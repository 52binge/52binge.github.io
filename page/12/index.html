<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Auckland New Zealand</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="Everyone should not forget his dream">
<meta property="og:type" content="website">
<meta property="og:title" content="Auckland New Zealand">
<meta property="og:url" content="http:&#x2F;&#x2F;iequa.com&#x2F;page&#x2F;12&#x2F;index.html">
<meta property="og:site_name" content="Auckland New Zealand">
<meta property="og:description" content="Everyone should not forget his dream">
<meta property="og:locale" content="en">
<meta name="twitter:card" content="summary">
  
  
    <link rel="icon" href="/css/images/favicon.ico">
  
  <link href="/webfonts/ptserif/main.css" rel='stylesheet' type='text/css'>
  <link href="/webfonts/source-code-pro/main.css" rel="stylesheet" type="text/css">
  <link rel="stylesheet" href="/css/style.css">
  

</head>

<body>
  <div id="container">
    <!-- blair add baidu tongji start... @2017.10.03 -->
<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?8864dc75a81a27b7e44c00138af95d66";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>
<!-- blair add baidu tongji end ! @2017.10.03 -->

<header id="header">
  <div id="header-outer" class="outer">
    <div id="header-inner" class="inner">
      <a id="main-nav-toggle" class="nav-icon" href="javascript:;" target="_blank" rel="noopener"></a>
      <a id="logo" class="logo" href="/"></a>
      <nav id="main-nav">
        
          <a class="main-nav-link" href="/ai1">AI</a>
        
          <a class="main-nav-link" href="/tensorflow">TF/Keras</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
          <a class="main-nav-link" href="/categories">Categories</a>
        
          <a class="main-nav-link" href="/about">About</a>
        
      </nav>
      <nav id="sub-nav">
        <div id="search-form-wrap">
          <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://iequa.com"></form>
        </div>
      </nav>
    </div>
  </div>
</header>

    <br>
    <section id="main" class="outer">
      <article id="post-tensorflow/tf-2.8-tensorflow-basic-summary" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <myh11 itemprop="name">
      <a class="article-title-index" href="/2017/09/08/tensorflow/tf-2.8-tensorflow-basic-summary/"><strong>TensorFlow åŸºæœ¬ç”¨æ³•æ€»ç»“</strong></a>
      <small class=article-date-index>&nbsp; 2017-09-08</small>
      <!--<a>
      <div = post.date  </div>
      </a>-->
      <br>
      <br> <!-- blair add -->
    </myh11>
  


      </header>
    
    <div class="article-meta">
      <!--<a href="/2017/09/08/tensorflow/tf-2.8-tensorflow-basic-summary/" class="article-date">
  <time datetime="2017-09-08T06:27:21.000Z" itemprop="datePublished">2017-09-08</time>
</a>-->
      <!--
  <div class="article-category-index">
    <a class="article-category-index-link" href="/categories/tensorflow/">tensorflow</a>
  </div>

-->
      <!--
      
        <div class="article-comment-link-wrap">
          <a href="http://iequa.com/2017/09/08/tensorflow/tf-2.8-tensorflow-basic-summary/#disqus_thread" class="article-comment-link">Comments</a>
        </div>
      
      -->
    </div>
	
    <div class="article-entry" itemprop="articleBody">
      
        <p>tensorflow ä¸­æ–‡æ–‡æ¡£å­¦ä¹  tensorflow çš„åŸºæœ¬ç”¨æ³•ã€‚</p>
<p>&lt;!-- more --&gt;</p>
<p>æŒ‰ç…§æ–‡æ¡£è¯´æ˜ï¼Œä¸€ç‚¹çŸ¥è¯†ç‚¹å°æ€»ç»“ï¼š</p>
<ol>
<li>å°±æ˜¯ Session() å’Œ InteractiveSession() çš„ç”¨æ³•ã€‚åè€…ç”¨ Tensor.eval() å’Œ Operation.run() æ¥æ›¿ä»£äº† Session.run(). å…¶ä¸­æ›´å¤šçš„æ˜¯ç”¨Tensor.eval()ï¼Œæ‰€æœ‰çš„è¡¨è¾¾å¼éƒ½å¯ä»¥çœ‹ä½œæ˜¯ Tensor.</li>
<li>tf è¡¨è¾¾å¼ä¸­æ‰€æœ‰çš„ <strong>varå˜é‡</strong> æˆ– <strong>constantå¸¸é‡</strong> éƒ½åº”è¯¥æ˜¯ <strong>tf</strong> çš„ç±»å‹ã€‚</li>
<li>åªè¦æ˜¯å£°æ˜äº† <strong>varå˜é‡</strong>ï¼Œå°±å¾—ç”¨ sess.run(tf.global_variables_initializer()) æ–¹æ³•æ¥åˆå§‹åŒ–æ‰èƒ½ç”¨ã€‚</li>
</ol>
<h2>1. å¹³é¢æ‹Ÿåˆ</h2>
<p>é€šè¿‡æœ¬ä¾‹å¯ä»¥çœ‹åˆ°æœºå™¨å­¦ä¹ çš„ä¸€ä¸ªé€šç”¨è¿‡ç¨‹ï¼š</p>
<ol>
<li>å‡†å¤‡æ•°æ®</li>
<li>æ„é€ æ¨¡å‹ï¼ˆè®¾ç½®æ±‚è§£ç›®æ ‡å‡½æ•°ï¼‰</li>
<li>æ±‚è§£æ¨¡å‹</li>
</ol>
<p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> tensorflow <span class="keyword">as</span> tf</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"><span class="comment"># 1.å‡†å¤‡æ•°æ®ï¼šä½¿ç”¨ NumPy ç”Ÿæˆå‡æ•°æ®(phony data), æ€»å…± 100 ä¸ªç‚¹.</span></span><br><span class="line">x_data = np.float32(np.random.rand(<span class="number">2</span>, <span class="number">100</span>)) <span class="comment"># éšæœºè¾“å…¥</span></span><br><span class="line">y_data = np.dot([<span class="number">0.100</span>, <span class="number">0.200</span>], x_data) + <span class="number">0.300</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 2.æ„é€ ä¸€ä¸ªçº¿æ€§æ¨¡å‹</span></span><br><span class="line">b = tf.Variable(tf.zeros([<span class="number">1</span>]))</span><br><span class="line">W = tf.Variable(tf.random_uniform([<span class="number">1</span>, <span class="number">2</span>], <span class="number">-1.0</span>, <span class="number">1.0</span>))</span><br><span class="line">y = tf.matmul(W, x_data) + b</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3.æ±‚è§£æ¨¡å‹</span></span><br><span class="line"><span class="comment"># è®¾ç½®æŸå¤±å‡½æ•°ï¼šè¯¯å·®çš„å‡æ–¹å·®</span></span><br><span class="line">loss = tf.reduce_mean(tf.square(y - y_data))</span><br><span class="line"><span class="comment"># é€‰æ‹©æ¢¯åº¦ä¸‹é™çš„æ–¹æ³•</span></span><br><span class="line">optimizer = tf.train.GradientDescentOptimizer(<span class="number">0.5</span>)</span><br><span class="line"><span class="comment"># è¿­ä»£çš„ç›®æ ‡ï¼šæœ€å°åŒ–æŸå¤±å‡½æ•°</span></span><br><span class="line">train = optimizer.minimize(loss)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">############################################################</span></span><br><span class="line"><span class="comment"># ä»¥ä¸‹æ˜¯ç”¨ tf æ¥è§£å†³ä¸Šé¢çš„ä»»åŠ¡</span></span><br><span class="line"><span class="comment"># 1.åˆå§‹åŒ–å˜é‡ï¼štf çš„å¿…å¤‡æ­¥éª¤ï¼Œä¸»è¦å£°æ˜äº†å˜é‡ï¼Œå°±å¿…é¡»åˆå§‹åŒ–æ‰èƒ½ç”¨</span></span><br><span class="line">init = tf.global_variables_initializer()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># è®¾ç½®tensorflowå¯¹GPUçš„ä½¿ç”¨æŒ‰éœ€åˆ†é…</span></span><br><span class="line">config  = tf.ConfigProto()</span><br><span class="line">config.gpu_options.allow_growth = <span class="literal">True</span></span><br><span class="line"><span class="comment"># 2.å¯åŠ¨å›¾ (graph)</span></span><br><span class="line">sess = tf.Session(config=config)</span><br><span class="line">sess.run(init)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3.è¿­ä»£ï¼Œåå¤æ‰§è¡Œä¸Šé¢çš„æœ€å°åŒ–æŸå¤±å‡½æ•°è¿™ä¸€æ“ä½œï¼ˆtrain opï¼‰,æ‹Ÿåˆå¹³é¢</span></span><br><span class="line"><span class="keyword">for</span> step <span class="keyword">in</span> xrange(<span class="number">0</span>, <span class="number">201</span>):</span><br><span class="line">    sess.run(train)</span><br><span class="line">    <span class="keyword">if</span> step % <span class="number">20</span> == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">print</span> step, sess.run(W), sess.run(b)</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¾—åˆ°æœ€ä½³æ‹Ÿåˆç»“æœ W: [[0.100  0.200]], b: [0.300]</span></span><br></pre></td></tr></table></figure></p>
<p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">0 [[ 0.27467242  0.81889796]] [-0.13746099]</span><br><span class="line">20 [[ 0.1619305   0.39317462]] [ 0.18206716]</span><br><span class="line">40 [[ 0.11901411  0.25831661]] [ 0.2642329]</span><br><span class="line">60 [[ 0.10580806  0.21761954]] [ 0.28916073]</span><br><span class="line">80 [[ 0.10176832  0.20532639]] [ 0.29671678]</span><br><span class="line">100 [[ 0.10053726  0.20161074]] [ 0.29900584]</span><br><span class="line">120 [[ 0.100163    0.20048723]] [ 0.29969904]</span><br><span class="line">140 [[ 0.10004941  0.20014738]] [ 0.29990891]</span><br><span class="line">160 [[ 0.10001497  0.20004457]] [ 0.29997244]</span><br><span class="line">180 [[ 0.10000452  0.20001349]] [ 0.29999167]</span><br><span class="line">200 [[ 0.10000138  0.2000041 ]] [ 0.29999748]</span><br></pre></td></tr></table></figure></p>
<h2>2. ä¸¤ä¸ªæ•°æ±‚å’Œ</h2>
<p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">input1 = tf.constant(<span class="number">2.0</span>)</span><br><span class="line">input2 = tf.constant(<span class="number">3.0</span>)</span><br><span class="line">input3 = tf.constant(<span class="number">5.0</span>)</span><br><span class="line"></span><br><span class="line">intermd = tf.add(input1, input2)</span><br><span class="line">mul = tf.multiply(input2, input3)</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> tf.Session() <span class="keyword">as</span> sess:</span><br><span class="line">    result = sess.run([mul, intermd])  <span class="comment"># ä¸€æ¬¡æ‰§è¡Œå¤šä¸ªop</span></span><br><span class="line">    print(result)</span><br><span class="line">    print(type(result))</span><br><span class="line">    print(type(result[<span class="number">0</span>]))</span><br></pre></td></tr></table></figure></p>
<p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">[15.0, 5.0]</span><br><span class="line">&lt;class &apos;list&apos;&gt;</span><br><span class="line">&lt;class &apos;numpy.float32&apos;&gt;</span><br></pre></td></tr></table></figure></p>
<h2>3. å˜é‡ï¼Œå¸¸é‡</h2>
<h3>3.1 tensorflow å®ç°è®¡æ•°å™¨</h3>
<p>ä¸»è¦æ˜¯è®¾è®¡äº†åœ¨å¾ªç¯ä¸­è°ƒç”¨åŠ æ³•å®ç°è®¡æ•°</p>
<p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># åˆ›å»ºå˜é‡ï¼Œåˆå§‹åŒ–ä¸º0</span></span><br><span class="line">state = tf.Variable(<span class="number">0</span>, name=<span class="string">"counter"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºä¸€ä¸ª op , å…¶ä½œç”¨æ˜¯æ—¶ state å¢åŠ  1</span></span><br><span class="line">one = tf.constant(<span class="number">1</span>) <span class="comment"># ç›´æ¥ç”¨ 1 ä¹Ÿå°±è¡Œäº†</span></span><br><span class="line">new_value = tf.add(state, <span class="number">1</span>)</span><br><span class="line">update = tf.assign(state, new_value)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># å¯åŠ¨å›¾ä¹‹åï¼Œ è¿è¡Œ update op</span></span><br><span class="line"><span class="keyword">with</span> tf.Session() <span class="keyword">as</span> sess:</span><br><span class="line">    <span class="comment"># åˆ›å»ºå¥½å›¾ä¹‹åï¼Œå˜é‡å¿…é¡»ç»è¿‡â€˜åˆå§‹åŒ–â€™ </span></span><br><span class="line">    sess.run(tf.global_variables_initializer())</span><br><span class="line">    <span class="comment"># æŸ¥çœ‹stateçš„åˆå§‹åŒ–å€¼</span></span><br><span class="line">    print(sess.run(state))</span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> range(<span class="number">3</span>):</span><br><span class="line">        sess.run(update)  <span class="comment"># è¿™æ ·å­æ¯ä¸€æ¬¡è¿è¡Œstate éƒ½è¿˜æ˜¯1</span></span><br><span class="line">        print(sess.run(state))</span><br></pre></td></tr></table></figure></p>
<p>output:</p>
<p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">0</span><br><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td></tr></table></figure></p>
<h3>3.2 ç”¨ tf æ¥å®ç°å¯¹ä¸€ç»„æ•°æ±‚å’Œï¼Œå†è®¡ç®—å¹³å‡</h3>
<p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> tensorflow <span class="keyword">as</span> tf</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">h_sum = tf.Variable(<span class="number">0.0</span>, dtype=tf.float32)</span><br><span class="line"><span class="comment"># h_vec = tf.random_normal(shape=([10]))</span></span><br><span class="line">h_vec = tf.constant([<span class="number">1.0</span>,<span class="number">2.0</span>,<span class="number">3.0</span>,<span class="number">4.0</span>])</span><br><span class="line"><span class="comment"># æŠŠ h_vec çš„æ¯ä¸ªå…ƒç´ åŠ åˆ° h_sum ä¸­ï¼Œç„¶åå†é™¤ä»¥ 10 æ¥è®¡ç®—å¹³å‡å€¼</span></span><br><span class="line"><span class="comment"># å¾…æ·»åŠ çš„æ•°</span></span><br><span class="line">h_add = tf.placeholder(tf.float32)</span><br><span class="line"><span class="comment"># æ·»åŠ ä¹‹åçš„å€¼</span></span><br><span class="line">h_new = tf.add(h_sum, h_add)</span><br><span class="line"><span class="comment"># æ›´æ–° h_new çš„ op</span></span><br><span class="line">update = tf.assign(h_sum, h_new)</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> tf.Session() <span class="keyword">as</span> sess:</span><br><span class="line">    sess.run(tf.global_variables_initializer())</span><br><span class="line">    <span class="comment"># æŸ¥çœ‹åŸå§‹å€¼</span></span><br><span class="line">    print(<span class="string">'s_sum ='</span>, sess.run(h_sum))</span><br><span class="line">    print(<span class="string">"vec = "</span>, sess.run(h_vec))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># å¾ªç¯æ·»åŠ </span></span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> range(<span class="number">4</span>):</span><br><span class="line">        sess.run(update, feed_dict=&#123;h_add: sess.run(h_vec[_])&#125;)</span><br><span class="line">        print(<span class="string">'h_sum ='</span>, sess.run(h_sum))</span><br><span class="line"></span><br><span class="line"><span class="comment">#     print 'the mean is ', sess.run(sess.run(h_sum) / 4)  # è¿™æ ·å†™ 4  æ˜¯é”™è¯¯çš„ï¼Œ å¿…é¡»è½¬ä¸º tf å˜é‡æˆ–è€…å¸¸é‡</span></span><br><span class="line">    print(<span class="string">'the mean is '</span>, sess.run(sess.run(h_sum) / tf.constant(<span class="number">4.0</span>)))</span><br></pre></td></tr></table></figure></p>
<h3>3.3 åªç”¨ä¸€ä¸ªå˜é‡æ¥å®ç°è®¡æ•°å™¨</h3>
<p>ä¸Šé¢çš„è®¡æ•°å™¨æ˜¯ TensorFlow å®˜æ–¹æ–‡æ¡£çš„ä¾‹å­ï¼Œä½†æ˜¯è§‰å¾—å¥½è‡ƒè‚¿ï¼Œæ‰€ä»¥ä¸‹é¢è¿™ä¸ªæ˜¯æ›´åŠ ç®€å•çš„ï¼Œåªéœ€è¦å®šä¹‰ä¸€ä¸ªå˜é‡å’Œä¸€ä¸ª åŠ  1 çš„æ“ä½œï¼ˆopï¼‰ã€‚é€šè¿‡forå¾ªç¯å°±èƒ½å¤Ÿå®ç°äº†ã€‚</p>
<p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># å¦‚æœä¸æ˜¯ assign() é‡æ–°èµ‹å€¼çš„è¯ï¼Œæ¯ä¸€æ¬¡ sess.run()éƒ½ä¼šæŠŠ stateå†æ¬¡åˆå§‹åŒ–ä¸º 0.0</span></span><br><span class="line">state = tf.Variable(<span class="number">0.0</span>, tf.float32)</span><br><span class="line"><span class="comment"># é€šè¿‡ assign æ“ä½œæ¥æ”¹å˜stateçš„å€¼ã€‚</span></span><br><span class="line">add_op = tf.assign(state, state+<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">sess.run(tf.global_variables_initializer())</span><br><span class="line"><span class="keyword">print</span> <span class="string">'init state '</span>, sess.run(state)</span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> xrange(<span class="number">3</span>):</span><br><span class="line">    sess.run(add_op)</span><br><span class="line">    print(sess.run(state))</span><br></pre></td></tr></table></figure></p>
<p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">init state  0.0</span><br><span class="line">1.0</span><br><span class="line">2.0</span><br><span class="line">3.0</span><br></pre></td></tr></table></figure></p>
<blockquote>
<p>è¿™æ ·å­å’Œæˆ‘ä»¬å¹³æ—¶å®ç°è®¡æ•°å™¨çš„æ–¹æ³•åŸºæœ¬ä¸Šå°±ä¸€è‡´äº†ã€‚æˆ‘ä»¬è¦é‡ç‚¹ç†è§£çš„æ˜¯ï¼Œ TensorFlow ä¸­é€šè¿‡ tf.assign(ref, value) çš„æ–¹å¼æ¥æŠŠ value å€¼èµ‹ç»™ ref å˜é‡ã€‚è¿™æ ·å­ï¼Œæ¯ä¸€æ¬¡å¾ªç¯çš„æ—¶å€™ï¼Œref å˜é‡æ‰ä¸ä¼šå†åšå®šä¹‰æ—¶å€™çš„åˆå§‹åŒ–æ“ä½œã€‚</p>
</blockquote>
<h2>4. InteractiveSession() çš„ç”¨æ³•</h2>
<p>InteractiveSession() ä¸»è¦æ˜¯é¿å… Sessionï¼ˆä¼šè¯ï¼‰è¢«ä¸€ä¸ªå˜é‡æŒæœ‰</p>
<p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">a = tf.constant(<span class="number">1.0</span>)</span><br><span class="line">b = tf.constant(<span class="number">2.0</span>)</span><br><span class="line">c = a + b</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¸‹é¢çš„ä¸¤ç§æƒ…å†µæ˜¯ç­‰ä»·çš„</span></span><br><span class="line"><span class="keyword">with</span> tf.Session():  <span class="comment"># ä¸ç”¨ close()</span></span><br><span class="line">    print(c.eval())</span><br><span class="line"></span><br><span class="line">sess = tf.InteractiveSession()</span><br><span class="line">print(c.eval())</span><br><span class="line">sess.close()</span><br></pre></td></tr></table></figure></p>
<p>output:</p>
<p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">3.0</span><br><span class="line">3.0</span><br></pre></td></tr></table></figure></p>
<h3>4.1 InteractiveSession()ã€evalã€init</h3>
<p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">a = tf.constant(<span class="number">1.0</span>)</span><br><span class="line">b = tf.constant(<span class="number">2.0</span>)</span><br><span class="line">c = tf.Variable(<span class="number">3.0</span>)</span><br><span class="line">d = a + b</span><br><span class="line"></span><br><span class="line">sess = tf.InteractiveSession()</span><br><span class="line">sess.run(tf.global_variables_initializer())</span><br><span class="line"></span><br><span class="line"><span class="comment">###################</span></span><br><span class="line"><span class="comment"># è¿™æ ·å†™æ˜¯é”™è¯¯çš„</span></span><br><span class="line"><span class="comment"># print(a.run())</span></span><br><span class="line"><span class="comment"># print(d.run())</span></span><br><span class="line"></span><br><span class="line"><span class="comment">####################</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è¿™æ ·æ‰æ˜¯æ­£ç¡®çš„</span></span><br><span class="line">print(a.eval())</span><br><span class="line">print(d.eval())</span><br><span class="line"></span><br><span class="line"><span class="comment"># run() æ–¹æ³•ä¸»è¦ç”¨æ¥</span></span><br><span class="line">x = tf.Variable(<span class="number">1.2</span>)</span><br><span class="line"><span class="comment"># print(x.eval())  # è¿˜æ²¡åˆå§‹åŒ–ï¼Œä¸èƒ½ç”¨</span></span><br><span class="line">x.initializer.run()  <span class="comment"># x.initializer å°±æ˜¯ä¸€ä¸ªåˆå§‹åŒ–çš„ opï¼Œ op æ‰è°ƒç”¨run() æ–¹æ³•</span></span><br><span class="line">print(x.eval())</span><br><span class="line"></span><br><span class="line">sess.close()</span><br></pre></td></tr></table></figure></p>
<p>output:</p>
<p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">1.0</span><br><span class="line">3.0</span><br><span class="line">1.2</span><br></pre></td></tr></table></figure></p>
<h3>4.2 ä½¿ç”¨ tf.InteractiveSession() æ¥å®Œæˆä¸Šé¢ æ±‚å’Œã€å¹³å‡ çš„æ“ä½œå‘¢?</h3>
<p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">h_sum = tf.Variable(<span class="number">0.0</span>, dtype=tf.float32)</span><br><span class="line"><span class="comment"># h_vec = tf.random_normal(shape=([10]))</span></span><br><span class="line">h_vec = tf.constant([<span class="number">1.0</span>,<span class="number">2.0</span>,<span class="number">3.0</span>,<span class="number">4.0</span>])</span><br><span class="line"><span class="comment"># æŠŠ h_vec çš„æ¯ä¸ªå…ƒç´ åŠ åˆ° h_sum ä¸­ï¼Œç„¶åå†é™¤ä»¥ 10 æ¥è®¡ç®—å¹³å‡å€¼</span></span><br><span class="line"><span class="comment"># å¾…æ·»åŠ çš„æ•°</span></span><br><span class="line">h_add = tf.placeholder(tf.float32)</span><br><span class="line"><span class="comment"># æ·»åŠ ä¹‹åçš„å€¼</span></span><br><span class="line">h_new = tf.add(h_sum, h_add)</span><br><span class="line"><span class="comment"># æ›´æ–° h_new çš„ op</span></span><br><span class="line">update = tf.assign(h_sum, h_new)</span><br><span class="line"></span><br><span class="line">sess = tf.InteractiveSession()</span><br><span class="line">sess.run(tf.global_variables_initializer())</span><br><span class="line"></span><br><span class="line">print(<span class="string">'s_sum ='</span>, h_sum.eval())</span><br><span class="line">print(<span class="string">"vec = "</span>, h_vec.eval())</span><br><span class="line">print(<span class="string">"vec = "</span>, h_vec[<span class="number">0</span>].eval())</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> range(<span class="number">4</span>):</span><br><span class="line">    update.eval(feed_dict=&#123;h_add: h_vec[_].eval()&#125;)</span><br><span class="line">    print(<span class="string">'h_sum ='</span>, h_sum.eval())</span><br><span class="line">sess.close()</span><br></pre></td></tr></table></figure></p>
<p>output:</p>
<p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">s_sum = 0.0</span><br><span class="line">vec =  [ 1.  2.  3.  4.]</span><br><span class="line">vec =  1.0</span><br><span class="line">h_sum = 1.0</span><br><span class="line">h_sum = 3.0</span><br><span class="line">h_sum = 6.0</span><br><span class="line">h_sum = 10.0</span><br></pre></td></tr></table></figure></p>
<h3>4.3 ä½¿ç”¨ feed æ¥å¯¹å˜é‡èµ‹å€¼</h3>
<p>è¿™äº›éœ€è¦ç”¨åˆ° feed æ¥èµ‹å€¼çš„æ“ä½œå¯ä»¥é€šè¿‡ tf.placeholder() è¯´æ˜ï¼Œä»¥åˆ›å»ºå ä½ç¬¦ã€‚</p>
<p>ä¸‹é¢çš„ä¾‹å­ä¸­å¯ä»¥çœ‹å‡º session.run([output], â€¦) å’Œ session.run(output, â€¦) çš„åŒºåˆ«ã€‚å‰è€…è¾“å‡ºäº† output çš„ç±»å‹ç­‰è¯¦ç»†ä¿¡æ¯ï¼Œåè€…åªè¾“å‡ºç®€å•ç»“æœã€‚</p>
<p><strong>ğŸŒ°ğŸŒ°1ï¼šfeed</strong></p>
<p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">input1 = tf.placeholder(tf.float32)</span><br><span class="line">input2 = tf.placeholder(tf.float32)</span><br><span class="line">output = tf.multiply(input1, input2)</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> tf.Session() <span class="keyword">as</span> sess:</span><br><span class="line">    print(sess.run([output], feed_dict=&#123;input1:[<span class="number">7.0</span>], input2:[<span class="number">2.0</span>]&#125;))</span><br></pre></td></tr></table></figure></p>
<p>output:</p>
<p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[array([ 14.], dtype=float32)]</span><br></pre></td></tr></table></figure></p>
<p><strong>ğŸŒ°ğŸŒ°2ï¼š input1:[7.0], input2:[2.0]</strong></p>
<p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">with</span> tf.Session() <span class="keyword">as</span> sess:</span><br><span class="line">    result = sess.run(output, feed_dict=&#123;input1:[<span class="number">7.0</span>], input2:[<span class="number">2.0</span>]&#125;)</span><br><span class="line">    print(type(result))</span><br><span class="line">    print(result)</span><br></pre></td></tr></table></figure></p>
<p>output:</p>
<p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;type &apos;numpy.ndarray&apos;&gt;</span><br><span class="line">[ 14.]</span><br></pre></td></tr></table></figure></p>
<p><strong>ğŸŒ°ğŸŒ°3ï¼š input1:7.0, input2:2.0</strong></p>
<p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">with</span> tf.Session() <span class="keyword">as</span> sess:</span><br><span class="line">    result = sess.run(output, feed_dict=&#123;input1:<span class="number">7.0</span>, input2:<span class="number">2.0</span>&#125;)</span><br><span class="line">    print(type(result))</span><br><span class="line">    print(result)</span><br></pre></td></tr></table></figure></p>
<p>output:</p>
<p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;type &apos;numpy.float32&apos;&gt;</span><br><span class="line">14.0</span><br></pre></td></tr></table></figure></p>
<p><strong>ğŸŒ°ğŸŒ°4ï¼š [output], output</strong></p>
<p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">with</span> tf.Session() <span class="keyword">as</span> sess:</span><br><span class="line">    print(sess.run([output], feed_dict=&#123;input1:[<span class="number">7.0</span>, <span class="number">3.0</span>], input2:[<span class="number">2.0</span>, <span class="number">1.0</span>]&#125;))</span><br><span class="line">    print()</span><br><span class="line">    print(sess.run(output, feed_dict=&#123;input1:[<span class="number">7.0</span>, <span class="number">3.0</span>], input2:[<span class="number">2.0</span>, <span class="number">1.0</span>]&#125;))</span><br></pre></td></tr></table></figure></p>
<p>output:</p>
<p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">[array([ 14.,   3.], dtype=float32)]</span><br><span class="line"></span><br><span class="line">[ 14.   3.]</span><br></pre></td></tr></table></figure></p>
<h2>Reference</h2>
<ul>
<li><a href="https://www.tensorflow.org/" target="_blank" rel="noopener">tensorflow.org</a></li>
<li><a href="https://blog.csdn.net/jerr__y/article/details/57084008" target="_blank" rel="noopener">TensorFlowå…¥é—¨ï¼ˆä¸€ï¼‰åŸºæœ¬ç”¨æ³•</a></li>
</ul>

      
    </div>
	
    <!--
	
    -->
    <!--
    
      <footer class="article-footer">
      </footer>
    
    -->
  </div>
  
</article>



    
      <article id="post-tensorflow/tf-2.6-B-activation-function" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <myh11 itemprop="name">
      <a class="article-title-index" href="/2017/09/07/tensorflow/tf-2.6-B-activation-function/"><strong>Activation Function æ¿€åŠ±å‡½æ•°</strong></a>
      <small class=article-date-index>&nbsp; 2017-09-07</small>
      <!--<a>
      <div = post.date  </div>
      </a>-->
      <br>
      <br> <!-- blair add -->
    </myh11>
  


      </header>
    
    <div class="article-meta">
      <!--<a href="/2017/09/07/tensorflow/tf-2.6-B-activation-function/" class="article-date">
  <time datetime="2017-09-07T06:27:21.000Z" itemprop="datePublished">2017-09-07</time>
</a>-->
      <!--
  <div class="article-category-index">
    <a class="article-category-index-link" href="/categories/tensorflow/">tensorflow</a>
  </div>

-->
      <!--
      
        <div class="article-comment-link-wrap">
          <a href="http://iequa.com/2017/09/07/tensorflow/tf-2.6-B-activation-function/#disqus_thread" class="article-comment-link">Comments</a>
        </div>
      
      -->
    </div>
	
    <div class="article-entry" itemprop="articleBody">
      
        <p>Tensorflow æä¾›çš„ä¸€äº› Activation Function <a href="https://www.tensorflow.org/api_guides/python/nn" target="_blank" rel="noopener">tensorflow/api_guides/python/nn</a></p>
<p>&lt;!-- more --&gt;</p>
<p>æ¿€åŠ±å‡½æ•°è¿è¡Œæ—¶æ¿€æ´»ç¥ç»ç½‘ç»œä¸­æŸä¸€éƒ¨åˆ†ç¥ç»å…ƒï¼Œå°†æ¿€æ´»ä¿¡æ¯å‘åä¼ å…¥ä¸‹ä¸€å±‚çš„ç¥ç»ç³»ç»Ÿã€‚</p>
<p>æ¿€åŠ±å‡½æ•°çš„å®è´¨æ˜¯éçº¿æ€§æ–¹ç¨‹ã€‚ Tensorflow çš„ç¥ç»ç½‘ç»œ é‡Œé¢å¤„ç†è¾ƒä¸ºå¤æ‚çš„é—®é¢˜æ—¶éƒ½ä¼šéœ€è¦è¿ç”¨ activation function ã€‚</p>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ª TensorFlow æ­å»ºçš„ ç®€å•ç‰ˆç¥ç»ç½‘ç»œ æ•°æ®æµå›¾ :</p>
<p>&lt;img src=&quot;/images/tensorflow/tf-2.6-active6_1.png&quot; width=&quot;550&quot; /&gt;</p>
<p>Layer2 å±•å¼€éƒ¨åˆ†ï¼ŒLayer1 å‡ºæ¥çš„æ•°æ®ï¼Œå†è¾“å…¥åˆ° Layer2 ä¸­</p>
<p>&lt;img src=&quot;/images/tensorflow/tf-2.6-active7.jpg&quot; width=&quot;550&quot; /&gt;</p>
<blockquote>
<p>è¯¦ç»†ä»‹ç»è¯·å‰å¾€ <a href="/2018/09/07/tensorflow-2-6-A-activation-function/">What's Activation Function</a></p>
</blockquote>
<h2>Reference</h2>
<ul>
<li><a href="https://www.tensorflow.org/" target="_blank" rel="noopener">tensorflow.org</a></li>
<li><a href="https://morvanzhou.github.io/tutorials/machine-learning/tensorflow/" target="_blank" rel="noopener">è«çƒ¦Python</a></li>
<li><a href="https://www.tensorflow.org/api_guides/python/nn" target="_blank" rel="noopener">Tensorflow æä¾›çš„ä¸€äº› æ¿€åŠ±å‡½æ•°</a></li>
</ul>

      
    </div>
	
    <!--
	
    -->
    <!--
    
      <footer class="article-footer">
      </footer>
    
    -->
  </div>
  
</article>



    
      <article id="post-tensorflow/tf-2.6-A-activation-function" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <myh11 itemprop="name">
      <a class="article-title-index" href="/2017/09/07/tensorflow/tf-2.6-A-activation-function/"><strong>What&#39;s Activation Function</strong></a>
      <small class=article-date-index>&nbsp; 2017-09-07</small>
      <!--<a>
      <div = post.date  </div>
      </a>-->
      <br>
      <br> <!-- blair add -->
    </myh11>
  


      </header>
    
    <div class="article-meta">
      <!--<a href="/2017/09/07/tensorflow/tf-2.6-A-activation-function/" class="article-date">
  <time datetime="2017-09-07T06:15:21.000Z" itemprop="datePublished">2017-09-07</time>
</a>-->
      <!--
  <div class="article-category-index">
    <a class="article-category-index-link" href="/categories/tensorflow/">tensorflow</a>
  </div>

-->
      <!--
      
        <div class="article-comment-link-wrap">
          <a href="http://iequa.com/2017/09/07/tensorflow/tf-2.6-A-activation-function/#disqus_thread" class="article-comment-link">Comments</a>
        </div>
      
      -->
    </div>
	
    <div class="article-entry" itemprop="articleBody">
      
        <p>ç°ä»£ç¥ç»ç½‘ç»œä¸­ å¿…ä¸å¯å°‘çš„ä¸€ä¸ªç»„æˆéƒ¨åˆ†, æ¿€åŠ±å‡½æ•°, activation function.</p>
<p>&lt;!-- more --&gt;</p>
<p>æœ¬æ–‡å¤§éƒ¨åˆ†å†…å®¹è½¬è½½è‡ª <a href="https://morvanzhou.github.io/tutorials/machine-learning/tensorflow/" target="_blank" rel="noopener">è«çƒ¦Python /Tensorflow-Tutorial</a></p>
<h2>éçº¿æ€§æ–¹ç¨‹</h2>
<p>æˆ‘ä»¬ä¸ºä»€ä¹ˆè¦ä½¿ç”¨æ¿€åŠ±å‡½æ•°? ç”¨ç®€å•çš„è¯­å¥æ¥æ¦‚æ‹¬. å°±æ˜¯å› ä¸º, &lt;span style=&quot;TEXT-DECORATION: underline&quot;&gt;<strong>ç°å®å¹¶æ²¡æœ‰æˆ‘ä»¬æƒ³è±¡çš„é‚£ä¹ˆç¾å¥½</strong>&lt;/span&gt;ã€‚æ¿€åŠ±å‡½æ•°ä¹Ÿå°±æ˜¯ä¸ºäº†è§£å†³æˆ‘ä»¬æ—¥å¸¸ç”Ÿæ´»ä¸­ <strong>ä¸èƒ½ç”¨çº¿æ€§æ–¹ç¨‹æ‰€æ¦‚æ‹¬çš„é—®é¢˜</strong>.</p>
<p><img src="/images/tensorflow/tf-2.6-active1.png" alt="Linear function and Nonlinear function"></p>
<p>è¯´åˆ°çº¿æ€§æ–¹ç¨‹, æˆ‘ä»¬ä¸å¾—ä¸æåˆ°å¦å¤–ä¸€ç§æ–¹ç¨‹, éçº¿æ€§æ–¹ç¨‹ (nonlinear function). æˆ‘ä»¬å‡è®¾, å¥³ç”Ÿé•¿å¾—è¶Šæ¼‚äº®, è¶Šå¤šç”·ç”Ÿçˆ±. è¿™å°±å¯ä»¥è¢«å½“åšä¸€ä¸ªçº¿æ€§é—®é¢˜. ä½†æ˜¯å¦‚æœæˆ‘ä»¬å‡è®¾è¿™ä¸ªåœºæ™¯æ˜¯å‘ç”Ÿåœ¨æ ¡å›­é‡Œ. æ ¡å›­é‡Œçš„ç”·ç”Ÿæ•°æ˜¯æœ‰é™çš„, å¥³ç”Ÿå†æ¼‚äº®, ä¹Ÿä¸å¯èƒ½ä¼šæœ‰æ— ç©·å¤šçš„ç”·ç”Ÿå–œæ¬¢å¥¹. æ‰€ä»¥è¿™å°±å˜æˆäº†ä¸€ä¸ªéçº¿æ€§é—®é¢˜.å†è¯´..å¥³ç”Ÿä¹Ÿä¸å¯èƒ½æ˜¯æ— ç©·æ¼‚äº®çš„. è¿™ä¸ªé—®é¢˜æˆ‘ä»¬ä»¥åæœ‰æ—¶é—´ç§ä¸‹è®¨è®º.</p>
<p><img src="/images/tensorflow/tf-2.6-active2.png" alt="Linear function -&amp;gt; Activation Function"></p>
<p>ç„¶åæˆ‘ä»¬å°±å¯ä»¥æ¥è®¨è®ºå¦‚ä½•åœ¨ç¥ç»ç½‘ç»œä¸­è¾¾æˆæè¿°éçº¿æ€§çš„ä»»åŠ¡äº†. æˆ‘ä»¬å¯ä»¥æŠŠæ•´ä¸ªç½‘ç»œç®€åŒ–æˆè¿™æ ·ä¸€ä¸ªå¼å­. $Y = WX$, $W$ å°±æ˜¯æˆ‘ä»¬è¦æ±‚çš„å‚æ•°, $y$ æ˜¯é¢„æµ‹å€¼, $x$ æ˜¯è¾“å…¥å€¼. ç”¨è¿™ä¸ªå¼å­, æˆ‘ä»¬å¾ˆå®¹æ˜“å°±èƒ½æè¿°åˆšåˆšçš„é‚£ä¸ªçº¿æ€§é—®é¢˜, å› ä¸º $W$ æ±‚å‡ºæ¥å¯ä»¥æ˜¯ä¸€ä¸ªå›ºå®šçš„æ•°. ä¸è¿‡è¿™ä¼¼ä¹å¹¶ä¸èƒ½è®©è¿™æ¡ç›´çº¿å˜å¾—æ‰­èµ·æ¥ , æ¿€åŠ±å‡½æ•°è§çŠ¶, æ‹”åˆ€ç›¸åŠ©, ç«™å‡ºæ¥è¯´é“: â€œè®©æˆ‘æ¥æ°å¼¯å®ƒ!â€.</p>
<h2>æ¿€åŠ±å‡½æ•°</h2>
<p><img src="/images/tensorflow/tf-2.6-active3.png" alt="Activation Function"></p>
<blockquote>
<p>è¿™é‡Œçš„ AF å°±æ˜¯æŒ‡æ¿€åŠ±å‡½æ•°. æ¿€åŠ±å‡½æ•°æ‹¿å‡ºè‡ªå·±æœ€æ“…é•¿çš„â€æ°å¼¯åˆ©å™¨â€, å¥—åœ¨åŸå‡½æ•°ä¸Šç”¨åŠ›ä¸€æ‰­, åŸæ¥çš„ $WX$ ç»“æœå°±è¢«æ‰­å¼¯äº†.</p>
</blockquote>
<p>å…¶å®è¿™ä¸ª AF, æ°å¼¯åˆ©å™¨, ä¹Ÿä¸æ˜¯ä»€ä¹ˆè§¦ä¸å¯åŠçš„ä¸œè¥¿. å®ƒå…¶å®å°±æ˜¯å¦å¤–ä¸€ä¸ªéçº¿æ€§å‡½æ•°. æ¯”å¦‚è¯´<code>relu, sigmoid, tanh</code>. å°†è¿™äº›æ°å¼¯åˆ©å™¨åµŒå¥—åœ¨åŸæœ‰çš„ç»“æœä¹‹ä¸Š, å¼ºè¡ŒæŠŠåŸæœ‰çš„çº¿æ€§ç»“æœç»™æ‰­æ›²äº†. ä½¿å¾—è¾“å‡ºç»“æœ $y$ ä¹Ÿæœ‰äº†éçº¿æ€§çš„ç‰¹å¾. ä¸¾ä¸ªä¾‹å­, æ¯”å¦‚æˆ‘ä½¿ç”¨äº† <code>relu</code> è¿™ä¸ªæ°å¼¯åˆ©å™¨, å¦‚æœæ­¤æ—¶ $Wx$ çš„ç»“æœæ˜¯ 1, $y$ è¿˜å°†æ˜¯ 1, ä¸è¿‡ $WX$ ä¸º -1 çš„æ—¶å€™, $y$ ä¸å†æ˜¯ -1, è€Œä¼šæ˜¯ 0.</p>
<p>&lt;img src=&quot;/images/tensorflow/tf-2.6-active5.jpg&quot; width=&quot;550&quot; /&gt;</p>
<blockquote>
<p>ä½ ç”šè‡³å¯ä»¥åˆ›é€ è‡ªå·±çš„æ¿€åŠ±å‡½æ•°æ¥å¤„ç†è‡ªå·±çš„é—®é¢˜, ä¸è¿‡è¦ç¡®ä¿çš„æ˜¯è¿™äº›æ¿€åŠ±å‡½æ•°å¿…é¡»æ˜¯å¯ä»¥å¾®åˆ†çš„, å› ä¸ºåœ¨ backpropagation è¯¯å·®åå‘ä¼ é€’çš„æ—¶å€™, åªæœ‰è¿™äº›å¯å¾®åˆ†çš„æ¿€åŠ±å‡½æ•°æ‰èƒ½æŠŠè¯¯å·®ä¼ é€’å›å».</p>
</blockquote>
<h2>å¸¸ç”¨é€‰æ‹©</h2>
<p><img src="/images/tensorflow/tf-2.6-active4.png" alt="Activation Function"></p>
<p>æƒ³è¦æ°å½“ä½¿ç”¨è¿™äº›æ¿€åŠ±å‡½æ•°, è¿˜æ˜¯æœ‰çªé—¨çš„. æ¯”å¦‚å½“ä½ çš„ç¥ç»ç½‘ç»œå±‚åªæœ‰ä¸¤ä¸‰å±‚, ä¸æ˜¯å¾ˆå¤šçš„æ—¶å€™, å¯¹äºéšè—å±‚, ä½¿ç”¨ä»»æ„çš„æ¿€åŠ±å‡½æ•°, éšä¾¿æ°å¼¯æ˜¯å¯ä»¥çš„, ä¸ä¼šæœ‰ç‰¹åˆ«å¤§çš„å½±å“. ä¸è¿‡, å½“ä½ ä½¿ç”¨ç‰¹åˆ«å¤šå±‚çš„ç¥ç»ç½‘ç»œ, åœ¨æ°å¼¯çš„æ—¶å€™, ç©ç©ä¸å¾—éšæ„é€‰æ‹©åˆ©å™¨. å› ä¸ºè¿™ä¼šæ¶‰åŠåˆ°æ¢¯åº¦çˆ†ç‚¸, æ¢¯åº¦æ¶ˆå¤±çš„é—®é¢˜. å› ä¸ºæ—¶é—´çš„å…³ç³», æˆ‘ä»¬å¯èƒ½ä¼šåœ¨ä»¥åæ¥å…·ä½“è°ˆè°ˆè¿™ä¸ªé—®é¢˜.</p>
<p>æœ€åæˆ‘ä»¬è¯´è¯´, åœ¨å…·ä½“çš„ä¾‹å­ä¸­, æˆ‘ä»¬é»˜è®¤é¦–é€‰çš„æ¿€åŠ±å‡½æ•°æ˜¯å“ªäº›. åœ¨å°‘é‡å±‚ç»“æ„ä¸­, æˆ‘ä»¬å¯ä»¥å°è¯•å¾ˆå¤šç§ä¸åŒçš„æ¿€åŠ±å‡½æ•°. åœ¨å·ç§¯ç¥ç»ç½‘ç»œ Convolutional neural networks çš„å·ç§¯å±‚ä¸­, æ¨èçš„æ¿€åŠ±å‡½æ•°æ˜¯ <code>relu</code>. åœ¨å¾ªç¯ç¥ç»ç½‘ç»œä¸­ Recurrent neural networks, æ¨èçš„æ˜¯ <code>tanh</code> æˆ–è€…æ˜¯ <code>relu</code> (è¿™ä¸ªå…·ä½“æ€ä¹ˆé€‰, æˆ‘ä¼šåœ¨ä»¥å å¾ªç¯ç¥ç»ç½‘ç»œ çš„ä»‹ç»ä¸­åœ¨è¯¦ç»†è®²è§£).</p>
<h2>Reference</h2>
<ul>
<li><a href="https://www.tensorflow.org/" target="_blank" rel="noopener">tensorflow.org</a></li>
<li><a href="https://morvanzhou.github.io/tutorials/machine-learning/tensorflow/" target="_blank" rel="noopener">è«çƒ¦Python</a></li>
<li><a href="https://github.com/MorvanZhou/Tensorflow-Tutorial" target="_blank" rel="noopener">Tensorflow æä¾›çš„ä¸€äº› æ¿€åŠ±å‡½æ•°</a></li>
</ul>

      
    </div>
	
    <!--
	
    -->
    <!--
    
      <footer class="article-footer">
      </footer>
    
    -->
  </div>
  
</article>



    
      <article id="post-tensorflow/tf-2.5-placeholde" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <myh11 itemprop="name">
      <a class="article-title-index" href="/2017/08/30/tensorflow/tf-2.5-placeholde/"><strong>Placeholder ä¼ å…¥å€¼</strong></a>
      <small class=article-date-index>&nbsp; 2017-08-30</small>
      <!--<a>
      <div = post.date  </div>
      </a>-->
      <br>
      <br> <!-- blair add -->
    </myh11>
  


      </header>
    
    <div class="article-meta">
      <!--<a href="/2017/08/30/tensorflow/tf-2.5-placeholde/" class="article-date">
  <time datetime="2017-08-30T03:45:21.000Z" itemprop="datePublished">2017-08-30</time>
</a>-->
      <!--
  <div class="article-category-index">
    <a class="article-category-index-link" href="/categories/tensorflow/">tensorflow</a>
  </div>

-->
      <!--
      
        <div class="article-comment-link-wrap">
          <a href="http://iequa.com/2017/08/30/tensorflow/tf-2.5-placeholde/#disqus_thread" class="article-comment-link">Comments</a>
        </div>
      
      -->
    </div>
	
    <div class="article-entry" itemprop="articleBody">
      
        <p>placeholder æ˜¯ Tensorflow ä¸­çš„å ä½ç¬¦ï¼Œæš‚æ—¶å‚¨å­˜å˜é‡.</p>
<p>&lt;!-- more --&gt;</p>
<p>Tensorflow å¦‚æœæƒ³è¦ä»å¤–éƒ¨ä¼ å…¥data, é‚£å°±éœ€è¦ç”¨åˆ° <code>tf.placeholder()</code>, ç„¶åä»¥è¿™ç§å½¢å¼ä¼ è¾“æ•°æ® <code>sess.run(**, feed_dict={input: **})</code>.</p>
<p>ä¸¾ä¸ªğŸŒ°:</p>
<p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> tensorflow <span class="keyword">as</span> tf</span><br><span class="line"></span><br><span class="line"><span class="comment">#åœ¨ Tensorflow ä¸­éœ€è¦å®šä¹‰ placeholder çš„ type ï¼Œä¸€èˆ¬ä¸º float32 å½¢å¼</span></span><br><span class="line">input1 = tf.placeholder(tf.float32)</span><br><span class="line">input2 = tf.placeholder(tf.float32)</span><br><span class="line"></span><br><span class="line"><span class="comment"># mul = multiply æ˜¯å°†input1å’Œinput2 åšä¹˜æ³•è¿ç®—ï¼Œå¹¶è¾“å‡ºä¸º output </span></span><br><span class="line">ouput = tf.multiply(input1, input2)</span><br></pre></td></tr></table></figure></p>
<p>æ¥ä¸‹æ¥, ä¼ å€¼çš„å·¥ä½œäº¤ç»™äº† <code>sess.run()</code> , éœ€è¦ä¼ å…¥çš„å€¼æ”¾åœ¨äº† <code>feed_dict={}</code> å¹¶ä¸€ä¸€å¯¹åº”æ¯ä¸€ä¸ª <code>input</code>. <code>placeholder</code> ä¸ <code>feed_dict={}</code> æ˜¯ç»‘å®šåœ¨ä¸€èµ·å‡ºç°çš„ã€‚</p>
<p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">with</span> tf.Session() <span class="keyword">as</span> sess:</span><br><span class="line">    print(sess.run(ouput, feed_dict=&#123;input1: [<span class="number">7.</span>], input2: [<span class="number">2.</span>]&#125;))</span><br><span class="line"><span class="comment"># [ 14.]</span></span><br></pre></td></tr></table></figure></p>
<h2>Reference</h2>
<ul>
<li><a href="https://www.tensorflow.org/" target="_blank" rel="noopener">tensorflow.org</a></li>
<li><a href="https://morvanzhou.github.io/tutorials/machine-learning/tensorflow/" target="_blank" rel="noopener">è«çƒ¦Python</a></li>
</ul>

      
    </div>
	
    <!--
	
    -->
    <!--
    
      <footer class="article-footer">
      </footer>
    
    -->
  </div>
  
</article>



    
      <article id="post-tensorflow/tf-2.4-variable" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <myh11 itemprop="name">
      <a class="article-title-index" href="/2017/08/29/tensorflow/tf-2.4-variable/"><strong>Variable å˜é‡</strong></a>
      <small class=article-date-index>&nbsp; 2017-08-29</small>
      <!--<a>
      <div = post.date  </div>
      </a>-->
      <br>
      <br> <!-- blair add -->
    </myh11>
  


      </header>
    
    <div class="article-meta">
      <!--<a href="/2017/08/29/tensorflow/tf-2.4-variable/" class="article-date">
  <time datetime="2017-08-29T02:07:21.000Z" itemprop="datePublished">2017-08-29</time>
</a>-->
      <!--
  <div class="article-category-index">
    <a class="article-category-index-link" href="/categories/tensorflow/">tensorflow</a>
  </div>

-->
      <!--
      
        <div class="article-comment-link-wrap">
          <a href="http://iequa.com/2017/08/29/tensorflow/tf-2.4-variable/#disqus_thread" class="article-comment-link">Comments</a>
        </div>
      
      -->
    </div>
	
    <div class="article-entry" itemprop="articleBody">
      
        <p>åœ¨ Tensorflow ä¸­ä½¿ç”¨ Variableã€‚ åœ¨ Tensorflow ä¸­ï¼Œå®šä¹‰äº†æŸå­—ç¬¦ä¸²æ˜¯å˜é‡ï¼Œå®ƒæ‰æ˜¯å˜é‡ï¼Œè¿™ä¸€ç‚¹æ˜¯ä¸ Python æ‰€ä¸åŒçš„ã€‚</p>
<p>&lt;!-- more --&gt;</p>
<p>å®šä¹‰è¯­æ³•ï¼š <code>state = tf.Variable()</code></p>
<p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> tensorflow <span class="keyword">as</span> tf</span><br><span class="line"></span><br><span class="line">state = tf.Variable(<span class="number">0</span>, name=<span class="string">'counter'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># å®šä¹‰å¸¸é‡ one</span></span><br><span class="line">one = tf.constant(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># å®šä¹‰åŠ æ³•æ­¥éª¤ (æ³¨: æ­¤æ­¥å¹¶æ²¡æœ‰ç›´æ¥è®¡ç®—)</span></span><br><span class="line">new_value = tf.add(state, one)</span><br><span class="line"></span><br><span class="line"><span class="comment"># å°† State æ›´æ–°æˆ new_value</span></span><br><span class="line">update = tf.assign(state, new_value)</span><br></pre></td></tr></table></figure></p>
<p>å¦‚æœä½ åœ¨ Tensorflow ä¸­è®¾å®šäº†å˜é‡ï¼Œé‚£ä¹ˆåˆå§‹åŒ–å˜é‡æ˜¯æœ€é‡è¦çš„ï¼ï¼æ‰€ä»¥å®šä¹‰äº†å˜é‡ä»¥å, ä¸€å®šè¦å®šä¹‰ <code>init = tf.initialize_all_variables()</code>.</p>
<p>åˆ°è¿™é‡Œå˜é‡è¿˜æ˜¯æ²¡æœ‰è¢«æ¿€æ´»ï¼Œéœ€è¦å†åœ¨ <code>sess</code> é‡Œ, <code>sess.run(init)</code> , æ¿€æ´» <code>init</code> è¿™ä¸€æ­¥.</p>
<p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># å¦‚æœå®šä¹‰ Variable, å°±ä¸€å®šè¦ initialize</span></span><br><span class="line"><span class="comment"># init = tf.initialize_all_variables() # tf é©¬ä¸Šå°±è¦åºŸå¼ƒè¿™ç§å†™æ³•</span></span><br><span class="line">init = tf.global_variables_initializer()  <span class="comment"># æ›¿æ¢æˆè¿™æ ·å°±å¥½</span></span><br><span class="line"> </span><br><span class="line"><span class="comment"># ä½¿ç”¨ Session</span></span><br><span class="line"><span class="keyword">with</span> tf.Session() <span class="keyword">as</span> sess:</span><br><span class="line">    sess.run(init)</span><br><span class="line">    print(sess.run(new_value))</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">3</span>):</span><br><span class="line">        sess.run(update) <span class="comment"># ç›¸å½“äºè¿è¡Œäº†ä¸€é tf.assign(state, new_value+100)ï¼Œ å› ä¸ºè¿™æ˜¯ update</span></span><br><span class="line">        print(sess.run(state))</span><br><span class="line">    print(<span class="string">"Sess Hello !"</span>)</span><br></pre></td></tr></table></figure></p>
<blockquote>
<p>æ³¨æ„ï¼šç›´æ¥ print(state) ä¸èµ·ä½œç”¨ï¼ï¼</p>
<p>ä¸€å®šè¦æŠŠ <code>sess</code> çš„æŒ‡é’ˆæŒ‡å‘ <code>state</code> å†è¿›è¡Œ <code>print</code> æ‰èƒ½å¾—åˆ°æƒ³è¦çš„ç»“æœï¼</p>
</blockquote>
<h2>Reference</h2>
<ul>
<li><a href="https://www.tensorflow.org/" target="_blank" rel="noopener">tensorflow.org</a></li>
<li><a href="https://morvanzhou.github.io/tutorials/machine-learning/tensorflow/" target="_blank" rel="noopener">è«çƒ¦Python</a></li>
<li><a href="https://github.com/MorvanZhou/Tensorflow-Tutorial" target="_blank" rel="noopener">æ–°ç‰ˆå¯è§†åŒ–æ•™å­¦ä»£ç </a></li>
</ul>

      
    </div>
	
    <!--
	
    -->
    <!--
    
      <footer class="article-footer">
      </footer>
    
    -->
  </div>
  
</article>



    
      <article id="post-tensorflow/tf-2.3-session" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <myh11 itemprop="name">
      <a class="article-title-index" href="/2017/08/28/tensorflow/tf-2.3-session/"><strong>Session ä¼šè¯æ§åˆ¶</strong></a>
      <small class=article-date-index>&nbsp; 2017-08-28</small>
      <!--<a>
      <div = post.date  </div>
      </a>-->
      <br>
      <br> <!-- blair add -->
    </myh11>
  


      </header>
    
    <div class="article-meta">
      <!--<a href="/2017/08/28/tensorflow/tf-2.3-session/" class="article-date">
  <time datetime="2017-08-28T08:07:21.000Z" itemprop="datePublished">2017-08-28</time>
</a>-->
      <!--
  <div class="article-category-index">
    <a class="article-category-index-link" href="/categories/tensorflow/">tensorflow</a>
  </div>

-->
      <!--
      
        <div class="article-comment-link-wrap">
          <a href="http://iequa.com/2017/08/28/tensorflow/tf-2.3-session/#disqus_thread" class="article-comment-link">Comments</a>
        </div>
      
      -->
    </div>
	
    <div class="article-entry" itemprop="articleBody">
      
        <p>Session æ˜¯ Tensorflow ä¸ºäº†æ§åˆ¶,å’Œè¾“å‡ºæ–‡ä»¶çš„æ‰§è¡Œè¯­å¥. è¿è¡Œ session.run() å¯ä»¥è·å¾—ä½ è¦å¾—çŸ¥çš„è¿ç®—ç»“æœ.</p>
<p>&lt;!-- more --&gt;</p>
<p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> tensorflow <span class="keyword">as</span> tf</span><br><span class="line"></span><br><span class="line">a = tf.constant([<span class="number">1.0</span>, <span class="number">2.0</span>], name=<span class="string">"a"</span>)</span><br><span class="line">b = tf.constant([<span class="number">2.0</span>, <span class="number">3.0</span>], name=<span class="string">"b"</span>) <span class="comment"># a, b å®šä¹‰ä¸º 2 ä¸ªå¸¸é‡ å‘é‡</span></span><br><span class="line"></span><br><span class="line">result = a + b</span><br><span class="line"></span><br><span class="line">sess = tf.Session()</span><br><span class="line"></span><br><span class="line">sess.run(result) <span class="comment"># array([ 3.,  5.], dtype=float32)</span></span><br></pre></td></tr></table></figure></p>
<blockquote>
<p>è¦è¾“å‡ºç›¸åŠ å¾—åˆ°çš„ç»“æœï¼Œä¸èƒ½ç®€å•åœ°ç›´æ¥è¾“å‡º resultï¼Œè€Œéœ€è¦å…ˆç”Ÿæˆä¸€ä¸ª Sessionï¼Œå¹¶é€šè¿‡è¿™ä¸ª Session æ¥è®¡ç®—ç»“æœã€‚</p>
</blockquote>
<p>ğŸŒ°ğŸŒ°ğŸŒ°</p>
<p>è¿™æ¬¡éœ€è¦åŠ è½½ Tensorflow ï¼Œç„¶åå»ºç«‹ä¸¤ä¸ª <code>matrix</code> , è¾“å‡ºä¸¤ä¸ª <code>matrix</code> çŸ©é˜µç›¸ä¹˜çš„ç»“æœã€‚</p>
<p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> tensorflow <span class="keyword">as</span> tf</span><br><span class="line"></span><br><span class="line"><span class="comment"># create two matrixes</span></span><br><span class="line"></span><br><span class="line">matrix1 = tf.constant([[<span class="number">3</span>,<span class="number">3</span>]])</span><br><span class="line">matrix2 = tf.constant([[<span class="number">2</span>],</span><br><span class="line">                       [<span class="number">2</span>]])</span><br><span class="line">product = tf.matmul(matrix1,matrix2)</span><br></pre></td></tr></table></figure></p>
<p>æˆ‘ä»¬ä¼šè¦ä½¿ç”¨ <code>Session</code> æ¥æ¿€æ´» <code>product</code> å¹¶å¾—åˆ°è®¡ç®—ç»“æœ. æœ‰ä¸¤ç§å½¢å¼ä½¿ç”¨ä¼šè¯æ§åˆ¶ <code>Session</code> ã€‚</p>
<p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># method 1</span></span><br><span class="line">sess = tf.Session()</span><br><span class="line">result = sess.run(product)</span><br><span class="line">print(result) <span class="comment"># [[12]]</span></span><br><span class="line">sess.close()</span><br><span class="line"><span class="comment"># [[12]]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># method 2</span></span><br><span class="line"><span class="keyword">with</span> tf.Session() <span class="keyword">as</span> sess:</span><br><span class="line">    result2 = sess.run(product)</span><br><span class="line">    print(result2)</span><br><span class="line"><span class="comment"># [[12]]</span></span><br></pre></td></tr></table></figure></p>
<p>ä»¥ä¸Šå°±æ˜¯æˆ‘ä»¬ä»Šå¤©æ‰€å­¦çš„ä¸¤ç§ <code>Session</code> æ‰“å¼€æ¨¡å¼ã€‚</p>
<p>è®©æˆ‘ä»¬å­¦ä¹ ä¸‹ä¸€èŠ‚ â€” Tensorflow ä¸­çš„ Variableã€‚</p>
<h2>Reference</h2>
<ul>
<li><a href="https://www.tensorflow.org/" target="_blank" rel="noopener">tensorflow.org</a></li>
<li><a href="https://morvanzhou.github.io/tutorials/machine-learning/tensorflow/" target="_blank" rel="noopener">è«çƒ¦Python</a></li>
<li><a href="https://github.com/MorvanZhou/Tensorflow-Tutorial" target="_blank" rel="noopener">æ–°ç‰ˆå¯è§†åŒ–æ•™å­¦ä»£ç </a></li>
</ul>

      
    </div>
	
    <!--
	
    -->
    <!--
    
      <footer class="article-footer">
      </footer>
    
    -->
  </div>
  
</article>



    
      <article id="post-tensorflow/tf-2.2-example" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <myh11 itemprop="name">
      <a class="article-title-index" href="/2017/08/27/tensorflow/tf-2.2-example/"><strong>Tensorflow å…¥é—¨ä¾‹å­</strong></a>
      <small class=article-date-index>&nbsp; 2017-08-27</small>
      <!--<a>
      <div = post.date  </div>
      </a>-->
      <br>
      <br> <!-- blair add -->
    </myh11>
  


      </header>
    
    <div class="article-meta">
      <!--<a href="/2017/08/27/tensorflow/tf-2.2-example/" class="article-date">
  <time datetime="2017-08-27T03:27:21.000Z" itemprop="datePublished">2017-08-27</time>
</a>-->
      <!--
  <div class="article-category-index">
    <a class="article-category-index-link" href="/categories/tensorflow/">tensorflow</a>
  </div>

-->
      <!--
      
        <div class="article-comment-link-wrap">
          <a href="http://iequa.com/2017/08/27/tensorflow/tf-2.2-example/#disqus_thread" class="article-comment-link">Comments</a>
        </div>
      
      -->
    </div>
	
    <div class="article-entry" itemprop="articleBody">
      
        <p>Tensorflow æ˜¯éå¸¸é‡è§†ç»“æ„çš„, æˆ‘ä»¬å»ºç«‹å¥½äº†ç¥ç»ç½‘ç»œçš„ç»“æ„, æ‰èƒ½å°†æ•°å­—æ”¾è¿›å», è¿è¡Œè¿™ä¸ªç»“æ„.</p>
<p>&lt;!-- more --&gt;</p>
<p>è¿™ä¸ªä¾‹å­ç®€å•çš„é˜è¿°äº† tensorflow å½“ä¸­å¦‚ä½•ç”¨ä»£ç æ¥è¿è¡Œæˆ‘ä»¬æ­å»ºçš„ç»“æ„.</p>
<h2>1. åˆ›å»ºæ•°æ®</h2>
<p>é¦–å…ˆ, æˆ‘ä»¬è¿™æ¬¡éœ€è¦åŠ è½½ tensorflow å’Œ numpy ä¸¤ä¸ªæ¨¡å—, å¹¶ä¸”ä½¿ç”¨ numpy æ¥åˆ›å»ºæˆ‘ä»¬çš„æ•°æ®.</p>
<p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> tensorflow <span class="keyword">as</span> tf</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"><span class="comment"># create data</span></span><br><span class="line">x_data = np.random.rand(<span class="number">100</span>).astype(np.float32)</span><br><span class="line">y_data = x_data*<span class="number">0.1</span> + <span class="number">0.3</span></span><br></pre></td></tr></table></figure></p>
<p>æ¥ç€, æˆ‘ä»¬ç”¨ <code>tf.Variable</code> æ¥åˆ›å»ºæè¿° <code>y</code> çš„å‚æ•°. æˆ‘ä»¬å¯ä»¥æŠŠ <code>y_data = x_data*0.1 + 0.3</code> æƒ³è±¡æˆ <code>y=Weights * x + biases</code>, ç„¶åç¥ç»ç½‘ç»œä¹Ÿå°±æ˜¯å­¦ç€æŠŠ Weights å˜æˆ 0.1, biases å˜æˆ 0.3.</p>
<h2>2. æ­å»ºæ¨¡å‹</h2>
<p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">Weights = tf.Variable(tf.random_uniform([<span class="number">1</span>], <span class="number">-1.0</span>, <span class="number">1.0</span>))</span><br><span class="line">biases = tf.Variable(tf.zeros([<span class="number">1</span>]))</span><br><span class="line"></span><br><span class="line">y = Weights*x_data + biases</span><br></pre></td></tr></table></figure></p>
<h2>3. è®¡ç®—è¯¯å·®</h2>
<p>æ¥ç€å°±æ˜¯è®¡ç®— <code>y</code> å’Œ <code>y_data</code> çš„è¯¯å·®:</p>
<p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">loss = tf.reduce_mean(tf.square(y-y_data))</span><br></pre></td></tr></table></figure></p>
<h2>4. ä¼ æ’­è¯¯å·®</h2>
<p>åå‘ä¼ é€’è¯¯å·®çš„å·¥ä½œå°±æ•™ç»™ <code>optimizer</code> äº†, æˆ‘ä»¬ä½¿ç”¨çš„è¯¯å·®ä¼ é€’æ–¹æ³•æ˜¯æ¢¯åº¦ä¸‹é™æ³•: Gradient Descent</p>
<p>ç„¶åæˆ‘ä»¬ä½¿ç”¨ <code>optimizer</code> æ¥è¿›è¡Œå‚æ•°çš„æ›´æ–°.</p>
<p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">optimizer = tf.train.GradientDescentOptimizer(<span class="number">0.5</span>)</span><br><span class="line">train = optimizer.minimize(loss)</span><br></pre></td></tr></table></figure></p>
<h2>5. è®­ç»ƒ</h2>
<p>åˆ°ç›®å‰ä¸ºæ­¢, æˆ‘ä»¬åªæ˜¯å»ºç«‹äº†ç¥ç»ç½‘ç»œçš„ç»“æ„, è¿˜æ²¡æœ‰ä½¿ç”¨è¿™ä¸ªç»“æ„.</p>
<p>åœ¨ä½¿ç”¨è¿™ä¸ªç»“æ„ä¹‹å‰, æˆ‘ä»¬å¿…é¡»å…ˆåˆå§‹åŒ–æ‰€æœ‰ä¹‹å‰å®šä¹‰çš„ <code>Variable</code>,  æ‰€ä»¥è¿™ä¸€æ­¥æ˜¯å¾ˆé‡è¦çš„!</p>
<p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">init = tf.global_variables_initializer()  <span class="comment"># æ›¿æ¢æˆè¿™æ ·å°±å¥½</span></span><br></pre></td></tr></table></figure></p>
<p>æ¥ç€,æˆ‘ä»¬å†åˆ›å»ºä¼šè¯ <code>Session</code>. æˆ‘ä»¬ä¼šåœ¨ä¸‹ä¸€èŠ‚ä¸­è¯¦ç»†è®²è§£ Session. æˆ‘ä»¬ç”¨ <code>Session</code> æ¥æ‰§è¡Œ <code>init</code> åˆå§‹åŒ–æ­¥éª¤. å¹¶ä¸”, ç”¨ <code>Session</code> æ¥ <code>run</code> æ¯ä¸€æ¬¡ training çš„æ•°æ®. é€æ­¥æå‡ç¥ç»ç½‘ç»œçš„é¢„æµ‹å‡†ç¡®æ€§.</p>
<p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">sess = tf.Session()</span><br><span class="line">sess.run(init)          <span class="comment"># Very important</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> step <span class="keyword">in</span> range(<span class="number">201</span>):</span><br><span class="line">    sess.run(train)</span><br><span class="line">    <span class="keyword">if</span> step % <span class="number">20</span> == <span class="number">0</span>:</span><br><span class="line">        print(step, sess.run(Weights), sess.run(biases))</span><br></pre></td></tr></table></figure></p>
<h2>6. Reference</h2>
<ul>
<li><a href="https://www.tensorflow.org/" target="_blank" rel="noopener">tensorflow.org</a></li>
<li><a href="https://morvanzhou.github.io/tutorials/machine-learning/tensorflow/" target="_blank" rel="noopener">è«çƒ¦Python</a></li>
</ul>

      
    </div>
	
    <!--
	
    -->
    <!--
    
      <footer class="article-footer">
      </footer>
    
    -->
  </div>
  
</article>



    
      <article id="post-tensorflow/tf-2.1-structure" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <myh11 itemprop="name">
      <a class="article-title-index" href="/2017/08/25/tensorflow/tf-2.1-structure/"><strong>Tensorflow å¤„ç†ç»“æ„</strong></a>
      <small class=article-date-index>&nbsp; 2017-08-25</small>
      <!--<a>
      <div = post.date  </div>
      </a>-->
      <br>
      <br> <!-- blair add -->
    </myh11>
  


      </header>
    
    <div class="article-meta">
      <!--<a href="/2017/08/25/tensorflow/tf-2.1-structure/" class="article-date">
  <time datetime="2017-08-25T03:17:21.000Z" itemprop="datePublished">2017-08-25</time>
</a>-->
      <!--
  <div class="article-category-index">
    <a class="article-category-index-link" href="/categories/tensorflow/">tensorflow</a>
  </div>

-->
      <!--
      
        <div class="article-comment-link-wrap">
          <a href="http://iequa.com/2017/08/25/tensorflow/tf-2.1-structure/#disqus_thread" class="article-comment-link">Comments</a>
        </div>
      
      -->
    </div>
	
    <div class="article-entry" itemprop="articleBody">
      
        <p>Tensorflow é¦–å…ˆè¦å®šä¹‰ç¥ç»ç½‘ç»œçš„ç»“æ„, ç„¶åå†æŠŠæ•°æ®æ”¾å…¥ç»“æ„å½“ä¸­å»è¿ç®— å’Œ training.</p>
<p>&lt;!-- more --&gt;</p>
<h2>è®¡ç®—å›¾</h2>
<p>&lt;img src=&quot;/images/tensorflow/tf-1-why.gif&quot; width=&quot;400&quot; /&gt;</p>
<p>å› ä¸º TensorFlow æ˜¯é‡‡ç”¨æ•°æ®æµå›¾ï¼ˆ<strong>dataã€€flowã€€graphs</strong>ï¼‰æ¥è®¡ç®—, æ‰€ä»¥é¦–å…ˆæˆ‘ä»¬å¾—åˆ›å»ºä¸€ä¸ª<strong>æ•°æ®æµå›¾</strong>, ç„¶åå†å°†æˆ‘ä»¬çš„æ•°æ®ï¼ˆæ•°æ®ä»¥å¼ é‡(<strong>tensor</strong>)çš„å½¢å¼å­˜åœ¨ï¼‰æ”¾åœ¨æ•°æ®æµå›¾ä¸­è®¡ç®—.</p>
<blockquote>
<ul>
<li>Nodes åœ¨å›¾ä¸­è¡¨ç¤ºæ•°å­¦æ“ä½œ</li>
<li>Edges åœ¨å›¾ä¸­åˆ™è¡¨ç¤ºåœ¨èŠ‚ç‚¹é—´ç›¸äº’è”ç³»çš„å¤šç»´æ•°æ®æ•°ç»„ï¼Œå³å¼ é‡ï¼ˆtensorï¼‰</li>
</ul>
</blockquote>
<p>è®­ç»ƒæ¨¡å‹æ—¶ <strong>tensor</strong> ä¼šä¸æ–­çš„ä»æ•°æ®æµå›¾ä¸­çš„ä¸€ä¸ªèŠ‚ç‚¹ <strong>flow</strong> åˆ°å¦ä¸€èŠ‚ç‚¹, è¿™å°±æ˜¯ TensorFlow åå­—çš„ç”±æ¥.</p>
<h2>Tensor å¼ é‡æ„ä¹‰</h2>
<p><strong>å¼ é‡ï¼ˆTensor)</strong>: å¼ é‡æœ‰å¤šç§.</p>
<ul>
<li>é›¶é˜¶å¼ é‡ä¸º çº¯é‡æˆ–æ ‡é‡ (scalar) ä¹Ÿå°±æ˜¯ä¸€ä¸ªæ•°å€¼. æ¯”å¦‚ <code>[1]</code></li>
<li>ä¸€é˜¶å¼ é‡ä¸º å‘é‡ (vector), æ¯”å¦‚ ä¸€ç»´çš„ <code>[1, 2, 3]</code></li>
<li>äºŒé˜¶å¼ é‡ä¸º çŸ©é˜µ (matrix), æ¯”å¦‚ äºŒç»´çš„ <code>[[1, 2, 3],[4, 5, 6],[7, 8, 9]]</code></li>
</ul>
<blockquote>
<p>ä»¥æ­¤ç±»æ¨, è¿˜æœ‰ ä¸‰é˜¶ ä¸‰ç»´çš„ â€¦</p>
</blockquote>
<h2>Reference</h2>
<ul>
<li><a href="https://www.tensorflow.org/" target="_blank" rel="noopener">tensorflow.org</a></li>
</ul>

      
    </div>
	
    <!--
	
    -->
    <!--
    
      <footer class="article-footer">
      </footer>
    
    -->
  </div>
  
</article>



    
      <article id="post-ml/naive-bayes-2" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <myh11 itemprop="name">
      <a class="article-title-index" href="/2017/08/23/ml/naive-bayes-2/"><strong>Naive Bayes * æ–‡æœ¬åˆ†ç±»</strong></a>
      <small class=article-date-index>&nbsp; 2017-08-23</small>
      <!--<a>
      <div = post.date  </div>
      </a>-->
      <br>
      <br> <!-- blair add -->
    </myh11>
  


      </header>
    
    <div class="article-meta">
      <!--<a href="/2017/08/23/ml/naive-bayes-2/" class="article-date">
  <time datetime="2017-08-22T23:08:21.000Z" itemprop="datePublished">2017-08-23</time>
</a>-->
      <!--
  <div class="article-category-index">
    <a class="article-category-index-link" href="/categories/machine-learning/">machine-learning</a>
  </div>

-->
      <!--
      
        <div class="article-comment-link-wrap">
          <a href="http://iequa.com/2017/08/23/ml/naive-bayes-2/#disqus_thread" class="article-comment-link">Comments</a>
        </div>
      
      -->
    </div>
	
    <div class="article-entry" itemprop="articleBody">
      
        <p>æœ´ç´ è´å¶æ–¯ï¼Œé€‚ç”¨äºæ–°é—»åˆ†ç±»é—®é¢˜</p>
<p>$$
p(x)p(y|x) = p(y)p(x|y)
$$</p>
<p>&lt;!-- more --&gt;</p>
<h2>1. è´å¶æ–¯ç†è®ºç®€å•å›é¡¾</h2>
<p>åœ¨æˆ‘ä»¬æœ‰ä¸€å¤§å †æ ·æœ¬ï¼ˆåŒ…å«ç‰¹å¾å’Œç±»åˆ«ï¼‰çš„æ—¶å€™ï¼Œæˆ‘ä»¬éå¸¸å®¹æ˜“é€šè¿‡ç»Ÿè®¡å¾—åˆ°  $p(ç‰¹å¾|ç±»åˆ«)$.
å¤§å®¶åˆéƒ½å¾ˆç†Ÿæ‚‰ä¸‹è¿°å…¬å¼ï¼š</p>
<p>$$
p(x)p(y|x) = p(y)p(x|y)
$$</p>
<p>æ‰€ä»¥åšä¸€ä¸ªå°å°çš„å˜æ¢</p>
<p>$$
p(ç‰¹å¾)p(ç±»åˆ«|ç‰¹å¾) = p(ç±»åˆ«)p(ç‰¹å¾|ç±»åˆ«)
$$</p>
<p>$$
p(ç±»åˆ«|ç‰¹å¾) = \frac{p(ç±»åˆ«)p(ç‰¹å¾|ç±»åˆ«)}{p(ç‰¹å¾)}
$$</p>
<h2>2. ç‹¬ç«‹å‡è®¾</h2>
<p>çœ‹èµ·æ¥å¾ˆç®€å•ï¼Œä½†å®é™…ä¸Šï¼Œä½ çš„ç‰¹å¾å¯èƒ½æ˜¯å¾ˆå¤šç»´çš„</p>
<p>$$
p(features|class) = p({f_0, f_1, \ldots ,f_n}|c)
$$</p>
<p>å°±ç®—æ˜¯2ä¸ªç»´åº¦å§ï¼Œå¯ä»¥ç®€å•å†™æˆ</p>
<p>$$
p({f_0, f_1}|c) = p(f_1|c, f_0)p(f_0|c)
$$</p>
<p>åŠ ä¸€ä¸ªç‰›é€¼çš„å‡è®¾ï¼šç‰¹å¾ä¹‹é—´æ˜¯ç‹¬ç«‹çš„</p>
<p>$$
p({f_0, f_1}|c) = p(f_1|c)p(f_0|c)
$$</p>
<p>å…¶å®ä¹Ÿå°±æ˜¯ï¼š</p>
<p>$$
p({f_0, f_1, \ldots, f_n}|c) = \Pi^n_i p(f_i|c)
$$</p>
<h2>3. è´å¶æ–¯åˆ†ç±»å™¨</h2>
<p>å…¶å®æˆ‘ä»¬å°±æ˜¯å¯¹æ¯ä¸ªç±»åˆ«è®¡ç®—ä¸€ä¸ªæ¦‚ç‡ $p(ci)$ ï¼Œç„¶åå†è®¡ç®—æ‰€æœ‰ç‰¹å¾çš„æ¡ä»¶æ¦‚ç‡ $p(f_j|c_i)$ ï¼Œé‚£ä¹ˆåˆ†ç±»çš„æ—¶å€™æˆ‘ä»¬å°±æ˜¯ä¾æ®è´å¶æ–¯æ‰¾ä¸€ä¸ªæœ€å¯èƒ½çš„ç±»åˆ«ï¼š</p>
<p>$$
p(class_i|{f_0, f_1, \ldots, f_n})= \frac{p(class_i)}{p({f_0, f_1, \ldots, f_n})} \Pi^n_j p(f_j|c_i)
$$</p>
<h2>4. æ–‡æœ¬åˆ†ç±»é—®é¢˜</h2>

      
    </div>
	
    <!--
	
    -->
    <!--
    
      <footer class="article-footer">
      </footer>
    
    -->
  </div>
  
</article>



    
      <article id="post-tensorflow/tf-1.1-why" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <myh11 itemprop="name">
      <a class="article-title-index" href="/2017/08/22/tensorflow/tf-1.1-why/"><strong>TensorFlow Why?</strong></a>
      <small class=article-date-index>&nbsp; 2017-08-22</small>
      <!--<a>
      <div = post.date  </div>
      </a>-->
      <br>
      <br> <!-- blair add -->
    </myh11>
  


      </header>
    
    <div class="article-meta">
      <!--<a href="/2017/08/22/tensorflow/tf-1.1-why/" class="article-date">
  <time datetime="2017-08-22T05:17:21.000Z" itemprop="datePublished">2017-08-22</time>
</a>-->
      <!--
  <div class="article-category-index">
    <a class="article-category-index-link" href="/categories/tensorflow/">tensorflow</a>
  </div>

-->
      <!--
      
        <div class="article-comment-link-wrap">
          <a href="http://iequa.com/2017/08/22/tensorflow/tf-1.1-why/#disqus_thread" class="article-comment-link">Comments</a>
        </div>
      
      -->
    </div>
	
    <div class="article-entry" itemprop="articleBody">
      
        <p>2015.10 å¼€æºçš„ TensorFlow æ˜¯ç”± Google brain çš„å·¥ç¨‹å¸ˆå¼€å‘å‡ºæ¥ï¼Œç”¨äºæœºå™¨å­¦ä¹ å’Œç¥ç»ç½‘ç»œæ–¹é¢çš„ç ”ç©¶</p>
<p>&lt;!-- more --&gt;</p>
<p>TensorFlow æ˜¯ä¸€æ¬¾ç¥ç»ç½‘ç»œçš„ Python å¤–éƒ¨çš„ç»“æ„åŒ…, ä¹Ÿæ˜¯ä¸€ä¸ªé‡‡ç”¨æ•°æ®æµå›¾æ¥è¿›è¡Œæ•°å€¼è®¡ç®—çš„å¼€æºè½¯ä»¶åº“.</p>
<p><img src="/images/tensorflow/tf-1-why.gif" alt="TensorFlow èŠ‚ç‚¹è¡¨ç¤ºæŸç§æŠ½è±¡çš„è®¡ç®—ï¼Œè¾¹è¡¨ç¤ºèŠ‚ç‚¹ä¹‹é—´ç›¸äº’è”ç³»çš„å¼ é‡"></p>
<h2>1. TensorFlow Why</h2>
<p>TensorFlow æ“…é•¿çš„ä»»åŠ¡å°±æ˜¯è®­ç»ƒæ·±åº¦ç¥ç»ç½‘ç»œ. ä½¿ç”¨å®ƒæˆ‘ä»¬å°±å¯ä»¥å¤§å¤§é™ä½æ·±åº¦å­¦ä¹ çš„å¼€å‘æˆæœ¬å’Œå¼€å‘éš¾åº¦;</p>
<p>TensorFlow æ¶æ„çµæ´»ï¼Œæ”¯æŒå„ç§å¼‚æ„çš„å¹³å°ï¼Œæ”¯æŒå¤šCPU/GPUï¼Œ èƒ½å¤Ÿæ”¯æŒå„ç§ç½‘ç»œæ¨¡å‹ï¼Œå…·æœ‰è‰¯å¥½çš„é€šç”¨æ€§;</p>
<p>TensorFlow ç”¨æˆ·å¯ä»¥æ–¹ä¾¿åœ°ç”¨å®ƒè®¾è®¡ <strong>Neural Network</strong> ç»“æ„ï¼Œè€Œä¸å¿…äº²è‡ªå†™ C++æˆ– CUDA ä»£ç ã€‚æ”¯æŒè‡ªåŠ¨æ±‚å¯¼ï¼Œç”¨æˆ·ä¸éœ€è¦å†é€šè¿‡åå‘ä¼ æ’­æ±‚è§£æ¢¯åº¦ã€‚</p>
<h2>2. TF.Learn å’Œ TF.Slim ä¸Šå±‚ç»„ä»¶</h2>
<p>TensorFlow å†…ç½®çš„ TF.Learn å’Œ TF.Slim ç­‰ä¸Šå±‚ç»„ä»¶å¯ä»¥å¸®åŠ©å¿«é€Ÿåœ°è®¾è®¡æ–°ç½‘ç»œï¼Œå¹¶ä¸”å…¼å®¹ Scikit-learn estimator æ¥å£ï¼Œå¯ä»¥æ–¹ä¾¿åœ°å®ç° evaluateã€grid searchã€cross validation ç­‰åŠŸèƒ½ã€‚</p>
<blockquote>
<p>åŒæ—¶ TensorFlow ä¸åªå±€é™äºç¥ç»ç½‘ç»œï¼Œå…¶æ•°æ®æµå¼å›¾æ”¯æŒéå¸¸è‡ªç”±çš„ç®—æ³•è¡¨è¾¾ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥è½»æ¾å®ç°æ·±åº¦å­¦ä¹ ä»¥å¤–çš„æœºå™¨å­¦ä¹ ç®—æ³•ã€‚</p>
</blockquote>
<h2>3. DeepLearning Framework</h2>
<p><img src="https://static.leiphone.com/uploads/new/article/740_740/201702/58ad62e781969.png?imageMogr2/format/jpg/quality/90" alt=""></p>
<h2>Reference</h2>
<ul>
<li><a href="https://www.tensorflow.org/" target="_blank" rel="noopener">tensorflow.org</a></li>
<li><a href="https://www.tensorflow.org/get_started/" target="_blank" rel="noopener">tensorflow.org get_started</a></li>
<li><a href="https://www.leiphone.com/news/201702/T5e31Y2ZpeG1ZtaN.html" target="_blank" rel="noopener">TensorFlow å’Œ Caffeã€MXNetã€Kerasç­‰å…¶ä»–æ·±åº¦å­¦ä¹ æ¡†æ¶çš„å¯¹æ¯”</a></li>
</ul>

      
    </div>
	
    <!--
	
    -->
    <!--
    
      <footer class="article-footer">
      </footer>
    
    -->
  </div>
  
</article>



    
      <article id="post-chatbot/chatbot-research6" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <myh11 itemprop="name">
      <a class="article-title-index" href="/2017/08/16/chatbot/chatbot-research6/"><strong>Chatbot Research 6 - æ›´å¤šè®ºæ–‡ (æ„Ÿè°¢ PaperWeekly)</strong></a>
      <small class=article-date-index>&nbsp; 2017-08-16</small>
      <!--<a>
      <div = post.date  </div>
      </a>-->
      <br>
      <br> <!-- blair add -->
    </myh11>
  


      </header>
    
    <div class="article-meta">
      <!--<a href="/2017/08/16/chatbot/chatbot-research6/" class="article-date">
  <time datetime="2017-08-16T06:00:21.000Z" itemprop="datePublished">2017-08-16</time>
</a>-->
      <!--
  <div class="article-category-index">
    <a class="article-category-index-link" href="/categories/chatbot/">chatbot</a>
  </div>

-->
      <!--
      
        <div class="article-comment-link-wrap">
          <a href="http://iequa.com/2017/08/16/chatbot/chatbot-research6/#disqus_thread" class="article-comment-link">Comments</a>
        </div>
      
      -->
    </div>
	
    <div class="article-entry" itemprop="articleBody">
      
        <p>Chatbot æ›´å¤š Paper è®ºæ–‡å’Œå‚è€ƒèµ„æ–™ (æ„Ÿè°¢ PaperWeekly)</p>
<p>&lt;!-- more --&gt;</p>
<h2>Paper 1</h2>
<p>ã€ŠA Neural Conversational Modelã€‹</p>
<p>ä»£ç : https://github.com/Conchylicultor/DeepQA  2128 star</p>
<ul>
<li>ä½œè€…: æ¥è‡ª Google Brainï¼Œæ¯•ä¸šäº UC Berkeley çš„ Oriol Vinyalsåšå£«</li>
<li>å¯¹æ¯” cleverbot (ç¬¬äºŒä»£åŸºäºæ£€ç´¢çš„èŠå¤©æœºå™¨äºº)ï¼Œéƒ¨åˆ†å›ç­” æ›´æ™ºèƒ½ã€‚</li>
<li>å¦‚ä½•å®¢è§‚åœ°è¯„ä»·ç”Ÿæˆçš„æ•ˆæœ? æœ‰ä¸€äº›é—®é¢˜æ²¡æœ‰æ ‡å‡†ç­”æ¡ˆ æ¥è¯´ï¼Œè‡ªåŠ¨è¯„ä»· VS ç”¨æˆ·è¯„ä»·</li>
</ul>
<blockquote>
<p>ä½œè€…å¯¹ä¸€äº›è¯„ä¼°æ–¹æ³•æå‡ºäº†ä¸€äº›è‡ªå·±çš„æ€è€ƒæ–¹å¼</p>
</blockquote>
<p>DeepQA</p>
<ol>
<li>chatbot è®­ç»ƒçš„éƒ¨åˆ†</li>
<li>chatbot_website æœåŠ¡çš„éƒ¨åˆ†ï¼Œç½‘é¡µç«¯</li>
</ol>
<p><a href="https://github.com/Conchylicultor/DeepQA/tree/master/chatbot" target="_blank" rel="noopener">DeepQA/chatbot/</a> è¿™å‡ ä¸ªæ–‡ä»¶æ¯”è¾ƒé‡è¦</p>
<p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> chatbot.corpus.cornelldata <span class="keyword">import</span> CornellData</span><br><span class="line"><span class="keyword">from</span> chatbot.corpus.opensubsdata <span class="keyword">import</span> OpensubsData</span><br><span class="line"><span class="keyword">from</span> chatbot.corpus.scotusdata <span class="keyword">import</span> ScotusData</span><br><span class="line"><span class="keyword">from</span> chatbot.corpus.ubuntudata <span class="keyword">import</span> UbuntuData</span><br><span class="line"><span class="keyword">from</span> chatbot.corpus.lightweightdata <span class="keyword">import</span> LightweightData</span><br></pre></td></tr></table></figure></p>
<p>è¯­æ–™å¤ªå¤§çš„æƒ…å†µä¸‹ï¼Œåšä¸€äº›é‡‡æ ·æˆ–è€…å±‚æ¬¡åŒ–çš„ softmax å¯è¡Œ</p>
<p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> <span class="number">0</span> &lt; self.args.softmaxSamples &lt; self.textData.getVocabularySize():</span><br><span class="line">    outputProjection = ProjectionOp(</span><br><span class="line">        (self.textData.getVocabularySize(), self.args.hiddenSize),</span><br><span class="line">        scope=<span class="string">'softmax_projection'</span>,</span><br><span class="line">        dtype=self.dtype</span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">sampledSoftmax</span><span class="params">(labels, inputs)</span>:</span></span><br></pre></td></tr></table></figure></p>
<h2>Paper 2</h2>
<p>ã€ŠA Diversity-Promoting Objective Function for Neural Conversation Modelsã€‹</p>
<blockquote>
<ul>
<li>
<p>ä½œè€…ï¼š <a href="https://nlp.stanford.edu/~bdlijiwei/Myself.html" target="_blank" rel="noopener">Jiwei Li</a>ï¼Œ <a href="https://github.com/jiweil" target="_blank" rel="noopener">Jiwei Li's Github</a></p>
</li>
<li>
<p>å…³äºã€ŠA Persona-Based Neural Conversation Modelã€‹çš„pre-paper  Seq2seq å®¹æ˜“äº§å‡ºâ€å‘µå‘µâ€ï¼Œâ€éƒ½å¯ä»¥â€ï¼Œâ€æˆ‘ä¸çŸ¥é“â€è¿™ç§ safe ä½†æ— æ„ä¹‰çš„å›ç­”</p>
</li>
<li>
<p>NLG é—®é¢˜ï¼Œå¸¸ä½¿ç”¨ <strong>MLE</strong> ä½œä¸ºç›®æ ‡å‡½æ•°ï¼Œäº§å‡ºçš„ç»“æœé€šç•…ï¼Œä½† diversity å·®ï¼Œå¯è€ƒè™‘ decoder äº§å‡º n-best, å† rank</p>
</li>
<li>
<p>æå‡º Maximum Mutual Information(MMI) ä½œä¸ºç›®æ ‡å‡½æ•°ï¼Œ æœ‰ MMI-antiLM å’ŒMMI-bidi 2ç§</p>
</li>
</ul>
</blockquote>
<h2>Paper 3</h2>
<p>ã€ŠA Persona-Based Neural Conversation Modelã€‹</p>
<blockquote>
<ul>
<li>
<p>Speaker Model å’Œ Speaker-Addressee Model</p>
</li>
<li>
<p>ä½œè€…ï¼š <a href="https://nlp.stanford.edu/~bdlijiwei/Myself.html" target="_blank" rel="noopener">Jiwei Li</a>ï¼Œ <a href="https://github.com/jiweil" target="_blank" rel="noopener">Jiwei Li's Github</a></p>
</li>
<li>
<p>ä»£ç ï¼š https://github.com/jiweil/Neural-Dialogue-Generation</p>
</li>
<li>
<p>è§£å†³å¤šè½®å¯¹è¯å›ç­”ä¸ä¸€è‡´é—®é¢˜</p>
</li>
<li>
<p>Model ä¸­èå…¥ user identity (æ¯”å¦‚èƒŒæ™¯ä¿¡æ¯ã€ç”¨æˆ·ç”»åƒï¼Œå¹´é¾„ç­‰ä¿¡æ¯)ï¼Œæ„å»ºå‡ºä¸ªæ€§åŒ–çš„ seq2seq æ¨¡å‹ï¼Œä¸ºä¸åŒçš„ userï¼Œ ä»¥åŠ åŒä¸€ä¸ªuser å¯¹ä¸åŒçš„å¯¹è±¡å¯¹è¯ç”Ÿæˆä¸åŒé£æ ¼çš„ response</p>
</li>
</ul>
</blockquote>
<p>&lt;img src=&quot;/images/chatbot/bot_A3.jpg&quot; width=&quot;800&quot; /&gt;</p>
<h2>Paper 4</h2>
<p>ã€ŠA Hierarchical Latent Variable Encoder-Decoder Model for Generating Dialoguesã€‹</p>
<blockquote>
<ul>
<li>ä»£ç : https://github.com/julianser/hed-dlg-truncated</li>
<li>ä½œè€…: æ¥è‡ªè’™ç‰¹åˆ©å°”å¤§å­¦å’ŒMaluubaå…¬å¸</li>
<li>æ„åœ¨è§£å†³è¯­è¨€æ¨¡å‹ç”Ÿæˆéƒ¨åˆ†å­˜åœ¨çš„é—®é¢˜</li>
<li>æ•´ä¸ª seq2seq æ¡†æ¶ä¸­ decoderç”Ÿæˆéƒ¨åˆ†çš„é—®é¢˜ï¼Œä¸ä»…æ˜¯ boté¢†åŸŸå¯¹è¯ç”Ÿæˆçš„é—®é¢˜ï¼Œéƒ½å¯ä»¥å°è¯•ç”¨è¿™ä¸ªæ–¹å¼ã€‚</li>
</ul>
</blockquote>
<p>&lt;img src=&quot;/images/chatbot/bot_A4.jpg&quot; width=&quot;700&quot; /&gt;</p>
<h2>Paper 5</h2>
<p>æ›´å¤šè®ºæ–‡å’Œå‚è€ƒèµ„æ–™(æ„Ÿè°¢PaperWeekly)</p>
<blockquote>
<ul>
<li>
<p>ã€ŠEnd-to-end LSTM-based dialog control optimized with supervised and reinforcement learningã€‹<br>
http://rsarxiv.github.io/2016/07/17/End-to-end-LSTM-based-dialog-control-optimized-with-supervised-and-reinforcement-learning-PaperWeekly/</p>
</li>
<li>
<p>ã€ŠA Network-based End-to-End Trainable Task-oriented Dialogue Systemã€‹<br>
http://rsarxiv.github.io/2016/07/12/A-Network-based-End-to-End-Trainable-Task-oriented-Dialogue-System-PaperWeekly</p>
</li>
<li>
<p>ã€ŠA Neural Network Approach to Context-Sensitive Generation of Conversational Responsesã€‹
http://rsarxiv.github.io/2016/07/15/A-Neural-Network-Approach-to-Context-Sensitive-Generation-of-Conversational-Responses-PaperWeekly/</p>
</li>
<li>
<p>Sequence to Backward and Forward Sequences: A Content-Introducing Approach to Generative Short-Text Conversation
http://rsarxiv.github.io/2016/07/09/Sequence-to-Backward-and-Forward-Sequences-A-Content-Introducing-Approach-to-Generative-Short-Text-Conversation-PaperWeekly/</p>
</li>
</ul>
</blockquote>
<h2>Reference</h2>
<ul>
<li><a href="https://github.com/Conchylicultor/DeepQA" target="_blank" rel="noopener">2015 DeepQA</a></li>
<li><a href="https://www.jianshu.com/p/4fb194d143cf" target="_blank" rel="noopener">èŠå¤©æœºå™¨äººæ·±åº¦å­¦ä¹ åº”ç”¨-part1ï¼šå¼•è¨€</a></li>
<li><a href="https://github.com/dennybritz/chatbot-retrieval/" target="_blank" rel="noopener">dennybritz/chatbot-retrieval</a></li>
<li>æ›´å¤šè®ºæ–‡å’Œå‚è€ƒèµ„æ–™(æ„Ÿè°¢PaperWeekly)</li>
</ul>

      
    </div>
	
    <!--
	
    -->
    <!--
    
      <footer class="article-footer">
      </footer>
    
    -->
  </div>
  
</article>



    
      <article id="post-chatbot/chatbot-research5" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <myh11 itemprop="name">
      <a class="article-title-index" href="/2017/08/15/chatbot/chatbot-research5/"><strong>Chatbot Research 5 - åŸºäºæ·±åº¦å­¦ä¹ çš„æ£€ç´¢èŠå¤©æœºå™¨äºº</strong></a>
      <small class=article-date-index>&nbsp; 2017-08-15</small>
      <!--<a>
      <div = post.date  </div>
      </a>-->
      <br>
      <br> <!-- blair add -->
    </myh11>
  


      </header>
    
    <div class="article-meta">
      <!--<a href="/2017/08/15/chatbot/chatbot-research5/" class="article-date">
  <time datetime="2017-08-15T06:00:21.000Z" itemprop="datePublished">2017-08-15</time>
</a>-->
      <!--
  <div class="article-category-index">
    <a class="article-category-index-link" href="/categories/chatbot/">chatbot</a>
  </div>

-->
      <!--
      
        <div class="article-comment-link-wrap">
          <a href="http://iequa.com/2017/08/15/chatbot/chatbot-research5/#disqus_thread" class="article-comment-link">Comments</a>
        </div>
      
      -->
    </div>
	
    <div class="article-entry" itemprop="articleBody">
      
        <p>ä»‹ç»åŸºäºæ£€ç´¢å¼æœºå™¨äººã€‚æ£€ç´¢å¼æ¶æ„æœ‰é¢„å®šå¥½çš„è¯­æ–™ç­”å¤åº“ã€‚</p>
<p>æ£€ç´¢å¼æ¨¡å‹çš„è¾“å…¥æ˜¯ä¸Šä¸‹æ–‡æ½œåœ¨çš„ç­”å¤ã€‚æ¨¡å‹è¾“å‡ºå¯¹è¿™äº›ç­”å¤çš„æ‰“åˆ†ï¼Œå¯ä»¥é€‰æ‹©æœ€é«˜åˆ†çš„ç­”æ¡ˆä½œä¸ºå›å¤ã€‚</p>
<p>&lt;!-- more --&gt;</p>
<blockquote>
<p>æ—¢ç„¶ç”Ÿæˆå¼çš„æ¨¡å‹æ›´å¼¹æ€§ï¼Œä¹Ÿä¸éœ€è¦é¢„å®šä¹‰çš„è¯­æ–™ï¼Œä¸ºä½•ä¸é€‰æ‹©å®ƒå‘¢ï¼Ÿ</p>
<p>ç”Ÿæˆå¼æ¨¡å‹çš„é—®é¢˜å°±æ˜¯å®é™…ä½¿ç”¨èµ·æ¥å¹¶ä¸èƒ½å¥½å¥½å·¥ä½œï¼Œè‡³å°‘ç°åœ¨æ˜¯ã€‚å› ä¸ºç­”å¤æ¯”è¾ƒè‡ªç”±ï¼Œå®¹æ˜“çŠ¯è¯­æ³•é”™è¯¯å’Œä¸ç›¸å…³ã€ä¸åˆé€»è¾‘çš„ç­”æ¡ˆï¼Œå¹¶ä¸”éœ€è¦å¤§é‡çš„æ•°æ®ä¸”å¾ˆéš¾åšä¼˜åŒ–ã€‚</p>
<p>å¤§é‡çš„ç”Ÿäº§ç³»ç»Ÿä¸Šè¿˜æ˜¯é‡‡ç”¨ æ£€ç´¢æ¨¡å‹ æˆ–è€… <code>æ£€ç´¢æ¨¡å‹</code> å’Œ <code>ç”Ÿæˆæ¨¡å‹</code> ç»“åˆçš„æ–¹å¼ã€‚</p>
<ul>
<li>ä¾‹å¦‚ google çš„ <a href="https://arxiv.org/abs/1606.04870" target="_blank" rel="noopener">smart reply</a>ã€‚</li>
</ul>
<p>ç”Ÿæˆæ¨¡å‹æ˜¯ç ”ç©¶çš„çƒ­é—¨é¢†åŸŸï¼Œä½†æ˜¯æˆ‘ä»¬è¿˜æ²¡åˆ°åº”ç”¨å®ƒçš„ç¨‹åº¦ã€‚å¦‚æœä½ æƒ³è¦åšä¸€ä¸ªèŠå¤©æœºå™¨äººï¼Œæœ€å¥½è¿˜æ˜¯é€‰ç”¨æ£€ç´¢å¼æ¨¡å‹</p>
</blockquote>
<p><strong>æ›´èªæ˜çš„èŠå¤©æœºå™¨äºº ï¼š</strong></p>
<ol>
<li>ç”Ÿæˆå¼æ¨¡å‹ VS æ£€ç´¢åŒ¹é…æ¨¡å‹</li>
<li>Chatterbotçš„è¿›åŒ–: æ·±åº¦å­¦ä¹ æé«˜æ™ºèƒ½åº¦</li>
</ol>
<p><strong>æ¨¡å‹æ„å»º ï¼š</strong></p>
<ol>
<li>é—®é¢˜çš„åˆ†æä¸è½¬åŒ–</li>
<li>æ•°æ®é›†ä¸æ ·æœ¬æ„é€ æ–¹æ³•</li>
<li>ç½‘ç»œç»“æ„çš„æ„å»º</li>
<li>æ¨¡å‹çš„è¯„ä¼°</li>
<li>ä»£ç å®ç°ä¸è§£æ</li>
</ol>
<h2>1. èŠå¤©æœºå™¨äºº</h2>
<p>&lt;img src=&quot;/images/chatbot/chatbot-5_1.jpg&quot; width=&quot;700&quot; /&gt;</p>
<h3>1.1 åŸºäºæ£€ç´¢çš„ chatbot</h3>
<ul>
<li>æ ¹æ® input å’Œ contextï¼Œç»“åˆçŸ¥è¯†åº“çš„ç®—æ³•å¾—åˆ°åˆé€‚å›å¤</li>
<li>ä»ä¸€ä¸ªå›ºå®šçš„æ•°æ®é›†ä¸­æ‰¾åˆ°åˆé€‚çš„å†…å®¹ä½œä¸ºå›å¤</li>
<li>æ£€ç´¢å’ŒåŒ¹é…çš„æ–¹å¼æœ‰å¾ˆå¤šç§</li>
<li>æ•°æ®å’ŒåŒ¹é…æ–¹æ³•å¯¹è´¨é‡æœ‰å¾ˆå¤§å½±å“</li>
</ul>
<h3>1.2 åŸºäºç”Ÿæˆæ¨¡å‹çš„chatbot</h3>
<ul>
<li>å…¸å‹çš„æ˜¯ seq2seq çš„æ–¹æ³•</li>
<li>ç”Ÿæˆçš„ç»“æœéœ€è¦è€ƒè™‘é€šç•…åº¦å’Œå‡†ç¡®åº¦</li>
</ul>
<blockquote>
<p>ä»¥å‰è€…ä¸ºä¸»(å¯æ§åº¦é«˜)ï¼Œåè€…ä¸ºè¾…</p>
</blockquote>
<h2>2. å›é¡¾ chatterbot</h2>
<p>&lt;img src=&quot;/images/chatbot/chatbot-5_2.png&quot; width=&quot;600&quot; /&gt;</p>
<h3>2.1 chatterbot çš„é—®é¢˜</h3>
<p><strong>åº”ç­”æ¨¡å¼çš„åŒ¹é…æ–¹å¼å¤ªç²—æš´</strong></p>
<blockquote>
<ul>
<li>ç¼–è¾‘è·ç¦»æ— æ³•æ•è·æ·±å±‚è¯­ä¹‰ä¿¡æ¯</li>
<li>æ ¸å¿ƒè¯ + word2vec æ— æ³•æ•è·æ•´å¥è¯è¯­ä¹‰</li>
<li>LSTM ç­‰ RNNæ¨¡å‹ èƒ½æ•è·åºåˆ—ä¿¡æ¯
...
ç”¨æ·±åº¦å­¦ä¹ æ¥æé«˜åŒ¹é…é˜¶æ®µå‡†ç¡®ç‡!!</li>
</ul>
</blockquote>
<p>å¿ƒå¾— :</p>
<blockquote>
<p>Open Domain çš„ chatbot å¾ˆéš¾åšï¼Œè¯é¢˜å¤ªå¹¿ï¼Œå› ä¸ºæ— æ³•é¢„çŸ¥ç”¨æˆ·ä¼šé—®åˆ°ä»€ä¹ˆé—®é¢˜.</p>
<p>ä½ æƒ³åƒä»€ä¹ˆ ï¼š éšä¾¿
ä½ æ„Ÿè§‰æ€ä¹ˆæ · : è¿˜å¥½</p>
<p>æ²¡é—®é¢˜å…¶å®</p>
<p>æ‰€ä»¥é’ˆå¯¹ä¸€ä¸ª Closed Domain + æ£€ç´¢ + çŸ¥è¯†åº“ï¼Œè¿˜åº”è¯¥å¯ä»¥åšä¸€ä¸ªå¯ä»¥ç”¨çš„æœºå™¨äºº.</p>
</blockquote>
<h3>2.2 åº”è¯¥æ€ä¹ˆåš</h3>
<p><strong>åŒ¹é…æœ¬èº«æ˜¯ä¸€ä¸ªæ¨¡ç³Šçš„åœºæ™¯</strong></p>
<blockquote>
<p>è½¬æˆæ’åºé—®é¢˜</p>
</blockquote>
<p><strong>æ’åºé—®é¢˜æ€ä¹ˆå¤„ç†?</strong></p>
<blockquote>
<p>è½¬æˆèƒ½è¾“å‡ºæ¦‚ç‡çš„01åˆ†ç±»é—®é¢˜</p>
<p><strong>Q1 -&gt; { R1: 0.8, R2: 0.1, R3: 0.05, R4: 0.2 }</strong></p>
<p>Query &lt;&gt; Response</p>
</blockquote>
<p><strong>æ•°æ®æ„å»º?</strong></p>
<blockquote>
<p>æˆ‘ä»¬éœ€è¦æ­£æ ·æœ¬(æ­£ç¡®çš„å›ç­”) å’Œ è´Ÿæ ·æœ¬(ä¸å¯¹çš„å›ç­”)</p>
<p><strong>{ æ­£æ ·æœ¬ : Q1-R1 1 }, { è´Ÿæ ·æœ¬ : Q1-R3 0 }</strong></p>
</blockquote>
<p><strong>Loss function?</strong></p>
<blockquote>
<p>å›å¿†ä¸€ä¸‹ logistic regression</p>
</blockquote>
<p><strong>å¿ƒå¾— :</strong></p>
<blockquote>
<p>å®šä¹‰é—®é¢˜ å’Œ è§£å†³é—®é¢˜ å¾ˆé‡è¦</p>
<p>æœ‰ä¸€ä¸ªé—®é¢˜ï¼Œå¯ä»¥è½¬æ¢ä¸º æœºå™¨å­¦ä¹  æˆ– æ·±åº¦å­¦ä¹  å¯ä»¥è§£å†³çš„é—®é¢˜ï¼Œè¿™éå¸¸é‡è¦ã€‚</p>
</blockquote>
<h2>3. ç”¨æ·±åº¦å­¦ä¹ æ¥å®Œæˆ</h2>
<p>&lt;img src=&quot;/images/chatbot/chatbot-5_3.png&quot; width=&quot;700&quot; /&gt;</p>
<blockquote>
<p>ä¸ç®¡ç½‘ç»œç»“æ„å¦‚ä½•ï¼Œä½ æŠ“ä½æœ€å¥½çš„ loss function</p>
<p>100 W æ ·æœ¬ï¼Œ50W+ï¼Œ 50W-ï¼Œ è¿™æ ·çš„æ•°æ®é›†</p>
<p>æˆ‘ä»¬æ‹¿æ¥åšè®­ç»ƒï¼Œè¿™æ ·çš„ç½‘ç»œç»“æ„ï¼Œä¸ç®¡å¦‚ä½•æ­å»ºï¼Œéƒ½ä¸è¦å¤ªæ‹…å¿ƒï¼Œä½ å°±æŠ“ä½ loss functionï¼Œä½ çš„æŸå¤±å‡½æ•°ç”± c å’Œ r å†³å®šçš„ã€‚ c å’Œ r æ˜¯ç”±äºä¸Šé¢çš„ç»“æ„äº§ç”Ÿçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å°±å¯ä»¥ç”¨ BPTT åšè®­ç»ƒäº†.</p>
<p>Query å’Œ Respon éƒ½æ˜¯æˆ‘ä»¬åˆ†è¯åç”¨çš„ word embmmingï¼ŒçŒå…¥ RNN ä¸­ï¼Œæˆ‘ä»¬æŠŠ LSTM é¡ºç€æ•æ‰ä¸‹æ¥ï¼Œå½“åšé—®é¢˜å’Œå›ç­”ï¼Œä¸¤ä¸ªæ•æ‰çš„ä¿¡æ¯æ¥åšåŒ¹é…ï¼Œæˆ‘æ‰¾äº†ä¸ªå‚æ•° Mï¼Œæ¥åš c å’Œ r çš„åŒ¹é…ã€‚ M æ˜¯ä¸€å®šçš„ï¼ŒåŒ¹é…ç¨‹åº¦å’Œæ–¹å¼ä¸€è‡´.</p>
<p>M åˆå§‹åŒ–çš„æ—¶å€™å¯ä»¥ç”± radom æ˜¯ç”Ÿæˆ. M ä¹‹åæ˜¯å¯ä»¥é€šè¿‡è®­ç»ƒåšæ›´æ–°çš„.</p>
<p><a href="http://www.wildml.com/2016/07/deep-learning-for-chatbots-2-retrieval-based-model-tensorflow/" target="_blank" rel="noopener">2016 Google Brain deep-learning-for-chatbots-2-retrieval-based-model-tensorflow, wildml blog</a></p>
</blockquote>
<h2>4. æ•°æ® - Ubuntu å¯¹è¯è¯­æ–™åº“</h2>
<p>æˆ‘ä»¬å°†ä½¿ç”¨Ubuntuå¯¹è¯æ•°æ®é›†ï¼ˆ<a href="https://arxiv.org/abs/1506.08909" target="_blank" rel="noopener">è®ºæ–‡æ¥æº</a> <a href="https://github.com/rkadlec/ubuntu-ranking-dataset-creator" target="_blank" rel="noopener">githubåœ°å€</a>ï¼‰ã€‚è¿™ä¸ªæ•°æ®é›†ï¼ˆUbuntu Dialog Corpus, UDCï¼‰æ˜¯ç›®å‰æœ€å¤§çš„å…¬å¼€å¯¹è¯æ•°æ®é›†ä¹‹ä¸€ï¼Œå®ƒæ˜¯æ¥è‡ª Ubuntu çš„ IRCç½‘ç»œ ä¸Šçš„å¯¹è¯æ—¥å¿—ã€‚<a href="https://arxiv.org/abs/1506.08909" target="_blank" rel="noopener">è¿™ç¯‡è®ºæ–‡</a>ä»‹ç»äº†è¯¥æ•°æ®é›†ç”Ÿæˆçš„å…·ä½“ç»†èŠ‚ã€‚ä¸‹é¢ç®€å•ä»‹ç»ä¸€ä¸‹æ•°æ®çš„æ ¼å¼ã€‚</p>
<p>è®­ç»ƒæ•°æ®æœ‰ 100W æ¡å®ä¾‹ï¼Œå…¶ä¸­ä¸€åŠæ˜¯æ­£ä¾‹ï¼ˆlabelä¸º1ï¼‰ï¼Œä¸€åŠæ˜¯è´Ÿä¾‹ï¼ˆlabelä¸º0ï¼Œè´Ÿä¾‹ä¸ºéšæœºç”Ÿæˆï¼‰ã€‚æ¯æ¡å®ä¾‹åŒ…æ‹¬ä¸€æ®µä¸Šä¸‹æ–‡ä¿¡æ¯ï¼ˆcontextï¼‰ï¼Œå³Queryï¼›å’Œä¸€æ®µå¯èƒ½çš„å›å¤å†…å®¹ï¼Œå³Responseï¼›Labelä¸º1è¡¨ç¤ºè¯¥Responseç¡®å®æ˜¯Queryçš„å›å¤ï¼ŒLabelä¸º0åˆ™è¡¨ç¤ºä¸æ˜¯ã€‚ä¸‹é¢æ˜¯æ•°æ®ç¤ºä¾‹ï¼š</p>
<p>æ•°æ®é›†ç”Ÿæˆè„šæœ¬å·²ç”¨<a href="http://www.nltk.org/" target="_blank" rel="noopener">NLTK</a>åšäº†ä¸€ç³»åˆ—çš„è¯­æ–™å¤„ç†åŒ…æ‹¬ï¼ˆ<a href="http://www.nltk.org/api/nltk.tokenize.html#module-nltk.tokenize" target="_blank" rel="noopener">åˆ†è¯</a>ï¼Œ<a href="http://www.nltk.org/api/nltk.stem.html#module-nltk.stem.snowball" target="_blank" rel="noopener">stemmed</a>ï¼Œ<a href="http://www.nltk.org/api/nltk.stem.html#module-nltk.stem.wordnet" target="_blank" rel="noopener">lemmatized</a>ï¼‰ç­‰æ–‡æœ¬é¢„å¤„ç†æ­¥éª¤ï¼›</p>
<blockquote>
<ul>
<li>ä½¿ç”¨äº†NERæŠ€æœ¯ï¼Œå°†æ–‡æœ¬ä¸­çš„å®ä½“ï¼Œå¦‚ å§“åã€åœ°ç‚¹ã€ç»„ç»‡ã€URL ç­‰æ›¿æ¢æˆç‰¹æ®Šå­—ç¬¦ã€‚</li>
<li>è¿™äº›é¢„å¤„ç†ä¸æ˜¯ä¸¥æ ¼å¿…è¦çš„ï¼Œä½†æ˜¯èƒ½æ”¹å–„ä¸€äº›ç³»ç»Ÿçš„è¡¨ç°ã€‚</li>
<li>è¯­æ–™çš„ä¸Šä¸‹æ–‡å¹³å‡æœ‰86ä¸ªè¯è¯­ï¼Œç­”å¤å¹³å‡æœ‰17ä¸ªè¯è¯­é•¿ã€‚æœ‰äººåšäº†è¯­æ–™çš„ç»Ÿè®¡åˆ†æï¼š<a href="https://github.com/dennybritz/chatbot-retrieval/blob/master/notebooks/Data%20Exploration.ipynb" target="_blank" rel="noopener">data analysis</a></li>
<li>æ•°æ®é›†ä¹ŸåŒ…æ‹¬äº† <strong>Test / Validation sets</strong>ï¼Œä½†è¿™ä¸¤éƒ¨åˆ†çš„æ•°æ®å’Œè®­ç»ƒæ•°æ®åœ¨æ ¼å¼ä¸Šä¸å¤ªä¸€æ ·ã€‚</li>
<li>åœ¨ <strong>Test / Validation sets</strong> ä¸­ï¼Œå¯¹äºæ¯ä¸€æ¡å®ä¾‹ï¼Œæœ‰ä¸€ä¸ªæ­£ä¾‹å’Œä¹ä¸ªè´Ÿä¾‹æ•°æ®ï¼ˆä¹Ÿç§°ä¸ºå¹²æ‰°æ•°æ®ï¼‰ã€‚</li>
<li>æ¨¡å‹çš„ç›®æ ‡åœ¨äºç»™æ­£ä¾‹çš„å¾—åˆ†å°½å¯èƒ½çš„é«˜ï¼Œè€Œç»™è´Ÿä¾‹çš„å¾—åˆ†å°½å¯èƒ½çš„ä½ã€‚ä¸‹é¢æ˜¯æ•°æ®ç¤ºä¾‹ï¼š</li>
</ul>
</blockquote>
<h3>4.1 Train sets</h3>
<p>&lt;img src=&quot;/images/chatbot/chatbot-5_4.png&quot; width=&quot;900&quot; /&gt;</p>
<h3>4.2 Test / Validation sets</h3>
<ul>
<li>æ¯ä¸ªæ ·æœ¬ï¼Œæœ‰ä¸€ä¸ªæ­£ä¾‹å’Œä¹ä¸ªè´Ÿä¾‹æ•°æ® (ä¹Ÿç§°ä¸ºå¹²æ‰°æ•°æ®)ã€‚</li>
<li>å»ºæ¨¡çš„ç›®æ ‡åœ¨äºç»™æ­£ä¾‹çš„å¾—åˆ†å°½å¯èƒ½çš„é«˜ï¼Œè€Œç»™è´Ÿä¾‹çš„å¾—åˆ†å°½å¯èƒ½çš„ä½ã€‚(æœ‰ç‚¹ç±»ä¼¼åˆ†ç±»ä»»åŠ¡)</li>
<li>è¯­æ–™åšè¿‡åˆ†è¯ã€stemmedã€lemmatized ç­‰æ–‡æœ¬é¢„å¤„ç†ã€‚</li>
</ul>
<p>NLTK stemmed</p>
<p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> nltk.stem.porter <span class="keyword">import</span> PorterStemmer</span><br><span class="line">p = PorterStemmer()</span><br><span class="line">p.stem(<span class="string">'wenting'</span>)</span><br></pre></td></tr></table></figure></p>
<p>NLTK Lemma</p>
<p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> nltk.stem <span class="keyword">import</span> WordNetLemmatizer</span><br><span class="line">wordnet_lemmatizer = WordNetLemmatizer()</span><br><span class="line">wordnet_lemmatizer.lemmatize(â€˜dogsâ€™)</span><br><span class="line">uâ€™dogâ€™</span><br></pre></td></tr></table></figure></p>
<ul>
<li>ç”¨ NER(å‘½åå®ä½“è¯†åˆ«) å°†æ–‡æœ¬ä¸­çš„ <strong>å®ä½“</strong>ï¼Œå¦‚å§“åã€åœ°ç‚¹ã€ç»„ç»‡ã€URLç­‰ æ›¿æ¢æˆç‰¹æ®Šå­—ç¬¦</li>
</ul>
<p>&lt;img src=&quot;/images/chatbot/chatbot-5_5.png&quot; width=&quot;900&quot; /&gt;</p>
<h2>5. è¯„ä¼°å‡†åˆ™ BASELINE</h2>
<p><strong>Recall@K</strong></p>
<blockquote>
<ul>
<li>å¸¸è§çš„ Kaggle æ¯”èµ›è¯„åˆ¤å‡†åˆ™</li>
<li>ç»æ¨¡å‹å¯¹å€™é€‰çš„ response æ’åºåï¼Œå‰ k ä¸ªå€™é€‰ä¸­ å­˜åœ¨æ­£ä¾‹æ•°æ®(æ­£ç¡®çš„é‚£ä¸ª)çš„å æ¯”ã€‚
è®© K=10ï¼Œè¿™å°±å¾—åˆ°ä¸€ä¸ª 100% çš„å¬å›ç‡ï¼Œå› æœ€å¤šå°± 10 ä¸ªå¤‡é€‰ã€‚å¦‚æœ K=1ï¼Œæ¨¡å‹åªä¸€æ¬¡æœºä¼šé€‰ä¸­æ­£ç¡®ç­”æ¡ˆã€‚</li>
<li>K å€¼ è¶Šå¤§ï¼ŒæŒ‡æ ‡å€¼è¶Šé«˜ï¼Œå¯¹æ¨¡å‹æ€§èƒ½çš„è¦æ±‚è¶Šæ¾ã€‚</li>
</ul>
</blockquote>
<p><strong>9ä¸ªå¹²æ‰°é¡¹ç›®æ€ä¹ˆé€‰å‡ºæ¥</strong></p>
<blockquote>
<p>è¿™ä¸ªæ•°æ®é›†é‡Œæ˜¯éšæœºçš„æ–¹æ³•é€‰æ‹©çš„ã€‚</p>
<p>ä½†æ˜¯ç°å®ä¸–ç•Œé‡Œä½ å¯èƒ½æ•°ç™¾ä¸‡çš„å¯èƒ½ç­”å¤ï¼Œå¹¶ä¸”ä½ å¹¶ä¸çŸ¥é“ç­”å¤æ˜¯å¦åˆç†æ­£ç¡®ã€‚ä½ æ²¡èƒ½åŠ›ä»æ•°ç™¾ä¸‡çš„å¯èƒ½çš„ç­”å¤é‡Œå»æŒ‘é€‰ä¸€ä¸ªå¾—åˆ†æœ€é«˜çš„æ­£ç¡®ç­”å¤ã€‚æˆæœ¬å¤ªé«˜äº†ï¼ google çš„ smart reply ç”¨åˆ†å¸ƒå¼é›†ç¾¤æŠ€æœ¯è®¡ç®—ä¸€ç³»åˆ—çš„å¯èƒ½ç­”å¤å»æŒ‘é€‰,.</p>
<p>å¯èƒ½ä½ åªæœ‰ç™¾æ¥ä¸ªå¤‡é€‰ç­”æ¡ˆï¼Œå¯ä»¥å»è¯„ä¼°æ¯ä¸€ä¸ªã€‚</p>
</blockquote>
<p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">evaluate_recall</span><span class="params">(y, y_test, k=<span class="number">1</span>)</span>:</span></span><br><span class="line">    num_examples = float(len(y))</span><br><span class="line">    num_correct = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> predictions, label <span class="keyword">in</span> zip(y, y_test):</span><br><span class="line">        <span class="keyword">if</span> label <span class="keyword">in</span> predictions[:k]:</span><br><span class="line">            num_correct += <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> num_correct/num_examples</span><br></pre></td></tr></table></figure></p>
<p>å…¶ä¸­ï¼Œy æ˜¯æ‰€é¢„æµ‹çš„ä»¥é™åºæ’åˆ—çš„æ¨¡å‹é¢„æµ‹åˆ†å€¼ï¼Œy_test æ˜¯å®é™…çš„ label å€¼ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œå‡è®¾ y çš„å€¼ä¸º [0,3,1,2,5,6,4,7,8,9]ï¼Œè¿™è¯´æ˜ ç¬¬0å· çš„å€™é€‰çš„é¢„æµ‹åˆ†å€¼æœ€é«˜ã€ä½œä¸ºå›å¤çš„å¯èƒ½æ€§æœ€é«˜ï¼Œè€Œ9å·åˆ™æœ€ä½ã€‚è¿™é‡Œçš„ ç¬¬0å· åŒæ—¶ä¹Ÿæ˜¯æ­£ç¡®çš„é‚£ä¸ªï¼Œå³æ­£ä¾‹æ•°æ®ï¼Œæ ‡å·ä¸º 1-9 çš„ä¸ºéšæœºç”Ÿæˆçš„è´Ÿä¾‹æ•°æ®ã€‚</p>
<h3>5.1  åŸºçº¿æ¨¡å‹:random guess</h3>
<p>ç†è®ºä¸Šï¼Œæœ€baseçš„éšæœºæ¨¡å‹ï¼ˆRandom Predictorï¼‰çš„recall@1çš„å€¼ä¸º10%ï¼Œrecall@2çš„å€¼ä¸º20%.</p>
<p>ç›¸åº”çš„ä»£ç å¦‚ä¸‹ï¼š</p>
<p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Random Predictor</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">predict_random</span><span class="params">(context, utterances)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> np.random.choice(len(utterances), <span class="number">10</span>, replace=<span class="literal">False</span>) <span class="comment">#np.random.choice(5, 3)  array([0, 3, 4])</span></span><br><span class="line">    <span class="comment"># å¯ä»¥ä»ä¸€ä¸ª intæ•°å­— æˆ– 1ç»´ array é‡Œéšæœºé€‰å–å†…å®¹ï¼Œå¹¶å°†é€‰å–ç»“æœæ”¾å…¥ nç»´ array ä¸­è¿”å›</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Evaluate Random predictor</span></span><br><span class="line">y_random = [predict_random(test_df.Context[x], test_df.iloc[x,<span class="number">1</span>:].values) <span class="keyword">for</span> x <span class="keyword">in</span> range(len(test_df))]</span><br><span class="line">y_test = np.zeros(len(y_random))</span><br><span class="line"><span class="keyword">for</span> n <span class="keyword">in</span> [<span class="number">1</span>, <span class="number">2</span>, <span class="number">5</span>, <span class="number">10</span>]:</span><br><span class="line">    print(<span class="string">"Recall @ (&#123;&#125;, 10): &#123;:g&#125;"</span>.format(n, evaluate_recall(y_random, y_test, n)))</span><br></pre></td></tr></table></figure></p>
<p>å®é™…çš„æ¨¡å‹ç»“æœå¦‚ä¸‹ï¼š</p>
<p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">Recall @ (<span class="number">1</span>, <span class="number">10</span>): <span class="number">0.0937632</span></span><br><span class="line">Recall @ (<span class="number">2</span>, <span class="number">10</span>): <span class="number">0.194503</span></span><br><span class="line">Recall @ (<span class="number">5</span>, <span class="number">10</span>): <span class="number">0.49297</span></span><br><span class="line">Recall @ (<span class="number">10</span>, <span class="number">10</span>): <span class="number">1</span></span><br></pre></td></tr></table></figure></p>
<p>è¿™ä¸ç†è®ºé¢„æœŸç›¸ç¬¦ï¼Œä½†è¿™ä¸æ˜¯æˆ‘ä»¬æ‰€è¿½æ±‚çš„ç»“æœã€‚</p>
<h3>5.2 åŸºçº¿æ¨¡å‹:TF-IDFæ£€ç´¢</h3>
<p>å¦å¤–ä¸€ä¸ª baseline çš„æ¨¡å‹ä¸º <strong>tfidf predictor</strong>ã€‚ç›´è§‚ä¸Šï¼Œä¸¤ç¯‡æ–‡æ¡£å¯¹åº”çš„ tfidf å‘é‡ è¶Šæ¥è¿‘ï¼Œä¸¤ç¯‡æ–‡ç« çš„å†…å®¹ä¹Ÿè¶Šç›¸ä¼¼ã€‚åŒæ ·çš„ï¼Œå¯¹äºä¸€ä¸ª QR pairï¼Œå®ƒä»¬è¯­ä¹‰ä¸Šæ¥è¿‘çš„è¯å…±ç°çš„è¶Šå¤šï¼Œä¹Ÿå°†è¶Šå¯èƒ½æ˜¯ä¸€ä¸ªæ­£ç¡®çš„ QR pairï¼ˆè¿™å¥è¯å­˜ç–‘ï¼ŒåŸå› åœ¨äº Q R ä¹‹é—´ä¹Ÿæœ‰å¯èƒ½ä¸å­˜åœ¨è¯­ä¹‰ä¸Šçš„ç›¸ä¼¼ï¼Œä¸€ä¸ªQå¯¹åº”çš„ R æ˜¯å¤šæ ·çš„ã€‚ï¼‰ã€‚tfidf predictor å¯¹åº”çš„ä»£ç å¦‚ä¸‹ï¼ˆåˆ©ç”¨scikit-learnå·¥å…·èƒ½å¤Ÿè½»æ˜“å®ç°ï¼‰ï¼š</p>
<blockquote>
<p>tfidfè¡¨ç¤ºè¯é¢‘ï¼ˆterm frequencyï¼‰å’Œé€†æ–‡æ¡£è¯é¢‘ï¼ˆinverse document frequencyï¼‰ï¼Œå®ƒè¡¡é‡äº†ä¸€ä¸ªè¯åœ¨ä¸€ç¯‡æ–‡æ¡£ä¸­çš„é‡è¦ç¨‹åº¦ï¼ˆåŸºäºæ•´ä¸ªè¯­æ–™åº“ï¼‰ã€‚</p>
</blockquote>
<p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TFIDFPredictor</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></span><br><span class="line">        self.vectorizer = TfidfVectorizer()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">train</span><span class="params">(self, data)</span>:</span></span><br><span class="line">        self.vectorizer.fit(np.append(data.Context.values,data.Utterance.values))</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">predict</span><span class="params">(self, context, utterances)</span>:</span></span><br><span class="line">        <span class="comment"># Convert context and utterances into tfidf vector</span></span><br><span class="line">        vector_context = self.vectorizer.transform([context])</span><br><span class="line">        vector_doc = self.vectorizer.transform(utterances)</span><br><span class="line">        <span class="comment"># The dot product measures the similarity of the resulting vectors</span></span><br><span class="line">        result = np.dot(vector_doc, vector_context.T).todense()</span><br><span class="line">        result = np.asarray(result).flatten()</span><br><span class="line">        <span class="comment"># Sort by top results and return the indices in descending order</span></span><br><span class="line">        <span class="keyword">return</span> np.argsort(result, axis=<span class="number">0</span>)[::<span class="number">-1</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># Evaluate TFIDF predictor</span></span><br><span class="line">pred = TFIDFPredictor()</span><br><span class="line">pred.train(train_df)</span><br><span class="line">y = [pred.predict(test_df.Context[x], test_df.iloc[x,<span class="number">1</span>:].values) <span class="keyword">for</span> x <span class="keyword">in</span> range(len(test_df))]</span><br><span class="line"><span class="keyword">for</span> n <span class="keyword">in</span> [<span class="number">1</span>, <span class="number">2</span>, <span class="number">5</span>, <span class="number">10</span>]:</span><br><span class="line">    print(<span class="string">"Recall @ (&#123;&#125;, 10): &#123;:g&#125;"</span>.format(n, evaluate_recall(y, y_test, n)))</span><br></pre></td></tr></table></figure></p>
<p>æ¨¡å‹ç»“æœå¦‚ä¸‹ï¼š</p>
<p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">Recall @ (<span class="number">1</span>, <span class="number">10</span>): <span class="number">0.495032</span></span><br><span class="line">Recall @ (<span class="number">2</span>, <span class="number">10</span>): <span class="number">0.596882</span></span><br><span class="line">Recall @ (<span class="number">5</span>, <span class="number">10</span>): <span class="number">0.766121</span></span><br><span class="line">Recall @ (<span class="number">10</span>, <span class="number">10</span>): <span class="number">1</span></span><br></pre></td></tr></table></figure></p>
<p>æ˜¾ç„¶è¿™æ¯” Random çš„æ¨¡å‹è¦å¥½å¾—å¤šï¼Œä½†è¿™è¿˜ä¸å¤Ÿã€‚ä¹‹å‰çš„å‡è®¾å¹¶ä¸å®Œç¾ï¼Œé¦–å…ˆ query å’Œ response ä¹‹é—´å¹¶ä¸ä¸€å®šè¦æ˜¯è¯­ä¹‰ä¸Šçš„ç›¸è¿‘ï¼›å…¶æ¬¡ tfidfæ¨¡å‹ å¿½ç•¥äº†è¯åºè¿™ä¸€é‡è¦çš„ä¿¡æ¯ã€‚ä½¿ç”¨ NNæ¨¡å‹ æˆ‘ä»¬èƒ½åšå¾—æ›´å¥½ä¸€äº›ã€‚</p>
<h2>6. LSTM</h2>
<p>å»ºç«‹çš„ NNæ¨¡å‹ ä¸ºä¸¤å±‚ Encoder çš„ LSTMæ¨¡å‹ï¼ˆDual Encoder LSTM Networkï¼‰ï¼Œè¿™ç§å½¢å¼çš„ç½‘ç»œè¢«å¹¿æ³›åº”ç”¨ chatbot ä¸­ã€‚</p>
<p><a href="https://www.tensorflow.org/versions/r0.9/tutorials/seq2seq/index.html" target="_blank" rel="noopener">seq2seqæ¨¡å‹</a> å¸¸ç”¨äºæœºå™¨ç¿»è¯‘é¢†åŸŸï¼Œå¹¶å–å¾—äº†è¾ƒå¤§çš„æ•ˆæœã€‚ä½¿ç”¨ Dual LSTMæ¨¡å‹ çš„åŸå› åœ¨äºè¿™ä¸ªæ¨¡å‹è¢«è¯æ˜åœ¨è¿™ä¸ªæ•°æ®é›†æœ‰è¾ƒå¥½çš„æ•ˆæœï¼ˆ<a href="https://arxiv.org/abs/1510.03753" target="_blank" rel="noopener">è¯¦æƒ…è§è¿™é‡Œ</a>ï¼‰, è¿™å¯ä»¥ä½œä¸ºæˆ‘ä»¬åç»­æ¨¡å‹æ•ˆæœçš„éªŒè¯ã€‚</p>
<p>ä¸¤å±‚ Encoder çš„ LSTMæ¨¡å‹ çš„ç»“æ„å›¾å¦‚ä¸‹ï¼ˆ<a href="https://arxiv.org/abs/1506.08909" target="_blank" rel="noopener">è®ºæ–‡æ¥æº</a>ï¼‰ï¼š</p>
<p><strong>å¤§è‡´æµç¨‹ï¼š</strong></p>
<blockquote>
<p>(1). Query å’Œ Response éƒ½æ˜¯ç»è¿‡åˆ†è¯çš„ï¼Œåˆ†è¯åæ¯ä¸ªè¯ embedding ä¸ºå‘é‡å½¢å¼ã€‚åˆå§‹çš„è¯å‘é‡ä½¿ç”¨ GloVe / Word2vecï¼Œä¹‹åè¯å‘é‡éšç€æ¨¡å‹çš„è®­ç»ƒä¼šè¿›è¡Œ fine-tuned ã€‚</p>
<p>(2). åˆ†è¯ä¸”å‘é‡åŒ–çš„ Query å’Œ Response ç»è¿‡ç›¸åŒçš„ RNNï¼ˆword by wordï¼‰ã€‚RNN æœ€ç»ˆç”Ÿæˆä¸€ä¸ªå‘é‡è¡¨ç¤ºï¼Œæ•æ‰äº† Query å’Œ Response ä¹‹é—´çš„[è¯­ä¹‰è”ç³»]ï¼ˆå›¾ä¸­çš„$c$å’Œ$r$ï¼‰ï¼›è¿™ä¸ªå‘é‡çš„ç»´åº¦æ˜¯å¯ä»¥æŒ‡å®šçš„ï¼Œè¿™é‡ŒæŒ‡å®šä¸º 256ç»´ã€‚</p>
<p>(3). å°† å‘é‡c ä¸ä¸€ä¸ª çŸ©é˜µM ç›¸ä¹˜ï¼Œæ¥é¢„æµ‹ä¸€ä¸ªå¯èƒ½çš„ å›å¤$râ€™$ã€‚å¦‚æœ $c$ ä¸ºä¸€ä¸ª256ç»´çš„å‘é‡ï¼ŒMç»´ 256*256 çš„çŸ©é˜µï¼Œä¸¤è€…ç›¸ä¹˜çš„ç»“æœä¸ºå¦ä¸€ä¸ª256ç»´çš„å‘é‡ï¼Œæˆ‘ä»¬å¯ä»¥å°†å…¶è§£é‡Šä¸º[ä¸€ä¸ªç”Ÿæˆå¼çš„å›å¤å‘é‡]ã€‚çŸ©é˜µM æ˜¯éœ€è¦è®­ç»ƒçš„å‚æ•°ã€‚</p>
<p>(4). é€šè¿‡ç‚¹ä¹˜çš„æ–¹å¼æ¥é¢„æµ‹ç”Ÿæˆçš„ å›å¤$râ€™$ å’Œ å€™é€‰çš„ å›å¤$r$ ä¹‹é—´çš„ç›¸ä¼¼ç¨‹åº¦ï¼Œç‚¹ä¹˜ç»“æœè¶Šå¤§è¡¨ç¤ºå€™é€‰å›å¤ä½œä¸ºå›å¤çš„å¯ä¿¡åº¦è¶Šé«˜ï¼›ä¹‹åé€šè¿‡ sigmoid å‡½æ•°å½’ä¸€åŒ–ï¼Œè½¬æˆæ¦‚ç‡å½¢å¼ã€‚</p>
<p>(sigmoidä½œä¸ºå‹ç¼©å‡½æ•°ç»å¸¸ä½¿ç”¨) å›¾ä¸­æŠŠç¬¬(3)æ­¥å’Œç¬¬(4)æ­¥ç»“åˆåœ¨ä¸€èµ·äº†ã€‚</p>
<ul>
<li>
<p>(5). æŸå¤±å‡½æ•°ï¼ˆloss functionï¼‰ã€‚è¿™é‡Œä½¿ç”¨äºŒå…ƒçš„äº¤å‰ç†µï¼ˆbinary cross-entropyï¼‰ä½œä¸ºæŸå¤±å‡½æ•°ã€‚æˆ‘ä»¬å·²çŸ¥å®ä¾‹çš„çœŸå® label $y$ï¼Œ å€¼ä¸º 0 æˆ– 1ï¼› é€šè¿‡ä¸Šé¢çš„ç¬¬(4)æ­¥å¯ä»¥å¾—åˆ°ä¸€ä¸ªæ¦‚ç‡å€¼ $y'$ï¼›å› æ­¤ï¼Œäº¤å‰ç†µæŸå¤±å€¼ä¸º $L = -y * ln(y') - (1 - y) * ln(1 - y')$ã€‚</p>
<p>è¿™ä¸ªå…¬å¼æ„ä¹‰æ˜¯ç›´è§‚çš„ï¼Œå³å½“ $y=1$ æ—¶ï¼Œ$L = -ln(y')$ï¼ŒæœŸæœ› $y'$ å°½é‡æ¥è¿‘ 1 ä½¿å¾—æŸå¤±å‡½æ•°çš„å€¼è¶Šå°ï¼›åä¹‹äº¦ç„¶ã€‚</p>
</li>
</ul>
<p>å®ç°è¿‡ç¨‹ä¸­ä½¿ç”¨äº† numpyã€pandasã€TensorFlow å’Œ TF Learn ç­‰å·¥å…·ã€‚</p>
</blockquote>
<h3>6.1. æ•°æ®é¢„å¤„ç†</h3>
<p><a href="https://github.com/chatbot-tube/ubuntu-ranking-dataset-creator" target="_blank" rel="noopener">æ•°æ®é›†</a>çš„åŸå§‹æ ¼å¼ä¸ºcsvæ ¼å¼ï¼Œæˆ‘ä»¬éœ€è¦å…ˆå°†å…¶è½¬ä¸º TensorFlow ä¸“æœ‰çš„æ ¼å¼ï¼Œè¿™ç§æ ¼å¼çš„å¥½å¤„åœ¨äºèƒ½å¤Ÿç›´æ¥ä»è¾“å…¥æ–‡ä»¶ä¸­ load tensorsï¼Œå¹¶è®© TensorFlow æ¥å¤„ç†æ´—ç‰Œ(shuffling)ã€æ‰¹é‡(batching) å’Œ é˜Ÿåˆ—åŒ–(queuing) ç­‰æ“ä½œã€‚é¢„å¤„ç†ä¸­è¿˜åŒ…æ‹¬åˆ›å»ºä¸€ä¸ªå­—å…¸åº“ï¼Œå°†è¯è¿›è¡Œæ ‡å·ï¼ŒTFRecord æ–‡ä»¶å°†ç›´æ¥å­˜å‚¨è¿™äº›è¯çš„æ ‡å·ã€‚</p>
<p>æ¯ä¸ªå®ä¾‹åŒ…æ‹¬å¦‚ä¸‹å‡ ä¸ªå­—æ®µï¼š</p>
<ul>
<li>Queryï¼šè¡¨ç¤ºä¸ºä¸€ä¸²è¯æ ‡å·çš„åºåˆ—ï¼Œå¦‚ [231, 2190, 737, 0, 912]ï¼›</li>
<li>Query çš„é•¿åº¦ï¼›</li>
<li>Responseï¼šåŒæ ·æ˜¯ä¸€ä¸²è¯æ ‡å·çš„åºåˆ—ï¼›</li>
<li>Response çš„é•¿åº¦ï¼›</li>
<li>Labelï¼›</li>
<li>Distractor_[N]ï¼šè¡¨ç¤ºè´Ÿä¾‹å¹²æ‰°æ•°æ®ï¼Œä»…åœ¨éªŒè¯é›†å’Œæµ‹è¯•é›†ä¸­æœ‰ï¼ŒN çš„å–å€¼ä¸º 0-8ï¼›</li>
<li>Distractor_[N]çš„é•¿åº¦ï¼›</li>
</ul>
<p>æ•°æ®é¢„å¤„ç†çš„ <a href="https://github.com/dennybritz/chatbot-retrieval/blob/master/scripts/prepare_data.py" target="_blank" rel="noopener">Pythonè„šæœ¬</a>ï¼Œç”Ÿæˆäº†3ä¸ªæ–‡ä»¶ï¼štrain.tfrecords, validation.tfrecords å’Œ test.tfrecordsã€‚ä½ å¯ä»¥å°è¯•è‡ªå·±è¿è¡Œç¨‹åºï¼Œæˆ–è€…ç›´æ¥ä¸‹è½½å’Œä½¿ç”¨é¢„å¤„ç†åçš„æ•°æ®ã€‚</p>
<h3>6.2. åˆ›å»ºè¾“å…¥å‡½æ•°</h3>
<p>ä¸ºäº†ä½¿ç”¨ TensoFlowå†…ç½® çš„è®­ç»ƒå’Œè¯„æµ‹æ¨¡å—ï¼Œæˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ªè¾“å…¥å‡½æ•°ï¼šè¿™ä¸ªå‡½æ•°è¿”å›è¾“å…¥æ•°æ®çš„ batchã€‚</p>
<blockquote>
<p>å› ä¸ºè®­ç»ƒæ•°æ®å’Œæµ‹è¯•æ•°æ®çš„æ ¼å¼ä¸åŒï¼Œæˆ‘ä»¬éœ€è¦åˆ›å»ºä¸åŒçš„è¾“å…¥å‡½æ•°ã€‚</p>
<p>è¾“å…¥å‡½æ•°éœ€è¦è¿”å›æ‰¹é‡(<strong>batch</strong>)çš„ç‰¹å¾å’Œæ ‡ç­¾å€¼(å¦‚æœæœ‰çš„è¯)ã€‚ç±»ä¼¼äºå¦‚ä¸‹ï¼š</p>
</blockquote>
<p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">input_fn</span><span class="params">()</span>:</span></span><br><span class="line">  <span class="comment"># TODO Load and preprocess data here</span></span><br><span class="line">  <span class="keyword">return</span> batched_features, labels</span><br></pre></td></tr></table></figure></p>
<p>å› ä¸ºæˆ‘ä»¬éœ€è¦åœ¨æ¨¡å‹è®­ç»ƒå’Œè¯„æµ‹è¿‡ç¨‹ä¸­ä½¿ç”¨ä¸åŒçš„è¾“å…¥å‡½æ•°ï¼Œä¸ºäº†é˜²æ­¢é‡å¤ä¹¦å†™ä»£ç ï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªåŒ…è£…å™¨(wrapper)ï¼Œåç§°ä¸ºcreate_input_fnï¼Œé’ˆå¯¹ä¸åŒçš„modeä½¿ç”¨ç›¸åº”çš„codeï¼Œå¦‚ä¸‹ï¼š</p>
<p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">create_input_fn</span><span class="params">(mode, input_files, batch_size, num_epochs=None)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">input_fn</span><span class="params">()</span>:</span></span><br><span class="line">	 <span class="comment"># TODO Load and preprocess data here</span></span><br><span class="line">        <span class="keyword">return</span> batched_features, labels</span><br><span class="line">    <span class="keyword">return</span> input_fn</span><br></pre></td></tr></table></figure></p>
<p>å®Œæ•´çš„codeè§<a href="https://github.com/dennybritz/chatbot-retrieval/blob/master/udc_inputs.py" target="_blank" rel="noopener">udc_inputs.py</a>ã€‚æ•´ä½“ä¸Šï¼Œè¿™ä¸ªå‡½æ•°åšäº†å¦‚ä¸‹çš„äº‹æƒ…ï¼š</p>
<p>(1) å®šä¹‰äº†ç¤ºä¾‹æ–‡ä»¶ä¸­çš„ featureå­—æ®µï¼›
(2) ä½¿ç”¨ tf.TFRecordReader æ¥è¯»å– input_files ä¸­çš„æ•°æ®ï¼›
(3) æ ¹æ® featureå­—æ®µ çš„å®šä¹‰å¯¹æ•°æ®è¿›è¡Œè§£æï¼›
(4) æå–è®­ç»ƒæ•°æ®çš„æ ‡ç­¾ labelï¼›
(5) äº§ç”Ÿæ‰¹é‡åŒ–çš„è®­ç»ƒæ•°æ® batch train_datasetsï¼›
(6) è¿”å›æ‰¹é‡çš„ç‰¹å¾æ•°æ®åŠå¯¹åº”æ ‡ç­¾ labelï¼›</p>
<h3>6.3. å®šä¹‰è¯„æµ‹æŒ‡æ ‡</h3>
<p>ä¹‹å‰å·²ç»æåˆ°ç”¨ <strong>recall@k</strong> è¿™ä¸ªæŒ‡æ ‡æ¥è¯„æµ‹æ¨¡å‹ï¼ŒTensorFlow ä¸­å·²ç»å®ç°äº†è®¸å¤šæ ‡å‡†æŒ‡æ ‡ï¼ˆåŒ…æ‹¬ <strong>recall@k</strong>ï¼‰ã€‚ä¸ºäº†ä½¿ç”¨è¿™äº›æŒ‡æ ‡ï¼Œéœ€è¦åˆ›å»ºä¸€ä¸ªå­—å…¸ï¼Œkey ä¸ºæŒ‡æ ‡åç§°ï¼Œvalue ä¸ºå¯¹åº”çš„è®¡ç®—å‡½æ•°ã€‚å¦‚ä¸‹</p>
<p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">create_evaluation_metrics</span><span class="params">()</span>:</span></span><br><span class="line">    eval_metrics = &#123;&#125;</span><br><span class="line">    <span class="keyword">for</span> k <span class="keyword">in</span> [<span class="number">1</span>, <span class="number">2</span>, <span class="number">5</span>, <span class="number">10</span>]:</span><br><span class="line">        eval_metrics[<span class="string">"recall_at_%d"</span> % k] = functools.partial(</span><br><span class="line">            tf.contrib.metrics.streaming_sparse_recall_at_k,</span><br><span class="line">            k=k</span><br><span class="line">    )</span><br><span class="line">    <span class="keyword">return</span> eval_metrics</span><br></pre></td></tr></table></figure></p>
<p>å¦‚ä¸Šï¼Œæˆ‘ä»¬ä½¿ç”¨äº† <a href="https://docs.python.org/2/library/functools.html#functools.partial" target="_blank" rel="noopener">functools.partial</a> å‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°çš„è¾“å…¥å‚æ•°æœ‰ä¸¤ä¸ªã€‚ä¸è¦è¢« streaming_sparse_recall_at_k æ‰€å›°æƒ‘ï¼Œå…¶ä¸­çš„ streaming çš„å«ä¹‰æ˜¯è¡¨ç¤ºæŒ‡æ ‡çš„è®¡ç®—æ˜¯å¢é‡å¼çš„ã€‚</p>
<p>è®­ç»ƒå’Œæµ‹è¯•æ‰€ä½¿ç”¨çš„è¯„æµ‹æ–¹å¼æ˜¯ä¸ä¸€æ ·çš„ï¼Œè®­ç»ƒè¿‡ç¨‹ä¸­æˆ‘ä»¬å¯¹ æ¯ä¸ªcase å¯èƒ½ä½œä¸ºæ­£ç¡®å›å¤çš„æ¦‚ç‡è¿›è¡Œé¢„æµ‹ï¼Œè€Œæµ‹è¯•è¿‡ç¨‹ä¸­æˆ‘ä»¬å¯¹æ¯ç»„æ•°æ®ï¼ˆåŒ…å«10ä¸ªcaseï¼Œå…¶ä¸­1ä¸ªæ˜¯æ­£ç¡®çš„ï¼Œå¦å¤–9ä¸ªæ˜¯ç”Ÿæˆçš„è´Ÿä¾‹/å™ªéŸ³æ•°æ®ï¼‰ä¸­çš„caseè¿›è¡Œé€æ¡æ¦‚ç‡é¢„æµ‹ï¼Œå¾—åˆ°ä¾‹å¦‚ [0.34, 0.11, 0.22, 0.45, 0.01, 0.02, 0.03, 0.08, 0.33, 0.11] è¿™æ ·æ ¼å¼çš„è¾“å‡ºï¼Œè¿™äº›è¾“å‡ºå€¼çš„å’Œå¹¶ä¸è¦æ±‚ä¸º 1ï¼ˆå› ä¸ºæ˜¯é€æ¡é¢„æµ‹çš„ï¼Œæœ‰å•ç‹¬çš„é¢„æµ‹æ¦‚ç‡å€¼ï¼Œåœ¨ 0 åˆ° 1 ä¹‹é—´ï¼‰ï¼› è€Œå¯¹äºè¿™ç»„æ•°æ®è€Œè¨€ï¼Œå› ä¸ºæ•°æ® index=0 å¯¹åº”çš„ä¸ºæ­£ç¡®ç­”æ¡ˆï¼Œè¿™é‡Œ recall@1 ä¸º 0ï¼Œå› ä¸º 0.34 æ˜¯å…¶ä¸­ç¬¬äºŒå¤§çš„å€¼ï¼Œæ‰€ä»¥ recall@2 æ˜¯ 1ï¼ˆè¡¨ç¤ºè¿™ç»„æ•°æ®ä¸­é¢„æµ‹æ¦‚ç‡å€¼åœ¨å‰äºŒçš„ä¸­æœ‰ä¸€ä¸ªæ˜¯æ­£ç¡®çš„ï¼‰ã€‚</p>
<h3>6.4. è®­ç»ƒç¨‹åºæ ·ä¾‹</h3>
<p>é¦–å…ˆï¼Œç»™ä¸€ä¸ªæ¨¡å‹è®­ç»ƒå’Œæµ‹è¯•çš„ç¨‹åºæ ·ä¾‹ï¼Œè¿™ä¹‹åä½ å¯ä»¥å‚ç…§ç¨‹åºä¸­æ‰€ç”¨åˆ°çš„æ ‡å‡†å‡½æ•°ï¼Œæ¥å¿«é€Ÿåˆ‡æ¢å’Œä½¿ç”¨å…¶ä»–çš„ç½‘ç»œæ¨¡å‹ã€‚å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªå‡½æ•° <code>model_fn</code>ï¼Œå‡½æ•°çš„è¾“å…¥å‚æ•°æœ‰ <code>batched features</code>ï¼Œ<code>label</code> å’Œ <code>mode</code>(train/evaluation)ï¼Œå‡½æ•°çš„è¾“å‡ºä¸ºé¢„æµ‹å€¼ã€‚ç¨‹åºæ ·ä¾‹å¦‚ä¸‹ï¼š</p>
<p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">estimator = tf.contrib.learn.Estimator(</span><br><span class="line">    model_fn=model_fn,</span><br><span class="line">    model_dir=MODEL_DIR,</span><br><span class="line">    config=tf.contrib.learn.RunConfig()</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">input_fn_train = udc_inputs.create_input_fn(</span><br><span class="line">    mode=tf.contrib.learn.ModeKeys.TRAIN,</span><br><span class="line">    input_files=[TRAIN_FILE],</span><br><span class="line">    batch_size=hparams.batch_size</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">input_fn_eval = udc_inputs.create_input_fn(</span><br><span class="line">    mode=tf.contrib.learn.ModeKeys.EVAL,</span><br><span class="line">    input_files=[VALIDATION_FILE],</span><br><span class="line">    batch_size=hparams.eval_batch_size,</span><br><span class="line">    num_epochs=<span class="number">1</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">eval_metrics = udc_metrics.create_evaluation_metrics()</span><br><span class="line"></span><br><span class="line"><span class="comment"># We need to subclass theis manually for now. The next TF version will</span></span><br><span class="line"><span class="comment"># have support ValidationMonitors with metrics built-in.</span></span><br><span class="line"><span class="comment"># It's already on the master branch.</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">EvaluationMonitor</span><span class="params">(tf.contrib.learn.monitors.EveryN)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">every_n_step_end</span><span class="params">(self, step, outputs)</span>:</span></span><br><span class="line">        self._estimator.evaluate(</span><br><span class="line">        input_fn=input_fn_eval,</span><br><span class="line">        metrics=eval_metrics,</span><br><span class="line">        steps=<span class="literal">None</span>)</span><br><span class="line"></span><br><span class="line">eval_monitor = EvaluationMonitor(every_n_steps=FLAGS.eval_every)</span><br><span class="line"></span><br><span class="line">estimator.fit(input_fn=input_fn_train, steps=<span class="literal">None</span>, monitors=[eval_monitor])</span><br></pre></td></tr></table></figure></p>
<p>è¿™é‡Œåˆ›å»ºäº†ä¸€ä¸ª <strong>model_fn</strong> çš„ <strong>estimator</strong>(è¯„ä¼°å‡½æ•°)ï¼›</p>
<p>ä¸¤ä¸ªè¾“å…¥å‡½æ•°ï¼Œ<strong>input_fn_train</strong> å’Œ <strong>input_fn_eval</strong>ï¼Œä»¥åŠè®¡ç®—è¯„æµ‹æŒ‡æ ‡çš„å‡½æ•°ï¼›</p>
<p>å®Œæ•´çš„codeè§<a href="https://github.com/dennybritz/chatbot-retrieval/blob/master/udc_train.py" target="_blank" rel="noopener">udc_train.py</a>ã€‚</p>
<h3>6.5. åˆ›å»ºæ¨¡å‹</h3>
<p>åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬åˆ›å»ºäº†æ¨¡å‹çš„ è¾“å…¥ã€è§£æã€è¯„æµ‹å’Œè®­ç»ƒ çš„æ ·ä¾‹ç¨‹åºã€‚ç°åœ¨æˆ‘ä»¬æ¥å†™ LSTM çš„ç¨‹åºï¼Œcreate_model_fnå‡½æ•° ç”¨ä»¥å¤„ç†ä¸åŒæ ¼å¼çš„è®­ç»ƒå’Œæµ‹è¯•æ•°æ®ï¼›å®ƒçš„è¾“å…¥å‚æ•°ä¸º model_implï¼Œè¿™ä¸ªå‡½æ•°è¡¨ç¤ºå®é™…ä½œå‡ºé¢„æµ‹çš„æ¨¡å‹ï¼Œè¿™é‡Œå°±æ˜¯ç”¨çš„LSTMï¼Œå½“ç„¶ä½ å¯ä»¥æ›¿æ¢æˆä»»æ„çš„å…¶ä»–æ¨¡å‹ã€‚ç¨‹åºå¦‚ä¸‹ï¼š</p>
<p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">dual_encoder_model</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">    hparams,</span></span></span><br><span class="line"><span class="function"><span class="params">    mode,</span></span></span><br><span class="line"><span class="function"><span class="params">    context,</span></span></span><br><span class="line"><span class="function"><span class="params">    context_len,</span></span></span><br><span class="line"><span class="function"><span class="params">    utterance,</span></span></span><br><span class="line"><span class="function"><span class="params">    utterance_len,</span></span></span><br><span class="line"><span class="function"><span class="params">    targets)</span>:</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># Initialize embedidngs randomly or with pre-trained vectors if available</span></span><br><span class="line">  embeddings_W = get_embeddings(hparams)</span><br><span class="line"></span><br><span class="line">  <span class="comment"># Embed the context and the utterance</span></span><br><span class="line">  context_embedded = tf.nn.embedding_lookup(</span><br><span class="line">      embeddings_W, context, name=<span class="string">"embed_context"</span>)</span><br><span class="line">  utterance_embedded = tf.nn.embedding_lookup(</span><br><span class="line">      embeddings_W, utterance, name=<span class="string">"embed_utterance"</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="comment"># Build the RNN</span></span><br><span class="line">  <span class="keyword">with</span> tf.variable_scope(<span class="string">"rnn"</span>) <span class="keyword">as</span> vs:</span><br><span class="line">    <span class="comment"># We use an LSTM Cell</span></span><br><span class="line">    cell = tf.nn.rnn_cell.LSTMCell(</span><br><span class="line">        hparams.rnn_dim,</span><br><span class="line">        forget_bias=<span class="number">2.0</span>,</span><br><span class="line">        use_peepholes=<span class="literal">True</span>,</span><br><span class="line">        state_is_tuple=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Run the utterance and context through the RNN</span></span><br><span class="line">    rnn_outputs, rnn_states = tf.nn.dynamic_rnn(</span><br><span class="line">        cell,</span><br><span class="line">        tf.concat(<span class="number">0</span>, [context_embedded, utterance_embedded]),</span><br><span class="line">        sequence_length=tf.concat(<span class="number">0</span>, [context_len, utterance_len]),</span><br><span class="line">        dtype=tf.float32)</span><br><span class="line">    encoding_context, encoding_utterance = tf.split(<span class="number">0</span>, <span class="number">2</span>, rnn_states.h)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">with</span> tf.variable_scope(<span class="string">"prediction"</span>) <span class="keyword">as</span> vs:</span><br><span class="line">    M = tf.get_variable(<span class="string">"M"</span>,</span><br><span class="line">      shape=[hparams.rnn_dim, hparams.rnn_dim],</span><br><span class="line">      initializer=tf.truncated_normal_initializer())</span><br><span class="line"></span><br><span class="line">    <span class="comment"># "Predict" a  response: c * M</span></span><br><span class="line">    generated_response = tf.matmul(encoding_context, M)</span><br><span class="line">    generated_response = tf.expand_dims(generated_response, <span class="number">2</span>)</span><br><span class="line">    encoding_utterance = tf.expand_dims(encoding_utterance, <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Dot product between generated response and actual response</span></span><br><span class="line">    <span class="comment"># (c * M) * r</span></span><br><span class="line">    logits = tf.batch_matmul(generated_response, encoding_utterance, <span class="literal">True</span>)</span><br><span class="line">    logits = tf.squeeze(logits, [<span class="number">2</span>])</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Apply sigmoid to convert logits to probabilities</span></span><br><span class="line">    probs = tf.sigmoid(logits)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Calculate the binary cross-entropy loss</span></span><br><span class="line">    losses = tf.nn.sigmoid_cross_entropy_with_logits(logits, tf.to_float(targets))</span><br><span class="line"></span><br><span class="line">  <span class="comment"># Mean loss across the batch of examples</span></span><br><span class="line">  mean_loss = tf.reduce_mean(losses, name=<span class="string">"mean_loss"</span>)</span><br><span class="line">  <span class="keyword">return</span> probs, mean_loss</span><br></pre></td></tr></table></figure></p>
<p>å®Œæ•´çš„ç¨‹åºè§ <a href="https://github.com/dennybritz/chatbot-retrieval/blob/master/models/dual_encoder.py" target="_blank" rel="noopener">dual_encoder.py</a>ã€‚åŸºäºè¿™ä¸ªï¼Œæˆ‘ä»¬èƒ½å¤Ÿå®ä¾‹åŒ– modelå‡½æ•° åœ¨æˆ‘ä»¬ä¹‹å‰å®šä¹‰çš„ <a href="https://github.com/dennybritz/chatbot-retrieval/blob/master/udc_train.py" target="_blank" rel="noopener">udc_train.py</a>ï¼Œå¦‚ä¸‹ï¼š</p>
<p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">model_fn = udc_model.create_model_fn(</span><br><span class="line">  hparams=hparams,</span><br><span class="line">  model_impl=dual_encoder_model)</span><br></pre></td></tr></table></figure></p>
<p>è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥ç›´æ¥è¿è¡Œ udc_train.pyæ–‡ä»¶ï¼Œæ¥å¼€å§‹æ¨¡å‹çš„è®­ç»ƒå’Œè¯„æµ‹äº†ï¼Œä½ å¯ä»¥è®¾å®š--eval_everyå‚æ•° æ¥æ§åˆ¶æ¨¡å‹åœ¨éªŒè¯é›†ä¸Šçš„è¯„æµ‹é¢‘ç‡ã€‚æ›´å¤šçš„å‘½ä»¤è¡Œå‚æ•°ä¿¡æ¯å¯è§ tf.flags å’Œ hparamsï¼Œä½ ä¹Ÿå¯ä»¥è¿è¡Œ python udc_train.py --help æ¥æŸ¥çœ‹ã€‚</p>
<p>è¿è¡Œç¨‹åºçš„æ•ˆæœå¦‚ä¸‹ï¼š</p>
<p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">INFO:tensorflow:training step 20200, loss = 0.36895 (0.330 sec/batch).</span><br><span class="line">INFO:tensorflow:Step 20201: mean_loss:0 = 0.385877</span><br><span class="line">INFO:tensorflow:training step 20300, loss = 0.25251 (0.338 sec/batch).</span><br><span class="line">INFO:tensorflow:Step 20301: mean_loss:0 = 0.405653</span><br><span class="line">...</span><br><span class="line">INFO:tensorflow:Results after 270 steps (0.248 sec/batch): recall_at_1 = 0.507581018519, recall_at_2 = 0.689699074074, recall_at_5 = 0.913020833333, recall_at_10 = 1.0, loss = 0.5383</span><br><span class="line">...</span><br></pre></td></tr></table></figure></p>
<h3>6.6. æ¨¡å‹çš„è¯„æµ‹</h3>
<p>åœ¨è®­ç»ƒå®Œæ¨¡å‹åï¼Œä½ å¯ä»¥å°†å…¶åº”ç”¨åœ¨ <strong>æµ‹è¯•é›†</strong> ä¸Šï¼Œä½¿ç”¨ï¼š</p>
<p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">python udc_test.py --model_dir=$MODEL_DIR_FROM_TRAINING</span><br></pre></td></tr></table></figure></p>
<p>ä¾‹å¦‚ï¼š</p>
<p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">python udc_test.py --model_dir=~/github/chatbot-retrieval/runs/<span class="number">1467389151</span></span><br></pre></td></tr></table></figure></p>
<p>è¿™å°†å¾—åˆ°æ¨¡å‹åœ¨ <strong>æµ‹è¯•é›†</strong> ä¸Šçš„ recall@k çš„ç»“æœï¼Œæ³¨æ„åœ¨ä½¿ç”¨ udc_test.pyæ–‡ä»¶ æ—¶ï¼Œéœ€è¦ä½¿ç”¨ä¸è®­ç»ƒæ—¶ç›¸åŒçš„å‚æ•°ã€‚</p>
<p>åœ¨è®­ç»ƒæ¨¡å‹çš„æ¬¡æ•°å¤§çº¦ <strong>2w</strong> æ¬¡æ—¶(åœ¨GPUä¸Šå¤§çº¦èŠ±è´¹1å°æ—¶)ï¼Œæ¨¡å‹åœ¨æµ‹è¯•é›†ä¸Šå¾—åˆ°å¦‚ä¸‹çš„ç»“æœï¼š</p>
<p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">recall_at_1 = 0.507581018519</span><br><span class="line">recall_at_2 = 0.689699074074</span><br><span class="line">recall_at_5 = 0.913020833333</span><br></pre></td></tr></table></figure></p>
<p>å…¶ä¸­ï¼Œrecall@1çš„å€¼ä¸tfidfæ¨¡å‹çš„å·®ä¸å¤šï¼Œä½†æ˜¯recall@2å’Œrecall@5çš„å€¼åˆ™æ¯”tfidfæ¨¡å‹çš„ç»“æœå¥½å¤ªå¤šã€‚åŸè®ºæ–‡ä¸­çš„ç»“æœä¾æ¬¡æ˜¯0.55,0.72å’Œ0.92ï¼Œå¯èƒ½é€šè¿‡æ¨¡å‹è°ƒå‚æˆ–è€…é¢„å¤„ç†èƒ½å¤Ÿè¾¾åˆ°è¿™ä¸ªç»“æœã€‚</p>
<h3>6.7. ä½¿ç”¨æ¨¡å‹è¿›è¡Œé¢„æµ‹</h3>
<p>å¯¹äºæ–°çš„æ•°æ®ï¼Œä½ å¯ä»¥ä½¿ç”¨ <a href="https://github.com/dennybritz/chatbot-retrieval/blob/master/udc_predict.py" target="_blank" rel="noopener">udc_predict.py</a> æ¥è¿›è¡Œé¢„æµ‹ï¼›ä¾‹å¦‚ï¼š</p>
<p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">python udc_predict.py --model_dir=./runs/<span class="number">1467576365</span>/</span><br></pre></td></tr></table></figure></p>
<p>ç»“æœå¦‚ä¸‹ï¼š</p>
<p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">Context: Example context</span><br><span class="line">Response 1: 0.44806</span><br><span class="line">Response 2: 0.481638</span><br></pre></td></tr></table></figure></p>
<p>ä½ å¯ä»¥ä»å€™é€‰çš„å›å¤ä¸­ï¼Œé€‰æ‹©é¢„æµ‹åˆ†å€¼æœ€é«˜çš„é‚£ä¸ªä½œä¸ºå›å¤ã€‚</p>
<h3>6.8. æ€»ç»“</h3>
<p>è¿™ç¯‡åšæ–‡ä¸­ï¼Œæˆ‘ä»¬å®ç°äº†ä¸€ä¸ªåŸºäºæ£€ç´¢çš„ NNæ¨¡å‹ï¼Œå®ƒèƒ½å¤Ÿå¯¹å€™é€‰çš„å›å¤è¿›è¡Œé¢„æµ‹å’Œæ‰“åˆ†ï¼Œé€šè¿‡è¾“å‡ºåˆ†å€¼æœ€é«˜ï¼ˆæˆ–è€…æ»¡è¶³ä¸€å®šé˜ˆå€¼ï¼‰çš„å€™é€‰å›å¤å·²å®ŒæˆèŠå¤©çš„è¿‡ç¨‹ã€‚åç»­å¯ä»¥å°è¯•å…¶ä»–æ›´å¥½çš„æ¨¡å‹ï¼Œæˆ–è€…é€šè¿‡è°ƒå‚æ¥å–å¾—æ›´å¥½çš„å®éªŒç»“æœã€‚</p>
<h2>Reference</h2>
<ul>
<li><a href="https://chatterbot.readthedocs.io/en/stable/" target="_blank" rel="noopener">About ChatterBot</a></li>
<li><a href="http://www.wildml.com/2016/04/deep-learning-for-chatbots-part-1-introduction/" target="_blank" rel="noopener">2016 Google Brain deep-learning-for-chatbots-part-1-introduction, wildml blog</a></li>
<li><a href="http://www.wildml.com/2016/07/deep-learning-for-chatbots-2-retrieval-based-model-tensorflow/" target="_blank" rel="noopener">2016 Google Brain deep-learning-for-chatbots-2-retrieval-based-model-tensorflow, wildml blog</a></li>
<li><a href="http://www.jeyzhang.com/deep-learning-for-chatbots-2.html" target="_blank" rel="noopener">èŠå¤©æœºå™¨äººä¸­çš„æ·±åº¦å­¦ä¹ æŠ€æœ¯ä¹‹äºŒï¼šåŸºäºæ£€ç´¢æ¨¡å‹çš„å®ç°</a></li>
<li><a href="http://www.jeyzhang.com/deep-learning-for-chatbots-1.html" target="_blank" rel="noopener">èŠå¤©æœºå™¨äººä¸­çš„æ·±åº¦å­¦ä¹ æŠ€æœ¯ä¹‹ä¸€ï¼šå¯¼è¯»</a></li>
<li><a href="http://www.cnblogs.com/LittleHann/p/6426610.html" target="_blank" rel="noopener">Tensorflowæä¸€ä¸ªèŠå¤©æœºå™¨äºº</a></li>
<li><a href="https://zhuanlan.zhihu.com/p/27285330" target="_blank" rel="noopener">Ericï¼ŒåŸºäºå¤šæœç´¢å¼•æ“çš„è‡ªåŠ¨é—®ç­”æœºå™¨äºº</a></li>
<li><a href="https://my.oschina.net/apdplat/blog/401622" target="_blank" rel="noopener">æµ‹è¯•äººæœºé—®ç­”ç³»ç»Ÿæ™ºèƒ½æ€§çš„3760ä¸ªé—®é¢˜</a></li>
<li><a href="https://zhuanlan.zhihu.com/p/25749274" target="_blank" rel="noopener">ä¸­å›½ç‰ˆçš„èŠå¤©æœºå™¨äººåœ°å›¾ Chatbots Landscape</a></li>
<li><a href="https://blog.csdn.net/SunJW_2017/article/details/82494360" target="_blank" rel="noopener">æ¡ä»¶éšæœºåœºç®€ä»‹</a></li>
<li><a href="https://blog.csdn.net/SunJW_2017/article/details/82460284" target="_blank" rel="noopener">çŸ¥è¯†å›¾è°±å­¦ä¹ ç³»åˆ—ä¹‹äºŒï¼šå‘½åå®ä½“è¯†åˆ«1ï¼ˆæŠ€æœ¯åŠä»£ç ï¼‰</a></li>
</ul>

      
    </div>
	
    <!--
	
    -->
    <!--
    
      <footer class="article-footer">
      </footer>
    
    -->
  </div>
  
</article>



    
      <article id="post-chatbot/chatbot-research4" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <myh11 itemprop="name">
      <a class="article-title-index" href="/2017/08/14/chatbot/chatbot-research4/"><strong>Chatbot Research 4 - æ·±åº¦å­¦ä¹ çŸ¥è¯†å›é¡¾</strong></a>
      <small class=article-date-index>&nbsp; 2017-08-14</small>
      <!--<a>
      <div = post.date  </div>
      </a>-->
      <br>
      <br> <!-- blair add -->
    </myh11>
  


      </header>
    
    <div class="article-meta">
      <!--<a href="/2017/08/14/chatbot/chatbot-research4/" class="article-date">
  <time datetime="2017-08-14T06:00:21.000Z" itemprop="datePublished">2017-08-14</time>
</a>-->
      <!--
  <div class="article-category-index">
    <a class="article-category-index-link" href="/categories/chatbot/">chatbot</a>
  </div>

-->
      <!--
      
        <div class="article-comment-link-wrap">
          <a href="http://iequa.com/2017/08/14/chatbot/chatbot-research4/#disqus_thread" class="article-comment-link">Comments</a>
        </div>
      
      -->
    </div>
	
    <div class="article-entry" itemprop="articleBody">
      
        <p>è¯¥ç¯‡ä¸»è¦ä»‹ç»ä¸€äº› RNNã€LSTM ç­‰æ·±åº¦å­¦ä¹ çŸ¥è¯†ã€‚  <a href="/deeplearning/#5-Sequence-Models">è¯¦æƒ…è¯·æˆ³</a></p>
<p>&lt;!-- more --&gt;</p>
<h2>Reference</h2>
<ul>
<li><a href="https://github.com/Conchylicultor/DeepQA" target="_blank" rel="noopener">2015 DeepQA</a></li>
</ul>

      
    </div>
	
    <!--
	
    -->
    <!--
    
      <footer class="article-footer">
      </footer>
    
    -->
  </div>
  
</article>



    
      <article id="post-chatbot/chatbot-research3" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <myh11 itemprop="name">
      <a class="article-title-index" href="/2017/08/13/chatbot/chatbot-research3/"><strong>Chatbot Research 3 - æœºå™¨å­¦ä¹ æ„å»º chatbot</strong></a>
      <small class=article-date-index>&nbsp; 2017-08-13</small>
      <!--<a>
      <div = post.date  </div>
      </a>-->
      <br>
      <br> <!-- blair add -->
    </myh11>
  


      </header>
    
    <div class="article-meta">
      <!--<a href="/2017/08/13/chatbot/chatbot-research3/" class="article-date">
  <time datetime="2017-08-13T06:00:21.000Z" itemprop="datePublished">2017-08-13</time>
</a>-->
      <!--
  <div class="article-category-index">
    <a class="article-category-index-link" href="/categories/chatbot/">chatbot</a>
  </div>

-->
      <!--
      
        <div class="article-comment-link-wrap">
          <a href="http://iequa.com/2017/08/13/chatbot/chatbot-research3/#disqus_thread" class="article-comment-link">Comments</a>
        </div>
      
      -->
    </div>
	
    <div class="article-entry" itemprop="articleBody">
      
        <p>Chatterbot èŠå¤©æœºå™¨äººæ¡†æ¶</p>
<p>æ£€ç´¢ä¸åŒ¹é… &amp; åˆ†ç±»ä¸æœ´ç´ è´å¶æ–¯</p>
<p>&lt;!-- more --&gt;</p>
<p><strong>å…³äºèŠå¤©æœºå™¨äººçš„æ€è€ƒ</strong></p>
<ol>
<li>å·¥ç¨‹è€ƒé‡</li>
<li>æœºå™¨å­¦ä¹ è§’åº¦è€ƒè™‘</li>
</ol>
<p><strong>é¢„å¤‡çŸ¥è¯†</strong></p>
<ol>
<li>æ£€ç´¢ä¸åŒ¹é…</li>
<li>åˆ†ç±»ä¸æœ´ç´ è´å¶æ–¯</li>
</ol>
<p><strong>chatterbot</strong></p>
<ol>
<li>æ¶æ„ä¸ä½¿ç”¨æ–¹æ³•</li>
<li>æºç åˆ†æ</li>
</ol>
<h2>1. ä¼ ç»ŸèŠå¤©æœºå™¨äºº</h2>
<p>NLP åŸºç¡€çŸ¥è¯†</p>
<blockquote>
<ol>
<li>åŸºæœ¬åˆ†è¯ (jieba)</li>
<li>å…³é”®è¯æŠ½å– (tf-idfç­‰)</li>
<li>æ­£åˆ™è¡¨è¾¾å¼æ¨¡å¼åŒ¹é…</li>
<li>...</li>
</ol>
</blockquote>
<p>Machine Learningç›¸å…³çŸ¥è¯†</p>
<blockquote>
<ol>
<li>æ–‡æœ¬è¡¨ç¤ºä¸åŒ¹é…</li>
<li>åˆ†ç±» (æ–‡æœ¬åœºæ™¯åˆ†æ)</li>
<li>æ•°æ®é©±åŠ¨ (ç‰¹å¾å·¥ç¨‹)</li>
<li>...</li>
</ol>
</blockquote>
<h2>2. èŠå¤©æœºå™¨äººçš„ä¸€äº›æ€è€ƒ</h2>
<p>å·¥ç¨‹è€ƒé‡</p>
<blockquote>
<ul>
<li>æ¶æ„è®¾è®¡æ¸…æ™°ã€æ¨¡å—åŒ–</li>
<li>åŠŸèƒ½åˆ†æ‹†ï¼Œè§£è€¦ï¼Œéƒ¨ä»¶å¯æ’æ‹”ä¸æ‰©å±•</li>
</ul>
</blockquote>
<p>&lt;img src=&quot;/images/chatbot/chatbot-3_1.jpg&quot; width=&quot;600&quot; /&gt;</p>
<p>ç®—æ³•ä¸æœºå™¨å­¦ä¹ è§’åº¦è€ƒé‡</p>
<blockquote>
<ul>
<li>ç®—æ³•ç®€å•ï¼Œæ•°æ®(ç‰¹å¾)é©±åŠ¨</li>
<li>åœºæ™¯åŒ–ä¸å‚ç›´é¢†åŸŸ</li>
</ul>
</blockquote>
<h2>3. é¢„å¤‡çŸ¥è¯†</h2>
<p><strong>åŸºäºæ£€ç´¢ä¸åŒ¹é…</strong></p>
<blockquote>
<ul>
<li>çŸ¥è¯†åº“ (å­˜å‚¨äº†é—®é¢˜ä¸å›å¤å†…å®¹)</li>
<li>æ£€ç´¢: æœå¯»ç›¸å…³é—®é¢˜</li>
<li>åŒ¹é…: å¯¹ç»“æœè¿›è¡Œæ’åº</li>
</ul>
</blockquote>
<p><strong>ç¼–è¾‘è·ç¦»</strong></p>
<blockquote>
<p>ç¼–è¾‘è·ç¦»/Levenshteinè·ç¦»ï¼Œæ˜¯æŒ‡ä¸¤ä¸ªå­—ç¬¦ä¸²ä¹‹é—´ï¼Œç”±ä¸€ä¸ªè½¬æˆå¦ä¸€ä¸ªæ‰€éœ€è¦çš„æœ€å°‘ç¼–è¾‘æ“ä½œæ¬¡æ•°ã€‚</p>
<p>é€’å½’ &amp; åŠ¨æ€è§„åˆ’ DP</p>
</blockquote>
<p>TFIDF</p>
<blockquote>
<p>QA pair çš„ TFIDF çš„ç›¸è¿‘åº¦</p>
<p>S1: &quot;ä½ å–œæ¬¢ä»€ä¹ˆä¹¦&quot;
S2: &quot;ä½ å–œæ¬¢ä»€ä¹ˆç”µå½±&quot;</p>
</blockquote>
<p>python ç¼–è¾‘è·ç¦»</p>
<blockquote>
<p>Pythonåœ¨string ç±»å‹ä¸­ï¼Œé»˜è®¤çš„ utf-8 ç¼–ç ä¸‹ï¼Œä¸€ä¸ªä¸­æ–‡å­—ç¬¦æ˜¯ç”¨ä¸‰ä¸ªå­—èŠ‚æ¥è¡¨ç¤ºçš„ã€‚ç”¨unicodeã€‚</p>
</blockquote>
<p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># -*- coding:utf-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> Levenshtein</span><br><span class="line"></span><br><span class="line">texta = <span class="string">"uå…³é”®æ—¶åˆ»"</span></span><br><span class="line">textb = <span class="string">"uå…³é”®Â·æ—¶åˆ»"</span></span><br><span class="line"></span><br><span class="line">print(Levenshtein.distance(texta,textb)) <span class="comment"># 1</span></span><br></pre></td></tr></table></figure></p>
<h2>4. Chatterbot èŠå¤©æœºå™¨äºº</h2>
<p>&lt;img src=&quot;/images/chatbot/chatbot-3_2.jpg&quot; width=&quot;700&quot; /&gt;</p>
<p><strong>æ¯ä¸ªéƒ¨åˆ†éƒ½è®¾è®¡äº†ä¸åŒçš„ &quot;é€‚é…å™¨&quot;(Adapter)</strong></p>
<p><strong>æœºå™¨äººåº”ç­”é€»è¾‘ =&gt; Logic Adapters</strong></p>
<blockquote>
<ul>
<li>Closest Match Adapter
å­—ç¬¦ä¸²æ¨¡ç³ŠåŒ¹é…(ç¼–è¾‘è·ç¦»)</li>
<li>Closest Meaning Adapter
å€ŸåŠ© nltk çš„ WordNetï¼Œè¿‘ä¹‰è¯è¯„ä¼°</li>
<li>Time Logic Adapter
å¤„ç†æ¶‰åŠæ—¶é—´çš„æé—®</li>
<li>Mathematical Evaluation Adapter    æ¶‰åŠæ•°å­¦è¿ç®—</li>
</ul>
</blockquote>
<p><strong>å­˜å‚¨å™¨åç«¯ =&gt; Storage Adapters</strong></p>
<blockquote>
<ul>
<li>Read Only Mode
åªè¯»æ¨¡å¼ï¼Œå½“æœ‰è¾“å…¥æ•°æ®åˆ° chatterbot çš„æ—¶å€™ï¼Œæ•°æ®åº“å¹¶ä¸ä¼šå‘ç”Ÿæ”¹å˜</li>
<li>Json Database Adapter
ç”¨ä»¥å­˜å‚¨å¯¹è¯æ•°æ®çš„æ¥å£ï¼Œå¯¹è¯æ•°æ®ä»¥ Jsonæ ¼å¼ è¿›è¡Œå­˜å‚¨. (è½½å…¥æ•°æ®ç‰¹åˆ«æ…¢ï¼Œå·¥ä¸šç•Œä¸å¯è¡Œ)</li>
<li>Mongo Database Adapter
ä»¥ MongoDB database æ–¹å¼æ¥å­˜å‚¨å¯¹è¯æ•°æ®</li>
</ul>
</blockquote>
<p><strong>è¾“å…¥å½¢å¼ =&gt; Input Adapters</strong></p>
<blockquote>
<ul>
<li>Variable input type adapter
å…è®¸ chatterbot æ¥æ”¶ä¸åŒç±»å‹çš„è¾“å…¥çš„ï¼Œå¦‚ strings, dictionaries å’ŒStatements</li>
<li>Terminal adapter
ä½¿å¾— ChatterBot å¯ä»¥é€šè¿‡ç»ˆç«¯è¿›è¡Œå¯¹è¯</li>
<li>Speech recognition
è¯­éŸ³è¯†åˆ«è¾“å…¥ï¼Œè¯¦è§ chatterbot-voice</li>
</ul>
</blockquote>
<h2>5. Bayes åˆ†ç±»</h2>
<p><strong>é¢„å¤‡çŸ¥è¯†:åœºæ™¯åˆ†ç±»ä¸NB</strong></p>
<p>&lt;img src=&quot;/images/chatbot/chatbot-3_3.png&quot; width=&quot;400&quot; /&gt;</p>
<h2>Reference</h2>
<ul>
<li><a href="https://github.com/gunthercox/ChatterBot" target="_blank" rel="noopener">github ChatterBot</a></li>
<li><a href="https://chatterbot.readthedocs.io/en/stable/" target="_blank" rel="noopener">Docs Â» About ChatterBot</a></li>
<li><a href="https://blog.xiaoquankong.ai/%E4%BD%BF%E7%94%A8chatterbot%E6%9E%84%E5%BB%BA%E8%87%AA%E5%B7%B1%E7%9A%84%E4%B8%AD%E6%96%87chat(%E9%97%B2%E8%81%8A)%E6%9C%BA%E5%99%A8%E4%BA%BA/" target="_blank" rel="noopener">ä½¿ç”¨chatterbotæ„å»ºè‡ªå·±çš„ä¸­æ–‡chat(é—²èŠ)æœºå™¨äºº/</a></li>
<li><a href="https://www.cnblogs.com/LHWorldBlog/p/9292024.html" target="_blank" rel="noopener">è‡ªç„¶è¯­è¨€å¤„ç† ChatterbotèŠå¤©æœºå™¨äºº</a></li>
<li><a href="https://blog.csdn.net/qifengzou/article/details/77126933" target="_blank" rel="noopener">ç²¾å“: å¼€æºChatterBotå·¥ä½œåŸç†</a></li>
</ul>

      
    </div>
	
    <!--
	
    -->
    <!--
    
      <footer class="article-footer">
      </footer>
    
    -->
  </div>
  
</article>



    
      <article id="post-chatbot/chatbot-research2" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <myh11 itemprop="name">
      <a class="article-title-index" href="/2017/08/12/chatbot/chatbot-research2/"><strong>Chatbot Research 2 - NLPåŸºç¡€çŸ¥è¯†å›é¡¾</strong></a>
      <small class=article-date-index>&nbsp; 2017-08-12</small>
      <!--<a>
      <div = post.date  </div>
      </a>-->
      <br>
      <br> <!-- blair add -->
    </myh11>
  


      </header>
    
    <div class="article-meta">
      <!--<a href="/2017/08/12/chatbot/chatbot-research2/" class="article-date">
  <time datetime="2017-08-12T06:00:21.000Z" itemprop="datePublished">2017-08-12</time>
</a>-->
      <!--
  <div class="article-category-index">
    <a class="article-category-index-link" href="/categories/chatbot/">chatbot</a>
  </div>

-->
      <!--
      
        <div class="article-comment-link-wrap">
          <a href="http://iequa.com/2017/08/12/chatbot/chatbot-research2/#disqus_thread" class="article-comment-link">Comments</a>
        </div>
      
      -->
    </div>
	
    <div class="article-entry" itemprop="articleBody">
      
        <p><a href="http://pypi.python.org/pypi/nltk" target="_blank" rel="noopener">NLTK</a> Pythonä¸Šè‘—åçš„è‡ªç„¶è¯­è¨€å¤„ç†åº“ã€‚</p>
<ul>
<li>è‡ªå¸¦è¯­æ–™åº“ï¼Œè¯æ€§åˆ†ç±»åº“ï¼Œ è¿˜æœ‰å¼ºå¤§çš„ç¤¾åŒºæ”¯æŒã€‚</li>
</ul>
<p>&lt;!-- more --&gt;</p>
<p><strong>æ–‡æœ¬å¤„ç†æµç¨‹</strong></p>
<ul>
<li>åˆ†è¯</li>
<li>å½’ä¸€åŒ–</li>
<li>åœæ­¢è¯</li>
</ul>
<p>**NLPç»å…¸ä¸‰æ¡ˆä¾‹ **</p>
<ul>
<li>æƒ…æ„Ÿåˆ†æ</li>
<li>æ–‡æœ¬ç›¸ä¼¼åº¦</li>
<li>æ–‡æœ¬åˆ†ç±»</li>
</ul>
<blockquote>
<p>æ–¯å¦ä½› CoreNLP (è‹±æ–‡ã€ä¸­æ–‡ã€è¥¿ç­ç‰™è¯­)</p>
</blockquote>
<h2>1. NLTK</h2>
<ol>
<li>Python è‘—åçš„è‡ªç„¶è¯­è¨€å¤„ç†åº“</li>
<li>è‡ªå¸¦è¯­æ–™åº“ã€è¯æ€§åˆ†ç±»åº“</li>
<li>è‡ªå¸¦åˆ†ç±»ã€åˆ†è¯ ç­‰åŠŸèƒ½</li>
<li>å¼ºå¤§çš„ç¤¾åŒºæ”¯æŒ</li>
</ol>
<p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo pip install -U nltk</span><br><span class="line">sudo pip install -U numpy</span><br></pre></td></tr></table></figure></p>
<p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> nltk</span><br><span class="line">nltk.download()</span><br></pre></td></tr></table></figure></p>
<p>&lt;!--&lt;img src=&quot;/images/chatbot/chatbot-2_1.png&quot; width=&quot;400&quot; /&gt;
--&gt;
æµ‹è¯•æ˜¯å¦å®‰è£…æˆåŠŸ</p>
<p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>python</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> nltk</span><br></pre></td></tr></table></figure></p>
<h2>2. åŠŸèƒ½ä¸€è§ˆè¡¨</h2>
<p>&lt;img src=&quot;/images/chatbot/chatbot-2_2.png&quot; width=&quot;800&quot; /&gt;</p>
<p><strong>NLTK è‡ªå¸¦è¯­æ–™åº“</strong></p>
<p>&lt;img src=&quot;/images/chatbot/chatbot-2_3.png&quot; width=&quot;600&quot; /&gt;</p>
<h2>3. Tokenize</h2>
<p><strong>tokenize æŠŠé•¿å¥å­æ‹†æˆæœ‰â€œæ„ä¹‰â€çš„å°éƒ¨ä»¶</strong></p>
<p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> nltk<span class="meta">&gt;&gt;&gt; </span>sentence = â€œhello, world<span class="string">"&gt;&gt;&gt; tokens = nltk.word_tokenize(sentence)&gt;&gt;&gt; tokens['hello', â€˜,', 'world']</span></span><br></pre></td></tr></table></figure></p>
<p><strong>ä¸­æ–‡åˆ†è¯ jieba</strong> (ç¬¬ä¸‰æ–¹å¼€æºåº“)</p>
<p>&lt;img src=&quot;/images/chatbot/chatbot-2_4.png&quot; width=&quot;780&quot; /&gt;</p>
<p><strong>æœ‰æ—¶å€™tokenizeæ²¡é‚£ä¹ˆç®€å•</strong></p>
<blockquote>
<p>æ¯”å¦‚ç¤¾äº¤ç½‘ç»œä¸Š,è¿™äº›ä¹±ä¸ƒå…«ç³Ÿçš„ä¸åˆè¯­æ³•ä¸åˆæ­£å¸¸é€»è¾‘çš„è¯­è¨€å¾ˆå¤š:æ‹¯æ•‘ @æŸäºº, è¡¨æƒ…ç¬¦å·, URL, #è¯é¢˜ç¬¦å·</p>
</blockquote>
<p>&lt;img src=&quot;/images/chatbot/chatbot-2_5.png&quot; width=&quot;650&quot; /&gt;</p>
<p><strong>ç¤¾äº¤ç½‘ç»œè¯­è¨€çš„tokenize :</strong></p>
<p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> nltk.tokenize <span class="keyword">import</span> word_tokenizetweet = <span class="string">'RT @angelababy: love you baby! :D http://ah.love #168cm'</span>print(word_tokenize(tweet))</span><br></pre></td></tr></table></figure></p>
<p>&lt;img src=&quot;/images/chatbot/chatbot-2_6.png&quot; width=&quot;880&quot; /&gt;</p>
<p><a href="http://www.regexlab.com/zh/regref.htm" target="_blank" rel="noopener">æ­£åˆ™è¡¨è¾¾å¼å¯¹ç…§è¡¨</a></p>
<h2>4. è¯å½¢å½’ä¸€åŒ–</h2>
<p>Inflectionå˜åŒ–: walk =&gt; walking =&gt; walked ä¸å½±å“è¯æ€§
derivation å¼•ç”³: nation (noun) =&gt; national (adjective) =&gt; nationalize (verb) å½±å“è¯æ€§</p>
<p>Stemming è¯å¹²æå–:ä¸€èˆ¬æ¥è¯´ï¼Œå°±æ˜¯æŠŠä¸å½±å“è¯æ€§çš„inflectionçš„å°å°¾å·´ç æ‰</p>
<blockquote>
<p>walking ç ing = walk
walked ç ed = walk</p>
</blockquote>
<p>Lemmatization è¯å½¢å½’ä¸€:æŠŠå„ç§ç±»å‹çš„è¯çš„å˜å½¢ï¼Œéƒ½å½’ä¸ºä¸€ä¸ªå½¢å¼</p>
<blockquote>
<p>went å½’ä¸€ = go
are å½’ä¸€ = be</p>
</blockquote>
<h3>4.1 Stemming</h3>
<ol>
<li>PorterStemmer</li>
<li>SnowballStemmer</li>
<li>LancasterStemmer</li>
<li>PorterStemmer</li>
</ol>
<p><strong>PorterStemmer</strong></p>
<p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> nltk.stem.porter <span class="keyword">import</span> PorterStemmer<span class="meta">&gt;&gt;&gt; </span>porter_stemmer = PorterStemmer()<span class="meta">&gt;&gt;&gt; </span>porter_stemmer.stem(â€˜maximumâ€™)uâ€™maximumâ€™<span class="meta">&gt;&gt;&gt; </span>porter_stemmer.stem(â€˜presumablyâ€™)uâ€™presumâ€™</span><br></pre></td></tr></table></figure></p>
<p><strong>LancasterStemmer</strong></p>
<p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> nltk.stem.lancaster <span class="keyword">import</span> LancasterStemmer</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>lancaster_stemmer = LancasterStemmer()</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>lancaster_stemmer.stem(â€˜maximumâ€™)</span><br><span class="line">â€˜maximâ€™</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>lancaster_stemmer.stem(â€˜presumablyâ€™)</span><br><span class="line">â€˜presumâ€™</span><br></pre></td></tr></table></figure>
### 4.2 Lemmatization</p>
<p>è¯å½¢å½’ä¸€ï¼š æŠŠå„ç§ç±»å‹çš„è¯çš„å˜å½¢,éƒ½å½’ä¸ºä¸€ä¸ªå½¢å¼</p>
<p>went å½’ä¸€ = go  are å½’ä¸€ = be</p>
<p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> nltk.stem <span class="keyword">import</span> WordNetLemmatizer<span class="meta">&gt;&gt;&gt; </span>wordnet_lemmatizer = WordNetLemmatizer()<span class="meta">&gt;&gt;&gt; </span>wordnet_lemmatizer.lemmatize(â€˜dogsâ€™)uâ€™dogâ€™<span class="meta">&gt;&gt;&gt; </span>wordnet_lemmatizer.lemmatize(â€˜churchesâ€™)uâ€™churchâ€™<span class="meta">&gt;&gt;&gt; </span>wordnet_lemmatizer.lemmatize(â€˜aardwolvesâ€™)uâ€™aardwolfâ€™</span><br></pre></td></tr></table></figure></p>
<p>NLTKæ›´å¥½åœ°å®ç°Lemma</p>
<p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="comment"># â½Šæœ¨æœ‰POS Tag,é»˜è®¤æ˜¯NN åè¯</span><span class="meta">&gt;&gt;&gt; </span>wordnet_lemmatizer.lemmatize(â€˜areâ€™) <span class="comment"># â€˜areâ€™</span><span class="meta">&gt;&gt;&gt; </span>wordnet_lemmatizer.lemmatize(â€˜<span class="keyword">is</span>â€™)  <span class="comment"># â€˜isâ€™</span><span class="comment"># åŠ ä¸ŠPOS Tag</span><span class="meta">&gt;&gt;&gt; </span>wordnet_lemmatizer.lemmatize(â€˜<span class="keyword">is</span>â€™, pos=â€™vâ€™)  <span class="comment"># uâ€™beâ€™</span><span class="meta">&gt;&gt;&gt; </span>wordnet_lemmatizer.lemmatize(â€˜areâ€™, pos=â€™vâ€™) <span class="comment"># uâ€™beâ€™</span></span><br></pre></td></tr></table></figure></p>
<h3>4.3 NLTK æ ‡æ³¨ POS Tag</h3>
<p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> nltk<span class="meta">&gt;&gt;&gt; </span>text = nltk.word_tokenize(<span class="string">'what does the fox say'</span>)<span class="meta">&gt;&gt;&gt; </span>text[<span class="string">'what'</span>, <span class="string">'does'</span>, <span class="string">'the'</span>, <span class="string">'fox'</span>, <span class="string">'say'</span>]<span class="meta">&gt;&gt;&gt; </span>nltk.pos_tag(text)[(<span class="string">'what'</span>, <span class="string">'WDT'</span>), (<span class="string">'does'</span>, <span class="string">'VBZ'</span>), (<span class="string">'the'</span>, <span class="string">'DT'</span>), (<span class="string">'fox'</span>, <span class="string">'NNS'</span>), (<span class="string">'say'</span>, <span class="string">'VBP'</span>)]</span><br></pre></td></tr></table></figure></p>
<h2>5. Stopwords</h2>
<p>ä¸€åƒä¸ª He æœ‰ä¸€åƒç§æŒ‡ä»£
ä¸€åƒä¸ª The æœ‰ä¸€åƒç§æŒ‡äº‹ å¯¹äºæ³¨é‡ç†è§£æ–‡æœ¬ã€æ„æ€ã€çš„åº”ç”¨åœºæ™¯æ¥è¯´</p>
<p>å…¨ä½“stopwordsåˆ—è¡¨ http://www.ranks.nl/stopwords</p>
<p><strong>å»é™¤ stopwords</strong></p>
<blockquote>
<p>é¦–å…ˆè®°å¾—åœ¨consoleé‡Œé¢ä¸‹è½½ä¸€ä¸‹è¯åº“ï¼Œ æˆ–è€… nltk.download(â€˜stopwordsâ€™)</p>
</blockquote>
<p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> nltk</span><br><span class="line"><span class="keyword">from</span> nltk.corpus <span class="keyword">import</span> stopwords </span><br><span class="line"></span><br><span class="line"><span class="comment"># å…ˆtokenâ¼€ä¸€æŠŠ,å¾—åˆ°â¼€ä¸€ä¸ªword_list</span></span><br><span class="line"></span><br><span class="line">word_list = nltk.word_tokenize(<span class="string">'what does the fox say'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç„¶åfilterâ¼€ä¸€æŠŠ</span></span><br><span class="line"></span><br><span class="line">filtered_words = [word <span class="keyword">for</span> word <span class="keyword">in</span> word_list <span class="keyword">if</span> word <span class="keyword">not</span> <span class="keyword">in</span> stopwords.words(<span class="string">'english'</span>)]</span><br><span class="line"></span><br><span class="line">filtered_words</span><br></pre></td></tr></table></figure></p>
<h2>6. æ–‡æœ¬é¢„å¤„ç†æµæ°´çº¿</h2>
<p>ä¸€æ¡typicalçš„æ–‡æœ¬é¢„å¤„ç†æµæ°´çº¿</p>
<p>&lt;img src=&quot;/images/chatbot/chatbot-2_8.png&quot; width=&quot;320&quot; /&gt;</p>
<p>æ–‡æœ¬é¢„å¤„ç†è®©æˆ‘ä»¬å¾—åˆ°äº†ä»€ä¹ˆ?</p>
<p>&lt;img src=&quot;/images/chatbot/chatbot-2_9.png&quot; width=&quot;320&quot; /&gt;</p>
<h2>7. NLPä¸Šçš„ç»å…¸åº”ç”¨</h2>
<p>æƒ…æ„Ÿåˆ†æ ã€ æ–‡æœ¬ç›¸ä¼¼åº¦ ã€ æ–‡æœ¬åˆ†ç±»</p>
<h3>7.1 æƒ…æ„Ÿåˆ†æ</h3>
<p>&lt;img src=&quot;/images/chatbot/chatbot-2_10.png&quot; width=&quot;720&quot; /&gt;</p>
<p>å“ªäº›æ˜¯å¤¸ä½ ï¼Ÿå“ªäº›æ˜¯é»‘ä½ ï¼Ÿ</p>
<p><strong>MLçš„æƒ…æ„Ÿåˆ†æ</strong></p>
<p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> nltk.classify <span class="keyword">import</span> NaiveBayesClassifier<span class="comment"># éšâ¼¿æ‰‹é€ ç‚¹è®­ç»ƒé›†</span>s1 = <span class="string">'this is a good book'</span>s2 = <span class="string">'this is a awesome book'</span>s3 = <span class="string">'this is a bad book'</span>s4 = <span class="string">'this is a terrible book'</span><span class="function"><span class="keyword">def</span> <span class="title">preprocess</span><span class="params">(s)</span>:</span> <span class="comment"># Func: å¥â¼¦å¤„ç†</span><span class="comment"># è¿™â¾¥ç®€å•çš„â½¤äº†ï¦ºsplit(), æŠŠå¥å­ä¸­æ¯ä¸ªå•è¯åˆ†å¼€ # æ˜¾ç„¶ è¿˜æœ‰æ›´å¤šçš„processing methodå¯ä»¥â½¤ </span></span><br><span class="line">    <span class="keyword">return</span> &#123;word: <span class="literal">True</span> <span class="keyword">for</span> word <span class="keyword">in</span> s.lower().split()&#125;<span class="comment"># returné•¿è¿™æ ·:</span><span class="comment"># &#123;'this': True, 'is':True, 'a':True, 'good':True, 'book':True&#125; # å…¶ä¸­, å‰â¼€ä¸€ä¸ªå«fname, å¯¹åº”æ¯ä¸ªå‡ºç°çš„æ–‡æœ¬å•è¯;</span><span class="comment"># åâ¼€ä¸€ä¸ªå«fval, æŒ‡çš„æ˜¯æ¯ä¸ªâ½‚æ–‡æœ¬å•è¯å¯¹åº”çš„å€¼ã€‚</span><span class="comment"># è¿™â¾¥é‡Œï§©æˆ‘ä»¬â½¤ç”¨æœ€ç®€å•çš„True,æ¥è¡¨ç¤º,è¿™ä¸ªè¯ã€å‡ºç°åœ¨å½“å‰çš„å¥ï¤†â¼¦å­ä¸­ã€çš„æ„ä¹‰ã€‚</span><span class="comment"># å½“ç„¶å•¦, æˆ‘ä»¬ä»¥åå¯ä»¥å‡çº§è¿™ä¸ªâ½…æ–¹ç¨‹, è®©å®ƒå¸¦æœ‰æ›´ï¤åŠ â½œç‰›é€¼çš„fval, æ¯”å¦‚ word2vec</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># æŠŠè®­ç»ƒé›†ç»™åšæˆæ ‡å‡†å½¢å¼</span>training_data = [[preprocess(s1), <span class="string">'pos'</span>],                 [preprocess(s2), <span class="string">'pos'</span>],                 [preprocess(s3), <span class="string">'neg'</span>],                 [preprocess(s4), <span class="string">'neg'</span>]]<span class="comment"># å–‚ç»™modelåƒ</span>model = NaiveBayesClassifier.train(training_data)<span class="comment"># æ‰“å‡ºç»“æœ</span>print(model.classify(preprocess(<span class="string">'this is a good book'</span>)))</span><br></pre></td></tr></table></figure></p>
<h3>7.2 æ–‡æœ¬ç›¸ä¼¼åº¦</h3>
<p><strong>Frequency é¢‘ç‡ç»Ÿè®¡</strong></p>
<p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> nltk</span><br><span class="line"><span class="keyword">from</span> nltk <span class="keyword">import</span> FreqDist</span><br><span class="line"><span class="comment"># åšä¸ªè¯åº“å…ˆ</span></span><br><span class="line">corpus = <span class="string">'this is my sentence '</span> \</span><br><span class="line">           <span class="string">'this is my life '</span> \</span><br><span class="line">           <span class="string">'this is the day'</span></span><br><span class="line"><span class="comment"># éšä¾¿tokenizeä¸€ä¸‹, æ˜¾ç„¶, æ­£å¦‚ä¸Šæ–‡æåˆ°,</span></span><br><span class="line"><span class="comment"># è¿™ï§©å¯ä»¥æ ¹æ®éœ€è¦åšä»»ä½•çš„preprocessing:  stopwords, lemma, stemming, etc.</span></span><br><span class="line"><span class="comment"># å€Ÿâ½¤NLTKçš„FreqDistç»Ÿè®¡â¼€ä¸‹â½‚å­—å‡ºç°çš„é¢‘ç‡ fdist = FreqDist(tokens)</span></span><br><span class="line"><span class="comment"># å®ƒå°±ç±»ä¼¼äºâ¼€ä¸ªDic,  å¸¦ä¸ŠæŸä¸ªå•è¯, å¯ä»¥çœ‹åˆ°å®ƒåœ¨æ•´ä¸ªæ–‡ç« ä¸­å‡ºç°çš„æ¬¡æ•°</span></span><br><span class="line"></span><br><span class="line">tokens = nltk.word_tokenize(corpus) </span><br><span class="line">print(tokens)</span><br><span class="line"><span class="comment"># å¾—åˆ° token å¥½çš„ word list</span></span><br><span class="line"><span class="comment"># ['this', 'is', 'my', 'sentence',</span></span><br><span class="line"><span class="comment"># 'this', 'is', 'my', 'life', 'this', # 'is', 'the', 'day']</span></span><br><span class="line"><span class="comment"># å€Ÿâ½¤ NLTK çš„ FreqDist ç»Ÿè®¡â¼€ä¸‹æ–‡å­—å‡ºç°çš„é¢‘ç‡</span></span><br><span class="line">fdist = FreqDist(tokens)</span><br><span class="line"></span><br><span class="line"><span class="comment"># å®ƒå°±ç±»ä¼¼äºâ¼€ä¸€ä¸ªDict</span></span><br><span class="line"><span class="comment"># å¸¦ä¸ŠæŸä¸ªå•è¯, å¯ä»¥çœ‹åˆ°å®ƒåœ¨æ•´ä¸ªæ–‡ç« ä¸­å‡ºç°çš„æ¬¡æ•°</span></span><br><span class="line">print(fdist[<span class="string">'is'</span>]) <span class="comment">#3</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å¥½, æ­¤åˆ», æˆ‘ä»¬å¯ä»¥æŠŠæœ€å¸¸â½¤çš„50ä¸ªå•è¯æ‹¿å‡ºæ¥ </span></span><br><span class="line">standard_freq_vector = fdist.most_common(<span class="number">50</span>) </span><br><span class="line">size = len(standard_freq_vector) </span><br><span class="line"><span class="keyword">print</span> <span class="string">"size: %s"</span> % (size)</span><br><span class="line">print(standard_freq_vector)</span><br><span class="line"><span class="comment"># [('is', 3), ('this', 3), ('my', 2),</span></span><br><span class="line"><span class="comment"># ('the', 1), ('day', 1), ('sentence', 1),</span></span><br><span class="line"><span class="comment"># ('life', 1)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Func: æŒ‰ç…§å‡ºç°é¢‘ç‡â¼¤å°, è®°å½•ä¸‹æ¯â¼€ä¸ªå•è¯çš„ä½ç½® </span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">position_lookup</span><span class="params">(v)</span>:</span></span><br><span class="line">    res = &#123;&#125;</span><br><span class="line">    counter = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> word <span class="keyword">in</span> v:</span><br><span class="line">        res[word[<span class="number">0</span>]] = counter</span><br><span class="line">        counter += <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"><span class="comment"># æŠŠæ ‡å‡†çš„å•è¯ä½ç½®è®°å½•ä¸‹æ¥</span></span><br><span class="line">standard_position_dict = position_lookup(standard_freq_vector) </span><br><span class="line">print(standard_position_dict)</span><br><span class="line"><span class="comment"># å¾—åˆ°â¼€ä¸ªä½ç½®å¯¹ç…§è¡¨</span></span><br><span class="line"><span class="comment"># &#123;'is': 0, 'the': 3, 'day': 4, 'this': 1, 'sentence': 5, 'my': 2, 'life': 6&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è¿™æ—¶, å¦‚æœæˆ‘ä»¬æœ‰ä¸ªæ–°å¥å­:</span></span><br><span class="line">sentence = <span class="string">'this is cool'</span></span><br><span class="line"><span class="comment"># å…ˆæ–°å»ºâ¼€ä¸ªè·Ÿæˆ‘ä»¬çš„æ ‡å‡†vectoråŒæ ·â¼¤å°çš„å‘é‡ </span></span><br><span class="line">freq_vector = [<span class="number">0</span>] * size</span><br><span class="line"><span class="comment"># ç®€å•çš„Preprocessing</span></span><br><span class="line">tokens = nltk.word_tokenize(sentence) <span class="comment"># å¯¹äºè¿™ä¸ªæ–°å¥â¼¦â¾¥çš„æ¯ä¸€ä¸ªå•è¯</span></span><br><span class="line"><span class="keyword">for</span> word <span class="keyword">in</span> tokens:</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">    <span class="comment"># å¦‚æœåœ¨æˆ‘ä»¬çš„è¯åº“ï§©å‡ºç°è¿‡</span></span><br><span class="line">    <span class="comment"># é‚£ä¹ˆå°±åœ¨"æ ‡å‡†ä½ç½®"ä¸Š+1 </span></span><br><span class="line">        freq_vector[standard_position_dict[word]] += <span class="number">1</span></span><br><span class="line">    <span class="keyword">except</span> KeyError: <span class="comment"># å¦‚æœæ˜¯ä¸ªæ–°è¯, å°± passæ‰</span></span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">print(freq_vector)   <span class="comment"># [1, 1, 0, 0, 0, 0, 0]</span></span><br><span class="line"><span class="comment"># [1, 1, 0, 0, 0, 0, 0]</span></span><br><span class="line"><span class="comment"># ç¬¬ä¸€ä¸ªä½ç½®ä»£è¡¨ is, å‡ºç°äº†ä¸€æ¬¡</span></span><br><span class="line"><span class="comment"># ç¬¬äºŒä¸ªä½ç½®ä»£è¡¨ this, å‡ºç°äº†ä¸€æ¬¡ </span></span><br><span class="line"><span class="comment"># åé¢éƒ½æ²¡æœ‰</span></span><br></pre></td></tr></table></figure></p>
<h3>7.3 æ–‡æœ¬åˆ†ç±» tf-idf</h3>
<p>TF: Term Frequency, è¡¡é‡ä¸€ä¸ªtermåœ¨æ–‡æ¡£ä¸­å‡ºç°å¾—æœ‰å¤šé¢‘ç¹ã€‚</p>
<p>$$
F(t) = (tå‡ºç°åœ¨æ–‡æ¡£ä¸­çš„æ¬¡æ•°) / (æ–‡æ¡£ä¸­çš„termæ€»æ•°)
$$IDF: Inverse Document Frequency, è¡¡é‡ä¸€ä¸ªtermæœ‰å¤šé‡è¦ã€‚ æœ‰äº›è¯å‡ºç°çš„å¾ˆå¤š,ä½†æ˜¯æ˜æ˜¾ä¸æ˜¯å¾ˆæœ‰åµç”¨ã€‚
$$
IDF(t) = log_e(æ–‡æ¡£æ€»æ•° / å«æœ‰tçš„æ–‡æ¡£æ€»æ•°)
$$</p>
<blockquote>
<p><strong>TF-IDF = TF * IDF</strong></p>
<p>ä¸¾ä¸ªæ —å­ğŸŒ° :</p>
<p>ä¸€ä¸ªæ–‡æ¡£æœ‰100ä¸ªå•è¯,å…¶ä¸­å•è¯babyå‡ºç°äº†3æ¬¡ã€‚ é‚£ä¹ˆ,TF(baby) = (3/100) = 0.03.
&gt; å¥½,ç°åœ¨æˆ‘ä»¬å¦‚æœæœ‰10Mçš„æ–‡æ¡£, babyå‡ºç°åœ¨å…¶ä¸­çš„1000ä¸ªæ–‡æ¡£ä¸­ã€‚ é‚£ä¹ˆ,IDF(baby) = log(10,000,000 / 1,000) = 4&gt;&gt; æ‰€ä»¥, TF-IDF(baby) = TF(baby) * IDF(baby) = 0.03 * 4 = 0.12</p>
</blockquote>
<p><strong>nltk implement tf-idf</strong></p>
<p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> nltk.text <span class="keyword">import</span> TextCollection</span><br><span class="line"><span class="comment"># â¾¸å…ˆ, æŠŠæ‰€æœ‰çš„â½‚æ¡£æ”¾åˆ°TextCollectionç±»ä¸­ã€‚</span></span><br><span class="line"><span class="comment"># è¿™ä¸ªç±»ä¼šâ¾ƒåŠ¨å¸®ä½ æ–­ï¤†, åšç»Ÿè®¡, åšè®¡ç®—</span></span><br><span class="line">corpus = TextCollection([<span class="string">'this is sentence one'</span>,</span><br><span class="line">                        <span class="string">'this is sentence two'</span>,</span><br><span class="line">                        <span class="string">'sentence three six'</span>,</span><br><span class="line">                        <span class="string">'this is sentence three'</span>])</span><br><span class="line"><span class="comment"># ç›´æ¥å°±èƒ½ç®—å‡ºtfidf</span></span><br><span class="line"><span class="comment"># (term: â¼€ä¸€å¥ï¤†è¯ä¸­çš„æŸä¸ªterm, text: è¿™å¥ï¤†è¯)</span></span><br><span class="line">print(corpus.tf_idf(<span class="string">'this'</span>, <span class="string">'this is sentence four'</span>))</span><br><span class="line"><span class="comment"># 0.444342</span></span><br><span class="line"><span class="comment"># åŒç†, æ€ä¹ˆå¾—åˆ°â¼€ä¸€ä¸ªæ ‡å‡†â¼¤å°çš„vectoræ¥è¡¨ç¤ºæ‰€æœ‰çš„å¥å­?</span></span><br><span class="line"><span class="comment"># å¯¹äºæ¯ä¸ªæ–°å¥å­</span></span><br><span class="line"><span class="comment">#new_sentence = 'this is sentence five' # éå†â¼€ä¸€éæ‰€æœ‰çš„vocabularyä¸­çš„è¯:</span></span><br><span class="line"><span class="comment">#for word in standard_vocab:</span></span><br><span class="line"><span class="comment">#    print(corpus.tf_idf(word, new_sentence)) # æˆ‘ä»¬ä¼šå¾—åˆ°â¼€ä¸ªå·¨é•¿(=æ‰€æœ‰vocabâ»“åº¦)çš„å‘é‡</span></span><br></pre></td></tr></table></figure></p>

      
    </div>
	
    <!--
	
    -->
    <!--
    
      <footer class="article-footer">
      </footer>
    
    -->
  </div>
  
</article>



    
      <nav id="page-nav">
        <a class="extend prev" rel="prev" href="/page/11/">&amp;laquo; Prev</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/10/">10</a><a class="page-number" href="/page/11/">11</a><span class="page-number current">12</span><a class="page-number" href="/page/13/">13</a><a class="page-number" href="/page/14/">14</a><span class="space">&hellip;</span><a class="page-number" href="/page/18/">18</a><a class="extend next" rel="next" href="/page/13/">Next &amp;raquo;</a>
      </nav>
    

</section>
    <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2019 Blair Chan&nbsp;
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>, theme by <a href="http://github.com/52binge/hexo-theme-blairos" target="_blank" rel="noopener">blairos</a>
    </div>
  </div>
</footer>

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX"],
    tex2jax: {
      inlineMath: [ ['$','$'], ['\\(','\\)'] ],
      displayMath: [ ['$$','$$']],
      processEscapes: true
    }
  });
</script>
<script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML,http://myserver.com/MathJax/config/local/local.js">
</script>

    
<script type="text/javascript"> <!-- add by blair 0724 type=text/javascript -->
  var disqus_shortname = 'blairos-sn';
  
  (function(){
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/count.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>


<script src="/js/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

  </div>
</body>
</html>
