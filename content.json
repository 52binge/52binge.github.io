{"meta":{"title":"Blair's Blog","subtitle":"æ˜¥æœ‰ç™¾èŠ±ç§‹æœ‰æœˆï¼Œå¤æœ‰æ¶¼é¢¨å†¬æœ‰é›ª .","description":"Everyone should not forget his dream","author":"Blair Chan","url":"http://iequa.com","root":"/"},"pages":[{"title":"","date":"2019-10-20T04:30:37.076Z","updated":"2019-10-20T04:30:37.076Z","comments":true,"path":"52binge.blog.src.html","permalink":"http://iequa.com/52binge.blog.src.html","excerpt":"","text":"â€¦or create a new repository on the command lineecho â€œ# 52binge.blog.sourceâ€ &gt;&gt; README.mdgit initgit add README.mdgit commit -m â€œfirst commitâ€git remote add origin https://github.com/52binge/ 52binge.blog.source.gitgit push -u origin master â€¦or push an existing repository from the command linegit remote add origin https://github.com/52binge/ 52binge.blog.source.gitgit push -u origin master â€¦or import code from another repositoryYou can initialize this repository with code from a Subversion, Mercurial, or TFS project."},{"title":"","date":"2021-06-13T16:33:08.861Z","updated":"2021-06-13T16:33:08.861Z","comments":true,"path":"manifest.json","permalink":"http://iequa.com/manifest.json","excerpt":"","text":"{\"short_name\":\"Volantis\",\"name\":\"Volantis\",\"icons\":[{\"src\":\"/assets/favicon/favicon_256.png\",\"type\":\"image/png\",\"sizes\":\"256x256\"},{\"src\":\"/assets/favicon/favicon_192.png\",\"type\":\"image/png\",\"sizes\":\"192x192\"},{\"src\":\"/assets/favicon/favicon_180.png\",\"type\":\"image/png\",\"sizes\":\"180x180\"},{\"src\":\"/assets/favicon/favicon_144.png\",\"type\":\"image/png\",\"sizes\":\"144x144\"},{\"src\":\"/assets/favicon/favicon_128.png\",\"type\":\"image/png\",\"sizes\":\"128x128\"}],\"background_color\":\"#ffffff\",\"theme_color\":\"#ffffff\",\"display\":\"standalone\",\"start_url\":\"./index.html\"}"},{"title":"About","date":"2021-06-15T03:30:48.000Z","updated":"2021-06-16T06:33:53.159Z","comments":true,"path":"about/index.html","permalink":"http://iequa.com/about/index.html","excerpt":"","text":"ğŸ‘¨ğŸ»â€ğŸ“ ğ—ºğ—², always 18 years old, a student, â€ã‚·ãƒ³ã‚¬ãƒãƒ¼ãƒ«ã«ä½ğŸ‡¸ğŸ‡¬ KIMO OTAKU, Lazy dog, vegetable, want to study ielts, speaks no Japanese, no offer, poverty. Welcome to communicate, learn and progress together ! &nbsp;&nbsp; contact: email-to-me. Who am I Blair Chen 90s, a data developer, GTD practitioner, live in Singapore, Singapore. Blair Chen focus on python, data engineering, data modeling, computer science. Recent me Classic line å‹æƒ…è§€ï¼š Whatever you do in this life, itâ€™s not legendary, unless your friends are there to see it. äººç”Ÿè§€ï¼š Life is full of changes. One day you have an apartment, the next day itâ€™s a house of dumplings. But the important stuff doesnâ€™t change. To the important stuff. æ„›æƒ…è§€ï¼š When youâ€™re single, and your friends start to get married, every wedding invitation presents a strange moment of self-evaluation: â€œWill you be bringing a guest, or will you be attending alone?â€ Contact me You can find me in these ways: Email Twitter Instagram Github You can continue to fellow this blog and comment by DISQUS ChangeLog 2021-06-13 : Blair Chan, theme volantis research.. 2017-10-08 : Blair Chan, blairos theme improve.. 2016-03-22 : Blair Chan, build this blog website"},{"title":"About","date":"2021-06-15T03:30:48.000Z","updated":"2021-06-16T05:55:44.998Z","comments":true,"path":"aboutMe/index.html","permalink":"http://iequa.com/aboutMe/index.html","excerpt":"","text":"ğŸ‘¨ğŸ»â€ğŸ“ ğ—ºğ—², always 18 years old, a student, â€ã‚·ãƒ³ã‚¬ãƒãƒ¼ãƒ«ã«ä½ğŸ‡¸ğŸ‡¬ KIMO OTAKU, Lazy dog, vegetable, want to study ielts, speaks no Japanese, no offer, poverty. Welcome to communicate, learn and progress together ! &nbsp;&nbsp;&nbsp; contact: email-to-me. Who am I Blair Chen 90s, a data developer, GTD practitioner, live in Singapore, Singapore. Blair Chen focus on python, data engineering, data modeling, computer science. Recent me Classic line å‹æƒ…è§€ï¼š Whatever you do in this life, itâ€™s not legendary, unless your friends are there to see it. äººç”Ÿè§€ï¼š Life is full of changes. One day you have an apartment, the next day itâ€™s a house of dumplings. But the important stuff doesnâ€™t change. To the important stuff. æ„›æƒ…è§€ï¼š When youâ€™re single, and your friends start to get married, every wedding invitation presents a strange moment of self-evaluation: â€œWill you be bringing a guest, or will you be attending alone?â€ Contact me You can find me in these ways: Email Twitter Instagram Github You can continue to fellow this blog and comment by DISQUS ChangeLog 2021-06-13 : Blair Chen, theme volantis research.. 2017-10-08 : Blair Chen, blairos theme improve.. 2016-03-22 : Blair Chen, build this blog website"},{"title":"","date":"2020-12-07T00:05:52.079Z","updated":"2020-12-07T00:05:52.078Z","comments":true,"path":"ai/index.html","permalink":"http://iequa.com/ai/index.html","excerpt":"","text":"NLP çš„å‘å±•NLP ç¥ç»ç½‘ç»œå‘å±•å†å²ä¸­æœ€é‡è¦çš„ 8 ä¸ªé‡Œç¨‹ç¢‘ Language Model (è¯­è¨€æ¨¡å‹å°±æ˜¯è¦çœ‹åˆ°ä¸Šæ–‡é¢„æµ‹ä¸‹æ–‡, So NNLM) n-gram modelï¼ˆnå…ƒæ¨¡å‹ï¼‰ï¼ˆåŸºäº é©¬å°”å¯å¤«å‡è®¾ æ€æƒ³ï¼‰ä¸Šä¸‹æ–‡ç›¸å…³çš„ç‰¹æ€§ å»ºç«‹æ•°å­¦æ¨¡å‹ã€‚ 2001 - NNLM , @Bengio , ç«äº 2013 å¹´ï¼Œ æ²‰å¯‚åå¹´ç»ˆæ—¶æ¥è¿è½¬ã€‚ ä½†å¾ˆå¿«åˆè¢«NLPå·¥ä½œè€…ç¥­å…¥ç¥æ®¿ã€‚ 2008 - Multi-task learning 2013 - Word2Vec (Word Embeddingçš„å·¥å…·word2vec : CBOW å’Œ Skip-gram) 2014 - sequence-to-sequence 2015 - Attention 2015 - Memory-based networks 2018 - Pretrained language models good å¼ ä¿Šæ—: æ·±åº¦å­¦ä¹ ä¸­çš„æ³¨æ„åŠ›æ¨¡å‹ï¼ˆ2017ç‰ˆï¼‰ good å¼ ä¿Šæ—: ä»Word Embeddingåˆ°Bertæ¨¡å‹â€”è‡ªç„¶è¯­è¨€å¤„ç†ä¸­çš„é¢„è®­ç»ƒæŠ€æœ¯å‘å±•å² 1. Language Model P(w_{i}|w_{1}, w_{2}, ..., w_{i-1}) = P(w_i | w_{i-N+1}, w_{i-N+2}, ..., w_{i-1})2. Perplexityè®¡ç®—perplexityçš„å…¬å¼å¦‚ä¸‹ï¼š perplexity åˆ»ç”»çš„æ˜¯è¯­è¨€æ¨¡å‹é¢„æµ‹ä¸€ä¸ªè¯­è¨€æ ·æœ¬çš„èƒ½åŠ›. æ¯”å¦‚å·²ç»çŸ¥é“ (w1,w2,w3,â€¦,wm) è¿™å¥è¯ä¼šå‡ºç°åœ¨è¯­æ–™åº“ä¹‹ä¸­ï¼Œé‚£ä¹ˆé€šè¿‡è¯­è¨€æ¨¡å‹è®¡ç®—å¾—åˆ°çš„è¿™å¥è¯çš„æ¦‚ç‡è¶Šé«˜ï¼Œè¯´æ˜è¯­è¨€æ¨¡å‹å¯¹è¿™ä¸ªè¯­æ–™åº“æ‹Ÿåˆå¾—è¶Šå¥½ã€‚ perplexity å®é™…æ˜¯è®¡ç®—æ¯ä¸€ä¸ªå•è¯å¾—åˆ°çš„æ¦‚ç‡å€’æ•°çš„ å‡ ä½•å¹³å‡(geometric mean) ï¼Œå› æ­¤ perplexity å¯ä»¥ç†è§£ä¸ºå¹³å‡åˆ†æ”¯ç³»æ•°ï¼ˆaverage branching factorï¼‰ï¼Œå³æ¨¡å‹é¢„æµ‹ä¸‹ä¸€ä¸ªè¯æ—¶çš„å¹³å‡å¯é€‰æ‹©æ•°é‡ã€‚ å‚è§ï¼š arithmetic average vs geometric mean åœ¨è¯­è¨€æ¨¡å‹çš„è®­ç»ƒä¸­ï¼Œé€šå¸¸é‡‡ç”¨ perplexity çš„ log è¡¨è¾¾å½¢å¼ï¼š ç›¸æ¯”è¾ƒä¹˜ç§¯æ±‚å¹³æ–¹æ ¹çš„æ–¹å¼ï¼ŒåŠ æ³•çš„å½¢å¼å¯åŠ é€Ÿè®¡ç®—ï¼ŒåŒæ—¶é¿å…æ¦‚ç‡ä¹˜ç§¯æ•°å€¼è¿‡å°è€Œå¯¼è‡´æµ®ç‚¹æ•°å‘ä¸‹æº¢å‡ºçš„é—®é¢˜. åœ¨æ•°å­¦ä¸Šï¼Œlog perplexity å¯ä»¥çœ‹ä½œçœŸå®åˆ†å¸ƒä¸é¢„æµ‹åˆ†å¸ƒä¹‹é—´çš„äº¤å‰ç†µ Cross Entropy, äº¤å‰ç†µæè¿°äº†ä¸¤ä¸ªæ¦‚ç‡åˆ†å¸ƒä¹‹é—´çš„ä¸€ç§è·ç¦». log perplexity å’Œ Cross Entropy æ˜¯ç­‰ä»·çš„ 2. Recurrent Neural Networks è¾“å…¥å’Œè¾“å‡ºçš„é•¿åº¦ä¸å°½ç›¸åŒ æ— æ³•å…±äº«ä»å…¶ä»–ä½ç½®å­¦æ¥çš„ç‰¹å¾ å¾ˆå¤šæ•°æ®æ˜¯ä»¥åºåˆ—å½¢å¼å­˜åœ¨çš„ï¼Œä¾‹å¦‚æ–‡æœ¬ã€è¯­éŸ³ã€è§†é¢‘ã€ç‚¹å‡»æµç­‰ç­‰ã€‚ Typical RNN Structure: åœ¨ $h_T$ åé¢ç›´æ¥æ¥ä¸€ä¸ª Softmax å±‚ï¼Œè¾“å‡ºæ–‡æœ¬æ‰€å±ç±»åˆ«çš„é¢„æµ‹æ¦‚ç‡ $y$ï¼Œå°±å¯ä»¥å®ç°æ–‡æœ¬åˆ†ç±». å¯åº”ç”¨äºå¤šç§å…·ä½“ä»»åŠ¡ï¼š net_{t}=U x_{t}+W h_{t-1} h_{t}=f\\left(\\text {net}_{t}\\right) y=g\\left(V h_{T}\\right)å…¶ä¸­ $f$ å’Œ $g$ ä¸ºæ¿€æ´»å‡½æ•°ï¼Œ$U$ ä¸ºè¾“å…¥å±‚åˆ°éšå«å±‚çš„æƒé‡çŸ©é˜µï¼Œ$W$ ä¸ºéšå«å±‚ä»ä¸Šä¸€æ—¶åˆ»åˆ°ä¸‹ä¸€æ—¶åˆ»çŠ¶æ€è½¬ç§»çš„æƒé‡çŸ©é˜µã€‚åœ¨æ–‡æœ¬åˆ†ç±»ä»»åŠ¡ä¸­ï¼Œ$f$ å¯ä»¥é€‰å– Tanh å‡½æ•°æˆ–è€… ReLU å‡½æ•°ï¼Œ$g$ å¯ä»¥é‡‡ç”¨ Softmax å‡½æ•°ã€‚ TensorFlow RNN æ›´å¤šè¯¦æƒ…å‚è§æœ¬åšï¼š TensorFlowï¼šç¬¬8ç«  Recurrent Neural Networks 1 RNN ä¼˜ç‚¹ï¼š æœ€å¤§ç¨‹åº¦æ•æ‰ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼Œè¿™å¯èƒ½æœ‰åˆ©äºæ•è·é•¿æ–‡æœ¬çš„è¯­ä¹‰ã€‚ RNN ç¼ºç‚¹ï¼š æ˜¯ä¸€ä¸ªæœ‰åå€šçš„æ¨¡å‹ï¼Œåœ¨è¿™ä¸ªæ¨¡å‹ä¸­ï¼Œåé¢çš„å•è¯æ¯”å…ˆå‰çš„å•è¯æ›´å…·ä¼˜åŠ¿ã€‚å› æ­¤ï¼Œå½“å®ƒè¢«ç”¨äºæ•è·æ•´ä¸ªæ–‡æ¡£çš„è¯­ä¹‰æ—¶ï¼Œå®ƒå¯èƒ½ä¼šé™ä½æ•ˆç‡ï¼Œå› ä¸ºå…³é”®ç»„ä»¶å¯èƒ½å‡ºç°åœ¨æ–‡æ¡£ä¸­çš„ä»»ä½•åœ°æ–¹ï¼Œè€Œä¸æ˜¯æœ€åã€‚ Recurrent Neural Networks 3. NNLMNNLM,ç›´æ¥ä»è¯­è¨€æ¨¡å‹å‡ºå‘ï¼Œå°†æ¨¡å‹æœ€ä¼˜åŒ–è¿‡ç¨‹è½¬åŒ–ä¸ºæ±‚è¯å‘é‡è¡¨ç¤ºçš„è¿‡ç¨‹. ä½¿ç”¨è¯åµŒä¸‰æ­¥ è·å¾—è¯åµŒï¼šè·å¾—çš„æ–¹å¼å¯ä»¥é€šè¿‡è®­ç»ƒå¤§çš„æ–‡æœ¬é›†æˆ–è€…ä¸‹è½½å¾ˆå¤šå¼€æºçš„è¯åµŒåº“ åº”ç”¨è¯åµŒï¼šå°†è·å¾—çš„è¯åµŒåº”ç”¨åœ¨æˆ‘ä»¬çš„è®­ç»ƒä»»åŠ¡ä¸­ å¯é€‰ï¼šé€šè¿‡æˆ‘ä»¬çš„è®­ç»ƒä»»åŠ¡æ›´æ–°è¯åµŒåº“ï¼ˆå¦‚æœè®­ç»ƒé‡å¾ˆå°å°±ä¸è¦æ›´æ–°äº†ï¼‰ 4. word2vecword2vec å¹¶ä¸æ˜¯ä¸€ä¸ªæ¨¡å‹ï¼Œ è€Œæ˜¯ä¸€ä¸ª 2013å¹´ google å‘è¡¨çš„å·¥å…·. è¯¥å·¥å…·åŒ…å«2ä¸ªæ¨¡å‹ï¼š Skip-Gram CBOW. è¯¥å·¥å…·åŒ…å«2ç§é«˜æ•ˆè®­ç»ƒæ–¹æ³•ï¼š negative sampling hierarchicam softmax. è¯å‘é‡ï¼ˆè¯çš„ç‰¹å¾å‘é‡ï¼‰æ—¢èƒ½å¤Ÿé™ä½ç»´åº¦ï¼Œåˆèƒ½å¤Ÿcaptureåˆ°å½“å‰è¯åœ¨æœ¬å¥å­ä¸­ä¸Šä¸‹æ–‡çš„ä¿¡æ¯ CBOW (context(W)-&gt;center) çº é”™ : ä¸Šå›¾â€ç›®æ ‡å‡½æ•°â€œçš„ç¬¬ä¸€ä¸ªå…¬å¼ï¼Œåº”è¯¥æ˜¯ è¿ä¹˜ å…¬å¼ï¼Œä¸æ˜¯ è¿åŠ  è¿ç®—ã€‚ ç†è§£ : èƒŒæ™¯è¯å‘é‡ä¸ ä¸­å¿ƒè¯å‘é‡ å†…ç§¯ ç­‰éƒ¨åˆ†ï¼Œä½ å¯è€ƒè™‘ softmax $w * x+b$ ä¸­ $x$ å’Œ $w$ çš„å…³ç³»æ¥ç†è§£. 4.1 Negative Sampling 1ï¼‰å¦‚ä½•é€šè¿‡ä¸€ä¸ªæ­£ä¾‹å’Œnegä¸ªè´Ÿä¾‹è¿›è¡ŒäºŒå…ƒé€»è¾‘å›å½’å‘¢ï¼Ÿ 2ï¼‰ å¦‚ä½•è¿›è¡Œè´Ÿé‡‡æ ·å‘¢ï¼Ÿ å¦‚ä½•è¿›è¡Œ negative samplingï¼Ÿ æ¯ä¸ªè¯ğ‘¤çš„çº¿æ®µé•¿åº¦ç”±ä¸‹å¼å†³å®šï¼š len(w) = \\frac{count(w)}{\\sum\\limits_{u \\in vocab} count(u)} åœ¨word2vecä¸­ï¼Œåˆ†å­å’Œåˆ†æ¯éƒ½å–äº†3/4æ¬¡å¹‚å¦‚ä¸‹ï¼š len(w) = \\frac{count(w)^{3/4}}{\\sum\\limits_{u \\in vocab} count(u)^{3/4}} è´Ÿé‡‡æ ·è¿™ä¸ªç‚¹å¼•å…¥ word2vec éå¸¸å·§å¦™ï¼Œä¸¤ä¸ªä½œç”¨ï¼Œ åŠ é€Ÿäº†æ¨¡å‹è®¡ç®— ä¿è¯äº†æ¨¡å‹è®­ç»ƒçš„æ•ˆæœ ç¬¬ä¸€ï¼Œmodel æ¯æ¬¡åªéœ€è¦æ›´æ–°é‡‡æ ·çš„è¯çš„æƒé‡ï¼Œä¸ç”¨æ›´æ–°æ‰€æœ‰çš„æƒé‡ï¼Œé‚£æ ·ä¼šå¾ˆæ…¢ã€‚ ç¬¬äºŒï¼Œä¸­å¿ƒè¯å…¶å®åªè·Ÿå®ƒå‘¨å›´çš„è¯æœ‰å…³ç³»ï¼Œä½ç½®ç¦»ç€å¾ˆè¿œçš„è¯æ²¡æœ‰å…³ç³»ï¼Œä¹Ÿæ²¡å¿…è¦åŒæ—¶è®­ç»ƒæ›´æ–°ï¼Œä½œè€…è¿™ç‚¹èªæ˜. good, word2vec Negative Sampling åˆ˜å»ºå¹³Pinard 4.2 Hierarchicam Softmax çŸ¥ä¹: Huffman Tree ç»™å®šnæƒå€¼ä½œä¸ºnä¸ªå¶å­èŠ‚ç‚¹ï¼Œæ„é€ ä¸€æ£µäºŒå‰æ ‘ï¼Œè‹¥è¿™æ£µäºŒå‰æ ‘çš„å¸¦æƒè·¯å¾„é•¿åº¦è¾¾åˆ°æœ€å°ï¼Œåˆ™ç§°è¿™æ ·çš„äºŒå‰æ ‘ä¸ºæœ€ä¼˜äºŒå‰æ ‘ï¼Œä¹Ÿç§°ä¸ºHuffmanæ ‘ã€‚ word2vec vs glove ç›®æ ‡å‡½æ•°ä¸åŒ ï¼ˆcrossentrpy vs å¹³æ–¹æŸå¤±å‡½æ•°ï¼‰ glove å…¨å±€ç»Ÿè®¡å›ºå®šè¯­æ–™ä¿¡æ¯ word2vec æ˜¯å±€éƒ¨è¯­æ–™åº“è®­ç»ƒçš„ï¼Œå…¶ç‰¹å¾æå–æ˜¯åŸºäºæ»‘çª—çš„ï¼›è€Œgloveçš„æ»‘çª—æ˜¯ä¸ºäº†æ„å»ºco-occurance matrixï¼Œæ˜¯åŸºäºå…¨å±€è¯­æ–™çš„ï¼Œå¯è§gloveéœ€è¦äº‹å…ˆç»Ÿè®¡å…±ç°æ¦‚ç‡ï¼›å› æ­¤ï¼Œword2vecå¯ä»¥è¿›è¡Œåœ¨çº¿å­¦ä¹ ï¼Œgloveåˆ™éœ€è¦ç»Ÿè®¡å›ºå®šè¯­æ–™ä¿¡æ¯ã€‚ æ€»ä½“æ¥çœ‹ï¼Œglove å¯ä»¥è¢«çœ‹ä½œæ˜¯æ›´æ¢äº†ç›®æ ‡å‡½æ•°å’Œæƒé‡å‡½æ•°çš„å…¨å±€ word2vecã€‚ 5. fastTextFastTextæ˜¯ä¸€ä¸ªå¿«é€Ÿæ–‡æœ¬åˆ†ç±»ç®—æ³•ï¼Œåœ¨ä½¿ç”¨æ ‡å‡†å¤šæ ¸CPUçš„æƒ…å†µä¸‹ï¼Œåœ¨10åˆ†é’Ÿå†…å¯ä»¥å¯¹è¶…è¿‡10äº¿ä¸ªå•è¯è¿›è¡Œè®­ç»ƒã€‚ ä¸éœ€è¦ä½¿ç”¨é¢„å…ˆè®­ç»ƒå¥½çš„è¯å‘é‡ï¼Œå› ä¸ºFastTextä¼šè‡ªå·±è®­ç»ƒè¯å‘é‡ã€‚ fastText èƒ½å¤Ÿåšåˆ°æ•ˆæœå¥½ï¼Œé€Ÿåº¦å¿«ï¼Œä¸»è¦ä¾é ä¸¤ä¸ªç§˜å¯†æ­¦å™¨ï¼š ç»“æ„ä¸CBOWç±»ä¼¼ï¼Œä½†å­¦ä¹ ç›®æ ‡æ˜¯äººå·¥æ ‡æ³¨çš„åˆ†ç±»ç»“æœï¼› ç”¨åˆ°äº† å±‚æ¬¡åŒ–Softmaxå›å½’ (Hierarchical Softmax) çš„è®­ç»ƒ trick. å¼•å…¥ N-gramï¼Œè€ƒè™‘è¯åºç‰¹å¾ï¼› å¼•å…¥ subword æ¥å¤„ç†é•¿è¯ï¼Œå¤„ç†æœªç™»é™†è¯é—®é¢˜ï¼› 6. Seq2Seq Source å’Œ Target åˆ†åˆ«ç”±å„è‡ªçš„å•è¯åºåˆ—æ„æˆï¼š Source = ({x}_1, {x}_2, ..., {x}_m) Target = ({y}_1, {y}_2, ..., {y}_n)Encoder é¡¾åæ€ä¹‰å°±æ˜¯å¯¹è¾“å…¥å¥å­Sourceè¿›è¡Œç¼–ç ï¼Œå°†è¾“å…¥å¥å­é€šè¿‡éçº¿æ€§å˜æ¢è½¬åŒ–ä¸ºä¸­é—´è¯­ä¹‰è¡¨ç¤ºCï¼š C = F({x}_1, {x}_2, ..., {x}_m)å¯¹äº Decoder æ¥è¯´ï¼Œå…¶ä»»åŠ¡æ˜¯æ ¹æ®å¥å­ Source çš„ ä¸­é—´è¯­ä¹‰è¡¨ç¤º C å’Œ ä¹‹å‰å·²ç»ç”Ÿæˆçš„å†å²ä¿¡æ¯ ({y}_1, {y}_2, ..., {y}_{i-1})æ¥ç”Ÿæˆ iæ—¶åˆ» è¦ç”Ÿæˆçš„å•è¯ ${y}_{i}$ y_{i} = g(C, {y}_1, {y}_2, ..., {y}_{i-1}) æ¯ä¸ª $y_i$ éƒ½ä¾æ¬¡è¿™ä¹ˆäº§ç”Ÿï¼Œé‚£ä¹ˆçœ‹èµ·æ¥å°±æ˜¯æ•´ä¸ªç³»ç»Ÿæ ¹æ®è¾“å…¥ å¥å­Source ç”Ÿæˆäº†ç›®æ ‡å¥å­Targetã€‚ (1). å¦‚æœSourceæ˜¯ä¸­æ–‡å¥å­ï¼ŒTargetæ˜¯è‹±æ–‡å¥å­ï¼Œé‚£ä¹ˆè¿™å°±æ˜¯è§£å†³æœºå™¨ç¿»è¯‘é—®é¢˜ï¼›(2). å¦‚æœSourceæ˜¯ä¸€ç¯‡æ–‡ç« ï¼ŒTargetæ˜¯æ¦‚æ‹¬æ€§çš„å‡ å¥æè¿°è¯­å¥ï¼Œé‚£ä¹ˆè¿™æ˜¯æ–‡æœ¬æ‘˜è¦ï¼›(3). å¦‚æœSourceæ˜¯ä¸€å¥é—®å¥ï¼ŒTargetæ˜¯ä¸€å¥å›ç­”ï¼Œé‚£ä¹ˆè¿™æ˜¯é—®ç­”ç³»ç»Ÿã€‚ åœ¨æ¨¡å‹è®­ç»ƒä¸­ï¼Œæ‰€æœ‰è¾“å‡ºåºåˆ—æŸå¤±çš„å‡å€¼é€šå¸¸ä½œä¸ºéœ€è¦æœ€å°åŒ–çš„æŸå¤±å‡½æ•°ã€‚ train seq2seq model æ ¹æ®æœ€å¤§ä¼¼ç„¶ä¼°è®¡ï¼Œæˆ‘ä»¬å¯ä»¥æœ€å¤§åŒ–è¾“å‡ºåºåˆ—åŸºäºè¾“å…¥åºåˆ—çš„æ¡ä»¶æ¦‚ç‡ \\begin{split}\\begin{aligned} {P}(y_1, \\ldots, y_{T'} \\mid x_1, \\ldots, x_T) &= \\prod_{t'=1}^{T'} {P}(y_{t'} \\mid y_1, \\ldots, y_{t'-1}, x_1, \\ldots, x_T)\\\\\\\\ &= \\prod_{t'=1}^{T'} {P}(y_{t'} \\mid y_1, \\ldots, y_{t'-1}, \\boldsymbol{c}), \\end{aligned}\\end{split}å¹¶å¾—åˆ°è¯¥è¾“å‡ºåºåˆ—çš„æŸå¤± - \\log{P}(y_1, \\ldots, y_{T'} \\mid x_1, \\ldots, x_T) = -\\sum_{t'=1}^{T'} \\log {P}(y_{t'} \\mid y_1, \\ldots, y_{t'-1}, \\boldsymbol{c}), åœ¨ train ä¸­ï¼Œæ‰€æœ‰è¾“å‡ºåºåˆ—æŸå¤±çš„å‡å€¼é€šå¸¸ä½œä¸ºéœ€è¦æœ€å°åŒ–çš„æŸå¤±å‡½æ•°ã€‚ åœ¨ predict ä¸­ï¼Œæˆ‘ä»¬éœ€è¦å°†decodeåœ¨ä¸Šä¸€ä¸ªæ—¶é—´æ­¥çš„è¾“å‡ºä½œä¸ºå½“å‰æ—¶é—´æ­¥çš„è¾“å…¥ Or teacher forcingã€‚ summary Encoderâ€”Decoderï¼ˆseq2seqï¼‰å¯ä»¥è¾“å…¥å¹¶è¾“å‡ºä¸å®šé•¿çš„åºåˆ—ã€‚Encoderâ€”Decoder ä½¿ç”¨äº†ä¸¤ä¸ª RNN . Encoderâ€”Decoder çš„è®­ç»ƒä¸­ï¼Œæˆ‘ä»¬å¯ä»¥é‡‡ç”¨ teacher forcingã€‚(è¿™ä¹Ÿæ˜¯ Seq2Seq 2 çš„å†…å®¹) å°†sourceè¿›è¡Œååºè¾“å…¥ï¼šè¾“å…¥çš„æ—¶å€™å°†â€œABCâ€å˜æˆâ€œCBAâ€ï¼Œè¿™æ ·åšçš„å¥½å¤„æ˜¯è§£å†³äº†é•¿åºåˆ—çš„long-termä¾èµ–ï¼Œä½¿å¾—æ¨¡å‹å¯ä»¥å­¦ä¹ åˆ°æ›´å¤šçš„å¯¹åº”å…³ç³»ï¼Œä»è€Œè¾¾åˆ°æ¯”è¾ƒå¥½çš„æ•ˆæœã€‚ Beam Searchï¼šè¿™æ˜¯åœ¨testæ—¶çš„æŠ€å·§ï¼Œä¹Ÿå°±æ˜¯åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ä¸ä¼šä½¿ç”¨ã€‚ 7. Attentionè¯·åŠ¡å¿…è¦é˜…è¯»ï¼š å¼ ä¿Šæ— æ·±åº¦å­¦ä¹ ä¸­çš„æ³¨æ„åŠ›æ¨¡å‹ï¼ˆ2017ç‰ˆï¼‰ Attention æœ¬è´¨æ€æƒ³ æŠŠAttentionæœºåˆ¶ä»ä¸Šæ–‡è®²è¿°ä¾‹å­ä¸­çš„Encoder-Decoderæ¡†æ¶ä¸­å‰¥ç¦»ï¼Œå¹¶è¿›ä¸€æ­¥åšæŠ½è±¡ï¼Œå¯ä»¥æ›´å®¹æ˜“æ‡‚: Attention çš„ä¸‰é˜¶æ®µ ç¬¬ä¸€ä¸ªé˜¶æ®µæ ¹æ®Queryå’ŒKeyè®¡ç®—ä¸¤è€…çš„ç›¸ä¼¼æ€§æˆ–è€…ç›¸å…³æ€§ï¼› ç¬¬äºŒä¸ªé˜¶æ®µå¯¹ç¬¬ä¸€é˜¶æ®µçš„åŸå§‹åˆ†å€¼è¿›è¡Œå½’ä¸€åŒ–å¤„ç†ï¼› æ ¹æ®æƒé‡ç³»æ•°å¯¹Valueè¿›è¡ŒåŠ æƒæ±‚å’Œã€‚ 8. GPT &amp; ELMOELMO: Embedding from Language Models ELMOçš„è®ºæ–‡é¢˜ç›®ï¼šâ€œDeep contextualized word representationâ€ NAACL 2018 æœ€ä½³è®ºæ–‡ - ELMOï¼š Deep contextualized word representation ELMO æœ¬èº«æ˜¯ä¸ªæ ¹æ®å½“å‰ä¸Šä¸‹æ–‡å¯¹Word EmbeddingåŠ¨æ€è°ƒæ•´çš„æ€è·¯ã€‚ ELMO æœ‰ä»€ä¹ˆç¼ºç‚¹ï¼Ÿ LSTM æŠ½å–ç‰¹å¾èƒ½åŠ›è¿œå¼±äº Transformer æ‹¼æ¥æ–¹å¼åŒå‘èåˆç‰¹å¾èƒ½åŠ›åå¼± GPT (Generative Pre-Training) ç¬¬ä¸€ä¸ªé˜¶æ®µæ˜¯åˆ©ç”¨ language è¿›è¡Œ Pre-Training. ç¬¬äºŒé˜¶æ®µé€šè¿‡ Fine-tuning çš„æ¨¡å¼è§£å†³ä¸‹æ¸¸ä»»åŠ¡ã€‚ GPT: æœ‰ä»€ä¹ˆç¼ºç‚¹ï¼Ÿ è¦æ˜¯æŠŠ language model æ”¹é€ æˆåŒå‘å°±å¥½äº† ä¸å¤ªä¼šç‚’ä½œï¼ŒGPT ä¹Ÿæ˜¯éå¸¸é‡è¦çš„å·¥ä½œ. Bert äº®ç‚¹ : æ•ˆæœå¥½ å’Œ æ™®é€‚æ€§å¼º Transformer ç‰¹å¾æŠ½å–å™¨ Language Model ä½œä¸ºè®­ç»ƒä»»åŠ¡ (åŒå‘) Bert é‡‡ç”¨å’Œ GPT å®Œå…¨ç›¸åŒçš„ ä¸¤é˜¶æ®µ æ¨¡å‹ï¼š Pre-Train Language Modelï¼› Fine-&gt; Tuningæ¨¡å¼è§£å†³ä¸‹æ¸¸ä»»åŠ¡ã€‚ 9. TransformerTransformer æ”¹è¿›äº†RNNæœ€è¢«äººè¯Ÿç—…çš„è®­ç»ƒæ…¢çš„ç¼ºç‚¹ï¼Œåˆ©ç”¨self-attentionæœºåˆ¶å®ç°å¿«é€Ÿå¹¶è¡Œã€‚ Transformer å¯ä»¥å¢åŠ åˆ°éå¸¸æ·±çš„æ·±åº¦ï¼Œå……åˆ†å‘æ˜DNNæ¨¡å‹çš„ç‰¹æ€§ï¼Œæå‡æ¨¡å‹å‡†ç¡®ç‡ã€‚ åŠ¡å¿…é˜…è¯»ï¼š The Illustrated Transformer ä¸­æ–‡ç‰ˆ Qã€Kã€V å®ƒä»¬éƒ½æ˜¯æœ‰åŠ©äºè®¡ç®—å’Œç†è§£æ³¨æ„åŠ›æœºåˆ¶çš„æŠ½è±¡æ¦‚å¿µ æ‰€æœ‰çš„ç¼–ç å™¨åœ¨ç»“æ„ä¸Šéƒ½æ˜¯ç›¸åŒçš„ï¼Œä½†å®ƒä»¬æ²¡æœ‰å…±äº«å‚æ•°ã€‚æ¯ä¸ªè§£ç å™¨éƒ½å¯ä»¥åˆ†è§£æˆä¸¤ä¸ªå­å±‚ã€‚ è§£ç å™¨ä¸­ä¹Ÿæœ‰ç¼–ç å™¨çš„è‡ªæ³¨æ„åŠ›ï¼ˆself-attentionï¼‰å±‚å’Œå‰é¦ˆï¼ˆfeed-forwardï¼‰å±‚ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œè¿™ä¸¤ä¸ªå±‚ä¹‹é—´è¿˜æœ‰ä¸€ä¸ªæ³¨æ„åŠ›å±‚ï¼Œç”¨æ¥å…³æ³¨è¾“å…¥å¥å­çš„ç›¸å…³éƒ¨åˆ†ï¼ˆå’Œseq2seqæ¨¡å‹çš„æ³¨æ„åŠ›ä½œç”¨ç›¸ä¼¼ï¼‰ã€‚ ä¸€ä¸ªå…¬å¼æ¥è®¡ç®—è‡ªæ³¨æ„åŠ›å±‚çš„è¾“å‡º è§£ç ç»„ä»¶ Transformerä½œä¸ºæ–°æ¨¡å‹ï¼Œå¹¶ä¸æ˜¯å®Œç¾æ— ç¼ºçš„ã€‚å®ƒä¹Ÿæœ‰æ˜æ˜¾çš„ç¼ºç‚¹ï¼šé¦–å…ˆï¼Œå¯¹äºé•¿è¾“å…¥çš„ä»»åŠ¡ï¼Œå…¸å‹çš„æ¯”å¦‚ç¯‡ç« çº§åˆ«çš„ä»»åŠ¡ï¼ˆä¾‹å¦‚æ–‡æœ¬æ‘˜è¦ï¼‰ï¼Œå› ä¸ºä»»åŠ¡çš„è¾“å…¥å¤ªé•¿ï¼ŒTransformerä¼šæœ‰å·¨å¤§çš„è®¡ç®—å¤æ‚åº¦ï¼Œå¯¼è‡´é€Ÿåº¦ä¼šæ€¥å‰§å˜æ…¢ã€‚ 10. Task tricksåœ¨æ–‡æœ¬åˆ†ç±»ä»»åŠ¡ä¸­ï¼Œæœ‰å“ªäº›è®ºæ–‡ä¸­å¾ˆå°‘æåŠå´å¯¹æ€§èƒ½æœ‰é‡è¦å½±å“çš„tricksï¼Ÿ æ•°æ®é¢„å¤„ç†æ—¶vocabçš„é€‰å–ï¼ˆå‰Nä¸ªé«˜é¢‘è¯æˆ–è€…è¿‡æ»¤æ‰å‡ºç°æ¬¡æ•°å°äº3çš„è¯ç­‰ç­‰ï¼‰ è¯å‘é‡çš„é€‰æ‹©ï¼Œå¯ä»¥ä½¿ç”¨é¢„è®­ç»ƒå¥½çš„è¯å‘é‡å¦‚è°·æ­Œã€facebookå¼€æºå‡ºæ¥çš„ï¼Œå½“è®­ç»ƒé›†æ¯”è¾ƒå¤§çš„æ—¶å€™ä¹Ÿå¯ä»¥è¿›è¡Œå¾®è°ƒæˆ–è€…éšæœºåˆå§‹åŒ–ä¸è®­ç»ƒåŒæ—¶è¿›è¡Œã€‚è®­ç»ƒé›†è¾ƒå°æ—¶å°±åˆ«å¾®è°ƒäº† ç»“åˆè¦ä½¿ç”¨çš„æ¨¡å‹ï¼Œè¿™é‡Œå¯ä»¥æŠŠæ•°æ®å¤„ç†æˆcharã€wordæˆ–è€…éƒ½ç”¨ç­‰ æœ‰æ—¶å°†è¯æ€§æ ‡æ³¨ä¿¡æ¯ä¹ŸåŠ å…¥è®­ç»ƒæ•°æ®ä¼šæ”¶åˆ°æ¯”è¾ƒå¥½çš„æ•ˆæœ è‡³äºPADçš„è¯ï¼Œå–å‡å€¼æˆ–è€…ä¸€ä¸ªç¨å¾®æ¯”è¾ƒå¤§çš„æ•°ï¼Œä½†æ˜¯åˆ«å–æœ€å¤§å€¼é‚£ç§åº”è¯¥éƒ½è¿˜å¥½ ç¥ç»ç½‘ç»œç»“æ„çš„è¯åˆ°æ²¡æœ‰ä»€ä¹ˆè¦è¯´çš„ï¼Œå¯ä»¥å¤šè¯•å‡ ç§æ¯”å¦‚fastTextã€TextCNNã€RCNNã€char-CNN/RNNã€HANç­‰ç­‰ã€‚åŠ ä¸Šdropoutå’ŒBNå¯èƒ½ä¼šæœ‰æ„å¤–æ”¶è·ã€‚åæ­£æ¨¡å‹è¿™å—è¿˜æ˜¯è¦å…·ä½“é—®é¢˜å…·ä½“åˆ†æå§ï¼Œï¼ˆæ¯”å¦‚ä¹‹å‰å‚åŠ çŸ¥ä¹ç«èµ›çš„æ—¶å€™ï¼Œæœ€ç»ˆçš„åˆ†ç±»æ ‡ç­¾ä¹Ÿæœ‰æ–‡æœ¬æè¿°ï¼Œæ‰€ä»¥å°±å¯ä»¥æŠŠè¿™éƒ¨åˆ†ä¿¡æ¯ä¹ŸåŠ åˆ°æ¨¡å‹ä¹‹ä¸­ç­‰ç­‰ï¼‰ Overfiting 8 æ¡ 1). get more data2). Data augmentation3). Regularizationï¼ˆæƒå€¼è¡°å‡ï¼‰. (L1 æ‹‰æ™®æ‹‰æ–¯å…ˆéªŒ, L2 é«˜æ–¯å…ˆéªŒ)4). Dropout (ç±»ä¼¼ RF bagging ä½œç”¨ï¼Œæœ€åä»¥æŠ•ç¥¨çš„æ–¹å¼é™ä½è¿‡æ‹Ÿåˆï¼›)5). Choosing Right Network Structure6). Early stopping7). Model Ensumble8). Batch Normalization å¼ ä¿Šæ— - Batch Normalizationå¯¼è¯» ã€ å¼ ä¿Šæ— - æ·±åº¦å­¦ä¹ ä¸­çš„Normalizationæ¨¡å‹ Internal Covariate Shift &amp; Independent and identically distributedï¼Œç¼©å†™ä¸º IID Batch Normalization å¯ä»¥æœ‰æ•ˆé¿å…å¤æ‚å‚æ•°å¯¹ç½‘ç»œè®­ç»ƒäº§ç”Ÿçš„å½±å“ï¼Œä¹Ÿå¯æé«˜æ³›åŒ–èƒ½åŠ›. ç¥ç»ç½‘è·¯çš„è®­ç»ƒè¿‡ç¨‹çš„æœ¬è´¨æ˜¯å­¦ä¹ æ•°æ®åˆ†å¸ƒï¼Œå¦‚æœè®­ç»ƒæ•°æ®ä¸æµ‹è¯•æ•°æ®åˆ†å¸ƒä¸åŒï¼Œå°†å¤§å¤§é™ä½ç½‘ç»œæ³›åŒ–èƒ½åŠ›ï¼Œ BN æ˜¯é’ˆå¯¹æ¯ä¸€æ‰¹æ•°æ®ï¼Œåœ¨ç½‘ç»œçš„æ¯ä¸€å±‚è¾“å…¥ä¹‹å‰å¢åŠ  BNï¼Œ(å‡å€¼0ï¼Œæ ‡å‡†å·®1)ã€‚ Dropout å¯ä»¥æŠ‘åˆ¶è¿‡æ‹Ÿåˆï¼Œä½œç”¨äºæ¯ä»½å°æ‰¹é‡çš„è®­ç»ƒæ•°æ®ï¼Œéšæœºä¸¢å¼ƒéƒ¨åˆ†ç¥ç»å…ƒæœºåˆ¶. bagging åŸç†. MLç®—æ³•ï¼š å…³äºé˜²æ­¢è¿‡æ‹Ÿåˆï¼Œæ•´ç†äº† 8 æ¡è¿­ä»£æ–¹å‘ Reference Language Model and Perplexity sklearn: TfidfVectorizer ä¸­æ–‡å¤„ç†åŠä¸€äº›ä½¿ç”¨å‚æ•° sklearn.feature_extraction.text.TfidfVectorizerå‡½æ•°è¯´æ˜"},{"title":"artitalk","date":"2021-06-15T03:30:48.000Z","updated":"2021-06-15T06:23:26.216Z","comments":true,"path":"artitalk/index.html","permalink":"http://iequa.com/artitalk/index.html","excerpt":"","text":"new Artitalk({ appId: 'xxxx', appKey: 'xxx' })"},{"title":"Categories","date":"2021-06-16T06:30:11.895Z","updated":"2021-06-16T06:30:11.895Z","comments":false,"path":"categories/index.html","permalink":"http://iequa.com/categories/index.html","excerpt":"","text":""},{"title":"","date":"2019-10-20T04:30:33.522Z","updated":"2019-10-20T04:30:33.522Z","comments":true,"path":"deeplearning/index.html","permalink":"http://iequa.com/deeplearning/index.html","excerpt":"","text":"åšä¸»æ°´å¹³ç°å¸¸æœ‰é™ï¼ŒæœŸæœ›èƒ½ä¸å°ã€Deep Learning æ„Ÿå…´è¶£çš„æœ‹å‹ä¸€èµ·å­¦ä¹ ã€äº¤æµã€æ¢è®¨ä¸åˆ†äº«~~ 1. Neural Networks / Deep Learning No. Neural Networks Neural Networks and Deep Learning 1 Introduction to Deep Learning äº†è§£ç°ä»Šæ·±åº¦å­¦ä¹ åœ¨å“ªé‡Œåº”ç”¨ã€å¦‚ä½•åº”ç”¨ 2 Neural Networks Basics logistic æŸå¤±å‡½æ•°ã€å¯¼æ•°ã€è®¡ç®—å›¾ã€mä¸ªæ ·æœ¬çš„æ¢¯åº¦ä¸‹é™ã€å‘é‡åŒ– 3 Shallow Neural Networks NN Representationã€å‘é‡åŒ–ã€Activation functionsã€Random initã€Python å®ç° NN 4 Deep Neural Networks æ·±ç½‘çš„å‰å‘ä¼ æ’­ã€æ ¸å¯¹çŸ©é˜µç»´æ•°ã€åå‘ä¼ æ’­ã€å‚æ•°VSè¶…å‚æ•°ã€Python å®ç° NN å¯¹äºä¸­é—´å±‚æ¥è¯´, å¾€å¾€æ˜¯ ReLU çš„æ•ˆæœæœ€å¥½.è™½ç„¶ z &lt; 0, çš„æ—¶å€™ï¼Œæ–œç‡ä¸º0ï¼Œ ä½†åœ¨å®è·µä¸­ï¼Œæœ‰è¶³å¤Ÿå¤šçš„éšè—å•å…ƒ ä»¤ z &gt; 0, å¯¹å¤§å¤šæ•°è®­ç»ƒæ ·æœ¬æ¥è¯´æ˜¯å¾ˆå¿«çš„. so the one place you might use as linear activation function others usually in the output layer. 2. Improving Deep Neural Networks No. Improving Improving Deep Neural Networks 5 Deep Learning Action Train/Dev/Testã€Bias/Varianceã€L1 L2 Dropoutã€æ¢¯åº¦æ¶ˆå¤±\\çˆ†ç‚¸ã€Weight initã€Gradient checking 6 Optimization mini-batchã€æŒ‡æ•°åŠ æƒå¹³å‡-åå·®ä¿®æ­£ã€Momentumã€RMSpropã€Adamã€Î± decayã€å±€éƒ¨ä¼˜ 7 è¶…å‚æ•°è°ƒè¯•ã€Batch Hyperparameterã€Normalizing Activationsã€Batch Norm [Fitting NN]ã€Softmax 3. Structured Machine Learning No. Structured Structured Machine Learning Projects 8 ML Strategy 1 æ­£äº¤åŒ–ã€Satisficing and optimizing metricsã€Train/dev/test æ”¹å˜ã€å¯é¿å…åå·®ã€äººçš„è¡¨ç° 9 ML Strategy 2 è¯¯å·®åˆ†æã€æ ‡æ³¨é”™è¯¯æ•°æ®ã€å®šä½æ•°æ®ä¸åŒ¹é…åå·®ä¸æ–¹å·®ã€è¿ç§»å­¦ä¹ ã€å¤šä»»åŠ¡å­¦ä¹ ã€ç«¯åˆ°ç«¯å­¦ä¹  4. Convolutional Neural Networks No. CNN Convolutional Neural Networks 10 Convolutional Neural Networks Edge detectionã€Paddingã€Strided convolutionsã€Convolutions Over Volumesã€Pooling 11 &nbsp;&nbsp;Deep CNN&nbsp;&nbsp; Classic Netsã€ResNetsã€1Ã—1 convolutionsã€Inceptionã€Transfer Learningã€Data augmentation 12 Object detection Object Localizationã€Landmark Detectionã€Sliding Windowsã€Bounding Box Predictionsã€Intersection Over Unionã€Non-max Suppressionã€Anchor Boxesã€YOLO 13 Face recognition One-Shotã€Siameseã€Triplet Lossã€Face Verificationã€deep ConvNets learning? LeNet-5ã€AlexNetã€VGGã€ResNet (æœ‰152å±‚)ã€Inceptionã€‚ ç›®æ ‡å®šä½ã€ç‰¹å¾ç‚¹æ£€æµ‹ã€Bounding Boxé¢„æµ‹ã€Anchor Boxes 5. Sequence Models No. Sequence Models Sequence Models 14 Recurrent Sequence Models Notationã€RNNã€Vanishing gradientsã€GRUã€LSTMã€BRNNã€Deep RNNs 15 NLP &amp; Word Embeddings Matrixã€Word2Vecã€Negative Samplingã€GloVeã€Debiasing Word Embeddings 16 Sequence Models &amp; Attention Greedy Searchã€Beam Searchã€Error analysis on beam searchã€Attention Friends link æ·±åº¦å­¦ä¹ ä¸è‡ªç„¶è¯­è¨€å¤„ç† CS244d Notes æ€æ ·æ‰¾åˆ°ä¸€ä»½æ·±åº¦å­¦ä¹ çš„å·¥ä½œ"},{"title":"é¸£è°¢é¡¹ç›®å’Œç¤¾åŒºè´¡çŒ®è€…","date":"2021-06-16T06:31:21.527Z","updated":"2021-06-16T06:31:21.527Z","comments":true,"path":"contributors/index.html","permalink":"http://iequa.com/contributors/index.html","excerpt":"Volantis ç¤¾åŒºçš„å‘å±•ç¦»ä¸å¼€å›¢é˜Ÿå¤§ä½¬ä»¬çš„æ— ç§å¥‰çŒ®å’Œç¤¾åŒºå°ä¼™ä¼´ä»¬çš„çƒ­æƒ…äº’åŠ©ã€‚æ¯ä¸€ä¸ªå¿ƒæ€€æ¢¦æƒ³ã€æœ‰ç€ç‹¬ç‰¹è§è§£çš„æœ‹å‹éƒ½å¯ä»¥æˆä¸ºå›¢é˜Ÿçš„ä¸€å‘˜ã€‚ç›®å‰ Volantis ç¤¾åŒºæ­£å¤„äºå»ºè®¾åˆæœŸï¼Œæˆ‘ä»¬ç¼ºå°‘å„æ–¹é¢çš„äººæ‰ï¼Œå¦‚æœæ‚¨ä½¿ç”¨ä¸»é¢˜è‡³å°‘ä¸€ä¸ªæœˆä¸”é•¿æœŸæ´»è·ƒäºç¤¾åŒºï¼Œä¾‹å¦‚ï¼š è§£ç­” issues / discussions æäº¤æœ‰æ•ˆçš„å»ºè®® å®˜ç½‘æ–‡æ¡£è¡¥å…¨/çº é”™ å‘ç°å¹¶æ”¶å½•æœ‰æ„æ€çš„æ–‡ç« ï¼ˆæ­å»ºåšå®¢æ–¹é¢ï¼‰åˆ°å®˜ç½‘ æˆ‘ä»¬éå¸¸æ¬¢è¿æ‚¨çš„åŠ å…¥ï¼Œè¯·åœ¨è®ºå›å‘å¸–å‘Šè¯‰æˆ‘ä»¬ã€‚","text":"Volantis ç¤¾åŒºçš„å‘å±•ç¦»ä¸å¼€å›¢é˜Ÿå¤§ä½¬ä»¬çš„æ— ç§å¥‰çŒ®å’Œç¤¾åŒºå°ä¼™ä¼´ä»¬çš„çƒ­æƒ…äº’åŠ©ã€‚æ¯ä¸€ä¸ªå¿ƒæ€€æ¢¦æƒ³ã€æœ‰ç€ç‹¬ç‰¹è§è§£çš„æœ‹å‹éƒ½å¯ä»¥æˆä¸ºå›¢é˜Ÿçš„ä¸€å‘˜ã€‚ç›®å‰ Volantis ç¤¾åŒºæ­£å¤„äºå»ºè®¾åˆæœŸï¼Œæˆ‘ä»¬ç¼ºå°‘å„æ–¹é¢çš„äººæ‰ï¼Œå¦‚æœæ‚¨ä½¿ç”¨ä¸»é¢˜è‡³å°‘ä¸€ä¸ªæœˆä¸”é•¿æœŸæ´»è·ƒäºç¤¾åŒºï¼Œä¾‹å¦‚ï¼š è§£ç­” issues / discussions æäº¤æœ‰æ•ˆçš„å»ºè®® å®˜ç½‘æ–‡æ¡£è¡¥å…¨/çº é”™ å‘ç°å¹¶æ”¶å½•æœ‰æ„æ€çš„æ–‡ç« ï¼ˆæ­å»ºåšå®¢æ–¹é¢ï¼‰åˆ°å®˜ç½‘ æˆ‘ä»¬éå¸¸æ¬¢è¿æ‚¨çš„åŠ å…¥ï¼Œè¯·åœ¨è®ºå›å‘å¸–å‘Šè¯‰æˆ‘ä»¬ã€‚ æ„Ÿè°¢å¼€å‘è€… æ„Ÿè°¢ç¤¾åŒºå»ºè®¾è€… å¦‚ä½•å‚ä¸ç¤¾åŒºå»ºè®¾ç¤¾åŒºå»ºè®¾ä¸»è¦åŒ…æ‹¬ Issues Discussions(è®ºå›) å®˜ç½‘åšå®¢æ”¶å½• å®˜ç½‘æ–‡æ¡£ç»´æŠ¤ å‡ ä¸ªæ–¹é¢ã€‚ å¦‚ä½•ç»´æŠ¤æ–‡æ¡£ç›®å‰ Volantis 4.x å·²æ˜¯å·²çŸ¥çš„ Hexo ä¸»é¢˜ä¸­æ–‡æ¡£æœ€å…¨é¢çš„ï¼Œä½†ä»æœ‰éƒ¨åˆ†åŠŸèƒ½ç¼ºå°‘æ˜ç¡®çš„æ–‡æ¡£ã€éƒ¨åˆ†æ–‡æ¡£å·²ç»è¿‡æ—¶ï¼Œå¦‚æœæ‚¨å‘ç°äº†é—æ¼æˆ–è€…é”™è¯¯ä¹‹å¤„ï¼Œæˆ‘ä»¬éå¸¸å¸Œæœ›æ‚¨èƒ½å¤Ÿå¸®å¿™å®Œå–„ä¸€ä¸‹ã€‚ Volantis å®˜ç½‘æ”¯æŒ CI ï¼Œæ‚¨å¯ä»¥ç›´æ¥åœ¨çº¿ç¼–è¾‘æºç ï¼š åœ¨çº¿ç¼–è¾‘æ–‡æ¡£https://github.com/volantis-x/community/tree/master/source å¦‚ä½•æ”¶å½•åšå®¢æ¯ä½ç”¨æˆ·åœ¨ä½¿ç”¨æˆ–æ›´æ–°ä¸»é¢˜çš„æ—¶å€™éƒ½éœ€è¦é˜…è¯»å®˜ç½‘çš„æ–‡æ¡£ï¼Œæ”¶å½•çš„ç›¸å…³å†…å®¹èƒ½å¸®åŠ©ç”¨æˆ·æ›´é«˜æ•ˆåœ°ä¸Šæ‰‹ï¼ŒåŒæ—¶ä¹Ÿèƒ½å¤Ÿæé«˜è¢«æ”¶å½•çš„æ–‡ç« çš„æ›å…‰ç‡ã€‚å¦‚æœåœ¨å®˜ç½‘èƒ½çœ‹åˆ°æ›´å¤šçš„æœ‰ä»·å€¼çš„æ–‡ç« ï¼Œå°±ä¼šæœ‰æ›´å¤š Volantis ç”¨æˆ·æˆ–è€…é Volantis ç”¨æˆ·æ¥è®¿é—®ã€‚ å¦‚æœæ‚¨æœ‰æˆ–è€…å‘ç°äº†ä¸ Hexo åšå®¢æ­å»ºç›¸å…³çš„æ–‡ç« ï¼Œå¯ä»¥è½¬è½½å¤–é“¾åˆ° Volantis å®˜ç½‘ï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š _posts/blogs/2020-05-17-pjax.md---title: Volantis ä¸»é¢˜éƒ¨ç½² Pjaxdate: 2020-05-17updated: 2020-08-07categories: [å¼€å‘å¿ƒå¾—]author: inksslink: https://inkss.cn/blog/76993423/description: æœ¬ç¯‡æ–‡ç« è®°å½•äº†æˆ‘å¯¹ Volantis ä¸»é¢˜åš Pjax å…¼å®¹çš„ç§ç§ï¼Œå¤§æŠµç®—æ˜¯ç§è®°å½•å§~headimg: # å¯ä»¥è®¾ç½®æ–‡ç« å¤´å›¾backup: https://archive.vn/U36NG # å°†é¡µé¢å­˜æ¡£åˆ° archive.tody ç½‘é¡µå¿«ç…§æ¡£æ¡ˆé¦†çš„å­˜æ¡£é“¾æ¥ https://archive.tody--- å¦‚æœè¿™ç¯‡æ–‡ç« çš„ä½œè€…æ˜¯ç¬¬ä¸€æ¬¡å‡ºç°åœ¨å®˜ç½‘ï¼Œè¿˜éœ€è¦åœ¨ _data/author.yml æ–‡ä»¶ä¸­æ·»åŠ ä½œè€…ä¿¡æ¯ï¼Œä¾‹å¦‚ï¼š _data/author.yml...inkss: name: æ‹æŸšæ¢“ avatar: https://cdn.jsdelivr.net/gh/inkss/common@1.4.2/hexo/img/static/avatar.jpg url: https://inkss.cn æ³¨æ„äº‹é¡¹æ–‡ç« å­˜æ”¾åœ¨ _posts/blogs/ ç›®å½•ä¸­ï¼Œä¸”æ–‡ä»¶åæ ¼å¼ä¸ºã€Œå¹´-æœˆ-æ—¥-æ–‡ç« è¯é¢˜ã€ã€‚é¼“åŠ±åŸåˆ›æ–‡ç« ï¼Œæ‘˜è¦éƒ¨åˆ†300å­—ç¬¦ä»¥å†…ã€‚å¦‚æœæƒ³ä¸å‡ºæ‘˜è¦å¯ä»¥ä¸å†™ï¼Œä¸è¦åœ¨æ‘˜è¦é‡Œé‡å¤ä¸€éæ–‡ç« æ ‡é¢˜ã€‚æœ€å¥½é€‰æ‹©ä¸€ä¸ªæ–‡ç« åˆ†ç±»ï¼Œå¦‚æœç°æœ‰çš„åˆ†ç±»ä¸­æ²¡æœ‰åˆé€‚çš„ï¼Œå¯ä»¥è‡ªå·±æ–°å¢ã€‚å¦‚æœæœ‰æ–‡ç« å¤´å›¾ï¼Œè¯·ç¡®ä¿å›¾ç‰‡å†…æœ€å¤šåªæœ‰ä¸€ä¸ªå•è¯æˆ–çŸ­è¯­ï¼Œå›¾ç‰‡ä¸æ¸…æ™°æˆ–è€…ä¸æ–‡ç« æ— å…³çš„è¯ä¸å»ºè®®ä½¿ç”¨ã€‚ä¸ä»…é™äºè‡ªå·±çš„æ–‡ç« ï¼Œå¯ä»¥åœ¨å¾å¾—æ–‡ç« ä½œè€…åŒæ„çš„æƒ…å†µä¸‹å°†å…¶é“¾æ¥æ”¶å½•åˆ°å®˜ç½‘ã€‚ åœ¨çº¿ç¼–è¾‘æ–‡æ¡£https://github.com/volantis-x/community/tree/master/source/_posts/blogs"},{"title":"","date":"2019-10-20T04:30:33.523Z","updated":"2019-10-20T04:30:33.523Z","comments":true,"path":"deeplearning/index_2018-10-25.html","permalink":"http://iequa.com/deeplearning/index_2018-10-25.html","excerpt":"","text":"deep learningæˆ‘å¼€å§‹æ•´ç† Algorithm ç›¸å…³å­¦ä¹ ç¬”è®°ï¼Œå­¦ä¹ ç®—æ³•ç±»çŸ¥è¯†çœŸçš„éœ€è¦ä¸‹å¾ˆå¤§å¾ˆå¤§çš„åŠŸå¤«ï¼Œç°å¸¸åšå¤§ç²¾æ·±~~ åšä¸»æ°´å¹³ç°å¸¸æœ‰é™ï¼ŒæœŸæœ›èƒ½ä¸å°ã€Deep Learning æ„Ÿå…´è¶£çš„æœ‹å‹ä¸€èµ·å­¦ä¹ ã€äº¤æµã€æ¢è®¨ä¸åˆ†äº«~~ 1. Neural Networks / Deep Learning No. Neural Networks Neural Networks and Deep Learning 1 Introduction to Deep Learning äº†è§£ç°ä»Šæ·±åº¦å­¦ä¹ åœ¨å“ªé‡Œåº”ç”¨ã€å¦‚ä½•åº”ç”¨ 2 Neural Networks Basics logistic æŸå¤±å‡½æ•°ã€å¯¼æ•°ã€è®¡ç®—å›¾ã€mä¸ªæ ·æœ¬çš„æ¢¯åº¦ä¸‹é™ã€å‘é‡åŒ– 3 Shallow Neural Networks NN Representationã€å‘é‡åŒ–ã€Activation functionsã€Random initã€Python å®ç° NN 4 Deep Neural Networks æ·±ç½‘çš„å‰å‘ä¼ æ’­ã€æ ¸å¯¹çŸ©é˜µç»´æ•°ã€åå‘ä¼ æ’­ã€å‚æ•°VSè¶…å‚æ•°ã€Python å®ç° NN å¯¹äºä¸­é—´å±‚æ¥è¯´, å¾€å¾€æ˜¯ ReLU çš„æ•ˆæœæœ€å¥½.è™½ç„¶ z &lt; 0, çš„æ—¶å€™ï¼Œæ–œç‡ä¸º0ï¼Œ ä½†åœ¨å®è·µä¸­ï¼Œæœ‰è¶³å¤Ÿå¤šçš„éšè—å•å…ƒ ä»¤ z &gt; 0, å¯¹å¤§å¤šæ•°è®­ç»ƒæ ·æœ¬æ¥è¯´æ˜¯å¾ˆå¿«çš„. so the one place you might use as linear activation function others usually in the output layer. 2. Improving Deep Neural Networks No. Improving Improving Deep Neural Networks 5 Deep Learning Action Train/Dev/Testã€Bias/Varianceã€L1 L2 Dropoutã€æ¢¯åº¦æ¶ˆå¤±\\çˆ†ç‚¸ã€Weight initã€Gradient checking 6 Optimization mini-batchã€æŒ‡æ•°åŠ æƒå¹³å‡-åå·®ä¿®æ­£ã€Momentumã€RMSpropã€Adamã€Î± decayã€å±€éƒ¨ä¼˜ 7 è¶…å‚æ•°è°ƒè¯•ã€Batch Hyperparameterã€Normalizing Activationsã€Batch Norm [Fitting NN]ã€Softmax 3. Structured Machine Learning No. Structured Structured Machine Learning Projects 8 ML Strategy 1 æ­£äº¤åŒ–ã€Satisficing and optimizing metricsã€Train/dev/test æ”¹å˜ã€å¯é¿å…åå·®ã€äººçš„è¡¨ç° 9 ML Strategy 2 è¯¯å·®åˆ†æã€æ ‡æ³¨é”™è¯¯æ•°æ®ã€å®šä½æ•°æ®ä¸åŒ¹é…åå·®ä¸æ–¹å·®ã€è¿ç§»å­¦ä¹ ã€å¤šä»»åŠ¡å­¦ä¹ ã€ç«¯åˆ°ç«¯å­¦ä¹  4. Convolutional Neural Networks No. CNN Convolutional Neural Networks 10 Convolutional Neural Networks Edge detectionã€Paddingã€Strided convolutionsã€Convolutions Over Volumesã€Pooling 11 &nbsp;&nbsp;Deep CNN&nbsp;&nbsp; Classic Netsã€ResNetsã€1Ã—1 convolutionsã€Inceptionã€Transfer Learningã€Data augmentation 12 Object detection Object Localizationã€Landmark Detectionã€Sliding Windowsã€Bounding Box Predictionsã€Intersection Over Unionã€Non-max Suppressionã€Anchor Boxesã€YOLO 13 Face recognition One-Shotã€Siameseã€Triplet Lossã€Face Verificationã€deep ConvNets learning? LeNet-5ã€AlexNetã€VGGã€ResNet (æœ‰152å±‚)ã€Inceptionã€‚ ç›®æ ‡å®šä½ã€ç‰¹å¾ç‚¹æ£€æµ‹ã€Bounding Boxé¢„æµ‹ã€Anchor Boxes 5. Sequence Models No. Sequence Models Sequence Models 14 Recurrent Sequence Models Notationã€RNNã€Vanishing gradientsã€GRUã€LSTMã€BRNNã€Deep RNNs 15 NLP &amp; Word Embeddings Matrixã€Word2Vecã€Negative Samplingã€GloVeã€Debiasing Word Embeddings 16 Sequence Models &amp; Attention Greedy Searchã€Beam Searchã€Error analysis on beam searchã€Attention Friends link æ·±åº¦å­¦ä¹ ä¸è‡ªç„¶è¯­è¨€å¤„ç† CS244d Notes æ€æ ·æ‰¾åˆ°ä¸€ä»½æ·±åº¦å­¦ä¹ çš„å·¥ä½œ Machine learning Coursera No. Machine Learning Coursera Machine Learning Toc Content 1. Machine Learning Introduce Supervised learningã€Regression &amp; Classificationã€Unsupervised learning 2. Linear Regression Cost Function Gradient descent Linear Regressionã€Cost Functionã€Gradient Descent (Batch) 3. Linear Algebra Matrices And Vectors Linear Algebra Matrices And Vectors 4. Linear Regression with Multiple Variables Multiple Featuresã€Gradient Descã€Polynomial Regressionã€Normal Equation 5. Logistic Regression Classificationã€Cost Function &amp; Gradient Descã€Optimizationã€Regularization 6. Advice for Applying Machine Learning Model Selectionã€Bias and Variance -&gt; Regularizationã€Learning Curves 8. Large Scale Machine Learning * not Machine learning roc auc No. Machine Learning Title Machine Learning Toc Content 11. L1ã€L2 æ­£åˆ™åŒ–å°è®° å¥¥å¡å§†å‰ƒåˆ€ã€è´å¶æ–¯ä¼°è®¡ã€ç»“æ„é£é™©æœ€å°åŒ–ã€L1ã€L2 èŒƒæ•° 12. æ¨¡å‹è¯„ä¼°æ€»ç»“ Precisionã€Recallã€ROCã€AUC 13. Native Bayes 1 æ¡ä»¶ç‹¬ç«‹å‡è®¾ã€åƒåœ¾é‚®ä»¶è¯†åˆ«ã€å¤šé¡¹å¼/ä¼¯åŠªåˆ©/æ··åˆ æ¨¡å‹ã€å¹³æ»‘ 14. Native Bayes 2 ç‹¬ç«‹å‡è®¾ã€è´å¶æ–¯åˆ†ç±»å™¨ Machine learning tree model No. Machine Learning Tree Model Machine Learning Decision Tree &amp; Ensemble 15. Decision Tree 1 ID3 Information gain &amp; C4.5 Gain ratio 16. Decision Tree 2 CART : å›å½’æ ‘ï¼š æœ€å°äºŒä¹˜ &amp; åˆ†ç±»æ ‘ï¼š åŸºå°¼æŒ‡æ•° Gini index 17. Gradient Boosting ä¸‰ä¸ªè‡­çš®åŒ ï¼Œé¡¶ä¸ªè¯¸è‘›äº® 18. Xgboost @é™ˆå¤©å¥‡æ€ª æä¾›äº† Graident Boosting ç®—æ³•æ¡†æ¶ï¼Œç»™å‡ºäº†GBDTï¼ŒGBRTï¼ŒGBM å…·ä½“å®ç° 19. Ensemble 1 Bootstrapingã€Bagging (Random Forest) 19. Ensemble 2 æ¦‚ç‡å¯å­¦ä¹ æ€§ (PAC)ã€Boostingç®—æ³•ä»£è¡¨ ï¼šAdaboost(Adaptive Boosting) 19. Ensumble é›†æˆå­¦ä¹ å°è®° Baggingã€Boostingã€Stackingã€Blending NLP åŸºç¡€çŸ¥è¯† 1.1 æ–‡å­—å’Œè¯­è¨€ vs æ•°å­—å’Œä¿¡æ¯ 1.2 Python å­—ç¬¦ä¸²å¤„ç†-æ­£åˆ™è¡¨è¾¾å¼ 1.3 NLP ç®€ä»‹ &amp; ç»Ÿè®¡è¯­è¨€æ¨¡å‹ 1.4 Jieba åˆ†è¯ä¸­æ–‡å¤„ç† 1.5 Naive Bayes * åƒåœ¾é‚®ä»¶åˆ†ç±»ã€Naive Bayes * æ–‡æœ¬åˆ†ç±» 1.6 Word2vec åŸºç¡€"},{"title":"Cheer UPï¼","date":"2018-01-29T08:20:48.000Z","updated":"2020-10-23T02:09:56.687Z","comments":true,"path":"english/index.html","permalink":"http://iequa.com/english/index.html","excerpt":"","text":"Open Languagelearn what you love. love what you learn. ä½ ä¸å¾—ä¸å­¦çš„å‡è‚¥è‹±è¯­ï¼ Go on a diet è‡ªé©¾æ¸¸å¯ä¸æ˜¯ self-drivingï¼ å·´é»åœ£æ¯é™¢å« Notre-Dame Howç”¨çœ‹é›»å½±ã€è½éŸ³æ¨‚ã€èŠå¤©ã€ç­‰ç”Ÿæ´»åŒ–çš„æ–¹å¼é‚Šç©é‚Šå­¸. How I Met Your Mother S1 ep1 How I Met Your Mother S1 ep2 How I Met Your Mother S1 ep3 How I Met Your Mother S1 ep4 How I Met Your Mother S1 ep5 Reference How scripts Engoo çº¿ä¸Šè‹±æ–‡å®¶æ•™ Engvid: Taking care of your pet DOG!"},{"title":"Categories","date":"2021-06-16T05:27:17.120Z","updated":"2021-06-16T05:27:17.120Z","comments":false,"path":"categoriesc/index.html","permalink":"http://iequa.com/categoriesc/index.html","excerpt":"","text":""},{"title":"","date":"2021-06-13T16:29:17.973Z","updated":"2021-06-13T16:29:17.973Z","comments":true,"path":"examples/index.html","permalink":"http://iequa.com/examples/index.html","excerpt":"ç¤º ä¾‹ åš å®¢ ç¤¾åŒºç»´æŠ¤å›¢é˜Ÿçš„åšå®¢ ä½¿ç”¨ Volantis çš„åšå®¢ç¤ºä¾‹","text":"ç¤º ä¾‹ åš å®¢ ç¤¾åŒºç»´æŠ¤å›¢é˜Ÿçš„åšå®¢ ä½¿ç”¨ Volantis çš„åšå®¢ç¤ºä¾‹ å¦‚ä½•æ·»åŠ è‡ªå·±çš„åšå®¢é“¾æ¥ ç¬¬ä¸€æ­¥ï¼šæ–°å»º Issue æŒ‰ç…§æ ¼å¼å¡«å†™å¹¶æäº¤ &#123; &quot;title&quot;: &quot;&quot;, &quot;description&quot;: &quot;&quot;, &quot;screenshot&quot;: &quot;&quot;, &quot;url&quot;: &quot;&quot;, &quot;avatar&quot;: &quot;&quot;, &quot;version&quot;: &quot;ç‰ˆæœ¬ï¼š^4.0&quot;&#125;ä¸ºäº†æé«˜å›¾ç‰‡åŠ è½½é€Ÿåº¦ï¼Œå»ºè®®ä¼˜åŒ–å›¾ç‰‡å°ºå¯¸ï¼šæ‰“å¼€ å‹ç¼©å›¾ ä¸Šä¼ è‡ªå·±çš„æˆªå›¾ï¼Œå°†å›¾ç‰‡çš„é«˜åº¦è°ƒæ•´åˆ° 360px åä¸‹è½½ã€‚å°†å‹ç¼©åçš„å›¾ç‰‡ä¸Šä¼ åˆ° å»ä¸å›¾åºŠ å¹¶ä½¿ç”¨æ­¤å›¾ç‰‡é“¾æ¥ä½œä¸ºæˆªå›¾é“¾æ¥ã€‚ ç¬¬äºŒæ­¥ï¼šåˆ·æ–° å›æ¥åˆ·æ–°å³å¯ç”Ÿæ•ˆã€‚ å¦‚ä½•æ›´æ–°è‡ªå·±çš„åšå®¢é“¾æ¥ å¦‚æœæ˜¯è‡ªå·±åˆ›å»ºçš„ issue ï¼Œå¯ä»¥è‡ªå·±ä¿®æ”¹ã€‚ å¦‚æœæ˜¯ç®¡ç†å‘˜åˆ›å»ºçš„ï¼Œè¯·è‡ªå·±é‡æ–°åˆ›å»ºä¸€ä»½ï¼Œç„¶åè®©ç®¡ç†å‘˜åˆ æ‰æ—§çš„ã€‚"},{"title":"å¸¸è§é—®é¢˜ä¸åé¦ˆæ¸ é“","date":"2021-06-13T16:29:24.950Z","updated":"2021-06-13T16:29:24.949Z","comments":true,"path":"faqs/index.html","permalink":"http://iequa.com/faqs/index.html","excerpt":"é€šå¸¸æ¥è¯´ï¼Œä¸€ä¸ªå…¨æ–°çš„å·¥ç¨‹å…¨éƒ¨ä½¿ç”¨é»˜è®¤é…ç½®æ˜¯æ­£å¸¸æ²¡æœ‰æ•…éšœçš„ã€‚å¦‚æœæ— æ³•ä½¿ç”¨æˆ–è€…æ•ˆæœä¸ç¤ºä¾‹æœ‰è¾ƒå¤§åŒºåˆ«ï¼Œå¯ä»¥ä½¿ç”¨ Hexo å®˜æ–¹æä¾›çš„ç”¨äºå•å…ƒæµ‹è¯•çš„åšå®¢åº”ç”¨æœ¬ä¸»é¢˜æŸ¥çœ‹æ ·å¼æ˜¯å¦æ­£å¸¸ï¼Œå¯¹æ¯” _config.yml æ–‡ä»¶æ’æŸ¥é—®é¢˜ã€‚ Hexo å®˜æ–¹çš„å•å…ƒæµ‹è¯•é¡¹ç›®ï¼š https://github.com/hexojs/hexo-theme-unit-test å‘å¼€å‘è€…åé¦ˆé—®é¢˜","text":"é€šå¸¸æ¥è¯´ï¼Œä¸€ä¸ªå…¨æ–°çš„å·¥ç¨‹å…¨éƒ¨ä½¿ç”¨é»˜è®¤é…ç½®æ˜¯æ­£å¸¸æ²¡æœ‰æ•…éšœçš„ã€‚å¦‚æœæ— æ³•ä½¿ç”¨æˆ–è€…æ•ˆæœä¸ç¤ºä¾‹æœ‰è¾ƒå¤§åŒºåˆ«ï¼Œå¯ä»¥ä½¿ç”¨ Hexo å®˜æ–¹æä¾›çš„ç”¨äºå•å…ƒæµ‹è¯•çš„åšå®¢åº”ç”¨æœ¬ä¸»é¢˜æŸ¥çœ‹æ ·å¼æ˜¯å¦æ­£å¸¸ï¼Œå¯¹æ¯” _config.yml æ–‡ä»¶æ’æŸ¥é—®é¢˜ã€‚ Hexo å®˜æ–¹çš„å•å…ƒæµ‹è¯•é¡¹ç›®ï¼š https://github.com/hexojs/hexo-theme-unit-test å‘å¼€å‘è€…åé¦ˆé—®é¢˜ å¦‚ä½•æ›´æ–°ä¸»é¢˜ä½¿ç”¨ä¸»é¢˜çš„æ—¶å€™ï¼Œå°½é‡ fork ä¸»é¢˜åˆ°è‡ªå·±çš„ GitHubï¼Œç„¶åè¿›è¡Œä¿®æ”¹å¹¶ä½¿ç”¨ã€‚è¿™æ ·åšçš„å¥½å¤„æ˜¯ï¼šå½“ä¸»é¢˜è¿›è¡Œé‡è¦æ›´æ–°çš„æ—¶å€™å¯ä»¥æ ¹æ®éœ€è¦æ‹‰å–åˆå¹¶ä»£ç ï¼Œä½¿è‡ªå·± DIY çš„ä¸»é¢˜èƒ½å¤Ÿé€šè¿‡æ›´æ–°è·å– BUG ä¿®å¤æˆ–è€…æ–°ç‰¹æ€§ã€‚ å¦‚æœä¸æ‡‚è¯·è‡ªè¡Œæœç´¢å…³é”®è¯ï¼šfork æ›´æ–° å®ç”¨å°æŠ€å·§æ‰€æœ‰éœ€è¦å†™åœ¨ä¸»é¢˜é…ç½®æ–‡ä»¶ä¸­çš„é…ç½®éƒ½å¯ä»¥å†™åœ¨ç«™ç‚¹é…ç½®æ–‡ä»¶çš„ theme_config: ä¸­ï¼Œåœ¨ Hexo 5.0 åï¼Œè¿˜å¯ä»¥å†™åœ¨ _config.volantis.yml æ–‡ä»¶ä¸­ï¼Œè¯¦è§ Hexo å®˜æ–¹æ–‡æ¡£ï¼šè¦†ç›–ä¸»é¢˜é…ç½®https://hexo.io/zh-cn/docs/configuration#%E8%A6%86%E7%9B%96%E4%B8%BB%E9%A2%98%E9%85%8D%E7%BD%AEä¹Ÿå¯ä»¥ç›´æ¥æŸ¥çœ‹æœ¬ç«™æºç ä¸­ç«™ç‚¹é…ç½®æ–‡ä»¶çš„å†™æ³•ï¼š_config.volantis.yml æ— æ³•æˆåŠŸè¿è¡Œæœ¬åœ°é¢„è§ˆ å¯èƒ½æ˜¯æ²¡æœ‰å®‰è£…ä¾èµ–ï¼Œè¯·æŒ‰ç…§ã€Œå¼€å§‹ã€é¡µé¢ä¸­çš„æ­¥éª¤è¿›è¡Œå®‰è£…ï¼Œå¹¶å®‰è£…æ‰€éœ€ä¾èµ–ã€‚ å¦‚æœå¼€å¯äº†æŸäº›ç¬¬ä¸‰æ–¹æœåŠ¡ï¼Œè¯·æŸ¥çœ‹æ–‡æ¡£ä¸­æ˜¯å¦è¦æ±‚å®‰è£…æ’ä»¶ã€‚ å¦‚æœæŠ¥é”™ä¿¡æ¯æœ‰ lastIndexï¼Œä½ å¯ä»¥å°è¯•æŠŠåšå®¢æ ¹ç›®å½•é…ç½®æ–‡ä»¶ä¸­æ‰¾åˆ° highlightï¼Œå¹¶å°† auto_detect è®¾ç½®ä¸º falseã€‚ ä¸»é¢˜é…ç½®ä¿®æ”¹æ²¡æœ‰ç”Ÿæ•ˆè¯·ç¡®è®¤æ–‡æ¡£ä¸­è¦æ±‚ä¿®æ”¹çš„æ˜¯åšå®¢ä¸»ç›®å½•çš„é…ç½®æ–‡ä»¶ blog/_config.yml è¿˜æ˜¯ä¸»é¢˜çš„é…ç½®æ–‡ä»¶ blog/_config.volantis.ymlã€‚ ä¸»é¢˜æ ·å¼ä¿®æ”¹æ²¡æœ‰ç”Ÿæ•ˆå¦‚æœä¸»é¢˜é…ç½®æ–‡ä»¶ä¸­å¼€å¯äº† cdn æœåŠ¡ï¼Œé‚£ä¹ˆä¿®æ”¹æœ¬åœ°çš„æ ·å¼æ˜¯ä¸ä¼šç”Ÿæ•ˆçš„ï¼Œéœ€è¦å…³é—­ cdn æœåŠ¡ã€‚ ä¿®æ”¹ä»€ä¹ˆéƒ½æ²¡æœ‰ç”Ÿæ•ˆéœ€è¦ hexo clean ç„¶åé‡æ–° hexo s å¦‚æœå®‰è£…äº†ã€Œç›¸å…³æ–‡ç« æ¨èã€æ’ä»¶åï¼Œæ¯æ¬¡ä¿®æ”¹ md æ–‡ä»¶åéƒ½éœ€è¦é‡æ–° hexo s å…³æ‰ CDN ä¹‹åæ ·å¼é”™ä¹± è¯·å‰å¾€æ–‡æ¡£ã€Œå¼€å§‹ã€é¡µé¢ï¼Œæ£€æŸ¥æ˜¯å¦å®‰è£…äº†å¿…è¦çš„ä¾èµ–åŒ…ã€‚ æœç´¢æ— æ³•ä½¿ç”¨ è¯·å‰å¾€æ–‡æ¡£ã€Œå¼€å§‹ã€é¡µé¢ï¼Œæ£€æŸ¥æ˜¯å¦å®‰è£…äº†å¿…è¦çš„ä¾èµ–åŒ…ã€‚ æ£€æŸ¥æ ¹ç›®å½•é…ç½®æ–‡ä»¶æ˜¯å¦æœ‰ search å­—æ®µå†²çªã€‚ å¦‚æœä»¥ä¸Šä¸¤æ­¥éƒ½æ— æ³•æ‰¾åˆ°é—®é¢˜ï¼Œè¯·ä¸‹è½½ç¤ºä¾‹æºç è¿›è¡Œå¯¹æ¯”ã€‚ æœç´¢ç»“æœé“¾æ¥ä¸æ­£ç¡®è¯·æ£€æŸ¥æ ¹ç›®å½•é…ç½®æ–‡ä»¶ä¸­çš„é“¾æ¥æ˜¯å¦æ­£ç¡®ï¼Œå¦‚ï¼š blog/_config.ymlurl: https://xaoxuu.comroot: / æ•™ç¨‹ä¸æŒ‡å— Hexo å®˜æ–¹æ–‡æ¡£ | Valine å®˜æ–¹æ–‡æ¡£è¯·ä¸€å®šè¦é˜…è¯»å®˜æ–¹æ–‡æ¡£ï¼ å¯ä¾›äº¤æµçš„æ¸ é“è§£å†³é—®é¢˜ æ¸ é“ æ–¹å¼ ç”¨é€” Issues @volantis-x/hexo-theme-volantis å’Œå¼€å‘è€…æ²Ÿé€šçš„å”¯ä¸€æ¸ é“ï¼Œç”¨äºè·Ÿè¿›å’Œè§£å†³é—®é¢˜ è¯·ä¸è¦å‘é€é‚®ä»¶å¼€æºé¡¹ç›®çš„å¼€å‘è€…å¾ˆåæ„Ÿåˆ«äººä¸é€šè¿‡æ­£ç¡®çš„é€”å¾„å¦‚ Issues è€Œæ˜¯é€šè¿‡ç§äººé‚®ä»¶è¯¢é—®å¼€æºé¡¹ç›®é—®é¢˜ï¼Œæ‰€ä»¥ä¸€èˆ¬ä¸ä¼šå›å¤æ­¤ç±»é‚®ä»¶ã€‚ äº¤æµ æ¸ é“ æ–¹å¼ ç”¨é€” è®ºå› @volantis-x/discussions æ…¢ï¼Œç›¸å¯¹æ­£å¼ï¼Œæ–¹ä¾¿æ£€ç´¢ï¼Œå¯ä»¥ç»™å…¶ä»–ç”¨æˆ·å‚è€ƒ QQç¾¤ 1146399464 (éªŒè¯ç : vlts-2021) éæ­£å¼ï¼Œå³æ—¶é€šè®¯ï¼Œæ˜“äºæ–—å›¾ï¼›ä¸åˆ©äºç»™å…¶ä»–ç”¨æˆ·å‚è€ƒ ä½›ç³»äº’åŠ¨ æ¸ é“ æ–¹å¼ ç”¨é€” è¯„è®ºåŒº ç•™è¨€ å¯ä»¥æµ‹è¯•ã€çŒæ°´ã€æ¨å¹¿è‡ªå·±çš„åšå®¢ã€‚"},{"title":"Home","date":"2021-06-16T05:44:02.126Z","updated":"2021-06-16T05:44:02.126Z","comments":false,"path":"home/index.html","permalink":"http://iequa.com/home/index.html","excerpt":"","text":""},{"title":"","date":"2017-10-08T12:53:48.000Z","updated":"2021-06-13T18:51:29.391Z","comments":true,"path":"friends/index.html","permalink":"http://iequa.com/friends/index.html","excerpt":"","text":"p + p { display: inline; } Aboutwhen we meet here. we can focusing on efficient learning, way of thinking, and communication skills. Who am I Blair Chan 90s, a data developer, GTD practitioner, live in Singapore, Singapore. Blair Chan focus on python, data engineering, computer science, machine learning. Recent me Classic line å‹æƒ…è§€ï¼š Whatever you do in this life, itâ€™s not legendary, unless your friends are there to see it. äººç”Ÿè§€ï¼š Life is full of changes. One day you have an apartment, the next day itâ€™s a house of dumplings. But the important stuff doesnâ€™t change. To the important stuff. æ„›æƒ…è§€ï¼š When youâ€™re single, and your friends start to get married, every wedding invitation presents a strange moment of self-evaluation: â€œWill you be bringing a guest, or will you be attending alone?â€ Contact me You can find me in these ways: Email Twitter Instagram Github You can continue to fellow this blog and comment by DISQUS ChangeLog 2017-10-08 : Blair Chan @theme improve 2016-03-22 : Blair Chan @build this blog"},{"title":"","date":"2021-06-13T15:28:54.374Z","updated":"2021-06-13T15:28:54.374Z","comments":true,"path":"hzbank/index.html","permalink":"http://iequa.com/hzbank/index.html","excerpt":"","text":"1. Data Warehouse OLTP (on-line transaction processing) OLAPï¼ˆOn-Line Analytical Processingï¼‰ æ•°æ®åœ¨ç³»ç»Ÿä¸­äº§ç”Ÿ æœ¬èº«ä¸äº§ç”Ÿæ•°æ®ï¼ŒåŸºç¡€æ•°æ®æ¥æºäºäº§ç”Ÿç³»ç»Ÿ åŸºäºäº¤æ˜“çš„å¤„ç†ç³»ç»Ÿ åŸºäºæŸ¥è¯¢çš„åˆ†æç³»ç»Ÿ ç‰µæ‰¯çš„æ•°æ®é‡å¾ˆå° ç‰µæ‰¯çš„æ•°æ®é‡åºå¤§ (å¤æ‚æŸ¥è¯¢ç»å¸¸ä½¿ç”¨å…¨è¡¨æ‰«æç­‰) å¯¹å“åº”æ—¶é—´è¦æ±‚éå¸¸é«˜ å“åº”æ—¶é—´ä¸å…·ä½“æŸ¥è¯¢æœ‰å¾ˆå¤§å…³ç³» ç”¨æˆ·æ•°é‡å¤§ï¼Œä¸ºæ“ä½œç”¨æˆ· ç”¨æˆ·æ•°é‡å°‘ï¼Œä¸»è¦æœ‰æŠ€æœ¯äººå‘˜ä¸ä¸šåŠ¡äººå‘˜ å„ç§æ“ä½œä¸»è¦åŸºäºç´¢å¼•è¿›è¡Œ ä¸šåŠ¡é—®é¢˜ä¸å›ºå®šï¼Œæ•°æ®åº“çš„å„ç§æ“ä½œä¸èƒ½å®Œå…¨åŸºäºç´¢å¼•è¿›è¡Œ Data Warehouse é¢å‘ä¸»é¢˜ æ•°æ®ä»“åº“çš„ç”±æ¥ æ•°ä»“ç‰¹ç‚¹: ä¸»é¢˜æ€§, é›†æˆæ€§, æ—¶å˜æ€§, å†å²æ€§ å¿ƒç†å§¿åŠ¿: æ”¾ç©º, å¯¹è‡ªå·±è´Ÿè´£ 2. DW æŠ€æœ¯é€‰å‹ No. Title Tech 1. æ•°æ®é‡‡é›† flume, kafka, sqoop, logstach, datax 2. æ•°æ®å­˜å‚¨ mysql, hdfs, hbase, redis, elastic, kudu, mongodb 3. æ•°æ®è®¡ç®— hive, tez, spark, flink, storm 4. æ•°æ®æŸ¥è¯¢ presto, kylin, impala, druid, clickhouse 5. æ•°æ®å¯è§†åŒ– echarts, superset, quickbl, dataV 6. ä»»åŠ¡è°ƒåº¦ azkaban, airflow, Oozie 7. é›†ç¾¤ç›‘æ§ Zabbix 8. å…ƒæ•°æ®ç®¡ç† Apache Atlas 9. æƒé™ç®¡ç† Aapche Ranger 3. é¡¹ç›®èƒŒæ™¯äº’è”ç½‘é‡‘èè¡Œä¸š, ä¿¡è´·, ç†è´¢ å…³é”®æ€§æ•°æ®éœ€æ±‚ï¼š é‡‡é›†å®¢æˆ·ç³»ç»Ÿ, é£æ§ç³»ç»Ÿ, æ ¸å¿ƒæ”¾æ¬¾ç³»ç»Ÿ, äº§å“, ç»„ç»‡ç®¡ç†ç­‰ç³»ç»Ÿæ•°æ®, è¿›è¡Œæ•´åˆ å®¢æˆ·ä¸»é¢˜è¿›è¡Œåˆ†æ: å®¢æˆ·ç»“æ„, å®¢æˆ·è´¨é‡, å®¢æˆ·è½¬åŒ–ç‡ ç»è¥æ•ˆç‡çš„åˆ†æ é£é™©ä¸»é¢˜åˆ†æ: é£é™©, é€¾æœŸç‡, äº§å“çš„è¿çº¦ç‡ è´¢åŠ¡ä¸»é¢˜åˆ†æ: è´¡çŒ®ç‡ æ•°æ®å¯è§†åŒ–: é€šè¿‡æŠ¥è¡¨æˆ–å¤§å±çš„å½¢å¼å±•ç¤ºç»™ç®¡ç†è€… 4. æ•°æ®è°ƒç ” No. Table Name Desc 1. channel_info 2. com_manager_info 3. dict_citys 4. dict_product 5. dict_provinces 6. drawal_address 7. drawal_apply å€Ÿæ¬¾ç”³è¯·ID, ä¿¡ç”¨å®¡æ ¸ID, é‡‘é¢, æœŸé™, å¾…è¿˜é‡‘é¢, æ”¾æ¬¾æ—¶é—´, åè®®ID, ä¸‹ä¸€ä¸ªè¿˜æ¬¾æ—¶é—´, æ”¾æ¬¾èµ„é‡‘æºID, åè®®æ ¸å¯¹æ ‡è¯†, ä¿¡ç”¨å®¡æ ¸ç±»å‹, ç”¨æˆ·ç±»å‹, æ”¾æ¬¾ç±»å‹ 8. drawal_companys 9. loan_apply 10. loan_apply_credit_report 11. loan_apply_salary 12. loan_credit å®¡æ ¸çŠ¶æ€, æ—¶é—´, ç»“è®º, äº§å“, æ‰¹å‡†é‡‘é¢, æœŸé™, åˆ†æ•° 13. repay_plan user_id, apply_id, contract_amount, loan_termæœŸé™, paid_amount å·²è¿˜é‡‘é¢, é¢„å­˜é‡‘é¢, å°šæ¬ é‡‘é¢, å‡å…é‡‘é¢, æå‰ç»“æ¸…è¿çº¦é‡‘, ä¸æ ¸å¿ƒåŒæ­¥æ—¶é—´ 14. repay_plan_item drawal_apply_idææ¬¾ç”³è¯·ID, repay_plan_idè¿˜æ¬¾è®¡åˆ’ID, repay_itemè¿˜æ¬¾æœŸæ•°ç¼–å·, due_dataé€¾æœŸæ—¶é—´, dest_principal, dest_interest, dest_service, dest_pty_fee æœ¬æ¯æ»çº³é‡‘, â€¦ 15. repay_plan_item_his 16. user_det 17. user_ocr_log 18. user_md5 19. user_quota ä¿¡ç”¨é¢åº¦, å·²ä½¿ç”¨é¢, æœªä½¿ç”¨é¢, å¤±æ•ˆæ—¥æœŸ, é¢åº¦å¤±æ•ˆæ—¥æœŸ.. 20. users SELECT user_id, count(id) as xFROM loan_applygroup by user_idhaving count(id) &gt;= 2 5. DWåˆ†å±‚æ¸…æ™°çš„æ•°æ®ç»“æ„: æ¯ä¸€å±‚çš„ä½œç”¨ä¸ä¸€æ ·, ç›®çš„æ˜¯æˆ‘æ›´å¥½çš„å®šä½å’Œç†è§£æ•°æ® æ–¹ä¾¿æ•°æ®è¡€ç¼˜è¿½è¸ª: å‡å°‘é‡å¤æ€§çš„å¼€å‘: ä¸‰ä¸ªä¸åŒçš„éœ€æ±‚, éƒ½éœ€è¦ä»5å¼ è¡¨è·å–æ•°æ®, éƒ½éœ€æ±‚è¿›è¡Œæ¸…æ´—å’Œè½¬æ¢. æŠŠå¤æ‚é—®é¢˜ç®€å•åŒ–: å®¢æˆ·ä»·å€¼ï¼š è´­ä¹°é¢åº¦ï¼Œ æ¬¡æ•° (äº§å“) äº§å“1: æ¬¡æ•°, é¢åº¦ â€”table1 äº§å“2: æ¬¡æ•°, é¢åº¦ â€”table1 DW 4 å¤§ç‰¹å¾: Subject Orientedã€Integrateã€Non-Volatilã€Time Variant . æ•°ä»“åˆ†å±‚ STG Stage ï¼ˆä¸åšä»»ä½•åŠ å·¥, ç¦æ­¢é‡å¤è¿›å…¥ï¼‰ ODSï¼ˆOperational Data Storeï¼‰ä¸åšå¤„ç†ï¼Œå­˜æ”¾åŸå§‹æ•°æ® (è¯¥å±‚åœ¨stageä¸Šä»…æ•°æ®æ ¼å¼åˆ°æ ‡å‡†æ ¼å¼è½¬æ¢) DWDï¼ˆData Warehouse Summary æ˜ç»†æ•°æ®å±‚ï¼‰è¿›è¡Œç®€å•æ•°æ®æ¸…æ´—ï¼Œé™ç»´ DWSï¼ˆData Warehouse Summary æœåŠ¡æ•°æ®å±‚ï¼‰è¿›è¡Œè½»åº¦æ±‡æ€»ï¼ˆåšå®½è¡¨ï¼‰ ADSï¼ˆApplication Data Summary æ•°æ®åº”ç”¨å±‚ï¼‰ä¸ºæŠ¥è¡¨æä¾›æ•°æ® 5.1 DWH basicdata warehouse é€»è¾‘åˆ†å±‚æ¶æ„ï¼š ODSå±‚ä½œç”¨ï¼š ä¸ºDWåšæ•°æ®å‡†å¤‡, å‡å°‘DWå‡å°‘å¯¹ä¸šåŠ¡åº“çš„å½±å“ODSå±‚æ•°æ®æ¥æºï¼š ä¸šåŠ¡åº“, åŸ‹ç‚¹æ•°æ®, æ¶ˆæ¯é˜Ÿåˆ—ODSå±‚å»ºè®¾åŸåˆ™ï¼š æ•°æ®ä¿ç•™æ—¶é—´æ ¹æ®ä¸šåŠ¡å…·ä½“ç¡®å®š DWå±‚: Data Warehouse æ•°æ®æ¥æº: åªèƒ½æ˜¯ ODS å±‚å»ºè®¾æ–¹å¼: æ ¹æ®ODSå±‚æ•°æ®æŒ‰ç…§ä¸»é¢˜æ€§å½’ç±»å»ºæ¨¡4ä¸ªåŸºæœ¬æ¦‚å¿µï¼š ç»´åº¦, äº‹å®, æŒ‡æ ‡(åº¦é‡), ç²’åº¦é€¾æœŸä¸€æœŸçš„å®¢æˆ·è¡¨ç°: é€¾æœŸé‡‘é¢ (å®¢æˆ·, äº§å“, ç»„ç»‡, æ—¶é—´)å®¢æˆ·æ³¨å†Œäº‹å®è¡¨: ä¸€æ¡å®¢æˆ·æ³¨å†Œè®°å½•å°±æ˜¯ä¸€ä¸ªäº‹å®. æŒ‡æ ‡: å®¢æˆ·æ³¨å†Œé‡ DWå±‚å†…éƒ¨æ˜¯ä¸€ä¸ªç»†åˆ†å­å±‚: DWD, DWB DWD: æ˜ç»†ç²’åº¦çš„æ•°æ®, æ¸…æ´—, è§£å†³æ•°æ®çš„è´¨é‡é—®é¢˜. NULL, ç¼–ç è½¬æ¢é—®é¢˜. ç›‘ç®¡æŠ¥é€æˆ–åˆè§„æ ¸æŸ¥æä¾›æœ€åŸºæœ¬çš„æ•°æ® ç•™å¿«ç…§: DWBå±‚: åŸºç¡€æ•°æ®å±‚, å®¢æˆ·ç»Ÿè®¡æ•°æ®, ä¸­é—´å±‚ä½¿ç”¨ (ç²’åº¦è¿˜æ˜¯æ¯”è¾ƒç»†) DWSå±‚: åœ¨DWBå±‚çš„åŸºç¡€ä¸Šè¿›è¡Œæ±‡æ€» DMå±‚ï¼š å¯¹æ˜ç»†æ•°æ®è¿›è¡Œé¢„åŠ å·¥, æ±‡æ€» ä¸å…³è”, å»ºç«‹å¤šç»´ç«‹æ–¹ä½“çš„æ•°æ®é‡, æé«˜æŸ¥è¯¢æ•ˆç‡ APPå±‚: æœåŠ¡äºç»ˆç«¯ç”¨æˆ·, é«˜åº¦æ±‡æ€» DW: ä¸€å¼ äº‹å®è¡¨æœ‰20ä¸ªç»´åº¦, 5ä¸ªæŒ‡æ ‡, DMå±‚å°±å¯èƒ½æœ‰ï¼š10ä¸ªç»´åº¦ï¼Œ5ä¸ªæŒ‡æ ‡; APPå±‚3ä¸ª,5ä¸ªæŒ‡æ ‡ 3.0æ•°æ®ä»“åº“å»ºè¡¨è§„èŒƒ DWå±‚ï¼š dwfactä¸»é¢˜table_name (dw_fact_cus_regeste_detail)Dimå±‚ï¼šdim_table_name, ä¾‹å¦‚ï¼š dim_productDmå±‚ï¼š dm_facté›†å¸‚å_table_name, ä¾‹å¦‚ï¼š dm_fact_risk_first_overdue å®¢æˆ·é¦–æœŸé€¾æœŸ å›¾ æ•°æ®ä»“åº“å»ºæ¨¡ user_md5 ä½ æŒæœ‰çš„ä¿¡æ¯å’Œå…¬å®‰éƒ¨çš„ä¿¡æ¯æ˜¯å¦ä¸€è‡´ å®¢æˆ·ç»ç†ç»Ÿè®¡è¡¨ DM å±‚çš„ åœ¨æ•°æ®ä»“åº“ä¸­ï¼Œæœ‰äº›è¡¨æ—¢å¯ä»¥ä½œä¸º fact ä¹Ÿå¯ä»¥ä½œä¸º dim MD5è®¤è¯ å¤šæ•°äºº 1.1 æ³¨å†Œ ç«‹é©¬ 1.2 OCRè®¤è¯ 1.3 MD5è®¤è¯ 99%åŒä¸€å¤©å®Œæˆ power-design åè®® - æ”¯ç”¨ç”³è¯·ï¼Œç­¾ç½²äº†æ”¯ç”¨åè®®ï¼Œæ‰äº§ç”Ÿå€Ÿæ®ï¼Œ å€Ÿæ®å· çš„ä¿¡æ¯åœ¨è¿™é‡Œ. äº‹ä»¶ - è¿˜æ¬¾ï¼Œå€Ÿæ¬¾ äº§å“ - ä¸šåŠ¡æµç¨‹ ï¼Œ åªæœ‰ç»´åº¦è¡¨ å®¢æˆ· - ç”¨æˆ·ä¿¡æ¯, éå¸¸å¤š, äººè¡Œå¾ä¿¡ä¿¡æ¯ï¼Œ ä¸ªäººèµ„äº§ä¿¡æ¯ æœºæ„ - çº¿ä¸‹æœ‰å“ªäº›å›¢é˜Ÿ, æµ™æ±ŸåŒºï¼Œå›¢é˜Ÿé•¿ï¼Œå®¢æˆ·ç»ç†ï¼Œ æœ‰ 600 ä¸ª. åªæœ‰ç»´åº¦è¡¨ (1). åŒä¸šå€Ÿæ¬¾, 100å¤šäº¿ (2). æ”¾è´·æ¬¾ - äº¬ä¸œï¼Œç™¾åº¦ (3). ç­¾åè®® äº§ç”Ÿ äº§å“ è¥é”€ä¹‹åçš„ï¼Œå•†åŠ¡ç»ç†å’Œæ¸ é“ï¼Œè°ˆä¸‹æ¥ä¹‹åï¼Œ åç«¯ æ¸ é“ï¼Œ èµ„äº§ï¼Œ è´¦åŠ¡ äº§å“ç»´åº¦è¡¨ï¼š äº§å“ç¼–å·(åˆ†å¥½å‡ çº§), äº§å“åç§°, dim_code, dim_nameï¼Œ ä¸Šæ¶ï¼Œ ä¸‹æ¶ äº¬ä¸œé‡‘æ¡ï¼Œ codeï¼Œ å±•ç¤ºç»™è´¢åŠ¡ äº‹ä»¶ä¸»é¢˜ - è¿˜æ¬¾æµæ°´, æˆä¿¡æµæ°´, æ”¯ç”¨æµæ°´, æ”¾æ¬¾æµæ°´, è¿˜æ¬¾è®¡åˆ’. åœ¨åç«¯èµ„äº§çš„æ¨¡å—. DWD - è¿™äº›æµæ°´è¡¨éƒ½åœ¨è¿™å±‚. (1). æˆä¿¡æ”¯ç”¨åï¼Œå°±ä¼šäº§ç”Ÿå€Ÿæ®å· è¿˜æ¬¾æµæ°´ + æ”¯ç”¨æµæ°´ -&gt; è¿˜æ¬¾äº‹å®è¡¨ ï¼Ÿ ä¸ªè´·ä¸šåŠ¡æ•°æ®ï¼ŒåŒ…æ‹¬ç”³è¯·IDï¼Œæœºæ„ä»£å·ï¼Œè´·æ¬¾åˆåŒç¼–å·ï¼Œæ‹…ä¿ç±»å‹ï¼Œè´·æ¬¾æœŸé™ï¼Œè´·æ¬¾èµ·æœŸï¼Œè´·æ¬¾æ­¢æœŸï¼Œè¯‰è®¼æ ‡å¿—ï¼Œé€¾æœŸåˆ©æ¯åˆ©ç‡ï¼Œè¿˜æ¬¾å¸å·ï¼Œç»ˆå®¡é‡‘é¢ï¼Œè´·æ¬¾é‡‘é¢ï¼Œè´·æ¬¾ä½™é¢ï¼Œç»åŠäººç¼–å·ï¼Œç»“æ¸…æ—¥æœŸï¼Œè¿˜æ¬¾æ–¹å¼ï¼Œå®¢æˆ·å§“åï¼Œå®¢æˆ·ç§ç±»ï¼Œå®¢æˆ·æ€§è´¨ï¼Œå®¢æˆ·åˆ†ç±»ï¼Œè¯ä»¶ç±»å‹ï¼Œè¯ä»¶å·ç ï¼Œæµæ°´å·ï¼Œå€Ÿæ®å·ï¼Œå€Ÿæ®é‡‘é¢ï¼Œå€Ÿæ®ä½™é¢ï¼Œå€Ÿæ®åˆ©æ¯ä½™é¢ï¼Œå€Ÿæ®åˆ©ç‡ï¼Œå€Ÿæ®èµ·æœŸï¼Œå€Ÿæ®æ­¢æœŸï¼Œå€Ÿæ¬¾çŠ¶æ€ï¼Œé€¾æœŸå¤©æ•°ï¼Œç»“æ¯æ–¹å¼ï¼Œæ”¾æ¬¾è´¦å·ï¼Œæ”¾æ¬¾è´¦æˆ·æˆ·åç”¨é€”è¯¦æƒ…ï¼Œè¿˜æ¬¾è´¦æˆ·æˆ·åï¼Œè¿˜æ¬¾è´¦æˆ·è´¦å·ç­‰ã€‚ è¿˜æ¬¾äº‹å®è¡¨ - å€Ÿæ®å·(å¯ä»¥å…³è”åˆ°ç”¨æˆ·å’Œäº§å“), è¿˜æ¬¾æµæ°´å·, è¿˜æ¬¾é‡‘é¢(æœ¬é‡‘ï¼Œåˆ©æ¯ï¼Œæ‰‹ç»­è´¹), user_id, product_id, custom_id æ˜¯åœ¨ DWDï¼Œ æ˜¯æ ¹æ®æµæ°´è¡¨å…³è”å‡ºæ¥çš„ ä¸‹æ¸¸å¯èƒ½çœ‹ï¼Œå€Ÿæ®ç²’åº¦ï¼Œè¿˜äº†å¤šå°‘é’±ï¼Œ èšåˆ æ¯å¤©æ‹‰æ˜¨å¤©æ–°å¢çš„æµæ°´ å¾ˆå¤šé—®é¢˜æ˜¯ä¸Šæ¸¸æ•°æ®çš„é—®é¢˜ï¼Œè¿˜æœ‰éœ€æ±‚çš„é—®é¢˜ ReferenceåŸºäºç¬”è®°, åˆ»æ„ç»ƒä¹ "},{"title":"","date":"2021-03-07T11:02:34.512Z","updated":"2021-01-17T11:49:00.681Z","comments":true,"path":"hzbank/pre_index.html","permalink":"http://iequa.com/hzbank/pre_index.html","excerpt":"","text":"No. desc Flag 0. å®¢æˆ·ä¿¡æ¯è¡¨ã€åˆåŒä¿¡æ¯è¡¨å’Œè¿˜æ¬¾è®¡åˆ’è¡¨åˆ†åˆ«æ˜¯ä»€ä¹ˆï¼Ÿç©ä¸é€è€æ¿ä¼šæ€€ç–‘æˆ‘çš„èƒ½åŠ›ï¼Ÿ 0. å­—èŠ‚è·³åŠ¨-æ•°æ®ä»“åº“é«˜çº§å·¥ç¨‹å¸ˆé¢è¯• &nbsp; detail 1. æ˜Ÿå‹æ¨¡å‹å’Œé›ªèŠ±å‹æ¨¡å‹æ¯”è¾ƒ æ˜Ÿå‹æ¨¡å‹å› ä¸ºæ•°æ®çš„å†—ä½™æ‰€ä»¥å¾ˆå¤šç»Ÿè®¡æŸ¥è¯¢ä¸éœ€è¦åšå¤–éƒ¨çš„è¿æ¥ï¼Œå› æ­¤ä¸€èˆ¬æƒ…å†µä¸‹æ•ˆç‡æ¯”é›ªèŠ±å‹æ¨¡å‹è¦é«˜ æ˜Ÿå½¢æ¨¡å‹åŠ è½½ç»´åº¦è¡¨ï¼Œä¸éœ€è¦å†ç»´åº¦ä¹‹é—´æ·»åŠ é™„å±æ¨¡å‹ï¼Œå› æ­¤ETLå°±ç›¸å¯¹ç®€å•ï¼Œè€Œä¸”å¯ä»¥å®ç°é«˜åº¦çš„å¹¶è¡ŒåŒ– No. desc Flag 2. äº‹å®è¡¨ï¼Œç»´åº¦ï¼Œåº¦é‡ï¼ŒæŒ‡æ ‡ä¹‹é—´çš„å…³ç³» 3. é¢è¯•å¿…çŸ¥çš„Spark SQLå‡ ç§Joinå®ç° 1. å®¢æˆ·ä¿¡æ¯è¡¨ å®¢æˆ·ä¿¡æ¯è¡¨ä¸­ï¼Œå®¢æˆ·ç¼–å·æ˜¯è¡¨çš„ä¸»é”®ï¼ˆå”¯ä¸€å€¼ï¼Œç”¨äºå…³è”å…¶ä»–è¡¨ï¼‰ï¼Œå…¶ä»–æ•°æ®å¤§éƒ¨åˆ†æ˜¯æ ‡å‡†åŒ–çš„è¿ç»­å˜é‡å’Œåˆ†ç±»å˜é‡ï¼Œæ¯”å¦‚â€œå©šå§»çŠ¶æ€â€ã€â€œæˆ·ç±çœâ€ã€â€œå®¶åº­å­å¥³æ•°â€ã€‚å½“ç„¶ï¼Œä¹Ÿä¼šå­˜åœ¨ç±»ä¼¼â€œid_noâ€ã€â€mobileâ€œè¿™ç§éæ ‡å‡†åŒ–å˜é‡ï¼Œè¿™äº›å˜é‡ä¸»è¦ç”¨äºæ¬ºè¯ˆå…³è”åˆ†æï¼Œè´·åå‚¬æ”¶ç»“æœåˆ†æã€‚ 2. åˆåŒä¿¡æ¯è¡¨ å½“å€Ÿæ¬¾å®¢æˆ·å®Œæˆç”³è¯·å…¨æµç¨‹ï¼Œç¡®è®¤å€Ÿæ¬¾ä¸”å®¡æ‰¹é€šè¿‡åï¼Œé‡‘èæœºæ„ä¼šé’ˆå¯¹æ¯ä¸ªå€Ÿæ¬¾äººç”Ÿæˆä¸ä¹‹å¯¹åº”çš„è´·æ¬¾åˆåŒã€‚åˆåŒä¿¡æ¯è¡¨é‡Œè¯¦ç»†è®°è½½äº†å®¢æˆ·çš„è´·æ¬¾ä¿¡æ¯ã€è´·æ¬¾ç”¨é€”ã€æ”¾æ¬¾ä¿¡æ¯ã€é€¾æœŸçŠ¶æ€ã€åˆåŒçŠ¶æ€ã€åˆ©ç‡ã€‚ 3. è¿˜æ¬¾è®¡åˆ’è¡¨è¿˜æ¬¾è®¡åˆ’è¡¨ä¸¥æ ¼æ„ä¹‰ä¸Šåº”è¯¥åˆ†ä¸º çº¦å®šè¿˜æ¬¾ å’Œ å®é™…è¿˜æ¬¾ ä¸¤éƒ¨åˆ†. ä¸€éƒ¨åˆ†æ˜¯åˆåŒç”Ÿæˆæ—¶å°±äº§ç”Ÿäº†ï¼Œè€Œå¦ä¸€éƒ¨åˆ†æ˜¯è®°å½•åˆåŒç»“æŸå‰å®¢æˆ·çš„å®é™…è¿˜æ¬¾æƒ…å†µã€‚ è¿˜æ¬¾è®¡åˆ’è¡¨ä¸»è¦åŒ…æ‹¬ä¸‰å¤§ä¿¡æ¯ï¼š çº¦å®šè¿˜æ¬¾ã€å®é™…è¿˜æ¬¾åŠå…¶ä»–ä¿¡æ¯ å…¶ä¸­çº¦å®šè¿˜æ¬¾æ ¸å¿ƒå­—æ®µåŒ…æ‹¬â€œå½“å‰æœŸæ•°â€ã€â€œè®¡åˆ’è¿˜æ¬¾æ—¥â€ã€â€œåº”è¿˜æœ¬é‡‘â€ã€â€åº”è¿˜åˆ©æ¯â€œï¼› å®é™…è¿˜æ¬¾æ ¸å¿ƒå­—æ®µåŒ…æ‹¬â€å®é™…è¿˜æ¬¾æ—¥æœŸâ€œã€â€å·²è¿˜æœ¬/åˆ©/ç½šâ€œã€â€œé€¾æœŸæœ¬/åˆ©/ç½šâ€ã€â€œå‡å…æœ¬/åˆ©/ç½šâ€ï¼› å…¶ä»–ä¿¡æ¯åˆ™åŒ…æ‹¬â€œäº¤æ˜“çŠ¶æ€â€ã€â€œé€¾æœŸå¤©æ•°â€œã€â€å‰©ä½™æœŸæ•°â€œç­‰ã€‚ è¿˜æ¬¾è®¡åˆ’è¡¨è®°å½•äº†å®¢æˆ·çš„è¿˜æ¬¾è½¨è¿¹ï¼Œèƒ½å¤Ÿç›´æ¥å®šæ€§ä¸€ä¸ªå®¢æˆ·çš„å¥½åï¼Œè®¡ç®—é€¾æœŸç‡ã€è´¦é¾„ä»¥åŠå®šä¹‰å»ºæ¨¡æ—¶çš„ç›®æ ‡å˜é‡ï¼Œè¿™äº›éƒ½éœ€è¦é€šè¿‡è¿™ä¸ªè¡¨çš„æ•°æ®å®Œæˆã€‚å› æ­¤ï¼Œè¿˜æ¬¾è®¡åˆ’è¡¨æ˜¯ç­–ç•¥è¿­ä»£ã€å»ºæ¨¡ã€æ•°æ®åˆ†æä¸­æœ€ä¸ºé‡è¦çš„è¡¨ã€‚ power-design åè®® - æ”¯ç”¨ç”³è¯·ï¼Œç­¾ç½²äº†æ”¯ç”¨åè®®ï¼Œæ‰äº§ç”Ÿå€Ÿæ®ï¼Œ å€Ÿæ®å· çš„ä¿¡æ¯åœ¨è¿™é‡Œ. äº‹ä»¶ - è¿˜æ¬¾ï¼Œå€Ÿæ¬¾ äº§å“ - ä¸šåŠ¡æµç¨‹ ï¼Œ åªæœ‰ç»´åº¦è¡¨ å®¢æˆ· - ç”¨æˆ·ä¿¡æ¯, éå¸¸å¤š, äººè¡Œå¾ä¿¡ä¿¡æ¯ï¼Œ ä¸ªäººèµ„äº§ä¿¡æ¯ æœºæ„ - çº¿ä¸‹æœ‰å“ªäº›å›¢é˜Ÿ, æµ™æ±ŸåŒºï¼Œå›¢é˜Ÿé•¿ï¼Œå®¢æˆ·ç»ç†ï¼Œ æœ‰ 600 ä¸ª. åªæœ‰ç»´åº¦è¡¨ (1). åŒä¸šå€Ÿæ¬¾, 100å¤šäº¿ (2). æ”¾è´·æ¬¾ - äº¬ä¸œï¼Œç™¾åº¦ (3). ç­¾åè®® äº§ç”Ÿ äº§å“ è¥é”€ä¹‹åçš„ï¼Œå•†åŠ¡ç»ç†å’Œæ¸ é“ï¼Œè°ˆä¸‹æ¥ä¹‹åï¼Œ åç«¯ æ¸ é“ï¼Œ èµ„äº§ï¼Œ è´¦åŠ¡ äº§å“ç»´åº¦è¡¨ï¼š äº§å“ç¼–å·(åˆ†å¥½å‡ çº§), äº§å“åç§°, dim_code, dim_nameï¼Œ ä¸Šæ¶ï¼Œ ä¸‹æ¶ äº¬ä¸œé‡‘æ¡ï¼Œ codeï¼Œ å±•ç¤ºç»™è´¢åŠ¡ äº‹ä»¶ä¸»é¢˜ - è¿˜æ¬¾æµæ°´, æˆä¿¡æµæ°´, æ”¯ç”¨æµæ°´, æ”¾æ¬¾æµæ°´, è¿˜æ¬¾è®¡åˆ’. åœ¨åç«¯èµ„äº§çš„æ¨¡å—. DWD - è¿™äº›æµæ°´è¡¨éƒ½åœ¨è¿™å±‚. (1). æˆä¿¡æ”¯ç”¨åï¼Œå°±ä¼šäº§ç”Ÿå€Ÿæ®å· è¿˜æ¬¾æµæ°´ + æ”¯ç”¨æµæ°´ -&gt; è¿˜æ¬¾äº‹å®è¡¨ ï¼Ÿ ä¸ªè´·ä¸šåŠ¡æ•°æ®ï¼ŒåŒ…æ‹¬ç”³è¯·IDï¼Œæœºæ„ä»£å·ï¼Œè´·æ¬¾åˆåŒç¼–å·ï¼Œæ‹…ä¿ç±»å‹ï¼Œè´·æ¬¾æœŸé™ï¼Œè´·æ¬¾èµ·æœŸï¼Œè´·æ¬¾æ­¢æœŸï¼Œè¯‰è®¼æ ‡å¿—ï¼Œé€¾æœŸåˆ©æ¯åˆ©ç‡ï¼Œè¿˜æ¬¾å¸å·ï¼Œç»ˆå®¡é‡‘é¢ï¼Œè´·æ¬¾é‡‘é¢ï¼Œè´·æ¬¾ä½™é¢ï¼Œç»åŠäººç¼–å·ï¼Œç»“æ¸…æ—¥æœŸï¼Œè¿˜æ¬¾æ–¹å¼ï¼Œå®¢æˆ·å§“åï¼Œå®¢æˆ·ç§ç±»ï¼Œå®¢æˆ·æ€§è´¨ï¼Œå®¢æˆ·åˆ†ç±»ï¼Œè¯ä»¶ç±»å‹ï¼Œè¯ä»¶å·ç ï¼Œæµæ°´å·ï¼Œå€Ÿæ®å·ï¼Œå€Ÿæ®é‡‘é¢ï¼Œå€Ÿæ®ä½™é¢ï¼Œå€Ÿæ®åˆ©æ¯ä½™é¢ï¼Œå€Ÿæ®åˆ©ç‡ï¼Œå€Ÿæ®èµ·æœŸï¼Œå€Ÿæ®æ­¢æœŸï¼Œå€Ÿæ¬¾çŠ¶æ€ï¼Œé€¾æœŸå¤©æ•°ï¼Œç»“æ¯æ–¹å¼ï¼Œæ”¾æ¬¾è´¦å·ï¼Œæ”¾æ¬¾è´¦æˆ·æˆ·åç”¨é€”è¯¦æƒ…ï¼Œè¿˜æ¬¾è´¦æˆ·æˆ·åï¼Œè¿˜æ¬¾è´¦æˆ·è´¦å·ç­‰ã€‚ è¿˜æ¬¾äº‹å®è¡¨ - å€Ÿæ®å·(å¯ä»¥å…³è”åˆ°ç”¨æˆ·å’Œäº§å“), è¿˜æ¬¾æµæ°´å·, è¿˜æ¬¾é‡‘é¢(æœ¬é‡‘ï¼Œåˆ©æ¯ï¼Œæ‰‹ç»­è´¹), user_id, product_id, custom_id æ˜¯åœ¨ DWDï¼Œ æ˜¯æ ¹æ®æµæ°´è¡¨å…³è”å‡ºæ¥çš„ ä¸‹æ¸¸å¯èƒ½çœ‹ï¼Œå€Ÿæ®ç²’åº¦ï¼Œè¿˜äº†å¤šå°‘é’±ï¼Œ èšåˆ æ¯å¤©æ‹‰æ˜¨å¤©æ–°å¢çš„æµæ°´ å¾ˆå¤šé—®é¢˜æ˜¯ä¸Šæ¸¸æ•°æ®çš„é—®é¢˜ï¼Œè¿˜æœ‰éœ€æ±‚çš„é—®é¢˜"},{"title":"Python","date":"2018-01-06T08:46:48.000Z","updated":"2019-10-20T04:30:33.520Z","comments":true,"path":"python_language/index.html","permalink":"http://iequa.com/python_language/index.html","excerpt":"","text":"Python æ˜¯ Guido van Rossum 1989 å¹´åœ£è¯èŠ‚æœŸé—´ï¼Œä¸ºäº†æ‰“å‘æ— èŠçš„åœ£è¯èŠ‚è€Œç¼–å†™çš„ä¸€ä¸ªç¼–ç¨‹è¯­è¨€. Python å“²å­¦å°±æ˜¯ç®€å•ä¼˜é›…ï¼Œå°½é‡å†™å®¹æ˜“çœ‹æ˜ç™½çš„ä»£ç ï¼Œå°½é‡å†™å°‘çš„ä»£ç . Python å¼€å‘äº†å¾ˆå¤šæ˜æ˜Ÿç½‘ç«™ï¼Œä¾‹å¦‚ YouTubeã€Instagramã€Douban. Python 1.0 : Python Pyenv &amp; Anaconda3 1.1 : Python Data Analysis Lib Introduce 1.2 : Python Outputã€Variableã€dataTypeã€Ifã€While/Forã€Py Head 1.3 : Python String-Encoding and Str Python 2 2.1 : Python Listã€Tupleã€Dictã€Set 2.2 : Python å®šä¹‰å‡½æ•°ã€é»˜è®¤å‚æ•° 2.3 : Python IO : Read File &nbsp; (openã€appendã€readlineã€readlinesã€closeã€with open ..) Class 3.1 : Class Advanced 4.1 : Sliceã€Iterationã€List generationã€Generator 4.2 : zip lambda map 4.3 : try â€¦ except â€¦ as â€¦ 4.4 : copy &amp; deepcopy 4.5 : pickle Project ç»“æ„åŒ–ä½ çš„å·¥ç¨‹ next â‹¯â‹¯ notesï¼šnext â€¦"},{"title":"Matplotlib","date":"2018-01-06T08:46:48.000Z","updated":"2019-10-20T04:30:35.085Z","comments":true,"path":"python_matplotlib/index.html","permalink":"http://iequa.com/python_matplotlib/index.html","excerpt":"","text":"&nbsp;&nbsp; Matplotlib æ˜¯ä¸€ä¸ªéå¸¸å¼ºå¤§çš„ Python ç”»å›¾å·¥å…· &nbsp;åŸºæœ¬ä½¿ç”¨ 4.1 : Matplotlib Why ? 4.2 : Matplotlib Basic Use 4.3 : Matplotlib Figure 4.4 : Matplotlib Coordinate axis 4.5 : Matplotlib Legend 4.6 : Matplotlib Annotation 4.7 : Matplotlib Tick bbox &nbsp;ç”»å›¾ç§ç±» 4.08 : Matplotlib Scatter 4.09 : Matplotlib Bar 4.10 : Contours * 4.11 : Image å›¾ç‰‡ * 4.12 : 3D æ•°æ® * &nbsp;å¤šå›¾åˆå¹¶æ˜¾ç¤º 4.13 : Subplot å¤šåˆä¸€æ˜¾ç¤º * 4.14 : Subplot åˆ†æ ¼æ˜¾ç¤º * 4.15 : å›¾ä¸­å›¾ * 4.16 : æ¬¡åæ ‡è½´ * next â‹¯â‹¯ notesï¼šnext â€¦"},{"title":"Numpy & Pandas","date":"2018-01-06T08:46:48.000Z","updated":"2019-10-20T04:30:37.078Z","comments":true,"path":"python_numpy_pandas/index.html","permalink":"http://iequa.com/python_numpy_pandas/index.html","excerpt":"","text":"&nbsp;&nbsp;ä»»ä½•å…³äºæ•°æ®åˆ†æçš„æ¨¡å—éƒ½å°‘ä¸äº†å®ƒä»¬ä¸¤ä¸ª Numpy 2.1 : Numpy Attribute 2.2 : Numpy Array 2.3 : Numpy Basic Operation 1 2.4 : Numpy Basic Operation 2 2.5 : Numpy Index 2.6 : Numpy Array Merge 2.7 : Numpy Array Split 2.8 : Numpy Copy &amp; Deep Copy Pandas 3.1 : Pandas Basic Intro 3.2 : Pandas Select Data 3.3 : Pandas Set Value â€” loc/iloc 3.4 : Pandas Deal NaN Data 3.5 : Pandas Import &amp; Output 3.6 : Pandas Concatã€Join 3.7 : Pandas Merge 3.8 : Pandas Matplotlib Intro notesï¼šnext â€¦"},{"title":"","date":"2021-06-13T15:25:37.159Z","updated":"2021-06-13T15:25:37.158Z","comments":true,"path":"sina_project/index.html","permalink":"http://iequa.com/sina_project/index.html","excerpt":"","text":"1. user profile å†…å®¹å…´è¶£æŒ–æ˜æ–°æµªç”¨æˆ·å…´è¶£æŒ–æ˜ç³»ç»Ÿï¼Œæ®ç”¨æˆ·åœ¨äº’è”ç½‘ä¸Šçš„è®¿é—®è¡Œä¸ºï¼Œåˆ©ç”¨ LRã€Decision treeã€Random Forest ç­‰æ¨¡å‹é¢„æµ‹ç”¨æˆ·çš„å…´è¶£ã€‚ æŒ–æ˜ç”¨æˆ·æ ‡ç­¾ä¿¡æ¯æœ‰åŠ©äºå¹¿å‘Šä¸»æ›´åŠ å®šå‘ï¼Œå‡†ç¡®ï¼Œä¸ªæ€§åŒ–çš„æŠ•æ”¾å¹¿å‘Šï¼Œä½¿å¹¿å‘Šè¢«è½¬åŒ–çš„ä»·å€¼å°½å¯èƒ½æœ€å¤§åŒ–ã€‚ ä¸»è¦æµç¨‹åˆ†ä¸º4å¤§æ¨¡å—ï¼šæ•°æ®æºè·å–ã€ç½‘é¡µè§„èŒƒåŒ–ã€ç‰¹å¾è®¡ç®—ï¼Œå…´è¶£ç­–ç•¥èåˆ . 2. dmp é¡¹ç›®æ–°æµªdmpåŸºäºå¹¿å‘Šç¨‹åºåŒ–è´­ä¹°åœºæ™¯ï¼Œå°†å¹¿å‘Šä¸»æ•°æ®æ•´åˆæ¥å…¥ï¼Œå¹¶ç»“åˆæ–°æµªè‡ªæœ‰æ•°æ®ï¼Œæ ‡å‡†åŒ–ç»Ÿä¸€ç®¡ç†æ•°æ®ã€‚åŒæ—¶ï¼Œé€šè¿‡å¯¹æ•°æ®è¿›è¡Œç»†åŒ–æ•°æ®æ ‡ç­¾ï¼Œå®Œå–„åˆ†ç±»ä½“ç³»ï¼Œå‘ç”¨æˆ·æä¾›å¤šæ ·åŒ–çš„æ•°æ®åº”ç”¨æœåŠ¡ã€‚ æœ¬äººèŒè´£ ï¼š(1). ç”¨æˆ·æ ‡ç­¾è§„èŒƒåŒ–(2). æä¾› redis å­˜å‚¨æœåŠ¡, ç›¸å…³æ¥å£çš„å°è£… 1) æ”¯æŒæ¥æ”¶ä¸åŒæ¥æºçš„æ•°æ®ã€‚ 2) æ”¯æŒè®¿é—® redis é›†ç¾¤ç­–ç•¥å¯é…ï¼Œè¯»æ•°æ®è´Ÿè½½å‡è¡¡ 3) æŸæœºå™¨æˆ–å®ä¾‹å‡ºæ•…éšœï¼Œæ˜“äºç»´æŠ¤(3). æä¾›ç¬¬ä¸‰æ–¹æ•°æ®ç”¨æˆ·æ¨èå•†å“, 10ç§ç”¨æˆ·è¡Œä¸ºæ•°æ® çš„æ¥å…¥æ¥å£ host.txt é›†ç¾¤èŠ‚ç‚¹å®ä¾‹é…ç½®## REDIS1 DMP_INFO ## (128ä¸ªèŠ‚ç‚¹ï¼Œæ¯ä¸ªèŠ‚ç‚¹é…ç½® 60% æœºå™¨å†…å­˜ç»™ redis å®ä¾‹)REDIS1#pool1:10.**.*.**:6382$10.**.*.**:6382|pool2:10.**.***.**:6382$10.**.*.**:6382|pool3:10.**.**.**:6382$10.**.*.**:6382......## REDIS3 ##REDIS3#pool1:172.**.***.**:6571$1|pool2:172.**.***.**:6571$1REDIS3#pool1:172.**.***.**:6572$2|pool2:172.**.***.**:6572$2...regionToRedis regioné€‰æ‹©é›†ç¾¤DMP_INFO=REDIS1CROSS_INFO=REDIS33RD_INFO=REDIS3strategy.properties ç­–ç•¥é…ç½®REDIS1=read:random|pool2,pool3#write:pool1REDIS3=read:order|pool2,pool1#write:pool1 Coder æ›´å¤šé¡¹ç›®è¯¦æƒ…è¯·ç‚¹å‡»â€¦ (ä¸ºäº†æ›´å¥½çš„äº’ç›¸äº†è§£ï¼Œè„±æ•åæš‚æ—¶æ”¾ä¸Šgit,åä¼šè¿…é€Ÿç§»é™¤) 2.1 ç”¨æˆ·è¡Œä¸ºæ•°æ®æ¥æ”¶ä¸æŒ–æ˜æœ¬æ¨¡å—æ˜¯æ‰¶ç¿¼æ•ˆæœå¹³å°åŠ¨æ€åˆ›æ„é¡¹ç›®çš„ä¸€éƒ¨åˆ†ï¼Œä¸»è¦å®Œæˆç”¨æˆ·åœ¨å®¢æˆ·ç½‘ç«™ä¸Šçš„è¡Œä¸ºæ•°æ®æ¥æ”¶ä¸åˆ†å‘ã€‚æœ¬æœŸåŠ¨æ€åˆ›æ„ä¸“æŒ‡ä¸ªæ€§åŒ–é‡å®šå‘ï¼Œå³ä¸»è¦é’ˆå¯¹ç”µå•†å®¢æˆ·åˆ©ç”¨å…¶ç«™å†…ç”¨æˆ·è¡Œä¸ºæ•°æ®å’Œå•†å“æ•°æ®ä¸ºå¹¿å‘Šç”¨æˆ·å±•ç¤ºæœ€åˆé€‚çš„ä¸€ç»„å•†å“ä¿¡æ¯ï¼ˆå›¾ç‰‡ã€ä»·é’±ã€æŠ˜æ‰£ç­‰ï¼‰ç»„æˆçš„åˆ›æ„ ç”¨æˆ·è®¿é—®å¹¿å‘Šå®¢æˆ·ç½‘ç«™æ—¶ï¼Œè§¦å‘éƒ¨ç½²çš„ç›‘æµ‹ä»£ç ï¼Œå‘æ–°æµªå‘é€å„ç§ç”¨æˆ·è¡Œä¸ºæ•°æ®ã€‚ æ•°æ®æ¥æ”¶æœåŠ¡æ”¶åˆ°è¯·æ±‚ï¼Œè¿›è¡Œæ•°æ®è§£æä¸éªŒè¯ æ ¹æ®æ¥æ”¶çš„æ•°æ®ç±»å‹ï¼Œæ›´æ–°æ•°æ®å¯¹æ¥çŠ¶æ€ å°†æ¥æ”¶æ•°æ®å¤„ç†ä¸ºä¸‹æ¸¸éœ€è¦çš„æ ¼å¼ï¼ŒæŠ“å‘åˆ°æ¶ˆæ¯é˜Ÿåˆ— ä¸ºæ”¯æŒç¦»çº¿çš„æ•°æ®æŒ–æ˜ï¼Œå°†æ•°æ®å†™å…¥æ—¥å¿—ï¼Œå¹¶å®æ—¶å‘é€è‡³HDFS. 2.2 ç›¸å…³é…ç½®æ–‡ä»¶ configa) ä¿®æ”¹é…ç½®bin/catalina.shï¼Œæ·»åŠ javaé…ç½® i. JAVA_OPTS=&#x27;-Xms40000m -Xmx40000m -Xmn10000m -XX:+UseConcMarkSweepGC -XX:+UseParNewGC -verbose:gc -XX:+PrintGCDetails -XX:+PrintGCTimeStamps -XX:+DisableExplicitGC -XX:+CMSParallelRemarkEnabled -Dsun.rmi.dgc.server.gcInterval=86400000 -Dsun.rmi.dgc.client.gcInterval=86400000 -XX:+ExplicitGCInvokesConcurrent -XX:+CMSScavengeBeforeRemark -XX:+CMSClassUnloadingEnabled -XX:CMSInitiatingOccupancyFraction=60 -XX:+UseCMSInitiatingOccupancyOnly&#x27; b) ä¿®æ”¹é…ç½®conf/server.xmlï¼Œconnectorsé…ç½®ï¼Œæ·»åŠ  i. &lt;Connector port=&quot;8080&quot; protocol=&quot;HTTP/1.1&quot;ii. connectionTimeout=&quot;20000&quot;iii. redirectPort=&quot;8443&quot; iv. acceptCount=&quot;5000&quot; maxThreads=&quot;4000&quot;/&gt; 2.3 æ¨èå•†å“æ¥æ”¶æ¥å£ pc uv 3500W+ , wap uv 4500W+, weibo uv 1.6~1.8äº¿ 200ä¸ªå¹¶å‘åšæ¥å£å‹æµ‹ï¼Œqpsæ˜¯3000+ï¼Œå‡å»¶æ—¶65msã€‚ å»¶æ—¶ä¸»è¦è€—åœ¨åŸŸåè§£æä¸Šï¼Œå†…ç½‘å‹æµ‹qpsæ˜¯3ä¸‡+ï¼Œå‡å»¶æ—¶10ms 3. ç¦»çº¿åˆ†æè°ƒåº¦æ¡†æ¶è¿™æ˜¯ä¸€ä¸ª shell ç­‰å…¶ä»–è¯­è¨€é…åˆå†™æˆçš„çµæ´»è°ƒåº¦æ¡†æ¶. è¯¥ç¤ºä¾‹æ¨¡å—æ¶ é€‚ç”¨äºç¦»çº¿åˆ†æè°ƒåº¦ï¼Œç‰¹åˆ«æ˜¯æ¯å¤©è·‘çš„crontabä»»åŠ¡ï¼Œæˆ–è€…æ˜¯æ¯å‘¨ã€æ¯æœˆè·‘çš„ä»»åŠ¡. å¤šç”¨äº hive è¯­å¥ æˆ– å…¶ä»–è„šæœ¬ç¦»çº¿è¿è¡Œ. æä¾›ä¸€äº› best practice æé«˜å„æ¨¡å—ç»“æ„åŠä»£ç çš„ä¸€è‡´æ€§ é™ä½å¼€å‘æ–°æ¨¡å—çš„æˆæœ¬ ä¾¿äºç¦»çº¿å¤§æ•°æ®åˆ†ææµç¨‹æ§åˆ¶ å…·å¤‡æŠ¥è­¦ï¼Œæ—¥å¿—å®šä½ï¼Œå¸¸ç”¨æ£€æµ‹ä¾èµ–åº“å‡½æ•° ç­‰åŠŸèƒ½ å½“ç„¶å®ƒä¹Ÿé€‚ç”¨äºå¯¹ä»»ä½•ç¦»çº¿Jobè¿›è¡Œè°ƒåº¦ ä¸åŒäººè´Ÿè´£çš„æ¨¡å—ä¸åŒï¼Œæ¨¡å—ç›®å½•ç»“æ„æ˜¯ä¸€æ ·çš„ï¼Œå¦‚ä¸‹æ‰€ç¤º å¼€å‘æ¨¡å—çš„æ—¶å€™ï¼Œæ¯ä¸ªäººåªéœ€è¦ç¼–å†™è‡ªå·±æ¨¡å— script ä¸‹è„šæœ¬ å’Œ å°‘é‡ crontab_job è„šæœ¬çš„æ”¹åŠ¨å³å¯. ç›®å½•ç»“æ„ åŠŸèƒ½ è¯¦ç»†è¯´æ˜ â”€ crontab_job crontab è„šæœ¬ ç”± linux crontab è§¦å‘, æ£€æµ‹æ•´æ¡æµæ°´çº¿ä»»åŠ¡ä¾èµ–å…³ç³», è°ƒç”¨ script ç›®å½•è„šæœ¬ç­‰ â”€ script ä¸»è„šæœ¬ shellã€pythonè„šæœ¬. shell é‡Œä¸»ä¸º hql æˆ– streaming MRã€spark-submit ä»»åŠ¡ç­‰ â”€ conf é…ç½®æ–‡ä»¶ default.confã€vars.confã€alert.conf â”€ log æ—¥å¿—æ–‡ä»¶ ä¸»è„šæœ¬log (å¤šæ¬¡è¿è¡Œå¤šä¸ªlog file)ã€crontab è„šæœ¬log (ä¸€ä¸ªlog file) â”€ flag æ ‡è®°æ–‡ä»¶ (æ ‡å¿—è¯¥æ¨¡å—å·²è¿è¡Œï¼Œæˆ–è¿è¡Œå®Œæ¯•ï¼Œ crontab ä¼šè½®è¯¢æ£€æµ‹) &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; crontab_label.2017-12-13ã€ods_e_coupon/2017-12-13.all.done â”€ util å·¥å…·è„šæœ¬ loggingã€static_functionsã€static_hive_libã€crontab_job_envã€env â”€ alert æŠ¥è­¦å°è£… (å‘é€æŠ¥è­¦é‚®ä»¶çš„å°è£… alertã€send_mail.pyã€constant_mail.py) â”€ create_table å»ºè¡¨è„šæœ¬ å»ºé‡Œ hive table çš„è¯­å¥ â”€ jar jaråŒ… å¦‚ æ—  åˆ™ä¸éœ€è¦å»ºç«‹ â”€ java udfã€udaf å¦‚ æ—  åˆ™ä¸éœ€è¦å»ºç«‹ conf/default.conf #ç³»ç»Ÿç¯å¢ƒå˜é‡export HADOOP=&quot;$&#123;HADOOP_HOME&#125;/bin/hadoop&quot;export HIVE=&quot;$&#123;HIVE_HOME&#125;/bin/hive&quot;export JAVA=&quot;$&#123;JAVA_HOME&#125;/bin/java&quot;#hadoop jarhadoop_jar=&quot;$&#123;HADOOP_HOME&#125;/share/packages/hadoop2/hadoop-streaming-2.7.2.jar&quot;#log_utilscheduler_log_script=&quot;$&#123;util_dir&#125;/logging&quot;#æ§åˆ¶æ—¥å¿—è¿è¡Œæ–¹å¼open_log=true#è¿è¡Œhadoopä»»åŠ¡çš„ç”¨æˆ·åuser=&quot;data_mining&quot;#hiveè¡¨è·¯å¾„ods_hive_dir=&quot;/data_mining/dm/ods/&quot;mds_hive_dir=&quot;/data_mining/dm/mds/&quot;tmp_hive_dir=&quot;/data_mining/dm/tmp/&quot;## OSSOSS_URL=&quot;oss://your-key:your-value@x-bigdata.oss-cn-hangzhou-internal.aliyuncs.com&quot; crontab_job #check crontab_label whether existif check_local_crontab_label $&#123;flag_dir&#125; $&#123;d1&#125; then echo &quot;[INFO] script already run!&quot;else echo &quot;[INFO] check dependention&quot; check_hive_partitions tablename 2018-04-19# check_local_file()# check_hdfs_file()# ... echo &quot;[INFO] script run!&quot;# generate crontab_label touch_local_crontab_label $&#123;flag_dir&#125; $&#123;d1&#125;# run main script echo &quot;[INFO] start run...&quot; sh ods_dm_e_coupon.sh $d1 check_crontab_success $&#123;flag_dir&#125; $&#123;d1&#125; fiecho_ex &quot;run $0 end!&quot; bigdata-offline-demo æ›´å¤šé¡¹ç›®è¯¦æƒ…è¯·ç‚¹å‡»â€¦ 4. çˆ±å®¢ä»•é¢†åˆ¸é¡¹ç›®è¿™æ˜¯ä¸€æ¬¾åŸºäºåœ°ç†ä½ç½®ï¼Œä¸ºåŸå¸‚ç”Ÿæ´»äººç¾¤æä¾›ä¼˜æƒ å¡åˆ¸çš„èšåˆå¹³å°APP. å®æ—¶ä½ç½®åŸºäº6ä¸ªè·ç¦»æ®µçš„åˆ¸åº—å®æ—¶è·ç¦»è®¡ç®—å±•ç¤º. (ç¦»çº¿åœ°æ ‡è®¡ç®—) ä¸€å¼ åˆ¸é€‚ç”¨äºå¤šå®¶åº—å¸¦æ¥çš„æ•°æ®è†¨èƒ€. åœ°æ ‡å…³è”åº—åˆ¸ç­‰å¸¦æ¥æ•°æ®è†¨èƒ€ (åµŒå¥—å¯¹è±¡ç»“æ„) ä¸€å¼ åˆ¸é€‚ç”¨äºå¤šå®¶åº—ï¼Œä¸åŒåº—åˆ†ç±»ä¸åŒï¼Œä¸€å¼ åˆ¸å¤šåˆ†ç±»è§£å†³ (åµŒå¥—å¯¹è±¡ç»“æ„) å¤šåº—åˆä¸€ã€åŒåº—æ¯”ä»·.ï¼ˆä¸¤æ¡çº¿èµ°..æ ‡è®° &amp; ç­–ç•¥ï¼‰ â€¦ lingquan-offline-part æ›´å¤šé¡¹ç›®è¯¦æƒ…è¯·ç‚¹å‡»â€¦ (ä¸ºäº†æ›´å¥½çš„äº’ç›¸äº†è§£ï¼Œè„±æ•åæš‚æ—¶æ”¾ä¸Šgit,ä¼šè¿…é€Ÿç§»é™¤) å¤šåº—åˆä¸€ã€åŒåº—æ¯”ä»· (æ ‡è®°è¿é”å“ç‰Œã€ç­–ç•¥éè¿é”å“ç‰Œ) shop &quot;shop_id&quot;,... &quot;shop_name_show&quot;,...(ç”¨äºå±•ç¤º) &quot;shop_name&quot;: &#123; (ç”¨äºæœç´¢) &quot;type&quot;: &quot;string&quot;, &quot;fields&quot;: &#123; &quot;raw&quot;: &#123; &quot;type&quot;: &quot;string&quot;, &quot;index&quot;: &quot;not_analyzed&quot; &#125; &#125; &#125;, &quot;shop_position&quot;: &#123; &quot;geohash&quot;: True, &quot;geohash_precision&quot;: 7, &quot;type&quot;: &quot;geo_point&quot;, &quot;geohash_prefix&quot;: True &#125;, &quot;coupon_list&quot;: &#123; &quot;type&quot;: &quot;nested&quot;, &quot;properties&quot;: &#123; &quot;unique_coupon_id&quot;: &#123; &quot;index&quot;: &quot;not_analyzed&quot;, &quot;type&quot;: &quot;string&quot; &#125;, &quot;coupon_name&quot;: &#123; &quot;type&quot;: &quot;string&quot;, &quot;fields&quot;: &#123; &quot;raw&quot;: &#123; &quot;type&quot;: &quot;string&quot;, &quot;index&quot;: &quot;not_analyzed&quot; &#125; &#125; &#125;, &quot;coupon_source&quot;: &#123; &quot;type&quot;: &quot;integer&quot; &#125;, &quot;status&quot;: &#123; &quot;type&quot;: &quot;integer&quot; &#125; &#125; &#125;,... shop_business_center , shop_address, shop_open_hours, shop_power_count, level1_code , level2_code , shop_review_count, shop_avg_price, coupon_count, shop_source, status coupon mapping = &#123; index_type_name: &#123; &quot;properties&quot;: &#123; ... &quot;shop_list&quot;: &#123; &quot;type&quot;: &quot;nested&quot;, &quot;properties&quot;: &#123; &quot;unique_shop_id&quot;: &#123;&#x27;index&#x27;: &#x27;not_analyzed&#x27;, &quot;type&quot;: &quot;string&quot;&#125;, &quot;shop_address&quot;: &#123;&quot;type&quot;: &quot;string&quot;&#125;, &quot;shop_position&quot;: &#123; &quot;geohash&quot;: True, &quot;geohash_precision&quot;: 7, &quot;type&quot;: &quot;geo_point&quot;, &quot;geohash_prefix&quot;: True &#125; &#125; &#125;...... coupon_id , coupon_name_show, coupon_name, coupon_store, coupon_condition , coupon_source, coupon_desc, coupon_type, coupon_sold, shop_count, level1_code_list, â€¦ business center business center amap name address geo æ¹–æ»¨é“¶æ³° æ­å·æ¹–æ»¨é“¶æ³°in77AåŒº æ­å·å¸‚ä¸ŠåŸåŒºä¸œå¡è·¯7å· æ­å·æ¥ç¦å£« æ­å·æ¥ç¦å£« æ­å·å¸‚æ±Ÿå¹²åŒºé’±æ±Ÿæ–°åŸå¯Œæ˜¥è·¯ä¸æ–°ä¸šè·¯äº¤æ±‡å¤„å¾€åŒ—200ç±³ å˜‰é‡Œä¸­å¿ƒ æ­å·å˜‰é‡Œä¸­å¿ƒ æ­å·å¸‚ä¸‹åŸåŒºå»¶å®‰è·¯353å· â€¦ â€¦ â€¦ landmarkã€landmark_shop_couponã€shoppingã€â€¦ 5. é¢†åˆ¸/æ¨èç³»ç»ŸåŸºäºç”¨æˆ·åœ¨APPä¸Šäº§ç”Ÿçš„è¡Œä¸ºä¿¡æ¯ï¼ŒåŸºäºè¿‡å»6ä¸ªæœˆçš„è¡Œä¸ºè®°å½•(ç‚¹å‡»ã€ä¸‹å•ã€æ”¯ä»˜ã€åˆ†äº«)ï¼Œå¹¶ç»“åˆæ—¶é—´è¡°å‡æ„é€ ç”¨æˆ·çš„è¡Œä¸ºè¯„åˆ†çŸ©é˜µï¼Œ è¿›è€ŒæŒ–æ˜å‡ºç”¨æˆ·çš„åå¥½ï¼Œç»è¿‡ä¸€äº›ç­–ç•¥èåˆä¸å€™é€‰é›†é‡æ’åºï¼Œä¸ºç”¨æˆ·æä¾›å…¶å¯èƒ½ æ„Ÿå…´è¶£çš„å•†æˆ·å¡åˆ¸æ¨èåˆ—è¡¨ã€‚ é‡‡ç”¨åŸºäºéšå› å­æ¨¡å‹ FunkSVD çš„CFï¼Œä¸­é—´æƒé‡å€¼é‡‡ç”¨é¢‘æ¬¡ é™åˆ¶å¤„ç†åï¼Œéç”¨æˆ·å…´è¶£å†…å•†æˆ·æƒé‡è°ƒæ•´ï¼Œèåˆæœ€è¿‘å•†åœˆæˆ–è€…æ˜æ˜¾åœ°æ ‡çš„ çƒ­é”€åˆ¸. å¯¹äºæ–°ç”¨æˆ·é‡‡ç”¨å•†åœˆå†…çƒ­é”€åˆ¸å’ŒåŸå¸‚å†…çƒ­é”€åˆ¸è¿›è¡Œè¡¥å……. åå¯å†èåˆè´Ÿåé¦ˆçš„æ•°æ®ä¸ç”¨æˆ·åŒºåŸŸè¡Œä¸ºç­‰è¿½è¸ªï¼Œæœç´¢æ•°æ®ç­‰,é‡‡ç”¨å…¶ä»–æ¨¡å‹æ–¹æ³•ç­‰å°è¯•åšæ›´ä¸°å¯Œçš„ä¸ªæ€§åŒ–æ¨è â€¦ next.. Machine Learning Notes Python &amp; Hive &amp; Spark.. SpringMVC demo &amp; Csdn Java åˆ†ç±»ï¼Œæ—§ç‰ˆå­¦ç¬”è®°"},{"title":"åšæ–‡çš„èµåŠ©æ–¹å¼","date":"2017-11-05T12:05:21.000Z","updated":"2020-02-15T03:18:48.013Z","comments":true,"path":"support/index.html","permalink":"http://iequa.com/support/index.html","excerpt":"ä½ çš„ä¸€ç‚¹æ¿€åŠ±ï¼Œå¯ä»¥é¼“åŠ±ä½œè€…å†™å‡ºæ›´å¤šçš„å¥½æ–‡ç« ï¼Œè®©æ›´å¤šçš„äººå–œæ¬¢ï¼Œä»ä¸­å—ç›Šï¼Œæ„å»ºä¸€ä¸ªè‰¯æ€§çš„å¾ªç¯.","text":"ä½ çš„ä¸€ç‚¹æ¿€åŠ±ï¼Œå¯ä»¥é¼“åŠ±ä½œè€…å†™å‡ºæ›´å¤šçš„å¥½æ–‡ç« ï¼Œè®©æ›´å¤šçš„äººå–œæ¬¢ï¼Œä»ä¸­å—ç›Šï¼Œæ„å»ºä¸€ä¸ªè‰¯æ€§çš„å¾ªç¯. ä½ å¯ä»¥ä½¿ç”¨ä»¥ä¸‹æ–¹å¼ä»˜æ¬¾ï¼š æ”¯ä»˜å®ï¼š å¾®ä¿¡ï¼šç”±äºå¾®ä¿¡ä»˜æ¬¾ç»å¸¸å‡ºé—®é¢˜ï¼Œæš‚æ—¶åœæ­¢ä½¿ç”¨ã€‚ PayPal: è¯·ç‚¹å‡»ä»˜æ¬¾é“¾æ¥"},{"title":"","date":"2021-06-13T15:38:14.046Z","updated":"2021-06-13T15:38:14.038Z","comments":true,"path":"sina_project/pro4_index.html","permalink":"http://iequa.com/sina_project/pro4_index.html","excerpt":"","text":"4. é¢†åˆ¸é¡¹ç›®è¿™æ˜¯ä¸€æ¬¾åŸºäºåœ°ç†ä½ç½®ï¼Œä¸ºåŸå¸‚ç”Ÿæ´»äººç¾¤æä¾›ä¼˜æƒ å¡åˆ¸çš„èšåˆå¹³å°APP. å®æ—¶ä½ç½®åŸºäº6ä¸ªè·ç¦»æ®µçš„åˆ¸åº—å®æ—¶è·ç¦»è®¡ç®—å±•ç¤º. (ç¦»çº¿åœ°æ ‡è®¡ç®—) ä¸€å¼ åˆ¸é€‚ç”¨äºå¤šå®¶åº—å¸¦æ¥çš„æ•°æ®è†¨èƒ€. åœ°æ ‡å…³è”åº—åˆ¸ç­‰å¸¦æ¥æ•°æ®è†¨èƒ€ (åµŒå¥—å¯¹è±¡ç»“æ„) ä¸€å¼ åˆ¸é€‚ç”¨äºå¤šå®¶åº—ï¼Œä¸åŒåº—åˆ†ç±»ä¸åŒï¼Œä¸€å¼ åˆ¸å¤šåˆ†ç±»è§£å†³ (åµŒå¥—å¯¹è±¡ç»“æ„) å¤šåº—åˆä¸€ã€åŒåº—æ¯”ä»·.ï¼ˆä¸¤æ¡çº¿èµ°..æ ‡è®° &amp; ç­–ç•¥ï¼‰ â€¦ lingquan-offline-part æ›´å¤šé¡¹ç›®è¯¦æƒ…è¯·ç‚¹å‡»â€¦ (ä¸ºäº†æ›´å¥½çš„äº’ç›¸äº†è§£ï¼Œè„±æ•åæš‚æ—¶æ”¾ä¸Šgit,ä¼šè¿…é€Ÿç§»é™¤) å¤šåº—åˆä¸€ã€åŒåº—æ¯”ä»· (æ ‡è®°è¿é”å“ç‰Œã€ç­–ç•¥éè¿é”å“ç‰Œ) shop &#123; &quot;shop_id&quot;, &quot;shop_name_show&quot;, &quot;shop_name&quot; &#123; &quot;type&quot; &quot;string&quot;, &quot;fields&quot; &#123; &quot;raw&quot; &#123; &quot;type&quot; &quot;string&quot;, &quot;index&quot; &quot;not_analyzed&quot; &#125; &#125; &#125;, &quot;shop_position&quot; &#123; &quot;geohash&quot; True, &quot;geohash_precision&quot; 7, &quot;type&quot; &quot;geo_point&quot;, &quot;geohash_prefix&quot; True &#125;, &quot;coupon_list&quot; &#123; &quot;type&quot; &quot;nested&quot;, &quot;properties&quot; &#123; &quot;unique_coupon_id&quot; &#123; &quot;index&quot; &quot;not_analyzed&quot;, &quot;type&quot; &quot;string&quot; &#125;, &quot;coupon_name&quot; &#123; &quot;type&quot; &quot;string&quot;, &quot;fields&quot; &#123; &quot;raw&quot; &#123; &quot;type&quot; &quot;string&quot;, &quot;index&quot; &quot;not_analyzed&quot; &#125; &#125; &#125;, &quot;coupon_source&quot; &#123; &quot;type&quot; &quot;integer&quot; &#125;, &quot;status&quot; &#123; &quot;type&quot; &quot;integer&quot; &#125; &#125; &#125;&#125; shop_business_center , shop_address, shop_open_hours, shop_power_count, level1_code , level2_code , shop_review_count, shop_avg_price, coupon_count, shop_source, status coupon mapping = &#123; index_type_name &#123; &quot;properties&quot; &#123; ... &quot;shop_list&quot; &#123; &quot;type&quot; &quot;nested&quot;, &quot;properties&quot; &#123; &quot;unique_shop_id&quot; &#123;&#x27;index&#x27; &#x27;not_analyzed&#x27;, &quot;type&quot; &quot;string&quot;&#125;, &quot;shop_address&quot; &#123;&quot;type&quot; &quot;string&quot;&#125;, &quot;shop_position&quot; &#123; &quot;geohash&quot; True, &quot;geohash_precision&quot; 7, &quot;type&quot; &quot;geo_point&quot;, &quot;geohash_prefix&quot; True &#125; &#125; &#125;...... coupon_id , coupon_name_show, coupon_name, coupon_store, coupon_condition , coupon_source, coupon_desc, coupon_type, coupon_sold, shop_count, level1_code_list, â€¦ business center business center amap name address geo æ¹–æ»¨é“¶æ³° æ­å·æ¹–æ»¨é“¶æ³°in77AåŒº æ­å·å¸‚ä¸ŠåŸåŒºä¸œå¡è·¯7å· æ­å·æ¥ç¦å£« æ­å·æ¥ç¦å£« æ­å·å¸‚æ±Ÿå¹²åŒºé’±æ±Ÿæ–°åŸå¯Œæ˜¥è·¯ä¸æ–°ä¸šè·¯äº¤æ±‡å¤„å¾€åŒ—200ç±³ å˜‰é‡Œä¸­å¿ƒ æ­å·å˜‰é‡Œä¸­å¿ƒ æ­å·å¸‚ä¸‹åŸåŒºå»¶å®‰è·¯353å· â€¦ â€¦ â€¦ landmarkã€landmark_shop_couponã€shoppingã€â€¦ next.. Machine Learning Notes Python &amp; Hive &amp; Spark.. SpringMVC demo &amp; Csdn Java åˆ†ç±»ï¼Œæ—§ç‰ˆå­¦ç¬”è®°"},{"title":"Tagsâ˜ï¸","date":"2021-06-15T23:31:43.554Z","updated":"2021-06-15T23:31:43.554Z","comments":false,"path":"tags/index.html","permalink":"http://iequa.com/tags/index.html","excerpt":"","text":""},{"title":"","date":"2018-07-16T08:59:48.000Z","updated":"2019-10-20T04:30:35.176Z","comments":true,"path":"tensorflow/index.html","permalink":"http://iequa.com/tensorflow/index.html","excerpt":"","text":"TensorFlow ç”¨äºæœºå™¨å­¦ä¹ å’Œç¥ç»ç½‘ç»œæ–¹é¢çš„ç ”ç©¶ï¼Œé‡‡ç”¨æ•°æ®æµå›¾æ¥è¿›è¡Œæ•°å€¼è®¡ç®—çš„å¼€æºè½¯ä»¶åº“. Keras å¼€å‘é‡ç‚¹æ˜¯æ”¯æŒå¿«é€Ÿçš„å®éªŒã€‚èƒ½å¤Ÿä»¥æœ€å°çš„æ—¶å»¶æŠŠä½ çš„æƒ³æ³•è½¬æ¢ä¸ºå®éªŒç»“æœï¼Œæ˜¯åšå¥½ç ”ç©¶çš„å…³é”®ã€‚ 1. TensorFlow ç®€ä»‹ 1.1 TensorFlow Why ? 1.2 TensorFlow å¿«é€Ÿå­¦ä¹  &amp; æ–‡æ¡£ 2. Tensorflow åŸºç¡€æ„æ¶ 2.1 å¤„ç†ç»“æ„: è®¡ç®—å›¾ 2.2 å®Œæ•´æ­¥éª¤ ä¾‹å­2 ğŸŒ°ï¼ˆåˆ›å»ºæ•°æ®ã€æ­å»ºæ¨¡å‹ã€è®¡ç®—è¯¯å·®ã€ä¼ æ’­è¯¯å·®ã€è®­ç»ƒï¼‰ 2.3 Session ä¼šè¯æ§åˆ¶ 2.4 Variable å˜é‡ 2.5 Placeholder ä¼ å…¥å€¼ 2.6 ä»€ä¹ˆæ˜¯æ¿€åŠ±å‡½æ•° (Activation Function) 2.7 æ¿€åŠ±å‡½æ•° Activation Function 2.8 TensorFlow åŸºæœ¬ç”¨æ³•æ€»ç»“ ğŸŒ°ğŸŒ°ğŸŒ° 3. å»ºé€ æˆ‘ä»¬ç¬¬ä¸€ä¸ªç¥ç»ç½‘ç»œ 3.1 æ·»åŠ å±‚ def add_layer() 3.2 å»ºé€ ç¥ç»ç½‘ç»œ ğŸŒ°ğŸŒ°ğŸŒ° 3.3 Speed Up Training &amp; Optimizer (è½¬è½½è‡ªè«çƒ¦) 4. Tensorboard 4.1 Tensorboard å¯è§†åŒ–å¥½å¸®æ‰‹ 1 5. Estimator 5.1 tf.contrib.learn å¿«é€Ÿå…¥é—¨ 5.2 tf.contrib.learn æ„å»ºè¾“å…¥å‡½æ•° 5.3 tf.contrib.learn åŸºç¡€çš„è®°å½•å’Œç›‘æ§æ•™ç¨‹ 5.4 tf.contrib.learn åˆ›å»º Estimator 5.5 TF ä¿å­˜å’ŒåŠ è½½æ¨¡å‹ - ç®€ä¹¦ 1. Language model ä»‹ç»è¯­è¨€æ¨¡å‹æ˜¯è‡ªç„¶è¯­è¨€å¤„ç†é—®é¢˜ä¸­ä¸€ç±»æœ€åŸºæœ¬çš„é—®é¢˜ï¼Œå®ƒæœ‰ç€éå¸¸å¹¿æ³›çš„åº”ç”¨ã€‚ 1.1 RNN å¾ªç¯ç¥ç»ç½‘ç»œ ç®€ä»‹ 1.2 LSTM &amp; Bi-RNN &amp; Deep RNN 1.3 Language model ä»‹ç» / è¯„ä»·æ–¹æ³• perplexity (not finish) 2. NNLM (ç¥ç»è¯­è¨€æ¨¡å‹) 2.2 PTB æ•°æ®çš„ batching æ–¹æ³• 2.3 RNN çš„è¯­è¨€æ¨¡å‹ TensorFlow å®ç° 3. MNIST æ•°å­—è¯†åˆ«é—®é¢˜ 3.1 ç®€å•å‰é¦ˆç½‘ç»œå®ç° mnist åˆ†ç±» 3.2 å¤šå±‚ CNNs å®ç° mnist åˆ†ç±», not finish 3.3 name / variable_scope 3.4 å¤šå±‚ LSTM é€šä¿—æ˜“æ‡‚ç‰ˆ PythonPython å“²å­¦å°±æ˜¯ç®€å•ä¼˜é›…ï¼Œå°½é‡å†™å®¹æ˜“çœ‹æ˜ç™½çš„ä»£ç ï¼Œå°½é‡å†™å°‘çš„ä»£ç . Python æ•°æ®åˆ†ææ¨¡å—: Numpy &amp; Pandas, åŠå¼ºå¤§çš„ç”»å›¾å·¥å…· Matplotlib Python Numpy &amp; Pandas Matplotlib Scikit-LearnSklearn æœºå™¨å­¦ä¹ é¢†åŸŸå½“ä¸­æœ€çŸ¥åçš„ Python æ¨¡å—ä¹‹ä¸€ why 1.1 : Sklearn Choosing The Right Estimator 1.2 : Sklearn General Learning Model 1.3 : Sklearn DataSets 1.4 : Sklearn Common Attributes and Functions 1.5 : Normalization 1.6 : Cross-validation 1 1.7 : Cross-validation 2 1.8 : Cross-validation 3 1.9 : Sklearn Save Model"},{"title":"","date":"2016-07-16T08:59:48.000Z","updated":"2020-12-22T10:31:13.324Z","comments":true,"path":"tweet/index.html","permalink":"http://iequa.com/tweet/index.html","excerpt":"","text":"TweetBlair Chan Is Inputting 2017.05.28 Shuping Yangâ€™s University of Maryland speech 2017.05.20 I and my sister at Qianjiang New Townâ€™s Light Show. 2016.09.04 The people live and work in peace and contentment, treat each other with sincerity. 2016.07.08 ä»ä»€ä¹ˆæ—¶å€™å¼€å§‹ï¼Œè“å¤©â˜ç™½äº‘å·²ç»æ˜¯ä¸€ç§éå¸¸å¥¢ä¾ˆçš„äº«å— ï¼Ÿ"},{"title":"ç”¨æˆ·å†…å®¹å…´è¶£æŒ–æ˜æ–‡æ¡£","date":"2018-03-05T08:46:48.000Z","updated":"2019-10-20T04:33:53.409Z","comments":true,"path":"user_profile_content_interest/index.html","permalink":"http://iequa.com/user_profile_content_interest/index.html","excerpt":"","text":"MathJax.Hub.Config({ extensions: [\"tex2jax.js\"], jax: [\"input/TeX\"], tex2jax: { inlineMath: [ ['$','$'], ['\\\\(','\\\\)'] ], displayMath: [ ['$$','$$']], processEscapes: true } }); 1. éœ€æ±‚ç”¨æˆ·å…´è¶£æŒ–æ˜ç³»ç»Ÿï¼ŒåŸºäºç”¨æˆ·åœ¨æ–°æµªç½‘åŠåšå®¢ä¸Šçš„è®¿é—®å†å²ï¼Œé€šè¿‡å¯¹æ—¥å¿—åŠç½‘é¡µçš„åˆ†æï¼Œæ¨æµ‹å¹¶è®°å½•ç”¨æˆ·çš„å…´è¶£ã€‚ 1.1 ç³»ç»Ÿæµç¨‹å›¾ 2. æ•°æ®æº &amp; è§„èŒƒåŒ–2.1 æ•°æ®æºæ•°æ®æº æ¥è‡ª ä¸Šæ¸¸ ä¿¡æ¯ç³»ç»Ÿéƒ¨æä¾›çš„ suda log hiveè¡¨ï¼Œåˆ†åˆ«è®°å½•äº†æ–°æµªç½‘çš„ç½‘é¡µä¿¡æ¯ï¼Œblog ç­‰åšå®¢ä¿¡æ¯. 2.2 è§„èŒƒåŒ–è§„èŒƒåŒ–ä¸€äº›åƒåœ¾ç½‘é¡µï¼Œæ›å…‰åº¦ä½äºé‡ å’Œ å»æ‰ä¸€äº›æ­£æ–‡é•¿åº¦å°äº 200 å­—çš„ç½‘é¡µâ€¦ 3. ç‰¹å¾è®¡ç®—One : å¯¹äºæ¯ä¸ªè¦æ¨èçš„å†…å®¹,æˆ‘ä»¬éœ€è¦å»ºç«‹ä¸€ä»½èµ„æ–™ : æ¯”å¦‚è¯ $k_i$ åœ¨æ–‡æ¡£ $d_j$ ä¸­çš„æƒé‡ $w_{ij}$ (å¸¸ç”¨çš„æ–¹æ³•æ¯”å¦‚ TF-IDF) æœ‰ä¸€ä¸ªè¯è¡¨ Item [$w_1$, $w_2$, â€¦ ,$w_{4000}$], å¯¹æ¯ä¸ª document å»ºç«‹ä¸€ä¸ªè¯è¡¨ vectorã€‚ Two : éœ€è¦å¯¹ç”¨æˆ·ä¹Ÿå»ºç«‹ä¸€ä»½èµ„æ–™ : æ¯”å¦‚è¯´å®šä¹‰ä¸€ä¸ªæƒé‡å‘é‡ ($w_{c1},â€¦,w_{ck}$) , å…¶ä¸­ $w_{ci}$ è¡¨ç¤ºç¬¬ $k_i$ ä¸ªè¯å¯¹ç”¨æˆ· $c$ çš„é‡è¦åº¦user ä¹‹å‰æœ‰çœ‹è¿‡çš„ å°è¯´ æˆ– æ–‡æ¡£ã€‚(çœ‹è¿‡çš„æ–‡æ¡£æ”¾åœ¨ä¸€èµ·æä¸€ä¸ªdoc_vectorï¼Œæˆ–è€… å°† doc_vector åŠ æƒå¹³å‡) Three : è®¡ç®—åŒ¹é…åº¦ ä½™å¼¦è·ç¦»å…¬å¼ u(c, s) = \\cos(\\vec{w\\_c}, \\vec{w\\_s}) = \\frac{\\vec{w_c} \\cdot \\vec{w\\_s}}{\\vec{||w\\_c||} \\times \\vec{||w\\_s||}} æ€»ç»“ä¸‰æ­¥ : å¯¹ æ¯ä¸ª document å»ºç«‹ vector å¯¹ æ¯ä¸ª user å»ºç«‹ vector æ¯”å¯¹ user å‘é‡ï¼Œä¸ è¯¥user æ²¡æœ‰çœ‹è¿‡çš„ document å‘é‡ ä¹‹é—´çš„ç›¸ä¼¼åº¦ TF-IDF : è¯„ä¼°ä¸€ä¸ª word å¯¹å½“å‰ document çš„é‡è¦æ€§ã€‚ å½“å‰å‡é«˜è€Œå‡é«˜ï¼Œæ‰€æœ‰docä¸­ï¼Œå‡é«˜è€Œä¸‹é™ã€‚ 4. ç­–ç•¥å±‚4.1 page åˆ†ç±»å†…å®¹å…´è¶£äºŒçº§åˆ†ç±»ï¼Œå¤§éƒ¨åˆ†ç±»å¯ä»¥æ”¯æŒåˆ°äºŒçº§åˆ†ç±»ï¼Œè¿”å›äºŒçº§ç±»ç›®çš„idï¼›éƒ¨åˆ†ç±»ï¼šè¯»ä¹¦ã€æ¸¸æˆç­‰ï¼Œåªæ”¯æŒåˆ°ä¸€çº§åˆ†ç±»ï¼Œè¿”å›ä¸€çº§ç±»ç›®çš„idã€‚ ç±»åˆ«æƒé‡ç”¨æ¨¡å‹é¢„æµ‹æ—¶è¿”å›çš„åˆ†æ•°è¡¨ç¤ºï¼Œä¸åšåŠ å’Œä¸º1çš„å½’ä¸€åŒ–å¤„ç†ã€‚ 4.2 ç”¨æˆ·å…´è¶£è®¡ç®—å‡è®¾ç”¨æˆ· $u$ æŸä¸€å¤©è®¿é—®çš„é¡µé¢é›†åˆ $D = \\lbrace d_i \\rbrace, i = 1..m$ , é¡µé¢ $d_i$ çš„ç±»åˆ«æ¦‚ç‡åˆ†å¸ƒæ˜¯ $P_i = \\lbrace p_{ij} \\rbrace, j = 1..k$ 4.3 å…´è¶£åˆå¹¶çŸ­æœŸå…´è¶£å‡è®¾ç”¨æˆ·çš„å†å²å…´è¶£é›†åˆä¸º $\\lbrace (c_i, t_i) \\rbrace, i = 1\\ to\\ m$ $m$ æ˜¯å…´è¶£æ€»æ•°ï¼Œ$c_i$ æ˜¯ç¬¬$i$ä¸ªå…´è¶£ï¼Œ$t_i$ æ˜¯ç¬¬$i$ä¸ªå…´è¶£çš„ç”Ÿæˆæ—¶é—´ï¼Œç”¨è·ç¦»ä»Šå¤©çš„å¤©æ•°è¡¨ç¤ºã€‚ å¯¹ $c_i$ æŒ‰ç…§æ—¶é—´è¡°å‡ï¼š${c_i}^{â€˜} = c_i * a^{t_{i}}$ï¼Œ$a$ æ˜¯è¡°å‡å› å­ï¼Œå–å€¼ 0.8ã€‚ æœ€åï¼Œå¯¹å…´è¶£æ•°ç›®è¿›è¡Œæ§åˆ¶ï¼Œæœ€å¤šåªä¿ç•™ 10 ç§å…´è¶£ã€‚ é•¿æœŸå…´è¶£é•¿æœŸå…´è¶£æŒ‡ç”¨æˆ·åœ¨è¾ƒé•¿ä¸€æ®µæ—¶é—´(è‡³å°‘3ä¸ªæœˆ)å†…è¡¨ç°å‡ºçš„å…´è¶£å€¾å‘ã€‚ ç­–ç•¥å¦‚ä¸‹ï¼š æ¯å‘¨è¿›è¡Œä¸€æ¬¡ç”¨æˆ·å…´è¶£çš„åˆå¹¶ã€‚ å¯¹äºæœ€è¿‘3ä¸ªæœˆçš„ç”¨æˆ·å…´è¶£è®°å½•ï¼Œç»Ÿè®¡å¦‚ä¸‹ä¸¤ä¸ªæŒ‡æ ‡: å…´è¶£çš„å‘¨å‡ºç°æ¯”ä¾‹ è®¡ç®—å…¬å¼ï¼šoccur_ratio = å‡ºç°çš„å‘¨æ•° / æ€»å‘¨æ•°å¦‚æœ occur_ratio å°äºé˜ˆå€¼ï¼Œåˆ™è®¤ä¸ºè¯¥å…´è¶£éé•¿æœŸå…´è¶£ï¼Œè¿‡æ»¤æ‰ã€‚é˜ˆå€¼æ ¹æ®ç»éªŒè®¾å®šï¼Œé»˜è®¤è®¾ç½®ä¸º0.5ã€‚ å…´è¶£çš„å‡ºç°é—´éš”æ–¹å·® æˆ‘ä»¬è®¤ä¸ºé•¿æœŸå…´è¶£å‡ºç°æ˜¯å‘ˆç°å‘¨æœŸæ€§çš„ï¼Œç”¨é—´éš”æ–¹å·®è¡¨ç¤ºã€‚è®¡ç®—æ–¹æ³•ï¼šæ ¹æ®å…´è¶£çš„å‘¨å‡ºç°åºåˆ—ï¼Œå¾—åˆ°ç›¸é‚»ä¸¤æ¬¡å‡ºç°çš„é—´éš”åºåˆ—ï¼Œç„¶åè®¡ç®—è¯¥åºåˆ—çš„æ–¹å·®ã€‚ä¸¾ä¾‹ï¼šå‡è®¾å…´è¶£åœ¨ç¬¬1ã€3ã€5ã€8ã€9ã€12å‘¨å‡ºç°ï¼Œè®¡ç®—å‡ºçš„é—´éš”åºåˆ—æ˜¯ï¼š[2, 2, 3, 1, 3]ï¼Œæ–¹å·®æ˜¯0.56ã€‚ å¦‚æœé—´éš”æ–¹å·®å¤§äºé˜ˆå€¼ï¼Œè®¤ä¸ºå…´è¶£å±äºä¸´æ—¶å…´è¶£ï¼Œéé•¿æœŸå…´è¶£ã€‚ ç”±äºcookieå®¹æ˜“è¢«ç”¨æˆ·æ¸…ç†æ‰ï¼Œç”Ÿå‘½å‘¨æœŸè¾ƒçŸ­ï¼Œæˆ‘ä»¬é‡‡ç”¨è·¨å±æ‰“é€šæä¾›çš„æ–°æµªç»Ÿä¸€idå¯¹ç”¨æˆ·çš„é•¿æœŸè¡Œä¸ºè¿›è¡Œè·Ÿè¸ªã€‚ å…´è¶£å½’ä¸€åŒ–å¯¹åˆ†æ•°è¿›è¡ŒåŠ å’Œ å’Œ å½’ä¸€åŒ–ï¼Œ å¾—åˆ°ç”¨æˆ·çš„å…´è¶£ç±»åˆ«æ¦‚ç‡: p(u, c) = \\frac {score(u, c)} {\\sum_{i=1}^k score(u, i)}4. æŠ€æœ¯ç‚¹ page è¯å‘é‡ 3 ç§ç‰¹å¾å¤„ç†æ–¹å¼ log è®¿é—®æ¬¡æ•° + 1 çš„å¹³æ»‘å¤„ç† LR (æ ·æœ¬ä¸å¹³) &amp; Random Forest (æ ·æœ¬æ•°é€‰æ‹©ã€å†³ç­–æ ‘ä¸ªæ•°ã€ç‰¹å¾é€‰æ‹©ã€å‚æ•°è®­ç»ƒ) æ—¶é—´è¡°å‡ &amp; é—´éš”æ–¹å·®åˆ¤æ–­é•¿æœŸå…´è¶£ next â‹¯â‹¯ notesï¼šnext â€¦"},{"title":"ç”¨æˆ·ç”»åƒå¤§æ ‡ç­¾ä½“ç³»ç»“æ„","date":"2018-03-05T06:01:48.000Z","updated":"2019-10-20T04:33:53.410Z","comments":true,"path":"user_profile_label_system/index.html","permalink":"http://iequa.com/user_profile_label_system/index.html","excerpt":"","text":"æˆ‘ä»¬å®šä¹‰çš„å¤§æ ‡ç­¾ä½“ç³»ç»“æ„,é¦–å…ˆæ˜¯ä¸€æ£µå¤§çš„æœ‰ä¸€ä¸ªè™šæ‹Ÿæ ¹èŠ‚ç‚¹çš„æ ‘ç»“æ„,èƒ½å¤Ÿæ— é™æ‰©å±• æ–°çš„åˆ†ç±»ä½“ç³»ã€‚ä¸åŒçš„åˆ†ç±»ä½“ç³»ä¹‹é—´,ä¹Ÿå¯èƒ½å­˜åœ¨ä¸€å®šçš„å…³ç³»,å¯ä»¥é€šè¿‡å…³ç³»è‡ªåŠ¨æŒ–æ˜ç®—æ³•, å»ºç«‹å„ä¸ªæ ‡ç­¾èŠ‚ç‚¹ä¹‹é—´çš„å…³è”å…³ç³»,å¹¶èµ‹äºˆä¸€å®šçš„æƒé‡è¡¨ç¤ºå…³ç³»å¼ºå¼±ç¨‹åº¦ã€‚è¿™ç§å…³è”å…³ç³»å¯ä»¥å¸®åŠ©æˆ‘ä»¬å®ç°ä¸åŒæ ‡ç­¾ä½“ç³»çš„è‡ªåŠ¨æ˜ å°„,åœ¨å®é™…åº”ç”¨ä¸­ä¼šéå¸¸æœ‰ç”¨ã€‚å¤§æ ‡ç­¾ä½“ç³»æ„å»ºä¸€ä¸ªæ•°æ®æ ‡ç­¾ä½“ç³»,è®¾è®¡ç›®æ ‡å¦‚ä¸‹: æ”¯æŒå¤šç»´åº¦æ ‡ç­¾ä½“ç³»ã€‚ å¯æ‰©å±•ã€‚å·²æœ‰çš„åˆ†ç±»ä½“ç³»å¯ä»¥æ·»åŠ ã€åˆ é™¤ã€ä¿®æ”¹,ä¹Ÿå¯ä»¥åŠ å…¥æ–°çš„åˆ†ç±»ä½“ç³»ã€‚ æ ‡ç­¾è¯­ä¹‰åŠå…³ç³»æ”¯æŒã€‚ä¸ºæ ‡ç­¾èµ‹äºˆè¯­ä¹‰ä¿¡æ¯,å»ºç«‹æ ‡ç­¾çš„å…³ç³»å›¾ã€‚ æ ‡ç­¾ç»“æ„è®¾è®¡ å¦‚ä¸‹ : æ ‡ç­¾å±æ€§ æ ‡ç­¾å±æ€§ å«ä¹‰ ID æ¯ä¸ªæ ‡ç­¾æœ‰å…¨å±€å”¯ä¸€çš„ IDã€‚ name åç§°,åŸåˆ™ä¸Šä¸è¦æ±‚å…¨å±€å”¯ä¸€,ä½†è¦èƒ½æ¯”è¾ƒå‡†ç¡®çš„æè¿°è¯¥æ ‡ç­¾æ‰€æŒ‡å†…å®¹ã€‚ level å±‚çº§,æ ‡ç­¾æ‰€å±å±‚çº§ã€‚æ ‡ç­¾ä½“ç³»å¯ä»¥çœ‹åšä¸€ä¸ªæ ‘ç»“æ„,æœ‰ä¸ªè™šæ‹Ÿçš„æ ¹èŠ‚ç‚¹,å±‚çº§æ˜¯ä»è™šæ ¹èŠ‚ç‚¹åˆ°æ ‡ç­¾èŠ‚ç‚¹çš„è·ç¦»ã€‚æ‰€æœ‰ä¸€çº§åˆ†ç±»çš„ level æ˜¯ 1ã€‚ parent ID:çˆ¶äº²èŠ‚ç‚¹ ID,æ¯ä¸ªèŠ‚ç‚¹æœ‰ä¸€ä¸ªå”¯ä¸€çš„çˆ¶èŠ‚ç‚¹,ä»¥æ­¤å¯ä»¥è¿˜åŸå‡ºæ•´æ£µæ ‘ç»“æ„ã€‚ type:æ ‡ç­¾ç±»å‹,å¯¹æ ‡ç­¾ç»´åº¦çš„æè¿°,æ¯ä¸€ç±»æ ‡ç­¾æœ‰ä¸€ä¸ªå…¨å±€å”¯ä¸€çš„ type æ ‡è¯†ã€‚ä¾‹å¦‚, type age/gender/interest/crowd/area/education/product ç­‰ã€‚ concept æ ‡ç­¾æè¿°çš„æ¦‚å¿µç±»å‹,é¢„ç•™ã€‚ description å¯¹æ ‡ç­¾çš„è‡ªç„¶è¯­è¨€æè¿°ä¿¡æ¯ã€‚ version ç‰ˆæœ¬,ç”¨äºè·Ÿè¸ªæ ‡ç­¾çš„è¿›åŒ–çŠ¶æ€ã€‚åˆå§‹æ˜¯ 1.0ï¼ŒæŒç»­é€’å¢ã€‚ creator æ ‡ç­¾åˆ›å»ºè€…,é»˜è®¤æ˜¯æ‰€å±å…¬å¸å (å¦‚ : x)ã€‚å¦‚æœæ ‡ç­¾æ¥è‡ªç¬¬ä¸‰æ–¹å…¬å¸,å¯ä»¥ç”¨è¯¥å…¬å¸å…¬å¸åç§°ä»£æ›¿ã€‚ create_ts åˆ›å»ºæ—¶é—´,linux æ—¶é—´æˆ³ã€‚(å¾…å®šé¢„ç•™) æ ‡ç­¾å…³ç³» è¯´æ˜ æ ‡ç­¾å…³ç³» example ä¸¤ä¸ªæ ‡ç­¾ä¹‹é—´å¯èƒ½å­˜åœ¨ä¸€å®šçš„è¯­ä¹‰å…³ç³»ã€‚å¦‚â€œçˆ±å¥½å¥¢ä¾ˆå“â€è·Ÿâ€œæ¶ˆè´¹èƒ½åŠ›â€å¯èƒ½å­˜åœ¨æŸç§å¼ºç›¸å…³,è€Œè¿™ä¸¤ä¸ªæ ‡ç­¾å±äºä¸¤ä¸ªä¸åŒçš„ç±»å‹ã€‚é€šè¿‡å…³ç³»,å¯ä»¥å®ç°è·¨æ ‡ç­¾ç±»å‹çš„æ‰©å±•å’ŒæŒ–æ˜ã€‚ å…³ç³»å®šä¹‰æ˜¯ä¸€ä¸ªå››å…ƒç»„ã€‚ ID1, ID2 : å‘ç”Ÿå…³ç³»çš„ä¸¤ä¸ªæ ‡ç­¾èŠ‚ç‚¹çš„ ID ã€‚ weight:æƒé‡, æƒé‡è¶Šå¤§,è¡¨ç¤ºå…³ç³»è¶Šå¼ºã€‚ type:å…³ç³»ç±»å‹,é¢„ç•™ã€‚ æ ‡ç­¾è¯¦ç»†è¯´æ˜age æ ‡ç­¾ å«ä¹‰ 600 - 601 0-20 å² 602 21-25 å² 603 26-30 å² 604 31-35 å² 605 36-40 å² 606 40-99 å² gender æ ‡ç­¾ å«ä¹‰ 500 - 501 ç”· 502 å¥³ crowd æ ‡ç­¾ å«ä¹‰ 901 éƒ½å¸‚ç™½é¢† 902 è¿åŠ¨å¥èº« 903 æ—¶å°šè¾¾äºº 904 è´­è½¦ä¸€æ— 905 å•†æ—…äººå£« 906 ç¾é£Ÿçˆ±å¥½è€… 907 æŠ•èµ„ç†è´¢ 908 å®¶å±…å®¶è£… 909 æ¸¸æˆéƒ¨è½ 910 é«˜ç«¯äººå£« 911 äº²å­å®¶åº­ 912 æ—…æ¸¸å‡ºè¡Œ 913 é’æ˜¥æ ¡å›­ 914 æå®¢äººç¾¤ ï¿¼ content interest æ ‡ç­¾ å«ä¹‰ 801 æ–°é—» 80101 æ–°é—»-å›½å†… 80102 æ–°é—»-å›½é™… 80103 æ–°é—»-ç¤¾ä¼š 80104 æ–°é—»-èˆªç©º 80105 æ–°é—»-å¤©æ°” 80106 æ–°é—»-ç¾å®³ 802 å†›äº‹ 803 ä½“è‚²èµ›äº‹ 804 å¨±ä¹ 805 è´¢ç» 806 ç§‘æŠ€ 807 æ—¶å°šä¸½äºº 808 å¥åº· 809 æˆ¿äº§ 810 æ±½è½¦ 811 è¯»ä¹¦ 812 å†å² 813 æ•™è‚² 814 è‚²å„¿ ï¿¼815 æ˜Ÿåº§ 816 æ—…æ¸¸ ï¿¼817 æ¸¸æˆ 818 ç¾é…’ç¾é£Ÿ ï¿¼819 æ–‡åŒ–è‰ºæœ¯ 820 å® ç‰© ï¿¼821 èŒåœº 822 ç§‘å­¦æ¢ç´¢ 823 æ‘„å½± 824 å•†ä¸šäº§å“ 825 ï¿¼ç”Ÿæ´»æœåŠ¡ business interestâ€¦â€¦ æŸç”¨æˆ·ç”»åƒæœ€ç»ˆå½¢å¼ç¤ºä¾‹å¦‚ä¸‹&#123; &quot;com_its&quot;: [ &#123; &quot;id&quot;: &quot;20737&quot;, &quot;weight&quot;: 0.4976 &#125;, &#123; &quot;id&quot;: &quot;20847&quot;, &quot;weight&quot;: 0.25691 &#125; ], &quot;crowds&quot;: [ &#123; &quot;id&quot;: &quot;902&quot;, &quot;weight&quot;: 1.89692 &#125;, &#123; &quot;id&quot;: &quot;912&quot;, &quot;weight&quot;: 0.28242 &#125;, &#123; &quot;id&quot;: &quot;907&quot;, &quot;weight&quot;: 0.27972 &#125; ], &quot;gender&quot;: &quot;501&quot;, &quot;ad_clicks&quot;: [ &#123; &quot;type&quot;: &quot;PDPS000000028570&quot;, &quot;id&quot;: &quot;82901&quot;, &quot;weight&quot;: 8 &#125;, &#123; &quot;type&quot;: &quot;PDPS000000047262&quot;, &quot;id&quot;: &quot;138104&quot;, &quot;weight&quot;: 4 &#125; ], &quot;st_its&quot;: [ &#123; &quot;id&quot;: &quot;80302&quot;, &quot;weight&quot;: 0.49131 &#125;, &#123; &quot;id&quot;: &quot;80501&quot;, &quot;weight&quot;: 0.18479 &#125;, &#123; &quot;id&quot;: &quot;81205&quot;, &quot;weight&quot;: 0.16429 &#125; ], &quot;zones&quot;: [ &#123; &quot;id&quot;: &quot;316009&quot;, &quot;weight&quot;: 1 &#125; ], &quot;ages&quot;: [ &#123; &quot;id&quot;: &quot;603&quot;, &quot;weight&quot;: 0.45696 &#125;, &#123; &quot;id&quot;: &quot;602&quot;, &quot;weight&quot;: 0.40343 &#125; ], &quot;version&quot;: &quot;pc:3.0&quot;&#125; next â‹¯â‹¯ notesï¼šnext â€¦"},{"title":"Career","date":"2020-08-08T06:46:48.000Z","updated":"2020-10-11T15:02:51.649Z","comments":true,"path":"vc/index.html","permalink":"http://iequa.com/vc/index.html","excerpt":"","text":"Seagroup Labs, Sea Services Data: Engineer, Data Engineer, Data Platform Job 10 Description Design data warehouse architecture. Setup and maintain data warehouse infrastructure. Setup and maintain data warehouse applications, such as data browser, job scheduler, etc. Monitor data warehouse status and hardware capacity, optimize system performance. Work with stakeholders including the data engineers, data analysts, and other data users to assist with data-related technical issues and support their data infrastructure needs Conduct research on trending data platform applications and solutions. Create POC (proof of concept) to innovative ideas, and come up with practical proposals Job 5 Description Design and develop data pipelines to process a large amount of data from our products worldwide Update and maintain existing data pipelines Work with modern technology like Scala and Spark Collaborate with other data engineers, web developers and data analysts on designing data models and product features Job Requirements In-depth understanding of data structures and other computer science fundamentals Master at least one of the following programming languages: Python, Scala, Java Experience with one or more of these technologies: Spark, Hadoop, Oozie, MySQL Experience with Linux and Shell scripting Passionate about programming and new technologies in the field ShopeeJob Description Design and manage Data warehouse plan for a product, such as: design data model, define data metric, data governance and so on Work with BI, business team, PM team, use data to solve problems, identify needs and opportunities Design,build and maintain the batch or real time data pipeline in production using Hadoop big data technology Define and manage SLA,Data quality for all data sets in allocated areas of ownership Job Requirements Minimum B.S. degree in Computer Science or a related technical field. 2+ years working experience with programming languages,such as Java,Scala,Python Ability to write efficient SQL statements Familiar with Hadoop, Spark and Flink data processing, experience of TB data processing experience is a plus Familiar with data warehouse modeling, such as dimensional data modeling and schema design Understand data mining or machine learning Excellent communication skills including the ability to identify and communicate data driven insights Strong logical thinking and analysis abilities Passionate, self-motivated, and takes ownership Senior Data Engineer my previous working experience and several questions about database, sharding And a white board coding test was included as well. behavior questions: how your manager judge about you during your previous job? Whatâ€™s your experience about a project that fails, and how would you redo the project? Whatâ€™s your Advantages and disadvantages in your personality? Whatâ€™s your best project and why you did better than others in your opinion? Whatâ€™s your plan about your future career? tech questions: a problem of top k problem RMDB vs NoSQL DB Why distributed NoSQL DB cannot always support transaction? Level traverse a binary tree in an online white board. random questions about spark, hadoop etc How osâ€™ thread works? General DWH concepts, Spark internals, mapreduce Explain the map reduce paradigm Overall, I did not encountered questions about the role such as data model, SQL and ETL pipeline design, scheduler design, BI platform design. Two mach behavior questions made me uncomfortable and difficult to answer. Reference å¤§æ•°æ®å­¦ä¹ æŒ‡å— ä¸€æ–‡å¸¦ä½ è®¤æ¸…æ•°æ®ä»“åº“ã€Œç»´åº¦æ¨¡å‹è®¾è®¡ã€ä¸ã€Œåˆ†å±‚æ¶æ„ã€ æœ‰èµæ•°æ®ä»“åº“å®è·µä¹‹è·¯ å¤§æ•°æ®Hadoopé¢è¯•é¢˜ï¼ˆä¸‰ï¼‰â€”â€”MapReduce"},{"title":"","date":"2019-10-20T04:30:33.518Z","updated":"2019-10-20T04:30:33.517Z","comments":true,"path":"sina_project/pro2/index.html","permalink":"http://iequa.com/sina_project/pro2/index.html","excerpt":"","text":"2. dmp é¡¹ç›®æ–°æµªdmpåŸºäºå¹¿å‘Šç¨‹åºåŒ–è´­ä¹°åœºæ™¯ï¼Œå°†å¹¿å‘Šä¸»æ•°æ®æ•´åˆæ¥å…¥ï¼Œå¹¶ç»“åˆæ–°æµªè‡ªæœ‰æ•°æ®ï¼Œæ ‡å‡†åŒ–ç»Ÿä¸€ç®¡ç†æ•°æ®ã€‚åŒæ—¶ï¼Œé€šè¿‡å¯¹æ•°æ®è¿›è¡Œç»†åŒ–æ•°æ®æ ‡ç­¾ï¼Œå®Œå–„åˆ†ç±»ä½“ç³»ï¼Œå‘ç”¨æˆ·æä¾›å¤šæ ·åŒ–çš„æ•°æ®åº”ç”¨æœåŠ¡ã€‚ æœ¬äººèŒè´£ ï¼š(1). ç”¨æˆ·æ ‡ç­¾è§„èŒƒåŒ–(2). æä¾› redis å­˜å‚¨æœåŠ¡, ç›¸å…³æ¥å£çš„å°è£… 1) æ”¯æŒæ¥æ”¶ä¸åŒæ¥æºçš„æ•°æ®ã€‚ 2) æ”¯æŒè®¿é—® redis é›†ç¾¤ç­–ç•¥å¯é…ï¼Œè¯»æ•°æ®è´Ÿè½½å‡è¡¡ 3) æŸæœºå™¨æˆ–å®ä¾‹å‡ºæ•…éšœï¼Œæ˜“äºç»´æŠ¤(3). æä¾›ç¬¬ä¸‰æ–¹æ•°æ®ç”¨æˆ·æ¨èå•†å“, 10ç§ç”¨æˆ·è¡Œä¸ºæ•°æ® çš„æ¥å…¥æ¥å£ host.txt é›†ç¾¤èŠ‚ç‚¹å®ä¾‹é…ç½®## REDIS1 DMP_INFO ## (128ä¸ªèŠ‚ç‚¹ï¼Œæ¯ä¸ªèŠ‚ç‚¹é…ç½® 60% æœºå™¨å†…å­˜ç»™ redis å®ä¾‹)REDIS1#pool1:10.**.*.**:6382$10.**.*.**:6382|pool2:10.**.***.**:6382$10.**.*.**:6382|pool3:10.**.**.**:6382$10.**.*.**:6382......## REDIS3 ##REDIS3#pool1:172.**.***.**:6571$1|pool2:172.**.***.**:6571$1REDIS3#pool1:172.**.***.**:6572$2|pool2:172.**.***.**:6572$2...regionToRedis regioné€‰æ‹©é›†ç¾¤DMP_INFO=REDIS1CROSS_INFO=REDIS33RD_INFO=REDIS3strategy.properties ç­–ç•¥é…ç½®REDIS1=read:random|pool2,pool3#write:pool1REDIS3=read:order|pool2,pool1#write:pool1 Coder æ›´å¤šé¡¹ç›®è¯¦æƒ…è¯·ç‚¹å‡»â€¦ (ä¸ºäº†æ›´å¥½çš„äº’ç›¸äº†è§£ï¼Œè„±æ•åæš‚æ—¶æ”¾ä¸Šgit,åä¼šè¿…é€Ÿç§»é™¤) 2.1 ç”¨æˆ·è¡Œä¸ºæ•°æ®æ¥æ”¶ä¸æŒ–æ˜æœ¬æ¨¡å—æ˜¯æ‰¶ç¿¼æ•ˆæœå¹³å°åŠ¨æ€åˆ›æ„é¡¹ç›®çš„ä¸€éƒ¨åˆ†ï¼Œä¸»è¦å®Œæˆç”¨æˆ·åœ¨å®¢æˆ·ç½‘ç«™ä¸Šçš„è¡Œä¸ºæ•°æ®æ¥æ”¶ä¸åˆ†å‘ã€‚æœ¬æœŸåŠ¨æ€åˆ›æ„ä¸“æŒ‡ä¸ªæ€§åŒ–é‡å®šå‘ï¼Œå³ä¸»è¦é’ˆå¯¹ç”µå•†å®¢æˆ·åˆ©ç”¨å…¶ç«™å†…ç”¨æˆ·è¡Œä¸ºæ•°æ®å’Œå•†å“æ•°æ®ä¸ºå¹¿å‘Šç”¨æˆ·å±•ç¤ºæœ€åˆé€‚çš„ä¸€ç»„å•†å“ä¿¡æ¯ï¼ˆå›¾ç‰‡ã€ä»·é’±ã€æŠ˜æ‰£ç­‰ï¼‰ç»„æˆçš„åˆ›æ„ ç”¨æˆ·è®¿é—®å¹¿å‘Šå®¢æˆ·ç½‘ç«™æ—¶ï¼Œè§¦å‘éƒ¨ç½²çš„ç›‘æµ‹ä»£ç ï¼Œå‘æ–°æµªå‘é€å„ç§ç”¨æˆ·è¡Œä¸ºæ•°æ®ã€‚ æ•°æ®æ¥æ”¶æœåŠ¡æ”¶åˆ°è¯·æ±‚ï¼Œè¿›è¡Œæ•°æ®è§£æä¸éªŒè¯ æ ¹æ®æ¥æ”¶çš„æ•°æ®ç±»å‹ï¼Œæ›´æ–°æ•°æ®å¯¹æ¥çŠ¶æ€ å°†æ¥æ”¶æ•°æ®å¤„ç†ä¸ºä¸‹æ¸¸éœ€è¦çš„æ ¼å¼ï¼ŒæŠ“å‘åˆ°æ¶ˆæ¯é˜Ÿåˆ— ä¸ºæ”¯æŒç¦»çº¿çš„æ•°æ®æŒ–æ˜ï¼Œå°†æ•°æ®å†™å…¥æ—¥å¿—ï¼Œå¹¶å®æ—¶å‘é€è‡³HDFS. configa) ä¿®æ”¹é…ç½®bin/catalina.shï¼Œæ·»åŠ javaé…ç½® i. JAVA_OPTS=&#x27;-Xms40000m -Xmx40000m -Xmn10000m -XX:+UseConcMarkSweepGC -XX:+UseParNewGC -verbose:gc -XX:+PrintGCDetails -XX:+PrintGCTimeStamps -XX:+DisableExplicitGC -XX:+CMSParallelRemarkEnabled -Dsun.rmi.dgc.server.gcInterval=86400000 -Dsun.rmi.dgc.client.gcInterval=86400000 -XX:+ExplicitGCInvokesConcurrent -XX:+CMSScavengeBeforeRemark -XX:+CMSClassUnloadingEnabled -XX:CMSInitiatingOccupancyFraction=60 -XX:+UseCMSInitiatingOccupancyOnly&#x27; b) ä¿®æ”¹é…ç½®conf/server.xmlï¼Œconnectorsé…ç½®ï¼Œæ·»åŠ  i. &lt;Connector port=&quot;8080&quot; protocol=&quot;HTTP/1.1&quot;ii. connectionTimeout=&quot;20000&quot;iii. redirectPort=&quot;8443&quot; iv. acceptCount=&quot;5000&quot; maxThreads=&quot;4000&quot;/&gt; æ¨èå•†å“æ¥æ”¶æ¥å£ pc uv 3500W+ , wap uv 4500W+, weibo uv 1.6~1.8äº¿200ä¸ªå¹¶å‘åšæ¥å£å‹æµ‹ï¼Œqpsæ˜¯3000+ï¼Œå‡å»¶æ—¶65msã€‚å»¶æ—¶ä¸»è¦è€—åœ¨åŸŸåè§£æä¸Šï¼Œå†…ç½‘å‹æµ‹qpsæ˜¯3ä¸‡+ï¼Œå‡å»¶æ—¶10ms next.."},{"title":"","date":"2019-10-20T04:30:33.517Z","updated":"2019-10-20T04:30:33.516Z","comments":true,"path":"sina_project/pro3/index.html","permalink":"http://iequa.com/sina_project/pro3/index.html","excerpt":"","text":"3. ç¦»çº¿åˆ†æè°ƒåº¦æ¡†æ¶è¿™æ˜¯ä¸€ä¸ª shell ç­‰å…¶ä»–è¯­è¨€é…åˆå†™æˆçš„çµæ´»è°ƒåº¦æ¡†æ¶. è¯¥ç¤ºä¾‹æ¨¡å—æ¶ é€‚ç”¨äºç¦»çº¿åˆ†æè°ƒåº¦ï¼Œç‰¹åˆ«æ˜¯æ¯å¤©è·‘çš„crontabä»»åŠ¡ï¼Œæˆ–è€…æ˜¯æ¯å‘¨ã€æ¯æœˆè·‘çš„ä»»åŠ¡. å¤šç”¨äº hive è¯­å¥ æˆ– å…¶ä»–è„šæœ¬ç¦»çº¿è¿è¡Œ. æä¾›ä¸€äº› best practice æé«˜å„æ¨¡å—ç»“æ„åŠä»£ç çš„ä¸€è‡´æ€§ é™ä½å¼€å‘æ–°æ¨¡å—çš„æˆæœ¬ ä¾¿äºç¦»çº¿å¤§æ•°æ®åˆ†ææµç¨‹æ§åˆ¶ å…·å¤‡æŠ¥è­¦ï¼Œæ—¥å¿—å®šä½ï¼Œå¸¸ç”¨æ£€æµ‹ä¾èµ–åº“å‡½æ•° ç­‰åŠŸèƒ½ å½“ç„¶å®ƒä¹Ÿé€‚ç”¨äºå¯¹ä»»ä½•ç¦»çº¿Jobè¿›è¡Œè°ƒåº¦ ä¸åŒäººè´Ÿè´£çš„æ¨¡å—ä¸åŒï¼Œæ¨¡å—ç›®å½•ç»“æ„æ˜¯ä¸€æ ·çš„ï¼Œå¦‚ä¸‹æ‰€ç¤º å¼€å‘æ¨¡å—çš„æ—¶å€™ï¼Œæ¯ä¸ªäººåªéœ€è¦ç¼–å†™è‡ªå·±æ¨¡å— script ä¸‹è„šæœ¬ å’Œ å°‘é‡ crontab_job è„šæœ¬çš„æ”¹åŠ¨å³å¯. ç›®å½•ç»“æ„ åŠŸèƒ½ è¯¦ç»†è¯´æ˜ â”€ crontab_job crontab è„šæœ¬ ç”± linux crontab è§¦å‘, æ£€æµ‹æ•´æ¡æµæ°´çº¿ä»»åŠ¡ä¾èµ–å…³ç³», è°ƒç”¨ script ç›®å½•è„šæœ¬ç­‰ â”€ script ä¸»è„šæœ¬ shellã€pythonè„šæœ¬. shell é‡Œä¸»ä¸º hql æˆ– streaming MRã€spark-submit ä»»åŠ¡ç­‰ â”€ conf é…ç½®æ–‡ä»¶ default.confã€vars.confã€alert.conf â”€ log æ—¥å¿—æ–‡ä»¶ ä¸»è„šæœ¬log (å¤šæ¬¡è¿è¡Œå¤šä¸ªlog file)ã€crontab è„šæœ¬log (ä¸€ä¸ªlog file) â”€ flag æ ‡è®°æ–‡ä»¶ (æ ‡å¿—è¯¥æ¨¡å—å·²è¿è¡Œï¼Œæˆ–è¿è¡Œå®Œæ¯•ï¼Œ crontab ä¼šè½®è¯¢æ£€æµ‹) &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; crontab_label.2017-12-13ã€ods_e_coupon/2017-12-13.all.done â”€ util å·¥å…·è„šæœ¬ loggingã€static_functionsã€static_hive_libã€crontab_job_envã€env â”€ alert æŠ¥è­¦å°è£… (å‘é€æŠ¥è­¦é‚®ä»¶çš„å°è£… alertã€send_mail.pyã€constant_mail.py) â”€ create_table å»ºè¡¨è„šæœ¬ å»ºé‡Œ hive table çš„è¯­å¥ â”€ jar jaråŒ… å¦‚ æ—  åˆ™ä¸éœ€è¦å»ºç«‹ â”€ java udfã€udaf å¦‚ æ—  åˆ™ä¸éœ€è¦å»ºç«‹ conf/default.conf #ç³»ç»Ÿç¯å¢ƒå˜é‡export HADOOP=&quot;$&#123;HADOOP_HOME&#125;/bin/hadoop&quot;export HIVE=&quot;$&#123;HIVE_HOME&#125;/bin/hive&quot;export JAVA=&quot;$&#123;JAVA_HOME&#125;/bin/java&quot;#hadoop jarhadoop_jar=&quot;$&#123;HADOOP_HOME&#125;/share/packages/hadoop2/hadoop-streaming-2.7.2.jar&quot;#log_utilscheduler_log_script=&quot;$&#123;util_dir&#125;/logging&quot;#æ§åˆ¶æ—¥å¿—è¿è¡Œæ–¹å¼open_log=true#è¿è¡Œhadoopä»»åŠ¡çš„ç”¨æˆ·åuser=&quot;data_mining&quot;#hiveè¡¨è·¯å¾„ods_hive_dir=&quot;/data_mining/dm/ods/&quot;mds_hive_dir=&quot;/data_mining/dm/mds/&quot;tmp_hive_dir=&quot;/data_mining/dm/tmp/&quot;## OSSOSS_URL=&quot;oss://your-key:your-value@x-bigdata.oss-cn-hangzhou-internal.aliyuncs.com&quot; crontab_job #check crontab_label whether existif check_local_crontab_label $&#123;flag_dir&#125; $&#123;d1&#125; then echo &quot;[INFO] script already run!&quot;else echo &quot;[INFO] check dependention&quot; check_hive_partitions tablename 2018-04-19# check_local_file()# check_hdfs_file()# ... echo &quot;[INFO] script run!&quot;# generate crontab_label touch_local_crontab_label $&#123;flag_dir&#125; $&#123;d1&#125;# run main script echo &quot;[INFO] start run...&quot; sh ods_dm_e_coupon.sh $d1 check_crontab_success $&#123;flag_dir&#125; $&#123;d1&#125; fiecho_ex &quot;run $0 end!&quot; bigdata-offline-demo æ›´å¤šé¡¹ç›®è¯¦æƒ…è¯·ç‚¹å‡»â€¦ next.."},{"title":"","date":"2018-03-05T08:46:48.000Z","updated":"2019-10-20T04:30:33.515Z","comments":true,"path":"sina_project/proj/index.html","permalink":"http://iequa.com/sina_project/proj/index.html","excerpt":"","text":"MathJax.Hub.Config({ extensions: [\"tex2jax.js\"], jax: [\"input/TeX\"], tex2jax: { inlineMath: [ ['$','$'], ['\\\\(','\\\\)'] ], displayMath: [ ['$$','$$']], processEscapes: true } }); åœ¨æ‰€åšçš„å‡ ä¸ªé‡ç‚¹é¡¹ç›®å¦‚ä¸‹: ç”¨æˆ·å†…å®¹å…´è¶£æŒ–æ˜äººç¾¤åˆ’åˆ†dmp ç³»ç»Ÿé¢†åˆ¸æ¨èç³»ç»Ÿnext â‹¯â‹¯ å¤§æ ‡ç­¾ä½“ç³» notesï¼šnext â€¦"},{"title":"æ–°æµªDMPå­˜å‚¨ç³»ç»Ÿ","date":"2018-03-05T08:46:48.000Z","updated":"2019-10-20T04:30:33.519Z","comments":true,"path":"sina_project/proj_dmp/index.html","permalink":"http://iequa.com/sina_project/proj_dmp/index.html","excerpt":"","text":"æ–°æµªdmpåŸºäºå¹¿å‘Šç¨‹åºåŒ–è´­ä¹°åœºæ™¯ï¼Œå°†å¹¿å‘Šä¸»æ•°æ®æ•´åˆæ¥å…¥ï¼Œå¹¶ç»“åˆæ–°æµªè‡ªæœ‰æ•°æ®ï¼Œæ ‡å‡†åŒ–ç»Ÿä¸€ç®¡ç†æ•°æ®ã€‚åŒæ—¶ï¼Œé€šè¿‡å¯¹æ•°æ®è¿›è¡Œç»†åŒ–æ•°æ®æ ‡ç­¾ï¼Œå®Œå–„åˆ†ç±»ä½“ç³»ï¼Œå‘ç”¨æˆ·æä¾›å¤šæ ·åŒ–çš„æ•°æ®åº”ç”¨æœåŠ¡ã€‚ æœ¬äººèŒè´£ ï¼š(1). ç”¨æˆ·æ ‡ç­¾è§„èŒƒåŒ–(2). æä¾› redis å­˜å‚¨æœåŠ¡, ç›¸å…³æ¥å£çš„å°è£… 1) æ”¯æŒæ¥æ”¶ä¸åŒæ¥æºçš„æ•°æ®ã€‚ 2) æ”¯æŒè®¿é—® redis é›†ç¾¤ç­–ç•¥å¯é…ï¼Œè¯»æ•°æ®è´Ÿè½½å‡è¡¡ 3) æŸæœºå™¨æˆ–å®ä¾‹å‡ºæ•…éšœï¼Œæ˜“äºç»´æŠ¤(3). æä¾›ç¬¬ä¸‰æ–¹æ•°æ®cookie-mapping, ç”¨æˆ·æ¨èå•†å“, 10ç§ç”¨æˆ·è¡Œä¸ºæ•°æ® çš„æ¥å…¥(4). ç¦»çº¿äººç¾¤åŒ…æŒ–æ˜ next â‹¯â‹¯ notesï¼šnext â€¦"},{"title":"","date":"2021-06-14T16:22:09.022Z","updated":"2021-06-14T16:22:09.022Z","comments":true,"path":"v4/getting-started/index.html","permalink":"http://iequa.com/v4/getting-started/index.html","excerpt":"","text":"&ensp;Volantis4 A Wonderful Theme for Hexo Volantis æ˜¯ä¸€ä¸ªåŠŸèƒ½ä¸°å¯Œã€é«˜åº¦æ¨¡å—åŒ–çš„ Hexo åšå®¢ä¸»é¢˜ã€‚å¾—ç›Šäºå…¶å¼ºå¤§çš„æ¨¡å—åŒ–ç‰¹æ€§ï¼Œæ‚¨å¯ä»¥è½»æ¾æ­å»ºä¸€ä¸ªæç®€é£æ ¼çš„åšå®¢ï¼Œä¹Ÿå¯ä»¥ä»¿ç…§å®˜ç½‘æ­å»ºä¸€ä¸ªå¤šäººåä½œçš„ã€åŒ…å«æ–‡æ¡£æ¨¡å—çš„å¤§ä½“é‡ç»¼åˆå‹åšå®¢ã€‚ ç¤ºä¾‹åšå®¢https://volantis.js.org/examples/ æ‰€æœ‰çš„ Volantis ç”¨æˆ·éƒ½å¯ä»¥æŒ‰ç…§æ ¼å¼è‡ªè¡Œåˆ›å»º Issue æ¥å°†è‡ªå·±çš„åšå®¢æ·»åŠ åˆ°å®˜ç½‘çš„ç¤ºä¾‹åšå®¢é¡µé¢ä¸­ã€‚ å‡†å¤‡å·¥ä½œèƒ½åŠ›æ¡ä»¶ç¯å¢ƒé…ç½®æ¡ä»¶è‡ªå»ºåšå®¢éœ€è¦ä¸€å®šçš„ç›¸å…³çŸ¥è¯†ï¼Œåœ¨å¼€å§‹å‰ï¼Œè¯·åŠ¡å¿…ç¡®ä¿æ‚¨ä¼šä½¿ç”¨ markdown è¯­æ³•ï¼ŒæŒæ¡ç®€å•çš„ git çŸ¥è¯†ï¼Œæœ€æœ€é‡è¦çš„æ˜¯ï¼Œé‡åˆ°å›°éš¾çŸ¥é“è¯¥æ€ä¹ˆå¯»æ±‚è§£å†³ï¼š ç¿»é˜…å’Œæœç´¢æ–‡æ¡£ æœç´¢ issues ä¸­æ˜¯å¦æœ‰è§£å†³åŠæ³• æ–°å»º issue å¹¶æŒ‰ç…§è¦æ±‚è¿›è¡Œæ“ä½œï¼Œè¯¦å°½åœ°æè¿°æ‚¨é‡åˆ°çš„é—®é¢˜ å¦‚æœæ‚¨æ²¡æœ‰ä½¿ç”¨è¿‡ Hexo ä¹Ÿä¸è¦ç€æ€¥ï¼Œå¯ä»¥å…ˆé€šè¯»ä¸€é Hexo ä¸­æ–‡æ–‡æ¡£ï¼Œè¦æƒ³ä½¿ç”¨åœ°å¾—å¿ƒåº”æ‰‹ï¼Œæœ€å¥½å‚ç…§å›¢é˜Ÿæä¾›çš„å¼€æºé¡¹ç›®çš„æºç è¿›è¡Œæ­å»ºï¼š Demo æºç  ï½œ å®˜ç½‘æºç å¦‚æœæ‚¨ä»æ—§ç‰ˆæœ¬æ›´æ–°æˆ–ç€å…¶å®ƒä¸»é¢˜è¿ç§»ï¼Œè¯·ç¡®ä¿ç¯å¢ƒç‰ˆæœ¬ä¸è¦å¤ªä½ï¼Œå¦åˆ™ä¼šäº§ç”Ÿå…¼å®¹æ€§é—®é¢˜ã€‚ Hexo: 4.2 ~ 5.xhexo-cli: 3.1 ~ 4.xnode.js: 12.16 ~ latest # æ¨èä½¿ç”¨ LTS ç‰ˆnpm: 6.13 ~ latest å¿«é€Ÿä½“éªŒå¦‚æœæ‚¨å·²ç»å…·å¤‡ç¯å¢ƒé…ç½®æ¡ä»¶ï¼Œå¯ä»¥åœ¨ç»ˆç«¯ä¸­è¾“å…¥ä¸‹é¢è¿™è¡Œä»£ç ï¼Œç¨ç­‰ç‰‡åˆ»å³å¯å°é²œä½“éªŒï¼š git clone https://github.com/volantis-x/demo.git &amp;&amp; cd demo &amp;&amp; npm i &amp;&amp; hexo s ä¸‹è½½ä¸å®‰è£…å…¨æ–°åšå®¢å®‰è£…ä»å…¶å®ƒä¸»é¢˜è¿ç§»ç¬¬ 1/2 æ­¥ï¼šä¿®æ”¹ç«™ç‚¹é…ç½®æ–‡ä»¶ åœ¨ blog/_config.yml æ–‡ä»¶ä¸­æ‰¾åˆ°å¹¶ä¿®æ”¹ï¼štheme: volantis ç¬¬ 2/2 æ­¥ï¼šä¸‹è½½ä¸»é¢˜ åœ¨ç»ˆç«¯ä¸­è¾“å…¥ï¼šnpm i hexo-theme-volantis å¦‚æœæ‚¨æ˜¯ Mac ç”¨æˆ·ï¼Œå¯ä»¥ä½¿ç”¨è„šæœ¬å®Œæˆå…¨éƒ¨æµç¨‹ åœ¨åšå®¢è·¯å¾„æ‰“å¼€ç»ˆç«¯ï¼Œä¸‹è½½å®‰è£…å¹¶åº”ç”¨ä¸»é¢˜ï¼šcurl -s https://volantis.js.org/start | bashè¿™è¡Œå‘½ä»¤å°†ä¼šè‡ªåŠ¨æ£€æµ‹å¹¶å®‰è£…æ‰€éœ€ç¯å¢ƒï¼Œåˆå§‹åŒ–åšå®¢ï¼Œç„¶åä¸‹è½½å®‰è£…å¹¶åº”ç”¨ä¸»é¢˜ã€‚è„šæœ¬è¯¦ç»†ä½¿ç”¨æ–¹æ³•ï¼š#hexo.sh ç¬¬ 1/3 æ­¥ï¼šä¿®æ”¹ç«™ç‚¹é…ç½®æ–‡ä»¶ åœ¨ blog/_config.yml æ–‡ä»¶ä¸­æ‰¾åˆ°å¹¶ä¿®æ”¹ï¼štheme: volantis ç¬¬ 2/3 æ­¥ï¼šä¸‹è½½ä¸»é¢˜ å¦‚æœæ‚¨å·²ç»å‡çº§åˆ° Hexo 5.0.2 åŠä»¥ä¸Šï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ npm å‘½ä»¤å®‰è£…ï¼šnpm i hexo-theme-volantiså¯¹äºæ—§ç‰ˆæœ¬ï¼Œéœ€è¦ä¸‹è½½ä¸»é¢˜æºç åˆ° themes/ æ–‡ä»¶å¤¹ï¼šgit clone https://github.com/volantis-x/hexo-theme-volantis themes/volantiså¦‚æœæ‚¨æ— æ³•è®¿é—® GitHub å¯ä»¥ä½¿ç”¨å›½å†…é•œåƒæºï¼šgit clone https://e.coding.net/volantis-x/p/hexo-theme-volantis.git themes/volantis ç¬¬ 3/3 æ­¥ï¼šæ£€æŸ¥å¹¶å®‰è£…ä¾èµ– å®‰è£… Hexo æœç´¢çš„ä¾èµ–åŒ…ï¼šnpm i hexo-generator-search hexo-generator-json-contentå®‰è£… Stylus æ¸²æŸ“å™¨ï¼šnpm i hexo-renderer-stylus ç‰ˆæœ¬æ›´æ–°æ³¨æ„äº‹é¡¹ä½¿ç”¨ä¸»é¢˜çš„æ—¶å€™ï¼Œå°½é‡ fork ä¸»é¢˜åˆ°è‡ªå·±çš„ GitHubï¼Œç„¶åè¿›è¡Œä¿®æ”¹å¹¶ä½¿ç”¨ã€‚è¿™æ ·åšçš„å¥½å¤„æ˜¯ï¼šå½“ä¸»é¢˜è¿›è¡Œé‡è¦æ›´æ–°çš„æ—¶å€™å¯ä»¥æ ¹æ®éœ€è¦æ‹‰å–åˆå¹¶ä»£ç ï¼Œä½¿è‡ªå·± DIY çš„ä¸»é¢˜èƒ½å¤Ÿé€šè¿‡æ›´æ–°è·å– BUG ä¿®å¤æˆ–è€…æ–°ç‰¹æ€§ã€‚ å¦‚æœä¸æ‡‚è¯·è‡ªè¡Œæœç´¢å…³é”®è¯ï¼šfork æ›´æ–° å®ç”¨å°æŠ€å·§æ‰€æœ‰éœ€è¦å†™åœ¨ä¸»é¢˜é…ç½®æ–‡ä»¶ä¸­çš„é…ç½®éƒ½å¯ä»¥å†™åœ¨ç«™ç‚¹é…ç½®æ–‡ä»¶çš„ theme_config: ä¸­ï¼Œåœ¨ Hexo 5.0 åï¼Œè¿˜å¯ä»¥å†™åœ¨ _config.volantis.yml æ–‡ä»¶ä¸­ï¼Œè¯¦è§ Hexo å®˜æ–¹æ–‡æ¡£ï¼šè¦†ç›–ä¸»é¢˜é…ç½®https://hexo.io/zh-cn/docs/configuration#%E8%A6%86%E7%9B%96%E4%B8%BB%E9%A2%98%E9%85%8D%E7%BD%AEä¹Ÿå¯ä»¥ç›´æ¥æŸ¥çœ‹æœ¬ç«™æºç ä¸­ç«™ç‚¹é…ç½®æ–‡ä»¶çš„å†™æ³•ï¼š_config.volantis.yml è¯·å¯¹ç…§ æ›´æ–°æ—¥å¿— è¿›è¡Œæ›´æ–°ï¼Œä¸‹é¢æ˜¯æ›´æ–°ä¹‹åéœ€è¦æ³¨æ„çš„äº‹é¡¹ï¼š 2021-01-15 4.2.0 -&gt; 4.3.0 æ›´å¤šå…³äºVolantisçš„å°ç‰ˆæœ¬æ›´æ–°è¯·ç‚¹å‡»ä¸Šæ–¹æ›´æ–°æ—¥å¿—æŒ‰é’®å¢åŠ  disqusjs è¯„è®ºç³»ç»Ÿï¼›å¢åŠ  waline è¯„è®ºç³»ç»Ÿï¼›å¢åŠ  æ—§ç‰ˆ Internet Explorer æ·˜æ±°è¡ŒåŠ¨ ï¼›å¢åŠ  TidioèŠå¤©åŠŸèƒ½ï¼›å¢åŠ  twitoo waline valine minivaline æ–‡ç« é˜…è¯»é‡ç»Ÿè®¡ï¼›å¢åŠ  bbtalk.jsï¼›ä¿®å¤#514 #538 #567 #431 #468ï¼›ä¿®å¤å…³é—­ pjax æ—¶ coveræ ·å¼å¤±æ•ˆ å’Œ æŠ¥é”™ çš„é—®é¢˜ ã€‚ 2020-09-26 3.0.0 -&gt; 4.0.0 4.0.0 çš„é…ç½®æ–‡ä»¶æ”¹åŠ¨éå¸¸å¤§ï¼Œå¼ºçƒˆå»ºè®®ä¸è¦åœ¨æ—§çš„é…ç½®æ–‡ä»¶ä¸Šæ”¹ã€‚åŸæ•°æ®æ–‡ä»¶ä¸­çš„é…ç½®é¡¹ä¸å†æ”¯æŒï¼Œè¯·åœ¨é…ç½®æ–‡ä»¶ä¸­è¿›è¡Œè®¾ç½®ã€‚ä¸»é¢˜é…ç½®æ–‡ä»¶è¿›è¡Œäº†é‡æ–°è®¾è®¡ï¼Œéœ€è¦ã€Œå®Œå…¨ã€é‡æ–°é…ç½®ä¸€éã€‚å‹é“¾ä½¿ç”¨æ•°æ®æ–‡ä»¶ï¼Œå¹¶æ”¯æŒ issues æ ‡ç­¾å®ç°åŠ¨æ€è‡ªåŠ©å‹é“¾ã€‚åŸ meta è‡ªå®šä¹‰å¸ƒå±€ç°åœ¨åªæ”¯æŒæ–‡ç« å†…éƒ¨çš„ top_meta å’Œ bottom_meta ã€‚æ–‡ç« åˆ—è¡¨é¡µé¢å¸ƒå±€ç°åœ¨åªèƒ½åœ¨æœ‰é™èŒƒå›´å†…è¿›è¡Œè‡ªå®šä¹‰ã€‚ä¾§è¾¹æ ç»„ä»¶ç°åœ¨åªæ”¯æŒä¾§è¾¹æ ä½ç½®ï¼›æ–‡ç« æœ«å°¾æœ‰ä¸“ç”¨çš„ç»„ä»¶ã€‚å¦‚æœå®‰è£…äº†æ‡’åŠ è½½æ’ä»¶ï¼Œéœ€è¦å¸è½½æ‰ï¼Œä½¿ç”¨ä¸»é¢˜å†…ç½®çš„æ‡’åŠ è½½ï¼ˆå’Œæ’ä»¶å†²çªï¼‰ã€‚å¦‚æœæƒ³è¦å…³é—­è¯„è®ºï¼Œéœ€è¦æ”¹ä¸º comments: false ã€‚å¦‚æœè¦éšè—æ–‡ç« é¡¶éƒ¨æˆ–è€…åº•éƒ¨çš„ meta æ ‡ç­¾ï¼Œéœ€è®¾ç½® top_meta: false æˆ–è€… bottom_meta: false ã€‚å¦‚æœéœ€è¦åŒæ—¶éšè—æ ‡é¢˜å’Œé¡¶éƒ¨çš„ meta æ ‡ç­¾ä¹Ÿå¯ä»¥æŠŠ title: xxx æ”¹ä¸º seo_title: xxx ã€‚ä½œè€…çš„ä¿¡æ¯ä½¿ç”¨æ•°æ®æ–‡ä»¶è¿›è¡Œå®šä¹‰ï¼Œæ–‡ç« ä¸­åªéœ€è¦å†™ author: xxx è€Œä¸éœ€è¦é‡å¤å†™ä½œè€…çš„ä¿¡æ¯äº†ã€‚ç°åœ¨åªæœ‰ gallery æ ‡ç­¾çš„å›¾ç‰‡æ”¯æŒæ”¾å¤§ã€‚å‹é“¾é¡µé¢ layout: links æ”¹ä¸º layout: friendsã€‚ è®¸å¯åè®®æœ¬ä¸»é¢˜é‡‡ç”¨ MITå¼€æºè®¸å¯åè®® ï¼Œæ°¸ä¹…æ— é™åˆ¶å…è´¹ä½¿ç”¨ã€‚ MITå¼€æºè®¸å¯åè®®è¢«æˆæƒäººæœ‰æƒåˆ©ä½¿ç”¨ã€å¤åˆ¶ã€ä¿®æ”¹ã€åˆå¹¶ã€å‡ºç‰ˆå‘è¡Œã€æ•£å¸ƒã€å†æˆæƒåŠè´©å”®è½¯ä»¶åŠè½¯ä»¶çš„å‰¯æœ¬ã€‚è¢«æˆæƒäººå¯æ ¹æ®ç¨‹å¼çš„éœ€è¦ä¿®æ”¹æˆæƒæ¡æ¬¾ä¸ºé€‚å½“çš„å†…å®¹ã€‚åœ¨è½¯ä»¶å’Œè½¯ä»¶çš„æ‰€æœ‰å‰¯æœ¬ä¸­éƒ½å¿…é¡»åŒ…å«ç‰ˆæƒå£°æ˜å’Œè®¸å¯å£°æ˜ã€‚ é…ç½®ä¸ä½¿ç”¨é…ç½®ä¸ä½¿ç”¨/v4/site-settings/"},{"title":"è¿›é˜¶è®¾å®š","date":"2021-06-13T16:29:30.066Z","updated":"2021-06-13T16:29:30.066Z","comments":true,"path":"v4/advanced-settings/index.html","permalink":"http://iequa.com/v4/advanced-settings/index.html","excerpt":"","text":"è®¾ç½®å­æ¨¡å— å°†ä¸»é¢˜æ·»åŠ ä¸ºå­æ¨¡å— git submodule add https://github.com/volantis-x/hexo-theme-volantis.git themes/volantis å¤šäººååŒé»˜è®¤çš„ä½œè€…ä¿¡æ¯åœ¨ä¸»é¢˜é…ç½®æ–‡ä»¶ä¸­è®¾ç½®ï¼š blog/themes/volantis/_config.yml# æ–‡ç« å¸ƒå±€article: ... body: ... meta_library: author: avatar: name: è¯·è®¾ç½®æ–‡ç« ä½œè€… url: / Volantis æ”¯æŒå¤šä¸ªä½œè€…åœ¨ä¸€ä¸ªç«™ç‚¹å‘å¸ƒæ–‡ç« ï¼Œå…¶ä»–ä½œè€…ä¿¡æ¯éœ€è¦å†™åœ¨æ•°æ®æ–‡ä»¶ä¸­ï¼Œä¾‹å¦‚ï¼š blog/source/_data/author.ymlJon: name: Jon Snow avatar: https://cn.bing.com/th?id=AMMS_fc8f99fd41ebd737a71c4e13806db9a0&amp;w=110&amp;h=110&amp;c=7&amp;rs=1&amp;qlt=80&amp;pcl=f9f9f9&amp;cdv=1&amp;dpr=2&amp;pid=16.1 url: https://gameofthrones.fandom.com/wiki/Jon_SnowDany: name: Daenerys Targaryen avatar: https://tse1-mm.cn.bing.net/th?id=OIP.Yax4wLzIFbcBVUa_RsKywQHaLH&amp;w=80&amp;h=80&amp;c=8&amp;rs=1&amp;qlt=90&amp;dpr=2&amp;pid=3.1&amp;rm=2 url: https://gameofthrones.fandom.com/wiki/Daenerys_Targaryen åœ¨æ–‡ç« çš„ front-matter ä¸­æ–°å¢ author å³å¯ï¼š ---title: Jon Snow | Game of Thrones Wiki | Fandomauthor: Jon--- ä¸ºç½‘ç«™æé€ŸåŠ è½½é€Ÿåº¦ å‡å°‘ä¸å¿…è¦çš„ js æ’ä»¶ï¼Œä¾‹å¦‚å­—æ•°ç»Ÿè®¡ã€åŠ¨æ€èƒŒæ™¯ã€‚ æŸ¥æ‰¾å¹¶è§£å†³æ‹–æ…¢é€Ÿåº¦çš„èµ„æºï¼Œä»¥ Chrome æµè§ˆå™¨ä¸ºä¾‹ï¼š é¡µé¢ä¸­ç‚¹å‡»å³é”®ï¼Œé€‰æ‹©ã€Œæ£€æŸ¥ã€ã€‚ åœ¨å³è¾¹çš„çª—å£ä¸­ã€ŒNetworkã€é€‰é¡¹å¡ï¼Œå¹¶å‹¾é€‰ã€ŒDisable cacheã€ã€‚ åˆ·æ–°ç½‘é¡µï¼ŒæŸ¥çœ‹åŠ è½½é€Ÿåº¦æ…¢çš„èµ„æºã€‚3.1. åŠ è½½ç¼“æ…¢çš„å›¾ç‰‡ï¼Œå»ºè®®ä½¿ç”¨ CDNã€‚3.2. åŠ è½½ç¼“æ…¢çš„å¯ä»¥ä¸ç”¨çš„ js æ’ä»¶ï¼Œå»ºè®®èˆå¼ƒã€‚3.3. åŠ è½½ç¼“æ…¢å´å¿…é¡»ä½¿ç”¨çš„ js æ’ä»¶ï¼Œå»ºè®®ä¸‹è½½å¹¶è‡ªå·±ä¸Šä¼ è‡³ jsdelivrã€‚ è¿è¡Œé€Ÿåº¦ è®¿é—®å…·æœ‰åŠ¨æ€ç‰¹æ•ˆèƒŒæ™¯ï¼ˆå¦‚é›ªèŠ±ã€ç²’å­ç­‰ï¼‰çš„ç½‘ç«™æ—¶ï¼Œæ‰‹æœºå¾ˆå¿«ä¼šå‘çƒ«å˜å¡ï¼Œç¬”è®°æœ¬å¾ˆå¿«ä¼šé£æ‰‡ç‹‚è½¬å¹¶ä¸”æµè§ˆå™¨æç¤ºå»ºè®®å…³é—­æ­¤é¡µé¢ã€‚å¦‚æœä½ å¸Œæœ›ç½‘ç«™æœ‰å¥½çš„ä½¿ç”¨ä½“éªŒè¯·å°½é‡ä¸è¦å®‰è£…è¿™ç±»æ’ä»¶ã€‚ ä¼˜åŒ– SEOblog/_config.volantis.ymlseo: # When there are no keywords in the article&#x27;s front-matter, use tags as keywords. use_tags_as_keywords: true # When there is no description in the article&#x27;s front-matter, use excerpt as the description. use_excerpt_as_description: true robots: home_first_page: index,follow home_other_pages: noindex,follow archive: noindex,follow category: noindex,follow tag: noindex,follow # robots can be written in front-matter åœ¨ front-matter ä¸­ï¼Œå¯ä»¥è®¾ç½® keywordsã€descriptionã€robots å’Œ seo_titleã€‚å…¶ä¸­ seo_title ä»…ä»…ç”¨ä½œç½‘é¡µæ ‡é¢˜ï¼Œä¼˜å…ˆçº§é«˜äº titleã€‚ æ–‡ç« å†…éƒ¨ä¸è¦ä½¿ç”¨ H1 æ ‡é¢˜ã€‚ é€šè¿‡æ­»é“¾æ£€æµ‹å·¥å…·æ£€æŸ¥å¹¶åˆ é™¤æ— æ³•è®¿é—®çš„é“¾æ¥ã€‚ å®‰è£… SEO ä¼˜åŒ–æ’ä»¶ï¼š hexo-autonofollowhttps://github.com/liuzc/hexo-autonofollow hexo-generator-seo-friendly-sitemaphttps://github.com/ludoviclefevre/hexo-generator-seo-friendly-sitemap é¡µé¢ä¸è¦å †ç Œå…³é”®è¯ï¼Œä¸è¦é¢‘ç¹æ›´æ”¹è·¯å¾„ã€‚ ä½¿ç”¨ CDNå¯¹äºå¤§éƒ¨åˆ†å°†åšå®¢ deploy åˆ° GitHub çš„ç”¨æˆ·æ¥è¯´ï¼Œç›´æ¥åŠ è½½æœ¬åœ°èµ„æºé€Ÿåº¦æ¯”è¾ƒæ…¢ï¼Œå¯ä»¥ä½¿ç”¨ jsdelivr ä¸ºå¼€æºé¡¹ç›®æä¾›çš„ CDN æœåŠ¡ã€‚ å¼€å¯æ–¹æ³•blog/_config.volantis.yml# use_cdn: /source/js/* ä¸­çš„JSæ–‡ä»¶(JS Only)ä½¿ç”¨jsdelivrçš„minç‰ˆæœ¬åŠ é€Ÿ# é»˜è®¤ä½¿ç”¨ https://cdn.jsdelivr.net/npm/hexo-theme-volantis@&lt;%- theme.info.theme_version %&gt;/source/js/*.min.js çš„CDNå‹ç¼©ç‰ˆæœ¬(min.js)ï¼Œæ³¨æ„ç‰ˆæœ¬å·å¯¹åº”å…³ç³»ï¼ï¼å¯ä»¥é€šè¿‡ä¿®æ”¹ä»¥ä¸‹é…ç½®é¡¹è¦†ç›–# å¼€å‘è€…æ³¨æ„ use_cdn è®¾ç½®ä¸º falseuse_cdn: trueinfo: theme_version: &#x27;x.x.x&#x27; # This is theme&#x27;s version. cdn: js: # https://cdn.jsdelivr.net/npm/hexo-theme-volantis@&lt;%- theme.info.theme_version %&gt;/source/js/app.min.js # æ³¨æ„ç‰ˆæœ¬!!! css: first: # /css/first.css (é»˜è®¤ä¸æä¾›CDNï¼Œfirst.css ä¸­ä¸ºé¦–å±æ¸²æŸ“çš„æ ·å¼ï¼Œå†…å« cover navbar search çš„æ ·å¼ã€‚) style: # /css/style.css (é»˜è®¤ä¸æä¾›CDNï¼Œstyle.css ä¸ºå¼‚æ­¥å»¶è¿ŸåŠ è½½çš„æ ·å¼ã€‚) å¦‚æœä½ éœ€è¦å¯¹æ ·å¼è¿›è¡Œ DIYï¼Œå¯ä»¥åªå…³é—­ style æ–‡ä»¶çš„ CDNã€‚ å¦‚æœä½ éœ€è¦å¯¹æ ·å¼è¿›è¡Œ DIYï¼Œè¯·æ³¨æ„é¦–å±æ¸²æŸ“å’Œå¼‚æ­¥å»¶è¿ŸåŠ è½½çš„å·®å¼‚ã€‚ è‡ªå®šä¹‰ CDNå¦‚æœä½ æŠŠå¯¹åº”çš„æ–‡ä»¶ä¸Šä¼ åˆ°è‡ªå·±çš„ CDN æœåŠ¡å™¨ï¼Œå¯ä»¥æŠŠå¯¹åº”çš„é“¾æ¥æ”¹ä¸ºè‡ªå·±çš„ CDN é“¾æ¥ã€‚ å°è¯•ä½¿ç”¨ Terser å‹ç¼© ES6å®‰è£…å‹ç¼©å·¥å…·npm install -g gulpnpm install --save-dev gulp gulp-html-minifier-terser gulp-htmlclean gulp-htmlmin gulp-minify-css gulp-terser gulp é…ç½®æ–‡ä»¶blog/gulpfile.jsvar gulp = require(&#x27;gulp&#x27;);var minifycss = require(&#x27;gulp-minify-css&#x27;);var htmlmin = require(&#x27;gulp-html-minifier-terser&#x27;);var htmlclean = require(&#x27;gulp-htmlclean&#x27;);var terser = require(&#x27;gulp-terser&#x27;);// å‹ç¼©cssæ–‡ä»¶const minify_css = () =&gt; ( gulp.src([&#x27;./public/**/*.css&#x27;]) .pipe(minifycss()) .pipe(gulp.dest(&#x27;./public&#x27;)));// å‹ç¼©htmlæ–‡ä»¶const minify_html = () =&gt; ( gulp.src([&#x27;./public/**/*.html&#x27;,&#x27;!./public/&#123;lib,lib/**&#125;&#x27;]) .pipe(htmlclean()) .pipe(htmlmin(&#123; removeComments: true, minifyJS: true, minifyCSS: true, minifyURLs: true, &#125;)) .pipe(gulp.dest(&#x27;./public&#x27;)))// å‹ç¼©jsæ–‡ä»¶const minify_js = () =&gt; ( gulp.src([&#x27;./public/**/*.js&#x27;, &#x27;!./public/**/*.min.js&#x27;,&#x27;!./public/&#123;lib,lib/**&#125;&#x27;]) .pipe(terser()) .pipe(gulp.dest(&#x27;./public&#x27;)))module.exports = &#123; minify_html: minify_html, minify_css: minify_css, minify_js: minify_js&#125;;gulp.task(&#x27;one&#x27;, gulp.parallel( minify_html, minify_css, minify_js))gulp.task(&#x27;default&#x27;, gulp.series(&#x27;one&#x27;)); è¿è¡Œå‹ç¼©gulp å®‰è£… Service Worker æœåŠ¡blog/_config.yml# å…¨å±€å¯¼å…¥import: script: - &lt;script&gt;&quot;serviceWorker&quot;in navigator&amp;&amp;navigator.serviceWorker.register(&quot;/sw.js&quot;).then(function(n)&#123;n.onupdatefound=function()&#123;var e=n.installing;e.onstatechange=function()&#123;switch(e.state)&#123;case&quot;installed&quot;:navigator.serviceWorker.controller?console.log(&quot;Updated serviceWorker.&quot;):console.log(&quot;serviceWorker Sucess!&quot;);break;case&quot;redundant&quot;:console.log(&quot;The installing service worker became redundant.&quot;)&#125;&#125;&#125;&#125;).catch(function(e)&#123;console.log(&quot;Error during service worker registration:&quot;,e)&#125;); &lt;/script&gt; åœ¨blog/sourceä¸­åˆ›å»ºsw.jsæ–‡ä»¶ã€‚ å†…å®¹å¦‚ä¸‹ï¼š importScripts(&#x27;https://cdn.jsdelivr.net/npm/workbox-cdn@5.1.3/workbox/workbox-sw.js&#x27;);workbox.setConfig(&#123; modulePathPrefix: &#x27;https://cdn.jsdelivr.net/npm/workbox-cdn@5.1.3/workbox/&#x27;&#125;);const &#123; core, precaching, routing, strategies, expiration, cacheableResponse, backgroundSync &#125; = workbox;const &#123; CacheFirst, NetworkFirst, NetworkOnly, StaleWhileRevalidate &#125; = strategies;const &#123; ExpirationPlugin &#125; = expiration;const &#123; CacheableResponsePlugin &#125; = cacheableResponse;const cacheSuffixVersion = &#x27;-000010&#x27;, // ç¼“å­˜ç‰ˆæœ¬å· æç«¯é‡è¦ï¼Œä¿®æ”¹é™æ€æ–‡ä»¶åå‘å¸ƒç½‘é¡µä¸€å®šè¦ä¿®æ”¹ç¼“å­˜ç‰ˆæœ¬å· maxEntries = 100;self.addEventListener(&#x27;activate&#x27;, (event) =&gt; &#123; event.waitUntil( caches.keys().then((keys) =&gt; &#123; return Promise.all(keys.map((key) =&gt; &#123; if (!key.includes(cacheSuffixVersion)) return caches.delete(key); &#125;)); &#125;) );&#125;);core.setCacheNameDetails(&#123; prefix: &#x27;volantis&#x27;, // æç«¯é‡è¦ è‡ªå·±æ‹Ÿå®šä¸€ä¸ªåå­— suffix: cacheSuffixVersion&#125;);core.skipWaiting();core.clientsClaim();precaching.cleanupOutdatedCaches();/* * Precache * - Static Assets */precaching.precacheAndRoute( // æç«¯é‡è¦ å®šä¹‰é¦–æ¬¡ç¼“å­˜çš„é™æ€æ–‡ä»¶ å¦‚æœå¼€å¯CDNéœ€è¦ä¿®æ”¹ä¸ºCDNé“¾æ¥ [ &#123; url: &#x27;/css/first.css&#x27;, revision: null &#125;, &#123; url: &#x27;/css/style.css&#x27;, revision: null &#125;, &#123; url: &#x27;/js/app.js&#x27;, revision: null &#125;, ],);/* * Cache File From CDN * * Method: CacheFirst * cacheName: static-immutable * cacheTime: 30d */// cdn.jsdelivr.net - cors enabledrouting.registerRoute( /.*cdn\\.jsdelivr\\.net/, new CacheFirst(&#123; cacheName: &#x27;static-immutable&#x27; + cacheSuffixVersion, fetchOptions: &#123; mode: &#x27;cors&#x27;, credentials: &#x27;omit&#x27; &#125;, plugins: [ new ExpirationPlugin(&#123; maxAgeSeconds: 30 * 24 * 60 * 60, purgeOnQuotaError: true &#125;) ] &#125;));// m7.music.126.net - cors enabledrouting.registerRoute( /.*m7\\.music\\.126\\.net/, new CacheFirst(&#123; cacheName: &#x27;static-immutable&#x27; + cacheSuffixVersion, fetchOptions: &#123; mode: &#x27;cors&#x27;, credentials: &#x27;omit&#x27; &#125;, plugins: [ new ExpirationPlugin(&#123; maxAgeSeconds: 30 * 24 * 60 * 60, purgeOnQuotaError: true &#125;) ] &#125;));/* * No Cache * * Method: networkOnly */routing.registerRoute( /.*baidu\\.com.*/, new NetworkOnly());/* * Others img fonts * Method: staleWhileRevalidate */routing.registerRoute( // Cache image fonts files /.*\\.(?:png|jpg|jpeg|svg|gif|webp|ico|eot|ttf|woff|woff2|mp3)/, new StaleWhileRevalidate());/* * Static Assets * Method: staleWhileRevalidate */routing.registerRoute( // Cache CSS files /.*\\.(css|js)/, // Use cache but update in the background ASAP new StaleWhileRevalidate());/* * sw.js - Revalidate every time * staleWhileRevalidate */routing.registerRoute( &#x27;/sw.js&#x27;, // æœ¬æ–‡ä»¶å new StaleWhileRevalidate());/* * Default - Serve as it is * networkFirst */routing.setDefaultHandler( new NetworkFirst(&#123; networkTimeoutSeconds: 3 &#125;)); å®‰è£…ã€Œç›¸å…³æ–‡ç« ã€æ’ä»¶ å®‰è£…æ’ä»¶ npm i -S hexo-related-popular-posts æ’ä»¶çš„è‡ªå®šä¹‰é…ç½®æ–¹æ³•ï¼š hexo-related-popular-postshttps://github.com/tea3/hexo-related-popular-posts å¦‚æœæ‚¨ä½¿ç”¨äº†å¤´å›¾ï¼Œå¯ä»¥åœ¨ç«™ç‚¹é…ç½®æ–‡ä»¶ä¸­æ·»åŠ ä»¥ä¸‹è®¾ç½®æ¥è®©ç›¸å…³æ–‡ç« æ˜¾ç¤ºæ­£ç¡®çš„æ–‡ç« å¤´å›¾ï¼š blog/_config.ymlpopularPosts: eyeCatchImageAttributeName: headimg æ³¨æ„éœ€è¦å‡çº§åˆ° 5.0.1 åŠä»¥ä¸Šç‰ˆæœ¬æ‰å¯ä»¥æ”¯æŒè‡ªå®šä¹‰å¤´å›¾ï¼Œè¯¦è§ #29 åˆ†æä¸ç»Ÿè®¡é»˜è®¤æ”¯æŒ ä¸è’œå­ çš„è®¿é—®ç»Ÿè®¡ï¼Œå¯ä»¥è‡ªè¡Œæ·»åŠ ç™¾åº¦ç»Ÿè®¡å’Œ Google Analyticsã€‚ å­—æ•°å’Œé˜…è¯»æ—¶é•¿ å®‰è£…ä»¥ä¸‹æ’ä»¶ï¼šnpm i --save hexo-wordcount ä¿®æ”¹é…ç½®æ–‡ä»¶ï¼Œå°† wordcount æ’ä»¶æ‰“å¼€blog/_config.volantis.ymlplugins: ... # æ–‡ç« å­—æ•°ç»Ÿè®¡ã€é˜…è¯»æ—¶é•¿ï¼Œå¼€å¯éœ€è¦å®‰è£…æ’ä»¶: npm i --save hexo-wordcount wordcount: enable: #true ç„¶åä¿®æ”¹é…ç½®æ–‡ä»¶ï¼Œå°† wordcount å†™å…¥éœ€è¦æ˜¾ç¤ºçš„ meta ä½ç½®ï¼šblog/_config.volantis.yml# æ–‡ç« å¸ƒå±€article: ... # æ–‡ç« è¯¦æƒ…é¡µé¢çš„æ–‡ç« å¡ç‰‡æœ¬ä½“å¸ƒå±€æ–¹æ¡ˆ body: # æ–‡ç« é¡¶éƒ¨ä¿¡æ¯ # ä» meta_library ä¸­å– top_meta: [..., wordcount, ...] ... # æ–‡ç« åº•éƒ¨ä¿¡æ¯ # ä» meta_library ä¸­å– bottom_meta: [..., wordcount, ...] CNZZ ç»Ÿè®¡è¯·å‚è€ƒ ZYMIN çš„è¿™ç¯‡æ•™ç¨‹ï¼šHexo hexo+ejs+material x æ·»åŠ CNZZç»Ÿè®¡ä»£ç https://zymin.cn/arcticle/hexo+ejs+material.html æ›´å¤šè¿›é˜¶ç©æ³•è¯¦è§ @TRHX çš„è¿™ç¯‡åšå®¢ï¼šHexo åšå®¢ä¸»é¢˜ä¸ªæ€§åŒ–https://www.itrhx.com/2018/08/27/A04-Hexo-blog-topic-personalization/ å†…å«å¡ç‰‡åŠé€æ˜ã€å¢åŠ å¡é€šäººç‰©ã€è‡ªå®šä¹‰é¼ æ ‡æ ·å¼ã€é¼ æ ‡ç‰¹æ•ˆã€çƒŸèŠ±ç‰¹æ•ˆã€å½©è‰²æ»šåŠ¨å­—ä½“ã€ç½‘ç«™è¿è¡Œæ—¶é—´ã€åŠ¨æ€æµè§ˆå™¨æ ‡é¢˜ã€é›ªèŠ±é£˜è½ç‰¹æ•ˆç­‰å¤šç§è¯¦ç»†æ•™ç¨‹ã€‚ ä¸»é¢˜å®˜ç½‘ #è¿›é˜¶ç©æ³•https://volantis.js.org/categories/è¿›é˜¶ç©æ³•/"},{"title":"ç«™ç‚¹é…ç½®","date":"2021-06-13T16:29:30.069Z","updated":"2021-06-13T16:29:30.069Z","comments":true,"path":"v4/site-settings/index.html","permalink":"http://iequa.com/v4/site-settings/index.html","excerpt":"","text":"åšå®¢æ ¹ç›®å½•ä¸‹çš„ _config.yml æ–‡ä»¶é€šå¸¸è´Ÿè´£ç«™ç‚¹ç›¸å…³é…ç½®ã€ç¬¬ä¸‰æ–¹ npm æ’ä»¶ç›¸å…³çš„é…ç½®ã€‚ ç½‘ç«™æ ‡é¢˜blog/_config.yml# ç½‘ç«™æ ‡é¢˜title: my blog ç½‘ç«™å›¾æ ‡ç®€å•æ–¹å¼å®Œå…¨è‡ªå®šä¹‰blog/_config.yml# ç½‘ç«™å›¾æ ‡ï¼Œæ›´å¤šå°ºå¯¸ç­‰å›¾æ ‡è¯·ä½¿ç”¨importæ–¹å¼æ‰¹é‡å¯¼å…¥favicon: https://cdn.jsdelivr.net/gh/xaoxuu/assets@master/favicon/favicon.icoblog/_config.ymlimport: meta: - &lt;meta name=&quot;msapplication-TileColor&quot; content=&quot;#ffffff&quot;&gt; - &lt;meta name=&quot;msapplication-config&quot; content=&quot;https://cdn.jsdelivr.net/gh/volantis-x/cdn-org/blog/favicon/browserconfig.xml&quot;&gt; - &lt;meta name=&quot;theme-color&quot; content=&quot;#ffffff&quot;&gt; link: - &lt;link rel=&quot;apple-touch-icon&quot; sizes=&quot;180x180&quot; href=&quot;https://cdn.jsdelivr.net/gh/volantis-x/cdn-org/blog/favicon/apple-touch-icon.png&quot;&gt; - &lt;link rel=&quot;icon&quot; type=&quot;image/png&quot; sizes=&quot;32x32&quot; href=&quot;https://cdn.jsdelivr.net/gh/volantis-x/cdn-org/blog/favicon/favicon-32x32.png&quot;&gt; - &lt;link rel=&quot;icon&quot; type=&quot;image/png&quot; sizes=&quot;16x16&quot; href=&quot;https://cdn.jsdelivr.net/gh/volantis-x/cdn-org/blog/favicon/favicon-16x16.png&quot;&gt; - &lt;link rel=&quot;manifest&quot; href=&quot;https://cdn.jsdelivr.net/gh/volantis-x/cdn-org/blog/favicon/site.webmanifest&quot;&gt; - &lt;link rel=&quot;mask-icon&quot; href=&quot;https://cdn.jsdelivr.net/gh/volantis-x/cdn-org/blog/favicon/safari-pinned-tab.svg&quot; color=&quot;#5bbad5&quot;&gt; - &lt;link rel=&quot;shortcut icon&quot; href=&quot;https://cdn.jsdelivr.net/gh/volantis-x/cdn-org/blog/favicon/favicon.ico&quot;&gt; å¤šè¯­è¨€è®¾ç½®blog/_config.ymllanguage: - zh-CN - en - zh-HK - zh-TW å¯¹åº”çš„ç¿»è¯‘æ–‡ä»¶è·¯å¾„ï¼š themes/volantis/languages/ ä½¿ç”¨ Import å¯¼å…¥å¤–éƒ¨æ–‡ä»¶Volantis ç”¨æˆ·å¯ä»¥åœ¨ä¸ä¿®æ”¹ä¸»é¢˜æ–‡ä»¶çš„æƒ…å†µä¸‹å‘ head å’Œ body ä¸­æ·»åŠ å„ç§æ ‡ç­¾ã€‚meta å’Œ link å¯¹åº” head ä¸­çš„ &lt;meta&gt; å’Œ &lt;link&gt; æ ‡ç­¾ã€‚script å¯ä»¥åœ¨ body æœ«å°¾å¯¼å…¥ js ä»£ç ã€‚ blog/_config.ymlimport: meta: - &lt;meta name=&quot;msapplication-TileColor&quot; content=&quot;#ffffff&quot;&gt; - &lt;meta name=&quot;msapplication-config&quot; content=&quot;https://cdn.jsdelivr.net/gh/volantis-x/cdn-org/blog/favicon/browserconfig.xml&quot;&gt; - &lt;meta name=&quot;theme-color&quot; content=&quot;#ffffff&quot;&gt; link: - &lt;link rel=&quot;apple-touch-icon&quot; sizes=&quot;180x180&quot; href=&quot;https://cdn.jsdelivr.net/gh/volantis-x/cdn-org/blog/favicon/apple-touch-icon.png&quot;&gt; - &lt;link rel=&quot;icon&quot; type=&quot;image/png&quot; sizes=&quot;32x32&quot; href=&quot;https://cdn.jsdelivr.net/gh/volantis-x/cdn-org/blog/favicon/favicon-32x32.png&quot;&gt; - &lt;link rel=&quot;icon&quot; type=&quot;image/png&quot; sizes=&quot;16x16&quot; href=&quot;https://cdn.jsdelivr.net/gh/volantis-x/cdn-org/blog/favicon/favicon-16x16.png&quot;&gt; - &lt;link rel=&quot;manifest&quot; href=&quot;https://cdn.jsdelivr.net/gh/volantis-x/cdn-org/blog/favicon/site.webmanifest&quot;&gt; - &lt;link rel=&quot;mask-icon&quot; href=&quot;https://cdn.jsdelivr.net/gh/volantis-x/cdn-org/blog/favicon/safari-pinned-tab.svg&quot; color=&quot;#5bbad5&quot;&gt; - &lt;link rel=&quot;shortcut icon&quot; href=&quot;https://cdn.jsdelivr.net/gh/volantis-x/cdn-org/blog/favicon/favicon.ico&quot;&gt; script: - &lt;script&gt;&lt;/script&gt; æ›´å¤šHexo å®˜æ–¹æ–‡æ¡£ #é…ç½®https://hexo.io/zh-cn/docs/configuration"},{"title":"é¡µé¢é…ç½®","date":"2021-06-13T16:29:30.068Z","updated":"2021-06-13T16:29:30.068Z","comments":true,"path":"v4/page-settings/index.html","permalink":"http://iequa.com/v4/page-settings/index.html","excerpt":"","text":"é¡µé¢å¸ƒå±€æ¨¡æ¿å¸ƒå±€æ¨¡æ¿ å–å€¼ å«ä¹‰ page ç‹¬ç«‹é¡µé¢ post æ–‡ç« é¡µé¢ docs æ–‡æ¡£é¡µé¢ category åˆ†ç±»é¡µé¢ tag æ ‡ç­¾é¡µé¢ friends å‹é“¾é¡µé¢ list åˆ—è¡¨é¡µé¢ page &amp; post &amp; docsè¿™ä¸‰ç§é¡µé¢ç›¸åŒï¼Œä½†æ˜¯æœ‰ä»¥ä¸‹ç»†å¾®åŒºåˆ«ï¼š post æ–‡ç« æœ‰ title æ—¶ï¼Œå‘ä¸‹æ»šåŠ¨ç½‘é¡µï¼Œå¯¼èˆªæ ä¼šå‘ä¸Šç§»å‡ºå±å¹•æ˜¾å‡ºæ–‡ç« æ ‡é¢˜ï¼Œè€Œ page å’Œ docs ä¸ä¼šã€‚ post æ–‡ç« æœ«å°¾æœ€å¤šå¯ä»¥æ˜¾ç¤ºã€Œå‚è€ƒèµ„æ–™ã€ã€ã€Œç›¸å…³æ–‡ç« ã€ã€ã€Œç‰ˆæƒæ ‡è¯†ã€ã€ã€Œæ‰“èµã€å››ä¸ªæ¨¡å—ã€‚ docs æ–‡ç« æœ«å°¾æœ€å¤šå¯ä»¥æ˜¾ç¤ºã€Œå‚è€ƒèµ„æ–™ã€ä¸€ä¸ªæ¨¡å—ã€‚ é™¤äº†å½’æ¡£é¡µé¢æ˜¯è‡ªåŠ¨ç”Ÿæˆçš„ï¼Œå…¶å®ƒç‹¬ç«‹é¡µé¢éƒ½éœ€è¦æ‰‹åŠ¨åˆ›å»º md æ–‡ä»¶ã€‚ å½’æ¡£é¡µé¢å½’æ¡£é¡µé¢æ˜¯è‡ªåŠ¨ç”Ÿæˆçš„ï¼Œå¹¶ä¸”åˆå§‹åŒ–çš„æ—¶å€™å·²ç»ç”Ÿæˆï¼Œè·¯å¾„å¦‚ä¸‹ï¼š blog/_config.yml# Directoryarchive_dir: archives å…³äºé¡µé¢Create file if not exists: source/about/index.md---layout: docsseo_title: å…³äºbottom_meta: falsesidebar: []valine: placeholder: æœ‰ä»€ä¹ˆæƒ³å¯¹æˆ‘è¯´çš„å‘¢ï¼Ÿ---ä¸‹é¢å†™å…³äºè‡ªå·±çš„å†…å®¹ åˆ†ç±»é¡µé¢Create file if not exists: source/categories/index.md---layout: categoryindex: truetitle: æ‰€æœ‰åˆ†ç±»--- æ ‡ç­¾é¡µé¢Create file if not exists: source/tags/index.md---layout: tagindex: truetitle: æ‰€æœ‰æ ‡ç­¾--- åˆ—è¡¨é¡µé¢Create file if not exists: source/mylist/index.md---layout: listgroup: mylistindex: true--- ç»“æœå°±æ˜¯ç­›é€‰å‡ºæ‰€æœ‰æ–‡ç« ä¸­ front-matter éƒ¨åˆ†å«æœ‰ group: mylist çš„æ–‡ç« ã€‚ å‹é“¾é¡µé¢åˆ›å»ºé¡µé¢æ–‡ä»¶Create file if not exists: source/friends/index.md---layout: friends # å¿…é¡»title: æˆ‘çš„æœ‹å‹ä»¬ # å¯é€‰ï¼Œè¿™æ˜¯å‹é“¾é¡µçš„æ ‡é¢˜---è¿™é‡Œå†™å‹é“¾ä¸Šæ–¹çš„å†…å®¹ã€‚&lt;!-- more --&gt;è¿™é‡Œå¯ä»¥å†™å‹é“¾é¡µé¢ä¸‹æ–¹çš„æ–‡å­—å¤‡æ³¨ï¼Œä¾‹å¦‚è‡ªå·±çš„å‹é“¾è§„èŒƒã€ç¤ºä¾‹ç­‰ã€‚ é€‰æ‹©å¸ƒå±€æ–¹æ¡ˆåœ¨ä¸»é¢˜é…ç½®æ–‡ä»¶ä¸­æ‰¾åˆ°ä»¥ä¸‹å†…å®¹ï¼š pages: # å‹é“¾é¡µé¢é…ç½® friends: layout_scheme: traditional # simple: ç®€å•å¸ƒå±€, traditional: ä¼ ç»Ÿå¸ƒå±€, sites: ç½‘ç«™å¡ç‰‡å¸ƒå±€ ç›®å‰æä¾›ä¸‰ç§å¸ƒå±€æ–¹æ¡ˆï¼š simple: ç®€å•å¸ƒå±€ï¼Œåªæœ‰å¤´åƒå’Œæ ‡é¢˜ã€‚ traditional: ä¼ ç»Ÿå¸ƒå±€ï¼Œæ˜¯ Volantis æ—§ç‰ˆæœ¬çš„é£æ ¼ã€‚ sites: ç½‘ç«™å¡ç‰‡å¸ƒå±€ï¼Œæ˜¯ Volantis 4.x æ–°å¢çš„ç½‘ç«™å¡ç‰‡æ ‡ç­¾çš„æ ·å¼ã€‚ è®¾ç½®æ•°æ®æºé™æ€æ•°æ®æºåŠ¨æ€æ•°æ®æºå‹é“¾çš„æ•°æ®æºå†™åœ¨ä»¥ä¸‹è·¯å¾„ï¼Œå¦‚æœæ²¡æœ‰è¯·è‡ªè¡Œåˆ›å»ºï¼šblog/source/_data/friends.ymlå†…å®¹æ ¼å¼ä¸ºï¼šblog/source/_data/friends.yml- group: # åˆ†ç»„æ ‡é¢˜ description: # åˆ†ç»„æè¿° items: - title: # åç§° avatar: # å¤´åƒ url: # é“¾æ¥ screenshot: # æˆªå›¾ keywords: # å…³é”®è¯ description: # æè¿° - title: # åç§° avatar: # å¤´åƒ url: # é“¾æ¥ screenshot: # æˆªå›¾ keywords: # å…³é”®è¯ description: # æè¿° ä¸åŒçš„å¸ƒå±€æ–¹å¼ï¼Œä¼šç”¨åˆ°ä¸€éƒ¨åˆ†çš„å­—æ®µï¼Œä¸€èˆ¬æ¥è¯´ï¼Œtitleã€avatar å’Œ url éƒ½æ˜¯å¿…é¡»çš„ã€‚è¿™äº›æ•°æ®è¢«è½¬æˆ HTML æ ‡ç­¾æ’å…¥åˆ°å‹é“¾é¡µé¢çš„ &lt;!-- more --&gt; éƒ¨åˆ†ã€‚ä½¿ç”¨ issues æ ‡ç­¾å¯ä»¥ä» issues ä¸­è·å– JSON æ•°æ®è§£æå¹¶ç”Ÿæˆ HTML å¡«å……åˆ°é¡µé¢ä¸­ï¼Œä½¿ç”¨æ–¹æ³•å¦‚ä¸‹ï¼š &#123;% issues sites | api=https://api.github.com/repos/xaoxuu/friends/issues?sort=updated&amp;state=open&amp;page=1&amp;per_page=100&amp;labels=active %&#125; è¿™æ ·æ·»åŠ å‹é“¾çš„æ–¹å¼å°±å˜æˆäº†ï¼šå¯¹æ–¹æ Issue ï¼Œè‡ªå·±å®¡æ ¸ï¼Œç„¶åæ·»åŠ  active æ ‡ç­¾ï¼Œç„¶ååˆ·æ–°ç½‘é¡µå°±ç”Ÿæ•ˆäº†ã€‚æ›´æ–°å‹é“¾å†…å®¹ä¹Ÿå˜å¾—ååˆ†æ–¹ä¾¿ï¼Œ Issue çš„åˆ›å»ºè€…æ‹¥æœ‰ä¿®æ”¹å’Œå…³é—­çš„æƒé™ã€‚ æ–°å»ºä¸€ä¸ª GitHub æˆ–è€… Gitee ä»“åº“ï¼Œåˆ›å»º Issues æ¨¡æ¿ï¼Œå¦‚ä¸‹ï¼š &#123; &quot;title&quot;: &quot;&quot;, &quot;screenshot&quot;: &quot;&quot;, &quot;url&quot;: &quot;&quot;, &quot;avatar&quot;: &quot;&quot;, &quot;description&quot;: &quot;&quot;, &quot;keywords&quot;: &quot;&quot;&#125; å…³äºå¦‚ä½•ä½¿ç”¨ issues æ ‡ç­¾ï¼Œè¯¦è§è¿™ç¯‡æ–‡ç« ï¼š é™æ€åšå®¢ä½¿ç”¨ Issues API å‘å¸ƒåŠ¨æ€ã€å‹é“¾ã€ä¹¦ç­¾https://xaoxuu.com/blog/2020-08-23-issues-api/ å»ºè®®ä¸¤è€…æ˜¯å¯ä»¥åŒæ—¶ä½¿ç”¨çš„å“¦ï¼Œå»ºè®®å¼€æ”¾ issues å‹é“¾ç»™å¤§å®¶ï¼Œå¸¸è”ç³»çš„è‡ªå·±å†ä¿å­˜åˆ°é™æ€å‹é“¾ã€‚å®æµ‹ GitHub API é€Ÿåº¦å’Œç¨³å®šæ€§ä¸å¦‚ Gitee ï¼Œå¦‚æœè¿½æ±‚ç¨³å®šå»ºè®®ä½¿ç”¨ Giteeã€‚ 404é¡µé¢Create file if not exists: source/404.md---cover: truerobots: noindex,nofollowsitemap: falseseo_title: 404 Not Foundbottom_meta: falsesidebar: []valine: path: /404.html placeholder: è¯·ç•™è¨€å‘Šè¯‰æˆ‘æ‚¨è¦è®¿é—®å“ªä¸ªé¡µé¢æ‰¾ä¸åˆ°äº†---&#123;% p logo center huge, 404 %&#125;&#123;% p center bold, å¾ˆæŠ±æ­‰ï¼Œæ‚¨è®¿é—®çš„é¡µé¢ä¸å­˜åœ¨ %&#125;&#123;% p center small, å¯èƒ½æ˜¯è¾“å…¥åœ°å€æœ‰è¯¯æˆ–è¯¥åœ°å€å·²è¢«åˆ é™¤ %&#125; front-matterfront-matter æ˜¯æ–‡ä»¶æœ€ä¸Šæ–¹ä»¥ --- åˆ†éš”çš„åŒºåŸŸï¼Œç”¨äºæŒ‡å®šä¸ªåˆ«æ–‡ä»¶çš„å˜é‡ã€‚æ›´å¤šè¯·è§ Hexo å®˜æ–¹æ–‡æ¡£ï¼š#front-matter å­—æ®µ å«ä¹‰ å€¼ç±»å‹ é»˜è®¤å€¼ layout å¸ƒå±€æ¨¡ç‰ˆ String - title é¡µé¢æ ‡é¢˜ String - seo_title ç½‘é¡µæ ‡é¢˜ String page.title short_title é¡µé¢æ ‡é¢˜ï¼ˆåœ¨groupåˆ—è¡¨ä¸­æ˜¾ç¤ºï¼‰ String page.title date åˆ›å»ºæ—¶é—´ Date æ–‡ä»¶åˆ›å»ºæ—¶é—´ updated æ›´æ–°æ—¥æœŸ Date æ–‡ä»¶ä¿®æ”¹æ—¶é—´ link å¤–éƒ¨æ–‡ç« ç½‘å€ String - music å†…éƒ¨éŸ³ä¹æ§ä»¶ [Object] - robots robots String - keywords é¡µé¢å…³é”®è¯ String - description é¡µé¢æè¿°ã€æ‘˜è¦ String - cover æ˜¯å¦æ˜¾ç¤ºå°é¢ Bool true top_meta æ˜¯å¦æ˜¾ç¤ºæ–‡ç« æˆ–é¡µé¢é¡¶éƒ¨çš„metaä¿¡æ¯ Bool true bottom_meta æ˜¯å¦æ˜¾ç¤ºæ–‡ç« æˆ–é¡µé¢åº•éƒ¨çš„metaä¿¡æ¯ Bool true sidebar é¡µé¢ä¾§è¾¹æ  Bool, Array theme.layout.*.sidebar body é¡µé¢ä¸»ä½“å…ƒç´  Array theme.layout.on_page.body mathjax æ˜¯å¦æ¸²æŸ“å…¬å¼ Bool, String false thumbnail ç¼©ç•¥å›¾ String false icons å›¾æ ‡ Array [] pin æ˜¯å¦ç½®é¡¶ Bool false headimg æ–‡ç« å¤´å›¾ url - layout:post æ—¶ç‰¹æœ‰çš„å­—æ®µï¼š å­—æ®µ å«ä¹‰ å€¼ç±»å‹ é»˜è®¤å€¼ author æ–‡ç« ä½œè€… [Object] config.author categories åˆ†ç±» String, Array - tags æ ‡ç­¾ String, Array - toc æ˜¯å¦ç”Ÿæˆç›®å½• Bool true music å­—æ®µ æ˜¯å¦å¿…é¡» å€¼ç±»å‹ server æ˜¯ netease, tencent, kugou, xiami, baidu type æ˜¯ song, playlist, album, search, artist id æ˜¯ song id / playlist id / album id / search keyword æ–‡ç« ç½®é¡¶åœ¨ front-matter ä¸­è®¾ç½®ä»¥ä¸‹å€¼ï¼šfront-matterpin: true æ–‡ç« åˆ†ç±»å¤šä¸ªåˆ†ç±»æœ‰ä¸¤ç§å…³ç³»ï¼Œä¸€ç§æ˜¯å±‚çº§ï¼ˆç­‰åŒäºæ–‡ä»¶å¤¹ï¼‰ï¼Œä¸€ç§æ˜¯å¹¶åˆ—ï¼ˆç­‰åŒäºæ ‡ç­¾ï¼‰ã€‚ å¤šçº§åˆ†ç±»ï¼šfront-matter---categories: [åˆ†ç±»A, åˆ†ç±»B]---æˆ–è€… front-matter---categories: - åˆ†ç±»A - åˆ†ç±»B--- å¹¶åˆ—åˆ†ç±» front-mattercategories: - [åˆ†ç±»A] - [åˆ†ç±»B] å¤šçº§+å¹¶åˆ—åˆ†ç±» front-mattercategories: - [åˆ†ç±»A, åˆ†ç±»B] - [åˆ†ç±»C, åˆ†ç±»D] æ–‡ç« æ‘˜è¦åœ¨æ–‡ç« ä¸­æ’å…¥ &lt;!-- more --&gt;ï¼Œå‰é¢çš„éƒ¨åˆ†å³ä¸ºæ‘˜è¦ã€‚ æŸç¯‡æ–‡ç« æºç ---title: xxxdate: 2020-02-21---è¿™æ˜¯æ‘˜è¦&lt;!-- more --&gt;è¿™æ˜¯æ­£æ–‡ æ³¨æ„ï¼š &lt;!-- more --&gt; å‰åä¸€å®šè¦æœ‰ç©ºè¡Œï¼Œä¸ç„¶å¯èƒ½å¯¼è‡´æ˜¾ç¤ºé”™ä½ã€‚ è®¾ç½®æ–‡ç« ä½œè€…Volantis æ”¯æŒå¤šä¸ªä½œè€…åœ¨ä¸€ä¸ªç«™ç‚¹å‘å¸ƒæ–‡ç« ï¼Œå…¶ä»–ä½œè€…ä¿¡æ¯éœ€è¦å†™åœ¨æ•°æ®æ–‡ä»¶ä¸­ï¼Œä¾‹å¦‚ï¼š blog/source/_data/author.ymlJon: name: Jon Snow avatar: https://cn.bing.com/th?id=AMMS_fc8f99fd41ebd737a71c4e13806db9a0&amp;w=110&amp;h=110&amp;c=7&amp;rs=1&amp;qlt=80&amp;pcl=f9f9f9&amp;cdv=1&amp;dpr=2&amp;pid=16.1 url: https://gameofthrones.fandom.com/wiki/Jon_SnowDany: name: Daenerys Targaryen avatar: https://tse1-mm.cn.bing.net/th?id=OIP.Yax4wLzIFbcBVUa_RsKywQHaLH&amp;w=80&amp;h=80&amp;c=8&amp;rs=1&amp;qlt=90&amp;dpr=2&amp;pid=3.1&amp;rm=2 url: https://gameofthrones.fandom.com/wiki/Daenerys_Targaryen åœ¨æ–‡ç« çš„ front-matter ä¸­æ–°å¢ author å³å¯ï¼š front-matter---title: Jon Snow | Game of Thrones Wiki | Fandomauthor: Jon--- å¼•å…¥å¤–éƒ¨æ–‡ç« åˆ©ç”¨ linkï¼Œæ­é…è‡ªå®šä¹‰çš„æ–‡ç« ä½œè€…ä¿¡æ¯ï¼Œä½ å¯ä»¥åœ¨æ–‡ç« åˆ—è¡¨ä¸­æ˜¾ç¤ºå¤–éƒ¨æ–‡ç« æˆ–è€…ç½‘å€ï¼Œä¾‹å¦‚ï¼š blog/source/_data/author.ymlxaoxuu: name: xaoxuu avatar: https://cdn.jsdelivr.net/gh/xaoxuu/assets@master/avatar/avatar.png url: https://xaoxuu.com front-matter---layout: postdate: 2017-07-05title: [è½¬]å¦‚ä½•æ­å»ºåŸºäºHexoçš„ç‹¬ç«‹åšå®¢categories: [Dev, Hexo]tags: - Hexoauthor: xaoxuulink: https://xaoxuu.com/blog/2017-07-05-hexo-blog/---![](https://img.vim-cn.com/d9/a9af7dc49fc0af8ca3e6dd2450a2f7095a87db.png) ç½®é¡¶å¯¹äºä»»ä½•æ–‡ç« æˆ–è€…é¡µé¢ï¼Œè®¾ç½® pin: true å³å¯ç½®é¡¶åœ¨é¦–é¡µã€‚ front-matter---pin: true--- è¿™ä¼šå¯¼è‡´ä¸€ä¸ªå°é—®é¢˜ï¼šé¦–é¡µ post å¡ç‰‡æ•°é‡å¤šäºè®¾å®šå€¼ï¼Œå¦‚æœæœ‰å¼ºè¿«ç—‡å¸Œæœ›æ¯ä¸€ä¸ªåˆ†é¡µæ•°é‡ä¸€è‡´ï¼Œå¯ä»¥å®‰è£…æ’ä»¶æ¥å®ç°ï¼Œè¯¦è§ï¼š#421 ä¸å½’æ¡£å­˜æ”¾åœ¨ _posts æ–‡ä»¶å¤¹ä¸‹çš„æ–‡ç« ä¸€èˆ¬éƒ½ä¼šå‡ºç°åœ¨å½’æ¡£é¡µï¼Œå¦‚æœæŸç¯‡æ–‡ç« ä¸å¸Œæœ›å‡ºç°åœ¨å½’æ¡£é¡µé¢ï¼š front-matter---archive: false--- é¡µé¢è‡ªå®šä¹‰å¸ƒå±€æ˜¾ç¤ºè¿·ä½ éŸ³ä¹æ’­æ”¾å™¨æ ‡é¢˜å³è¾¹æ˜¾ç¤ºè¿·ä½ éŸ³ä¹æ’­æ”¾å™¨ï¼Œæ”¯æŒçš„å­—æ®µæœ‰ï¼šserverã€typeã€idã€‚ front-matter---music: server: netease # netease, tencent, kugou, xiami, baidu type: song # song, playlist, album, search, artist id: 16846091 # song id / playlist id / album id / search keyword--- å®é™…æ•ˆæœè§ï¼š #contributors æ˜¾ç¤º meta æ ‡ç­¾æ–‡ç« é¡¶éƒ¨å’Œåº•éƒ¨çš„æ—¥æœŸã€åˆ†ç±»ã€æ›´æ–°æ—¥æœŸã€æ ‡ç­¾ã€åˆ†äº«ç­‰å±äº meta æ ‡ç­¾ã€‚ front-matter---top_meta: falsebottom_meta: false--- å¦‚æœä¸€ä¸ªé¡µé¢æ²¡æœ‰ title åˆ™ä¸ä¼šæ˜¾ç¤º top_meta ï¼Œåƒ404ã€å…³äºé¡µé¢å°±å¯ä»¥å®Œå…¨éšè—ï¼š front-matter---seo_title: å…³äºtop_meta: falsebottom_meta: false--- æ ‡é¢˜å³è¾¹æ˜¾ç¤ºç¼©ç•¥å›¾front-matter---thumbnail: https://img.vim-cn.com/17/0c7b02722686d1527a1df807dae0794d995860.png--- ç¼©ç•¥å›¾ä»…åœ¨æ–‡ç« åˆ—è¡¨å’Œæ–‡ç« é¡µé¢æ˜¾ç¤ºï¼Œä¸ä¼šåœ¨å½’æ¡£é¡µé¢æ˜¾ç¤ºã€‚ æ ‡é¢˜å³è¾¹æ˜¾ç¤ºå›¾æ ‡front-matter---icons: [fas fa-fire red, fas fa-star green]--- å›¾æ ‡ä»…åœ¨å½’æ¡£é¡µé¢ä¸­æ˜¾ç¤ºï¼Œå¯ä»¥ç”¨æ¥æ ‡æ³¨çƒ­é—¨æ–‡ç« ã€‚ å¯ä»¥é€šè¿‡ red / blue / green / yellow / orange / theme / accent æ¥è®¾ç½®å›¾æ ‡çš„é¢œè‰² æ˜¯å¦è¦æ˜¾ç¤ºå°é¢å¦‚æœæŸä¸ªé¡µé¢éœ€è¦å°é¢ï¼Œå¯ä»¥è¿™æ ·å†™ï¼šfront-matter---cover: true--- æ˜¾ç¤ºä¾§è¾¹æ é€šè¿‡è‡ªç”±è®¾ç½®è¾¹æ å¡ç‰‡æ¥åˆ å‡å¯¹åº”é¡µé¢çš„å†—ä½™ä¿¡æ¯ï¼Œæé«˜æœ‰ä»·å€¼çš„ä¿¡æ¯åœ¨é¡µé¢ä¸­çš„æƒé‡ã€‚ å¦‚æœæŸä¸ªé¡µé¢ä¸éœ€è¦ä¾§è¾¹æ ï¼Œå¯ä»¥è¿™æ ·å†™ï¼šfront-matter---sidebar: []--- æŸä¸ªé¡µé¢æƒ³æŒ‡å®šæ˜¾ç¤ºæŸå‡ ä¸ªä¾§è¾¹æ ï¼Œå°±è¿™æ ·å†™:front-matter---sidebar: [grid, toc, tags] # æ”¾ç½®ä»»ä½•ä½ æƒ³è¦æ˜¾ç¤ºçš„ä¾§è¾¹æ éƒ¨ä»¶--- å…³é—­è¯„è®ºfront-matter---comments: false--- æ¸²æŸ“å…¬å¼é»˜è®¤æ˜¯ä¸æ¸²æŸ“çš„ï¼Œå¦‚æœæ–‡ç« å†…æœ‰å…¬å¼ï¼Œéœ€è¦åœ¨ front-matter ä¸­è®¾ç½®å¼€å¯ã€‚å³ä¾¿å¼€å¯äº†ï¼Œæ–‡ç« åˆ—è¡¨ä¸­ä¹Ÿä¸ä¼šè¿›è¡Œæ¸²æŸ“ï¼Œè¯·æ³¨æ„ä¸è¦æŠŠå…¬å¼å†™åœ¨æ–‡ç« å¼€å¤´ã€‚ example.md:---title: æ¸²æŸ“å…¬å¼ï¼ˆMathJaxï¼‰date: 2020-02-23mathjax: true # false: ä¸æ¸²æŸ“, true: æ¸²æŸ“---æ·»åŠ ä¸€æ®µæè¿°æ€§æ–‡å­—&lt;!-- more --&gt;$$t+1=2$$$$\\mbox&#123;ç§¯ç´¯å› å­&#125;=\\begin&#123;cases&#125;1+ni &amp; \\mbox&#123;å•åˆ©&#125;\\\\\\\\(1+i)^n &amp; \\mbox&#123;å¤åˆ©&#125;\\end&#123;cases&#125;$$$$\\begin&#123;equation&#125;\\sum_&#123;i=0&#125;^n F_i \\cdot \\phi (H, p_i) - \\sum_&#123;i=1&#125;^n a_i \\cdot ( \\tilde&#123;x_i&#125;, \\tilde&#123;y_i&#125;) + b_i \\cdot ( \\tilde&#123;x_i&#125;^2 , \\tilde&#123;y_i&#125;^2 )\\end&#123;equation&#125;$$$$\\begin&#123;equation&#125;\\beta^*(D) = \\mathop&#123;argmin&#125; \\limits_&#123;\\beta&#125; \\lambda &#123;||\\beta||&#125;^2 + \\sum_&#123;i=1&#125;^n max(0, 1 - y_i f_&#123;\\beta&#125;(x_i))\\end&#123;equation&#125;$$ æŸ¥çœ‹å…¬å¼æ¸²æŸ“æ•ˆæœ t+1=2\\mbox{ç§¯ç´¯å› å­}=\\begin{cases}1+ni & \\mbox{å•åˆ©}\\\\\\\\(1+i)^n & \\mbox{å¤åˆ©}\\end{cases}\\begin{equation}\\sum_{i=0}^n F_i \\cdot \\phi (H, p_i) - \\sum_{i=1}^n a_i \\cdot ( \\tilde{x_i}, \\tilde{y_i}) + b_i \\cdot ( \\tilde{x_i}^2 , \\tilde{y_i}^2 )\\end{equation}\\begin{equation}\\beta^*(D) = \\mathop{argmin} \\limits_{\\beta} \\lambda {||\\beta||}^2 + \\sum_{i=1}^n max(0, 1 - y_i f_{\\beta}(x_i))\\end{equation} å¦‚æœå…¬å¼ä»æ— æ³•æ­£ç¡®æ¸²æŸ“å¯ä»¥é˜…è¯» @MicDZ çš„è¿™ç¯‡æ–‡ç« ï¼š åœ¨Material-Xä¸Šä½¿ç”¨KaTeXhttps://www.micdz.cn/article/katex-on-volantis/"},{"title":"","date":"2021-04-07T08:59:09.087Z","updated":"2021-04-07T08:59:09.087Z","comments":true,"path":"prepare/index.html","permalink":"http://iequa.com/prepare/index.html","excerpt":"","text":"No. desc Flag &nbsp; dictï¼Œlistï¼Œsetå’Œtupleçš„åŒºåˆ«ï¼Ÿåº•å±‚å®ç°æ˜¯hash/list/æ•°ç»„ï¼Ÿ 1. list è¢«å®ç°ä¸ºé•¿åº¦å¯å˜çš„æ•°ç»„ï¼Œæ¯æ¬¡éƒ½ä¼šåˆ†é…ç•¥å¤§çš„å†…å­˜é˜²æ­¢é¢‘ç¹çš„ç”³è¯·åˆ†é…å†…å­˜ï¼Œè¿ç»­çš„ä¸€å—çš„å†…å­˜ 2. tuple æœ¬èº«ä¸ºä¸€ä¸ªç»“æ„ä½“ï¼Œç»“æ„ä½“é‡Œé¢æœ‰ä¸€ä¸ªäºŒçº§æŒ‡é’ˆï¼Œè¿™æ˜¯å¸¸é‡äºŒçº§æŒ‡é’ˆï¼Œå¯ä»¥å½¢æˆä¸€ä¸ªæŒ‡é’ˆæ•°ç»„ 3. set : å…è®¸ç©ºå€¼çš„dict, å¯¹dictæœ‰è¿›è¡Œä¼˜åŒ–ï¼Œåœ¨æ’å…¥å’Œåˆ é™¤å…ƒç´ çš„å¤æ‚åº¦ä¸ºå¸¸æ•°çº§åˆ«ï¼Œæœ€åä¹Ÿæ˜¯O(n) 4. dict åº•å±‚ä½¿ç”¨çš„å“ˆå¸Œè¡¨, å“ˆå¸Œè¡¨å¹³å‡æŸ¥æ‰¾æ—¶é—´å¤æ‚åº¦O(1) &nbsp;&nbsp; dictçš„keyæ˜¯ä¸å¯å˜å¯¹è±¡ï¼Œå› ä¸ºè¦ç¡®ä¿ç»è¿‡hashç®—æ³•ä¹‹åå¾—åˆ°çš„åœ°å€å”¯ä¸€ &nbsp;&nbsp; py3.6+ dictæ˜¯insert orderedï¼ŒåŸæ¥æ˜¯æ ¹æ®hashå€¼,ä¹±åºçš„ï¼Œpopä¸ä¸€å®šæ˜¯æœ€åä¸€ä¸ªæ’å…¥çš„é”®å€¼å¯¹ â &nbsp; å‡½æ•°å®šä¹‰çš„æ—¶å€™å‚æ•°å‰çš„å’Œ*åˆ†åˆ«æ˜¯ä»€ä¹ˆæ„æ€ï¼Œæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ &nbsp;&nbsp; fun(1,2,3,4), tuple 1, (2,3,4) / fun(1,a=2,b=3) dict 1, &#123;a:2, b:3&#125;1. â &nbsp; ç»™å˜é‡aèµ‹å€¼int(1)ï¼Œå†…å­˜å 4å­—èŠ‚ï¼Œåæ¥åˆç»™aèµ‹å€¼str(1)ï¼Œå†…å­˜å 1å­—èŠ‚ã€‚è¯·é—®ä¸¤æ¬¡èµ‹å€¼ä¹‹é—´å‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ pythonæŒ‰å¼•ç”¨èµ‹å€¼å’Œæ·±ã€æµ…æ‹·è´ - [-5,256] å°æ•´æ•°ä¼˜åŒ–ï¼Œ python int å ç”¨ 24~28 å­—èŠ‚, åŠ¨æ€ â &nbsp; ç¼–ç ç±»å‹UTF-8ï¼Œunicodeï¼Œgbkä»»é€‰ä¸¤ç§è¯´ä¸€ä¸‹åŒºåˆ«ï¼Ÿ &nbsp;&nbsp;Unicodeä¸æ˜¯ä¸€ä¸ªæ–°çš„ç¼–ç è§„åˆ™ï¼Œè€Œæ˜¯ä¸€å¥—å­—ç¬¦é›†, Unicode åªæ˜¯ä¸€ä¸ªç¬¦å·é›†ï¼Œå®ƒåªè§„å®šäº†ç¬¦å·çš„äºŒè¿›åˆ¶ä»£ç ï¼Œå´æ²¡æœ‰è§„å®šè¿™ä¸ªäºŒè¿›åˆ¶ä»£ç åº”è¯¥å¦‚ä½•å­˜å‚¨. &nbsp;&nbsp;UTF-8ç¼–ç : ç¼–ç è§„åˆ™å°±æ˜¯UTF-8ã€‚UTF-8é‡‡ç”¨1-4ä¸ªå­—ç¬¦è¿›è¡Œä¼ è¾“å’Œå­˜å‚¨æ•°æ®ï¼Œæ˜¯ä¸€ç§é’ˆå¯¹Unicodeçš„å¯å˜é•¿åº¦å­—ç¬¦ç¼–ç ï¼Œåˆç§°ä¸‡å›½ç . &nbsp;&nbsp; Unicodeç¬¦å·èŒƒå›´ï¼ˆåå…­è¿›åˆ¶ï¼‰, UTF-8ç¼–ç æ–¹å¼(äºŒè¿›åˆ¶) â &nbsp; iså’Œ==çš„åŒºåˆ« ? Answ: is ç”¨äºåˆ¤æ–­ä¸¤ä¸ªå˜é‡æ˜¯å¦å¼•ç”¨,ä¼šå¯¹æ¯”å…¶ä¸­ä¸¤ä¸ªå˜é‡çš„åœ°å€ â &nbsp; é€‰ä¸€ä¸ªmoduleï¼ˆæ¯”å¦‚numpyï¼Œpandasâ€¦â€¦ï¼‰å®ƒçš„æ•´ä½“æ¡†æ¶ï¼Œä¸»è¦åº”ç”¨åœºæ™¯ï¼Œåº•å±‚æ¶æ„ï¼Œï¼ˆä¼˜ç¼ºç‚¹ï¼‰ pd.DataFrame(&#123;&#39;A&#39;:[434,54],&#39;B&#39;:[4,56]&#125;,index = [1,2]) Pandas ä¸»è¦æ•°æ®ç»“æ„æ˜¯ä¸€ç»´æ•°æ®(Series)ã€äºŒç»´æ•°æ®ï¼ˆDataFrameï¼‰ï¼Œè¿™ä¸¤ç§æ•°æ®ç»“æ„èƒ½æ»¡è¶³é‡‘èã€ç»Ÿè®¡ã€ç¤¾ä¼šç­‰é¢†åŸŸä¸­å¤§å¤šå…¸å‹ç”¨ä¾‹ã€‚Pandas æ˜¯åŸºäº NumPy å¼€å‘ï¼Œå¯ä»¥ä¸å…¶å®ƒç¬¬ä¸‰æ–¹è®¡ç®—æ”¯æŒåº“å®Œç¾é›†æˆ. Pandasç¼ºç‚¹ï¼šå¤„ç†å¤§æ•°æ®é›†çš„é€Ÿåº¦éå¸¸æ…¢ã€‚ åœ¨é»˜è®¤è®¾ç½®ä¸‹ï¼ŒPandasåªä½¿ç”¨å•ä¸ªCPUå†…æ ¸ï¼Œåœ¨å•è¿›ç¨‹æ¨¡å¼ä¸‹è¿è¡Œå‡½æ•°ã€‚ 3. Leetcode &nbsp; â€” è¾“å…¥ä¸€ä¸ªæ•°æ®æµï¼ˆå¯ä»¥å…ˆå¯¹æ•°æ®åšé¢„å¤„ç†ï¼Œä»»ä½•é¢„å¤„ç†éƒ½å¯ä»¥ï¼Œåªè¦å¾—åˆ°çš„æ•°æ®å’ŒåŸæ•°æ®æ˜¯ä¸€ä¸€æ˜ å°„å³å¯ï¼Œè€ƒå®˜ä¸¾äº†ä¸€ä¸ªä¾‹å­æ˜¯å¯ä»¥ç”¨æ—¶é—´æˆ³ï¼‰ï¼Œå¯¹æ¯ä¸€ä¸ªå…ƒç´ åˆ¤æ–­æ˜¯å¦ä¹‹å‰å‡ºç°è¿‡ã€‚åœ¨å°½é‡å‡å°å†…å­˜å’Œæ—¶é—´çš„æƒ…å†µä¸‹ï¼Œå¦‚æœè¦æ±‚å®Œå…¨ç²¾ç¡®ï¼Œå¦‚ä½•åšï¼Ÿå¦‚æœå…è®¸å‡ºç°è¯¯å·®ï¼Œå¦‚ä½•åšï¼Œè¯¯å·®å¯ä»¥æ§åˆ¶åœ¨å¤šå°‘èŒƒå›´å†…ï¼Ÿ &nbsp; â€” ä¸¤ä¸ªæœ‰åºæ•°ç»„ï¼Œå¤§å°åˆ†åˆ«æ˜¯må’Œnï¼Œæ±‚æ•´ä½“çš„ä¸­ä½æ•°ï¼Œè¦æ±‚æ—¶é—´å¤æ‚åº¦O(log(m+n)) &nbsp; ç¼–ç¨‹é¢˜ï¼šå¤§æ•°æ±‚å’Œ â def big_data_add(a, b): # 1.å…ˆè·å–ä¸¤ä¸ªä¸­æœ€å¤§çš„é•¿åº¦ï¼Œç„¶åå°†çŸ­è¿›è¡Œè¡¥å……ï¼Œä½¿é•¿åº¦ä¸€è‡´ max_len = len(a) if len(a) &gt; len(b) else len(b) a = a.zfill(max_len) # &quot;abc&quot;.zfill(5) 00abc b = b.zfill(max_len) a = list(a) b = list(b) result = [0 for i in range(max_len+1)] # è¿™é‡ŒåŠ 1ä¸»è¦æ˜¯è€ƒè™‘åˆ°ä¸¤æ•°åŠ èµ·æ¥å¯èƒ½æ¯”ä¹‹å‰çš„æ•°è¿˜å¤šä¸€ä½ for i in range(max_len-1, -1, -1): temp = int(a[i]) + int(b[i]) if temp &gt;= 10: # è¿™é‡Œresultæ˜¯i+1 æ˜¯å› ä¸ºresultçš„é•¿åº¦æ¯”max_lené•¿åº¦é•¿ result[i+1] += temp % 10 result[i] += temp // 10 else: result[i+1] += temp return result 2ä¸ªæœ‰åºæ•°æ®çš„ä¸­ä½æ•°ï¼š 2åˆ†æŸ¥æ‰¾ class Solution: def findMedianSortedArrays(self, nums1: List[int], nums2: List[int]) -&gt; float: def getKthElement(k): &quot;&quot;&quot; - ä¸»è¦æ€è·¯ï¼šè¦æ‰¾åˆ°ç¬¬ k (k&gt;1) å°çš„å…ƒç´ ï¼Œé‚£ä¹ˆå°±å– pivot1 = nums1[k/2-1] å’Œ pivot2 = nums2[k/2-1] è¿›è¡Œæ¯”è¾ƒ - è¿™é‡Œçš„ &quot;/&quot; è¡¨ç¤ºæ•´é™¤ - nums1 ä¸­å°äºç­‰äº pivot1 çš„å…ƒç´ æœ‰ nums1[0 .. k/2-2] å…±è®¡ k/2-1 ä¸ª - nums2 ä¸­å°äºç­‰äº pivot2 çš„å…ƒç´ æœ‰ nums2[0 .. k/2-2] å…±è®¡ k/2-1 ä¸ª - å– pivot = min(pivot1, pivot2)ï¼Œä¸¤ä¸ªæ•°ç»„ä¸­å°äºç­‰äº pivot çš„å…ƒç´ å…±è®¡ä¸ä¼šè¶…è¿‡ (k/2-1) + (k/2-1) &lt;= k-2 ä¸ª - è¿™æ · pivot æœ¬èº«æœ€å¤§ä¹Ÿåªèƒ½æ˜¯ç¬¬ k-1 å°çš„å…ƒç´  - å¦‚æœ pivot = pivot1ï¼Œé‚£ä¹ˆ nums1[0 .. k/2-1] éƒ½ä¸å¯èƒ½æ˜¯ç¬¬ k å°çš„å…ƒç´ ã€‚æŠŠè¿™äº›å…ƒç´ å…¨éƒ¨ &quot;åˆ é™¤&quot;ï¼Œå‰©ä¸‹çš„ä½œä¸ºæ–°çš„ nums1 æ•°ç»„ - å¦‚æœ pivot = pivot2ï¼Œé‚£ä¹ˆ nums2[0 .. k/2-1] éƒ½ä¸å¯èƒ½æ˜¯ç¬¬ k å°çš„å…ƒç´ ã€‚æŠŠè¿™äº›å…ƒç´ å…¨éƒ¨ &quot;åˆ é™¤&quot;ï¼Œå‰©ä¸‹çš„ä½œä¸ºæ–°çš„ nums2 æ•°ç»„ - ç”±äºæˆ‘ä»¬ &quot;åˆ é™¤&quot; äº†ä¸€äº›å…ƒç´ ï¼ˆè¿™äº›å…ƒç´ éƒ½æ¯”ç¬¬ k å°çš„å…ƒç´ è¦å°ï¼‰ï¼Œå› æ­¤éœ€è¦ä¿®æ”¹ k çš„å€¼ï¼Œå‡å»åˆ é™¤çš„æ•°çš„ä¸ªæ•° &quot;&quot;&quot; ix1, ix2 = 0, 0 while True: # ç‰¹æ®Šæƒ…å†µ if ix1 == m: return nums2[ix2 + k - 1] if ix2 == n: return nums1[ix1 + k - 1] if k == 1: return min(nums1[ix1], nums2[ix2]) # æ­£å¸¸æƒ…å†µ newIndex1 = min(ix1 + k // 2 - 1, m - 1) newIndex2 = min(ix2 + k // 2 - 1, n - 1) pivot1, pivot2 = nums1[newIndex1], nums2[newIndex2] if pivot1 &lt;= pivot2: k = k - (newIndex1 - ix1 + 1) ix1 = newIndex1 + 1 else: k = k - (newIndex2 - ix2 + 1) ix2 = newIndex2 + 1 m, n = len(nums1), len(nums2) totalLength = m + n if totalLength % 2 == 1: return getKthElement((totalLength + 1) // 2) else: return (getKthElement(totalLength // 2) + getKthElement(totalLength // 2 + 1)) / 2 No. desc Flag 0. å®¢æˆ·ä¿¡æ¯è¡¨ã€åˆåŒä¿¡æ¯è¡¨å’Œè¿˜æ¬¾è®¡åˆ’è¡¨åˆ†åˆ«æ˜¯ä»€ä¹ˆï¼Ÿç©ä¸é€è€æ¿ä¼šæ€€ç–‘æˆ‘çš„èƒ½åŠ›ï¼Ÿ 0. å­—èŠ‚è·³åŠ¨-æ•°æ®ä»“åº“é«˜çº§å·¥ç¨‹å¸ˆé¢è¯• 0. å¤§æ•°æ®å¸¸è§é¢è¯•é¢˜ä¹‹spark sql 1. 2020 BATå¤§å‚æ•°æ®åˆ†æé¢è¯•ç»éªŒï¼šâ€œé«˜é¢‘é¢ç»â€ä¹‹æ•°æ®åˆ†æç¯‡ 2. 2020å¹´å¤§å‚é¢è¯•é¢˜-æ•°æ®ä»“åº“ç¯‡ 1.æ‰‹å†™â€è¿ç»­æ´»è·ƒç™»é™†â€ç­‰ç±»ä¼¼åœºæ™¯çš„sql - å¥½é¢˜ç›® âœ”ï¸ 3. æ•°ä»“å¤§æ³•å¥½ï¼è·¨å¢ƒç”µå•† Shopee çš„å®æ—¶æ•°ä»“ä¹‹è·¯ â 4. ã€æ•°ä»“é¢è¯•é¢˜ã€‘ä½¿ç”¨Hiveçª—å£å‡½æ•°æ›¿æ¢union allå¤„ç†åˆ†ç»„æ±‡æ€»ï¼ˆå°è®¡ï¼Œæ€»è®¡ï¼‰ 5. å­—èŠ‚è·³åŠ¨æ•°ä»“é¢è¯• ä¸‰é“é¢˜-JAVAç¼–ç¨‹+hiveçª—å£ 6. ç»å…¸sqlé¢˜ç›®ï¼ˆä½¿ç”¨çª—å£å‡½æ•°è§£å†³ï¼‰ Hive åˆ†æå‡½æ•°leadã€lagå®ä¾‹åº”ç”¨ æ‰‹å†™â€è¿ç»­æ´»è·ƒç™»é™†â€ç­‰ç±»ä¼¼åœºæ™¯çš„sql select * from ( select user_id, date_id, lead(date_id, 1) over(partition by user_id order by date_id) as last_date_id # lead å‚æ•°1ä¸ºåˆ—åï¼Œå‚æ•°2ä¸ºå¾€ä¸‹ç¬¬nè¡Œï¼ˆå¯é€‰ï¼Œé»˜è®¤ä¸º1) from ( select user_id, date_id from wedw_dw.tmp_log where date_id &gt;= &#x27;2020-08-10&#x27; and user_id is not null and length(user_id)&gt; 0 group by user_id, date_id order by user_id, date_id ) t ) t1where datediff(last_date_id,date_id)=1 å¤§æ•°æ®ç ”å‘å·¥ç¨‹å¸ˆ No. desc Flag &nbsp; å¤§æ•°æ®ç ”å‘å·¥ç¨‹å¸ˆï¼ˆä¸¤å¹´ï¼‰å­—èŠ‚è·³åŠ¨é¢ç» 1. æ•°æ®ä¸ä¸€è‡´æœ‰æ²¡æœ‰é‡åˆ°è¿‡ï¼Œæ€ä¹ˆè§£å†³çš„? &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; å›ç­”ï¼š 1. æŒ‡æ ‡ä½“ç³»,æ•°ä»“ 2. è§„åˆ™å¼•æ“ï¼Œå¤ç”¨é€»è¾‘ 2. ä¸€é“sqlçš„é¢˜ï¼Œä¸€å¼ è¡¨ï¼Œç”¨æˆ·idå’Œç™»å½•æ—¥æœŸï¼ŒæŸ¥æ‰¾è¿ç»­ä¸¤å¤©ç™»é™†çš„ç”¨æˆ· &nbsp;&nbsp; and (a.pdate = date_sub(b.pdate,1) or a.pdate = date_add(b.pdate,1)) 3. æ€ä¹ˆå®šä½æ€§èƒ½é—®é¢˜å¯¹åº”çš„æ˜¯å“ªæ®µsql? 1. spark driver log çœ‹ æ‰§è¡Œæ…¢çš„stageï¼ˆ99%ï¼‰ 2. spark ui ä¸Šçœ‹ è¯¥stage çš„task æ‰§è¡Œå®Œæˆæ¯”ç‡ 3. spark ui ä¸Šçœ‹ è¯¥stage å¯¹åº”çš„ continer id å’Œ æ‰€å±job 4. spark ui ä¸Šçœ‹ sql çš„æ‰§è¡Œè®¡åˆ’ å’Œ æ‰§è¡Œè®¡åˆ’å›¾ï¼Œæœ€ç»ˆå®šä½åˆ°æ˜¯å“ªæ®µsql â 4. é‡åˆ°sparkæ€§èƒ½é—®é¢˜æ€ä¹ˆè§£å†³çš„ï¼Ÿ &nbsp;&nbsp;&nbsp;&nbsp; 1. æäº¤å‚æ•° 2. å¼€å‘è°ƒä¼˜ 3. Shuffleè°ƒä¼˜ 4. å°æ–‡ä»¶ 5. 121. ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœº I &nbsp;&nbsp;&nbsp;&nbsp; maxprofit = max(price - minprice, maxprofit), minprice = min(price, minprice) 122. ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœº II, è´ªå¿ƒ: tmp = prices[i] - prices[i - 1], if tmp &gt; 0: profit += tmp DPï¼š dp[i][0] = max(dp[i-1][0], dp[i-1][1]+prices[i]) &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dp[i][1] = max(dp[i-1][1], dp[i-1][0]-prices[i]) 6. linux æ±‚ä¸€ä¸ªæ–‡ä»¶å‡ºç°æŸä¸ªå•è¯çš„è¡Œæ•° linuxåšå®Œç”¨sparkå†™ &nbsp;&nbsp;spark: long numAs = logData.filter(s -&gt; s.contains(â€œaâ€)).count(); 7. cacheå’Œpersisit çš„åŒºåˆ«? cacheåªæœ‰ä¸€ä¸ªé»˜è®¤çš„ç¼“å­˜çº§åˆ«MEMORY_ONLYï¼Œå³å°†æ•°æ®æŒä¹…åŒ–åˆ°å†…å­˜ä¸­. persistå¯ä»¥é€šè¿‡ä¼ é€’ä¸€ä¸ª StorageLevel å¯¹è±¡æ¥è®¾ç½®ç¼“å­˜çš„å­˜å‚¨çº§åˆ«. â 8. æœ‰ä¼˜åŒ–è¿‡Sparkæ‰§è¡Œæ€§èƒ½å—ï¼Œæ€ä¹ˆä¼˜åŒ–çš„, è¶…å…¨sparkæ€§èƒ½ä¼˜åŒ–æ€»ç»“ 9. spark on service ç”¨è¿‡å—ï¼Œ spark contextæœ‰é€€å‡ºçš„é—®é¢˜é‡åˆ°è¿‡å—ï¼Ÿ è¿™ä¸ªçŸ¥é“æ²¡ç”¨è¿‡ï¼Œæ‰€ä»¥æ²¡ç­”å‡ºæ¥ï¼Œä¸è¿‡é€šè¿‡è¿™ä¸ªé—®é¢˜èƒ½çœ‹å‡ºæ¥å­—èŠ‚å¤§ä½¬è¿˜çœŸæŒºå‰å®³çš„ï¼Œä¸‰é¢é¢è¯•å®˜å¯¹æŠ€æœ¯éƒ½è¿™ä¹ˆäº†è§£ 10. spark dataframeæ¯”rddæ€§èƒ½å¥½ï¼Œä¸ºå•¥? DataFrameè¿è¡Œæ•ˆç‡ä¼˜äºRDDï¼Œå› ä¸ºå®ƒè§„å®šäº†å…·ä½“çš„ç»“æ„å¯¹æ•°æ®åŠ ä»¥çº¦æŸ. ç”±äºDataFrameå…·æœ‰å®šä¹‰å¥½çš„ç»“æ„, Sparkå¯ä»¥åœ¨ä½œä¸šè¿è¡Œæ—¶åº”ç”¨è®¸å¤šæ€§èƒ½å¢å¼ºçš„æ–¹æ³•. å¦‚æœä½ èƒ½å¤Ÿä½¿ç”¨RDDå®Œç¾åœ°ç¼–å†™ç¨‹åºï¼Œä¹Ÿå¯ä»¥é€šè¿‡RDDå®ç°ç›¸åŒçš„æ€§èƒ½. Spark SQLçš„æ ¸å¿ƒæ˜¯Catalystä¼˜åŒ–å™¨ï¼Œå®ƒä»¥ä¸€ç§æ–°é¢–çš„æ–¹å¼åˆ©ç”¨é«˜çº§ç¼–ç¨‹è¯­è¨€åŠŸèƒ½ï¼ˆä¾‹å¦‚Scalaçš„æ¨¡å¼åŒ¹é…å’Œquasiquotesï¼‰æ¥æ„å»ºå¯æ‰©å±•çš„æŸ¥è¯¢ä¼˜åŒ–å™¨, å®ƒå¾ˆå®¹æ˜“æ·»åŠ ä¼˜åŒ–è§„åˆ™ 11. å †å¤–å†…å­˜æ˜¯å¹²ä»€ä¹ˆç”¨çš„ nettyã€‚ç»“ç‚¹ç›´æ¥äº¤äº’æ•°æ®ï¼Œspark æœ€æ–°feature å¼ƒç”¨jvmï¼Œç›´æ¥c++è°ƒç”¨å†…å­˜ï¼Œéƒ½æ˜¯å †å¤–, Spark 2.x æ‰§è¡Œå†…å­˜å’Œå­˜å‚¨å†…å­˜ ç›¸äº’ä¹‹é—´ èƒ½ å ç”¨ 1. (executorå†…å­˜) JVM å†…éƒ¨ çš„ On-heap Memory ï¼ˆå¯¹äºJVMæ¥è¯´å«åš å †å†…å­˜ï¼‰ 2. (executorå¤–éƒ¨) JVM å¤–éƒ¨/æ“ä½œç³»ç»Ÿ çš„ Off-heap Memory 12. çŸ¥é“ä»€ä¹ˆæ˜¯ whole stage codengenå— é¢å‘æ¥å£ç¼–ç¨‹å¤ªè€—æ—¶é—´ï¼Œä¸»è¦æ˜¯æ–¹æ³•é€’å½’è°ƒç”¨ï¼Œè™šå‡½æ•°è°ƒç”¨ å¯ä»¥å°†ä¸€ä¸ªstageçš„æ‰€æœ‰taskæ•´ç†æˆä¸€ä¸ªæ–¹æ³•ï¼Œå¹¶ä¸”ç”ŸæˆåŠ¨æ€å­—èŠ‚ç  å¹¶ç»“åˆ 13. åŠ å¼ºæ•°ä»“å’Œä¸šåŠ¡çš„å­¦ä¹  åŠ å¼ºåº•å±‚åŸç†çš„å­¦ä¹  14. æˆ‘æœºæ™ºçš„å›ç­”ï¼šæƒ³æ·±å…¥ä¸šåŠ¡ å’Œ æŠ€æœ¯åŸç†. æƒ³ä¼˜å…ˆè€ƒè™‘ï¼š data warehouse (é«˜å¹¶å‘å’Œå®æ—¶æµç»éªŒæ¬ ç¼º) &nbsp; å­—èŠ‚è·³åŠ¨å¤§æ•°æ®ç ”å‘å®ä¹ è¶…è¯¦ç»†é¢ç»ï¼ˆå·²æ‹¿offerï¼‰ 1. leetcode: äºŒå‰æ ‘å±‚åºéå†ï¼ŒæŒ‰å±‚æ¢è¡Œè¾“å‡º â 2. çº¿ç¨‹çš„çŠ¶æ€åŠçŠ¶æ€ä¹‹é—´çš„è£…æ¢ 3. B+æ ‘çš„ç‰¹ç‚¹? B+æ ‘æ˜¯ä¸€ç§æ ‘æ•°æ®ç»“æ„ï¼Œé€šå¸¸ç”¨äºæ•°æ®åº“å’Œæ“ä½œç³»ç»Ÿçš„æ–‡ä»¶ç³»ç»Ÿä¸­ã€‚B+æ ‘çš„ç‰¹ç‚¹æ˜¯èƒ½å¤Ÿä¿æŒæ•°æ®ç¨³å®šæœ‰åºï¼Œå…¶æ’å…¥ä¸ä¿®æ”¹æ‹¥æœ‰è¾ƒç¨³å®šçš„å¯¹æ•°æ—¶é—´å¤æ‚åº¦ã€‚B+æ ‘å…ƒç´ è‡ªåº•å‘ä¸Šæ’å…¥ï¼Œè¿™ä¸äºŒå‰æ ‘æ°å¥½ç›¸åã€‚ Bæ ‘æ˜¯ä¸ºç£ç›˜æˆ–å…¶ä»–ç›´æ¥å­˜å–çš„è¾…åŠ©å­˜å‚¨è®¾å¤‡è€Œè®¾è®¡çš„ä¸€ç§å¹³è¡¡æœç´¢æ ‘ã€‚Bæ ‘ç±»ä¼¼äºçº¢é»‘æ ‘ï¼Œä½†å®ƒä»¬åœ¨é™ä½ç£ç›˜I/Oæ“ä½œæ•°æ–¹é¢è¦æ›´å¥½ä¸€äº›ã€‚ 4. Redisæ”¯æŒçš„æ•°æ®ç»“æ„? ä¸ºä»€ä¹ˆæ€§èƒ½é«˜ï¼Ÿ ä¸ºä»€ä¹ˆæ˜¯å•çº¿ç¨‹? ç­”ï¼š å°†æ•°æ®å­˜å‚¨åœ¨å†…å­˜ï¼Œè¯»å–æ—¶å€™ä¸éœ€è¦è¿›è¡Œç£ç›˜çš„ IOï¼Œå•çº¿ç¨‹ä¹Ÿä¿è¯äº†ç³»ç»Ÿæ²¡æœ‰çº¿ç¨‹çš„ä¸Šä¸‹æ–‡åˆ‡æ¢ã€‚ Stringï¼šç¼“å­˜ã€è®¡æ•°å™¨ã€åˆ†å¸ƒå¼é”ç­‰ã€‚Listï¼šé“¾è¡¨ã€é˜Ÿåˆ—ã€å¾®åšå…³æ³¨äººæ—¶é—´è½´åˆ—è¡¨ç­‰ã€‚Hashï¼šç”¨æˆ·ä¿¡æ¯ã€Hash è¡¨ç­‰ã€‚Setï¼šå»é‡ã€èµã€è¸©ã€å…±åŒå¥½å‹ç­‰ã€‚Zsetï¼šè®¿é—®é‡æ’è¡Œæ¦œã€ç‚¹å‡»é‡æ’è¡Œæ¦œç­‰ã€‚Zset æ˜¯æœ‰åºçš„é“¾è¡¨ç»“æ„ï¼Œå…¶åº•å±‚æ•°æ®ç»“æ„æ˜¯è·³è·ƒè¡¨ skiplist 5. åœºæ™¯é¢˜ï¼šå¦‚ä½•ä»ç™¾äº¿æ¡IPä¿¡æ¯ä¸­å¾—å‡ºè®¿é—®é‡å‰10çš„IPåœ°å€ å“ˆå¸Œåˆ†æ²»æ³• 1. ipv4 åœ°å€æ˜¯ä¸€ä¸ª 32 ä½çš„æ•´æ•°ï¼Œå¯ä»¥ç”¨ uint ä¿å­˜ã€‚ 2. æˆ‘å…ˆè®¾è®¡ä¸€ä¸ªå“ˆå¸Œå‡½æ•°ï¼ŒæŠŠ100ä¸ªGçš„æ–‡ä»¶åˆ†æˆ10000ä»½ï¼Œæ¯ä»½å¤§çº¦æ˜¯ 10MBï¼Œå¯ä»¥åŠ è½½è¿›å†…å­˜äº† 6. åœºæ™¯è®¾è®¡é¢˜ï¼šä½ è‡ªå·±å¦‚ä½•è®¾è®¡ä¸€ä¸ªåˆ†å¸ƒå¼ç³»ç»Ÿï¼Œå®ç°å¯¹ç™¾äº¿æ¡æ•°æ®è¿›è¡Œåˆ†ç»„å¹¶æ±‚å’Œ 7. Spark shuffleæœºåˆ¶? 8. ç¼–ç¨‹é¢˜ï¼šä¸€ä¸ªæ•°ç»„æœ‰æ­£æ•°æœ‰è´Ÿæ•°ï¼Œè°ƒæ•´æ•°ç»„ä¸­çš„æ•°ä½¿å¾—æ­£è´Ÿäº¤æ›¿ 1. ç©ºé—´ O(1) 2. ä¿æŒåŸæ¥çš„é¡ºåº - æ—¶é—´å¤æ‚åº¦O(n^2) ï¼Œ if (i % 2 == 0 &amp;&amp; arr[i] &lt; 0) continue; 3. ä¸ç”¨ä¿æŒåŸæ¥çš„é¡ºåº, O(n) 9. åŒ»é™¢æ’é˜Ÿå€™è¯Šæ¨¡å‹ å‡è®¾ä¸€ä¸ªåŒ»é™¢ï¼ŒMä¸ªåŒ»ç”Ÿï¼ŒNä¸ªç—…äººï¼Œæ¯ä¸ªç—…äººçœ‹ç—…æ—¶é•¿å·²çŸ¥ã€‚å†™ä¸€ä¸ªå‡½æ•°ï¼ŒåšåŒ»ç”Ÿå’Œç—…äººçš„åˆ†é…ï¼Œè¦æ±‚åŒ»ç”Ÿè´Ÿè½½å°½é‡å‡è¡¡ã€‚ 10. 5 åˆ†é’Ÿç†è§£ https å·¥ä½œæµç¨‹ 11. Kafkaå¦‚ä½•ä¿è¯ç”Ÿäº§è€…ä¸ä¸¢å¤±æ•°æ®ï¼Œæ¶ˆè´¹ç«¯ä¸ä¸¢å¤±æ•°æ® &nbsp; å­—èŠ‚è·³åŠ¨å¤§æ•°æ®å²— , 2019.07 1. é™¤äº†ä½¿ç”¨hiveã€sparkã€‚åŸºæœ¬ç»Ÿè®¡æ¡†æ¶ï¼Œè‡ªå·±å®ç°ä¸€ä¸ªwordç»Ÿè®¡ç®—æ³•ï¼Ÿ æˆ‘è¯´äº†ç±»ä¼¼ä¸mapreducerç®—æ³• 2. é—®äº†MapReduceæ‰§è¡Œæµç¨‹ä»¥åŠé—®äº†RDDå±æ€§å’Œé—®äº†ä¸€äº›transformationå’Œactionç®—å­ 3. hiveèƒ½è¯»å–txtæ–‡ä»¶å—ï¼Ÿä»¥åŠè¯»å–å“ªäº›ç±»å‹æ–‡ä»¶ï¼Œè‹¥ä¸èƒ½è¯¥æ€ä¹ˆè®©å…¶èƒ½è¯»ï¼Ÿ load data local inpath â€˜/usr/testFile/result.csvâ€™ overwrite into table biao; â 4. å„ä¸ªæ–‡ä»¶åˆ†å¸ƒåœ¨ä¸åŒçš„åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œå¦‚ä½•å¿«é€Ÿçš„å®ç°æŸä¸ªå­—æ®µå‰ä¸‰ï¼Ÿ 5. 124. äºŒå‰æ ‘æœ€å¤§è·¯å¾„å’Œ, self.maxSum = float(â€œ-infâ€) leftGain = max(maxGain(node.left), 0) 51. N çš‡åï¼Œ def backtrack(row: int) if: else: for å›æº¯ Hard 6. 225. ç”¨é˜Ÿåˆ—å®ç°æ ˆ , self.queue = collections.deque() , push åï¼Œåœ¨ reverse è¿‡æ¥ self.queue.append(x) for _ in range(n): self.queue.append(self.queue.popleft()) â 7. å°å’Œé—®é¢˜å’Œé€†åºå¯¹é—®é¢˜ main: smallSum(arr,start,mid)+smallSum(arr,mid+1,end)+merge(arr,start,mid,end) core : Sum=Sum+arr[l]*(end-r+1) â &nbsp; å­—èŠ‚è·³åŠ¨å¤§æ•°æ®å¼€å‘å·¥ç¨‹å¸ˆæŠ€æœ¯ä¸­å°ä¸€äºŒä¸‰é¢+hré¢ select distinct a.uid from tb_log a left join tb_log b on a.uid = b.uid and (a.pdate = date_sub(b.pdate,1) or a.pdate = date_add(b.pdate,1)) 122. ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœº II class Solution: def maxProfit(self, prices: List[int]) -&gt; int: size = len(prices) # dp æ•°ç»„ dp = [[0, 0] for _ in range(size)] # åˆå§‹åŒ– dp[0][0] = 0 dp[0][1] = -prices[0] for i in range(1, size): # çŠ¶æ€è½¬ç§» dp[i][0] = max(dp[i-1][0], dp[i-1][1]+prices[i]) dp[i][1] = max(dp[i-1][1], dp[i-1][0]-prices[i]) return dp[size-1][0] å†™sql, æ±‚ä¸€ä¸ªçœä»½ä¸‹çš„uvæœ€é«˜çš„åŸå¸‚ ä¸»è¦è€ƒå¯Ÿçª—å£å‡½æ•° select province, city from ( select province, city, row_number() over( partition by province order by uv desc ) rank from ( select province, city, count(distinct uid) uv from tb_log where pdate = &#123;date&#125; group by province, city ) a ) a1 where a1.rank = 1 äºŒå‰æ ‘ä¸­çš„æœ€å¤§è·¯å¾„å’Œ class Solution: def __init__(self): self.maxSum = float(&quot;-inf&quot;) def maxPathSum(self, root: TreeNode) -&gt; int: def maxGain(node): if not node: return 0 # é€’å½’è®¡ç®—å·¦å³å­èŠ‚ç‚¹çš„æœ€å¤§è´¡çŒ®å€¼ # åªæœ‰åœ¨æœ€å¤§è´¡çŒ®å€¼å¤§äº 0 æ—¶ï¼Œæ‰ä¼šé€‰å–å¯¹åº”å­èŠ‚ç‚¹ leftGain = max(maxGain(node.left), 0) rightGain = max(maxGain(node.right), 0) # èŠ‚ç‚¹çš„æœ€å¤§è·¯å¾„å’Œå–å†³äºè¯¥èŠ‚ç‚¹çš„å€¼ä¸è¯¥èŠ‚ç‚¹çš„å·¦å³å­èŠ‚ç‚¹çš„æœ€å¤§è´¡çŒ®å€¼ priceNewpath = node.val + leftGain + rightGain # æ›´æ–°ç­”æ¡ˆ self.maxSum = max(self.maxSum, priceNewpath) # è¿”å›èŠ‚ç‚¹çš„æœ€å¤§è´¡çŒ®å€¼ return node.val + max(leftGain, rightGain) maxGain(root) return self.maxSum N çš‡å class Solution: def solveNQueens(self, n: int) -&gt; List[List[str]]: def generateBoard(): board = list() for i in range(n): row[queens[i]] = &quot;Q&quot; board.append(&quot;&quot;.join(row)) row[queens[i]] = &quot;.&quot; return board def backtrack(row: int): if row == n: board = generateBoard() solutions.append(board) else: for i in range(n): if i in columns or row - i in diagonal1 or row + i in diagonal2: continue queens[row] = i columns.add(i) diagonal1.add(row - i) diagonal2.add(row + i) backtrack(row + 1) columns.remove(i) diagonal1.remove(row - i) diagonal2.remove(row + i) solutions = list() queens = [-1] * n columns = set() diagonal1 = set() diagonal2 = set() row = [&quot;.&quot;] * n backtrack(0) return solutions Javaçº¿ç¨‹çš„5ç§çŠ¶æ€åŠçŠ¶æ€ä¹‹é—´è½¬æ¢ Hadoop, HDFS, MR, Yarn Jobä¸ƒã€ä»‹ç»ä¸€ä¸‹HDFSè¯»å†™æµç¨‹ HDFS blockæ•°æ®å—å¤§å°ä¸º128MB, é»˜è®¤æƒ…å†µä¸‹æ¯ä¸ªblockæœ‰ä¸‰ä¸ªå‰¯æœ¬, NameNodeä¸»èŠ‚ç‚¹ï¼Œ DataNode ä»èŠ‚ç‚¹. HDFS clientä¸Šä¼ æ•°æ®åˆ°HDFSæ—¶ï¼Œé¦–å…ˆï¼Œåœ¨æœ¬åœ°ç¼“å­˜æ•°æ®ï¼Œå½“æ•°æ®è¾¾åˆ°ä¸€ä¸ªblockå¤§å°æ—¶ã€‚è¯·æ±‚NameNodeåˆ†é…ä¸€ä¸ªblockã€‚ NameNodeä¼šæŠŠblockæ‰€åœ¨çš„DataNodeçš„åœ°å€å‘Šè¯‰HDFS clientã€‚ HDFS clientä¼šç›´æ¥å’ŒDataNodeé€šä¿¡ï¼ŒæŠŠæ•°æ®å†™åˆ°DataNodeèŠ‚ç‚¹ä¸€ä¸ªblockæ–‡ä»¶é‡Œ No. Read HDFS (download) - FSDataInputStream() 4æ­¥ Flag 1. FileSystemå¯¹è±¡çš„open == DistributedFileSystem() 2. get block locations from NameNode ï¼ˆrpcï¼‰ 3. Client ä¸ DataNode é€šä¿¡, FSDataInputStreamå¯¹è±¡ï¼Œè¯¥å¯¹è±¡ä¼šè¢«å°è£…DFSInputStreamå¯¹è±¡ 4. å‡è®¾ç¬¬ä¸€å—çš„æ•°æ®è¯»å®Œäº†ï¼Œå°±ä¼šå…³é—­æŒ‡å‘ç¬¬ä¸€å—çš„datanodeè¿æ¥ã€‚æ¥ç€è¯»å–ä¸‹ä¸€å—. No. Writing HDFS (upload) - FSDataOutputStream() 6ä¸æ­¥ ACK queue Flag 1. clienté€šè¿‡è°ƒç”¨DistributedFileSystemçš„createæ–¹æ³•åˆ›å»ºæ–°æ–‡ä»¶ 2. DFileSystemé€šè¿‡RPCè°ƒç”¨namenodeå»åˆ›å»ºä¸€ä¸ªæ²¡æœ‰blockså…³è”çš„æ–°æ–‡ä»¶, åˆ›å»ºå‰ï¼Œ namenodeåšæ ¡éªŒ. 3. å‰ä¸¤æ­¥ç»“æŸåã€‚ä¼šè¿”å›FSDataOutputStreamçš„å¯¹è±¡ï¼Œä¸è¯»æ–‡ä»¶çš„æ—¶å€™ç±»ä¼¼ï¼Œ FSDataOutputStreamè¢«å°è£…æˆDFSOutputStreamã€‚DFSOutputStreamèƒ½å¤Ÿåè°ƒnamenodeå’Œdatanodeã€‚clienté–‹å§‹å†™æ•°æ®åˆ°DFSOutputStreamï¼ŒDFSOutputStreamä¼šæŠŠæ•°æ®åˆ‡æˆä¸€ä¸ªä¸ªå°çš„packetã€‚ç„¶åæ’æˆé˜Ÿåˆ—data quene 4. DataStreamerä¼šå»å¤„ç†æ¥å—data queneï¼Œå®ƒå…ˆè¯¢é—®namenodeè¿™ä¸ªæ–°çš„blockæœ€é€‚åˆå­˜å‚¨çš„åœ¨å“ª 5. DFSOutputStreamå¦ä¸€ä¸ªå¯¹åˆ—å«ack queneã€‚ä¹Ÿæ˜¯ç”±packetç»„æˆï¼Œç­‰å¾…datanodeçš„æ”¶åˆ°å“åº”ï¼Œå½“pipelineä¸­çš„å…¨éƒ¨datanodeéƒ½è¡¨ç¤ºå·²ç»æ”¶åˆ°çš„æ—¶å€™ï¼Œè¿™æ—¶akc queneæ‰ä¼šæŠŠç›¸åº”çš„packetåŒ…ç§»é™¤æ‰ã€‚ 6. clientå®Œæ¯•å†™æ•°æ®åè°ƒç”¨closeæ–¹æ³•å…³é—­å†™å…¥æµ MapReduceè¿‡ç¨‹è¯¦è§£ 1. Mapç«¯æ•´ä¸ªæµç¨‹åˆ†ä¸º4æ­¥ æ¥æºäºHDFSçš„Block åœ¨ç»è¿‡Mapperè¿è¡Œåï¼Œè¾“å‡ºæ˜¯Key/Value - é»˜è®¤å¯¹Keyè¿›è¡Œå“ˆå¸Œè¿ç®—åï¼Œå†ä»¥ReduceTaskæ•°é‡å–æ¨¡ å†…å­˜ç¼“å†²åŒºçš„å¤§å°æ˜¯æœ‰é™çš„ï¼Œé»˜è®¤æ˜¯100MB, Spillï¼Œä¸­æ–‡è¯‘ä¸ºæº¢å†™ æ¯æ¬¡æº¢å†™éƒ½åœ¨ç£ç›˜ä¸Šç”Ÿæˆä¸€æº¢å†™æ–‡ä»¶ï¼Œå¦‚Mapç»“æœå¾ˆå¤§ï¼Œå°±æœ‰å¤šæ¬¡æº¢å†™å‘ç”Ÿï¼Œç£ç›˜ä¸Šå°±ä¼šæœ‰å¤šä¸ªæº¢å†™æ–‡ä»¶, åmerge 2. Reduceç«¯æ•´ä¸ªæµç¨‹åˆ†ä¸º3æ­¥ Copyè¿‡ç¨‹. å³ç®€å•åœ°æ‹‰å–æ•°æ® Mergeé˜¶æ®µ: å¤åˆ¶è¿‡æ¥ æ•°æ®ä¼šå…ˆæ”¾åˆ°å†…å­˜ç¼“å†²åŒºä¸­ï¼Œå½“è¾¾åˆ°ä¸€å®šé˜ˆå€¼æ—¶ï¼Œå°±ä¼šå¯åŠ¨å†…å­˜åˆ°ç£ç›˜çš„Merge. Reducerè¾“å‡ºæ–‡ä»¶ã€‚ä¸æ–­Mergeåï¼Œæœ€åç”Ÿæˆä¸€ä¸ªâ€œæœ€ç»ˆæ–‡ä»¶â€. å½“Reducerè¾“å…¥æ–‡ä»¶å·²å®šï¼Œæ•´ä¸ªShuffleè¿‡ç¨‹æ‰ç»“æŸ. No. MapReduceçš„Shuffleè¿‡ç¨‹ Flag 1. Mapæ–¹æ³•ä¹‹åReduceæ–¹æ³•ä¹‹å‰è¿™æ®µå¤„ç†è¿‡ç¨‹å«ã€ŒShuffleã€ 2. Mapæ–¹æ³•ä¹‹åï¼Œæ•°æ®é¦–å…ˆè¿›å…¥åˆ°åˆ†åŒºæ–¹æ³•ï¼ŒæŠŠæ•°æ®æ ‡è®°å¥½åˆ†åŒºï¼Œç„¶åæŠŠæ•°æ®å‘é€åˆ°ç¯å½¢ç¼“å†²åŒºï¼› ç¯å½¢ç¼“å†²åŒºè¾¾åˆ°80%æ—¶ï¼Œè¿›è¡Œæº¢å†™ï¼› æ’åºçš„æ‰‹æ®µã€Œå¿«æ’ã€ï¼›æº¢å†™äº§ç”Ÿå¤§é‡æº¢å†™æ–‡ä»¶ï¼Œéœ€è¦å¯¹æº¢å†™æ–‡ä»¶è¿›è¡Œã€Œå½’å¹¶æ’åºã€ï¼›å¯¹æº¢å†™çš„æ–‡ä»¶ä¹Ÿå¯ä»¥è¿›è¡ŒCombineræ“ä½œï¼Œå‰ææ˜¯æ±‡æ€»æ“ä½œï¼Œæ±‚å¹³å‡å€¼ä¸è¡Œã€‚æœ€åå°†æ–‡ä»¶æŒ‰ç…§åˆ†åŒºå­˜å‚¨åˆ°ç£ç›˜ï¼Œç­‰å¾…Reduceç«¯æ‹‰å–ã€‚ 3. æ¯ä¸ªReduceæ‹‰å–Mapç«¯å¯¹åº”åˆ†åŒºçš„æ•°æ®ã€‚æ‹‰å–æ•°æ®åå…ˆå­˜å‚¨åˆ°å†…å­˜ä¸­ï¼Œå†…å­˜ä¸å¤Ÿäº†ï¼Œå†å­˜å‚¨åˆ°ç£ç›˜ã€‚æ‹‰å–å®Œæ‰€æœ‰æ•°æ®åï¼Œé‡‡ç”¨å½’å¹¶æ’åºå°†å†…å­˜å’Œç£ç›˜ä¸­çš„æ•°æ®éƒ½è¿›è¡Œæ’åºã€‚åœ¨è¿›å…¥Reduceæ–¹æ³•å‰ï¼Œå¯ä»¥å¯¹æ•°æ®è¿›è¡Œåˆ†ç»„æ“ä½œã€‚ No. Yarn çš„ Job æäº¤æµç¨‹ 8 æ­¥ï¼Œ Client-&gt;RM-&gt;C-&gt;AMâ€”rmâ€”&gt;C nums-&gt;NM-&gt;C-&gt;æ³¨é”€AM+C Flag 1. clientå‘RMæäº¤åº”ç”¨ç¨‹åº 2. ResourceManagerå¯åŠ¨ä¸€ä¸ªContainerç”¨äºè¿è¡ŒApplicationMaster 3. å¯åŠ¨ä¸­çš„ApplicationMasterå‘ResourceManageræ³¨å†Œè‡ªå·±ï¼Œå¯åŠ¨æˆåŠŸåä¸RMä¿æŒå¿ƒè·³ 4. AM å‘ RM å‘é€è¯·æ±‚,ç”³è¯·ç›¸åº”æ•°ç›®çš„ Container 5. ç”³è¯·æˆåŠŸçš„Containerï¼Œç”±AMè¿›è¡Œåˆå§‹åŒ–ã€‚Containerçš„å¯åŠ¨ä¿¡æ¯åˆå§‹åŒ–åï¼ŒAMä¸å¯¹åº”çš„NodeManageré€šä¿¡ï¼Œè¦æ±‚NMå¯åŠ¨Container 6. NMå¯åŠ¨container 7. containerè¿è¡ŒæœŸé—´ï¼ŒAM å¯¹ Containerè¿›è¡Œç›‘æ§ã€‚Containeré€šè¿‡RPCåè®®å‘å¯¹åº”çš„AMæ±‡æŠ¥è‡ªå·±çš„è¿›åº¦å’ŒçŠ¶æ€ç­‰ä¿¡æ¯ 8. åº”ç”¨è¿è¡Œç»“æŸåï¼ŒAM å‘ RM æ³¨é”€è‡ªå·±ï¼Œå¹¶å…è®¸å±äºå®ƒçš„ Containerè¢«æ”¶å› 0. Glassdoor No. Question Flag 1. hashmap questions å“ˆå¸Œå†²çªè§£å†³æ–¹æ³• : å…³é”®å­—å€¼ä¸åŒçš„å…ƒç´ å¯èƒ½ä¼šæ˜ è±¡åˆ°å“ˆå¸Œè¡¨çš„åŒä¸€åœ°å€ä¸Šå°±ä¼šå‘ç”Ÿå“ˆå¸Œå†²çª1. å¼€æ”¾å®šå€æ³• 2. å†å“ˆå¸Œæ³• 3. é“¾åœ°å€æ³• 4. å»ºç«‹å…¬å…±æº¢å‡ºåŒº å¤§å‚é¢è¯•å¿…é—®ï¼HashMap æ€æ ·è§£å†³hashå†²çªï¼Ÿ ä¸ºä»€ä¹ˆ Map æ¡¶ä¸­è¶…è¿‡ 8 ä¸ªæ‰è½¬ä¸ºçº¢é»‘æ ‘ï¼Ÿ HashMapæŒ‡å— HashMapé¢è¯• shopå¤§æ•°æ®é¢è¯• No. Question Flag 2. What is the difference between optimistic and pessimistic locks? æ•°æ®åº“é”æœºåˆ¶ï¼ˆä¹è§‚é”å’Œæ‚²è§‚é”ã€è¡¨é”å’Œè¡Œé”ï¼‰ä½ äº†è§£ä¹è§‚é”å’Œæ‚²è§‚é”å—ï¼Ÿ 1ã€CASï¼ˆCompare And Swapï¼‰ - CASåªèƒ½ä¿è¯å•ä¸ªå˜é‡æ“ä½œçš„åŸå­æ€§2ã€ç‰ˆæœ¬å·æœºåˆ¶3ã€ä¹è§‚é”åŠ é”å—ï¼Ÿ4ã€CASæœ‰å“ªäº›ç¼ºç‚¹ï¼Ÿ The coding test had 2 questions, were about heaps and double-ended queues. # from heapq import heappush, nsmallest, nlargest, ...heap = []for i in range(3): heappush(heap, i)# heappop(heap)ï¼šå¼¹å‡ºå †ä¸­æœ€å°çš„å…ƒç´ # heapify(heap)ï¼šå°†åˆ—è¡¨è½¬æ¢ä¸ºå †# heapreplace(heap, x)ï¼šå¼¹å‡ºå †ä¸­æœ€å°çš„å…ƒç´ ï¼Œç„¶åå°†æ–°å…ƒç´ æ’å…¥# nlargest(n, iter)ã€nsmallest(n, iter)ï¼šç”¨æ¥å¯»æ‰¾ä»»ä½•å¯è¿­ä»£å¯¹è±¡iterä¸­çš„å‰nä¸ªæœ€å¤§çš„æˆ–å‰nä¸ªæœ€å°çš„å…ƒç´ queue = collections.deque()queue.append(5)queue.appendleft(10)cur = queue.popleft()cur = queue.pop() there was a question on writing an SQL query and command line applications. General DWH concepts, Spark internals, mapreduce. They also had few questions on coding which were focused on data structures &amp; algorithms. The interviewers look at how youâ€™re thought process. Explain the map reduce paradigm. Hadoop æ˜¯èƒ½å¯¹å¤§é‡æ•°æ®è¿›è¡Œåˆ†å¸ƒå¼å¤„ç†çš„è½¯ä»¶æ¡†æ¶ åŒ…æ‹¬ Hdfsï¼ŒMapReduceï¼ŒYarn Spark: RDDè®¡ç®—æ—¶æ˜¯æŠŠæ•°æ®å…¨éƒ¨åŠ è½½è‡³å†…å­˜ä¹ˆ? good - åšå®¢å›­ Spark Shuffle Shuffleçš„æœ¬è´¨: Stageæ˜¯ä»¥shuffleä½œä¸ºåˆ†ç•Œçš„! Shuffleä¸è¿‡æ˜¯å·å·çš„å¸®ä½ åŠ ä¸Šäº†ä¸ªç±»ä¼¼saveAsLocalDiskFileçš„åŠ¨ä½œã€‚ å¦‚æœæ˜¯M/Rçš„è¯: æ¯ä¸ªStageå…¶å®å°±æ˜¯ä¸Šé¢è¯´çš„é‚£æ ·ï¼Œä¸€å¥—æ•°æ®è¢«Nä¸ªåµŒå¥—çš„å‡½æ•°å¤„ç†(ä¹Ÿå°±æ˜¯ä½ çš„transformåŠ¨ä½œ)ã€‚é‡åˆ°äº†Shuffle,å°±è¢«åˆ‡å¼€æ¥ã€‚Shuffleæœ¬è´¨ä¸Šæ˜¯æŠŠæ•°æ®æŒ‰è§„åˆ™ä¸´æ—¶éƒ½è½åˆ°ç£ç›˜ä¸Šï¼Œç›¸å½“äºå®Œæˆäº†ä¸€ä¸ªsaveAsTextFileçš„åŠ¨ä½œï¼Œä¸è¿‡æ˜¯å­˜æœ¬åœ°ç£ç›˜ã€‚ç„¶åè¢«åˆ‡å¼€çš„ä¸‹ä¸€ä¸ªStageåˆ™ä»¥æœ¬åœ°ç£ç›˜çš„è¿™äº›æ•°æ®ä½œä¸ºæ•°æ®æºï¼Œé‡èµ°ä¸Šé¢çš„æµç¨‹ã€‚ several questions about database, sharding, RMDB vs NoSQL DB, Why distributed NoSQL DB cannot always support transaction? TiDB, ä¹Ÿæ˜¯å¯ä»¥æ”¯æŒäº‹åŠ¡çš„ï¼Œåªæ˜¯å¼€é”€éå¸¸å¤§ leetcode: solve a problem of top k problem in an online white board # return heapq.nsmallest(k, arr)import heapqclass Solution: def smallestK(self, arr: List[int], k: int) -&gt; List[int]: if k&gt;len(arr) or k==0: return [] heap = [] for i in arr[:k]: heapq.heappush(heap, -i) for i in arr[k:]: if i &lt; -heap[0]: heapq.heappop(heap) heapq.heappush(heap, -i) result = [] for i in range(k): result.append(-heapq.heappop(heap)) return result[::-1] æ‰©å±•: 1). 692. å‰Kä¸ªé«˜é¢‘å•è¯2). 347. å‰ K ä¸ªé«˜é¢‘å…ƒç´ 3). 215. Kth Largest Element in an Array4). é¢è¯•é¢˜ 17.14. æœ€å°Kä¸ªæ•° (æ’åº) Level traverse a binary tree in an online white board. q = deque()q.append(), q.popleft()while q: passlist(res.values()) 1. Operating System No. Question Flag 1. è¿›ç¨‹åˆ‡æ¢è¯´ä¸€ä¸‹ è¿›ç¨‹åˆ‡æ¢å…·ä½“å“ªäº›èµ„æºï¼Ÿ 2. Linuxçš„Killå‘½ä»¤ï¼ˆ-9ä¿¡å·çš„ä½œç”¨ï¼‰ 3. è¿›ç¨‹åˆ‡æ¢å’Œçº¿ç¨‹åˆ‡æ¢ï¼š è¿›ç¨‹åˆ‡æ¢ï¼šâ‘  åˆ‡æ¢é¡µç›®å½•ä»¥ä½¿ç”¨æ–°åœ°å€ç©ºé—´ï¼›â‘¡ åˆ‡æ¢å†…æ ¸æ ˆå’Œç¡¬ä»¶ä¸Šä¸‹æ–‡ï¼› çº¿ç¨‹åˆ‡æ¢ä¸ç”¨åˆ‡åœ°å€ç©ºé—´ï¼Œä¹Ÿå°±æ˜¯ä¸ç”¨åšâ‘  ä¸Šä¸‹æ–‡åˆ‡æ¢é€šè¿‡OSå†…æ ¸å®Œæˆï¼Œæ€§èƒ½æŸè€—ä¸»è¦æ¥æºäºâ‘  å¯„å­˜å™¨å†…å®¹åˆ‡å‡ºåˆ‡å…¥ï¼›â‘¡ åˆ‡æ¢åCPUåŸæœ¬çš„ç¼“å­˜ä½œåºŸï¼ŒTLBï¼ˆé¡µè¡¨ç¼“å†²ï¼‰ç­‰éƒ½è¢«åˆ·æ–°ï¼Œå¯¼è‡´ä¸€æ®µæ—¶é—´çš„å†…å­˜è®¿é—®ååˆ†ä½æ•ˆï¼ˆçº¿ç¨‹åˆ‡æ¢æ²¡æœ‰è¿™ä¸ªé—®é¢˜ï¼‰ è¿›ç¨‹æ€§èƒ½ ä¸ ç³»ç»Ÿæ€§èƒ½ cpuï¼štop, å†…å­˜ï¼šfree, å¸¦å®½ï¼šnetstat, straceå†…æ ¸æ—¶é—´ vs ç”¨æˆ·æ—¶é—´ï¼Œ åº“æ—¶é—´ vs åº”ç”¨ç¨‹åºæ—¶é—´ï¼Œ ç»†åˆ†åº”ç”¨ç¨‹åºæ—¶é—´ gprof vs oprofile gprofç”¨äºåˆ†æå‡½æ•°è°ƒç”¨è€—æ—¶ï¼Œå¯ç”¨ä¹‹æŠ“å‡ºæœ€è€—æ—¶çš„å‡½æ•°ï¼Œä»¥ä¾¿ä¼˜åŒ–ç¨‹åº gprofæ˜¯GNU profileå·¥å…·ï¼Œå¯ä»¥è¿è¡Œäºlinuxã€AIXã€Sunç­‰æ“ä½œç³»ç»Ÿè¿›è¡ŒCã€C++ã€Pascalã€Fortranç¨‹åºçš„æ€§èƒ½åˆ†æ 2. Database No. Question Flag 0. å¹»è¯»ï¼š InnoDB MVCC çš„å®ç°ï¼Œé€šè¿‡ä¿å­˜æ•°æ®åœ¨æŸä¸ªæ—¶é—´ç‚¹çš„å¿«ç…§æ¥å®ç°çš„ â 1. äº‹åŠ¡4ä¸ªç‰¹æ€§ACID æœ‰å“ªäº› å¹¶åˆ†åˆ«è§£é‡Š? &nbsp;&nbsp;äº‹åŠ¡æ˜¯æŒ‡æ˜¯ç¨‹åºä¸­ä¸€ç³»åˆ—ä¸¥å¯†çš„é€»è¾‘æ“ä½œï¼Œè€Œä¸”æ‰€æœ‰æ“ä½œå¿…é¡»å…¨éƒ¨æˆåŠŸå®Œæˆ. AåŸå­æ€§ï¼š äº‹åŠ¡æ˜¯æ•°æ®åº“çš„é€»è¾‘å·¥ä½œå•ä½ï¼Œä¸å¯åˆ†å‰²Cä¸€è‡´æ€§ï¼š æ•°æ®åº“ä»ä¸€ä¸ªä¸€è‡´æ€§çŠ¶æ€å˜åˆ°å¦ä¸€ä¸ªä¸€è‡´æ€§çŠ¶æ€ I éš”ç¦»æ€§ï¼šä¸€ä¸ªäº‹åŠ¡çš„æ‰§è¡Œä¸èƒ½å…¶å®ƒäº‹åŠ¡å¹²æ‰° DæŒä¹…æ€§ï¼š ä¸€ä¸ªäº‹åŠ¡ä¸€æ—¦æäº¤ï¼Œå®ƒå¯¹æ•°æ®åº“ä¸­çš„æ•°æ®çš„æ”¹å˜å°±åº”è¯¥æ˜¯æ°¸ä¹…æ€§çš„ï¼Œä¸èƒ½å›æ»š â 2. MySQLéš”ç¦»çº§åˆ«æœ‰å“ªäº›? SQLæ ‡å‡†å®šä¹‰äº†4ç±»éš”ç¦»çº§åˆ«ï¼ŒåŒ…æ‹¬äº†ä¸€äº›å…·ä½“è§„åˆ™ï¼Œç”¨æ¥é™å®šäº‹åŠ¡å†…å¤–çš„å“ªäº›æ”¹å˜æ˜¯å¯è§çš„ï¼Œå“ªäº›æ˜¯ä¸å¯è§çš„ã€‚ä½çº§åˆ«çš„éš”ç¦»çº§ä¸€èˆ¬æ”¯æŒæ›´é«˜çš„å¹¶å‘å¤„ç†ï¼Œå¹¶æ‹¥æœ‰æ›´ä½çš„ç³»ç»Ÿå¼€é”€ã€‚ 1. Read Uncommittedï¼ˆè¯»å–æœªæäº¤å†…å®¹ï¼‰- &nbsp;&nbsp;ä¹Ÿç§°ä¸º è„è¯»(Dirty Read) - RollBack 2. Read Committedï¼ˆè¯»å–æäº¤å†…å®¹ï¼‰- &nbsp;&nbsp;ä¸€ä¸ªäº‹åŠ¡åªèƒ½çœ‹è§å·²ç»æäº¤äº‹åŠ¡æ‰€åšçš„æ”¹å˜ 3. Repeatable Readï¼ˆå¯é‡è¯»ï¼‰ - &nbsp;&nbsp;åŒä¸€äº‹åŠ¡å¹¶å‘è¯»åŒæ ·ç»“æœ. InnoDB MVCC è§£å†³å¹»è¯» 4. Serializableï¼ˆå¯ä¸²è¡ŒåŒ–ï¼‰- &nbsp;&nbsp; äº‹åŠ¡æ’åºè§£å†³ å¹»è¯»é—®é¢˜ 1. è„è¯»(Drity Read): æŸäº‹åŠ¡å·²æ›´æ–°äº†æ•°æ®ï¼ŒRollBackäº†æ“ä½œï¼Œåˆ™åä¸€ä¸ªäº‹åŠ¡æ‰€è¯»å–çš„æ•°æ®å°±ä¼šæ˜¯ä¸æ­£ç¡®.2. ä¸å¯é‡å¤è¯»: åœ¨ä¸€äº‹åŠ¡çš„ä¸¤æ¬¡æŸ¥è¯¢æ•°æ®ä¸ä¸€è‡´ï¼Œå¯èƒ½ä¸­é—´æ’å…¥äº†ä¸€ä¸ªäº‹åŠ¡æ›´æ–°åŸæœ‰çš„æ•°æ®.3. å¹»è¯»(Phantom Read): åœ¨ä¸€äº‹åŠ¡çš„ä¸¤æ¬¡æŸ¥è¯¢ä¸­æ•°æ®ç¬”æ•°ä¸ä¸€è‡´. å¦ä¸€äº‹åŠ¡å´åœ¨æ­¤æ’å…¥äº†æ–°çš„å‡ åˆ—æ•°æ®. â 3. SQLçš„ç´¢å¼•é‡‡ç”¨ä»€ä¹ˆæ•°æ®ç»“æ„ï¼Ÿï¼ˆB+æ ‘ï¼‰ â 4. èšç°‡ç´¢å¼•InnoDB / éèšç°‡ç´¢å¼•Myisam â 5. ä¸»é”®å’Œç´¢å¼•çš„åŒºåˆ«ï¼Ÿ 1. ä¸»é”®æ˜¯ä¸ºäº†æ ‡è¯†æ•°æ®åº“è®°å½•å”¯ä¸€æ€§ï¼Œä¸å…è®¸è®°å½•é‡å¤ï¼Œä¸”é”®å€¼ä¸èƒ½ä¸ºç©ºï¼Œä¸»é”®ä¹Ÿæ˜¯ä¸€ä¸ªç‰¹æ®Šç´¢å¼•. 2. ç´¢å¼•å¯æé«˜æŸ¥è¯¢é€Ÿåº¦ï¼Œå®ƒç›¸å½“äºå­—å…¸çš„ç›®å½•ï¼Œå¯é€šè¿‡å®ƒå¾ˆå¿«æŸ¥è¯¢åˆ°æƒ³è¦çš„ç»“æœï¼Œè€Œä¸éœ€è¦è¿›è¡Œå…¨è¡¨æ‰«æ. 3. ä¸»é”®ä¹Ÿå¯ä»¥ç”±å¤šä¸ªå­—æ®µç»„æˆï¼Œç»„æˆå¤åˆä¸»é”®ï¼ŒåŒæ—¶ä¸»é”®è‚¯å®šä¹Ÿæ˜¯å”¯ä¸€ç´¢å¼•. â 6. Redisçš„è¿‡æœŸç­–ç•¥å’Œå†…å­˜æ·˜æ±°ç­–ç•¥ä¸è¦ææ··æ·† 1. Redisçš„è¿‡æœŸç­–ç•¥ - åœ¨ç¨‹åºä¸­å¯ä»¥è®¾ç½®Redisä¸­ç¼“å­˜çš„keyçš„è¿‡æœŸæ—¶é—´. &nbsp;&nbsp;1.1 å®šæ—¶è¿‡æœŸ - ä¼šå ç”¨å¤§é‡çš„CPU &nbsp;&nbsp;1.2 æƒ°æ€§è¿‡æœŸ - å ç”¨å†…å­˜å¤š &nbsp;&nbsp;1.3 å®šæœŸè¿‡æœŸï¼šæ¯éš”ä¸€å®šçš„æ—¶é—´ï¼Œä¼šæ‰«æä¸€å®šæ•°é‡expires key 2. Redisçš„å†…å­˜æ·˜æ±°ç­–ç•¥æ˜¯æŒ‡å†…å­˜ä¸è¶³æ—¶ï¼Œæ€ä¹ˆå¤„ç†éœ€è¦æ–°å†™å…¥ä¸”éœ€è¦ç”³è¯·é¢å¤–ç©ºé—´çš„æ•°æ®. â 7. å¦‚ä½•è§£å†³å“ˆå¸Œå†²çª ï¼ˆæ‹‰é“¾æ³•ï¼Œçº¿æ€§æ¢æµ‹æ³•â€¦æ‹“å±•å·´æ‹‰å·´æ‹‰ï¼‰ MySQLçš„å­˜å‚¨å¼•æ“ï¼š å› ä¸ºé¢è¯•å‰çœ‹äº†ä¸€ç¯‡å…³äºB+æ•°ç»“æ„çš„æ–‡ç« ï¼Œæ»¡è„‘å­éƒ½æ˜¯B+æ ‘ï¼Œæ²¡ç­”å¥½ï¼Œç»­å¤šInnodbçš„ç‰¹æ€§éƒ½æ²¡ç­”åˆ° InnoDBæ˜¯MySQLç›®å‰é»˜è®¤çš„å­˜å‚¨å¼•æ“ï¼Œåº•å±‚ä½¿ç”¨äº†B+æ ‘ä½œä¸ºæ•°æ®ç»“æ„ï¼Œä¸MyiSAMä¸åŒçš„æ—¶ï¼ŒInnoDBå±äºèšé›†ç´¢å¼•ï¼Œä¸»é”®å’Œæ•°æ®ä¸€èµ·å­˜å‚¨åœ¨B+æ ‘çš„å¶å­èŠ‚ç‚¹ä¸­ï¼Œè€ŒMyiSAMçš„ä¸»é”®å’Œæ•°æ®æ˜¯åˆ†å¼€å­˜å‚¨çš„ï¼Œå¶å­èŠ‚ç‚¹ä¸­å­˜å‚¨çš„æ˜¯æ•°æ®æ‰€åœ¨çš„åœ°å€ã€‚InnoDBå’ŒMyiSAMçš„åŒºåˆ«ï¼š å­˜å‚¨æ–¹å¼ï¼šå‰è€…ç´¢å¼•å’Œæ•°æ®å…±å­˜äºä¸€ä¸ªæ–‡ä»¶ä¸­ï¼›åè€…ç´¢å¼•å’Œæ•°æ®åˆ†å¼€å­˜å‚¨é”ç²’åº¦ï¼šå‰è€…æ”¯æŒè¡Œé”ï¼ˆMVCCç‰¹æ€§)ï¼›è€Œåè€…ä»…æ”¯æŒåˆ°è¡¨é”äº‹åŠ¡æ”¯æŒï¼šå‰è€…æ”¯æŒäº‹åŠ¡ï¼›åè€…ä¸æ”¯æŒäº‹åŠ¡å¯¹äºå†™å¤šçš„åœºæ™¯ï¼Œç”±äºMyiSAMéœ€è¦é¢‘ç¹çš„é”è¡¨ï¼Œæ€§èƒ½å¼€é”€æ¯”InnoDBå¤§å¾—å¤šå¯¹äºè¯»å¤šå†™å°‘çš„åœºæ™¯ï¼Œç”±äºInnoDBæ¯æ¬¡æ“ä½œéƒ½éœ€è¦åœ¨äº‹åŠ¡ä¸­ï¼ŒMyiSAMçš„æ€§èƒ½å¯èƒ½ä¼šæ¯”å‰è€…å¥½ 3.0 LRUclass DLinkedNode: def __init__(self, key=0, value=0): self.key = key self.value = value self.prev = None self.next = None class LRUCache: def __init__(self, capacity: int): self.head = DLinkedNode() self.tail = DLinkedNode() self.head.next = self.tail self.tail.prev = self.head self.capacity = capacity self.size = 0 self.cache = &#123;&#125; 3.1 quickSortdef quickSort(nums, left, right): if left &lt; right: l, r = left, right x = nums[l] while True: while l &lt; r and nums[r] &gt;= x: r -= 1 while l &lt; r and nums[l] &lt;= x: l += 1 if l &gt;= r: break nums[l], nums[r] = nums[r], nums[l] nums[left], nums[l] = nums[l], nums[left] quickSort(nums, left, l - 1) quickSort(nums, l + 1, right) return nums 3.2 mergeSortdef mergeSort(nums, l, r): if l &gt;= r: return mid = (l + r) // 2 mergeSort(nums, l, mid) mergeSort(nums, mid + 1, r) arr = [0] * (r - l + 1) k, i, j = 0, l, mid + 1 while i &lt;= mid and j &lt;= r: if nums[i] &lt;= nums[j]: arr[k] = nums[i] k, i = k + 1, i + 1 else: arr[k] = nums[j] # ans += (mid+1-i); k, j = k + 1, j + 1 while i &lt;= mid: arr[k] = nums[i] k, i = k + 1, i + 1 while j &lt;= r: arr[k] = nums[j] k, j = k + 1, j + 1 for i in range(l, r+1): nums[i] = arr[i - l] 3.3 isValidBSTclass Solution: def isValidBST(self, root): stack, pre = [], float(&#x27;-inf&#x27;) while stack or root: while root: stack.append(root) root = root.left root = stack.pop() # å¦‚æœä¸­åºéå†å¾—åˆ°çš„èŠ‚ç‚¹çš„å€¼å°äºç­‰äºå‰ä¸€ä¸ª inorderï¼Œè¯´æ˜ä¸æ˜¯äºŒå‰æœç´¢æ ‘ if root.val &lt;= pre: return False pre = root.val root = root.right return True class Solution: def isValidBST(self, root): def helper(node, lower = float(&#x27;-inf&#x27;), upper = float(&#x27;inf&#x27;)): if not node: return True val = node.val if val &lt;= lower or val &gt;= upper: return False if not helper(node.right, val, upper): return False if not helper(node.left, lower, val): return False return True return helper(root) 3.4 isHappydef isHappy(self, n: int) -&gt; bool: def get_next(number): total_sum = 0 while number &gt; 0: number, digit = divmod(number, 10) total_sum += digit ** 2 return total_sum slow_runner = n fast_runner = get_next(n) while fast_runner != 1 and slow_runner != fast_runner: slow_runner = get_next(slow_runner) fast_runner = get_next(get_next(fast_runner)) return fast_runner == 1 93. å¤åŸIPåœ°å€class Solution: def restoreIpAddresses(self, s: str) -&gt; List[str]: SEG_COUNT = 4 ans = list() segments = [0] * SEG_COUNT def dfs(segId: int, segStart: int): # å¦‚æœæ‰¾åˆ°äº† 4 æ®µ IP åœ°å€å¹¶ä¸”éå†å®Œäº†å­—ç¬¦ä¸²ï¼Œé‚£ä¹ˆå°±æ˜¯ä¸€ç§ç­”æ¡ˆ if segId == SEG_COUNT: if segStart == len(s): ipAddr = &quot;.&quot;.join(str(seg) for seg in segments) ans.append(ipAddr) return # å¦‚æœè¿˜æ²¡æœ‰æ‰¾åˆ° 4 æ®µ IP åœ°å€å°±å·²ç»éå†å®Œäº†å­—ç¬¦ä¸²ï¼Œé‚£ä¹ˆæå‰å›æº¯ if segStart == len(s): return # ç”±äºä¸èƒ½æœ‰å‰å¯¼é›¶ï¼Œå¦‚æœå½“å‰æ•°å­—ä¸º 0ï¼Œé‚£ä¹ˆè¿™ä¸€æ®µ IP åœ°å€åªèƒ½ä¸º 0 if s[segStart] == &quot;0&quot;: segments[segId] = 0 dfs(segId + 1, segStart + 1) # ä¸€èˆ¬æƒ…å†µï¼Œæšä¸¾æ¯ä¸€ç§å¯èƒ½æ€§å¹¶é€’å½’ addr = 0 for segEnd in range(segStart, len(s)): addr = addr * 10 + (ord(s[segEnd]) - ord(&quot;0&quot;)) if 0 &lt; addr &lt;= 0xFF: segments[segId] = addr dfs(segId + 1, segEnd + 1) else: break dfs(0, 0) return ans 46. å…¨æ’åˆ—class Solution: def permute(self, nums): def backtrack(first=0): # æ‰€æœ‰æ•°éƒ½å¡«å®Œäº† if first == n: res.append(nums[:]) for i in range(first, n): # åŠ¨æ€ç»´æŠ¤æ•°ç»„ nums[first], nums[i] = nums[i], nums[first] # ç»§ç»­é€’å½’å¡«ä¸‹ä¸€ä¸ªæ•° backtrack(first + 1) # æ’¤é”€æ“ä½œ nums[first], nums[i] = nums[i], nums[first] n = len(nums) res = [] backtrack(first=0) return res 1262. å¯è¢«ä¸‰æ•´é™¤çš„æœ€å¤§å’Œè¾“å…¥ï¼šnums = [3,6,5,1,8]è¾“å‡ºï¼š18è§£é‡Šï¼šé€‰å‡ºæ•°å­— 3, 6, 1 å’Œ 8ï¼Œå®ƒä»¬çš„å’Œæ˜¯ 18ï¼ˆå¯è¢« 3 æ•´é™¤çš„æœ€å¤§å’Œï¼‰ã€‚ æ–¹æ³•äºŒï¼šè´ªå¿ƒ + é€†å‘æ€ç»´ æˆ‘ä»¬æŠŠæ•°ç»„ä¸­çš„æ•°åˆ†æˆä¸‰éƒ¨åˆ† aï¼Œb å’Œ cï¼Œå®ƒä»¬åˆ†åˆ«åŒ…å«æ‰€æœ‰è¢« 3 é™¤ä½™ 0ï¼Œ1ï¼Œ2 çš„æ•°ã€‚æ˜¾ç„¶ï¼Œæˆ‘ä»¬å¯ä»¥é€‰å– a ä¸­æ‰€æœ‰çš„æ•°ï¼Œè€Œå¯¹äº b å’Œ c ä¸­çš„æ•°ï¼Œæˆ‘ä»¬éœ€è¦æ ¹æ®ä¸åŒçš„æƒ…å†µé€‰å–ä¸åŒæ•°é‡çš„æ•°ã€‚ æˆ‘ä»¬è®¾ tot ä¸ºæ•°ç»„ nums ä¸­æ‰€æœ‰å…ƒç´ çš„å’Œï¼Œæ­¤æ—¶ tot ä¼šæœ‰ä¸‰ç§æƒ…å†µï¼š tot æ˜¯ 3 çš„å€æ•°ï¼Œé‚£ä¹ˆæˆ‘ä»¬ä¸éœ€è¦ä¸¢å¼ƒä»»ä½•æ•°ï¼› tot æ¨¡ 3 ä½™ 1ï¼Œæ­¤æ—¶æˆ‘ä»¬æœ‰ä¸¤ç§é€‰æ‹©ï¼šè¦ä¹ˆä¸¢å¼ƒ b ä¸­æœ€å°çš„ 1 ä¸ªæ•°ï¼Œè¦ä¹ˆä¸¢å¼ƒ c ä¸­æœ€å°çš„ 2 ä¸ª&gt;tot æ¨¡ 3 ä½™ 2ï¼Œæ­¤æ—¶æˆ‘ä»¬æœ‰ä¸¤ç§é€‰æ‹©ï¼šè¦ä¹ˆä¸¢å¼ƒ b ä¸­æœ€å°çš„ 2 ä¸ªæ•°ï¼Œè¦ä¹ˆä¸¢å¼ƒ c ä¸­æœ€å°çš„ 1 ä¸ªæ•°ã€‚ class Solution: def maxSumDivThree(self, nums: List[int]) -&gt; int: a = [x for x in nums if x % 3 == 0] b = sorted([x for x in nums if x % 3 == 1], reverse=True) c = sorted([x for x in nums if x % 3 == 2], reverse=True) tot = sum(nums) ans = 0 if tot % 3 == 0: ans = tot if tot % 3 == 1: if len(b) &gt;= 1: ans = max(ans, tot - b[-1]) if len(c) &gt;= 2: ans = max(ans, tot - sum(c[-2:])) elif tot % 3 == 2: if len(b) &gt;= 2: ans = max(ans, tot - sum(b[-2:])) if len(c) &gt;= 1: ans = max(ans, tot - c[-1]) return ans 4. å¯»æ‰¾ä¸¤ä¸ªæ­£åºæ•°ç»„çš„ä¸­ä½æ•°é¢˜è§£ï¼šäºŒåˆ†æŸ¥æ‰¾ class Solution: def findMedianSortedArrays(self, nums1: List[int], nums2: List[int]) -&gt; float: def getKthElement(k): &quot;&quot;&quot; - ä¸»è¦æ€è·¯ï¼šè¦æ‰¾åˆ°ç¬¬ k (k&gt;1) å°çš„å…ƒç´ ï¼Œé‚£ä¹ˆå°±å– pivot1 = nums1[k/2-1] å’Œ pivot2 = nums2[k/2-1] è¿›è¡Œæ¯”è¾ƒ - è¿™é‡Œçš„ &quot;/&quot; è¡¨ç¤ºæ•´é™¤ - nums1 ä¸­å°äºç­‰äº pivot1 çš„å…ƒç´ æœ‰ nums1[0 .. k/2-2] å…±è®¡ k/2-1 ä¸ª - nums2 ä¸­å°äºç­‰äº pivot2 çš„å…ƒç´ æœ‰ nums2[0 .. k/2-2] å…±è®¡ k/2-1 ä¸ª - å– pivot = min(pivot1, pivot2)ï¼Œä¸¤ä¸ªæ•°ç»„ä¸­å°äºç­‰äº pivot çš„å…ƒç´ å…±è®¡ä¸ä¼šè¶…è¿‡ (k/2-1) + (k/2-1) &lt;= k-2 ä¸ª - è¿™æ · pivot æœ¬èº«æœ€å¤§ä¹Ÿåªèƒ½æ˜¯ç¬¬ k-1 å°çš„å…ƒç´  - å¦‚æœ pivot = pivot1ï¼Œé‚£ä¹ˆ nums1[0 .. k/2-1] éƒ½ä¸å¯èƒ½æ˜¯ç¬¬ k å°çš„å…ƒç´ ã€‚æŠŠè¿™äº›å…ƒç´ å…¨éƒ¨ &quot;åˆ é™¤&quot;ï¼Œå‰©ä¸‹çš„ä½œä¸ºæ–°çš„ nums1 æ•°ç»„ - å¦‚æœ pivot = pivot2ï¼Œé‚£ä¹ˆ nums2[0 .. k/2-1] éƒ½ä¸å¯èƒ½æ˜¯ç¬¬ k å°çš„å…ƒç´ ã€‚æŠŠè¿™äº›å…ƒç´ å…¨éƒ¨ &quot;åˆ é™¤&quot;ï¼Œå‰©ä¸‹çš„ä½œä¸ºæ–°çš„ nums2 æ•°ç»„ - ç”±äºæˆ‘ä»¬ &quot;åˆ é™¤&quot; äº†ä¸€äº›å…ƒç´ ï¼ˆè¿™äº›å…ƒç´ éƒ½æ¯”ç¬¬ k å°çš„å…ƒç´ è¦å°ï¼‰ï¼Œå› æ­¤éœ€è¦ä¿®æ”¹ k çš„å€¼ï¼Œå‡å»åˆ é™¤çš„æ•°çš„ä¸ªæ•° &quot;&quot;&quot; index1, index2 = 0, 0 while True: # ç‰¹æ®Šæƒ…å†µ if index1 == m: return nums2[index2 + k - 1] if index2 == n: return nums1[index1 + k - 1] if k == 1: return min(nums1[index1], nums2[index2]) # æ­£å¸¸æƒ…å†µ newIndex1 = min(index1 + k // 2 - 1, m - 1) # k=6, 2 newIndex2 = min(index2 + k // 2 - 1, n - 1) # k=6, 2 pivot1, pivot2 = nums1[newIndex1], nums2[newIndex2] if pivot1 &lt;= pivot2: k -= newIndex1 - index1 + 1 index1 = newIndex1 + 1 else: k -= newIndex2 - index2 + 1 index2 = newIndex2 + 1 m, n = len(nums1), len(nums2) totalLength = m + n if totalLength % 2 == 1: return getKthElement((totalLength + 1) // 2) else: return (getKthElement(totalLength // 2) + getKthElement(totalLength // 2 + 1)) / 2 ç»éªŒåˆ†äº« Operating System è¿›ç¨‹ä¸çº¿ç¨‹çš„åŒºåˆ« è¿›ç¨‹æ˜¯æ“ä½œç³»ç»Ÿåˆ†é…èµ„æºçš„å•ä½ çº¿ç¨‹(Thread)æ˜¯è¿›ç¨‹çš„ä¸€ä¸ªå®ä½“ï¼Œæ˜¯CPUè°ƒåº¦å’Œåˆ†æ´¾çš„åŸºæœ¬å•ä½ çº¿ç¨‹å’Œè¿›ç¨‹çš„å…³ç³»æ˜¯ï¼šçº¿ç¨‹æ˜¯å±äºè¿›ç¨‹çš„ï¼Œçº¿ç¨‹è¿è¡Œåœ¨è¿›ç¨‹ç©ºé—´å†…ï¼ŒåŒä¸€è¿›ç¨‹æ‰€äº§ç”Ÿçš„çº¿ç¨‹å…±äº«åŒä¸€å†…å­˜ç©ºé—´ï¼Œå½“è¿›ç¨‹é€€å‡ºæ—¶è¯¥è¿›ç¨‹æ‰€äº§ç”Ÿçš„çº¿ç¨‹éƒ½ä¼šè¢«å¼ºåˆ¶é€€å‡ºå¹¶æ¸…é™¤ã€‚çº¿ç¨‹å¯ä¸å±äºåŒä¸€è¿›ç¨‹çš„å…¶å®ƒçº¿ç¨‹å…±äº«è¿›ç¨‹æ‰€æ‹¥æœ‰çš„å…¨éƒ¨èµ„æºï¼Œä½†æ˜¯å…¶æœ¬èº«åŸºæœ¬ä¸Šä¸æ‹¥æœ‰ç³»ç»Ÿèµ„æºï¼Œåªæ‹¥æœ‰ä¸€ç‚¹åœ¨è¿è¡Œä¸­å¿…ä¸å¯å°‘çš„ä¿¡æ¯(å¦‚ç¨‹åºè®¡æ•°å™¨ã€ä¸€ç»„å¯„å­˜å™¨å’Œæ ˆ)ã€‚ è™šæ‹Ÿå†…å­˜æ˜¯æ€ä¹ˆè°ƒåº¦çš„? github OSç¬”è®°è™šæ‹Ÿå†…å­˜è°ƒåº¦æ–¹å¼ï¼ˆé¡µå¼ã€æ®µå¼ã€æ®µé¡µå¼ï¼‰æ€æ ·é€šä¿—çš„ç†è§£æ“ä½œç³»ç»Ÿä¸­å†…å­˜ç®¡ç†åˆ†é¡µå’Œåˆ†æ®µï¼Ÿ åˆ†é¡µæ–¹å¼çš„ä¼˜ç‚¹æ˜¯é¡µé•¿å›ºå®šï¼Œå› è€Œä¾¿äºæ„é€ é¡µè¡¨ã€æ˜“äºç®¡ç†ï¼Œä¸”ä¸å­˜åœ¨å¤–ç¢ç‰‡ã€‚ä½†åˆ†é¡µæ–¹å¼çš„ç¼ºç‚¹æ˜¯é¡µé•¿ä¸ç¨‹åºçš„é€»è¾‘å¤§å°ä¸ç›¸å…³ã€‚ LRU æ˜¯ä»€ä¹ˆ? å¤æ‚åº¦? Cache &amp; é¡µé¢ç½®æ¢ HTTPä¸HTTPSçš„åŒºåˆ« ? ä¸ºäº†æ•°æ®ä¼ è¾“çš„å®‰å…¨ï¼ŒHTTPSåœ¨HTTPçš„åŸºç¡€ä¸ŠåŠ å…¥äº†SSLåè®®ï¼ŒSSLä¾é è¯ä¹¦æ¥éªŒè¯æœåŠ¡å™¨çš„èº«ä»½ï¼Œå¹¶ä¸ºæµè§ˆå™¨å’ŒæœåŠ¡å™¨ä¹‹é—´çš„é€šä¿¡åŠ å¯†ã€‚ HTTPSåè®®çš„ä¸»è¦ä½œç”¨å¯ä»¥åˆ†ä¸ºä¸¤ç§ï¼šä¸€ç§æ˜¯å»ºç«‹ä¸€ä¸ªä¿¡æ¯å®‰å…¨é€šé“ï¼Œæ¥ä¿è¯æ•°æ®ä¼ è¾“çš„å®‰å…¨ï¼›å¦ä¸€ç§å°±æ˜¯ç¡®è®¤ç½‘ç«™çš„çœŸå®æ€§ã€‚ 5. ç½‘ç»œ TCP5.1 ä¸‰æ¬¡æ¡æ‰‹ TCP çš„ä¸‰æ¬¡æ¡æ‰‹, å››æ¬¡æŒ¥æ‰‹: TCP åè®®æ˜¯å¦‚ä½•å»ºç«‹å’Œé‡Šæ”¾è¿æ¥çš„ï¼Ÿ ä¸‰æ¬¡æ¡æ‰‹å»ºç«‹è¿æ¥: ç¬¬ä¸€æ¬¡æ¡æ‰‹ï¼šAç»™Bæ‰“ç”µè¯è¯´ï¼Œä½ å¯ä»¥å¬åˆ°æˆ‘è¯´è¯å—ï¼Ÿï¼ˆseq=xï¼‰ç¬¬äºŒæ¬¡æ¡æ‰‹ï¼šBæ”¶åˆ°äº†Açš„ä¿¡æ¯ï¼Œç„¶åå¯¹Aè¯´ï¼šæˆ‘å¯ä»¥å¬å¾—åˆ°ä½ è¯´è¯å•Šï¼Œä½ èƒ½å¬å¾—åˆ°æˆ‘è¯´è¯å—ï¼Ÿï¼ˆACK=x+1ï¼Œseq=yï¼‰ç¬¬ä¸‰æ¬¡æ¡æ‰‹ï¼šAæ”¶åˆ°äº†Bçš„ä¿¡æ¯ï¼Œç„¶åè¯´å¯ä»¥çš„ï¼Œæˆ‘è¦ç»™ä½ å‘ä¿¡æ¯å•¦ï¼ï¼ˆack=y+1ï¼‰ 5.2 å››æ¬¡æŒ¥æ‰‹ å››æ¬¡æŒ¥æ‰‹é‡Šæ”¾è¿æ¥: A:å–‚ï¼Œæˆ‘ä¸è¯´äº†ã€‚(FIN)B:æˆ‘çŸ¥é“äº†ã€‚ç­‰ä¸‹ï¼Œä¸Šä¸€å¥è¿˜æ²¡è¯´å®Œã€‚Balabalaâ€¦..ï¼ˆACKï¼‰B:å¥½äº†ï¼Œè¯´å®Œäº†ï¼Œæˆ‘ä¹Ÿä¸è¯´äº†ã€‚ï¼ˆFINï¼‰A:æˆ‘çŸ¥é“äº†ã€‚(ACK)Aç­‰å¾… 2MSL,ä¿è¯Bæ”¶åˆ°äº†æ¶ˆæ¯,å¦åˆ™é‡è¯´ä¸€æ¬¡æˆ‘çŸ¥é“äº†ã€‚ TCPå››æ¬¡æŒ¥æ‰‹ä¸­çš„TIME_WAITçŠ¶æ€ Referenceother: Shopeeå¤§æ•°æ® 0086 shopeeé¢˜æ±‡æ€» good - æ–°åŠ å¡Singapore Data infra ç»éªŒåˆ†äº« ä¸€äº©ä¸‰åˆ†åœ° - Shopeeæ–°åŠ å¡é¢ç» 2020 å¹´ Shopee ç§‹æ‹›é¢ç» Shopeeè™¾çš®æŠ€æœ¯é¢ æ“ä½œç³»ç»Ÿè™šæ‹Ÿå†…å­˜è°ƒåº¦æ–¹å¼ï¼ˆé¡µå¼ã€æ®µå¼ã€æ®µé¡µå¼ï¼‰ æ•°ä»“å¤§æ³•å¥½ï¼è·¨å¢ƒç”µå•† Shopee çš„å®æ—¶æ•°ä»“ä¹‹è·¯ other: å„å¤§å…¬å¸è¿‘æœŸ data engineer é¢ç»å¤§å…¨ æ±‚èŒé¢è¯•åˆ†äº« [2019.07.28] é¢åœˆç½‘ shopå¤§æ•°æ®"},{"title":"æ ‡ç­¾æ’ä»¶","date":"2021-06-13T16:29:30.070Z","updated":"2021-06-13T16:29:30.070Z","comments":true,"path":"v4/tag-plugins/index.html","permalink":"http://iequa.com/v4/tag-plugins/index.html","excerpt":"","text":"ä¸ºäº†å…¼å®¹è€ç”¨æˆ·ï¼Œæ—§çš„æ ‡ç­¾æ’ä»¶åœ¨é‡æ„ä¹‹å‰ä¾ç„¶æ²¿ç”¨æ—§çš„æ ¼å¼ï¼Œå³ã€Œè‹±æ–‡é€—å·+ç©ºæ ¼ã€ä½œä¸ºå‚æ•°åˆ†éš”ç¬¦ï¼Œè€Œéƒ¨åˆ†æ–°å¢æ ‡ç­¾æ’ä»¶æ˜¯ã€Œç©ºæ ¼+è‹±æ–‡ç«–çº¿+ç©ºæ ¼ã€ï¼Œè¯·æ³¨æ„åŒºåˆ†ã€‚ æˆ‘ä»¬ä¹Ÿåœ¨æ¢ç´¢å“ªç§åˆ†éš”ç¬¦æ—¢ç®€å•åˆä¸å®¹æ˜“å¼•èµ·å†²çªï¼Œæ‰€ä»¥å¯èƒ½å­˜åœ¨å¤šç§æ ¼å¼ï¼Œå…·ä½“ä»¥å¯¹åº”æ–‡æ¡£æè¿°ä¸ºå‡†ã€‚ textè¿™æ˜¯ä¸€äº›æ–‡æœ¬æ ·å¼æ ‡ç­¾ï¼š å¸¦ ä¸‹åˆ’çº¿ çš„æ–‡æœ¬example.md:å¸¦ &#123;% u ä¸‹åˆ’çº¿ %&#125; çš„æ–‡æœ¬ å¸¦ ç€é‡å· çš„æ–‡æœ¬example.md:å¸¦ &#123;% emp ç€é‡å· %&#125; çš„æ–‡æœ¬ å¸¦ æ³¢æµªçº¿ çš„æ–‡æœ¬example.md:å¸¦ &#123;% wavy æ³¢æµªçº¿ %&#125; çš„æ–‡æœ¬ å¸¦ åˆ é™¤çº¿ çš„æ–‡æœ¬example.md:å¸¦ &#123;% del åˆ é™¤çº¿ %&#125; çš„æ–‡æœ¬ é”®ç›˜æ ·å¼çš„æ–‡æœ¬ command + Dexample.md:é”®ç›˜æ ·å¼çš„æ–‡æœ¬ &#123;% kbd command %&#125; + &#123;% kbd D %&#125; å¯†ç æ ·å¼çš„æ–‡æœ¬ï¼šè¿™é‡Œæ²¡æœ‰éªŒè¯ç example.md:å¯†ç æ ·å¼çš„æ–‡æœ¬ï¼š&#123;% psw è¿™é‡Œæ²¡æœ‰éªŒè¯ç  %&#125; spanæœ¬æ’ä»¶æœ€åæ›´æ–°äº 2.5 ç‰ˆæœ¬&#123;% span æ ·å¼å‚æ•°, æ–‡æœ¬å†…å®¹ %&#125; å½©è‰²æ–‡å­—åœ¨ä¸€æ®µè¯ä¸­æ–¹ä¾¿æ’å…¥å„ç§é¢œè‰²çš„æ ‡ç­¾ï¼ŒåŒ…æ‹¬ï¼šçº¢è‰²ã€é»„è‰²ã€ç»¿è‰²ã€é’è‰²ã€è“è‰²ã€ç°è‰²ã€‚ è¶…å¤§å·æ–‡å­—æ–‡æ¡£ã€Œå¼€å§‹ã€é¡µé¢ä¸­çš„æ ‡é¢˜éƒ¨åˆ†å°±æ˜¯è¶…å¤§å·æ–‡å­—ã€‚ Volantis A Wonderful Theme for Hexo ä¸Šè¿°ç¤ºä¾‹çš„æºç example:#### å½©è‰²æ–‡å­—åœ¨ä¸€æ®µè¯ä¸­æ–¹ä¾¿æ’å…¥å„ç§é¢œè‰²çš„æ ‡ç­¾ï¼ŒåŒ…æ‹¬ï¼š&#123;% span red, çº¢è‰² %&#125;ã€&#123;% span yellow, é»„è‰² %&#125;ã€&#123;% span green, ç»¿è‰² %&#125;ã€&#123;% span cyan, é’è‰² %&#125;ã€&#123;% span blue, è“è‰² %&#125;ã€&#123;% span gray, ç°è‰² %&#125;ã€‚#### è¶…å¤§å·æ–‡å­—æ–‡æ¡£ã€Œå¼€å§‹ã€é¡µé¢ä¸­çš„æ ‡é¢˜éƒ¨åˆ†å°±æ˜¯è¶…å¤§å·æ–‡å­—ã€‚&#123;% span center logo large, Volantis %&#125;&#123;% span center small, A Wonderful Theme for Hexo %&#125; å¯ä»¥æ”¯æŒçš„å‚æ•°æ ·å¼å‚æ•°ä½ç½®å¯ä»¥å†™é¢œè‰²ã€å¤§å°å’Œå¯¹é½æ–¹å‘ï¼Œå¤šä¸ªæ ·å¼å‚æ•°ç”¨ç©ºæ ¼éš”å¼€ã€‚ å­—ä½“logo, code é¢œè‰²red, yellow, green, cyan, blue, gray å¤§å°small, h4, h3, h2, h1, large, huge, ultra å¯¹é½æ–¹å‘left, center, right pæœ¬æ’ä»¶æœ€åæ›´æ–°äº 2.5 ç‰ˆæœ¬&#123;% p æ ·å¼å‚æ•°, æ–‡æœ¬å†…å®¹ %&#125; æ¼”ç¤ºæ•ˆæœå½©è‰²æ–‡å­—åœ¨ä¸€æ®µè¯ä¸­æ–¹ä¾¿æ’å…¥å„ç§é¢œè‰²çš„æ ‡ç­¾ï¼ŒåŒ…æ‹¬ï¼šçº¢è‰²ã€é»„è‰²ã€ç»¿è‰²ã€é’è‰²ã€è“è‰²ã€ç°è‰²ã€‚ è¶…å¤§å·æ–‡å­—æ–‡æ¡£ã€Œå¼€å§‹ã€é¡µé¢ä¸­çš„æ ‡é¢˜éƒ¨åˆ†å°±æ˜¯è¶…å¤§å·æ–‡å­—ã€‚ Volantis A Wonderful Theme for Hexo ä¸Šè¿°ç¤ºä¾‹çš„æºç example:#### å½©è‰²æ–‡å­—åœ¨ä¸€æ®µè¯ä¸­æ–¹ä¾¿æ’å…¥å„ç§é¢œè‰²çš„æ ‡ç­¾ï¼ŒåŒ…æ‹¬ï¼š&#123;% p red, çº¢è‰² %&#125;ã€&#123;% p yellow, é»„è‰² %&#125;ã€&#123;% p green, ç»¿è‰² %&#125;ã€&#123;% p cyan, é’è‰² %&#125;ã€&#123;% p blue, è“è‰² %&#125;ã€&#123;% p gray, ç°è‰² %&#125;ã€‚#### è¶…å¤§å·æ–‡å­—æ–‡æ¡£ã€Œå¼€å§‹ã€é¡µé¢ä¸­çš„æ ‡é¢˜éƒ¨åˆ†å°±æ˜¯è¶…å¤§å·æ–‡å­—ã€‚&#123;% p center logo large, Volantis %&#125;&#123;% p center small, A Wonderful Theme for Hexo %&#125; å¯ä»¥æ”¯æŒçš„å‚æ•°æ ·å¼å‚æ•°ä½ç½®å¯ä»¥å†™é¢œè‰²ã€å¤§å°å’Œå¯¹é½æ–¹å‘ï¼Œå¤šä¸ªæ ·å¼å‚æ•°ç”¨ç©ºæ ¼éš”å¼€ã€‚ å­—ä½“logo, code é¢œè‰²red, yellow, green, cyan, blue, gray å¤§å°small, h4, h3, h2, h1, large, huge, ultra å¯¹é½æ–¹å‘left, center, right noteNoteBlock æ˜¯ Blockquote çš„å¢å¼ºç‰ˆï¼Œåœ¨å·¦è¾¹æ˜¾ç¤ºå›¾æ ‡ï¼Œå¹¶ä¸”å¯ä»¥è‡ªå®šé¢œè‰²ã€‚è€Œ Note æ˜¯ NoteBlock çš„ç®€ä¾¿å†™æ³•ã€‚ æœ€åæ›´æ–°äº 2.3 ç‰ˆæœ¬&#123;% note æ ·å¼å‚æ•°, æ–‡æœ¬å†…å®¹ %&#125; æ¼”ç¤ºæ•ˆæœç»å…¸ç”¨æ³•å¯ä»¥åœ¨é…ç½®æ–‡ä»¶ä¸­è®¾ç½®é»˜è®¤æ ·å¼ï¼Œä¸ºç®€å•çš„ä¸€å¥è¯æä¾›æœ€çš„ç®€ä¾¿å†™æ³•ã€‚ note quote é€‚åˆå¼•ç”¨ä¸€æ®µè¯ note info é»˜è®¤ä¸»é¢˜è‰²ï¼Œé€‚åˆä¸­æ€§çš„ä¿¡æ¯ note warning é»˜è®¤é»„è‰²ï¼Œé€‚åˆè­¦å‘Šæ€§çš„ä¿¡æ¯ note error/danger é»˜è®¤çº¢è‰²ï¼Œé€‚åˆå±é™©æ€§çš„ä¿¡æ¯ note done/success é»˜è®¤ç»¿è‰²ï¼Œé€‚åˆæ­£ç¡®æ“ä½œçš„ä¿¡æ¯ æ›´å¤šå›¾æ ‡è¿™äº›éƒ½æ˜¯é»˜è®¤æ ·å¼ï¼Œå¯ä»¥æ‰‹åŠ¨åŠ ä¸Šé¢œè‰²ï¼š note radiation é»˜è®¤æ ·å¼ note radiation yellow å¯ä»¥åŠ ä¸Šé¢œè‰² note bug red è¯´æ˜è¿˜å­˜åœ¨çš„ä¸€äº›æ•…éšœ note link green å¯ä»¥æ”¾ç½®ä¸€äº›é“¾æ¥ note paperclip blue æ”¾ç½®ä¸€äº›é™„ä»¶é“¾æ¥ note todo å¾…åŠäº‹é¡¹ note guide clear å¯ä»¥åŠ ä¸Šä¸€æ®µå‘å¯¼ note download å¯ä»¥æ”¾ç½®ä¸‹è½½é“¾æ¥ note message gray ä¸€æ®µæ¶ˆæ¯ note up å¯ä»¥è¯´æ˜å¦‚ä½•è¿›è¡Œæ›´æ–° note undo light å¯ä»¥è¯´æ˜å¦‚ä½•æ’¤é”€æˆ–è€…å›é€€ ä¸Šè¿°ç¤ºä¾‹çš„æºç example:#### ç»å…¸ç”¨æ³•&#123;% note, å¯ä»¥åœ¨é…ç½®æ–‡ä»¶ä¸­è®¾ç½®é»˜è®¤æ ·å¼ï¼Œä¸ºç®€å•çš„ä¸€å¥è¯æä¾›æœ€çš„ç®€ä¾¿å†™æ³•ã€‚ %&#125;&#123;% note quote, note quote é€‚åˆå¼•ç”¨ä¸€æ®µè¯ %&#125;&#123;% note info, note info é»˜è®¤ä¸»é¢˜è‰²ï¼Œé€‚åˆä¸­æ€§çš„ä¿¡æ¯ %&#125;&#123;% note warning, note warning é»˜è®¤é»„è‰²ï¼Œé€‚åˆè­¦å‘Šæ€§çš„ä¿¡æ¯ %&#125;&#123;% note danger, note error/danger é»˜è®¤çº¢è‰²ï¼Œé€‚åˆå±é™©æ€§çš„ä¿¡æ¯ %&#125;&#123;% note success, note done/success é»˜è®¤ç»¿è‰²ï¼Œé€‚åˆæ­£ç¡®æ“ä½œçš„ä¿¡æ¯ %&#125;#### æ›´å¤šå›¾æ ‡è¿™äº›éƒ½æ˜¯é»˜è®¤æ ·å¼ï¼Œå¯ä»¥æ‰‹åŠ¨åŠ ä¸Šé¢œè‰²ï¼š&#123;% note radiation, note radiation é»˜è®¤æ ·å¼ %&#125;&#123;% note radiation yellow, note radiation yellow å¯ä»¥åŠ ä¸Šé¢œè‰² %&#125;&#123;% note bug red, note bug red è¯´æ˜è¿˜å­˜åœ¨çš„ä¸€äº›æ•…éšœ %&#125;&#123;% note link green, note link green å¯ä»¥æ”¾ç½®ä¸€äº›é“¾æ¥ %&#125;&#123;% note paperclip blue, note paperclip blue æ”¾ç½®ä¸€äº›é™„ä»¶é“¾æ¥ %&#125;&#123;% note todo, note todo å¾…åŠäº‹é¡¹ %&#125;&#123;% note guide clear, note guide clear å¯ä»¥åŠ ä¸Šä¸€æ®µå‘å¯¼ %&#125;&#123;% note download, note download å¯ä»¥æ”¾ç½®ä¸‹è½½é“¾æ¥ %&#125;&#123;% note message gray, note message gray ä¸€æ®µæ¶ˆæ¯ %&#125;&#123;% note up, note up å¯ä»¥è¯´æ˜å¦‚ä½•è¿›è¡Œæ›´æ–° %&#125;&#123;% note undo light, note undo light å¯ä»¥è¯´æ˜å¦‚ä½•æ’¤é”€æˆ–è€…å›é€€ %&#125; å¯ä»¥æ”¯æŒçš„å‚æ•°æ ·å¼å‚æ•°ä½ç½®å¯ä»¥å†™å›¾æ ‡å’Œé¢œè‰²ï¼Œå¤šä¸ªæ ·å¼å‚æ•°ç”¨ç©ºæ ¼éš”å¼€ã€‚ å›¾æ ‡å½©è‰²çš„quote, info, warning, done/success, error/danger ç°è‰²çš„ï¼Œä¹Ÿå¯ä»¥æŒ‡å®šé¢œè‰²radiation, bug, idea, link, paperclip, todo, message, guide, download, up, undo é¢œè‰²æŒ‡å®šé¢œè‰²clear, light, gray, red, yellow, green, cyan, blue noteblockNoteBlock æ˜¯ Blockquote çš„å¢å¼ºç‰ˆï¼Œåœ¨å·¦è¾¹æ˜¾ç¤ºå›¾æ ‡ï¼Œå¹¶ä¸”å¯ä»¥è‡ªå®šé¢œè‰²ã€‚è€Œ Note æ˜¯ NoteBlock çš„ç®€ä¾¿å†™æ³•ã€‚ æœ€åæ›´æ–°äº 4.0 ç‰ˆæœ¬&#123;% noteblock æ ·å¼å‚æ•°ï¼ˆå¯é€‰ï¼‰, æ ‡é¢˜ï¼ˆå¯é€‰ï¼‰ %&#125;æ–‡æœ¬æ®µè½&#123;% endnoteblock %&#125; æ¼”ç¤ºæ•ˆæœå¯ä»¥åœ¨åŒºå—ä¸­æ”¾ç½®ä¸€äº›å¤æ‚çš„ç»“æ„ï¼Œæ”¯æŒåµŒå¥—ã€‚ æ ‡é¢˜ï¼ˆå¯é€‰ï¼‰Windows 10ä¸æ˜¯ç‚ºæ‰€æœ‰äººè¨­è¨ˆ,è€Œæ˜¯ç‚ºæ¯å€‹äººè¨­è¨ˆåµŒå¥—æµ‹è¯•ï¼š è¯·åå’Œæ”¾å®½ï¼Œæˆ‘æ­£åœ¨å¸®ä½ æå®šä¸€åˆ‡â€¦ Folding æµ‹è¯•ï¼š ç‚¹å‡»æŸ¥çœ‹æ›´å¤š ä¸è¦è¯´æˆ‘ä»¬æ²¡æœ‰è­¦å‘Šè¿‡ä½ æˆ‘ä»¬éƒ½æœ‰ä¸é¡ºåˆ©çš„æ—¶å€™ ä¸Šè¿°ç¤ºä¾‹çš„æºç example:&#123;% noteblock, æ ‡é¢˜ï¼ˆå¯é€‰ï¼‰ %&#125;Windows 10ä¸æ˜¯ç‚ºæ‰€æœ‰äººè¨­è¨ˆ,è€Œæ˜¯ç‚ºæ¯å€‹äººè¨­è¨ˆ&#123;% noteblock done %&#125;åµŒå¥—æµ‹è¯•ï¼š è¯·åå’Œæ”¾å®½ï¼Œæˆ‘æ­£åœ¨å¸®ä½ æå®šä¸€åˆ‡...&#123;% endnoteblock %&#125;&#123;% folding yellow, Folding æµ‹è¯•ï¼š ç‚¹å‡»æŸ¥çœ‹æ›´å¤š %&#125;&#123;% note warning, ä¸è¦è¯´æˆ‘ä»¬æ²¡æœ‰è­¦å‘Šè¿‡ä½  %&#125;&#123;% noteblock bug red %&#125;æˆ‘ä»¬éƒ½æœ‰ä¸é¡ºåˆ©çš„æ—¶å€™&#123;% endnoteblock %&#125;&#123;% endfolding %&#125;&#123;% endnoteblock %&#125; å¯ä»¥æ”¯æŒçš„å‚æ•°æ ·å¼å‚æ•°ä½ç½®å¯ä»¥å†™å›¾æ ‡å’Œé¢œè‰²ï¼Œå¤šä¸ªæ ·å¼å‚æ•°ç”¨ç©ºæ ¼éš”å¼€ã€‚ å›¾æ ‡å½©è‰²çš„quote, info, warning, done/success, error/danger ç°è‰²çš„ï¼Œä¹Ÿå¯ä»¥æŒ‡å®šé¢œè‰²radiation, bug, idea, link, paperclip, todo, message, guide, download, up, undo é¢œè‰²æŒ‡å®šé¢œè‰²clear, light, gray, red, yellow, green, cyan, blue checkboxæœ€åæ›´æ–°äº 2.6 ç‰ˆæœ¬&#123;% checkbox æ ·å¼å‚æ•°ï¼ˆå¯é€‰ï¼‰, æ–‡æœ¬ï¼ˆæ”¯æŒç®€å•mdï¼‰ %&#125; æ¼”ç¤ºæ•ˆæœ çº¯æ–‡æœ¬æµ‹è¯• æ”¯æŒç®€å•çš„ markdown è¯­æ³• æ”¯æŒè‡ªå®šä¹‰é¢œè‰² ç»¿è‰² + é»˜è®¤é€‰ä¸­ é»„è‰² + é»˜è®¤é€‰ä¸­ é’è‰² + é»˜è®¤é€‰ä¸­ è“è‰² + é»˜è®¤é€‰ä¸­ å¢åŠ  å‡å°‘ å‰ ä¸Šè¿°ç¤ºä¾‹çš„æºç example:&#123;% checkbox çº¯æ–‡æœ¬æµ‹è¯• %&#125;&#123;% checkbox checked, æ”¯æŒç®€å•çš„ [markdown](https://guides.github.com/features/mastering-markdown/) è¯­æ³• %&#125;&#123;% checkbox red, æ”¯æŒè‡ªå®šä¹‰é¢œè‰² %&#125;&#123;% checkbox green checked, ç»¿è‰² + é»˜è®¤é€‰ä¸­ %&#125;&#123;% checkbox yellow checked, é»„è‰² + é»˜è®¤é€‰ä¸­ %&#125;&#123;% checkbox cyan checked, é’è‰² + é»˜è®¤é€‰ä¸­ %&#125;&#123;% checkbox blue checked, è“è‰² + é»˜è®¤é€‰ä¸­ %&#125;&#123;% checkbox plus green checked, å¢åŠ  %&#125;&#123;% checkbox minus yellow checked, å‡å°‘ %&#125;&#123;% checkbox times red checked, å‰ %&#125; å¯ä»¥æ”¯æŒçš„å‚æ•°é¢œè‰²red, yellow, green, cyan, blue æ ·å¼plus, minus, times é€‰ä¸­çŠ¶æ€checked radioæœ€åæ›´æ–°äº 2.6 ç‰ˆæœ¬&#123;% checkbox æ ·å¼å‚æ•°ï¼ˆå¯é€‰ï¼‰, æ–‡æœ¬ï¼ˆæ”¯æŒç®€å•mdï¼‰ %&#125; æ¼”ç¤ºæ•ˆæœ çº¯æ–‡æœ¬æµ‹è¯• æ”¯æŒç®€å•çš„ markdown è¯­æ³• æ”¯æŒè‡ªå®šä¹‰é¢œè‰² ç»¿è‰² é»„è‰² é’è‰² è“è‰² ä¸Šè¿°ç¤ºä¾‹çš„æºç example:&#123;% radio çº¯æ–‡æœ¬æµ‹è¯• %&#125;&#123;% radio checked, æ”¯æŒç®€å•çš„ [markdown](https://guides.github.com/features/mastering-markdown/) è¯­æ³• %&#125;&#123;% radio red, æ”¯æŒè‡ªå®šä¹‰é¢œè‰² %&#125;&#123;% radio green, ç»¿è‰² %&#125;&#123;% radio yellow, é»„è‰² %&#125;&#123;% radio cyan, é’è‰² %&#125;&#123;% radio blue, è“è‰² %&#125; å¯ä»¥æ”¯æŒçš„å‚æ•°é¢œè‰²red, yellow, green, cyan, blue é€‰ä¸­çŠ¶æ€checked timelineæœ€åæ›´æ–°äº 3.0 ç‰ˆæœ¬&#123;% timeline æ—¶é—´çº¿æ ‡é¢˜ï¼ˆå¯é€‰ï¼‰ %&#125;&#123;% timenode æ—¶é—´èŠ‚ç‚¹ï¼ˆæ ‡é¢˜ï¼‰ %&#125;æ­£æ–‡å†…å®¹&#123;% endtimenode %&#125;&#123;% timenode æ—¶é—´èŠ‚ç‚¹ï¼ˆæ ‡é¢˜ï¼‰ %&#125;æ­£æ–‡å†…å®¹&#123;% endtimenode %&#125;&#123;% endtimeline %&#125; æ¼”ç¤ºæ•ˆæœ 2020-07-24 2.6.6 -&gt; 3.0 å¦‚æœæœ‰ hexo-lazyload-image æ’ä»¶ï¼Œéœ€è¦åˆ é™¤å¹¶é‡æ–°å®‰è£…æœ€æ–°ç‰ˆæœ¬ï¼Œè®¾ç½® lazyload.isSPA: trueã€‚2.x ç‰ˆæœ¬çš„ css å’Œ js ä¸é€‚ç”¨äº 3.x ç‰ˆæœ¬ï¼Œå¦‚æœä½¿ç”¨äº† use_cdn: true åˆ™éœ€è¦åˆ é™¤ã€‚2.x ç‰ˆæœ¬çš„ fancybox æ ‡ç­¾åœ¨ 3.x ç‰ˆæœ¬ä¸­è¢«é‡å‘½åä¸º gallery ã€‚2.x ç‰ˆæœ¬çš„ç½®é¡¶ top: true æ”¹ä¸ºäº† pin: trueï¼Œå¹¶ä¸”åŒæ ·é€‚ç”¨äº layout: page çš„é¡µé¢ã€‚å¦‚æœä½¿ç”¨äº† hexo-offline æ’ä»¶ï¼Œå»ºè®®å¸è½½ï¼Œ3.0 ç‰ˆæœ¬é»˜è®¤å¼€å¯äº† pjax æœåŠ¡ã€‚ 2020-05-15 2.6.3 -&gt; 2.6.6 ä¸éœ€è¦é¢å¤–å¤„ç†ã€‚ 2020-04-20 2.6.2 -&gt; 2.6.3 å…¨å±€æœç´¢ seotitle å¹¶æ›¿æ¢ä¸º seo_titleã€‚group ç»„ä»¶çš„ç´¢å¼•è§„åˆ™æœ‰å˜ï¼Œä½¿ç”¨ group ç»„ä»¶çš„æ–‡ç« å†…ï¼Œgroup: group_name å¯¹åº”çš„ç»„ä»¶åå¿…é¡»æ˜¯ group_nameã€‚group ç»„ä»¶çš„åˆ—è¡¨åä¼˜å…ˆæ˜¾ç¤ºæ–‡ç« çš„ short_title å…¶æ¬¡æ˜¯ titleã€‚ ä¸Šè¿°ç¤ºä¾‹çš„æºç example:&#123;% timeline %&#125;&#123;% timenode 2020-07-24 [2.6.6 -&gt; 3.0](https://github.com/volantis-x/hexo-theme-volantis/releases) %&#125;1. å¦‚æœæœ‰ `hexo-lazyload-image` æ’ä»¶ï¼Œéœ€è¦åˆ é™¤å¹¶é‡æ–°å®‰è£…æœ€æ–°ç‰ˆæœ¬ï¼Œè®¾ç½® `lazyload.isSPA: true`ã€‚2. 2.x ç‰ˆæœ¬çš„ css å’Œ js ä¸é€‚ç”¨äº 3.x ç‰ˆæœ¬ï¼Œå¦‚æœä½¿ç”¨äº† `use_cdn: true` åˆ™éœ€è¦åˆ é™¤ã€‚3. 2.x ç‰ˆæœ¬çš„ fancybox æ ‡ç­¾åœ¨ 3.x ç‰ˆæœ¬ä¸­è¢«é‡å‘½åä¸º gallery ã€‚4. 2.x ç‰ˆæœ¬çš„ç½®é¡¶ `top: true` æ”¹ä¸ºäº† `pin: true`ï¼Œå¹¶ä¸”åŒæ ·é€‚ç”¨äº `layout: page` çš„é¡µé¢ã€‚5. å¦‚æœä½¿ç”¨äº† `hexo-offline` æ’ä»¶ï¼Œå»ºè®®å¸è½½ï¼Œ3.0 ç‰ˆæœ¬é»˜è®¤å¼€å¯äº† pjax æœåŠ¡ã€‚&#123;% endtimenode %&#125;&#123;% timenode 2020-05-15 [2.6.3 -&gt; 2.6.6](https://github.com/volantis-x/hexo-theme-volantis/releases/tag/2.6.6) %&#125;ä¸éœ€è¦é¢å¤–å¤„ç†ã€‚&#123;% endtimenode %&#125;&#123;% timenode 2020-04-20 [2.6.2 -&gt; 2.6.3](https://github.com/volantis-x/hexo-theme-volantis/releases/tag/2.6.3) %&#125;1. å…¨å±€æœç´¢ `seotitle` å¹¶æ›¿æ¢ä¸º `seo_title`ã€‚2. group ç»„ä»¶çš„ç´¢å¼•è§„åˆ™æœ‰å˜ï¼Œä½¿ç”¨ group ç»„ä»¶çš„æ–‡ç« å†…ï¼Œ`group: group_name` å¯¹åº”çš„ç»„ä»¶åå¿…é¡»æ˜¯ `group_name`ã€‚2. group ç»„ä»¶çš„åˆ—è¡¨åä¼˜å…ˆæ˜¾ç¤ºæ–‡ç« çš„ `short_title` å…¶æ¬¡æ˜¯ `title`ã€‚&#123;% endtimenode %&#125;&#123;% endtimeline %&#125; linkæœ€åæ›´æ–°äº 3.0 ç‰ˆæœ¬&#123;% link æ ‡é¢˜, é“¾æ¥, å›¾ç‰‡é“¾æ¥ï¼ˆå¯é€‰ï¼‰ %&#125; æ¼”ç¤ºæ•ˆæœå¦‚ä½•å‚ä¸é¡¹ç›®https://volantis.js.org/contributors/ ä¸Šè¿°ç¤ºä¾‹çš„æºç example:&#123;% link å¦‚ä½•å‚ä¸é¡¹ç›®, https://volantis.js.org/contributors/, https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets@master/logo/256/safari.png %&#125; buttonè¿™ä¸ªé¡µé¢çš„æ ‡ç­¾å°†ä¼šåœ¨ä¸ä¹…åé‡æ„ åŸºç¡€æŒ‰é’®è¯·å°†æ‚¨çš„ Volantis å‡çº§è‡³ 2.4 ç‰ˆæœ¬ä»¥ä¸Šä½¿ç”¨ã€‚ è¯­æ³•æ ¼å¼å‚æ•°åˆ—è¡¨ç¤ºä¾‹å†™æ³•ç¤ºä¾‹æ•ˆæœ&#123;% btn æ ·å¼å‚æ•°ï¼ˆå¯é€‰ï¼‰, æ ‡é¢˜, é“¾æ¥, å›¾æ ‡ï¼ˆå¯é€‰ï¼‰ %&#125; å¯é€‰çš„å‚æ•°å¯ä»¥çœç•¥ï¼Œä½†æ˜¯å‰åé¡ºåºä¸èƒ½ä¹±ã€‚æ ·å¼å‚æ•° regular, large, center å›¾æ ‡ ç¬¬1ä¸ªæˆ–è€…ç¬¬2ä¸ªå‚æ•°åŒ…å« fa- çš„é‚£ä¸ªè¢«è¯†åˆ«ä¸ºå›¾æ ‡ã€‚example.md:ä¸è®¾ç½®ä»»ä½•å‚æ•°çš„ &#123;% btn æŒ‰é’®, / %&#125; é€‚åˆèå…¥æ®µè½ä¸­ã€‚regular æŒ‰é’®é€‚åˆç‹¬ç«‹äºæ®µè½ä¹‹å¤–ï¼š&#123;% btn regular, ç¤ºä¾‹åšå®¢, https://xaoxuu.com, fas fa-play-circle %&#125;large æŒ‰é’®æ›´å…·æœ‰å¼ºè°ƒä½œç”¨ï¼Œå»ºè®®æ­é… center ä½¿ç”¨ï¼š&#123;% btn center large, å¼€å§‹ä½¿ç”¨, https://volantis.js.org/v3/getting-started/, fas fa-download %&#125;è¡Œå†…æŒ‰é’® ä¸è®¾ç½®ä»»ä½•å‚æ•°çš„ æŒ‰é’® é€‚åˆèå…¥æ®µè½ä¸­ã€‚ ç©ºå¿ƒæŒ‰é’® ç¤ºä¾‹åšå®¢ ç¤ºä¾‹åšå®¢ ç¤ºä¾‹åšå®¢ ç¤ºä¾‹åšå®¢ å±…ä¸­ï¼š å¼€å§‹ä½¿ç”¨ å®å¿ƒæŒ‰é’® ç¤ºä¾‹åšå®¢ ç¤ºä¾‹åšå®¢ ç¤ºä¾‹åšå®¢ ç¤ºä¾‹åšå®¢ å±…ä¸­ï¼š å¼€å§‹ä½¿ç”¨ å¯Œæ–‡æœ¬æŒ‰é’®è¯·å°†æ‚¨çš„ Volantis å‡çº§è‡³ 2.3 ç‰ˆæœ¬ä»¥ä¸Šä½¿ç”¨ã€‚ è¯­æ³•æ ¼å¼å‚æ•°åˆ—è¡¨ç¤ºä¾‹å†™æ³•ç¤ºä¾‹æ•ˆæœ&#123;% btns æ ·å¼å‚æ•° %&#125;&#123;% cell æ ‡é¢˜, é“¾æ¥, å›¾ç‰‡æˆ–è€…å›¾æ ‡ %&#125;&#123;% cell æ ‡é¢˜, é“¾æ¥, å›¾ç‰‡æˆ–è€…å›¾æ ‡ %&#125;&#123;% endbtns %&#125;æ ·å¼å‚æ•°ä½ç½®å¯ä»¥å†™å›¾ç‰‡æ ·å¼ã€å¸ƒå±€æ–¹å¼ï¼Œå¤šä¸ªæ ·å¼å‚æ•°ç”¨ç©ºæ ¼éš”å¼€ã€‚ åœ†è§’æ ·å¼ é»˜è®¤ä¸ºæ–¹å½¢ rounded, circle å¸ƒå±€æ–¹å¼ é»˜è®¤ä¸ºè‡ªåŠ¨å®½åº¦ï¼Œé€‚åˆè§†é‡å†…åªæœ‰ä¸€ä¸¤ä¸ªçš„æƒ…å†µã€‚ å‚æ•° å«ä¹‰ wide å®½ä¸€ç‚¹çš„æŒ‰é’® fill å¡«å……å¸ƒå±€ï¼Œè‡ªåŠ¨é“ºæ»¡è‡³å°‘ä¸€è¡Œï¼Œå¤šäº†ä¼šæ¢è¡Œã€‚ center å±…ä¸­ï¼ŒæŒ‰é’®ä¹‹é—´æ˜¯å›ºå®šé—´è·ã€‚ around å±…ä¸­åˆ†æ•£ grid2 ç­‰å®½æœ€å¤š2åˆ—ï¼Œå±å¹•å˜çª„ä¼šé€‚å½“å‡å°‘åˆ—æ•°ã€‚ grid3 ç­‰å®½æœ€å¤š3åˆ—ï¼Œå±å¹•å˜çª„ä¼šé€‚å½“å‡å°‘åˆ—æ•°ã€‚ grid4 ç­‰å®½æœ€å¤š4åˆ—ï¼Œå±å¹•å˜çª„ä¼šé€‚å½“å‡å°‘åˆ—æ•°ã€‚ grid5 ç­‰å®½æœ€å¤š5åˆ—ï¼Œå±å¹•å˜çª„ä¼šé€‚å½“å‡å°‘åˆ—æ•°ã€‚ å¢åŠ æ–‡å­—æ ·å¼ å¯ä»¥åœ¨å®¹å™¨å†…å¢åŠ  &lt;b&gt;æ ‡é¢˜&lt;/b&gt; å’Œ &lt;p&gt;æè¿°æ–‡å­—&lt;/p&gt;å¦‚æœéœ€è¦æ˜¾ç¤ºç±»ä¼¼ã€Œå›¢é˜Ÿæˆå‘˜ã€ä¹‹ç±»çš„ä¸€ç»„å«æœ‰å¤´åƒçš„é“¾æ¥ï¼š example.md:&#123;% btns circle grid5 %&#125;&#123;% cell xaoxuu, https://xaoxuu.com, https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/avatar/avatar.png %&#125;&#123;% cell xaoxuu, https://xaoxuu.com, https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/avatar/avatar.png %&#125;&#123;% cell xaoxuu, https://xaoxuu.com, https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/avatar/avatar.png %&#125;&#123;% cell xaoxuu, https://xaoxuu.com, https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/avatar/avatar.png %&#125;&#123;% cell xaoxuu, https://xaoxuu.com, https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/avatar/avatar.png %&#125;&#123;% endbtns %&#125; æˆ–è€…å«æœ‰å›¾æ ‡çš„æŒ‰é’®ï¼š example.md:&#123;% btns rounded grid5 %&#125;&#123;% cell ä¸‹è½½æºç , /, fas fa-download %&#125;&#123;% cell æŸ¥çœ‹æ–‡æ¡£, /, fas fa-book-open %&#125;&#123;% endbtns %&#125; åœ†å½¢å›¾æ ‡ + æ ‡é¢˜ + æè¿° + å›¾ç‰‡ + ç½‘æ ¼5åˆ— + å±…ä¸­ example.md:&#123;% btns circle center grid5 %&#125;&lt;a href=&#x27;https://apps.apple.com/cn/app/heart-mate-pro-hrm-utility/id1463348922?ls=1&#x27;&gt; &lt;i class=&#x27;fab fa-apple&#x27;&gt;&lt;/i&gt; &lt;b&gt;å¿ƒç‡ç®¡å®¶&lt;/b&gt; &#123;% p red, ä¸“ä¸šç‰ˆ %&#125; &lt;img src=&#x27;https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/qrcode/heartmate_pro.png&#x27;&gt;&lt;/a&gt;&lt;a href=&#x27;https://apps.apple.com/cn/app/heart-mate-lite-hrm-utility/id1475747930?ls=1&#x27;&gt; &lt;i class=&#x27;fab fa-apple&#x27;&gt;&lt;/i&gt; &lt;b&gt;å¿ƒç‡ç®¡å®¶&lt;/b&gt; &#123;% p green, å…è´¹ç‰ˆ %&#125; &lt;img src=&#x27;https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/qrcode/heartmate_lite.png&#x27;&gt;&lt;/a&gt;&#123;% endbtns %&#125;å¦‚æœéœ€è¦æ˜¾ç¤ºç±»ä¼¼ã€Œå›¢é˜Ÿæˆå‘˜ã€ä¹‹ç±»çš„ä¸€ç»„å«æœ‰å¤´åƒçš„é“¾æ¥ï¼š xaoxuu xaoxuu xaoxuu xaoxuu xaoxuu æˆ–è€…å«æœ‰å›¾æ ‡çš„æŒ‰é’®ï¼š ä¸‹è½½æºç  æŸ¥çœ‹æ–‡æ¡£ åœ†å½¢å›¾æ ‡ + æ ‡é¢˜ + æè¿° + å›¾ç‰‡ + ç½‘æ ¼5åˆ— + å±…ä¸­ å¿ƒç‡ç®¡å®¶ ä¸“ä¸šç‰ˆ å¿ƒç‡ç®¡å®¶ å…è´¹ç‰ˆ ghcardæœ€åæ›´æ–°äº 4.0 ç‰ˆæœ¬&#123;% ghcard ç”¨æˆ·å, å…¶å®ƒå‚æ•°ï¼ˆå¯é€‰ï¼‰ %&#125;&#123;% ghcard ç”¨æˆ·å/ä»“åº“, å…¶å®ƒå‚æ•°ï¼ˆå¯é€‰ï¼‰ %&#125; ç”¨æˆ·ä¿¡æ¯å¡ç‰‡ ä¸Šè¿°ç¤ºä¾‹çš„æºç ï¼š example:| &#123;% ghcard xaoxuu %&#125; | &#123;% ghcard xaoxuu, theme=vue %&#125; || -- | -- || &#123;% ghcard xaoxuu, theme=buefy %&#125; | &#123;% ghcard xaoxuu, theme=solarized-light %&#125; || &#123;% ghcard xaoxuu, theme=onedark %&#125; | &#123;% ghcard xaoxuu, theme=solarized-dark %&#125; || &#123;% ghcard xaoxuu, theme=algolia %&#125; | &#123;% ghcard xaoxuu, theme=calm %&#125; | ä»“åº“ä¿¡æ¯å¡ç‰‡ ä¸Šè¿°ç¤ºä¾‹çš„æºç ï¼š example:| &#123;% ghcard volantis-x/hexo-theme-volantis %&#125; | &#123;% ghcard volantis-x/hexo-theme-volantis, theme=vue %&#125; || -- | -- || &#123;% ghcard volantis-x/hexo-theme-volantis, theme=buefy %&#125; | &#123;% ghcard volantis-x/hexo-theme-volantis, theme=solarized-light %&#125; || &#123;% ghcard volantis-x/hexo-theme-volantis, theme=onedark %&#125; | &#123;% ghcard volantis-x/hexo-theme-volantis, theme=solarized-dark %&#125; || &#123;% ghcard volantis-x/hexo-theme-volantis, theme=algolia %&#125; | &#123;% ghcard volantis-x/hexo-theme-volantis, theme=calm %&#125; | æ›´å¤šå‚æ•°é€‰æ‹©GitHub å¡ç‰‡ API å‚æ•°https://github-readme-stats.vercel.app siteç½‘ç«™å¡ç‰‡å¯ä»¥æ˜¾ç¤ºç½‘ç«™æˆªå›¾ã€logoã€æ ‡é¢˜ã€æè¿°ï¼Œä½¿ç”¨æ–¹æ³•å’Œå‹é“¾æ ‡ç­¾ä¸€æ¨¡ä¸€æ ·ï¼Œå”¯ä¸€çš„åŒºåˆ«æ˜¯æ•°æ®æ–‡ä»¶åç§°ä¸º sites.ymlï¼Œå¯ä»¥å’Œå‹é“¾æ•°æ®æ··ç”¨ï¼Œé€šè¿‡åˆ†ç»„è¿‡æ»¤å®ç°ä¸ä¸€æ ·çš„æ•ˆæœã€‚ ç¤ºä¾‹å†™æ³•&#123;% sites only:community_team %&#125; sites only:community_team dropmenuè¿™ä¸ªé¡µé¢çš„æ ‡ç­¾å°†ä¼šåœ¨ä¸ä¹…åé‡æ„ ä¸‹æ‹‰èœå•è¯·å°†æ‚¨çš„ Volantis å‡çº§è‡³ 3.0 ç‰ˆæœ¬ä»¥ä¸Šä½¿ç”¨ã€‚ è¯­æ³•æ ¼å¼ç¤ºä¾‹å†™æ³•ç¤ºä¾‹æ•ˆæœå®¹å™¨ &#123;% menu å‰ç¼€ï¼ˆå¯çœç•¥ï¼‰, æ ‡é¢˜, åç¼€ï¼ˆå¯çœç•¥ï¼‰ %&#125;èœå•å†…å®¹&#123;% endmenu %&#125; èœå•å†…å®¹ èœå•é¡¹ &#123;% menuitem æ–‡æœ¬, é“¾æ¥, å›¾æ ‡ %&#125; åˆ†å‰²çº¿ &#123;% menuitem hr %&#125; å­èœå• &#123;% submenu åµŒå¥—èœå•, å›¾æ ‡ %&#125;èœå•å†…å®¹&#123;% endsubmenu %&#125;ç¤ºä¾‹1 &#123;% menu ä¸‹æ‹‰èœå• %&#125;&#123;% menuitem ä¸»é¢˜æºç , https://github.com/volantis-x/hexo-theme-volantis/, fas fa-file-code %&#125;&#123;% menuitem æ›´æ–°æ—¥å¿—, https://github.com/volantis-x/hexo-theme-volantis/releases/, fas fa-clipboard-list %&#125;&#123;% menuitem hr %&#125;&#123;% submenu æœ‰ç–‘é—®ï¼Ÿ, fas fa-question-circle %&#125;&#123;% menuitem çœ‹ FAQ, /faqs/ %&#125;&#123;% menuitem çœ‹ æœ¬ç«™æºç , https://github.com/volantis-x/volantis-docs/ %&#125;&#123;% menuitem æ Issue, https://github.com/volantis-x/hexo-theme-volantis/issues/ %&#125;&#123;% endsubmenu %&#125;&#123;% endmenu %&#125; ç¤ºä¾‹2 &#123;% menu è¿™ä¸ªæ˜¯, ä¸‹æ‹‰èœå• %&#125;ï¼ˆåŒä¸Šï¼‰&#123;% endmenu %&#125; ç¤ºä¾‹3 &#123;% menu è¿™ä¸ªæ˜¯, ä¸‹æ‹‰èœå•, çš„ç¤ºä¾‹æ•ˆæœã€‚ %&#125;ï¼ˆåŒä¸Šï¼‰&#123;% endmenu %&#125;ç¤ºä¾‹1 ä¸‹æ‹‰èœå• ä¸»é¢˜æºç  æ›´æ–°æ—¥å¿— æœ‰ç–‘é—®ï¼Ÿ çœ‹ FAQ çœ‹ æœ¬ç«™æºç  æ Issue ç¤ºä¾‹2 è¿™ä¸ªæ˜¯ ä¸‹æ‹‰èœå• ä¸»é¢˜æºç  æ›´æ–°æ—¥å¿— æœ‰ç–‘é—®ï¼Ÿ çœ‹ FAQ çœ‹ æœ¬ç«™æºç  æ Issue ç¤ºä¾‹3 è¿™ä¸ªæ˜¯ ä¸‹æ‹‰èœå• ä¸»é¢˜æºç  æ›´æ–°æ—¥å¿— æœ‰ç–‘é—®ï¼Ÿ çœ‹ FAQ çœ‹ æœ¬ç«™æºç  æ Issue çš„ç¤ºä¾‹æ•ˆæœã€‚ tabæ­¤æ’ä»¶ç§»æ¤è‡ª NexT #tabs æœ€åæ›´æ–°äº 2.1 ç‰ˆæœ¬&#123;% tabs é¡µé¢å†…ä¸é‡å¤çš„ID %&#125;&lt;!-- tab æ ç›®1 --&gt;å†…å®¹&lt;!-- endtab --&gt;&lt;!-- tab æ ç›®2 --&gt;å†…å®¹&lt;!-- endtab --&gt;&#123;% endtabs %&#125; æ¼”ç¤ºæ•ˆæœæ ç›®1æ ç›®2ã€‚ã€‚ã€‚ï¼ï¼ï¼ ä¸Šè¿°ç¤ºä¾‹çš„æºç example:&#123;% tabs tab-id %&#125;&lt;!-- tab æ ç›®1 --&gt;ã€‚ã€‚ã€‚&lt;!-- endtab --&gt;&lt;!-- tab æ ç›®2 --&gt;ï¼ï¼ï¼&lt;!-- endtab --&gt;&#123;% endtabs %&#125; foldingæœ€åæ›´æ–°äº 2.3 ç‰ˆæœ¬&#123;% folding å‚æ•°ï¼ˆå¯é€‰ï¼‰, æ ‡é¢˜ %&#125;![](https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper/abstract/41F215B9-261F-48B4-80B5-4E86E165259E.jpeg)&#123;% endfolding %&#125; æ¼”ç¤ºæ•ˆæœ æŸ¥çœ‹å›¾ç‰‡æµ‹è¯• æŸ¥çœ‹é»˜è®¤æ‰“å¼€çš„æŠ˜å æ¡† è¿™æ˜¯ä¸€ä¸ªé»˜è®¤æ‰“å¼€çš„æŠ˜å æ¡†ã€‚ æŸ¥çœ‹ä»£ç æµ‹è¯• &#123;% folding green, æŸ¥çœ‹ä»£ç æµ‹è¯• %&#125;æŸ¥çœ‹ä»£ç æµ‹è¯•&#123;% endfolding %&#125; æŸ¥çœ‹åˆ—è¡¨æµ‹è¯• hahahehe æŸ¥çœ‹åµŒå¥—æµ‹è¯• æŸ¥çœ‹åµŒå¥—æµ‹è¯•2 æŸ¥çœ‹åµŒå¥—æµ‹è¯•3 hahaha ä¸Šè¿°ç¤ºä¾‹çš„æºç example:&#123;% folding æŸ¥çœ‹å›¾ç‰‡æµ‹è¯• %&#125;![](https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper/abstract/41F215B9-261F-48B4-80B5-4E86E165259E.jpeg)&#123;% endfolding %&#125;&#123;% folding cyan open, æŸ¥çœ‹é»˜è®¤æ‰“å¼€çš„æŠ˜å æ¡† %&#125;è¿™æ˜¯ä¸€ä¸ªé»˜è®¤æ‰“å¼€çš„æŠ˜å æ¡†ã€‚&#123;% endfolding %&#125;&#123;% folding green, æŸ¥çœ‹ä»£ç æµ‹è¯• %&#125;&#123;% endfolding %&#125;&#123;% folding yellow, æŸ¥çœ‹åˆ—è¡¨æµ‹è¯• %&#125;- haha- hehe&#123;% endfolding %&#125;&#123;% folding red, æŸ¥çœ‹åµŒå¥—æµ‹è¯• %&#125;&#123;% folding blue, æŸ¥çœ‹åµŒå¥—æµ‹è¯•2 %&#125;&#123;% folding æŸ¥çœ‹åµŒå¥—æµ‹è¯•3 %&#125;hahaha &lt;span&gt;&lt;img src=&#x27;https://cdn.jsdelivr.net/gh/volantis-x/cdn-emoji/tieba/%E6%BB%91%E7%A8%BD.png&#x27; style=&#x27;height:24px&#x27;&gt;&lt;/span&gt;&#123;% endfolding %&#125;&#123;% endfolding %&#125;&#123;% endfolding %&#125; å¯ä»¥æ”¯æŒçš„å‚æ•°å‚æ•°ä½ç½®å¯ä»¥å¡«å†™é¢œè‰²å’ŒçŠ¶æ€ï¼Œå¤šä¸ªå‚æ•°ç”¨ç©ºæ ¼éš”å¼€ã€‚ é¢œè‰²blue, cyan, green, yellow, red çŠ¶æ€çŠ¶æ€å¡«å†™ open ä»£è¡¨é»˜è®¤æ‰“å¼€ã€‚ inlineimageInlineimage æ ‡ç­¾æ˜¯ä¸€ç§è¡Œå†…å›¾ç‰‡æ ‡ç­¾ï¼Œå¯ä»¥ç”¨æ¥åœ¨ä¸€æ®µè¯ä¸­é—´æ’å…¥è¡¨æƒ…ã€‚ æœ¬æ’ä»¶æœ€åæ›´æ–°äº 4.0 ç‰ˆæœ¬&#123;% inlineimage å›¾ç‰‡é“¾æ¥, height=é«˜åº¦ï¼ˆå¯é€‰ï¼‰ %&#125; æ¼”ç¤ºæ•ˆæœè¿™æ˜¯ ä¸€æ®µè¯ã€‚ è¿™åˆæ˜¯ ä¸€æ®µè¯ã€‚ ä¸Šè¿°ç¤ºä¾‹çš„æºç example:è¿™æ˜¯ &#123;% inlineimage https://cdn.jsdelivr.net/gh/volantis-x/cdn-emoji/aru-l/0000.gif %&#125; ä¸€æ®µè¯ã€‚è¿™åˆæ˜¯ &#123;% inlineimage https://cdn.jsdelivr.net/gh/volantis-x/cdn-emoji/aru-l/5150.gif, height=40px %&#125; ä¸€æ®µè¯ã€‚ å¯ä»¥æ”¯æŒçš„å‚æ•°é«˜åº¦height=20px imageImage æ ‡ç­¾æ˜¯ä¸€ç§é’ˆå¯¹å•ä¸ªå›¾ç‰‡åº”ç”¨åœºæ™¯çš„æ ‡ç­¾ï¼Œæ”¯æŒå›¾ç‰‡æè¿°æ–‡å­—å’ŒæŒ‡å®šå®½åº¦ã€‚ æœ¬æ’ä»¶æœ€åæ›´æ–°äº 4.0 ç‰ˆæœ¬&#123;% image é“¾æ¥, width=å®½åº¦ï¼ˆå¯é€‰ï¼‰, height=é«˜åº¦ï¼ˆå¯é€‰ï¼‰, alt=æè¿°ï¼ˆå¯é€‰ï¼‰, bg=å ä½é¢œè‰²ï¼ˆå¯é€‰ï¼‰ %&#125; æ¼”ç¤ºæ•ˆæœæ·»åŠ æè¿°ï¼š æ¯å¤©ä¸‹è¯¾å›å®¿èˆçš„è·¯ï¼Œæ²¡æœ‰ä»€ä¹ˆæ•…äº‹ã€‚ æŒ‡å®šå®½åº¦ï¼š æŒ‡å®šå®½åº¦å¹¶æ·»åŠ æè¿°ï¼š æ¯å¤©ä¸‹è¯¾å›å®¿èˆçš„è·¯ï¼Œæ²¡æœ‰ä»€ä¹ˆæ•…äº‹ã€‚ è®¾ç½®å ä½èƒŒæ™¯è‰²ï¼š ä¼˜åŒ–ä¸åŒå®½åº¦æµè§ˆçš„è§‚æ„Ÿ ä¸Šè¿°ç¤ºä¾‹çš„æºç example:æ·»åŠ æè¿°ï¼š&#123;% image https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper-minimalist/2020/025.jpg, alt=æ¯å¤©ä¸‹è¯¾å›å®¿èˆçš„è·¯ï¼Œæ²¡æœ‰ä»€ä¹ˆæ•…äº‹ã€‚ %&#125;æŒ‡å®šå®½åº¦ï¼š&#123;% image https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper-minimalist/2020/025.jpg, width=400px %&#125;æŒ‡å®šå®½åº¦å¹¶æ·»åŠ æè¿°ï¼š&#123;% image https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper-minimalist/2020/025.jpg, width=400px, alt=æ¯å¤©ä¸‹è¯¾å›å®¿èˆçš„è·¯ï¼Œæ²¡æœ‰ä»€ä¹ˆæ•…äº‹ã€‚ %&#125;è®¾ç½®å ä½èƒŒæ™¯è‰²ï¼š&#123;% image https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper-minimalist/2020/025.jpg, width=400px, bg=#1D0C04, alt=ä¼˜åŒ–ä¸åŒå®½åº¦æµè§ˆçš„è§‚æ„Ÿ %&#125; å¯ä»¥æ”¯æŒçš„å‚æ•°å›¾ç‰‡å®½é«˜åº¦example:width=300px, height=32px å›¾ç‰‡æè¿°example:alt=å›¾ç‰‡æè¿° å ä½èƒŒæ™¯è‰²example:bg=#f2f2f2 galleryGallery æ ‡ç­¾æ˜¯ä¸€ç§é’ˆå¯¹ä¸€ç»„å›¾ç‰‡åº”ç”¨åœºæ™¯çš„æ ‡ç­¾ã€‚ æœ¬æ’ä»¶æœ€åæ›´æ–°äº 3.0 ç‰ˆæœ¬&#123;% gallery å‚æ•°, åˆ—æ•° %&#125;![å›¾ç‰‡æè¿°](https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper/abstract/B18FCBB3-67FD-48CC-B4F3-457BA145F17A.jpeg)![](https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper/abstract/67239FBB-E15D-4F4F-8EE8-0F1C9F3C4E7C.jpeg)&#123;% endgallery %&#125; æ¼”ç¤ºæ•ˆæœä¸€è¡Œä¸€ä¸ªå›¾ç‰‡ å›¾ç‰‡æè¿° ä¸€è¡Œå¤šä¸ªå›¾ç‰‡ï¼ˆä¸æ¢è¡Œï¼‰ å›¾ç‰‡æè¿° å›¾ç‰‡æè¿° å›¾ç‰‡æè¿° å¤šè¡Œå¤šä¸ªå›¾ç‰‡ï¼ˆæ¯è¡Œ2ï½8ä¸ªå›¾ç‰‡ï¼‰ ä¸Šè¿°ç¤ºä¾‹çš„æºç ä¸€è¡Œä¸€ä¸ªå›¾ç‰‡ example.md:&#123;% gallery %&#125;![å›¾ç‰‡æè¿°](https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper/abstract/41F215B9-261F-48B4-80B5-4E86E165259E.jpeg)&#123;% endgallery %&#125; ä¸€è¡Œå¤šä¸ªå›¾ç‰‡ï¼ˆä¸æ¢è¡Œï¼‰ example.md:&#123;% gallery %&#125;![å›¾ç‰‡æè¿°](https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper/abstract/B18FCBB3-67FD-48CC-B4F3-457BA145F17A.jpeg)![å›¾ç‰‡æè¿°](https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper/abstract/67239FBB-E15D-4F4F-8EE8-0F1C9F3C4E7C.jpeg)![å›¾ç‰‡æè¿°](https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper/abstract/00E0F0ED-9F1C-407A-9AA6-545649D919F4.jpeg)&#123;% endgallery %&#125; å¤šè¡Œå¤šä¸ªå›¾ç‰‡ï¼ˆæ¯è¡Œ2ï½8ä¸ªå›¾ç‰‡ï¼‰ example.md:&#123;% gallery stretch, 4 %&#125;![](https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper/abstract/B951AE18-D431-417F-B3FE-A382403FF21B.jpeg)![](https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper/landscape/AEB33F9D-7294-4CF1-B8C5-3020748A9D45.jpeg)![](https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper/landscape/250662D4-5A21-4AAA-BB63-CD25CF97CFF1.jpeg)![](https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper/landscape/10A0FCE5-36A1-4AD0-8CF0-019259A89E03.jpeg)![](https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper/abstract/B951AE18-D431-417F-B3FE-A382403FF21B.jpeg)![](https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper/landscape/AEB33F9D-7294-4CF1-B8C5-3020748A9D45.jpeg)![](https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper/landscape/250662D4-5A21-4AAA-BB63-CD25CF97CFF1.jpeg)![](https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper/landscape/10A0FCE5-36A1-4AD0-8CF0-019259A89E03.jpeg)&#123;% endgallery %&#125; å¯ä»¥æ”¯æŒçš„å‚æ•°å¯¹é½æ–¹å‘left, center, right ç¼©æ”¾stretch åˆ—æ•°é€—å·åé¢ç›´æ¥å†™åˆ—æ•°ï¼Œæ”¯æŒ 2 ï½ 8 åˆ—ã€‚è®¾å®šåˆ—åˆ—æ•°ä¹‹åå°±æ˜¯ã€Œå¤šè¡Œå¤šå›¾ã€å¸ƒå±€ï¼Œæ­¤æ—¶å›¾ç‰‡é»˜è®¤å·¦å¯¹é½ã€‚ä¸ºäº†é¿å…å›¾ç‰‡å¤§å°ä¸ä¸€ï¼Œå»ºè®®æ­é… stretch æ¥æ—¶å›¾ç‰‡æ”¾å¤§å¡«å……ã€‚ audioæœ¬æ’ä»¶æœ€åæ›´æ–°äº 2.4 ç‰ˆæœ¬&#123;% audio éŸ³é¢‘é“¾æ¥ %&#125; æ¼”ç¤ºæ•ˆæœYour browser does not support the audio tag. ä¸Šè¿°ç¤ºä¾‹çš„æºç example:&#123;% audio https://github.com/volantis-x/volantis-docs/releases/download/assets/Lumia1020.mp3 %&#125; videoæœ¬æ’ä»¶æœ€åæ›´æ–°äº 2.3 ç‰ˆæœ¬&#123;% video è§†é¢‘é“¾æ¥ %&#125; æ¼”ç¤ºæ•ˆæœ100%å®½åº¦ Your browser does not support the video tag. 50%å®½åº¦ Your browser does not support the video tag. Your browser does not support the video tag. Your browser does not support the video tag. Your browser does not support the video tag. 25%å®½åº¦ Your browser does not support the video tag. Your browser does not support the video tag. Your browser does not support the video tag. Your browser does not support the video tag. Your browser does not support the video tag. Your browser does not support the video tag. Your browser does not support the video tag. Your browser does not support the video tag. ä¸Šè¿°ç¤ºä¾‹çš„æºç 100%å®½åº¦ example.md:&#123;% video https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_0341.mov %&#125; 50%å®½åº¦ example.md:&#123;% videos, 2 %&#125;&#123;% video https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_0341.mov %&#125;&#123;% video https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_0341.mov %&#125;&#123;% video https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_0341.mov %&#125;&#123;% video https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_0341.mov %&#125;&#123;% endvideos %&#125; 25%å®½åº¦ example.md:&#123;% videos, 4 %&#125;&#123;% video https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_0341.mov %&#125;&#123;% video https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_0341.mov %&#125;&#123;% video https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_0341.mov %&#125;&#123;% video https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_0341.mov %&#125;&#123;% video https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_0341.mov %&#125;&#123;% video https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_0341.mov %&#125;&#123;% video https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_0341.mov %&#125;&#123;% video https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_0341.mov %&#125;&#123;% endvideos %&#125; å¯ä»¥æ”¯æŒçš„å‚æ•°å¯¹é½æ–¹å‘left, center, right åˆ—æ•°é€—å·åé¢ç›´æ¥å†™åˆ—æ•°ï¼Œæ”¯æŒ 1 ï½ 4 åˆ—ã€‚ frameè¿™æ˜¯ä¸€ä¸ªèƒ½å¤Ÿå°†å›¾ç‰‡æˆ–è€…è§†é¢‘å¥—å…¥è®¾å¤‡æ¡†æ¶ä¸­çš„æ ‡ç­¾ï¼Œå¯ä»¥ç”¨æ¥æ›´ä¼˜é›…åœ°æ˜¾ç¤ºæˆªå›¾ã€å½•å±ã€‚ æœ¬æ’ä»¶æœ€åæ›´æ–°äº 4.0 ç‰ˆæœ¬&#123;% frame æ¡†æ¶å | img=å›¾ç‰‡é“¾æ¥ | alt=å›¾ç‰‡æè¿°ï¼ˆå¯é€‰ï¼‰ | part=top/bottomï¼ˆå¯é€‰ï¼‰ %&#125;&#123;% frame æ¡†æ¶å | video=è§†é¢‘é“¾æ¥ | part=top/bottomï¼ˆå¯é€‰ï¼‰ %&#125; &#123;% frame iphone11 | img=https://7.dusays.com/2020/09/28/baa33914a34ec.jpg | video=https://7.dusays.com/2020/09/28/39db723f1e200.mp4 | part=top %&#125; åœ¨è¿™ä¸ªç¤ºä¾‹ä¸­åŒæ—¶å‡ºç°äº† img å’Œ video é‚£ä¹ˆå®ƒå°±æ˜¯ä¸€ä¸ªå¸¦æœ‰å°é¢çš„è§†é¢‘ï¼Œåœ¨è§†é¢‘åŠ è½½å®Œæˆä¹‹å‰ä¼šå…ˆæ˜¾ç¤ºè§†é¢‘å°é¢ã€‚ è®¾å¤‡æ¡†æ¶ç›®å‰æ”¯æŒçš„æœ‰ï¼š iphone11 å¦‚æœæ‚¨æœ‰ä»¥ä¸‹å…¶å®ƒè®¾å¤‡æ¡†æ¶å›¾(svg)ï¼Œæ¬¢è¿ PR å…¼å®¹ã€‚ android, ipad, macbook, watch å‰ªè£é€šè¿‡è®¾ç½® part=top æˆ–è€… part=bottom æ¥æ˜¾ç¤ºä¸ŠåŠéƒ¨åˆ†æˆ–è€…ä¸‹åŠéƒ¨åˆ†ï¼Œå¦åˆ™å°†æ˜¾ç¤ºå®Œæ•´çš„æ¡†æ¶åŠå…¶ä¸­çš„å›¾ç‰‡/è§†é¢‘ã€‚ aplayerä¸»é¢˜å¯¹ APlayer æ’ä»¶çš„æ ·å¼è¿›è¡Œäº†å…¼å®¹ã€‚å®‰è£…æ’ä»¶ï¼š npm i -S hexo-tag-aplayer ä½¿ç”¨æ–¹æ³•ï¼š hexo-tag-aplayerhttps://github.com/MoePlayer/hexo-tag-aplayer issuesæœ€åæ›´æ–°äº 4.0 ç‰ˆæœ¬&#123;% issues type | api=url | group=key:value1,value2ï¼ˆå¯é€‰ï¼‰ %&#125; ç±»å‹æ ¹æ®éœ€æ±‚ä¸åŒï¼Œä¼šå°† issues å†…å®¹è§£ææˆä¸åŒçš„ HTML æ ‡ç­¾ï¼Œç›®å‰æ”¯æŒçš„ç±»å‹æœ‰ï¼š timeline: è§£ææˆ timeline æ ‡ç­¾ï¼Œissue çš„æ ‡é¢˜å¯¹åº” timeline çš„æ—¶é—´ï¼Œ issue çš„å†…å®¹å¯¹åº” timeline çš„å†…å®¹ã€‚ sites: è§£ææˆ sites æ ‡ç­¾ï¼Œéœ€è¦æœ‰ JSON ä»£ç å—ï¼š&#123; &quot;title&quot;: &quot;&quot;, &quot;screenshot&quot;: &quot;&quot;, &quot;url&quot;: &quot;&quot;, &quot;avatar&quot;: &quot;&quot;, &quot;description&quot;: &quot;&quot;, &quot;keywords&quot;: &quot;&quot;&#125; APIä¼ å¯ä»¥è°ƒå¾—é€šçš„ URL ï¼Œä¾‹å¦‚ï¼šapi=https://gitee.com/api/v5/repos/xaoxuu/friends/issues?sort=updated&amp;state=open&amp;page=1&amp;per_page=100&amp;labels=activeapi=https://api.github.com/repos/xaoxuu/friends/issues?sort=updated&amp;state=open&amp;page=1&amp;per_page=100&amp;labels=active åˆ†ç»„sites ç±»å‹çš„ issues é»˜è®¤ä¸åˆ†ç»„ï¼Œå¦‚æœéœ€è¦åˆ†ç»„ï¼Œå¯æŒ‡å®šåˆ†ç»„ä¾æ®ã€Œkeyã€ï¼Œå’Œåˆ†ç»„ç™½åå•ã€Œvalue1ã€ã€Œvalue2ã€ç­‰ï¼Œä¾‹å¦‚ï¼š group=version:v4,v3,v2 è¿™ä¸ªå‚æ•°çš„ä½œç”¨å°±æ˜¯ï¼Œç­›é€‰å‡º JSON ä¸­åŒ…å« &quot;version&quot;: &quot;v4&quot; æˆ–è€… &quot;version&quot;: &quot;v3&quot; æˆ–è€… &quot;version&quot;: &quot;v2&quot; çš„æ•°æ®ï¼Œå¹¶åˆ†ç»„æ˜¾ç¤ºã€‚ ç¤ºä¾‹æ—¶é—´çº¿&#123;% issues timeline | api=https://gitee.com/api/v5/repos/xaoxuu/timeline/issues?state=open&amp;creator=xaoxuu&amp;sort=created&amp;direction=desc&amp;page=1&amp;per_page=100 %&#125; æ˜¾ç¤ºæ•ˆæœï¼š å¯¹åº”çš„ä»“åº“é“¾æ¥ï¼š Gitee: xaoxuu/timelinehttps://gitee.com/xaoxuu/timeline/issues å‹é“¾&#123;% issues sites | api=https://gitee.com/api/v5/repos/xaoxuu/friends/issues?sort=updated&amp;state=open&amp;page=1&amp;per_page=100&amp;labels=active %&#125;&#123;% issues sites | api=https://api.github.com/repos/xaoxuu/friends/issues?sort=updated&amp;state=open&amp;page=1&amp;per_page=100&amp;labels=active %&#125; ä¸Šä¾‹ä¸­çš„ labels=active å‚æ•°å¯ä»¥æ§åˆ¶é»˜è®¤çš„ issue ä¸æ˜¾ç¤ºï¼Œåªæœ‰è‡ªå·±å®¡æ ¸é€šè¿‡æ·»åŠ äº† active æ ‡ç­¾ä¹‹åæ‰ä¼šæ˜¾ç¤ºã€‚ä¸Šè¿°ç¤ºä¾‹å¯¹åº”çš„ä»“åº“é“¾æ¥ï¼š GitHub: xaoxuu/friendshttps://github.com/xaoxuu/friends/issues åˆ†ç»„è¿™æ˜¯ä¸»é¢˜å®˜ç½‘çš„ã€Œç¤ºä¾‹åšå®¢ã€é¡µé¢çš„æ•°æ®ï¼š &#123;% issues sites | api=https://api.github.com/repos/volantis-x/examples/issues?sort=updated&amp;state=open&amp;page=1&amp;per_page=100 | group=version:ç‰ˆæœ¬ï¼š^4.0,ç‰ˆæœ¬ï¼š^3.0,ç‰ˆæœ¬ï¼š^2.0 %&#125; ä¸Šè¿°ç¤ºä¾‹å¯¹åº”çš„ä»“åº“é“¾æ¥ï¼š GitHub: volantis-x/exampleshttps://github.com/volantis-x/examples/issues Hexo é€šç”¨æ ‡ç­¾åœ¨æ–‡ç« ä¸­ä½¿ç”¨ &lt;!-- more --&gt;ï¼Œé‚£ä¹ˆ &lt;!-- more --&gt; ä¹‹å‰çš„æ–‡å­—å°†ä¼šè¢«è§†ä¸ºæ‘˜è¦ã€‚é¦–é¡µä¸­å°†åªå‡ºç°è¿™éƒ¨åˆ†æ–‡å­—ï¼ŒåŒæ—¶è¿™éƒ¨åˆ†æ–‡å­—ä¹Ÿä¼šå‡ºç°åœ¨æ­£æ–‡ä¹‹ä¸­ã€‚è¯¦è§ Hexo å®˜æ–¹æ–‡æ¡£ï¼š Hexo å®˜æ–¹æ–‡æ¡£ #æ ‡ç­¾æ’ä»¶https://hexo.io/zh-cn/docs/tag-plugins"},{"title":"ä¸»é¢˜é…ç½®","date":"2021-06-13T16:29:30.064Z","updated":"2021-06-13T16:29:30.064Z","comments":true,"path":"v4/theme-settings/index.html","permalink":"http://iequa.com/v4/theme-settings/index.html","excerpt":"","text":"åˆ›å»ºä¸»é¢˜é…ç½®æ–‡ä»¶ä¸»é¢˜ç›®å½•ä¸‹çš„ _config.yml æ–‡ä»¶é€šå¸¸è´Ÿè´£ä¸»é¢˜ç›¸å…³é…ç½®ï¼Œæˆ‘ä»¬å¼ºçƒˆå»ºè®®æ‚¨ä½¿ç”¨ä»£æ›¿çš„ä¸»é¢˜é…ç½®æ–‡ä»¶ä»¥é˜²æ­¢è‡ªå·±çš„é…ç½®ä¸¢å¤±ã€‚é‚£ä¹ˆå¦‚ä½•ä½¿ç”¨ä»£æ›¿ä¸»é¢˜é…ç½®æ–‡ä»¶å‘¢ï¼Ÿ ç¬¬ 1/2 æ­¥ï¼šåˆ›å»ºé…ç½®æ–‡ä»¶ åœ¨åšå®¢æ ¹ç›®å½•çš„ _config.yml æ–‡ä»¶æ—è¾¹æ–°å»ºä¸€ä¸ªæ–‡ä»¶ï¼š _config.volantis.yml ï¼Œè¿™ä¸ªæ–‡ä»¶ä¸­çš„é…ç½®ä¿¡æ¯ä¼˜å…ˆçº§é«˜äºä¸»é¢˜æ–‡ä»¶å¤¹ä¸­çš„é…ç½®æ–‡ä»¶ã€‚ ç¬¬ 2/2 æ­¥ï¼šè¦†ç›–è‡ªå®šä¹‰é…ç½® å½“æ‚¨éœ€è¦ä¿®æ”¹æŸé¡¹å†…å®¹æ—¶ï¼Œä¾‹å¦‚å¯¼èˆªæ èœå•ï¼Œé‚£ä¹ˆæ‚¨éœ€è¦åœ¨ä¸»é¢˜é…ç½®æ–‡ä»¶ä¸­æ‰¾åˆ°ç›¸å…³å†…å®¹ï¼Œå¤åˆ¶è¿›è‡ªå·±åˆ›å»ºçš„é…ç½®æ–‡ä»¶ä¸­ï¼šblog/_config.volantis.ymlnavbar: visiable: auto # always, auto logo: # choose [img] or [icon + title] img: https://cdn.jsdelivr.net/gh/volantis-x/cdn-org/blog/Logo-NavBar@3x.png icon: title: menu: - name: åšå®¢ icon: fas fa-rss url: /å°æç¤ºä½¿ç”¨ã€Œnpm i hexo-theme-volantisã€æ–¹å¼å®‰è£…çš„ä¸»é¢˜ï¼Œä¸»é¢˜é…ç½®æ–‡ä»¶åœ¨ã€Œblog/node_modules/hexo-theme-volantis/_config.ymlã€ä½¿ç”¨ä¼ ç»Ÿæ–¹å¼å®‰è£…çš„ä¸»é¢˜ï¼Œä¸»é¢˜é…ç½®æ–‡ä»¶åœ¨ã€Œblog/themes/volantis/_config.ymlã€ è‡ªå®šä¹‰ä¸»é¢˜å¤–è§‚æœ€å¤§å¸ƒå±€å®½åº¦blog/_config.volantis.ymlcustom_css: ... max_width: 1080px # Sum of body width and sidebar width ç½‘é¡µæ‰€å‘ˆç°çš„å†…å®¹çš„æœ€å¤§å®½åº¦ï¼Œå³ body å’Œ sidebar çš„å®½åº¦ä¹‹å’Œã€‚ æŠ—é”¯é½¿blog/_config.volantis.ymlcustom_css: ... font_smoothing: true # font-smoothing for webkit è‡ªå®šä¹‰å…‰æ ‡æ ·å¼blog/_config.volantis.ymlcustom_css: ... cursor: enable: true text: https://cdn.jsdelivr.net/gh/inkss/common@master/cursor/text.png pointer: https://cdn.jsdelivr.net/gh/inkss/common@master/cursor/pointer.png default: https://cdn.jsdelivr.net/gh/inkss/common@master/cursor/left_ptr.png not-allowed: https://cdn.jsdelivr.net/gh/inkss/common@master/cursor/circle.png zoom-out: https://cdn.jsdelivr.net/gh/inkss/common@master/cursor/zoom-out.png zoom-in: https://cdn.jsdelivr.net/gh/inkss/common@master/cursor/zoom-in.png grab: https://cdn.jsdelivr.net/gh/inkss/common@master/cursor/openhand.png å¯¼èˆªæ æ ·å¼æ‚¨å¯ä»¥è®¾ç½®å¯¼èˆªæ çš„é«˜åº¦ä»¥åŠè§†è§‰ç‰¹æ•ˆï¼Œè§†è§‰ç‰¹æ•ˆç›®å‰å¯é€‰çš„æœ‰ï¼š shadowï¼šå¡ç‰‡é˜´å½±ã€‚ floatableï¼šå½“é¼ æ ‡ç§»åŠ¨åˆ°å®¹å™¨å†…æ—¶ï¼Œå‘ˆç°å‡ºæµ®èµ·æ¥çš„æ•ˆæœã€‚ blurï¼šèƒŒæ™¯æ¨¡ç³Šæ•ˆæœï¼ˆæ¯›ç»ç’ƒï¼‰ï¼Œå½“æµè§ˆå™¨ä¸æ”¯æŒæ—¶æ˜¾ç¤ºä¸ºä¸é€æ˜ã€‚ blog/_config.volantis.ymlcustom_css: ... navbar: height: 64px effect: [shadow, blur] # [shadow, floatable, blur] æ»šåŠ¨æ¡æ ·å¼blog/_config.volantis.ymlcustom_css: ... scrollbar: size: 4px border: 2px color: &#x27;#2196f3&#x27; hover: &#x27;#ff5722&#x27; ä¾§è¾¹æ æ ·å¼è§†è§‰ç‰¹æ•ˆå‚æ•°åŒä¸Šï¼Œå€¼å¾—æ³¨æ„çš„æ˜¯ï¼šå¡ç‰‡çš„ floatable æ•ˆæœå’Œ blur æ•ˆæœç›¸å†²çªã€‚blog/_config.volantis.ymlcustom_css: ... sidebar: effect: [shadow] # [shadow, floatable, blur] æ­£æ–‡åŒºåŸŸæ ·å¼è§†è§‰ç‰¹æ•ˆå‚æ•°åŒä¸Šï¼Œå€¼å¾—æ³¨æ„çš„æ˜¯ï¼šå¡ç‰‡çš„ floatable æ•ˆæœå’Œ blur æ•ˆæœç›¸å†²çªã€‚æ‚¨å¯ä»¥åœ¨ language: true è¿™é‡Œè®¾ç½®ä»£ç å—æ˜¾ç¤ºè¯­è¨€åç§°ã€‚text_align å¯ä»¥è®¾ç½® h1/h2/h3/h4/p çš„æ–‡å­—å¯¹é½æ–¹å‘ã€‚blog/_config.volantis.ymlcustom_css: ... body: effect: [shadow] # [shadow, floatable, blur] highlight: language: true # show language of codeblock copy_btn: true text_align: # left, right, justify, center h1: left h2: left h3: left h4: left p: justify note: # style for default note: &#123;% note text %&#125; icon: &#x27;\\f054&#x27; color: &#x27;&#x27; å¸ƒå±€é—´è·æ‚¨å¯ä»¥è®¾ç½®å‡ ç§æ ‡é¢˜çš„å¸ƒå±€é—´è· h2/h3/h4ã€æ®µè½é—´è· lineã€åŒºå—å†…éƒ¨çš„æ®µè½é—´è· inlineã€‚blog/_config.volantis.ymlcustom_css: ... gap: h2: 48px # Spacing above H2 (only px unit) h3: 32px # Spacing above H3 (only px unit) h4: 16px # Spacing above H4 (only px unit) paragraph: 1rem # Paragraph spacing between paragraphs row: .5rem # Paragraph spacing between other elements è‡ªå®šä¹‰å­—ä½“æ‚¨å¯ä»¥è‡ªå®šä¹‰æ­£æ–‡å’Œä»£ç å­—ä½“ã€‚blog/_config.volantis.ymlcustom_css: ... fontfamily: logofont: fontfamily: &#x27;&quot;Varela Round&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, Helvetica, Arial&#x27; name: &#x27;Varela Round&#x27; url: https://cdn.jsdelivr.net/gh/volantis-x/cdn-fonts/VarelaRound/VarelaRound-Regular.ttf weight: normal style: normal bodyfont: fontfamily: &#x27;UbuntuMono, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, Helvetica, Arial&#x27; name: &#x27;UbuntuMono&#x27; url: https://cdn.jsdelivr.net/gh/volantis-x/cdn-fonts/UbuntuMono/UbuntuMono-Regular.ttf weight: normal style: normal codefont: fontfamily: &#x27;Menlo, Monaco&#x27; name: &#x27;Monaco&#x27; url: https://cdn.jsdelivr.net/gh/volantis-x/cdn-fonts/Monaco/Monaco.ttf weight: normal style: normal è‡ªå®šä¹‰é¢œè‰²å¤šå½©é…è‰²æ–¹æ¡ˆ blog/_config.volantis.ymlcolor_scheme: # ------------ # é€šç”¨é¢œè‰² common: # ä¸»é¢˜è‰² theme: &#x27;#44D7B6&#x27; # é“¾æ¥è‰² link: &#x27;#2196f3&#x27; # æŒ‰é’®è‰² button: &#x27;#44D7B6&#x27; # é¼ æ ‡æ”¾åˆ°äº¤äº’å…ƒç´ ä¸Šæ—¶çš„è‰² hover: &#x27;#ff5722&#x27; # ä¸»é¢˜è‰²å—å†…éƒ¨çš„æ–‡å­—é¢œè‰² inner: &#x27;#fff&#x27; # é€‰ä¸­åŒºåŸŸæ–‡å­—çš„èƒŒæ™¯é¢œè‰² selection: &#x27;alpha(#2196f3, 0.2)&#x27; # ------------ # äº®è‰²ä¸»é¢˜ï¼ˆé»˜è®¤ï¼‰ light: # ç½‘ç«™èƒŒæ™¯è‰² site_bg: &#x27;#f4f4f4&#x27; # ç½‘ç«™èƒŒæ™¯ä¸Šçš„æ–‡å­— site_inner: &#x27;#fff&#x27; # ç½‘ç«™é¡µè„šæ–‡å­— site_footer: &#x27;#666&#x27; # å¡ç‰‡èƒŒæ™¯è‰² card: &#x27;#fff&#x27; # å¡ç‰‡ä¸Šçš„æ™®é€šæ–‡å­— text: &#x27;#444&#x27; # åŒºå—å’Œä»£ç å—èƒŒæ™¯è‰² block: &#x27;#f6f6f6&#x27; # ä»£ç å—é«˜äº®æ—¶çš„èƒŒæ™¯è‰² codeblock: &#x27;#FFF7EA&#x27; # è¡Œå†…ä»£ç é¢œè‰² inlinecode: &#x27;#D56D28&#x27; # æ–‡ç« éƒ¨åˆ† h1: &#x27;#444&#x27; h2: &#x27;#444&#x27; h3: &#x27;#444&#x27; h4: &#x27;#444&#x27; h5: &#x27;#444&#x27; h6: &#x27;#444&#x27; p: &#x27;#444&#x27; # åˆ—è¡¨æ–‡å­— list: &#x27;#666&#x27; # åˆ—è¡¨ hover æ—¶çš„æ–‡å­— list_hl: &#x27;mix($color-theme, #000, 80)&#x27; # è¾…åŠ©æ€§æ–‡å­— meta: &#x27;#888&#x27; # ------------ # æš—è‰²ä¸»é¢˜ dark: # ç½‘ç«™èƒŒæ™¯è‰² site_bg: &#x27;#222&#x27; # ç½‘ç«™èƒŒæ™¯ä¸Šçš„æ–‡å­— site_inner: &#x27;#eee&#x27; # ç½‘ç«™é¡µè„šæ–‡å­— site_footer: &#x27;#aaa&#x27; # å¡ç‰‡èƒŒæ™¯è‰² card: &#x27;#444&#x27; # å¡ç‰‡ä¸Šçš„æ™®é€šæ–‡å­— text: &#x27;#eee&#x27; # åŒºå—å’Œä»£ç å—èƒŒæ™¯è‰² block: &#x27;#3a3a3a&#x27; # ä»£ç å—é«˜äº®æ—¶çš„èƒŒæ™¯è‰² codeblock: &#x27;#343a3c&#x27; # è¡Œå†…ä»£ç é¢œè‰² inlinecode: &#x27;#D56D28&#x27; # æ–‡ç« éƒ¨åˆ† h1: &#x27;#eee&#x27; h2: &#x27;#eee&#x27; h3: &#x27;#ddd&#x27; h4: &#x27;#ddd&#x27; h5: &#x27;#ddd&#x27; h6: &#x27;#ddd&#x27; p: &#x27;#bbb&#x27; # åˆ—è¡¨æ–‡å­— list: &#x27;#aaa&#x27; # åˆ—è¡¨ hover æ—¶çš„æ–‡å­— list_hl: &#x27;mix($color-theme, #fff, 80)&#x27; # è¾…åŠ©æ€§æ–‡å­— meta: &#x27;#888&#x27; # å¤œé—´å›¾ç‰‡äº®åº¦ brightness: 70% è‡ªå®šä¹‰å³é”®èœå•blog/_config.volantis.yml# è‡ªå®šä¹‰å³é”®èœå•rightmenu: enable: true # hr: åˆ†å‰²çº¿, music: éŸ³ä¹æ§åˆ¶å™¨ layout: [home, help, examples, contributors, hr, source_docs, source_theme, hr, print, hr, dark_mode, hr, music] # å¯é€‰åŠŸèƒ½é¡¹ print: name: æ‰“å°é¡µé¢ icon: fa fa-print onclick: document.execCommand(&#x27;print&#x27;) # è‡ªå®šä¹‰èœå•çš„æ ¼å¼å¦‚ä¸‹ help: name: å¸¸è§é—®é¢˜ icon: fa fa-question url: https://volantis.js.org/faqs/ examples: name: ç¤ºä¾‹åšå®¢ icon: fa fa-rss url: https://volantis.js.org/examples/ contributors: name: åŠ å…¥ç¤¾åŒº icon: fa fa-fan fa-spin url: https://volantis.js.org/contributors/ source_docs: name: æœ¬ç«™æºç  icon: fa fa-code-branch url: https://github.com/volantis-x/volantis-docs/ source_theme: name: ä¸»é¢˜æºç  icon: fa fa-code-branch url: https://github.com/volantis-x/hexo-theme-volantis/ dark_mode: name: Dark mode icon: fas fa-moon toggle: darkmode è®¾ç½®ç½‘ç«™å¯¼èˆªæ å¯¼èˆªæ é…ç½®å¯¼èˆªæ åˆ†ä¸º logoã€menuã€search ä¸‰ä¸ªåŒºåŸŸè®¾ç½®ï¼Œå…¶ä¸­ logo åŒºåŸŸå¦‚æœè®¾ç½®äº†å›¾ç‰‡ï¼Œåˆ™ä¸èƒ½æ˜¾ç¤ºå›¾æ ‡å’Œæ ‡é¢˜ï¼Œ menu åŒºåŸŸçš„è®¾ç½®å¯ä»¥å†™åœ¨ä¸€ä¸ªå•ç‹¬çš„æ–‡ä»¶ä¸­ã€‚blog/_config.volantis.yml# æ³¨æ„äº‹é¡¹ï¼šå»ºè®®è§„èŒƒå…¨ç«™è·¯å¾„ URL æœ€åå¸¦ä¸€ä¸ª &quot;/&quot; ä¾‹å¦‚ &quot;about/&quot;navbar: logo: # choose [img] or [icon + title] img: icon: title: menu: # The following can be written in `blog/source/_data/menu.yml` - name: åšå®¢ icon: fas fa-rss url: / - name: åˆ†ç±» icon: fas fa-folder-open url: categories/ - name: æ ‡ç­¾ icon: fas fa-tags url: tags/ - name: å½’æ¡£ icon: fas fa-archive url: archives/ - name: å‹é“¾ icon: fas fa-link url: friends/ - name: å…³äº icon: fas fa-info-circle url: about/ search: æœç´¢ # Search bar placeholder ä½¿ç”¨æ•°æ®æ–‡ä»¶ å»ºè®®æ–°å»ºä¸€ä¸ªæ–‡ä»¶ï¼Œä¸“é—¨å­˜æ”¾å¯¼èˆªæ èœå•é…ç½®ï¼Œæ–‡ä»¶çš„è·¯å¾„ä¸ºï¼šblog/source/_data/menu.ymlæ–‡ä»¶çš„å†…å®¹ä¸ºï¼šblog/source/_data/menu.yml- name: åšå®¢ icon: fas fa-rss url: /... èœå•åµŒå¥—å¯¼èˆªæ èœå•æ”¯æŒåµŒå¥—ï¼ŒåµŒå¥—çš„å±æ€§åä¸º rows ï¼Œå†™æ³•ç¤ºä¾‹ï¼šblog/source/_data/menu.yml...- name: æ›´å¤š icon: fas fa-ellipsis-v rows: - name: ä¸»é¢˜æºç  url: https://github.com/volantis-x/hexo-theme-volantis/ - name: æ›´æ–°æ—¥å¿— url: https://github.com/volantis-x/hexo-theme-volantis/releases/ - name: hr - name: æœ‰ç–‘é—®ï¼Ÿ rows: - name: çœ‹ FAQ url: faqs/ - name: çœ‹ æœ¬ç«™æºç  url: https://github.com/volantis-x/volantis-docs/ - name: æ Issue url: https://github.com/volantis-x/hexo-theme-volantis/issues/ - name: hr - name: å…¬å‘Šå’Œæµ‹è¯•åšæ–‡ url: archives/ - name: ç¤ºä¾‹åšå®¢ url: examples/ - name: ç‰¹åˆ«æ„Ÿè°¢ url: contributors/ åˆ†å‰²çº¿åœ¨å­èœå•ä¸­ï¼Œæ–°å¢ä¸€ä¸ªåªæœ‰ name: hr çš„â€œèœå•â€å°±ä¼šè¢«æ¸²æŸ“æˆä¸€ä¸ªåˆ†å‰²çº¿ã€‚- name: hr å°æ ‡é¢˜åœ¨å­èœå•ä¸­ï¼Œæ–°å¢ä¸€ä¸ªåªæœ‰ name: å°æ ‡é¢˜å†…å®¹ï¼ˆä¹Ÿå¯ä»¥æœ‰ icon: å°æ ‡é¢˜çš„å›¾æ ‡ï¼‰çš„â€œèœå•â€å°±ä¼šè¢«æ¸²æŸ“æˆä¸€ä¸ªå°æ ‡é¢˜ã€‚...- name: è¿‘æœŸ icon: fas fa-clock url: / rows: - name: çƒ­é—¨æ–‡ç«  icon: fas fa-fire - name: ProHUD å¼€æºåº“çš„è®¾è®¡æ€è·¯ url: blog/2019-08-27-prohud/ - name: ValueXï¼šå®ç”¨çš„å®‰å…¨å¯¹è±¡ç±»å‹è½¬æ¢åº“ url: blog/2019-08-29-valuex/ - name: å¿ƒç‡ç®¡å®¶ App çš„è®¾è®¡ä¸å¼€å‘ url: blog/2019-07-23-heartmate/ æ’­æ”¾å™¨åœ¨å­èœå•ä¸­ï¼Œæ–°å¢ä¸€ä¸ª icon: fas fa-compact-disc çš„â€œèœå•â€å°±ä¼šè¢«æ¸²æŸ“æˆä¸€ä¸ª APlayer æ’­æ”¾å™¨ã€‚- name: èƒŒæ™¯éŸ³ä¹ icon: fas fa-compact-disc è®¾ç½®ç½‘ç«™é¡µè„šæ‚¨é€šè¿‡ layout å¯ä»¥è‡ªç”±å¸ƒå±€ç½‘ç«™é¡µè„šå†…å®¹ aplayer, social, license, info, copyrightã€‚blog/_config.volantis.ymlsite_footer: # layout of footer: [aplayer, social, license, info, copyright] layout: [aplayer, social, license, info, copyright] social: - icon: fas fa-rss url: atom.xml - icon: fas fa-envelope url: mailto:me@xaoxuu.com - icon: fab fa-github url: https://github.com/xaoxuu - icon: fas fa-headphones-alt url: https://music.163.com/#/user/home?id=63035382 copyright: &#x27;[Copyright Â© 2017-2021 XXX](/)&#x27; # You can add your own property here. (Support markdown, for example: br: &#x27;&lt;br&gt;&#x27;) br: &#x27;&lt;br&gt;&#x27;å…¶ä¸­ï¼Œaplayer éœ€è¦åœ¨æ’ä»¶éƒ¨åˆ†è®¾ç½®ä¸­å¯ç”¨ã€‚æ‚¨å¯ä»¥æ–°å¢æ–‡å­—å±æ€§ï¼Œç”¨äºå±•ç¤ºå…¶å®ƒæ–‡å­—ä¿¡æ¯ï¼Œä¾‹å¦‚ï¼šblog/_config.volantis.ymlsite_footer: layout: [..., br, hello, ...] ... # You can add your own property here. (Support markdown, for example: br: &#x27;&lt;br&gt;&#x27;) br: &#x27;&lt;br&gt;&#x27; hello: &#x27;[Hello World](/)&#x27; ç½‘ç«™ä¸æ–‡ç« å°é¢å°é¢é«˜åº¦blog/_config.volantis.ymlcover: height_scheme: full # full, half ... ç›®å‰ä¸»é¢˜æä¾›ä¸¤ç§é¦–é¡µå°é¢é«˜åº¦æ–¹æ¡ˆï¼Œå…¶å®ƒé¡µé¢å‡ä¸ºåŠå±å¹•é«˜åº¦ã€‚ å°é¢å¸ƒå±€æ–¹æ¡ˆblog/_config.volantis.ymlcover: ... scheme: dock # search (æœç´¢), dock (å), featured (ç²¾é€‰), focus (ç„¦ç‚¹) ... å¸ƒå±€æ–¹æ¡ˆ é€‚åˆåœºæ™¯ search æ³¨é‡æœç´¢ dock å…¥å£é€‰é¡¹æ¯”è¾ƒå¤š featured é€‰é¡¹åœ¨4ä¸ªå·¦å³ focus é€‰é¡¹åœ¨4ä¸ªå·¦å³ é»˜è®¤æ˜¾ç¤ºè®¾ç½®blog/_config.volantis.ymlcover: ... display: home: true archive: false others: false # can be written in front-matter &#x27;cover: true&#x27; ç”±äºä¸»é¡µã€å½’æ¡£æ˜¯ hexo è‡ªåŠ¨ç”Ÿæˆçš„ï¼Œæ‚¨éœ€è¦åœ¨ä¸»é¢˜é…ç½®æ–‡ä»¶ä¸­è®¾ç½®æ˜¯å¦æ˜¾ç¤ºå°é¢ï¼Œè€Œå…¶å®ƒé¡µé¢åˆ™å¯ä»¥åœ¨ front-matter ä¸­é€šè¿‡è®¾ç½® cover: true/false æ¥å†³å®šæ˜¾ç¤ºå°é¢æˆ–è€…ä¸æ˜¾ç¤ºå°é¢ã€‚ æ–‡ç« å¸ƒå±€é…ç½®# æ–‡ç« å¸ƒå±€article: # æ–‡ç« åˆ—è¡¨é¡µé¢çš„æ–‡ç« å¡ç‰‡å¸ƒå±€æ–¹æ¡ˆ preview: scheme: landscape # landscape # pin icon for post pin_icon: https://cdn.jsdelivr.net/gh/twitter/twemoji@13.0/assets/svg/1f4cc.svg # auto generate title if not exist auto_title: true # false, true # auto generate excerpt if not exist auto_excerpt: true # false, true # show split line or not line_style: solid # hidden, solid, dashed, dotted # show readmore button readmore: auto # auto, always # æ–‡ç« è¯¦æƒ…é¡µé¢çš„æ–‡ç« å¡ç‰‡æœ¬ä½“å¸ƒå±€æ–¹æ¡ˆ body: # æ–‡ç« é¡¶éƒ¨ä¿¡æ¯ # ä» meta_library ä¸­å– top_meta: [author, category, date, counter] # ---------------- # æ–‡ç« é¡µè„šç»„ä»¶ footer_widget: # ---------------- # å‚è€ƒèµ„æ–™ã€ç›¸å…³èµ„æ–™ç­‰ (for layout: post/docs) references: title: å‚è€ƒèµ„æ–™ icon: fas fa-quote-left # åœ¨ front-matter ä¸­: # references: # - title: æŸç¯‡æ–‡ç«  # url: https:// # å³å¯æ˜¾ç¤ºæ­¤ç»„ä»¶ã€‚ # ---------------- # ç›¸å…³æ–‡ç« ï¼Œéœ€è¦å®‰è£…æ’ä»¶ (for layout: post) # npm i hexo-related-popular-posts related_posts: enable: false title: ç›¸å…³æ–‡ç«  icon: fas fa-bookmark max_count: 5 # è®¾ä¸ºç©ºåˆ™ä¸ä½¿ç”¨æ–‡ç« å¤´å›¾ placeholder_img: https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper-minimalist/2020/046.jpg # ---------------- # ç‰ˆæƒå£°æ˜ç»„ä»¶ (for layout: post/docs) copyright: enable: true permalink: &#x27;æœ¬æ–‡æ°¸ä¹…é“¾æ¥æ˜¯ï¼š&#x27; content: - &#x27;åšå®¢å†…å®¹éµå¾ª ç½²å-éå•†ä¸šæ€§ä½¿ç”¨-ç›¸åŒæ–¹å¼å…±äº« 4.0 å›½é™… (CC BY-NC-SA 4.0) åè®®&#x27; - permalink # ---------------- # æ‰“èµç»„ä»¶ (for layout: post/docs) donate: enable: false images: - https://cdn.jsdelivr.net/gh/volantis-x/cdn-org/blog/qrcode/github@volantis.png - https://cdn.jsdelivr.net/gh/volantis-x/cdn-org/blog/qrcode/github@volantis.png # æ–‡ç« åº•éƒ¨ä¿¡æ¯ # ä» meta_library ä¸­å– bottom_meta: [updated, tags, share] # meta library meta_library: # é»˜è®¤æ–‡ç« ä½œè€…ï¼ˆå¯åœ¨ front-matter ä¸­è¦†ç›–ï¼‰ author: avatar: name: è¯·è®¾ç½®æ–‡ç« ä½œè€… url: / # æ–‡ç« åˆ›å»ºæ—¥æœŸ date: icon: fas fa-calendar-alt title: &#x27;å‘å¸ƒäºï¼š&#x27; format: &#x27;ll&#x27; # æ—¥æœŸæ ¼å¼ http://momentjs.com/docs/ # æ–‡ç« æ›´æ–°æ—¥æœŸ updated: icon: fas fa-edit title: &#x27;æ›´æ–°äºï¼š&#x27; format: &#x27;ll&#x27; # æ—¥æœŸæ ¼å¼ http://momentjs.com/docs/ # æ–‡ç« åˆ†ç±» category: icon: fas fa-folder-open # æ–‡ç« æµè§ˆè®¡æ•° counter: icon: fas fa-eye unit: &#x27;æ¬¡æµè§ˆ&#x27; # æ–‡ç« è¯„è®ºæ•°é‡ï¼šåªæ”¯æŒ valine valinecount: icon: fas fa-comment-dots desc: &#x27;&#x27; # æ¡è¯„è®º # æ–‡ç« å­—æ•°å’Œé˜…è¯»æ—¶é•¿ wordcount: icon_wordcount: fas fa-keyboard icon_duration: fas fa-hourglass-half # æ–‡ç« æ ‡ç­¾ tags: icon: fas fa-hashtag # åˆ†äº« share: - id: qq img: https://cdn.jsdelivr.net/gh/volantis-x/cdn-org/logo/128/qq.png - id: qzone img: https://cdn.jsdelivr.net/gh/volantis-x/cdn-org/logo/128/qzone.png - id: weibo img: https://cdn.jsdelivr.net/gh/volantis-x/cdn-org/logo/128/weibo.png - id: # qrcode # å½“idä¸ºqrcodeæ—¶éœ€è¦å®‰è£…æ’ä»¶ npm i hexo-helper-qrcode img: # https://cdn.jsdelivr.net/gh/volantis-x/cdn-org/logo/128/wechat.png - id: # telegram img: # https://cdn.jsdelivr.net/gh/volantis-x/cdn-org/logo/128/telegram.png å…¶ä¸­ top_meta å’Œ bottom_meta éƒ¨åˆ†çš„å–å€¼è‡ª meta_library åº“ã€‚ ä¾§è¾¹æ é…ç½®ä¾§è¾¹æ å°ç»„ä»¶ä¸ meta åº“ä¸åŒçš„æ˜¯ï¼šé™¤äº†ç°æœ‰çš„ widget ï¼Œæ‚¨å¯ä»¥å¾ˆè½»æ˜“åœ°åˆ›å»ºè‡ªå·±çš„ widget ï¼Œç„¶åæ”¾åœ¨éœ€è¦çš„åœ°æ–¹ã€‚æ­¤å¤–ï¼Œæ‚¨è¿˜å¯ä»¥å°† widget å†™åœ¨å•ç‹¬çš„æ–‡ä»¶ä¸­ã€‚ æŸ¥çœ‹æ‰€æœ‰ç›¸å…³é…ç½® blog/_config.volantis.ymlsidebar: # ä¸»é¡µã€åˆ†ç±»ã€å½’æ¡£ç­‰ç‹¬ç«‹é¡µé¢ for_page: [blogger, category, tagcloud, qrcode] # layout: docs/post è¿™ç±»æ–‡ç« é¡µé¢ for_post: [toc] # ä¾§è¾¹æ ç»„ä»¶åº“ widget_library: # --------------------------------------- # blogger info widget blogger: class: blogger display: [desktop, mobile] # [desktop, mobile] avatar: https://cdn.jsdelivr.net/gh/volantis-x/cdn-org/blog/Logo-NavBar@3x.png shape: rectangle # circle, rectangle url: /about/ title: subtitle: jinrishici: true # Poetry Today. You can set a string, and it will be displayed when loading fails. social: true # --------------------------------------- # toc widget (valid only in articles) toc: class: toc display: [desktop, mobile] # [desktop, mobile] header: icon: fas fa-list title: æœ¬æ–‡ç›®å½• list_number: false min_depth: 2 max_depth: 5 # --------------------------------------- # category widget category: class: category display: [desktop] # [desktop, mobile] header: icon: fas fa-folder-open title: æ–‡ç« åˆ†ç±» url: /blog/categories/ # --------------------------------------- # tagcloud widget tagcloud: class: tagcloud display: [desktop, mobile] # [desktop, mobile] header: icon: fas fa-tags title: çƒ­é—¨æ ‡ç­¾ url: /blog/tags/ min_font: 14 max_font: 24 color: true start_color: &#x27;#999&#x27; end_color: &#x27;#555&#x27; # --------------------------------------- # qrcode widget donate: class: qrcode display: [desktop, mobile] # [desktop, mobile] height: 64px # Automatic height if not set images: - https://cdn.jsdelivr.net/gh/volantis-x/cdn-org/blog/qrcode/github@volantis.png - https://cdn.jsdelivr.net/gh/volantis-x/cdn-org/blog/qrcode/github@volantis.png # --------------------------------------- # webinfo widget webinfo: class: webinfo display: [desktop] header: icon: fas fa-award title: ç«™ç‚¹ä¿¡æ¯ type: article: enable: true text: &#x27;æ–‡ç« æ•°ç›®ï¼š&#x27; unit: &#x27;ç¯‡&#x27; runtime: enable: true data: &#x27;2020/01/01&#x27; # å¡«å†™å»ºç«™æ—¥æœŸ text: &#x27;å·²è¿è¡Œæ—¶é—´ï¼š&#x27; unit: &#x27;å¤©&#x27; wordcount: enable: true text: &#x27;æœ¬ç«™æ€»å­—æ•°ï¼š&#x27; # éœ€è¦å¯ç”¨ wordcount unit: &#x27;å­—&#x27; siteuv: enable: true text: &#x27;æœ¬ç«™è®¿å®¢æ•°ï¼š&#x27; # éœ€è¦å¯ç”¨ busuanzi unit: &#x27;äºº&#x27; sitepv: enable: true text: &#x27;æœ¬ç«™æ€»è®¿é—®é‡ï¼š&#x27; # éœ€è¦å¯ç”¨ busuanzi unit: &#x27;æ¬¡&#x27; lastupd: enable: true friendlyShow: true # æ›´å‹å¥½çš„æ—¶é—´æ˜¾ç¤º text: &#x27;æœ€åæ´»åŠ¨æ—¶é—´ï¼š&#x27; unit: &#x27;æ—¥&#x27; æ¯ä¸€ä¸ªå°éƒ¨ä»¶éƒ½æœ‰ class å’Œ displayï¼Œå‰è€…ä»£è¡¨è¿™ä¸ªå°éƒ¨ä»¶æ˜¯ä»€ä¹ˆï¼Œåè€…ä»£è¡¨è¿™ä¸ªå°éƒ¨ä»¶åœ¨ä»€ä¹ˆæ¡Œé¢å’Œç§»åŠ¨å¹³å°ä¸­æ˜¯å¦æ˜¾ç¤ºï¼Œå¦‚æœåœ¨ç§»åŠ¨å¹³å°æ˜¾ç¤ºï¼Œç”±äºå±å¹•å®½åº¦æœ‰é™ï¼Œä¾§è¾¹æ çš„å°éƒ¨ä»¶åˆ™ä¼šè¢«ç§»åŠ¨åˆ°æ­£æ–‡åŒºåŸŸä¸‹æ–¹ï¼Œå› æ­¤éƒ¨åˆ†ä¾§è¾¹æ å°éƒ¨ä»¶ä¾¿å¤±å»æ„ä¹‰ï¼Œå»ºè®®è®¾ç½®ä¸ºä»…æ¡Œé¢ç«¯æ˜¾ç¤ºã€‚ å°éƒ¨ä»¶å: class: å°éƒ¨ä»¶ç±»åˆ« display: [å°éƒ¨ä»¶åœ¨æ¡Œé¢ç«¯æ˜¯å¦æ˜¾ç¤º, å°éƒ¨ä»¶åœ¨ç§»åŠ¨è®¾å¤‡æ˜¯å¦æ˜¾ç¤º] åšä¸»ä¿¡æ¯éƒ¨ä»¶blog/_config.volantis.ymlblogger: class: blogger display: [desktop] # [desktop, mobile] avatar: https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/avatar/avatar.png title: subtitle: jinrishici: true # Poetry Today. You can set a string, and it will be displayed when loading fails. social: true å…¶ä¸­ï¼Œä»Šæ—¥è¯—è¯ jinrishici å¦‚æœè®¾ç½®ä¸ºä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè¿™ä¸ªå­—ç¬¦ä¸²ä¼šå˜æˆå ä½æ–‡å­—ï¼ŒåŠ è½½å¤±è´¥æ—¶æ˜¾ç¤ºã€‚å¦‚æœä¸éœ€è¦ï¼Œå°±è¯·è®¾ç½®ä¸º jinrishici: falseã€‚social çš„å…·ä½“å†…å®¹è¯·åœ¨ç½‘ç«™é¡µè„šéƒ¨åˆ†è®¾ç½®ã€‚ æ–‡ç« ç›®å½•éƒ¨ä»¶blog/_config.volantis.ymltoc: class: toc display: [desktop, mobile] # [desktop, mobile] header: icon: fas fa-list title: æœ¬æ–‡ç›®å½• list_number: false min_depth: 2 max_depth: 5 è¿™ä¸ªéƒ¨ä»¶åªèƒ½æ”¾ç½®åœ¨ä¾§è¾¹æ ï¼Œå¹¶ä¸”åœ¨æ–‡ç« ä¸­æœ‰æ•ˆã€‚åœ¨ç§»åŠ¨è®¾å¤‡ä¸­é¢„è§ˆæ—¶ï¼Œæ‰‹æŒ‡å‘ä¸Šæ»‘åŠ¨æ—¶ï¼Œå¯¼èˆªæ å³è¾¹ä¼šå‡ºç° TOC æŒ‰é’®ï¼Œç‚¹å‡»å³å¯å±•å¼€ TOC éƒ¨ä»¶ã€‚å¦‚æœæ‚¨éœ€è¦æ˜¾ç¤ºç« èŠ‚åºå·ï¼Œè¯·è®¾ç½® list_numberã€‚ min_depth å’Œ max_depth ä»£è¡¨ TOC æ”¯æŒçš„æ ‡é¢˜å±‚çº§ï¼Œæœ€å¤§èŒƒå›´æ˜¯2ï½6ã€‚ æ–‡ç« åˆ†ç±»éƒ¨ä»¶blog/_config.volantis.ymlcategory: class: category display: [desktop] # [desktop, mobile] header: icon: fas fa-folder-open title: æ–‡ç« åˆ†ç±» url: /blog/categories/ è¿™ä¸ªéƒ¨ä»¶å¯ä»¥ç›´æ¥æ˜¾ç¤ºæ‰€æœ‰æ–‡ç« åˆ†ç±»ï¼Œå¦‚æœæ‚¨å¸Œæœ›æœ‰ä¸€ä¸ªç‹¬ç«‹çš„é¡µé¢æ¥å±•ç¤ºï¼Œéœ€è¦è‡ªå·±åˆ›å»ºä¸€ä¸ªæ–‡ä»¶ï¼Œå…·ä½“æ“ä½œåœ¨ã€Œé¡µé¢ã€éƒ¨åˆ†æ–‡æ¡£ä¸­ã€‚ æ ‡ç­¾äº‘éƒ¨ä»¶blog/_config.volantis.ymltagcloud: class: tagcloud display: [desktop] # [desktop, mobile] header: icon: fas fa-tags title: çƒ­é—¨æ ‡ç­¾ url: /blog/tags/ min_font: 14 max_font: 24 color: true start_color: &#x27;#999&#x27; end_color: &#x27;#555&#x27; è¿™ä¸ªéƒ¨ä»¶å¯ä»¥ç›´æ¥æ˜¾ç¤ºæ‰€æœ‰æ–‡ç« çš„æ ‡ç­¾ï¼Œå¦‚æœæ‚¨å¸Œæœ›æœ‰ä¸€ä¸ªç‹¬ç«‹çš„é¡µé¢æ¥å±•ç¤ºï¼Œéœ€è¦è‡ªå·±åˆ›å»ºä¸€ä¸ªæ–‡ä»¶ï¼Œå…·ä½“æ“ä½œåœ¨ã€Œé¡µé¢ã€éƒ¨åˆ†æ–‡æ¡£ä¸­ã€‚ äºŒç»´ç éƒ¨ä»¶blog/_config.volantis.ymldonate: class: qrcode display: [desktop, mobile] # [desktop, mobile] height: 64px # Automatic height if not set images: - https://cdn.jsdelivr.net/gh/volantis-x/cdn-org/blog/qrcode/github@volantis.png - https://cdn.jsdelivr.net/gh/volantis-x/cdn-org/blog/qrcode/github@volantis.png æ‚¨å¯ä»¥æ”¾ç½®åœ¨æ–‡ç« é¡µè„šç”¨äºå±•ç¤ºæ‰“èµå›¾ç‰‡ï¼Œä¹Ÿå¯ä»¥æ”¾ç½®åœ¨ä¾§è¾¹æ ã€‚ é€šç”¨æ–‡æœ¬éƒ¨ä»¶blog/_config.volantis.ymlrepos: class: text display: [desktop] # [desktop, mobile] header: icon: fab fa-github title: ç‚¹ä¸ªèµå§ url: https://github.com/xaoxuu/ content: - &#x27;æ‚¨çš„èµå¯¹æˆ‘æ¥è¯´å¾ˆé‡è¦ï¼Œå¦‚æœæ‚¨å–œæ¬¢æœ¬ä¸»é¢˜ï¼Œå¸Œæœ›èƒ½å¤Ÿç»™ä¸‹é¢çš„é¡¹ç›®ç‚¹ä¸ªèµæ¥æ”¯æŒä¸€ä¸‹ã€‚&#x27; - &#x27;[&lt;img src=&quot;https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/proj/prohud/logo.png&quot; height=&quot;50px&quot;&gt;](https://github.com/xaoxuu/ProHUD)&#x27; - &#x27;[&lt;img src=&quot;https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/proj/valuex/logo.png&quot; height=&quot;50px&quot;&gt;](https://github.com/xaoxuu/ValueX)&#x27; - &#x27;[&lt;img src=&quot;https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/proj/inspire/logo.png&quot; height=&quot;50px&quot;&gt;](https://github.com/xaoxuu/Inspire)&#x27; æ‚¨å¯ä»¥åˆ›å»ºç”¨äºå±•ç¤ºä»»ä½•æ–‡æœ¬å†…å®¹çš„æ–‡æœ¬éƒ¨ä»¶ã€‚ é€šç”¨åˆ—è¡¨éƒ¨ä»¶blog/_config.volantis.ymlwiki-hexo-theme: class: list display: [desktop, mobile] # [desktop, mobile] header: icon: fas fa-chevron-left title: Hexo Themes url: /wiki/ rows: - name: Volantis for Hexo url: /wiki/volantis/ - name: Resume for Hexo url: /wiki/resume/ æ‚¨å¯ä»¥åˆ›å»ºç”¨äºå±•ç¤ºä»»ä½•é“¾æ¥åˆ—è¡¨çš„åˆ—è¡¨éƒ¨ä»¶ã€‚åˆ—è¡¨çš„ rows ä¸­çš„æ¯ä¸€é¡¹æ”¯æŒçš„å±æ€§æœ‰ï¼š nameã€urlã€iconã€imgã€avatarï¼Œå…¶ä¸­ img æ˜¯æ–¹å½¢å›¾ç‰‡çš„é“¾æ¥ï¼Œavatar æ˜¯åœ†å½¢å›¾ç‰‡çš„é“¾æ¥ã€‚ ç»„ç´¢å¼•è¿™ä¸ªéƒ¨ä»¶çš„å¸ƒå±€ç»§æ‰¿è‡ª list éƒ¨ä»¶ï¼Œç”¨äºå±•ç¤ºæ–‡ç« æ‰€å±çš„åˆ†ç»„çš„æ–‡ç« åˆ—è¡¨ã€‚è¯·å°†æ‚¨çš„ Volantis å‡çº§è‡³ 2.5 ç‰ˆæœ¬ä»¥ä¸Šä½¿ç”¨ã€‚ blog/_config.volantis.ymlgroup-1: class: group display: [desktop, mobile] # [desktop, mobile] header: icon: fab fa-github title: Git url: /wiki/git/ åœ¨æ–‡ç« çš„ front-matter ä¸­è®¾ç½®ï¼šfront-mattergroup: group-1order: 16sidebar: [group-1, toc] ã€Œgroup-1ã€å¡ç‰‡å°†ä¼šä»¥åˆ—è¡¨çš„å½¢å¼æ˜¾ç¤ºæ‰€æœ‰è®¾ç½®äº† group: group-1 çš„æ–‡ç« ï¼Œé¡ºåºæŒ‰ç…§ order ä»å°åˆ°å¤§æ’åˆ—ã€‚ é€šç”¨ç½‘æ ¼éƒ¨ä»¶blog/_config.volantis.ymlfeedback: class: grid display: [desktop, mobile] header: icon: fas fa-headset title: è”ç³»å¼€å‘è€… url: https://github.com/volantis-x/hexo-theme-volantis fixed: true # å›ºå®šå®½åº¦ rows: - name: åé¦ˆBUG icon: fas fa-bug url: https://github.com/volantis-x/hexo-theme-volantis/issues/ - name: ç–‘é—®æ±‚åŠ© icon: fas fa-question-circle url: https://github.com/volantis-x/hexo-theme-volantis/issues/ - name: æä¸ªå»ºè®® icon: fas fa-lightbulb url: https://github.com/volantis-x/hexo-theme-volantis/issues/ æ‚¨å¯ä»¥åˆ›å»ºç”¨äºå±•ç¤ºä»»ä½•é“¾æ¥åˆ—è¡¨çš„ç½‘æ ¼éƒ¨ä»¶ã€‚ç½‘æ ¼é»˜è®¤æ ¹æ®æ–‡å­—é•¿åº¦è‡ªåŠ¨ç¡®å®šæ¯ä¸€ä¸ªæ ¼å­çš„å®½åº¦ï¼Œå¦‚æœæ–‡å­—é•¿çŸ­ä¸ä¸€ï¼Œå»ºè®®é€šè¿‡è®¾ç½® fixed: true æ¥å›ºå®šå®½åº¦ï¼Œæ­¤æ—¶æ–‡å­—è¿‡é•¿çš„æ ¼å­ä¸­çš„æ–‡å­—ä¼šæ¢è¡Œæ˜¾ç¤ºã€‚ é€šç”¨é¡µé¢éƒ¨ä»¶blog/_config.volantis.ymltest: class: page display: [desktop, mobile] pid: haha content: excerpt # excerpt, more, content æ‚¨å¯ä»¥æŠŠæ•´ä¸ªé¡µé¢çš„mdå†…å®¹ä½œä¸ºä¸€ä¸ªå°éƒ¨ä»¶æ¸²æŸ“æ˜¾ç¤ºå‡ºæ¥ã€‚åªéœ€è¦è®¾ç½®å°éƒ¨ä»¶é‡Œçš„ pid å±æ€§å’Œæ–‡ç« çš„ front-matter ä¸­è®¾ç½®ä¸€æ ·çš„ pid å³å¯ã€‚ content ä»£è¡¨è¿™ä¸ªéƒ¨ä»¶æ˜¾ç¤ºçš„å†…å®¹ï¼Œå¯é€‰ excerptï¼Œmoreï¼Œcontent åˆ†åˆ«å¯¹åº”æ–‡ç« çš„æ‘˜è¦ã€æ‘˜è¦åé¢çš„å†…å®¹ã€å…¨æ–‡ã€‚ é€‰æ‹©è¯„è®ºç³»ç»Ÿç›®å‰æ”¯æŒçš„è¯„è®ºç³»ç»Ÿæœ‰ï¼š valine, twikoo, waline, minivaline, disqus, disqusjs, gitalk, vssue, livere, isso, hashover blog/_config.volantis.ymlcomments: title: &lt;i class=&#x27;fas fa-comments&#x27;&gt;&lt;/i&gt; è¯„è®º subtitle: service: valine # valine, twikoo, waline, minivaline, disqus, disqusjs, gitalk, vssue, livere, isso, hashover ValinetwikoowalineMiniValineVssueGitalkDisqusDisqusJSLivereIssoHashover...&lt;/i&gt; ä¸€æ¬¾å¿«é€Ÿã€ç®€æ´ä¸”é«˜æ•ˆçš„æ— åç«¯è¯„è®ºç³»ç»Ÿ https://valine.js.org blog/_config.volantis.ymlcomments: ... service: valine ... valine: # js: https://cdn.jsdelivr.net/npm/valine@1.4/dist/Valine.min.js path: # å…¨å±€è¯„è®ºåœ°å€ ç›®å‰è®¾ç½®å…¨å±€è¯„è®ºåœ°å€åvisitorå¤±æ•ˆ,è¿™æ˜¯valineçš„é—®é¢˜ placeholder: å¿«æ¥è¯„è®ºå§~ # è¯„è®ºå ä½æç¤º # å…¶ä»–é…ç½®é¡¹æŒ‰ç…§ymlæ ¼å¼ç»§ç»­å¡«å†™å³å¯ é™¤äº† [el path placeholder emojiCDN emojiMaps] é€‰é¡¹ appId: # your appId appKey: # your appKey ... å¯é€‰é…ç½®é¡¹è¯¦è§æºç  å…¶ä¸­ï¼Œplaceholder æ”¯æŒåœ¨ front-matter ä¸­è®¾ç½®ã€‚ front-matter---valine: placeholder: ä½ è§‰å¾—xxxæ€ä¹ˆæ ·å‘¢ï¼Ÿ--- ä¹Ÿå¯ä»¥é€šè¿‡è®¾ç½® valine.path å®ç°å¤šä¸ªé¡µé¢å…±ç”¨ä¸€ä¸ªè¯„è®ºæ¡†ã€‚ front-matter---valine: path: /---&lt;/i&gt; ä¸€ä¸ªç®€æ´ã€å®‰å…¨ã€å…è´¹çš„é™æ€ç½‘ç«™è¯„è®ºç³»ç»Ÿ | A simple, safe, free comment system. https://twikoo.js.org/ blog/_config.volantis.ymlcomments: ... service: twikoo ... twikoo: js: https://cdn.jsdelivr.net/npm/twikoo@latest # å»ºè®®é”å®šç‰ˆæœ¬ path: # å…¨å±€è¯„è®ºåœ°å€ # å…¶ä»–é…ç½®é¡¹æŒ‰ç…§ymlæ ¼å¼ç»§ç»­å¡«å†™å³å¯ é™¤äº† [el path] é€‰é¡¹ envId: xxxxxxxxxxxxxxx # è…¾è®¯äº‘ç¯å¢ƒid&lt;/i&gt; ä¸€ä¸ªç®€æ´ã€å®‰å…¨ã€å…è´¹çš„é™æ€ç½‘ç«™è¯„è®ºç³»ç»Ÿ | A simple, safe, free comment system. https://waline.js.org/ blog/_config.volantis.ymlcomments: ... service: waline ... # Waline # https://waline.js.org/ waline: js: https://cdn.jsdelivr.net/npm/@waline/client/dist/Waline.min.js path: # å…¨å±€è¯„è®ºåœ°å€ ç›®å‰è®¾ç½®å…¨å±€è¯„è®ºåœ°å€åvisitorå¤±æ•ˆ,è¿™æ˜¯walineçš„é—®é¢˜ placeholder: å¿«æ¥è¯„è®ºå§~ # è¯„è®ºå ä½æç¤º imageHosting: https://7bu.top/api/upload # å›¾åºŠapiï¼ˆé»˜è®¤ä½¿ç”¨å»ä¸å›¾åºŠï¼‰ # å…¶ä»–é…ç½®é¡¹æŒ‰ç…§ymlæ ¼å¼ç»§ç»­å¡«å†™å³å¯ é™¤äº† [el path placeholder uploadImage] é€‰é¡¹ serverURL: xxxxxxxxxxxxxxx # Waline çš„æœåŠ¡ç«¯åœ°å€ï¼ˆå¿…å¡«ï¼‰ æµ‹è¯•ç”¨åœ°å€: https://waline-ruddy.vercel.app ... å¯é€‰é…ç½®é¡¹è¯¦è§æºç &lt;/i&gt; ä¸€æ¬¾å¿«é€Ÿã€ç®€æ´ä¸”é«˜æ•ˆçš„æ— åç«¯è¯„è®ºç³»ç»Ÿ https://github.com/MiniValine/MiniValine/ blog/_config.volantis.ymlcomments: ... service: minivaline ... # MiniValine # https://github.com/MiniValine/MiniValine minivaline: js: https://cdn.jsdelivr.net/npm/minivaline@latest path: # å…¨å±€è¯„è®ºåœ°å€ placeholder: å¿«æ¥è¯„è®ºå§~ # å…¨å±€è¯„è®ºå ä½æç¤º # æ›´å¤šé€‰é¡¹ https://minivaline.js.org/docs/cn/#/Options æŒ‰ç…§ymlæ ¼å¼ç»§ç»­å¡«å†™å³å¯ ï¼ˆé™¤äº† [el path placeholder] é€‰é¡¹ï¼‰ # emoticonUrl ç­‰åˆ—è¡¨é€‰é¡¹ å¯å‚è€ƒ https://github.com/MiniValine/hexo-next-minivaline # ä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ï¼š backend: waline serverURL: https://waline.vercel.app&lt;/i&gt; Vue é©±åŠ¨çš„ã€åŸºäº Issue çš„è¯„è®ºæ’ä»¶ https://vssue.js.org/zh/ blog/_config.volantis.ymlcomments: ... service: vssue ... vssue: owner: repo: clientId: clientSecret:&lt;/i&gt; A modern comment component based on Github Issue and Preact. https://gitalk.github.io/ blog/_config.volantis.ymlcomments: ... service: gitalk ... gitalk: clientID: clientSecret: repo: owner: admin: # [] clientID å’Œ clientSecret çš„è·å–æ–¹æ³•å¯è‡ªè¡Œæœç´¢æ•™ç¨‹ï¼Œè¿™é‡Œä»…ç®€å•æè¿°ä¸€ä¸‹æ­¥éª¤ï¼š ç‚¹å‡» GitHub -&gt; Settings https://github.com/settings/profile ç‚¹å‡» Developer settings https://github.com/settings/developers ç‚¹å‡» New OAuth App https://github.com/settings/applications/new å¡«å†™ä¿¡æ¯ï¼šApplication name éšä¾¿å¡«ï¼Œæˆ‘çš„æ˜¯ï¼šxaoxuu.comHomepage URL å’Œ Authorization callback URL éƒ½å†™ä½ çš„ç½‘å€ï¼Œæˆ‘çš„æ˜¯ï¼šhttps://xaoxuu.com å¯ä»¥é€šè¿‡è®¾ç½® gitalk.id å®ç°å¤šä¸ªé¡µé¢å…±ç”¨ä¸€ä¸ªè¯„è®ºæ¡†ã€‚ front-matter---gitalk: id: /wiki/volantis/---&lt;/i&gt; Disqus - The #1 way to build an audience on your website. https://disqus.com/ blog/_config.volantis.ymlcomments: ... service: disqus ... disqus: shortname:&lt;/i&gt; Render Disqus comments in Mainland China using Disqus API https://github.com/SukkaW/DisqusJS blog/_config.volantis.ymlcomments: ... service: disqusjs ... # DisqusJS # https://github.com/SukkaW/DisqusJS disqusjs: path: # å…¨å±€è¯„è®ºåœ°å€ # é…ç½®é¡¹æŒ‰ç…§ymlæ ¼å¼ç»§ç»­å¡«å†™å³å¯ é™¤äº† [siteName url identifier] é€‰é¡¹ #shortname: #api: #apikey: #admin: #nesting:&lt;/i&gt; Communication makes better world. https://www.livere.com/ blog/_config.volantis.ymlcomments: ... service: livere ... livere: uid: #ä½ çš„livereçš„uid åœ¨è¿™é‡ŒæŸ¥çœ‹ä½ çš„ uidï¼šhttps://livere.com/insight/myCodeï¼Œåœ¨ã€ä»£ç ç®¡ç† -&gt; ä¸€èˆ¬ç½‘ç«™ã€‘ä¸­æ‰¾åˆ°å¦‚ä¸‹è¿™æ®µä»£ç ï¼Œå…¶ä¸­ data-uid ä¸­çš„å†…å®¹å°±æ˜¯ä½ çš„ livere_uidã€‚ &lt;!-- æ¥å¿…åŠ›Cityç‰ˆå®‰è£…ä»£ç  --&gt;&lt;div id=&quot;lv-container&quot; data-id=&quot;city&quot; data-uid=&quot;ä½ çš„livereçš„uid&quot;&gt;...&lt;/i&gt; A commenting server similar to Disqus. https://posativ.org/isso/ blog/_config.volantis.ymlcomments: ... service: isso ... isso: url: https://example.com/(path/) src: https://example.com/(path/)js/embed.min.js&lt;/i&gt; A free and open source PHP comment system designed to allow completely anonymous comments and easy theming. https://www.barkdull.org/software/hashover blog/_config.volantis.ymlcomments: ... service: hashover ... hashover: src: https://example.com/(path/)comments.phpblog/themes/volantis/layout/_third-party/comments/è¯„è®ºç³»ç»Ÿåç§°/layout.ejsè¿™é‡Œå†™å¸ƒå±€ä»£ç  blog/themes/volantis/layout/_third-party/comments/è¯„è®ºç³»ç»Ÿåç§°/script.ejsè¿™é‡Œè¦å†™åŠ è½½ js çš„ä»£ç  æ”¶å½•æ›´å¤šè¯„è®ºç³»ç»Ÿ ç«™å†…æœç´¢blog/_config.volantis.ymlsearch: enable: true service: hexo # hexo, google, algolia, azure, baidu js: https://cdn.jsdelivr.net/gh/volantis-x/cdn-volantis@2.6.4/js/search.js google: apiKey: engineId: algolia: applicationID: apiKey: indexName: azure: serviceName: indexName: queryKey: baidu: apiId: é»˜è®¤é…ç½®ä¸º Hexo æœç´¢ï¼Œä½†æ˜¯éœ€è¦å®‰è£…æ’ä»¶æ‰èƒ½ä½¿ç”¨ï¼šnpm i -S hexo-generator-search hexo-generator-json-content ç¬¬ä¸‰æ–¹æ’ä»¶æ’ä»¶åº“Volantis ä¸ºä¸°å¯Œçš„æ’ä»¶æä¾›äº†å…¼å®¹æ€§ä¼˜åŒ–ã€‚å¤§éƒ¨åˆ†æ’ä»¶æ‚¨åªéœ€å¼€å¯å’Œå…³é—­ï¼Œæ— éœ€è¿›è¡Œè®¾ç½®ã€‚ blog/_config.volantis.ymlplugins: ################# required plugins ################ # jquery jquery: https://cdn.jsdelivr.net/npm/jquery@3.5/dist/jquery.min.js # fontawesome fontawesome: https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.14/css/all.min.css ################# optional plugins ################ ######### Plugins to improve loading speed: # é¢„åŠ è½½ preload: enable: true service: flying_pages # instant_page, flying_pages instant_page: https://cdn.jsdelivr.net/gh/volantis-x/cdn-volantis@2/js/instant_page.js flying_pages: https://cdn.jsdelivr.net/gh/gijo-varghese/flying-pages@2.1.2/flying-pages.min.js # å›¾ç‰‡æ‡’åŠ è½½ # https://www.npmjs.com/package/vanilla-lazyload lazyload: enable: true js: https://cdn.jsdelivr.net/npm/vanilla-lazyload@17.1.0/dist/lazyload.min.js onlypost: false loadingImg: # https://cdn.jsdelivr.net/gh/volantis-x/cdn-volantis@3/img/placeholder/c617bfd2497fcea598e621413e315c368f8d8e.svg blurIn: true # æ¨¡ç³ŠåŠ è½½æ•ˆæœ ï¼ˆloadingImgä¸ºç©ºæ—¶æœ‰æ•ˆï¼‰ ######### Plugins to optimize the experience: # highlight.js highlightjs: enable: #true # Please set hexo.config.highlight.enable = false !!! js: https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@10/build/highlight.min.js css: https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@10/build/styles/solarized-light.min.css # more: https://www.jsdelivr.com/package/npm/highlight.js?path=styles # https://scrollrevealjs.org/api/reveal.html scrollreveal: enable: #true js: https://cdn.jsdelivr.net/npm/scrollreveal@4.0.6/dist/scrollreveal.min.js distance: 32px duration: 800 # ms interval: 20 # ms scale: 1 # 0.1~1 # Codeblock Copy Button clipboard: enable: #true js: https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js ######### Plugins for SEO: # npm i hexo-wordcount wordcount: enable: #true ######### Plugins for ... # Button Ripple Effect nodewaves: enable: #true css: https://cdn.jsdelivr.net/npm/node-waves@0.7.6/dist/waves.min.css js: https://cdn.jsdelivr.net/npm/node-waves@0.7.6/dist/waves.min.js # fontawesome animation fontawesome_animation: enable: #true css: https://cdn.jsdelivr.net/gh/l-lin/font-awesome-animation/dist/font-awesome-animation.min.css # Typing Effects comment_typing: enable: #true js: https://cdn.jsdelivr.net/gh/volantis-x/cdn-volantis@2/js/comment_typing.js # Slide Background backstretch: enable: #true js: https://cdn.jsdelivr.net/npm/jquery-backstretch@2.1.18/jquery.backstretch.min.js position: cover # cover: sticky on the cover. fixed: Fixed as background for the site. shuffle: true # shuffle playlist duration: 10000 # Duration (ms) fade: 1500 # fade duration (ms) (Not more than 1500) images: # For personal use only. At your own risk if used for commercial purposes !!! - https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper-minimalist/2020/001.jpg - https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper-minimalist/2020/002.jpg - https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper-minimalist/2020/003.jpg - https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper-minimalist/2020/004.jpg - https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper-minimalist/2020/005.jpg - https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper-minimalist/2020/006.jpg - https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper-minimalist/2020/012.jpg - https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper-minimalist/2020/016.jpg - https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper-minimalist/2020/019.jpg - https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper-minimalist/2020/025.jpg - https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper-minimalist/2020/033.jpg - https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper-minimalist/2020/034.jpg - https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper-minimalist/2020/035.jpg - https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper-minimalist/2020/038.jpg - https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper-minimalist/2020/039.jpg - https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper-minimalist/2020/042.jpg - https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper-minimalist/2020/046.jpg - https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper-minimalist/2020/051.jpg - https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper-minimalist/2020/052.jpg - https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper-minimalist/2020/054.jpg - https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper-minimalist/2020/056.jpg # APlayer is only available in mainland China. # APlayer config: https://github.com/metowolf/MetingJS aplayer: enable: #true js: aplayer: https://cdn.jsdelivr.net/npm/aplayer@1.10/dist/APlayer.min.js meting: https://cdn.jsdelivr.net/npm/meting@2.0/dist/Meting.min.js # Required server: netease # netease, tencent, kugou, xiami, baidu type: playlist # song, playlist, album, search, artist id: 3175833810 # song id / playlist id / album id / search keyword # Optional fixed: false # enable fixed mode theme: &#x27;#1BCDFC&#x27; # main color autoplay: false # audio autoplay order: list # player play order, values: &#x27;list&#x27;, &#x27;random&#x27; loop: all # player loop play, values: &#x27;all&#x27;, &#x27;one&#x27;, &#x27;none&#x27; volume: 0.7 # default volume, notice that player will remember user setting, default volume will not work after user set volume themselves list_max_height: 320px # list max height list_folded: true pjax: enable: true cover: true # å°é¢æ˜¯å¦pjaxå¤„ç† falseï¼šæ¯æ¬¡åˆ‡æ¢é¡µé¢å°é¢éƒ½é‡è½½ï¼Œé€‚åˆå°é¢è¾ƒå°‘çš„æƒ…å†µ trueï¼šå°é¢ç»è¿‡Pjaxå¤„ç†ï¼Œé€‚åˆå°é¢è¾ƒå¤šçš„æƒ…å†µ timeout: 5000 # The timeout in milliseconds for the XHR requests. Set to 0 to disable the timeout. cacheBust: false # When set to true, Pjax appends a timestamp to skip the browser cache. animation: false # false, nprogress, circle banUrl: # è¢«å±è”½çš„ url åœ°å€å°†ä¸å¯ç”¨ pjax è·³è½¬ï¼Œå¯ä»¥åœ¨æ§åˆ¶å°ä¸‹ä½¿ç”¨ window.location.pathname è·å– # - &#x27;/artitalk/&#x27; # artitalk ä¸æ”¯æŒ pjax # - &#x27;/bb/&#x27; # bbtalk ä¸æ”¯æŒ pjax # ä» issues åŠ è½½åŠ¨æ€æ•°æ® # &#123;% issues sites/timeline/friends | api=xxx | group=key:a,b,c %&#125; # ä¾‹å¦‚ï¼š # &#123;% issues sites | api=https://api.github.com/repos/volantis-x/examples/issues?sort=updated&amp;state=open&amp;page=1&amp;per_page=100 | group=version:latest,v6,v5,v4,v3,v2,v1,v0 %&#125; # æš—é»‘æ¨¡å¼ darkmode # æ ·å¼ï¼šsource/css/_plugins/dark.styl # å¼€å…³æŒ‰é’®ï¼šåœ¨ navbar.menu ä¸­æ·»åŠ ï¼š # - name: æš—é»‘æ¨¡å¼ # å¯è‡ªå®šä¹‰ # icon: fas fa-moon # å¯è‡ªå®šä¹‰ # toggle: darkmode darkmodejs: enable: #true # æ—§ç‰ˆ Internet Explorer æ·˜æ±°è¡ŒåŠ¨ # https://www.microsoft.com/zh-cn/WindowsForBusiness/End-of-IE-support # æœ¬ä¸»é¢˜ä¸æ”¯æŒInternet Explorerçš„ä»»ä½•ç‰ˆæœ¬!!! killOldVersionsOfIE: enable: true # ç¦ç”¨JavaScriptæç¤º # æœ¬é¡µé¢éœ€è¦æµè§ˆå™¨æ”¯æŒï¼ˆå¯ç”¨ï¼‰JavaScript # ä¸»é¢˜ä¸­çš„æŸäº›æ’ä»¶å¿…é¡»å¯ç”¨JavaScriptæ‰èƒ½æ­£å¸¸å·¥ä½œï¼Œä¾‹å¦‚å¼€å¯scrollrevealå¦‚æœç¦ç”¨JavaScriptä¼šå¯¼è‡´å¡ç‰‡æ¶ˆå¤± killNoScript: enable: true # Artitalk https://artitalk.js.org # é…ç½®è¿‡ç¨‹è¯·å‚è€ƒï¼šhttps://artitalk.js.org/doc.html # ä½¿ç”¨è¿‡æ—§ç‰ˆæœ¬çš„è¯·ä¿®æ”¹Leancloud shuoshuo classéƒ¨åˆ†åˆ—åï¼šhttps://artitalk.js.org/release.html # é™¤appIDå’ŒappKEYå¤–å‡ä¸ºé€‰å¡«é¡¹ artitalk: # Set `layout: artitalk` to enable in page # é…ç½®é¡¹æŒ‰ç…§ymlæ ¼å¼ç»§ç»­å¡«å†™å³å¯ appId: ogP8qj3veMh0LFpFWMPOyF0X-MdYXbMMI # your appID appKey: nHXLd3N3Jgh460t2iRQKWAtr # your appKEY # serverURL: #leancloudç»‘å®šçš„å®‰å…¨åŸŸåï¼Œä½¿ç”¨å›½é™…ç‰ˆçš„è¯ä¸éœ€è¦å¡«å†™ # lang: # è¯­è¨€è®¾ç½®ï¼Œzhä¸ºæ±‰è¯­ï¼Œenä¸ºè‹±è¯­ï¼Œesä¸ºè¥¿ç­ç‰™è¯­ã€‚é»˜è®¤ä¸ºæ±‰è¯­ # pageSize: #æ¯é¡µè¯´è¯´çš„æ˜¾ç¤ºæ•°é‡ # shuoPla: #åœ¨ç¼–è¾‘è¯´è¯´çš„è¾“å…¥æ¡†ä¸­çš„å ä½ç¬¦ # avatarPla: #è‡ªå®šä¹‰å¤´åƒurlçš„è¾“å…¥æ¡†çš„å ä½ç¬¦ # motion: #åŠ è½½åŠ¨ç”»çš„å¼€å…³ï¼Œ1ä¸ºå¼€ï¼Œ0ä¸ºå…³ï¼Œé»˜è®¤ä¸ºå¼€ # bgImg: #è¯´è¯´è¾“å…¥æ¡†èƒŒæ™¯å›¾ç‰‡url # color1: #è¯´è¯´èƒŒæ™¯é¢œè‰²1&amp;æŒ‰é’®é¢œè‰²1 # color2: #è¯´è¯´èƒŒæ™¯é¢œè‰²2&amp;æŒ‰é’®é¢œè‰²2 # color3: #è¯´è¯´å­—ä½“é¢œè‰² # cssUrl: #è‡ªå®šä¹‰cssæ¥å£ # BBtalk https://bb.js.org bbtalk: js: https://cdn.jsdelivr.net/npm/bbtalk@0.1.5/dist/bbtalk.min.js # BBtalk.js appId: 0KzOX4vC7Jsk6vzUGNeEiUaI-gzGzoHsz # your appID appKey: HwCiWuxfpvKiLm4teCUgTIba # your appKEY serverURLs: https://bbapi.heson10.com # Request Api åŸŸå # TidioèŠå¤©åŠŸèƒ½ # https://www.tidio.com/ tidio: enable: #true id: xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx å¹»ç¯ç‰‡èƒŒæ™¯blog/_config.volantis.ymlplugins: ... backstretch: enable: true js: https://cdn.jsdelivr.net/npm/jquery-backstretch@2.1.18/jquery.backstretch.min.js position: cover # cover: sticky on the cover. fixed: Fixed as background for the site. duration: 20000 # Duration (ms) fade: 1500 # fade duration (ms) (Not more than 1500) images: # For personal use only. At your own risk if used for commercial purposes !!! - https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper/abstract/41F215B9-261F-48B4-80B5-4E86E165259E.jpeg ... å¹»ç¯ç‰‡èƒŒæ™¯å›¾ç‰‡æ˜¾ç¤ºçš„ä½ç½®å¯ä»¥é€‰æ‹©ç²˜è´´åœ¨å°é¢ä¸Šï¼Œè·Ÿéšå°é¢ä¸€èµ·æ»‘åŠ¨ï¼Œä¹Ÿå¯ä»¥é€‰æ‹©å›ºå®šä½œä¸ºç½‘é¡µèƒŒæ™¯å›¾ç‰‡ã€‚ highlight.jsblog/_config.volantis.ymlplugins: ... # highlight.js highlightjs: enable: true # Please set hexo.config.highlight.enable = false !!! js: https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@10/build/highlight.min.js css: https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@10/build/styles/solarized-light.min.css # more: https://www.jsdelivr.com/package/npm/highlight.js?path=styles å¦‚æœéœ€è¦ä½¿ç”¨ highlight.js è¿›è¡Œè¯­æ³•é«˜äº®ï¼Œè¯·å°†ç«™ç‚¹é…ç½®æ–‡ä»¶ä¸­çš„ highlight.enable è®¾ç½®ä¸º false å¦åˆ™ä¸ä¼šåŠ è½½æ’ä»¶ã€‚æ‚¨å¯ä»¥åœ¨ 94 ç§ è¯­æ³•é«˜äº®ä¸»é¢˜ ä¸­æŒ‘é€‰å–œçˆ±çš„ä¸»é¢˜ï¼Œç„¶åæ›¿æ¢ä¸Šé¢çš„ css é“¾æ¥ã€‚ å¦‚æœæ‚¨ä½¿ç”¨ highlight.js è¯·ç¡®ä¿æ²¡æœ‰ä½¿ç”¨ hexo å®˜æ–¹çš„ codeblock æ ‡ç­¾ï¼Œå¦åˆ™ä¼šæŠ¥é”™ã€‚ ç»æµ‹è¯•ï¼Œä½¿ç”¨ highlight.js çš„æƒ…å†µä¸‹ï¼Œéƒ¨åˆ†å®¹å™¨å†…çš„ä»£ç å¯èƒ½ä»ç„¶ä¼šè¢«æ¸²æŸ“ç”šè‡³æŠ¥é”™ã€‚ APlayer éŸ³ä¹æ’­æ”¾å™¨blog/_config.volantis.ymlplugins: ... # APlayer is only available in mainland China. # APlayer config: https://github.com/metowolf/MetingJS aplayer: enable: true js: aplayer: https://cdn.jsdelivr.net/npm/aplayer@1.10/dist/APlayer.min.js meting: https://cdn.jsdelivr.net/npm/meting@2.0/dist/Meting.min.js # Required server: netease # netease, tencent, kugou, xiami, baidu type: playlist # song, playlist, album, search, artist id: 3175833810 # song id / playlist id / album id / search keyword # Optional fixed: false # enable fixed mode theme: &#x27;#1BCDFC&#x27; # main color autoplay: false # audio autoplay order: list # player play order, values: &#x27;list&#x27;, &#x27;random&#x27; loop: all # player loop play, values: &#x27;all&#x27;, &#x27;one&#x27;, &#x27;none&#x27; volume: 0.7 # default volume, notice that player will remember user setting, default volume will not work after user set volume themselves list_max_height: 320px # list max height list_folded: true APlayeræ’­æ”¾å™¨åªå¯ä»¥åœ¨ä¸­å›½å¤§é™†åœ°åŒºä½¿ç”¨ã€‚ç›¸å…³æ–‡æ¡£ï¼š APlayer | MetingJS æš—é»‘æ¨¡å¼blog/_config.volantis.ymlplugins: ... # æ ·å¼ï¼šsource/css/_plugins/dark.styl # å¼€å…³æŒ‰é’®ï¼šåœ¨ navbar.menu ä¸­æ·»åŠ ï¼š # - name: æš—é»‘æ¨¡å¼ # å¯è‡ªå®šä¹‰ # icon: fas fa-moon # å¯è‡ªå®šä¹‰ # toggle: darkmode darkmodejs: enable: true ç»“æŸæ”¯æŒblog/_config.volantis.ymlplugins: ... # æ—§ç‰ˆ Internet Explorer æ·˜æ±°è¡ŒåŠ¨ # https://www.microsoft.com/zh-cn/WindowsForBusiness/End-of-IE-support # æœ¬ä¸»é¢˜ä¸æ”¯æŒInternet Explorerçš„ä»»ä½•ç‰ˆæœ¬!!! killOldVersionsOfIE: enable: true # ç¦ç”¨JavaScriptæç¤º # æœ¬é¡µé¢éœ€è¦æµè§ˆå™¨æ”¯æŒï¼ˆå¯ç”¨ï¼‰JavaScript # ä¸»é¢˜ä¸­çš„æŸäº›æ’ä»¶å¿…é¡»å¯ç”¨JavaScriptæ‰èƒ½æ­£å¸¸å·¥ä½œï¼Œä¾‹å¦‚å¼€å¯scrollrevealå¦‚æœç¦ç”¨JavaScriptä¼šå¯¼è‡´å¡ç‰‡æ¶ˆå¤± killNoScript: enable: true Artitalkblog/_config.volantis.ymlplugins: ... # Artitalk https://artitalk.js.org # é…ç½®è¿‡ç¨‹è¯·å‚è€ƒï¼šhttps://artitalk.js.org/doc.html # ä½¿ç”¨è¿‡æ—§ç‰ˆæœ¬çš„è¯·ä¿®æ”¹Leancloud shuoshuo classéƒ¨åˆ†åˆ—åï¼šhttps://artitalk.js.org/release.html # é™¤appIDå’ŒappKEYå¤–å‡ä¸ºé€‰å¡«é¡¹ artitalk: # Set `layout: artitalk` to enable in page # é…ç½®é¡¹æŒ‰ç…§ymlæ ¼å¼ç»§ç»­å¡«å†™å³å¯ appId: ogP8qj3veMh0LFpFWMPOyF0X-MdYXbMMI # your appID appKey: nHXLd3N3Jgh460t2iRQKWAtr # your appKEY # serverURL: #leancloudç»‘å®šçš„å®‰å…¨åŸŸåï¼Œä½¿ç”¨å›½é™…ç‰ˆçš„è¯ä¸éœ€è¦å¡«å†™ # lang: # è¯­è¨€è®¾ç½®ï¼Œzhä¸ºæ±‰è¯­ï¼Œenä¸ºè‹±è¯­ï¼Œesä¸ºè¥¿ç­ç‰™è¯­ã€‚é»˜è®¤ä¸ºæ±‰è¯­ # pageSize: #æ¯é¡µè¯´è¯´çš„æ˜¾ç¤ºæ•°é‡ # shuoPla: #åœ¨ç¼–è¾‘è¯´è¯´çš„è¾“å…¥æ¡†ä¸­çš„å ä½ç¬¦ # avatarPla: #è‡ªå®šä¹‰å¤´åƒurlçš„è¾“å…¥æ¡†çš„å ä½ç¬¦ # motion: #åŠ è½½åŠ¨ç”»çš„å¼€å…³ï¼Œ1ä¸ºå¼€ï¼Œ0ä¸ºå…³ï¼Œé»˜è®¤ä¸ºå¼€ # bgImg: #è¯´è¯´è¾“å…¥æ¡†èƒŒæ™¯å›¾ç‰‡url # color1: #è¯´è¯´èƒŒæ™¯é¢œè‰²1&amp;æŒ‰é’®é¢œè‰²1 # color2: #è¯´è¯´èƒŒæ™¯é¢œè‰²2&amp;æŒ‰é’®é¢œè‰²2 # color3: #è¯´è¯´å­—ä½“é¢œè‰² # cssUrl: #è‡ªå®šä¹‰cssæ¥å£ BBtalkblog/_config.volantis.ymlplugins: ... bbtalk: js: https://cdn.jsdelivr.net/npm/bbtalk@0.1.5/dist/bbtalk.min.js # BBtalk.js appId: 0KzOX4vC7Jsk6vzUGNeEiUaI-gzGzoHsz # your appID appKey: HwCiWuxfpvKiLm4teCUgTIba # your appKEY serverURLs: https://bbapi.heson10.com # Request Api åŸŸå Tidioblog/_config.volantis.ymlplugins: ... # TidioèŠå¤©åŠŸèƒ½ # https://www.tidio.com/ tidio: enable: true id: xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"},{"title":"Coding","date":"2021-02-28T07:55:08.295Z","updated":"2021-02-28T07:55:08.295Z","comments":true,"path":"lc/index.html","permalink":"http://iequa.com/lc/index.html","excerpt":"","text":"Leetcode åˆ†ç±»æ€»ç»“ LCP 18. æ—©é¤ç»„åˆ, LCP 19. ç§‹å¶æ”¶è—é›†, sortä¸sortedçš„åŒºåˆ« # &quot;abc&quot;.zfill(5) 00abc# result.append(-heapq.heappop(heap)) return result[::-1]class TreeNode: def __init__(self, x): self.val = x self.left = None self.right = None Data Engineer No. Question Flag &nbsp; 840. Magic Squares In Grid for i in range(len(grid)-2):&nbsp;&nbsp;for j in range(len(grid[i])-2):&nbsp;&nbsp;&nbsp;&nbsp;subset.append(grid[i][j:j+3])&nbsp;&nbsp;&nbsp;&nbsp;subset.append(grid[i+1][j:j+3])&nbsp;&nbsp;&nbsp;&nbsp;subset.append(grid[i+2][j:j+3]) â &nbsp; 25. K ä¸ªä¸€ç»„ç¿»è½¬é“¾è¡¨ 1-&gt;2-&gt;3-&gt;4-&gt;5 å½“ k = 3 æ—¶ï¼Œåº”å½“è¿”å›: 3-&gt;2-&gt;1-&gt;4-&gt;5 &nbsp; def reverse(self, head: ListNode, tail: ListNode): prev=tail.next p=head &nbsp; def reverseKGroup(head, k): hair = ListNode(0) while head: &nbsp; (1) æŸ¥çœ‹å‰©ä½™éƒ¨åˆ†é•¿åº¦æ˜¯å¦å¤§äºç­‰äº k (2). æŠŠå­é“¾è¡¨é‡æ–°æ¥å›åŸé“¾è¡¨ hard 1. è‚¡ç¥¨æœ€å¤§åˆ©æ¶¦(ä¹°å–ä¸€æ¬¡) cost, profit = float(â€œ+infâ€), 0 cost = min(cost, price); profit = max(profit, price - cost) â 2. Move Zeroes for i in range(len(nums)): if nums[i]: swap(nums[i], nums[j]) â 3. 102. äºŒå‰æ ‘çš„å±‚åºéå†from collections import dequequeue = collections.deque(); queue.append(root); while queue: size = len(queue)cur = queue.popleft()queue.append(cur.left)queue.append(cur.right) â 4. 83. åˆ é™¤æ’åºé“¾è¡¨ä¸­çš„é‡å¤å…ƒç´  while cur and cur.next: if â€¦ : cur.next = cur.next.next82. åˆ é™¤æ’åºé“¾è¡¨ä¸­çš„é‡å¤å…ƒç´  II - åˆ é™¤æ‰€æœ‰å«æœ‰é‡å¤æ•°å­—çš„èŠ‚ç‚¹ dHead = ListNode(0), dHead.next = head pre,cur = dHead,head; while cur: pre.next = cur.next è·³è¿‡é‡å¤éƒ¨åˆ† â 5. å¦‚ä½•å®ç°LRU, åŒå‘é“¾è¡¨+Dict+Size+Cap class DLinkedNode(4), removeTail, moveToHead, addToHead, removeNode âœ”ï¸â 6. 125. éªŒè¯å›æ–‡ä¸², while left &lt; right: while left &lt; right and not s[left].isalnum(): æ‰©å±•: 5. æœ€é•¿å›æ–‡å­ä¸² dp, æšä¸¾é•¿åº¦ &nbsp; for l in range(n): for i in n: dp[i][j] = (dp[i + 1][j - 1] and s[i] == s[j]) â 7. 101. å¯¹ç§°äºŒå‰æ ‘ &nbsp; class TreeNode: def __init__(self, x): &nbsp; isSymmetricHelper(left.left, right.right) and isSymmetricHelper(left.right, right.left) â 8. 98. éªŒè¯äºŒå‰æœç´¢æ ‘, stack, inorder = [], float(â€˜-infâ€™)while stack or root: while root â 9. æ‰¾å‡ºæ•°ç»„é‡Œä¸‰ä¸ªæ•°ç›¸ä¹˜æœ€å¤§çš„é‚£ä¸ªï¼ˆæœ‰æ­£æœ‰è´Ÿï¼‰, nums.sort() a = nums[-1] * nums[-2] * nums[-3]b = nums[0] * nums[1] * nums[-1] â 10. åšé¢˜ï¼šä¸¤ä¸ªåå…­è¿›åˆ¶æ•°çš„åŠ æ³• â 11. 93. å¤åŸIPåœ°å€, &quot;.&quot;.join([&#39;1&#39;,&#39;2&#39;,&#39;3&#39;,&#39;4&#39;]) == &#39;1.2.3.4&#39;,&nbsp; ord(&quot;a&quot;) = 97 &nbsp; dfs(seg_id, seg_start) for seg_end in range(seg_start, len(s)): &nbsp;&nbsp; if 0 &lt; addr &lt;= 0xFFï¼ˆ11111111==255): âœ”ï¸â 12. 202. å¿«ä¹æ•°, divmod(79, 10) = (7,9); while n &gt; 0: &nbsp;&nbsp;n, digit = divmod(n, 10)&nbsp;&nbsp;total_sum += digit ** 2 â 13. å¿«æ’å½’å¹¶æ‰‹æ’• for i in range(l, r+1): nums[i] = arr[i - l] â 14. 1143. æœ€é•¿å…¬å…±å­åºåˆ— dp = [[0] * (n + 1) for _ in range(m + 1)] &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if text1[i - 1] == text2[j - 1]: dp[i][j] = dp[i-1][j-1] + 1 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else: dp[i][j] = max(dp[i-1][j], dp[i][j-1]) â 15. 3. æ— é‡å¤å­—ç¬¦çš„æœ€é•¿å­ä¸², occ=set(); &nbsp; for l in range(n): remove(i-1), while r+1 &lt; n and s[r+1] not in occ: add(r+1) â 16. 405-æ•°å­—è½¬æ¢ä¸ºåå…­è¿›åˆ¶æ•°, bin(dec), oct(dec), hex(dec), int(â€˜0b10000â€™, 2) â 17. 67. äºŒè¿›åˆ¶æ±‚å’Œï¼Œ for i, j in zip(a[::-1], b[::-1]):&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; s = int(i) + int(j) + carry, r = str(s % 2) + r, carry = s // 2 list(zip([1,2,3], [4,5,6])) == [(1, 4), (2, 5), (3, 6)] â 18. 4. å¯»æ‰¾ä¸¤ä¸ªæ­£åºæ•°ç»„çš„ä¸­ä½æ•° - hard , äºŒåˆ†æŸ¥æ‰¾ O(log (m+n)) , k/2-1=7/2âˆ’1=2 def getKthElement(k): A: 1 3 4 9 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;â†‘B: 1 2 3 4 5 6 7 8 9&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;â†‘k=k-k/2=4, ä¸‹ä¸€ä¸ªä½ç½®æ˜¯ k/2-1 = 4/2-1 = 1 âœ”ï¸â 19. å‰‘æŒ‡ Offer 55 - II. å¹³è¡¡äºŒå‰æ ‘ &nbsp; (1). abs(maxHigh(root.left) - maxHigh(root.right)) &lt;= 1 &nbsp; (2). self.isBalanced(root.left) and self.isBalanced(root.right) â 20. 155. æœ€å°æ ˆ, self.stack = [], self.min_stack = [float(â€˜infâ€™)] â 21. éé€’å½’å•é“¾è¡¨åè½¬ ç°åœºæ‰‹å†™ â 22. 105. ä»å‰åºä¸ä¸­åºéå†åºåˆ—æ„é€ äºŒå‰æ ‘ root = TreeNode(preorder[0]) i = inorder.index(preorder[0]) â 23. å…¨æ’åˆ—, def dfs(x): if x == len(c) - 1: res.append(â€˜â€™.join(c)) &nbsp;&nbsp;&nbsp;&nbsp; for i in range(first, n): â 24. 1262. å¯è¢«ä¸‰æ•´é™¤çš„æœ€å¤§å’Œ, é¢˜è§£ &nbsp;&nbsp;è´ªå¿ƒ+é€†å‘æ€ç»´ï¼š &nbsp;&nbsp; a = [x for x in nums if x % 3 == 0] &nbsp;&nbsp; b = sorted([x for x in nums if x % 3 == 1], reverse=True)&nbsp;&nbsp; c = sorted([x for x in nums if x % 3 == 2], reverse=True) â 27. ä¸¤åƒä¸‡ä¸ªæ–‡ä»¶æ‰¾æœ€å°çš„ä¸€åƒä¸ªï¼ˆç­”é”™äº†ï¼Œåº”è¯¥ç”¨å¤§é¡¶å †ï¼Œç­”æˆäº†å°é¡¶å †ï¼‰ â 28. 10äº¿ä¸ªæ•°ä¸­æ‰¾å‡ºæœ€å¤§çš„10000ä¸ªæ•°? &nbsp;&nbsp;&nbsp;&nbsp; å°†1äº¿ä¸ªæ•°æ®åˆ†æˆ100ä»½ï¼Œæ¯ä»½100ä¸‡ä¸ªæ•°æ®ï¼Œæ‰¾åˆ°æ¯ä»½æ•°æ®ä¸­æœ€å¤§çš„10000ä¸ªï¼Œæœ€ååœ¨å‰©ä¸‹çš„100*10000ä¸ªæ•°æ®é‡Œé¢æ‰¾å‡ºæœ€å¤§çš„10000ä¸ª åˆ†æ²»æ³• 29. 1000ä¸ªæ•°æ®ï¼ŒæŸ¥æ‰¾å‡ºç°æ¬¡æ•°æœ€å¤šçš„kä¸ªæ•°å­— æˆ‘ä»¬é¦–å…ˆä¸€æ ·æ˜¯è¦æŠŠè¿™åäº¿ä¸ªæ•°åˆ†æˆå¾ˆå¤šä»½ã€‚ä¾‹å¦‚ 1000ä»½ï¼Œæ¯ä»½ 10ä¸‡ã€‚ç„¶åä½¿ç”¨ HashMap æ¥ç»Ÿè®¡ã€‚åœ¨æ¯ä¸€æ¬¡çš„ç»Ÿè®¡ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥æ‰¾å‡ºæœ€å¤§çš„100ä¸ªæ•°ï¼Ÿ è¿™æ ·100*10000 å¯ä»¥ å¿«æ’åº è§£å†³ 1. åˆ†æ²»æ³•HashMap 2. ä½å›¾æ³•Bitmap 30. 239. æ»‘åŠ¨çª—å£æœ€å¤§å€¼, é¢˜è§£ åŒç«¯é˜Ÿåˆ— &nbsp;(1). # init deque and output: &nbsp;&nbsp;while deq and nums[i] &gt; nums[deq[-1]]: deq.pop() &nbsp;(2). # build output: &nbsp;&nbsp;&nbsp;&nbsp;for i in range(k, n): âœ”ï¸â HOT No. Question Flag Meeting Meeting Rooms ç³»åˆ— easy 252 Meeting Rooms I, Sort, right = intervals[0][-1] for : if x&lt;right: return False â heapq 253 Meeting Rooms II , heapq ä¸­çš„ free_rooms ä»£è¡¨æˆ¿é—´ä¸ªæ•° &nbsp; intervals.sort(key= lambda x: x[0]) &nbsp; heapq.heappush(free_rooms, intervals[0][1]), for i in intervals[1:] re len(free_rms) â Array æŒ‡é’ˆ, å†’æ³¡ &nbsp; 75 Sort Colors, 2é å•æŒ‡é’ˆå›ºå®šå¢åŠ , if nums[i] == 0: nums[i], nums[p] = nums[p], nums[i] â Array Sort idea, æ¨¡æ‹Ÿ &nbsp; 621 ä»»åŠ¡è°ƒåº¦å™¨ï¼Œ æ¡¶æ€æƒ³ + æ¨¡æ‹Ÿè®¡ç®— ä¸¤ä¸ªç›¸åŒç§ç±»çš„ä»»åŠ¡é—´å¿…é¡»æœ‰é•¿åº¦ä¸ºæ•´æ•° n çš„å†·å´æ—¶é—´for i in set(tasks):tnum.append(tasks.count(i)) maxt=max(tnum) â Array æœç´¢æ—‹è½¬æ’åºæ•°ç»„ nums = [4,5,6,7,0,1,2], target = 0 , åŒif åˆ¤æ–­ä½ç½® Array å‰‘æŒ‡ Offer 11. æ—‹è½¬æ•°ç»„çš„æœ€å°æ•°å­— &nbsp; 33. æœç´¢æ—‹è½¬æ’åºæ•°ç»„, nums[0] &lt;= nums[mid] if nums[0] &lt;= target &lt; nums[mid]: while l &lt;= r: mid = (l + r) // 2 if nums[mid] == target: return mid â Array å•è°ƒæ€§æœ‰å…³ âœ”ï¸ æ’ç©ºæ³• 406. æ ¹æ®èº«é«˜é‡å»ºé˜Ÿåˆ— Queue Reconstruction by Height &nbsp;&nbsp;people.sort(key=lambda x:(-x[0], x[1])), æ’ç©ºæ³•, ans[p[1],p[1]]=[p] ,&nbsp; tmp[:] â Stock è‚¡ç¥¨ä¹°å–ç³»åˆ— &nbsp; 121. ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœº , inf = int(1e9), int max = sys.maxsize &nbsp; maxprofit = max(price - minprice, maxprofit) â &nbsp; 122. ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœº II, è´ªå¿ƒç®€å• &amp; DP åˆ†çŠ¶æ€è®¨è®º &nbsp; dp[i][0] = max(dp[i - 1][0], dp[i - 1][1] + prices[i]); &nbsp; dp[i][1] = max(dp[i - 1][1], dp[i - 1][0] - prices[i]); &nbsp; 309. Best Time to Buy and Sell Stock with Coo, é¢˜è§£ï¼šæœ€ä½³ä¹°å–è‚¡ç¥¨æ—¶æœºå«å†·å†»æœŸ 1. f[i][0]: æ‰‹ä¸ŠæŒæœ‰è‚¡ç¥¨çš„æœ€å¤§æ”¶ç›Š 2. f[i][1]: æ‰‹ä¸Šä¸æŒæœ‰è‚¡ç¥¨, å¹¶ä¸”å¤„äºå†·å†»æœŸçš„æœ€å¤§æ”¶ç›Š 3. f[i][2]: æ‰‹ä¸Šä¸æŒæœ‰è‚¡ç¥¨, å¹¶ä¸”ä¸å¤„äºå†·å†»æœŸçš„æœ€å¤§æ”¶ç›Š â 0-1 èƒŒåŒ… &nbsp; 416 åˆ†å‰²ç­‰å’Œå­é›†, 0-1èƒŒåŒ… å˜ä½“ âœ”ï¸ DP Tree DP, å·ä¸å· &nbsp; 337. House Robber IIIï¼Œ å·ä¸å· âœ”ï¸ äºŒç»´DP äºŒç»´æ ¼å­ DP &nbsp; 221. Maximal Square æœ€å¤§çš„æ­£æ–¹å½¢ if i == 0 or j == 0: dp[i][j] = 1 è¾¹ç•Œ &nbsp;&nbsp; dp = [[0] * columns for _ in range(rows)] &nbsp; &nbsp;&nbsp; dp[i][j] = min(dp[i - 1][j], dp[i][j - 1], dp[i - 1][j - 1]) + 1 ä¸€ç»´DP å­åºåˆ— &nbsp; 300. æœ€é•¿ä¸Šå‡å­åºåˆ—, dp[0]=1; j in range(i): dp[i] = max(dp[i], dp[j] + 1) â &nbsp; 152. Maximum Product Subarray - ä¹˜ç§¯æœ€å¤§çš„è¿ç»­å­æ•°ç»„, pre_max ,pre_min,num &nbsp;&nbsp;dp[i] = max(nums[i] pre_max, nums[i] pre_min, nums[i]) â DFS äºŒç»´æ ¼å­ &nbsp; 79. Word Search, å•è¯æœç´¢ &nbsp;&nbsp; for for if DFS å›æº¯, visited = set() visited.add((i,j)), visited.remove((i,j)) â &nbsp; 200. Number of Islands, if grid[r][c] == &quot;1&quot;: num_islands += 1 â DFS å…¨æ’åˆ— &nbsp; 39. ç»„åˆæ€»å’Œ, [2,3,6,7] = [7], [2,2,3]ï¼Œ DFS æ ‘çŠ¶å›¾ &nbsp;dfs(candidates, index, path + [candidates[index]], target - candidates[index]) â &nbsp; 78. Subsets å­é›†, æ”¾ä¸æ”¾ dfs(ix=0)ï¼Œ æœç´¢+å›æº¯ â Bool DP 139. Word Break ï¼Œ å¥½é¢˜ç›®ï¼Œ3ç§è§£æ³•, for i in n: for j in (i+1,n+1) if(dp[i] and (s[i:j] in wordDict)): dp[j]=True â &nbsp; Tree &nbsp; 543. Diameter of Binary Tree, height = return max(L, R) + 1 â stack å•è°ƒstack - åè¿›å…ˆå‡º &nbsp; 739. Daily Temperatures æ¯æ—¥æ¸©åº¦ï¼Œ while stack and temperature &gt; T[stack[-1]]: âœ”ï¸â heapq å † &nbsp; 215. Kth Largest Element in an Array â è´ªå¿ƒ ç»´æŠ¤æœ€å¤§è·ç¦» &nbsp; 55 è·³è·ƒæ¸¸æˆï¼Œ è´ªå¿ƒ ç´¢å¼•&amp;ä½ç½® rightmost = max(rightmost, i + nums[i]) â Linked LinkedList &nbsp; 234. Palindrome Linked List, å·§å¦™é€’å½’+front_point or vals == vals[::-1] âœ”ï¸â &nbsp; 114. Flatten Binary Tree to Linked List &nbsp; pre_list = list(), for i in pre_list: prev.left=None, prev.right=curr â Tree 538 Convert BST to Greater Tree, åä¸­åºé, def dfs(root: TreeNode): nonlocal total â &nbsp; Sliding Window å‰ç¼€å’Œå“ˆå¸Œä¼˜åŒ– 560. å’Œä¸ºKçš„å­æ•°ç»„ &nbsp;&nbsp; num_times = collections.defaultdict(int), num_times[0]=1 &nbsp;&nbsp;&nbsp;cur_sum - k in nums_times, res += num_times[cur_sum - k] â HOT100 No. Question Flag (1). binary-search good 15. 3Sum == TwoSumï¼Œ nums.sort(), for for while second &lt; third, sec_ix &amp; thd_ix â Array 283. Move Zeroesï¼Œ å†’æ³¡æ€æƒ³ â &nbsp; 48. Rotate Image, n*n matrix, ä¸Šä¸‰è§’ã€è½¬ç½®+reverse()ã€‘, matrix[i].reverse() âœ”ï¸â (2). Dynamic programming, DP &nbsp; 53. Maximum Subarrayï¼Œ è¿ç»­çš„æœ€å¤§å­åºå’Œ â &nbsp; 64. Minimum Path Sum äºŒç»´æ ¼å­çš„æœ€å°è·¯å¾„å’Œ ï¼Œ æ ¼å­ DPï¼ˆå‘å·¦å’Œå‘ä¸‹èµ°ï¼‰ â &nbsp; 198 æ‰“å®¶åŠ«èˆ , dp = [0] * size, dp[0], dp[1], dp[i]=max(dp[i - 2] + nums[i], dp[i - 1]) â (3). æ¨¡æ‹Ÿ &nbsp; 31. Next Permutation == 8.5 ä¸‹ä¸€ä¸ªæ›´å¤§å…ƒç´  III â (4). DFS / BFS / Tree / Stack &nbsp; 56. Merge Intervals ï¼Œ Sort+éå†, æ›¿æ¢ç»“æœ&nbsp; intervals.sort(key=lambda x: x[0]) &nbsp; merged[-1][1] = max(merged[-1][1], interval[1]) â &nbsp; 21. Merge Two Sorted Lists â å¡ç‰¹å…° 96. Unique Binary Search Trees , 2(2n+1)/n+1 â (6). LinkedList &nbsp; 142. Linked List Cycle IIï¼Œ è½¬ä¸ºç¯å½¢é“¾è¡¨II-é¾Ÿå…”åˆ¤åœˆ â &nbsp; 287. Find the Duplicate Numberï¼Œ è½¬ä¸ºç¯å½¢é“¾è¡¨II-é¾Ÿå…”åˆ¤åœˆ â åŒªå¤· 148. Sort List âœ”ï¸â &nbsp; 240 æœç´¢äºŒç»´çŸ©é˜µ II , while col &lt; width and row &gt;= 0: â &nbsp; 226 ç¿»è½¬äºŒå‰æ ‘ &nbsp;&nbsp; root.left, root.right = root.right, root.left â &nbsp; 617 åˆå¹¶äºŒå‰æ ‘, new_root = TreeNode(t1.val + t2.val) â 337. House Robber IIIå·,ä¸å· é¢˜è§£ æˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªå¤§å°ä¸º 2 çš„æ•°ç»„æ¥è¡¨ç¤º int[] res = new int[2] 0 ä»£è¡¨ä¸å·ï¼Œ1 ä»£è¡¨å·ä»»ä½•ä¸€ä¸ªèŠ‚ç‚¹èƒ½å·åˆ°çš„æœ€å¤§é’±çš„çŠ¶æ€å¯ä»¥å®šä¹‰ä¸º å½“å‰èŠ‚ç‚¹é€‰æ‹©ä¸å·ï¼šå½“å‰èŠ‚ç‚¹èƒ½å·åˆ°çš„æœ€å¤§é’±æ•° = å·¦å­©å­èƒ½å·åˆ°çš„é’± + å³å­©å­èƒ½å·åˆ°çš„é’± å½“å‰èŠ‚ç‚¹é€‰æ‹©å·ï¼šå½“å‰èŠ‚ç‚¹èƒ½å·åˆ°çš„æœ€å¤§é’±æ•° = å·¦å­©å­é€‰æ‹©è‡ªå·±ä¸å·æ—¶èƒ½å¾—åˆ°çš„é’± + å³å­©å­é€‰æ‹©ä¸å·æ—¶èƒ½å¾—åˆ°çš„é’± + å½“å‰èŠ‚ç‚¹çš„é’±æ•° class Solution: def rob(self, root: TreeNode) -&gt; int: def _rob(root): if not root: return 0, 0 # å·ï¼Œä¸å· left = _rob(root.left) right = _rob(root.right) # å·å½“å‰èŠ‚ç‚¹, åˆ™å·¦å³å­æ ‘éƒ½ä¸èƒ½å· v1 = root.val + left[1] + right[1] # ä¸å·å½“å‰èŠ‚ç‚¹, åˆ™å–å·¦å³å­æ ‘ä¸­æœ€å¤§çš„å€¼ v2 = max(left) + max(right) return v1, v2 return max(_rob(root)) 621 ä»»åŠ¡è°ƒåº¦å™¨ï¼Œ leastInterval class Solution: def leastInterval(self, tasks: List[str], n: int) -&gt; int: tnum=[] for i in set(tasks):tnum.append(tasks.count(i)) maxt=max(tnum) return max((n+1)*(maxt-1)+tnum.count(maxt),len(tasks)) æœ€å¤§æ•° class LargerNumKey(str): def __lt__(x, y): return x+y &gt; y+x class Solution: def largestNumber(self, nums): largest_num = &#x27;&#x27;.join(sorted(map(str, nums), key=LargerNumKey)) return &#x27;0&#x27; if largest_num[0] == &#x27;0&#x27; else largest_num Review shop No. Question Flag (1). binary-search &nbsp; 179. æœ€å¤§æ•°, sorted(iter, key=your_sort_class, __lt__) â &nbsp; 1.1 äºŒåˆ†æŸ¥æ‰¾, while l &lt;= r â âœ”ï¸ 1.2 åœ¨æ’åºæ•°ç»„ä¸­æŸ¥æ‰¾å…ƒç´ çš„ç¬¬ä¸€ä¸ªå’Œæœ€åä¸€ä¸ªä½ç½®, def binSearch(nums, t, flag), mid=r-1 or l+1, return r+1 or l-1 â addition 162. å¯»æ‰¾å³°å€¼ nums[-1] = nums[n] = -âˆ , l=mid+1, r=mid â &nbsp; 278. First Bad Version , if isBadVersion(mid): right = mid - 1 â hard 410. Split Array Largest Sum Input: nums = [7,2,5,10,8], m = 2. Output: 18 ã€Œä½¿â€¦â€¦æœ€å¤§å€¼å°½å¯èƒ½å°ã€æ˜¯äºŒåˆ†æœç´¢é¢˜ç›®å¸¸è§çš„é—®æ³• â é€†å‘åŒæŒ‡é’ˆ 88. Merge Sorted Array nums1 = [1,2,3,0,0,0], nums2 = [2,5,6] â åŒæŒ‡é’ˆ 15. 3Sumï¼Œ for for while , second_ix &amp; third_ix ä¸¤è¾¹å¤¹ åŒæŒ‡é’ˆ 11. ç››æœ€å¤šæ°´çš„å®¹å™¨ , ç§»åŠ¨ l å’Œ r è¾ƒå°çš„ä¸€æ–¹æ‰å¯èƒ½å¢åŠ  area â hard, merge+index 315. Count of Smaller Numbers After Self hard (2). DFS / Stack &nbsp; 2.1 å­—ç¬¦ä¸²è§£ç  â€œ3[a2[c]]â€ == â€œaccaccâ€, stack == [(3, &quot;&quot;), (2,&quot;a&quot;)] âœ”ï¸â &nbsp; 215. æ•°ç»„ä¸­çš„ç¬¬Kä¸ªæœ€å¤§å…ƒç´  from heapq import heapify, heappush, heappop &nbsp; pythonä¸­çš„heapæ˜¯å°æ ¹å †: heapify(hp) , heappop(hp), heappush(hp, v) (3). Digit, æ¨¡æ‹Ÿ &nbsp; 3.1 å›æ–‡æ•° [ç¦æ­¢æ•´æ•°è½¬å­—ç¬¦ä¸²]ï¼Œ &nbsp;&nbsp;&nbsp;&nbsp;æ¨¡æ‹Ÿ 123321 -&gt; 2332 -&gt; 33 â &nbsp; 470. ç”¨ Rand7() å®ç° Rand10() , é¢˜è§£: ç­‰æ¦‚ç‡å¤šæ¬¡è°ƒç”¨ &nbsp; 205. åŒæ„å­—ç¬¦ä¸², all(s.index(s[i]) == t.index(t[i]) for i in range(len(s))) â (4). DP good 4.1 æ …æ æ¶‚è‰² &nbsp;&nbsp; dp[i] = dp[i-2]*(k-1) + dp[i-1]*(k-1) âœ”ï¸â &nbsp; 4.2 åŒºåŸŸå’Œæ£€ç´¢ == è¿ç»­å­æ•°ç»„æœ€å¤§å’Œ â goodfloat(&#39;inf&#39;)good 4.3 Coin Change [é›¶é’±å…‘æ¢] &nbsp;&nbsp;dp[0] = 0, dp[x] = min(dp[x], dp[x - coin] + 1) $F(i)= min_{j=0â€¦nâˆ’1} F(iâˆ’c_j)+1$ dp = [float(&#39;inf&#39;)] * (amount + 1) è¾“å…¥ï¼šcoins = [1, 2, 5], amount = 11è¾“å‡ºï¼š3 è§£é‡Šï¼š11 = 5 + 5 + 1 Tips: float(â€˜infâ€™) + 1 = inf âœ”ï¸â &nbsp; 279. å®Œå…¨å¹³æ–¹æ•°, numSquares(n)=min(numSquares(n-k) + 1)âˆ€kâˆˆsquare ä¸ Coin Change éå¸¸ç±»ä¼¼ï¼Œä½†ä¸å®Œå…¨ âœ”ï¸â &nbsp; 4.4 é™¤è‡ªèº«ä»¥å¤–æ•°ç»„çš„ä¹˜ç§¯ , [0]*len, range(len(nums)-2, -1, -1) â hard 44. Wildcard Matching Input: s = â€œaaâ€, p = â€œ*â€ Output: true , Input: s = â€œcbâ€, p = â€œ?aâ€ Output: false (5). hash &nbsp; 5.1 ä¸¤æ•°ä¹‹å’Œ, enumerate hash[num] = i â (6). linkedList - 6.1 ç›¸äº¤é“¾è¡¨ romantic â - 6.2 ç¯å½¢é“¾è¡¨ hash â - 6.3 ä¸¤æ•°ç›¸åŠ  I LinkNode æ¨¡æ‹Ÿ head = ListNode(0), cur = head, carry = 0 â - 445. Add Two Numbers II, é“¾è¡¨æ±‚å’Œ, stack+post_p while s1 or s2 or carry != 0: â - 6.4 å¤åˆ¶å¸¦éšæœºæŒ‡é’ˆçš„é“¾è¡¨ &nbsp;&nbsp; 1. while, 2. while (random pointers) 3. while (ptr_old_listï¼‰ â âœ”ï¸âœ”ï¸âœ”ï¸âœ”ï¸ 6.5 LRUCache class DLinkedNode(4), removeTail, moveToHead, addToHead, removeNode âœ”ï¸â - 6.6 åˆ é™¤é“¾è¡¨çš„å€’æ•°ç¬¬Nä¸ªèŠ‚ç‚¹ â åŒªå¤·æ‰€æ€ 6.7 æ’åºé“¾è¡¨, slow, fast = head, head.next, mid, slow.next=slow.next, None âœ”ï¸â - é¢è¯•é¢˜ 02.05. é“¾è¡¨æ±‚å’Œ I â hard 25. Reverse Nodes in k-Group hard 23. Merge k Sorted Lists (7). stack - 7.1 æœ‰æ•ˆçš„æ‹¬å· if i == &#39;)&#39; and len(stack)&gt; 0 and stack[-1] == &#39;(&#39;: stack.pop() â - 402. ç§»æ‰Kä½æ•°å­— â (8). string reversed 8.1 å­—ç¬¦ä¸²ç›¸åŠ  ç»™å®šä¸¤ä¸ªå­—ç¬¦ä¸²å½¢å¼çš„éè´Ÿæ•´æ•° num1 å’Œnum2 ï¼Œè®¡ç®—å®ƒä»¬çš„å’Œ num1 = &quot;&quot;.join(list(reversed(num1))), num1 = num1 + (&quot;0&quot; * diff1) num2 = num2 + (&quot;0&quot; * diff2) âœ”ï¸ï¸â - 8.2 æ¯”è¾ƒç‰ˆæœ¬å· , split then compare .. â - 8.3 å­—ç¬¦ä¸²è§£ç  â - 8.4 æ— é‡å¤å­—ç¬¦çš„æœ€é•¿å­ä¸² sliding window, [l, r], occ=set(), occ.remove(elem) âœ”ï¸âï¸ - 8.5 ä¸‹ä¸€ä¸ªæ›´å¤§å…ƒç´  III ï¼Œ æ¨¡æ‹Ÿå¤æ‚ è§é¢˜è§£ 1,5,8,4,7,6,5,3,1 =&gt; decreasing elem found 1,5,8,4(i-1),7,6,5(j),3,1 (found j, just larger a[i-1]) =&gt; 1,5,8,5,7,6,4,3,1 =&gt; 1,5,8,5,1,3,4,6,7 (reverse these elements) âœ”ï¸ï¸â - 8.6 å…¨æ’åˆ— def backtrack(first=0): for i in range(first, n): swap(nums[first], nums[i]) â (9). tree - 9.1 ä»å‰åºä¸ä¸­åºéå†åºåˆ—æ„é€ äºŒå‰æ ‘ i = inorder.index(preorder[0]) â - 9.2 äºŒå‰æ ‘çš„ä¸­åºéå† (éé€’å½’) while while â - 9.3 äºŒå‰æ ‘çš„å³è§†å›¾ â hard 124. Binary Tree Maximum Path Sum sales-person é”€å”®å‘˜ SELECT s.nameFROM salesperson sWHERE s.sales_id NOT IN (SELECT o.sales_id FROM orders o LEFT JOIN company c ON o.com_id = c.com_id WHERE c.name = &#x27;RED&#x27;) 3sumclass Solution: def threeSum(self, nums: List[int]) -&gt; List[List[int]]: n = len(nums) nums.sort() ans = list() # æšä¸¾ a for first in range(n): # éœ€è¦å’Œä¸Šä¸€æ¬¡æšä¸¾çš„æ•°ä¸ç›¸åŒ if first &gt; 0 and nums[first] == nums[first - 1]: continue # c å¯¹åº”çš„æŒ‡é’ˆåˆå§‹æŒ‡å‘æ•°ç»„çš„æœ€å³ç«¯ third = n - 1 target = -nums[first] # æšä¸¾ b for second in range(first + 1, n): # éœ€è¦å’Œä¸Šä¸€æ¬¡æšä¸¾çš„æ•°ä¸ç›¸åŒ if second &gt; first + 1 and nums[second] == nums[second - 1]: continue # éœ€è¦ä¿è¯ b çš„æŒ‡é’ˆåœ¨ c çš„æŒ‡é’ˆçš„å·¦ä¾§ while second &lt; third and nums[second] + nums[third] &gt; target: third -= 1 # å¦‚æœæŒ‡é’ˆé‡åˆï¼Œéšç€ b åç»­çš„å¢åŠ  # å°±ä¸ä¼šæœ‰æ»¡è¶³ a+b+c=0 å¹¶ä¸” b&lt;c çš„ c äº†ï¼Œå¯ä»¥é€€å‡ºå¾ªç¯ if second == third: break if nums[second] + nums[third] == target: ans.append([nums[first], nums[second], nums[third]]) return ans 402. ç§»æ‰Kä½æ•°å­—class Solution: def removeKdigits(self, num: str, k: int) -&gt; str: numStack = [] # æ„å»ºå•è°ƒé€’å¢çš„æ•°å­—ä¸² for digit in num: while k and numStack and numStack[-1] &gt; digit: numStack.pop() k -= 1 numStack.append(digit) # å¦‚æœ K &gt; 0ï¼Œåˆ é™¤æœ«å°¾çš„ K ä¸ªå­—ç¬¦ finalStack = numStack[:-k] if k else numStack # æŠ¹å»å‰å¯¼é›¶ return &quot;&quot;.join(finalStack).lstrip(&#x27;0&#x27;) or &quot;0&quot; 241. ä¸ºè¿ç®—è¡¨è¾¾å¼è®¾è®¡ä¼˜å…ˆçº§è§£é¢˜æ€è·¯ å¯¹äºä¸€ä¸ªå½¢å¦‚ x op yï¼ˆop ä¸ºè¿ç®—ç¬¦ï¼Œx å’Œ y ä¸ºæ•°ï¼‰ çš„ç®—å¼è€Œè¨€ï¼Œå®ƒçš„ç»“æœç»„åˆå–å†³äº x å’Œ y çš„ç»“æœç»„åˆæ•°ï¼Œè€Œ x å’Œ y åˆå¯ä»¥å†™æˆå½¢å¦‚ x op y çš„ç®—å¼ã€‚ å› æ­¤ï¼Œè¯¥é—®é¢˜çš„å­é—®é¢˜å°±æ˜¯ x op y ä¸­çš„ x å’Œ yï¼šä»¥è¿ç®—ç¬¦åˆ†éš”çš„å·¦å³ä¸¤ä¾§ç®—å¼è§£ã€‚ ç„¶åæˆ‘ä»¬æ¥è¿›è¡Œ åˆ†æ²»ç®—æ³•ä¸‰æ­¥èµ°ï¼š åˆ†è§£ï¼šæŒ‰è¿ç®—ç¬¦åˆ†æˆå·¦å³ä¸¤éƒ¨åˆ†ï¼Œåˆ†åˆ«æ±‚è§£ è§£å†³ï¼šå®ç°ä¸€ä¸ªé€’å½’å‡½æ•°ï¼Œè¾“å…¥ç®—å¼ï¼Œè¿”å›ç®—å¼è§£ åˆå¹¶ï¼šæ ¹æ®è¿ç®—ç¬¦åˆå¹¶å·¦å³ä¸¤éƒ¨åˆ†çš„è§£ï¼Œå¾—å‡ºæœ€ç»ˆè§£ class Solution: def diffWaysToCompute(self, input: str) -&gt; List[int]: # å¦‚æœåªæœ‰æ•°å­—ï¼Œç›´æ¥è¿”å› if input.isdigit(): return [int(input)] res = [] for i, char in enumerate(input): if char in [&#x27;+&#x27;, &#x27;-&#x27;, &#x27;*&#x27;]: # 1.åˆ†è§£ï¼šé‡åˆ°è¿ç®—ç¬¦ï¼Œè®¡ç®—å·¦å³ä¸¤ä¾§çš„ç»“æœé›† # 2.è§£å†³ï¼šdiffWaysToCompute é€’å½’å‡½æ•°æ±‚å‡ºå­é—®é¢˜çš„è§£ left = self.diffWaysToCompute(input[:i]) right = self.diffWaysToCompute(input[i+1:]) # 3.åˆå¹¶ï¼šæ ¹æ®è¿ç®—ç¬¦åˆå¹¶å­é—®é¢˜çš„è§£ for l in left: for r in right: if char == &#x27;+&#x27;: res.append(l + r) elif char == &#x27;-&#x27;: res.append(l - r) else: res.append(l * r) return res 279. å®Œå…¨å¹³æ–¹æ•°Recursion class Solution(object): def numSquares(self, n): square_nums = [i**2 for i in range(1, int(math.sqrt(n))+1)] def minNumSquares(k): &quot;&quot;&quot; recursive solution &quot;&quot;&quot; # bottom cases: find a square number if k in square_nums: return 1 min_num = float(&#x27;inf&#x27;) # Find the minimal value among all possible solutions for square in square_nums: if k &lt; square: break new_num = minNumSquares(k-square) + 1 min_num = min(min_num, new_num) return min_num return minNumSquares(n) DP class Solution(object): def numSquares(self, n): &quot;&quot;&quot; :type n: int :rtype: int &quot;&quot;&quot; square_nums = [i**2 for i in range(0, int(math.sqrt(n))+1)] dp = [float(&#x27;inf&#x27;)] * (n+1) # bottom case dp[0] = 0 for i in range(1, n+1): for square in square_nums: if i &lt; square: break dp[i] = min(dp[i], dp[i-square] + 1) return dp[-1] 96. ä¸åŒçš„äºŒå‰æœç´¢æ ‘class Solution: def numTrees(self, n): G = [0]*(n+1) G[0], G[1] = 1, 1 for i in range(2, n+1): for j in range(1, i+1): G[i] += G[j-1] * G[i-j] return G[n] class Solution: def decodeString(self, s: str) -&gt; str: stack, res, multi = [], &quot;&quot;, 0 for c in s: if c == &#x27;[&#x27;: stack.append([multi, res]) res, multi = &quot;&quot;, 0 elif c == &#x27;]&#x27;: cur_multi, last_res = stack.pop() res = last_res + cur_multi * res elif &#x27;0&#x27; &lt;= c &lt;= &#x27;9&#x27;: multi = multi * 10 + int(c) else: res += c return res LRUCache class DLinkedNode: def __init__(self, key=0, value=0): self.key = key self.value = value self.prev = None self.next = None class LRUCache: def __init__(self, capacity: int): self.head = DLinkedNode() self.tail = DLinkedNode() self.head.next = self.tail self.tail.prev = self.head self.capacity = capacity self.size = 0 self.cache = &#123;&#125; def get(self, key: int) -&gt; int: if key not in self.cache: return -1 # å¦‚æœ key å­˜åœ¨ï¼Œå…ˆé€šè¿‡å“ˆå¸Œè¡¨å®šä½ï¼Œå†ç§»åˆ°å¤´éƒ¨ node = self.cache[key] self.moveToHead(node) return node.value def put(self, key: int, value: int) -&gt; None: if key not in self.cache: # å¦‚æœ key ä¸å­˜åœ¨ï¼Œåˆ›å»ºä¸€ä¸ªæ–°çš„èŠ‚ç‚¹ node = DLinkedNode(key, value) # æ·»åŠ è¿›å“ˆå¸Œè¡¨ self.cache[key] = node # æ·»åŠ è‡³åŒå‘é“¾è¡¨çš„å¤´éƒ¨ self.addToHead(node) self.size += 1 if self.size &gt; self.capacity: # å¦‚æœè¶…å‡ºå®¹é‡ï¼Œåˆ é™¤åŒå‘é“¾è¡¨çš„å°¾éƒ¨èŠ‚ç‚¹ removed = self.removeTail() # åˆ é™¤å“ˆå¸Œè¡¨ä¸­å¯¹åº”çš„é¡¹ self.cache.pop(removed.key) self.size -= 1 else: # å¦‚æœ key å­˜åœ¨ï¼Œå…ˆé€šè¿‡å“ˆå¸Œè¡¨å®šä½ï¼Œå†ä¿®æ”¹ valueï¼Œå¹¶ç§»åˆ°å¤´éƒ¨ node = self.cache[key] node.value = value self.moveToHead(node) def addToHead(self, node): node.prev = self.head node.next = self.head.next self.head.next.prev = node self.head.next = node def removeNode(self, node): node.prev.next = node.next node.next.prev = node.prev def moveToHead(self, node): self.removeNode(node) self.addToHead(node) def removeTail(self): node = self.tail.prev self.removeNode(node) return node# Your LRUCache object will be instantiated and called as such:# obj = LRUCache(capacity)# param_1 = obj.get(key)# obj.put(key,value) very good sortList: # -*- coding: utf-8 -*-# Definition for singly-linked list.class ListNode: def __init__(self, val=0, next=None): self.val = val self.next = next# åœ¨ O(n log n) æ—¶é—´å¤æ‚åº¦å’Œå¸¸æ•°çº§ç©ºé—´å¤æ‚åº¦ä¸‹ï¼Œå¯¹é“¾è¡¨è¿›è¡Œæ’åºã€‚## ç¤ºä¾‹ 1:## è¾“å…¥: 4-&gt;2-&gt;1-&gt;3# è¾“å‡º: 1-&gt;2-&gt;3-&gt;4class Solution: def sortList(self, head: ListNode) -&gt; ListNode: if not head or not head.next: return head # termination. # cut the LinkedList at the mid index. slow, fast = head, head.next while fast and fast.next: fast, slow = fast.next.next, slow.next mid, slow.next = slow.next, None # save and cut. # recursive for cutting. left, right = self.sortList(head), self.sortList(mid) # merge `left` and `right` linked list and return it. h = res = ListNode(0) while left and right: if left.val &lt; right.val: h.next, left = left, left.next else: h.next, right = right, right.next h = h.next h.next = left if left else right return res.next äºŒå‰æ ‘çš„ä¸­åºéå† class Solution: def __init__(self): self.res = [] def inorderTraversal(self, root: TreeNode) -&gt; List[int]: if not root: return [] stack = list() while stack or root: while root: stack.append(root) root = root.left root = stack.pop() self.res.append(root.val) root = root.right return self.res å‰‘æŒ‡,Table No. Question Flag easy (1). Tree &nbsp; 1.1 å¹³è¡¡äºŒå‰æ ‘ abs(maxHigh(root.left) - maxHigh(root.right)) &lt;= 1 and self.isBalanced(root.left) and self.isBalanced(root.right) â &nbsp; 1.2 å¯¹ç§°çš„äºŒå‰æ ‘ â &nbsp; 1.3 äºŒå‰æ ‘çš„é•œåƒï¼š root.left = self.mirrorTree(root.right) swapå+é€’å½’ â &nbsp; 1.4 äºŒå‰æœç´¢æ ‘çš„ç¬¬kå¤§èŠ‚ç‚¹ &nbsp;&nbsp; [ä¸­åºéå† å€’åº, å³-ä¸­-å·¦] âœ”ï¸â good 1.5 (ä¸¤ä¸ªèŠ‚ç‚¹)äºŒå‰æ ‘çš„æœ€è¿‘å…¬å…±ç¥–å…ˆ &nbsp;&nbsp; [Recursion] ååºéå†+è·¯å¾„å›æº¯ âœ”ï¸â good 1.6 (ä¸¤ä¸ªèŠ‚ç‚¹)äºŒå‰æœç´¢æ ‘çš„æœ€è¿‘å…¬å…±ç¥–å…ˆ &nbsp;&nbsp; Recursion + å‰ªæ âœ”ï¸â good 1.7 äºŒå‰æ ‘ä¸­å’Œä¸ºæŸä¸€å€¼çš„è·¯å¾„ é€’å½’å›æº¯ âœ”âï¸ &nbsp; 1.8 äºŒå‰æœç´¢æ ‘çš„ååºéå†åºåˆ— â &nbsp; 1.9 äºŒå‰æœç´¢æ ‘ä¸åŒå‘é“¾è¡¨ additional æ±‚äºŒå‰æ ‘ç¬¬Kå±‚çš„èŠ‚ç‚¹ä¸ªæ•° [Recursion] ï¼Œroot != None and k==1ï¼Œè¿”å›1 f(root.left, k-1) + f(root.right, k-1) â additional æ±‚äºŒå‰æ ‘ç¬¬Kå±‚çš„å¶å­èŠ‚ç‚¹ä¸ªæ•° [Recursion] if(k==1 and root.left and root.right is null) return 1; âœ”ï¸â (2). Stack &nbsp; 394. å­—ç¬¦ä¸²è§£ç  [a]2[bc] â &nbsp; 28. åŒ…å«minå‡½æ•°çš„æ ˆ â &nbsp; 29. æœ€å°çš„kä¸ªæ•°ã€å †æ’çš„é€†å‘ã€‘ heapq.heappop(hp),heapq.heappush(hp, -arr[i]) âœ”ï¸â &nbsp; 36. æ»‘åŠ¨çª—å£çš„æœ€å¤§å€¼ (åŒç†äºåŒ…å« min å‡½æ•°çš„æ ˆ) deque.popleft(),åŒç«¯é˜Ÿåˆ—+å•è°ƒ âœ”ï¸â &nbsp; 59 II. é˜Ÿåˆ—çš„æœ€å¤§å€¼ , ç»´æŠ¤ä¸ªå•è°ƒçš„deque &nbsp;&nbsp; import queue, queue.deque(), queue.Queue(), deq[0], deq[-1] âœ”ï¸â (3). linkedList &nbsp; 7. ä»å°¾åˆ°å¤´æ‰“å°é“¾è¡¨ï¼š reversePrint(head.next) + [head.val] â &nbsp; 8. åè½¬é“¾è¡¨ &nbsp;&nbsp; (å¾ªç¯ç‰ˆ åŒæŒ‡é’ˆ) â &nbsp; 10. åˆå¹¶ä¸¤ä¸ªæ’åºçš„é“¾è¡¨ &nbsp;&nbsp; [Recursion] p.next = self.mergeTwoLists(l1.next, l2) â addition æ—‹è½¬å•é“¾è¡¨ (F1. ç¯ F2. èµ°n-k%n æ–­å¼€) ä¸¾ä¾‹ï¼š ç»™å®š 1-&gt;2-&gt;3-&gt;4-&gt;5-&gt;6-&gt;NULL, K=3 åˆ™4-&gt;5-&gt;6-&gt;1-&gt;2-&gt;3-&gt;NULL â addition 92. ç¿»è½¬éƒ¨åˆ†å•é“¾è¡¨ reverse(head: ListNode, tail: ListNode) ä¸¾ä¾‹ï¼š1-&gt;2-&gt;3-&gt;4-&gt;5-&gt;null, from = 2, to = 4 ç»“æœï¼š1-&gt;4-&gt;3-&gt;2-&gt;5-&gt;null â addition é“¾è¡¨åˆ’åˆ†, æè¿°ï¼š ç»™å®šä¸€ä¸ªå•é“¾è¡¨å’Œæ•°å€¼xï¼Œåˆ’åˆ†é“¾è¡¨ä½¿å¾—å°äºxçš„èŠ‚ç‚¹æ’åœ¨å¤§äºç­‰äºxçš„èŠ‚ç‚¹ä¹‹å‰ â addition 82. åˆ é™¤æ’åºé“¾è¡¨ä¸­çš„é‡å¤å…ƒç´  II é“¾è¡¨1-&gt;2-&gt;3-&gt;3-&gt;4-&gt;4-&gt;5 å¤„ç†åä¸º 1-&gt;2-&gt;5. â addition è¾“å…¥ï¼š(7 -&gt; 1 -&gt; 6) + (5 -&gt; 9 -&gt; 2)ï¼Œå³617 + 295 è¾“å‡ºï¼š2 -&gt; 1 -&gt; 9ï¼Œå³912 (4). DP &nbsp; 31. nä¸ªéª°å­çš„ç‚¹æ•° dp[i][j] ï¼Œè¡¨ç¤ºæŠ•æ·å®Œ i æšéª°å­åï¼Œç‚¹æ•° j çš„å‡ºç°æ¬¡æ•° âœ”ï¸ &nbsp; Summary 20 dynamic programming (4.1) DPè¡¨ç¤ºçŠ¶æ€ easy 1. climbing-stairs ï¼Œ æ–°å»º{}or[] ,æ»šåŠ¨æ•°ç»„ 2. è¿ç»­å­æ•°ç»„çš„æœ€å¤§å’Œ â addition 63. ä¸åŒè·¯å¾„ II, store = [[0]*n for i in range(m)] äºŒç»´åˆå§‹åŒ– â addition Edit Distance/ç¼–è¾‘è·ç¦»ã€word1 è½¬æ¢æˆ word2ã€‘&nbsp;&nbsp; 1. dp = [ [0] * (m + 1) for _ in range(n + 1)] &nbsp;&nbsp; 2. dp[i][j] = min(A,B,C) âœ”ï¸â addition 5. Longest Palindromic Substring/æœ€é•¿å›æ–‡å­ä¸² 1. æšä¸¾å­ä¸²çš„é•¿åº¦ l+1,ä»å°é—®é¢˜åˆ°å¤§é—®é¢˜ 2. æšä¸¾å­ä¸²çš„èµ·å§‹ä½ç½® i, j=i+l å­ä¸²ç»“æŸä½ç½®, dp[i][j] = (dp[i+1][j-1] and s[i]==s[j]) âœ”ï¸â good æŠŠæ•°å­—ç¿»è¯‘æˆå­—ç¬¦ä¸² Fib âœ”ï¸â addition Leetcode 64. Minimum Path Sum, æœ€å°è·¯å¾„å’Œ grid[i][j] = min(grid[i - 1][j], grid[i][j - 1]) + grid[i][j] â addition 115. Distinct Subsequences I Hard addition 940. ä¸åŒçš„å­åºåˆ— II Hard addition Interleaving String/äº¤é”™å­—ç¬¦ä¸² Hard (5). DFS / BFS &nbsp; 66. çŸ©é˜µä¸­çš„è·¯å¾„ , ç»å…¸å¥½é¢˜: æ·±æœ+å›æº¯ def dfs(i, j, k): âœ”ï¸â &nbsp; 61. æœºå™¨äººçš„è¿åŠ¨èŒƒå›´ bfs good &nbsp;&nbsp; from queue import Queue, q.get() q.pup() âœ”ï¸â (6). sliding Window &nbsp; 65. æœ€é•¿ä¸å«é‡å¤å­—ç¬¦çš„å­å­—ç¬¦ä¸² æ»‘åŠ¨çª—å£ âœ”ï¸â &nbsp; 14. å’Œä¸ºsçš„è¿ç»­æ­£æ•°åºåˆ— &nbsp;&nbsp; [sliding window] inputï¼štarget = 9 outputï¼š[[2,3,4],[4,5]] âœ”ï¸â (7). æ¨¡æ‹Ÿ &nbsp; 21. åœ†åœˆä¸­æœ€åå‰©ä¸‹çš„æ•°å­— 1. å½“æ•°åˆ°æœ€åä¸€ä¸ªç»“ç‚¹ä¸è¶³mä¸ªæ—¶ï¼Œéœ€è¦è·³åˆ°ç¬¬ä¸€ä¸ªç»“ç‚¹ç»§ç»­æ•° 2. æ¯è½®éƒ½æ˜¯ä¸Šä¸€è½®è¢«åˆ ç»“ç‚¹çš„ä¸‹ä¸€ä¸ªç»“ç‚¹å¼€å§‹æ•° m ä¸ª 3. å¯»æ‰¾ f(n,m) ä¸ f(n-1,m) å…³ç³» 4. Aï¼š f(n,m)=(m+x)%n 5. Python æ·±åº¦ä¸å¤Ÿæ‰‹åŠ¨è®¾ç½® sys.setrecursionlimit(100000) ä¸œå¤§ Lucien é¢˜è§£,è®²å¾—æœ€æ¸…æ¥šçš„é‚£ä¸ªã€‚å®˜æ–¹è®²è§£æœ‰è¯¯ âœ”ï¸â &nbsp; 35. é¡ºæ—¶é’ˆæ‰“å°çŸ©é˜µ left, right, top, bottom = 0, columns - 1, 0, rows - 1 âœ”ï¸â &nbsp; 56. æŠŠæ•°ç»„æ’æˆæœ€å°çš„æ•°, sorted vs sort, strs.sort(key=cmp_to_key(sort_rule)) âœ”ï¸â &nbsp; 70. æŠŠå­—ç¬¦ä¸²è½¬æ¢æˆæ•´æ•° &nbsp;&nbsp;&nbsp;&nbsp; int_max, int_min, bndry = 231-1, -231, 2**31//10 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bndry=2147483647//10=214748364 ï¼Œåˆ™ä»¥ä¸‹ä¸¤ç§æƒ…å†µè¶Šç•Œ&nbsp;&nbsp;&nbsp;&nbsp; res &gt; bndry or res == bndry and c &gt;â€™7â€™ âœ”ï¸â medium 37 0ï½n-1ä¸­ç¼ºå¤±çš„æ•°å­— â 42 æ±‚1+2+â€¦+n â 43 æ•°ç»„ä¸­æ•°å­—å‡ºç°çš„æ¬¡æ•° so hard 44 å¤æ‚é“¾è¡¨çš„å¤åˆ¶ â 45 æ•°ç»„ä¸­æ•°å­—å‡ºç°çš„æ¬¡æ•° â 46 é‡å»ºäºŒå‰æ ‘ â 47 ç¤¼ç‰©çš„æœ€å¤§ä»·å€¼ f = [len(grid[0]) * [0]] * len(grid) â 48 ä»ä¸Šåˆ°ä¸‹æ‰“å°äºŒå‰æ ‘ III queue.append([root, 0]) â 49 ä¸‘æ•° n2, n3, n5 = dp[a] 2, dp[b] 3, dp[c] * 5 â 50 äºŒå‰æœç´¢æ ‘ä¸åŒå‘é“¾è¡¨ âœ”ï¸â 51 è‚¡ç¥¨çš„æœ€å¤§åˆ©æ¶¦ ï¼ˆä¹°å–ä¸€æ¬¡ï¼‰ cost, profit = float(&quot;+inf&quot;), 0 for price in prices:&nbsp;&nbsp;&nbsp;&nbsp;cost, profit = min(cost, price), max(profit, price - cost) 54 æ„å»ºä¹˜ç§¯æ•°ç»„ â 55 äºŒå‰æ ‘ä¸­å’Œä¸ºæŸä¸€å€¼çš„è·¯å¾„ âœ”ï¸â 57 å‰ªç»³å­ (1) n &lt; 4 (2) n == 4 (3) n &gt; 4, å¤šä¸ª == 3 æ®µ â 58 å­—ç¬¦ä¸²çš„æ’åˆ— c = list(s) res = [] def dfs(x): â 59 æŠŠæ•°å­—ç¿»è¯‘æˆå­—ç¬¦ä¸² f[i] = f[i-1] + f[i-2] åŒ æ‰“å®¶åŠ«èˆ â 60 äºŒå‰æœç´¢æ ‘çš„ååºéå†åºåˆ— def recur(i, j): â 68 æ•°å€¼çš„æ•´æ•°æ¬¡æ–¹ ï¼ˆ1ï¼‰å½“ n ä¸ºå¶æ•° ï¼ˆ2ï¼‰å½“ n ä¸ºå¥‡æ•° â 71 è¡¨ç¤ºæ•°å€¼çš„å­—ç¬¦ä¸²ï¼š ç¡®å®šæœ‰é™çŠ¶æ€è‡ªåŠ¨æœº é¢è¯•é¢˜20. è¡¨ç¤ºæ•°å€¼çš„å­—ç¬¦ä¸²ï¼ˆæœ‰é™çŠ¶æ€è‡ªåŠ¨æœºï¼Œæ¸…æ™°å›¾è§£ï¼‰ hard 72 æ•°æ®æµä¸­çš„ä¸­ä½æ•° 73 åºåˆ—åŒ–äºŒå‰æ ‘ 64 1ï½næ•´æ•°ä¸­1å‡ºç°çš„æ¬¡æ•° 74 æ•°ç»„ä¸­çš„é€†åºå¯¹ 75 æ­£åˆ™è¡¨è¾¾å¼åŒ¹é… No. Pass Question Flag pass_easy 1 å·¦æ—‹è½¬å­—ç¬¦ä¸² â 2 é“¾è¡¨ä¸­å€’æ•°ç¬¬kä¸ªèŠ‚ç‚¹ â 3 äºŒå‰æ ‘çš„æ·±åº¦ â 5 æ‰“å°ä»1åˆ°æœ€å¤§çš„nä½æ•°ï¼š sum = 10 ** n â 6 æ›¿æ¢ç©ºæ ¼ â 11 äºŒè¿›åˆ¶ä¸­1çš„ä¸ªæ•° [n = n &amp; (n-1)] â 12 ç”¨ä¸¤ä¸ªæ ˆå®ç°é˜Ÿåˆ— â 16 ä»ä¸Šåˆ°ä¸‹æ‰“å°äºŒå‰æ ‘II &nbsp;&nbsp; queue.append([root, 0]) æˆ– for _ in range(queue_size) â 17 æ•°ç»„ä¸­å‡ºç°æ¬¡æ•°è¶…è¿‡ä¸€åŠçš„æ•°å­— â 18 æ•°ç»„ä¸­é‡å¤çš„æ•°å­— set() â 19 å’Œä¸ºsçš„ä¸¤ä¸ªæ•°å­— [sliding window] â 20 è°ƒæ•´æ•°ç»„é¡ºåºä½¿å¥‡æ•°ä½äºå¶æ•°å‰é¢ â 22 ä¸¤ä¸ªé“¾è¡¨çš„ç¬¬ä¸€ä¸ªå…¬å…±èŠ‚ç‚¹ â 23 ç¬¬ä¸€ä¸ªåªå‡ºç°ä¸€æ¬¡çš„å­—ç¬¦:&nbsp;&nbsp; Python 3.6 åï¼Œé»˜è®¤å­—å…¸å°±æ˜¯æœ‰åºçš„ï¼Œæ— éœ€ç”¨ OrderedDict() â 24 è¿ç»­å­æ•°ç»„çš„æœ€å¤§å’Œ dp[i] = dp[i-1] + nums[i] â 25 åˆ é™¤é“¾è¡¨çš„èŠ‚ç‚¹ pre, p â 30 ä¸ç”¨åŠ å‡ä¹˜é™¤åšåŠ æ³• add(a ^ b, (a &amp; b) &lt;&lt; 1) â 32 åœ¨æ’åºæ•°ç»„ä¸­æŸ¥æ‰¾æ•°å­—I â 33 æ—‹è½¬æ•°ç»„çš„æœ€å°æ•°å­— numbers[high] â 34 æ‰‘å…‹ç‰Œä¸­çš„é¡ºå­ ma - mi &lt; 5 â 38 ç¿»è½¬å•è¯é¡ºåº â 39 é’è›™è·³å°é˜¶é—®é¢˜ â 40 äºŒç»´æ•°ç»„ä¸­çš„æŸ¥æ‰¾ â 41 æ–æ³¢é‚£å¥‘æ•°åˆ— â pass_medium 52 æ ˆçš„å‹å…¥ã€å¼¹å‡ºåºåˆ— (+stack è¾…åŠ©) â 53 å‰‘æŒ‡ Offer 32 - III. ä»ä¸Šåˆ°ä¸‹æ‰“å°äºŒå‰æ ‘ III â 63 æ ‘çš„å­ç»“æ„ â 67 æ•°å­—åºåˆ—ä¸­æŸä¸€ä½çš„æ•°å­— æ‰¾è§„å¾‹, pass NG 69 å‰ªç»³å­II Not Good, so pass. 1. Tree No. Question Flag 1.1 å¹³è¡¡äºŒå‰æ ‘ 1.2 å¯¹ç§°çš„äºŒå‰æ ‘ 1.3 äºŒå‰æ ‘çš„é•œåƒ 1.4 äºŒå‰æ ‘çš„æœ€è¿‘å…¬å…±ç¥–å…ˆ 1.6 ä»ä¸Šåˆ°ä¸‹æ‰“å°äºŒå‰æ ‘ II / III 1.7 äºŒå‰æ ‘ä¸­å’Œä¸ºæŸä¸€å€¼çš„è·¯å¾„ 1.8 äºŒå‰æœç´¢æ ‘çš„ååºéå†åºåˆ— 1.9 äºŒå‰æœç´¢æ ‘ä¸åŒå‘é“¾è¡¨ class Solution: def treeToDoublyList(self, root: &#x27;Node&#x27;) -&gt; &#x27;Node&#x27;: def dfs(cur): if not cur: return dfs(cur.left) # é€’å½’å·¦å­æ ‘ if self.pre: # ä¿®æ”¹èŠ‚ç‚¹å¼•ç”¨ self.pre.right, cur.left = cur, self.pre else: # è®°å½•å¤´èŠ‚ç‚¹ self.head = cur self.pre = cur # ä¿å­˜ cur dfs(cur.right) # é€’å½’å³å­æ ‘ if not root: return self.pre = None dfs(root) self.head.left, self.pre.right = self.pre, self.head return self.head é¢˜è§£é“¾æ¥ 1.0 æ„é€ äºŒå‰æ ‘ class Node: def __init__(self, x): self.val = x self.left = None self.right = Nonedef creatTree(vals): nodes = [] for i in range(len(vals)): cur_val = vals[i] if cur_val is not None: cur_node = Node(cur_val) else: cur_node = None nodes.append(cur_node) if i &gt; 0: # 0, 1-1/2, 2-1/2 par_id = (i - 1) // 2 if (i - 1) % 2 == 0: nodes[par_id].left = cur_node else: nodes[par_id].right = cur_node return nodes[0]def pre_out(root): if not root: return None print(root.val) pre_out(root.left) pre_out(root.right)if __name__ == &#x27;__main__&#x27;: vals = [3,5,1,6,2,0,8,None,None,7,4] root = creatTree(vals) pre_out(root) 1.1 å¹³è¡¡äºŒå‰æ ‘ class Solution: def isBalanced(self, root: TreeNode) -&gt; bool: def maxHigh(root): if root == None: return 0 return max(maxHigh(root.left), maxHigh(root.right)) + 1 if root == None: return True return abs(maxHigh(root.left) - maxHigh(root.right)) &lt;= 1 and self.isBalanced(root.left) and self.isBalanced(root.right) 1.2 å¯¹ç§°çš„äºŒå‰æ ‘ def isSymmetricHelper(left: TreeNode, right: TreeNode): if left == None and right == None: return True if left == None or right == None: return False if left.val != right.val: return False return isSymmetricHelper(left.left, right.right) and isSymmetricHelper(left.right, right.left)class Solution: def isSymmetric(self, root: TreeNode) -&gt; bool: return root == None or isSymmetricHelper(root.left, root.right) 1.3 äºŒå‰æ ‘çš„é•œåƒ class Solution: def mirrorTree(self, root: TreeNode) -&gt; TreeNode: if root == None: return root node = root.left root.left = self.mirrorTree(root.right) root.right = self.mirrorTree(node) return root 1.4 äºŒå‰æ ‘çš„æœ€è¿‘å…¬å…±ç¥–å…ˆ # 1. ä»æ ¹èŠ‚ç‚¹å¼€å§‹éå†æ ‘# 2. å¦‚æœèŠ‚ç‚¹ p å’ŒèŠ‚ç‚¹ q éƒ½åœ¨å³å­æ ‘ä¸Šï¼Œé‚£ä¹ˆä»¥å³å­©å­ä¸ºæ ¹èŠ‚ç‚¹ç»§ç»­ 1 çš„æ“ä½œ# 3. å¦‚æœèŠ‚ç‚¹ p å’ŒèŠ‚ç‚¹ q éƒ½åœ¨å·¦å­æ ‘ä¸Šï¼Œé‚£ä¹ˆä»¥å·¦å­©å­ä¸ºæ ¹èŠ‚ç‚¹ç»§ç»­ 1 çš„æ“ä½œ# 4. å¦‚æœæ¡ä»¶ 2 å’Œæ¡ä»¶ 3 éƒ½ä¸æˆç«‹ï¼Œè¿™å°±æ„å‘³ç€æˆ‘ä»¬å·²ç»æ‰¾åˆ°èŠ‚ p å’ŒèŠ‚ç‚¹ q çš„ LCA äº†class Solution: def lowestCommonAncestor(self, root: TreeNode, p: TreeNode, q: TreeNode) -&gt; TreeNode: # å½“è¶Šè¿‡å¶èŠ‚ç‚¹ï¼Œåˆ™ç›´æ¥è¿”å› null # å½“ rootroot ç­‰äº p, qï¼Œ åˆ™ç›´æ¥è¿”å› root if root == None or root == p or root == q: return root left = self.lowestCommonAncestor(root.left, p, q) right = self.lowestCommonAncestor(root.right, p, q) if not left and not right: return None if not left: return right if not right: return left return root äºŒå‰æœç´¢æ ‘çš„æœ€è¿‘å…¬å…±ç¥–å…ˆ class TreeNode: def __init__(self, x): self.val = x self.left = None self.right = None# ç®—æ³•:# 1. ä»æ ¹èŠ‚ç‚¹å¼€å§‹éå†æ ‘# 2. å¦‚æœèŠ‚ç‚¹ p å’ŒèŠ‚ç‚¹ q éƒ½åœ¨å³å­æ ‘ä¸Šï¼Œé‚£ä¹ˆä»¥å³å­©å­ä¸ºæ ¹èŠ‚ç‚¹ç»§ç»­ 1 çš„æ“ä½œ# 3. å¦‚æœèŠ‚ç‚¹ p å’ŒèŠ‚ç‚¹ q éƒ½åœ¨å·¦å­æ ‘ä¸Šï¼Œé‚£ä¹ˆä»¥å·¦å­©å­ä¸ºæ ¹èŠ‚ç‚¹ç»§ç»­ 1 çš„æ“ä½œ# 4. å¦‚æœæ¡ä»¶ 2 å’Œæ¡ä»¶ 3 éƒ½ä¸æˆç«‹ï¼Œè¿™å°±æ„å‘³ç€æˆ‘ä»¬å·²ç»æ‰¾åˆ°èŠ‚ p å’ŒèŠ‚ç‚¹ q çš„ LCA äº†class Solution: def lowestCommonAncestor(self, root: TreeNode, p: TreeNode, q: TreeNode) -&gt; TreeNode: # Value of current node or parent node. parent_val = root.val # Value of p p_val = p.val # Value of q q_val = q.val # If both p and q are greater than parent if p_val &gt; parent_val and q_val &gt; parent_val: return self.lowestCommonAncestor(root.right, p, q) # If both p and q are lesser than parent elif p_val &lt; parent_val and q_val &lt; parent_val: return self.lowestCommonAncestor(root.left, p, q) # We have found the split point, i.e. the LCA node. else: return root 1.6 ä»ä¸Šåˆ°ä¸‹æ‰“å°äºŒå‰æ ‘ II / III ä»ä¸Šåˆ°ä¸‹æ‰“å°äºŒå‰æ ‘ II from collections import dequeclass Solution: def levelOrder(self, root: TreeNode) -&gt; List[int]: if not root: return [] queue = collections.deque() queue.append(root) res = [] while queue: size = len(queue) for _ in range(size): cur = queue.popleft() if not cur: continue res.append(cur.val) queue.append(cur.left) queue.append(cur.right) return res ä»ä¸Šåˆ°ä¸‹æ‰“å°äºŒå‰æ ‘ III class Solution: def levelOrder(self, root: TreeNode) -&gt; List[List[int]]: if not root: return [] queue = deque() queue.append([root, 0]) res = [] tmp_dict = dict() while queue: cur, level = queue.popleft() if tmp_dict.get(level) is not None: tmp_dict[level].append(cur.val) else: tmp_dict[level] = [cur.val] if cur.left: queue.append([cur.left, level + 1]) if cur.right: queue.append([cur.right, level + 1]) for ix in range(len(tmp_dict)): if ix % 2 == 1: res.append(tmp_dict[ix][::-1]) else: res.append(tmp_dict[ix]) return res 1.7 äºŒå‰æ ‘ä¸­å’Œä¸ºæŸä¸€å€¼çš„è·¯å¾„ def pathSum(self, root: TreeNode, sum: int) -&gt; List[List[int]]: if not root: return [] self.path.append(root.val) sum = sum - root.val if sum == 0 and root.left is None and root.right is None: self.res.append(list(self.path)) if root.left: self.pathSum(root.left, sum) if root.right: self.pathSum(root.right, sum) self.path.pop() return self.res 1.8 äºŒå‰æœç´¢æ ‘çš„ååºéå†åºåˆ— class Solution: def verifyPostorder(self, postorder: [int]) -&gt; bool: def recur(i, j): if i &gt;= j: return True p = i while postorder[p] &lt; postorder[j]: p += 1 m = p while postorder[p] &gt; postorder[j]: p += 1 return p == j and recur(i, m - 1) and recur(m, j - 1) return recur(0, len(postorder) - 1) 1.9 äºŒå‰æœç´¢æ ‘ä¸åŒå‘é“¾è¡¨ class Solution: def treeToDoublyList(self, root: &#x27;Node&#x27;) -&gt; &#x27;Node&#x27;: def dfs(cur): if not cur: return dfs(cur.left) # é€’å½’å·¦å­æ ‘ if self.pre: # ä¿®æ”¹èŠ‚ç‚¹å¼•ç”¨ self.pre.right = cur cur.left = self.pre else: # è®°å½•å¤´èŠ‚ç‚¹ self.head = cur self.pre = cur # ä¿å­˜ cur dfs(cur.right) # é€’å½’å³å­æ ‘ if not root: return self.pre = None dfs(root) self.head.left = self.pre self.pre.right = self.head return self.head 2. LinkedList2.1 å¤æ‚é“¾è¡¨çš„å¤åˆ¶ &quot;&quot;&quot;# Definition for a Node.class Node: def __init__(self, x: int, next: &#x27;Node&#x27; = None, random: &#x27;Node&#x27; = None): self.val = int(x) self.next = next self.random = random&quot;&quot;&quot;class Solution: def copyRandomList(self, head: &#x27;Node&#x27;) -&gt; &#x27;Node&#x27;: 3. Stringå­—ç¬¦ä¸²å…¨æ’åˆ— permutation # è¾“å…¥ï¼šs = &quot;abc&quot;# è¾“å‡ºï¼š[&quot;abc&quot;,&quot;acb&quot;,&quot;bac&quot;,&quot;bca&quot;,&quot;cab&quot;,&quot;cba&quot;]from typing import Listclass Solution: def permutation(self, s: str) -&gt; List[str]: c = list(s) res = [] def dfs(x): if x == len(c) - 1: res.append(&#x27;&#x27;.join(c)) # æ·»åŠ æ’åˆ—æ–¹æ¡ˆ return dic = set() for i in range(x, len(c)): # if c[i] in dic: continue # é‡å¤ï¼Œå› æ­¤å‰ªæ # dic.add(c[i]) c[i], c[x] = c[x], c[i] # äº¤æ¢ï¼Œå°† c[i] å›ºå®šåœ¨ç¬¬ x ä½ dfs(x + 1) # å¼€å¯å›ºå®šç¬¬ x + 1 ä½å­—ç¬¦ c[i], c[x] = c[x], c[i] # æ¢å¤äº¤æ¢ dfs(0) return res 4. Array &amp; Sort4.1 æœ€å°çš„kä¸ªæ•° import heapqfrom typing import Listclass Solution: def getLeastNumbers(self, arr: List[int], k: int) -&gt; List[int]: if k == 0: return list() hp = [-x for x in arr[:k]] heapq.heapify(hp) for i in range(k, len(arr)): if -hp[0] &gt; arr[i]: heapq.heappop(hp) heapq.heappush(hp, -arr[i]) ans = [-x for x in hp] return ans 4.2 nä¸ªéª°å­çš„ç‚¹æ•° # æŠŠnä¸ªéª°å­æ‰”åœ¨åœ°ä¸Šï¼Œæ‰€æœ‰éª°å­æœä¸Šä¸€é¢çš„ç‚¹æ•°ä¹‹å’Œä¸ºsã€‚è¾“å…¥nï¼Œæ‰“å°å‡ºsçš„æ‰€æœ‰å¯èƒ½çš„å€¼å‡ºç°çš„æ¦‚ç‡ã€‚## ä½ éœ€è¦ç”¨ä¸€ä¸ªæµ®ç‚¹æ•°æ•°ç»„è¿”å›ç­”æ¡ˆï¼Œå…¶ä¸­ç¬¬ i ä¸ªå…ƒç´ ä»£è¡¨è¿™ n ä¸ªéª°å­æ‰€èƒ½æ·å‡ºçš„ç‚¹æ•°é›†åˆä¸­ç¬¬ i å°çš„é‚£ä¸ªçš„æ¦‚ç‡ã€‚## è¾“å…¥: 1# è¾“å‡º: [0.16667,0.16667,0.16667,0.16667,0.16667,0.16667]## è¾“å…¥: 2# è¾“å‡º: [0.02778,0.05556,0.08333,0.11111,0.13889,0.16667,0.13889,0.11111,0.08333,0.05556,0.02778]# é€šè¿‡é¢˜ç›®æˆ‘ä»¬çŸ¥é“ä¸€å…±æŠ•æ· n æšéª°å­ï¼Œé‚£æœ€åä¸€ä¸ªé˜¶æ®µå¾ˆæ˜¾ç„¶å°±æ˜¯ï¼šå½“æŠ•æ·å®Œ n æšéª°å­åï¼Œå„ä¸ªç‚¹æ•°å‡ºç°çš„æ¬¡æ•°ã€‚## æ³¨æ„ï¼Œè¿™é‡Œçš„ç‚¹æ•°æŒ‡çš„æ˜¯å‰ n æšéª°å­çš„ç‚¹æ•°å’Œï¼Œè€Œä¸æ˜¯ç¬¬ n æšéª°å­çš„ç‚¹æ•°ï¼Œä¸‹æ–‡åŒç†ã€‚## æ‰¾å‡ºäº†æœ€åä¸€ä¸ªé˜¶æ®µï¼Œé‚£çŠ¶æ€è¡¨ç¤ºå°±ç®€å•äº†ã€‚## é¦–å…ˆç”¨æ•°ç»„çš„ç¬¬ä¸€ç»´æ¥è¡¨ç¤ºé˜¶æ®µï¼Œä¹Ÿå°±æ˜¯æŠ•æ·å®Œäº†å‡ æšéª°å­ã€‚# ç„¶åç”¨ç¬¬äºŒç»´æ¥è¡¨ç¤ºæŠ•æ·å®Œè¿™äº›éª°å­åï¼Œå¯èƒ½å‡ºç°çš„ç‚¹æ•°ã€‚# æ•°ç»„çš„å€¼å°±è¡¨ç¤ºï¼Œè¯¥é˜¶æ®µå„ä¸ªç‚¹æ•°å‡ºç°çš„æ¬¡æ•°ã€‚# æ‰€ä»¥çŠ¶æ€è¡¨ç¤ºå°±æ˜¯è¿™æ ·çš„ï¼šdp[i][j] ï¼Œè¡¨ç¤ºæŠ•æ·å®Œ i æšéª°å­åï¼Œç‚¹æ•° j çš„å‡ºç°æ¬¡æ•°ã€‚# dp[i][j] += dp[i-1][j-cur]; from typing import Listclass Solution: def twoSum(self, n: int) -&gt; List[float]: dp = [[0] * (6 * n + 1) for _ in range(11 + 1)] # ç´¢å¼•0ä¸å–ï¼Œåé¢å–åˆ°æœ€å¤§ç´¢å¼•6*n for i in range(1, 7): # init dp[1][i] = 1 for i in range(2, n + 1): # ä»ç¬¬äºŒè½®æŠ›æ·å¼€å§‹ç®— for j in range(2, 6 * i + 1): # ç¬¬äºŒè½®æŠ›æ·æœ€å°å’Œä¸º2ï¼Œä»å¤§åˆ°å°æ›´æ–°å¯¹åº”çš„æŠ›æ·æ¬¡æ•° # dp[j] = 0 # æ¯æ¬¡æŠ•æ·è¦ä»0æ›´æ–°dp[j]å¤§å°ï¼Œç‚¹æ•°å’Œå‡ºç°çš„æ¬¡æ•°è¦é‡æ–°è®¡ç®— for cur in range(1, 7): # æ¯æ¬¡æŠ›æ·çš„ç‚¹æ•° if j - cur &lt;= 0: break if j - cur &gt; (i - 1) * 6: continue dp[i][j] += dp[i - 1][j - cur] # æ ¹æ®ä¸Šä¸€è½®æ¥æ›´æ–°å½“å‰è½®æ•°æ® print(f&#x27;&#123;i&#125;, &#123;j&#125;, ==== &#123;i-1&#125; &#123;j-cur&#125;&#x27;) sum_ = 6 ** n res = [] for i in range(n, 6 * n + 1): res.append(dp[n][i] * 1.0 / sum_) return res 4.3 é¡ºæ—¶é’ˆæ‰“å°çŸ©é˜µ# è¾“å…¥ï¼šmatrix = [# [1,2,3,4],# [5,6,7,8],# [9,10,11,12]# ]# è¾“å‡ºï¼š[# 1,2,3,4,# 8,12,11,10,# 9,5,6,7# ]from typing import Listclass Solution: def spiralOrder(self, matrix: List[List[int]]) -&gt; List[int]: if not matrix or not matrix[0]: return list() rows, columns = len(matrix), len(matrix[0]) order = list() left, right, top, bottom = 0, columns - 1, 0, rows - 1 while left &lt;= right and top &lt;= bottom: for column in range(left, right + 1): order.append(matrix[top][column]) for row in range(top + 1, bottom + 1): order.append(matrix[row][right]) if left &lt; right and top &lt; bottom: for column in range(right - 1, left, -1): order.append(matrix[bottom][column]) for row in range(bottom, top, -1): order.append(matrix[row][left]) left, right, top, bottom = left + 1, right - 1, top + 1, bottom - 1 return order 4.4 æŠŠæ•°ç»„æ’æˆæœ€å°çš„æ•°from functools import cmp_to_keyfrom typing import Listclass Solution: def minNumber(self, nums: List[int]) -&gt; str: def sort_rule(x, y): a, b = x + y, y + x if a &gt; b: return 1 elif a &lt; b: return -1 else: return 0 strs = [str(num) for num in nums] strs.sort(key=cmp_to_key(sort_rule)) return &#x27;&#x27;.join(strs) 4.5 æŠŠå­—ç¬¦ä¸²è½¬æ¢æˆæ•´æ•°class Solution: def strToInt(self, str: str) -&gt; int: str = str.strip() # åˆ é™¤é¦–å°¾ç©ºæ ¼ if not str: return 0 # å­—ç¬¦ä¸²ä¸ºç©ºåˆ™ç›´æ¥è¿”å› res, i, sign = 0, 1, 1 int_max, int_min, bndry = 2 ** 31 - 1, -2 ** 31, 2 ** 31 // 10 if str[0] == &#x27;-&#x27;: sign = -1 # ä¿å­˜è´Ÿå· elif str[0] != &#x27;+&#x27;: i = 0 # è‹¥æ— ç¬¦å·ä½ï¼Œåˆ™éœ€ä» i = 0 å¼€å§‹æ•°å­—æ‹¼æ¥ for c in str[i:]: if not &#x27;0&#x27; &lt;= c &lt;= &#x27;9&#x27; : break # é‡åˆ°éæ•°å­—çš„å­—ç¬¦åˆ™è·³å‡º if res &gt; bndry or res == bndry and c &gt; &#x27;7&#x27;: return int_max if sign == 1 else int_min # æ•°å­—è¶Šç•Œå¤„ç† res = 10 * res + int(c) # æ•°å­—æ‹¼æ¥ return sign * res 4.7 æ•°å€¼çš„æ•´æ•°æ¬¡æ–¹ (é€’å½’+2åˆ†)class Solution: def myPow(self, x: float, n: int) -&gt; float: if x == 0: return 0 res = 1 if n &lt; 0: x, n = 1 / x, -n while n: if n &amp; 1: res *= x x *= x n &gt;&gt;= 1 return res 5. sliding windowå‰‘æŒ‡ Offer 59 - I. æ»‘åŠ¨çª—å£çš„æœ€å¤§å€¼ - (åŒç†äºåŒ…å« min å‡½æ•°çš„æ ˆ) answ # -*- coding: utf-8 -*-import collectionsfrom typing import List# è¾“å…¥: nums = [1,3,-1,-3,5,3,6,7], å’Œ k = 3# è¾“å‡º: [3,3,5,5,6,7]# è§£é‡Š:## æ»‘åŠ¨çª—å£çš„ä½ç½® æœ€å¤§å€¼# --------------- -----# [1 3 -1] -3 5 3 6 7 3# 1 [3 -1 -3] 5 3 6 7 3# 1 3 [-1 -3 5] 3 6 7 5# 1 3 -1 [-3 5 3] 6 7 5# 1 3 -1 -3 [5 3 6] 7 6# 1 3 -1 -3 5 [3 6 7] 7class Solution: def maxSlidingWindow(self, nums: List[int], k: int) -&gt; List[int]: if not nums or k == 0: return [] deque = collections.deque() for i in range(k): # æœªå½¢æˆçª—å£ while deque and deque[-1] &lt; nums[i]: deque.pop() deque.append(nums[i]) res = [deque[0]] for i in range(k, len(nums)): # å½¢æˆçª—å£å #[0~k-1], [1~k], [2~k+1] if deque[0] == nums[i - k]: deque.popleft() while deque and deque[-1] &lt; nums[i]: deque.pop() deque.append(nums[i]) res.append(deque[0]) return res quickSort def quickSort(a, left, right): if left &lt; right: l, r, x = left, right, a[l] while True while l &lt; r and a[r] &gt;= x: r-- while l &lt; r and a[l] &lt;= x: l++ if l &gt;= r: break a[r], a[l] = a[l], a[r] a[left], a[l] = a[l], a[left] quickSort(a, left, l-1) quickSort(a, l+1, right)void mergeSort(int a[], int l, int r) &#123; // 8, 5, 4, 9, 2, 3, 6 if(l &gt;= r) return; // exit. int mid = (l+r) / 2; // overflow &lt;-&gt; l + (r-l)/2 mergeSort(a, l, mid); mergeSort(a, mid+1, r); int *arr = new int[r-l+1]; int k = 0; int i = l, j = mid + 1; while(i &lt;= mid &amp;&amp; j &lt;= r) &#123; if(a[i] &lt;= a[j]) &#123; arr[k++] = a[i++]; &#125; else &#123; arr[k++] = a[j++]; // ans += (mid-i+1); &#125; &#125; while(i &lt;= mid) arr[k++] = a[i++]; while(j &lt;= r) arr[k++] = a[j++]; for(int i = l; i &lt;= r; i++) &#123; a[i] = arr[i-l]; &#125; delete []arr;&#125; Reference æˆé•¿ä¹‹è·¯ 0607offer çŸ¥ä¹ï¼š [Leetcode][åŠ¨æ€è§„åˆ’]ç›¸å…³é¢˜ç›®æ±‡æ€»/åˆ†æ/æ€»ç»“ ç®€ä¹¦ï¼š 2019 ç®—æ³•é¢è¯•ç›¸å…³(leetcode)â€”åŠ¨æ€è§„åˆ’(Dynamic Programming) CSDN leetcode DP åˆ·å®Œ700å¤šé¢˜åçš„é¦–æ¬¡æ€»ç»“ï¼šLeetCodeåº”è¯¥æ€ä¹ˆåˆ·ï¼Ÿ å°ç™½ä¸€è·¯èµ°æ¥ï¼Œè¿ç»­åˆ·é¢˜ä¸‰å¹´ï¼Œè°ˆè°ˆæˆ‘çš„ç®—æ³•å­¦ä¹ ç»éªŒcodebunk.comã€Šç¨‹åºå‘˜çš„ç®—æ³•è¶£é¢˜ã€‹-å¼€å‘è®°å½•"}],"posts":[{"title":"2021 Leetcode","slug":"leetcode/2021-leetcode","date":"2021-03-19T02:54:16.000Z","updated":"2021-04-03T04:37:30.307Z","comments":true,"path":"2021/03/19/leetcode/2021-leetcode/","link":"","permalink":"http://iequa.com/2021/03/19/leetcode/2021-leetcode/","excerpt":"","text":"1. binary-search1.1 äºŒåˆ†æŸ¥æ‰¾, while l &lt;= r class Solution: def search(self, nums: List[int], target: int) -&gt; int: if not nums: return -1 l, r = 0, len(nums) - 1 while l &lt;= r: mid = (r - l)//2 + l if nums[mid] &lt; target: l = mid + 1 elif nums[mid] &gt; target: r = mid - 1 else: return mid return -1 34. åœ¨æ’åºæ•°ç»„ä¸­æŸ¥æ‰¾å…ƒç´ çš„ç¬¬ä¸€ä¸ªå’Œæœ€åä¸€ä¸ªä½ç½® class Solution: def searchRange(self, nums: List[int], target: int) -&gt; List[int]: if not nums: return [-1, -1] def binSearch(nums, t, flag): l, r = 0, len(nums) - 1 while l &lt;= r: mid = (l + r) // 2 if nums[mid] &gt; t: r = mid - 1 elif nums[mid] &lt; t: l = mid + 1 else: if flag == &quot;L&quot;: r = mid - 1 else: l = mid + 1 if flag == &#x27;L&#x27; and r + 1 &lt; len(nums) and nums[r + 1] == t: return r + 1 if flag == &#x27;R&#x27; and l - 1 &gt;= 0 and nums[l - 1] == t: return l - 1 return -1 return [binSearch(nums=nums, t=target, flag=&#x27;L&#x27;), binSearch(nums=nums, t=target, flag=&#x27;R&#x27;)] 88. åˆå¹¶ä¸¤ä¸ªæœ‰åºæ•°ç»„ - é€†å‘åŒæŒ‡é’ˆ class Solution: def merge(self, A: List[int], m: int, B: List[int], n: int) -&gt; None: &quot;&quot;&quot; Do not return anything, modify A in-place instead. &quot;&quot;&quot; pa, pb = m-1, n-1 tail = m+n-1 while not (pa == -1 and pb == -1): if pa == -1: A[tail] = B[pb] pb -= 1 elif pb == -1: A[tail] = A[pa] pa -= 1 elif A[pa] &gt; B[pb]: A[tail] = A[pa] pa -= 1 else: A[tail] = B[pb] pb -= 1 tail -= 1 return A[:] 15. 3Sum - for for while , second_ix &amp; third_ix ä¸¤è¾¹å¤¹ class Solution: def threeSum(self, nums: List[int]) -&gt; List[List[int]]: n = len(nums) nums.sort() ans = list() # æšä¸¾ a for first in range(n): # éœ€è¦å’Œä¸Šä¸€æ¬¡æšä¸¾çš„æ•°ä¸ç›¸åŒ if first &gt; 0 and nums[first] == nums[first - 1]: continue # c å¯¹åº”çš„æŒ‡é’ˆåˆå§‹æŒ‡å‘æ•°ç»„çš„æœ€å³ç«¯ third = n - 1 target = -nums[first] # æšä¸¾ b for second in range(first + 1, n): # éœ€è¦å’Œä¸Šä¸€æ¬¡æšä¸¾çš„æ•°ä¸ç›¸åŒ if second &gt; first + 1 and nums[second] == nums[second - 1]: continue # éœ€è¦ä¿è¯ b çš„æŒ‡é’ˆåœ¨ c çš„æŒ‡é’ˆçš„å·¦ä¾§ while second &lt; third and nums[second] + nums[third] &gt; target: third -= 1 # å¦‚æœæŒ‡é’ˆé‡åˆï¼Œéšç€ b åç»­çš„å¢åŠ  # å°±ä¸ä¼šæœ‰æ»¡è¶³ a+b+c=0 å¹¶ä¸” b&lt;c çš„ c äº†ï¼Œå¯ä»¥é€€å‡ºå¾ªç¯ if second == third: break if nums[second] + nums[third] == target: ans.append([nums[first], nums[second], nums[third]]) return ans 11. Container With Most Water åŒæŒ‡é’ˆ - ç§»åŠ¨ l å’Œ r è¾ƒå°çš„ä¸€æ–¹æ‰å¯èƒ½å¢åŠ  area class Solution: def maxArea(self, height: List[int]) -&gt; int: l, r = 0, len(height) - 1 area = 0 while l &lt; r: area = max(area, min(height[l], height[r]) * (r-l)) if height[l] &lt; height[r]: l += 1 else: r -= 1 return area 2. DFS / Stack2.1 å­—ç¬¦ä¸²è§£ç  â€œ3[a2[c]]â€ == â€œaccaccâ€, stack == [(3, &quot;&quot;), (2,&quot;a&quot;)] class Solution: def decodeString(self, s: str) -&gt; str: stack, res, multi = [], &quot;&quot;, 0 for c in s: if c == &#x27;[&#x27;: stack.append([multi, res]) res, multi = &quot;&quot;, 0 elif c == &#x27;]&#x27;: cur_multi, last_res = stack.pop() res = last_res + cur_multi * res elif &#x27;0&#x27; &lt;= c &lt;= &#x27;9&#x27;: multi = multi * 10 + int(c) else: res += c return res 215. æ•°ç»„ä¸­çš„ç¬¬Kä¸ªæœ€å¤§å…ƒç´  from heapq import heapify, heappush, heappop # pythonä¸­çš„heapæ˜¯å°æ ¹å †: heapify(hp) , heappop(hp), heappush(hp, v) class Solution: def findKthLargest(self, nums: List[int], k: int) -&gt; int: n = len(nums) if k == 0 or k &gt; n: return [] hp = nums[:k] heapify(hp) for i in range(k, n): v = nums[i] if v &gt; hp[0]: heappop(hp) heappush(hp, v) return hp[0] 3. DP No. dynamic programming Flag no-gd 31. nä¸ªéª°å­çš„ç‚¹æ•° dp[i][j] ï¼Œè¡¨ç¤ºæŠ•æ·å®Œ i æšéª°å­åï¼Œç‚¹æ•° j çš„å‡ºç°æ¬¡æ•° âœ”ï¸ &nbsp; Summary 20 dynamic programming (4.1) DPè¡¨ç¤ºçŠ¶æ€ easy 1. climbing-stairs ï¼Œ æ–°å»º{}or[] ,æ»šåŠ¨æ•°ç»„ 2. è¿ç»­å­æ•°ç»„çš„æœ€å¤§å’Œ â addition 63. å¤šå°‘ç§ ä¸åŒè·¯å¾„ II, store = [[0]*n for i in range(m)] äºŒç»´åˆå§‹åŒ– â addition Edit Distance/ç¼–è¾‘è·ç¦»ã€word1 è½¬æ¢æˆ word2ã€‘&nbsp;&nbsp; 1. dp = [ [0] * (m + 1) for _ in range(n + 1)] &nbsp;&nbsp; 2. dp[i][j] = min(A,B,C) âœ”ï¸â addition 5. Longest Palindromic Substring/æœ€é•¿å›æ–‡å­ä¸² 1. æšä¸¾å­ä¸²çš„é•¿åº¦ l+1,ä»å°é—®é¢˜åˆ°å¤§é—®é¢˜ 2. æšä¸¾å­ä¸²çš„èµ·å§‹ä½ç½® i, j=i+l å­ä¸²ç»“æŸä½ç½®, dp[i][j] = (dp[i+1][j-1] and s[i]==s[j]) âœ”ï¸â good æŠŠæ•°å­—ç¿»è¯‘æˆå­—ç¬¦ä¸² Fib âœ”ï¸â addition Leetcode 64. Minimum Path Sum, æœ€å°è·¯å¾„å’Œ grid[i][j] = min(grid[i - 1][j], grid[i][j - 1]) + grid[i][j] â addition 115. Distinct Subsequences I Hard addition 940. ä¸åŒçš„å­åºåˆ— II Hard addition Interleaving String/äº¤é”™å­—ç¬¦ä¸² Hard 4. sliding window &amp; hash No. Question Flag (6). sliding Window &nbsp; 65. æœ€é•¿ä¸å«é‡å¤å­—ç¬¦çš„å­å­—ç¬¦ä¸² æ»‘åŠ¨çª—å£ âœ”ï¸â &nbsp; 14. å’Œä¸ºsçš„è¿ç»­æ­£æ•°åºåˆ— &nbsp;&nbsp; [sliding window] inputï¼štarget = 9 outputï¼š[[2,3,4],[4,5]] âœ”ï¸â (7). æ¨¡æ‹Ÿ &nbsp; 21. åœ†åœˆä¸­æœ€åå‰©ä¸‹çš„æ•°å­— 1. å½“æ•°åˆ°æœ€åä¸€ä¸ªç»“ç‚¹ä¸è¶³mä¸ªæ—¶ï¼Œéœ€è¦è·³åˆ°ç¬¬ä¸€ä¸ªç»“ç‚¹ç»§ç»­æ•° 2. æ¯è½®éƒ½æ˜¯ä¸Šä¸€è½®è¢«åˆ ç»“ç‚¹çš„ä¸‹ä¸€ä¸ªç»“ç‚¹å¼€å§‹æ•° m ä¸ª 3. å¯»æ‰¾ f(n,m) ä¸ f(n-1,m) å…³ç³» 4. Aï¼š f(n,m)=(m+x)%n 5. Python æ·±åº¦ä¸å¤Ÿæ‰‹åŠ¨è®¾ç½® sys.setrecursionlimit(100000) ä¸œå¤§ Lucien é¢˜è§£,è®²å¾—æœ€æ¸…æ¥šçš„é‚£ä¸ªã€‚å®˜æ–¹è®²è§£æœ‰è¯¯ âœ”ï¸â &nbsp; 35. é¡ºæ—¶é’ˆæ‰“å°çŸ©é˜µ left, right, top, bottom = 0, columns - 1, 0, rows - 1 âœ”ï¸â &nbsp; 56. æŠŠæ•°ç»„æ’æˆæœ€å°çš„æ•°, sorted vs sort, strs.sort(key=cmp_to_key(sort_rule)) âœ”ï¸â &nbsp; 70. æŠŠå­—ç¬¦ä¸²è½¬æ¢æˆæ•´æ•° &nbsp;&nbsp;&nbsp;&nbsp; int_max, int_min, bndry = 231-1, -231, 2**31//10 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bndry=2147483647//10=214748364 ï¼Œåˆ™ä»¥ä¸‹ä¸¤ç§æƒ…å†µè¶Šç•Œ&nbsp;&nbsp;&nbsp;&nbsp; res &gt; bndry or res == bndry and c &gt;â€™7â€™ âœ”ï¸â 5. linkedList No. Question Flag (3). linkedList &nbsp; 7. ä»å°¾åˆ°å¤´æ‰“å°é“¾è¡¨ï¼š reversePrint(head.next) + [head.val] â &nbsp; 8. åè½¬é“¾è¡¨ pre, cur = head, head.next &nbsp; pre.next = None &nbsp; (å¾ªç¯ç‰ˆ åŒæŒ‡é’ˆ) â &nbsp; 10. åˆå¹¶ä¸¤ä¸ªæ’åºçš„é“¾è¡¨ &nbsp;&nbsp; [Recursion] p.next = self.mergeTwoLists(l1.next, l2) â addition æ—‹è½¬å•é“¾è¡¨ (F1. ç¯ F2. èµ°n-k%n æ–­å¼€) ä¸¾ä¾‹ï¼š ç»™å®š 1-&gt;2-&gt;3-&gt;4-&gt;5-&gt;6-&gt;NULL, K=3 åˆ™4-&gt;5-&gt;6-&gt;1-&gt;2-&gt;3-&gt;NULL â addition 92. ç¿»è½¬éƒ¨åˆ†å•é“¾è¡¨ reverse(head: ListNode, tail: ListNode) ä¸¾ä¾‹ï¼š1-&gt;2-&gt;3-&gt;4-&gt;5-&gt;null, from = 2, to = 4 ç»“æœï¼š1-&gt;4-&gt;3-&gt;2-&gt;5-&gt;null â addition é“¾è¡¨åˆ’åˆ†, æè¿°ï¼š ç»™å®šä¸€ä¸ªå•é“¾è¡¨å’Œæ•°å€¼xï¼Œåˆ’åˆ†é“¾è¡¨ä½¿å¾—å°äºxçš„èŠ‚ç‚¹æ’åœ¨å¤§äºç­‰äºxçš„èŠ‚ç‚¹ä¹‹å‰ â addition 82. åˆ é™¤æ’åºé“¾è¡¨ä¸­çš„é‡å¤å…ƒç´  II é“¾è¡¨1-&gt;2-&gt;3-&gt;3-&gt;4-&gt;4-&gt;5 å¤„ç†åä¸º 1-&gt;2-&gt;5. â addition è¾“å…¥ï¼š(7 -&gt; 1 -&gt; 6) + (5 -&gt; 9 -&gt; 2)ï¼Œå³617 + 295 è¾“å‡ºï¼š2 -&gt; 1 -&gt; 9ï¼Œå³912 6. stack No. Question Flag (2). Stack &nbsp; 394. å­—ç¬¦ä¸²è§£ç  [a]2[bc] â &nbsp; 28. åŒ…å«minå‡½æ•°çš„æ ˆ â &nbsp; 29. æœ€å°çš„kä¸ªæ•°ã€å †æ’çš„é€†å‘ã€‘ heapq.heappop(hp),heapq.heappush(hp, -arr[i]) âœ”ï¸â &nbsp; 36. æ»‘åŠ¨çª—å£çš„æœ€å¤§å€¼ (åŒç†äºåŒ…å« min å‡½æ•°çš„æ ˆ) deque.popleft(),åŒç«¯é˜Ÿåˆ—+å•è°ƒ âœ”ï¸â &nbsp; 59 II. é˜Ÿåˆ—çš„æœ€å¤§å€¼ , ç»´æŠ¤ä¸ªå•è°ƒçš„deque &nbsp;&nbsp; import queue, queue.deque(), queue.Queue(), deq[0], deq[-1] âœ”ï¸â (5). DFS / BFS &nbsp; 66. çŸ©é˜µä¸­çš„è·¯å¾„ , ç»å…¸å¥½é¢˜: æ·±æœ+å›æº¯ def dfs(i, j, k): âœ”ï¸â &nbsp; 61. æœºå™¨äººçš„è¿åŠ¨èŒƒå›´ bfs good &nbsp;&nbsp; from queue import Queue, q.get() q.pup() âœ”ï¸â 7. string8. Tree å‰‘æŒ‡ No. Question Flag easy (1). Tree &nbsp; 1.1 å¹³è¡¡äºŒå‰æ ‘ abs(maxHigh(root.left) - maxHigh(root.right)) &lt;= 1 and self.isBalanced(root.left) and self.isBalanced(root.right) â &nbsp; 1.2 å¯¹ç§°çš„äºŒå‰æ ‘ â &nbsp; 1.3 äºŒå‰æ ‘çš„é•œåƒï¼š root.left = self.mirrorTree(root.right) swapå+é€’å½’ â &nbsp; 1.4 äºŒå‰æœç´¢æ ‘çš„ç¬¬kå¤§èŠ‚ç‚¹ &nbsp;&nbsp; [ä¸­åºéå† å€’åº, å³-ä¸­-å·¦] âœ”ï¸â good 1.5 (ä¸¤ä¸ªèŠ‚ç‚¹)äºŒå‰æ ‘çš„æœ€è¿‘å…¬å…±ç¥–å…ˆ &nbsp;&nbsp; [Recursion] ååºéå†+è·¯å¾„å›æº¯ âœ”ï¸â good 1.6 (ä¸¤ä¸ªèŠ‚ç‚¹)äºŒå‰æœç´¢æ ‘çš„æœ€è¿‘å…¬å…±ç¥–å…ˆ &nbsp;&nbsp; Recursion + å‰ªæ âœ”ï¸â good 1.7 äºŒå‰æ ‘ä¸­å’Œä¸ºæŸä¸€å€¼çš„è·¯å¾„ é€’å½’å›æº¯ âœ”âï¸ &nbsp; 1.8 äºŒå‰æœç´¢æ ‘çš„ååºéå†åºåˆ— â &nbsp; 1.9 äºŒå‰æœç´¢æ ‘ä¸åŒå‘é“¾è¡¨ additional æ±‚äºŒå‰æ ‘ç¬¬Kå±‚çš„èŠ‚ç‚¹ä¸ªæ•° [Recursion] ï¼Œroot != None and k==1ï¼Œè¿”å›1 f(root.left, k-1) + f(root.right, k-1) â additional æ±‚äºŒå‰æ ‘ç¬¬Kå±‚çš„å¶å­èŠ‚ç‚¹ä¸ªæ•° [Recursion] if(k==1 and root.left and root.right is null) return 1; âœ”ï¸â class TreeNode: def __init__(self, x): self.val = x self.left = None self.right = Noneclass Solution: def isBalanced(self, root: TreeNode) -&gt; bool: def maxHigh(root): if root == None: return 0 return max(maxHigh(root.left), maxHigh(root.right)) + 1 if root == None: return True return abs(maxHigh(root.left) - maxHigh(root.right)) &lt;= 1 and self.isBalanced(root.left) and self.isBalanced(root.right)","categories":[{"name":"leetcode","slug":"leetcode","permalink":"http://iequa.com/categories/leetcode/"}],"tags":[{"name":"leetcode","slug":"leetcode","permalink":"http://iequa.com/tags/leetcode/"}]},{"title":"Hive Optimization Solution Notes","slug":"dataware/dwh-summary-5-knowleage","date":"2021-03-12T01:07:21.000Z","updated":"2021-06-15T15:29:01.025Z","comments":true,"path":"2021/03/12/dataware/dwh-summary-5-knowleage/","link":"","permalink":"http://iequa.com/2021/03/12/dataware/dwh-summary-5-knowleage/","excerpt":"","text":"1. Hive ä¼˜åŒ– å†æ¬¡åˆ†äº«ï¼Hiveè°ƒä¼˜ï¼Œæ•°æ®å·¥ç¨‹å¸ˆæˆç¥ä¹‹è·¯2020 å¤§æ•°æ®/æ•°ä»“/æ•°å¼€ QuestionsHiveå†…éƒ¨è¡¨å¤–éƒ¨è¡¨åŒºåˆ«åŠå„è‡ªä½¿ç”¨åœºæ™¯ // è®©å¯ä»¥ä¸èµ°mapreduceä»»åŠ¡çš„ï¼Œå°±ä¸èµ°mapreduceä»»åŠ¡hive&gt; set hive.fetch.task.conversion=more; // å¼€å¯ä»»åŠ¡å¹¶è¡Œæ‰§è¡Œ set hive.exec.parallel=true;// è§£é‡Šï¼šå½“ä¸€ä¸ªsqlä¸­æœ‰å¤šä¸ªjobæ—¶å€™ï¼Œä¸”è¿™å¤šä¸ªjobä¹‹é—´æ²¡æœ‰ä¾èµ–ï¼Œåˆ™å¯ä»¥è®©é¡ºåºæ‰§è¡Œå˜ä¸ºå¹¶è¡Œæ‰§è¡Œï¼ˆä¸€èˆ¬ä¸ºç”¨åˆ°union allçš„æ—¶å€™ï¼‰ // åŒä¸€ä¸ªsqlå…è®¸å¹¶è¡Œä»»åŠ¡çš„æœ€å¤§çº¿ç¨‹æ•° set hive.exec.parallel.thread.number=8; // è®¾ç½®jvmé‡ç”¨// JVMé‡ç”¨å¯¹hiveçš„æ€§èƒ½å…·æœ‰éå¸¸å¤§çš„ å½±å“ï¼Œç‰¹åˆ«æ˜¯å¯¹äºå¾ˆéš¾é¿å…å°æ–‡ä»¶çš„åœºæ™¯æˆ–è€…taskç‰¹åˆ«å¤šçš„åœºæ™¯ï¼Œè¿™ç±»åœºæ™¯å¤§å¤šæ•°æ‰§è¡Œæ—¶é—´éƒ½å¾ˆçŸ­ã€‚jvmçš„å¯åŠ¨è¿‡ç¨‹å¯èƒ½ä¼šé€ æˆç›¸å½“å¤§çš„å¼€é”€ï¼Œå°¤å…¶æ˜¯æ‰§è¡Œçš„jobåŒ…å«æœ‰æˆåƒä¸Šä¸‡ä¸ªtaskä»»åŠ¡çš„æƒ…å†µã€‚set mapred.job.reuse.jvm.num.tasks=10; // åˆç†è®¾ç½®reduceçš„æ•°ç›®// æ–¹æ³•1ï¼šè°ƒæ•´æ¯ä¸ªreduceæ‰€æ¥å—çš„æ•°æ®é‡å¤§å°set hive.exec.reducers.bytes.per.reducer=500000000; ï¼ˆ500Mï¼‰// æ–¹æ³•2ï¼šç›´æ¥è®¾ç½®reduceæ•°é‡set mapred.reduce.tasks = 20// mapç«¯èšåˆï¼Œé™ä½ä¼ ç»™reduceçš„æ•°æ®é‡set hive.map.aggr=true // å¼€å¯hiveå†…ç½®çš„æ•°å€¾ä¼˜åŒ–æœºåˆ¶set hive.groupby.skewindata=true Hadoopé«˜é¢‘è€ƒç‚¹ï¼ No. Hive ä¼˜åŒ– Flag 1. explain explain [extended] query 2. Column croppingåˆ—è£å‰ª set hive.optimize.cp = true; # åˆ—è£å‰ªï¼Œå–æ•°åªå–æŸ¥è¯¢ä¸­éœ€è¦ç”¨çš„åˆ—ï¼Œé»˜è®¤true 3. è°“è¯ä¸‹æ¨Predicate pushdown set hive.optimize.ppd=true; # é»˜è®¤æ˜¯trueselect a.*, b.* from a join b on a.id = b.id where b.age &gt; 20; 4. Partition crop åˆ†åŒºè£å‰ª set hive.optimize.pruner=true; # é»˜è®¤æ˜¯true 5. Merge small filesåˆå¹¶å°æ–‡ä»¶ Map input merge å¦‚æœä¸€ä¸ªmapreduce jobç¢°åˆ°ä¸€å¯¹å°æ–‡ä»¶ä½œä¸ºè¾“å…¥ï¼Œä¸€ä¸ªå°æ–‡ä»¶å¯åŠ¨ä¸€ä¸ªTaskMap è¾“å…¥åˆå¹¶:# Mapç«¯è¾“å…¥ã€åˆå¹¶æ–‡ä»¶ä¹‹åæŒ‰ç…§blockçš„å¤§å°åˆ†å‰²ï¼ˆé»˜è®¤ï¼‰set hive.input.format=org.apache.hadoop.hive.ql.io.CombineHiveInputFormat;# Mapç«¯è¾“å…¥ï¼Œä¸åˆå¹¶set hive.input.format=org.apache.hadoop.hive.ql.io.HiveInputFormat; 5. åˆå¹¶å°æ–‡ä»¶ Map/Reduceè¾“å‡ºåˆå¹¶ å¤§é‡çš„å°æ–‡ä»¶ä¼šç»™ HDFS å¸¦æ¥å‹åŠ›ï¼Œå½±å“å¤„ç†æ•ˆç‡.å¯ä»¥é€šè¿‡åˆå¹¶ Map å’Œ Reduce çš„ç»“æœæ–‡ä»¶æ¥æ¶ˆé™¤å½±å“ æ˜¯å¦åˆå¹¶Mapè¾“å‡ºæ–‡ä»¶, é»˜è®¤å€¼ä¸ºtrueset hive.merge.mapfiles=true; æ˜¯å¦åˆå¹¶Reduceç«¯è¾“å‡ºæ–‡ä»¶,é»˜è®¤å€¼ä¸ºfalseset hive.merge.mapredfiles=true; 6. MapTaskå¹¶è¡Œåº¦ 1ã€å‡å°‘ MapTask æ•°æ˜¯é€šè¿‡åˆå¹¶å°æ–‡ä»¶æ¥å®ç°ï¼Œè¿™ä¸€ç‚¹ä¸»è¦æ˜¯é’ˆå¯¹æ•°æ®æº2ã€å¢åŠ  MapTask æ•°å¯ä»¥é€šè¿‡æ§åˆ¶ä¸Šä¸€ä¸ª job çš„ reduceTask ä¸ªæ•°é‡ç‚¹æ³¨æ„ï¼šä¸æ¨èæŠŠè¿™ä¸ªå€¼è¿›è¡Œéšæ„è®¾ç½®ï¼æ¨èçš„æ–¹å¼ï¼šä½¿ç”¨é»˜è®¤çš„åˆ‡å—å¤§å°å³å¯ã€‚å¦‚æœéè¦è°ƒæ•´ï¼Œæœ€å¥½æ˜¯åˆ‡å—çš„Nå€æ•° default_mapper_num = total_size / dfs_block_size set mapred.map.tasks=10; # é»˜è®¤å€¼æ˜¯2, å¤§äº default_mapper_num æ‰ç”Ÿæ•ˆ æ€»ç»“ä¸€ä¸‹æ§åˆ¶ mapper ä¸ªæ•°çš„æ–¹æ³•ï¼š1. å¦‚æœæƒ³å¢åŠ  MapTask ä¸ªæ•°ï¼Œå¯ä»¥è®¾ç½® mapred.map.tasks ä¸ºä¸€ä¸ªè¾ƒå¤§çš„å€¼2. å¦‚æœæƒ³å‡å°‘ MapTask ä¸ªæ•°ï¼Œå¯ä»¥è®¾ç½® maperd.min.split.size ä¸ºä¸€ä¸ªè¾ƒå¤§çš„å€¼3. å¦‚inputæ˜¯å¤§é‡å°æ–‡ä»¶ï¼Œæƒ³å‡å°‘ mapper æ•°ï¼Œå¯è®¾ç½® hive.input.format åˆå¹¶å°æ–‡ä»¶hive.input.format=org.apache.hadoop.hive.ql.io.CombineHiveInputFormat; 7. ReduceTaskå¹¶è¡Œåº¦ å¯ä»¥é€šè¿‡æ”¹å˜ä¸Šè¿°ä¸¤ä¸ªå‚æ•°çš„å€¼æ¥æ§åˆ¶ ReduceTask çš„æ•°é‡. ä¹Ÿå¯ä»¥é€šè¿‡: set mapred.map.tasks=10; set mapreduce.job.reduces=10; 8. Joinä¼˜åŒ– 1. ä¼˜å…ˆè¿‡æ»¤åå†è¿›è¡ŒJoinæ“ä½œï¼Œæœ€å¤§é™åº¦å‡å°‘å‚ä¸joinçš„æ•°æ®é‡2. å°è¡¨joinå¤§è¡¨ï¼Œæœ€å¥½å¯åŠ¨mapjoinï¼Œhiveè‡ªå¯ç”¨mapjoin, å°è¡¨ä¸èƒ½è¶…è¿‡25Mï¼Œå¯æ”¹3. Join onçš„æ¡ä»¶ç›¸åŒçš„è¯ï¼Œæœ€å¥½æ”¾å…¥åŒä¸€ä¸ªjobï¼Œå¹¶ä¸”joinè¡¨çš„æ’åˆ—é¡ºåºä»å°åˆ°å¤§4. å¦‚æœå¤šå¼ è¡¨åšjoin, å¦‚æœå¤šä¸ªé“¾æ¥æ¡ä»¶éƒ½ç›¸åŒï¼Œä¼šè½¬æ¢æˆä¸€ä¸ªJobå¤§è¡¨Joinå¤§è¡¨ 1. filter null key 2. change null key to rand() case when a.user_id is null then concat(&#39;hive&#39;,rand()) else a.user_id end = b.user_id; 9. å¯ç”¨ MapJoin æ˜¯å¦æ ¹æ®è¾“å…¥å°è¡¨çš„å¤§å°ï¼Œè‡ªåŠ¨å°†reduceç«¯çš„common join è½¬åŒ–ä¸ºmap joinï¼Œå°†å°è¡¨åˆ·å…¥å†…å­˜ä¸­ å¯¹åº”é€»è¾‘ä¼˜åŒ–å™¨æ˜¯MapJoinProcessor set hive.auto.convert.join = true;# åˆ·å…¥å†…å­˜è¡¨çš„å¤§å°(å­—èŠ‚)set hive.mapjoin.smalltable.filesize = 25000000; # hiveä¼šåŸºäºè¡¨çš„sizeè‡ªåŠ¨çš„å°†æ™®é€šjoinè½¬æ¢æˆmapjoin set hive.auto.convert.join.noconditionaltask=true; # å¤šå¤§çš„è¡¨å¯ä»¥è‡ªåŠ¨è§¦å‘æ”¾åˆ°å†…å±‚LocalTaskä¸­ï¼Œé»˜è®¤å¤§å°10Mset hive.auto.convert.join.noconditionaltask.size=10000000; ä¹Ÿå¯ä»¥æ‰‹åŠ¨å¼€å¯mapjoinï¼š &nbsp;&nbsp; SELECT /+ MAPJOIN(smallTable) / smallTable.key, bigTable.value 10. Join_data_skew skew /skjuË/ # joinçš„keyå¯¹åº”çš„è®°å½•æ¡æ•°è¶…è¿‡è¿™ä¸ªå€¼åˆ™ä¼šè¿›è¡Œåˆ†æ‹†ï¼Œå€¼æ ¹æ®å…·ä½“æ•°æ®é‡è®¾ç½®set hive.skewjoin.key=100000;# å¦‚æœæ˜¯joinè¿‡ç¨‹å‡ºç°å€¾æ–œåº”è¯¥è®¾ç½®ä¸ºtrueset hive.optimize.skewjoin=false;é€šè¿‡ hive.skewjoin.mapjoin.map.tasks å‚æ•°è¿˜å¯ä»¥æ§åˆ¶ç¬¬äºŒä¸ª job çš„ mapper æ•°é‡ï¼Œé»˜è®¤10000set hive.skewjoin.mapjoin.map.tasks=10000; 13. Group Byä¼˜åŒ– 1. Mapç«¯éƒ¨åˆ†èšåˆ # å¼€å¯Mapç«¯èšåˆå‚æ•°è®¾ç½® set hive.map.aggr=true;# è®¾ç½®mapç«¯é¢„èšåˆçš„è¡Œæ•°é˜ˆå€¼ï¼Œè¶…è¿‡è¯¥å€¼å°±ä¼šåˆ†æ‹†jobï¼Œé»˜è®¤å€¼100000set hive.groupby.mapaggr.checkinterval=100000 2. æœ‰æ•°æ®å€¾æ–œæ—¶è¿›è¡Œè´Ÿè½½å‡è¡¡å½“ HQL è¯­å¥ä½¿ç”¨ group by æ—¶æ•°æ®å‡ºç°å€¾æ–œæ—¶ï¼Œå¦‚æœè¯¥å˜é‡è®¾ç½®ä¸º trueï¼Œé‚£ä¹ˆ Hive ä¼šè‡ªåŠ¨è¿›è¡Œè´Ÿè½½å‡è¡¡ã€‚ç­–ç•¥å°±æ˜¯æŠŠ MapReduce ä»»åŠ¡æ‹†åˆ†æˆä¸¤ä¸ªï¼š ç¬¬1ä¸ªå…ˆåšé¢„æ±‡æ€»ï¼Œç¬¬2ä¸ªå†åšæœ€ç»ˆæ±‡æ€». # è‡ªåŠ¨ä¼˜åŒ–ï¼Œæœ‰æ•°æ®å€¾æ–œçš„æ—¶å€™è¿›è¡Œè´Ÿè½½å‡è¡¡ï¼ˆé»˜è®¤æ˜¯falseï¼‰ set hive.groupby.skewindata=false; 15. Count Distinctä¼˜åŒ– ä¼˜åŒ–åï¼ˆå¯åŠ¨2ä¸ªjobï¼Œ1ä¸ªjobè´Ÿè´£å­æŸ¥è¯¢(å¯æœ‰å¤šä¸ªreduce)ï¼Œå¦1ä¸ªjobè´Ÿè´£count(1)): select count(1) from (select id from tablename group by id) tmp; 16. æ€æ ·å†™in/existsleft semi join â€” in / exists å®ç° select a.id, a.name from a where a.id in (select b.id from b);æ˜¯æ¨èä½¿ç”¨ Hive çš„ä¸€ä¸ªé«˜æ•ˆæ›¿ä»£æ–¹æ¡ˆï¼šleft semi joinselect a.id, a.name from a left semi join b on a.id = b.id; Hive0.11ç‰ˆæœ¬ä¹‹åï¼š hive.auto.convert.join=Truehive.mapjoin.smalltable.filesize# é»˜è®¤å€¼ä¸º2500000(25M),é€šè¿‡é…ç½®è¯¥å±æ€§æ¥ç¡®å®šä½¿ç”¨è¯¥ä¼˜åŒ–çš„è¡¨çš„å¤§å°ï¼Œå¦‚æœè¡¨çš„å¤§å°å°äºæ­¤å€¼å°±ä¼šè¢«åŠ è½½è¿›å†…å­˜ä¸­ Notesï¼šä½¿ç”¨é»˜è®¤å¯åŠ¨è¯¥ä¼˜åŒ–çš„æ–¹å¼å¦‚æœå‡ºç°é»˜åå¥‡å¦™çš„BUG(æ¯”å¦‚MAPJOINå¹¶ä¸èµ·ä½œç”¨),å°±å°†ä»¥ä¸‹ä¸¤ä¸ªå±æ€§ç½®ä¸ºfaseæ‰‹åŠ¨ä½¿ç”¨MAPJOINæ ‡è®°æ¥å¯åŠ¨è¯¥ä¼˜åŒ– hive.auto.convert.join=false(å…³é—­è‡ªåŠ¨MAPJOINè½¬æ¢æ“ä½œ)hive.ignore.mapjoin.hint=false(ä¸å¿½ç•¥MAPJOINæ ‡è®°) æ‰‹åŠ¨å¼€å¯mapjoinï¼š --SQLæ–¹å¼ï¼Œåœ¨SQLè¯­å¥ä¸­æ·»åŠ MapJoinæ ‡è®°ï¼ˆmapjoin hintï¼‰--å°†å°è¡¨æ”¾åˆ°å†…å­˜ä¸­ï¼Œçœå»shffleæ“ä½œ// åœ¨æ²¡æœ‰å¼€å¯mapjoinçš„æƒ…å†µä¸‹ï¼Œæ‰§è¡Œçš„æ˜¯reduceJoinSELECT /*+ MAPJOIN(smallTable) */ smallTable.key, bigTable.value FROMsmallTable JOIN bigTable ON smallTable.key = bigTable.key;/*+mapjoin(smalltable)*/ 2.å¤§è¡¨Joinå¤§è¡¨ æŠŠç©ºå€¼çš„keyå˜æˆä¸€ä¸ªå­—ç¬¦ä¸²åŠ ä¸Šéšæœºæ•°ï¼ŒæŠŠå€¾æ–œçš„æ•°æ®åˆ†åˆ°ä¸åŒçš„reduceä¸Šï¼Œç”±äºnullå€¼å…³è”ä¸ä¸Šï¼Œå¤„ç†åå¹¶ä¸å½±å“æœ€ç»ˆç»“æœã€‚å¦‚ä¸‹ï¼š select * from log a left outer join users b on case when a.user_id is null then concat(&#x27;hive&#x27;,rand()) else a.user_id end = b.user_id; å°è¡¨ä¸å°ä¸å¤§ï¼Œæ€ä¹ˆç”¨ map join è§£å†³å€¾æ–œé—®é¢˜ åœ¨å°è¡¨å’Œå¤§è¡¨è¿›è¡Œjoinæ—¶ï¼Œå°†å°è¡¨æ”¾åœ¨å‰è¾¹ï¼Œæ•ˆç‡ä¼šé«˜ã€‚hiveä¼šå°†å°è¡¨è¿›è¡Œç¼“å­˜ã€‚ Reduce é•¿å°¾ Count Distinct çš„æ‰§è¡ŒåŸç†æ˜¯å°†éœ€è¦å»é‡çš„å­—æ®µ ä»¥åŠ Group By å­—æ®µ è”åˆä½œä¸º keyå°†æ•°æ®åˆ†å‘åˆ° Reduceç«¯ã€‚å› ä¸º Distinctæ“ä½œï¼Œæ•°æ®æ— æ³•åœ¨ Map ç«¯çš„ Shuffle é˜¶æ®µæ ¹æ® Group By å…ˆåšä¸€æ¬¡èšåˆæ“ä½œï¼Œä»¥å‡å°‘ä¼ è¾“çš„æ•°æ®é‡ï¼Œè€Œæ˜¯å°†æ‰€æœ‰çš„æ•°æ®éƒ½ä¼ è¾“åˆ° Reduce ç«¯ï¼Œå½“ key çš„æ•°æ®åˆ†å‘ä¸å‡åŒ€æ—¶ï¼Œå°±ä¼šå¯¼è‡´ Reduce ç«¯é•¿å°¾ã€‚ å¯¹åŒä¸€ä¸ªè¡¨æŒ‰ç…§ç»´åº¦å¯¹ä¸åŒçš„åˆ—è¿›è¡Œ Count Distinctæ“ä½œï¼Œé€ æˆ Map ç«¯æ•°æ®è†¨èƒ€ï¼Œä»è€Œä½¿å¾—ä¸‹æ¸¸çš„ Join å’Œ Reduce å‡ºç°é“¾è·¯ä¸Šçš„ é•¿å°¾ã€‚ Map ç«¯ç›´æ¥åšèšåˆæ—¶å‡ºç° key å€¼åˆ†å¸ƒä¸å‡åŒ€ï¼Œé€ æˆ Reduce ç«¯é•¿å°¾ã€‚ . åŠ¨æ€åˆ†åŒºæ•°è¿‡å¤šæ—¶å¯èƒ½é€ æˆå°æ–‡ä»¶è¿‡å¤šï¼Œä»è€Œå¼•èµ· Reduce ç«¯é•¿å°¾ã€‚ . å¤šä¸ª Distinct åŒæ—¶å‡ºç°åœ¨ä¸€æ®µ SQL ä»£ç æ—¶ï¼Œæ•°æ®ä¼šè¢«åˆ†å‘å¤šæ¬¡ï¼Œ ä¼šé€ æˆæ•°æ®è†¨èƒ€ N å€ï¼Œé•¿å°¾ç°è±¡æ”¾å¤§ N å€. 2. MapReduce (1) Mapæ–¹æ³•ä¹‹åReduceæ–¹æ³•ä¹‹å‰è¿™æ®µå¤„ç†è¿‡ç¨‹å«ã€ŒShuffleã€ (2) Mapæ–¹æ³•ä¹‹åï¼Œæ•°æ®é¦–å…ˆè¿›å…¥åˆ°åˆ†åŒºæ–¹æ³•ï¼ŒæŠŠæ•°æ®æ ‡è®°å¥½åˆ†åŒºï¼Œç„¶åæŠŠæ•°æ®å‘é€åˆ°ç¯å½¢ç¼“å†²åŒºï¼›ç¯å½¢ç¼“å†²åŒºé»˜è®¤å¤§å°100mï¼Œç¯å½¢ç¼“å†²åŒºè¾¾åˆ°80%æ—¶ï¼Œè¿›è¡Œæº¢å†™ï¼›æº¢å†™å‰å¯¹æ•°æ®è¿›è¡Œæ’åºï¼Œæ’åºæŒ‰ç…§å¯¹keyçš„ç´¢å¼•è¿›è¡Œå­—å…¸é¡ºåºæ’åºï¼Œæ’åºçš„æ‰‹æ®µã€Œå¿«æ’ã€ï¼›æº¢å†™äº§ç”Ÿå¤§é‡æº¢å†™æ–‡ä»¶ï¼Œéœ€è¦å¯¹æº¢å†™æ–‡ä»¶è¿›è¡Œã€Œå½’å¹¶æ’åºã€ï¼›å¯¹æº¢å†™çš„æ–‡ä»¶ä¹Ÿå¯ä»¥è¿›è¡ŒCombineræ“ä½œï¼Œå‰ææ˜¯æ±‡æ€»æ“ä½œï¼Œæ±‚å¹³å‡å€¼ä¸è¡Œã€‚æœ€åå°†æ–‡ä»¶æŒ‰ç…§åˆ†åŒºå­˜å‚¨åˆ°ç£ç›˜ï¼Œç­‰å¾…Reduceç«¯æ‹‰å–ã€‚ 3ï¼‰æ¯ä¸ªReduceæ‹‰å–Mapç«¯å¯¹åº”åˆ†åŒºçš„æ•°æ®ã€‚æ‹‰å–æ•°æ®åå…ˆå­˜å‚¨åˆ°å†…å­˜ä¸­ï¼Œå†…å­˜ä¸å¤Ÿäº†ï¼Œå†å­˜å‚¨åˆ°ç£ç›˜ã€‚æ‹‰å–å®Œæ‰€æœ‰æ•°æ®åï¼Œé‡‡ç”¨å½’å¹¶æ’åºå°†å†…å­˜å’Œç£ç›˜ä¸­çš„æ•°æ®éƒ½è¿›è¡Œæ’åºã€‚åœ¨è¿›å…¥Reduceæ–¹æ³•å‰ï¼Œå¯ä»¥å¯¹æ•°æ®è¿›è¡Œåˆ†ç»„æ“ä½œã€‚ No. Hive ä¼˜åŒ– Flag 1. join ä¼˜åŒ–, order &amp; customer - å…ˆè¿‡æ»¤åœ¨Join 2. unionä¼˜åŒ–ï¼š ï¼ˆunion å»æ‰é‡å¤çš„è®°å½•ï¼‰è€Œæ˜¯ä½¿ç”¨ union all ç„¶ååœ¨ç”¨group by å»é‡ 5. æ¶ˆç­å­æŸ¥è¯¢å†…çš„ group by ã€ COUNT(DISTINCT)ï¼ŒMAXï¼ŒMINã€‚å¯ä»¥å‡å°‘jobçš„æ•°é‡ 6. spark join ä¼˜åŒ– - set hive.auto.convert.join=true; å°è¡¨è‡ªåŠ¨åˆ¤æ–­ï¼Œåœ¨å†…å­˜ &nbsp;&nbsp;Sort -Merge -Bucket Join å¯¹å¤§è¡¨è¿æ¥å¤§è¡¨çš„ä¼˜åŒ– 7. æ•°æ®å€¾æ–œ - SQL å¯¼è‡´ 1. group byç»´åº¦å˜å¾—æ›´ç»† 2. å€¼ä¸ºç©ºçš„æƒ…å†µå•ç‹¬å¤„ç† 3. ä¸åŒæ•°æ®ç±»å‹å…³è”äº§ç”Ÿæ•°æ®å€¾æ–œï¼ˆint,stringï¼‰ group byç»´åº¦ä¸èƒ½å˜å¾—æ›´ç»†çš„æ—¶å€™,å°±å¯ä»¥åœ¨åŸåˆ†ç»„keyä¸Šæ·»åŠ éšæœºæ•°ååˆ†ç»„èšåˆä¸€æ¬¡, ç„¶åå¯¹ç»“æœå»æ‰éšæœºæ•°åå†åˆ†ç»„èšåˆ,åœ¨joinæ—¶ï¼Œæœ‰å¤§é‡ä¸ºnullçš„join keyï¼Œåˆ™å¯ä»¥å°†nullè½¬æˆéšæœºå€¼ï¼Œé¿å…èšé›† 8. æ•°æ®å€¾æ–œ - ä¸šåŠ¡æ•°æ®æœ¬èº«å¯¼è‡´ - çƒ­ç‚¹å€¼å’Œéçƒ­ç‚¹å€¼åˆ†åˆ«è¿›è¡Œå¤„ç† 9. æ•°æ®å€¾æ–œ - keyæœ¬èº«ä¸å‡ - å¯ä»¥åœ¨keyä¸ŠåŠ éšæœºæ•°ï¼Œæˆ–è€…å¢åŠ reduceTaskæ•°é‡ 10. åˆå¹¶å°æ–‡ä»¶ - å°æ–‡ä»¶çš„äº§ç”Ÿæœ‰ä¸‰ä¸ªåœ°æ–¹ï¼Œmapè¾“å…¥ï¼Œmapè¾“å‡ºï¼Œreduceè¾“å‡º WITH x AS ( SELECT app, user_id, count( 1 ) AS rn FROM table1 GROUP BY app, user_id ) SELECT t.app, t.user_id FROM ( SELECT app, user_id, row_number ( ) over ( PARTITION BY app ORDER BY rn DESC ) AS max_user FROM x ) AS t WHERE t.max_user &lt;= 5 3. Spark (1). Data Skew çš„åŸç†å¾ˆç®€å•ï¼šåœ¨è¿›è¡Œshuffleçš„æ—¶å€™ï¼Œå¿…é¡»å°†å„ä¸ªèŠ‚ç‚¹ä¸Šç›¸åŒçš„keyæ‹‰å–åˆ°æŸä¸ªèŠ‚ç‚¹ä¸Šçš„ä¸€ä¸ªtaskæ¥è¿›è¡Œå¤„ç†ï¼Œæ¯”å¦‚æŒ‰ç…§keyè¿›è¡Œèšåˆæˆ–joinç­‰æ“ä½œã€‚æ­¤æ—¶å¦‚æœæŸä¸ªkeyå¯¹åº”çš„æ•°æ®é‡ç‰¹åˆ«å¤§çš„è¯ï¼Œå°±ä¼šå‘ç”Ÿ Data Skewã€‚ (2). Task æœ‰2ä¸ªéå¸¸æ…¢ ä¸æŒ‡å®šè¯­è¨€ï¼Œå†™ä¸€ä¸ªWordCountçš„MapReduce lines = sc.textFile(â€¦) lines.flatMap(lambda x: x.split(â€˜ â€˜)) wco = words.map(lambda x: (x, 1)) word_count = wco.reduceByKey(add) word_count.collect() lines = sc.textFile(&quot;/Users/blair/ghome/github/spark3.0/pyspark/spark-src/word_count.text&quot;, 2)lines = lines.filter(lambda x: &#x27;New York&#x27; in x)#lines.take(3)words = lines.flatMap(lambda x: x.split(&#x27; &#x27;))wco = words.map(lambda x: (x, 1))#print(wco.take(5))word_count = wco.reduceByKey(add)word_count.collect() ä½ èƒ½ç”¨SQLè¯­å¥å®ç°ä¸Šè¿°çš„MapReduceå—ï¼Ÿ select id, count(*) from D group by id order by count(*) desc; Sparkæäº¤ä½ çš„jaråŒ…æ—¶æ‰€ç”¨çš„å‘½ä»¤æ˜¯ä»€ä¹ˆï¼Ÿ spark-submit ä½ æ‰€ç†è§£çš„Sparkçš„shuffleè¿‡ç¨‹ï¼Ÿ Shuffleæ˜¯MapReduceæ¡†æ¶ä¸­çš„ä¸€ä¸ªç‰¹å®šçš„phaseï¼Œä»‹äºMap phaseå’ŒReduce phaseä¹‹é—´ï¼Œå½“Mapçš„è¾“å‡ºç»“æœè¦è¢«Reduceä½¿ç”¨æ—¶ï¼Œè¾“å‡ºç»“æœéœ€è¦æŒ‰keyå“ˆå¸Œï¼Œå¹¶ä¸”åˆ†å‘åˆ°æ¯ä¸€ä¸ªReducerä¸Šå»ï¼Œè¿™ä¸ªè¿‡ç¨‹å°±æ˜¯shuffleã€‚ç”±äºshuffleæ¶‰åŠåˆ°äº†ç£ç›˜çš„è¯»å†™å’Œç½‘ç»œçš„ä¼ è¾“ï¼Œå› æ­¤shuffleæ€§èƒ½çš„é«˜ä½ç›´æ¥å½±å“åˆ°äº†æ•´ä¸ªç¨‹åºçš„è¿è¡Œæ•ˆç‡ã€‚ å¦‚æœæˆ‘æœ‰ä¸¤ä¸ªlistï¼Œå¦‚ä½•ç”¨Pythonè¯­è¨€å–å‡ºè¿™ä¸¤ä¸ªlistä¸­ç›¸åŒçš„å…ƒç´ ï¼Ÿ list(set(list1).intersection(set(list2))) Sparkæœ‰å“ªäº›èšåˆç±»çš„ç®—å­,æˆ‘ä»¬åº”è¯¥å°½é‡é¿å…ä»€ä¹ˆç±»å‹çš„ç®—å­ï¼Ÿ åœ¨æˆ‘ä»¬çš„å¼€å‘è¿‡ç¨‹ä¸­ï¼Œèƒ½é¿å…åˆ™å°½å¯èƒ½é¿å…ä½¿ç”¨reduceByKeyã€joinã€distinctã€repartitionç­‰ä¼šè¿›è¡Œshuffleçš„ç®—å­ï¼Œå°½é‡ä½¿ç”¨mapç±»çš„éshuffleç®—å­ã€‚è¿™æ ·çš„è¯ï¼Œæ²¡æœ‰shuffleæ“ä½œæˆ–è€…ä»…æœ‰è¾ƒå°‘shuffleæ“ä½œçš„Sparkä½œä¸šï¼Œå¯ä»¥å¤§å¤§å‡å°‘æ€§èƒ½å¼€é”€ã€‚ ./bin/spark-submit \\ --master yarn --deploy-mode cluster --num-executors 100 \\ # æ€»å…±ç”³è¯·çš„executoræ•°ç›®ï¼Œæ™®é€šä»»åŠ¡åå‡ ä¸ªæˆ–è€…å‡ åä¸ªè¶³å¤Ÿäº† --executor-memory 6G \\ --executor-cores 4 \\ # æ¯ä¸ªexecutorå†…çš„æ ¸æ•°ï¼Œå³æ¯ä¸ªexecutorä¸­çš„ä»»åŠ¡taskæ•°ç›®ï¼Œæ­¤å¤„è®¾ç½®ä¸º2 --driver-memory 1G \\ # driverå†…å­˜å¤§å°ï¼Œä¸€èˆ¬æ²¡æœ‰å¹¿æ’­å˜é‡(broadcast)æ—¶ï¼Œè®¾ç½®1~4gè¶³å¤Ÿ --conf spark.default.parallelism=1000 \\ # é»˜è®¤æ¯ä¸ª satge çš„ Taskæ€»æ•° # Sparkä½œä¸šçš„é»˜è®¤ä¸º500~1000ä¸ªæ¯”è¾ƒåˆé€‚,å¦‚æœä¸è®¾ç½®ï¼Œsparkä¼šæ ¹æ®åº•å±‚HDFSçš„blockæ•°é‡è®¾ç½®taskçš„æ•°é‡ï¼Œè¿™æ ·ä¼šå¯¼è‡´å¹¶è¡Œåº¦åå°‘ï¼Œèµ„æºåˆ©ç”¨ä¸å……åˆ†ã€‚è¯¥å‚æ•°è®¾ä¸ºnum-executors * executor-coresçš„2~3å€æ¯”è¾ƒåˆé€‚ --conf spark.storage.memoryFraction=0.5 \\ å­˜å‚¨å†…å­˜ --conf spark.shuffle.memoryFraction=0.3 \\ æ‰§è¡Œå†…å­˜ # shuffleè¿‡ç¨‹ä¸­ä¸€ä¸ªtaskæ‹‰å–åˆ°ä¸Šä¸ªstageçš„taskçš„è¾“å‡ºåï¼Œè¿›è¡Œèšåˆæ“ä½œæ—¶èƒ½å¤Ÿä½¿ç”¨çš„Executorå†…å­˜çš„æ¯”ä¾‹ï¼Œé»˜è®¤æ˜¯0.2ï¼Œå¦‚æœshuffleèšåˆæ—¶ä½¿ç”¨çš„å†…å­˜è¶…å‡ºäº†è¿™ä¸ª20%çš„é™åˆ¶ï¼Œå¤šä½™æ•°æ®ä¼šè¢«æº¢å†™åˆ°ç£ç›˜æ–‡ä»¶ä¸­å»ï¼Œé™ä½shuffleæ€§èƒ½ # è¯¥å‚æ•°ä»£è¡¨äº†Executorå†…å­˜ä¸­ï¼Œåˆ†é…ç»™shuffle read taskè¿›è¡Œèšåˆæ“ä½œçš„å†…å­˜æ¯”ä¾‹ï¼Œé»˜è®¤æ˜¯20%ã€‚ # # â€”-spark.yarn.executor.memoryOverhead 1G ï¼š executoræ‰§è¡Œçš„æ—¶å€™ï¼Œç”¨çš„å†…å­˜å¯èƒ½ä¼šè¶…è¿‡executor-memoryï¼Œ # æ‰€ä»¥ä¼šä¸ºexecutoré¢å¤–é¢„ç•™ä¸€éƒ¨åˆ†å†…å­˜ï¼Œspark.yarn.executor.memoryOverheadå³ä»£è¡¨è¿™éƒ¨åˆ†å†…å­˜ # é»˜è®¤çš„ spark.executor.memoryOverhead=6144ï¼ˆ6Gï¼‰ æœ‰ç‚¹æµªè´¹ spark-summary-3-trouble-shooting spark.sql.shuffle.partitions - é…ç½®joinæˆ–è€…èšåˆæ“ä½œshuffleæ•°æ®æ—¶åˆ†åŒºçš„æ•°é‡spark.default.parallelism. - è¯¥å‚æ•°ç”¨äºè®¾ç½®æ¯ä¸ªstageçš„é»˜è®¤taskæ•°é‡ , è®¾ç½®è¯¥å‚æ•°ä¸ºnum-executors * executor-coresçš„2~3å€è¾ƒä¸ºåˆé€‚ spark sqlå¤šç»´åˆ†æä¼˜åŒ–â€”â€”æé«˜è¯»å–æ–‡ä»¶çš„å¹¶è¡Œåº¦, File (ROW Group - column chunk) spark.sql.files.maxPartitionBytes é»˜è®¤128MBï¼Œå•ä¸ªåˆ†åŒºè¯»å–çš„æœ€å¤§æ–‡ä»¶å¤§å°spark.sql.files.maxPartitionBytes çš„å€¼æ¥é™ä½ maxSplitBytes çš„å€¼parquet.block.size parquet æ–‡ä»¶çš„æ•°æ®æ˜¯ä»¥row group å­˜å‚¨ï¼Œä¸€ä¸ªparquet æ–‡ä»¶å¯èƒ½åªå«æœ‰ä¸€ä¸ªrow groupï¼Œä¹Ÿæœ‰å¯èƒ½å«æœ‰å¤šä¸ªrow group ï¼Œrow group çš„å¤§å° ä¸»è¦ç”±parquet.block.size å†³å®šã€‚ ã€ŒParquetæ˜¯ä¸ºäº†ä½¿Hadoopç”Ÿæ€ç³»ç»Ÿä¸­çš„ä»»ä½•é¡¹ç›®éƒ½å¯ä»¥ä½¿ç”¨å‹ç¼©çš„ï¼Œé«˜æ•ˆçš„åˆ—å¼æ•°æ®è¡¨ç¤ºå½¢å¼ã€parquet.block size:é»˜è®¤å€¼ä¸º134217728byte,å³128MB,è¡¨ç¤º Row Groupåœ¨å†…å­˜ä¸­çš„å—å¤§å°ã€‚è¯¥å€¼è®¾ç½®å¾—å¤§,å¯ä»¥æå‡ Parquetæ–‡ä»¶çš„è¯»å–æ•ˆç‡,ä½†æ˜¯ç›¸åº”åœ¨å†™çš„æ—¶å€™éœ€è¦è€—è´¹æ›´å¤šçš„å†…å­˜ ã€Œæ‰€ä»¥åœ¨å®é™…ç”Ÿäº§ä¸­ï¼Œä½¿ç”¨Parquetå­˜å‚¨ï¼Œsnappy/lzoå‹ç¼©çš„æ–¹å¼æ›´ä¸ºå¸¸è§ï¼Œè¿™ç§æƒ…å†µä¸‹å¯ä»¥é¿å…ç”±äºè¯»å–ä¸å¯åˆ†å‰²å¤§æ–‡ä»¶å¼•å‘çš„æ•°æ®å€¾æ–œã€‚ è¯»å–hdfsæ–‡ä»¶å¹¶è¡Œäº† 22ä¸ª tasks 1. Cache ç¼“å­˜ 1.1 spark.catalog.cacheTable(â€œtâ€) æˆ– df.cache() Spark SQLä¼šæŠŠéœ€è¦çš„åˆ—å‹ç¼©åç¼“å­˜ï¼Œé¿å…ä½¿ç”¨å’ŒGCçš„å‹åŠ› 1.2 spark.sql.inMemoryColumnarStorage.compressed é»˜è®¤true 1.3 spark.sql.inMemoryColumnarStorage.batchSize é»˜è®¤10000 æ§åˆ¶åˆ—ç¼“å­˜æ—¶çš„æ•°é‡ï¼Œé¿å…OOMé£é™©ã€‚å¼•ç”³è¦ç‚¹ï¼š è¡Œå¼å­˜å‚¨ &amp; åˆ—å¼å­˜å‚¨ ä¼˜ç¼ºç‚¹2. å…¶ä»–é…ç½® 2.1 spark.sql.autoBroadcastJoinThreshold 2.2 spark.sql.shuffle.partitions é»˜è®¤200ï¼Œé…ç½®joinå’Œaggçš„æ—¶å€™çš„åˆ†åŒºæ•° 2.3 spark.sql.broadcastTimeout é»˜è®¤300ç§’ï¼Œå¹¿æ’­joinæ—¶å¹¿æ’­ç­‰å¾…çš„æ—¶é—´ 2.4 spark.sql.files.maxPartitionBytes é»˜è®¤128MBï¼Œå•ä¸ªåˆ†åŒºè¯»å–çš„æœ€å¤§æ–‡ä»¶å¤§å° 2.5 spark.sql.files.openCostInBytesparquet.block.size3. å¹¿æ’­ hash join - BHJ 3.1 å½“ç³»ç»Ÿ spark.sql.autoBroadcastJoinThreshold åˆ¤æ–­æ»¡è¶³æ¡ä»¶ï¼Œä¼šè‡ªåŠ¨ä½¿ç”¨BHJ Spark SQL åœ¨ Spark Core çš„åŸºç¡€ä¸Šé’ˆå¯¹ç»“æ„åŒ–æ•°æ®å¤„ç†è¿›è¡Œå¾ˆå¤šä¼˜åŒ–å’Œæ”¹è¿›. Spark åªåœ¨å¯åŠ¨ Executor æ˜¯å¯åŠ¨ä¸€æ¬¡ JVMï¼Œå†…å­˜çš„ Task æ“ä½œæ˜¯åœ¨çº¿ç¨‹å¤ç”¨çš„ã€‚æ¯æ¬¡å¯åŠ¨ JVM çš„æ—¶é—´å¯èƒ½å°±éœ€è¦å‡ ç§’ç”šè‡³åå‡ ç§’ï¼Œé‚£ä¹ˆå½“ Task å¤šäº†ï¼Œè¿™ä¸ªæ—¶é—´ Hadoop ä¸çŸ¥é“æ¯” Spark æ…¢äº†å¤šã€‚ å¦‚æœå¯¹RDDè¿›è¡Œcacheæ“ä½œåï¼Œæ•°æ®åœ¨å“ªé‡Œï¼Ÿ æ‰§è¡Œcacheç®—å­æ—¶æ•°æ®ä¼šè¢«åŠ è½½åˆ°å„ä¸ªExecutorè¿›ç¨‹çš„å†…å­˜. ç¬¬äºŒæ¬¡ä½¿ç”¨ ä¼šç›´æ¥ä»å†…å­˜ä¸­è¯»å–è€Œä¸ä¼šåŒºç£ç›˜. åä¸ºäº‘Stackå…¨æ™¯å›¾ &gt; å¼€å‘è€…æŒ‡å— &gt; SQLå’ŒDataFrameè°ƒä¼˜ &gt; Spark SQL joinä¼˜åŒ– é€»è¾‘æ‰§è¡Œè®¡åˆ’åªæ˜¯å¯¹SQLè¯­å¥ä¸­ä»¥ä»€ä¹ˆæ ·çš„æ‰§è¡Œé¡ºåºåšä¸€ä¸ªæ•´ä½“æè¿°. ç‰©ç†æ‰§è¡Œè®¡åˆ’åŒ…å«å…·ä½“ä»€ä¹ˆæ“ä½œ. ä¾‹å¦‚ï¼šæ˜¯BroadcastJoinã€è¿˜æ˜¯SortMergeJoinâ€¦ èšåˆåcache é»˜è®¤æƒ…å†µä¸‹coalesceä¸ä¼šäº§ç”Ÿshuffle coalesce, repartition (1) è°“è¯ä¸‹æ¨ Predicate PushDown - SQLä¸­çš„è°“è¯ä¸»è¦æœ‰ likeã€betweenã€is nullã€inã€=ã€!=ç­‰(2) åˆ—è£å‰ª Column Pruning å’Œ æ˜ å°„ä¸‹æ¨ Project PushDown - åˆ—è£å‰ªå’Œæ˜ å°„ä¸‹æ¨çš„ç›®çš„ï¼šè¿‡æ»¤æ‰æŸ¥è¯¢ä¸éœ€è¦ä½¿ç”¨åˆ°çš„åˆ— 4. hadoop, hive, spark Hiveä¸­order byï¼Œsort byï¼Œdistribute byï¼Œcluster byçš„åŒºåˆ« order byä¼šå¯¹è¾“å…¥åšå…¨å±€æ’åºï¼Œå› æ­¤åªæœ‰ä¸€ä¸ªReducersort byä¸æ˜¯å…¨å±€æ’åºï¼Œå…¶åœ¨æ•°æ®è¿›å…¥reducerå‰å®Œæˆæ’åº distribute byæ˜¯æ§åˆ¶åœ¨mapç«¯å¦‚ä½•æ‹†åˆ†æ•°æ®ç»™reduceç«¯çš„, sort byä¸ºæ¯ä¸ªreduceäº§ç”Ÿä¸€ä¸ªæ’åºæ–‡ä»¶ 1 Hadoopå’Œsparkçš„ä¸»è¦åŒºåˆ«2 Hadoopä¸­ä¸€ä¸ªå¤§æ–‡ä»¶è¿›è¡Œæ’åºï¼Œå¦‚ä½•ä¿è¯æ•´ä½“æœ‰åºï¼Ÿsortåªä¼šä¿è¯å•ä¸ªèŠ‚ç‚¹çš„æ•°æ®æœ‰åº3 Hiveä¸­æœ‰å“ªäº›udf4 Hadoopä¸­æ–‡ä»¶put getçš„è¿‡ç¨‹è¯¦ç»†æè¿°5 Javaä¸­æœ‰å“ªäº›GCç®—æ³•? [1. æ ‡è®°-æ¸…é™¤ç®—æ³• 2. å¤åˆ¶ç®—æ³• 3. æ ‡è®°-æ•´ç†ç®—æ³• 4. åˆ†ä»£æ”¶é›†ç®—æ³•]6 Javaä¸­çš„å¼±å¼•ç”¨ å¼ºå¼•ç”¨å’Œè½¯å¼•ç”¨åˆ†åˆ«åœ¨å“ªäº›åœºæ™¯ä¸­ä½¿ç”¨7 Hadoopå’Œsparkçš„ä¸»è¦åŒºåˆ«-è¿™ä¸ªé—®é¢˜åŸºæœ¬éƒ½ä¼šé—®åˆ° (1). Hadoopå’Œsparkçš„ä¸»è¦åŒºåˆ« sparkæ¶ˆé™¤äº†å†—ä½™çš„ HDFS è¯»å†™: Hadoop æ¯æ¬¡ shuffle æ“ä½œåï¼Œå¿…é¡»å†™åˆ°ç£ç›˜ï¼Œè€Œ Spark åœ¨ shuffle åä¸ä¸€å®šè½ç›˜ï¼Œå¯ä»¥ cache åˆ°å†…å­˜ä¸­ï¼Œä»¥ä¾¿è¿­ä»£æ—¶ä½¿ç”¨ã€‚å¦‚æœæ“ä½œå¤æ‚ï¼Œå¾ˆå¤šçš„ shufle æ“ä½œï¼Œé‚£ä¹ˆ Hadoop çš„è¯»å†™ IO æ—¶é—´ä¼šå¤§å¤§å¢åŠ ï¼Œä¹Ÿæ˜¯ Hive æ›´æ…¢çš„ä¸»è¦åŸå› äº†ã€‚ sparkæ¶ˆé™¤äº†å†—ä½™çš„ MapReduce é˜¶æ®µ: Hadoop çš„ shuffle æ“ä½œä¸€å®šè¿ç€å®Œæ•´çš„ MapReduce æ“ä½œï¼Œå†—ä½™ç¹çã€‚è€Œ Spark åŸºäº RDD æä¾›äº†ä¸°å¯Œçš„ç®—å­æ“ä½œï¼Œä¸” reduce æ“ä½œäº§ç”Ÿ shuffle æ•°æ®ï¼Œå¯ä»¥ç¼“å­˜åœ¨å†…å­˜ä¸­ã€‚ JVM çš„ä¼˜åŒ–: Hadoop æ¯æ¬¡ MapReduce æ“ä½œï¼Œå¯åŠ¨ä¸€ä¸ª Task ä¾¿ä¼šå¯åŠ¨ä¸€æ¬¡ JVMï¼ŒåŸºäºè¿›ç¨‹çš„æ“ä½œã€‚è€Œ Spark æ¯æ¬¡ MapReduce æ“ä½œæ˜¯åŸºäºçº¿ç¨‹çš„ï¼Œåªåœ¨å¯åŠ¨ Executor æ˜¯å¯åŠ¨ä¸€æ¬¡ JVMï¼Œå†…å­˜çš„ Task æ“ä½œæ˜¯åœ¨çº¿ç¨‹å¤ç”¨çš„ã€‚æ¯æ¬¡å¯åŠ¨ JVM çš„æ—¶é—´å¯èƒ½å°±éœ€è¦å‡ ç§’ç”šè‡³åå‡ ç§’ï¼Œé‚£ä¹ˆå½“ Task å¤šäº†ï¼Œè¿™ä¸ªæ—¶é—´ Hadoop ä¸çŸ¥é“æ¯” Spark æ…¢äº†å¤šã€‚ (2). Hadoopä¸­ä¸€ä¸ªå¤§æ–‡ä»¶è¿›è¡Œæ’åºï¼Œå¦‚ä½•ä¿è¯æ•´ä½“æœ‰åºï¼Ÿ ä¸€ä¸ªæ–‡ä»¶æœ‰keyå€¼ä»1åˆ°10000çš„æ•°æ®ï¼Œæˆ‘ä»¬ç”¨ä¸¤ä¸ªåˆ†åŒºï¼Œå°†1åˆ°5000çš„keyå‘é€åˆ°partition1ï¼Œç„¶åç”±reduce1å¤„ç†ï¼Œ5001åˆ°10000çš„keyå‘åŠ¨åˆ°partition2ç„¶åç”±reduce2å¤„ç†ï¼Œreduce1çš„keyæ˜¯æŒ‰ç…§1åˆ°5000çš„å‡åºæ’åºï¼Œreduce2çš„keyæ˜¯æŒ‰ç…§5001åˆ°10000çš„å‡åºæ’åºï¼Œè¿™å°±ä¿è¯äº†æ•´ä¸ªMapReduceç¨‹åºçš„å…¨å±€æ’åºã€‚ Hadoop ä¸­çš„ç±» TotalOrderPartitioner 5. data warehouseçŸ¥ä¹ï¼šå¦‚ä½•å»ºè®¾æ•°æ®ä»“åº“ï¼Ÿåä¸ºï¼šæ•°æ®ä»“åº“ã€ä¸»é¢˜åŸŸã€ä¸»é¢˜æ¦‚å¿µä¸å®šä¹‰ other: ç¾å›¢é…é€æ•°æ®æ²»ç†å®è·µ æ•°ä»“å¤§å±±å“¥ ç é¾„10å¹´good æ•°ä»“å¤§å±±å“¥ - Hiveæ•°æ®å€¾æ–œçš„åŸå› åŠä¸»è¦è§£å†³æ–¹æ³•æ•°ä»“å¤§å±±å“¥ - Hiveä¼˜åŒ–-å¤§è¡¨joinå¤§è¡¨ä¼˜åŒ–ç¼“æ…¢å˜åŒ–ç»´ (Slowly Changing Dimension) å¸¸è§çš„ä¸‰ç§ç±»å‹åŠåŸå‹è®¾è®¡ï¼ˆè½¬ï¼‰ DWH å»ºæ¨¡æ–¹æ³•: èŒƒå¼å»ºæ¨¡æ³•/ç»´åº¦å»ºæ¨¡æ³•/å®ä½“å»ºæ¨¡æ³• è¿™é‡Œé¢å°±æ¶‰åŠåˆ°äº†æ•°æ®ä»“åº“çš„æ¶æ„ï¼Œç®€å•æ¥è¯´æ•°æ®ä»“åº“åˆ†ä¸ºå››ä¸ªå±‚æ¬¡ï¼š Layering Desc ODS å­˜æ”¾åŸå§‹æ•°æ®ï¼Œç›´æ¥åŠ è½½åŸå§‹æ—¥å¿—ã€æ•°æ®ï¼Œæ•°æ®ä¿å­˜åŸè²Œä¸åšå¤„ç†ã€‚ DWD ç»“æ„ä¸ç²’åº¦åŸå§‹è¡¨ä¿æŒä¸€è‡´ï¼Œå¯¹ODSå±‚æ•°æ®è¿›è¡Œæ¸…æ´— DWS ä»¥DWDä¸ºåŸºç¡€ï¼Œè¿›è¡Œè½»åº¦æ±‡æ€» ï¼ˆå°‘é‡ä»¥ODSä¸ºåŸºç¡€ï¼‰ ADS ä¸ºå„ç§ç»Ÿè®¡æŠ¥è¡¨æä¾›æ•°æ® æ³¨æ„: æ•°æ®ä»“åº“çš„æ¶æ„å½“ä¸­ï¼Œå„ä¸ªç³»ç»Ÿçš„å…ƒæ•°æ®é€šè¿‡ETLåŒæ­¥åˆ°æ“ä½œæ€§æ•°æ®ä»“åº“ODSä¸­ï¼Œå¯¹ODSæ•°æ®è¿›è¡Œé¢å‘ä¸»é¢˜åŸŸå»ºæ¨¡å½¢æˆDWï¼ˆæ•°æ®ä»“åº“ï¼‰ï¼ŒDMæ˜¯é’ˆå¯¹æŸä¸€ä¸ªä¸šåŠ¡é¢†åŸŸå»ºç«‹æ¨¡å‹ï¼Œå…·ä½“ç”¨æˆ·ï¼ˆå†³ç­–å±‚ï¼‰æŸ¥çœ‹DMç”Ÿæˆçš„æŠ¥è¡¨ æœ€é‡è¦çš„æ˜¯ï¼Œè¦å’Œä¸šåŠ¡ä»¥åŠäº§å“è´Ÿè´£äººè€å¿ƒæ²Ÿé€šï¼Œè®¤çœŸæ•²å®šå£å¾„ï¼Œæ¯”å¦‚è§‚çœ‹äººæ•°çš„ç»Ÿè®¡ï¼Œå°±æ˜¯è¦ç¡®å®šå¥½å“ªäº›è§‚ä¼—ä¸ç®—æœ‰æ•ˆè§‚ä¼—ï¼Œè§‚ä¼—å’Œä¸»æ’­æ˜¯åŒä¸€äººçš„ç­‰ç­‰ç»†èŠ‚ï¼Œè€å¿ƒæ˜¯å¾ˆé‡è¦çš„ï¼Œéœ€è¦æ ¼å¤–æ³¨æ„çš„æ˜¯ï¼Œå¼€å‘è¦å­¦ä¼šè¦æŠ›å¼ƒè‡ªå·±çš„ä¸“ä¸šçŸ¥è¯†ï¼Œç”¨æœ€é€šä¿—çš„æ–¹å¼å»è§£é‡Šï¼Œå¹¶ä¸”å­¦ä¼šç•™ä¸‹è®°å½•ã€‚ è¯´äº†è¿™ä¹ˆå¤šï¼Œæœ€æœ€é‡è¦çš„ï¼Œä¸€å®šè¦åšå¥½è§„èŒƒç»´æŠ¤ï¼Œæ— è®ºæ˜¯ç”¨å‰ç«¯è¿˜æ˜¯excelï¼ŒåŠæ—¶æ›´æ–°æ˜¯å¿…é¡»çš„ã€‚è¡¨çš„ä½œç”¨ï¼Œè®¾è®¡ç†å¿µï¼Œè¡¨å­—æ®µçš„å–æ•°é€»è¾‘ï¼Œå£å¾„çš„æä¾›äººï¼Œè¡¨ç»“æ„éƒ½è¦è®°å½•åœ¨æ¡ˆï¼Œæ—¶å¸¸ç»´æŠ¤ æ•°æ®è´¨é‡ - æ•°æ®æœ¬èº«è´¨é‡ï¼šæ•°æ®å¼€å‘å¯¹æ•°æ®è´¨é‡è´Ÿè´£ï¼Œä¿æŒå¯¹æ•°æ®çš„æ•¬ç•å¿ƒ æ•°æ®å»ºè®¾è´¨é‡ï¼šå¯ä»¥ä»ä¸¤æ–¹é¢æ¥è€ƒé‡ï¼šæ˜“ç”¨æ€§å’Œä¸°å¯Œæ€§ï¼› Title Desc æŒ‡æ ‡ä½“ç³» æŒ‡æ ‡å®šä¹‰è§„èŒƒï¼Œç›®çš„æ˜¯ç»Ÿä¸€å¼€å‘&amp;äº§å“å¯¹æŒ‡æ ‡çš„å®šä¹‰ã€‚é€šè¿‡å¯¹åŸå­æŒ‡æ ‡çš„å‘½åè§„åˆ™ã€æ´¾ç”ŸæŒ‡æ ‡çš„å‘½åè§„åˆ™å’Œæ´¾ç”Ÿè¯çš„å®šä¹‰æ¥å®Œæˆã€‚ ç²’åº¦ ç»´åº¦ æ•°æ®ä¸»é¢˜åˆ’åˆ† æ•°æ®åˆ†å±‚ è¡¨ å‘½åè§„èŒƒ - dwdæ•°æ®åŸŸä¸šåŠ¡è¿‡ç¨‹(på…¨é‡/iå¢é‡) / dwsæ•°æ®åŸŸç»´åº¦ç»Ÿè®¡å‘¨æœŸ ods dwd dws dim ads è¯„ä»·ä½“ç³»ï¼š æ•°æ®å®‰å…¨ æ•°æ®è´¨é‡ å¼€å‘æ•ˆç‡ æ•°æ®ç¨³å®š æ•°æ®è§„èŒƒ æ•°æ®å»ºè®¾ å…ƒæ•°æ®ç®¡ç†: Excel 2. DDL 3. Airflow Risk Dept å»ºç«‹å·¥å• Referenceå¤§æ•°æ®ï¼šå…ƒæ•°æ®ï¼ˆMetadataï¼‰æ•°æ®æ²»ç†ä¹‹å…ƒæ•°æ®ç®¡ç† æ•°æ®ä»“åº“â€“æ•°æ®åˆ†å±‚ï¼ˆETLã€ODSã€DWã€APPã€DIMï¼‰æ•°ä»“â€”Theoryâ€”æ•°ä»“å‘½åè§„èŒƒæœ‰èµæ•°æ®ä»“åº“å…ƒæ•°æ®ç³»ç»Ÿå®è·µã€æ•°æ®ä»“åº“ã€‘â€”â€”æ•°æ®ä»“åº“æ¦‚å¿µHiveæ•°æ®å€¾æ–œä¼˜åŒ–æ€»ç»“æ•°æ®ä»“åº“â€“æ•°æ®åˆ†å±‚ï¼ˆETLã€ODSã€DWã€APPã€DIMï¼‰ç½‘æ˜“ä¸¥é€‰æ•°ä»“è§„èŒƒä¸è¯„ä»·ä½“ç³»DEï¼ˆå¼€å‘ï¼‰é¢˜(é™„ç­”æ¡ˆ) Sparkç³»åˆ—â€”SparkSQL(ä¸‰)æ‰§è¡ŒSparkSQLæŸ¥è¯¢","categories":[{"name":"data-warehouse","slug":"data-warehouse","permalink":"http://iequa.com/categories/data-warehouse/"},{"name":"hive","slug":"data-warehouse/hive","permalink":"http://iequa.com/categories/data-warehouse/hive/"}],"tags":[{"name":"Hive","slug":"Hive","permalink":"http://iequa.com/tags/Hive/"}]},{"title":"DataWare Review Summary 4","slug":"dataware/dwh-summary-4-project","date":"2021-03-09T01:07:21.000Z","updated":"2021-06-16T00:56:22.822Z","comments":true,"path":"2021/03/09/dataware/dwh-summary-4-project/","link":"","permalink":"http://iequa.com/2021/03/09/dataware/dwh-summary-4-project/","excerpt":"","text":"1. DW æŠ€æœ¯é€‰å‹ No. Title Tech 1. æ•°æ®é‡‡é›† flume, kafka, sqoop, logstach, datax 2. æ•°æ®å­˜å‚¨ mysql, hdfs, hbase, redis, elastic, kudu, mongodb 3. æ•°æ®è®¡ç®— hive, tez, spark, flink, storm 4. æ•°æ®æŸ¥è¯¢ presto, kylin, impala, druid, clickhouse 5. æ•°æ®å¯è§†åŒ– echarts, superset, quickbl, dataV 6. ä»»åŠ¡è°ƒåº¦ azkaban, airflow, Oozie 7. é›†ç¾¤ç›‘æ§ Zabbix 8. å…ƒæ•°æ®ç®¡ç† Apache Atlas 9. æƒé™ç®¡ç† Aapche Ranger 2. é¡¹ç›®èƒŒæ™¯é‡‘èè¡Œä¸š, ä¿¡è´· 3. æ•°æ®è°ƒç ” Table List No. | Table Name | Desc --- | --- | --- 1. | channel_info | 2. | com\\_manager\\_info | 3. | dict_citys 4. | dict_product 5. | dict_provinces 6. | drawal_address 7. | drawal_apply | å€Ÿæ¬¾ç”³è¯·ID, ä¿¡ç”¨å®¡æ ¸ID, é‡‘é¢, æœŸé™, å¾…è¿˜é‡‘é¢, æ”¾æ¬¾æ—¶é—´, åè®®ID, ä¸‹ä¸€ä¸ªè¿˜æ¬¾æ—¶é—´, æ”¾æ¬¾èµ„é‡‘æºID, åè®®æ ¸å¯¹æ ‡è¯†, ä¿¡ç”¨å®¡æ ¸ç±»å‹, ç”¨æˆ·ç±»å‹, æ”¾æ¬¾ç±»å‹ 8. | drawal_companys | 9. | loan_apply 10. | loan_apply\\_credit\\_report 11. | loan_apply\\_salary 12. | loan_credit | å®¡æ ¸çŠ¶æ€, æ—¶é—´, ç»“è®º, äº§å“, æ‰¹å‡†é‡‘é¢, æœŸé™, åˆ†æ•° 13. | repay_plan | user\\_id, apply\\_id, contract\\_amount, loan\\_termæœŸé™, paid_amount å·²è¿˜é‡‘é¢, é¢„å­˜é‡‘é¢, å°šæ¬ é‡‘é¢, å‡å…é‡‘é¢, æå‰ç»“æ¸…è¿çº¦é‡‘, ä¸æ ¸å¿ƒåŒæ­¥æ—¶é—´ 14. | repay_plan\\_item | drawal\\_apply\\_idææ¬¾ç”³è¯·ID, repay\\_plan\\_idè¿˜æ¬¾è®¡åˆ’ID, repay\\_itemè¿˜æ¬¾æœŸæ•°ç¼–å·, due\\_dataé€¾æœŸæ—¶é—´, dest\\_principal, dest\\_interest, dest_service, dest_pty_fee æœ¬æ¯æ»çº³é‡‘, ... 15. | repay_plan\\_item\\_his 16. | user_det 17. | user_ocr\\_log 18. | user_md5 19. | user_quota | ä¿¡ç”¨é¢åº¦, å·²ä½¿ç”¨é¢, æœªä½¿ç”¨é¢, å¤±æ•ˆæ—¥æœŸ, é¢åº¦å¤±æ•ˆæ—¥æœŸ.. 20. | users ææ¬¾&amp;è¿˜æ¬¾ 34 Table Details ### 3.5 loan_apply è¡¨å | å­—æ®µ | ç±»å‹ | æè¿° --- | --- | --- | --- loan\\_apply | id, user_id | bigint(20) | ID / ç”¨æˆ·ID loan\\_apply | apply_time | datetime | ç”³è¯·æ—¶é—´ loan\\_apply | is_current | tinyint(4) | æ˜¯å¦æœ€æ–°ç”³è¯· loan\\_apply | short_loan_term | int(4) | æœ€çŸ­å€Ÿæ¬¾æœŸé™ loan\\_apply | long_loan_term | int(4) | æœ€é•¿å€Ÿæ¬¾æœŸé™ loan\\_apply | short_loan_amount | double | æœ€ä½å€Ÿæ¬¾é‡‘é¢ loan\\_apply | long_loan_amount | double | æœ€é«˜å€Ÿæ¬¾é‡‘é¢ loan\\_apply | credit_id | bigint(20) | ä¿¡ç”¨å®¡æ ¸ID loan\\_apply | status | varchar(20) | çŠ¶æ€ loan\\_apply | created_time, updated_time | datetime | åˆ›å»º, æ›´æ–°æ—¶é—´ ### 3.6 loan_apply_salary è¡¨å | å­—æ®µ | ç±»å‹ | æè¿° --- | --- | --- | --- loan\\_apply\\_salary | id, user_id | bigint(20) | ID / ç”¨æˆ·ID loan\\_apply\\_salary | loan_apply_id | bigint(20) | ç”³è¯·ID loan\\_apply\\_salary | salary_report_url | varchar(50) | è–ªèµ„æŠ¥å‘ŠURL loan\\_apply\\_salary | is_review | varchar(10) | æ˜¯å¦å®Œæˆå®¡æŸ¥ loan\\_apply\\_salary | created_time, updated_time | datetime | åˆ›å»º, æ›´æ–°æ—¶é—´ ### 3.7 loan_apply_credit_report è¡¨å | å­—æ®µ | ç±»å‹ | æè¿° --- | --- | --- | --- loan\\_apply\\_credit\\_report | id, user_id | bigint(20) | ID / ç”¨æˆ·ID loan\\_apply\\_credit\\_report | loan_apply_id | bigint(20) | ç”³è¯·ID loan\\_apply\\_credit\\_report | salary_report_url | varchar(50) | è–ªèµ„æŠ¥å‘ŠURL loan\\_apply\\_credit\\_report | is_review | varchar(10) | æ˜¯å¦å®Œæˆå®¡æŸ¥ loan\\_apply\\_credit\\_report | created_time, updated_time | datetime | åˆ›å»º, æ›´æ–°æ—¶é—´ ### 3.8 drawal_apply è¡¨å | å­—æ®µ | ç±»å‹ | æè¿° --- | --- | --- | --- drawal_apply | id | bigint(20) | ID drawal_apply | user_id | bigint(20) | ID drawal_apply | loan_apply_id | bigint(20) | ID drawal_apply | product_id | bigint(20) | ID drawal_apply | audit_id | bigint(20) | ID drawal_apply | credit_type | bigint(20) | ID drawal_apply | amount | bigint(20) | ID drawal_apply | loan_term | bigint(20) | ID drawal_apply | repay_amount | bigint(20) | å¾…è¿˜æ¬¾é‡‘é¢ drawal_apply | status | bigint(20) | çŠ¶æ€ drawal_apply | lend_time | datetime | æ”¾æ¬¾æ—¶é—´ drawal_apply | due_date | datetime | é€¾æœŸæ—¶é—´ drawal_apply | id | bigint(20) | ID ### 3.9 drawal_companys è¡¨å | å­—æ®µ | ç±»å‹ | æè¿° --- | --- | --- | --- drawal_companys | id, user_id, drawal_apply_id æ”¯ç”¨ç”³è¯·ID drawal_companys | occupation_type | è¡Œä¸šç±»å‹ drawal_companys | company_type | drawal_companys | working_age | drawal_companys | post | drawal_companys | title | drawal_companys | comp_name/comp_address/comp_tel/comp_email/salary | drawal_companys | social_security drawal_companys | loan_usage | 4. ä¸»é¢˜æ¨¡å‹ ä¸»é¢˜ï¼ˆSubjectï¼‰æ˜¯åœ¨è¾ƒé«˜å±‚æ¬¡ä¸Šå°†ä¼ä¸šä¿¡æ¯ç³»ç»Ÿä¸­çš„æ•°æ®è¿›è¡Œç»¼åˆã€å½’ç±»å’Œåˆ†æåˆ©ç”¨çš„ä¸€ä¸ªæŠ½è±¡æ¦‚å¿µï¼Œæ¯ä¸€ä¸ªä¸»é¢˜åŸºæœ¬å¯¹åº”ä¸€ä¸ªå®è§‚çš„åˆ†æé¢†åŸŸã€‚ No. ä¸»é¢˜åç§° ä¸»é¢˜æè¿° 1. å®¢æˆ· (USER) å½“äº‹äºº, ç”¨æˆ·ä¿¡æ¯, éå¸¸å¤š, äººè¡Œå¾ä¿¡ä¿¡æ¯ï¼Œ ä¸ªäººèµ„äº§ä¿¡æ¯ 2. æœºæ„ (ORG) çº¿ä¸‹æœ‰å“ªäº›å›¢é˜Ÿ, æµ™æ±ŸåŒºï¼Œå›¢é˜Ÿé•¿ï¼Œå®¢æˆ·ç»ç†ï¼Œ æœ‰ 600+ ä¸ª. åªæœ‰ç»´åº¦è¡¨ 3. äº§å“ (PRD) ç­¾åè®® äº§ç”Ÿ äº§å“, ä¸šåŠ¡æµç¨‹, åªæœ‰ç»´åº¦è¡¨ äº§å“ç»´åº¦è¡¨ï¼š äº§å“ç¼–å·, äº§å“åç§°ï¼Œ ä¸Šæ¶ï¼Œ ä¸‹æ¶äº¬é‡‘ï¼Œ codeï¼Œ å±•ç¤ºç»™è´¢åŠ¡ 4. æ¸ é“ (CHL) 5. äº‹ä»¶ (EVT) 1. ä¸šå€Ÿ / æ³¨å†Œ&amp;è®¤è¯ 2. æˆä¿¡ 3. æ”¯ç”¨ 4. æ”¾æ¬¾ 5. æ”¯ä»˜ 6. è¿˜æ¬¾ 6. åè®® (AGR) åˆçº¦ 7. è¥é”€ (CAMP) è¥é”€ä¹‹åçš„ï¼Œå•†åŠ¡ç»ç†å’Œæ¸ é“ï¼Œè°ˆä¸‹æ¥ä¹‹åï¼Œ åç«¯ æ¸ é“ï¼Œ èµ„äº§ï¼Œ è´¦åŠ¡ 8. è´¢åŠ¡ (RISK) 9. é£é™© (FINANCE) é£é™©éƒ¨ åœ¨é€»è¾‘æ„ä¹‰ä¸Šï¼Œå®ƒæ˜¯å¯¹åº”ä¼ä¸šä¸­æŸä¸€å®è§‚åˆ†æé¢†åŸŸæ‰€æ¶‰åŠçš„åˆ†æå¯¹è±¡ã€‚ä¾‹å¦‚â€œé”€å”®åˆ†æâ€å°±æ˜¯ä¸€ä¸ªåˆ†æé¢†åŸŸï¼Œå› æ­¤è¿™ä¸ªæ•°æ®ä»“åº“åº”ç”¨çš„ä¸»é¢˜å°±æ˜¯â€œé”€å”®åˆ†æâ€ã€‚ æ•°æ®åˆ†å±‚æ•°æ®æ¥æº: ODS, å¤šæ•°å…¨é‡ 5. å»ºæ¨¡æµç¨‹ No. data warehosue å»ºæ¨¡ä½“ç³» description 1. è§„èŒƒåŒ–æ•°æ®ä»“åº“ 2. dimensional modeling 1. ç»´åº¦è¡¨ dimension ï¼š è¡¨ç¤ºå¯¹åˆ†æä¸»é¢˜æ‰€å±ç±»å‹çš„æè¿° 2. äº‹å®è¡¨ fact table : å¯¹åˆ†æä¸»é¢˜çš„åº¦é‡ 3. ç‹¬ç«‹æ•°æ®é›†å¸‚ ods_table_name / dw_fact_topic_table_name / dm_fact_mart_name_table_name Business Pipeline ### 5.1 OCR è®¤è¯ No. | æŒ‡æ ‡, ç²’åº¦, ç»´åº¦ |æè¿° --- | --- | --- **ç»Ÿè®¡æŒ‡æ ‡ï¼š** | . | 1. OCR è®¤è¯é‡, OCRé€šè¿‡é‡ | **ç»Ÿè®¡ç²’åº¦ï¼š** | æ¯ä¸ªç”¨æˆ·OCRè®¤è¯ç”³è¯·, ä¸€æ¡æ•°æ® **åˆ†æç»´åº¦ï¼š** | æ³¨å†Œæ—¥æœŸ, æ¸ é“, ç”¨æˆ·ç±»å‹, æ€§åˆ«, å®¢æˆ·ç»ç† > æœªæ¥çš„å¯èƒ½éœ€æ±‚: åŸå­æ€§, æ˜ç»†å±‚é¢ è€ƒè™‘. > > çŸ­ä¿¡éªŒè¯, 2å…ƒé€€åŒ– ### 5.2 MD5 è®¤è¯ No. | æŒ‡æ ‡, ç²’åº¦, ç»´åº¦ |æè¿° --- | --- | --- **ç»Ÿè®¡æŒ‡æ ‡ï¼š** | . | 1. ç”³è¯·æ¬¡æ•°, é€šè¿‡æ¬¡æ•°, ç”³è¯·äººæ•°, é€šè¿‡äººæ•° | **ç»Ÿè®¡ç²’åº¦ï¼š** | ç”¨æˆ·md5è¯·æ±‚ä¸ºä¸€æ¡æ˜ç»†è®°å½• **åˆ†æç»´åº¦ï¼š** | è®¤è¯æ—¥æœŸ, è¯ä»¶ç±»å‹, æ€§åˆ«, æ¸ é“, å®¢æˆ·ç»ç†, ç”¨æˆ·ç±»å‹ > æ‘˜è¦: ç”³è¯·äººæ•°, é€šè¿‡äººæ•° ä¸åœ¨DWæ˜ç»†å±‚å‡ºç°, è€Œåº”è¯¥æ”¾åœ¨DMå±‚ 5.3 ä¿¡è´·ç”³è¯· No. æŒ‡æ ‡, ç²’åº¦, ç»´åº¦ æè¿° ç»Ÿè®¡æŒ‡æ ‡ï¼š . 1. å€Ÿæ¬¾é‡‘é¢, ç”³è¯·æ¬¡æ•° . 2. æä¾›è–ªæŠ¥æ¬¡æ•°, æä¾›è–ªæŠ¥æœ€æ—©æ—¶é—´ . 3. æä¾›ä¿¡æŠ¥æ¬¡æ•°, æä¾›ä¿¡æŠ¥æœ€æ—©æ—¶é—´ ç»Ÿè®¡ç²’åº¦ï¼š ç”¨æˆ·çš„ä¸€æ¬¡ç”³è¯·ä¸€æ¡è®°å½• åˆ†æç»´åº¦ï¼š ç”³è¯·æ—¥æœŸ, è¯ä»¶ç±»å‹, æ€§åˆ«, æ¸ é“, å®¢æˆ·ç»ç†, ç”¨æˆ·ç±»å‹, æœ€çŸ­æœŸæ•°, æœ€é•¿æœŸæ•° low and high å€Ÿæ¬¾é‡‘é¢ ---dwd æ˜ç»†å±‚fact_loan_apply( data_date string, idty_type string, -- è¯ä»¶ç±»å‹ channel_id bigint, user_type string, manager_id bigint, sex string, user_id bigint, apply_id bigint, apply_time string, short_loan_term bigint, long_loan_term bigint, id_current string, -- æ˜¯å¦æ˜¯å½“å‰ç”³è¯·ï¼Œä¸æ˜¯ä¸€ä¸ªç»´åº¦, æ˜¯ä¸€ä¸ªæ ‡è¯†, 2å…ƒé€€åŒ– salary_cnt int, first_salary_time, last_salary_time, cereport_cnt int, last_cereport_time, loan_app_cnt int, etl_time string) dw/fact_loan_apply INSERT OVERWRITE Table dw/fact_loan_apply partition(partition_date)SELECT ... u.idty_type, u.channel_id, u.user_type, u.manager_id, u.sex, a.user_id, a.id AS apply_id, a.apply_time, a.is_current, b.salary_cnt, b.first_salary_time, b.last_salary_time, c.cereport_cnt, c.first_cereport_time, c.last_cereport_time, ... etl_time, partition_dateFROM ods.loan_apply a LEFT JOIN ods.users u ON a.user_id = u.id LEFT JOIN ( SELECT user_id, loan_apply_id, count( id ) AS salary_cnt, min( created_at ) AS first_salary_time, max( created_at ) AS last_salary_time FROM ods.loan_apply_salary GROUP BY user_id, loan_apply_id ) b ON a.user_id = b.user_id AND a.id = b.loan_apply_id LEFT JOIN ( SELECT user_id, loan_apply_id, count( id ) AS cereport_cnt, min( created_at ) AS first_cereport_time, max( created_at ) AS last_cereport_time FROM ods.loan_apply_credit_report GROUP BY user_id, loan_apply_id ) c ON a.user_id = c.user_id AND a.id = c.loan_apply_id dm/fact_loan_apply_sum --- å€Ÿæ¬¾ç”³è¯·é‡, ç”³è¯·äººæ•°CREATE TABLE dm/fact_loan_apply_sum ( data_date string, idty_type string, channel_id BIGINT, user_type string, manager_id BIGINT, sex string, short_loan_term INT, long_loan_term INT, apply_num INT, apply_user_num INT, salary_cnt INT, cereport_cnt INT, short_loan_amount deciman ( 11, 2 ), long_loan_amount deciman ( 11, 2 ), etl_time string ) COMMENT &#x27;&#x27; partitioned BY ( partition_date string COMMENT &#x27;åˆ†åŒºæ—¥æœŸ&#x27; ) ROW format delimited FIELDS TERMINATED BY &#x27;\\t&#x27; LINES TERMINATED BY &#x27;\\n&#x27;;INSERT overwrite TABLE dm: fact_loan_apply_sum PARTITION ( partition_date ) SELECT data_date, idty_type, channel_id, user_type, manager_id, sex, short_loan_term, long_loan_term, sum( loan_app_cnt ) AS apply_sum, count( DISTINCT user_id ) AS apply_user_sum, sum( salary_cnt ) AS salary_cnt, sum( cereport_cnt ) AS cereport_cnt, sum( short_loan_amount ) AS short_loan_amount, sum( long_loan_amount ) AS long_loan_amount, max( from_unixtime(...) ) AS etl_time FROM dw: fact_user_regiter_dtlWHERE partition_data = form_unixtime (...) GROUP BY data_date, idty_date, channel_id, user_type, manager_id, sexæœªå®Œå¾…ç»­ 5.4 ä¿¡è´·å®¡æ ¸main table: loan_credit, user_quota loan_credit è¡¨å | å­—æ®µ | ç±»å‹ | æè¿° --- | --- | --- | --- loan_credit | id, loan_credit | apply_id | loan_credit | user_id | loan_credit | audit_status | | å®¡æ ¸çŠ¶æ€ loan_credit | audit_date | datetime | å®¡æ ¸æ—¶é—´ loan_credit | audit_result | | å®¡æ ¸ç»“è®º loan_credit | passed_products | varchar(6000) | é€šè¿‡äº§å“é›† loan_credit | amount | | æ‰¹å‡†é‡‘é¢ loan_credit | product_terms | | æ‰¹è´·äº§å“æœŸé™ loan_credit | score | varchar(20) | ä¿¡ç”¨åˆ†æ•° loan_credit | credit_type | | ä¿¡ç”¨å®¡æ ¸ç±»å‹ loan_credit | credit_user_id | | ä¿¡ç”¨å®¡æ ¸ç”¨æˆ·ID loan_credit | created_time / updated_time | è¡¨å | å­—æ®µ | ç±»å‹ | æè¿° --- | --- | --- | --- user_quota | id, 1. dwd/fact_credit_dtl No. æŒ‡æ ‡ Index, ç²’åº¦ Granularity, ç»´åº¦ dimension æè¿° ç»Ÿè®¡æŒ‡æ ‡ï¼š . 1. å®¡æ ¸é€šè¿‡é‡‘é¢ 2. ä¿¡ç”¨å®¡æ ¸åˆ†æ•° 3. é€šè¿‡ç”³è¯·é‡ 4. æ‹’ç»ç”³è¯·é‡ 5. é€šè¿‡äººæ•° 6. æ‹’ç»äººæ•° ç»Ÿè®¡ç²’åº¦ï¼š ç”¨æˆ·çš„ä¸€æ¬¡å®¡æ ¸è®°å½•ä¸ºä¸€æ¡è®°å½• åˆ†æç»´åº¦ï¼š å®¡æ ¸æ—¥æœŸ, è¯ä»¶ç±»å‹, æ¸ é“, ç”¨æˆ·ç±»å‹, å®¢æˆ·ç»ç†, æ€§åˆ«, å®¡æ ¸äºº dwd/fact_credit_dtl insert overwrite table dwd/fact_credit_dtl partition(partition_date)select from_unixtime(a.audit_date, &#x27;yyyy-MM-dd&#x27;) as data_date, u.idty_type, u.channel_id, u.user_type, u.manager_id, u.sex, a.id as credit_id, a.apply_id, a.user_id, a.audit_status, a.audit_result, a.passwd_products, a.product_terms, a.credit_type, a.credit_user_id, a.score, a.amount, (case when upper(audit_status) = &#x27;PASS&#x27; then 1 else 0 end) as pass_cnt, (case when upper(audit_status) = &#x27;DENY&#x27; then 1 else 0 end) as deny_cnt, from_unixtime(unix_timestamp(), &#x27;yyyy-MM-dd JH:mm:ss&#x27;) as etl_time, from_unixtime(a.created_time, &#x27;yyyy-MM-dd&#x27;) as partition_date,from ods.loan_credit a left join (dim).users u on a.user_id=u.id 2. dm/fact_loan_credit_sum No. æŒ‡æ ‡, ç²’åº¦, ç»´åº¦ æè¿° ç»Ÿè®¡æŒ‡æ ‡ï¼š . åˆå®¡é‡ 1. åˆå®¡é€šè¿‡äººæ•° 2. åˆå®¡æ‹’ç»äººæ•° 3. åˆå®¡é€šè¿‡é‡‘é¢ ç»ˆå®¡é‡ 1. ç»ˆå®¡é€šè¿‡äººæ•° 2. ç»ˆå®¡æ‹’ç»äººæ•° 3. ç»ˆå®¡é€šè¿‡é‡‘é¢ åˆ†æç»´åº¦ï¼š å®¡æ ¸æ—¥æœŸ, è¯ä»¶ç±»å‹, æ€§åˆ«, æ¸ é“, å®¢æˆ·ç»ç†, ç”¨æˆ·ç±»å‹, å®¡æ ¸äºº dm/fact_loan_credit_sum insert overwrite table dm/fact_loan_credit_sum partition(partition_date)select data_date, idty_type, channel_id, user_type, manager_id, sex, credit_user_id, count(case when credit_type=&#x27;cs&#x27; then credit_id else null end) as cs_num, count(distinct (case when credit_type=&#x27;cs&#x27; then user_id else null end) as cs_user_num, count(distinct (case when credit_type=&#x27;cs&#x27; then apply_id else null end) as cs_app_num, count(distinct (case when credit_type=&#x27;cs&#x27; and upper(audit_status) = &#x27;PASS&#x27; then 1 else 0 end) as cs_pass_num, count(distinct ((case when credit_type=&#x27;cs&#x27; and upper(audit_status) = &#x27;DENY&#x27; then 1 else 0 end) as cs_deny_num, sum(distinct (case when credit_type=&#x27;cs&#x27; and upper(audit_status) = &#x27;PASS&#x27; then amount else null end) as cs_pass_amt, max(from_unixtime(unix_timestamp(), &#x27;yyyy-MM-dd HH:mm:ss&#x27;)) as etl_time, max(from_unixtime(partition_date, &#x27;yyyy-MM-dd HH:mm:ss&#x27;)) as partition_datefrom dw: fact_credit_dtlwhere data_date=from_unixtime(unix_timestamp(), &#x27;yyyy-MM-dd&#x27;)group by data_date, idty_type, channel_id, user_type, manager_id, sex, credit_user_id; 5.5 æ”¯ç”¨/è¿˜æ¬¾ No. æŒ‡æ ‡, ç²’åº¦, ç»´åº¦ æè¿° ç»Ÿè®¡æŒ‡æ ‡ï¼š . 1. æ”¯ç”¨ç”³è¯·é‡, æ”¯ç”¨ç”³è¯·äººæ•° . 2. æ”¯ç”¨é€šè¿‡é‡, æ”¯ç”¨é€šè¿‡äººæ•° . 3. åè®®ç­¾è®¢é‡, åè®®ç­¾è®¢äººæ•° . 4. ç”³è¯·ææ¬¾é‡‘é¢, åè®®ç­¾è®¢é‡‘é¢, å®é™…ææ¬¾é‡‘é¢ ç”¨æˆ·çš„ä¸€æ¬¡ç”³è¯·ï¼Œ å¯èƒ½æœ‰å¤šæ¡å®¡æ ¸è®°å½• ods.drawal_apply a left join ods.users u on a.user_id=u.idleft join ( select com.id dmå±‚ï¼š ææ¬¾ç»Ÿè®¡æŒ‡æ ‡: ---ææ¬¾ç»Ÿè®¡æŒ‡æ ‡create table dm/fact_drawal_sum ( data_date string, idty_type string, channel_id bigint, user_type string, manager_id bigint, sex string, product_id bigint, loan_term bigint, drawal_app_num int, drawal_appuse_num int, drawal_app_amt decimal(11,2), Referenceæ•°æ®ä»“åº“â€“æ•°æ®åˆ†å±‚ï¼ˆETLã€ODSã€DWã€APPã€DIMï¼‰æ•°ä»“â€”Theoryâ€”æ•°ä»“å‘½åè§„èŒƒæœ‰èµæ•°æ®ä»“åº“å…ƒæ•°æ®ç³»ç»Ÿå®è·µçŸ¥ä¹ï¼šå¤§æ•°æ®ç¯å¢ƒä¸‹è¯¥å¦‚ä½•ä¼˜é›…åœ°è®¾è®¡æ•°æ®åˆ†å±‚ã€æ•°æ®ä»“åº“ã€‘â€”â€”æ•°æ®ä»“åº“æ¦‚å¿µHiveæ•°æ®å€¾æ–œä¼˜åŒ–æ€»ç»“æ•°æ®ä»“åº“â€“æ•°æ®åˆ†å±‚ï¼ˆETLã€ODSã€DWã€APPã€DIMï¼‰ç½‘æ˜“ä¸¥é€‰æ•°ä»“è§„èŒƒä¸è¯„ä»·ä½“ç³»","categories":[{"name":"data-warehouse","slug":"data-warehouse","permalink":"http://iequa.com/categories/data-warehouse/"}],"tags":[{"name":"DWH","slug":"DWH","permalink":"http://iequa.com/tags/DWH/"}]},{"title":"DataWare Review Summary 3 - Window Function","slug":"dataware/dwh-summary-3-window-function","date":"2021-02-20T01:07:21.000Z","updated":"2021-06-14T06:14:33.936Z","comments":true,"path":"2021/02/20/dataware/dwh-summary-3-window-function/","link":"","permalink":"http://iequa.com/2021/02/20/dataware/dwh-summary-3-window-function/","excerpt":"","text":"Window Function ä¸åŒäº æ™®é€šå‡½æ•°å’Œèšåˆå‡½æ•°ï¼Œå®ƒä¸ºæ¯è¡Œæ•°æ®è¿›è¡Œä¸€æ¬¡è®¡ç®—ï¼šè¾“å…¥å¤šè¡Œ(ä¸€ä¸ªçª—å£), è¿”å›ä¸€ä¸ªå€¼. 1. Window Function, SQLç‰¹ç‚¹å°±æ˜¯ OVER å…³é”®å­—: window_function (expression) OVER ( [ PARTITION BY part_list ] [ ORDER BY order_list ] [ &#123; ROWS | RANGE &#125; BETWEEN frame_start AND frame_end ] )# 1. PARTITION BY è¡¨ç¤ºå°†æ•°æ®å…ˆæŒ‰ part_list è¿›è¡Œåˆ†åŒº# 2. ORDER BY è¡¨ç¤ºå°†å„ä¸ªåˆ†åŒºå†…çš„æ•°æ®æŒ‰ order_list è¿›è¡Œæ’åº æœ€åä¸€é¡¹è¡¨ç¤º Frame çš„å®šä¹‰ï¼Œå³ï¼šå½“å‰çª—å£åŒ…å«å“ªäº›æ•°æ®ï¼Ÿ type frame sql example ROWS ROWS BETWEEN 3 PRECEDING AND 3 FOLLOWING è¡¨ç¤ºå¾€å‰ 3 è¡Œåˆ°å¾€å 3 è¡Œï¼Œä¸€å…± 7 è¡Œæ•°æ®ï¼ˆæˆ–å°äº 7 è¡Œï¼Œå¦‚æœç¢°åˆ°äº†è¾¹ç•Œï¼‰ RANGE RANGE BETWEEN 3 PRECEDING AND 3 FOLLOWING è¡¨ç¤ºæ‰€æœ‰å€¼åœ¨ $[c-3,c+3]$ è¿™ä¸ªèŒƒå›´å†…çš„è¡Œï¼Œ$c$ ä¸ºå½“å‰è¡Œçš„å€¼ é€»è¾‘è¯­ä¹‰ä¸Šè¯´ï¼Œä¸€ä¸ªçª—å£å‡½æ•°çš„è®¡ç®—â€œè¿‡ç¨‹â€å¦‚ä¸‹ï¼š æŒ‰çª—å£å®šä¹‰ï¼Œå°†æ‰€æœ‰è¾“å…¥æ•°æ®åˆ†åŒºã€å†æ’åºï¼ˆå¦‚æœéœ€è¦çš„è¯ï¼‰ å¯¹æ¯ä¸€è¡Œæ•°æ®ï¼Œè®¡ç®—å®ƒçš„ Frame èŒƒå›´ å°† Frame å†…çš„è¡Œé›†åˆè¾“å…¥çª—å£å‡½æ•°ï¼Œè®¡ç®—ç»“æœå¡«å…¥å½“å‰è¡Œ ä¸¾ä¸ªä¾‹å­ï¼š SELECT dealer_id, emp_name, sales, ROW_NUMBER() OVER (PARTITION BY dealer_id ORDER BY sales) AS rank, AVG(sales) OVER (PARTITION BY dealer_id) AS avgsales FROM sales# ä¸Šè¿°æŸ¥è¯¢ä¸­ï¼Œrank åˆ—è¡¨ç¤ºåœ¨å½“å‰ç»é”€å•†ä¸‹ï¼Œè¯¥é›‡å‘˜çš„é”€å”®æ’åï¼›# avgsales è¡¨ç¤ºå½“å‰ç»é”€å•†ä¸‹æ‰€æœ‰é›‡å‘˜çš„å¹³å‡é”€å”®é¢ã€‚æŸ¥è¯¢ç»“æœå¦‚ä¸‹+------------+-----------------+--------+------+---------------+| dealer_id | emp_name | sales | rank | avgsales |+------------+-----------------+--------+------+---------------+| 1 | Raphael Hull | 8227 | 1 | 14356 || 1 | Jack Salazar | 9710 | 2 | 14356 || 1 | Ferris Brown | 19745 | 3 | 14356 || 1 | Noel Meyer | 19745 | 4 | 14356 || 2 | Haviva Montoya | 9308 | 1 | 13924 || 2 | Beverly Lang | 16233 | 2 | 13924 || 2 | Kameko French | 16233 | 3 | 13924 || 3 | May Stout | 9308 | 1 | 12368 || 3 | Abel Kim | 12369 | 2 | 12368 || 3 | Ursa George | 15427 | 3 | 12368 |+------------+-----------------+--------+------+---------------+# æ³¨ï¼šFrame å®šä¹‰å¹¶éæ‰€æœ‰çª—å£å‡½æ•°éƒ½é€‚ç”¨ï¼Œæ¯”å¦‚ ROW_NUMBER()ã€RANK()ã€LEAD() ç­‰ã€‚è¿™äº›å‡½æ•°æ€»æ˜¯åº”ç”¨äºæ•´ä¸ªåˆ†åŒºï¼Œè€Œéå½“å‰ Frame 2. Window Function, Hive/Sparkcreate table window_test_table ( id int, --ç”¨æˆ·id sq string, --å¯ä»¥æ ‡è¯†æ¯ä¸ªå•†å“ cell_type int, --æ ‡è¯†æ¯ä¸ªå•†å“çš„ç±»å‹ï¼Œæ¯”å¦‚å¹¿å‘Šï¼Œéå¹¿å‘Š rank int --è¿™æ¬¡æœç´¢ä¸‹å•†å“çš„ä½ç½®ï¼Œæ¯”å¦‚ç¬¬ä¸€ä¸ªå¹¿å‘Šå•†å“å°±æ˜¯1ï¼Œåé¢çš„ä¾æ¬¡2ï¼Œ3ï¼Œ4...)ROW FORMAT DELIMITED FIELDS TERMINATED BY &#x27;,&#x27;; ä¸šåŠ¡æ–¹çš„å®ç°æ–¹æ³•ï¼š --ä¸šåŠ¡æ–¹çš„å†™æ³•select id, sq, cell_type, rank, if(cell_type!=26,row_number() over(partition by id order by rank),null) naturl_rank from window_test_table order by rank; 2. Window Function Principleselect row_number() over( partition by col1 order by col2 ) from table 2.1 window function partwindowså‡½æ•°éƒ¨åˆ†å°±æ˜¯æ‰€è¦åœ¨çª—å£ä¸Šæ‰§è¡Œçš„å‡½æ•°ï¼Œsparkæ”¯æŒä¸‰ä¸­ç±»å‹çš„çª—å£å‡½æ•°ï¼š No. title example 1. Aggregate functions (èšåˆå‡½æ•°) AVG(), COUNT(), MIN(), MAX(), SUM() 2. Ranking functions (æ’åºå‡½æ•°) RANK(), DENSE_RANK(), ROW_NUMBER(), NTILE() 3. Analytic functions (åˆ†æçª—å£å‡½æ•°) FIRST_VALUE(), LAST_VALUE(), LEAD(), LAG() cume_distå‡½æ•°è®¡ç®—å½“å‰å€¼åœ¨çª—å£ä¸­çš„ç™¾åˆ†ä½æ•° 2.2 window Function å®ç°åŸç†çª—å£å‡½æ•°çš„å®ç°ï¼Œä¸»è¦å€ŸåŠ© Partitioned Table Function ï¼ˆå³PTFï¼‰ï¼› select id, sq, cell_type, rank, row_number() over(partition by id order by rank ) naturl_rank, rank() over(partition by id order by rank) as r, dense_rank() over(partition by cell_type order by id) as dr from window_test_table group by id,sq,cell_type,rank; æ•°æ®æµè½¬å¦‚ä¸‹å›¾ï¼š Reference SQL çª—å£å‡½æ•°çš„ä¼˜åŒ–å’Œæ‰§è¡Œ ã€ç¤¾æ‹›ã€‘å¿«æ‰‹æ•°æ®ä»“åº“é¢è¯•é¢˜æ•´ç† 2020å¹´å¤§å‚é¢è¯•é¢˜-æ•°æ®ä»“åº“ç¯‡ ã€ Spark ã€14. ä¸€æ¬¡ Spark SQL æ€§èƒ½æå‡10å€çš„ç»å† Sparkæ•™ç¨‹-Spark æ€§èƒ½ä¼˜åŒ–â€”â€”å’Œ shuffle ææ–— sparkä¸­çš„spark Shuffleè¯¦è§£1 Spark-SQLæ€§èƒ½ä¼˜åŒ–","categories":[{"name":"data-warehouse","slug":"data-warehouse","permalink":"http://iequa.com/categories/data-warehouse/"}],"tags":[{"name":"SQL","slug":"SQL","permalink":"http://iequa.com/tags/SQL/"},{"name":"data warehouse","slug":"data-warehouse","permalink":"http://iequa.com/tags/data-warehouse/"}]},{"title":"SparkSQL Multidimensional Analysis - Group by","slug":"spark/spark-summary-6-sql-optimization-cube-group-by","date":"2021-02-10T07:28:21.000Z","updated":"2021-06-15T13:37:28.519Z","comments":true,"path":"2021/02/10/spark/spark-summary-6-sql-optimization-cube-group-by/","link":"","permalink":"http://iequa.com/2021/02/10/spark/spark-summary-6-sql-optimization-cube-group-by/","excerpt":"","text":"1. DataFrame From RowSparkSQL - åˆ›å»º DataFrame (Row) from pyspark.sql import Rowsc = spark.sparkContextrdd1 = sc.parallelize([(1, &#x27;dog&#x27;), (2, &#x27;cat&#x27;), (3, &#x27;dog&#x27;), (4, &#x27;pig&#x27;)], 2) pet = rdd1.map(lambda p: Row(id=p[0], name=p[1]))df1 = spark.createDataFrame(pet)df1.show()# +---+----+# | id|name|# +---+----+# | 1| dog|# | 2| cat|# | 3| dog|# | 4| pig|# +---+----+df1.createOrReplaceTempView(&quot;pet&quot;)# SQL can be run over DataFrames that have been registered as a table.pets = spark.sql(&quot;SELECT id, name FROM pet&quot;)# The results of SQL queries are Dataframe objects.# rdd returns the content as an :class:`pyspark.RDD` of :class:`Row`.petNames = pets.rdd.map(lambda p: &quot;Name: &quot; + p.name).collect()for name in petNames: print(name) datasets-and-dataframes 2. count distinct2.1 Hive--ä¼˜åŒ–å‰select count(distinct id) from table_a Hive SQL count(distinct) - optimization --ä¼˜åŒ–åselect count(id)from( select id from table_a group by id) tmp principle of hiveql-select-group-by [hiveql-select-group-by multi-reduce](https://www.wikitechy.com/tutorials/hive/hiveql-select-group-by) > 2.2 SparkSqlSparkSql: sc.parallelize([]), StructType([]), LongType, createDataFrame, createOrReplaceTempView # Import typesfrom pyspark.sql.types import *# Generate comma delimited datastringCSVRDD = sc.parallelize( [ (123, &#x27;Katie&#x27;, 19, &#x27;brown&#x27;), (234, &#x27;Michael&#x27;, 22, &#x27;green&#x27;), (345, &#x27;Simone&#x27;, 23, &#x27;blue&#x27;) ])# Specify schemaschema = StructType( [ StructField(&quot;id&quot;, LongType(), True), StructField(&quot;name&quot;, StringType(), True), StructField(&quot;age&quot;, LongType(), True), StructField(&quot;eyeColor&quot;, StringType(), True) ])# Apply the schema to the RDD and Create DataFrameswimmers = spark.createDataFrame(stringCSVRDD, schema)# Creates a temporary view using the DataFrameswimmers.createOrReplaceTempView(&quot;swimmers&quot;) count(distinct id) - expand spark.sql(&quot;SELECT count(distinct id), count(distinct name) FROM pet&quot;).explain()== Physical Plan ==*(3) HashAggregate(keys=[], functions=[count(if ((gid#245 = 1)) pet.`id`#246L else null), count(if ((gid#245 = 2)) pet.`name`#247 else null)])+- Exchange SinglePartition, true, [id=#510] +- *(2) HashAggregate(keys=[], functions=[partial_count(if ((gid#245 = 1)) pet.`id`#246L else null), partial_count(if ((gid#245 = 2)) pet.`name`#247 else null)]) +- *(2) HashAggregate(keys=[pet.`id`#246L, pet.`name`#247, gid#245], functions=[]) +- Exchange hashpartitioning(pet.`id`#246L, pet.`name`#247, gid#245, 200), true, [id=#505] +- *(1) HashAggregate(keys=[pet.`id`#246L, pet.`name`#247, gid#245], functions=[]) +- *(1) Expand [List(id#222L, null, 1), List(null, name#223, 2)], [pet.`id`#246L, pet.`name`#247, gid#245] +- *(1) Scan ExistingRDD[id#222L,name#223] As see from the execution plan, when dealing with count distinct, the Expand method is used. After expand, use id and name (not id,name) as keys to perform HashAggregate, which is group by, so that it is equivalent to de-duplication. then Calculate count (id) and count (name) directly later, divide and conquer the data. the data skew is alleviated. expand æ–¹å¼é€‚åˆç»´åº¦å°çš„å¤šç»´åˆ†æï¼Œè¿™æ˜¯å› ä¸º expand æ–¹å¼è¯»å–æ•°æ®çš„æ¬¡æ•°åªæœ‰ä¸€æ¬¡ï¼Œä½†æ•°æ®ä¼šè†¨èƒ€nå€ 3. GROUP BY3.1 ROLLUP SELECT factory, SUM( quantity ) FROM production GROUP BY ROLLUP ( factory ) ORDER BY factory SELECT factory, department, SUM(quantity)FROM productionGROUP BY ROLLUP(factory, department)ORDER BY factory å¦‚æœ ROLLUP(A,B,C)åˆ™å…ˆå¯¹ A,B,Cè¿›è¡Œ GROUP BY ï¼Œç„¶åå¯¹ A,Bè¿›è¡ŒGROUP BY,å†å¯¹ A è¿›è¡ŒGROUP BY,æœ€åå¯¹å…¨è¡¨è¿›è¡Œ GROUP BY. 3.2 CUBESELECT factory, department, SUM(quantity)FROM productionGROUP BY CUBE(factory, department)ORDER BY factory,department; å¦‚æœ CUBE(A,B,C)åˆ™å…ˆå¯¹ A,B,C è¿›è¡Œ GROUP BY,ä¹‹åå¯¹ A,B ï¼Œä¹‹åå¯¹A,C ï¼Œä¹‹åå¯¹ B,C ä¹‹åå¯¹ A,ä¹‹åå¯¹ Bï¼Œä¹‹åå¯¹ Cï¼Œæœ€åå¯¹å…¨è¡¨GROUP BY 3.3 GROUPPINGThe GROUPING() function can only be used with ROLLUP and CUBE. GROUPING() receives a column, and returns 0 if this column is not empty, and returns 1 if it is empty. SELECT GROUPING(factory), factory, department, SUM(quantity)FROM productionGROUP BY ROLLUP(factory, department)ORDER BY factory, department; 3.4 GROUPING SETSSELECT factory, department, SUM(quantity)FROM productionGROUP BY GROUPING SETS(factory, department)ORDER BY factory, department 3.5 GROUPING_ID()SELECT factory, department, GROUPING(factory), GROUPING(department), GROUPING_ID(factory,department), SUM(quantity)FROM production GROUP BY CUBE(factory, department) ORDER BY factory, department; With the GROUPING_ID column, we can use the HAVING clause to filter the query results. If you select GROUPING_ID=0, it means that the FACTORY and DEPARTMENT columns are not empty. Reference Hive SQL grouping sets ç”¨æ³• Sparkçš„åˆ†åŒºã€‹ã€ã€Šé€šè¿‡spark.default.parallelismè°ˆSparkå¹¶è¡Œåº¦ã€‹ã€é‡è¦ | Sparkåˆ†åŒºå¹¶è¡Œåº¦å†³å®šæœºåˆ¶ sparkçš„groupping setçš„ä¼˜åŒ– Spark SQL / Catalyst å†…éƒ¨åŸç† ä¸ RBO Sparkæƒå¨æŒ‡å—â€”â€” DataFrame APIç¬”è®° GROUP BYéƒ½ä¸ä¼šï¼ROLLUPï¼ŒCUBEï¼ŒGROUPPINGè¯¦è§£","categories":[{"name":"spark","slug":"spark","permalink":"http://iequa.com/categories/spark/"}],"tags":[{"name":"sparkSQL","slug":"sparkSQL","permalink":"http://iequa.com/tags/sparkSQL/"}]},{"title":"Spark Monitor","slug":"spark/spark-monitor","date":"2021-02-06T07:28:21.000Z","updated":"2021-02-18T23:52:14.847Z","comments":true,"path":"2021/02/06/spark/spark-monitor/","link":"","permalink":"http://iequa.com/2021/02/06/spark/spark-monitor/","excerpt":"","text":"Reference gangliaç›‘æ§çš„æ­å»ºéƒ¨ç½² å‰æ ‡ç­¾ï¼šHadoop+Spark é€šè¿‡Spark Rest æœåŠ¡ç›‘æ§Sparkä»»åŠ¡æ‰§è¡Œæƒ…å†µ sparkä»»åŠ¡ç›‘æ§ sparkTag Sparkè¿è¡ŒçŠ¶æ€çš„ç›‘æ§ æŸ¥çœ‹Sparkä»»åŠ¡çš„è¯¦ç»†ä¿¡æ¯ Monitoring and Instrumentation Sparkï¼ˆå››åä¸ƒï¼‰ï¼šSpark UI æ•°æ®å¯è§†åŒ– Spark2.3(ä¸‰åå…­)ï¼šæ ¹æ®appNameéªŒè¯æŸä¸ªappæ˜¯å¦åœ¨è¿è¡Œ Spark2.2(ä¸‰åä¹)ï¼šå¦‚ä½•æ ¹æ®appNameç›‘æ§sparkä»»åŠ¡,å½“ä»»åŠ¡ä¸å­˜åœ¨åˆ™å¯åŠ¨ï¼ˆä»»åŠ¡å­˜åœ¨å½“è¶…è¿‡å¤šä¹…æ²¡æœ‰æ´»åŠ¨çŠ¶æ€åˆ™killï¼Œç­‰å¾…ä¸‹æ¬¡å¯åŠ¨ï¼‰ Spark2.3ï¼ˆå››åï¼‰ï¼šå¦‚ä½•ä½¿ç”¨javaé€šè¿‡yarn apiè°ƒåº¦spark appï¼Œå¹¶æ ¹æ®appIdç›‘æ§ä»»åŠ¡ï¼Œå…³é—­ä»»åŠ¡ï¼Œè·å–ä»»åŠ¡æ—¥å¿—","categories":[{"name":"spark","slug":"spark","permalink":"http://iequa.com/categories/spark/"}],"tags":[{"name":"sparkSQL","slug":"sparkSQL","permalink":"http://iequa.com/tags/sparkSQL/"}]},{"title":"SparkSQL ä»å…¥é—¨åˆ°è°ƒä¼˜","slug":"spark/spark-summary-5-sql-optimization-indoor","date":"2021-02-03T07:28:21.000Z","updated":"2021-02-15T10:49:22.316Z","comments":true,"path":"2021/02/03/spark/spark-summary-5-sql-optimization-indoor/","link":"","permalink":"http://iequa.com/2021/02/03/spark/spark-summary-5-sql-optimization-indoor/","excerpt":"","text":"1. SparkSQL å‘å±•SparkSQL å‘å±•å² Version | Title Description :---: | :--- 1.0ä»¥å‰ | Shark Spark-1.1 | SparkSQL(åªæ˜¯æµ‹è¯•æ€§çš„) SQL Spark é»˜è®¤æƒ…å†µä¸‹ä¿å­˜æ•°æ®åˆ° HDFS çš„æ•°æ®æ ¼å¼ï¼š .snappy.parquet > .snappyï¼š ç»“æœä¿å­˜åˆ° HDFS ä¸Šçš„æ—¶å€™è‡ªåŠ¨å‹ç¼©ï¼š å‹ç¼©ç®—æ³•ï¼š snappy > .parquetï¼š ç»“æœä½¿ç”¨ä¸€ç§åˆ—å¼æ–‡ä»¶å­˜å‚¨æ ¼å¼ä¿å­˜ > parquet / rc / orc / row column df = spark.read.load(&quot;examples/src/main/resources/users.parquet&quot;)df.select(&quot;name&quot;, &quot;favorite_color&quot;).write.save(&quot;namesAndFavColors.parquet&quot;)# parquet file é»˜è®¤æ˜¯è¿™ç§æ–‡ä»¶æ–¹å¼ load ä¸¾ä¸ªğŸŒ°: spark å®‰è£…è·¯å¾„ examples/src/main/resources : # /usr/local/xsoft/spark/examples/src/main/resources [23:06:36]âœ lltotal 88drwxr-xr-x@ 5 blair staff 160B Jun 6 21:34 dir1-rw-r--r--@ 1 blair staff 130B Jun 6 21:34 employees.json-rw-r--r--@ 1 blair staff 240B Jun 6 21:34 full_user.avsc-rw-r--r--@ 1 blair staff 5.7K Jun 6 21:34 kv1.txt-rw-r--r--@ 1 blair staff 49B Jun 6 21:34 people.csv-rw-r--r--@ 1 blair staff 73B Jun 6 21:34 people.json-rw-r--r--@ 1 blair staff 32B Jun 6 21:34 people.txt-rw-r--r--@ 1 blair staff 185B Jun 6 21:34 user.avsc-rw-r--r--@ 1 blair staff 334B Jun 6 21:34 users.avro-rw-r--r--@ 1 blair staff 547B Jun 6 21:34 users.orc-rw-r--r--@ 1 blair staff 615B Jun 6 21:34 users.parquet 3. SparkSQL è°ƒä¼˜ No. Title Author Link 0. åä¸ºå¼€å‘è€…SparkCoreçŸ¥ä¹å¤§æ•°æ®SparkSQL å¼€å‘è€…æŒ‡å— &gt; ç»„ä»¶æˆåŠŸæ¡ˆä¾‹ &gt; Spark &gt; æ¡ˆä¾‹10ï¼šSpark Coreè°ƒä¼˜ &gt; ç»éªŒæ€»ç»“ SparkåŸºç¡€ï¼šSpark SQLè°ƒä¼˜ 1. Cache ç¼“å­˜ &nbsp;&nbsp;1.1 spark.catalog.cacheTable(â€œtâ€) æˆ– df.cache() &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Spark SQLä¼šæŠŠéœ€è¦çš„åˆ—å‹ç¼©åç¼“å­˜ï¼Œé¿å…ä½¿ç”¨å’ŒGCçš„å‹åŠ›&nbsp;&nbsp;1.2 spark.sql.inMemoryColumnarStorage.compressed é»˜è®¤true &nbsp;&nbsp;1.3 spark.sql.inMemoryColumnarStorage.batchSize é»˜è®¤10000 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; æ§åˆ¶åˆ—ç¼“å­˜æ—¶çš„æ•°é‡ï¼Œé¿å…OOMé£é™©ã€‚ å¼•ç”³è¦ç‚¹ï¼š è¡Œå¼å­˜å‚¨ &amp; åˆ—å¼å­˜å‚¨ ä¼˜ç¼ºç‚¹ 2. å…¶ä»–é…ç½® &nbsp;&nbsp;2.1 spark.sql.autoBroadcastJoinThreshold &nbsp;&nbsp;2.2 spark.sql.shuffle.partitions é»˜è®¤200ï¼Œé…ç½®joinå’Œaggçš„æ—¶å€™çš„åˆ†åŒºæ•° &nbsp;&nbsp;2.3 spark.sql.broadcastTimeout é»˜è®¤300ç§’ï¼Œå¹¿æ’­joinæ—¶å¹¿æ’­ç­‰å¾…çš„æ—¶é—´ &nbsp;&nbsp;2.4 spark.sql.files.maxPartitionBytes é»˜è®¤128MBï¼Œå•ä¸ªåˆ†åŒºè¯»å–çš„æœ€å¤§æ–‡ä»¶å¤§å°&nbsp;&nbsp;2.5 spark.sql.files.openCostInBytes parquet.block.size3. å¹¿æ’­ hash join - BHJ &nbsp;&nbsp; 3.1 å½“ç³»ç»Ÿ spark.sql.autoBroadcastJoinThreshold åˆ¤æ–­æ»¡è¶³æ¡ä»¶ï¼Œä¼šè‡ªåŠ¨ä½¿ç”¨BHJ åä¸ºäº‘Stackå…¨æ™¯å›¾ &gt; å¼€å‘è€…æŒ‡å— &gt; SQLå’ŒDataFrameè°ƒä¼˜ &gt; Spark SQL joinä¼˜åŒ– sparkä¸ä¼š æ³¨æ„sparkä¸ä¼šç¡®ä¿æ¯æ¬¡é€‰æ‹©å¹¿æ’­è¡¨éƒ½æ˜¯æ­£ç¡®çš„ï¼Œå› ä¸ºæœ‰çš„åœºæ™¯æ¯”å¦‚ full outer join æ˜¯ä¸æ”¯æŒBHJçš„ã€‚æ‰‹åŠ¨æŒ‡å®šå¹¿æ’­: broadcast(spark.table(\"src\")).join(spark.table(\"records\"), \"key\").show() 1. Sparkå­¦ä¹ æŠ€å·§ Spark SQLä»å…¥é—¨åˆ°ç²¾é€š Data Sourceï¼š json, parquet, jdbc, orc, libsvm, csv, text, Hive è¡¨ 3. SparkSQLè¦æ‡‚çš„ Spark SQLåœ¨Sparké›†ç¾¤ä¸­æ˜¯å¦‚ä½•æ‰§è¡Œçš„ï¼Ÿ 1. Spark SQL è½¬æ¢ä¸ºé€»è¾‘æ‰§è¡Œè®¡åˆ’ 2. Catalyst Optimizerç»„ä»¶ï¼Œå°†é€»è¾‘æ‰§è¡Œè®¡åˆ’è½¬æ¢ä¸ºOptimizedé€»è¾‘æ‰§è¡Œè®¡åˆ’ 3. å°†Optimizedé€»è¾‘æ‰§è¡Œè®¡åˆ’è½¬æ¢ä¸ºç‰©ç†æ‰§è¡Œè®¡åˆ’ 4. Code Generationå¯¹ç‰©ç†æ‰§è¡Œè®¡åˆ’è¿›ä¸€æ­¥ä¼˜åŒ–ï¼Œå°†ä¸€äº›(éshuffle)æ“ä½œä¸²è”åœ¨ä¸€èµ· 5. ç”ŸæˆJobï¼ˆDAGï¼‰ç”±schedulerè°ƒåº¦åˆ°spark executorsä¸­æ‰§è¡Œ é€»è¾‘æ‰§è¡Œè®¡åˆ’å’Œç‰©ç†æ‰§è¡Œè®¡åˆ’çš„åŒºåˆ«ï¼Ÿ 1. é€»è¾‘æ‰§è¡Œè®¡åˆ’åªæ˜¯å¯¹SQLè¯­å¥ä¸­ä»¥ä»€ä¹ˆæ ·çš„æ‰§è¡Œé¡ºåºåšä¸€ä¸ªæ•´ä½“æè¿°.2. ç‰©ç†æ‰§è¡Œè®¡åˆ’åŒ…å«å…·ä½“ä»€ä¹ˆæ“ä½œ. ä¾‹å¦‚ï¼šæ˜¯BroadcastJoinã€è¿˜æ˜¯SortMergeJoin.. 4. SparkSQLä¼˜åŒ–) 1. spark.sql.codegen=false/true æ¯æ¡æŸ¥è¯¢çš„è¯­å¥åœ¨è¿è¡Œæ—¶ç¼–è¯‘ä¸ºjavaçš„äºŒè¿›åˆ¶ä»£ç  2. spark.sql.inMemoryColumnStorage.compressed é»˜è®¤false å†…å­˜åˆ—å¼å­˜å‚¨å‹ç¼©3. spark.sql.inMemoryColumnStorage.batchSize = 1000 4. spark.sql.parquet.compressed.codec é»˜è®¤snappy, (uncompressed/gzip/lzo) 5. spark.catalog.cacheTable(â€œtableNameâ€) æˆ– dataFrame.cache() 6. â€”conf â€œspark.sql.autoBroadcastJoinThreshold = 50485760â€ 10 MB -&gt; 50M 7. â€”conf â€œspark.sql.shuffle.partitions=200â€ -&gt; 2000 5. SparkSQLè°ƒä¼˜ http://marsishandsome.github.io/SparkSQL-Internal/03-performance-turning/ 1. å¯¹äºæ•°æ®å€¾æ–œï¼Œé‡‡ç”¨åŠ å…¥éƒ¨åˆ†ä¸­é—´æ­¥éª¤ï¼Œå¦‚èšåˆåcacheï¼Œå…·ä½“æƒ…å†µå…·ä½“åˆ†æï¼›2. é€‚å½“çš„ä½¿ç”¨åºåŒ–æ–¹æ¡ˆä»¥åŠå‹ç¼©æ–¹æ¡ˆï¼› 3. å–„äºè§£å†³é‡ç‚¹çŸ›ç›¾ï¼Œå¤šè§‚å¯ŸStageä¸­çš„Taskï¼ŒæŸ¥çœ‹æœ€è€—æ—¶çš„Taskï¼ŒæŸ¥æ‰¾åŸå› å¹¶æ”¹å–„ï¼› 4. å¯¹äºjoinæ“ä½œï¼Œä¼˜å…ˆç¼“å­˜è¾ƒå°çš„è¡¨ï¼›5. è¦å¤šæ³¨æ„Stageçš„ç›‘æ§ï¼Œå¤šæ€è€ƒå¦‚ä½•æ‰èƒ½æ›´å¤šçš„Taskä½¿ç”¨PROCESS_LOCALï¼› 6. è¦å¤šæ³¨æ„Storageçš„ç›‘æ§ï¼Œå¤šæ€è€ƒå¦‚ä½•æ‰èƒ½Fraction cachedçš„æ¯”ä¾‹æ›´å¤š 1.1 åŸºæœ¬æ“ä½œval df = spark.read.json(â€œfile:///opt/meitu/bigdata/src/main/data/people.jsonâ€)df.show()import spark.implicits._df.printSchema()df.select(&quot;name&quot;).show()df.select($&quot;name&quot;, $&quot;age&quot; + 1).show()df.filter($&quot;age&quot; &gt; 21).show()df.groupBy(&quot;age&quot;).count().show()spark.stop() ç¼–ç  // spark2+, SparkSessionval spark = SparkSession.builder() .config(sparkConf).getOrCreate()//ä½¿ç”¨hiveå…ƒæ•°æ®val spark = SparkSession.builder() .config(sparkConf).enableHiveSupport().getOrCreate()spark.sql(&quot;select count(*) from student&quot;).show() ä½¿ç”¨ createOrReplaceTempView val df =spark.read.json(&quot;examples/src/main/resources/people.json&quot;) df.createOrReplaceTempView(&quot;people&quot;) spark.sql(&quot;SELECT * FROM people&quot;).show() 4. SparkSQL è¿è¡Œè¿‡ç¨‹5. Catalyst Apache Spark RDD vs DataFrame vs DataSet No. Link 0. ã€å¤§æ•°æ®ã€‘SparkSqlè¿æ¥æŸ¥è¯¢ä¸­çš„è°“è¯ä¸‹æ¨å¤„ç†(ä¸€) 0. ä½¿ç”¨explainåˆ†æSpark SQLä¸­çš„è°“è¯ä¸‹æ¨ï¼Œåˆ—è£å‰ªï¼Œæ˜ å°„ä¸‹æ¨ 1. SparkSQL â€“ ä»0åˆ°1è®¤è¯†Catalystï¼ˆè½¬è½½ï¼‰ æ·±å…¥ç ”ç©¶Spark SQLçš„Catalystä¼˜åŒ–å™¨ï¼ˆåŸåˆ›ç¿»è¯‘ï¼‰ 2. Spark SQL Catalystä¼˜åŒ–å™¨ 3. ã€æ•°æ®åº“å†…æ ¸ã€‘åŸºäºè§„åˆ™ä¼˜åŒ–ä¹‹è°“è¯ä¸‹æ¨ Reference No. Link 1. W3C School - Spark RDD æ“ä½œ 2. W3C School - Spark RDDæŒä¹…åŒ– 3. W3C School - Spark SQLæ€§èƒ½è°ƒä¼˜ è®°å½•ä¸€æ¬¡spark sqlçš„ä¼˜åŒ–è¿‡ç¨‹ good - spark å†…å­˜æº¢å‡ºå¤„ç† good - sparkå†…å­˜æº¢å‡ºåŠå…¶è§£å†³æ–¹æ¡ˆ SparkSQLè§£å†³æ•°æ®å€¾æ–œå®æˆ˜ä»‹ç»(é€‚ç”¨äºHiveSQL) ä¼˜åŒ–Sparkä¸­çš„æ•°æ®å€¾æ–œ sparkåäº¿æ•°æ®joinä¼˜åŒ– Apache Spark åœ¨eBay çš„ä¼˜åŒ– å­—èŠ‚è·³åŠ¨åœ¨Spark SQLä¸Šçš„æ ¸å¿ƒä¼˜åŒ–å®è·µ | å­—èŠ‚è·³åŠ¨æŠ€æœ¯æ²™é¾™ Apache Sparkæºç èµ°è¯»ä¹‹11 â€” sqlçš„è§£æä¸æ‰§è¡Œ èƒŒå„ç§SparkSQLè°ƒä¼˜å‚æ•°ï¼Ÿè¿™ä¸ªä¸œè¥¿æ‰æ˜¯SparkSQLå¿…é¡»è¦æ‡‚çš„ SparkSQLæ€§èƒ½è°ƒä¼˜ ä¸€äº›å¸¸ç”¨çš„Spark SQLè°ƒä¼˜æŠ€å·§ SparkSQLè°ƒä¼˜ SparkåŸºç¡€ï¼šSpark SQLè°ƒä¼˜ spark-sqlè°ƒä¼˜æŠ€å·§ - sparkSQLçš„å‰ä¸–ä»Šç”Ÿ èŠèŠspark-submitçš„å‡ ä¸ªæœ‰ç”¨é€‰é¡¹","categories":[{"name":"spark","slug":"spark","permalink":"http://iequa.com/categories/spark/"}],"tags":[{"name":"sparkSQL","slug":"sparkSQL","permalink":"http://iequa.com/tags/sparkSQL/"}]},{"title":"çŒ´å­çš„å›¾è§£SQL å­¦ä¹ ç¬”è®°","slug":"dataware/SQL-Monkey","date":"2021-02-01T01:07:21.000Z","updated":"2021-04-11T14:33:50.494Z","comments":true,"path":"2021/02/01/dataware/SQL-Monkey/","link":"","permalink":"http://iequa.com/2021/02/01/dataware/SQL-Monkey/","excerpt":"","text":"SQL çš„ä¹¦å†™è§„åˆ™æ˜¯ä»€ä¹ˆï¼Ÿ å¦‚ä½•æŒ‡å®šæŸ¥è¯¢æ¡ä»¶ï¼Ÿ SQL æ˜¯å¦‚ä½•è¿è¡Œçš„ï¼Ÿ å­¦ç”Ÿè¡¨ï¼šstudent(å­¦å·,å­¦ç”Ÿå§“å,å‡ºç”Ÿå¹´æœˆ,æ€§åˆ«) æˆç»©è¡¨ï¼šscore(å­¦å·,è¯¾ç¨‹å·,æˆç»©) è¯¾ç¨‹è¡¨ï¼šcourse(è¯¾ç¨‹å·,è¯¾ç¨‹åç§°,æ•™å¸ˆå·) æ•™å¸ˆè¡¨ï¼šteacher(æ•™å¸ˆå·,æ•™å¸ˆå§“å) RAND() Function 0 &lt;= ret &lt; 1 1~100 -&gt; SELECT FLOOR(1 + (RAND() * 100)) LIMIT 10; IF(expr1,expr2,expr3) SELECT CustomerName, CONCAT(â€œH1â€, â€œ H2 â€œ, RAND()),CONCAT(Address, â€œ â€œ, PostalCode, â€œ â€œ, City) AS Address FROM Customers; #SQL å¦‚ä½•æŸ¥è¯¢å…³äºã€è¿ç»­å‡ å¤©ã€‘çš„é—®é¢˜ SELECT id, created_at, CURDATE( ), -- 2021-03-18 DATE(created_at), -- 2019-11-21 DATE(created_at) - 1 -- 20191120FROM users LIMIT 5;SELECT user_id, MAX( count_date_on ) FROM ( ( SELECT user_id, count( date_on ) count_date_on FROM ( SELECT user_id, date, row_number ( ) over ( PARTITION BY USER ORDER BY date DESC ) rnk, date - ( MAX( date ) - rnk ) date_on FROM TB GROUP BY user_id ) A GROUP BY user_id, date_on ) ) B GROUP BY user_id 1. SQLï¼šæŸ¥æ‰¾é‡å¤æ•°æ®ï¼ŸçŸ¥è¯†: group by åˆ—å having count(åˆ—å) &gt; n ä¸¾ä¸€åä¸‰: æŸ¥è¯¢å¹³å‡æˆç»©å¤§äº60åˆ†çš„å­¦ç”Ÿçš„å­¦å·å’Œå¹³å‡æˆç»© select å­¦å· ,avg(æˆç»©) from score group by å­¦å· having avg(æˆç»© ) &gt;60 æŸ¥è¯¢å„å­¦ç”Ÿçš„å¹´é¾„ï¼ˆç²¾ç¡®åˆ°æœˆä»½ï¼‰ /*ã€çŸ¥è¯†ç‚¹ã€‘æ—¶é—´æ ¼å¼è½¬åŒ– timestampdiff*/select å­¦å· ,timestampdiff(month ,å‡ºç”Ÿæ—¥æœŸ ,now())/12 from student ; 2. SQLï¼šå¦‚ä½•æŸ¥æ‰¾ç¬¬Né«˜çš„æ•°æ®ï¼Ÿselect ifNull( (select distinct salary from Employee order by Salary Desc limit 1,1), null ) as SecondHighestSalary; çŸ¥è¯†: limit 1,n 3. SQLï¼šæŸ¥æ‰¾ä¸åœ¨è¡¨é‡Œçš„æ•°æ® select a.Name as Customersfrom Customers as a left join Orders as bon a.Id=b.CustomerIdwhere b.CustomerId is null; 4. SQLï¼šä½ æœ‰å¤šä¹…æ²¡æ¶¨è¿‡å·¥èµ„äº†ï¼Ÿ 5. SQLï¼šå¦‚ä½•æ¯”è¾ƒæ—¥æœŸæ•°æ®ï¼Ÿ ä¸¾ä¸€åä¸‰ï¼š Weather select a.ID, a.datefrom weather as a cross join weather as b on timestampdiff(day, a.date, b.date) = -1where a.temp &gt; b.temp; 6. DiDi: å¦‚ä½•æ‰¾å‡ºæœ€å°çš„Nä¸ªæ•°ï¼Ÿ1.ç­›é€‰å‡º2017å¹´å…¥å­¦çš„â€œè®¡ç®—æœºâ€ä¸“ä¸šå¹´é¾„æœ€å°çš„3ä½åŒå­¦åå•ï¼ˆå§“åã€å¹´é¾„ï¼‰2.ç»Ÿè®¡æ¯ä¸ªç­åŒå­¦å„ç§‘æˆç»©å¹³å‡åˆ†å¤§äº80åˆ†çš„äººæ•°å’Œäººæ•°å æ¯” è€ƒç‚¹: 1.ä½¿ç”¨é€»è¾‘æ ‘åˆ†ææ–¹æ³•å°†å¤æ‚é—®é¢˜å˜æˆç®€å•é—®é¢˜çš„èƒ½åŠ›2.å½“é‡åˆ°â€œæ¯ä¸ªâ€é—®é¢˜çš„æ—¶å€™ï¼Œè¦æƒ³åˆ°ç”¨åˆ†ç»„æ±‡æ€»3.æŸ¥è¯¢æœ€å°nä¸ªæ•°æ®çš„é—®é¢˜ï¼šå…ˆæ’åºï¼ˆorder byï¼‰ï¼Œç„¶åä½¿ç”¨limitå–å‡ºå‰nè¡Œæ•°æ®4.é‡åˆ°æœ‰ç­›é€‰æ¡ä»¶çš„ç»Ÿè®¡æ•°é‡é—®é¢˜æ—¶ï¼Œä½¿ç”¨caseè¡¨è¾¾å¼ç­›é€‰å‡ºç¬¦åˆæ¡ä»¶çš„è¡Œä¸º1ï¼Œå¦åˆ™ä¸º0ã€‚ç„¶åç”¨æ±‡æ€»å‡½æ•°ï¼ˆsumï¼‰å¯¹caseè¡¨è¾¾å¼è¾“å‡ºåˆ—æ±‚å’Œã€‚ 7. æ‹¼å¤•å¤•ï¼šè¿ç»­å‡ºç°Næ¬¡çš„å†…å®¹ï¼Ÿæ–¹æ³•1ï¼š è‡ªè¿æ¥SELECT *FROM Score AS a, Score AS b, Score AS cWHERE a.s_id = b.s_id - 1 AND b.s_id = c.s_id - 1 AND a.s_score = b.s_score AND b.s_score = c.s_score; SELECT DISTINCT a.s_score as æœ€ç»ˆç­”æ¡ˆFROM Score AS a, Score AS b, Score AS cWHERE a.s_id = b.s_id - 1 AND b.s_id = c.s_id - 1 AND a.s_score = b.s_score AND b.s_score = c.s_score; æ–¹æ³•2ï¼š window functionSELECT DISTINCT çƒå‘˜å§“å FROM ( SELECT çƒå‘˜å§“å, lead ( çƒå‘˜å§“å, 1 ) over ( PARTITION BY çƒé˜Ÿ ORDER BY å¾—åˆ†æ—¶é—´ ) AS å§“å1, lead ( çƒå‘˜å§“å, 2 ) over ( PARTITION BY çƒé˜Ÿ ORDER BY å¾—åˆ†æ—¶é—´ ) AS å§“å2 FROM åˆ†æ•°è¡¨ ) AS a WHERE ( a.çƒå‘˜å§“å = a.å§“å1 AND a.çƒå‘˜å§“å = a.å§“å2 ); 10. SQLï¼šç»å…¸topNé—®é¢˜select *from ( select *, row_number() over (partition by å§“å order by æˆç»© desc) as ranking from æˆç»©è¡¨) as awhere ranking &lt;=2 11. é“¾å®¶ï¼šå¦‚ä½•åˆ†æç•™å­˜ç‡ï¼Ÿinput: æŒ‡æ ‡å®šä¹‰ï¼š æŸæ—¥æ´»è·ƒç”¨æˆ·æ•°ï¼ŒæŸæ—¥æ´»è·ƒçš„å»é‡ç”¨æˆ·æ•°ã€‚ Næ—¥æ´»è·ƒç”¨æˆ·æ•°ï¼ŒæŸæ—¥æ´»è·ƒçš„ç”¨æˆ·æ•°åœ¨ä¹‹åçš„ç¬¬Næ—¥æ´»è·ƒç”¨æˆ·æ•°ã€‚ Næ—¥æ´»è·ƒç•™å­˜ç‡ï¼ŒNæ—¥ç•™å­˜ç”¨æˆ·æ•°/æŸæ—¥æ´»è·ƒç”¨æˆ·æ•° ä¾‹ï¼šç™»é™†æ—¶é—´ï¼ˆ20180501æ—¥ï¼‰å»é‡ç”¨æˆ·æ•°10000ï¼Œè¿™æ‰¹ç”¨æˆ·åœ¨20180503æ—¥ä»æœ‰7000äººæ´»è·ƒï¼Œåˆ™3æ—¥æ´»è·ƒç•™å­˜ç‡ä¸º7000/10000=70% 11.1 æ´»è·ƒç”¨æˆ·æ•°å¯¹åº”çš„æ—¥æœŸ SELECT ç™»é™†æ—¶é—´, count( DISTINCT ç”¨æˆ·id ) AS æ´»è·ƒç”¨æˆ·æ•° FROM ç”¨æˆ·è¡Œä¸ºä¿¡æ¯è¡¨ WHERE åº”ç”¨åç§° = &#x27;ç›¸æœº&#x27; GROUP BY ç™»é™†æ—¶é—´; 11.2 æ¬¡æ—¥ç•™å­˜ç”¨æˆ·æ•° æ¬¡æ—¥ç•™å­˜ç”¨æˆ·æ•°ï¼šåœ¨ä»Šæ—¥ç™»å½•ï¼Œæ˜å¤©ä¹Ÿæœ‰ç™»å½•çš„ç”¨æˆ·æ•°ã€‚ä¹Ÿå°±æ˜¯æ—¶é—´é—´éš”=1 ä¸€ä¸ªè¡¨å¦‚æœæ¶‰åŠåˆ°æ—¶é—´é—´éš”ï¼Œå°±éœ€è¦ç”¨åˆ°è‡ªè”ç»“ï¼Œä¹Ÿå°±æ˜¯å°†ä¸¤ä¸ªç›¸åŒçš„è¡¨è¿›è¡Œè”ç»“ SELECT *, count(DISTINCT CASE WHEN æ—¶é—´é—´éš” = 1 THEN ç”¨æˆ·id ELSE NULL END) AS æ¬¡æ—¥ç•™å­˜æ•° FROM (SELECT *, timestampdiff(DAY, a_t, b_t ) AS æ—¶é—´é—´éš” FROM c) GROUP BY a_t; 11.3 ä¸‰æ—¥çš„ç•™å­˜æ•°/ç•™å­˜ç‡ select a_t, count(distinct ç”¨æˆ·id) as æ´»è·ƒç”¨æˆ·æ•°, count(distinct case when æ—¶é—´é—´éš”=1 then ç”¨æˆ·id else null end) as æ¬¡æ—¥ç•™å­˜æ•°, count(distinct case when æ—¶é—´é—´éš”=1 then ç”¨æˆ·id else null end)/ count(distinct ç”¨æˆ·id) as æ¬¡æ—¥ç•™å­˜ç‡, count(distinct case when æ—¶é—´é—´éš”=3 then ç”¨æˆ·id else null end) as ä¸‰æ—¥ç•™å­˜æ•°, count(distinct case when æ—¶é—´é—´éš”=3 then ç”¨æˆ·id else null end)/ count(distinct ç”¨æˆ·id) as ä¸‰æ—¥ç•™å­˜ç‡, count(distinct case when æ—¶é—´é—´éš”=7 then ç”¨æˆ·id else null end) as ä¸ƒæ—¥ç•™å­˜æ•°, count(distinct case when æ—¶é—´é—´éš”=7 then ç”¨æˆ·id else null end)/ count(distinct ç”¨æˆ·id) as ä¸ƒæ—¥ç•™å­˜ç‡from ( SELECT c.ç”¨æˆ·id, timestampdiff(day, c.a_t, c.b_t) as æ—¶é—´é—´éš” FROM ( SELECT a.ç”¨æˆ·id, a.ç™»é™†æ—¶é—´ as a_t, b.ç™»é™†æ—¶é—´ as b_t FROM ç”¨æˆ·è¡Œä¸ºä¿¡æ¯è¡¨ as a left join ç”¨æˆ·è¡Œä¸ºä¿¡æ¯è¡¨ as b on a.ç”¨æˆ·id = b.ç”¨æˆ·id where a.åº”ç”¨åç§°= &#x27;ç›¸æœº&#x27; ) as c ) as dgroup by a_t; 11.4 æœ¬é¢˜è€ƒç‚¹ å¸¸ç”¨æŒ‡æ ‡çš„ç†è§£ï¼Œä¾‹å¦‚ç•™å­˜ç”¨æˆ·æ•°ã€ç•™å­˜ç‡ã€‚ çµæ´»ä½¿ç”¨caseæ¥ç»Ÿè®¡when å‡½æ•°ä¸group by è¿›è¡Œè‡ªå®šä¹‰åˆ—è”è¡¨ç»Ÿè®¡ã€‚ é‡åˆ°åªæœ‰ä¸€ä¸ªè¡¨ï¼Œä½†æ˜¯éœ€è¦è®¡æ•°æ—¶é—´é—´éš”çš„é—®é¢˜ï¼Œå°±è¦æƒ³åˆ°ç”¨è‡ªè”ç»“æ¥æ±‚æ—¶é—´é—´éš”ï¼Œç±»ä¼¼çš„æœ‰æ‰¾å‡ºè¿ç»­å‡ºç°Næ¬¡çš„å†…å®¹ã€æ»´æ»´2020æ±‚èŒçœŸé¢˜ã€‚ 12. å¦‚ä½•åˆ†æç”¨æˆ·æ»¡æ„åº¦ï¼Ÿâ€œæ»¡æ„åº¦è¡¨â€è®°å½•äº†æ•™å¸ˆå’Œå­¦ç”Ÿå¯¹è¯¾ç¨‹çš„æ»¡æ„ç¨‹åº¦ã€‚â€œæ˜¯å¦æ»¡æ„â€åˆ—é‡Œæ˜¯è€å¸ˆå’Œå­¦ç”Ÿå¯¹è¯¾ç¨‹çš„è¯„ä»·ï¼Œå…¶ä¸­â€œæ˜¯â€è¡¨ç¤ºæ•™å¸ˆå’Œå­¦ç”Ÿéƒ½æ»¡æ„ã€‚ â€œ ç”¨æˆ·è¡¨â€è®°å½•äº†å­¦æ ¡æ•™å¸ˆå’Œå­¦ç”Ÿçš„ä¿¡æ¯ã€‚æ¯ä¸ªç”¨æˆ·æœ‰å”¯ä¸€é”® â€œç¼–å·â€ï¼Œâ€œæ˜¯å¦åœ¨ç³»ç»Ÿâ€è¡¨ç¤ºè¿™ä¸ªç”¨æˆ·æ˜¯å¦è¿˜åœ¨è¿™æ‰€å­¦æ ¡é‡Œï¼Œâ€œè§’è‰²â€è¡¨ç¤ºè¿™ä¸ªäººæ˜¯å­¦ç”Ÿè¿˜æ˜¯æ•™å¸ˆã€‚ ä¸¤ä¸ªè¡¨çš„å…³ç³»ï¼šæ»¡æ„åº¦è¡¨çš„â€œå­¦ç”Ÿç¼–å·â€ ã€ â€œæ•™å¸ˆç¼–å·â€ å’Œç”¨æˆ·è¡¨çš„ â€œç¼–å·â€ è”ç»“ã€‚ ç°åœ¨éœ€è¦åˆ†æå‡ºå­¦æ ¡é‡Œäººå‘˜å¯¹è¯¾ç¨‹çš„æ»¡æ„åº¦ã€‚æ»¡æ„åº¦çš„è®¡ç®—æ–¹å¼å¦‚ä¸‹ï¼š (æ•™å¸ˆå’Œå­¦ç”Ÿå¯¹è¯¾ç¨‹éƒ½æ»¡æ„ä¸”å·²å­˜åœ¨å½“å‰æ•™åŠ¡ç³»ç»Ÿä¸­çš„ç”¨æˆ·) / (åœ¨å­¦æ ¡é‡Œçš„äººæ•°) select sum(case when æ»¡æ„åº¦è¡¨.æ˜¯å¦æ»¡æ„=&#x27;æ˜¯&#x27; then 1 else 0 end)/count(æ»¡æ„åº¦è¡¨.æ˜¯å¦æ»¡æ„) as æ»¡æ„åº¦from æ»¡æ„åº¦è¡¨ left join (select ç¼–å· from ç”¨æˆ·è¡¨ where æ˜¯å¦åœ¨ç³»ç»Ÿ=&#x27;æ˜¯&#x27;) as å­¦ç”Ÿon (æ»¡æ„åº¦è¡¨.å­¦ç”Ÿç¼–å· = å­¦ç”Ÿ.ç¼–å·)left join (select ç¼–å· from ç”¨æˆ·è¡¨ where æ˜¯å¦åœ¨ç³»ç»Ÿ=&#x27;æ˜¯&#x27;) as æ•™å¸ˆon (æ»¡æ„åº¦è¡¨.æ•™å¸ˆç¼–å· = æ•™å¸ˆ.ç¼–å·); 14. æ‹¼å¤šå¤šï¼šå¦‚ä½•æŸ¥æ‰¾å‰20%çš„æ•°æ®ï¼Ÿ æŠŠè¿™ä¸ªå¤æ‚çš„é—®é¢˜æ‹†è§£ä¸º3ä¸ªå­é—®é¢˜ï¼š 1ï¼‰æ‰¾å‡ºè®¿é—®æ¬¡æ•°å‰20%çš„ç”¨æˆ·2ï¼‰å‰”é™¤è®¿é—®æ¬¡æ•°å‰20%çš„ç”¨æˆ·3ï¼‰æ¯ç±»ç”¨æˆ·çš„å¹³å‡è®¿é—®æ¬¡æ•° 1.è®¿é—®æ¬¡æ•°å‰20%çš„ç”¨æˆ· æ’åï¼š select *, row_number() over(order by è®¿é—®é‡ desc) as æ’åfrom ç”¨æˆ·è®¿é—®æ¬¡æ•°è¡¨; max(æ’å) * 0.2 select * from (select *, row_number() over(order by è®¿é—®é‡ desc) as æ’å from ç”¨æˆ·è®¿é—®æ¬¡æ•°è¡¨) as awhere æ’å &lt;= (select max(æ’å) from a) * 0.2; 3. æ¯ç±»ç”¨æˆ·çš„å¹³å‡è®¿é—®æ¬¡æ•° select ç”¨æˆ·ç±»å‹,avg(è®¿é—®é‡)from bgroup by ç”¨æˆ·ç±»å‹; 15. SQLï¼šå¦‚ä½•æŸ¥æ‰¾å·¥èµ„å‰ä¸‰é«˜çš„å‘˜å·¥select *, rank() over (order by æˆç»© desc) as ranking, dense_rank() over (order by æˆç»© desc) as dese_rank, row_number() over (order by æˆç»© desc) as row_numfrom ç­çº§; select è¯¾ç¨‹å·,å­¦å·,æˆç»©,æ’å from(select *, dense_rank() over (partition by è¯¾ç¨‹å· order by æˆç»© desc) as æ’åfrom æˆç»©è¡¨) as aawhere æ’å &lt;=3; 17. SQLï¼šå¦‚ä½•åˆ†ç»„æ¯”è¾ƒï¼Ÿselect *from (select *, avg(æˆç»©) over (partition by ç§‘ç›®) as avg_score from æˆç»©è¡¨) as bwhere æˆç»© &gt; avg_score; 18. SQLï¼šå¦‚ä½•åˆ†ææ¸¸æˆï¼Ÿ37. å­—èŠ‚ï¼šä½ çš„å¹³å‡è–ªæ°´æ˜¯å¤šå°‘æŸ¥è¯¢å‡ºæ¯ä¸ªéƒ¨é—¨é™¤å»æœ€é«˜ã€æœ€ä½è–ªæ°´åçš„å¹³å‡è–ªæ°´ï¼Œå¹¶ä¿ç•™æ•´æ•° sqlçš„è¿è¡Œé¡ºåºï¼Œä¼šå…ˆè¿è¡Œfromå’Œwhereå­å¥ï¼Œæœ€åæ‰è¿è¡Œselectå­å¥ã€‚ format(N, D) , N æ˜¯è¦æ ¼å¼åŒ–çš„æ•°å­—ï¼Œ D æ˜¯è¦èˆå…¥çš„å°æ•°ä½æ•° GB SQL Taskï¼ˆ2ï¼‰SQL Task-- write your code in PostgreSQL 9.4SELECT ( SELECT COUNT(*) FROM ( SELECT t2.* FROM ( SELECT t.*, SUM(salary) OVER (ORDER BY salary) AS j_sum_salary FROM candidates t WHERE position = &#x27;junior&#x27; ) t2 CROSS JOIN ( SELECT coalesce(SUM(salary), 0) AS total_salary FROM ( SELECT t1.* FROM ( SELECT t.*, SUM(salary) OVER (ORDER BY salary) AS s_sum_salary FROM candidates t WHERE position = &#x27;senior&#x27; ) t1 WHERE s_sum_salary &lt;= 50000 ) seniors_table ) s WHERE j_sum_salary &lt;= 50000 - s.total_salary ) junior_table ) AS juniors , ( SELECT COUNT(*) FROM ( SELECT t1.* FROM ( SELECT t.*, SUM(salary) OVER (ORDER BY salary) AS s_sum_salary FROM candidates t WHERE position = &#x27;senior&#x27; ) t1 WHERE s_sum_salary &lt;= 50000 ) seniors_table ) AS seniors Reference hiveå¤§å°è¡¨joinä¼˜åŒ–æ€§èƒ½ åˆ†ææœ€è¿‘ä¸ƒå¤©å†…è¿ç»­ä¸‰å¤©æ´»è·ƒç”¨æˆ·æ•° #SQL å¦‚ä½•æŸ¥è¯¢å…³äºã€è¿ç»­å‡ å¤©ã€‘çš„é—®é¢˜ å›¾è§£SQLé¢è¯•é¢˜ï¼šç»å…¸50é¢˜ 7å¼ å›¾å­¦ä¼šSQL å›¾è§£é¢è¯•é¢˜ æ•°æ®ä»“åº“å·¥å…·ç®± ç»´åº¦å»ºæ¨¡æƒå¨æŒ‡å— ç¬¬3ç‰ˆ.pdf","categories":[{"name":"data-warehouse","slug":"data-warehouse","permalink":"http://iequa.com/categories/data-warehouse/"}],"tags":[{"name":"data warehouse","slug":"data-warehouse","permalink":"http://iequa.com/tags/data-warehouse/"}]},{"title":"Spark - Data Skew Advanced","slug":"spark/spark-summary-4-data-skew","date":"2021-01-26T23:07:21.000Z","updated":"2021-02-22T03:33:37.107Z","comments":true,"path":"2021/01/27/spark/spark-summary-4-data-skew/","link":"","permalink":"http://iequa.com/2021/01/27/spark/spark-summary-4-data-skew/","excerpt":"","text":"1. Spark Data SkewFor example, there are a total of 1,000 tasks, 997 tasks are executed within 1 minute, but the remaining two or three tasks take one or two hours. This situation is very common. Most tasks are executed very fast, but some tasks are extremely slow. the progress of the entire Spark job is determined by the task with the longest running time. 2. The principle of Data Skewwhen performing shuffle, the same key on each node must be pulled to a task on a node for processing, such as aggregation or join operations according to the key. For example, most keys correspond to 10 pieces of data, but individual keys correspond to 1 million pieces of data, so most tasks may only be assigned to 10 pieces of data, and then run out in 1 second; but individual tasks may be assigned 1 million pieces The data will run for one or two hours. No. trigger shuffle operations when data skew, it may be caused by using one of these operators. 1. distinct 2. groupByKey 3. reduceByKey 4. aggregateByKey 5. join, cogroup, repartition, etc. 3. The execution of a task slowThe first thing to look at is which stage of data skew occurs in. yarn-client submit, you can see the log locally, find which stage is currently running in the log; yarn-cluster submit, Spark Web UI Run to the first few stages. Whether using the yarn-client mode or the yarn-cluster mode, we can take a deep look at the amount of data allocated by each task of this stage on the Spark Web UI, so as to further determine whether the uneven data allocated by the task causes data skew. After knowing which stage the data skew occurs, then we need to calculate which part of the code corresponds to the stage where the skew occurs based on the principle of stage division. solution: as long as you see a shuffle operator or Spark SQL SQL in the Spark code If there is a statement that will cause shuffle in the statement (such as a group by statement), then it can be determined that the front and the back stage are divided by that place. Word Count val conf = new SparkConf()val sc = new SparkContext(conf) val lines = sc.textFile(&quot;hdfs://...&quot;)val words = lines.flatMap(_.split(&quot; &quot;))val pairs = words.map((_, 1))val wordCounts = pairs.reduceByKey(_ + _) wordCounts.collect().foreach(println(_)) 3.1 stages dividedthe entire code, only one reduceByKey operator will shuffle, the front and back stages will be divided.* stage0, mainly to perform operations from textFile to map, and perform shuffle write operations. 3.2 shuffle writeThe shuffle write operation can be simply understood as partitioning the data in the pairs RDD. In the data processed by each task, the same key will be written to the same disk file.* Stage1 is mainly to perform operations from reduceByKey to collect. 3.3 shuffle readWhen each task of stage1 starts to run, it will first perform shuffle read operation. The task that performs the shuffle read operation will pull those keys that belong to the node where each task of stage 0 is located, and then perform operations such as global aggregation or join on the same key. Here, the value of the key is accumulated. After stage1 executes the reduceByKey operator, it calculates the final wordCounts RDD, and then executes the collect operator to pull all the data to the Driver for us to traverse and print out. 4. data skew - distribution of keys No. View the data distribution of keys that cause data skew 1. If the data skew caused by the group by and join statements in Spark SQL, then query the key distribution of the table used in SQL Happening. 2. If the data skew is caused by the shuffle operator on Spark RDD, you can view the key distribution in the Spark job, such as RDD.countByKey(). Then, collect/take, see the distribution of the keys. For example, Word Count we can first sample 10% of the sample data for pairs, then use the countByKey operator to count the number of occurrences of each key, and finally traverse and print the number of occurrences of each key in the sample data on the client. val sampledPairs = pairs.sample(false, 0.1)val sampledWordCounts = sampledPairs.countByKey()sampledWordCounts.foreach(println(_)) No. solutions of the data skew 1. Improve the parallelism of shuffle operations åœ¨å¯¹RDDæ‰§è¡Œshuffleç®—å­æ—¶ï¼Œç»™shuffleç®—å­ä¼ å…¥ä¸€ä¸ªå‚æ•°ï¼Œæ¯”å¦‚reduceByKey(1000)ï¼Œè¯¥å‚æ•°å°±è®¾ç½®äº†è¿™ä¸ªshuffleç®—å­æ‰§è¡Œæ—¶shuffle read taskçš„æ•°é‡Spark SQLä¸­çš„shuffleç±»è¯­å¥ï¼Œæ¯”å¦‚group byã€joinç­‰ï¼Œéœ€è¦è®¾ç½®ä¸€ä¸ªå‚æ•°ï¼Œå³spark.sql.shuffle.partitionsï¼Œè¯¥å‚æ•°ä»£è¡¨äº†shuffle read taskçš„å¹¶è¡Œåº¦ï¼Œè¯¥å€¼é»˜è®¤æ˜¯200ï¼Œå¯¹äºå¾ˆå¤šåœºæ™¯æ¥è¯´éƒ½æœ‰ç‚¹è¿‡å°ã€‚ Experienceï¼š cannot completely solve the data skewï¼Œsuch as the amount of data a key is 1 million. 2. Two-stage aggregation (local aggregation + global aggregation) disadvantages: only solve aggregate shuffle operations. If it is a shuffle operation of the join class, other solutions have to be used. 3. Convert reduce join to map join advantages: The effect is very good for data skew caused by the join operation, because shuffle and data skew will not happen at all. disadvantages: only suitable for a large table and a small table. After all, we need to broadcast the small table, which consumes more memory resources. The driver and each Executor will have a full amount of data of a small RDD in the memory. If the RDD data we broadcast is relatively large, such as 10G or more, then memory overflow may occur. Therefore, it is not suitable for the situation where both are large tables. import sysimport random from pyspark import SparkContext, SparkConffrom operator import add# sc, random.randint(0,2) # 0 or 1 0r 2 WordCounts reduceByKey More Info... # read data from text file and split each line into wordsinput_file = sc.textFile(&quot;/Users/blair/Desktop/input.txt&quot;, 2)words=input_file.flatMap(lambda line: line.split(&quot; &quot;))# words.collect() # [&#x27;China&#x27;, &#x27;Singapore&#x27;, &#x27;bbb&#x27;, &#x27;Singapore&#x27;, &#x27;hello&#x27;, &#x27;haha&#x27;, &#x27;hello&#x27;, &#x27;world&#x27;] # words.first() # count the occurrence of each wordwordCounts = words.map(lambda word: (f&#x27;&#123;random.randint(0,2)&#125;_&#123;word&#125;&#x27;, 1)).reduceByKey(add)wordCounts.take(10) [('0_Singapore', 3), ('2_bbb', 1), ('0_hello', 1), ('2_haha', 1), ('0_world', 1), ('1_ShangHai', 1), ('0_China', 1), ('2_Singapore', 4), ('1_Singapore', 1), ('2_hello', 1)] words_recover = wordCounts.map(lambda x: (x[0][x[0].find(&#x27;_&#x27;)+1:], x[1]))word_count_ret = words_recover.reduceByKey(add)word_count_ret.take(5) [(&#39;world&#39;, 1), (&#39;ShangHai&#39;, 1), (&#39;China&#39;, 1), (&#39;Singapore&#39;, 8), (&#39;bbb&#39;, 1)] 5. Convert reduce join to map join code: // é¦–å…ˆå°†æ•°æ®é‡æ¯”è¾ƒå°çš„RDDçš„æ•°æ®ï¼Œcollectåˆ°Driverä¸­æ¥ã€‚rdd1Data = rdd1.collect()// ç„¶åä½¿ç”¨Sparkçš„å¹¿æ’­åŠŸèƒ½ï¼Œå°†å°RDDçš„æ•°æ®è½¬æ¢æˆå¹¿æ’­å˜é‡ï¼Œè¿™æ ·æ¯ä¸ªExecutorå°±åªæœ‰ä¸€ä»½RDDçš„æ•°æ®ã€‚// å¯ä»¥å°½å¯èƒ½èŠ‚çœå†…å­˜ç©ºé—´ï¼Œå¹¶ä¸”å‡å°‘ç½‘ç»œä¼ è¾“æ€§èƒ½å¼€é”€ã€‚rdd1DataBroadcast = sc.broadcast(rdd1Data) // å¯¹å¦å¤–ä¸€ä¸ªRDDæ‰§è¡Œmapç±»æ“ä½œï¼Œè€Œä¸å†æ˜¯joinç±»æ“ä½œã€‚JavaPairRDD&lt;String, Tuple2&lt;String, Row&gt;&gt; joinedRdd = rdd2.mapToPair( new PairFunction&lt;Tuple2&lt;Long,String&gt;, String, Tuple2&lt;String, Row&gt;&gt;() &#123; private static final long serialVersionUID = 1L; @Override public Tuple2&lt;String, Tuple2&lt;String, Row&gt;&gt; call(Tuple2&lt;Long, String&gt; tuple) throws Exception &#123; // åœ¨ç®—å­å‡½æ•°ä¸­ï¼Œé€šè¿‡å¹¿æ’­å˜é‡ï¼Œè·å–åˆ°æœ¬åœ°Executorä¸­çš„rdd1æ•°æ®ã€‚ List&lt;Tuple2&lt;Long, Row&gt;&gt; rdd1Data = rdd1DataBroadcast.value(); // å¯ä»¥å°†rdd1çš„æ•°æ®è½¬æ¢ä¸ºä¸€ä¸ªMapï¼Œä¾¿äºåé¢è¿›è¡Œjoinæ“ä½œã€‚ Map&lt;Long, Row&gt; rdd1DataMap = new HashMap&lt;Long, Row&gt;(); for(Tuple2&lt;Long, Row&gt; data : rdd1Data) &#123; rdd1DataMap.put(data._1, data._2); &#125; // è·å–å½“å‰RDDæ•°æ®çš„keyä»¥åŠvalueã€‚ String key = tuple._1; String value = tuple._2; // ä»rdd1æ•°æ®Mapä¸­ï¼Œæ ¹æ®keyè·å–åˆ°å¯ä»¥joinåˆ°çš„æ•°æ®ã€‚ Row rdd1Value = rdd1DataMap.get(key); return new Tuple2&lt;String, String&gt;(key, new Tuple2&lt;String, Row&gt;(value, rdd1Value)); &#125; &#125;); // è¿™é‡Œå¾—æç¤ºä¸€ä¸‹ã€‚// ä¸Šé¢çš„åšæ³•ï¼Œä»…ä»…é€‚ç”¨äºrdd1ä¸­çš„keyæ²¡æœ‰é‡å¤ï¼Œå…¨éƒ¨æ˜¯å”¯ä¸€çš„åœºæ™¯ã€‚// å¦‚æœrdd1ä¸­æœ‰å¤šä¸ªç›¸åŒçš„keyï¼Œé‚£ä¹ˆå°±å¾—ç”¨flatMapç±»çš„æ“ä½œï¼Œåœ¨è¿›è¡Œjoinçš„æ—¶å€™ä¸èƒ½ç”¨mapï¼Œè€Œæ˜¯å¾—éå†rdd1æ‰€æœ‰æ•°æ®è¿›è¡Œjoinã€‚// rdd2ä¸­æ¯æ¡æ•°æ®éƒ½å¯èƒ½ä¼šè¿”å›å¤šæ¡joinåçš„æ•°æ®ã€‚ æ–¹æ¡ˆå®è·µç»éªŒï¼šæ›¾ç»å¼€å‘ä¸€ä¸ªæ•°æ®éœ€æ±‚çš„æ—¶å€™ï¼Œå‘ç°ä¸€ä¸ªjoinå¯¼è‡´äº†æ•°æ®å€¾æ–œã€‚ä¼˜åŒ–ä¹‹å‰ï¼Œä½œä¸šçš„æ‰§è¡Œæ—¶é—´å¤§çº¦æ˜¯60åˆ†é’Ÿå·¦å³ï¼›ä½¿ç”¨è¯¥æ–¹æ¡ˆä¼˜åŒ–ä¹‹åï¼Œæ‰§è¡Œæ—¶é—´ç¼©çŸ­åˆ°10åˆ†é’Ÿå·¦å³ï¼Œæ€§èƒ½æå‡äº†6å€ã€‚ Other Solution 1: Use Hive ETL to preprocess dataOther Solution 2: Filter a few keys that cause skew Reference https://github.com/wwcom614/Spark/blob/master/src/main/scala/com/ww/rdd/performance_optimize/BroadcastMapJoins.scala æ¯ä¸ªSparkå·¥ç¨‹å¸ˆéƒ½åº”è¯¥çŸ¥é“çš„ Sparkçš„äº”ç§JOINç­–ç•¥è§£æ SparkSQLä¸­çš„ä¸‰ç§JoinåŠå…¶å…·ä½“å®ç°ï¼ˆbroadcast joinã€shuffle hash joinå’Œsort merge join Spark Joinâ€”â€”Broadcast Joinã€Shuffle Hash Joinã€Sort Merge Join spark sqlä¼˜åŒ–ï¼šå°è¡¨å¤§è¡¨å…³è”ä¼˜åŒ– &amp; unionæ›¿æ¢or &amp; broadcast join Hiveæ•°ä»“å»ºè¡¨è¯¥é€‰ç”¨ORCè¿˜æ˜¯Parquetï¼Œå‹ç¼©é€‰LZOè¿˜æ˜¯Snappyï¼Ÿ Sparkå®è·µ â€” æ€§èƒ½ä¼˜åŒ–åŸºç¡€ å°šç¡…è°·2021è¿æ–°ç‰ˆå¤§æ•°æ®Sparkä»å…¥é—¨åˆ°ç²¾é€š å°šç¡…è°·å¤§æ•°æ®ç”µå•†æ•°ä»“V3.0ç‰ˆæœ¬æ•™ç¨‹ï¼ˆæ•°æ®ä»“åº“é¡¹ç›®å¼€å‘å®æˆ˜ï¼‰ Spark Sql ä¸ MySql ä½¿ç”¨ group by çš„å·®åˆ«","categories":[{"name":"spark","slug":"spark","permalink":"http://iequa.com/categories/spark/"}],"tags":[{"name":"spark","slug":"spark","permalink":"http://iequa.com/tags/spark/"}]},{"title":"SQL@Leetcode","slug":"dataware/SQL-LC","date":"2021-01-26T01:07:21.000Z","updated":"2021-06-14T05:23:06.605Z","comments":true,"path":"2021/01/26/dataware/SQL-LC/","link":"","permalink":"http://iequa.com/2021/01/26/dataware/SQL-LC/","excerpt":"","text":"SQL Practiceå›¾è§£SQLé¢è¯•é¢˜ï¼šç»å…¸50é¢˜ No. Question Flag 1. 175. Combine Two Tables â 2. 176. Second Highest Salary, ORDER BY, OFFSET, IFNULL(xxx, NULL) SELECT DISTINCT Salary FROM Employee ORDER BY Salary DESC LIMIT 1 OFFSET 1 âœ”ï¸ 3. 177. Nth Highest Salary, CREATE FUNCTION func_name RETURNS INT 6ç§æ–¹æ¡ˆè¯ é‡ŠMySQLé€šç”¨æŸ¥è¯¢ç­–ç•¥, BEGIN RETURN xxx/select END, SET âœ”ï¸ 4. 178. Rank Scores, æ‘˜è¦: ä¸“ç”¨çª—å£å‡½æ•°rank, dense_rank, row_numberæœ‰ä»€ä¹ˆåŒºåˆ«å‘¢ï¼Ÿ ã€Šé€šä¿—æ˜“æ‡‚çš„å­¦ä¼šï¼šSQLçª—å£å‡½æ•°ã€‹ &nbsp;&nbsp; select score, dense_rank() over(order by Score desc) as Ranking from Scores; 5. 180. Consecutive Numbers, &nbsp;&nbsp; l1.Id=l2.Id-1 AND l2.Id=l3.Id-1 AND l1.Num=l2.Num AND l2.Num=l3.Num â 6. 185 Department Top Three Salaries, dense_rank() over (partition by x order by y desc) â 7. 184. Department Highest Salary, (Employee.DepartmentId , Salary) IN â 8. .. .. 9. 196. Delete Duplicate Emails, &nbsp;&nbsp; â€œdeleteâ€ å’Œ â€œ&gt;â€ çš„è§£é‡Šï¼Œæ¨èï¼ â 10. 181. Employees Earning More Than Their Managers, 1. ç¬›å¡å°”ç§¯+WHERE 2. è‡ªè¿æ¥+ON â 11. 1179. Reformat Department Table, CASE WHEN condition1 THEN result1 END 12. 182. Duplicate Emails, ä½¿ç”¨ GROUP BY å’Œ HAVING æ¡ä»¶ â 13. 197. Rising Temperature, JOIN â€¦ ON DATEDIFF(w1.recordDate, w2.recordDate) = 1 14. 601. Human Traffic of Stadium æœª 15. 183. ä»ä¸è®¢è´­çš„å®¢æˆ· NOT IN â 16. 627. Swap Salary å˜æ›´æ€§åˆ«ï¼Œ sex=CASE WHEN sex=&#39;m&#39; THEN &#39;f&#39; ELSE &#39;m&#39; END; â 17. 626. Exchange Seats æ¢åº§ä½, (CASE WHEN MOD(id,2) END) AS id FROM table1, 5 â 627. Swap Salary å˜æ›´æ€§åˆ«UPDATE salarySET sex = CASE WHEN sex=&#x27;m&#x27; THEN &#x27;f&#x27; ELSE &#x27;m&#x27; END;å­¦ä¹ è¦ç‚¹ï¼š SELECT OrderID, Quantity,CASE WHEN Quantity &gt; 30 THEN &#x27;The quantity is greater than 30&#x27; WHEN Quantity = 30 THEN &#x27;The quantity is 30&#x27; ELSE &#x27;The quantity is under 30&#x27;END AS QuantityTextFROM OrderDetails; 626. Exchange Seats æ¢åº§ä½SELECT (CASE WHEN MOD(id, 2) != 0 AND counts != id THEN id + 1 WHEN MOD(id, 2) != 0 AND counts = id THEN id ELSE id - 1 END) AS id, studentFROM seat, (SELECT COUNT(*) AS counts FROM seat) AS seat_countsORDER BY id ASC; DELETE p1 FROM Person p1, Person p2WHERE p1.Email = p2.Email AND p1.Id &gt; p2.Id 176. Second Highest Salary+----+--------+| Id | Salary |+----+--------+| 1 | 100 || 2 | 200 || 3 | 300 |+----+--------+ If there is no second highest salary, then the query should return null. SELECT IFNULL( (SELECT DISTINCT Salary FROM Employee ORDER BY Salary DESC LIMIT 1 OFFSET 1), NULL) AS SecondHighestSalaryå­¦ä¹ è¦ç‚¹ï¼š OFFSET 177. Nth Highest SalaryMYSQL: CREATE FUNCTION CREATE FUNCTION func_name ( [func_parameter] ) //æ‹¬å·æ˜¯å¿…é¡»çš„ï¼Œå‚æ•°æ˜¯å¯é€‰çš„RETURNS type[ characteristic ...] routine_body LIMIT ç”¨æ³•ï¼š mysql&gt; SELECT * FROM orange LIMIT 5; mysql&gt; SELECT * FROM orange LIMIT 0,5; mysql&gt; SELECT * FROM orange LIMIT 10,15; // æ£€ç´¢è®°å½•11-25mysql&gt; SELECT * FROM orange LIMIT 2 OFFSET 3;//æŸ¥è¯¢4-5ä¸¤æ¡è®°å½•mysql&gt; SELECT * FROM orange LIMIT 3,2;mysql&gt; SELECT * FROM orange LIMIT 95,-1; // æ£€ç´¢è®°å½•96-last getNthHighestSalary(N INT) CREATE FUNCTION getNthHighestSalary(N INT) RETURNS INTBEGIN SET N := N-1; // èµ‹å€¼è¯­å¥ N = N-1 RETURN ( # Write your MySQL query statement below. SELECT salary FROM employee GROUP BY salary ORDER BY salary DESC LIMIT N, 1 );END 180. Consecutive NumbersSELECT DISTINCT #l2.*, l1.Num AS ConsecutiveNumsFROM Logs l1, Logs l2, Logs l3WHERE l1.Id = l2.Id - 1 AND l2.Id = l3.Id - 1 AND l1.Num = l2.Num AND l2.Num = l3.Num; 185. Department Top Three Salaries# Write your MySQL query statement belowSELECT t2.Name as Department, t1.Name as Employee, t1.SalaryFROM(SELECT DepartmentId,Name,SalaryFROM ( SELECT *, dense_rank() over (partition by DepartmentId order by Salary desc) as ranking FROM Employee) as aWHERE ranking &lt;= 3) t1JOIN Department t2ON t1.DepartmentId = t2.Id 184. Department Highest SalarySELECT Department.name AS &#x27;Department&#x27;, Employee.name AS &#x27;Employee&#x27;, SalaryFROM Employee JOIN Department ON Employee.DepartmentId = Department.IdWHERE (Employee.DepartmentId , Salary) IN ( SELECT DepartmentId, MAX(Salary) FROM Employee GROUP BY DepartmentId ); 181. Employees Earning More Than Their ManagersSELECT a.NAME AS EmployeeFROM Employee AS a JOIN Employee AS b ON a.ManagerId = b.Id AND a.Salary &gt; b.Salary; 1179. Reformat Department Table# Write your MySQL query statement belowselect id, sum(case month when &#x27;Jan&#x27; then revenue end) as Jan_Revenue, sum(case month when &#x27;Feb&#x27; then revenue end) as Feb_Revenue, sum(case month when &#x27;Mar&#x27; then revenue end) as Mar_Revenue, sum(case month when &#x27;Apr&#x27; then revenue end) as Apr_Revenue, sum(case month when &#x27;May&#x27; then revenue end) as May_Revenue, sum(case month when &#x27;Jun&#x27; then revenue end) as Jun_Revenue, sum(case month when &#x27;Jul&#x27; then revenue end) as Jul_Revenue, sum(case month when &#x27;Aug&#x27; then revenue end) as Aug_Revenue, sum(case month when &#x27;Sep&#x27; then revenue end) as Sep_Revenue, sum(case month when &#x27;Oct&#x27; then revenue end) as Oct_Revenue, sum(case month when &#x27;Nov&#x27; then revenue end) as Nov_Revenue, sum(case month when &#x27;Dec&#x27; then revenue end) as Dec_Revenuefrom Departmentgroup by id CASE WHEN condition1 THEN result1 END CASE WHEN condition1 THEN result1 WHEN condition2 THEN result2 WHEN conditionN THEN resultN ELSE resultEND;SELECT CustomerName, City, CountryFROM CustomersORDER BY(CASE WHEN City IS NULL THEN Country ELSE CityEND);CASE case_value WHEN when_value THEN statement_list [WHEN when_value THEN statement_list] ... [ELSE statement_list]END CASECASE WHEN search_condition THEN statement_list [WHEN search_condition THEN statement_list] ... [ELSE statement_list]END CASE 197. Rising TemperatureSELECT w1.id AS &#x27;Id&#x27;FROM weather as w1 JOIN weather as w2 ON DATEDIFF(w1.recordDate, w2.recordDate) = 1AND w1.Temperature &gt; w2.Temperature; concat_wsSELECT CONCAT_WS(&quot;-&quot;, &quot;SQL&quot;, &quot;Tutorial&quot;, &quot;is&quot;, &quot;fun!&quot;) AS ConcatenatedString;# output:## ConcatenatedString# SQL-Tutorial-is-fun! EVT Topic ## Data Warehouse å»ºæ¨¡ï¼š è¯´ç™½äº†å°±æ˜¯è¡¨å­—æ®µè®¾è®¡ 1. äº†è§£ä¸šåŠ¡åœºæ™¯ å¹³å°ç»´åº¦ å¹³å°çš„æ”¶å…¥ï¼Œå¹³å°è®¢å•å®Œæˆç‡ å¹³å°è®¢å•æ•°é‡å˜åŒ– æœ€è¿‘7æ—¥ï¼Œ15æ—¥ï¼Œ30æ—¥ï¼Œ60æ—¥ï¼Œ90æ—¥ å»ºæ¨¡ ä¸»é¢˜ç¡®å®šï¼Œç»´åº¦é€€åŒ–ï¼Œè½»åº¦èšåˆ å¦‚ä½•æŠŠå»ºæ¨¡è¯´çš„é«˜å¤§ä¸Šä¸€äº›ï¼š atlas jdbcä¼šæŠŠtinyint è®¤ä¸ºæ˜¯java.sql.Types.BITï¼Œç„¶åsqoopå°±ä¼šè½¬ä¸ºBooleanäº†ã€‚ åœ¨è¿æ¥ä¸ŠåŠ ä¸Šä¸€å¥è¯tinyInt1isBit=false Mysqlä¸­å­˜åœ¨tinyint(1)æ—¶ï¼Œåœ¨æ•°æ®å¯¼å…¥åˆ°HDFSæ—¶ï¼Œè¯¥å­—æ®µé»˜è®¤ä¼šè¢«è½¬åŒ–ä¸ºbooleanæ•°æ®ç±»å‹ã€‚å¯¼è‡´æ•°æ®å†…å®¹ä¸¢å¤±ã€‚ tinyInt1isBit=false [sqoopä»mysqlå¯¼å…¥hiveä¸­tinyintç±»å‹å˜æˆäº†booleanç±»å‹çš„é—®é¢˜](https://blog.csdn.net/qq_36579777/article/details/86475680?utm_medium=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLearnPai2-1.control&depth_1-utm_source=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLearnPai2-1.control) mysql.server restart --init-file=/Users/blair/init.sql Reference hive lateral view ä¸ explodeè¯¦è§£ w3schools sql Mysqlè‡ªå®šä¹‰å˜é‡çš„ä½¿ç”¨ å¸¸è§çš„SQLé¢è¯•é¢˜ï¼šç»å…¸50é¢˜ - çŸ¥ä¹ Spark SQL å’Œ ä¼ ç»Ÿ SQL çš„åŒºåˆ« MySQL rootå¯†ç å¿˜è®°ï¼ŒåŸæ¥è¿˜æœ‰æ›´ä¼˜é›…çš„è§£æ³•ï¼ hive è¡Œè½¬åˆ— lateral view explodeHive Lateral viewä»‹ç» ç¼“æ…¢å˜åŒ–ç»´çš„10ç§æ–¹å¼","categories":[{"name":"data-warehouse","slug":"data-warehouse","permalink":"http://iequa.com/categories/data-warehouse/"}],"tags":[{"name":"SQL","slug":"SQL","permalink":"http://iequa.com/tags/SQL/"}]},{"title":"Airflow Review 1","slug":"dataware/airflow-1","date":"2021-01-24T01:07:21.000Z","updated":"2021-06-14T05:21:59.930Z","comments":true,"path":"2021/01/24/dataware/airflow-1/","link":"","permalink":"http://iequa.com/2021/01/24/dataware/airflow-1/","excerpt":"","text":"hello world# -*- coding: utf-8 -*-import airflowfrom airflow import DAGfrom airflow.operators.bash import BashOperatorfrom airflow.operators.python import PythonOperatorfrom datetime import timedelta#-------------------------------------------------------------------------------# these args will get passed on to each operator# you can override them on a per-task basis during operator initializationdefault_args = &#123; &#x27;owner&#x27;: &#x27;jifeng.si&#x27;, &#x27;depends_on_past&#x27;: False, &#x27;start_date&#x27;: airflow.utils.dates.days_ago(2), &#x27;email&#x27;: [&#x27;779844881@qq.com&#x27;], &#x27;email_on_failure&#x27;: False, &#x27;email_on_retry&#x27;: False, &#x27;retries&#x27;: 1, &#x27;retry_delay&#x27;: timedelta(minutes=5), # &#x27;queue&#x27;: &#x27;bash_queue&#x27;, # &#x27;pool&#x27;: &#x27;backfill&#x27;, # &#x27;priority_weight&#x27;: 10, # &#x27;end_date&#x27;: datetime(2016, 1, 1), # &#x27;wait_for_downstream&#x27;: False, # &#x27;dag&#x27;: dag, # &#x27;adhoc&#x27;:False, # &#x27;sla&#x27;: timedelta(hours=2), # &#x27;execution_timeout&#x27;: timedelta(seconds=300), # &#x27;on_failure_callback&#x27;: some_function, # &#x27;on_success_callback&#x27;: some_other_function, # &#x27;on_retry_callback&#x27;: another_function, # &#x27;trigger_rule&#x27;: u&#x27;all_success&#x27;&#125;#-------------------------------------------------------------------------------# dagdag = DAG( &#x27;example_hello_world_dag&#x27;, default_args=default_args, description=&#x27;my first DAG&#x27;, schedule_interval=timedelta(days=1))#-------------------------------------------------------------------------------# first operatordate_operator = BashOperator( task_id=&#x27;date_task&#x27;, bash_command=&#x27;date&#x27;, dag=dag)#-------------------------------------------------------------------------------# second operatorsleep_operator = BashOperator( task_id=&#x27;sleep_task&#x27;, depends_on_past=False, bash_command=&#x27;sleep 5&#x27;, dag=dag)#-------------------------------------------------------------------------------# third operatordef print_hello(): return &#x27;Hello world!&#x27;hello_operator = PythonOperator( task_id=&#x27;hello_task&#x27;, python_callable=print_hello, dag=dag)#-------------------------------------------------------------------------------# dependenciessleep_operator.set_upstream(date_operator)hello_operator.set_upstream(date_operator) # ~/airflow/dags [19:59:51]âœ python hello_world.py airflow tasks list example_hello_world_dag airflow tasks list example_hello_world_dag âœ airflow tasks list example_hello_world_dag[2021-01-24 20:00:02,162] &#123;dagbag.py:440&#125; INFO - Filling up the DagBag from /Users/blair/airflow/dags[2021-01-24 20:00:02,200] &#123;example_kubernetes_executor_config.py:174&#125; WARNING - Could not import DAGs in example_kubernetes_executor_config.py: No module named &#x27;kubernetes&#x27;[2021-01-24 20:00:02,200] &#123;example_kubernetes_executor_config.py:175&#125; WARNING - Install kubernetes dependencies with: pip install apache-airflow[&#x27;cncf.kubernetes&#x27;]date_taskhello_tasksleep_task 2.1 æµ‹è¯• date_taskâœ airflow tasks test example_hello_world_dag date_task 20210124 2.2 æµ‹è¯• hello_taskAIRFLOW_CTX_DAG_EMAIL=779844881@qq.comAIRFLOW_CTX_DAG_OWNER=blair.chanAIRFLOW_CTX_DAG_ID=example_hello_world_dagAIRFLOW_CTX_TASK_ID=hello_taskAIRFLOW_CTX_EXECUTION_DATE=2021-01-24T00:00:00+00:00[2021-01-24 20:05:03,473] &#123;python.py:118&#125; INFO - Done. Returned value was: Hello world![2021-01-24 20:05:03,480] &#123;taskinstance.py:1142&#125; INFO - Marking task as SUCCESS. dag_id=example_hello_world_dag, task_id=hello_task, execution_date=20210124T000000, start_date=20210124T120503, end_date=20210124T120503 2.3 æµ‹è¯• sleep_task /var/folders/58/kj1q13hs3j52hwvj3t2g2plh0000gp/T[2021-01-24 20:04:30,923] &#123;bash.py:158&#125; INFO - Running command: sleep 5[2021-01-24 20:04:30,929] &#123;bash.py:169&#125; INFO - Output:[2021-01-24 20:04:35,942] &#123;bash.py:177&#125; INFO - Command exited with return code 0[2021-01-24 20:04:35,972] &#123;taskinstance.py:1142&#125; INFO - Marking task as SUCCESS. dag_id=example_hello_world_dag, task_id=sleep_task, execution_date=20210124T000000, start_date=20210124T120430, end_date=20210124T120435 airflowå¦‚ä½•è®¾ç½®Dagå’ŒDagä¹‹é—´çš„ä¾èµ–å•Šï¼Ÿ å¯ä»¥è‡ªå·±å†™ä¸€ä¸ªè„šæœ¬æ¥æ£€æµ‹çˆ¶dagçš„çŠ¶æ€ï¼Œæ¥è¾¾åˆ°dagä¹‹é—´çš„ä¾èµ– ExternalTaskSensor é«˜çº§ç‰¹æ€§ï¼Œç›‘å·¥ Reference AirFlowé«˜é˜¶ï¼Œä¸¤ä¸ªå¯åŠ¨æ—¶é—´ä¸åŒDAGä¸­çš„ä»»åŠ¡ä¾èµ–å…³è”demo ã€ airflow å®æˆ˜ç³»åˆ—ã€‘ åŸºäº python çš„è°ƒåº¦å’Œç›‘æ§å·¥ä½œæµçš„å¹³å° ç”¨æˆ·ç”»åƒâ€”Airflowä½œä¸šè°ƒåº¦(ETL) é—²èŠè°ƒåº¦ç³»ç»Ÿ Apache Airflow åä¸‰ã€å›å¡«ä»»åŠ¡â€”BackfillJob ETL principles Airflow ä½¿ç”¨åŠåŸç†åˆ†æ data engineer ä½¿ç”¨luigi è¿˜æ˜¯ airflowæ¯”è¾ƒå¥½ï¼Ÿ airflowå®˜æ–¹æ•™ç¨‹â€”â€”ä¸€ä¸ªç®€å•æ¡ˆä¾‹ Airflow ä¸­æ–‡æ–‡æ¡£ AirFlowå¸¸ç”¨å‘½ä»¤ [AirFlow]AirFlowä½¿ç”¨æŒ‡å—ä¸‰ ç¬¬ä¸€ä¸ªDAGç¤ºä¾‹","categories":[{"name":"data-warehouse","slug":"data-warehouse","permalink":"http://iequa.com/categories/data-warehouse/"}],"tags":[{"name":"Airflow","slug":"Airflow","permalink":"http://iequa.com/tags/Airflow/"}]},{"title":"DataWare Business Review 3","slug":"dataware/dataware-business-3","date":"2021-01-22T01:07:21.000Z","updated":"2021-06-14T05:21:59.917Z","comments":true,"path":"2021/01/22/dataware/dataware-business-3/","link":"","permalink":"http://iequa.com/2021/01/22/dataware/dataware-business-3/","excerpt":"","text":"äº‹ä»¶ä¸»é¢˜ - è¿˜æ¬¾æµæ°´, æˆä¿¡æµæ°´, æ”¯ç”¨æµæ°´, æ”¾æ¬¾æµæ°´, è¿˜æ¬¾è®¡åˆ’. åœ¨åç«¯èµ„äº§çš„æ¨¡å—. DWD - è¿™äº›æµæ°´è¡¨éƒ½åœ¨è¿™å±‚. (1). æˆä¿¡æ”¯ç”¨åï¼Œå°±ä¼šäº§ç”Ÿå€Ÿæ®å· ä¸ªè´·ä¸šåŠ¡æ•°æ®ï¼ŒåŒ…æ‹¬ç”³è¯·IDï¼Œæœºæ„ä»£å·ï¼Œè´·æ¬¾åˆåŒç¼–å·ï¼Œæ‹…ä¿ç±»å‹ï¼Œè´·æ¬¾æœŸé™ï¼Œè´·æ¬¾èµ·æœŸï¼Œè´·æ¬¾æ­¢æœŸï¼Œè¯‰è®¼æ ‡å¿—ï¼Œé€¾æœŸåˆ©æ¯åˆ©ç‡ï¼Œè¿˜æ¬¾å¸å·ï¼Œç»ˆå®¡é‡‘é¢ï¼Œè´·æ¬¾é‡‘é¢ï¼Œè´·æ¬¾ä½™é¢ï¼Œç»åŠäººç¼–å·ï¼Œç»“æ¸…æ—¥æœŸï¼Œè¿˜æ¬¾æ–¹å¼ï¼Œå®¢æˆ·å§“åï¼Œå®¢æˆ·ç§ç±»ï¼Œå®¢æˆ·æ€§è´¨ï¼Œå®¢æˆ·åˆ†ç±»ï¼Œè¯ä»¶ç±»å‹ï¼Œè¯ä»¶å·ç ï¼Œæµæ°´å·ï¼Œå€Ÿæ®å·ï¼Œå€Ÿæ®é‡‘é¢ï¼Œå€Ÿæ®ä½™é¢ï¼Œå€Ÿæ®åˆ©æ¯ä½™é¢ï¼Œå€Ÿæ®åˆ©ç‡ï¼Œå€Ÿæ®èµ·æœŸï¼Œå€Ÿæ®æ­¢æœŸï¼Œå€Ÿæ¬¾çŠ¶æ€ï¼Œé€¾æœŸå¤©æ•°ï¼Œç»“æ¯æ–¹å¼ï¼Œæ”¾æ¬¾è´¦å·ï¼Œæ”¾æ¬¾è´¦æˆ·æˆ·åç”¨é€”è¯¦æƒ…ï¼Œè¿˜æ¬¾è´¦æˆ·æˆ·åï¼Œè¿˜æ¬¾è´¦æˆ·è´¦å·ç­‰ã€‚ 8å¤§ä¸»é¢˜æ¨¡å‹ No. ä¸»é¢˜åç§° ä¸»é¢˜æè¿° 1. å®¢æˆ· (USER) å½“äº‹äºº, ç”¨æˆ·ä¿¡æ¯, éå¸¸å¤š, äººè¡Œå¾ä¿¡ä¿¡æ¯ï¼Œ ä¸ªäººèµ„äº§ä¿¡æ¯ 2. æœºæ„ (ORG) çº¿ä¸‹æœ‰å“ªäº›å›¢é˜Ÿ, æµ™æ±ŸåŒºï¼Œå›¢é˜Ÿé•¿ï¼Œå®¢æˆ·ç»ç†ï¼Œ æœ‰ 600+ ä¸ª. åªæœ‰ç»´åº¦è¡¨ 3. äº§å“ (PRD) ç­¾åè®® äº§ç”Ÿ äº§å“, ä¸šåŠ¡æµç¨‹, åªæœ‰ç»´åº¦è¡¨ äº§å“ç»´åº¦è¡¨ï¼š äº§å“ç¼–å·(åˆ†å¥½å‡ çº§), äº§å“åç§°, dim_code, dim_nameï¼Œ ä¸Šæ¶ï¼Œ ä¸‹æ¶äº¬ä¸œé‡‘æ¡ï¼Œ codeï¼Œ å±•ç¤ºç»™è´¢åŠ¡ 4. æ¸ é“ (CHL) 5. äº‹ä»¶ (EVT) 1. åŒä¸šå€Ÿæ¬¾(50~200äº¿) 2. å®¢æˆ·æˆä¿¡ 3. æ”¯ç”¨ 4. æ”¾æ¬¾ 5. æ”¯ä»˜ 6. è¿˜æ¬¾ (æ”¯ä»˜æµæ°´æ€»é‡æœ‰1.5äº¿) , æ‰€ä»¥åŸºæœ¬æ¯å¤©å…¨é‡å…¨é‡å…³è” 6. åè®® (AGR) åˆçº¦ 7. è¥é”€ (CAMP) 8. è´¢åŠ¡ (RISK) 9. é£é™© (FINANCE) é£é™©éƒ¨ è¥é”€ä¹‹åçš„ï¼Œå•†åŠ¡ç»ç†å’Œæ¸ é“ï¼Œè°ˆä¸‹æ¥ä¹‹åï¼Œ åç«¯ æ¸ é“ï¼Œ èµ„äº§ï¼Œ è´¦åŠ¡ ODS è¿˜æ¬¾æµæ°´è¡¨ï¼š è¿˜æ¬¾æµæ°´å· å€Ÿæ®å· è¿˜æ¬¾æ—¥ è¿˜æ¬¾é‡‘é¢ è¿˜æ¬¾é‡‘é¢(æœ¬é‡‘ï¼Œåˆ©æ¯ï¼Œæ‰‹ç»­è´¹), user_id product_id â€¦ è¿˜æ¬¾æµæ°´ ï¼ˆå¹³å‡æ—¥å¢40~50Wï¼Œ å¶å°”100~200Wä¹Ÿæ˜¯æœ‰çš„ï¼‰, å¹´ä¸Šäº¿ ODS æ”¯ä»˜æµæ°´ï¼š æ”¯ä»˜æµæ°´æœ‰å®¢æˆ·çš„é“¶è¡Œå¡ï¼Œèº«ä»½è¯ï¼Œèµ°çš„ä»€ä¹ˆæ”¯ä»˜é€šé“ç­‰ä¿¡æ¯ï¼Œ æ”¯ä»˜é€šé“æ˜¯å“ªå®¶é“¶è¡Œï¼Œ å®¢æˆ·é€šè¿‡ä¸åŒé“¶è¡Œæ”¯ä»˜åˆ°å…¬å¸è´¦æˆ· å¾®ä¿¡ï¼Œæ”¯ä»˜å® ä¹Ÿæœ‰ ODS å†²æ­£è¿˜æ¬¾æµæ°´è¡¨ï¼ˆ1Wå†…ï¼‰ï¼š è¿˜æ¬¾æµæ°´å· å€Ÿæ®å· è¿˜æ¬¾æ—¥ è¿˜æ¬¾é‡‘é¢ è¿˜æ¬¾é‡‘é¢(æœ¬é‡‘ï¼Œåˆ©æ¯ï¼Œæ‰‹ç»­è´¹), user_id product_id â€¦ DWDï¼š è¿˜æ¬¾äº‹å®è¡¨ (Join from è¿˜æ¬¾æµæ°´è¡¨ &amp; å†²æ­£è¿˜æ¬¾æµæ°´è¡¨) è¿˜æ¬¾äº‹å®è¡¨ - å€Ÿæ®å·(å¯ä»¥å…³è”åˆ°ç”¨æˆ·å’Œäº§å“), è¿˜æ¬¾æµæ°´å·, è¿˜æ¬¾é‡‘é¢(æœ¬é‡‘ï¼Œåˆ©æ¯ï¼Œæ‰‹ç»­è´¹), user_id, product_id, custom_id ä¸‹æ¸¸å¯èƒ½çœ‹ï¼Œå€Ÿæ®ç²’åº¦ï¼Œè¿˜äº†å¤šå°‘é’±ï¼Œ èšåˆ æ¯å¤©æ‹‰æ˜¨å¤©æ–°å¢çš„æµæ°´ DWSï¼šæŒ‰ç…§å€Ÿæ®å· Group, å€Ÿæ®å·æ˜¯æœ€å°çš„ç²’åº¦äº†. æ•°æ®é‡å¾ˆå¤§ï¼Œä½†æ˜¯è¿™é‡Œæœ‰ä¸€ä¸ªå°æŠ€å·§: é‡‘é¢åŠ ä¸Šå». SQL Data Skew DW Model table name: ä¸»é¢˜åŸŸ_dwd_table EVT Topic æˆä¿¡æµæ°´, å‡ åä¸‡ï¼Œä¸Šç™¾ä¸‡æ”¯ç”¨æµæ°´, æ”¾æ¬¾æµæ°´, è¿˜æ¬¾æµæ°´, æ—¥å¢ å‡ åä¸‡ ~ ç™¾ä¸‡ï¼Œ åˆ©ç”¨sqoopæŠ½å–æ–°å¢ä¸€å¤©æ”¾æ¬¾ä¸Šäº¿ï¼Œå›æ”¶ä¹Ÿæ˜¯ä¸Šäº¿å®¢æˆ· 4000W / æ‹®æ® 800W&gt; 360: 300W+&gt; åˆ†æœŸä¹ï¼š 200W+&gt; å€Ÿå‘—ï¼š 100W+&gt; å°Šäº«è´·ï¼š 10W+&gt; JDï¼š 50W+&gt; ç™¾åº¦ï¼Œç¿¼æ”¯ä»˜ï¼Œå°ç±³ï¼Œæ»´æ»´ä¸åŒæ¸ é“ï¼Œäº§å“ï¼Œåˆ©ç‡æ®µæ”¾æ¬¾é‡‘é¢ï¼Œä¸åŒåŒºé—´çš„ï¼Œç”¨æˆ·æ•°æ”¯ä»˜æµæ°´ 1.5äº¿+ &amp; è¿˜æ¬¾æµæ°´ æ ¹æ®æµæ°´å· Join å­˜å¿«ç…§æ•°æ®ä¸ä¸€è‡´æœ‰æ²¡æœ‰é‡åˆ°è¿‡ï¼Œæ€ä¹ˆè§£å†³çš„ã€‚å›ç­”ï¼šé‡åˆ°è¿‡ï¼Œæœ€å¸¸è§ï¼ŒåŒä¸€ä¸ªæŒ‡æ ‡ï¼Œå¤šä¸ªäººå¤šä¸ªå›¢é˜Ÿå‡ºï¼Œå£å¾„ä¸ä¸€è‡´ï¼›æˆ–è€…ç›¸åŒé€»è¾‘å¤šä¸ªåœ°æ–¹ç»´æŠ¤ï¼Œå¤åˆ¶ç²˜è´´ï¼Œæ”¹ä¸€ä¸ªåœ°æ–¹å¦ä¸€ä¸ªåœ°æ–¹å¿˜è®°æ”¹è¿½é—®è§£å†³åŠæ³•ï¼šæŒ‡æ ‡ä½“ç³»ï¼Œå¤ç”¨æ•°æ®ï¼šæŒ‰ç…§ä¸šåŠ¡çº¿å°†ä¸€ä¸ªä¸šåŠ¡çº¿è®¾è®¡åˆ°çš„æ‰€æœ‰ç»´åº¦å’ŒæŒ‡æ ‡ç»Ÿä¸€å»ºæ¨¡åˆ°ä¸€å¼ hiveè¡¨ï¼Œä¸Šå±‚æ‰€æœ‰åº”ç”¨æˆ–è€…å¯¹å•†åˆ†æš´éœ²çš„è¡¨éƒ½æ˜¯åŒæºçš„ï¼Œä¸”ç›´æ¥å–ä¸ç”¨å†è®¡ç®—è§„åˆ™å¼•æ“ï¼Œå¤ç”¨é€»è¾‘ï¼šç›¸åŒçš„å­—æ®µåŠ å·¥é€»è¾‘æŠ½ç¦»åˆ°è§„åˆ™å¼•æ“ä¸­è¿›è¡Œé…ç½®ï¼Œä¿è¯ä¸€å¤„ä¿®æ”¹ï¼Œå¤„å¤„è¿è¡Œåˆ†éš”ç¬¦ \\n -&gt; 001é€šè¿‡mysqlè‡ªåŠ¨è¯†åˆ«Hiveè¡¨ç»“æ„hadoop - Sqoopå¯¼å…¥å°†TINYINTè½¬æ¢ä¸ºBOOLEANjdbc:mysql://127.0.0.1:3306/nfl?tinyInt1isBit=falsecomment &#x27;ä»»åŠ¡æ—¥å¿—-ä¸´æ—¶è¡¨ï¼Œç”¨äºå°†æ•°æ®é€šè¿‡åŠ¨æ€åˆ†åŒºè½½å…¥ods_task_logä¸­&#x27; ROW FORMAT DELIMITED FIELDS TERMINATED BY &#x27;\\t&#x27; LINES TERMINATED BY &#x27;\\n&#x27; STORED AS TEXTFILE; load data local inpath &#x27;/kkb/datas/gamecenter/ods_task_log.txt&#x27; overwrite into table tmp_ods_task_log; set hive.exec.dynamic.partition=true; set hive.exec.dynamic.partition.mode=nostrict; set hive.exec.max.dynamic.partitions.pernode=1000; insert overwrite table ods_task_log partition(part_date) select plat_id,server_id,channel_id,user_id,role_id,role_name,event_time,task_type,task_id,cost_time,op_type,level_limit,award_exp,award_monetary,award_item,death_count,award_attribute, from_unixtime(event_time,&#x27;yyyy-MM-dd&#x27;) as part_date from tmp_ods_task_log; &quot; a = [ &#123;&quot;row_id&quot;: 2, &quot;text&quot;: &quot;t1&quot;&#125;, &#123;&quot;row_id&quot;: 1, &quot;text&quot;: &quot;t2&quot;&#125;, &#123;&quot;row_id&quot;: 2, &quot;text&quot;: &quot;t3&quot;&#125;, &#123;&quot;row_id&quot;: 2, &quot;text&quot;: &quot;t1&quot;&#125;]ret = pydash.group_by(a, [&quot;row_id&quot;])ret# &#123;2: [&#123;&#x27;row_id&#x27;: 2, &#x27;text&#x27;: &#x27;t1&#x27;&#125;, &#123;&#x27;row_id&#x27;: 2, &#x27;text&#x27;: &#x27;t3&#x27;&#125;], 1: [&#123;&#x27;row_id&#x27;: 1, &#x27;text&#x27;: &#x27;t2&#x27;&#125;]&#125; [pydash_groyp_by](https://pydash.readthedocs.io/en/latest/api.html?highlight=group%20by#pydash.collections.group_by) Reference æµ…è°ˆé“¶è¡Œæ•°æ®ä»“åº“ï¼šé‡‘èä¸»é¢˜å±‚å»ºè®¾ç¯‡ æ•°æ®ä»“åº“-å»ºæ¨¡å®è·µ ç‹¬ä¸€æ— äºŒçš„æ•°æ®ä»“åº“å»ºæ¨¡æŒ‡å—ï¼ˆå‡çº§ç‰ˆï¼‰ å¤§æ•°æ®é¡¹ç›®ä¹‹ç¦»çº¿æ•°ä»“2.0é¡¹ç›®å®æˆ˜æ•™ç¨‹ èƒ¡æ˜æ˜Š - å›´ç»•æ•°æ®å»ºæ¨¡ï¼Œè°ˆé‡‘èæ•°ä»“å»ºè®¾çš„æ ¸å¿ƒ TeraDataé‡‘èæ•°æ®æ¨¡å‹ï¼ˆé“¶è¡Œåå¤§ä¸»é¢˜åˆ’åˆ†ï¼‰ çŸ¥ä¹ï¼šæ•°æ®ä»“åº“æ¶æ„åŠæ•°æ®æ¨¡å‹ä»‹ç» Wechat: æ•°æ®åˆ†æå¸ˆæˆé•¿ä½“ç³»æ¼«è°ˆ - æ•°ä»“æ¨¡å‹è®¾è®¡ å¤§ç™½è¯ç³»åˆ—ï¼šHIVEä¸­æ•°æ®å€¾æ–œåŸç†åŠä¼˜åŒ–æ–¹æ¡ˆ","categories":[{"name":"data-warehouse","slug":"data-warehouse","permalink":"http://iequa.com/categories/data-warehouse/"}],"tags":[{"name":"data warehouse","slug":"data-warehouse","permalink":"http://iequa.com/tags/data-warehouse/"}]},{"title":"Spark - troubleshooting","slug":"spark/spark-summary-3-trouble-shooting","date":"2021-01-20T23:07:21.000Z","updated":"2021-04-08T10:20:01.447Z","comments":true,"path":"2021/01/21/spark/spark-summary-3-trouble-shooting/","link":"","permalink":"http://iequa.com/2021/01/21/spark/spark-summary-3-trouble-shooting/","excerpt":"","text":"Spark No. Title Desc 1. coalesce æ— è®ºæ˜¯åœ¨RDDä¸­è¿˜æ˜¯DataSetï¼Œé»˜è®¤æƒ…å†µä¸‹coalesceä¸ä¼šäº§ç”Ÿshuffleï¼Œæ­¤æ—¶é€šè¿‡coalesceåˆ›å»ºçš„RDDåˆ†åŒºæ•°å°äºç­‰äºçˆ¶RDDçš„åˆ†åŒºæ•°ã€‚ 2. repartition 1ï¼‰å¢åŠ åˆ†åŒºæ•° - repartitionè§¦å‘shuffleï¼Œshuffleçš„æƒ…å†µä¸‹å¯ä»¥å¢åŠ åˆ†åŒºæ•°.- coalesceé»˜è®¤ä¸è§¦å‘shuffleï¼Œå³è°ƒç”¨è¯¥ç®—å­å¢åŠ åˆ†åŒºæ•°ï¼Œå®é™…æƒ…å†µæ˜¯åˆ†åŒºæ•°ä»æ˜¯å½“å‰çš„åˆ†åŒºæ•°. 3. union val rdd4 = rdd1.union(rdd3) - res: Array[Int] = Array(1,2,3,4,5,6,7,8,9,12,14,16,18) å¤šæ•°æƒ…å†µ: é€šè¿‡unionç”Ÿæˆçš„RDDçš„åˆ†åŒºæ•°ä¸ºçˆ¶RDDçš„åˆ†åŒºæ•°ä¹‹å’Œ 4. Join join(otherDataset, [numTasks])æ˜¯è¿æ¥æ“ä½œï¼Œå°†è¾“å…¥æ•°æ®é›†(K,V)å’Œå¦å¤–ä¸€ä¸ªæ•°æ®é›†(K,W)è¿›è¡ŒJoinï¼Œ å¾—åˆ°(K, (V,W))ï¼›è¯¥æ“ä½œæ˜¯å¯¹äºç›¸åŒKçš„Vå’ŒWé›†åˆè¿›è¡Œç¬›å¡å°”ç§¯ æ“ä½œï¼Œä¹Ÿå³Vå’ŒWçš„æ‰€æœ‰ç»„åˆ val rdd5 = rdd0.join(rdd0) res3: Array[(Char,(Int, Int))] = Array((d,(9,8)), (c,(6,6)), (c,(6,7))) rdd ç®—å­ï¼š leftOuterJoin, fullOuterJoin, .. spark sql ä¹‹joinç­‰å‡½æ•°ç”¨æ³• 5. cogroup cogroup(otherDataset, [numTasks])æ˜¯å°†è¾“å…¥æ•°æ®é›†(K, V)å’Œå¦å¤–ä¸€ä¸ªæ•°æ®é›†(K, W)è¿›è¡Œcogroupï¼Œå¾—åˆ°ä¸€ä¸ªæ ¼å¼ä¸º(K, Seq[V], Seq[W])çš„æ•°æ®é›† val rdd6 = rdd0.cogroup(rdd0)res: Array[(Int, (Iterable[Int], Iterable[Int]))] = Array((1,(ArrayBuffer(1, 2, 3),ArrayBuffer(1, 2, 3))), (2,(ArrayBuffer(1, 2, 3),ArrayBuffer(1, 2, 3)))) sparkçš„unionå’Œjoinæ“ä½œæ¼”ç¤º No. Title Author Link &amp; Solutions 0. GROUPING SETS spark.sql.files.maxPartitionBytes é»˜è®¤128M, å•ä¸ªåˆ†åŒºè¯»å–çš„æœ€å¤§æ–‡ä»¶å¤§å° ï¼ˆå¯¹äºå¤§éƒ¨åˆ†çš„Parquetå‹ç¼©è¡¨æ¥è¯´,æ³¨æ„å‹ç¼©è¦å¯åˆ†å‰²lzoï¼Œè¿™ä¸ªé»˜è®¤è®¾ç½®å…¶å®ä¼šå¯¼è‡´æ€§èƒ½é—®é¢˜ï¼‰å¯ä»¥é€šè¿‡è®¾ç½®spark.sql.files.maxPartitionBytes æ¥åˆ†å‰²æ¯ä¸ªtask çš„è¾“å…¥åœ¨Hadoopé‡Œï¼Œä»»åŠ¡çš„å¹¶å‘é»˜è®¤æ˜¯ä»¥hdfs blockä¸ºå•ä½çš„ï¼Œè€ŒSparké‡Œå¤šäº†ä¸€ç§é€‰æ‹©ï¼Œå³ä»¥RowGroupä¸ºåŸºæœ¬å•ä½: spark å¤„ç†parquet æ–‡ä»¶æ—¶ï¼Œä¸€ä¸ªrow group åªèƒ½ç”±ä¸€ä¸ªtaskæ¥å¤„ç†row groupæ˜¯éœ€è¦è°ƒä¼˜çš„sparkå‚æ•°,é‡è¦ä¸€ç‚¹,å°±æ˜¯æ§åˆ¶ä»»åŠ¡çš„å¹¶å‘åº¦:set parquet.block.size=16Mset spark.sql.files.maxPartitionBytes=16M 1. è¾ƒå¤šçš„ DataFrame join æ“ä½œæ—¶ è°ƒå¤§æ­¤å‚æ•°ï¼šspark.sql.autoBroadcastJoinThresholdï¼Œé»˜è®¤10Mï¼Œå¯è®¾ç½®ä¸º 100M 2. åä¸ºå¼€å‘è€…SparkCoreçŸ¥ä¹å¤§æ•°æ®SparkSQL å¼€å‘è€…æŒ‡å— &gt; ç»„ä»¶æˆåŠŸæ¡ˆä¾‹ &gt; Spark &gt; æ¡ˆä¾‹10ï¼šSpark Coreè°ƒä¼˜ &gt; ç»éªŒæ€»ç»“ SparkåŸºç¡€ï¼šSpark SQLè°ƒä¼˜ 1. Cache ç¼“å­˜ &nbsp;&nbsp;1.1 spark.catalog.cacheTable(â€œtâ€) æˆ– df.cache() &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Spark SQLä¼šæŠŠéœ€è¦çš„åˆ—å‹ç¼©åç¼“å­˜ï¼Œé¿å…ä½¿ç”¨å’ŒGCçš„å‹åŠ›&nbsp;&nbsp;1.2 spark.sql.inMemoryColumnarStorage.compressed é»˜è®¤true &nbsp;&nbsp;1.3 spark.sql.inMemoryColumnarStorage.batchSize é»˜è®¤10000 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; æ§åˆ¶åˆ—ç¼“å­˜æ—¶çš„æ•°é‡ï¼Œé¿å…OOMé£é™©ã€‚ å¼•ç”³è¦ç‚¹ï¼š è¡Œå¼å­˜å‚¨ &amp; åˆ—å¼å­˜å‚¨ ä¼˜ç¼ºç‚¹ 2. å…¶ä»–é…ç½® &nbsp;&nbsp;2.1 spark.sql.autoBroadcastJoinThreshold &nbsp;&nbsp;2.2 spark.sql.shuffle.partitions é»˜è®¤200ï¼Œé…ç½®joinå’Œaggçš„æ—¶å€™çš„åˆ†åŒºæ•° &nbsp;&nbsp;2.3 spark.sql.broadcastTimeout é»˜è®¤300ç§’ï¼Œå¹¿æ’­joinæ—¶å¹¿æ’­ç­‰å¾…çš„æ—¶é—´ &nbsp;&nbsp;2.4 spark.sql.files.maxPartitionBytes é»˜è®¤128MBï¼Œå•ä¸ªåˆ†åŒºè¯»å–çš„æœ€å¤§æ–‡ä»¶å¤§å°&nbsp;&nbsp;2.5 spark.sql.files.openCostInBytes parquet.block.size3. å¹¿æ’­ hash join - BHJ &nbsp;&nbsp; 3.1 å½“ç³»ç»Ÿ spark.sql.autoBroadcastJoinThreshold åˆ¤æ–­æ»¡è¶³æ¡ä»¶ï¼Œä¼šè‡ªåŠ¨ä½¿ç”¨BHJ åä¸ºäº‘Stackå…¨æ™¯å›¾ &gt; å¼€å‘è€…æŒ‡å— &gt; SQLå’ŒDataFrameè°ƒä¼˜ &gt; Spark SQL joinä¼˜åŒ– sparkä¸ä¼š æ³¨æ„sparkä¸ä¼šç¡®ä¿æ¯æ¬¡é€‰æ‹©å¹¿æ’­è¡¨éƒ½æ˜¯æ­£ç¡®çš„ï¼Œå› ä¸ºæœ‰çš„åœºæ™¯æ¯”å¦‚ full outer join æ˜¯ä¸æ”¯æŒBHJçš„ã€‚æ‰‹åŠ¨æŒ‡å®šå¹¿æ’­: broadcast(spark.table(\"src\")).join(spark.table(\"records\"), \"key\").show() å¼€å‘å°çŸ¥è¯† 0. NULL, AVG/NOT IN select avg(amount) as a_mount from orders amount (150, 150, null) avg = 150 ä¸æ˜¯ 100 select * from stores where tag not in (â€œâ€) 1. NVL(expr1,expr2) NVL(expr1,expr2) NVL(UnitsOnOrder,0) other simlar: IFNULL(UnitsOnOrder, 0) / coalesce(null, â€œâ€) NULLIF(exp1,expr2)å‡½æ•°çš„ä½œç”¨æ˜¯å¦‚æœexp1å’Œexp2ç›¸ç­‰åˆ™è¿”å›ç©º(NULL) 2. IF( expr1 , expr2 , expr3 ) expr1 çš„å€¼ä¸º TRUEï¼Œåˆ™è¿”å›å€¼ä¸º expr2 expr1 çš„å€¼ä¸ºFALSEï¼Œåˆ™è¿”å›å€¼ä¸º expr3 3. IFNULL( expr1 , expr2 ) if expr1 not null, return expr1 å¸¸è§é—®é¢˜ 3. å®šä½æ€§èƒ½é—®é¢˜å¯¹åº”çš„sql 1. spark driver log çœ‹ æ‰§è¡Œæ…¢çš„stageï¼ˆ99%ï¼‰ 2. spark ui ä¸Šçœ‹ è¯¥stage çš„task æ‰§è¡Œå®Œæˆæ¯”ç‡3. spark ui ä¸Šçœ‹ è¯¥stage å¯¹åº”çš„ continer id å’Œ æ‰€å±job4. spark ui ä¸Šçœ‹ sql çš„æ‰§è¡Œè®¡åˆ’ å’Œ æ‰§è¡Œè®¡åˆ’å›¾ï¼Œæœ€ç»ˆå®šä½åˆ°æ˜¯å“ªæ®µsql 4. ä¸€é“sqlçš„é¢˜ï¼Œä¸€å¼ è¡¨ï¼Œç”¨æˆ·idå’Œç™»å½•æ—¥æœŸï¼ŒæŸ¥æ‰¾è¿ç»­ä¸¤å¤©ç™»é™†çš„ç”¨æˆ· left join tb_log b on a.uid = b.uid on a.uid = b.uid 5. å†™sqlã€‚æ±‚ä¸€ä¸ªçœä»½ä¸‹çš„uvæœ€é«˜çš„åŸå¸‚ ä¸»è¦è€ƒå¯Ÿçª—å£å‡½æ•° select province,city,row_nnumber()over(partition by province order by uv desc ) rank 6. æ•°æ®ä¸ä¸€è‡´é‡åˆ°è¿‡å—ï¼Œæ˜¯ä»€ä¹ˆåŸå› ? 7. çŸ¥é“ä»€ä¹ˆæ˜¯ whole stage codengenå— é¢å‘æ¥å£ç¼–ç¨‹å¤ªè€—æ—¶é—´ï¼Œä¸»è¦æ˜¯æ–¹æ³•é€’å½’è°ƒç”¨ï¼Œè™šå‡½æ•°è°ƒç”¨ å¯ä»¥å°†ä¸€ä¸ªstageçš„æ‰€æœ‰taskæ•´ç†æˆä¸€ä¸ªæ–¹æ³•ï¼Œå¹¶ä¸”ç”ŸæˆåŠ¨æ€å­—èŠ‚ç  å¹¶ç»“åˆ 8. spark 3.0 ç‰¹æ€§ å¾…å­¦ 9. wordCount lines=sc.textFile(path) words = lines.flatMap(lambda x: x.split(â€˜ â€˜)) wco = words.map(lambda x: (x, 1))word_count = wco.reduceByKey(add) SELECT factory, department, SUM(quantity)FROM productionGROUP BY GROUPING SETS(factory, department)ORDER BY factory, departmentHDFS:205.2 M part-00000-30ceee1e-2ed6-4239-8a6b-45fc6cbf1ef6.c000205.2 M part-00001-30ceee1e-2ed6-4239-8a6b-45fc6cbf1ef6.c0003.8 M part-00002-30ceee1e-2ed6-4239-8a6b-45fc6cbf1ef6.c000å…±ä¸‰ä¸ªæ•°æ®æ–‡ä»¶ï¼Œå¦‚æœè®¾ç½®å‚æ•° spark.sql.files.maxPartitionBytesä¸º64Mï¼Œä¼šæŠŠæ•°æ®åˆ†8ä¸ªå—:##part-00000 å››å—range: 0-67108864 ; range: 67108864-134217728; range: 134217728-201326592range: 201326592-215189723##part-00001 å››å—range: 0-67108864 ; range: 67108864-134217728; range: 134217728-201326592range: 201326592-215167669##part-00002 ä¸€å—range: 0-4002630å¯åŠ¨7ä¸ªtaskï¼šç†è®ºä¸Šæœ‰6ä¸ªtaskåˆ†åˆ«è´Ÿè´£æ¯ä¸ª64Mçš„å—æ•°æ®ï¼Œç„¶åæœ€åä¸€ä¸ªtaskè´Ÿè´£part-00000ï¼Œpart-00001å‰©ä½™çš„ä¸è¶³64Mçš„ä¸¤ä¸ªå—ä»¥åŠpart-00002åˆ†åŒºæ•°ç¡®å®å¢åŠ äº†ï¼Œç”±å››ä¸ªå¢åŠ åˆ°äº†7ä¸ªï¼Œä½†æ˜¯æ–°å¢çš„3ä¸ªå´æ²¡å¤„ç†ä»€ä¹ˆæ•°æ®ï¼Œå¤§éƒ¨åˆ†çš„æ•°æ®è¿˜æ˜¯4ä¸ªpartitionåœ¨å¤„ç†ï¼Œæ‰€ä»¥è¿˜æ˜¯å¾ˆæ…¢~~~~taskæ•°å¢åŠ äº†ï¼Œä½†æ˜¯æ•°æ®å¹¶æ²¡æœ‰å‡åˆ†åˆ°æ¯ä¸ªtaskï¼Œä¸ºä»€ä¹ˆå‘¢?spark åœ¨å¤„ç†parquet æ–‡ä»¶æ—¶ï¼Œä¸€ä¸ªrow group åªèƒ½ç”±ä¸€ä¸ªtask æ¥å¤„ç†ï¼Œåœ¨hdfs ä¸­ä¸€ä¸ªrow group å¯èƒ½æ¨ªè·¨hdfs block ï¼Œé‚£ä¹ˆsparkæ˜¯æ€ä¹ˆä¿è¯ä¸€ä¸ªtaskåªå¤„ç†ä¸€ä¸ª row group çš„å‘¢ï¼Ÿæ£€æŸ¥table_aå‘ç°ï¼Œç”Ÿæˆtable_aæ—¶ï¼Œparquet.block.size ç”¨çš„é»˜è®¤å€¼128M ï¼Œè¿™æ ·å°±å¯¼è‡´ä¸€ä¸ªrow group æœ‰128M çš„å¤§å°ã€‚parquet.block.size æ˜¯å¯ä»¥ä¾æ®å®é™…ä½¿ç”¨æƒ…å†µæ¥è°ƒä¼˜çš„ï¼Œå¯¹äºåšå¤šç»´åˆ†æè¡¨ï¼Œå¯ä»¥è®¾ç½®ç¨å°ä¸€ç‚¹ã€‚æœ€ç»ˆ ç»è¿‡è°ƒè¯•è®¾ç½®parquet.block.size ä¸º16M ï¼›è®¾ç½®spark.sql.files.maxPartitionBytesä¸º16Mè¯»å–hdfsæ–‡ä»¶æ—¶ï¼Œå¹¶è¡Œäº†22ä¸ªtaskï¼Œå¹¶ä¸”æ¯ä¸ªtaskå¤„ç†æ•°æ®å‡åŒ€parquet.block.sizeæ‰€æ§åˆ¶çš„parquet row groupå¤§å°æ˜¯ä¸€ä¸ªéœ€è¦è°ƒä¼˜çš„sparkå‚æ•°ã€‚å…¶ä¸­é‡è¦ä¸€ç‚¹ï¼Œå°±æ˜¯æ§åˆ¶ä»»åŠ¡çš„å¹¶å‘åº¦ã€‚åœ¨Hadoopé‡Œï¼Œä»»åŠ¡çš„å¹¶å‘é»˜è®¤æ˜¯ä»¥hdfs blockä¸ºå•ä½çš„ï¼Œè€ŒSparké‡Œå¤šäº†ä¸€ç§é€‰æ‹©ï¼Œå³ä»¥RowGroupä¸ºåŸºæœ¬å•ä½ã€‚åœ¨è°ƒç”¨HiveContext.read.parquet(path)æ—¶ï¼Œä¼šè§¦å‘ParquetRelation2å¯¹è±¡ç”ŸæˆSqlNewHadoopRDDå¯¹è±¡ï¼Œå¹¶è¦†ç›–å…¶ä¸­getPartitions()æ–¹æ³•60min -&gt; 3mins No. Title Flag 0. kaike - sparkSQLåº•å±‚å®ç°åŸç†spark.sql.shuffle.partitionså’Œ spark.default.parallelism çš„åŒºåˆ«SparkSQLå¹¶è¡Œåº¦å‚æ•°è®¾ç½®æ–¹æ³• 1. Bç«™ æˆ‘çˆ±å–å‡é…’ - æ€§èƒ½è°ƒä¼˜ 2. Sparkæ€§èƒ½è°ƒä¼˜ä¹‹åˆç†è®¾ç½®å¹¶è¡Œåº¦ (ç¨æœ‰è¯¯)ï¼Œ Sparkå®è·µ â€” æ€§èƒ½ä¼˜åŒ–åŸºç¡€ 3. spark.defalut.parallelism é»˜è®¤æ˜¯æ²¡æœ‰å€¼çš„ï¼Œå¦‚è®¾ç½®å€¼ä¸º10ï¼Œæ˜¯åœ¨shuffle/çª„ä¾èµ– çš„è¿‡ç¨‹æ‰ä¼šèµ·ä½œç”¨ï¼ˆval rdd2 = rdd1.reduceByKey(_+_) //rdd2çš„åˆ†åŒºæ•°å°±æ˜¯10ï¼Œrdd1çš„åˆ†åŒºæ•°ä¸å—è¿™ä¸ªå‚æ•°çš„å½±å“ï¼‰ 4. å¦‚æœè¯»å–çš„æ•°æ®åœ¨HDFSä¸Šï¼Œå¢åŠ blockæ•°ï¼Œé»˜è®¤æƒ…å†µä¸‹splitä¸blockæ˜¯ä¸€å¯¹ä¸€çš„ï¼Œè€Œsplitåˆä¸RDDä¸­çš„partitionå¯¹åº”ï¼Œæ‰€ä»¥å¢åŠ äº†blockæ•°ï¼Œä¹Ÿå°±æé«˜äº†å¹¶è¡Œåº¦ 5. reduceByKeyçš„ç®—å­æŒ‡å®špartitionçš„æ•°é‡ val rdd2 = rdd1.reduceByKey(_+_,10) val rdd3 = rdd2.map.filter.reduceByKey(_+_) 6. val rdd3 = rdd1.joinï¼ˆrdd2ï¼‰ rdd3é‡Œé¢partiitonçš„æ•°é‡æ˜¯ç”±çˆ¶RDDä¸­æœ€å¤šçš„partitionæ•°é‡æ¥å†³å®šï¼Œå› æ­¤ä½¿ç”¨joinç®—å­çš„æ—¶å€™ï¼Œå¢åŠ çˆ¶RDDä¸­partitionçš„æ•°é‡ 7. ç”±äºSpark SQLæ‰€åœ¨stageçš„ å¹¶è¡Œåº¦æ— æ³•æ‰‹åŠ¨è®¾ç½®å¦‚æœæ•°æ®é‡è¾ƒå¤§ï¼Œå¹¶ä¸”æ­¤stageä¸­åç»­çš„transformationæ“ä½œæœ‰ç€å¤æ‚çš„ä¸šåŠ¡é€»è¾‘ï¼Œè€ŒSpark SQLè‡ªåŠ¨è®¾ç½®çš„taskæ•°é‡å¾ˆå°‘ï¼Œè¿™å°±æ„å‘³ç€æ¯ä¸ªtaskè¦å¤„ç†ä¸ºæ•°ä¸å°‘çš„æ•°æ®é‡ï¼Œç„¶åè¿˜è¦æ‰§è¡Œéå¸¸å¤æ‚çš„å¤„ç†é€»è¾‘ï¼Œè¿™å°±å¯èƒ½è¡¨ç°ä¸ºç¬¬ä¸€ä¸ªæœ‰Spark SQLçš„stageé€Ÿåº¦å¾ˆæ…¢ï¼Œè€Œåç»­çš„æ²¡æœ‰Spark SQLçš„stageè¿è¡Œé€Ÿåº¦éå¸¸å¿«ã€‚ RDD å±æ€§ A list of partitions A function for computing each split A list of dependencies on other RDDs Optionally, a Partitioner for key-value RDDs (e.g. to say that the RDD is hash-partitioned) Optionally, a list of preferred locations to compute each split on (block locations for an HDFS file) very good Sparkåˆ†åŒº partition è¯¦è§£ No. Title Flag 1. ä¸€ç»„åˆ†ç‰‡ï¼ˆPartitionï¼‰ï¼Œå³æ•°æ®é›†çš„åŸºæœ¬ç»„æˆå•ä½ã€‚å¯¹äºRDDæ¥è¯´ï¼Œæ¯ä¸ªåˆ†ç‰‡éƒ½ä¼šè¢«ä¸€ä¸ªè®¡ç®—ä»»åŠ¡å¤„ç†ï¼Œå¹¶å†³å®šå¹¶è¡Œè®¡ç®—çš„ç²’åº¦ã€‚ç”¨æˆ·å¯ä»¥åœ¨åˆ›å»ºRDDæ—¶æŒ‡å®šRDDçš„åˆ†ç‰‡ä¸ªæ•°ï¼Œå¦‚æœæ²¡æœ‰æŒ‡å®šï¼Œé‚£ä¹ˆå°±ä¼šé‡‡ç”¨é»˜è®¤å€¼ã€‚é»˜è®¤å€¼å°±æ˜¯ç¨‹åºæ‰€åˆ†é…åˆ°çš„CPU Coreçš„æ•°ç›®ã€‚ â 2. ä¸€ä¸ªè®¡ç®—æ¯ä¸ªåˆ†åŒºçš„å‡½æ•°ã€‚Sparkä¸­RDDçš„è®¡ç®—æ˜¯ä»¥åˆ†ç‰‡ä¸ºå•ä½çš„ï¼Œæ¯ä¸ªRDDéƒ½ä¼šå®ç°computeå‡½æ•°ä»¥è¾¾åˆ°è¿™ä¸ªç›®çš„ã€‚computeå‡½æ•°ä¼šå¯¹è¿­ä»£å™¨è¿›è¡Œå¤åˆï¼Œä¸éœ€è¦ä¿å­˜æ¯æ¬¡è®¡ç®—çš„ç»“æœã€‚ â 3. RDDä¹‹é—´çš„ä¾èµ–å…³ç³»ã€‚RDDçš„æ¯æ¬¡è½¬æ¢éƒ½ä¼šç”Ÿæˆä¸€ä¸ªæ–°çš„RDDï¼Œæ‰€ä»¥RDDä¹‹é—´å°±ä¼šå½¢æˆç±»ä¼¼äºæµæ°´çº¿ä¸€æ ·çš„å‰åä¾èµ–å…³ç³»ã€‚åœ¨éƒ¨åˆ†åˆ†åŒºæ•°æ®ä¸¢å¤±æ—¶ï¼ŒSparkå¯ä»¥é€šè¿‡è¿™ä¸ªä¾èµ–å…³ç³»é‡æ–°è®¡ç®—ä¸¢å¤±çš„åˆ†åŒºæ•°æ®ï¼Œè€Œä¸æ˜¯å¯¹RDDçš„æ‰€æœ‰åˆ†åŒºè¿›è¡Œé‡æ–°è®¡ç®—ã€‚ â 4. ä¸€ä¸ªPartitionerï¼Œå³RDDçš„åˆ†ç‰‡å‡½æ•°ã€‚å½“å‰Sparkä¸­å®ç°äº†ä¸¤ç§ç±»å‹çš„åˆ†ç‰‡å‡½æ•°ï¼Œä¸€ä¸ªæ˜¯åŸºäºå“ˆå¸Œçš„HashPartitionerï¼Œå¦å¤–ä¸€ä¸ªæ˜¯åŸºäºèŒƒå›´çš„RangePartitionerã€‚åªæœ‰å¯¹äºäºkey-valueçš„RDDï¼Œæ‰ä¼šæœ‰Partitionerï¼Œékey-valueçš„RDDçš„Parititionerçš„å€¼æ˜¯Noneã€‚Partitionerå‡½æ•°ä¸ä½†å†³å®šäº†RDDæœ¬èº«çš„åˆ†ç‰‡æ•°é‡ï¼Œä¹Ÿå†³å®šäº†parent RDD Shuffleè¾“å‡ºæ—¶çš„åˆ†ç‰‡æ•°é‡ã€‚ â 5. ä¸€ä¸ªåˆ—è¡¨ï¼Œå­˜å‚¨å­˜å–æ¯ä¸ªPartitionçš„ä¼˜å…ˆä½ç½®ï¼ˆpreferred locationï¼‰ã€‚å¯¹äºä¸€ä¸ªHDFSæ–‡ä»¶æ¥è¯´ï¼Œè¿™ä¸ªåˆ—è¡¨ä¿å­˜çš„å°±æ˜¯æ¯ä¸ªPartitionæ‰€åœ¨çš„å—çš„ä½ç½®ã€‚æŒ‰ç…§â€œç§»åŠ¨æ•°æ®ä¸å¦‚ç§»åŠ¨è®¡ç®—â€çš„ç†å¿µï¼ŒSparkåœ¨è¿›è¡Œä»»åŠ¡è°ƒåº¦çš„æ—¶å€™ï¼Œä¼šå°½å¯èƒ½åœ°å°†è®¡ç®—ä»»åŠ¡åˆ†é…åˆ°å…¶æ‰€è¦å¤„ç†æ•°æ®å—çš„å­˜å‚¨ä½ç½® â å°½é‡ä¿è¯æ¯è½®Stageé‡Œæ¯ä¸ªtaskå¤„ç†çš„æ•°æ®é‡&gt;128M Reference æ•°ä»“å¼€å‘éœ€è¦äº†è§£çš„5å¤§SQLåˆ†æå‡½æ•° å¹²è´§ï¼šä¸€æ–‡è¯»æ‡‚æ•°æ®ä»“åº“è®¾è®¡æ–¹æ¡ˆ | ä½¿ç”¨Hiveçª—å£å‡½æ•°æ›¿æ¢union allå¤„ç†åˆ†ç»„æ±‡æ€»ï¼ˆå°è®¡ï¼Œæ€»è®¡ï¼‰ Sparkå®è·µ â€” æ€§èƒ½ä¼˜åŒ–åŸºç¡€ Sparké¡¹ç›®å®æˆ˜-troubleshootingä¹‹æ§åˆ¶shuffle reduceç«¯ç¼“å†²å¤§å°ä»¥é¿å…OOM ç»“åˆæºç è°ˆè°ˆ - é€šè¿‡spark.default.parallelismè°ˆSparkå¹¶è¡Œåº¦ è°ˆè°ˆspark.sql.shuffle.partitionså’Œ spark.default.parallelism çš„åŒºåˆ«åŠsparkå¹¶è¡Œåº¦çš„ç†è§£","categories":[{"name":"spark","slug":"spark","permalink":"http://iequa.com/categories/spark/"}],"tags":[{"name":"spark","slug":"spark","permalink":"http://iequa.com/tags/spark/"}]},{"title":"python çš„ decorator & getattr() å‡½æ•°","slug":"python/language/py_getattr","date":"2021-01-20T02:07:21.000Z","updated":"2021-01-19T01:01:13.408Z","comments":true,"path":"2021/01/20/python/language/py_getattr/","link":"","permalink":"http://iequa.com/2021/01/20/python/language/py_getattr/","excerpt":"decorator ç”±äºå‡½æ•°ä¹Ÿæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œè€Œä¸”å‡½æ•°å¯¹è±¡å¯ä»¥è¢«èµ‹å€¼ç»™å˜é‡ï¼Œæ‰€ä»¥ï¼Œé€šè¿‡å˜é‡ä¹Ÿèƒ½è°ƒç”¨è¯¥å‡½æ•°ã€‚ getattr(object, name[,default]) è·å–å¯¹è±¡objectçš„å±æ€§æˆ–è€…æ–¹æ³•ï¼Œå¦‚æœå­˜åœ¨æ‰“å°å‡ºæ¥ï¼Œå¦‚æœä¸å­˜åœ¨ï¼Œæ‰“å°å‡ºé»˜è®¤å€¼ï¼Œé»˜è®¤å€¼å¯é€‰.","text":"decorator ç”±äºå‡½æ•°ä¹Ÿæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œè€Œä¸”å‡½æ•°å¯¹è±¡å¯ä»¥è¢«èµ‹å€¼ç»™å˜é‡ï¼Œæ‰€ä»¥ï¼Œé€šè¿‡å˜é‡ä¹Ÿèƒ½è°ƒç”¨è¯¥å‡½æ•°ã€‚ getattr(object, name[,default]) è·å–å¯¹è±¡objectçš„å±æ€§æˆ–è€…æ–¹æ³•ï¼Œå¦‚æœå­˜åœ¨æ‰“å°å‡ºæ¥ï¼Œå¦‚æœä¸å­˜åœ¨ï¼Œæ‰“å°å‡ºé»˜è®¤å€¼ï¼Œé»˜è®¤å€¼å¯é€‰. éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœè¿”å›çš„å¯¹è±¡çš„æ–¹æ³•ï¼Œè¿”å›çš„æ˜¯æ–¹æ³•çš„å†…å­˜åœ°å€ï¼Œå¦‚æœéœ€è¦è¿è¡Œè¿™ä¸ªæ–¹æ³•ï¼Œå¯ä»¥åœ¨åé¢æ·»åŠ ä¸€å¯¹æ‹¬å·. 1. decoratorç”±äºå‡½æ•°ä¹Ÿæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œè€Œä¸”å‡½æ•°å¯¹è±¡å¯ä»¥è¢«èµ‹å€¼ç»™å˜é‡ï¼Œæ‰€ä»¥ï¼Œé€šè¿‡å˜é‡ä¹Ÿèƒ½è°ƒç”¨è¯¥å‡½æ•°ã€‚ &gt;&gt;&gt; def now():... print(&#x27;2015-3-25&#x27;)...&gt;&gt;&gt; f = now&gt;&gt;&gt; f()2015-3-25def log(func): def wrapper(*args, **kw): print(&#x27;call %s():&#x27; % func.__name__) return func(*args, **kw) return wrapper å¦‚æœdecoratoræœ¬èº«éœ€è¦ä¼ å…¥å‚æ•°ï¼Œé‚£å°±éœ€è¦ç¼–å†™ä¸€ä¸ªè¿”å›decoratorçš„é«˜é˜¶å‡½æ•°ï¼Œå†™å‡ºæ¥ä¼šæ›´å¤æ‚ã€‚æ¯”å¦‚ï¼Œè¦è‡ªå®šä¹‰logçš„æ–‡æœ¬ï¼š def log(text): def decorator(func): def wrapper(*args, **kw): print(&#x27;%s %s():&#x27; % (text, func.__name__)) return func(*args, **kw) return wrapper return decorator è¿™ä¸ª3å±‚åµŒå¥—çš„decoratorç”¨æ³•å¦‚ä¸‹ï¼š @log(&#x27;execute&#x27;)def now(): print(&#x27;2015-3-25&#x27;) æ‰§è¡Œç»“æœå¦‚ä¸‹ï¼š &gt;&gt;&gt; now()execute now():2015-3-25 2. Callable3. getattrReference ä½¿ç”¨Future Callable å‡½æ•°å¼ç¼–ç¨‹-è£…é¥°å™¨ pythonçš„getattrï¼ˆï¼‰å‡½æ•°","categories":[{"name":"python","slug":"python","permalink":"http://iequa.com/categories/python/"}],"tags":[{"name":"getattr","slug":"getattr","permalink":"http://iequa.com/tags/getattr/"}]},{"title":"SparkSQL - Parquet","slug":"spark/spark-summary-7-sql-optimization-parquet","date":"2021-01-12T07:28:21.000Z","updated":"2021-02-22T03:07:33.212Z","comments":true,"path":"2021/01/12/spark/spark-summary-7-sql-optimization-parquet/","link":"","permalink":"http://iequa.com/2021/01/12/spark/spark-summary-7-sql-optimization-parquet/","excerpt":"","text":"äºŒã€Parquetçš„ç²¾è¦ä»‹ç» Parquetæ˜¯åˆ—å¼å­˜å‚¨æ ¼å¼çš„ä¸€ç§æ–‡ä»¶ç±»å‹ï¼Œåˆ—å¼å­˜å‚¨æœ‰ä»¥ä¸‹çš„æ ¸å¿ƒä¼˜åŠ¿ï¼š aï¼‰å¯ä»¥è·³è¿‡ä¸ç¬¦åˆæ¡ä»¶çš„æ•°æ®ï¼Œåªè¯»å–éœ€è¦çš„æ•°æ®ï¼Œé™ä½IOæ•°æ®é‡ã€‚ bï¼‰å‹ç¼©ç¼–ç å¯ä»¥é™ä½ç£ç›˜å­˜å‚¨ç©ºé—´ã€‚ç”±äºåŒä¸€åˆ—çš„æ•°æ®ç±»å‹æ˜¯ä¸€æ ·çš„ï¼Œå¯ä»¥ä½¿ç”¨æ›´é«˜æ•ˆçš„å‹ç¼©ç¼–ç ï¼ˆä¾‹å¦‚RunLength Encodingå’ŒDelta Encodingï¼‰è¿›ä¸€æ­¥èŠ‚çº¦å­˜å‚¨ç©ºé—´ã€‚ cï¼‰åªè¯»å–éœ€è¦çš„åˆ—ï¼Œæ”¯æŒå‘é‡è¿ç®—ï¼Œèƒ½å¤Ÿè·å–æ›´å¥½çš„æ‰«ææ€§èƒ½ã€‚ ç›¸å¯¹äºå…¶å®ƒçš„åˆ—å¼å­˜å‚¨æ ¼å¼ï¼Œä¾‹å¦‚ORC,Parquetä¸»è¦ä¼˜åŠ¿åœ¨äºæ”¯æŒæ›´ä¸ºå¹¿æ³›ï¼Œä¸”å¯¹åµŒå¥—æ•°æ®çš„æ”¯æŒæ›´å¥½ã€‚è¯¦ç»†çš„æ¯”è¾ƒå¯ä»¥å‚è€ƒ http://dongxicheng.org/mapreduce-nextgen/columnar-storage-parquet-and-orc/ Reference Parquetæ–‡ä»¶æ ¼å¼è§£æ sparkè¯»å–parquetæ–‡ä»¶ï¼Œåˆ†é…çš„ä»»åŠ¡ä¸ªæ•° Spark+Parquetåˆ†ç‰‡è§„åˆ™ [çœ‹å›¾è¯´è¯] åŸºäºSpark UIæ€§èƒ½ä¼˜åŒ–ä¸è°ƒè¯•â€”â€”åˆçº§ç¯‡ é‡è¦ | Sparkåˆ†åŒºå¹¶è¡Œåº¦å†³å®šæœºåˆ¶","categories":[{"name":"spark","slug":"spark","permalink":"http://iequa.com/categories/spark/"}],"tags":[{"name":"sparkSQL","slug":"sparkSQL","permalink":"http://iequa.com/tags/sparkSQL/"}]},{"title":"DataWare Review Summary 2","slug":"dataware/dwh-summary-2-interview","date":"2021-01-09T01:07:21.000Z","updated":"2021-06-14T05:21:59.924Z","comments":true,"path":"2021/01/09/dataware/dwh-summary-2-interview/","link":"","permalink":"http://iequa.com/2021/01/09/dataware/dwh-summary-2-interview/","excerpt":"","text":"No. 2020å¹´å¤§å‚-æ•°æ®ä»“åº“ç¯‡ Flag 0. Hive SQL countï¼ˆdistinctï¼‰æ•ˆç‡é—®é¢˜åŠä¼˜åŒ– set mapreduce.map.memory.mb=48192;set mapreduce.reduce.memory.mb=48192;set mapred.reduce.tasks=1000ï¼›select countï¼ˆdistinct accountï¼‰ fromâ€¦whereâ€¦ åŠ å…¥distinctï¼Œmapé˜¶æ®µä¸èƒ½ç”¨combineæ¶ˆé‡ï¼Œæ•°æ®è¾“å‡ºä¸ºï¼ˆkï¼Œvï¼‰å½¢å¼ç„¶ååœ¨reduceé˜¶æ®µè¿›è¡Œæ¶ˆé‡Hiveåœ¨å¤„ç†COUNTè¿™ç§â€œå…¨èšåˆ(full aggregates)â€è®¡ç®—æ—¶ï¼Œå¿½ç•¥æŒ‡å®šçš„Reduce Taskæ•°ï¼Œè€Œå¼ºåˆ¶ä½¿ç”¨1 insert overwrite table temp select idï¼Œaccountï¼Œcount(1) as num from tablename group by idï¼Œaccountï¼› MapReduceæµç¨‹ç®€å•è§£æ â 1. æ‰‹å†™â€è¿ç»­æ´»è·ƒç™»é™†â€ç­‰ç±»ä¼¼åœºæ™¯çš„sql â 2. left semi joinå’Œleft joinåŒºåˆ«? left semi join æ˜¯ in(keySet) çš„å…³ç³»ï¼Œé‡åˆ°å³è¡¨é‡å¤è®°å½•ï¼Œå·¦è¡¨ä¼šè·³è¿‡ï¼›å½“å³è¡¨ä¸å­˜åœ¨çš„æ—¶å€™ï¼Œå·¦è¡¨æ•°æ®ä¸ä¼šæ˜¾ç¤º; ç›¸å½“äºSQLçš„inè¯­å¥. left join: å½“å³è¡¨ä¸å­˜åœ¨çš„æ—¶å€™ï¼Œåˆ™ä¼šæ˜¾ç¤ºNULL â 3. ç»´åº¦å»ºæ¨¡ å’Œ èŒƒå¼å»ºæ¨¡(3NFæ¨¡å‹) çš„åŒºåˆ«? ç»´åº¦å»ºæ¨¡æ˜¯é¢å‘åˆ†æåœºæ™¯çš„ï¼Œä¸»è¦å…³æ³¨ç‚¹åœ¨äºå¿«é€Ÿã€çµæ´»: æ˜Ÿå‹æ¨¡å‹ &amp; é›ªèŠ±æ¨¡å‹ &amp; æ˜Ÿç³»æ¨¡å‹ 3NFçš„æœ€ç»ˆç›®çš„å°±æ˜¯ä¸ºäº†é™ä½æ•°æ®å†—ä½™ï¼Œä¿éšœæ•°æ®ä¸€è‡´æ€§: (2.1) åŸå­æ€§ - æ•°æ®ä¸å¯åˆ†å‰² (2.2) åŸºäºç¬¬ä¸€ä¸ªæ¡ä»¶ï¼Œå®ä½“å±æ€§å®Œå…¨ä¾èµ–äºä¸»é”® (2.3) æ¶ˆé™¤ä¼ é€’ä¾èµ– - ä»»ä½•éä¸»å±æ€§ä¸ä¾èµ–äºå…¶ä»–éä¸»å±æ€§ â 4. æ•°æ®æ¼‚ç§»å¦‚ä½•è§£å†³ ? é€šå¸¸æ˜¯æŒ‡odsè¡¨çš„åŒä¸€ä¸ªä¸šåŠ¡æ—¥æœŸæ•°æ®ä¸­åŒ…å«äº†å‰ä¸€å¤©æˆ–åä¸€å¤©å‡Œæ™¨é™„è¿‘çš„æ•°æ®æˆ–è€…ä¸¢å¤±å½“å¤©å˜æ›´çš„æ•°æ®ï¼Œè¿™ç§ç°è±¡å°±å«åšæ¼‚ç§»ï¼Œä¸”åœ¨å¤§éƒ¨åˆ†å…¬å¸ä¸­éƒ½ä¼šé‡åˆ°çš„åœºæ™¯ 1. å¤šè·å–åä¸€å¤©çš„æ•°æ®ï¼Œä¿éšœæ•°æ®åªå¤šä¸å°‘ 2. é€šè¿‡å¤šä¸ªæ—¶é—´æˆ³å­—æ®µæ¥é™åˆ¶æ—¶é—´è·å–ç›¸å¯¹å‡†ç¡®çš„æ•°æ® log_time, modified_time, proc_time &nbsp;&nbsp;&nbsp;&nbsp; modified_time è¿‡æ»¤éå½“å¤©çš„æ•°æ®ï¼Œè¿™æ ·ç¡®ä¿æ•°æ®ä¸ä¼šå› ä¸ºç³»ç»Ÿé—®é¢˜è¢«é—æ¼ â 5. æ‹‰é“¾è¡¨å¦‚ä½•è®¾è®¡ï¼Œæ‹‰é“¾è¡¨å‡ºç°æ•°æ®å›æ»šçš„éœ€æ±‚æ€ä¹ˆè§£å†³ ? æ‹‰é“¾è¡¨ä½¿ç”¨çš„åœºæ™¯ï¼š1. æ•°æ®é‡å¤§ï¼Œä¸”è¡¨ä¸­éƒ¨åˆ†å­—æ®µä¼šæ›´æ–°ï¼Œæ¯”å¦‚ç”¨æˆ·åœ°å€ã€äº§å“æè¿°ä¿¡æ¯ã€è®¢å•çŠ¶æ€ç­‰ç­‰2. éœ€è¦æŸ¥çœ‹æŸä¸€ä¸ªæ—¶é—´æ®µçš„å†å²å¿«ç…§ä¿¡æ¯3. å˜åŒ–æ¯”ä¾‹å’Œé¢‘ç‡ä¸æ˜¯å¾ˆå¤§ 6. ä»¥ LEFT JOIN ä¸ºä¾‹ï¼š è°ˆè°ˆ åœ¨ä½¿ç”¨ LEFT JOIN æ—¶ï¼ŒON å’Œ WHERE è¿‡æ»¤æ¡ä»¶çš„åŒºåˆ«å¦‚ä¸‹ï¼š 1. on æ¡ä»¶æ˜¯åœ¨ç”Ÿæˆä¸´æ—¶è¡¨æ—¶ä½¿ç”¨çš„æ¡ä»¶ï¼Œå®ƒä¸ç®¡ on ä¸­çš„æ¡ä»¶æ˜¯å¦ä¸ºçœŸï¼Œéƒ½ä¼šè¿”å›å·¦è¾¹è¡¨ä¸­çš„è®°å½• 2. where æ¡ä»¶æ˜¯åœ¨ä¸´æ—¶è¡¨ç”Ÿæˆå¥½åï¼Œå†å¯¹ä¸´æ—¶è¡¨è¿›è¡Œè¿‡æ»¤çš„æ¡ä»¶ã€‚ â 7. å…¬å…±å±‚(CDM:dwdå’Œdws) å’Œ æ•°æ®é›†å¸‚å±‚çš„åŒºåˆ«å’Œç‰¹ç‚¹ï¼Ÿ åˆ†ä¸ºdwdå±‚å’Œdwså±‚ï¼Œä¸»è¦å­˜æ”¾æ˜ç»†äº‹å®æ•°æ®ã€ç»´è¡¨æ•°æ® åŠ å…¬å…±æŒ‡æ ‡æ±‡æ€»æ•°æ®ï¼Œå…¶ä¸­æ˜ç»†äº‹å®æ•°æ®ã€ç»´è¡¨æ•°æ®ä¸€èˆ¬æ˜¯æ ¹æ®odså±‚æ•°æ®åŠ å·¥ç”Ÿæˆçš„ï¼Œå…¬å…±æŒ‡æ ‡æ±‡æ€»æ•°æ®ä¸€èˆ¬æ˜¯åŸºäºç»´è¡¨å’Œæ˜ç»†äº‹å®æ•°æ®åŠ å·¥ç”Ÿæˆçš„. é‡‡ç”¨ç»´åº¦æ¨¡å‹æ–¹æ³•ä½œä¸ºç†è®ºåŸºç¡€ï¼Œæ›´å¤šé‡‡ç”¨ä¸€äº›ç»´åº¦é€€åŒ–çš„æ‰‹æ®µï¼Œå°†ç»´åº¦é€€åŒ–åˆ°äº‹å®è¡¨ä¸­ï¼Œå‡å°‘äº‹å®è¡¨å’Œç»´åº¦è¡¨ä¹‹é—´çš„å…³è”ã€‚åŒæ—¶åœ¨æ±‡æ€»å±‚ï¼ŒåŠ å¼ºæŒ‡æ ‡çš„ç»´åº¦é€€åŒ–ï¼Œé‡‡ç”¨æ›´å¤šçš„å®½è¡¨åŒ–æ‰‹æ®µæ„å»ºå…¬å…±æŒ‡æ ‡æ•°æ®å±‚. Data Mart: å°±æ˜¯æ»¡è¶³ç‰¹å®šéƒ¨é—¨æˆ–è€…ç”¨æˆ·çš„éœ€æ±‚ï¼ŒæŒ‰ç…§å¤šç»´æ–¹å¼å­˜å‚¨ã€‚é¢å‘å†³ç­–åˆ†æçš„æ•°æ®ç«‹æ–¹ä½“ 8. ä»åŸç†ä¸Šè¯´ä¸€ä¸‹mppå’Œmrçš„åŒºåˆ« ? 1. MPPè·‘çš„æ˜¯SQL,è€ŒHadoopåº•å±‚å¤„ç†æ˜¯MapReduceç¨‹åº 2. æ‰©å±•ç¨‹åº¦ï¼šMPPæ‰©å±•ä¸€èˆ¬æ˜¯æ‰©å±•åˆ°100å·¦å³,å› ä¸ºMPPå§‹ç»ˆè¿˜æ˜¯DB,ä¸€å®šè¦è€ƒè™‘åˆ°C(Consistency) â 9. Kimballå’ŒInmonçš„ç›¸åŒå’Œä¸åŒï¼Ÿ Inmonï¼š ä¸å¼ºè°ƒäº‹å®è¡¨å’Œç»´åº¦è¡¨çš„æ¦‚å¿µï¼Œ ç±»ä¼¼ 3NF â 10. ç¼“æ…¢å˜åŒ–ç»´ï¼ˆSlowly Changing Dimensionï¼‰å¤„ç†æ–¹å¼ ? 1. é‡å†™è¦†ç›– 2. å¢åŠ æ–°è¡Œ(æ³¨æ„äº‹å®è¡¨å…³è”æ›´æ–°) 3. å¿«ç…§ (æ¯å¤©ä¿ç•™å…¨é‡çš„å¿«ç…§æ•°æ®ï¼Œé€šè¿‡ç©ºé—´æ¢æ—¶é—´) 4. å†å²æ‹‰é“¾ (æ‹‰é“¾è¡¨çš„å¤„ç†æ–¹å¼ï¼Œå³é€šè¿‡æ—¶é—´æ ‡ç¤ºå½“å‰æœ‰æ•ˆè®°å½•) â 11. æ•°æ®è´¨é‡/å…ƒæ•°æ®ç®¡ç†/æŒ‡æ ‡ä½“ç³»å»ºè®¾/æ•°æ®é©±åŠ¨ ç•¥ 12. hiveçš„row_number()ã€rank()å’Œdense_rank()çš„åŒºåˆ«ä»¥åŠå…·ä½“ä½¿ç”¨ â 13. Hiveçª—å£å‡½æ•°æ€ä¹ˆè®¾ç½®çª—å£å¤§å°ï¼Ÿ, between 1 preceding and 1 following âœ”ï¸ 14. Hive å››ä¸ªbyçš„åŒºåˆ« 15. æ€ä¹ˆéªŒè¯Hive SQLçš„æ­£ç¡®æ€§ ï¼Ÿ 1. å¦‚æœåªæ˜¯æ ¡éªŒsqlçš„è¯­æ³•æ­£ç¡®æ€§ï¼Œå¯ä»¥é€šè¿‡explainæˆ–è€…æ‰§è¡Œä¸€ä¸‹å°±å¯ä»¥ 16. Hiveæ•°æ®é€‰æ‹©çš„ä»€ä¹ˆå‹ç¼©æ ¼å¼ ? 17. Hive SQLå¦‚ä½•è½¬åŒ–MRä»»åŠ¡ ? HiveSQL -&gt;AST(æŠ½è±¡è¯­æ³•æ ‘) -&gt; QB(æŸ¥è¯¢å—) -&gt;OperatorTreeï¼ˆæ“ä½œæ ‘ï¼‰-&gt;ä¼˜åŒ–åçš„æ“ä½œæ ‘-&gt;mapreduceä»»åŠ¡æ ‘-&gt;ä¼˜åŒ–åçš„mapreduceä»»åŠ¡æ ‘ 18. joinæ“ä½œåº•å±‚ MR æ˜¯æ€ä¹ˆæ‰§è¡Œçš„ï¼Ÿ æ ¹æ®joinå¯¹åº”çš„keyè¿›è¡Œåˆ†åŒºshuffleï¼Œç„¶åæ‰§è¡Œmapreduceé‚£å¥—æµç¨‹. 19. Parquetæ•°æ®æ ¼å¼å†…éƒ¨ç»“æ„? &nbsp; 2020 BATå¤§å‚æ•°æ®åˆ†æé¢è¯•ç»éªŒï¼šâ€œé«˜é¢‘é¢ç»â€ä¹‹æ•°æ®åˆ†æç¯‡ 1. Mysqlä¸­ç´¢å¼•æ˜¯ä»€ä¹ˆï¼Ÿå»ºç«‹ç´¢å¼•çš„ç›®çš„ï¼Ÿ 2. sqlè¯­å¥æ‰§è¡Œé¡ºåºï¼Ÿ from-on-join-where-group by-avg,sum-having 3. æ•°æ®åº“ä¸æ•°æ®ä»“åº“çš„åŒºåˆ«? 4. OLTPå’ŒOLAPçš„åŒºåˆ«ï¼Ÿ 5. è¡Œå­˜å‚¨å’Œåˆ—å­˜å‚¨çš„åŒºåˆ«? è¡Œå­˜å‚¨ï¼šä¼ ç»Ÿæ•°æ®åº“çš„å­˜å‚¨æ–¹å¼ï¼ŒåŒä¸€å¼ è¡¨å†…çš„æ•°æ®æ”¾åœ¨ä¸€èµ·ï¼Œæ’å…¥æ›´æ–°å¾ˆå¿«ã€‚ç¼ºç‚¹æ˜¯æ¯æ¬¡æŸ¥è¯¢å³ä½¿åªæ¶‰åŠå‡ åˆ—ï¼Œä¹Ÿè¦æŠŠæ‰€æœ‰æ•°æ®è¯»å–åˆ—å­˜å‚¨ï¼šOLAPç­‰æƒ…å†µä¸‹ï¼Œå°†æ•°æ®æŒ‰ç…§åˆ—å­˜å‚¨ä¼šæ›´é«˜æ•ˆï¼Œæ¯ä¸€åˆ—éƒ½å¯ä»¥æˆä¸ºç´¢å¼•ï¼ŒæŠ•å½±å¾ˆé«˜æ•ˆã€‚ç¼ºç‚¹æ˜¯æŸ¥è¯¢æ˜¯é€‰æ‹©å®Œæˆæ—¶ï¼Œéœ€è¦å¯¹é€‰æ‹©çš„åˆ—è¿›è¡Œé‡æ–°ç»„è£…ã€‚å½“ä½ çš„æ ¸å¿ƒä¸šåŠ¡æ˜¯ OLTP æ—¶ï¼Œä¸€ä¸ªè¡Œå¼æ•°æ®åº“ï¼Œå†åŠ ä¸Šä¼˜åŒ–æ“ä½œï¼Œå¯èƒ½æ˜¯ä¸ªæœ€å¥½çš„é€‰æ‹©ã€‚å½“ä½ çš„æ ¸å¿ƒä¸šåŠ¡æ˜¯ OLAP æ—¶ï¼Œä¸€ä¸ªåˆ—å¼æ•°æ®åº“ï¼Œç»å¯¹æ˜¯æ›´å¥½çš„é€‰æ‹© 6. Hiveæ‰§è¡Œæµç¨‹ï¼Ÿ 7. Hive HDFS HBaseåŒºåˆ«ï¼Ÿ Hbaseæ˜¯Hadoop databaseï¼Œå³Hadoopæ•°æ®åº“.&nbsp;&nbsp; å®ƒæ˜¯ä¸€ä¸ªé€‚åˆäºéç»“æ„åŒ–æ•°æ®å­˜å‚¨çš„æ•°æ®åº“ï¼ŒHBaseåŸºäºåˆ—çš„è€Œä¸æ˜¯åŸºäºè¡Œçš„æ¨¡å¼. 8. æ•°ä»“ä¸­ODSã€DWã€DM(Data Mart) æ¦‚å¿µåŠåŒºåˆ«ï¼Ÿ 9. çª—å£å‡½æ•°æ˜¯ä»€ä¹ˆï¼Ÿå®ç°åŸç†ï¼Ÿ çª—å£å‡½æ•°åˆåå¼€çª—å‡½æ•°ï¼Œå±äºåˆ†æå‡½æ•°çš„ä¸€ç§ã€‚ç”¨äºè§£å†³å¤æ‚æŠ¥è¡¨ç»Ÿè®¡éœ€æ±‚çš„åŠŸèƒ½å¼ºå¤§çš„å‡½æ•°ã€‚çª—å£å‡½æ•°ç”¨äºè®¡ç®—åŸºäºç»„çš„æŸç§èšåˆå€¼ï¼Œå®ƒå’Œèšåˆå‡½æ•°çš„ä¸åŒä¹‹å¤„æ˜¯ï¼šå¯¹äºæ¯ä¸ªç»„è¿”å›å¤šè¡Œï¼Œè€Œèšåˆå‡½æ•°å¯¹äºæ¯ä¸ªç»„åªè¿”å›ä¸€è¡Œ. ä¸‹é¢åˆ—ä¸¾ä¸€äº›å¸¸ç”¨çª—å£å‡½æ•°ï¼š1. è·å–æ•°æ®æ’åçš„ï¼šROW_NUMBER() RAND() DENSE_RANK() PERCENT_RANK()2. è·å–åˆ†ç»„å†…çš„ç¬¬ä¸€åæˆ–è€…æœ€åä¸€åç­‰ï¼šFIRST_VALUE() LAST_VALUE() LEAD() LAG()3. ç´¯è®¡åˆ†å¸ƒï¼švCUME_DIST() NTH_VALUE() NTILE() æ¼«è°ˆç³»åˆ— > [1. æ¼«è°ˆç³»åˆ— - æ•°ä»“ç¬¬ä¸€ç¯‡NO.1 ã€åŸºç¡€æ¶æ„ã€](https://mp.weixin.qq.com/s/J_PA_qhU44DX0PiCDuVaEA) > > [2. æ¼«è°ˆç³»åˆ— - æ•°ä»“ç¬¬äºŒç¯‡NO.2 ã€æ•°æ®æ¨¡å‹ã€](https://mp.weixin.qq.com/s/oKcCQx2vfnyAYlu7V0uHbg) > > [3. æ¼«è°ˆç³»åˆ— - æ•°ä»“ç¬¬ä¸‰ç¯‡NO.3 ã€æ•°æ®ETLã€](https://mp.weixin.qq.com/s/INerSvksPi8sreSVCA2csA) > > [4. æ¼«è°ˆç³»åˆ— - æ•°ä»“ç¬¬å››ç¯‡NO.4 ã€æ•°æ®åº”ç”¨ã€](https://mp.weixin.qq.com/s/Y1xWwJ2Jr392eRHQeBRYZQ) > > [5. æ¼«è°ˆç³»åˆ— - æ•°ä»“ç¬¬äº”ç¯‡NO.5 ã€è°ƒåº¦ç³»ç»Ÿã€](https://mp.weixin.qq.com/s/d5g-anyABYAcbYfP-jg4HQ) > > [6. æ¼«è°ˆç³»åˆ— - æ•°ä»“ç¬¬å…­ç¯‡NO.6 ã€æ•°æ®æ²»ç†ã€][0] > > [7. æ¼«è°ˆç³»åˆ— - æ¼«è°ˆæ•°ä»“ç¬¬ä¸€ç¯‡NO.7 ã€é¢è¯•çœŸç»ã€](https://mp.weixin.qq.com/s/iZs7zEb-yoiSnlG2q74Fvg) [0]: /2020/10/01/dataware/summary-dataware/ - [å…ƒæ•°æ®ç®¡ç†è§£æä»¥åŠæ•°æ®ä»“åº“å’Œä¸»æ•°æ®ä»‹ç»](https://zhuanlan.zhihu.com/p/36136675) No. | table_type | details :---: | :---: | :--- | :--- 1. | äº‹å®è¡¨ | ï¼ˆ1ï¼‰äº‹åŠ¡äº‹å®è¡¨ ï¼ˆ2ï¼‰å‘¨æœŸå¿«ç…§äº‹å®è¡¨ ï¼ˆ3ï¼‰ç´¯ç§¯å¿«ç…§äº‹å®è¡¨ 2. | ç»´åº¦è¡¨ | ï¼ˆ1ï¼‰é€€åŒ–ç»´åº¦ï¼ˆDegenerateDimensionï¼‰ ï¼ˆ2ï¼‰ç¼“æ…¢å˜åŒ–ç»´ï¼ˆSlowly Changing Dimensionsï¼‰| ç»´åº¦çš„å±æ€§å¹¶ä¸æ˜¯å§‹ç»ˆä¸å˜çš„ï¼Œå®ƒä¼šéšç€æ—¶é—´çš„æµé€å‘ç”Ÿç¼“æ…¢çš„å˜åŒ–ï¼Œè¿™ç§éšæ—¶é—´å‘ç”Ÿå˜åŒ–çš„ç»´åº¦æˆ‘ä»¬ä¸€èˆ¬ç§°ä¹‹ä¸ºç¼“æ…¢å˜åŒ–ç»´ï¼ˆSCDï¼‰ Reference SQL çª—å£å‡½æ•°çš„ä¼˜åŒ–å’Œæ‰§è¡Œ ã€ç¤¾æ‹›ã€‘å¿«æ‰‹æ•°æ®ä»“åº“é¢è¯•é¢˜æ•´ç† 2020å¹´å¤§å‚é¢è¯•é¢˜-æ•°æ®ä»“åº“ç¯‡","categories":[{"name":"data-warehouse","slug":"data-warehouse","permalink":"http://iequa.com/categories/data-warehouse/"}],"tags":[{"name":"data warehouse","slug":"data-warehouse","permalink":"http://iequa.com/tags/data-warehouse/"}]},{"title":"Spark Summary 2 - Q&A","slug":"spark/spark-summary-2-common-questions","date":"2021-01-07T23:07:21.000Z","updated":"2021-01-21T01:29:28.031Z","comments":true,"path":"2021/01/08/spark/spark-summary-2-common-questions/","link":"","permalink":"http://iequa.com/2021/01/08/spark/spark-summary-2-common-questions/","excerpt":"","text":"good - Sparkä¼šæŠŠæ•°æ®éƒ½è½½å…¥åˆ°å†…å­˜ä¹ˆï¼Ÿ Spark No. Title Flag 0. kaike - sparkSQLåº•å±‚å®ç°åŸç†spark.sql.shuffle.partitionså’Œ spark.default.parallelism çš„åŒºåˆ«SparkSQLå¹¶è¡Œåº¦å‚æ•°è®¾ç½®æ–¹æ³• 0. SparkSql - ç»“æ„åŒ–æ•°æ®å¤„ç† (ä¸Š) 0. Spark Container Executor taskä¹‹é—´çš„å…³ç³» 0. Spark æ¼«ç”» å…¨é¢è§£é‡ŠSparkä¼ä¸šè°ƒä¼˜ç‚¹ 0 Sparkå†…æ ¸åŠè°ƒä¼˜ &nbsp; 1. RDD å±æ€§ï¼Ÿ 5å¤§å±æ€§ â 2. ç®—å­åˆ†ä¸ºå“ªå‡ ç±»(RDDæ”¯æŒå“ªå‡ ç§ç±»å‹çš„æ“ä½œ) &nbsp;&nbsp;&nbsp;&nbsp; 1. Transformation ï¼ˆlazyæ¨¡å¼ï¼‰2. Action â 3. åˆ›å»ºrddçš„å‡ ç§æ–¹å¼ â 4. sparkè¿è¡Œæµç¨‹ â 5. Sparkä¸­coalesceä¸repartitionçš„åŒºåˆ« â 6. sortBy å’Œ sortByKeyçš„åŒºåˆ« â 7. mapå’ŒmapPartitionsçš„åŒºåˆ« sc.parallelize([1, 2, 3, 4]).mapPartitions(func).collect() â 8. æ•°æ®å­˜å…¥Redis ä¼˜å…ˆä½¿ç”¨map mapPartitions foreach foreachPartions ? def f(x): print(x) sc.parallelize([1, 2, 3, 4, 5]).foreach(f) â 9. reduceByKeyå’ŒgroupBykeyçš„åŒºåˆ« â 10. cacheå’ŒcheckPointçš„æ¯”è¾ƒ : éƒ½æ˜¯åš RDD æŒä¹…åŒ–çš„ â 11. ç®€è¿°mapå’ŒflatMapçš„åŒºåˆ«å’Œåº”ç”¨åœºæ™¯ &nbsp;&nbsp;&nbsp;&nbsp; mapæ˜¯å¯¹æ¯ä¸ªå…ƒç´ è¿›è¡Œæ“åšï¼Œflatmapæ˜¯å¯¹æ¯ä¸ªå…ƒç´ æ“åšåå¹¶å‹å¹³. â 12. è®¡ç®—æ›å…‰æ•°å’Œç‚¹å‡»æ•° 13. åˆ†åˆ«åˆ—å‡ºå‡ ä¸ªå¸¸ç”¨çš„transformationå’Œactionç®—å­ â 17. Sparkåº”ç”¨æ‰§è¡Œæœ‰å“ªäº›æ¨¡å¼ï¼Œå…¶ä¸­å“ªå‡ ç§æ˜¯é›†ç¾¤æ¨¡å¼ â 18. è¯·è¯´æ˜sparkä¸­å¹¿æ’­å˜é‡çš„ç”¨é€” ?ï¼ˆ1ï¼‰broadcast (ä¸èƒ½æ”¹)ï¼ˆ2ï¼‰accumulator, sc.accumulator(0) ä½¿ç”¨å¹¿æ’­å˜é‡ï¼Œæ¯ä¸ª Executor çš„å†…å­˜ä¸­ï¼Œåªé©»ç•™ä¸€ä»½å˜é‡å‰¯æœ¬ï¼Œè€Œä¸æ˜¯å¯¹ æ¯ä¸ª task éƒ½ä¼ è¾“ä¸€æ¬¡å¤§å˜é‡ï¼Œçœäº†å¾ˆå¤šçš„ç½‘ç»œä¼ è¾“ï¼Œ å¯¹æ€§èƒ½æå‡å…·æœ‰å¾ˆå¤§å¸®åŠ©ï¼Œ è€Œä¸”ä¼šé€šè¿‡é«˜æ•ˆçš„å¹¿æ’­ç®—æ³•æ¥å‡å°‘ä¼ è¾“ä»£ä»·.mapper = &#123;&#39;dog&#39;:1&#125;, bc=sc.broadcast(mapper), bc.value: &#123;&#39;dog&#39;:1&#125; mapper = &#123;&#39;pig&#39;: 3&#125; , bc.unpersist(), sc.broadcast(mapper).value 2.2 rdd-programming-guide.html#broadcast-variables â 20. Sparké«˜é¢‘è€ƒç‚¹: å†™å‡ºä½ ç”¨è¿‡çš„sparkä¸­çš„ç®—å­ï¼Œå…¶ä¸­å“ªäº›ä¼šäº§ç”Ÿshuffleè¿‡ç¨‹ 1. reduceBykey 2. groupByKey 3. â€¦ByKey â 21. good - Sparkå­¦ä¹ ä¹‹è·¯ ï¼ˆä¸‰ï¼‰Sparkä¹‹RDD æ‰å¿ƒäº†è€é“ â 22. è¯·å†™å‡ºåˆ›å»ºDatesetçš„å‡ ç§æ–¹å¼ 1. å¸¸ç”¨çš„æ–¹å¼é€šè¿‡sparksessionè¯»å–å¤–éƒ¨æ–‡ä»¶æˆ–è€…æ•°æ®ç”Ÿæˆdataset 2. é€šè¿‡è°ƒç”¨createDataFrameç”ŸæˆDataset df.select(&quot;name&quot;).show()df.select(df[&#39;name&#39;], df[&#39;age&#39;] + 1).show() df.filter(df[&#39;age&#39;] &gt; 21).show() df.groupBy(&quot;age&quot;).count().show() df.createOrReplaceTempView(&quot;people&quot;) sqlDF = spark.sql(&quot;SELECT * FROM people&quot;) sqlDF.show() teenNames = teenagers.rdd.map(lambda p: â€œName: â€œ + p.name).collect() â 23. æè¿°ä¸€ä¸‹ RDDï¼ŒDataFrameï¼ŒDataSet çš„åŒºåˆ«ï¼Ÿ DataSet ç»“åˆäº† RDD å’Œ DataFrame çš„ä¼˜åŠ¿ï¼Œå¹¶å¸¦æ¥çš„ä¸€ä¸ªæ–°çš„æ¦‚å¿µ Encoderã€‚ å½“åºåˆ—åŒ–æ•°æ®æ—¶ï¼ŒEncoder äº§ç”Ÿå­—èŠ‚ç ä¸ off-heap è¿›è¡Œäº¤äº’ï¼Œå¯ä»¥è¾¾åˆ°æŒ‰éœ€è®¿é—®æ•°æ®çš„æ•ˆæœï¼Œè€Œä¸ç”¨ååºåˆ—åŒ–æ•´ä¸ªå¯¹è±¡ã€‚Spark å°šæœªæä¾›è‡ªå®šä¹‰ Encoder çš„ APIï¼Œå¯æ˜¯å°†æ¥ä¼šåŠ å…¥ Apache spark DataFrame &amp; Dataset â 24. æè¿°ä¸€ä¸‹Sparkä¸­stageæ˜¯å¦‚ä½•åˆ’åˆ†çš„ï¼Ÿæè¿°ä¸€ä¸‹shuffleçš„æ¦‚å¿µ âœ”ï¸â 25. Spark åœ¨yarnä¸Šè¿è¡Œéœ€è¦åšå“ªäº›å…³é”®çš„é…ç½®å·¥ä½œï¼Ÿ å¦‚ä½•kill -ä¸ªSparkåœ¨yarnè¿è¡Œä¸­Application: yarn application -kill &lt;appId&gt; ä½†æ˜¯è¿™æ ·ä¼šå¯¼è‡´ç«¯å£åœ¨ä¸€æ®µæ—¶é—´ï¼ˆ24å°æ—¶ï¼‰å†…è¢«å ç”¨ â 26. é€šå¸¸æ¥è¯´ï¼ŒSparkä¸MapReduceç›¸æ¯”ï¼ŒSparkè¿è¡Œæ•ˆç‡æ›´é«˜ã€‚è¯·è¯´æ˜æ•ˆç‡æ›´é«˜æ¥æºäºSparkå†…ç½®çš„å“ªäº›æœºåˆ¶ï¼Ÿå¹¶è¯·åˆ—ä¸¾å¸¸è§sparkçš„è¿è¡Œæ¨¡å¼ï¼Ÿ â 27. RDDä¸­çš„æ•°æ®åœ¨å“ªï¼Ÿ ä¸å¯å˜çš„æ„æ€æ˜¯RDDä¸­çš„æ¯ä¸ªåˆ†åŒºæ•°æ®æ˜¯ only-read RDDè¦åšé€»è¾‘åˆ†åŒºï¼ˆè¿™é‡Œçš„åˆ†åŒºç±»ä¼¼hadoopä¸­çš„é€»è¾‘åˆ‡ç‰‡splitï¼‰ï¼Œæ¯ä¸ªåˆ†åŒºå¯å•ç‹¬åœ¨é›†ç¾¤èŠ‚ç‚¹è®¡ç®— â 28. å¦‚æœå¯¹RDDè¿›è¡Œcacheæ“ä½œåï¼Œæ•°æ®åœ¨å“ªé‡Œï¼Ÿ 1. æ‰§è¡Œcacheç®—å­æ—¶æ•°æ®ä¼šè¢«åŠ è½½åˆ°å„ä¸ªExecutorè¿›ç¨‹çš„å†…å­˜. 2. ç¬¬äºŒæ¬¡ä½¿ç”¨ ä¼šç›´æ¥ä»å†…å­˜ä¸­è¯»å–è€Œä¸ä¼šåŒºç£ç›˜. â 29. Sparkä¸­Partitionçš„æ•°é‡ç”±ä»€ä¹ˆå†³å®š? ç­”ï¼š å’ŒMRä¸€æ ·ï¼Œä½†æ˜¯Sparké»˜è®¤æœ€å°‘æœ‰ä¸¤ä¸ªåˆ†åŒº. â 30. Sparkåˆ¤æ–­Shuffleçš„ä¾æ®? â 35. Sparkcontextçš„ä½œç”¨? â 36. Spark SQL åœ¨ Spark Core çš„åŸºç¡€ä¸Šé’ˆå¯¹ç»“æ„åŒ–æ•°æ®å¤„ç†è¿›è¡Œå¾ˆå¤šä¼˜åŒ–å’Œæ”¹è¿›. â 37. ç®€è¿°å®½ä¾èµ–å’Œçª„ä¾èµ–æ¦‚å¿µï¼ŒgroupByKey,reduceByKey,map,filter,unionäº”ç§æ“ä½œ â 38. æ•°æ®å€¾æ–œå¯èƒ½ä¼šå¯¼è‡´å“ªäº›é—®é¢˜ï¼Œå¦‚ä½•ç›‘æ§å’Œæ’æŸ¥ï¼Œåœ¨è®¾è®¡ä¹‹åˆï¼Œè¦è€ƒè™‘å“ªäº›æ¥é¿å… â 39. ç®€è¿°å®½ä¾èµ–å’Œçª„ä¾èµ–æ¦‚å¿µï¼ŒgroupByKey,reduceByKey,map,filter,unionäº”ç§æ“ä½œ. â 41. æœ‰ä¸€åƒä¸‡æ¡çŸ­ä¿¡ï¼Œæœ‰é‡å¤ï¼Œä»¥æ–‡æœ¬æ–‡ä»¶çš„å½¢å¼ä¿å­˜ï¼Œä¸€è¡Œä¸€æ¡æ•°æ®ï¼Œè¯·ç”¨äº”åˆ†é’Ÿæ—¶é—´ï¼Œæ‰¾å‡ºé‡å¤å‡ºç°æœ€å¤šçš„å‰10æ¡ 42. ç°æœ‰ä¸€æ–‡ä»¶ï¼Œæ ¼å¼å¦‚ä¸‹ï¼Œè¯·ç”¨sparkç»Ÿè®¡æ¯ä¸ªå•è¯å‡ºç°çš„æ¬¡æ•° â 45. ç‰¹åˆ«å¤§çš„æ•°æ®ï¼Œæ€ä¹ˆå‘é€åˆ°excutorä¸­ï¼Ÿ Answï¼š broadcast â 46. sparkè°ƒä¼˜éƒ½åšè¿‡å“ªäº›æ–¹é¢ï¼Ÿ è¦éå¸¸å…·ä½“çš„åœºæ™¯ â 47. sparkä»»åŠ¡ä¸ºä»€ä¹ˆä¼šè¢«yarn killæ‰ï¼Ÿ â 48. Spark on Yarnä½œä¸šæ‰§è¡Œæµç¨‹ï¼Ÿyarn-clientå’Œyarn-clusteræœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ â 49. sparkä¸­çš„cache() persist() checkpoint()ä¹‹é—´çš„åŒºåˆ« 1. checkpoint çš„ RDD ä¼šè¢«è®¡ç®—ä¸¤æ¬¡ 2. rdd.persist(StorageLevel.DISK_ONLY), partition ç”± blockManager ç®¡ç†, blockManager stop, cache åˆ°ç£ç›˜ä¸Š RDD ä¹Ÿä¼šè¢«æ¸…ç©º 3. checkpoint å°† RDD æŒä¹…åŒ–åˆ° HDFS æˆ–æœ¬åœ°æ–‡ä»¶å¤¹, å¯ä»¥è¢«ä¸‹ä¸€ä¸ª driver program ä½¿ç”¨. â 50. sparkç®—å­è°ƒä¼˜å››ï¼šrepartitionè§£å†³SparkSQLä½å¹¶è¡Œåº¦é—®é¢˜ ä½ è‡ªå·±é€šè¿‡spark.default.parallelismå‚æ•°æŒ‡å®šçš„å¹¶è¡Œåº¦ï¼Œåªä¼šåœ¨æ²¡æœ‰spark sqlçš„stageä¸­ç”Ÿæ•ˆ hiveè¡¨ï¼Œå¯¹åº”äº†ä¸€ä¸ªhdfsæ–‡ä»¶ï¼Œæœ‰20ä¸ªblock;ä½ è‡ªå·±è®¾ç½®äº†spark.default.parallelishå‚æ•°ä¸º100ï¼›ä½ çš„ç¬¬ä¸€ä¸ªstageçš„å¹¶è¡Œåº¦ï¼Œæ˜¯ä¸å—ä½ è®¾ç½®çš„å‚æ•°æ§åˆ¶çš„ï¼Œå°±åªæœ‰20task 51. very good å¤šå¼—æœ—æ˜å“¥ -ã€å¤§æ•°æ®ã€‘Sparkæ€§èƒ½ä¼˜åŒ–å’Œæ•…éšœå¤„ç† ç®—å­è°ƒä¼˜ä¸‰ï¼šfilterä¸coalesceçš„é…åˆä½¿ç”¨ç®—å­è°ƒä¼˜å››ï¼šrepartitionè§£å†³SparkSQLä½å¹¶è¡Œåº¦é—®é¢˜ç®—å­è°ƒä¼˜äº”ï¼šreduceByKeyæœ¬åœ°èšåˆ # Register the DataFrame as a SQL temporary viewdf.createOrReplaceTempView(&quot;people&quot;)sqlDF = spark.sql(&quot;SELECT * FROM people&quot;)sqlDF.show()# +----+-------+# | age| name|# +----+-------+# |null|Michael|# | 30| Andy|# | 19| Justin|# +----+-------+ 1. RDD å±æ€§ A list of partitions A function for computing each split A list of dependencies on other RDDs Optionally, a Partitioner for key-value RDDs (e.g. to say that the RDD is hash-partitioned) Optionally, a list of preferred locations to compute each split on (block locations for an HDFS file) very good Sparkåˆ†åŒº partition è¯¦è§£ No. Title Flag 1. ä¸€ç»„åˆ†ç‰‡ï¼ˆPartitionï¼‰ï¼Œå³æ•°æ®é›†çš„åŸºæœ¬ç»„æˆå•ä½ã€‚å¯¹äºRDDæ¥è¯´ï¼Œæ¯ä¸ªåˆ†ç‰‡éƒ½ä¼šè¢«ä¸€ä¸ªè®¡ç®—ä»»åŠ¡å¤„ç†ï¼Œå¹¶å†³å®šå¹¶è¡Œè®¡ç®—çš„ç²’åº¦ã€‚ç”¨æˆ·å¯ä»¥åœ¨åˆ›å»ºRDDæ—¶æŒ‡å®šRDDçš„åˆ†ç‰‡ä¸ªæ•°ï¼Œå¦‚æœæ²¡æœ‰æŒ‡å®šï¼Œé‚£ä¹ˆå°±ä¼šé‡‡ç”¨é»˜è®¤å€¼ã€‚é»˜è®¤å€¼å°±æ˜¯ç¨‹åºæ‰€åˆ†é…åˆ°çš„CPU Coreçš„æ•°ç›®ã€‚ â 2. ä¸€ä¸ªè®¡ç®—æ¯ä¸ªåˆ†åŒºçš„å‡½æ•°ã€‚Sparkä¸­RDDçš„è®¡ç®—æ˜¯ä»¥åˆ†ç‰‡ä¸ºå•ä½çš„ï¼Œæ¯ä¸ªRDDéƒ½ä¼šå®ç°computeå‡½æ•°ä»¥è¾¾åˆ°è¿™ä¸ªç›®çš„ã€‚computeå‡½æ•°ä¼šå¯¹è¿­ä»£å™¨è¿›è¡Œå¤åˆï¼Œä¸éœ€è¦ä¿å­˜æ¯æ¬¡è®¡ç®—çš„ç»“æœã€‚ â 3. RDDä¹‹é—´çš„ä¾èµ–å…³ç³»ã€‚RDDçš„æ¯æ¬¡è½¬æ¢éƒ½ä¼šç”Ÿæˆä¸€ä¸ªæ–°çš„RDDï¼Œæ‰€ä»¥RDDä¹‹é—´å°±ä¼šå½¢æˆç±»ä¼¼äºæµæ°´çº¿ä¸€æ ·çš„å‰åä¾èµ–å…³ç³»ã€‚åœ¨éƒ¨åˆ†åˆ†åŒºæ•°æ®ä¸¢å¤±æ—¶ï¼ŒSparkå¯ä»¥é€šè¿‡è¿™ä¸ªä¾èµ–å…³ç³»é‡æ–°è®¡ç®—ä¸¢å¤±çš„åˆ†åŒºæ•°æ®ï¼Œè€Œä¸æ˜¯å¯¹RDDçš„æ‰€æœ‰åˆ†åŒºè¿›è¡Œé‡æ–°è®¡ç®—ã€‚ â 4. ä¸€ä¸ªPartitionerï¼Œå³RDDçš„åˆ†ç‰‡å‡½æ•°ã€‚å½“å‰Sparkä¸­å®ç°äº†ä¸¤ç§ç±»å‹çš„åˆ†ç‰‡å‡½æ•°ï¼Œä¸€ä¸ªæ˜¯åŸºäºå“ˆå¸Œçš„HashPartitionerï¼Œå¦å¤–ä¸€ä¸ªæ˜¯åŸºäºèŒƒå›´çš„RangePartitionerã€‚åªæœ‰å¯¹äºäºkey-valueçš„RDDï¼Œæ‰ä¼šæœ‰Partitionerï¼Œékey-valueçš„RDDçš„Parititionerçš„å€¼æ˜¯Noneã€‚Partitionerå‡½æ•°ä¸ä½†å†³å®šäº†RDDæœ¬èº«çš„åˆ†ç‰‡æ•°é‡ï¼Œä¹Ÿå†³å®šäº†parent RDD Shuffleè¾“å‡ºæ—¶çš„åˆ†ç‰‡æ•°é‡ã€‚ â 5. ä¸€ä¸ªåˆ—è¡¨ï¼Œå­˜å‚¨å­˜å–æ¯ä¸ªPartitionçš„ä¼˜å…ˆä½ç½®ï¼ˆpreferred locationï¼‰ã€‚å¯¹äºä¸€ä¸ªHDFSæ–‡ä»¶æ¥è¯´ï¼Œè¿™ä¸ªåˆ—è¡¨ä¿å­˜çš„å°±æ˜¯æ¯ä¸ªPartitionæ‰€åœ¨çš„å—çš„ä½ç½®ã€‚æŒ‰ç…§â€œç§»åŠ¨æ•°æ®ä¸å¦‚ç§»åŠ¨è®¡ç®—â€çš„ç†å¿µï¼ŒSparkåœ¨è¿›è¡Œä»»åŠ¡è°ƒåº¦çš„æ—¶å€™ï¼Œä¼šå°½å¯èƒ½åœ°å°†è®¡ç®—ä»»åŠ¡åˆ†é…åˆ°å…¶æ‰€è¦å¤„ç†æ•°æ®å—çš„å­˜å‚¨ä½ç½® â å°½é‡ä¿è¯æ¯è½®Stageé‡Œæ¯ä¸ªtaskå¤„ç†çš„æ•°æ®é‡&gt;128M 2. RDDæ”¯æŒçš„æ“ä½œ No. Title Flag 1. Transformationï¼š ç°æœ‰çš„RDDé€šè¿‡è½¬æ¢ç”Ÿæˆä¸€ä¸ªæ–°çš„RDDã€‚lazyæ¨¡å¼ï¼Œå»¶è¿Ÿæ‰§è¡Œã€‚ mapï¼Œfilterï¼ŒflatMapï¼ŒgroupByKeyï¼ŒreduceByKeyï¼ŒaggregateByKeyï¼Œunion,join, coalesce. â 2. Actionï¼š åœ¨RDDä¸Šè¿è¡Œè®¡ç®—ï¼Œå¹¶è¿”å›ç»“æœç»™é©±åŠ¨ç¨‹åº(Driver)æˆ–å†™å…¥æ–‡ä»¶ç³»ç»Ÿ. reduceï¼Œcollectï¼Œcountï¼Œfirstï¼Œtakeï¼ŒcountByKey åŠ foreach ç­‰ç­‰. â è¯´æ˜ collect è¯¥æ–¹æ³•æŠŠæ•°æ®æ”¶é›†åˆ°driverç«¯ Arrayæ•°ç»„ç±»å‹, transformationåªæœ‰é‡åˆ°actionæ‰èƒ½è¢«æ‰§è¡Œ. â å½“æ‰§è¡Œactionä¹‹åï¼Œæ•°æ®ç±»å‹ä¸å†æ˜¯rddäº†ï¼Œæ•°æ®å°±ä¼šå­˜å‚¨åˆ°æŒ‡å®šæ–‡ä»¶ç³»ç»Ÿä¸­ï¼Œæˆ–è€…ç›´æ¥æ‰“å°ç»“ æœæˆ–è€…æ”¶é›†èµ·æ¥. 3. åˆ›å»ºrddçš„å‡ ç§æ–¹å¼1.é›†åˆå¹¶è¡ŒåŒ–åˆ›å»º(æœ‰æ•°æ®) val arr = Array(1,2,3,4,5)val rdd = sc.parallelize(arr)val rdd =sc.makeRDD(arr) 2.è¯»å–å¤–éƒ¨æ–‡ä»¶ç³»ç»Ÿï¼Œå¦‚hdfsï¼Œæˆ–è€…è¯»å–æœ¬åœ°æ–‡ä»¶(æœ€å¸¸ç”¨çš„æ–¹å¼)(æ²¡æ•°æ®) val rdd2 = sc.textFile(&quot;hdfs://hdp-01:9000/words.txt&quot;)// è¯»å–æœ¬åœ°æ–‡ä»¶val rdd2 = sc.textFile(â€œfile:///root/words.txtâ€) 3.ä»çˆ¶RDDè½¬æ¢æˆæ–°çš„å­RDD è°ƒç”¨Transformationç±»çš„æ–¹æ³•ï¼Œç”Ÿæˆæ–°çš„RDD 5. coalesce, repartitionåŒºåˆ« repartition åº•å±‚è°ƒç”¨çš„å°±æ˜¯ coalesce æ–¹æ³•ï¼šcoalesce(numPartitions, shuffle = true) repartition ä¸€å®šä¼šå‘ç”Ÿ shuffleï¼Œcoalesce æ ¹æ®ä¼ å…¥çš„å‚æ•°æ¥åˆ¤æ–­æ˜¯å¦å‘ç”Ÿ shuffle ä¸€èˆ¬æƒ…å†µä¸‹å¢å¤§ rdd çš„ partition æ•°é‡ä½¿ç”¨ repartitionï¼Œå‡å°‘ partition æ•°é‡æ—¶ä½¿ç”¨coalesce 6. sortBy / sortByKeyåŒºåˆ« sortByæ—¢å¯ä»¥ä½œç”¨äºRDD[K] ï¼Œè¿˜å¯ä»¥ä½œç”¨äºRDD[(k,v)] sortByKey åªèƒ½ä½œç”¨äº RDD[K,V] ç±»å‹ä¸Š sortBy : sortBy(lambda x:x[2],ascending = False) #ä»»åŠ¡ï¼šæœ‰ä¸€æ‰¹å­¦ç”Ÿä¿¡æ¯è¡¨æ ¼ï¼ŒåŒ…æ‹¬name,age,score, æ‰¾å‡ºscoreæ’åå‰3çš„å­¦ç”Ÿ, scoreç›¸åŒå¯ä»¥ä»»å–students = [(&quot;LiLei&quot;,18,87),(&quot;HanMeiMei&quot;,16,77),(&quot;DaChui&quot;,16,66),(&quot;Jim&quot;,18,77),(&quot;RuHua&quot;,18,50)]rdd_students = sc.parallelize(students)rdd_sorted = rdd_students.sortBy(lambda x:x[2],ascending = False)# [(â€˜LiLeiâ€™, 18, 87), (â€˜HanMeiMeiâ€™, 16, 77), (â€˜Jimâ€™, 18, 77)] sortByKey : sortByKey().map(lambda x:x[0]) #ä»»åŠ¡ï¼šæŒ‰ä»å°åˆ°å¤§æ’åºå¹¶è¿”å›åºå·, å¤§å°ç›¸åŒçš„åºå·å¯ä»¥ä¸åŒdata = [1,7,8,5,3,18,34,9,0,12,8]rdd_data = sc.parallelize(data)rdd_sorted = rdd_data.map(lambda x:(x,1)).sortByKey().map(lambda x:x[0]) # [0, 1, 3, 5, 7, 8, 8, 9, 12, 18, 34] 7. mapå’ŒmapPartitionsçš„åŒºåˆ« 8. æ•°æ®å­˜å…¥Redis ä¼˜å…ˆä½¿ç”¨ä»€ä¹ˆç®—å­?foreachPartions map mapPartitions foreach foreachPartions from pyspark import SparkFilespath = os.path.join(tempdir, &quot;test.txt&quot;)with open(path, &quot;w&quot;) as testFile: _ = testFile.write(&quot;100&quot;)sc.addFile(path)def func(iterator): with open(SparkFiles.get(&quot;test.txt&quot;)) as testFile: fileVal = int(testFile.readline()) return [x * fileVal for x in iterator]sc.parallelize([1, 2, 3, 4]).mapPartitions(func).collect()[100, 200, 300, 400] ä½¿ç”¨ foreachPartions map mapPartitions æ˜¯è½¬æ¢ç±»çš„ç®—å­ï¼Œ æœ‰è¿”å›å€¼ å†™mysql,redis çš„é“¾æ¥ pyspark.html # foreach(f)[source]# Applies a function to all elements of this RDD.def f(x): print(x)sc.parallelize([1, 2, 3, 4, 5]).foreach(f)foreachPartition(f)[source]#Applies a function to each partition of this RDD.def f(iterator): for x in iterator: print(x)sc.parallelize([1, 2, 3, 4, 5]).foreachPartition(f) 9. reduceByKeyå’ŒgroupBykeyåŒºåˆ« reduceByKeyä¼šä¼ ä¸€ä¸ªèšåˆå‡½æ•°ï¼Œ è‡³å…³äº groupByKey + mapValues reduceByKey ä¼šæœ‰ä¸€ä¸ªåˆ†åŒºå†…èšåˆï¼Œè€ŒgroupByKeyæ²¡æœ‰ æœ€æ ¸å¿ƒçš„åŒºåˆ« ç»“è®ºï¼šreduceByKeyæœ‰åˆ†åŒºå†…èšåˆï¼Œæ›´é«˜æ•ˆï¼Œä¼˜å…ˆé€‰æ‹©ä½¿ç”¨reduceByKey 10. cacheå’ŒcheckPointçš„æ¯”è¾ƒéƒ½æ˜¯ä½œ RDD æŒä¹…åŒ–çš„ 1.ç¼“å­˜ï¼Œæ˜¯åœ¨è§¦å‘actionä»¥åï¼ŒæŠŠæ•°æ®å†™å…¥åˆ°å†…å­˜æˆ–è€…ç£ç›˜ä¸­ã€‚ä¸ä¼šæˆªæ–­è¡€ç¼˜å…³ç³» ï¼ˆè®¾ç½®ç¼“å­˜çº§åˆ«ä¸ºmemory_onlyï¼šå†…å­˜ä¸è¶³ï¼Œåªä¼šéƒ¨åˆ†ç¼“å­˜æˆ–è€…æ²¡æœ‰ç¼“å­˜ï¼Œç¼“å­˜ä¼šä¸¢å¤±,memory_and_disk :å†…å­˜ä¸è¶³ï¼Œä¼šä½¿ç”¨ç£ç›˜ï¼‰ 2.checkpoint ä¹Ÿæ˜¯åœ¨è§¦å‘actionä»¥åï¼Œæ‰§è¡Œä»»åŠ¡ã€‚å•ç‹¬å†å¯åŠ¨ä¸€ä¸ªjobï¼Œè´Ÿè´£å†™å…¥æ•°æ®åˆ°hdfsä¸­ã€‚ï¼ˆæŠŠrddä¸­çš„æ•°æ®ï¼Œä»¥äºŒè¿›åˆ¶æ–‡æœ¬çš„æ–¹å¼å†™å…¥åˆ°hdfsä¸­ï¼Œæœ‰å‡ ä¸ªåˆ†åŒºï¼Œå°±æœ‰å‡ ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶ï¼‰ 3.æŸä¸€ä¸ªRDDè¢«checkpointä»¥åï¼Œä»–çš„çˆ¶ä¾èµ–å…³ç³»ä¼šè¢«åˆ é™¤ï¼Œè¡€ç¼˜å…³ç³»è¢«æˆªæ–­ï¼Œè¯¥RDDè½¬æ¢æˆäº†CheckPointRDDï¼Œä¹‹åå†å¯¹è¯¥rddçš„å…¨éƒ¨æ“åšï¼Œéƒ½æ˜¯ä»hdfsä¸­çš„checkpointçš„å…·ä½“ç›®å½•æ¥è¯»å–æ•°æ®ã€‚ç¼“å­˜ä»¥åï¼Œrddçš„ä¾èµ–å…³ç³»ä»æ˜¯å­˜åœ¨çš„ã€‚ checkpoint sc.setCheckpointDir(â€œ/Users/xulijie/Documents/data/checkpointâ€) val pairs = sc.parallelize(data, 3) pairs.checkpoint Cache Cache(): è¿ç®—æ—¶é—´å¾ˆé•¿æˆ–è¿ç®—é‡å¤ªå¤§æ‰èƒ½å¾—åˆ°çš„ RDDï¼Œcomputing chain è¿‡é•¿æˆ–ä¾èµ–å…¶ä»– RDD å¾ˆå¤šçš„ RDD. df2.cache()rdd2.cache() cache æœºåˆ¶æ˜¯æ¯è®¡ç®—å‡ºä¸€ä¸ªè¦ cache çš„ partition å°±ç›´æ¥å°†å…¶ cache åˆ°å†…å­˜äº†ã€‚ä½† checkpoint æ²¡æœ‰ä½¿ç”¨è¿™ç§ç¬¬ä¸€æ¬¡è®¡ç®—å¾—åˆ°å°±å­˜å‚¨çš„æ–¹æ³•ï¼Œè€Œæ˜¯ç­‰åˆ° job ç»“æŸåå¦å¤–å¯åŠ¨ä¸“é—¨çš„ job å»å®Œæˆ checkpoint ã€‚ ä¹Ÿå°±æ˜¯è¯´éœ€è¦ checkpoint çš„ RDD ä¼šè¢«è®¡ç®—ä¸¤æ¬¡ã€‚å› æ­¤ï¼Œåœ¨ä½¿ç”¨ rdd.checkpoint() çš„æ—¶å€™ï¼Œå»ºè®®åŠ ä¸Š rdd.cache()ï¼Œ è¿™æ ·ç¬¬äºŒæ¬¡è¿è¡Œçš„ job å°±ä¸ç”¨å†å»è®¡ç®—è¯¥ rdd äº†ï¼Œç›´æ¥è¯»å– cache å†™ç£ç›˜ã€‚ Hadoop vs Spark åŒºåˆ«Sparkæ¯”MapReduceè¿è¡Œé€Ÿåº¦å¿«çš„åŸå› ä¸»è¦æœ‰ä»¥ä¸‹å‡ ç‚¹ï¼š taskå¯åŠ¨æ—¶é—´æ¯”è¾ƒå¿«ï¼ŒSparkæ˜¯forkå‡ºçº¿ç¨‹ï¼›è€ŒMRæ˜¯å¯åŠ¨ä¸€ä¸ªæ–°çš„è¿›ç¨‹ï¼› æ›´å¿«çš„shufflesï¼ŒSparkåªæœ‰åœ¨shuffleçš„æ—¶å€™æ‰ä¼šå°†æ•°æ®æ”¾åœ¨ç£ç›˜ï¼Œè€ŒMRå´ä¸æ˜¯ã€‚ æ›´å¿«çš„å·¥ä½œæµï¼šå…¸å‹çš„MRå·¥ä½œæµæ˜¯ç”±å¾ˆå¤šMRä½œä¸šç»„æˆçš„ï¼Œä»–ä»¬ä¹‹é—´çš„æ•°æ®äº¤äº’éœ€è¦æŠŠæ•°æ®æŒä¹…åŒ–åˆ°ç£ç›˜æ‰å¯ä»¥ï¼›è€ŒSparkæ”¯æŒDAGä»¥åŠpipeliningï¼Œåœ¨æ²¡æœ‰é‡åˆ°shuffleå®Œå…¨å¯ä»¥ä¸æŠŠæ•°æ®ç¼“å­˜åˆ°ç£ç›˜ã€‚ç¼“å­˜ï¼šè™½ç„¶ç›®å‰HDFSä¹Ÿæ”¯æŒç¼“å­˜ï¼Œä½†æ˜¯ä¸€èˆ¬æ¥è¯´ï¼ŒSparkçš„ç¼“å­˜åŠŸèƒ½æ›´åŠ é«˜æ•ˆï¼Œç‰¹åˆ«æ˜¯åœ¨SparkSQLä¸­ï¼Œæˆ‘ä»¬å¯ä»¥å°†æ•°æ®ä»¥åˆ—å¼çš„å½¢å¼å‚¨å­˜åœ¨å†…å­˜ä¸­ã€‚ æ‰€æœ‰çš„è¿™äº›åŸå› æ‰ä½¿å¾—Sparkç›¸æ¯”Hadoopæ‹¥æœ‰æ›´å¥½çš„æ€§èƒ½è¡¨ç°ï¼›åœ¨æ¯”è¾ƒçŸ­çš„ä½œä¸šç¡®å®èƒ½å¿«ä¸Š100å€ï¼Œä½†æ˜¯åœ¨çœŸå®çš„ç”Ÿäº§ç¯å¢ƒä¸‹ï¼Œä¸€èˆ¬åªä¼šå¿« 2.5x ~ 3xï¼ JVM çš„ä¼˜åŒ–: Hadoop æ¯æ¬¡ MapReduce æ“ä½œï¼Œå¯åŠ¨ä¸€ä¸ª Task ä¾¿ä¼šå¯åŠ¨ä¸€æ¬¡ JVMï¼ŒåŸºäºè¿›ç¨‹çš„æ“ä½œã€‚è€Œ Spark æ¯æ¬¡ MapReduce æ“ä½œæ˜¯åŸºäºçº¿ç¨‹çš„ï¼ŒSpark åªåœ¨å¯åŠ¨ Executor æ˜¯å¯åŠ¨ä¸€æ¬¡ JVMï¼Œå†…å­˜çš„ Task æ“ä½œæ˜¯åœ¨çº¿ç¨‹å¤ç”¨çš„ã€‚æ¯æ¬¡å¯åŠ¨ JVM çš„æ—¶é—´å¯èƒ½å°±éœ€è¦å‡ ç§’ç”šè‡³åå‡ ç§’ï¼Œé‚£ä¹ˆå½“ Task å¤šäº†ï¼Œè¿™ä¸ªæ—¶é—´ Hadoop ä¸çŸ¥é“æ¯” Spark æ…¢äº†å¤šã€‚ Reference very good å¤šå¼—æœ—æ˜å“¥ -ã€å¤§æ•°æ®ã€‘Sparkæ€§èƒ½ä¼˜åŒ–å’Œæ•…éšœå¤„ç† good - Sparkåˆ†åŒº partition è¯¦è§£ good - 2020å¤§æ•°æ®/æ•°ä»“/æ•°å¼€é¢è¯•é¢˜çœŸé¢˜æ€»ç»“(é™„ç­”æ¡ˆ) 2020å¤§æ•°æ®/æ•°ä»“/æ•°å¼€é¢è¯•é¢˜çœŸé¢˜æ€»ç»“(é™„ç­”æ¡ˆ) sparkä¸­çš„cache() persist() checkpoint()ä¹‹é—´çš„åŒºåˆ« airflowçš„ä½¿ç”¨æ–¹æ³• other: å‰–æSparkæ•°æ®åˆ†åŒºä¹‹Hadoopåˆ†ç‰‡","categories":[{"name":"spark","slug":"spark","permalink":"http://iequa.com/categories/spark/"}],"tags":[{"name":"spark","slug":"spark","permalink":"http://iequa.com/tags/spark/"}]},{"title":"Spark Functions","slug":"spark/spark-review-functions","date":"2021-01-07T12:07:21.000Z","updated":"2021-01-22T00:43:42.642Z","comments":true,"path":"2021/01/07/spark/spark-review-functions/","link":"","permalink":"http://iequa.com/2021/01/07/spark/spark-review-functions/","excerpt":"","text":"spark å­¦ä¹ ç¬”è®° sample ç®—å­ æœ‰æ”¾å›å–æ ·0.001%data.sample(true,0.00001).collect().foreach(println) Reference","categories":[{"name":"spark","slug":"spark","permalink":"http://iequa.com/categories/spark/"}],"tags":[{"name":"spark","slug":"spark","permalink":"http://iequa.com/tags/spark/"}]},{"title":"Spark Practice","slug":"spark/python-spark-practice","date":"2021-01-05T23:07:21.000Z","updated":"2021-01-07T07:42:04.015Z","comments":true,"path":"2021/01/06/spark/python-spark-practice/","link":"","permalink":"http://iequa.com/2021/01/06/spark/python-spark-practice/","excerpt":"good - Sparkä¼šæŠŠæ•°æ®éƒ½è½½å…¥åˆ°å†…å­˜ä¹ˆï¼Ÿ","text":"good - Sparkä¼šæŠŠæ•°æ®éƒ½è½½å…¥åˆ°å†…å­˜ä¹ˆï¼Ÿ 1. Spark Functions1.1 count, firstlines.= sc.textFile(&quot;file:///home/blair/../input.txt&quot;)lines.count()lines.first()lines.take(3) 1.2 filterpythonLines = lines.filter(lambda line: &quot;Python&quot; in line)# å¦ä¸€ç§å†™æ³•def hasPython(line): return &quot;Python&quot; in linepythonLines = lines.filter(hasPython) 1.3 sc initfrom pyspark import SparkConf, SparkContext#conf = SparkConf().setMaster(&quot;local&quot;).setAppName(&quot;My App&quot;)#sc = SparkContext(conf = conf)# sc é»˜è®¤å°±æœ‰äº†sc.stop() 1.4 avg,data = [1,5,7,10,23,20,6,5,10,7,10]rdd_data = sc.parallelize(data)s = rdd_data.reduce(lambda x,y: x+y+0.0)n = rdd_data.count()avg = s/nprint(&quot;average:&quot;,avg) 1.5 æ±‚ä¼—æ•°data = [1,5,7,10,23,20,7,5,10,7,10]rdd_data = sc.parallelize(data)rdd_count = rdd_data.map(lambda x:(x,1)).reduceByKey(lambda x,y:x+y)max_count = rdd_count.map(lambda x:x[1]).reduce(lambda x,y: x if x&gt;=y else y)print(max_count)rdd_mode = rdd_count.filter(lambda x:x[1]==max_count).map(lambda x:x[0])mode = rdd_mode.reduce(lambda x,y:x+y+0.0)/rdd_mode.count()print(&quot;mode:&quot;,mode) 1.6 TopN#ä»»åŠ¡ï¼šæœ‰ä¸€æ‰¹å­¦ç”Ÿä¿¡æ¯è¡¨æ ¼ï¼ŒåŒ…æ‹¬name,age,score, æ‰¾å‡ºscoreæ’åå‰3çš„å­¦ç”Ÿ, scoreç›¸åŒå¯ä»¥ä»»å–students = [(&quot;LiLei&quot;,18,87),(&quot;HanMeiMei&quot;,16,77),(&quot;DaChui&quot;,16,66),(&quot;Jim&quot;,18,77),(&quot;RuHua&quot;,18,50)]n = 3rdd_students = sc.parallelize(students)rdd_sorted = rdd_students.sortBy(lambda x:x[2],ascending = False)students_topn = rdd_sorted.take(n)print(students_topn) [(â€˜LiLeiâ€™, 18, 87), (â€˜HanMeiMeiâ€™, 16, 77), (â€˜Jimâ€™, 18, 77)] 1.7 æ’åºå¹¶è¿”å›åºå·#ä»»åŠ¡ï¼šæŒ‰ä»å°åˆ°å¤§æ’åºå¹¶è¿”å›åºå·, å¤§å°ç›¸åŒçš„åºå·å¯ä»¥ä¸åŒdata = [1,7,8,5,3,18,34,9,0,12,8]rdd_data = sc.parallelize(data)rdd_sorted = rdd_data.map(lambda x:(x,1)).sortByKey().map(lambda x:x[0]) # [0, 1, 3, 5, 7, 8, 8, 9, 12, 18, 34]rdd_sorted_index = rdd_sorted.zipWithIndex()print(rdd_sorted_index.collect()) output: [(0, 0), (1, 1), (3, 2), (5, 3), (7, 4), (8, 5), (8, 6), (9, 7), (12, 8), (18, 9), (34, 10)] 1.8 äºŒæ¬¡æ’åº#ä»»åŠ¡ï¼šæœ‰ä¸€æ‰¹å­¦ç”Ÿä¿¡æ¯è¡¨æ ¼ï¼ŒåŒ…æ‹¬name,age,score#é¦–å…ˆæ ¹æ®å­¦ç”Ÿçš„scoreä»å¤§åˆ°å°æ’åºï¼Œå¦‚æœscoreç›¸åŒï¼Œæ ¹æ®ageä»å¤§åˆ°å°students = [(&quot;LiLei&quot;,18,87),(&quot;HanMeiMei&quot;,16,77),(&quot;DaChui&quot;,16,66),(&quot;Jim&quot;,18,77),(&quot;RuHua&quot;,18,50)]rdd_students = sc.parallelize(students) %%writefile student.py#ä¸ºäº†åœ¨RDDä¸­ä½¿ç”¨è‡ªå®šä¹‰ç±»ï¼Œéœ€è¦å°†ç±»çš„åˆ›å»ºä»£ç å…¶å†™å…¥åˆ°ä¸€ä¸ªæ–‡ä»¶ä¸­ï¼Œå¦åˆ™ä¼šæœ‰åºåˆ—åŒ–é”™è¯¯class Student: def __init__(self,name,age,score): self.name = name self.age = age self.score = score def __gt__(self,other): if self.score &gt; other.score: return True elif self.score==other.score and self.age&gt;other.age: return True else: return False from student import Studentrdd_sorted = rdd_students \\ .map(lambda t:Student(t[0],t[1],t[2]))\\ .sortBy(lambda x:x,ascending = False)\\ .map(lambda student:(student.name,student.age,student.score))#å‚è€ƒæ–¹æ¡ˆï¼šæ­¤å¤„å·§å¦™åœ°å¯¹scoreå’Œageè¿›è¡Œç¼–ç æ¥è¡¨è¾¾å…¶æ’åºä¼˜å…ˆçº§å…³ç³»ï¼Œé™¤éageè¶…è¿‡100000ï¼Œä»¥ä¸‹é€»è¾‘æ— é”™è¯¯ã€‚#rdd_sorted = rdd_students.sortBy(lambda x:100000*x[2]+x[1],ascending=False)rdd_sorted.collect() [(&#x27;LiLei&#x27;, 18, 87),(&#x27;Jim&#x27;, 18, 77),(&#x27;HanMeiMei&#x27;, 16, 77),(&#x27;DaChui&#x27;, 16, 66),(&#x27;RuHua&#x27;, 18, 50)] 1.9 è¿æ¥æ“ä½œ#ä»»åŠ¡ï¼šå·²çŸ¥ç­çº§ä¿¡æ¯è¡¨å’Œæˆç»©è¡¨ï¼Œæ‰¾å‡ºç­çº§å¹³å‡åˆ†åœ¨75åˆ†ä»¥ä¸Šçš„ç­çº§#ç­çº§ä¿¡æ¯è¡¨åŒ…æ‹¬class,name,æˆç»©è¡¨åŒ…æ‹¬name,scoreclasses = [(&quot;class1&quot;,&quot;LiLei&quot;), (&quot;class1&quot;,&quot;HanMeiMei&quot;),(&quot;class2&quot;,&quot;DaChui&quot;),(&quot;class2&quot;,&quot;RuHua&quot;)]scores = [(&quot;LiLei&quot;,76),(&quot;HanMeiMei&quot;,80),(&quot;DaChui&quot;,70),(&quot;RuHua&quot;,60)]rdd_classes = sc.parallelize(classes).map(lambda x:(x[1],x[0]))rdd_scores = sc.parallelize(scores)rdd_join = rdd_scores.join(rdd_classes).map(lambda t:(t[1][1],t[1][0]))def average(iterator): data = list(iterator) s = 0.0 for x in data: s = s + x return s/len(data)rdd_result = rdd_join.groupByKey().map(lambda t:(t[0],average(t[1]))).filter(lambda t:t[1]&gt;75)print(rdd_result.collect()) [(â€˜class1â€™, 78.0)] 1.10 åˆ†ç»„æ±‚ä¼—æ•°#ä»»åŠ¡ï¼šæœ‰ä¸€æ‰¹å­¦ç”Ÿä¿¡æ¯è¡¨æ ¼ï¼ŒåŒ…æ‹¬classå’Œageã€‚æ±‚æ¯ä¸ªç­çº§å­¦ç”Ÿå¹´é¾„çš„ä¼—æ•°ã€‚students = [ (&quot;class1&quot;,15),(&quot;class1&quot;,15),(&quot;class2&quot;,16), (&quot;class2&quot;,16),(&quot;class1&quot;,17),(&quot;class2&quot;,19)] run def mode(arr): dict_cnt = &#123;&#125; for x in arr: dict_cnt[x] = dict_cnt.get(x,0)+1 max_cnt = max(dict_cnt.values()) most_values = [k for k,v in dict_cnt.items() if v==max_cnt] s = 0.0 for x in most_values: s = s + x return s/len(most_values)rdd_students = sc.parallelize(students)rdd_classes = rdd_students.aggregateByKey([],lambda arr,x:arr+[x],lambda arr1,arr2:arr1+arr2)rdd_mode = rdd_classes.map(lambda t:(t[0],mode(t[1])))print(rdd_mode.collect()) [(â€˜class1â€™, 15.0), (â€˜class2â€™, 16.0)] Reference spark python ç»ƒä¹ ï¼ˆä¸€ï¼‰ 7é“RDDç¼–ç¨‹ç»ƒä¹ é¢˜","categories":[{"name":"spark","slug":"spark","permalink":"http://iequa.com/categories/spark/"}],"tags":[{"name":"spark","slug":"spark","permalink":"http://iequa.com/tags/spark/"}]},{"title":"Data Analysis - SQL 50","slug":"dataware/dw-sql-50-review","date":"2021-01-05T01:07:21.000Z","updated":"2021-01-05T14:54:27.701Z","comments":true,"path":"2021/01/05/dataware/dw-sql-50-review/","link":"","permalink":"http://iequa.com/2021/01/05/dataware/dw-sql-50-review/","excerpt":"","text":"å…¶ä¸­é‡ç‚¹ä¸ºï¼š1/2/5/6/7/10/11/12/13/15/17/18/19/22/23/25/31/35/36/40/41/42/45/46 å…±16é¢˜ è¶…çº§é‡ç‚¹ 18å’Œ23ã€ 22å’Œ25 ã€ 41ã€46 (1). æŸ¥è¯¢è¯¾ç¨‹ç¼–å·ä¸ºâ€œ01â€çš„è¯¾ç¨‹æ¯”â€œ02â€çš„è¯¾ç¨‹æˆç»©é«˜çš„æ‰€æœ‰å­¦ç”Ÿçš„å­¦å·ï¼ˆé‡ç‚¹ï¼‰ SELECT t1.s_id as t1_s_id, t2.s_id as t2_s_id, t3.s_name, t1.s_score as s_score_01, t2.s_score as s_score_02FROM (select s_id, c_id, s_score from Score WHERE c_id = &#x27;01&#x27;) as t1INNER JOIN (select s_id, c_id, s_score from Score WHERE c_id = &#x27;02&#x27;) as t2ON t1.s_id = t2.s_idINNER JOIN Student as t3 ON t1.s_id = t3.s_idwhere t1.s_score &gt; t2.s_score DISTINCTSELECT DISTINCT column1, column2, ...FROM table_name;SELECT column1, column2, ...FROM table_nameWHERE condition1 AND condition2 AND condition3 ...; INSERT INTO table_name (column1, column2, column3, ...)VALUES (value1, value2, value3, ...);SELECT MIN(column_name), MAX(column_name), COUNT, AVG, SUMFROM table_nameWHERE condition; BETWEEN â€¦ ANDSELECT column_name(s)FROM table_nameWHERE column_name BETWEEN value1 AND value2;SELECT *FROM OrdersLEFT JOIN CustomersSELECT column_name(s)FROM table1INNER JOIN table2ON table1.column_name = table2.column_name; HAVINGSELECT COUNT(CustomerID), CountryFROM CustomersGROUP BY CountryHAVING COUNT(CustomerID) &gt; 5; UNIONSELECT City FROM CustomersUNIONSELECT City FROM SuppliersORDER BY City;","categories":[{"name":"data-warehouse","slug":"data-warehouse","permalink":"http://iequa.com/categories/data-warehouse/"}],"tags":[{"name":"data warehouse","slug":"data-warehouse","permalink":"http://iequa.com/tags/data-warehouse/"}]},{"title":"collections and heapq","slug":"python/language/py_collections_heapq_queue","date":"2020-12-16T02:07:21.000Z","updated":"2020-12-18T07:04:19.035Z","comments":true,"path":"2020/12/16/python/language/py_collections_heapq_queue/","link":"","permalink":"http://iequa.com/2020/12/16/python/language/py_collections_heapq_queue/","excerpt":"","text":"1. queue1.1 collections.dequeimport collectionsqueue = collections.deque()queue.append(5)queue.appendleft(10)queue.append(6)queue.append(7)print(queue) # deque([10, 5, 6, 7]) cur = queue.popleft()cur = queue.pop()print(queue) # deque([5, 6]) 1.2 queue.Queue()from queue import Queueq = Queue()q.put(5)q.put(3)q.put(9)print(q.qsize()) # 3print(q.get()) # 5, ç­‰äºæ˜¯ pop(), Queue æ²¡æœ‰ pop() åªæœ‰ get(), get==popprint(q.qsize()) # 2 1.3 queue.PriorityQueue()from queue import PriorityQueuepq = PriorityQueue()pq.put((1, 2))pq.put((1, 0))pq.put((5, 0))pq.put((2, 3))while not pq.empty(): print (pq.get()) # output# (1, 0) # (1, 2) # (2, 3) # (5, 0) å­˜æ”¾è‡ªå®šä¹‰ç±»å‹ï¼š è‡ªå®šä¹‰æ•°æ®ç±»å‹ï¼Œéœ€è¦è‡ªå®šä¹‰ __cmp__ æˆ–è€… __lt__ æ¯”ä»·å‡½æ•° # -*- coding: utf-8 -*-from queue import PriorityQueueclass Job(object): def __init__(self, priority, description): self.priority = priority self.description = description def __lt__(self, other): return self.priority &lt; other.priorityq2 = PriorityQueue()q2.put(Job(5, &#x27;Mid-level job&#x27;))q2.put(Job(10, &#x27;Low-level job&#x27;))q2.put(Job(1, &#x27;Important job&#x27;)) # æ•°å­—è¶Šå°ï¼Œä¼˜å…ˆçº§è¶Šé«˜print(q2.qsize())while not q2.empty(): next_job = q2.get() # å¯æ ¹æ®ä¼˜å…ˆçº§å–åºåˆ— print(next_job.description)# 3# Important job# Mid-level job# Low-level job 2. heapqfrom heapq import nsmallest, nlargestlst = [5, 8, 0, 4, 6, 7]print(nsmallest(3, lst))print(nlargest(3, lst))# pythonä¼˜å…ˆé˜Ÿåˆ—å’Œå †çš„ä½¿ç”¨# https://blog.csdn.net/liuweiyuxiang/article/details/97249128 3. stack is lista = [1, 5, 22, 2, 7]a.pop(2)a.insert(2, 220)print(a) 4. è¿›åˆ¶è½¬æ¢ bin, oct, hex, int(â€˜0b10000â€™, 2)# -*- coding: UTF-8 -*- # Filename : test.py# author by : www.runoob.com # è·å–ç”¨æˆ·è¾“å…¥åè¿›åˆ¶æ•°dec = int(input(&quot;è¾“å…¥æ•°å­—ï¼š&quot;)) print(&quot;åè¿›åˆ¶æ•°ä¸ºï¼š&quot;, dec)print(&quot;è½¬æ¢ä¸ºäºŒè¿›åˆ¶ä¸ºï¼š&quot;, bin(dec))print(&quot;è½¬æ¢ä¸ºå…«è¿›åˆ¶ä¸ºï¼š&quot;, oct(dec))print(&quot;è½¬æ¢ä¸ºåå…­è¿›åˆ¶ä¸ºï¼š&quot;, hex(dec))int(hex(2*a),16) åè¿›åˆ¶ ä¸ äºŒè¿›åˆ¶ çš„äº’ç›¸è½¬æ¢ In [1]: a = 16In [9]: bin(a)Out[9]: &#x27;0b10000&#x27;In [10]: int(&#x27;0b10000&#x27;, 2)Out[10]: 16 Reference","categories":[{"name":"python","slug":"python","permalink":"http://iequa.com/categories/python/"}],"tags":[{"name":"interview","slug":"interview","permalink":"http://iequa.com/tags/interview/"}]},{"title":"Spark Summary 1 - Basic knowledge","slug":"spark/spark-summary-1-basic-questions","date":"2020-10-30T23:07:21.000Z","updated":"2021-02-19T00:19:56.190Z","comments":true,"path":"2020/10/31/spark/spark-summary-1-basic-questions/","link":"","permalink":"http://iequa.com/2020/10/31/spark/spark-summary-1-basic-questions/","excerpt":"","text":"Sparkä¼šæŠŠæ•°æ®éƒ½è½½å…¥åˆ°å†…å­˜ä¹ˆï¼Ÿ ./bin/spark-submit \\ --master yarn --deploy-mode cluster --num-executors 100 \\ # æ€»å…±ç”³è¯·çš„executoræ•°ç›®ï¼Œæ™®é€šä»»åŠ¡åå‡ ä¸ªæˆ–è€…å‡ åä¸ªè¶³å¤Ÿäº† --executor-memory 6G \\ --executor-cores 4 \\ # æ¯ä¸ªexecutorå†…çš„æ ¸æ•°ï¼Œå³æ¯ä¸ªexecutorä¸­çš„ä»»åŠ¡taskæ•°ç›®ï¼Œæ­¤å¤„è®¾ç½®ä¸º2 --driver-memory 1G \\ # driverå†…å­˜å¤§å°ï¼Œä¸€èˆ¬æ²¡æœ‰å¹¿æ’­å˜é‡(broadcast)æ—¶ï¼Œè®¾ç½®1~4gè¶³å¤Ÿ --conf spark.default.parallelism=1000 \\ # é»˜è®¤æ¯ä¸ª satge çš„ Taskæ€»æ•° # Sparkä½œä¸šçš„é»˜è®¤ä¸º500~1000ä¸ªæ¯”è¾ƒåˆé€‚,å¦‚æœä¸è®¾ç½®ï¼Œsparkä¼šæ ¹æ®åº•å±‚HDFSçš„blockæ•°é‡è®¾ç½®taskçš„æ•°é‡ï¼Œè¿™æ ·ä¼šå¯¼è‡´å¹¶è¡Œåº¦åå°‘ï¼Œèµ„æºåˆ©ç”¨ä¸å……åˆ†ã€‚è¯¥å‚æ•°è®¾ä¸ºnum-executors * executor-coresçš„2~3å€æ¯”è¾ƒåˆé€‚ --conf spark.storage.memoryFraction=0.5 \\ å­˜å‚¨å†…å­˜ --conf spark.shuffle.memoryFraction=0.3 \\ æ‰§è¡Œå†…å­˜ # shuffleè¿‡ç¨‹ä¸­ä¸€ä¸ªtaskæ‹‰å–åˆ°ä¸Šä¸ªstageçš„taskçš„è¾“å‡ºåï¼Œè¿›è¡Œèšåˆæ“ä½œæ—¶èƒ½å¤Ÿä½¿ç”¨çš„Executorå†…å­˜çš„æ¯”ä¾‹ï¼Œé»˜è®¤æ˜¯0.2ï¼Œå¦‚æœshuffleèšåˆæ—¶ä½¿ç”¨çš„å†…å­˜è¶…å‡ºäº†è¿™ä¸ª20%çš„é™åˆ¶ï¼Œå¤šä½™æ•°æ®ä¼šè¢«æº¢å†™åˆ°ç£ç›˜æ–‡ä»¶ä¸­å»ï¼Œé™ä½shuffleæ€§èƒ½ # # â€”-spark.yarn.executor.memoryOverhead 1G ï¼š executoræ‰§è¡Œçš„æ—¶å€™ï¼Œç”¨çš„å†…å­˜å¯èƒ½ä¼šè¶…è¿‡executor-memoryï¼Œ # æ‰€ä»¥ä¼šä¸ºexecutoré¢å¤–é¢„ç•™ä¸€éƒ¨åˆ†å†…å­˜ï¼Œspark.yarn.executor.memoryOverheadå³ä»£è¡¨è¿™éƒ¨åˆ†å†…å­˜ # é»˜è®¤çš„ spark.executor.memoryOverhead=6144ï¼ˆ6Gï¼‰ æœ‰ç‚¹æµªè´¹ å°½é‡ä¿è¯æ¯è½®Stageé‡Œæ¯ä¸ªtaskå¤„ç†çš„æ•°æ®é‡&gt;128M A list of partitions A function for computing each split A list of dependencies on other RDDs Optionally, a Partitioner for key-value RDDs (e.g. to say that the RDD is hash-partitioned) Optionally, a list of preferred locations to compute each split on (block locations for an HDFS file) Stageæ˜¯ä¸€ä¸ªTaskSetï¼Œå°†Stageæ ¹æ®åˆ†åŒºæ•°åˆ’åˆ†æˆä¸€ä¸ªä¸ªçš„Task DataFrameå’ŒDataSetå¯ä»¥ç›¸äº’è½¬åŒ–ï¼Œdf.as[ElementType]è¿™æ ·å¯ä»¥æŠŠDataFrameè½¬åŒ–ä¸ºDataSetï¼Œds.toDF()è¿™æ ·å¯ä»¥æŠŠDataSetè½¬åŒ–ä¸ºDataFrame DataSetå¯ä»¥åœ¨ç¼–è¯‘æ—¶æ£€æŸ¥ç±»å‹, DataSetä»¥Catalysté€»è¾‘æ‰§è¡Œè®¡åˆ’è¡¨ç¤ºï¼Œå¹¶ä¸”æ•°æ®ä»¥ç¼–ç çš„äºŒè¿›åˆ¶å½¢å¼è¢«å­˜å‚¨ï¼Œä¸éœ€è¦ååºåˆ—åŒ–å°±å¯ä»¥æ‰§è¡Œsortingã€shuffleç­‰æ“ä½œã€‚ repartition vs coalesce vs coalesce in sql Sparkç®—å­ï¼šRDDåŸºæœ¬è½¬æ¢æ“ä½œ(2)â€“coalesceã€repartitionä¸€èˆ¬æƒ…å†µä¸‹å¢å¤§rddçš„partitionæ•°é‡ä½¿ç”¨repartitionï¼Œå‡å°‘partitionæ•°é‡æ—¶ä½¿ç”¨coalesce No. Title Article 0. Hiveæ€æ‹› å†æ¬¡åˆ†äº«ï¼Hiveè°ƒä¼˜ï¼Œæ•°æ®å·¥ç¨‹å¸ˆæˆç¥ä¹‹è·¯ 0 HadoopReviewæ€æ‹› Hadoopé«˜é¢‘è€ƒç‚¹ï¼Œæ­£åœ¨åˆ·æ–°ä½ çš„è®¤çŸ¥ï¼ 0. Apache Parquetå’ŒApache Avro 0. RDDæ˜¯åˆ†å¸ƒå¼çš„Javaå¯¹è±¡çš„é›†åˆ DataFrameæ˜¯åˆ†å¸ƒå¼çš„Rowå¯¹è±¡çš„é›†åˆ RDDã€DataFrameå’ŒDataSetçš„åŒºåˆ« persistã€cacheå’Œcheckpointçš„åŒºåˆ«ä¸è”ç³» 3. Data Warehouse 2020 å¤§æ•°æ®/æ•°ä»“/æ•°å¼€ Interview Questions 4. Spark RDD very good SparkåŸç†ç¯‡ä¹‹RDDç‰¹å¾åˆ†æè®²è§£ 5. Spark Task Sparkä¸­Taskæ•°é‡çš„åˆ†æ 6. Spark è…¾è®¯æ€»ç»“ Spark è…¾è®¯è®¡ç®—æœºç»„æ€»ç»“(ä¸€) 7. å¤§æ•°æ®å­¦ä¹ æŒ‡å— Github å¤§æ•°æ®å­¦ä¹ æŒ‡å— Sparkæ€§èƒ½ä¼˜åŒ–æŒ‡å— 1. dev Sparkæ€§èƒ½ä¼˜åŒ–æŒ‡å—â€”â€”åŸºç¡€ç¯‡ 2. shuffle Sparkæ€§èƒ½ä¼˜åŒ–æŒ‡å—â€”â€”é«˜çº§ç¯‡ï¼ˆ8ï¼‰ 3. Spark 1.6 åå¼•å…¥ç»Ÿä¸€å†…å­˜ç®¡ç† Apache Spark å†…å­˜ç®¡ç†è¯¦è§£ è“¦ç„¶å¤§æ•°æ®å¼€å‘ More Info è¯·ç‚¹å‡» No. | Title | Article :---: | --- | --- | | **è“¦ç„¶å¤§æ•°æ®å¼€å‘** | 1. | è“¦ç„¶å¤§æ•°æ®å¼€å‘| [çŸ¥ä¹ï¼Œ å…¬ä¼—å·ï¼šæ—§æ—¶å…‰å¤§æ•°æ®](https://www.zhihu.com/people/ai-yo-ai-yo-33-50/posts) 2. | è“¦ç„¶å¤§æ•°æ®å¼€å‘ | [å¤§æ•°æ®Hadoopï¼ˆä¸‰ï¼‰â€”â€”MapReduce](https://zhuanlan.zhihu.com/p/97714898) 1. | Spark | [å¤§æ•°æ®Sparké¢˜ï¼ˆä¸€ï¼‰](https://zhuanlan.zhihu.com/p/107354908) 2. | Spark | [å¤§æ•°æ®Sparké¢˜ï¼ˆäºŒï¼‰](https://zhuanlan.zhihu.com/p/107355676) 3. | Spark | [å¤§æ•°æ®Sparké¢˜ï¼ˆä¸‰ï¼‰](https://zhuanlan.zhihu.com/p/107358759) 4. | Spark | [å¤§æ•°æ®Sparké¢˜ï¼ˆå››ï¼‰](https://zhuanlan.zhihu.com/p/107359082) 5. | Spark | [å¤§æ•°æ®Sparké¢˜ï¼ˆäº”ï¼‰â€” å‡ ç§å¸¸è§çš„æ•°æ®å€¾æ–œæƒ…å†µåŠè°ƒä¼˜æ–¹å¼](https://zhuanlan.zhihu.com/p/107359523) 6. | Spark | [å¤§æ•°æ®Sparké¢˜ï¼ˆå…­ï¼‰â€” Shuffleé…ç½®è°ƒä¼˜](https://zhuanlan.zhihu.com/p/107365488) 7. | Spark | [å¤§æ•°æ®Sparké¢˜ï¼ˆä¸ƒï¼‰â€” ç¨‹åºå¼€å‘è°ƒä¼˜](https://zhuanlan.zhihu.com/p/107366035) 8. | Spark | [å¤§æ•°æ®Sparké¢˜ï¼ˆå…«ï¼‰â€” è¿è¡Œèµ„æºè°ƒä¼˜](https://zhuanlan.zhihu.com/p/107367271) Spark åˆ›å»ºRDDã€DataFrameå„ç§æƒ…å†µçš„é»˜è®¤åˆ†åŒºæ•° 1). reduceByKey(func, numPartitions=None), Sparkå¯ä»¥åœ¨æ¯ä¸ªåˆ†åŒºç§»åŠ¨æ•°æ®ä¹‹å‰å°†å¾…è¾“å‡ºæ•°æ®ä¸ä¸€ä¸ªå…±ç”¨çš„keyç»“åˆ 2). groupByKey(numPartitions=None), ä¸èƒ½è‡ªå®šä¹‰å‡½æ•°ï¼Œæˆ‘ä»¬éœ€è¦å…ˆç”¨groupByKeyç”ŸæˆRDDï¼Œç„¶åæ‰èƒ½å¯¹æ­¤RDDé€šè¿‡mapè¿›è¡Œè‡ªå®šä¹‰å‡½æ•°æ“ä½œ sparkçš„æ‰§è¡Œæ¨¡å‹çš„æ–¹å¼ï¼Œå®ƒçš„ç‰¹ç‚¹æ— éå°±æ˜¯å¤šä¸ªä»»åŠ¡ä¹‹é—´æ•°æ®é€šä¿¡ä¸éœ€è¦å€ŸåŠ©ç¡¬ç›˜è€Œæ˜¯é€šè¿‡å†…å­˜ï¼Œå¤§å¤§æé«˜äº†ç¨‹åºçš„æ‰§è¡Œæ•ˆç‡ã€‚è€Œhadoopç”±äºæœ¬èº«çš„æ¨¡å‹ç‰¹ç‚¹ï¼Œå¤šä¸ªä»»åŠ¡ä¹‹é—´æ•°æ®é€šä¿¡æ˜¯å¿…é¡»å€ŸåŠ©ç¡¬ç›˜è½åœ°çš„ã€‚é‚£ä¹ˆsparkçš„ç‰¹ç‚¹å°±æ˜¯æ•°æ®äº¤äº’ä¸ä¼šèµ°ç¡¬ç›˜ã€‚åªèƒ½è¯´å¤šä¸ªä»»åŠ¡çš„æ•°æ®äº¤äº’ä¸èµ°ç¡¬ç›˜ï¼Œä½†æ˜¯sparkçš„shuffleè¿‡ç¨‹å’Œhadoopä¸€æ ·ä»ç„¶å¿…é¡»èµ°ç¡¬ç›˜çš„ã€‚ æ‰€è°“Shuffleä¸è¿‡æ˜¯æŠŠå¤„ç†æµç¨‹åˆ‡åˆ†ï¼Œç»™åˆ‡åˆ†çš„ä¸Šä¸€æ®µ(æˆ‘ä»¬ç§°ä¸ºStage M)åŠ ä¸ªå­˜å‚¨åˆ°ç£ç›˜çš„ActionåŠ¨ä½œï¼ŒæŠŠåˆ‡åˆ†çš„ä¸‹ä¸€æ®µ(Stage M+1)æ•°æ®æºå˜æˆStage Må­˜å‚¨çš„ç£ç›˜æ–‡ä»¶ã€‚æ¯ä¸ªStageéƒ½å¯ä»¥èµ°æˆ‘ä¸Šé¢çš„æè¿°ï¼Œè®©æ¯æ¡æ•°æ®éƒ½å¯ä»¥è¢«Nä¸ªåµŒå¥—çš„å‡½æ•°å¤„ç†ï¼Œæœ€åé€šè¿‡ç”¨æˆ·æŒ‡å®šçš„åŠ¨ä½œè¿›è¡Œå­˜å‚¨ã€‚ æˆ‘ä»¬åšCache/Persistæ„å‘³ç€ä»€ä¹ˆï¼Ÿ å…¶å®å°±æ˜¯ç»™æŸä¸ªStageåŠ ä¸Šäº†ä¸€ä¸ªsaveAsMemoryBlockFileçš„åŠ¨ä½œï¼Œç„¶åä¸‹æ¬¡å†è¦æ•°æ®çš„æ—¶å€™ï¼Œå°±ä¸ç”¨ç®—äº†ã€‚è¿™äº›å­˜åœ¨å†…å­˜çš„æ•°æ®å°±è¡¨ç¤ºäº†æŸä¸ªRDDå¤„ç†åçš„ç»“æœã€‚è¿™ä¸ªæ‰æ˜¯è¯´ä¸ºå•¥Sparkæ˜¯å†…å­˜è®¡ç®—å¼•æ“çš„åœ°æ–¹ã€‚åœ¨MRé‡Œï¼Œä½ æ˜¯è¦æ”¾åˆ°HDFSé‡Œçš„ï¼Œä½†Sparkå…è®¸ä½ æŠŠä¸­é—´ç»“æœæ”¾å†…å­˜é‡Œã€‚ æ‰€ä»¥ç»“è®ºæ˜¯ï¼šSparkå¹¶ä¸æ˜¯åŸºäºå†…å­˜çš„æŠ€æœ¯ï¼å®ƒå…¶å®æ˜¯ä¸€ç§å¯ä»¥æœ‰æ•ˆåœ°ä½¿ç”¨å†…å­˜LRUç­–ç•¥çš„æŠ€æœ¯ Sparkåªæœ‰åœ¨shuffleçš„æ—¶å€™æ‰ä¼šå°†æ•°æ®æ”¾åœ¨ç£ç›˜ï¼Œè€ŒMRå´ä¸æ˜¯ 0. Top Questions1. sparkçš„ä¼˜åŒ–æ€ä¹ˆåšï¼Ÿ ï¼ˆâ˜†â˜†â˜†â˜†â˜†ï¼‰ sparkè°ƒä¼˜æ¯”è¾ƒå¤æ‚ï¼Œä½†æ˜¯å¤§ä½“å¯ä»¥åˆ†ä¸ºä¸‰ä¸ªæ–¹é¢æ¥è¿›è¡Œ No. Title Answer 1 Platform æé«˜æ•°æ®çš„æœ¬åœ°æ€§ï¼Œé€‰æ‹©é«˜æ•ˆçš„å­˜å‚¨æ ¼å¼å¦‚parquet 2 Application å¤„ç† Data Skewï¼Œå¤ç”¨RDDè¿›è¡Œç¼“å­˜ï¼Œä½œä¸šå¹¶è¡ŒåŒ–æ‰§è¡Œç­‰ç­‰ 3 JVM å±‚é¢ å¯ç”¨é«˜æ•ˆçš„åºåˆ—åŒ–æ–¹æ³•å¦‚kyroï¼Œå¢å¤§off headå†…å­˜ç­‰ç­‰ Lineage, cognitive ability 2. Sparkæ€§èƒ½ä¼˜åŒ–æŒ‡å—â€”é«˜çº§ç¯‡(8) ï¼ˆâ˜†â˜†â˜†â˜†â˜†ï¼‰ Data Skew å‘ç”Ÿçš„åŸç† Data Skew çš„åŸç†å¾ˆç®€å•ï¼šåœ¨è¿›è¡Œshuffleçš„æ—¶å€™ï¼Œå¿…é¡»å°†å„ä¸ªèŠ‚ç‚¹ä¸Šç›¸åŒçš„keyæ‹‰å–åˆ°æŸä¸ªèŠ‚ç‚¹ä¸Šçš„ä¸€ä¸ªtaskæ¥è¿›è¡Œå¤„ç†ï¼Œæ¯”å¦‚æŒ‰ç…§keyè¿›è¡Œèšåˆæˆ–joinç­‰æ“ä½œã€‚æ­¤æ—¶å¦‚æœæŸä¸ªkeyå¯¹åº”çš„æ•°æ®é‡ç‰¹åˆ«å¤§çš„è¯ï¼Œå°±ä¼šå‘ç”Ÿ Data Skewã€‚ No. Sparkæ€§èƒ½ä¼˜åŒ–æŒ‡å—â€”é«˜çº§ç¯‡(8) ä¼˜ç¼ºç‚¹ Flag 3. æé«˜shuffleæ“ä½œçš„å¹¶è¡Œåº¦ reduceByKey(1000) rdd: spark.default.parallelismSQL: spark.sql.shuffle.partitions,shuffle task é»˜200 æ€»ç»“ï¼šå®ç°èµ·æ¥ç®€å•ï¼Œå¯ä»¥ç¼“è§£å’Œå‡è½» Data Skew çš„å½±å“ â 4. ä¸¤é˜¶æ®µèšåˆï¼ˆå±€éƒ¨èšåˆ+å…¨å±€èšåˆï¼‰ éšæœºå‰ç¼€=&gt;åŸ1ä¸ªTaskçš„æ•°æ®ï¼Œç°åˆ†å¤šTask, åå»æ‰å‰ç¼€, åœ¨å…¨å±€èšåˆ ä»…ä»…é€‚ç”¨äºèšåˆç±»çš„shuffleæ“ä½œï¼Œé€‚ç”¨èŒƒå›´ç›¸å¯¹è¾ƒçª„ â 5. å°†reduce joinè½¬ä¸ºmap join è¿™ä¸ªæ–¹æ¡ˆåªé€‚ç”¨1ä¸ªå¤§è¡¨å’Œ1ä¸ªå°è¡¨æƒ…å†µã€‚éœ€å°†å°è¡¨è¿›è¡Œå¹¿æ’­ good 6. é‡‡æ ·å€¾æ–œkeyå¹¶åˆ†æ‹†joinæ“ä½œ å¦‚æœå¯¼è‡´å€¾æ–œçš„keyç‰¹åˆ«å¤šçš„è¯ï¼Œï¼Œé‚£ä¹ˆè¿™ç§æ–¹å¼ä¹Ÿä¸é€‚åˆ âœ”ï¸ 7. ä½¿ç”¨éšæœºå‰ç¼€å’Œæ‰©å®¹RDDè¿›è¡Œjoin è¯¥æ–¹æ¡ˆæ›´å¤šçš„æ˜¯ç¼“è§£æ•°æ®å€¾æ–œï¼Œè€Œä¸æ˜¯å½»åº•é¿å…æ•°æ®å€¾æ–œã€‚ è€Œä¸”éœ€è¦å¯¹æ•´ä¸ªRDDè¿›è¡Œæ‰©å®¹ï¼Œå¯¹å†…å­˜èµ„æºè¦æ±‚å¾ˆé«˜ âœ”ï¸ No. è°ƒä¼˜æ¦‚è¿° 1. å¤§å¤šæ•°Sparkä½œä¸šçš„æ€§èƒ½ä¸»è¦å°±æ˜¯æ¶ˆè€—åœ¨shuffleç¯èŠ‚ï¼Œå› ä¸ºåŒ…å«äº†å¤§é‡çš„ç£ç›˜IOã€åºåˆ—åŒ–ã€ç½‘ç»œæ•°æ®ä¼ è¾“ç­‰æ“ä½œã€‚ å½±å“ä¸€ä¸ªSparkä½œä¸šæ€§èƒ½çš„å› ç´ ï¼Œä¸»è¦è¿˜æ˜¯ä»£ç å¼€å‘ã€èµ„æºå‚æ•°ä»¥åŠæ•°æ®å€¾æ–œï¼Œshuffleè°ƒä¼˜åªèƒ½åœ¨æ•´ä¸ªSparkçš„æ€§èƒ½è°ƒä¼˜ä¸­å åˆ°ä¸€å°éƒ¨åˆ†è€Œå·²ã€‚ 2. shuffleç›¸å…³å‚æ•°è°ƒä¼˜ å°†reduce joinè½¬ä¸ºmap join: // é¦–å…ˆå°†æ•°æ®é‡æ¯”è¾ƒå°çš„RDDçš„æ•°æ®ï¼Œcollectåˆ°Driverä¸­æ¥ã€‚List&lt;Tuple2&lt;Long, Row&gt;&gt; rdd1Data = rdd1.collect()// ç„¶åä½¿ç”¨Sparkçš„å¹¿æ’­åŠŸèƒ½ï¼Œå°†å°RDDçš„æ•°æ®è½¬æ¢æˆå¹¿æ’­å˜é‡ï¼Œè¿™æ ·æ¯ä¸ªExecutorå°±åªæœ‰ä¸€ä»½RDDçš„æ•°æ®ã€‚// å¯ä»¥å°½å¯èƒ½èŠ‚çœå†…å­˜ç©ºé—´ï¼Œå¹¶ä¸”å‡å°‘ç½‘ç»œä¼ è¾“æ€§èƒ½å¼€é”€ã€‚final Broadcast&lt;List&lt;Tuple2&lt;Long, Row&gt;&gt;&gt; rdd1DataBroadcast = sc.broadcast(rdd1Data); 3. RDDçš„å¼¹æ€§è¡¨ç°åœ¨å“ªå‡ ç‚¹ï¼Ÿï¼ˆâ˜†â˜†â˜†â˜†â˜†ï¼‰ 1ï¼‰è‡ªåŠ¨çš„è¿›è¡Œå†…å­˜å’Œç£ç›˜çš„å­˜å‚¨åˆ‡æ¢ï¼›2ï¼‰åŸºäºLineageçš„é«˜æ•ˆå®¹é”™ï¼›3ï¼‰taskå¦‚æœå¤±è´¥ä¼šè‡ªåŠ¨è¿›è¡Œç‰¹å®šæ¬¡æ•°çš„é‡è¯•ï¼›4ï¼‰stageå¦‚æœå¤±è´¥ä¼šè‡ªåŠ¨è¿›è¡Œç‰¹å®šæ¬¡æ•°çš„é‡è¯•ï¼Œè€Œä¸”åªä¼šè®¡ç®—å¤±è´¥çš„åˆ†ç‰‡ï¼›5ï¼‰checkpointå’Œpersistï¼Œæ•°æ®è®¡ç®—ä¹‹åæŒä¹…åŒ–ç¼“å­˜ï¼›6ï¼‰æ•°æ®è°ƒåº¦å¼¹æ€§ï¼ŒDAG TASKè°ƒåº¦å’Œèµ„æºæ— å…³ï¼›7ï¼‰æ•°æ®åˆ†ç‰‡çš„é«˜åº¦å¼¹æ€§ã€‚ 4. Spark å¼€å‘è°ƒä¼˜ ï¼ˆâ˜†â˜†â˜†â˜†â˜†ï¼‰ No. Sparkæ€§èƒ½ä¼˜åŒ–æŒ‡å—åŸºç¡€ç¯‡(8) ä¼˜ç¼ºç‚¹ &nbsp; 1 ~ 3: é‡å¤åˆ©ç”¨ä¸€ä¸ªRDD é‡å¤åˆ©ç”¨ä¸€ä¸ªRDD (1). é¿å…åˆ›å»ºé‡å¤ RDD (2). å°½å¯èƒ½å¤ç”¨åŒä¸€ä¸ª RDD (3). å¯¹å¤šæ¬¡ä½¿ç”¨çš„ RDD è¿›è¡ŒæŒä¹…åŒ– &nbsp; 4 ~ 6: æé«˜ä»»åŠ¡å¤„ç†çš„æ€§èƒ½ æé«˜ä»»åŠ¡å¤„ç†çš„æ€§èƒ½ (4). å°½é‡é¿å…ä½¿ç”¨ shuffle ç±»ç®—å­ Sparkä½œä¸šè¿è¡Œè¿‡ç¨‹ä¸­ï¼Œæœ€æ¶ˆè€—æ€§èƒ½çš„åœ°æ–¹å°±æ˜¯shuffleè¿‡ç¨‹ shuffleè¿‡ç¨‹ä¸­ï¼Œå„ä¸ªèŠ‚ç‚¹ä¸Šçš„ç›¸åŒkeyéƒ½ä¼šå…ˆå†™å…¥æœ¬åœ°ç£ç›˜æ–‡ä»¶ä¸­ï¼Œç„¶åå…¶ä»–èŠ‚ç‚¹éœ€è¦é€šè¿‡ç½‘ç»œä¼ è¾“æ‹‰å–å„ä¸ªèŠ‚ç‚¹ä¸Šçš„ç£ç›˜æ–‡ä»¶ä¸­çš„ç›¸åŒkey (5). ä½¿ç”¨ map-side é¢„èšåˆçš„ shuffle æ“ä½œ æ˜¯åœ¨æ¯ä¸ªèŠ‚ç‚¹æœ¬åœ°å¯¹ç›¸åŒçš„keyè¿›è¡Œä¸€æ¬¡èšåˆæ“ä½œï¼Œç±»ä¼¼äºMapReduceä¸­çš„æœ¬åœ°combiner; map-sideé¢„èšåˆä¹‹åï¼Œæ¯ä¸ªèŠ‚ç‚¹æœ¬åœ°å°±åªä¼šæœ‰ä¸€æ¡ç›¸åŒçš„keyï¼Œå› ä¸ºå¤šæ¡ç›¸åŒçš„keyéƒ½è¢«èšåˆèµ·æ¥äº† å‡å°‘äº†ç£ç›˜IOä»¥åŠç½‘ç»œä¼ è¾“å¼€é”€ (6). ä½¿ç”¨é«˜æ€§èƒ½ç®—å­ reduceByKey/aggregateByKeyæ›¿ä»£groupByKey ä½¿ç”¨mapPartitionsæ›¿ä»£æ™®é€šmap &nbsp; (7). å¹¿æ’­å¤§å˜é‡ (å‡è½»ç½‘ç»œè´Ÿæ‹…) (8). ä½¿ç”¨ Kryo ä¼˜åŒ–åºåˆ—åŒ–æ€§èƒ½ 1. åœ¨ç®—å­å‡½æ•°ä¸­ç”¨åˆ°å¤–éƒ¨å˜é‡ï¼Œè¯¥å˜é‡ä¼šåºåˆ—åŒ–åç½‘ç»œä¼ è¾“ 2. RDDæ³›å‹ç±»å‹æ—¶ï¼Œæ‰€æœ‰è‡ªå®šä¹‰ç±»å‹å¯¹è±¡ï¼Œéƒ½ä¼šè¿›è¡Œåºåˆ—åŒ– 3. ä½¿ç”¨å¯åºåˆ—åŒ–çš„æŒä¹…åŒ–ç­–ç•¥æ—¶ Kryoè¦æ±‚æœ€å¥½è¦æ³¨å†Œæ‰€æœ‰éœ€è¦è¿›è¡Œåºåˆ—åŒ–çš„è‡ªå®šä¹‰ç±»å‹ (9). ä¼˜åŒ–æ•°æ®ç»“æ„ æ€»ç»“ï¼š å¦‚æœè¯´æœ‰æŸä¸€ä¸ª RDD ä¼šåœ¨ä¸€ä¸ªç¨‹åºä¸­è¢«å¤šæ¬¡ä½¿ç”¨ï¼Œé‚£ä¹ˆå°±åº”è¯¥ä¸è¦é‡å¤åˆ›å»ºï¼Œè¦å¤šæ¬¡ä½¿ç”¨è¿™ä¸€ä¸ªRDD (ä¸å¯å˜çš„)ï¼Œæ—¢ç„¶è¦é‡å¤åˆ©ç”¨ä¸€ä¸ªRDDï¼Œå°±åº”è¯¥æŠŠè¿™ä¸ª RDD è¿›è¡ŒæŒä¹…åŒ–. ï¼ˆæœ€å¥½åœ¨å†…å­˜ä¸­ï¼‰ cache persist æŒä¹…åŒ–æ•°æ®åˆ°ç£ç›˜æˆ–å†…å­˜ unpersistå¦‚ä½•æŠŠæŒä¹…åŒ–åˆ°ç£ç›˜æˆ–å†…å­˜ä¸­çš„æ•°æ®ç»™åˆ é™¤æ‰å‘¢ï¼Ÿ 1. Spark åŸºç¡€ (2)1ï¼‰. sparkçš„æœ‰å‡ ç§éƒ¨ç½²æ¨¡å¼ï¼Œæ¯ç§æ¨¡å¼ç‰¹ç‚¹ï¼Ÿ 1). local ã€å¯åŠ¨1~kä¸ªexecutor]ã€‘2). standalone ã€åˆ†å¸ƒå¼éƒ¨ç½²é›†ç¾¤ï¼Œè‡ªå¸¦å®Œæ•´çš„æœåŠ¡ï¼Œèµ„æºç®¡ç†å’Œä»»åŠ¡ç›‘æ§æ˜¯Sparkè‡ªå·±ç›‘æ§ã€‘3). Spark on yarn (yarn-clusterå’Œyarn-client) Spark on yarnæ¨¡å¼ åˆ†å¸ƒå¼éƒ¨ç½²é›†ç¾¤ï¼Œèµ„æºå’Œä»»åŠ¡ç›‘æ§äº¤ç»™yarnç®¡ç† ç²—ç²’åº¦èµ„æºåˆ†é…æ–¹å¼ï¼ŒåŒ…å«clusterå’Œclientè¿è¡Œæ¨¡å¼ cluster é€‚åˆç”Ÿäº§ï¼Œdriverè¿è¡Œåœ¨é›†ç¾¤å­èŠ‚ç‚¹ï¼Œå…·æœ‰å®¹é”™åŠŸèƒ½ client é€‚åˆè°ƒè¯•ï¼Œdirverè¿è¡Œåœ¨å®¢æˆ·ç«¯ 2ï¼‰. sparkæœ‰5ä¸ªç»„ä»¶ (5) masterï¼šç®¡ç†é›†ç¾¤å’ŒèŠ‚ç‚¹ï¼Œä¸å‚ä¸è®¡ç®—ã€‚ workerï¼šè®¡ç®—èŠ‚ç‚¹ï¼Œè¿›ç¨‹æœ¬èº«ä¸å‚ä¸è®¡ç®—ï¼Œå’Œmasteræ±‡æŠ¥ã€‚ Driverï¼šè¿è¡Œç¨‹åºçš„mainæ–¹æ³•ï¼Œåˆ›å»ºspark contextå¯¹è±¡ã€‚ sparkContextï¼šæ§åˆ¶æ•´ä¸ªapplicationçš„ç”Ÿå‘½å‘¨æœŸï¼ŒåŒ…æ‹¬dagshedulerå’Œtask schedulerç­‰ç»„ä»¶ã€‚ clientï¼šç”¨æˆ·æäº¤ç¨‹åºçš„å…¥å£ã€‚ 2. Sparkè¿è¡Œç»†èŠ‚ (13) No. Topic Flag 1. sparkå·¥ä½œæœºåˆ¶ ? ã€clientç«¯æäº¤ä½œä¸šå-&gt;Drive,main,SparkContext-&gt;DAG...ã€‘ 2. Sparkåº”ç”¨ç¨‹åºçš„æ‰§è¡Œè¿‡ç¨‹ 3. driverçš„åŠŸèƒ½æ˜¯ä»€ä¹ˆï¼Ÿ ã€ä½œä¸šä¸»è¿›ç¨‹ï¼Œæœ‰mainå‡½æ•°ï¼Œä¸”æœ‰SparkContextçš„å®ä¾‹ã€‘ 4. Sparkä¸­workerçš„ä¸»è¦å·¥ä½œæ˜¯ä»€ä¹ˆï¼Ÿ [ç®¡ç†å½“å‰èŠ‚ç‚¹å†…å­˜ï¼ŒCPUä½¿ç”¨çŠ¶å†µ, workerå°±ç±»ä¼¼äºåŒ…å·¥å¤´ï¼Œç®¡ç†åˆ†é…æ–°è¿›ç¨‹] 5. taskæœ‰å‡ ç§ç±»å‹ï¼Ÿ2ç§ ã€resultTask å’Œ shuffleMapTaskç±»å‹ï¼Œé™¤äº†æœ€åä¸€ä¸ªtaskéƒ½æ˜¯ã€‘ 6. ä»€ä¹ˆæ˜¯shuffleï¼Œä»¥åŠä¸ºä»€ä¹ˆéœ€è¦shuffleï¼Ÿ ã€æŸç§å…·æœ‰å…±åŒç‰¹å¾çš„æ•°æ®æ±‡èšåˆ°ä¸€ä¸ªè®¡ç®—èŠ‚ç‚¹ä¸Šè¿›è¡Œè®¡ç®—ã€‘ 7. Spark master HA ä¸»ä»åˆ‡æ¢è¿‡ç¨‹ä¸ä¼šå½±å“é›†ç¾¤å·²æœ‰çš„ä½œä¸šè¿è¡Œï¼Œä¸ºä»€ä¹ˆï¼Ÿ ã€å› ä¸ºç¨‹åºåœ¨è¿è¡Œä¹‹å‰ï¼Œå·²ç»ç”³è¯·è¿‡èµ„æºäº†ï¼Œdriverå’ŒExecutorsé€šè®¯ï¼Œä¸éœ€è¦å’Œmasterè¿›è¡Œé€šè®¯çš„ã€‘ 8. Sparkå¹¶è¡Œåº¦æ€ä¹ˆè®¾ç½®æ¯”è¾ƒåˆé€‚ ã€sparkå¹¶è¡Œåº¦ï¼Œæ¯ä¸ªcoreæ‰¿è½½2~4ä¸ªpartitionï¼ˆå¹¶è¡Œåº¦ï¼‰ã€‘ 9. Sparkç¨‹åºæ‰§è¡Œï¼Œæœ‰æ—¶å€™é»˜è®¤ä¸ºä»€ä¹ˆä¼šäº§ç”Ÿå¾ˆå¤štaskï¼Œæ€ä¹ˆä¿®æ”¹é»˜è®¤taskæ‰§è¡Œä¸ªæ•°ï¼Ÿ 10. Sparkä¸­æ•°æ®çš„ä½ç½®æ˜¯è¢«è°ç®¡ç†çš„ï¼Ÿ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ã€æ¯ä¸ªæ•°æ®åˆ†ç‰‡éƒ½å¯¹åº”å…·ä½“ç‰©ç†ä½ç½®ï¼Œæ•°æ®çš„ä½ç½®æ˜¯è¢«blockManagerç®¡ç†ã€‘ 11. ä¸ºä»€ä¹ˆè¦è¿›è¡Œåºåˆ—åŒ–? &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ã€å‡å°‘å­˜å‚¨ç©ºé—´ï¼Œé«˜æ•ˆå­˜å‚¨å’Œä¼ è¾“æ•°æ®ï¼Œç¼ºç‚¹ï¼šä½¿ç”¨æ—¶éœ€è¦ååºåˆ—åŒ–ï¼Œéå¸¸æ¶ˆè€—CPUã€‘ 12. Sparkå¦‚ä½•å¤„ç†ä¸èƒ½è¢«åºåˆ—åŒ–çš„å¯¹è±¡ï¼Ÿ ã€å°è£…æˆobjectã€‘ 2.1 sparkå·¥ä½œæœºåˆ¶ ç”¨æˆ·åœ¨clientç«¯æäº¤ä½œä¸šåï¼Œä¼šç”±Driverè¿è¡Œmainæ–¹æ³•å¹¶åˆ›å»º sparkContext æ‰§è¡Œaddç®—å­ï¼Œå½¢æˆdagå›¾è¾“å…¥dagscheduler ï¼Œ (åˆ›å»ºjob,åˆ’åˆ†Stage,æäº¤Stage) æŒ‰ç…§addä¹‹é—´çš„ä¾èµ–å…³ç³»åˆ’åˆ†stageè¾“å…¥task scheduler task schedulerä¼šå°†stageåˆ’åˆ†ä¸ºtasksetåˆ†å‘åˆ°å„ä¸ªèŠ‚ç‚¹çš„executorä¸­æ‰§è¡Œ 2.2 Sparkåº”ç”¨ç¨‹åºçš„æ‰§è¡Œè¿‡ç¨‹1 . æ„å»ºSpark Applicationçš„è¿è¡Œç¯å¢ƒï¼ˆå¯åŠ¨SparkContextï¼‰ 2 . SparkContextå‘èµ„æºç®¡ç†å™¨ï¼ˆå¯ä»¥æ˜¯Standaloneã€Mesosæˆ–YARNï¼‰æ³¨å†Œå¹¶ç”³è¯·è¿è¡ŒExecutorèµ„æºï¼› 3 . èµ„æºç®¡ç†å™¨åˆ†é…Executorèµ„æºï¼ŒExecutorè¿è¡Œæƒ…å†µå°†éšç€å¿ƒè·³å‘é€åˆ°èµ„æºç®¡ç†å™¨ä¸Šï¼› YARNé›†ç¾¤ç®¡ç†å™¨ä¼šæ ¹æ®æˆ‘ä»¬ä¸ºSparkä½œä¸šè®¾ç½®çš„èµ„æºå‚æ•°ï¼Œåœ¨å„ä¸ªå·¥ä½œèŠ‚ç‚¹ä¸Šï¼Œå¯åŠ¨ä¸€å®šæ•°é‡çš„Executorè¿›ç¨‹ï¼Œæ¯ä¸ªExecutorè¿›ç¨‹éƒ½å æœ‰ä¸€å®šæ•°é‡çš„å†…å­˜å’ŒCPU coreã€‚ 4 . SparkContextæ„å»ºæˆDAGå›¾ï¼Œå°†DAGå›¾åˆ†è§£æˆStageï¼Œå¹¶æŠŠTasksetå‘é€ç»™Task Scheduler5 . Executorå‘SparkContextç”³è¯·Taskï¼ŒTask Schedulerå°†Taskå‘æ”¾ç»™Executorè¿è¡Œï¼ŒSparkContextå°†åº”ç”¨ç¨‹åºä»£ç å‘æ”¾ç»™Executorã€‚6 . Taskåœ¨Executorä¸Šè¿è¡Œï¼Œè¿è¡Œå®Œæ¯•é‡Šæ”¾æ‰€æœ‰èµ„æº åœ¨ç”³è¯·åˆ°äº†ä½œä¸šæ‰§è¡Œæ‰€éœ€çš„èµ„æºä¹‹åï¼ŒDriverè¿›ç¨‹å°±ä¼šå¼€å§‹è°ƒåº¦å’Œæ‰§è¡Œæˆ‘ä»¬ç¼–å†™çš„ä½œä¸šä»£ç äº†ã€‚ Driverè¿›ç¨‹ä¼šå°†æˆ‘ä»¬ç¼–å†™çš„Sparkä½œä¸šä»£ç åˆ†æ‹†ä¸ºå¤šä¸ªstageï¼Œæ¯ä¸ªstageæ‰§è¡Œä¸€éƒ¨åˆ†ä»£ç ç‰‡æ®µï¼Œå¹¶ä¸ºæ¯ä¸ªstageåˆ›å»ºä¸€æ‰¹taskï¼Œç„¶åå°†è¿™äº›taskåˆ†é…åˆ°å„ä¸ªExecutorè¿›ç¨‹ä¸­æ‰§è¡Œã€‚ taskæ˜¯æœ€å°çš„è®¡ç®—å•å…ƒï¼Œè´Ÿè´£æ‰§è¡Œä¸€æ¨¡ä¸€æ ·çš„è®¡ç®—é€»è¾‘ï¼ˆä¹Ÿå°±æ˜¯æˆ‘ä»¬è‡ªå·±ç¼–å†™çš„æŸä¸ªä»£ç ç‰‡æ®µï¼‰ï¼Œåªæ˜¯æ¯ä¸ªtaskå¤„ç†çš„æ•°æ®ä¸åŒè€Œå·²ã€‚ ä¸€ä¸ªstageçš„æ‰€æœ‰taskéƒ½æ‰§è¡Œå®Œæ¯•ä¹‹åï¼Œä¼šåœ¨å„ä¸ªèŠ‚ç‚¹æœ¬åœ°çš„ç£ç›˜æ–‡ä»¶ä¸­å†™å…¥è®¡ç®—ä¸­é—´ç»“æœï¼Œç„¶åDriverå°±ä¼šè°ƒåº¦è¿è¡Œä¸‹ä¸€ä¸ªstageã€‚ ä¸‹ä¸€ä¸ªstageçš„taskçš„è¾“å…¥æ•°æ®å°±æ˜¯ä¸Šä¸€ä¸ªstageè¾“å‡ºçš„ä¸­é—´ç»“æœã€‚å¦‚æ­¤å¾ªç¯å¾€å¤ï¼Œç›´åˆ°å°†æˆ‘ä»¬è‡ªå·±ç¼–å†™çš„ä»£ç é€»è¾‘å…¨éƒ¨æ‰§è¡Œå®Œï¼Œå¹¶ä¸”è®¡ç®—å®Œæ‰€æœ‰çš„æ•°æ®ï¼Œå¾—åˆ°æˆ‘ä»¬æƒ³è¦çš„ç»“æœä¸ºæ­¢ã€‚ stageçš„åˆ’åˆ† Sparkæ˜¯æ ¹æ®shuffleç±»ç®—å­æ¥è¿›è¡Œstageçš„åˆ’åˆ†ã€‚å¦‚æœæˆ‘ä»¬çš„ä»£ç ä¸­æ‰§è¡Œäº†æŸä¸ªshuffleç±»ç®—å­ï¼ˆæ¯”å¦‚reduceByKeyã€joinç­‰ï¼‰ï¼Œé‚£ä¹ˆå°±ä¼šåœ¨è¯¥ç®—å­å¤„ï¼Œåˆ’åˆ†å‡ºä¸€ä¸ªstageç•Œé™æ¥ã€‚å¯ä»¥å¤§è‡´ç†è§£ä¸ºï¼Œshuffleç®—å­æ‰§è¡Œä¹‹å‰çš„ä»£ç ä¼šè¢«åˆ’åˆ†ä¸ºä¸€ä¸ªstageï¼Œshuffleç®—å­æ‰§è¡Œä»¥åŠä¹‹åçš„ä»£ç ä¼šè¢«åˆ’åˆ†ä¸ºä¸‹ä¸€ä¸ªstageã€‚ å› æ­¤ä¸€ä¸ªstageåˆšå¼€å§‹æ‰§è¡Œçš„æ—¶å€™ï¼Œå®ƒçš„æ¯ä¸ªtaskå¯èƒ½éƒ½ä¼šä»ä¸Šä¸€ä¸ªstageçš„taskæ‰€åœ¨çš„èŠ‚ç‚¹ï¼Œå»é€šè¿‡ç½‘ç»œä¼ è¾“æ‹‰å–éœ€è¦è‡ªå·±å¤„ç†çš„æ‰€æœ‰keyï¼Œç„¶åå¯¹æ‹‰å–åˆ°çš„æ‰€æœ‰ç›¸åŒçš„keyä½¿ç”¨æˆ‘ä»¬è‡ªå·±ç¼–å†™çš„ç®—å­å‡½æ•°æ‰§è¡Œèšåˆæ“ä½œï¼ˆæ¯”å¦‚reduceByKey()ç®—å­æ¥æ”¶çš„å‡½æ•°ï¼‰ã€‚è¿™ä¸ªè¿‡ç¨‹å°±æ˜¯shuffleã€‚ å½“æˆ‘ä»¬åœ¨ä»£ç ä¸­æ‰§è¡Œäº†cache/persistç­‰æŒä¹…åŒ–æ“ä½œæ—¶ï¼Œæ ¹æ®æˆ‘ä»¬é€‰æ‹©çš„æŒä¹…åŒ–çº§åˆ«çš„ä¸åŒï¼Œæ¯ä¸ªtaskè®¡ç®—å‡ºæ¥çš„æ•°æ®ä¹Ÿä¼šä¿å­˜åˆ°Executorè¿›ç¨‹çš„å†…å­˜æˆ–è€…æ‰€åœ¨èŠ‚ç‚¹çš„ç£ç›˜æ–‡ä»¶ä¸­ã€‚ No. Executorçš„å†…å­˜ä¸»è¦åˆ†ä¸ºä¸‰å— 1. ç¬¬ä¸€å—æ˜¯è®©taskæ‰§è¡Œæˆ‘ä»¬è‡ªå·±ç¼–å†™çš„ä»£ç æ—¶ä½¿ç”¨ï¼Œé»˜è®¤æ˜¯å Executoræ€»å†…å­˜çš„20%ï¼› 2. ç¬¬äºŒå—æ˜¯è®©taské€šè¿‡shuffleè¿‡ç¨‹æ‹‰å–äº†ä¸Šä¸€ä¸ªstageçš„taskçš„è¾“å‡ºåï¼Œè¿›è¡Œèšåˆç­‰æ“ä½œæ—¶ä½¿ç”¨ï¼Œé»˜è®¤ä¹Ÿæ˜¯å Executoræ€»å†…å­˜çš„20%ï¼› 3. ç¬¬ä¸‰å—æ˜¯è®©RDDæŒä¹…åŒ–æ—¶ä½¿ç”¨ï¼Œé»˜è®¤å Executoræ€»å†…å­˜çš„60%ã€‚ Sparkæ€§èƒ½ä¼˜åŒ–æŒ‡å—â€”â€”åŸºç¡€ç¯‡ ./bin/spark-submit \\ --master yarn-cluster \\ --num-executors 100 \\ --executor-memory 6G \\ --executor-cores 4 \\ --driver-memory 1G \\ --conf spark.default.parallelism=1000 \\ --conf spark.storage.memoryFraction=0.5 \\ --conf spark.shuffle.memoryFraction=0.3 \\ 2.3 driverçš„åŠŸèƒ½æ˜¯ä»€ä¹ˆï¼ŸSparkä½œä¸šè¿è¡Œæ—¶åŒ…æ‹¬ä¸€ä¸ªDriverè¿›ç¨‹ï¼Œä¹Ÿæ˜¯ä½œä¸šä¸»è¿›ç¨‹ï¼Œæœ‰mainå‡½æ•°ï¼Œä¸”æœ‰SparkContextçš„å®ä¾‹ï¼Œæ˜¯ç¨‹åºå…¥å£ç‚¹ï¼› åŠŸèƒ½ï¼š å‘é›†ç¾¤ç”³è¯·èµ„æº è´Ÿè´£äº†ä½œä¸šçš„è°ƒåº¦å’Œè§£æ ç”ŸæˆStageå¹¶è°ƒåº¦Taskåˆ°Executorä¸Šï¼ˆåŒ…æ‹¬DAGSchedulerï¼ŒTaskSchedulerï¼‰ 2.4 Sparkä¸­Workerå·¥ä½œæ˜¯ä»€ä¹ˆï¼Ÿ ç®¡ç†å½“å‰èŠ‚ç‚¹å†…å­˜ï¼ŒCPUä½¿ç”¨çŠ¶å†µ,æ¥æ”¶masteråˆ†é…è¿‡æ¥çš„èµ„æºæŒ‡ä»¤,é€šè¿‡ExecutorRunnerå¯åŠ¨ç¨‹åºåˆ†é…ä»»åŠ¡ workerå°±ç±»ä¼¼äºåŒ…å·¥å¤´ï¼Œç®¡ç†åˆ†é…æ–°è¿›ç¨‹ï¼Œåšè®¡ç®—çš„æœåŠ¡ï¼Œç›¸å½“äºprocessæœåŠ¡ workerä¸ä¼šè¿è¡Œä»£ç ï¼Œå…·ä½“è¿è¡Œçš„æ˜¯Executoræ˜¯å¯ä»¥è¿è¡Œå…·ä½“appliactionå†™çš„ä¸šåŠ¡é€»è¾‘ä»£ç  Process è¿›ç¨‹ 2.4 Spark ç¨‹åºæ‰§è¡Œï¼Œæœ‰æ—¶å€™é»˜è®¤ä¸ºä»€ä¹ˆä¼šäº§ç”Ÿå¾ˆå¤štaskï¼Œæ€ä¹ˆä¿®æ”¹é»˜è®¤taskæ‰§è¡Œä¸ªæ•°ï¼Ÿ æœ‰å¾ˆå¤šå°æ–‡ä»¶çš„æ—¶å€™ï¼Œæœ‰å¤šå°‘ä¸ªè¾“å…¥blockå°±ä¼šæœ‰å¤šå°‘ä¸ªtaskå¯åŠ¨ sparkä¸­æœ‰partitionï¼Œæ¯ä¸ªpartitionéƒ½ä¼šå¯¹åº”ä¸€ä¸ªtaskï¼Œtaskè¶Šå¤šï¼Œåœ¨å¤„ç†å¤§è§„æ¨¡æ•°æ®çš„æ—¶å€™ï¼Œå°±ä¼šè¶Šæœ‰æ•ˆç‡ 3. Spark ä¸ Hadoop æ¯”è¾ƒ(7) Mapreduceå’ŒSparkçš„ç›¸åŒå’ŒåŒºåˆ« ç®€ç­”è¯´ä¸€ä¸‹hadoopçš„mapreduceç¼–ç¨‹æ¨¡å‹ ç®€å•è¯´ä¸€ä¸‹hadoopå’Œsparkçš„shuffleç›¸åŒå’Œå·®å¼‚ï¼Ÿ ç®€å•è¯´ä¸€ä¸‹hadoopå’Œsparkçš„shuffleè¿‡ç¨‹ partitionå’Œblockçš„å…³è” Sparkä¸ºä»€ä¹ˆæ¯”mapreduceå¿«ï¼Ÿ Mapreduceæ“ä½œçš„mapperå’Œreduceré˜¶æ®µç›¸å½“äºsparkä¸­çš„å“ªå‡ ä¸ªç®—å­ï¼Ÿ ç›¸å½“äºsparkä¸­çš„mapç®—å­å’ŒreduceByKeyç®—å­ï¼ŒåŒºåˆ«ï¼šMRä¼šè‡ªåŠ¨è¿›è¡Œæ’åºçš„ï¼Œsparkè¦çœ‹å…·ä½“partitioner 3.1 MRå’ŒSparkç›¸åŒå’ŒåŒºåˆ« sparkç”¨æˆ·æäº¤çš„ä»»åŠ¡ï¼šapplication ä¸€ä¸ªapplicationå¯¹åº”ä¸€ä¸ªSparkContextï¼Œappä¸­å­˜åœ¨å¤šä¸ªjob 1). æ¯è§¦å‘ä¸€æ¬¡actionä¼šäº§ç”Ÿä¸€ä¸ª job -&gt; è¿™äº›jobå¯ä»¥å¹¶è¡Œæˆ–ä¸²è¡Œæ‰§è¡Œ 2). æ¯ä¸ªjobæœ‰å¤šä¸ª stageï¼Œstageæ˜¯shuffleè¿‡ç¨‹ä¸­DAGSchaduleré€šè¿‡RDDä¹‹é—´çš„ä¾èµ–å…³ç³»åˆ’åˆ†jobè€Œæ¥çš„ 3). æ¯ä¸ªstageé‡Œé¢æœ‰å¤šä¸ª taskï¼Œç»„æˆ taskset æœ‰ TaskSchaduler åˆ†å‘åˆ°å„ä¸ªexecutoræ‰§è¡Œ 4). executor ç”Ÿå‘½å‘¨æœŸå’Œappä¸€æ ·çš„ï¼Œå³ä½¿æ²¡æœ‰jobè¿è¡Œä¹Ÿå­˜åœ¨ï¼Œæ‰€ä»¥taskå¯ä»¥å¿«é€Ÿå¯åŠ¨è¯»å–å†…å­˜è¿›è¡Œè®¡ç®—. 3.2 mapreduce ç¼–ç¨‹æ¨¡å‹ map taskä¼šä»æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿè¯»å–æ•°æ®ï¼Œè½¬æ¢æˆkey-valueå½¢å¼çš„é”®å€¼å¯¹é›†åˆ key-value,é›†åˆ,input to mapperè¿›è¡Œä¸šåŠ¡å¤„ç†è¿‡ç¨‹ï¼Œå°†å…¶è½¬æ¢æˆéœ€è¦çš„key-&gt; valueåœ¨è¾“å‡º ä¹‹åä¼šè¿›è¡Œä¸€ä¸ªpartitionåˆ†åŒºæ“ä½œï¼Œé»˜è®¤ä½¿ç”¨çš„æ˜¯hashpartitioner ä¹‹åä¼šå¯¹keyè¿›è¡Œè¿›è¡Œsortæ’åºï¼Œgroupingåˆ†ç»„æ“ä½œå°†ç›¸åŒkeyçš„valueåˆå¹¶åˆ†ç»„è¾“å‡º ä¹‹åè¿›è¡Œä¸€ä¸ªcombinerå½’çº¦æ“ä½œï¼Œå…¶å®å°±æ˜¯ä¸€ä¸ªæœ¬åœ°çš„reduceé¢„å¤„ç†ï¼Œä»¥å‡å°åé¢shufleå’Œreducerçš„å·¥ä½œé‡ reduce taskä¼šé€šè¿‡ç½‘ç»œå°†å„ä¸ªæ•°æ®æ”¶é›†è¿›è¡Œreduceå¤„ç† æœ€åå°†æ•°æ®ä¿å­˜æˆ–è€…æ˜¾ç¤ºï¼Œç»“æŸæ•´ä¸ªjob 3.3 mr/spark çš„ shuffle å·®å¼‚?high-level è§’åº¦ï¼š ä¸¤è€…å¹¶æ²¡æœ‰å¤§çš„å·®åˆ« éƒ½æ˜¯å°† mapperï¼ˆSpark: ShuffleMapTaskï¼‰çš„è¾“å‡ºè¿›è¡Œ partitionï¼Œ ä¸åŒçš„ partition é€åˆ°ä¸åŒçš„ reducerï¼ˆSpark é‡Œ reducer å¯èƒ½æ˜¯ä¸‹ä¸€ä¸ª stage é‡Œçš„ ShuffleMapTaskï¼Œä¹Ÿå¯èƒ½æ˜¯ ResultTaskï¼‰ Reducer ä»¥å†…å­˜ä½œç¼“å†²åŒºï¼Œè¾¹ shuffle è¾¹ aggregate æ•°æ®ï¼Œç­‰åˆ°æ•°æ® aggregate å¥½ä»¥åè¿›è¡Œ reduce(). low-level è§’åº¦ï¼š Hadoop MapReduce æ˜¯ sort-basedï¼Œè¿›å…¥ combine() å’Œ reduce() çš„ records å¿…é¡»å…ˆ sort. å¥½å¤„ï¼šcombine/reduce() å¯ä»¥å¤„ç†å¤§è§„æ¨¡çš„æ•°æ®, å› ä¸ºå…¶è¾“å…¥æ•°æ®å¯ä»¥é€šè¿‡å¤–æ’å¾—åˆ° (1) mapper å¯¹æ¯æ®µæ•°æ®å…ˆåšæ’åº(2) reducer çš„ shuffle å¯¹æ’å¥½åºçš„æ¯æ®µæ•°æ®åš å½’å¹¶ merge Spark é»˜è®¤é€‰æ‹©çš„æ˜¯ hash-basedï¼Œé€šå¸¸ä½¿ç”¨ HashMap æ¥å¯¹ shuffle æ¥çš„æ•°æ®è¿›è¡Œ aggregateï¼Œä¸æå‰æ’åºå¦‚æœç”¨æˆ·éœ€è¦ç»è¿‡æ’åºçš„æ•°æ®ï¼šsortByKey() å®ç°è§’åº¦ï¼š Hadoop MapReduce å°†å¤„ç†æµç¨‹åˆ’åˆ†å‡ºæ˜æ˜¾çš„å‡ ä¸ªé˜¶æ®µï¼šmap(), spilt, merge, shuffle, sort, reduce() Spark æ²¡æœ‰è¿™æ ·åŠŸèƒ½æ˜ç¡®çš„é˜¶æ®µï¼Œåªæœ‰ä¸åŒçš„ stage å’Œä¸€ç³»åˆ—çš„ transformation()ï¼Œspill, merge, aggregate ç­‰æ“ä½œéœ€è¦è•´å«åœ¨ transformation() ä¸­ 3.4 MR/Spark çš„ shuffle è¿‡ç¨‹ Tech description hadoop mapç«¯ä¿å­˜åˆ†ç‰‡æ•°æ®ï¼Œé€šè¿‡ç½‘ç»œæ”¶é›†åˆ°reduceç«¯ spark sparkçš„shuffleæ˜¯åœ¨DAGSchedularåˆ’åˆ†Stageçš„æ—¶å€™äº§ç”Ÿçš„ï¼ŒTaskScheduleè¦åˆ†å‘Stageåˆ°å„ä¸ªworkerçš„executorï¼Œå‡å°‘shuffleå¯ä»¥æé«˜æ€§èƒ½ 3.5 partition å’Œ block çš„å…³è” hdfs ä¸­çš„ block æ˜¯åˆ†å¸ƒå¼å­˜å‚¨çš„æœ€å°å•å…ƒï¼Œç­‰åˆ†ï¼Œå¯è®¾ç½®å†—ä½™ï¼Œè¿™æ ·è®¾è®¡æœ‰ä¸€éƒ¨åˆ†ç£ç›˜ç©ºé—´çš„æµªè´¹ï¼Œä½†æ˜¯æ•´é½çš„ blockå¤§å°ï¼Œä¾¿äºå¿«é€Ÿæ‰¾åˆ°ã€è¯»å–å¯¹åº”çš„å†…å®¹ Sparkä¸­çš„partitionæ˜¯RDDçš„æœ€å°å•å…ƒï¼ŒRDDæ˜¯ç”±åˆ†å¸ƒåœ¨å„ä¸ªèŠ‚ç‚¹ä¸Šçš„partitionç»„æˆçš„. partitionæ˜¯æŒ‡çš„sparkåœ¨è®¡ç®—è¿‡ç¨‹ä¸­ï¼Œç”Ÿæˆçš„æ•°æ®åœ¨è®¡ç®—ç©ºé—´å†…æœ€å°å•å…ƒ. åŒä¸€ä»½æ•°æ®ï¼ˆRDDï¼‰çš„partionå¤§å°ä¸ä¸€ï¼Œæ•°é‡ä¸å®šï¼Œæ˜¯æ ¹æ®applicationé‡Œçš„ç®—å­å’Œæœ€åˆè¯»å…¥çš„æ•°æ®åˆ†å—æ•°é‡å†³å®š block/partition description block ä½äºå­˜å‚¨ç©ºé—´, blockçš„å¤§å°æ˜¯å›ºå®šçš„ partition ä½äºè®¡ç®—ç©ºé—´, partionå¤§å°æ˜¯ä¸å›ºå®šçš„ 4. Spark RDD(4)4.1 RDDæœºåˆ¶ åˆ†å¸ƒå¼å¼¹æ€§æ•°æ®é›†ï¼Œç®€å•çš„ç†è§£æˆä¸€ç§æ•°æ®ç»“æ„ï¼Œæ˜¯sparkæ¡†æ¶ä¸Šçš„é€šç”¨è´§å¸ æ‰€æœ‰ç®—å­éƒ½æ˜¯åŸºäºrddæ¥æ‰§è¡Œçš„ rddæ‰§è¡Œè¿‡ç¨‹ä¸­ä¼šå½¢æˆdagå›¾ï¼Œç„¶åå½¢æˆlineageä¿è¯å®¹é”™æ€§ç­‰ ä»ç‰©ç†çš„è§’åº¦æ¥çœ‹rddå­˜å‚¨çš„æ˜¯blockå’Œnodeä¹‹é—´çš„æ˜ å°„ 4.2 RDDçš„å¼¹æ€§è¡¨ç°åœ¨å“ªå‡ ç‚¹ï¼Ÿ è‡ªåŠ¨çš„è¿›è¡Œå†…å­˜å’Œç£ç›˜çš„å­˜å‚¨åˆ‡æ¢ï¼› åŸºäºLingageçš„é«˜æ•ˆå®¹é”™ï¼› taskå¦‚æœå¤±è´¥ä¼šè‡ªåŠ¨è¿›è¡Œç‰¹å®šæ¬¡æ•°çš„é‡è¯•ï¼› stageå¦‚æœå¤±è´¥ä¼šè‡ªåŠ¨è¿›è¡Œç‰¹å®šæ¬¡æ•°çš„é‡è¯•ï¼Œè€Œä¸”åªä¼šè®¡ç®—å¤±è´¥çš„åˆ†ç‰‡ï¼› checkpointå’Œpersistï¼Œæ•°æ®è®¡ç®—ä¹‹åæŒä¹…åŒ–ç¼“å­˜ æ•°æ®è°ƒåº¦å¼¹æ€§ï¼ŒDAG TASKè°ƒåº¦å’Œèµ„æºæ— å…³ æ•°æ®åˆ†ç‰‡çš„é«˜åº¦å¼¹æ€§ï¼Œa.åˆ†ç‰‡å¾ˆå¤šç¢ç‰‡å¯ä»¥åˆå¹¶æˆå¤§çš„ï¼Œb.par 4.3 RDDæœ‰å“ªäº›ç¼ºé™·ï¼Ÿ ä¸æ”¯æŒç»†ç²’åº¦çš„å†™å’Œæ›´æ–°æ“ä½œï¼ˆå¦‚ç½‘ç»œçˆ¬è™«ï¼‰ sparkå†™æ•°æ®æ˜¯ç²—ç²’åº¦çš„ï¼Œæ‰€è°“ç²—ç²’åº¦ï¼Œå°±æ˜¯æ‰¹é‡å†™å…¥æ•°æ® ï¼ˆæ‰¹é‡å†™ï¼‰ ä½†æ˜¯è¯»æ•°æ®æ˜¯ç»†ç²’åº¦çš„ä¹Ÿå°±æ˜¯è¯´å¯ä»¥ä¸€æ¡æ¡çš„è¯» ï¼ˆä¸€æ¡æ¡è¯»ï¼‰ ä¸æ”¯æŒå¢é‡è¿­ä»£è®¡ç®—ï¼ŒFlinkæ”¯æŒ 4.4 ä»€ä¹ˆæ˜¯RDDå®½ä¾èµ–å’Œçª„ä¾èµ–ï¼ŸRDDå’Œå®ƒä¾èµ–çš„parent RDD(s)çš„å…³ç³»æœ‰ä¸¤ç§ä¸åŒçš„ç±»å‹ çª„ä¾èµ–ï¼šæ¯ä¸€ä¸ªparent RDDçš„Partitionæœ€å¤šè¢«å­RDDçš„ä¸€ä¸ªPartitionä½¿ç”¨ ï¼ˆä¸€çˆ¶ä¸€å­ï¼‰ å®½ä¾èµ–ï¼šå¤šä¸ªå­RDDçš„Partitionä¼šä¾èµ–åŒä¸€ä¸ªparent RDDçš„Partition ï¼ˆä¸€çˆ¶å¤šå­ï¼‰ 5. RDDæ“ä½œ(13)5.1 cacheå’Œpesistçš„åŒºåˆ« .cache() == .persist(MEMORY_ONLY) 5.2 cacheåé¢èƒ½ä¸èƒ½æ¥å…¶ä»–ç®—å­,å®ƒæ˜¯ä¸æ˜¯actionæ“ä½œï¼Ÿå¯ä»¥æ¥å…¶ä»–ç®—å­ï¼Œä½†æ˜¯æ¥äº†ç®—å­ä¹‹åï¼Œèµ·ä¸åˆ°ç¼“å­˜åº”æœ‰çš„æ•ˆæœï¼Œå› ä¸ºä¼šé‡æ–°è§¦å‘cachecacheä¸æ˜¯actionæ“ä½œ 5.3 ä»€ä¹ˆåœºæ™¯ä¸‹è¦è¿›è¡Œpersistæ“ä½œï¼Ÿ sparkæ‰€æœ‰å¤æ‚ä¸€ç‚¹çš„ç®—æ³•éƒ½ä¼šæœ‰persistèº«å½±,sparké»˜è®¤æ•°æ®æ”¾åœ¨å†…å­˜ï¼Œsparkå¾ˆå¤šå†…å®¹éƒ½æ˜¯æ”¾åœ¨å†…å­˜çš„ï¼Œéå¸¸é€‚åˆé«˜é€Ÿè¿­ä»£ï¼Œ1000ä¸ªæ­¥éª¤ åªæœ‰ç¬¬ä¸€ä¸ªè¾“å…¥æ•°æ®ï¼Œä¸­é—´ä¸äº§ç”Ÿä¸´æ—¶æ•°æ®ï¼Œä½†åˆ†å¸ƒå¼ç³»ç»Ÿé£é™©å¾ˆé«˜ï¼Œæ‰€ä»¥å®¹æ˜“å‡ºé”™ï¼Œå°±è¦å®¹é”™ï¼Œrddå‡ºé”™æˆ–è€…åˆ†ç‰‡å¯ä»¥æ ¹æ®è¡€ç»Ÿç®—å‡ºæ¥ï¼Œå¦‚æœæ²¡æœ‰å¯¹çˆ¶rddè¿›è¡Œpersist æˆ–cacheçš„åŒ–ï¼Œå°±è¦é‡å¤´åšã€‚ No. ä»¥ä¸‹åœºæ™¯ä¼šä½¿ç”¨persist Article 1ï¼‰ æŸä¸ªæ­¥éª¤è®¡ç®—éå¸¸è€—æ—¶ï¼Œéœ€è¦è¿›è¡ŒpersistæŒä¹…åŒ– ï¼› 2ï¼‰ è®¡ç®—é“¾æ¡éå¸¸é•¿ï¼Œé‡æ–°æ¢å¤è¦ç®—å¾ˆå¤šæ­¥éª¤ï¼Œå¾ˆå¥½ä½¿ï¼Œpersist ï¼› 3ï¼‰ checkpointæ‰€åœ¨çš„rddè¦æŒä¹…åŒ–persistï¼Œ lazyçº§åˆ«ï¼Œæ¡†æ¶å‘ç°æœ‰checnkpointï¼Œcheckpointæ—¶å•ç‹¬è§¦å‘ä¸€ä¸ªjobï¼Œéœ€è¦é‡ç®—ä¸€éï¼Œcheckpointå‰ è¦æŒä¹…åŒ–ï¼Œå†™ä¸ªrdd.cacheæˆ–è€…rdd.persistï¼Œå°†ç»“æœä¿å­˜èµ·æ¥ï¼Œå†å†™checkpointæ“ä½œï¼Œè¿™æ ·æ‰§è¡Œèµ·æ¥ä¼šéå¸¸å¿«ï¼Œä¸éœ€è¦é‡æ–°è®¡ç®—rddé“¾æ¡äº†ã€‚checkpointä¹‹å‰ä¸€å®šä¼šè¿›è¡Œpersistï¼›sc.setCheckpointDir(â€œhdfs://lijie:9000/checkpoint0727â€) rdd.cache() rdd.checkpoint() 4ï¼‰ shuffleä¹‹åä¸ºä»€ä¹ˆè¦persistï¼Œshuffleè¦è¿›æ€§ç½‘ç»œä¼ è¾“ï¼Œé£é™©å¾ˆå¤§ï¼Œæ•°æ®ä¸¢å¤±é‡æ¥ï¼Œæ¢å¤ä»£ä»·å¾ˆå¤§ ï¼› 5ï¼‰ shuffleä¹‹å‰è¿›è¡Œpersistï¼Œæ¡†æ¶é»˜è®¤å°†æ•°æ®æŒä¹…åŒ–åˆ°ç£ç›˜ï¼Œè¿™ä¸ªæ˜¯æ¡†æ¶è‡ªåŠ¨åšçš„ã€‚ 5.4 rddæœ‰å‡ ç§æ“ä½œç±»å‹ï¼Ÿä¸‰ç§ï¼ transformationï¼Œrddç”±ä¸€ç§è½¬ä¸ºå¦ä¸€ç§rdd action cronrollerï¼Œæ§åˆ¶ç®—å­(cache/persist) å¯¹æ€§èƒ½å’Œæ•ˆç‡çš„æœ‰å¾ˆå¥½çš„æ”¯æŒ 5.5 collectåŠŸèƒ½æ˜¯ä»€ä¹ˆï¼Œå…¶åº•å±‚æ˜¯æ€ä¹ˆå®ç°çš„ï¼Ÿ driveré€šè¿‡collectæŠŠé›†ç¾¤ä¸­å„ä¸ªèŠ‚ç‚¹çš„å†…å®¹æ”¶é›†è¿‡æ¥æ±‡æ€»æˆç»“æœcollectè¿”å›ç»“æœæ˜¯Arrayç±»å‹çš„ï¼Œåˆå¹¶åArrayä¸­åªæœ‰ä¸€ä¸ªå…ƒç´ ï¼Œæ˜¯tupleç±»å‹ï¼ˆKVç±»å‹çš„ï¼‰çš„ã€‚ 5.6 mapä¸flatMapçš„åŒºåˆ« mapï¼šå¯¹RDDæ¯ä¸ªå…ƒç´ è½¬æ¢ï¼Œæ–‡ä»¶ä¸­çš„æ¯ä¸€è¡Œæ•°æ®è¿”å›ä¸€ä¸ªæ•°ç»„å¯¹è±¡flatMapï¼šå¯¹RDDæ¯ä¸ªå…ƒç´ è½¬æ¢ï¼Œç„¶åå†æ‰å¹³åŒ–ï¼Œå°†æ‰€æœ‰çš„å¯¹è±¡åˆå¹¶ä¸ºä¸€ä¸ªå¯¹è±¡ï¼Œä¼šæŠ›å¼ƒå€¼ä¸ºnullçš„å€¼ 5.8 åˆ—ä¸¾ä½ å¸¸ç”¨çš„actionï¼Ÿ collectï¼Œreduce,take,count,saveAsTextFileç­‰ 5.10 Sparkç´¯åŠ å™¨æœ‰å“ªäº›ç‰¹ç‚¹ï¼Ÿ å…¨å±€çš„ï¼Œåªå¢ä¸å‡ï¼Œè®°å½•å…¨å±€é›†ç¾¤çš„å”¯ä¸€çŠ¶æ€åœ¨exeä¸­ä¿®æ”¹å®ƒï¼Œåœ¨driverè¯»å–executorçº§åˆ«å…±äº«çš„ï¼Œå¹¿æ’­å˜é‡æ˜¯taskçº§åˆ«çš„å…±äº«ä¸¤ä¸ªapplicationä¸å¯ä»¥å…±äº«ç´¯åŠ å™¨ï¼Œä½†æ˜¯åŒä¸€ä¸ªappä¸åŒçš„jobå¯ä»¥å…±äº« 5.11 spark hashParitionerçš„å¼Šç«¯ åˆ†åŒºåŸç†ï¼šå¯¹äºç»™å®šçš„keyï¼Œè®¡ç®—å…¶hashCodeå¼Šç«¯æ˜¯æ•°æ®ä¸å‡åŒ€ï¼Œå®¹æ˜“å¯¼è‡´æ•°æ®å€¾æ–œ 5.12 RangePartitioneråˆ†åŒºçš„åŸç† å°½é‡ä¿è¯æ¯ä¸ªåˆ†åŒºä¸­æ•°æ®é‡çš„å‡åŒ€ï¼Œè€Œä¸”åˆ†åŒºä¸åˆ†åŒºä¹‹é—´æ˜¯æœ‰åºçš„ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸€ä¸ªåˆ†åŒºä¸­çš„å…ƒç´ è‚¯å®šéƒ½æ˜¯æ¯”å¦ä¸€ä¸ªåˆ†åŒºå†…çš„å…ƒç´ å°æˆ–è€…å¤§åˆ†åŒºå†…çš„å…ƒç´ æ˜¯ä¸èƒ½ä¿è¯é¡ºåºçš„ç®€å•çš„è¯´å°±æ˜¯å°†ä¸€å®šèŒƒå›´å†…çš„æ•°æ˜ å°„åˆ°æŸä¸€ä¸ªåˆ†åŒºå†… 5.13 Sparkä¸­çš„HashShufleçš„æœ‰å“ªäº›ä¸è¶³ï¼Ÿ shuffleäº§ç”Ÿæµ·é‡çš„å°æ–‡ä»¶åœ¨ç£ç›˜ä¸Šï¼Œæ­¤æ—¶ä¼šäº§ç”Ÿå¤§é‡è€—æ—¶çš„ã€ä½æ•ˆçš„IOæ“ä½œï¼›å®¹æ˜“å¯¼è‡´å†…å­˜ä¸å¤Ÿç”¨ï¼Œç”±äºå†…å­˜éœ€è¦ä¿å­˜æµ·é‡çš„æ–‡ä»¶æ“ä½œå¥æŸ„å’Œä¸´æ—¶ç¼“å­˜ä¿¡æ¯å®¹æ˜“å‡ºç°æ•°æ®å€¾æ–œï¼Œå¯¼è‡´OOM 5. Spark å¤§æ•°æ®é—®é¢˜(7) No. Title 1. å¦‚ä½•ä½¿ç”¨Sparkè§£å†³TopNé—®é¢˜ï¼Ÿ 2. å¦‚ä½•ä½¿ç”¨Sparkè§£å†³åˆ†ç»„æ’åºé—®é¢˜ï¼Ÿ lines.groupByKey(), values.toList.sortWith 3. ç»™å®šaã€bä¸¤ä¸ªæ–‡ä»¶ï¼Œå„å­˜æ”¾50äº¿ä¸ªurlï¼Œæ¯ä¸ªurlå„å 64å­—èŠ‚ï¼Œå†…å­˜é™åˆ¶æ˜¯4Gï¼Œè®©ä½ æ‰¾å‡ºaã€bæ–‡ä»¶å…±åŒçš„url? Solutionï¼š åˆ’åˆ†å°æ–‡ä»¶ Hash &amp; Bloomfilter 4. æœ‰ä¸€ä¸ª1Gå¤§å°çš„ä¸€ä¸ªæ–‡ä»¶ï¼Œé‡Œé¢æ¯ä¸€è¡Œæ˜¯ä¸€ä¸ªè¯ï¼Œè¯çš„å¤§å°ä¸è¶…è¿‡16å­—èŠ‚ï¼Œå†…å­˜é™åˆ¶å¤§å°æ˜¯1Mï¼Œè¦æ±‚è¿”å›é¢‘æ•°æœ€é«˜çš„100ä¸ªè¯ (1). hash(x)%5000 5000ä¸ªå°æ–‡ä»¶ (2). ç»Ÿè®¡æ¯ä¸ªå°æ–‡ä»¶è¯é¢‘ 5. ç°æœ‰æµ·é‡æ—¥å¿—æ•°æ®ä¿å­˜åœ¨ä¸€ä¸ªè¶…çº§å¤§çš„æ–‡ä»¶ä¸­ï¼Œè¯¥æ–‡ä»¶æ— æ³•ç›´æ¥è¯»å…¥å†…å­˜ï¼Œè¦æ±‚ä»ä¸­æå–æŸå¤©å‡ºè®¿é—®ç™¾åº¦æ¬¡æ•°æœ€å¤šçš„é‚£ä¸ªIP &nbsp;&nbsp;&nbsp;&nbsp;åˆ†è€Œæ²»ä¹‹+Hash, Hash(IP)%1024 6. åœ¨2.5äº¿ä¸ªæ•´æ•°ä¸­æ‰¾å‡ºä¸é‡å¤çš„æ•´æ•°ï¼Œæ³¨ï¼Œå†…å­˜ä¸è¶³ä»¥å®¹çº³è¿™2.5äº¿ä¸ªæ•´æ•° æ–¹æ¡ˆ1ï¼šé‡‡ç”¨2-Bitmap æ–¹æ¡ˆ2ï¼šåˆ’åˆ†å°æ–‡ä»¶,åœ¨å°æ–‡ä»¶ä¸­æ‰¾å‡ºä¸é‡å¤çš„æ•´æ•°ï¼Œå¹¶æ’åºã€‚ç„¶åå†è¿›è¡Œå½’å¹¶ï¼Œæ³¨æ„å»é™¤é‡å¤çš„å…ƒç´  7. è…¾è®¯é¢è¯•é¢˜ï¼šç»™40äº¿ä¸ªä¸é‡å¤çš„unsignedintçš„æ•´æ•°ï¼Œæ²¡æ’è¿‡åºçš„ï¼Œç„¶åå†ç»™ä¸€ä¸ªæ•°ï¼Œå¦‚ä½•å¿«é€Ÿåˆ¤æ–­è¿™ä¸ªæ•°æ˜¯å¦åœ¨é‚£40äº¿ä¸ªæ•°å½“ä¸­? ç”³è¯·512Mçš„å†…å­˜ï¼Œä¸€ä¸ªbitä½ä»£è¡¨ä¸€ä¸ªunsignedintå€¼ã€‚è¯»å…¥40äº¿ä¸ªæ•°ï¼Œè®¾ç½®ç›¸åº”çš„bitä½ï¼Œè¯»å…¥è¦æŸ¥è¯¢çš„æ•°ï¼ŒæŸ¥çœ‹ç›¸åº”bitä½æ˜¯å¦ä¸º1ï¼Œä¸º1è¡¨ç¤ºå­˜åœ¨ï¼Œä¸º0è¡¨ç¤ºä¸å­˜åœ¨ Hiveæ•°ä»“å»ºè¡¨è¯¥é€‰ç”¨ORCè¿˜æ˜¯Parquetï¼Œå‹ç¼©é€‰LZOè¿˜æ˜¯Snappyï¼Ÿ ã€Œæ‰€ä»¥åœ¨å®é™…ç”Ÿäº§ä¸­ï¼Œä½¿ç”¨Parquetå­˜å‚¨ï¼Œlzoå‹ç¼©çš„æ–¹å¼æ›´ä¸ºå¸¸è§ï¼Œè¿™ç§æƒ…å†µä¸‹å¯ä»¥é¿å…ç”±äºè¯»å–ä¸å¯åˆ†å‰²å¤§æ–‡ä»¶å¼•å‘çš„æ•°æ®å€¾æ–œã€‚ ä½†æ˜¯ï¼Œå¦‚æœæ•°æ®é‡å¹¶ä¸å¤§ï¼ˆé¢„æµ‹ä¸ä¼šæœ‰è¶…å¤§æ–‡ä»¶ï¼Œè‹¥å¹²Gä»¥ä¸Šï¼‰çš„æƒ…å†µä¸‹ï¼Œä½¿ç”¨ORCå­˜å‚¨ï¼Œsnappyå‹ç¼©çš„æ•ˆç‡è¿˜æ˜¯éå¸¸é«˜çš„ã€‚ã€ ReferenceSparkç®—å­ï¼šRDDåŸºæœ¬è½¬æ¢æ“ä½œ(2)â€“coalesceã€repartition SparkçŸ¥è¯†ç‚¹æ±‡æ€» Sparkæ€»ç»“(ä¸€) çŸ¥ä¹ Spark:Yarn-clusterå’ŒYarn-clientåŒºåˆ«ä¸è”ç³» Sparkå¸¸ç”¨ç®—å­ ã€ŠSparkå¿«é€Ÿå¤§æ•°æ®åˆ†æã€‹RDDæ“ä½œæ€»ç»“ Sparkå¸¸è§é¢è¯•é—®é¢˜æœ‰å“ªäº›ï¼Ÿ Sparkå­¦ä¹ ç—›ç‚¹å’Œè·¯çº¿å›¾ Sparké¢è¯•é¢˜(ä¸€) æ¯ä¸ª Spark å·¥ç¨‹å¸ˆéƒ½åº”è¯¥çŸ¥é“çš„äº”ç§ Join ç­–ç•¥","categories":[{"name":"spark","slug":"spark","permalink":"http://iequa.com/categories/spark/"}],"tags":[{"name":"spark","slug":"spark","permalink":"http://iequa.com/tags/spark/"}]},{"title":"Spark Chap 7 å†…å­˜æ¨¡å‹å’Œèµ„æºè°ƒä¼˜","slug":"spark/spark-aura-7.1-memory","date":"2020-10-19T15:07:21.000Z","updated":"2021-02-19T00:36:42.314Z","comments":true,"path":"2020/10/19/spark/spark-aura-7.1-memory/","link":"","permalink":"http://iequa.com/2020/10/19/spark/spark-aura-7.1-memory/","excerpt":"1. Sparkæ€§èƒ½ä¼˜åŒ–æŒ‡å—â€”â€”åŸºç¡€ç¯‡","text":"1. Sparkæ€§èƒ½ä¼˜åŒ–æŒ‡å—â€”â€”åŸºç¡€ç¯‡ æœ€é‡è¦çš„5å¼ å›¾ - MapReduceç¼–ç¨‹æ¡ˆä¾‹ by é©¬ä¸­å mapreduce çš„ shuffle æ˜¯ä¸€é€šç”¨çš„ shuffle (æ—¢æ¯ä¸€ä¸ªtaskæœ€ç»ˆéƒ½åªä¼šå½¢æˆä¸€ä¸ªç£ç›˜æ–‡ä»¶+ä¸€ä¸ªç´¢å¼•)spark çš„4ç§ shuffle å°±æ˜¯åœ¨ mapreduce çš„ shuffle åŸºç¡€ä¹‹ä¸Š, è¿›è¡Œäº†æŸäº›åŠ¨ä½œçš„åˆ å‡ä¹‹åå½¢æˆçš„ å¤šç§ shuffle æ–¹æ¡ˆé€‰æ‹©: mapreduce: partitioner, combiner, sort spark: å¯ä»¥åœ¨ 4 ç§æ–¹æ¡ˆä¸­é€‰æ‹©ä½¿ç”¨å…¶ä¸­çš„å“ªä¸€ç§ã€‚ (å°±æ˜¯å¯¹ä¸Šé¢çš„ mapreduce shuffle è¿‡ç¨‹çš„) å„ç§å…¨ç†è®ºï¼š 1) spark çš„å†…å­˜æ¨¡å‹ å †å†…å†…å­˜ + å †å¤–å†…å­˜ æ‰§è¡Œå†…å­˜ + å­˜å‚¨å†…å­˜ é™æ€å†…å­˜æ¨¡å‹ + ç»Ÿä¸€å†…å­˜æ¨¡å‹ åŠ¨æ€å ç”¨æœºåˆ¶ 2) èµ„æºè°ƒä¼˜ num-executors executor-memory total-executor-cores spark.shuffle.memoryFraction spark.storage.memoryFractionâ€¦spark-submit â€¦ 3) spark çš„ shuffle HashShuffleManager æœªä¼˜åŒ–ç‰ˆæœ¬å·²ä¼˜åŒ–ç‰ˆæœ¬ SortShuffleManager æ™®é€šçš„æœºåˆ¶bypassæœºåˆ¶ 1. Spark çš„ shuffle è°ƒä¼˜spark.shuffle.io.maxRetries é»˜è®¤å€¼ï¼š3 å‚æ•°è¯´æ˜ï¼šshuffle read taskä»shuffle write taskæ‰€åœ¨èŠ‚ç‚¹æ‹‰å–å±äºè‡ªå·±çš„æ•°æ®æ—¶ï¼Œå¦‚æœå› ä¸ºç½‘ç»œå¼‚å¸¸å¯¼è‡´æ‹‰å–å¤±è´¥ï¼Œæ˜¯ä¼šè‡ªåŠ¨è¿›è¡Œé‡è¯•çš„ã€‚è¯¥å‚æ•°å°±ä»£è¡¨äº†å¯ä»¥é‡è¯•çš„æœ€å¤§æ¬¡æ•°ã€‚å¦‚æœåœ¨æŒ‡å®šæ¬¡æ•°ä¹‹å†…æ‹‰å–è¿˜æ˜¯æ²¡æœ‰æˆåŠŸï¼Œå°±å¯èƒ½ä¼šå¯¼è‡´ä½œä¸šæ‰§è¡Œå¤±è´¥ã€‚ è°ƒä¼˜å»ºè®®ï¼šå¯¹äºé‚£äº›åŒ…å«äº†ç‰¹åˆ«è€—æ—¶çš„shuffleæ“ä½œçš„ä½œä¸šï¼Œå»ºè®®å¢åŠ é‡è¯•æœ€å¤§æ¬¡æ•°ï¼ˆæ¯”å¦‚60æ¬¡ï¼‰ï¼Œä»¥é¿å…ç”±äºJVMçš„full gcæˆ–è€…ç½‘ç»œä¸ç¨³å®šç­‰å› ç´ å¯¼è‡´çš„æ•°æ®æ‹‰å–å¤±è´¥ã€‚åœ¨å®è·µä¸­å‘ç°ï¼Œå¯¹äºé’ˆå¯¹è¶…å¤§æ•°æ®é‡ï¼ˆæ•°åäº¿~ä¸Šç™¾äº¿ï¼‰çš„shuffleè¿‡ç¨‹ï¼Œè°ƒèŠ‚è¯¥å‚æ•°å¯ä»¥å¤§å¹…åº¦æå‡ç¨³å®šæ€§ã€‚ spark.shuffle.io.retryWait é»˜è®¤å€¼ï¼š5s å‚æ•°è¯´æ˜ï¼šå…·ä½“è§£é‡ŠåŒä¸Šï¼Œè¯¥å‚æ•°ä»£è¡¨äº†æ¯æ¬¡é‡è¯•æ‹‰å–æ•°æ®çš„ç­‰å¾…é—´éš”ï¼Œé»˜è®¤æ˜¯5sã€‚ è°ƒä¼˜å»ºè®®ï¼šå»ºè®®åŠ å¤§é—´éš”æ—¶é•¿ï¼ˆæ¯”å¦‚60sï¼‰ï¼Œä»¥å¢åŠ shuffleæ“ä½œçš„ç¨³å®šæ€§ã€‚ 2. sparkå¼€å‘è°ƒä¼˜å’ŒDatSkewå¤ä¹ 2.1 å¼€å‘è°ƒä¼˜ &nbsp;å¼€å‘è°ƒä¼˜ 1 ~ 3: é‡å¤åˆ©ç”¨ä¸€ä¸ªRDD é‡å¤åˆ©ç”¨ä¸€ä¸ªRDD (1). é¿å…åˆ›å»ºé‡å¤ RDD (2). å°½å¯èƒ½å¤ç”¨åŒä¸€ä¸ª RDD (3). å¯¹å¤šæ¬¡ä½¿ç”¨çš„ RDD è¿›è¡ŒæŒä¹…åŒ– å¼€å‘è°ƒä¼˜ 4 ~ 6: æé«˜ä»»åŠ¡å¤„ç†çš„æ€§èƒ½ æé«˜ä»»åŠ¡å¤„ç†çš„æ€§èƒ½ (4). å°½é‡é¿å…ä½¿ç”¨ shuffle ç±»ç®—å­ (5). ä½¿ç”¨ map-side é¢„èšåˆçš„ shuffle æ“ä½œ (6). ä½¿ç”¨é«˜æ€§èƒ½ç®—å­ (7). å¹¿æ’­å¤§å˜é‡ (å‡è½»ç½‘ç»œè´Ÿæ‹…) (8). ä½¿ç”¨ Kryo ä¼˜åŒ–åºåˆ—åŒ–æ€§èƒ½ (9). ä¼˜åŒ–æ•°æ®ç»“æ„ æ€»ç»“ï¼š å¦‚æœè¯´æœ‰æŸä¸€ä¸ª RDD ä¼šåœ¨ä¸€ä¸ªç¨‹åºä¸­è¢«å¤šæ¬¡ä½¿ç”¨ï¼Œé‚£ä¹ˆå°±åº”è¯¥ä¸è¦é‡å¤åˆ›å»ºï¼Œè¦å¤šæ¬¡ä½¿ç”¨è¿™ä¸€ä¸ªRDD (ä¸å¯å˜çš„)ï¼Œæ—¢ç„¶è¦é‡å¤åˆ©ç”¨ä¸€ä¸ªRDDï¼Œå°±åº”è¯¥æŠŠè¿™ä¸ª RDD è¿›è¡ŒæŒä¹…åŒ–. ï¼ˆæœ€å¥½åœ¨å†…å­˜ä¸­ï¼‰ cache persist æŒä¹…åŒ–æ•°æ®åˆ°ç£ç›˜æˆ–å†…å­˜ unpersistå¦‚ä½•æŠŠæŒä¹…åŒ–åˆ°ç£ç›˜æˆ–å†…å­˜ä¸­çš„æ•°æ®ç»™åˆ é™¤æ‰å‘¢ï¼Ÿ rdd. 2.2 Data Skewæ•°æ®å¦‚ä½•åˆ†åŒºï¼Ÿ (éšæœºï¼Œhashï¼ŒèŒƒå›´) Data Skew description (1). DataSkew å‘ç”Ÿçš„ç°è±¡ (2). DataSkew å‘ç”Ÿçš„åŸç† &gt; æ•°æ®åˆ†å¸ƒä¸å‡åŒ€ &gt; è¿½æ±‚çš„ç›®æ ‡ï¼š æ•°æ®åˆ†å¸ƒè¦å‡åŒ€ (3). å¦‚ä½•å®šä½å¯¼è‡´ DataSkew çš„ä»£ç  &gt; æŸä¸ª task æ‰§è¡Œç‰¹åˆ«æ…¢çš„æƒ…å†µ &gt; æŸä¸ª task è«åå…¶å¦™å†…å­˜æº¢å‡ºçš„æƒ…å†µ (4). æŸ¥çœ‹å¯¼è‡´ DataSkew çš„ key çš„æ•°æ®åˆ†å¸ƒæƒ…å†µ &gt; æµ‹è¯• &gt; é‡‡æ · 3. spark çš„å†…å­˜ç®¡ç†å®è§‚æ¦‚è¿°spark ä½œä¸ºåŸºäºå†…å­˜çš„åˆ†å¸ƒå¼è®¡ç®—å¼•æ“, å…¶å†…å­˜ç®¡ç†æ¨¡å—åœ¨æ•´ä¸ªç³»ç»Ÿä¸­éå¸¸é‡è¦. ç†è§£ spark å†…å­˜ç®¡ç†çš„åŸºæœ¬åŸç†ï¼Œæœ‰åŠ©äºæ›´å¥½çš„å¼€å‘ spark åº”ç”¨ç¨‹åº å’Œ è¿›è¡Œæ€§èƒ½è°ƒä¼˜. sparkçš„å†…å­˜æ¨¡å‹ sparkçš„shuffle sparkçš„èµ„æºè°ƒä¼˜ 3.1 sparkçš„å†…å­˜æ¨¡å‹ No. spark çš„äº§ç”ŸèƒŒæ™¯ï¼Œ spark ä¼˜äº mapreduce çš„äº”å¤§åŸå› ï¼š (1). å‡å°‘äº†ç£ç›˜ IO (2). æé«˜å¹¶è¡Œåº¦ (3). é¿å…é‡å¤è®¡ç®— (4). å¯é€‰çš„ shuffle å’Œæ’åº (5). æä¾›äº†ä¸€ä¸ªçµæ´»çš„ å†…å­˜ç®¡ç†ç­–ç•¥ good Sparkå­¦ä¹ ä¹‹è·¯ ï¼ˆåä¸€ï¼‰SparkCoreçš„è°ƒä¼˜ä¹‹Sparkå†…å­˜æ¨¡å‹ 3.2 application å†…å­˜ No. åˆ’åˆ† application åœ¨è¿è¡Œçš„æ—¶å€™ï¼Œä¼šåœ¨å“ªäº›åœ°æ–¹äº§ç”Ÿæ•°æ®ï¼Œéœ€è¦å­˜å‚¨åœ¨å†…å­˜ä¸­å‘¢ï¼Ÿ 1. åº”ç”¨ç¨‹åº 2. æ‰§è¡Œå†…å­˜ å…¨å±€å˜é‡ï¼Œé™æ€å˜é‡ 3. æ‰§è¡Œå†…å­˜ task åœ¨è®¡ç®—çš„æ—¶å€™, æ•°æ®åœ¨å†…å­˜ä¸­(128M) (æœ‰çš„ ptn_data &gt; 128 æœ‰çš„ &lt; 128) 4. æ‰§è¡Œå†…å­˜ mapPartitions (ptn_data =&gt; {}) &nbsp;&nbsp;&nbsp;&nbsp; for (element &lt;- partition) &nbsp;&nbsp;&nbsp;&nbsp; code æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œä½¿ç”¨çš„ä¸´æ—¶å®¹å™¨ï¼Œä¸´æ—¶å˜é‡ 5. æ‰§è¡Œå†…å­˜ stage0 å’Œ stage1 ä¹‹é—´æœ‰ shuffleï¼Œè¿™ä¸ªå°†è¦è¿›è¡Œ shuffle çš„æ•°æ®å­˜å‚¨åœ¨ä½•åœ°ï¼Ÿ .. æ•°æ®çš„åˆ†åŒºæ•° 6. å­˜å‚¨å†…å­˜ å†…å­˜å ç”¨çš„å¤§æˆ·ï¼š rdd.cache() å ç”¨æ—¶é—´ é•¿ + å¤š 7. å­˜å‚¨å†…å­˜ å¹¿æ’­å‡ºæ¥çš„å¤§å˜é‡ sc,broadcast(list) list ä¼šå­˜å‚¨åœ¨æ‰€æœ‰ executor å†…å­˜ä¸­ .. ä¸€ç§åˆé€‚çš„å†…å­˜ç®¡ç†ç­–ç•¥ï¼Œå¯ä»¥æå‡å†…å­˜åˆ©ç”¨ç‡ï¼Œæé«˜Taskæ‰§è¡Œçš„æˆåŠŸç‡ 3.3 Spark å†…å­˜æ¨¡å‹æ¦‚è¿°åœ¨æ‰§è¡Œ Spark çš„åº”ç”¨ç¨‹åºæ—¶ï¼ŒSpark é›†ç¾¤ä¼šå¯åŠ¨ Driver å’Œ Executor ä¸¤ç§ JVM è¿›ç¨‹ Driver ä¸»æ§è¿›ç¨‹ï¼Œè´Ÿè´£åˆ›å»º SparkContextï¼Œæäº¤ Spark Jobï¼Œå¹¶å°†ä½œä¸šè½¬åŒ–ä¸ºè®¡ç®—ä»»åŠ¡ï¼ˆTaskï¼‰ï¼Œåœ¨å„ä¸ª Executor è¿›ç¨‹é—´åè°ƒä»»åŠ¡çš„è°ƒåº¦ Executor è´Ÿè´£åœ¨å·¥ä½œèŠ‚ç‚¹ä¸Šæ‰§è¡Œå…·ä½“çš„ è®¡ç®— Taskï¼Œå¹¶å°†ç»“æœè¿”å›ç»™ Driverï¼ŒåŒæ—¶ä¸ºéœ€è¦æŒä¹…åŒ–çš„ RDD æä¾›å­˜å‚¨åŠŸèƒ½[1]ã€‚ ç”±äº Driver-memory 1G çš„å†…å­˜ç®¡ç†ç›¸å¯¹æ¥è¯´è¾ƒä¸ºç®€å•ï¼Œæœ¬æ–‡ä¸»è¦å¯¹ Executor çš„å†…å­˜ç®¡ç†è¿›è¡Œåˆ†æï¼Œä¸‹æ–‡ä¸­çš„ Spark å†…å­˜å‡ç‰¹æŒ‡ Executor çš„å†…å­˜ã€‚ Spark çš„åº”ç”¨ç¨‹åº2ç§è¿›ç¨‹ driverï¼š ä¸»æ§è¿›ç¨‹ï¼Œå¿…é¡»ä¿è¯ä¸èƒ½å‡ºé”™, è€Œä¸”ä¹Ÿåªæœ‰ä¸€ä¸ª executorï¼š task çš„æ‰§è¡Œè½½ä½“ï¼Œæ•°é‡ä¹Ÿå¾ˆå¤š ä¾§é‡ç‚¹ï¼š executor ä¸Šçš„å†…å­˜ç®¡ç† æ‰§è¡Œ task è¿‡ç¨‹ä¸­ä¼šäº§ç”Ÿå“ªäº›æ•°æ®å‘¢ï¼Ÿ 2 3 4 5 spark å¸®åŠ©æˆ‘ä»¬æŠŠåº”ç”¨ç¨‹åºæ‰§è¡Œæ„æˆå½“ä¸­æ‰€å ç”¨çš„å†…å­˜åˆ†æˆ 2 ä¸ªæ–¹é¢ï¼š æ‰§è¡Œå†…å­˜ 2 3 4 5 å¿…é¡»çš„ å­˜å‚¨å†…å­˜ 6 7 å¯æœ‰å¯æ—  3.4 Spark æŠŠå†…å­˜åšåˆ†ç±»çš„ç›®çš„å‡å¦‚ç»™æ¯ä¸€ä¸ª executor åˆ†é…çš„å†…å­˜æ˜¯ 8G: æ‰§è¡Œå†…å­˜ï¼š 1Gï¼Œ å­˜å‚¨å†…å­˜ 7G2G: æ‰§è¡Œå†…å­˜ï¼š 1Gï¼Œ å­˜å‚¨å†…å­˜ 1G å‡å¦‚ç»™æ¯ä¸€ä¸ª executor åˆ†é…çš„å†…å­˜æ˜¯ 8G (1). å½“è¿™ä¸ª executor å¯åŠ¨ä¸€ä¸ª task æ‰§è¡Œè®¡ç®—çš„æ—¶å€™ï¼Œå¤„ç†çš„æ•°æ®é‡æ˜¯ 2G (2). å½“è¿™ä¸ª executor å¯åŠ¨ä¸€ä¸ª task æ‰§è¡Œè®¡ç®—çš„æ—¶å€™ï¼Œå¤„ç†çš„æ•°æ®é‡æ˜¯ 6G ç»“è®ºï¼š åŒä¸€ä¸ªç¨‹åºåœ¨æ‰§è¡Œä¸åŒé‡çº§çš„æ•°æ®çš„è®¡ç®—çš„æ—¶å€™ï¼Œæ¯ä¸ª task æ‰§è¡Œçš„å†…å­˜æ‰€å ç”¨çš„èµ„æºå…¶å®å·®ä¸å¤šä¸€è‡´ æ•°æ®åˆ†åŒºçš„å­˜å‚¨ 3.5 Sparkå†…å­˜çš„æ•´ä½“åˆ’åˆ†åˆåˆ†ä¸º2ç§ä¸åŒç±»å‹çš„å†…å­˜åˆ’åˆ†ï¼š No. spark èƒ½åˆ©ç”¨çš„å†…å­˜æœ‰2ä¸ªåŒºåŸŸ 1. (executorå†…å­˜) JVM å†…éƒ¨ çš„ On-heap Memory ï¼ˆå¯¹äºJVMæ¥è¯´å«åš å †å†…å­˜ï¼‰ 2. (executorå¤–éƒ¨) JVM å¤–éƒ¨/æ“ä½œç³»ç»Ÿ çš„ Off-heap Memory è¿™2ä¸ªåŒºåŸŸï¼Œåˆéƒ½åˆ†ä¸º2ä¸ªåŒºåŸŸï¼š public class Test1 &#123; private List list; public synchronized void test1() &#123; // visit list &#125;&#125;Test t1 = new Test1();Test t2 = new Test1(); æ­£å¸¸çš„æƒ…å†µä¸‹ï¼Œä¸€ä¸ª JVM è¿›ç¨‹ä¸­çš„çº¿ç¨‹æ˜¯æ²¡æ³•ä»æ“ä½œç³»ç»Ÿä¸­ç”³è¯·å†…å­˜çš„åªèƒ½ä» JVM ä¸­ç”³è¯·å†…å­˜ä½†æ˜¯ç°åœ¨sparkçš„task(ä¸€ä¸ªçº¿ç¨‹)å°±å¯ä»¥ä»æ“ä½œç³»ç»Ÿï¼Œä¹Ÿå°±æ˜¯è¯´JVMä¹‹å¤–ï¼Œç”³è¯·å†…å­˜ä½¿ç”¨ï¼Œè€Œä¸”è¿˜æ˜¯æ‰€æœ‰çš„taskå…¬ç”¨çš„. æœ‰ä»€ä¹ˆå¥½å¤„ï¼Ÿ spark çš„ç¨‹åºä¸­ï¼Œä¸Šé¢ç¼“å­˜çš„RDDï¼Œåœ¨è¿™ä¸ªåº”ç”¨ç¨‹åºä¸­çš„ä»»ä½•åœ°æ–¹éƒ½å¯ä»¥è®¿é—® 4. spark çš„é™æ€å†…å­˜æ¨¡å‹å’Œç»Ÿä¸€å†…å­˜æ¨¡å‹è¯¦è§£ + èµ„æºè°ƒä¼˜ spark çš„2ç§å†…å­˜ç®¡ç†æ–¹å¼ï¼š 1). spark 1.x é™æ€å†…å­˜æ¨¡å‹ æ‰§è¡Œå†…å­˜å’Œå­˜å‚¨å†…å­˜ ç›¸äº’ä¹‹é—´ ä¸èƒ½ å ç”¨ 2). spark 2.x ç»Ÿä¸€å†…å­˜æ¨¡å‹ æ‰§è¡Œå†…å­˜å’Œå­˜å‚¨å†…å­˜ ç›¸äº’ä¹‹é—´ èƒ½ å ç”¨ å†…å­˜ç®¡ç†æ¥å£: MemoryManager StaticMemoryManager UnifiedMemoryManager æ–¹æ³•ï¼š é‡è¦çš„æ–¹æ³•æœ‰ 6 ä¸ªï¼š 3ä¸ªæ˜¯ç”³è¯·å†…å­˜çš„, 3ä¸ªæ˜¯é‡Šæ”¾å†…å­˜çš„ ä»¥ä¸Šè¿™3ä¸ªç”³è¯·å’Œ3ä¸ªé‡Šæ”¾å†…å­˜çš„æ–¹æ³•ï¼Œå…¶å®å°±æ˜¯å¯¹ç”³è¯·åˆ°çš„æ€»å†…å­˜è¿›è¡Œä¸€ç§é€»è¾‘ä¸Šçš„ç®¡ç†è§„åˆ’ å †å†…å†…å­˜ å’Œ å †å¤–å†…å­˜ æ˜¯çœŸæ˜¯å­˜åœ¨çš„ä¸€ä¸ªå†…å­˜åŒºåŸŸ æ‰§è¡Œå†…å­˜å’Œå­˜å‚¨å†…å­˜ï¼Œéƒ½æ˜¯å †å†…å’Œå †å¤–å†…å­˜çš„ä¸€ä¸ªé€»è¾‘åŒºåˆ’çš„æ¦‚å¿µ. good Apache Spark å†…å­˜ç®¡ç†è¯¦è§£ Memory Management 4.1 spark çš„é™æ€å†…å­˜æ¨¡å‹é™æ€å†…å­˜ç®¡ç†å›¾ç¤ºâ€”â€”å †å†… é™æ€å†…å­˜ç®¡ç†å›¾ç¤ºâ€”â€”å †å¤– 4.2 ç»Ÿä¸€å†…å­˜æ¨¡å‹ç»Ÿä¸€å†…å­˜ç®¡ç†å›¾ç¤ºâ€”â€”å †å†… Execution å ç”¨ Storage æ˜¯ä¸ä¼šå½’è¿˜çš„, åä¹‹ è¦å½’è¿˜ ç»Ÿä¸€å†…å­˜ç®¡ç†å›¾ç¤ºâ€”â€”å †å¤– application ä¸­çš„ job çš„æ‰§è¡Œï¼š FIFO æŠŠ YARN çš„èµ„æºåˆ†æ‹†æˆå¤šä¸ªä¸åŒçš„é˜Ÿåˆ— æ¯ä¸ªé˜Ÿåˆ—ä¸­çš„ä»»åŠ¡çš„æ‰§è¡Œæ˜¯é¡ºåºçš„ FIFO æ‰§è¡Œ æ•´ä¸ªç¨‹åºåˆ°åº•æœ‰å¤šå°‘ä¸ª taskï¼Ÿ num-executors å¦‚æœç°åœ¨ä¸€ä¸ª executor çš„ task æ•°é‡ ä¸€ä¸ª executor åˆ†é… 3~5ä¸ª cpu cores. 5. èµ„æºè°ƒä¼˜ 2 èµ„æºè°ƒä¼˜ params description å‚æ•°è°ƒä¼˜å»ºè®® &nbsp;(1) num-executors ä¸€ä¸ª executor å°±æ˜¯ä¸€ä¸ªè¿›ç¨‹, 50~100ä¸ªå·¦å³çš„Executorè¿›ç¨‹æ¯”è¾ƒåˆé€‚ &nbsp;(2) executor-memory æ¯ä¸ªExecutorè¿›ç¨‹çš„å†…å­˜è®¾ç½®4G~8Gè¾ƒä¸ºåˆé€‚ &nbsp;(3) total-executor-cores Executorçš„CPU coreæ•°é‡è®¾ç½®ä¸º2~4ä¸ªè¾ƒä¸ºåˆé€‚æ¯ä¸ªè¿›ç¨‹å¯ä»¥ä½¿ç”¨å¤šå°‘ä¸ª cpu coreï¼Œä¸€ä¸ªexecutor å¯åŠ¨ 10 ä¸ªtask &nbsp;driver-memory Driverçš„å†…å­˜é€šå¸¸æ¥è¯´ä¸è®¾ç½®ï¼Œæˆ–è€…è®¾ç½®1Gå·¦å³åº”è¯¥å°±å¤Ÿäº† &nbsp;spark.default.parallelism è¯¥å‚æ•°ç”¨äºè®¾ç½®æ¯ä¸ªstageçš„é»˜è®¤taskæ•°é‡ã€‚è¿™ä¸ªå‚æ•°æä¸ºé‡è¦ Sparkä½œä¸šçš„é»˜è®¤taskæ•°é‡ä¸º500~1000ä¸ªè¾ƒä¸ºåˆé€‚ã€‚å¾ˆå¤šåŒå­¦å¸¸çŠ¯çš„ä¸€ä¸ªé”™è¯¯å°±æ˜¯ä¸å»è®¾ç½®è¿™ä¸ªå‚æ•°ï¼Œé‚£ä¹ˆæ­¤æ—¶å°±ä¼šå¯¼è‡´Sparkè‡ªå·±æ ¹æ®åº•å±‚HDFSçš„blockæ•°é‡æ¥è®¾ç½®taskçš„æ•°é‡ï¼Œé»˜è®¤æ˜¯ä¸€ä¸ªHDFS blockå¯¹åº”ä¸€ä¸ªtaskã€‚ è®¾ç½®è¯¥å‚æ•°ä¸ºnum-executors * executor-coresçš„2~3å€è¾ƒä¸ºåˆé€‚ &nbsp;(4) spark.shuffle.memoryFraction &nbsp;(5) spark.storage.memoryFraction â€¦ â€¦ spark-submit â€¦ å¦‚æœ master æ˜¯ local: é»˜è®¤çš„åˆ†åŒºæ•°æ˜¯ 1ä¸ªï¼Œè€Œä¸”æ²¡æœ‰ executoreå¦‚æœ master æ˜¯ spark: é»˜è®¤çš„åˆ†åŒºæ•°æ˜¯ 2ä¸ª min(defaultMinPartitions,2)ï¼Œæœ‰ executore ä¸€ä¸ª spark åº”ç”¨ç¨‹åºï¼š 500ä¸ªtask50ä¸ªexecutoræ¯ä¸€ä¸ª executor æ‰§è¡Œ 10 ä¸ª task å·¦å³æ¯ä¸€ä¸ª executor åˆ†é… 3~5ä¸ªæ€» cpu core æ•°ï¼š 150 ~ 250æ¯ä¸€ä¸ª executor åˆ†é…çš„å†…å­˜æ˜¯ï¼š 2Gdriverç¨‹åºåˆ†é…çš„å†…å­˜ï¼š 2G æ•´ä¸ªåº”ç”¨æ€»æ¶ˆè€—ï¼š50*2 + 2 = 102 å†…å­˜ æ¯ 1 ä¸ª stage ä¸­çš„åˆ°åº•æœ‰å¤šå°‘ä¸ª task ç”±è°å†³å®šï¼Ÿ åˆ’åˆ† stage çš„æ ‡å‡†ï¼š shuffle ç®—å­ï¼Œå®½ä¾èµ– åœ¨ä¸€ä¸ªstageä¸­æ˜¯æœ‰å¯èƒ½æœ‰ å¤šä¸ªRDD çš„ æ¯ä¸€ä¸ª stage ä¸­çš„ task æ€»æ•°, æ˜¯ç”±è¿™ä¸ª stage ä¸­çš„æœ€åä¸€ä¸ª RDD çš„åˆ†åŒºæ•°æ¥å†³å®šçš„. spark ä» hdfs ä¸­è¯»å–æ•°æ®ï¼Œä½¿ç”¨çš„æ–¹å¼ï¼Œé»˜è®¤æƒ…å†µä¸‹ä¾ç„¶æ˜¯ TextInputFormat é»˜è®¤æƒ…å†µä¸‹ mapreduce ä¸­æ•°æ®è¯»å–è§„åˆ™æ˜¯ç”± TextInputFormat å’Œ LineRecordReader å†³å®šé»˜è®¤æƒ…å†µä¸‹ï¼Œå…¶å®å°±æ˜¯ 1ä¸ªblock 1ä¸ªtask æ¯ä¸ªå…ƒç´ çš„è¯»å–æ–¹å¼ä¾ç„¶æ˜¯é€è¡Œè¯»å–å½¢æˆä¸ºä¸€ä¸ªå…ƒç´  mapper: key, valuerdd: value RDD[String] spark.storage.memoryFraction spark.shuffle.memoryFraction èµ„æºå‚æ•°å‚è€ƒç¤ºä¾‹./bin/spark-submit \\ --master yarn --deploy-mode cluster --num-executors 100 \\ --executor-memory 6G \\ --executor-cores 4 \\ --driver-memory 1G \\ --conf spark.default.parallelism=1000 \\ Taskæ€»æ•° --conf spark.storage.memoryFraction=0.5 \\ å­˜å‚¨å†…å­˜ --conf spark.shuffle.memoryFraction=0.3 \\ æ‰§è¡Œå†…å­˜ ä¸€èˆ¬æœºå™¨ï¼š 32/64cpu, 64G/128G/256G 60cpu core, 240G å†…å­˜ã€‚ å¦å¤–16Gå†…å­˜ç»™ç³»ç»Ÿè¿è¡Œç”¨. æ¯ä¸€ä¸ª cpu core 4G å†…å­˜ æ¯ä¸€ä¸ª executor è¦åˆ†é…2~3ä¸ªcpu coreï¼Œ åˆ†é…å†…å­˜ï¼š 8~12G æ¯ä¸€ä¸ªapplicationå¤§æ¦‚æ˜¯ï¼š 100ä¸ªexecutor 6. mapreduceçš„shuffleå¤ä¹ key, value kvbuffer: ptn, key, value ptn+key Reference ä»ä¸€ä¸ªsqlä»»åŠ¡ç†è§£sparkå†…å­˜æ¨¡å‹ Apache Spark å†…å­˜ç®¡ç†è¯¦è§£ Sparkå­¦ä¹ ä¹‹è·¯ ï¼ˆåä¸€ï¼‰SparkCoreçš„è°ƒä¼˜ä¹‹Sparkå†…å­˜æ¨¡å‹ äº‘è¯¾å ‚ SparkSQL çš„æ•°æ®æºæ“ä½œ å¤§æ•°æ®èµ„æ–™ç¬”è®°æ•´ç† Sparkæ€§èƒ½ä¼˜åŒ–æŒ‡å—â€”â€”é«˜çº§ç¯‡ Sparkæ€§èƒ½ä¼˜åŒ–æŒ‡å—â€”â€”åŸºç¡€ç¯‡","categories":[{"name":"spark","slug":"spark","permalink":"http://iequa.com/categories/spark/"}],"tags":[{"name":"spark","slug":"spark","permalink":"http://iequa.com/tags/spark/"}]},{"title":"DataWare Review Summary 1","slug":"dataware/dwh-summary-1-warehouse-theory","date":"2020-10-01T01:07:21.000Z","updated":"2021-06-14T05:21:59.936Z","comments":true,"path":"2020/10/01/dataware/dwh-summary-1-warehouse-theory/","link":"","permalink":"http://iequa.com/2020/10/01/dataware/dwh-summary-1-warehouse-theory/","excerpt":"","text":"æ¼«è°ˆç³»åˆ—ï¼š No. | Question | Flag :---: | --- | :---: 1. | good - [æ¼«è°ˆå¤§ç‰›å¸¦ä½ ä»0åˆ°1æ„å»ºæ•°æ®ä»“åº“å®æˆ˜](https://mp.weixin.qq.com/s/iwC0iKXBFFBVwxCQPhBAxg) | 2. | good - [æ•°æ®æ¨¡å‹è®¾è®¡ï¼ˆæ¨èæ”¶è—ï¼‰](https://mp.weixin.qq.com/s/_WHI-1gjW0iaQeKW0TfMDA) | 3. | [æ•°æ®ä»“åº“ï¼ˆäºŒï¼‰](https://www.jianshu.com/p/a145e15dedfc), [æ•°æ®ä»“åº“ï¼ˆä¸€ï¼‰](https://www.jianshu.com/p/9750703dba28) | 4. | [Hadoopçš„å…ƒæ•°æ®æ²»ç†--Apache Atlas](https://www.jiqizhixin.com/articles/2019-09-16-12) 5. | [1. æ¼«ç”»ï¼šä»€ä¹ˆæ˜¯æ•°æ®ä»“åº“ï¼Ÿ](https://mp.weixin.qq.com/s/XIJoE3nV7QQwGE0WLIhiRw) 6. | [2. ä¼ ç»Ÿæ•°ä»“å’Œå¤§æ•°æ®æ•°ä»“çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ âœ”ï¸](https://mp.weixin.qq.com/s/Uo7UzUhCJdzXeLL8nRLefw) 7. | [4. æ•°ä»“é‚£ç‚¹äº‹ï¼šä»å…¥é—¨åˆ°ä½›ç³»](https://mp.weixin.qq.com/s/kbSZkggtdaEVnN6wjjv4ag) 8. | [5. ä»8ä¸ªè§’åº¦5åˆ†é’Ÿæå®šæ•°æ®ä»“åº“](https://mp.weixin.qq.com/s/3pABsYDHLxS5u1NQV4PGBA) 9. | [6. æ»´æ»´æ•°æ®ä»“åº“æŒ‡æ ‡ä½“ç³»å»ºè®¾å®è·µ](https://mp.weixin.qq.com/s/-pLpLD_HMiasyyRxo5oTRQ) 11. | [9. æ‰‹æŠŠæ‰‹æ•™ä½ å¦‚ä½•æ­å»ºä¸€ä¸ªæ•°æ®ä»“åº“](https://mp.weixin.qq.com/s/PwnQl6uji85m7BGALmOVrw) 12. | [10. åŸºäºsparkå¿«é€Ÿæ„å»ºæ•°ä»“é¡¹ç›®ï¼ˆæ–‡æœ«Q&Aï¼‰](https://mp.weixin.qq.com/s/oidx8qDndDKr3MN5x5Xl-Q) 13. | [11. æ•°æ®æ¹–VSæ•°æ®ä»“åº“ä¹‹äº‰ï¼Ÿé˜¿é‡Œæå‡ºå¤§æ•°æ®æ¶æ„æ–°æ¦‚å¿µï¼šæ¹–ä»“ä¸€ä½“ï¼](https://mp.weixin.qq.com/s/V_EWJi5-rtiNNwmnGOdZYw) 14. | [12. æ•°æ®ä»“åº“ï¼ˆç¦»çº¿+å®æ—¶ï¼‰å¤§å‚ä¼˜ç§€æ¡ˆä¾‹æ±‡æ€»ï¼ˆå»ºè®®æ”¶è—ï¼‰](https://mp.weixin.qq.com/s?__biz=Mzg3NjIyNjQwMg==&mid=2247485223&idx=2&sn=149000071adf5fbdf819fdf6afb1ce7f&chksm=cf34352af843bc3c3f56071447c57f120a3ca7601d4d67c17bb422695d6a4637eec42fad2819&scene=21#wechat_redirect) 15. | [Good - Hive æ‹‰é“¾è¡¨å®è·µ](https://mp.weixin.qq.com/s?__biz=Mzg3NjIyNjQwMg==&mid=2247485525&idx=2&sn=595eab33c9b16f5a20cded2bf3c4f8ed&chksm=cf343a58f843b34e20e2fcd4cbb21f8a27451a3b235050b1c91aec1ac756dc4ad4d74216b879&scene=21#wechat_redirect) ä»™å­ç´«éœ æ•°æ®ä»“åº“ä¸Pythonå¤§æ•°æ® 1/1 å®ï¼è‡´2020çš„ä¸€å°æƒ…ä¹¦ï¼Œè¯·æŸ¥æ”¶ï¼æ–‡æœ«2019å¹´æ–‡ç« ç²¾é€‰ 1. æ¼«è°ˆç³»åˆ— | æ•°ä»“ç¬¬ä¸€ç¯‡NO.1 ã€åŸºç¡€æ¶æ„ã€2. æ¼«è°ˆç³»åˆ— | æ•°ä»“ç¬¬äºŒç¯‡NO.2 ã€æ•°æ®æ¨¡å‹ã€3. æ¼«è°ˆç³»åˆ— | æ•°ä»“ç¬¬ä¸‰ç¯‡NO.3 ã€æ•°æ®ETLã€4. æ¼«è°ˆç³»åˆ— | æ•°ä»“ç¬¬å››ç¯‡NO.4 ã€æ•°æ®åº”ç”¨ã€5. æ¼«è°ˆç³»åˆ— | æ•°ä»“ç¬¬äº”ç¯‡NO.5 ã€è°ƒåº¦ç³»ç»Ÿã€6. æ¼«è°ˆç³»åˆ— | æ•°ä»“ç¬¬å…­ç¯‡NO.6 ã€æ•°æ®æ²»ç†ã€7. æ¼«è°ˆç³»åˆ— | æ¼«è°ˆæ•°ä»“ç¬¬ä¸€ç¯‡NO.7 ã€é¢è¯•çœŸç»ã€ å…ƒæ•°æ®ç®¡ç†è§£æä»¥åŠæ•°æ®ä»“åº“å’Œä¸»æ•°æ®ä»‹ç» 1. DWH, Concept OLTP (on-line transaction processing) OLAPï¼ˆOn-Line Analytical Processingï¼‰ æ•°æ®åœ¨ç³»ç»Ÿä¸­äº§ç”Ÿ æœ¬èº«ä¸äº§ç”Ÿæ•°æ®ï¼ŒåŸºç¡€æ•°æ®æ¥æºäºäº§ç”Ÿç³»ç»Ÿ åŸºäºäº¤æ˜“çš„å¤„ç†ç³»ç»Ÿ åŸºäºæŸ¥è¯¢çš„åˆ†æç³»ç»Ÿ ç‰µæ‰¯çš„æ•°æ®é‡å¾ˆå° ç‰µæ‰¯çš„æ•°æ®é‡åºå¤§ (å¤æ‚æŸ¥è¯¢ç»å¸¸ä½¿ç”¨å…¨è¡¨æ‰«æç­‰) å¯¹å“åº”æ—¶é—´è¦æ±‚éå¸¸é«˜ å“åº”æ—¶é—´ä¸å…·ä½“æŸ¥è¯¢æœ‰å¾ˆå¤§å…³ç³» ç”¨æˆ·æ•°é‡å¤§ï¼Œä¸ºæ“ä½œç”¨æˆ· ç”¨æˆ·æ•°é‡å°‘ï¼Œä¸»è¦æœ‰æŠ€æœ¯äººå‘˜ä¸ä¸šåŠ¡äººå‘˜ å„ç§æ“ä½œä¸»è¦åŸºäºç´¢å¼•è¿›è¡Œ ä¸šåŠ¡é—®é¢˜ä¸å›ºå®šï¼Œæ•°æ®åº“çš„å„ç§æ“ä½œä¸èƒ½å®Œå…¨åŸºäºç´¢å¼•è¿›è¡Œ DW 4 å¤§ç‰¹å¾: Subject Orientedã€Integrateã€Non-Volatilã€Time Variant . æ•°ä»“åˆ†å±‚ STG Stage ï¼ˆä¸åšä»»ä½•åŠ å·¥, ç¦æ­¢é‡å¤è¿›å…¥ï¼‰ ODSï¼ˆOperational Data Storeï¼‰ä¸åšå¤„ç†ï¼Œå­˜æ”¾åŸå§‹æ•°æ® (è¯¥å±‚åœ¨stageä¸Šä»…æ•°æ®æ ¼å¼åˆ°æ ‡å‡†æ ¼å¼è½¬æ¢) DWDï¼ˆData Warehouse Summary æ˜ç»†æ•°æ®å±‚ï¼‰è¿›è¡Œç®€å•æ•°æ®æ¸…æ´—ï¼Œé™ç»´ DWSï¼ˆData Warehouse Summary æœåŠ¡æ•°æ®å±‚ï¼‰è¿›è¡Œè½»åº¦æ±‡æ€»ï¼ˆåšå®½è¡¨ï¼‰ ADSï¼ˆApplication Data Summary æ•°æ®åº”ç”¨å±‚ï¼‰ä¸ºæŠ¥è¡¨æä¾›æ•°æ® 1.1 DWH basicdata warehouse é€»è¾‘åˆ†å±‚æ¶æ„ï¼š 1.2 data modeling Title_Kimball æ·±å…¥æµ…å‡ºæ•°æ®æ¨¡å‹ï¼ˆæ¨èæ”¶è—ï¼‰ æµç¨‹ æ¶æ„æ˜¯è‡ªä¸‹å‘ä¸Šï¼Œå³ä»æ•°æ®é›†å¸‚(ä¸»é¢˜åˆ’åˆ†)â€”&gt;æ•°æ®ä»“åº“â€”&gt; æ•°æ®æŠ½å–ï¼Œæ˜¯ä»¥éœ€æ±‚ä¸ºå¯¼å‘çš„ï¼Œä¸€èˆ¬ä½¿ç”¨æ˜Ÿå‹æ¨¡å‹ äº‹å®è¡¨å’Œç»´è¡¨ æ¶æ„å¼ºè°ƒæ¨¡å‹ç”±äº‹å®è¡¨å’Œç»´è¡¨ç»„æˆï¼Œæ³¨é‡äº‹å®è¡¨ä¸ç»´è¡¨çš„è®¾è®¡ æ•°æ®é›†å¸‚ æ•°æ®ä»“åº“æ¶æ„ä¸­ï¼Œæ•°æ®é›†å¸‚æ˜¯ä¸€ä¸ªé€»è¾‘æ¦‚å¿µï¼Œåªæ˜¯å¤šç»´æ•°æ®ä»“åº“ä¸­çš„ä¸»é¢˜åŸŸåˆ’åˆ†ï¼Œå¹¶æ²¡æœ‰è‡ªå·±çš„ç‰©ç†å­˜å‚¨ï¼Œä¹Ÿå¯ä»¥è¯´æ˜¯è™šæ‹Ÿçš„æ•°æ®é›†å¸‚ã€‚æ˜¯æ•°æ®ä»“åº“çš„ä¸€ä¸ªè®¿é—®å±‚ï¼Œæ˜¯æŒ‰ä¸»é¢˜åŸŸç»„ç»‡çš„æ•°æ®é›†åˆï¼Œç”¨äºæ”¯æŒéƒ¨é—¨çº§çš„å†³ç­–ã€‚ data modeling çš„å‡ ç§æ–¹å¼: No. æ•°æ®å»ºæ¨¡æ–¹å¼ type 1. ERæ¨¡å‹ ä¸‰èŒƒå¼ 2. ç»´åº¦å»ºæ¨¡ 1. æ˜Ÿå‹æ¨¡å‹ 2. é›ªèŠ±æ¨¡å‹ 3. æ˜Ÿåº§æ¨¡å‹ 1. äº‹å®è¡¨ äº‹å®è¡¨ç”Ÿäºä¸šåŠ¡è¿‡ç¨‹ï¼Œå­˜å‚¨ä¸šåŠ¡æ´»åŠ¨æˆ–äº‹ä»¶æç‚¼å‡ºæ¥çš„æ€§èƒ½åº¦é‡ã€‚ä»æœ€ä½çš„ç²’åº¦çº§åˆ«æ¥çœ‹ï¼Œäº‹å®è¡¨è¡Œå¯¹åº”ä¸€ä¸ªåº¦é‡äº‹ä»¶ ï¼ˆ1ï¼‰äº‹åŠ¡äº‹å®è¡¨ ï¼ˆ2ï¼‰å‘¨æœŸå¿«ç…§äº‹å®è¡¨ ï¼ˆ3ï¼‰ç´¯ç§¯å¿«ç…§äº‹å®è¡¨ 2. ç»´åº¦è¡¨ ï¼ˆ1ï¼‰é€€åŒ–ç»´åº¦ï¼ˆDegenerateDimensionï¼‰ ï¼ˆ2ï¼‰ç¼“æ…¢å˜åŒ–ç»´ï¼ˆSlowly Changing Dimensionsï¼‰ ç»´åº¦çš„å±æ€§å¹¶ä¸æ˜¯å§‹ç»ˆä¸å˜çš„ï¼Œè¿™ç§éšæ—¶é—´å‘ç”Ÿå˜åŒ–çš„ç»´åº¦æˆ‘ä»¬ä¸€èˆ¬ç§°ä¹‹ä¸ºç¼“æ…¢å˜åŒ–ç»´ï¼ˆSCDï¼‰ 1.3 data ETLSQLåˆ†æå‡½æ•°ï¼Œçœ‹è¿™ä¸€ç¯‡å°±å¤Ÿäº† No. Title desc 1. æ•°ä»“å»ºæ¨¡å·¥å…·å“ªä¸€ä¸ªå¥½? powerDesigner å‹‰å¼ºæ¨ä¸€ä¸ªå§ 2. DWS è½»åº¦èšåˆåŠï¼ˆæ±‡æ€» == group byï¼‰ æ˜¯æŒ‰ç…§ Topic åˆ’åˆ†çš„ 3. DWD join æˆå®½è¡¨ by ODS äº‹å®è¡¨åŸºæœ¬éƒ½åœ¨ DWD å±‚. 4. App å±‚ä¹Ÿæ˜¯åœ¨ Hive ä¸­ä¹ˆ? å°½é‡ä¸è¦ 5. æ•°æ®ä»“åº“çš„æ•°æ®è´¨é‡å¦‚ä½•ä¿éšœ? éœ€è¦ä»æºå¤´ç®¡æ§ï¼Œä¸šåŠ¡ç³»ç»Ÿè¿›è¡Œç»†è‡´çš„å­—æ®µçš„æ ¡éªŒ 6. å¦‚ä½•ä¿è¯ä½ çš„è®¡ç®—çš„æŒ‡æ ‡ç»“æœå‡†ç¡®æ€§ï¼Ÿ 1. æœ‰æµ‹è¯•äººå‘˜ 2. æˆ‘ä»¬å…¬å¸æœ‰åšå°æ ·æœ¬æ•°æ®é›†çš„æŠ½å–å¼€å‘ 7. æ•°æ®å­˜å‚¨æ ¼å¼ orc / Parquet 8. æ•°æ®å‹ç¼©æ–¹å¼ snappy / LZO 9. æ•°æ®å­˜å‚¨æ ¼å¼ + å‹ç¼© æœåŠ¡å™¨çš„ç£ç›˜ç©ºé—´å¯ä»¥å˜ä¸ºåŸæ¥çš„ 1/3 10. beeline å®¢æˆ·ç«¯æ”¯æŒè¿œç¨‹è¿æ¥ 11. lzo æ”¯æŒåˆ‡åˆ†ä¹ˆï¼Ÿ snappy ä¸æ”¯æŒåˆ‡åˆ†, ç»™lzoæ–‡ä»¶å»ºç«‹ç´¢å¼•åï¼Œåˆ™æ”¯æŒåˆ‡åˆ† create_time, update_time, ä½¿ç”¨æ‹‰é“¾è¡¨è§£å†³å†å²æ•°æ®å˜æ›´çš„é—®é¢˜ # è®¾ç½®è¾“å‡ºæ•°æ®æ ¼å¼å‹ç¼©æˆä¸ºLZOSET hive.exec.compress.output=true;SET mapreduce.output.fileoutputformat.compress=true;set mapred.output.compression.codec=com.hadoop.compression.lzo.LzopCodec;#æ’å…¥æ•°æ®åˆ°ç›®æ ‡è¡¨é‡Œé¢å»insert overwrite table ods_user_login partition(part_date)select plat_id,server_id,channel_id,user_id,role_id,role_name,client_ip,event_time,op_type,online_time,operating_system,operating_version,device_brand,device_type,from_unixtime(event_time,&#x27;yyyy-MM-dd&#x27;) as part_date from tmp_ods_user_login;#ç»™lzoæ–‡ä»¶å»ºç«‹ç´¢å¼•ï¼šä¾¿äºä»¥åå¤šä¸ªmapTaskæ¥å¯¹æ–‡ä»¶è¿›è¡Œå¤„ç†hadoop jar /kkb/install/hadoop-2.6.0-cdh5.14.2/share/hadoop/common/hadoop-lzo-0.4.20.jar com.hadoop.compression.lzo.DistributedLzoIndexer /user/hive/warehouse/game_center.db/ods_user_login/ 1.4 Tool-App No. Tool 1. Apache_Druid &nbsp;&nbsp; Druidæ˜¯ä¸€ä¸ªç”¨äºå¤§æ•°æ®å®æ—¶æŸ¥è¯¢å’Œåˆ†æçš„é«˜å®¹é”™ã€é«˜æ€§èƒ½å¼€æºåˆ†å¸ƒå¼ç³»ç»Ÿï¼Œç”¨äºè§£å†³å¦‚ä½•åœ¨å¤§è§„æ¨¡æ•°æ®é›†ä¸‹è¿›è¡Œå¿«é€Ÿçš„ã€äº¤äº’å¼çš„æŸ¥è¯¢å’Œåˆ†æã€‚ 2. Apache Kylinâ„¢ &nbsp;&nbsp; ä¸€ä¸ªå¼€æºçš„åˆ†å¸ƒå¼åˆ†æå¼•æ“ï¼Œæä¾›Hadoop/Sparkä¹‹ä¸Šçš„SQLæŸ¥è¯¢æ¥å£åŠå¤šç»´åˆ†æï¼ˆOLAPï¼‰èƒ½åŠ›ä»¥æ”¯æŒè¶…å¤§è§„æ¨¡æ•°æ®ï¼Œæœ€åˆç”±eBay Inc. å¼€å‘å¹¶è´¡çŒ®è‡³å¼€æºç¤¾åŒºã€‚å®ƒèƒ½åœ¨äºšç§’å†…æŸ¥è¯¢å·¨å¤§çš„Hiveè¡¨ã€‚ 3. Clickhouseæ˜¯ä¸€ä¸ªç”¨äºåœ¨çº¿åˆ†æå¤„ç†ï¼ˆOLAPï¼‰çš„åˆ—å¼æ•°æ®åº“ç®¡ç†ç³»ç»Ÿï¼ˆDBMSï¼‰ 4. ADBï¼ˆAnalyticDB_for_MySQLï¼‰ &nbsp;&nbsp; åˆ†æå‹æ•°æ®åº“MySQLç‰ˆï¼ˆAnalyticDB for MySQLï¼‰ï¼Œæ˜¯é˜¿é‡Œå·´å·´è‡ªä¸»ç ”å‘çš„æµ·é‡æ•°æ®å®æ—¶é«˜å¹¶å‘åœ¨çº¿åˆ†æï¼ˆRealtime OLAPï¼‰äº‘è®¡ç®—æœåŠ¡ï¼Œä½¿å¾—æ‚¨å¯ä»¥åœ¨æ¯«ç§’çº§é’ˆå¯¹åƒäº¿çº§æ•°æ®è¿›è¡Œå³æ—¶çš„å¤šç»´åˆ†æé€è§†å’Œä¸šåŠ¡æ¢ç´¢ã€‚ 5. èŠ±æœªå…¨å¼€*æœˆæœªåœ† 1.1 presto æ˜¯Facebookå¼€æºçš„ï¼Œå®Œå…¨åŸºäºå†…å­˜çš„å¹¶â¾è®¡ç®—(MPP)ï¼Œåˆ†å¸ƒå¼SQLäº¤äº’å¼æŸ¥è¯¢å¼•æ“1.2 æ•°æ®æ²»ç†: åœ¨ETLè¿‡ç¨‹ä¸­å¼€å‘äººå‘˜ä¼šå¯¹æ•°æ®æ¸…æ´—è¿™å…¶å®å°±æ˜¯æ²»ç†çš„ä¸€éƒ¨åˆ†1.3 å…ƒæ•°æ®æ˜¯è®°å½•æ•°ä»“ä¸­æ¨¡å‹çš„å®šä¹‰ã€å„å±‚çº§çš„æ˜ å°„å…³ç³»ã€ç›‘æ§æ•°ä»“çš„æ•°æ®çŠ¶æ€åŠ ETL çš„ä»»åŠ¡è¿è¡ŒçŠ¶æ€ 1.4 DW-DMå±‚æ˜¯é‡‡ç”¨Kimballçš„æ€»çº¿å¼çš„æ•°æ®ä»“åº“æ¶æ„ï¼Œé’ˆå¯¹éƒ¨é—¨ï¼ˆæ¯”å¦‚è´¢åŠ¡éƒ¨é—¨ï¼‰æˆ–è€…æŸä¸€ä¸»é¢˜ï¼ˆæ¯”å¦‚å•†æˆ·ã€ç”¨æˆ·ï¼‰ï¼Œé€šè¿‡ç»´åº¦å»ºæ¨¡ï¼ˆæ¨èæ˜Ÿå‹æ¨¡å‹ï¼‰ï¼Œæ„å»ºä¸€è‡´æ€§ç»´åº¦ï¼ŒåŸå­ç²’åº¦çš„æ•°æ®æ˜¯DWå±‚ï¼ŒæŒ‰ç…§å®ä½“æˆ–è€…ä¸»é¢˜ç»è¿‡ä¸€å®šçš„æ±‡æ€»ï¼Œå»ºè®¾æ•°æ®é›†å¸‚æ¨¡å‹ã€‚æ•°æ®é›†å¸‚å¯ä»¥ä¸ºOLAPæä¾›æœåŠ¡ã€‚ Ad-hoc æŸ¥è¯¢æˆ–æŠ¥å‘Šï¼ˆå³å¸­æŸ¥è¯¢æˆ–æŠ¥å‘Šï¼‰æ˜¯ å•†ä¸šæ™ºèƒ½çš„ä¸€ä¸ªæ¬¡è¦çš„è¯é¢˜ï¼Œå®ƒè¿˜ç»å¸¸ä¸OLAPã€æ•°æ®ä»“åº“ç›¸å¹¶è®º. 2. SQL å»–é›ªå³°:å…³ç³»æ•°æ®åº“æ¦‚è¿° (1). ä¸»é”® / FOREIGN KEY èº«ä»½è¯å·ã€æ‰‹æœº è¿™äº›çœ‹ä¸Šå»å¯ä»¥å”¯ä¸€çš„å­—æ®µï¼Œå‡ä¸å¯ç”¨ä½œä¸»é”®ã€‚ä½œä¸ºä¸»é”®æœ€å¥½æ˜¯å®Œå…¨ä¸šåŠ¡æ— å…³çš„å­—æ®µï¼Œæˆ‘ä»¬ä¸€èˆ¬æŠŠè¿™ä¸ªå­—æ®µå‘½åä¸ºidã€‚è‡ªå¢æ•´æ•°ç±»å‹æ²¡æœ‰å¿…è¦çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å°½é‡ä¸ä½¿ç”¨è”åˆä¸»é”®ï¼Œå› ä¸ºå®ƒç»™å…³ç³»è¡¨å¸¦æ¥äº†å¤æ‚åº¦çš„ä¸Šå‡ã€‚ç”±äºå¤–é”®çº¦æŸä¼šé™ä½æ•°æ®åº“çš„æ€§èƒ½ï¼Œå¤§éƒ¨åˆ†äº’è”ç½‘åº”ç”¨ç¨‹åºä¸ºäº†è¿½æ±‚é€Ÿåº¦ï¼Œå¹¶ä¸è®¾ç½®å¤–é”®çº¦æŸï¼Œè€Œæ˜¯ä»…é åº”ç”¨ç¨‹åºè‡ªèº«æ¥ä¿è¯é€»è¾‘çš„æ­£ç¡®æ€§ã€‚ (2). INDEX å¯ä»¥å¯¹ä¸€å¼ è¡¨åˆ›å»ºå¤šä¸ªç´¢å¼•ã€‚ç´¢å¼•çš„ä¼˜ç‚¹æ˜¯æé«˜äº†æŸ¥è¯¢æ•ˆç‡ç¼ºç‚¹æ˜¯åœ¨æ’å…¥ã€æ›´æ–°å’Œåˆ é™¤è®°å½•æ—¶ï¼Œéœ€è¦åŒæ—¶ä¿®æ”¹ç´¢å¼•ï¼Œå› æ­¤ï¼Œç´¢å¼•è¶Šå¤šï¼Œæ’å…¥ã€æ›´æ–°å’Œåˆ é™¤è®°å½•çš„é€Ÿåº¦å°±è¶Šæ…¢ã€‚å¯¹äºä¸»é”®ï¼Œå…³ç³»æ•°æ®åº“ä¼šè‡ªåŠ¨å¯¹å…¶åˆ›å»ºä¸»é”®ç´¢å¼•ã€‚ä½¿ç”¨ä¸»é”®ç´¢å¼•çš„æ•ˆç‡æ˜¯æœ€é«˜çš„ï¼Œå› ä¸ºä¸»é”®ä¼šä¿è¯ç»å¯¹å”¯ä¸€ã€‚ (3). SQLæŸ¥è¯¢ 3.1 åŸºç¡€æŸ¥è¯¢SELECT * FROM students WHERE score &gt;= 80;SELECT id, name, gender, score FROM students ORDER BY score;SELECT id, name, gender, score FROM students ORDER BY score DESC LIMIT 3 OFFSET 6; ç¬¬3é¡µSELECT COUNT(*) boys FROM students WHERE gender = &#x27;M&#x27;;3.2 åˆ†ç»„æŸ¥è¯¢:SELECT COUNT(*) num FROM students GROUP BY class_id;SELECT class_id, gender, COUNT(*) num FROM students GROUP BY class_id, gender;3.3 å¤šè¡¨æŸ¥è¯¢:SELECT s.id sid, s.name, s.gender, s.score, c.id cid, c.name cnameFROM students s, classes cWHERE s.gender = &#x27;M&#x27; AND c.id = 1;ä½¿ç”¨å¤šè¡¨æŸ¥è¯¢å¯ä»¥è·å–M x Nè¡Œè®°å½•ï¼›å¤šè¡¨æŸ¥è¯¢çš„ç»“æœé›†å¯èƒ½éå¸¸å·¨å¤§ï¼Œè¦å°å¿ƒä½¿ç”¨ã€‚3.4 è¿æ¥æŸ¥è¯¢:JOINæŸ¥è¯¢éœ€è¦å…ˆç¡®å®šä¸»è¡¨ï¼Œç„¶åæŠŠå¦ä¸€ä¸ªè¡¨çš„æ•°æ®â€œé™„åŠ â€åˆ°ç»“æœé›†ä¸Šï¼›INNER JOINæ˜¯æœ€å¸¸ç”¨çš„ä¸€ç§JOINæŸ¥è¯¢ï¼Œå®ƒçš„è¯­æ³•æ˜¯SELECT ... FROM &lt;è¡¨1&gt; INNER JOIN &lt;è¡¨2&gt; ON &lt;æ¡ä»¶...&gt;ï¼›JOINæŸ¥è¯¢ä»ç„¶å¯ä»¥ä½¿ç”¨WHEREæ¡ä»¶å’ŒORDER BYæ’åºã€‚ 3. Hive 1. ä¸€ç¯‡æ–‡ç« è®©ä½ äº†è§£Hiveè°ƒä¼˜ï¼ˆæ–‡æœ«èµ ä¹¦ï¼‰ 2. å†æ¬¡åˆ†äº«ï¼Hiveè°ƒä¼˜ï¼Œæ•°æ®å·¥ç¨‹å¸ˆæˆç¥ä¹‹è·¯ 1.1 3NF vs Dim modeling 3NF: æ¯ä¸ªå±æ€§å€¼å”¯ä¸€ï¼Œä¸å…·æœ‰å¤šä¹‰æ€§ï¼› æ¯ä¸ªéä¸»å±æ€§å¿…é¡»å®Œå…¨ä¾èµ–äºæ•´ä¸ªä¸»é”®ï¼Œè€Œéä¸»é”®çš„ä¸€éƒ¨åˆ†ï¼› æ¯ä¸ªéä¸»å±æ€§ä¸èƒ½ä¾èµ–äºå…¶ä»–å…³ç³»ä¸­çš„å±æ€§ï¼Œå› ä¸ºè¿™æ ·çš„è¯ï¼Œè¿™ç§å±æ€§åº”è¯¥å½’åˆ°å…¶ä»–å…³ç³»ä¸­ã€‚ ç»´åº¦æ¨¡å‹: æ˜¯ä¸€ä¸ªè§„èŒƒåŒ–çš„ äº‹å®è¡¨ å’Œ åè§„èŒƒåŒ–çš„ä¸€äº› ç»´åº¦è¡¨ ç»„æˆçš„ (1) ä¸€ç§éè§„èŒƒåŒ–çš„å…³ç³»æ¨¡å‹ (2) è¡¨è·Ÿè¡¨ä¹‹é—´çš„å…³ç³»é€šè¿‡ keyword å’Œ foreign-key æ¥å®šä¹‰ Hive Input -&gt; Mappers -&gt; Sort,Shuffle -&gt; Reducers -&gt; Output Hive ç³»ç»Ÿæ¶æ„ 1. Hive åŸç† 1. ç”¨æˆ·æäº¤æŸ¥è¯¢ç­‰ä»»åŠ¡ç»™Driverã€‚2. ç¼–è¯‘å™¨è·å¾—è¯¥ç”¨æˆ·çš„ä»»åŠ¡Planã€‚3. ç¼–è¯‘å™¨Compileræ ¹æ®ç”¨æˆ·ä»»åŠ¡å»MetaStoreä¸­è·å–éœ€è¦çš„Hiveçš„å…ƒæ•°æ®ä¿¡æ¯ã€‚4. ç¼–è¯‘å™¨Compilerå¾—åˆ°å…ƒæ•°æ®ä¿¡æ¯ï¼Œå¯¹ä»»åŠ¡è¿›è¡Œç¼–è¯‘ï¼Œå…ˆå°†HiveQLè½¬æ¢ä¸ºæŠ½è±¡è¯­æ³•æ ‘ï¼Œç„¶åå°†æŠ½è±¡è¯­æ³•æ ‘è½¬æ¢æˆæŸ¥è¯¢å—ï¼Œå°†æŸ¥è¯¢å—è½¬åŒ–ä¸ºé€»è¾‘çš„æŸ¥è¯¢è®¡åˆ’ï¼Œé‡å†™é€»è¾‘æŸ¥è¯¢è®¡åˆ’ï¼Œå°†é€»è¾‘è®¡åˆ’è½¬åŒ–ä¸ºç‰©ç†çš„è®¡åˆ’ï¼ˆMapReduceï¼‰, æœ€åé€‰æ‹©æœ€ä½³çš„ç­–ç•¥ã€‚5. å°†æœ€ç»ˆçš„è®¡åˆ’æäº¤ç»™Driverã€‚6. Driverå°†è®¡åˆ’Planè½¬äº¤ç»™ExecutionEngineå»æ‰§è¡Œï¼Œè·å–å…ƒæ•°æ®ä¿¡æ¯ï¼Œæäº¤ç»™JobTrackeræˆ–è€…SourceManageræ‰§è¡Œè¯¥ä»»åŠ¡ï¼Œä»»åŠ¡ä¼šç›´æ¥è¯»å–HDFSä¸­æ–‡ä»¶è¿›è¡Œç›¸åº”çš„æ“ä½œã€‚7. è·å–æ‰§è¡Œçš„ç»“æœã€‚8. å–å¾—å¹¶è¿”å›æ‰§è¡Œç»“æœã€‚ 2. hadoopå¤„ç†æ•°æ®çš„è¿‡ç¨‹ï¼Œæœ‰å‡ ä¸ªæ˜¾è‘—çš„ç‰¹å¾ 1.ä¸æ€•æ•°æ®å¤šï¼Œå°±æ€•æ•°æ®å€¾æ–œã€‚2ï¼å¯¹jobsæ•°æ¯”è¾ƒå¤šçš„ä½œä¸šè¿è¡Œæ•ˆç‡ç›¸å¯¹æ¯”è¾ƒä½ï¼Œæ¯”å¦‚å³ä½¿æœ‰å‡ ç™¾è¡Œçš„è¡¨ï¼Œå¦‚æœå¤šæ¬¡å…³è”å¤šæ¬¡æ±‡æ€»ï¼Œäº§ç”Ÿåå‡ ä¸ªjobsï¼Œæ²¡åŠå°æ—¶æ˜¯è·‘ä¸å®Œçš„ã€‚map reduceä½œä¸šåˆå§‹åŒ–çš„æ—¶é—´æ˜¯æ¯”è¾ƒé•¿çš„ã€‚3.å¯¹sumï¼Œcountæ¥è¯´ï¼Œä¸å­˜åœ¨æ•°æ®å€¾æ–œé—®é¢˜ã€‚4.å¯¹count(distinct ),æ•ˆç‡è¾ƒä½ï¼Œæ•°æ®é‡ä¸€å¤šï¼Œå‡†å‡ºé—®é¢˜ï¼Œå¦‚æœæ˜¯å¤šcount(distinct )æ•ˆç‡æ›´ä½ 4. Sqoop é—®é¢˜ function import_data_hdfs() &#123; sqoop import \\ -Dorg.apache.sqoop.splitter.allow_text_splitter=true --connect $&#123;jdbc_url&#125; --username $&#123;jdbc_username&#125; --password $&#123;jdbc_passwd&#125; \\ --query &quot;$&#123;exec_sql&#125;&quot; \\ --split-by $&#123;id&#125; -m 20 \\ --target-dir $&#123;target_dir&#125; \\ --fields-terminated-by &quot;\\001&quot; --lines-terminated-by &quot;\\n&quot; \\ --hive-drop-import-delims \\ --null-string &#x27;\\\\N&#x27; --null-non-string &#x27;\\\\N&#x27; check_success echo_ex &quot;end successful import $&#123;target_dir&#125;. field.delim : \\001&quot;&#125;(1) å¯¼å…¥å¯¼å‡ºNullå­˜å‚¨ä¸€è‡´æ€§é—®é¢˜ å¯¼å‡ºæ•°æ®æ—¶é‡‡ç”¨â€“input-null-stringå’Œâ€“input-null-non-string å¯¼å…¥æ•°æ®æ—¶é‡‡ç”¨â€“null-stringå’Œâ€“null-non-string(2). jdbc_url jdbc_url=&quot;jdbc:mysql://xxxx:3306/reportpublic?autoReconnect=true&quot;(3). Map é˜¶æ®µ, åªæœ‰ åŸç†æ˜¯é‡å†™äº† MRï¼š inputformat å’Œ outputformat æ•°æ®æ¹– vs æ•°æ®ä»“åº“ vs æ•°æ®ä¸­å° No. | Title | desc :---: | --- | :---: 0. | [https://delta.io/](https://delta.io/) | 1. | [æ•°æ®æ¹–å¦‚ä½•ä¸ºä¼ä¸šå¸¦æ¥9%çš„é«˜å¢é•¿ï¼Ÿå¯å¦å–ä»£æ•°æ®ä»“åº“ï¼Ÿ](https://mp.weixin.qq.com/s/SjQgQD4jstm9lrE0lSCMbA) | âœ”ï¸ 2. | [æ•°æ®æ¹–(Data Lake)-å‰‘æŒ‡ä¸‹ä¸€ä»£æ•°æ®ä»“åº“](https://mp.weixin.qq.com/s/8k5Iimm6ePaT_Dt1WJihkA) | âœ”ï¸ 3. | [IOTAæ¶æ„ã€æ•°æ®æ¹–ã€Metric Platformï¼Œç»ˆäºæœ‰äººè®²æ¸…æ¥šäº†ï¼](https://mp.weixin.qq.com/s/nn6bHRmx9Xf3WI9mUyWPhw) 4. | [Delta Lake æ•°æ®æ¹–çš„è¯ç”Ÿä¸æ¡ˆä¾‹å®è·µ](https://mp.weixin.qq.com/s/CxRMnclnLtE9pDToBV6RDg) | è‡³æ­¤ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥å¯¹æ¯”ä¸€ä¸‹æ•°æ®æ¹–ã€æ•°æ®ä»“åº“ã€æ•°æ®ä¸­å°ï¼Œç®€æ˜æ‰¼è¦æ¦‚æ‹¬ä¸ºï¼š 1ï¼‰æ•°æ®æ¹–ï¼š æ— ä¸ºè€Œæ²»ï¼Œç›®æ ‡AI 2ï¼‰æ•°æ®ä»“åº“ï¼šåˆ†è€Œæ²»ä¹‹ï¼Œç›®æ ‡BI 3ï¼‰æ•°æ®ä¸­å°ï¼šä¸€ç»Ÿå¤©ä¸‹ï¼Œç›®æ ‡ç»„ç»‡æ¶æ„ > Data Lakeæ˜¯ä¸€ä¸ªå­˜å‚¨åº“ï¼Œå¯ä»¥å­˜å‚¨å¤§é‡ç»“æ„åŒ–ï¼ŒåŠç»“æ„åŒ–å’Œéç»“æ„åŒ–æ•°æ®ã€‚å®ƒæ˜¯ä»¥åŸç”Ÿæ ¼å¼å­˜å‚¨æ¯ç§ç±»å‹æ•°æ®çš„åœ°æ–¹ï¼Œå¯¹å¸æˆ·å¤§å°æˆ–æ–‡ä»¶æ²¡æœ‰å›ºå®šé™åˆ¶ã€‚å®ƒæä¾›é«˜æ•°æ®é‡ä»¥æé«˜åˆ†ææ€§èƒ½å’Œæœ¬æœºé›†æˆã€‚ > > Data Lakeå°±åƒä¸€ä¸ªå¤§å‹å®¹å™¨ï¼Œä¸çœŸæ­£çš„æ¹–æ³Šå’Œæ²³æµéå¸¸ç›¸ä¼¼ã€‚å°±åƒåœ¨æ¹–ä¸­ä½ æœ‰å¤šä¸ªæ”¯æµè¿›æ¥ä¸€æ ·ï¼Œæ•°æ®æ¹–æœ‰ç»“æ„åŒ–æ•°æ®ï¼Œéç»“æ„åŒ–æ•°æ®ï¼Œæœºå™¨åˆ°æœºå™¨ï¼Œå®æ—¶æµåŠ¨çš„æ—¥å¿—ã€‚ > > æ•°æ®æ¹–ç›¸å¯¹äºä»¥å¾€çš„å…³ç³»å‹æ•°æ®åº“ã€ä¼ ç»Ÿå¼æ•°æ®ä»“åº“ï¼Œæ›´å¤šä½“ç°çš„æ˜¯ä¸€ç§æ•°æ®å­˜å‚¨æŠ€æœ¯ä¸Šçš„èåˆã€‚æ•°æ®æ¹–çš„æå‡ºï¼Œæ”¹å˜äº†ç”¨æˆ·ä½¿ç”¨æ•°æ®çš„æ–¹å¼ï¼ŒåŒæ—¶ï¼Œæ•°æ®æ¹–ä¹Ÿæ•´åˆäº†å„ç§ç±»å‹æ•°æ®çš„åˆ†æå’Œå­˜å‚¨ï¼Œç”¨æˆ·ä¸å¿…ä¸ºä¸åŒçš„æ•°æ®æ„å»ºä¸åŒæ•°æ®å­˜å‚¨åº“ã€‚ > > ä½†æ˜¯ï¼Œç°é˜¶æ®µæ•°æ®æ¹–æ›´å¤šæ˜¯ä½œä¸ºæ•°æ®ä»“åº“çš„è¡¥å……ï¼Œå®ƒçš„ç”¨æˆ·ä¸€èˆ¬åªé™äºä¸“ä¸šæ•°æ®ç§‘å­¦å®¶æˆ–åˆ†æå¸ˆã€‚æ•°æ®æ¹–æ¦‚å¿µå’ŒæŠ€æœ¯è¿˜åœ¨ä¸æ–­æ¼”åŒ–ï¼Œä¸åŒçš„è§£å†³æ–¹æ¡ˆä¾›åº”å•†ä¹Ÿåœ¨æ·»åŠ æ–°çš„ç‰¹æ€§å’ŒåŠŸèƒ½ï¼ŒåŒ…æ‹¬æ¶æ„æ ‡å‡†åŒ–å’Œäº’æ“ä½œæ€§ã€æ•°æ®æ²»ç†è¦æ±‚ã€æ•°æ®å®‰å…¨æ€§ç­‰ã€‚ > > æœªæ¥ï¼Œæ•°æ®æ¹–å¯èƒ½ä¼šè¿›ä¸€æ­¥å‘å±•ï¼Œä½œä¸ºä¸€ç§äº‘æœåŠ¡éšæ—¶æŒ‰éœ€æ»¡è¶³å¯¹ä¸åŒæ•°æ®çš„åˆ†æã€å¤„ç†å’Œå­˜å‚¨éœ€æ±‚ï¼Œæ•°æ®æ¹–çš„æ‰©å±•æ€§ï¼Œå¯ä»¥ä¸ºç”¨æˆ·æä¾›æ›´å¤šçš„å®æ—¶åˆ†æï¼ŒåŸºäºä¼ä¸šå¤§æ•°æ®çš„æ•°æ®æ¹–æ­£åœ¨å‘æ”¯æŒæ›´å¤šç±»å‹çš„å®æ—¶æ™ºèƒ½åŒ–æœåŠ¡å‘å±•ï¼Œ å°†ä¼šä¸ºä¼ä¸šç°æœ‰çš„æ•°æ®é©±åŠ¨å‹å†³ç­–åˆ¶å®šæ¨¡å¼å¸¦æ¥æå¤§æ”¹å˜ã€‚ > > å³å¸­æŸ¥è¯¢ï¼ˆAd Hocï¼‰ç”¨æˆ·æ®è‡ªå·±çš„éœ€æ±‚ï¼Œçµæ´»çš„é€‰æ‹©æŸ¥è¯¢æ¡ä»¶ï¼Œç³»ç»Ÿèƒ½å¤Ÿæ ¹æ®ç”¨æˆ·çš„é€‰æ‹©ç”Ÿæˆç›¸åº”çš„ç»Ÿè®¡æŠ¥è¡¨ dw No. | ä¸»é¢˜åç§° | ä¸»é¢˜æè¿° --- | --- | --- 1. | **å®¢æˆ· (USER)** | å½“äº‹äºº, ç”¨æˆ·ä¿¡æ¯, éå¸¸å¤š, äººè¡Œå¾ä¿¡ä¿¡æ¯ï¼Œ ä¸ªäººèµ„äº§ä¿¡æ¯ 2. | æœºæ„ (ORG) | çº¿ä¸‹æœ‰å“ªäº›å›¢é˜Ÿ, æµ™æ±ŸåŒºï¼Œå›¢é˜Ÿé•¿ï¼Œå®¢æˆ·ç»ç†ï¼Œ æœ‰ 600+ ä¸ª. åªæœ‰ç»´åº¦è¡¨ 3. | äº§å“ (PRD) | ç­¾åè®® äº§ç”Ÿ äº§å“, ä¸šåŠ¡æµç¨‹, åªæœ‰ç»´åº¦è¡¨ äº§å“ç»´åº¦è¡¨ï¼š äº§å“ç¼–å·(åˆ†å¥½å‡ çº§), äº§å“åç§°, dim_code, dim_nameï¼Œ ä¸Šæ¶ï¼Œ ä¸‹æ¶äº¬ä¸œé‡‘æ¡ï¼Œ codeï¼Œ å±•ç¤ºç»™è´¢åŠ¡ 4. | æ¸ é“ (CHL) | 5. | **äº‹ä»¶ (EVT)** | 1. ä¸šå€Ÿ / æ³¨å†Œ&è®¤è¯ 2. æˆä¿¡ 3. æ”¯ç”¨ 4. æ”¾æ¬¾ 5. æ”¯ä»˜ 6. è¿˜æ¬¾ 6. | **åè®® (AGR)** | åˆçº¦ 7. | è¥é”€ (CAMP) | è¥é”€ä¹‹åçš„ï¼Œå•†åŠ¡ç»ç†å’Œæ¸ é“ï¼Œè°ˆä¸‹æ¥ä¹‹åï¼Œ åç«¯ æ¸ é“ï¼Œ èµ„äº§ï¼Œ è´¦åŠ¡ 8. | **è´¢åŠ¡ (RISK)** | 9. | é£é™© (FINANCE) | é£é™©éƒ¨ Reference HDFSåŸºæœ¬æ¶æ„ã€åŸç†ã€ä¸åº”ç”¨åœºæ™¯ã€å®è·µï¼ˆé™„pptï¼‰ Hiveå­˜å‚¨æ ¼å¼å¯¹æ¯” very good - igDataGuide/é¢è¯•-all Apache Druid ç®€ä»‹ æ“ä½œç³»ç»Ÿä¹‹å †å’Œæ ˆçš„åŒºåˆ« æ¼«è°ˆæ•°æ®ä»“åº“ä¹‹æ‹‰é“¾è¡¨ï¼ˆåŸç†ã€è®¾è®¡ä»¥åŠåœ¨Hiveä¸­çš„å®ç°ï¼‰ 2020å¤§æ•°æ®/æ•°ä»“/æ•°å¼€é¢è¯•é¢˜çœŸé¢˜æ€»ç»“(é™„ç­”æ¡ˆ)","categories":[{"name":"data-warehouse","slug":"data-warehouse","permalink":"http://iequa.com/categories/data-warehouse/"}],"tags":[{"name":"data warehouse","slug":"data-warehouse","permalink":"http://iequa.com/tags/data-warehouse/"}]},{"title":"Data Analysis - SQL 50 ç¬¬2ç¯‡ Action","slug":"dataware/dw-sql-50-2","date":"2020-08-08T01:07:21.000Z","updated":"2020-08-10T00:49:11.258Z","comments":true,"path":"2020/08/08/dataware/dw-sql-50-2/","link":"","permalink":"http://iequa.com/2020/08/08/dataware/dw-sql-50-2/","excerpt":"","text":"å…¶ä¸­é‡ç‚¹ä¸ºï¼š1/2/5/6/7/10/11/12/13/15/17/18/19/22/23/25/31/35/36/40/41/42/45/46 å…±16é¢˜ è¶…çº§é‡ç‚¹ 18å’Œ23ã€ 22å’Œ25 ã€ 41ã€46 (1). æŸ¥è¯¢è¯¾ç¨‹ç¼–å·ä¸ºâ€œ01â€çš„è¯¾ç¨‹æ¯”â€œ02â€çš„è¯¾ç¨‹æˆç»©é«˜çš„æ‰€æœ‰å­¦ç”Ÿçš„å­¦å·ï¼ˆé‡ç‚¹ï¼‰ SELECT t1.s_id as t1_s_id, t2.s_id as t2_s_id, t3.s_name, t1.s_score as s_score_01, t2.s_score as s_score_02FROM (select s_id, c_id, s_score from Score WHERE c_id = &#x27;01&#x27;) as t1INNER JOIN (select s_id, c_id, s_score from Score WHERE c_id = &#x27;02&#x27;) as t2ON t1.s_id = t2.s_idINNER JOIN Student as t3 ON t1.s_id = t3.s_idwhere t1.s_score &gt; t2.s_score (2). æŸ¥è¯¢å¹³å‡æˆç»©å¤§äº60åˆ†çš„å­¦ç”Ÿçš„å­¦å·å’Œå¹³å‡æˆç»©ï¼ˆç®€å•ï¼Œç¬¬äºŒé“é‡ç‚¹ï¼‰ bilibili analysis SELECT s_id, avg(s_score)FROM scoreGROUP BY s_id HAVING avg(s_score) &gt; 60 (9). æŸ¥è¯¢æ‰€æœ‰è¯¾ç¨‹æˆç»©å°äº60åˆ†çš„å­¦ç”Ÿçš„å­¦å·ã€å§“å å¾—å‡ºåŒå­¦è¯¾ç¨‹æˆç»©å°äº 60åˆ† çš„è¯¾ç¨‹æ•° ç»Ÿè®¡åŒå­¦æ€»å…±å­¦äº†å‡ é—¨è¯¾ SELECT a.s_id, t.s_nameFROM(SELECT s_id, count(c_id) as cntFROM ScoreWHERE s_score &lt; 60GROUP BY s_id) aINNER JOIN(SELECT s_id, count(c_id) as cnt FROM ScoreGROUP BY s_id) bON a.s_id = b.s_idINNER JOINStudent as t ON a.s_id=t.s_idWHERE a.cnt = b.cnt (3). æŸ¥è¯¢æ‰€æœ‰å­¦ç”Ÿçš„å­¦å·ã€å§“åã€é€‰è¯¾æ•°ã€æ€»æˆç»© å­¦å· å§“å è¯¾ç¨‹ç¼–å· è¿™é—¨è¯¾æˆç»© 1 å°å¼  1 60 1 å°å¼  3 70 SELECT t1.s_id, t1.s_name, COUNT( t2.c_id ), SUM(case when t2.s_score is NULL then 0 else t2.s_score END) FROM Student AS t1 LEFT JOIN Score AS t2 ON t1.s_id = t2.s_idGROUP BY s_id, t1.s_name (4). æŸ¥è¯¢å§“â€œçŒ´â€çš„è€å¸ˆçš„ä¸ªæ•°ï¼ˆä¸é‡è¦ï¼‰ SELECT count(t_id)FROM teacherWHERE t_name LIKE &#x27;å¼ %&#x27; SELECT count(distinct t_name)FROM teacherWHERE t_name LIKE &#x27;å¼ %&#x27; (5). æŸ¥è¯¢æ²¡å­¦è¿‡â€œå¼ ä¸‰â€è€å¸ˆè¯¾çš„å­¦ç”Ÿçš„å­¦å·ã€å§“åï¼ˆé‡ç‚¹ï¼‰ å­¦å· è¯¾ç¨‹å· æˆç»© æ•™å¸ˆå· æ•™å¸ˆå§“å s_1 c_1 90 t_1 å¼ ä¸‰ SELECT s_id, s_name from StudentWHERE s_id not in ( SELECT s_id FROM Score s INNER JOIN Course c ON s.c_id = c.c_id INNER JOIN Teacher t ON c.t_id = t.t_id WHERE t.t_name=&#x27;å¼ ä¸‰&#x27;) (6). æŸ¥è¯¢å­¦è¿‡â€œå¼ ä¸‰â€è€å¸ˆæ‰€æ•™çš„æ‰€æœ‰è¯¾çš„åŒå­¦çš„å­¦å·ã€å§“åï¼ˆé‡ç‚¹) SELECT st.s_id, st.s_name FROM Student as st INNER JOIN Score s ON s.s_id = st.s_id INNER JOIN Course c ON s.c_id = c.c_id INNER JOIN Teacher t ON c.t_id = t.t_id WHERE t.t_name=&#x27;å¼ ä¸‰&#x27;) å¹³æ—¶åšçš„æ—¶å€™è¡¨å¤ªå¤§ï¼Œæˆ‘ä»¬ä¼šå…ˆè¿‡æ»¤ç”¨ â€™å¼ ä¸‰â€˜ çš„æ¡ä»¶ï¼Œåšæˆ temp table åœ¨å¼€å§‹åš JOIN. (7). æŸ¥è¯¢å­¦è¿‡ç¼–å·ä¸ºâ€œ01â€çš„è¯¾ç¨‹å¹¶ä¸”ä¹Ÿå­¦è¿‡ç¼–å·ä¸ºâ€œ02â€çš„è¯¾ç¨‹çš„å­¦ç”Ÿçš„å­¦å·ã€å§“åï¼ˆé‡ç‚¹ï¼‰ SELECT * FROM STUDENT WHERE s_id IN( SELECT a.s_id FROM (SELECT s_id, c_id FROM Score WHERE c_id = &#x27;01&#x27;) a INNER JOIN (SELECT s_id, c_id FROM Score WHERE c_id = &#x27;02&#x27;) b ON a.s_id = b.s_id) (8). æŸ¥è¯¢è¯¾ç¨‹ç¼–å·ä¸ºâ€œ02â€çš„æ€»æˆç»©ï¼ˆä¸é‡ç‚¹ï¼‰ SELECT SUM(s_score)FROM ScorewWHERE c_id = &#x27;02&#x27; (10). æŸ¥è¯¢æ²¡æœ‰å­¦å…¨æ‰€æœ‰è¯¾çš„å­¦ç”Ÿçš„å­¦å·ã€å§“å(é‡ç‚¹) SELECT * FROM courseSELECT * FROM Score Error Version: SELECT s_id, s_name FROM Student WHERE s_id IN ( SELECT s_id FROM Score GROUP BY s_id HAVING count(distinct c_id) &lt; (SELECT COUNT(distinct c_id) FROM Course))-- ä¸€é—¨è¯¾éƒ½æ²¡æœ‰å­¦ï¼Œä¸Šé¢çš„ SQL å°±æ¼æ‰äº†. Right Version: SELECT st.*, sc.*FROM Student as stLEFT JOIN Score as sc ON st.s_id=sc.s_idGROUP BY st.s_id HAVING count(distinct sc.c_id) &lt; (SELECT COUNT(distinct c_id) FROM Course))-- ä¸€é—¨è¯¾éƒ½æ²¡æœ‰å­¦ï¼Œä¸Šé¢çš„ SQL å°±æ¼æ‰äº†. (11). æŸ¥è¯¢è‡³å°‘æœ‰ä¸€é—¨è¯¾ä¸å­¦å·ä¸ºâ€œ01â€çš„å­¦ç”Ÿæ‰€å­¦è¯¾ç¨‹ç›¸åŒçš„å­¦ç”Ÿçš„å­¦å·å’Œå§“åï¼ˆé‡ç‚¹ï¼‰ andåœ¨æ‹¬å·å¤–ç”¨ distinct ä¸çŸ¥é“ä»€ä¹ˆæ—¶å€™ç”¨ï¼Ÿ (12). æŸ¥è¯¢å’Œâ€œ01â€å·åŒå­¦æ‰€å­¦è¯¾ç¨‹å®Œå…¨ç›¸åŒçš„å…¶ä»–åŒå­¦çš„å­¦å·(é‡ç‚¹) Reference å¸¸è§çš„SQLé¢è¯•é¢˜ï¼šç»å…¸50é¢˜ - çŸ¥ä¹ SQLé¢è¯•å¿…ä¼š50é¢˜ - çŸ¥ä¹ bilibiliã€æ•°æ®åˆ†æã€‘- SQLé¢è¯•50é¢˜ - è·Ÿæˆ‘ä¸€èµ·æ‰“æ€ªå‡çº§ ä¸€èµ·æˆä¸ºæ•°æ®ç§‘å­¦å®¶ æ•°æ®åˆ†æå¸ˆæˆé•¿ä¹‹è·¯ ã€SQLã€‘SQLé¢è¯•50é¢˜ åˆ†ç±»æ¢³ç†ä¸è§£ç­” ã€Pythonã€‘æ•°æ®åˆ†æå‰çš„å…¥é—¨æ•™ç¨‹ Python For Everybody P1ï¼šé›¶åŸºç¡€ç¨‹åºè®¾è®¡","categories":[{"name":"data-warehouse","slug":"data-warehouse","permalink":"http://iequa.com/categories/data-warehouse/"}],"tags":[{"name":"data warehouse","slug":"data-warehouse","permalink":"http://iequa.com/tags/data-warehouse/"}]},{"title":"Data Analysis - SQL 50 ç¬¬1ç¯‡","slug":"dataware/dw-sql-50-1","date":"2020-08-07T01:07:21.000Z","updated":"2020-08-08T10:32:58.688Z","comments":true,"path":"2020/08/07/dataware/dw-sql-50-1/","link":"","permalink":"http://iequa.com/2020/08/07/dataware/dw-sql-50-1/","excerpt":"","text":"æœ¬æ–‡æ±‡æ€»äº†ä¸åŒç‰ˆæœ¬çš„SQLé¢è¯•50é¢˜çš„é¢˜ç›®ï¼Œåˆ å»äº†é‡å¤å†…å®¹ï¼Œå¹¶æ ¹æ®æ¶‰åŠçŸ¥è¯†ç‚¹è¿›è¡Œåˆ†ç±»ï¼ŒæŒ‰ç…§ç”±æ˜“åˆ°éš¾ã€ç›¸ä¼¼é¢˜æ”¾åœ¨ä¸€èµ·çš„æ€è·¯è¿›è¡Œæ’åºå¹¶é‡æ–°ç¼– Table å…³ç³»å›¾ï¼š SQLé¢è¯•å¿…ä¼š50é¢˜ - çŸ¥ä¹ å»ºè¡¨ &amp; å‡†å¤‡æ•°æ®ï¼š -- å»ºè¡¨-- å­¦ç”Ÿè¡¨CREATE TABLE `Student`(`s_id` VARCHAR(20),`s_name` VARCHAR(20) NOT NULL DEFAULT &#x27;&#x27;,`s_birth` VARCHAR(20) NOT NULL DEFAULT &#x27;&#x27;,`s_sex` VARCHAR(10) NOT NULL DEFAULT &#x27;&#x27;,PRIMARY KEY(`s_id`));-- è¯¾ç¨‹è¡¨CREATE TABLE `Course`(`c_id` VARCHAR(20),`c_name` VARCHAR(20) NOT NULL DEFAULT &#x27;&#x27;,`t_id` VARCHAR(20) NOT NULL,PRIMARY KEY(`c_id`));-- æ•™å¸ˆè¡¨CREATE TABLE `Teacher`(`t_id` VARCHAR(20),`t_name` VARCHAR(20) NOT NULL DEFAULT &#x27;&#x27;,PRIMARY KEY(`t_id`));-- æˆç»©è¡¨CREATE TABLE `Score`(`s_id` VARCHAR(20),`c_id` VARCHAR(20),`s_score` INT(3),PRIMARY KEY(`s_id`,`c_id`)); -- æ’å…¥å­¦ç”Ÿè¡¨æµ‹è¯•æ•°æ®insert into Student values(&#x27;01&#x27; , &#x27;èµµé›·&#x27; , &#x27;1990-01-01&#x27; , &#x27;ç”·&#x27;);insert into Student values(&#x27;02&#x27; , &#x27;é’±ç”µ&#x27; , &#x27;1990-12-21&#x27; , &#x27;ç”·&#x27;);insert into Student values(&#x27;03&#x27; , &#x27;å­™é£&#x27; , &#x27;1990-05-20&#x27; , &#x27;ç”·&#x27;);insert into Student values(&#x27;04&#x27; , &#x27;æäº‘&#x27; , &#x27;1990-08-06&#x27; , &#x27;ç”·&#x27;);insert into Student values(&#x27;05&#x27; , &#x27;å‘¨æ¢…&#x27; , &#x27;1991-12-01&#x27; , &#x27;å¥³&#x27;);insert into Student values(&#x27;06&#x27; , &#x27;å´å…°&#x27; , &#x27;1992-03-01&#x27; , &#x27;å¥³&#x27;);insert into Student values(&#x27;07&#x27; , &#x27;éƒ‘ç«¹&#x27; , &#x27;1989-07-01&#x27; , &#x27;å¥³&#x27;);insert into Student values(&#x27;08&#x27; , &#x27;ç‹èŠ&#x27; , &#x27;1990-01-20&#x27; , &#x27;å¥³&#x27;);-- è¯¾ç¨‹è¡¨æµ‹è¯•æ•°æ®insert into Course values(&#x27;01&#x27; , &#x27;è¯­æ–‡&#x27; , &#x27;02&#x27;);insert into Course values(&#x27;02&#x27; , &#x27;æ•°å­¦&#x27; , &#x27;01&#x27;);insert into Course values(&#x27;03&#x27; , &#x27;è‹±è¯­&#x27; , &#x27;03&#x27;);-- æ•™å¸ˆè¡¨æµ‹è¯•æ•°æ®insert into Teacher values(&#x27;01&#x27; , &#x27;å¼ ä¸‰&#x27;);insert into Teacher values(&#x27;02&#x27; , &#x27;æå››&#x27;);insert into Teacher values(&#x27;03&#x27; , &#x27;ç‹äº”&#x27;);-- æˆç»©è¡¨æµ‹è¯•æ•°æ®insert into Score values(&#x27;01&#x27; , &#x27;01&#x27; , 80);insert into Score values(&#x27;01&#x27; , &#x27;02&#x27; , 90);insert into Score values(&#x27;01&#x27; , &#x27;03&#x27; , 99);insert into Score values(&#x27;02&#x27; , &#x27;01&#x27; , 70);insert into Score values(&#x27;02&#x27; , &#x27;02&#x27; , 60);insert into Score values(&#x27;02&#x27; , &#x27;03&#x27; , 80);insert into Score values(&#x27;03&#x27; , &#x27;01&#x27; , 80);insert into Score values(&#x27;03&#x27; , &#x27;02&#x27; , 80);insert into Score values(&#x27;03&#x27; , &#x27;03&#x27; , 80);insert into Score values(&#x27;04&#x27; , &#x27;01&#x27; , 50);insert into Score values(&#x27;04&#x27; , &#x27;02&#x27; , 30);insert into Score values(&#x27;04&#x27; , &#x27;03&#x27; , 20);insert into Score values(&#x27;05&#x27; , &#x27;01&#x27; , 76);insert into Score values(&#x27;05&#x27; , &#x27;02&#x27; , 87);insert into Score values(&#x27;06&#x27; , &#x27;01&#x27; , 31);insert into Score values(&#x27;06&#x27; , &#x27;03&#x27; , 34);insert into Score values(&#x27;07&#x27; , &#x27;02&#x27; , 89);insert into Score values(&#x27;07&#x27; , &#x27;03&#x27; , 98); Reference å¸¸è§çš„SQLé¢è¯•é¢˜ï¼šç»å…¸50é¢˜ - çŸ¥ä¹ SQLé¢è¯•å¿…ä¼š50é¢˜ - çŸ¥ä¹ bilibiliã€æ•°æ®åˆ†æã€‘- SQLé¢è¯•50é¢˜ - è·Ÿæˆ‘ä¸€èµ·æ‰“æ€ªå‡çº§ ä¸€èµ·æˆä¸ºæ•°æ®ç§‘å­¦å®¶ æ•°æ®åˆ†æå¸ˆæˆé•¿ä¹‹è·¯ ã€SQLã€‘SQLé¢è¯•50é¢˜ åˆ†ç±»æ¢³ç†ä¸è§£ç­” ã€Pythonã€‘æ•°æ®åˆ†æå‰çš„å…¥é—¨æ•™ç¨‹ Python For Everybody P1ï¼šé›¶åŸºç¡€ç¨‹åºè®¾è®¡","categories":[{"name":"data-warehouse","slug":"data-warehouse","permalink":"http://iequa.com/categories/data-warehouse/"}],"tags":[{"name":"data warehouse","slug":"data-warehouse","permalink":"http://iequa.com/tags/data-warehouse/"}]},{"title":"Python æ˜Ÿå·è¡¨è¾¾å¼(*) ç”¨æ³•è¯¦è§£","slug":"python/language/py-language-15-star","date":"2020-07-17T02:00:21.000Z","updated":"2020-07-17T02:47:54.468Z","comments":true,"path":"2020/07/17/python/language/py-language-15-star/","link":"","permalink":"http://iequa.com/2020/07/17/python/language/py-language-15-star/","excerpt":"","text":"1. å‡½æ•°å¯å˜å‚æ•°æ ‡å¿—ä»¥åŠå‚æ•°è§£åŒ…2. èµ‹å€¼è¯­å¥ä¸­ä½œä¸ºå¯å˜å˜é‡æ ‡å¿—3. å¯¹å¯è¿­ä»£å¯¹è±¡è¿›è¡Œè§£åŒ…4. å…ƒç»„/é›†åˆ/åˆ—è¡¨ä»¥å…ƒç»„ä¸ºä¾‹ï¼Œé›†åˆä¸åˆ—è¡¨åŒç†ã€‚ å…ƒç»„ä¹Ÿå¯ä»¥æ¯”è¾ƒå¤§å°ï¼Œä¾‹å¦‚ä¸‹é¢ä»£ç ï¼š (1, 5) &lt; (2, 3) # True(2, 8) &lt; (2, 6) # False(1, 2) &lt; (1, 2) # False(1, 1, -1) &lt; (1, 2) # True(1, 2, -1) &lt; (1, 2) # False Reference pythonå‡½æ•°å‚æ•°å‰é¢å•æ˜Ÿå·ï¼ˆï¼‰å’ŒåŒæ˜Ÿå·ï¼ˆ*ï¼‰çš„åŒºåˆ« Pythonæ˜Ÿå·è¡¨è¾¾å¼(*)ç”¨æ³•è¯¦è§£ å…ƒç»„/é›†åˆ/åˆ—è¡¨ æ¯”è¾ƒå¤§å°","categories":[{"name":"python","slug":"python","permalink":"http://iequa.com/categories/python/"}],"tags":[{"name":"python","slug":"python","permalink":"http://iequa.com/tags/python/"}]},{"title":"JVM è¿è¡Œæ—¶","slug":"java/java-jvm-p1","date":"2020-05-30T08:54:16.000Z","updated":"2020-08-31T00:20:53.050Z","comments":true,"path":"2020/05/30/java/java-jvm-p1/","link":"","permalink":"http://iequa.com/2020/05/30/java/java-jvm-p1/","excerpt":"","text":"1. JVM çš„ç»„ç»‡ç»“æ„ jvm çš„ä¸‰ä¸ªæ ¸å¿ƒï¼š jvm ç±»åŠ è½½æœºåˆ¶ jvm è¿è¡Œæ—¶æ•°æ®åŒº jvm åƒåœ¾å›æ”¶ 2. JVM å„åŒºåŸŸä½œç”¨ heap Method Area Program Counter Register JVM Stacks Native Method Stacks å¼‚å¸¸æ€»ç»“ 3. JVM åƒåœ¾å›æ”¶ æ¦‚è¿° Garbage Collector Reference JVMå†…å­˜ç»“æ„ JVMç‰©ç†ç»“æ„å’Œåœ¨å†…å­˜ä¸­çš„ç»„ç»‡ç»“æ„ æ·±å…¥ç†è§£JVM-å†…å­˜æ¨¡å‹ï¼ˆjmmï¼‰å’ŒGC","categories":[{"name":"java","slug":"java","permalink":"http://iequa.com/categories/java/"}],"tags":[{"name":"java","slug":"java","permalink":"http://iequa.com/tags/java/"},{"name":"jvm","slug":"jvm","permalink":"http://iequa.com/tags/jvm/"}]},{"title":"Hive Optimize 25 Items","slug":"hadoop/hive-optimization-25-cases","date":"2020-04-18T00:07:21.000Z","updated":"2020-12-06T10:53:28.176Z","comments":true,"path":"2020/04/18/hadoop/hive-optimization-25-cases/","link":"","permalink":"http://iequa.com/2020/04/18/hadoop/hive-optimization-25-cases/","excerpt":"","text":"è°ƒä¼˜: Hiveåº•å±‚æ‰§è¡Œå¼•æ“æ·±åº¦å‰–æ 25æ¡Hiveæ€§èƒ½è°ƒä¼˜å®æˆ˜ æ·±åº¦å‰–æHiveæ¶æ„è®¾è®¡ä¸å·¥ä½œåŸç†4.1 Hive çš„æ¦‚å¿µ Hiveä¾èµ–HDFSæ•°æ®ï¼ŒHiveå°†HQLè½¬æˆMapReduceæ‰§è¡Œï¼Œæ‰€ä»¥è¯´Hiveæ˜¯åŸºäºHadoopçš„ä¸€ä¸ªæ•°æ®ä»“åº“å·¥å…· å®è´¨å°±æ˜¯ä¸€æ¬¾åŸºäºHDFSçš„MapReduceè®¡ç®—æ¡†æ¶ï¼Œå¯¹å­˜å‚¨åœ¨HDFSä¸­çš„æ•°æ®è¿›è¡Œåˆ†æå’Œç®¡ç†ã€‚ 4.2 Hive çš„å·¥ä½œæœºåˆ¶ç®€å•æ€»ç»“: 1ã€Hiveçš„å†…ç½®å››å¤§ç»„ä»¶(Driver, Compiler, Optimizer, Executor)å®ŒæˆHQLåˆ°MapReduceçš„è½¬æ¢ 2ã€åœ¨Hiveæ‰§è¡ŒHQLç¼–è¯‘è¿‡ç¨‹ä¸­ï¼Œä¼šä»å…ƒæ•°æ®åº“è·å–è¡¨ç»“æ„å’Œæ•°æ®å­˜å‚¨ç›®å½•ç­‰ç›¸å…³ä¿¡æ¯ 3ã€Hiveåªæ˜¯å®Œæˆå¯¹å­˜å‚¨åœ¨HDFSä¸Šçš„ç»“æ„åŒ–æ•°æ®çš„ç®¡ç†ï¼Œå¹¶æä¾›ä¸€ç§ç±»SQLçš„æ“ä½œæ–¹å¼æ¥è¿›è¡Œæµ·é‡æ•°æ®è¿è¡Œï¼Œ åº•å±‚æ”¯æŒå¤šç§åˆ†å¸ƒå¼è®¡ç®—å¼•æ“ã€‚ æœ€å…¨25æ¡é€‰æ€§èƒ½è°ƒä¼˜å…¨è¯¦è§£5.1 è°ƒä¼˜æ¦‚è¿°Hive ä½œä¸ºå¤§æ•°æ®é¢†åŸŸå¸¸ç”¨çš„æ•°æ®ä»“åº“ç»„ä»¶ï¼Œåœ¨å¹³æ—¶è®¾è®¡å’ŒæŸ¥è¯¢æ—¶è¦ç‰¹åˆ«æ³¨æ„æ•ˆç‡ã€‚å½±å“ Hive æ•ˆç‡çš„å‡ ä¹ä»ä¸æ˜¯æ•°æ®é‡è¿‡å¤§ï¼Œè€Œæ˜¯æ•°æ®å€¾æ–œã€å†—ä½™ã€Jobæˆ–I/Oè¿‡å¤šã€MapReduce åˆ†é…ä¸åˆç†ç­‰ã€‚ å¯¹ Hive çš„è°ƒä¼˜æ—¢åŒ…å« Hive çš„å»ºè¡¨è®¾è®¡æ–¹é¢ï¼Œå¯¹HiveHQL è¯­å¥æœ¬èº«çš„ä¼˜åŒ–ï¼Œä¹ŸåŒ…å« Hive é…ç½®å‚æ•°å’Œåº•å±‚å¼•æ“ MapReduceæ–¹é¢çš„è°ƒæ•´ã€‚ æ‰€ä»¥æ­¤æ¬¡è°ƒä¼˜ä¸»è¦åˆ†ä¸ºä»¥ä¸‹å››ä¸ªæ–¹é¢å±•å¼€: 1ã€Hiveçš„å»ºè¡¨è®¾è®¡å±‚é¢ 2ã€HQLè¯­æ³•å’Œè¿è¡Œå‚æ•°å±‚é¢ 3ã€Hiveæ¶æ„å±‚é¢ 4ã€Hiveæ•°æ®å€¾æ–œ æ€»ä¹‹ï¼ŒHiveè°ƒä¼˜çš„ä½œç”¨ï¼š åœ¨ä¿è¯ä¸šåŠ¡ç»“æœä¸å˜çš„å‰æä¸‹ï¼Œé™ä½èµ„æºçš„ä½¿ç”¨é‡ï¼Œå‡å°‘ä»»åŠ¡çš„æ‰§è¡Œæ—¶é—´ã€‚ 5.2 è°ƒä¼˜é¡»çŸ¥5.3 Hiveå»ºè¡¨è®¾è®¡å±‚é¢5.3.1 åˆ©ç”¨åˆ†åŒºè¡¨ä¼˜åŒ–5.3.2 åˆ©ç”¨åˆ†æ¡¶è¡¨ä¼˜åŒ–è·Ÿåˆ†åŒºçš„æ¦‚å¿µå¾ˆç›¸ä¼¼, éƒ½æ˜¯æŠŠæ•°æ®åˆ†æˆå¤šä¸ªä¸åŒç±»åˆ«, åŒºåˆ«å°±æ˜¯è§„åˆ™ä¸ä¸€æ · ! 1ã€åˆ†åŒºï¼š æŒ‰ç…§å­—æ®µå€¼æ¥è¿›è¡Œ: ä¸€ä¸ªåˆ†åŒº, å°±åªæ˜¯åŒ…å«è¿™ä¸ªè¿™ä¸€ä¸ªå€¼çš„æ‰€æœ‰è®°å½• Hive Bucket, åˆ†æ¡¶, æ˜¯æŒ‡å°†æ•°æ®ä»¥æŒ‡å®šåˆ—çš„å€¼ä¸ºkeyè¿›è¡Œhash, hash åˆ°æŒ‡å®šæ•°æ®çš„æ¡¶ä¸­. 5.3.3 åˆé€‚çš„æ–‡ä»¶å­˜å‚¨æ ¼å¼data warehouse ods: TextFile dw: ORC or ParquetFile 5.3.4 åˆé€‚çš„å‹ç¼©æ ¼å¼5.4 HQL è¯­æ³•å’Œè¿è¡Œå‚æ•°å±‚é¢5.4.1 æŸ¥çœ‹Hiveæ‰§è¡Œè®¡åˆ’5.4.2 åˆ—è£å‰ª5.4.3 è°“è¯ä¸‹æ¨5.4.4 åˆ†åŒºè£å‰ª5.4.5 åˆå¹¶å°æ–‡ä»¶5.4.6 åˆç†è®¾ç½®MapTaskå¹¶è¡Œåº¦5.4.7 åˆç†è®¾ç½®ReduceTaskå¹¶è¡Œåº¦Reference Sparkæ€§èƒ½ä¼˜åŒ–æŒ‡å—â€”â€”åŸºç¡€ç¯‡ Sparkæ€§èƒ½ä¼˜åŒ–æŒ‡å—â€”â€”é«˜çº§ç¯‡ å¤§æ•°æ®èµ„æ–™ç¬”è®°æ•´ç†","categories":[{"name":"spark","slug":"spark","permalink":"http://iequa.com/categories/spark/"}],"tags":[{"name":"spark","slug":"spark","permalink":"http://iequa.com/tags/spark/"}]},{"title":"ä» Transformer åˆ° BERTæ¨¡å‹ (by è‘›ç¿°éª‹ Amazon)","slug":"nlp/BERT_tutorial_5_Summary","date":"2020-04-05T03:00:21.000Z","updated":"2020-04-05T12:52:40.815Z","comments":true,"path":"2020/04/05/nlp/BERT_tutorial_5_Summary/","link":"","permalink":"http://iequa.com/2020/04/05/nlp/BERT_tutorial_5_Summary/","excerpt":"","text":"Paper: BERT: Pre-training of Deep Bidirectional Transformers for Language Understanding BERTçš„å…¨ç§°æ˜¯: Bidirectional Encoder Representation from Transformers 1. Transformer to BERT 1.1 ELMOELMO å…¨ç§°ï¼š Embeddings from Language Models 1.2 Transformer 1.3 Bert E_A ä»£è¡¨è¿™ä¸ª Token å±äº SentenceA è¿˜æ˜¯ Sentence B 1.4 Pre-training Bert ä¸ºä»€ä¹ˆç”¨2ä¸ª Sentences è®¡ç®— Loss æ—¶ï¼Œåªé’ˆå¯¹è¢« Mask çš„ Token Training Tips 1). å¢åŠ ä¸åŒ Token è¢« Mask çš„æœºä¼š3). ä¸è¡¨ç¤ºåœ¨ Word Level åš Mask Looks Likeï¼š Bert æ¯ä¸ª Head èƒ½æŠ“ä½ä¸åŒçš„ Feature å¯¹äºæ¯ä¸ªå±‚ï¼Œhead çš„åŠŸèƒ½å·®ä¸å¤šï¼Œå¯¹äºæ¯ä¸ª Head é‡Œé¢ï¼Œæ¯ä¸ªä¸åŒçš„ head è¡¨ç°çš„åŠŸèƒ½æ˜¯ä¸ä¸€æ ·çš„ 2. Transformer to BERT é˜…è¯»ç†è§£æ˜¯QAåŠ éš¾çš„ç‰ˆæœ¬ 3. Recap æ¯ä¸ªwordéƒ½æ˜¯è¿™å¥è¯çš„æ‰€æœ‰ä¿¡æ¯ç»„æˆçš„ Bert Training 40+ times, Fine-tune 2~4 times every token: 12 * 768ï¼Œ 12 å±‚çš„ Transformer. Bert ä¸»è¦çš„ç¼ºé™·å°±æ˜¯å¤ªå¤§äº†. Reference ä¸€æ­¥æ­¥ç†è§£BERT ä»è¯­è¨€æ¨¡å‹åˆ°Seq2Seqï¼šTransformerå¦‚æˆï¼Œå…¨é Mask BERTå®Œå…¨æŒ‡å— å¯è§†åŒ–Bert","categories":[{"name":"nlp","slug":"nlp","permalink":"http://iequa.com/categories/nlp/"}],"tags":[{"name":"BERT","slug":"BERT","permalink":"http://iequa.com/tags/BERT/"}]},{"title":"SBERT-WK-Sentence-Embedding","slug":"nlp/SBERT-WK-Sentence-Embedding","date":"2020-03-18T14:00:21.000Z","updated":"2020-03-21T07:06:02.792Z","comments":true,"path":"2020/03/18/nlp/SBERT-WK-Sentence-Embedding/","link":"","permalink":"http://iequa.com/2020/03/18/nlp/SBERT-WK-Sentence-Embedding/","excerpt":"SBERT-WK: A Sentence Embedding Method by Dissecting BERT-based Word Models è¦ç‚¹ï¼šä¸€ç§æ–°çš„å¥å­åµŒå…¥æ–¹æ³•","text":"SBERT-WK: A Sentence Embedding Method by Dissecting BERT-based Word Models è¦ç‚¹ï¼šä¸€ç§æ–°çš„å¥å­åµŒå…¥æ–¹æ³• é“¾æ¥ï¼šhttps://arxiv.org/abs/2002.06652 codeï¼šGithub SBERT-WK-Sentence-Embedding ä½œè€…ï¼šBin Wang, C.-C. Jay Kuo å•ä½ï¼šUniversity of Southern California ä¸»é¢˜ï¼šComputation and Language (cs.CL); Machine Learning (cs.LG); Multimedia (cs.MM) è¦ç‚¹ï¼šä¸€ç§æ–°çš„å¥å­åµŒå…¥æ–¹æ³• æ‘˜è¦ï¼šå¥å­åµŒå…¥æ˜¯è‡ªç„¶è¯­è¨€å¤„ç†ï¼ˆNLPï¼‰çš„é‡è¦ç ”ç©¶ä¸»é¢˜ï¼Œå› ä¸ºå®ƒå¯ä»¥å°†çŸ¥è¯†è½¬ç§»åˆ°ä¸‹æ¸¸ä»»åŠ¡ã€‚åŒæ—¶ï¼Œç§°ä¸ºBERTçš„ä¸Šä¸‹æ–‡åŒ–è¯è¡¨ç¤ºåœ¨è®¸å¤šNLPä»»åŠ¡ä¸­éƒ½å®ç°äº†æœ€æ–°çš„æ€§èƒ½ã€‚ç„¶è€Œï¼Œä»åŸºäºBERTçš„å•è¯æ¨¡å‹ç”Ÿæˆé«˜è´¨é‡çš„å¥å­è¡¨ç¤ºæ˜¯ä¸€ä¸ªå¼€æ”¾çš„é—®é¢˜ã€‚å…ˆå‰çš„ç ”ç©¶è¡¨æ˜ï¼ŒBERTçš„ä¸åŒå±‚æ•è·äº†ä¸åŒçš„è¯­è¨€å±æ€§ã€‚è¿™ä½¿æˆ‘ä»¬èƒ½å¤Ÿè·¨å±‚èåˆä¿¡æ¯ä»¥æ‰¾åˆ°æ›´å¥½çš„å¥å­è¡¨ç¤ºå½¢å¼ã€‚åœ¨è¿™é¡¹å·¥ä½œä¸­ï¼Œæˆ‘ä»¬ç ”ç©¶äº†æ·±åº¦ä¸Šä¸‹æ–‡æ¨¡å‹çš„å•è¯è¡¨ç¤ºçš„åˆ†å±‚æ¨¡å¼ã€‚ç„¶åï¼Œé€šè¿‡å¯¹è¯è¡¨ç¤ºæ‰€è·¨è¶Šç©ºé—´çš„å‡ ä½•åˆ†æï¼Œå¯¹åŸºäºBERTçš„è¯æ¨¡å‹è¿›è¡Œè§£å‰–ï¼Œæå‡ºäº†ä¸€ç§æ–°çš„å¥å­åµŒå…¥æ–¹æ³•ã€‚è¿™ç§°ä¸ºSBERT-WKæ–¹æ³•ã€‚ SBERT-WKä¸éœ€è¦è¿›ä¸€æ­¥çš„è®­ç»ƒã€‚æˆ‘ä»¬è¯„ä¼°SBERT-WKåœ¨è¯­ä¹‰æ–‡æœ¬ç›¸ä¼¼æ€§å’Œä¸‹æ¸¸ç›‘ç£ä»»åŠ¡ä¸Šçš„ä½œç”¨ã€‚æ­¤å¤–ï¼Œæå‡ºäº†åä¸ªå¥å­çº§çš„æ¢æŸ¥ä»»åŠ¡ï¼Œä»¥è¿›è¡Œè¯¦ç»†çš„è¯­è¨€åˆ†æã€‚å®éªŒè¡¨æ˜ï¼ŒSBERT-WKå…·æœ‰æœ€å…ˆè¿›çš„æ€§èƒ½ã€‚æˆ‘ä»¬çš„ä»£ç æ˜¯å…¬å¼€å¯ç”¨çš„ã€‚","categories":[{"name":"nlp","slug":"nlp","permalink":"http://iequa.com/categories/nlp/"}],"tags":[{"name":"BERT","slug":"BERT","permalink":"http://iequa.com/tags/BERT/"}]},{"title":"çº¿æ€§ä»£æ•°çš„æœ¬è´¨ - ç³»åˆ—åˆé›†","slug":"nlp/PCA-Matrix","date":"2020-03-11T14:00:21.000Z","updated":"2020-03-15T14:50:56.104Z","comments":true,"path":"2020/03/11/nlp/PCA-Matrix/","link":"","permalink":"http://iequa.com/2020/03/11/nlp/PCA-Matrix/","excerpt":"ã€å®˜æ–¹åŒè¯­/åˆé›†ã€‘çº¿æ€§ä»£æ•°çš„æœ¬è´¨ - ç³»åˆ—åˆé›†","text":"ã€å®˜æ–¹åŒè¯­/åˆé›†ã€‘çº¿æ€§ä»£æ•°çš„æœ¬è´¨ - ç³»åˆ—åˆé›† 01. å‘é‡ç©¶ç«Ÿæ˜¯ä»€ä¹ˆï¼Ÿ02. çº¿æ€§ç»„åˆã€å¼ æˆçš„ç©ºé—´ä¸åŸºç­‰çº¿æ€§ä»£æ•°åŸºç¡€æ¦‚å¿µ03. Matrics as linear transformations çŸ©é˜µä¸çº¿æ€§å˜æ¢çŸ©é˜µä¹˜æ³•çš„æ„ä¹‰å°±æ˜¯ç‰¹å®šçš„å‘é‡è½¬æ¢ (ä¸åŒåæ ‡ç³»çš„å‘é‡è½¬æ¢) Are you ready? 04. Matrix multiplication as composition09. åŸºå˜æ¢ Are you ready? Jenniferâ€™s åæ ‡ç³»çš„åŸºå‘é‡ï¼Œæ˜¯å¦å¤–çš„æ ·å­. (åœ¨æˆ‘ä»¬çš„åæ ‡ç³»ä¸­çš„è¡¨ç¤º) Are you ready? çŸ©é˜µä¹˜æ³•çš„æ„ä¹‰å°±æ˜¯ç‰¹å®šçš„å‘é‡è½¬æ¢ (ä¸åŒåæ ‡ç³»çš„å‘é‡è½¬æ¢) Are you ready? Jenniferâ€™s åæ ‡ç³»çš„ vector ä¸ æˆ‘ä»¬åæ ‡ç³»çš„ vector çš„äº’ç›¸è½¬æ¢ï¼š Are you ready? Are you ready? Reference ã€ç®€åŒ–æ•°æ®ã€‘å¥‡å¼‚å€¼åˆ†è§£(SVD) çº¿æ€§ä»£æ•°çš„â€åŸºâ€æƒ… A1.1:å¥‡å¼‚å€¼åˆ†è§£åˆ°åº•åˆ†è§£äº†å•¥ï¼ˆSVD","categories":[{"name":"nlp","slug":"nlp","permalink":"http://iequa.com/categories/nlp/"}],"tags":[{"name":"BERT","slug":"BERT","permalink":"http://iequa.com/tags/BERT/"}]},{"title":"XLNETï¼š Generalized Autoregressive Pretraining for Language","slug":"nlp/BERT_tutorial_5_post3","date":"2020-02-26T14:00:21.000Z","updated":"2020-03-01T13:31:28.166Z","comments":true,"path":"2020/02/26/nlp/BERT_tutorial_5_post3/","link":"","permalink":"http://iequa.com/2020/02/26/nlp/BERT_tutorial_5_post3/","excerpt":"","text":"Preface Organizationï¼šGoogle Brainã€CMU Timeï¼š19 Jun. 2019 Authorï¼šZhilin Yang, Zihang Dai, Yiming Yangâ€¦ Paperï¼šhttps://arxiv.org/abs/1906.08237 Githubï¼šhttps://github.com/zihangdai/xlnet XLNet å¸¦ç€å¼€æºçš„ä»£ç å’Œ 20 é¡¹ SOTA çš„æˆç»©å‘å¸ƒäº†ã€‚ä» BERT åˆ° XLNetâ€¦ XLNet è¯ç”Ÿä¹‹è·¯ä¸Šæœ€é‡è¦çš„ä¸‰ç¯‡è®ºæ–‡ï¼š Attention Is All You Need (12 Jun. 2017) Transformer-XL: Attentive Language Models Beyond a Fixed-Length Context (9 Jan. 2019) XLNet: Generalized Autoregressive Pretraining for Language Understanding (19 Jun. 2019) 1. Table of Contents Unsupervised Pre-training Autogressive vs Auto-encoding Permutation Language Model (PLM) Two-stream Self Attention Results Bert çš„ç›®æ ‡å‡½æ•°æ¥è‡ª Auto-encodingï¼Œ Bert ä¸¥æ ¼æ¥è¯´æ˜¯ DAE. ELMO ä¸¥æ ¼æ¥è¯´æ— æ³•è§£å†³åŒå‘çš„é—®é¢˜. Permutation Language Model, ä½†æ˜¯æƒ³å°† PLM ç›´æ¥ç”¨åœ¨ Transformer ä¸Šï¼Œä½†æ˜¯è¾¾ä¸åˆ°æˆ‘ä»¬çš„è¦æ±‚. ä¸­é—´å‘ç”Ÿå¾ˆå¤šå°é—®é¢˜ï¼Œæ‰€ä»¥å‡ºç° Two Stream Self Attention. Transformer-XL é•¿æ–‡æœ¬ï¼Œæœ¬è®²ä¸æ¶‰åŠ. å¾ˆåºå¤§çš„è¯é¢˜. 1.1 Pre-training Pre-training æ˜¯è¿ç§»å­¦ä¹ ä¸­å¾ˆé‡è¦çš„ä¸€é¡¹æŠ€æœ¯ã€‚åœ¨NLPä¸­ä¸»è¦ä»¥è¯å‘é‡ä¸ºä¸»ã€‚ å•è¯æˆ‘ä»¬ä¸€èˆ¬ç”¨ä¸¤ç§ä¸åŒçš„æ–¹å¼æ¥è¡¨ç¤ºï¼š one-hot encoding åˆ†å¸ƒå¼è¡¨ç¤ºï¼ˆé€šå¸¸ä¹Ÿå«ä½œè¯å‘é‡/Word2Vecï¼‰ ç”±äºå•è¯æ˜¯æ‰€æœ‰æ–‡æœ¬çš„åŸºç¡€ï¼Œæ‰€ä»¥å¦‚ä½•å»æ›´å¥½åœ°è¡¨ç¤ºå•è¯å˜å¾—å°¤å…¶é‡è¦. é‚£å¦‚ä½•å»ç†è§£é¢„è®­ç»ƒå‘¢ï¼Ÿ ä¸¾ä¸ªä¾‹å­ï¼Œæ¯”å¦‚æˆ‘ä»¬ç”¨BERTè®­ç»ƒäº†ä¸€å¥—æ¨¡å‹ï¼Œè€Œä¸”å·²ç»å¾—åˆ°äº†æ¯ä¸ªå•è¯çš„è¯å‘é‡ï¼Œ é‚£è¿™æ—¶å€™æˆ‘ä»¬å¯ä»¥ç›´æ¥æŠŠè¿™äº›è¯å‘é‡ç”¨åœ¨æˆ‘ä»¬è‡ªå·±çš„ä»»åŠ¡ä¸Šï¼Œä¸ç”¨è‡ªå·±é‡æ–°è®­ç»ƒï¼Œè¿™å°±ç±»ä¼¼äºè¿ç§»å­¦ä¹ çš„æ¦‚å¿µã€‚ é¢„è®­ç»ƒåœ¨é€šå¸¸æƒ…å†µä¸‹æ—¢å¯ä»¥æå‡è®­ç»ƒæ•ˆç‡ä¹Ÿå¯ä»¥æé«˜æ¨¡å‹æ•ˆæœ. 1.2 è¯å‘é‡æŠ€æœ¯ é€šè¿‡è¯å‘é‡æŠ€æœ¯æˆ‘ä»¬å¯ä»¥æŠŠä¸€ä¸ªå•è¯è¡¨ç¤ºä¸ºå‘é‡çš„å½¢å¼ï¼Œç„¶åæ¥ç€åº”ç”¨åœ¨åç»­çš„æ¨¡å‹å½“ä¸­ã€‚æˆ‘ä»¬å¯ä»¥è®¤ä¸ºè¯å‘é‡è¡¨ç¤ºçš„æ˜¯å•è¯çš„è¯­ä¹‰ï¼ˆsemantic)ã€‚ æˆ‘ä»¬å¯ä»¥æŒ‰ç…§ä¸åŒçš„ç±»åˆ«åŒºåˆ†è¯å‘é‡æŠ€æœ¯ã€‚ å¸¸ç”¨çš„è¯å‘é‡æ¨¡å‹æ¯”å¦‚ï¼š SkipGram, CBOW, Glove æ˜¯ä¸è€ƒè™‘ä¸Šä¸‹æ–‡çš„ï¼Œ1ä¸ªå•è¯æœ‰ä¸ªï¼ˆFixedï¼‰çš„å‘é‡ï¼Œä¸ä¾èµ–ä¸Šä¸‹æ–‡æ”¹å˜è€Œæ”¹å˜. ä½†æ˜¯ â€œI back my carâ€å’Œ â€œI hurt my backâ€é‡Œï¼Œå•è¯â€backâ€åœ¨ä¸åŒçš„è¯­å¢ƒä¸‹çš„å«ä¹‰æ˜¯ä¸ä¸€æ ·çš„ ã€‚ è¿‘2ï¼Œ3å¹´å¾ˆå¤šå·¥ä½œçš„é‡ç‚¹æ”¾åœ¨äº†å­¦ä¹ è€ƒè™‘ä¸Šä¸‹æ–‡çš„è¯å‘é‡ã€‚åœ¨è¿™ä¸ªé¢†åŸŸäº§ç”Ÿäº†è¯¸å¤šå¾ˆæœ‰çªç ´æ€§çš„è¿›å±•ï¼Œä»ELMoã€ BERTã€XLNetã€ ALBERTï¼Œæ— ä¸€ä¸æ˜¯ä»¥è¿™ä¸ªä¸ºé‡ç‚¹ã€‚åˆ©ç”¨è¿™äº›æ¨¡å‹ï¼Œæˆ‘ä»¬å¯ä»¥åŠ¨æ€åœ°å»å­¦å‡ºä¸€ä¸ªå•è¯åœ¨ä¸åŒä¸Šä¸‹æ–‡ä¹‹é—´çš„è¯å‘é‡ã€‚å½“ç„¶ï¼Œè¿™äº›å‘é‡åœ¨ä¸åŒçš„è¯­å¢ƒä¸‹çš„è¡¨ç¤ºè‚¯å®šæ˜¯ä¸ä¸€æ ·çš„ 2. Unsupervised Learning 2.1 Unsupervised Pre-Training 2.2 Pre-Training for NLP Non-contextualized techniques Contextualized techniques SkipGram ELMo CBOW BERT Glove XLNET .. ALBERT 3. Autogressive vs Auto-encoding æ·±åº¦å­¦ä¹ åŸºç¡€ï¼šAutoencoders å¼ ä¿Šæ—: XLNet:è¿è¡Œæœºåˆ¶åŠå’ŒBertçš„å¼‚åŒæ¯”è¾ƒ å…³äºBERTçš„è‹¥å¹²é—®é¢˜æ•´ç†è®°å½• BERT Masked LM BERT æ¨¡å‹çš„è¿™ä¸ªé¢„è®­ç»ƒè¿‡ç¨‹å…¶å®å°±æ˜¯åœ¨æ¨¡ä»¿æˆ‘ä»¬å­¦è¯­è¨€çš„è¿‡ç¨‹ï¼Œæ€æƒ³æ¥æºäºå®Œå½¢å¡«ç©ºçš„ä»»åŠ¡ã€‚å…·ä½“æ¥è¯´ï¼Œæ–‡ç« ä½œè€…åœ¨ä¸€å¥è¯ä¸­éšæœºé€‰æ‹© 15% çš„è¯æ±‡ç”¨äºé¢„æµ‹ã€‚å¯¹äºåœ¨åŸå¥ä¸­è¢«æŠ¹å»çš„è¯æ±‡ï¼Œ 80% æƒ…å†µä¸‹é‡‡ç”¨ä¸€ä¸ªç‰¹æ®Šç¬¦å· [MASK] æ›¿æ¢ï¼Œ 10% æƒ…å†µä¸‹é‡‡ç”¨ä¸€ä¸ªä»»æ„è¯æ›¿æ¢ï¼Œå‰©ä½™ 10% æƒ…å†µä¸‹ä¿æŒåŸè¯æ±‡ä¸å˜ã€‚è¿™ä¹ˆåšçš„ä¸»è¦åŸå› æ˜¯ï¼šåœ¨åç»­å¾®è°ƒä»»åŠ¡ä¸­è¯­å¥ä¸­å¹¶ä¸ä¼šå‡ºç° [MASK] æ ‡è®°ï¼Œè€Œä¸”è¿™ä¹ˆåšçš„å¦ä¸€ä¸ªå¥½å¤„æ˜¯ï¼šé¢„æµ‹ä¸€ä¸ªè¯æ±‡æ—¶ï¼Œæ¨¡å‹å¹¶ä¸çŸ¥é“è¾“å…¥å¯¹åº”ä½ç½®çš„è¯æ±‡æ˜¯å¦ä¸ºæ­£ç¡®çš„è¯æ±‡ï¼ˆ 10% æ¦‚ç‡ï¼‰ï¼Œè¿™å°±è¿«ä½¿æ¨¡å‹æ›´å¤šåœ°ä¾èµ–äºä¸Šä¸‹æ–‡ä¿¡æ¯å»é¢„æµ‹è¯æ±‡ï¼Œå¹¶ä¸”èµ‹äºˆäº†æ¨¡å‹ä¸€å®šçš„çº é”™èƒ½åŠ›ã€‚ä¸Šè¿°æåˆ°äº†è¿™æ ·åšçš„ä¸€ä¸ªç¼ºç‚¹ï¼Œå…¶å®è¿™æ ·åšè¿˜æœ‰å¦å¤–ä¸€ä¸ªç¼ºç‚¹ï¼Œå°±æ˜¯æ¯æ‰¹æ¬¡æ•°æ®ä¸­åªæœ‰ 15% çš„æ ‡è®°è¢«é¢„æµ‹ï¼Œè¿™æ„å‘³ç€æ¨¡å‹å¯èƒ½éœ€è¦æ›´å¤šçš„é¢„è®­ç»ƒæ­¥éª¤æ¥æ”¶æ•›ã€‚ BERTæœ‰ä»€ä¹ˆå±€é™æ€§ï¼Ÿ Autogressive vs Auto-encodingï¼š 3.1 Autogressiveæœ€å¤§çš„é—®é¢˜æ˜¯ï¼Œä¸èƒ½åŒæ—¶è€ƒè™‘2è¾¹ New York is a City è€ƒè™‘äº†è¢«é¢„æµ‹å•è¯ä¹‹é—´çš„ç›¸å…³æ€§, ä»æ¦‚ç‡æ¥è®²æ˜¯éå¸¸å®Œå¤‡çš„ 3.2 Auto-encodingNew York is a City ä½ é¢„æµ‹ä½ çš„ï¼Œæˆ‘é¢„æµ‹æˆ‘çš„ï¼Œè¿™ä¸ªé—®é¢˜å¾ˆä¸¥é‡. æ¯”å¦‚â€New York is a cityâ€ï¼Œå‡è®¾æˆ‘ä»¬Maskä½â€Newâ€å’Œâ€Yorkâ€ä¸¤ä¸ªè¯ï¼Œé‚£ä¹ˆç»™å®šâ€is a cityâ€çš„æ¡ä»¶ä¸‹â€Newâ€å’Œâ€Yorkâ€å¹¶ä¸ç‹¬ç«‹ï¼Œå› ä¸ºâ€New Yorkâ€æ˜¯ä¸€ä¸ªå®ä½“ï¼Œçœ‹åˆ°â€Newâ€åˆ™åé¢å‡ºç°â€Yorkâ€çš„æ¦‚ç‡è¦æ¯”çœ‹åˆ°â€Oldâ€åé¢å‡ºç°â€Yorkâ€æ¦‚ç‡è¦å¤§å¾—å¤šã€‚ è¾“å…¥ï¼š Log Angeles is s cityNew York is a city è®­ç»ƒæ—¶å€™ [Mask][Mask] is a city.[Mask][Mask] is a city. è®­ç»ƒæ—¶å€™æ˜¯äº’ç›¸ç‹¬ç«‹çš„ï¼Œæ‰€ä»¥å¯èƒ½é¢„æµ‹å‡ºï¼š New Angeles is a city. å› ä¸ºæˆ‘ä»¬åœ¨ç›®æ ‡å‡½æ•°ä¸­ï¼Œæ²¡æœ‰å°†å•è¯å…³ç³»åˆ—å‡ºæ¥ Independent Assmption Training å’Œ Testing [Mask] token åªå­˜åœ¨äº pre-train è¿‡ç¨‹, çœŸæ­£ä½¿ç”¨æ—¶å€™æ²¡æœ‰ [Mask] fine-tune å’Œ test æ—¶å€™éƒ½æ²¡æœ‰ [Mask] ä¼˜ç‚¹å’Œç¼ºç‚¹æ•´åˆå‡ºä¸€ä¸ªæ–°çš„model: XLNET XLNETAR: Aotoregressive Lanuage Modeling å®ƒæŒ‡çš„æ˜¯ï¼Œä¾æ®å‰é¢(æˆ–åé¢)å‡ºç°çš„tokensæ¥é¢„æµ‹å½“å‰æ—¶åˆ»çš„tokenï¼Œä»£è¡¨æ¨¡å‹æœ‰ELMOã€GTPç­‰ã€‚ ç¼ºç‚¹ï¼šå®ƒåªèƒ½åˆ©ç”¨å•å‘è¯­ä¹‰è€Œä¸èƒ½åŒæ—¶åˆ©ç”¨ä¸Šä¸‹æ–‡ä¿¡æ¯ã€‚ ELMO é€šè¿‡åŒå‘éƒ½åšAR æ¨¡å‹ï¼Œç„¶åè¿›è¡Œæ‹¼æ¥ï¼Œä½†ä»ç»“æœæ¥çœ‹ï¼Œæ•ˆæœå¹¶ä¸æ˜¯å¤ªå¥½ã€‚ ä¼˜ç‚¹ï¼š å¯¹è‡ªç„¶è¯­è¨€ç”Ÿæˆä»»åŠ¡(NLG)å‹å¥½ï¼Œå¤©ç„¶ç¬¦åˆç”Ÿæˆå¼ä»»åŠ¡çš„ç”Ÿæˆè¿‡ç¨‹ã€‚è¿™ä¹Ÿæ˜¯ GPT èƒ½å¤Ÿç¼–æ•…äº‹çš„åŸå› ã€‚ AE: Autoencoding Language Modeling é€šè¿‡ä¸Šä¸‹æ–‡ä¿¡æ¯æ¥é¢„æµ‹å½“å‰è¢«maskçš„tokenï¼Œä»£è¡¨æœ‰BERTã€‚ ç¼ºç‚¹ï¼š ç”±äºè®­ç»ƒä¸­é‡‡ç”¨äº† [MASK] æ ‡è®°ï¼Œå¯¼è‡´é¢„è®­ç»ƒä¸å¾®è°ƒé˜¶æ®µä¸ä¸€è‡´çš„é—®é¢˜ã€‚ æ­¤å¤–å¯¹äºç”Ÿæˆå¼é—®é¢˜ï¼Œ AE æ¨¡å‹ä¹Ÿæ˜¾å¾—æ‰è¥Ÿè§è‚˜ï¼Œè¿™ä¹Ÿæ˜¯ç›®å‰ BERT ä¸ºæ•°ä¸å¤šå®ç°å¤§çš„çªç ´çš„é¢†åŸŸã€‚ ä¼˜ç‚¹ï¼š èƒ½å¤Ÿå¾ˆå¥½çš„ç¼–ç ä¸Šä¸‹æ–‡è¯­ä¹‰ä¿¡æ¯ï¼Œ åœ¨è‡ªç„¶è¯­è¨€ç†è§£(NLU)ç›¸å…³çš„ä¸‹æ¸¸ä»»åŠ¡ä¸Šè¡¨ç°çªå‡ºã€‚ æ—¶é—´å¤ªé•¿ç„¶å -&gt; Sample non-contexuailized techniques eg.skipgram cbow glove contexualized techniques eg.elmo bert xlnet Denoising auto encoder å»å™ªè‡ªåŠ¨ç¼–ç å™¨ï¼Œæ·±åº¦å­¦ä¹ æ¨¡å‹â€”â€”å­¦å‡ºå›¾ç‰‡æˆ–æ•°æ®æ›´æœ‰æ•ˆçš„è¡¨ç¤ºï¼Œ DAEåœ¨è®­ç»ƒä¸­åŠ å…¥å™ªå£°ï¼Œæé«˜æ¨¡å‹å¥å£®æ€§ 2ã€auto_regressive vs auto_encoding è‡ªå›å½’ï¼šelmoï¼Œproduct role ä¼˜ç‚¹ï¼šä¿æŒä¸€è‡´æ€§ï¼Œè€ƒè™‘è¯çš„ä¾èµ–å…³ç³»ï¼›ç¼ºç‚¹ï¼šå•å‘çš„ï¼Œä¸åŒåŒæ—¶è€ƒè™‘åŒè¾¹ è‡ªåŠ¨ç¼–ç ï¼š bert , maskä¸€äº›å•è¯ï¼ŒåŸºæœ¬ç‹¬ç«‹å‡è®¾ bertå­˜åœ¨çš„é—®é¢˜ï¼šindependent assumption ä¼˜ç‚¹ï¼šè€ƒè™‘äº†åŒå‘çš„å…³ç³»ï¼›ç¼ºç‚¹ï¼šéç‹¬ç«‹å‡è®¾ï¼›2ã€trainå’Œ test ä¹‹é—´å­˜åœ¨çš„ä¸ä¸€è‡´æ€§ï¼› 3ã€permutation language model æ’åˆ—è¯­è¨€æ¨¡å‹ åŸºäºelmoè€ƒè™‘åŒå‘é—®é¢˜è¿›è¡Œæ”¹é€ ã€‚answerï¼šconsider all possibel factorization éšæœºé‡‡æ ·ä¸€å®šåºåˆ—ï¼Œattention maskï¼ŒæŠŠè¯çš„é¡ºåºæ··æ’è¿›æ¨¡å‹(ç±»ä¼¼äºæ•°æ®å¢å¼ºï¼Œä¸æ”¹é€ æ¨¡å‹ï¼Œä»æ•°æ®è¾“å…¥ä¸Šæ”¹é€ ï¼‰ï¼› äºŒã€å·²çŸ¥å‘é‡çš„ä¿¡æ¯ï¼ŒçŸ¥é“å‘é‡çš„ä½ç½®ï¼Œç»“åˆä¸¤ä¸ªä¿¡æ¯ QABERT ä¸ºä»€ä¹ˆæœ‰äº› Mask, æœ‰äº›ä¸å˜, æœ‰äº›æ”¹ä¸ºå…¶ä»–word ? Training Bert æ—¶å€™ï¼Œå°† 15% çš„ token å˜ä¸º [Mask Token] 80% (percent 15 ä¸­çš„ 80%) [Mask] -&gt; [Token] é¢„æµ‹å•è¯æœ¬èº« (80%) DAE [Token] -&gt; [Token] å•è¯æœ¬èº«æ¥é¢„æµ‹å•è¯æœ¬èº« AE word1 -&gt; è½¬æ¢ä¸ºå…¶ä»– word2 -&gt; é¢„æµ‹ word1 (éš¾åº¦æ¯”Maskæ›´å¤§) Reference ä»bertåˆ°XLnet è°·æ­Œæ›´å¼ºNLPæ¨¡å‹XLNetå¼€æºï¼š20é¡¹ä»»åŠ¡å…¨é¢ç¢¾å‹BERTï¼ ä»BERT, XLNet, RoBERTaåˆ°ALBERT The Illustrated BERT, ELMo, and co. (How NLP Cracked Transfer Learning)","categories":[{"name":"nlp","slug":"nlp","permalink":"http://iequa.com/categories/nlp/"}],"tags":[{"name":"BERT","slug":"BERT","permalink":"http://iequa.com/tags/BERT/"}]},{"title":"BERT è‚©è†€ä¸Šçš„ NLP æ–°ç§€ï¼š UNILM (æ—¢èƒ½é˜…è¯»åˆèƒ½è‡ªåŠ¨ç”Ÿæˆçš„é¢„è®­ç»ƒæ¨¡å‹)","slug":"nlp/BERT_tutorial_5_post2","date":"2020-02-23T14:00:21.000Z","updated":"2020-02-24T00:47:49.618Z","comments":true,"path":"2020/02/23/nlp/BERT_tutorial_5_post2/","link":"","permalink":"http://iequa.com/2020/02/23/nlp/BERT_tutorial_5_post2/","excerpt":"","text":"UNILM: Unified Language Model Pre-training for Natural Language Understanding and Generation 1. ARä¸AEè¯­è¨€æ¨¡å‹AR: Aotoregressive Lanuage Modeling å®ƒæŒ‡çš„æ˜¯ï¼Œä¾æ®å‰é¢(æˆ–åé¢)å‡ºç°çš„tokensæ¥é¢„æµ‹å½“å‰æ—¶åˆ»çš„tokenï¼Œä»£è¡¨æ¨¡å‹æœ‰ELMOã€GTPç­‰ã€‚ ç¼ºç‚¹ï¼šå®ƒåªèƒ½åˆ©ç”¨å•å‘è¯­ä¹‰è€Œä¸èƒ½åŒæ—¶åˆ©ç”¨ä¸Šä¸‹æ–‡ä¿¡æ¯ã€‚ ELMO é€šè¿‡åŒå‘éƒ½åšAR æ¨¡å‹ï¼Œç„¶åè¿›è¡Œæ‹¼æ¥ï¼Œä½†ä»ç»“æœæ¥çœ‹ï¼Œæ•ˆæœå¹¶ä¸æ˜¯å¤ªå¥½ã€‚ ä¼˜ç‚¹ï¼š å¯¹è‡ªç„¶è¯­è¨€ç”Ÿæˆä»»åŠ¡(NLG)å‹å¥½ï¼Œå¤©ç„¶ç¬¦åˆç”Ÿæˆå¼ä»»åŠ¡çš„ç”Ÿæˆè¿‡ç¨‹ã€‚è¿™ä¹Ÿæ˜¯ GPT èƒ½å¤Ÿç¼–æ•…äº‹çš„åŸå› ã€‚ AE: Autoencoding Language Modeling é€šè¿‡ä¸Šä¸‹æ–‡ä¿¡æ¯æ¥é¢„æµ‹å½“å‰è¢«maskçš„tokenï¼Œä»£è¡¨æœ‰BERTã€‚ ç¼ºç‚¹ï¼š ç”±äºè®­ç»ƒä¸­é‡‡ç”¨äº† [MASK] æ ‡è®°ï¼Œå¯¼è‡´é¢„è®­ç»ƒä¸å¾®è°ƒé˜¶æ®µä¸ä¸€è‡´çš„é—®é¢˜ã€‚ æ­¤å¤–å¯¹äºç”Ÿæˆå¼é—®é¢˜ï¼Œ AE æ¨¡å‹ä¹Ÿæ˜¾å¾—æ‰è¥Ÿè§è‚˜ï¼Œè¿™ä¹Ÿæ˜¯ç›®å‰ BERT ä¸ºæ•°ä¸å¤šå®ç°å¤§çš„çªç ´çš„é¢†åŸŸã€‚ ä¼˜ç‚¹ï¼š èƒ½å¤Ÿå¾ˆå¥½çš„ç¼–ç ä¸Šä¸‹æ–‡è¯­ä¹‰ä¿¡æ¯ï¼Œ åœ¨è‡ªç„¶è¯­è¨€ç†è§£(NLU)ç›¸å…³çš„ä¸‹æ¸¸ä»»åŠ¡ä¸Šè¡¨ç°çªå‡ºã€‚ 2. Transformerå¦‚æˆï¼Œå…¨é Maskä¸ºä»€ä¹ˆTransformerå¯ä»¥å®ç°ä¹±åºè¯­è¨€æ¨¡å‹ï¼Ÿæ˜¯æ€ä¹ˆå®ç°çš„ï¼ŸRNNå¯ä»¥å®ç°å—ï¼Ÿ 1ã€AttentionçŸ©é˜µçš„Maskæ–¹å¼ä¸å„ç§é¢„è®­ç»ƒæ–¹æ¡ˆçš„å…³ç³»ï¼› 2ã€ç›´æ¥åˆ©ç”¨é¢„è®­ç»ƒçš„Bertæ¨¡å‹æ¥åšSeq2Seqä»»åŠ¡ 3. èŠ±å¼é¢„è®­ç»ƒ æ›´å¤šèŠ±æ ·çš„é¢„è®­ç»ƒç©æ³•ã€‚æ¯”å¦‚Bertå°±ç”¨äº†ç§°ä¹‹ä¸ºâ€œæ©ç è¯­è¨€æ¨¡å‹ï¼ˆMasked Language Modelï¼‰â€çš„æ–¹å¼æ¥é¢„è®­ç»ƒï¼Œä¸è¿‡è¿™åªæ˜¯æ™®é€šè¯­è¨€æ¨¡å‹çš„ä¸€ç§å˜ä½“ï¼›è¿˜æœ‰XLNetåˆ™æå‡ºäº†æ›´å½»åº•çš„â€œPermutation Language Modelingâ€ï¼Œæˆ‘ä»¬å¯ä»¥ç§°ä¹‹ä¸ºâ€œä¹±åºè¯­è¨€æ¨¡å‹â€ï¼›è¿˜æœ‰UNILMæ¨¡å‹ï¼Œç›´æ¥ç”¨å•ä¸ªBertçš„æ¶æ„åšSeq2Seqï¼Œä½ å¯ä»¥å°†å®ƒä½œä¸ºä¸€ç§é¢„è®­ç»ƒæ‰‹æ®µï¼Œåˆæˆ–è€…å¹²è„†å°±ç”¨å®ƒæ¥åšSeq2Seqä»»åŠ¡â€¦ 4. å•å‘è¯­è¨€æ¨¡å‹5. ä¹±åºè¯­è¨€æ¨¡å‹6. Seq2Seqç°åœ¨åˆ°æˆ‘ä»¬çš„â€œé‡å¤´æˆâ€äº†ï¼šå°†Bertç­‰Transformeræ¶æ„è·ŸSeq2Seqç»“åˆèµ·æ¥ã€‚ä¸ºä»€ä¹ˆè¯´é‡å¤´æˆå‘¢ï¼Ÿå› ä¸ºåŸåˆ™ä¸Šæ¥è¯´ï¼Œä»»ä½•NLPé—®é¢˜éƒ½å¯ä»¥è½¬åŒ–ä¸ºSeq2Seqæ¥åšï¼Œå®ƒæ˜¯ä¸€ä¸ªçœŸæ­£æ„ä¹‰ä¸Šçš„ä¸‡èƒ½æ¨¡å‹ã€‚æ‰€ä»¥å¦‚æœèƒ½å¤Ÿåšåˆ°Seq2Seqï¼Œç†è®ºä¸Šå°±å¯ä»¥å®ç°ä»»æ„ä»»åŠ¡äº†ã€‚ å°†Bertä¸Seq2Seqç»“åˆçš„æ¯”è¾ƒçŸ¥åçš„å·¥ä½œæœ‰ä¸¤ä¸ªï¼šMASS å’Œ UNILMï¼Œä¸¤è€…éƒ½æ˜¯å¾®è½¯çš„å·¥ä½œ MASS è¿˜æ˜¯æ™®é€šçš„Seq2Seqæ¶æ„ï¼Œåˆ†åˆ«ç”¨Bertç±»ä¼¼çš„Transformeræ¨¡å‹æ¥åšencoderå’Œdecoderï¼Œå®ƒçš„ä¸»è¦è´¡çŒ®å°±æ˜¯æä¾›äº†ä¸€ç§Seq2Seqæ€æƒ³çš„é¢„è®­ç»ƒæ–¹æ¡ˆï¼› UNILMï¼Œå®ƒæä¾›äº†ä¸€ç§å¾ˆä¼˜é›…çš„æ–¹å¼ï¼Œèƒ½å¤Ÿè®©æˆ‘ä»¬ç›´æ¥ç”¨å•ä¸ªBertæ¨¡å‹å°±å¯ä»¥åšSeq2Seqä»»åŠ¡ï¼Œè€Œä¸ç”¨åŒºåˆ†encoderå’Œdecoderã€‚è€Œå®ç°è¿™ä¸€ç‚¹å‡ ä¹ä¸è´¹å¹ç°ä¹‹åŠ›â€”â€”åªéœ€è¦ä¸€ä¸ªç‰¹åˆ«çš„Maskã€‚ 7. UniLMä»‹ç» æ¨¡å‹æ¶æ„ä¸å®éªŒè®¾ç½®: Reference ç«™åœ¨BERTè‚©è†€ä¸Šçš„NLPæ–°ç§€ä»¬(PART II) ä»è¯­è¨€æ¨¡å‹åˆ°Seq2Seqï¼šTransformerå¦‚æˆï¼Œå…¨é Mask UniLM:ä¸€ç§æ—¢èƒ½é˜…è¯»åˆèƒ½è‡ªåŠ¨ç”Ÿæˆçš„é¢„è®­ç»ƒæ¨¡å‹","categories":[{"name":"nlp","slug":"nlp","permalink":"http://iequa.com/categories/nlp/"}],"tags":[{"name":"BERT","slug":"BERT","permalink":"http://iequa.com/tags/BERT/"}]},{"title":"BERT è‚©è†€ä¸Šçš„ NLP æ–°ç§€ï¼š ERNIE","slug":"nlp/BERT_tutorial_5_post1","date":"2020-02-23T10:00:21.000Z","updated":"2020-02-23T13:53:02.179Z","comments":true,"path":"2020/02/23/nlp/BERT_tutorial_5_post1/","link":"","permalink":"http://iequa.com/2020/02/23/nlp/BERT_tutorial_5_post1/","excerpt":"","text":"Prefaceå»å¹´NLPé¢†åŸŸæœ€ç«çš„è«è¿‡äºBERTäº†ï¼Œå¾—ç›Šäºæ•°æ®è§„æ¨¡å’Œè®¡ç®—åŠ›çš„æå‡ã€‚ BERTåœ¨å¤§ä¼šè§„æ¨¡è¯­æ–™ä¸Šé¢„è®­ç»ƒï¼ˆMasked Language Model + Next Sentence Predictionï¼‰ ä¹‹åå¯ä»¥å¾ˆå¥½åœ°ä»è®­ç»ƒè¯­æ–™ä¸­æ•è·ä¸°å¯Œçš„è¯­ä¹‰ä¿¡æ¯ï¼Œå¯¹å„é¡¹ä»»åŠ¡ç–¯ç‹‚å± æ¦œã€‚ No. Name Full_Name 1 ERNIE from Baidu Enhanced Representation through Knowledge Integrationï¼ˆBaidu/2019ï¼‰ 2 ERNIE from THU Enhanced Language Representation with Informative Entitiesï¼ˆTHU/ACL2019ï¼‰ Basic-Level Maskingã€Phrase-Level Maskingã€ Entity-Level Masking XLNetåšäº†äº›ä»€ä¹ˆ? å…¶å®ä»å¦å¤–ä¸€ä¸ªè§’åº¦æ›´å¥½ç†è§£XLNetçš„åˆè¡·å’Œåšæ³•ï¼Œæˆ‘è§‰å¾—è¿™ä¸ªä¼°è®¡æ˜¯XLNetä½œè€…çœŸæ­£çš„æ€è€ƒå‡ºå‘ç‚¹ï¼Œæ˜¯å•¥å‘¢ï¼Ÿå°±æ˜¯è¯´è‡ªå›å½’è¯­è¨€æ¨¡å‹æœ‰ä¸ªç¼ºç‚¹ï¼Œè¦ä¹ˆä»å·¦åˆ°å³ï¼Œè¦ä¹ˆä»å³åˆ°å·¦ï¼Œå°½ç®¡å¯ä»¥ç±»ä¼¼ELMOä¸¤ä¸ªéƒ½åšï¼Œç„¶åå†æ‹¼æ¥çš„æ–¹å¼ã€‚ä½†æ˜¯è·ŸBertæ¯”ï¼Œæ•ˆæœæ˜æ˜¾ä¸è¶³å¤Ÿå¥½ï¼ˆè¿™é‡Œé¢æœ‰RNNå¼±äºTransformerçš„å› ç´ ï¼Œä¹Ÿæœ‰åŒå‘è¯­è¨€æ¨¡å‹æ€ä¹ˆåšçš„å› ç´ ï¼‰ã€‚é‚£ä¹ˆï¼Œèƒ½ä¸èƒ½ç±»ä¼¼Berté‚£æ ·ï¼Œæ¯”è¾ƒå……åˆ†åœ°åœ¨è‡ªå›å½’è¯­è¨€æ¨¡å‹ä¸­ï¼Œå¼•å…¥åŒå‘è¯­è¨€æ¨¡å‹å‘¢ï¼Ÿå› ä¸ºBertå·²ç»è¯æ˜äº†è¿™æ˜¯éå¸¸å…³é”®çš„ä¸€ç‚¹ã€‚è¿™ä¸€ç‚¹ï¼Œæƒ³æ³•ç®€å•ï¼Œä½†æ˜¯çœ‹ä¸Šå»è²Œä¼¼ä¸å¤ªå¥½åšï¼Œå› ä¸ºä»å·¦å‘å³çš„è¯­è¨€æ¨¡å‹ï¼Œå¦‚æœæˆ‘ä»¬å½“å‰æ ¹æ®ä¸Šæ–‡ï¼Œè¦é¢„æµ‹æŸä¸ªå•è¯Tiï¼Œé‚£ä¹ˆçœ‹ä¸Šå»å®ƒæ²¡æ³•çœ‹åˆ°ä¸‹æ–‡çš„å†…å®¹ã€‚å…·ä½“æ€ä¹ˆåšæ‰èƒ½è®©è¿™ä¸ªæ¨¡å‹ï¼šçœ‹ä¸Šå»ä»ç„¶æ˜¯ä»å·¦å‘å³çš„è¾“å…¥å’Œé¢„æµ‹æ¨¡å¼ï¼Œä½†æ˜¯å…¶å®å†…éƒ¨å·²ç»å¼•å…¥äº†å½“å‰å•è¯çš„ä¸‹æ–‡ä¿¡æ¯å‘¢ï¼ŸXLNetåœ¨æ¨¡å‹æ–¹é¢çš„ä¸»è¦è´¡çŒ®å…¶å®æ˜¯åœ¨è¿™é‡Œã€‚ Reference å¼ ä¿Šæ—: Bertæ—¶ä»£çš„åˆ›æ–°ï¼šBertåº”ç”¨æ¨¡å¼æ¯”è¾ƒåŠå…¶å®ƒ å¼ ä¿Šæ—: Bertæ—¶ä»£çš„åˆ›æ–°ï¼ˆåº”ç”¨ç¯‡ï¼‰ï¼šBertåœ¨NLPå„é¢†åŸŸçš„åº”ç”¨è¿›å±• å¼ ä¿Šæ—: XLNet:è¿è¡Œæœºåˆ¶åŠå’ŒBertçš„å¼‚åŒæ¯”è¾ƒ ç«™åœ¨BERTè‚©è†€ä¸Šçš„NLPæ–°ç§€ä»¬ï¼ˆPART Iï¼‰ ç«™åœ¨BERTè‚©è†€ä¸Šçš„NLPæ–°ç§€ä»¬(PART II) ä»è¯­è¨€æ¨¡å‹åˆ°Seq2Seqï¼šTransformerå¦‚æˆï¼Œå…¨é Mask","categories":[{"name":"nlp","slug":"nlp","permalink":"http://iequa.com/categories/nlp/"}],"tags":[{"name":"BERT","slug":"BERT","permalink":"http://iequa.com/tags/BERT/"}]},{"title":"base Singapore","slug":"data-analysis/ana","date":"2020-02-17T10:28:21.000Z","updated":"2021-06-14T05:16:52.518Z","comments":true,"path":"2020/02/17/data-analysis/ana/","link":"","permalink":"http://iequa.com/2020/02/17/data-analysis/ana/","excerpt":"Apply online","text":"Apply online date functionbtwæˆ‘å¿˜è¯´äº†oaå¤ä¹ pandasçš„æ—¶å€™å¤šçœ‹çœ‹datefunctionæ˜¯è€ƒæŸ¥é‡ç‚¹ï½ 1ï¼Œ HR callï¼Œç®€å•äº†è§£å·¥ä½œç»éªŒï¼Œé—®èŠä¸äº†è§£shopeeï¼Œä»‹ç»éƒ¨é—¨ã€‚2ï¼ŒOnline testï¼Œ Python+SQL3ï¼Œteam managerï¼šè‡ªæˆ‘ä»‹ç»+case study4, team lead: è‡ªæˆ‘ä»‹ç»+case study5, department lead: è‡ªæˆ‘ä»‹ç»+case study ç¬”è¯•ä¸¤å¥—é¢˜ç›®ï¼Œä¸€å¥—SQLï¼Œä¸€å¥—PythonSQL 6ä¸ªé¢˜Pythonä¸»è¦è€ƒpandasï¼Œ13ä¸ªé¢˜å„30åˆ†é’Ÿï¼Œå¯ä»¥ä¸Šç½‘æœæ¸£æ¸£çš„æˆ‘Pythonæ ¹æœ¬æ²¡åšå®Œï¼Œæœç„¶ä¸Šç­ä¸ç”¨çš„æ˜¯ä¸€å®šä¼šæ‰‹ç”Ÿçš„â€¦â€¦ æ²¡å’æˆç„¶åè·Ÿä¸¤ä¸ªteam leaderè¿œç¨‹ä¸€é¢äº† å…¨è‹±æ–‡ ç°åœ¨æ—¥å¸¸å·¥ä½œï¼Œå¤„ç†çš„metricså’Œæ•´ä½“æ•°æ®é‡ï¼Œè®²ä¸€ä¸ªåšè¿‡çš„é¡¹ç›® Pythonï¼Œæˆ‘è¯´æˆ‘ç¬”è¯•æ²¡åšå®Œç°åœ¨å·¥ä½œä¹Ÿä¸å¸¸ç”¨å¾ˆæ¸£ç„¶åå°±æ²¡æ€ä¹ˆè¢«é—®ï¼Œå¥¹ä»¬é—®é‚£å’‹è¯æ˜æˆ‘åé¢èƒ½è·Ÿå¾—ä¸Šå·¥ä½œâ€¦æˆ‘è¯´æˆ‘ä¹Ÿä¸çŸ¥é“â€¦ SQL,æ²¡è®©å†™ä»£ç ï¼Œæ„Ÿè§‰å°±æ˜¯åæ¦‚å¿µçš„è½¯æŠ€æœ¯ UNION,UNION ALL, MINUS, INTERSECTåˆ†åˆ«è§£é‡Š æœ‰ä¸€ä¸ªè¡¨åœ¨æ•°æ®åº“é‡Œå·²å­˜åœ¨ï¼Œå¦‚ä½•å¤åˆ¶ HAVINGå’ŒWHEREçš„åŒºåˆ« è¿˜æœ‰ä¸ªå•¥æˆ‘å¿˜è®°äº†â€¦ case studyï¼Œä½†æ˜¯ä¸éœ€è¦å…·ä½“æ•°æ®ï¼Œç®—æ˜¯behavior question A/B testingåŸºæœ¬æ­¥éª¤å’Œæ¦‚å¿µ base Singaporeï¼Œåœ¨å®˜ç½‘ç”³è¯·çš„ï¼Œå¤§çº¦ä¸€å‘¨åæ”¶åˆ°ä¸€é¢é€šçŸ¥ï¼Œé¢è¯•å®˜å¾ˆå¥½ï¼Œæ˜¯ä¸ªä¸­å›½å°å§å§ï¼Œå…¨è‹±æ–‡é¢è¯• åˆšæ”¶åˆ°é‚®ä»¶ï¼Œ1ä¸ªå¤šå°æ—¶çš„Python + SQL æµ‹è¯•ï¼Œè¦æ±‚ä¸‹è½½pycharmï¼Œç”¨pandaså¤„ç†ä»–ä»¬çš„excelï¼Œï¼Œï¼Œ ç”¨pandaså¤„ç†ä»–ä»¬çš„excelï¼Œsqlå†™å…­ä¸ªè¯­å¥ 1st round phone interview with HR, ask general background, your project, and experience2nd round testing Basic SQL, python questions for two hours, send the answer back after you finished. Ask you to write python code the organize their data Interview Questions analye some data use SQL and python 4 rounds in total. (1) HR for brief chat - simple (2) Technical test using SQL and Python (3) Interview with one of the team lead - this round they will give you a excel and some time to do basic analysis (4) Interview with team manager / lead - more of behavioral and fitting Should you not pass in any of the rounds for the role you applied, HR who see you as potential candidate may direct you to other HR managers for other roles consideration and you will need to go through the whole interview process again. I went through the second round of another role and eventually decided not to take up the role. Something to note is that you are expected to have mandarin competency (i.e. speak business in Chinese) and you may be expected to liaise in mandarin with Chinese counterparts (offshore developers) Interview Questions SQL questions and tell me what you analyze phone interviewfrom HR, and it took about 30 mins SQL assessmentfrom direct boss, and gave you two days behavioralfrom direct manager, took about 20 mins case interviewfrom direct manager, took about 1 hour HR interview -&gt;code test-&gt;result, code test includes python and sql. python is not that hard, but sql is hard. HR is very nice that she would introduce their department and products, which let you know more about their service. Coding round tested on dataframes: filtering, multi-conditional filtering, and also general theory on programming and Python HR interview asked the standard questions: why Shopee, why data analytics, where do you see yourself in 5 years 7. Data Analyst in SingaporeApplicationI applied through a recruiter. The process took 2 weeks. I interviewed at Shopee Singapore in May 2020. InterviewThe 1st round is a HR interview (less than 30 minutes). HR will ask you general question such as why do you want to apply to Shopee, and do you know what shopee is. The 2nd round interview is SQL and python test. It is a 1.5 hours online test in which contains 17 questions. There are probably 10 multiple choice questions, 3 SQL coding questions, 4 basic python questions. The SQL coding questions test you on basic SQL coding concept, such as SELECT, JOINS while the python questions test you on understanding about the python pandas package (understanding how datatime and df.groupby is used). If you are an amateur coders who refers to python manual often, you will find yourself not being able to complete those questions. I believe, in order to pass this test, you need to score close to full marks. I wasnâ€™t able to complete the test as i encounter some technical issue on the syntax part of the code in which i wasnâ€™t able to ask for help since itâ€™s an online test (due to COVID-19 situation). I believed i scored around 10-11/17 for my test, which is not enough to move on in the next part of the interview. So in conclusion, Shopee expects you to score close to full marks on your SQL, python test. If you fail to do so, you can forget about moving further in the interview. 8 machine learningCalled by HR &amp; explained the process of selection. The coding test too, data cleaning, data extraction &amp; use of machine learning. Given task had a huge data set 150,000 rows and 10 columns with 3 labels Reference Shopee Risk Data Analyst æ±‚èŒé¢è¯•åˆ†äº« [2019.07.28] æ•°æ®åˆ†æå²—é¢è¯•ç¬”è¯•é¢˜æ±‡æ€» glassdoor daæ–°é²œè™¾çš®æŒ‚ç» é¦–é¡µ &gt; ç¬”ç»é¢ç» &gt; shopeeå‡‰ç» æ•°æ®åˆ†æå²—Pythonç¬”è¯•é¢˜ æ•°æ®åˆ†æé¢è¯•é¢˜ä¹‹Pandasä¸­çš„groupby","categories":[{"name":"data-analysis","slug":"data-analysis","permalink":"http://iequa.com/categories/data-analysis/"}],"tags":[{"name":"ITFIN","slug":"ITFIN","permalink":"http://iequa.com/tags/ITFIN/"}]},{"title":"BERT tutorial 4","slug":"nlp/BERT_tutorial_4_Summary","date":"2020-02-16T03:00:21.000Z","updated":"2020-02-16T15:18:03.782Z","comments":true,"path":"2020/02/16/nlp/BERT_tutorial_4_Summary/","link":"","permalink":"http://iequa.com/2020/02/16/nlp/BERT_tutorial_4_Summary/","excerpt":"","text":"2018.10 google å‘å¸ƒ BERT æ¨¡å‹. å¼•çˆ†æ•´ä¸ªAIåœˆçš„ NLP æ¨¡å‹. åœ¨ NLPé¢†åŸŸ åˆ·æ–° 11 é¡¹è®°å½•. BERT å…¶å®æ˜¯ language_encoderï¼ŒæŠŠè¾“å…¥çš„ sentence æˆ– paragraph è½¬æˆ embedding. Paper: BERT: Pre-training of Deep Bidirectional Transformers for Language Understanding BERT æå‡ºä¸€å¥—å®Œæ•´çš„æ–¹æ¡ˆï¼Œåˆ©ç”¨ä¹‹å‰æœ€æ–°çš„ modelï¼Œå»è§£å†³å„ç§å„æ ·çš„ NLP Tasks. 1. ç®€ä»‹BERT: Pre-training of Deep Bidirectional Transformers for Language Understanding. 2. åŸç†ç¯‡æœ¬ç« å°†ä¼šå…ˆç»™å¤§å®¶ä»‹ç»BERTçš„æ ¸å¿ƒtransformerï¼Œè€Œtransformeråˆæ˜¯ç”±attentionç»„åˆè€Œæˆ. 2.1 Attentionæœºåˆ¶è®²è§£ è‹ç¥ã€ŠAttention is All You Needã€‹æµ…è¯»ï¼ˆç®€ä»‹+ä»£ç ï¼‰ Attentionæœºåˆ¶è®²è§£ å¼ ä¿Šæ—: æ·±åº¦å­¦ä¹ ä¸­çš„æ³¨æ„åŠ›æ¨¡å‹ï¼ˆ2017ç‰ˆï¼‰ 2.2 Transrofmeræ¨¡å‹è®²è§£ Transformeræ¨¡å‹è¯¦è§£ BERTå¤§ç«å´ä¸æ‡‚Transformerï¼Ÿè¯»è¿™ä¸€ç¯‡å°±å¤Ÿäº† Jay Alammarâ€™s Blog Transformer The Illustrated Transformerã€è¯‘ã€‘ 2.3 BERTåŸç† å›¾ç¤ºè¯¦è§£BERTæ¨¡å‹çš„è¾“å…¥ä¸è¾“å‡º More Readingï¼š å¼ ä¿Šæ—: ä»Word Embeddingåˆ°Bertæ¨¡å‹â€”è‡ªç„¶è¯­è¨€å¤„ç†ä¸­çš„é¢„è®­ç»ƒæŠ€æœ¯å‘å±•å² å¼ ä¿Šæ—: æ”¾å¼ƒå¹»æƒ³ï¼Œå…¨é¢æ‹¥æŠ±Transformerï¼šä¸‰å¤§ç‰¹å¾æŠ½å–å™¨ï¼ˆCNN/RNN/TFï¼‰æ¯”è¾ƒ 3. ä»£ç ç¯‡4. å®è·µç¯‡ å½“Berté‡ä¸ŠKerasï¼šè¿™å¯èƒ½æ˜¯Bertæœ€ç®€å•çš„æ‰“å¼€å§¿åŠ¿ hanxiao/bert-as-service PaperWeekly: ä¸¤è¡Œä»£ç ç©è½¬Google BERTå¥å‘é‡è¯å‘é‡ Reference ä¸€æ­¥æ­¥ç†è§£BERT ä»è¯­è¨€æ¨¡å‹åˆ°Seq2Seqï¼šTransformerå¦‚æˆï¼Œå…¨é Mask BERTå®Œå…¨æŒ‡å—","categories":[{"name":"nlp","slug":"nlp","permalink":"http://iequa.com/categories/nlp/"}],"tags":[{"name":"BERT","slug":"BERT","permalink":"http://iequa.com/tags/BERT/"}]},{"title":"RDDã€DataFrameå’ŒDataSetçš„åŒºåˆ«","slug":"spark/spark-rdd-ds-df","date":"2020-01-03T07:28:21.000Z","updated":"2021-01-04T02:06:30.423Z","comments":true,"path":"2020/01/03/spark/spark-rdd-ds-df/","link":"","permalink":"http://iequa.com/2020/01/03/spark/spark-rdd-ds-df/","excerpt":"","text":"1. RDDå’ŒDataFrameå·¦ä¾§çš„RDD[Person]è™½ç„¶ä»¥Personä¸ºç±»å‹å‚æ•°ï¼ŒSparkæ¡†æ¶æœ¬èº«ä¸äº†è§£Personç±»çš„å†…éƒ¨ç»“æ„ã€‚è€Œå³ä¾§çš„DataFrameå´æä¾›äº†è¯¦ç»†çš„ç»“æ„ä¿¡æ¯. ä½¿å¾—Spark SQLå¯ä»¥æ¸…æ¥šåœ°çŸ¥é“è¯¥æ•°æ®é›†ä¸­åŒ…å«å“ªäº›åˆ—ï¼Œæ¯åˆ—çš„åç§°å’Œç±»å‹å„æ˜¯ä»€ä¹ˆã€‚DataFrameå¤šäº†æ•°æ®çš„ç»“æ„ä¿¡æ¯ï¼Œå³schemaã€‚ RDDæ˜¯åˆ†å¸ƒå¼çš„Javaå¯¹è±¡çš„é›†åˆã€‚ DataFrameæ˜¯åˆ†å¸ƒå¼çš„Rowå¯¹è±¡çš„é›†åˆã€‚ DataFrameé™¤äº†æä¾›äº†æ¯”RDDæ›´ä¸°å¯Œçš„ç®—å­ä»¥å¤–ï¼Œæ›´é‡è¦çš„ç‰¹ç‚¹æ˜¯æå‡æ‰§è¡Œæ•ˆç‡ã€å‡å°‘æ•°æ®è¯»å–ä»¥åŠæ‰§è¡Œè®¡åˆ’çš„ä¼˜åŒ–ï¼Œæ¯”å¦‚filterä¸‹æ¨ã€è£å‰ªç­‰ã€‚ 2. DF æå‡æ‰§è¡Œæ•ˆç‡RDD APIæ˜¯å‡½æ•°å¼çš„ï¼Œå¼ºè°ƒä¸å˜æ€§ï¼Œåœ¨å¤§éƒ¨åˆ†åœºæ™¯ä¸‹å€¾å‘äºåˆ›å»ºæ–°å¯¹è±¡è€Œä¸æ˜¯ä¿®æ”¹è€å¯¹è±¡ã€‚ Spark SQLåœ¨æ¡†æ¶å†…éƒ¨å·²ç»åœ¨å„ç§å¯èƒ½çš„æƒ…å†µä¸‹ å°½é‡é‡ç”¨å¯¹è±¡ï¼Œè¿™æ ·åšè™½ç„¶åœ¨å†…éƒ¨ä¼šæ‰“ç ´äº†ä¸å˜æ€§ï¼Œä½†åœ¨å°†æ•°æ®è¿”å›ç»™ç”¨æˆ·æ—¶ï¼Œè¿˜ä¼šé‡æ–°è½¬ä¸ºä¸å¯å˜æ•°æ®ã€‚ åˆ©ç”¨ DataFrame APIè¿›è¡Œå¼€å‘ï¼Œå¯ä»¥å…è´¹åœ°äº«å—åˆ°è¿™äº›ä¼˜åŒ–æ•ˆæœã€‚ 3. DF å‡å°‘æ•°æ®è¯»å–åˆ†æå¤§æ•°æ®ï¼Œæœ€å¿«çš„æ–¹æ³•å°±æ˜¯ â€”â€”å¿½ç•¥å®ƒã€‚è¿™é‡Œçš„â€œå¿½ç•¥â€å¹¶ä¸æ˜¯ç†Ÿè§†æ— ç¹ï¼Œè€Œæ˜¯æ ¹æ®æŸ¥è¯¢æ¡ä»¶è¿›è¡Œæ°å½“çš„å‰ªæ ä¸Šæ–‡è®¨è®ºåˆ†åŒºè¡¨æ—¶æåˆ°çš„ åˆ†åŒºå‰ªæ ä¾¿æ˜¯å…¶ä¸­ä¸€ç§ -&gt; å½“æŸ¥è¯¢çš„è¿‡æ»¤æ¡ä»¶ä¸­æ¶‰åŠåˆ°åˆ†åŒºåˆ—æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥æ ¹æ®æŸ¥è¯¢æ¡ä»¶å‰ªæ‰è‚¯å®šä¸åŒ…å«ç›®æ ‡æ•°æ®çš„åˆ†åŒºç›®å½•ï¼Œä»è€Œå‡å°‘IO Spark SQLä¹Ÿå¯ä»¥å……åˆ†åˆ©ç”¨RCFileã€ORCã€Parquetç­‰åˆ—å¼å­˜å‚¨æ ¼å¼çš„ä¼˜åŠ¿ï¼Œä»…æ‰«ææŸ¥è¯¢çœŸæ­£æ¶‰åŠçš„åˆ—ï¼Œå¿½ç•¥å…¶ä½™åˆ—çš„æ•°æ®ã€‚ 4. RDDå’ŒDataSet DataSetä»¥Catalysté€»è¾‘æ‰§è¡Œè®¡åˆ’è¡¨ç¤ºï¼Œå¹¶ä¸”æ•°æ®ä»¥ç¼–ç çš„äºŒè¿›åˆ¶å½¢å¼è¢«å­˜å‚¨ï¼Œä¸éœ€è¦ååºåˆ—åŒ–å°±å¯ä»¥æ‰§è¡Œsortingã€shuffleç­‰æ“ä½œã€‚ DataSetåˆ›ç«‹éœ€è¦ä¸€ä¸ªæ˜¾å¼çš„Encoderï¼ŒæŠŠå¯¹è±¡åºåˆ—åŒ–ä¸ºäºŒè¿›åˆ¶ï¼Œå¯ä»¥æŠŠå¯¹è±¡çš„schemeæ˜ å°„ä¸ºSpark SQlç±»å‹ï¼Œç„¶è€ŒRDDä¾èµ–äºè¿è¡Œæ—¶åå°„æœºåˆ¶ã€‚ 5. DataFrameå’ŒDataSet Datasetå¯ä»¥è®¤ä¸ºæ˜¯DataFrameçš„ç‰¹ä¾‹ï¼ŒåŒºåˆ«æ˜¯Datasetæ¯ä¸€ä¸ªrecordå­˜å‚¨çš„æ˜¯ä¸€ä¸ªå¼ºç±»å‹å€¼è€Œä¸æ˜¯ä¸€ä¸ªRow DataSetå¯ä»¥åœ¨ç¼–è¯‘æ—¶æ£€æŸ¥ç±»å‹ æ˜¯é¢å‘å¯¹è±¡çš„ç¼–ç¨‹æ¥å£ DataFrameä¼šç»§æ‰¿DataSetï¼ŒDataFrameæ˜¯é¢å‘Spark SQLçš„æ¥å£ //DataSet,å®Œå…¨ä½¿ç”¨scalaç¼–ç¨‹ï¼Œä¸è¦åˆ‡æ¢åˆ°DataFrameval wordCount = ds.flatMap(_.split(&quot; &quot;)) .filter(_ != &quot;&quot;) .groupBy(_.toLowerCase()) // Instead of grouping on a column expression (i.e. $&quot;value&quot;) we pass a lambda function .count() DataFrame // Load a text file and interpret each line as a java.lang.Stringval ds = sqlContext.read.text(&quot;/home/spark/1.6/lines&quot;).as[String]val result = ds .flatMap(_.split(&quot; &quot;)) // Split on whitespace .filter(_ != &quot;&quot;) // Filter empty words .toDF() // Convert to DataFrame to perform aggregation / sorting .groupBy($&quot;value&quot;) // Count number of occurences of each word .agg(count(&quot;*&quot;) as &quot;numOccurances&quot;) .orderBy($&quot;numOccurances&quot; desc) // Show most common words first Reference ç”¨Apache Sparkè¿›è¡Œå¤§æ•°æ®å¤„ç†â€”â€”ç¬¬äºŒéƒ¨åˆ†ï¼šSpark SQL RDDã€DataFrameå’ŒDataSetçš„åŒºåˆ«","categories":[{"name":"spark","slug":"spark","permalink":"http://iequa.com/categories/spark/"}],"tags":[{"name":"spark","slug":"spark","permalink":"http://iequa.com/tags/spark/"}]},{"title":"Pycharm Keyboard Shortcutsï¼ˆMacï¼‰","slug":"python/tools/PyCharm","date":"2019-12-22T09:00:21.000Z","updated":"2020-12-06T06:17:17.904Z","comments":true,"path":"2019/12/22/python/tools/PyCharm/","link":"","permalink":"http://iequa.com/2019/12/22/python/tools/PyCharm/","excerpt":"","text":"1. Pycharm No. Shortcuts Function 1. Shift + option + Enter auto import 2. CMD + Opt + t try/catch 1 CMD + B è·³è½¬åˆ°å£°æ˜å¤„ï¼ˆcmdåŠ é¼ æ ‡ï¼‰ 2 CMD + [] å…‰æ ‡ä¹‹å‰/åçš„ä½ç½® 3 SHIFT + CMD + F , å…¨å±€æœç´¢ âœ”ï¸ 4 CMD + R / SHIFT + CMD + R å½“å‰æ–‡ä»¶æ›¿æ¢ / å…¨å±€æ›¿æ¢ 5 CMD + L , æŒ‡å®šè¡Œæ•°è·³è½¬ âœ”ï¸ 6 SHIFT + ENTER , ç›´æ¥åˆ°ä¸‹ä¸€è¡Œ âœ”ï¸ 7 ALT + ENTER , auto-import âœ”ï¸ 8 CMD +/- / SHIFT CMD +/- å±•å¼€å½“å‰ / å±•å¼€æ‰€æœ‰ 9 OPT + CMD + l ä»£ç å—å¯¹é½ 10 CMD + D åœ¨ä¸‹ä¸€è¡Œå¤åˆ¶æœ¬è¡Œçš„å†…å®¹ å·²ç†Ÿç»ƒ - - 1 CMD / æ³¨é‡Š/å–æ¶ˆæ³¨é‡Šä¸€è¡Œ 2 CMD + X/C å¤åˆ¶å…‰æ ‡å½“å‰è¡Œ,å‰ªåˆ‡åŒç† 3 CMD + F å½“å‰æ–‡ä»¶æœç´¢ï¼ˆå›è½¦ä¸‹ä¸€ä¸ª shiftå›è½¦ä¸Šä¸€ä¸ªï¼‰ 4 CMD + F6 æ›´æ”¹å˜é‡ ç»“æ„æ€§ 1 CMD + O / SHIFT + CMD + O / OPT + CMD + O æœç´¢ class / files / ç¬¦å·ï¼ˆå‡½æ•°ç­‰) 2 CTR + Tab å²ä¸Šæœ€NBçš„å¯¼èˆªçª—å£ 1. å·¥ç¨‹ file åˆ—è¡¨ã€æ–‡ä»¶ç»“æ„åˆ—è¡¨ 2. å‘½ä»¤è¡Œæ¨¡å¼ã€ä»£ç æ£€æŸ¥ã€VCSç­‰ 3 ALT + F12 æ‰“å¼€å‘½ä»¤è¡Œæ  âœ”ï¸ 4 CMD + F12 æ˜¾ç¤ºæ–‡ä»¶ç»“æ„ âœ”ï¸ 5 CMD + J ä»£ç æ™ºèƒ½è¡¥å…¨ 6 ALT + F1 å®šä½ç¼–è¾‘æ–‡ä»¶æ‰€åœ¨ä½ç½® 2. Invoke LearningPYTHONUNBUFFERED=1;INTERMEDIATE_DATA_PATH=/Users/blair/ghome/6E/work_project/mlar/tmp;PYTHONPATH=~/ghome/6E/work_project/mlar:~/ghome/6E/work_project/mlar/nn_framework environment Reference ä»£ç ç¼–è¾‘å¿«æ·é”®","categories":[{"name":"python","slug":"python","permalink":"http://iequa.com/categories/python/"}],"tags":[{"name":"pyCharm","slug":"pyCharm","permalink":"http://iequa.com/tags/pyCharm/"}]},{"title":"scikit-learn ä¸ºæœºå™¨å­¦ä¹ å‡†å¤‡æ–‡æœ¬æ•°æ®","slug":"nlp/scikit-learn-text-processing","date":"2019-12-08T14:00:21.000Z","updated":"2019-12-08T15:12:09.835Z","comments":true,"path":"2019/12/08/nlp/scikit-learn-text-processing/","link":"","permalink":"http://iequa.com/2019/12/08/nlp/scikit-learn-text-processing/","excerpt":"","text":"æœ‰å…³ç‰¹å¾çš„æå–ï¼Œscikit-learnç»™å‡ºäº†å¾ˆå¤šæ–¹æ³•ï¼Œå…·ä½“åˆ†æˆäº†å›¾ç‰‡ç‰¹å¾æå–å’Œæ–‡æœ¬ç‰¹å¾æå–ã€‚ æ–‡æœ¬ç‰¹å¾æå–çš„æ¥å£æ˜¯sklearn.feature_extraction.textï¼Œé‚£ä¹ˆæ¥ä¸‹æ¥å­¦ä¹ é‡Œé¢å°è£…çš„å‡½æ•°ã€‚ CountVectorizerfrom sklearn.feature_extraction.text import CountVectorizervectorizer = CountVectorizer(min_df=1)corpus = [ &#x27;This is the first document.&#x27;, &#x27;This is the second second document.&#x27;, &#x27;And the third one.&#x27;, &#x27;Is this the first document?&#x27;, ]X = vectorizer.fit_transform(corpus)feature_name = vectorizer.get_feature_names()print feature_nameprint X.toarray() ç¨‹åºçš„ç»“æœä¸º [u&#x27;and&#x27;, u&#x27;document&#x27;, u&#x27;first&#x27;, u&#x27;is&#x27;, u&#x27;one&#x27;, u&#x27;second&#x27;, u&#x27;the&#x27;, u&#x27;third&#x27;, u&#x27;this&#x27;][[0 1 1 1 0 0 1 0 1] [0 1 0 1 0 2 1 0 1] [1 0 0 0 1 0 1 1 0] [0 1 1 1 0 0 1 0 1]] Reference scikit-learn ä¸ºæœºå™¨å­¦ä¹ å‡†å¤‡æ–‡æœ¬æ•°æ® å­¦ä¹ sklearnä¹‹æ–‡æœ¬ç‰¹å¾æå– Scikit-Learn Vectorizermax_features Keras Keraså…¥é—¨ï¼ˆä¸€ï¼‰æ­å»ºæ·±åº¦ç¥ç»ç½‘ç»œï¼ˆDNNï¼‰è§£å†³å¤šåˆ†ç±»é—®é¢˜","categories":[{"name":"nlp","slug":"nlp","permalink":"http://iequa.com/categories/nlp/"}],"tags":[{"name":"scikit-learn","slug":"scikit-learn","permalink":"http://iequa.com/tags/scikit-learn/"}]},{"title":"SpaCy tutorial","slug":"nlp/SpaCy-tutorial","date":"2019-12-02T03:00:21.000Z","updated":"2019-12-03T03:18:48.103Z","comments":true,"path":"2019/12/02/nlp/SpaCy-tutorial/","link":"","permalink":"http://iequa.com/2019/12/02/nlp/SpaCy-tutorial/","excerpt":"","text":"spaCy æ˜¯ä¸€ä¸ªPythonè‡ªç„¶è¯­è¨€å¤„ç†å·¥å…·åŒ…ï¼Œè¯ç”Ÿäº 2014 å¹´ã€‚ spaCy æ˜¯ Industrial-Strength Natural Language Processing in Python spaCy å¤§é‡ä½¿ç”¨äº† Cython æ¥æé«˜æ¨¡å—æ€§èƒ½ï¼ŒåŒºåˆ«äºå­¦æœ¯æ€§è´¨æ›´æµ“çš„Python NLTKï¼Œå…·æœ‰äº†ä¸šç•Œåº”ç”¨çš„å®é™…ä»·å€¼ã€‚ Reference spacy.io è‡ªç„¶è¯­è¨€å¤„ç†å·¥å…·åŒ…spacyä»‹ç» Lemmatization Approaches with Examples in Python å¦‚ä½•ç”¨Pythonå¤„ç†è‡ªç„¶è¯­è¨€ï¼Ÿï¼ˆSpacyä¸Word Embeddingï¼‰ ç‰æ ‘èŠå…°, çŸ¥ä¹ä¸“æ  demo-spa-text-processing spaCy ç¬¬äºŒç¯‡ï¼šè¯­è¨€æ¨¡å‹","categories":[{"name":"nlp","slug":"nlp","permalink":"http://iequa.com/categories/nlp/"}],"tags":[{"name":"SpaCy","slug":"SpaCy","permalink":"http://iequa.com/tags/SpaCy/"}]},{"title":"Linux Systemd Tutorial","slug":"devops/linux-systemd-tutorial","date":"2019-11-23T06:11:21.000Z","updated":"2019-11-23T16:38:22.857Z","comments":true,"path":"2019/11/23/devops/linux-systemd-tutorial/","link":"","permalink":"http://iequa.com/2019/11/23/devops/linux-systemd-tutorial/","excerpt":"","text":"1. Prefaceå†å²ä¸Šï¼ŒLinux çš„å¯åŠ¨ä¸€ç›´é‡‡ç”¨initè¿›ç¨‹ã€‚ $ sudo /etc/init.d/apache2 start# æˆ–è€…$ service apache2 start è¿™ç§æ–¹æ³•æœ‰ä¸¤ä¸ªç¼ºç‚¹: å¯åŠ¨æ—¶é—´é•¿ å¯åŠ¨è„šæœ¬å¤æ‚ init è¿›ç¨‹æ˜¯ä¸²è¡Œå¯åŠ¨ï¼Œåªæœ‰å‰ä¸€ä¸ªè¿›ç¨‹å¯åŠ¨å®Œï¼Œæ‰ä¼šå¯åŠ¨ä¸‹ä¸€ä¸ªè¿›ç¨‹ã€‚ init è¿›ç¨‹åªæ˜¯æ‰§è¡Œå¯åŠ¨è„šæœ¬ï¼Œä¸ç®¡å…¶ä»–äº‹æƒ…ã€‚è„šæœ¬éœ€è¦è‡ªå·±å¤„ç†å„ç§æƒ…å†µï¼Œè¿™å¾€å¾€ä½¿å¾—è„šæœ¬å˜å¾—å¾ˆé•¿ã€‚ 2. Systemd (daemon)Systemd å°±æ˜¯ä¸ºäº†è§£å†³è¿™äº›é—®é¢˜è€Œè¯ç”Ÿçš„ã€‚å®ƒçš„è®¾è®¡ç›®æ ‡æ˜¯ï¼Œä¸ºç³»ç»Ÿçš„å¯åŠ¨å’Œç®¡ç†æä¾›ä¸€å¥—å®Œæ•´çš„è§£å†³æ–¹æ¡ˆã€‚ æ ¹æ® Linux æƒ¯ä¾‹ï¼Œå­—æ¯dæ˜¯å®ˆæŠ¤è¿›ç¨‹ï¼ˆdaemonï¼‰çš„ç¼©å†™ã€‚ Systemd è¿™ä¸ªåå­—çš„å«ä¹‰ï¼Œå°±æ˜¯å®ƒè¦å®ˆæŠ¤æ•´ä¸ªç³»ç»Ÿã€‚ Linux OS Daemon management tool Systemd ã€‚å®ƒæ˜¯ OS çš„ä¸€éƒ¨åˆ†ï¼Œç›´æ¥ä¸ kernel äº¤äº’ï¼Œæ€§èƒ½æ£’ï¼ŒåŠŸèƒ½å¼ºã€‚æˆ‘ä»¬å®Œå…¨å¯ä»¥å°†ç¨‹åºäº¤ç»™ Systemd ï¼Œè®©ç³»ç»Ÿç»Ÿä¸€ç®¡ç†ï¼Œæˆä¸ºçœŸæ­£æ„ä¹‰ä¸Šçš„ç³»ç»ŸæœåŠ¡ã€‚ æŸ¥çœ‹ Systemd çš„ç‰ˆæœ¬ã€‚$ systemctl --version 3. System managementSystemd å¹¶ä¸æ˜¯ä¸€ä¸ªå‘½ä»¤ï¼Œè€Œæ˜¯ä¸€ç»„å‘½ä»¤ï¼Œæ¶‰åŠåˆ°ç³»ç»Ÿç®¡ç†çš„æ–¹æ–¹é¢é¢ã€‚ 4. UnitSystemd å¯ä»¥ç®¡ç†æ‰€æœ‰ç³»ç»Ÿèµ„æºã€‚ä¸åŒçš„èµ„æºç»Ÿç§°ä¸º Unitï¼ˆå•ä½ï¼‰ã€‚ 4.1 Unit definitionUnit ä¸€å…±åˆ†æˆ12ç§: Service unitï¼šç³»ç»ŸæœåŠ¡ Target unitï¼šå¤šä¸ª Unit æ„æˆçš„ä¸€ä¸ªç»„ Device Unitï¼šç¡¬ä»¶è®¾å¤‡ Mount Unitï¼šæ–‡ä»¶ç³»ç»Ÿçš„æŒ‚è½½ç‚¹ Automount Unitï¼šè‡ªåŠ¨æŒ‚è½½ç‚¹ Path Unitï¼šæ–‡ä»¶æˆ–è·¯å¾„ Scope Unitï¼šä¸æ˜¯ç”± Systemd å¯åŠ¨çš„å¤–éƒ¨è¿›ç¨‹ Slice Unitï¼šè¿›ç¨‹ç»„ Snapshot Unitï¼šSystemd å¿«ç…§ï¼Œå¯ä»¥åˆ‡å›æŸä¸ªå¿«ç…§ Socket Unitï¼šè¿›ç¨‹é—´é€šä¿¡çš„ socket Swap Unitï¼šswap æ–‡ä»¶ Timer Unitï¼šå®šæ—¶å™¨ systemctl list-units å‘½ä»¤å¯ä»¥æŸ¥çœ‹å½“å‰ç³»ç»Ÿçš„æ‰€æœ‰ Unit # åˆ—å‡ºæ­£åœ¨è¿è¡Œçš„ Unit$ systemctl list-units# åˆ—å‡ºæ‰€æœ‰Unitï¼ŒåŒ…æ‹¬æ²¡æœ‰æ‰¾åˆ°é…ç½®æ–‡ä»¶çš„æˆ–è€…å¯åŠ¨å¤±è´¥çš„$ systemctl list-units --all# åˆ—å‡ºæ‰€æœ‰æ²¡æœ‰è¿è¡Œçš„ Unit$ systemctl list-units --all --state=inactive# åˆ—å‡ºæ‰€æœ‰åŠ è½½å¤±è´¥çš„ Unit$ systemctl list-units --failed# åˆ—å‡ºæ‰€æœ‰æ­£åœ¨è¿è¡Œçš„ã€ç±»å‹ä¸º service çš„ Unit$ systemctl list-units --type=service 4.2 Unit status# æ˜¾ç¤ºç³»ç»ŸçŠ¶æ€$ systemctl status# æ˜¾ç¤ºå•ä¸ª Unit çš„çŠ¶æ€$ sysystemctl status bluetooth.service# æ˜¾ç¤ºè¿œç¨‹ä¸»æœºçš„æŸä¸ª Unit çš„çŠ¶æ€$ systemctl -H root@rhel7.example.com status httpd.service é™¤äº† status å‘½ä»¤ï¼Œ systemctl è¿˜æä¾›äº†ä¸‰ä¸ªæŸ¥è¯¢çŠ¶æ€çš„ç®€å•æ–¹æ³•ï¼Œä¸»è¦ä¾›è„šæœ¬å†…éƒ¨çš„åˆ¤æ–­è¯­å¥ä½¿ç”¨ã€‚ 4.3 Unit managementå¯¹äºç”¨æˆ·æ¥è¯´ï¼Œæœ€å¸¸ç”¨çš„æ˜¯ä¸‹é¢è¿™äº›å‘½ä»¤ï¼Œç”¨äº start å’Œ stop Unitï¼ˆä¸»è¦æ˜¯ serviceï¼‰ # ç«‹å³å¯åŠ¨ä¸€ä¸ªæœåŠ¡$ sudo systemctl start apache.service# ç«‹å³åœæ­¢ä¸€ä¸ªæœåŠ¡$ sudo systemctl stop apache.service# é‡å¯ä¸€ä¸ªæœåŠ¡$ sudo systemctl restart apache.service# æ€æ­»ä¸€ä¸ªæœåŠ¡çš„æ‰€æœ‰å­è¿›ç¨‹$ sudo systemctl kill apache.service# é‡æ–°åŠ è½½ä¸€ä¸ªæœåŠ¡çš„é…ç½®æ–‡ä»¶$ sudo systemctl reload apache.service# é‡è½½æ‰€æœ‰ä¿®æ”¹è¿‡çš„é…ç½®æ–‡ä»¶$ sudo systemctl daemon-reload# æ˜¾ç¤ºæŸä¸ª Unit çš„æ‰€æœ‰åº•å±‚å‚æ•°$ systemctl show httpd.service# æ˜¾ç¤ºæŸä¸ª Unit çš„æŒ‡å®šå±æ€§çš„å€¼$ systemctl show -p CPUShares httpd.service# è®¾ç½®æŸä¸ª Unit çš„æŒ‡å®šå±æ€§$ sudo systemctl set-property httpd.service CPUShares=500 4.4 Unit dependenciesUnit ä¹‹é—´å­˜åœ¨ä¾èµ–å…³ç³»ï¼šA ä¾èµ–äº Bï¼Œå°±æ„å‘³ç€ Systemd åœ¨å¯åŠ¨ A çš„æ—¶å€™ï¼ŒåŒæ—¶ä¼šå»å¯åŠ¨ Bã€‚ systemctl list-dependencieså‘½ä»¤åˆ—å‡ºä¸€ä¸ª Unit çš„æ‰€æœ‰ä¾èµ– $ systemctl list-dependencies nginx.service ä¸Šé¢å‘½ä»¤çš„è¾“å‡ºç»“æœä¹‹ä¸­ï¼Œæœ‰äº›ä¾èµ–æ˜¯ Target ç±»å‹ï¼ˆè¯¦è§ä¸‹æ–‡ï¼‰ï¼Œé»˜è®¤ä¸ä¼šå±•å¼€æ˜¾ç¤ºã€‚å¦‚æœè¦å±•å¼€ Targetï¼Œå°±éœ€è¦ä½¿ç”¨â€”allå‚æ•° $ systemctl list-dependencies --all nginx.service 5. Unit config5.1 config overviewæ¯ä¸€ä¸ª Unit éƒ½æœ‰ä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼Œå‘Šè¯‰ Systemd æ€ä¹ˆå¯åŠ¨è¿™ä¸ª Unit ã€‚ Systemd é»˜è®¤ä»ç›®å½• /etc/systemd/system/ è¯»å–é…ç½®æ–‡ä»¶ã€‚ä½†æ˜¯ï¼Œé‡Œé¢å­˜æ”¾çš„å¤§éƒ¨åˆ†æ–‡ä»¶éƒ½æ˜¯ç¬¦å·é“¾æ¥ï¼ŒæŒ‡å‘ç›®å½• /usr/lib/systemd/system/ï¼ŒçœŸæ­£çš„é…ç½®æ–‡ä»¶å­˜æ”¾åœ¨é‚£ä¸ªç›®å½•ã€‚ systemctl enable å‘½ä»¤ç”¨äºåœ¨ä¸Šé¢ä¸¤ä¸ªç›®å½•ä¹‹é—´ï¼Œå»ºç«‹ç¬¦å·é“¾æ¥å…³ç³»ã€‚ $ sudo systemctl enable clamd@scan.service# ç­‰åŒäº$ sudo ln -s &#x27;/usr/lib/systemd/system/clamd@scan.service&#x27; &#x27;/etc/systemd/system/multi-user.target.wants/clamd@scan.service&#x27; é…ç½®æ–‡ä»¶çš„åç¼€åï¼Œå°±æ˜¯è¯¥ Unit çš„ç§ç±»ï¼Œæ¯”å¦‚ sshd.socketã€‚å¦‚æœçœç•¥ï¼ŒSystemd é»˜è®¤åç¼€åä¸º.serviceï¼Œæ‰€ä»¥ sshd ä¼šè¢«ç†è§£æˆ sshd.serviceã€‚ 5.2 config status# åˆ—å‡ºæ‰€æœ‰é…ç½®æ–‡ä»¶$ systemctl list-unit-files# åˆ—å‡ºæŒ‡å®šç±»å‹çš„é…ç½®æ–‡ä»¶$ systemctl list-unit-files --type=service è¿™ä¸ªå‘½ä»¤ä¼šè¾“å‡ºä¸€ä¸ªåˆ—è¡¨ $ systemctl list-unit-filesUNIT FILE STATEchronyd.service enabled (å·²å¯åŠ¨é“¾æ¥)clamd@.service static (è¯¥é…ç½®æ–‡ä»¶æ²¡æœ‰[Install]éƒ¨åˆ†ï¼ˆæ— æ³•æ‰§è¡Œï¼‰ï¼Œåªèƒ½ä½œä¸ºå…¶ä»–é…ç½®æ–‡ä»¶çš„ä¾èµ–)clamd@scan.service disabled (æ²¡å»ºç«‹å¯åŠ¨é“¾æ¥) ä»é…ç½®æ–‡ä»¶çš„çŠ¶æ€æ— æ³•çœ‹å‡ºï¼Œè¯¥ Unit æ˜¯å¦æ­£åœ¨è¿è¡Œã€‚è¿™å¿…é¡»æ‰§è¡Œå‰é¢æåˆ°çš„ systemctl status å‘½ä»¤ $ systemctl status bluetooth.service ä¸€æ—¦ä¿®æ”¹é…ç½®æ–‡ä»¶ï¼Œå°±è¦è®© SystemD é‡æ–°åŠ è½½é…ç½®æ–‡ä»¶ï¼Œç„¶åé‡æ–°å¯åŠ¨ï¼Œå¦åˆ™ä¿®æ”¹ä¸ä¼šç”Ÿæ•ˆã€‚ $ sudo systemctl daemon-reload$ sudo systemctl restart httpd.service 5.3 config formatsystemctl cat service_name å‘½ä»¤å¯ä»¥æŸ¥çœ‹é…ç½®æ–‡ä»¶çš„å†…å®¹ $ systemctl cat atd.service[Unit]Description=ATD daemon[Service]Type=forkingExecStart=/usr/bin/atd[Install]WantedBy=multi-user.target æ³¨æ„ï¼Œé”®å€¼å¯¹çš„ç­‰å·ä¸¤ä¾§ä¸èƒ½æœ‰ç©ºæ ¼ 5.4 config block[Unit]åŒºå—æ˜¯é…ç½®æ–‡ä»¶çš„ç¬¬ä¸€ä¸ªåŒºå—ï¼Œç”¨æ¥å®šä¹‰ Unit çš„å…ƒæ•°æ®åŠé…ç½®ä¸å…¶ä»– Unit çš„å…³ç³»ã€‚å®ƒçš„ä¸»è¦å­—æ®µå¦‚ä¸‹ã€‚ field desc Description ç®€çŸ­æè¿° Documentation æ–‡æ¡£åœ°å€ Requires å½“å‰ Unit ä¾èµ–çš„å…¶ä»– Unitï¼Œå¦‚æœå®ƒä»¬æ²¡æœ‰è¿è¡Œï¼Œå½“å‰ Unit ä¼šå¯åŠ¨å¤±è´¥ â€¦ â€¦ Assertâ€¦ å½“å‰ Unit è¿è¡Œå¿…é¡»æ»¡è¶³çš„æ¡ä»¶ï¼Œå¦åˆ™ä¼šæŠ¥å¯åŠ¨å¤±è´¥ [Install]åŒºå—æ˜¯é…ç½®æ–‡ä»¶çš„æœ€åä¸€ä¸ªåŒºå—ï¼Œç”¨æ¥å®šä¹‰å¦‚ä½•å¯åŠ¨ï¼Œä»¥åŠæ˜¯å¦å¼€æœºå¯åŠ¨ã€‚å®ƒçš„ä¸»è¦å­—æ®µå¦‚ä¸‹ã€‚ field desc WantedBy å®ƒçš„å€¼æ˜¯ä¸€ä¸ªæˆ–å¤šä¸ª Targetï¼Œå½“å‰ Unit æ¿€æ´»æ—¶ï¼ˆenableï¼‰ç¬¦å·é“¾æ¥ä¼šæ”¾å…¥/etc/systemd/systemç›®å½•ä¸‹é¢ä»¥ Target å + .wantsåç¼€æ„æˆçš„å­ç›®å½•ä¸­. â€¦ â€¦ Alias å½“å‰ Unit å¯ç”¨äºå¯åŠ¨çš„åˆ«å Also å½“å‰ Unit æ¿€æ´»ï¼ˆenableï¼‰æ—¶ï¼Œä¼šè¢«åŒæ—¶æ¿€æ´»çš„å…¶ä»– Unit [Service]åŒºå—ç”¨æ¥ Service çš„é…ç½®ï¼Œåªæœ‰ Service ç±»å‹çš„ Unit æ‰æœ‰è¿™ä¸ªåŒºå—ã€‚å®ƒçš„ä¸»è¦å­—æ®µå¦‚ä¸‹ã€‚ field desc Type å®šä¹‰å¯åŠ¨æ—¶çš„è¿›ç¨‹è¡Œä¸ºã€‚å®ƒæœ‰ä»¥ä¸‹å‡ ç§å€¼ã€‚ â€¦ â€¦ Environment æŒ‡å®šç¯å¢ƒå˜é‡ Unit é…ç½®æ–‡ä»¶çš„å®Œæ•´å­—æ®µæ¸…å•ï¼Œè¯·å‚è€ƒå®˜æ–¹æ–‡æ¡£. 6. Target (units)å¯åŠ¨è®¡ç®—æœºçš„æ—¶å€™ï¼Œéœ€è¦å¯åŠ¨å¤§é‡çš„ Unitã€‚å¦‚æœæ¯ä¸€æ¬¡å¯åŠ¨ï¼Œéƒ½è¦ä¸€ä¸€å†™æ˜æœ¬æ¬¡å¯åŠ¨éœ€è¦å“ªäº› Unitï¼Œæ˜¾ç„¶éå¸¸ä¸æ–¹ä¾¿ã€‚Systemd çš„è§£å†³æ–¹æ¡ˆå°±æ˜¯ Targetã€‚ ç®€å•è¯´ï¼ŒTarget å°±æ˜¯ä¸€ä¸ª Unit ç»„ï¼ŒåŒ…å«è®¸å¤šç›¸å…³çš„ Unit ã€‚ # æŸ¥çœ‹å½“å‰ç³»ç»Ÿçš„æ‰€æœ‰ Target$ systemctl list-unit-files --type=target# æŸ¥çœ‹ä¸€ä¸ª Target åŒ…å«çš„æ‰€æœ‰ Unit$ systemctl list-dependencies multi-user.target# æŸ¥çœ‹å¯åŠ¨æ—¶çš„é»˜è®¤ Target$ systemctl get-default# è®¾ç½®å¯åŠ¨æ—¶çš„é»˜è®¤ Target$ sudo systemctl set-default multi-user.target# åˆ‡æ¢ Target æ—¶ï¼Œé»˜è®¤ä¸å…³é—­å‰ä¸€ä¸ª Target å¯åŠ¨çš„è¿›ç¨‹ï¼Œ# systemctl isolate å‘½ä»¤æ”¹å˜è¿™ç§è¡Œä¸ºï¼Œ# å…³é—­å‰ä¸€ä¸ª Target é‡Œé¢æ‰€æœ‰ä¸å±äºåä¸€ä¸ª Target çš„è¿›ç¨‹$ sudo systemctl isolate multi-user.target Target ä¸ ä¼ ç»Ÿ RunLevel çš„å¯¹åº”å…³ç³»å¦‚ä¸‹: Traditional runlevel New target name Symbolically linked to...Runlevel 0 | runlevel0.target -&gt; poweroff.targetRunlevel 1 | runlevel1.target -&gt; rescue.targetRunlevel 2 | runlevel2.target -&gt; multi-user.targetRunlevel 3 | runlevel3.target -&gt; multi-user.targetRunlevel 4 | runlevel4.target -&gt; multi-user.targetRunlevel 5 | runlevel5.target -&gt; graphical.targetRunlevel 6 | runlevel6.target -&gt; reboot.target 7. Log managementSystemd ç»Ÿä¸€ç®¡ç†æ‰€æœ‰ Unit çš„å¯åŠ¨æ—¥å¿—ã€‚å¸¦æ¥çš„å¥½å¤„å°±æ˜¯ï¼Œå¯ä»¥åªç”¨ journalctl ä¸€ä¸ªå‘½ä»¤ï¼ŒæŸ¥çœ‹æ‰€æœ‰æ—¥å¿—ï¼ˆå†…æ ¸æ—¥å¿—å’Œåº”ç”¨æ—¥å¿—ï¼‰ã€‚æ—¥å¿—çš„é…ç½®æ–‡ä»¶æ˜¯ /etc/systemd/journald.confã€‚ # æŸ¥çœ‹æŸä¸ª Unit çš„æ—¥å¿—$ sudo journalctl -u nginx.service$ sudo journalctl -u nginx.service --since today# å®æ—¶æ»šåŠ¨æ˜¾ç¤ºæŸä¸ª Unit çš„æœ€æ–°æ—¥å¿—$ sudo journalctl -u nginx.service -f å®ƒä¸initè¿›ç¨‹çš„ä¸»è¦å·®åˆ«å¦‚ä¸‹ ï¼ˆ1ï¼‰é»˜è®¤çš„ RunLevelï¼ˆåœ¨/etc/inittabæ–‡ä»¶è®¾ç½®ï¼‰ç°åœ¨è¢«é»˜è®¤çš„ Target å–ä»£ï¼Œä½ç½®æ˜¯/etc/systemd/system/default.targetï¼Œé€šå¸¸ç¬¦å·é“¾æ¥åˆ°graphical.targetï¼ˆå›¾å½¢ç•Œé¢ï¼‰æˆ–è€…multi-user.targetï¼ˆå¤šç”¨æˆ·å‘½ä»¤è¡Œï¼‰ã€‚ï¼ˆ2ï¼‰å¯åŠ¨è„šæœ¬çš„ä½ç½®ï¼Œä»¥å‰æ˜¯/etc/init.dç›®å½•ï¼Œç¬¦å·é“¾æ¥åˆ°ä¸åŒçš„ RunLevel ç›®å½• ï¼ˆæ¯”å¦‚/etc/rc3.dã€/etc/rc5.dç­‰ï¼‰ï¼Œç°åœ¨åˆ™å­˜æ”¾åœ¨/lib/systemd/systemå’Œ/etc/systemd/systemç›®å½•ã€‚ï¼ˆ3ï¼‰é…ç½®æ–‡ä»¶çš„ä½ç½®ï¼Œä»¥å‰initè¿›ç¨‹çš„é…ç½®æ–‡ä»¶æ˜¯/etc/inittabï¼Œå„ç§æœåŠ¡çš„é…ç½®æ–‡ä»¶å­˜æ”¾åœ¨/etc/sysconfigç›®å½•ã€‚ç°åœ¨çš„é…ç½®æ–‡ä»¶ä¸»è¦å­˜æ”¾åœ¨/lib/systemdç›®å½•ï¼Œåœ¨/etc/systemdç›®å½•é‡Œé¢çš„ä¿®æ”¹å¯ä»¥è¦†ç›–åŸå§‹è®¾ç½®ã€‚ Reference é˜®ä¸€å³°: è®¡ç®—æœºæ˜¯å¦‚ä½•å¯åŠ¨çš„ï¼Ÿ âœ”ï¸ é˜®ä¸€å³°: Linux çš„å¯åŠ¨æµç¨‹ âœ”ï¸ é˜®ä¸€å³°: Linux daemon (å®ˆæŠ¤è¿›ç¨‹)çš„å¯åŠ¨æ–¹æ³• âœ”ï¸ é˜®ä¸€å³°: Systemd å…¥é—¨æ•™ç¨‹ï¼šå‘½ä»¤ç¯‡ âœ”ï¸ é˜®ä¸€å³°: Kiss (Keep it sample stupid) Unixå“²å­¦ âœ”ï¸ Systemd Service Manager Great: Linux ç³»ç»Ÿå¼€æœºå¯åŠ¨é¡¹æ¸…ç† Understanding And Using Systemd sudo sudo å‘½ä»¤æƒ…æ™¯åˆ†æ Linux ç³»ç»Ÿä¸­ sudo å‘½ä»¤çš„ 10 ä¸ªæŠ€å·§ é¸Ÿå“¥çš„ç§æˆ¿èœï¼š ç¬¬åå››ç« ã€Linux è´¦å·ç®¡ç†ä¸ ACL æƒé™é…ç½®","categories":[{"name":"devops","slug":"devops","permalink":"http://iequa.com/categories/devops/"}],"tags":[{"name":"Systemd","slug":"Systemd","permalink":"http://iequa.com/tags/Systemd/"}]},{"title":"Anaconda + Tensorflow ç¯å¢ƒæ­å»º","slug":"nlp/tensorflow_env_build","date":"2019-11-08T14:00:21.000Z","updated":"2019-11-26T12:56:25.395Z","comments":true,"path":"2019/11/08/nlp/tensorflow_env_build/","link":"","permalink":"http://iequa.com/2019/11/08/nlp/tensorflow_env_build/","excerpt":"","text":"1. Anaconda1.1 Anaconda å¸¸ç”¨å‘½ä»¤conda --versionconda update conda # å¸®åŠ©å‘½ä»¤conda -h# æ›´æ–°æ‰€æœ‰åŒ…conda update --allconda upgrade --all 1.2 Anaconda ç®¡ç†ç¯å¢ƒconda create --name &lt;env_name&gt; &lt;package_names&gt; å¦‚ï¼š conda create -n python3 python=3.5 numpy pandas å³åˆ›å»ºä¸€ä¸ªåä¸ºâ€œpython3â€çš„ç¯å¢ƒï¼Œç¯å¢ƒä¸­å®‰è£…ç‰ˆæœ¬ä¸º3.5çš„pythonï¼ŒåŒæ—¶ä¹Ÿå®‰è£…äº†numpyå’Œpandasã€‚ conda info --envsconda env listsource activate &lt;env_name&gt; # å¤åˆ¶ç¯å¢ƒconda create --name &lt;new_env_name&gt; --clone &lt;copied_env_name&gt;# åˆ é™¤ç¯å¢ƒconda remove --name &lt;env_name&gt; --all pip list / conda list# å½“ä½¿ç”¨ conda install æ— æ³•è¿›è¡Œå®‰è£…æ—¶ï¼Œå¯ä»¥ä½¿ç”¨pipè¿›è¡Œå®‰è£…pip install &lt;package_name&gt; 2. Tensorflowconda install pandas xlrd conda install keras==2.2.4pip install keras-bert conda install tensorflow==&#x27;1.11.0&#x27;conda install tensorflow-gpu==&#x27;1.11.0&#x27; 3. GPUnvidia-smi+-----------------------------------------------------------------------------+| Processes: GPU Memory || GPU PID Type Process name Usage ||=============================================================================|| 6 7847 C python 11615MiB || 7 6412 C python 4219MiB || 8 36257 C .../anaconda2/envs/bert-serving/bin/python 11615MiB || 9 17293 C /home/xxx/.conda/envs/aspect/bin/python 11613MiB |+-----------------------------------------------------------------------------+ è§£å†³ cuda10 å› ä¸ºæ˜¾å¡é©±åŠ¨ä¸æ”¯æŒçš„ conda install cudatoolkit=9.0 ç”¨å¦‚ä¸‹ä»£ç å¯æ£€æµ‹tensorflowçš„èƒ½ä½¿ç”¨è®¾å¤‡æƒ…å†µï¼š from tensorflow.python.client import device_libprint(device_lib.list_local_devices()) 4. CPUKerasä»¥åŠTensorflowå¼ºåˆ¶ä½¿ç”¨CPU ä½¿ç”¨CUDA_VISIBLE_DEVICESå‘½ä»¤è¡Œå‚æ•°ï¼Œä»£ç å¦‚ä¸‹ï¼š CUDA_VISIBLE_DEVICES=&quot;&quot; python3 train.py Reference Anacondaä»‹ç»ã€å®‰è£…åŠä½¿ç”¨æ•™ç¨‹ Tensorflowæ£€éªŒGPUæ˜¯å¦å®‰è£…æˆåŠŸ åŠ ä½¿ç”¨GPUè®­ç»ƒæ³¨æ„äº‹é¡¹ æŠ¥é”™ï¼šcudaGetDevice() failed. Status: CUDA driver version is https://tensorflow.google.cn/install/source tensorflow ä½¿ç”¨CPUè€Œä¸ä½¿ç”¨GPUçš„é—®é¢˜è§£å†³ Kerasä»¥åŠTensorflowå¼ºåˆ¶ä½¿ç”¨CPU Good! æ•™ç¨‹ | ä½¿ç”¨ PyCharm è¿æ¥æœåŠ¡å™¨è¿›è¡Œè¿œç¨‹å¼€å‘å’Œè°ƒè¯•","categories":[{"name":"devops","slug":"devops","permalink":"http://iequa.com/categories/devops/"}],"tags":[{"name":"Anaconda","slug":"Anaconda","permalink":"http://iequa.com/tags/Anaconda/"}]},{"title":"Bert æœ€ç®€å•çš„æ‰“å¼€å§¿åŠ¿","slug":"nlp/bert_keras-tutorial","date":"2019-11-08T03:00:21.000Z","updated":"2020-01-12T07:30:09.000Z","comments":true,"path":"2019/11/08/nlp/bert_keras-tutorial/","link":"","permalink":"http://iequa.com/2019/11/08/nlp/bert_keras-tutorial/","excerpt":"","text":"1. å½“Berté‡ä¸ŠKerasåœ¨Kerasä¸‹å¯¹Bertæœ€å¥½çš„å°è£…æ˜¯ï¼š keras-bertï¼šhttps://github.com/CyberZHG/keras-bert #! -*- coding:utf-8 -*-import jsonimport numpy as npimport pandas as pdfrom random import choicefrom keras_bert import load_trained_model_from_checkpoint, Tokenizerimport re, osimport codecsmaxlen = 100config_path = &#x27;../bert/chinese_L-12_H-768_A-12/bert_config.json&#x27;checkpoint_path = &#x27;../bert/chinese_L-12_H-768_A-12/bert_model.ckpt&#x27;dict_path = &#x27;../bert/chinese_L-12_H-768_A-12/vocab.txt&#x27;token_dict = &#123;&#125;# dict_path = &#x27;./bert/chinese_L-12_H-768_A-12/vocab.txt&#x27;with codecs.open(dict_path, &#x27;r&#x27;, &#x27;utf8&#x27;) as reader: for line in reader: token = line.strip() token_dict[token] = len(token_dict)class OurTokenizer(Tokenizer): def _tokenize(self, text): R = [] for c in text: if c in self._token_dict: print(c) R.append(c) elif self._is_space(c): R.append(&#x27;[unused1]&#x27;) # spaceç±»ç”¨æœªç»è®­ç»ƒçš„[unused1]è¡¨ç¤º else: R.append(&#x27;[UNK]&#x27;) # å‰©ä½™çš„å­—ç¬¦æ˜¯[UNK] return Rtokenizer = OurTokenizer(token_dict)tokenizertokenizer = OurTokenizer(token_dict)tokenizer.tokenize(u&#x27;ä»Šå¤©å¤© æ°”ä¸é”™&#x27;) output: [&#x27;[CLS]&#x27;, &#x27;ä»Š&#x27;, &#x27;å¤©&#x27;, &#x27;å¤©&#x27;, &#x27;[unused1]&#x27;, &#x27;æ°”&#x27;, &#x27;ä¸&#x27;, &#x27;é”™&#x27;, &#x27;[SEP]&#x27;] è¿™é‡Œç®€å•è§£é‡Šä¸€ä¸‹Tokenizerçš„è¾“å‡ºç»“æœã€‚é¦–å…ˆï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œåˆ†è¯åå¥å­é¦–ä½ä¼šåˆ†åˆ«åŠ ä¸Š[CLS]å’Œ[SEP]æ ‡è®°ï¼Œå…¶ä¸­[CLS]ä½ç½®å¯¹åº”çš„è¾“å‡ºå‘é‡æ˜¯èƒ½ä»£è¡¨æ•´å¥çš„å¥å‘é‡ï¼ˆåæ­£Bertæ˜¯è¿™æ ·è®¾è®¡çš„ï¼‰ï¼Œè€Œ[SEP]åˆ™æ˜¯å¥é—´çš„åˆ†éš”ç¬¦ï¼Œå…¶ä½™éƒ¨åˆ†åˆ™æ˜¯å•å­—è¾“å‡ºï¼ˆå¯¹äºä¸­æ–‡æ¥è¯´ï¼‰ 2. Sentiment classification æ–‡æœ¬æƒ…æ„Ÿåˆ†ç±»ï¼ˆä¸€ï¼‰ï¼šä¼ ç»Ÿæ¨¡å‹ æ–‡æœ¬æƒ…æ„Ÿåˆ†ç±»ï¼ˆäºŒï¼‰ï¼šæ·±åº¦å­¦ä¹ æ¨¡å‹ åšä¸€ä¸ªæœ€åŸºæœ¬çš„æ–‡æœ¬åˆ†ç±»ä»»åŠ¡: bert_model = load_trained_model_from_checkpoint(config_path, checkpoint_path, seq_len=None)for l in bert_model.layers: l.trainable = Truex1_in = Input(shape=(None,))x2_in = Input(shape=(None,))x = bert_model([x1_in, x2_in])x = Lambda(lambda x: x[:, 0])(x) # å–å‡º[CLS]å¯¹åº”çš„å‘é‡ç”¨æ¥åšåˆ†ç±»p = Dense(1, activation=&#x27;sigmoid&#x27;)(x)model = Model([x1_in, x2_in], p)model.compile( loss=&#x27;binary_crossentropy&#x27;, optimizer=Adam(1e-5), # metrics=[&#x27;accuracy&#x27;])model.summary() åœ¨Kerasä¸­è°ƒç”¨Bertæ¥åšæƒ…æ„Ÿåˆ†ç±»ä»»åŠ¡å°±è¿™æ ·å†™å®Œäº†ï½å†™å®Œäº†ï½ï½ 3. è¿è¡Œæ•ˆæœæ‰€æœ‰çš„ params train for l in bert_model.layers: l.trainable = True åŠ è½½çš„ bert params non-train 4. æŒ‡å¯¼åŸåˆ™æœ‰ä»€ä¹ˆåŸåˆ™æ¥æŒ‡å¯¼Bertåé¢åº”è¯¥è¦æ¥å“ªäº›å±‚ï¼Ÿ ç­”æ¡ˆæ˜¯ï¼šç”¨å°½å¯èƒ½å°‘çš„å±‚æ¥å®Œæˆä½ çš„ä»»åŠ¡ã€‚ æ¯”å¦‚ä¸Šè¿°æƒ…æ„Ÿåˆ†æåªæ˜¯ä¸€ä¸ªäºŒåˆ†ç±»ä»»åŠ¡ï¼Œä½ å°±å–å‡ºç¬¬ä¸€ä¸ªå‘é‡ç„¶ååŠ ä¸ªDense(1)å°±å¥½äº†ï¼Œä¸è¦æƒ³ç€å¤šåŠ å‡ å±‚Denseï¼Œæ›´åŠ ä¸è¦æƒ³ç€æ¥ä¸ªLSTMå†æ¥Denseï¼› å¦‚æœä½ è¦åšåºåˆ—æ ‡æ³¨ï¼ˆæ¯”å¦‚NERï¼‰ï¼Œé‚£ä½ å°±æ¥ä¸ªDense+CRFå°±å¥½ï¼Œä¹Ÿä¸è¦å¤šåŠ å…¶ä»–ä¸œè¥¿ã€‚ æ€»ä¹‹ï¼Œé¢å¤–åŠ çš„ä¸œè¥¿å°½å¯èƒ½å°‘ã€‚ä¸€æ˜¯å› ä¸ºBertæœ¬èº«å°±è¶³å¤Ÿå¤æ‚ï¼Œå®ƒæœ‰è¶³å¤Ÿèƒ½åŠ›åº”å¯¹ä½ è¦åšçš„å¾ˆå¤šä»»åŠ¡ï¼›äºŒæ¥ä½ è‡ªå·±åŠ çš„å±‚éƒ½æ˜¯éšå³åˆå§‹åŒ–çš„ï¼ŒåŠ å¤ªå¤šä¼šå¯¹Bertçš„é¢„è®­ç»ƒæƒé‡é€ æˆå‰§çƒˆæ‰°åŠ¨ï¼Œå®¹æ˜“é™ä½æ•ˆæœç”šè‡³é€ æˆæ¨¡å‹ä¸æ”¶æ•› Reference ã€ŠAttention is All You Needã€‹-è‹ç¥ BERT: Pre-training of Deep Bidirectional Transformers for Language Understanding æ·±åº¦å­¦ä¹ æ•™ç¨‹-è‹ç¥ ã€ å½“Berté‡ä¸ŠKeras-è‹ç¥ Kerasä¸­æ–‡æ–‡æ¡£ fit_generator å¼€å¯NLPçš„å¤§é­”æ³•é˜µâ€”â€”é€šè¿‡Keras-Bertæ“çºµBert è¶…ç‰›æ¨è alberthttps://arxiv.org/pdf/1909.11942.pdfELECTRAhttps://openreview.net/pdf?id=r1xMH1BtvBbert attention analysishttps://nlp.stanford.edu/pubs/clark2019what.pdf","categories":[{"name":"nlp","slug":"nlp","permalink":"http://iequa.com/categories/nlp/"}],"tags":[{"name":"BERT","slug":"BERT","permalink":"http://iequa.com/tags/BERT/"}]},{"title":"ElasticSearch å„ç§æŸ¥è¯¢å…³é”®å­—çš„åŒºåˆ«","slug":"elasticsearch/es-keyword-for-search","date":"2019-10-31T03:00:21.000Z","updated":"2021-02-08T00:48:02.593Z","comments":true,"path":"2019/10/31/elasticsearch/es-keyword-for-search/","link":"","permalink":"http://iequa.com/2019/10/31/elasticsearch/es-keyword-for-search/","excerpt":"","text":"Reference ElasticSearchå„ç§æŸ¥è¯¢å…³é”®å­—çš„åŒºåˆ« ç»ˆäºæœ‰äººæŠŠelasticsearchåŸç†è®²é€šäº†ï¼ æ·±å…¥æœç´¢ Function Score æŸ¥è¯¢ ElasticSearch è¯„åˆ†æ’åº æ·±å…¥æœç´¢ Â» æ§åˆ¶ç›¸å…³åº¦ 19 ä¸ªå¾ˆæœ‰ç”¨çš„ ElasticSearch æŸ¥è¯¢è¯­å¥ ElasticSearchæŸ¥è¯¢ ç¬¬å››ç¯‡ï¼šåŒ¹é…æŸ¥è¯¢ï¼ˆMatchï¼‰ Elasticsearch bool queryå°ç»“ (è§£å†³shouldå¤±æ•ˆ) æ·±å…¥æœç´¢ Â» å¤šå­—æ®µæœç´¢ Â» å¤šæ•°å­—æ®µ Stemmer Token Filter Elasticsearch Reference [6.2] Â» Analysis Â» Analyzers Elasticsearch Reference [6.2] Â» Analysis Â» Analyzers Â» Standard Analyzer Elasticsearchä¿®æ”¹åˆ†è¯å™¨ä»¥åŠè‡ªå®šä¹‰åˆ†è¯å™¨ ES 09 - Elasticsearchå¦‚ä½•å®šåˆ¶åˆ†è¯å™¨ (è‡ªå®šä¹‰åˆ†è¯ç­–ç•¥) å¤„ç†äººç±»è¯­è¨€ Â» å°†å•è¯è¿˜åŸä¸ºè¯æ ¹ Â» åŸå½¢è¯å¹²æå– elasticsearch shouldå®ç°oråŠŸèƒ½ï¼Œè®¾ç½®minimum_should_match Kibana ç”¨æˆ·æ‰‹å†Œ Â» æ•°æ®æ¢ç´¢ Elasticsearch: æƒå¨æŒ‡å— Â» æ·±å…¥æœç´¢ Â» å…¨æ–‡æœç´¢ Â» ç»„åˆæŸ¥è¯¢ Elasticsearch Reference [6.4] Â» Search APIs Â» Request Body Search Â» Field Collapsing ES Field Collapsing å­—æ®µæŠ˜å ä½¿ç”¨è¯¦è§£","categories":[{"name":"elastic","slug":"elastic","permalink":"http://iequa.com/categories/elastic/"}],"tags":[{"name":"ElasticSearch","slug":"ElasticSearch","permalink":"http://iequa.com/tags/ElasticSearch/"}]},{"title":"Kubernetes tutorial","slug":"devops/kubernetes-tutorial","date":"2019-10-28T10:11:21.000Z","updated":"2019-10-31T05:03:44.573Z","comments":true,"path":"2019/10/28/devops/kubernetes-tutorial/","link":"","permalink":"http://iequa.com/2019/10/28/devops/kubernetes-tutorial/","excerpt":"","text":"1. Kubernetes what?Kubernetes (K8s) is an open-source system for automating deployment, scaling, and management of containerized applications. Kubernetes minikube install @Mac sysctl -a | grep -E --color &#x27;machdep.cpu.features|VMX&#x27; brew cask install minikubeåŒæ™‚å®ƒä¹Ÿæœƒä¸€èµ·å®‰è£ kubectl é€™å€‹ Kubernetes æŒ‡ä»¤æ“ä½œå·¥å…· kubectl minikube version # /tmp/fluentd/etc [9:47:26]âœ minikube versionminikube version: v1.5.0commit: d1151d93385a70c5a03775e166e94067791fe2d9minikube ä¸»è¦æ˜¯ç”¨åœ¨ç·´ç¿’å’Œæ•™å­¸ä½¿ç”¨, éç”Ÿäº§ç¯å¢ƒ. Kubernetes is growing rapidly, has become a leader in Container Orchestrationã€‚ 2. Kubernetes whyï¼Ÿç”Ÿäº§ç¯å¢ƒåº”ç”¨ä¼šåŒ…å«å¤šä¸ª Containersï¼Œè€Œè¿™äº› Containers è¿˜å¾ˆå¯èƒ½ä¼šè·¨è¶Šå¤šä¸ªæœåŠ¡å™¨ä¸»æœºéƒ¨ç½²ã€‚ Kubernetes æä¾›äº†ä¸ºé‚£äº›å·¥ä½œè´Ÿè½½å¤§è§„æ¨¡éƒ¨ç½² Container çš„ç¼–æ’ä¸ç®¡ç†èƒ½åŠ›. Kubernetes ç¼–æ’èƒ½æ„å»ºå¤šå®¹å™¨åº”ç”¨æœåŠ¡ï¼Œåœ¨é›†ç¾¤ä¸Šè°ƒåº¦æˆ–ä¼¸ç¼©è¿™äº›å®¹å™¨ï¼ŒåŠç®¡ç†å®ƒä»¬éšæ—¶é—´å˜åŒ–çš„å¥åº·çŠ¶æ€. Kubernetes ä¹Ÿéœ€è¦ä¸ç½‘ç»œã€å­˜å‚¨ã€å®‰å…¨ã€ç›‘æ§ç­‰å…¶å®ƒæœåŠ¡é›†æˆæ‰èƒ½æä¾›ç»¼åˆæ€§çš„å®¹å™¨åŸºç¡€è®¾æ–½ã€‚ æœ‰äº† Kubernetesï¼Œä½ å¯ä»¥ï¼š è·¨ä¸»æœºç¼–æ’ Container; æ§åˆ¶ä¸è‡ªåŠ¨åŒ–åº”ç”¨çš„éƒ¨ç½²ä¸å‡çº§ã€‚ ä¸ºæœ‰çŠ¶æ€çš„ Application æŒ‚è½½å’Œæ·»åŠ å­˜å‚¨å™¨ã€‚ çº¿ä¸Šæ‰©å±•æˆ–è£å‰ª Containerized applications ä¸å®ƒä»¬çš„èµ„æºã€‚ å£°æ˜å¼çš„å®¹å™¨ç®¡ç†ï¼Œä¿è¯æ‰€éƒ¨ç½²çš„åº”ç”¨æŒ‰ç…§æˆ‘ä»¬éƒ¨ç½²çš„æ–¹å¼è¿ä½œã€‚ é€šè¿‡è‡ªåŠ¨å¸ƒå±€ã€è‡ªåŠ¨é‡å¯ã€è‡ªåŠ¨å¤åˆ¶ã€è‡ªåŠ¨ä¼¸ç¼©å®ç°åº”ç”¨çš„çŠ¶æ€æ£€æŸ¥ä¸è‡ªæˆ‘ä¿®å¤ã€‚ Kubernetes ä¾èµ–å…¶å®ƒé¡¹ç›®æ¥æä¾›å®Œæ•´çš„ç¼–æ’æœåŠ¡ã€‚ç»“åˆå…¶å®ƒå¿…è¦å¼€æºé¡¹ç›®ä½œä¸ºå…¶ç»„ä»¶ï¼š ä»“åº“ï¼šAtomic Registryã€Docker Registry ç­‰ã€‚ ç½‘ç»œï¼šOpenvSwitch å’Œæ™ºèƒ½è¾¹ç¼˜è·¯ç”±ç­‰ã€‚ ç›‘æ§ï¼šheapsterã€kibanaã€hawkular å’Œ elasticã€‚ å®‰å…¨ï¼šLDAPã€SELinuxã€ RBAC ä¸ æ”¯æŒå¤šç§Ÿæˆ·çš„ OAUTHã€‚ è‡ªåŠ¨åŒ–ï¼šé€šè¿‡ Ansible çš„ playbook è¿›è¡Œé›†ç¾¤çš„å®‰è£…å’Œç”Ÿå‘½å‘¨æœŸç®¡ç†ã€‚ æœåŠ¡ï¼šå¤§é‡äº‹å…ˆåˆ›å»ºå¥½çš„å¸¸ç”¨åº”ç”¨æ¨¡æ¿ã€‚ çº¢å¸½ OpenShift ä¸ºå®¹å™¨éƒ¨ç½²é¢„å…ˆé›†æˆäº†ä¸Šé¢è¿™äº›ç»„ä»¶ã€‚ 3. Kubernetes architectureKubernetes æ”¯æŒåœ¨å¤šç§ç¯å¢ƒä¸‹çš„å®‰è£…: æœ¬åœ°ä¸»æœºï¼ˆFedoraï¼‰ äº‘æœåŠ¡ï¼ˆGoogle GAEã€AWSï¼‰ 3.1 K8s architecture 3.2 MasterMasteræœ‰ä¸‰ä¸ªç»„ä»¶ï¼šAPI Serverã€Schedulerã€Controller: API Server æ˜¯æ•´ä¸ªç³»ç»Ÿçš„å¯¹å¤–æ¥å£ï¼Œæä¾› RESTful æ–¹å¼ä¾›å®¢æˆ·ç«¯å’Œå…¶å®ƒç»„ä»¶è°ƒç”¨ï¼› Scheduler è´Ÿè´£å¯¹èµ„æºè¿›è¡Œè°ƒåº¦ï¼Œåˆ†é…æŸä¸ª pod åˆ°æŸä¸ªèŠ‚ç‚¹ä¸Šï¼› Controller-manager è´Ÿè´£ç®¡ç†æ§åˆ¶å™¨ï¼ŒåŒ…æ‹¬ endpoint-controllerï¼ˆåˆ·æ–°æœåŠ¡å’Œ pod çš„å…³è”ä¿¡æ¯ï¼‰å’Œ replication-controllerï¼ˆç»´æŠ¤æŸä¸ª pod çš„å¤åˆ¶ä¸ºé…ç½®çš„æ•°å€¼ï¼‰ã€‚ 3.3 Node é›†ç¾¤ä¸­çš„æ¯ä¸ªé master èŠ‚ç‚¹éƒ½è¿è¡Œä¸¤ä¸ªè¿›ç¨‹ï¼š kubeletï¼Œå’Œ master èŠ‚ç‚¹è¿›è¡Œé€šä¿¡ã€‚ kube-proxyï¼Œä¸€ç§ç½‘ç»œä»£ç†ï¼Œå°† Kubernetes çš„ç½‘ç»œæœåŠ¡ä»£ç†åˆ°æ¯ä¸ªèŠ‚ç‚¹ä¸Šã€‚ 3.4 Kubernetes æœ¯è¯­ Masterï¼ˆä¸»èŠ‚ç‚¹ï¼‰ï¼š æ§åˆ¶ Kubernetes èŠ‚ç‚¹çš„æœºå™¨ï¼Œä¹Ÿæ˜¯åˆ›å»ºä½œä¸šä»»åŠ¡çš„åœ°æ–¹ã€‚ Nodeï¼ˆèŠ‚ç‚¹ï¼‰ï¼š è¿™äº›æœºå™¨åœ¨ Kubernetes ä¸»èŠ‚ç‚¹çš„æ§åˆ¶ä¸‹æ‰§è¡Œè¢«åˆ†é…çš„ä»»åŠ¡ã€‚ Podï¼š ç”±ä¸€ä¸ªæˆ–å¤šä¸ªå®¹å™¨æ„æˆçš„é›†åˆï¼Œä½œä¸ºä¸€ä¸ªæ•´ä½“è¢«éƒ¨ç½²åˆ°ä¸€ä¸ªå•ä¸€èŠ‚ç‚¹ã€‚ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;åŒä¸€ä¸ª pod ä¸­çš„å®¹å™¨å…±äº« IP åœ°å€ã€è¿›ç¨‹é—´é€šè®¯ï¼ˆIPCï¼‰ã€ä¸»æœºåä»¥åŠå…¶å®ƒèµ„æºã€‚ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Pod å°†åº•å±‚å®¹å™¨çš„ç½‘ç»œå’Œå­˜å‚¨æŠ½è±¡å‡ºæ¥ï¼Œä½¿å¾—é›†ç¾¤å†…çš„å®¹å™¨è¿ç§»æ›´ä¸ºä¾¿æ·ã€‚ Replication controllerï¼š æ§åˆ¶ä¸€ä¸ª pod åœ¨é›†ç¾¤ä¸Šè¿è¡Œçš„å®ä¾‹æ•°é‡ã€‚ Serviceï¼š å°†æœåŠ¡å†…å®¹ä¸å…·ä½“çš„ pod åˆ†ç¦»ã€‚Kubernetes æœåŠ¡ä»£ç†è´Ÿè´£è‡ªåŠ¨å°†æœåŠ¡è¯·æ±‚åˆ†å‘åˆ°æ­£ç¡®çš„ pod å¤„. Kubeletï¼š è¿™ä¸ªå®ˆæŠ¤è¿›ç¨‹è¿è¡Œåœ¨å„ä¸ªå·¥ä½œèŠ‚ç‚¹ä¸Šï¼Œè´Ÿè´£è·å–å®¹å™¨åˆ—è¡¨ï¼Œä¿è¯å£°æ˜çš„å®¹å™¨å·²ç»å¯åŠ¨ä¸”æ­£å¸¸è¿è¡Œã€‚ kubectlï¼š è¿™æ˜¯ Kubernetes çš„å‘½ä»¤è¡Œé…ç½®å·¥å…·ã€‚ æ›´å¤šå†…å®¹è¯·æŸ¥çœ‹ Kubernetes æœ¯è¯­è¡¨ 4. Quickstart minikubeå¯åŠ¨ Kubernetes cluster 4.1 Start Minik &amp; create clusterStart Minikube and create a cluster # /tmp/fluentd/etc [14:03:57]âœ minikube startğŸ˜„ minikube v1.5.0 on Darwin 10.14.6âœ¨ Automatically selected the &#x27;hyperkit&#x27; driverğŸ’¾ Downloading driver docker-machine-driver-hyperkit: 4.2 create a k8s DeploymentLetâ€™s create a Kubernetes Deployment using an existing image named echoserver, which is a simple HTTP server and expose it on port 8080 using â€”port. âœ kubectl create deployment hello-minikube --image=k8s.gcr.io/echoserver:1.10deployment.apps/hello-minikube created 4.3 hello-minikube DeploymentTo access the hello-minikube Deployment, expose it as a Service: âœ kubectl expose deployment hello-minikube --type=NodePort --port=8080service/hello-minikube exposed 4.4 view hello-minikube PodThe hello-minikube Pod is now launched but you have to wait until the Pod is up before accessing it via the exposed Service. If the output shows the STATUS as Running, the Pod is now up and running: âœ kubectl get podNAME READY STATUS RESTARTS AGEhello-minikube-797f975945-nrb6r 1/1 Running 0 2m14s(anaconda3) (base) kubectl get cmdï¼š kubectl get nodekubectl get po,svc -n kube-system 4.5 view the Service detailsGet the URL of the exposed Service to view the Service details: âœ minikube service hello-minikube --urlhttp://192.168.64.2:30799(anaconda3) (base) Output: Hostname: hello-minikube-797f975945-nrb6rPod Information: -no pod information available-Server values: server_version=nginx: 1.13.3 - lua: 10008Request Information: client_address=172.17.0.1 method=GET real path=/ query= request_version=1.1 request_scheme=http request_uri=http://192.168.64.2:8080/Request Headers: accept=text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3 accept-encoding=gzip, deflate accept-language=zh-CN,zh;q=0.9,zh-TW;q=0.8,en-US;q=0.7,en;q=0.6 connection=keep-alive host=192.168.64.2:30799 upgrade-insecure-requests=1 user-agent=Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/77.0.3865.120 Safari/537.36Request Body: -no body in request- 4.6 delete hello-minik servicekubectl delete services hello-minikube 4.7 delete hello-minik deploymé”€æ¯è¯¥ Deploymentï¼ˆå’Œå®ƒçš„ podï¼‰ kubectl delete deployment hello-minikube 4.8 stop Minikube clusterminikube stop 4.9 delete Minikube clusterminikube delete 5. Kubernetes hexoDocker ç”¨æˆ·ä½¿ç”¨ kubectl å‘½ä»¤æŒ‡å— Kubernetes æ”¯æŒä¸¤ç§æ–¹å¼åˆ›å»ºèµ„æºï¼š ç”¨ kubectl å‘½ä»¤ç›´æ¥åˆ›å»ºï¼Œæ¯”å¦‚ï¼š kubectl run nginx-deployment --image=nginx:1.7.9 --replicas=2åœ¨å‘½ä»¤è¡Œä¸­é€šè¿‡å‚æ•°æŒ‡å®šèµ„æºçš„å±æ€§. é€šè¿‡é…ç½®æ–‡ä»¶å’Œ kubectl apply åˆ›å»ºï¼Œè¦å®Œæˆå‰é¢åŒæ ·çš„å·¥ä½œï¼Œå¯æ‰§è¡Œå‘½ä»¤ï¼š kubectl apply -f nginx.ymlkubectl apply ä¸ä½†èƒ½å¤Ÿåˆ›å»º Kubernetes èµ„æºï¼Œä¹Ÿèƒ½å¯¹èµ„æºè¿›è¡Œæ›´æ–°ï¼Œéå¸¸æ–¹ä¾¿ã€‚ Kubernets è¿˜æä¾›äº†å‡ ä¸ªç±»ä¼¼çš„å‘½ä»¤ï¼Œä¾‹å¦‚: kubectl create, kubectl replace kubectl edit, kubectl patch 5.1 kubectl cluster-info cmdkubectl cluster-info âœ kubectl cluster-infoKubernetes master is running at https://192.168.64.2:8443KubeDNS is running at https://192.168.64.2:8443/api/v1/namespaces/kube-system/services/kube-dns:dns/proxy kubectl get po,svc -n kube-system âœ kubectl get po,svc -n kube-systemNAME READY STATUS RESTARTS AGEpod/coredns-5644d7b6d9-2qtds 1/1 Running 0 25hpod/coredns-5644d7b6d9-w8442 1/1 Running 0 25hpod/etcd-minikube 1/1 Running 0 25hpod/kube-addon-manager-minikube 1/1 Running 0 25hpod/kube-apiserver-minikube 1/1 Running 0 25hpod/kube-controller-manager-minikube 1/1 Running 1 25hpod/kube-proxy-k2pgh 1/1 Running 0 25hpod/kube-scheduler-minikube 1/1 Running 2 25hpod/storage-provisioner 1/1 Running 0 25hNAME TYPE CLUSTER-IP EXTERNAL-IP PORT(S) AGEservice/kube-dns ClusterIP 10.96.0.10 &lt;none&gt; 53/UDP,53/TCP,9153/TCP 25h 5.2 Create deployment hexo4kubectl run --image=blair101/ubuntu-hexo-blog:v1.4 hexo4 --port=4000 --env=&quot;DOMAIN=cluster&quot; åˆ›å»ºä¸€ä¸ª deployment, name: hexo4, ä¹Ÿä¼šç”Ÿæˆä¸€ä¸ª pod, å¯é€šè¿‡ kubectl edit deploy hexo4 ä¿®æ”¹å‰¯æœ¬æ•°ä¸º2 âœ kubectl get deploy,svcNAME READY UP-TO-DATE AVAILABLE AGEdeployment.apps/hexo4 2/2 2 2 8m34sNAME READY STATUS RESTARTS AGEpod/hexo4-67f54d9bd9-8gzt9 1/1 Running 0 8m34spod/hexo4-67f54d9bd9-dvzht 1/1 Running 0 3s k8s ç«¯å£æ˜ å°„ æŸ¥çœ‹è¯¦ç»† deploy hexo4 -o yaml kubectl get deploy hexo4 -o yaml apiVersion: apps/v1kind: Deploymentmetadata: annotations: deployment.kubernetes.io/revision: &quot;1&quot; creationTimestamp: null generation: 1 labels: run: hexo4 name: hexo4 selfLink: /apis/apps/v1/namespaces/default/deployments/hexo4spec: progressDeadlineSeconds: 600 replicas: 2 revisionHistoryLimit: 10 selector: matchLabels: run: hexo4 strategy: rollingUpdate: maxSurge: 25% maxUnavailable: 25% type: RollingUpdate template: metadata: creationTimestamp: null labels: run: hexo4 spec: containers: - env: - name: DOMAIN value: cluster image: blair101/ubuntu-hexo-blog:v1.4 imagePullPolicy: IfNotPresent name: hexo4 ports: - containerPort: 4000 protocol: TCP resources: &#123;&#125; terminationMessagePath: /dev/termination-log terminationMessagePolicy: File dnsPolicy: ClusterFirst restartPolicy: Always schedulerName: default-scheduler securityContext: &#123;&#125; terminationGracePeriodSeconds: 30status: &#123;&#125;(anaconda3) (base) ä¸€äº›å¸¸ç”¨å‘½ä»¤è®°å½•ï¼š kubectl describe po hexo4-67f54d9bd9-ffnspkubectl exec -it hexo4-67f54d9bd9-ffnsp bashkubectl get po hexo4-5b97779b7c-8z8ns -o yaml --exportkubectl get deploy hexo4 -o yaml --export | tee deploy-v1.yamlkubectl apply -f deploy-v5.yaml 5.3 Create service hexo4kubectl expose deployment hexo4 --port=4000 --name=hexo4 æŸ¥çœ‹ service, kubectl edit svc hexo4 âœ kubectl get deploy, po, svcNAME READY UP-TO-DATE AVAILABLE AGEdeployment.apps/hexo4 2/2 2 2 54mNAME READY STATUS RESTARTS AGEpod/hexo4-67f54d9bd9-8gzt9 1/1 Running 0 54mpod/hexo4-67f54d9bd9-dvzht 1/1 Running 0 45mNAME TYPE CLUSTER-IP EXTERNAL-IP PORT(S) AGEservice/hexo4 ClusterIP 10.97.151.174 &lt;none&gt; 4000/TCP 35sservice/kubernetes ClusterIP 10.96.0.1 &lt;none&gt; 443/TCP 26h æŸ¥çœ‹ service hexo4 è¯¦æƒ…: âœ kubectl get svc -o yaml hexo4apiVersion: v1kind: Servicemetadata: creationTimestamp: &quot;2019-10-30T03:56:49Z&quot; labels: run: hexo4 name: hexo4 namespace: default resourceVersion: &quot;48479&quot; selfLink: /api/v1/namespaces/default/services/hexo4 uid: e1c9c30b-d3b8-4625-9817-a14ea3677bd3spec: clusterIP: 10.97.151.174 ports: - port: 4000 protocol: TCP targetPort: 4000 selector: run: hexo4 sessionAffinity: None type: ClusterIPstatus: loadBalancer: &#123;&#125;(anaconda3) (base) 5.4 kubectl edit service hexo4kubectl edit service hexo4 type: ClusterIP â€”&gt; NodePort ä¸” spec.ports å¢åŠ  nodePort: 30001 spec: clusterIP: 10.107.236.48 externalTrafficPolicy: Cluster ports: - nodePort: 30001 port: 4000 protocol: TCP targetPort: 4000 selector: run: hexo4 sessionAffinity: None type: NodePort 5.5 build hexo5, deploy ervicecreate deployment hexo5 kubectl run --image=blair101/ubuntu-hexo-blog:v1.5 hexo5 --port=4000 --env=&quot;DOMAIN=cluster&quot; create service hexo5 kubectl expose deployment hexo5 --port=4000 --name=hexo5 kubectl edit service hexo5 type: ClusterIP â€”&gt; NodePort ä¸” spec.ports å¢åŠ  nodePort: 30001 5.6 modify service hexo4æ›´æ”¹ selector.run: hexo4 ä¸º hexo5 spec: clusterIP: 10.107.236.48 externalTrafficPolicy: Cluster ports: - nodePort: 30001 port: 4000 protocol: TCP targetPort: 4000 selector: run: hexo5 sessionAffinity: None type: NodePort æ¥ä¸‹æ¥æ˜¯ä¸€äº› delete æ“ä½œ. Reference kubernetes.io Kubernetes with Minikube Install Minikube Github kubernetes Kubernetes é¡¹ç›®Â· Docker â€”â€” ä»å…¥é—¨åˆ°å®è·µ - yeasy ä»0åˆ°1ä½¿ç”¨Kubernetesç³»åˆ— çŸ¥ä¹ï¼š Kubernetes æ˜¯ä»€ä¹ˆï¼Ÿ éƒ‘å»ºå‹‹ï¼ˆjonsonï¼‰K8S å®˜ç½‘ k8s æ¦‚å¿µ &amp; å¯¹è±¡ Docker ç”¨æˆ·ä½¿ç”¨ kubectl å‘½ä»¤æŒ‡å— Get a Shell to a Running Container Labelï¼Œ Deploymentï¼Œ Service å’Œ å¥åº·æ£€æŸ¥","categories":[{"name":"devops","slug":"devops","permalink":"http://iequa.com/categories/devops/"}],"tags":[{"name":"Kubernetes","slug":"Kubernetes","permalink":"http://iequa.com/tags/Kubernetes/"}]},{"title":"Tech Stack","slug":"devops/tech_stack","date":"2019-10-28T09:11:21.000Z","updated":"2020-12-06T06:18:48.099Z","comments":true,"path":"2019/10/28/devops/tech_stack/","link":"","permalink":"http://iequa.com/2019/10/28/devops/tech_stack/","excerpt":"","text":"1. Python env conda python &gt; 3.6 2. Data Process numpy pandas scikit-learn scipy matplotlib 3. Deep Learning tensorflow pytorch keras 4. NLP nltk spacy bert 5. System Dev5.1 Dev tensorflow serving flask flask-restplus pytest pyinvoke gunicorn 5.2 Libraries pydash dotenv fabric pathlib 5.2 Tools Cyberduck 6. System Test pytest nose locust mitmproxy 7. Log Collection fluentd elastic 8. CI/CD gitlab docker kubernetes Reference","categories":[{"name":"devops","slug":"devops","permalink":"http://iequa.com/categories/devops/"}],"tags":[{"name":"Stack","slug":"Stack","permalink":"http://iequa.com/tags/Stack/"}]},{"title":"Fluentd tutorial","slug":"devops/fluentd_td-agent","date":"2019-10-23T09:11:21.000Z","updated":"2019-11-12T02:17:36.442Z","comments":true,"path":"2019/10/23/devops/fluentd_td-agent/","link":"","permalink":"http://iequa.com/2019/10/23/devops/fluentd_td-agent/","excerpt":"","text":"1. Fluentd what?Fluentd is an open source data collector for unified logging layer. Fluentd allows you to unify data collection and consumption for a better use and understanding of data. 2. Fluentd dockerDocker æä¾›å¾ˆå¤š logging driverï¼Œé»˜è®¤ä¸‹ç”¨çš„ json-fileï¼Œdocker logs çœ‹åˆ°çš„æ—¥å¿—å°±æ˜¯æ¥è‡ªäºè¿™äº›jsonæ–‡ä»¶. å½“æœ‰å¤šä¸ªdocker hostçš„æ—¶å€™ä½ ä¼šå¸Œæœ›èƒ½å¤ŸæŠŠæ—¥å¿—æ±‡é›†èµ·æ¥ï¼Œé›†ä¸­å­˜æ”¾åˆ°ä¸€å¤„. æœ¬æ–‡è®²çš„æ˜¯å¦‚ä½•é€šè¿‡ fluentd logging driver é…åˆ fluentd æ¥è¾¾æˆè¿™ä¸€ç›®æ ‡ã€‚ Targetï¼š å°†standaloneå®¹å™¨æ‰“åˆ°stdout/stderrorçš„æ—¥å¿—æ”¶é›†èµ·æ¥ æ”¶é›†çš„æ—¥å¿—æ ¹æ®å®¹å™¨ååˆ†å¼€å­˜å‚¨ æ—¥å¿—æ–‡ä»¶æ ¹æ®æ¯å¤©æ»šåŠ¨ 2.1 é…ç½® Fluentd å®ä¾‹fluent.conf &lt;source&gt; @type forward&lt;/source&gt; &lt;match *&gt; @type file path /fluentd/log/$&#123;tag&#125;/$&#123;tag&#125; append true &lt;format&gt; @type single_value message_key log &lt;/format&gt; &lt;buffer tag,time&gt; @type file timekey 1d timekey_wait 10m flush_mode interval flush_interval 30s &lt;/buffer&gt;&lt;/match&gt; æ–°å»ºç›®å½• container-logsï¼Œ è®¾ç½® 777 æƒé™ # ~/ghome/home/ub [17:57:07]âœ lltotal 0drwxrwxrwx 5 blair staff 160B Oct 24 17:50 container-logsdrwxr-xr-x 4 blair staff 128B Oct 23 18:06 fluentd(base)# ~/ghome/home/ub [17:57:07] å¯åŠ¨Fluentdå®ä¾‹ï¼Œè¿™é‡Œä½¿ç”¨çš„Dockeræ–¹å¼ï¼š docker run -it \\ -d \\ -p 24224:24224 \\ -v /Users/blair/ghome/home/ub/fluentd/conf/fluent.conf:/fluentd/etc2/fluent.conf \\ -v /Users/blair/ghome/home/ub/container-logs:/fluentd/log \\ fluent/fluentd:v1.7.3-debian-1.0 2.2 æŒ‡å®š logging driverdocker run \\ -d \\ --log-driver=fluentd \\ --log-opt fluentd-address=&lt;fluentdhost&gt;:24224 \\ --log-opt mode=non-blocking \\ --log-opt tag=&#123;&#123;.Name&#125;&#125; \\ --rm -p 4000:4000 blair101/ubuntu-hexo-blog:v1.4 &lt;fluentdhost&gt; å‚æ•°ä¸å†™åˆ™æ˜¯æŒ‡æœ¬æœº. 2.3 è§‚å¯Ÿæ—¥å¿—# ~/ghome/home/ub [18:00:10]âœ ll container-logstotal 16-rw-r--r-- 1 blair staff 470B Oct 24 17:47 data.b595a4ec02f220b1ce9d68e14ca1fc303.log-rw-r--r-- 1 blair staff 74B Oct 24 17:47 data.b595a4ec02f220b1ce9d68e14ca1fc303.log.metalrwxrwxrwx 1 blair staff 55B Oct 24 17:47 data.log -&gt; /fluentd/log/data.b595a4ec02f220b1ce9d68e14ca1fc303.log(base)# ~/ghome/home/ub [18:00:12] 3. Fluentd docker + nginxæœ¬æœº /tmp/fluentd/etc ä¸‹åˆ›å»ºfluentd.conf &lt;source&gt;@type forward&lt;/source&gt;&lt;match *&gt; @type file path /fluentd/log/app.log append true&lt;/match&gt; 3.1 Fluentd Containerdocker run -d \\-p 24224:24224 \\-v /tmp/fluentd/etc:/fluentd/etc -e FLUENTD_CONF=fluentd.conf \\-v /tmp/container-logs:/fluentd/log \\fluent/fluentd æŸ¥çœ‹æ—¥å¿— docker logs 2e6d50875a07 3.2 Nginx Containerdocker run -d --log-driver fluentd --log-opt fluentd-address=localhost:24224 --log-opt tag=&quot;nginx-test&quot; --log-opt fluentd-async-connect --name nginx-test -p 9080:80 nginx 3.3 Curl testcurl -X GET http://localhost:9080 3.4 æŸ¥çœ‹æ—¥å¿—# /tmp/container-logs/app.log [19:02:53]âœ cat buffer.b595a5b11618618c6459a69df40de5e79.log2019-10-24T10:42:36+00:00 nginx-test &#123;&quot;container_id&quot;:&quot;53929d5422b0d74cd47f9fa3f6a21e63dd0a559b570631034118b4185435f266&quot;,&quot;container_name&quot;:&quot;/nginx-test&quot;,&quot;source&quot;:&quot;stdout&quot;,&quot;log&quot;:&quot;172.17.0.1 - - [24/Oct/2019:10:42:36 +0000] \\&quot;GET / HTTP/1.1\\&quot; 200 612 \\&quot;-\\&quot; \\&quot;curl/7.55.1\\&quot; \\&quot;-\\&quot;&quot;&#125;2019-10-24T10:46:04+00:00 nginx-test &#123;&quot;container_id&quot;:&quot;35dcb86564324032d5a4736d5e7bcfe78e6c2ead1408b9be85c60ac113d0de43&quot;,&quot;container_name&quot;:&quot;/nginx-test&quot;,&quot;source&quot;:&quot;stdout&quot;,&quot;log&quot;:&quot;172.17.0.1 - - [24/Oct/2019:10:46:04 +0000] \\&quot;GET / HTTP/1.1\\&quot; 200 612 \\&quot;-\\&quot; \\&quot;curl/7.55.1\\&quot; \\&quot;-\\&quot;&quot;&#125;2019-10-24T10:47:03+00:00 nginx-test &#123;&quot;log&quot;:&quot;172.17.0.1 - - [24/Oct/2019:10:47:03 +0000] \\&quot;GET / HTTP/1.1\\&quot; 200 612 \\&quot;-\\&quot; \\&quot;curl/7.55.1\\&quot; \\&quot;-\\&quot;&quot;,&quot;container_id&quot;:&quot;35dcb86564324032d5a4736d5e7bcfe78e6c2ead1408b9be85c60ac113d0de43&quot;,&quot;container_name&quot;:&quot;/nginx-test&quot;,&quot;source&quot;:&quot;stdout&quot;&#125;2019-10-24T10:48:12+00:00 nginx-test &#123;&quot;log&quot;:&quot;172.17.0.1 - - [24/Oct/2019:10:48:12 +0000] \\&quot;GET / HTTP/1.1\\&quot; 200 612 \\&quot;-\\&quot; \\&quot;curl/7.55.1\\&quot; \\&quot;-\\&quot;&quot;,&quot;container_id&quot;:&quot;35dcb86564324032d5a4736d5e7bcfe78e6c2ead1408b9be85c60ac113d0de43&quot;,&quot;container_name&quot;:&quot;/nginx-test&quot;,&quot;source&quot;:&quot;stdout&quot;&#125;(base)# /tmp/container-logs/app.log [19:02:55]âœ 4. Fluent-Logger-Pythonfluentd.conf &lt;source&gt; @type forward port 24224&lt;/source&gt;&lt;match fluentd.test.**&gt; @type stdout&lt;/match&gt; Please restart your agent once these lines are in place. docker run --rm \\-d \\-p 24224:24224 \\-v /tmp/fluentd/etc:/fluentd/etc -e FLUENTD_CONF=fluentd.conf \\-v /tmp/container-logs:/fluentd/log \\fluent/fluentd 4.1 Event-Based InterfaceFirst, install the fluent-logger library via pip. pip install fluent-logger Next, initialize and post the records as shown below. # test.pyfrom fluent import senderfrom fluent import eventsender.setup(&#x27;fluentd.test&#x27;, host=&#x27;localhost&#x27;, port=24224)event.Event(&#x27;follow&#x27;, &#123; &#x27;from&#x27;: &#x27;userA&#x27;, &#x27;to&#x27;: &#x27;userB&#x27;&#125;) Executing the script will send the logs to Fluentd # /tmp/fluentd/etc [14:21:01]âœ python test.py show docker fluentd log # /tmp/fluentd/etc [14:21:11]âœ docker logs cda923986a28 2019-10-25 06:19:57 +0000 [info]: parsing config file is succeeded path=&quot;/fluentd/etc/fluentd.conf&quot;.........2019-10-25 06:21:11.000000000 +0000 fluentd.test.follow: &#123;&quot;from&quot;:&quot;userA&quot;,&quot;to&quot;:&quot;userB&quot;&#125;(anaconda3) (base) #fluentsender-interface 4.2 FluentSender Interfacefluentd.conf &lt;source&gt; @type forward port 24224&lt;/source&gt;&lt;match fluentd.test.**&gt; @type stdout&lt;/match&gt;&lt;match app.**&gt; type stdout&lt;/match&gt; app.py from fluent import senderfrom fluent import eventimport time&#x27;&#x27;&#x27; FluentSender Interface sender.FluentSender is a structured event logger for Fluentd. By default, the logger assumes fluentd daemon is launched locally. You can also specify remote logger by passing the options.&#x27;&#x27;&#x27;# for local fluentlogger = sender.FluentSender(&#x27;app&#x27;)# for remote fluentlogger = sender.FluentSender(&#x27;app&#x27;, host=&#x27;localhost&#x27;, port=24224)# Specify optional timecur_time = int(time.time())logger.emit_with_time(&#x27;follow&#x27;, cur_time, &#123;&#x27;from&#x27;: &#x27;userA&#x27;, &#x27;to&#x27;:&#x27;userB&#x27;&#125;) 4.3 Handler for buffer overflowYou can inject your own custom proc to handle buffer overflow in the event of connection failure. This will mitigate the loss of data instead of simply throwing data away. from fluent import senderfrom fluent import eventimport timeimport msgpackfrom io import BytesIOdef overflow_handler(pendings): unpacker = msgpack.Unpacker(BytesIO(pendings)) for unpacked in unpacker: print(unpacked)# for local fluentlogger = sender.FluentSender(&#x27;app&#x27;)# for remote fluentlogger = sender.FluentSender(&#x27;app&#x27;, host=&#x27;localhost&#x27;, port=24224)# Specify optional timecur_time = int(time.time())# logger.emit_with_time(&#x27;follow&#x27;, cur_time, &#123;&#x27;from&#x27;: &#x27;userA&#x27;, &#x27;to&#x27;:&#x27;userB&#x27;&#125;)# Use nanosecondlogger = sender.FluentSender(&#x27;app&#x27;, nanosecond_precision=True)logger = sender.FluentSender(&#x27;app&#x27;, host=&#x27;localhost&#x27;, port=24224, buffer_overflow_handler=overflow_handler)logger.emit(&#x27;follow&#x27;, &#123;&#x27;from&#x27;: &#x27;userA&#x27;, &#x27;to&#x27;: &#x27;userB&#x27;&#125;)logger.emit_with_time(&#x27;follow&#x27;, time.time(), &#123;&#x27;from&#x27;: &#x27;userA&#x27;, &#x27;to&#x27;: &#x27;userB&#x27;&#125;)logger.close() 4.4 Python logging.Handler interfaceThis client-library also has FluentHandler class for Python logging module. import loggingfrom fluent import handlerimport msgpackfrom io import BytesIOcustom_format = &#123; &#x27;host&#x27;: &#x27;%(hostname)s&#x27;, &#x27;where&#x27;: &#x27;%(module)s.%(funcName)s&#x27;, &#x27;type&#x27;: &#x27;%(levelname)s&#x27;, &#x27;stack_trace&#x27;: &#x27;%(exc_text)s&#x27;&#125;logging.basicConfig(level=logging.INFO)def overflow_handler(pendings): unpacker = msgpack.Unpacker(BytesIO(pendings)) for unpacked in unpacker: print(unpacked)l = logging.getLogger(&#x27;fluent.test&#x27;)h = handler.FluentHandler(&#x27;app.follow&#x27;, host=&#x27;localhost&#x27;, port=24224, buffer_overflow_handler=overflow_handler)formatter = handler.FluentRecordFormatter(custom_format)h.setFormatter(formatter)l.addHandler(h)l.info(&#123; &#x27;from&#x27;: &#x27;userA&#x27;, &#x27;to&#x27;: &#x27;userB&#x27;&#125;)l.info(&#x27;&#123;&quot;from&quot;: &quot;userC&quot;, &quot;to&quot;: &quot;userD&quot;&#125;&#x27;)l.info(&quot;This log entry will be logged with the additional key: &#x27;message&#x27;.&quot;) ä½¿ç”¨æ­¥éª¤æ€»ç»“ï¼š FluentHandler (å¹¶å¯è®¾ç½® formatter) logging instance , l.addHandler(h) è‡ªå®šä¹‰æ ¼å¼åŒ–ç¨‹åº ä½ è¿˜å¯ä»¥é€šè¿‡ logging.config.dictConfig è‡ªå®šä¹‰æ ¼å¼åŒ–ç¨‹åº import logging.configimport yamlwithopen(&#x27;logging.yaml&#x27;) as fd: conf = yaml.load(fd)logging.config.dictConfig(conf[&#x27;logging&#x27;]) ä½ å¯ä»¥åœ¨è¿æ¥å¤±è´¥æ—¶æ’å…¥è‡ªå·±çš„è‡ªå®šä¹‰è¿‡ç¨‹æ¥å¤„ç†ç¼“å†²åŒºæº¢å‡ºã€‚ è¿™å°†å‡å°‘æ•°æ®çš„ä¸¢å¤±ï¼Œè€Œä¸æ˜¯ç®€å•åœ°ä¸¢å¼ƒæ•°æ®ã€‚ logging: version: 1 formatters: brief: format: &#x27;%(message)s&#x27; default: format: &#x27;%(asctime)s %(levelname)-8s %(name)-15s %(message)s&#x27; datefmt: &#x27;%Y-%m-%d %H:%M:%S&#x27; fluent_fmt: &#x27;()&#x27;: fluent.handler.FluentRecordFormatter format: level: &#x27;%(levelname)s&#x27; hostname: &#x27;%(hostname)s&#x27; where: &#x27;%(module)s.%(funcName)s&#x27; handlers: console: class : logging.StreamHandler level: DEBUG formatter: default stream: ext://sys.stdout fluent: class: fluent.handler.FluentHandler host: localhost port: 24224 tag: app.follow buffer_overflow_handler: overflow_handler formatter: fluent_fmt level: DEBUG none: class: logging.NullHandler loggers: amqp: handlers: [none] propagate: False conf: handlers: [none] propagate: False &#x27;&#x27;: # root logger handlers: [console, fluent] level: DEBUG propagate: False Reference docs.fluentd.org fluentd docker Fluentdå…¥é—¨æ•™ç¨‹ fluentdä¹‹mac install &amp; test fluentd-ä¸è² è²¬ä»»çš„å­¸ç¿’ç­†è¨˜ ä½¿ç”¨Fluentdæ”¶é›†Dockerå®¹å™¨æ—¥å¿— fluentdæ”¶é›†dockerå®¹å™¨æ—¥å¿— Dockerå®‰è£…Fluentdå¹¶ç®¡ç† Docker æ—¥å¿— fluent-logger-python github.com/fluent/fluent-logger-python fluent-logger-python, ç”¨æ–¼Fluentdçš„çµæ§‹åŒ–è¨˜éŒ„å™¨( python ) fluentdä¸­bufferé…ç½® fluentdæ’ä»¶ä»‹ç»","categories":[{"name":"devops","slug":"devops","permalink":"http://iequa.com/categories/devops/"}],"tags":[{"name":"Fluentd","slug":"Fluentd","permalink":"http://iequa.com/tags/Fluentd/"}]},{"title":"BERT tutorial","slug":"nlp/BERT_tutorial_3","date":"2019-10-23T03:00:21.000Z","updated":"2019-11-01T02:48:14.767Z","comments":true,"path":"2019/10/23/nlp/BERT_tutorial_3/","link":"","permalink":"http://iequa.com/2019/10/23/nlp/BERT_tutorial_3/","excerpt":"","text":"2018.10 google å‘å¸ƒ BERT æ¨¡å‹. å¼•çˆ†æ•´ä¸ªAIåœˆçš„ NLP æ¨¡å‹. åœ¨ NLPé¢†åŸŸ åˆ·æ–° 11 é¡¹è®°å½•. BERT is language_encoderï¼ŒæŠŠè¾“å…¥çš„ sentence æˆ– paragraph è½¬æˆ feature_vector(embedding). Paper: BERT: Pre-training of Deep Bidirectional Transformers for Language Understanding BERT åˆ›æ–°ç‚¹åœ¨äºæå‡ºäº†ä¸€å¥—å®Œæ•´çš„æ–¹æ¡ˆï¼Œåˆ©ç”¨ä¹‹å‰æœ€æ–°çš„ç®—æ³•æ¨¡å‹ï¼Œå»è§£å†³å„ç§å„æ ·çš„ NLP ä»»åŠ¡. NLP çš„ 4 å¤§ä»»åŠ¡ (1). åºåˆ—æ ‡æ³¨. (2). åˆ†ç±»ä»»åŠ¡ (3). å¥å­å…³ç³»åˆ¤æ–­ (4). ç”Ÿæˆå¼ä»»åŠ¡ BERTçš„ç›®çš„æ˜¯é¢„è®­ç»ƒè¯­è¨€æ¨¡å‹ï¼Œç®€å•æ¥è¯´å°±æ˜¯é¢„è®­ç»ƒä¸€ä¸ªæ¨¡å‹å¯ä»¥å¯¹å¥å­è¿›è¡Œembeddingï¼Œå…¶ä½œç”¨å¯ä»¥ç±»æ¯”word embeddingã€‚è®ºæ–‡é¦–å…ˆå¯¹Language model pre-trainingçš„æ–¹æ³•è¿›è¡Œäº†ä»‹ç»ï¼Œä¸€ä¸ªæ˜¯Feature-basedçš„æ–¹æ³•ï¼Œä¾‹å¦‚ELMoï¼Œä¸€ä¸ªæ˜¯Fine-tuningçš„æ–¹æ³•ï¼Œä¾‹å¦‚OpenAI GPTï¼ŒBERTåŒæ ·å±äºåè€…ã€‚é‚£ä¹ˆBERTæ˜¯å¦‚ä½•é¢„è®­ç»ƒçš„å‘¢ï¼Ÿ é‚£ä¹ˆBERTæ˜¯å¦‚ä½•é¢„è®­ç»ƒçš„å‘¢ï¼Ÿ Task1ï¼š Masked Language Modelæ€æƒ³å¾ˆç®€å•ï¼Œå°±æ˜¯éšæœºmaskå¥å­ä¸­çš„ä¸€éƒ¨åˆ†è¯ï¼Œç›®æ ‡æ˜¯åˆ©ç”¨å…¶å®ƒè¯å»é¢„æµ‹è¢«maskæ‰çš„è¯ã€‚ å…·ä½“BERTé‡‡å–çš„ç­–ç•¥å¦‚ä¸‹ï¼š æ–‡ä¸­è§£é‡Šå¹¶ä¸100%è¿›è¡Œmaskçš„åŸå› æ˜¯ä¸ºäº†ä¿æŒpre-trainingä¸fine-tuningçš„ä¸€è‡´ï¼Œå› ä¸ºfine-tuningçš„æ—¶å€™å¹¶ä¸èƒ½çœ‹åˆ°[mask]ã€‚è‡³äºå¼•å…¥éšæœºwordçš„åŸå› ä¸ªäººæ„Ÿè§‰ä»…ä»…æ˜¯å¼•å…¥ä¸€äº›å™ªå£°ä»è€Œä½¿æ¨¡å‹æ›´ç¨³å¥ï¼Œå…·æœ‰ä¸€å®šçº é”™èƒ½åŠ›ã€‚ä¸€ç‚¹ç‰µå¼ºçš„ç†ç”±æ˜¯æ–‡ä¸­å¼ºè°ƒäº†å’Œdenoising auto-encodersçš„åŒºåˆ«ã€‚ Transformerä¸BERTæµ…è¯´ Task2ï¼š Next Sentence PredictionNSP ç®€å•è¯´å°±æ˜¯é¢„æµ‹ å¥å­B æ˜¯å¦æ‰¿æ¥ å¥å­Aï¼Œå…·ä½“ BERT çš„ç­–ç•¥æ˜¯ï¼š (1). 50%Bæ˜¯Açš„ä¸‹æ–‡ï¼Œlabel=IsNext (2). 50%ä¸æ˜¯ï¼Œlabel=NotNext ä¹Ÿå°±æ˜¯ä¸ªäºŒåˆ†ç±»é—®é¢˜ã€‚ pre-training è¿‡ç¨‹åŒæ—¶ä¼˜åŒ–ä¸Šé¢ä¸¤ä¸ªä»»åŠ¡ï¼Œå…¶ç»“æŸåå°±å¯ä»¥åœ¨ç‰¹å®šä»»åŠ¡ä¸Šè¿›è¡Œ fine-tuningï¼Œä»…éœ€åœ¨BERTçš„åŸºç¡€ä¸Šå¢åŠ ç›¸åº”çš„ output layer å³å¯. Reference å¼ ä¿Šæ—: å¤©ç©ºä¹‹åŸï¼šæ‹‰é©¬åŠªé‡‘å¼æ€ç»´è®­ç»ƒæ³• äº’è”ç½‘äººåˆ°äº† 30 å²ï¼Œå¤§éƒ¨åˆ†éƒ½å»å¹²ä»€ä¹ˆäº†ï¼Ÿ AINLP BERTç›¸å…³è®ºæ–‡ã€æ–‡ç« å’Œä»£ç èµ„æºæ±‡æ€» è‡ªç„¶è¯­è¨€å¤„ç†ä¸­çš„Transformerå’ŒBERT RNNå’ŒLSTMå¼±ï¼çˆ†ï¼äº†ï¼æ³¨æ„åŠ›æ¨¡å‹æ‰æ˜¯ç‹é“ NLPçªç ´æ€§æˆæœ BERT æ¨¡å‹è¯¦ç»†è§£è¯» ä¸€æ­¥æ­¥ç†è§£BERT å½“Berté‡ä¸ŠKerasï¼šè¿™å¯èƒ½æ˜¯Bertæœ€ç®€å•çš„æ‰“å¼€å§¿åŠ¿ BERTå®Œå…¨æŒ‡å— è‡ªç„¶è¯­è¨€å¤„ç†ä¸­çš„Transformerå’ŒBERT","categories":[{"name":"nlp","slug":"nlp","permalink":"http://iequa.com/categories/nlp/"}],"tags":[{"name":"BERT","slug":"BERT","permalink":"http://iequa.com/tags/BERT/"}]},{"title":"Developer's manual","slug":"devops/developer-manual","date":"2019-10-20T09:11:21.000Z","updated":"2020-12-06T06:16:19.453Z","comments":true,"path":"2019/10/20/devops/developer-manual/","link":"","permalink":"http://iequa.com/2019/10/20/devops/developer-manual/","excerpt":"","text":"é˜®ä¸€å³°: Docker å…¥é—¨æ•™ç¨‹ é˜®ä¸€å³°: Docker å¾®æœåŠ¡æ•™ç¨‹ é˜®ä¸€å³°: developer æ‰‹å†Œ é˜®ä¸€å³°: RESTful API æœ€ä½³å®è·µ é˜®ä¸€å³°: RESTful API è®¾è®¡æŒ‡å— é˜®ä¸€å³°: MVCï¼ŒMVP å’Œ MVVM çš„å›¾ç¤º é˜®ä¸€å³°: Linuxçš„äº”ä¸ªæŸ¥æ‰¾å‘½ä»¤ é˜®ä¸€å³°: curl çš„ç”¨æ³•æŒ‡å— CoolShell: æ‰“é€ é«˜æ•ˆçš„å·¥ä½œç¯å¢ƒ â€“ SHELL ç¯‡ CoolShell: è®°ä¸€æ¬¡KUBERNETES/DOCKERç½‘ç»œæ’éšœ CoolShell: ç¨‹åºå‘˜æŠ€æœ¯ç»ƒçº§æ”»ç•¥ å»–é›ªå³°çš„å®˜æ–¹ç½‘ç«™ devops é˜®ä¸€å³°: awk å…¥é—¨æ•™ç¨‹ é˜®ä¸€å³°: xargs å‘½ä»¤æ•™ç¨‹ é˜®ä¸€å³°: Vim é…ç½®å…¥é—¨ é˜®ä¸€å³°: å‘½ä»¤è¡Œé€šé…ç¬¦æ•™ç¨‹ é˜®ä¸€å³°: ä¸ºä»€ä¹ˆæ–‡ä»¶åè¦å°å†™ï¼Ÿ é˜®ä¸€å³°: YAML è¯­è¨€æ•™ç¨‹ é˜®ä¸€å³°: Linux Serverçš„åˆæ­¥é…ç½®æµç¨‹ é˜®ä¸€å³°: è¯»æ‡‚diff Steve Yegge ç¨‹åºå‘˜çš„å‘å–Š other æˆ‘çš„Tweetæ¡£æ¡ˆ æ„Ÿè°¢å»–é›ªå³°å¸®åŠ© é™ˆçš“è¯»è¿‡çš„ä¹¦(72)","categories":[{"name":"devops","slug":"devops","permalink":"http://iequa.com/categories/devops/"}],"tags":[{"name":"developer","slug":"developer","permalink":"http://iequa.com/tags/developer/"}]},{"title":"æ€ä¹ˆç†è§£ Python3 çš„ cmp_to_keyå‡½æ•°ï¼Ÿ","slug":"python/language/py3_sort_vs_sorted","date":"2019-10-20T02:07:21.000Z","updated":"2020-12-05T01:05:05.657Z","comments":true,"path":"2019/10/20/python/language/py3_sort_vs_sorted/","link":"","permalink":"http://iequa.com/2019/10/20/python/language/py3_sort_vs_sorted/","excerpt":"","text":"# -*- coding: utf-8 -*-&quot;&quot;&quot; @file: tt_sort.py @date: 2020-10-20 10:41 AM&quot;&quot;&quot;import copyfrom functools import cmp_to_keydef rule(a, b): if a &gt; b: return 1 if a &lt; b: return -1 return 0L = [7, 4, 8, 2, 9, 6]L2 = copy.copy(L)L.sort(key=cmp_to_key(rule))print(sorted(L2, key=cmp_to_key(rule)))print(L)# print(L2)print(&#x27;&#x27;.join([str(num) for num in L2])) Reference python sort vs sorted pythonçš„getattrï¼ˆï¼‰å‡½æ•° pythonç±»çš„ç»§æ‰¿ ä¸ºPythonç±»ä½¿ç”¨â€getå‡½æ•°â€æœ‰ä»€ä¹ˆå¥½å¤„ï¼Ÿ","categories":[{"name":"python","slug":"python","permalink":"http://iequa.com/categories/python/"}],"tags":[{"name":"python3","slug":"python3","permalink":"http://iequa.com/tags/python3/"}]},{"title":"Docker + Hexo","slug":"devops/docker-hexo","date":"2019-10-19T09:11:21.000Z","updated":"2019-11-24T13:13:58.761Z","comments":true,"path":"2019/10/19/devops/docker-hexo/","link":"","permalink":"http://iequa.com/2019/10/19/devops/docker-hexo/","excerpt":"","text":"ä¸ºäº†æ›´å¥½çš„å¼•å‡º Docker, å…ˆç®€å•ä»‹ç»ä¸‹ Linux å®¹å™¨: 1. docker what?Docker å±äº Linux å®¹å™¨çš„ä¸€ç§å°è£…ï¼Œæä¾›ç®€å•æ˜“ç”¨çš„å®¹å™¨ä½¿ç”¨æ¥å£ã€‚ 2. dockerfileFROM blair101/ubuntu-hexo-blog:v1.3COPY ./source /blog/sourceWORKDIR /blog#RUN hexo sEXPOSE 4000CMD hexo s 3. markdown é€‚é…æ¸²æŸ“é—®é¢˜npm uninstall hexo-renderer-markdown-itnpm un hexo-renderer-markednpm install hexo-renderer-markdown-it-plus --savenpm install hexo-renderer-kramed --save Reference hexo.io, hexo-server é˜®ä¸€å³°: Docker å…¥é—¨æ•™ç¨‹ é˜®ä¸€å³°: Docker å¾®æœåŠ¡æ•™ç¨‹ è’é‡ä¹‹è: Docker æœ€ç®€æ•™ç¨‹ è’é‡ä¹‹è: Hexo+Github-Dockerfileè‡ªåŠ¨æ­å»º Docker å®¹å™¨ä»å…¥é—¨åˆ°å…¥é­” plugins: Hexo + hexo-asset-image Hexo + hexo-deployer-git Hexo + WordCount Hexo + sitemapã€rss æ¨™ç±¤å¤–æ›ï¼ˆTag Pluginsï¼‰","categories":[{"name":"devops","slug":"devops","permalink":"http://iequa.com/categories/devops/"}],"tags":[{"name":"Docker","slug":"Docker","permalink":"http://iequa.com/tags/Docker/"}]},{"title":"Docker microservices","slug":"devops/docker-wordpress-tutorial","date":"2019-10-14T09:11:21.000Z","updated":"2019-10-20T04:30:34.992Z","comments":true,"path":"2019/10/14/devops/docker-wordpress-tutorial/","link":"","permalink":"http://iequa.com/2019/10/14/devops/docker-wordpress-tutorial/","excerpt":"","text":"ç«™åœ¨ Docker çš„è§’åº¦ï¼ŒSoftware is the combination of Containersï¼š ä¸šåŠ¡é€»è¾‘å®¹å™¨ æ•°æ®åº“å®¹å™¨ å‚¨å­˜å®¹å™¨ â€¦ Docker ä½¿å¾—è½¯ä»¶å¯ä»¥æ‹†åˆ†æˆè‹¥å¹²ä¸ªæ ‡å‡†åŒ–å®¹å™¨ï¼Œç„¶ååƒæ­ç§¯æœ¨ä¸€æ ·ç»„åˆèµ·æ¥ã€‚ è¿™æ­£æ˜¯å¾®æœåŠ¡ï¼ˆmicroservicesï¼‰çš„æ€æƒ³ï¼š è½¯ä»¶æŠŠä»»åŠ¡å¤–åŒ…å‡ºå»ï¼Œè®©å„ç§å¤–éƒ¨æœåŠ¡å®Œæˆè¿™äº›ä»»åŠ¡ï¼Œè½¯ä»¶æœ¬èº«åªæ˜¯åº•å±‚æœåŠ¡çš„è°ƒåº¦ä¸­å¿ƒå’Œç»„è£…å±‚ã€‚ å¦‚ä½•åœ¨ä¸€å°è®¡ç®—æœºä¸Šå®ç°å¤šä¸ª Servicesï¼Œè®©å®ƒä»¬äº’ç›¸é…åˆï¼Œç»„åˆå‡ºä¸€ä¸ª Application: ä¸ºäº†åŠ æ·±ç†è§£ï¼Œé‡‡ç”¨ä¸‰ç§æ–¹æ³•ï¼Œæ¼”ç¤ºå¦‚ä½•æ¶è®¾ WordPress ç½‘ç«™ æ–¹æ³• Aï¼šè‡ªå»º WordPress å®¹å™¨æ–¹æ³• Bï¼šé‡‡ç”¨å®˜æ–¹çš„ WordPress å®¹å™¨æ–¹æ³• Cï¼šé‡‡ç”¨ Docker Compose å·¥å…· 1. è‡ªå»º WordPress Containeræ–¹æ³• Aï¼šè‡ªå»º WordPress Container 1.1 å®˜æ–¹ PHP imagedocker container run \\ -p 8080:80 \\ -it \\ --rm \\ --name wordpress \\ --volume &quot;$PWD/&quot;:/var/www/html php:5.6-apache 1.2 æ‹·è´ WordPress å®‰è£…åŒ…$ wget https://cn.wordpress.org/wordpress-4.9.4-zh_CN.tar.gz$ tar -xvf wordpress-4.9.4-zh_CN.tar.gz 1.3 å®˜æ–¹ MySQL Containerdocker container run \\ -d \\ --rm \\ --name wordpressdb \\ --env MYSQL_ROOT_PASSWORD=123456 \\ --env MYSQL_DATABASE=wordpress \\ mysql:5.7 æŸ¥çœ‹æ­£åœ¨è¿è¡Œçš„å®¹å™¨ âœ docker container lsCONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES228857116d2d mysql:5.7 &quot;docker-entrypoint.sâ€¦&quot; 4 minutes ago Up 4 minutes 3306/tcp, 33060/tcp wordpressdba4c7f3d045a3 php:5.6-apache &quot;docker-php-entrypoiâ€¦&quot; 23 minutes ago Up 23 minutes 0.0.0.0:8080-&gt;80/tcp wordpress(anaconda3) (base)âœ å…¶ä¸­ï¼Œwordpressdbæ˜¯åå°è¿è¡Œçš„ï¼Œå‰å°çœ‹ä¸è§å®ƒçš„è¾“å‡ºï¼Œå¿…é¡»ä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤æŸ¥çœ‹ docker container logs wordpressdb 1.4 å®šåˆ¶ PHP ContainerPHP çš„å®˜æ–¹ image ä¸å¸¦æœ‰mysqlæ‰©å±•ï¼Œå¿…é¡»è‡ªå·±æ–°å»º image æ–‡ä»¶ docker container stop wordpress Create Dockerfile in docker-demo dir FROM php:5.6-apacheRUN docker-php-ext-install mysqliCMD apache2-foreground åŸºäºè¿™ä¸ª Dockerfile æ–‡ä»¶ï¼Œæ–°å»ºä¸€ä¸ªåä¸º phpwithmysql çš„ image æ–‡ä»¶. docker build -t phpwithmysql . 1.5 WordpresspC è¿æ¥ MySQLdocker container run \\ --rm \\ --name wordpress \\ --volume &quot;$PWD/&quot;:/var/www/html \\ --link wordpressdb:mysql \\ phpwithmysql WordPressC è¦è¿åˆ° wordpressdbCï¼Œå†’å·è¡¨ç¤ºè¯¥ Container çš„åˆ«åæ˜¯ mysql . çœ‹åˆ°ä»¥ä¸Šç•Œé¢ï¼Œè‡ªå»ºWPC æ¼”ç¤ºå®Œæ¯•ã€‚ å…³é—­ Containersã€‚ âœ docker container stop wordpress wordpressdb 2. Official WordPress Containeræ–¹æ³• Bï¼šå®˜æ–¹ WordPress Container 2.1 mysql containerdocker container run \\ -d \\ --rm \\ --name wordpressdb \\ --env MYSQL_ROOT_PASSWORD=123456 \\ --env MYSQL_DATABASE=wordpress \\ mysql:5.7 2.2 wordpress containerâœ docker container run \\ -p 8080:80 \\ -d \\ --rm \\ --name wordpress \\ --env WORDPRESS_DB_PASSWORD=123456 \\ --link wordpressdb:mysql \\ wordpress -p 127.0.0.1:8080:80ï¼šå°†å®¹å™¨çš„ 80 ç«¯å£ æ˜ å°„åˆ° 127.0.0.2 çš„ 8080 ç«¯å£ â€”volume â€œ$PWD/wordpressâ€:/var/www/htmlï¼šå°†å®¹å™¨çš„/var/www/htmlç›®å½•æ˜ å°„åˆ°å½“å‰ç›®å½•çš„wordpresså­ç›®å½• 2.3 docker container lsâœ docker container ls --allCONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES99e93c4dfc7c wordpress &quot;docker-entrypoint.sâ€¦&quot; 2 seconds ago Up 1 second 80/tcp wordpress373fcc5e1b94 mysql:5.7 &quot;docker-entrypoint.sâ€¦&quot; 2 minutes ago Up 2 minutes 3306/tcp, 33060/tcp wordpressdb(anaconda3) (base) æµè§ˆå™¨ http://localhost:8080 å°±èƒ½çœ‹åˆ° WordPress çš„å®‰è£…æç¤º. 2.4 stop containersâœ docker container stop wordpress wordpressdb 3. Docker Compose ToolCompose ä¸€ä¸ªå·¥å…·è½¯ä»¶, å¯ä»¥ç®¡ç†å¤šä¸ª Docker å®¹å™¨ç»„æˆä¸€ä¸ªåº”ç”¨. å®šä¹‰ docker-compose.ymlï¼Œå†™å¥½å¤šå®¹å™¨çš„è°ƒç”¨å…³ç³»ã€‚ç„¶åï¼Œåªè¦ä¸€ä¸ªå‘½ä»¤ï¼Œå°±èƒ½åŒæ—¶å¯åŠ¨/å…³é—­è¿™äº›å®¹å™¨. docker-compose --version 3.1 WordPress examplemysql: image: mysql:5.7 environment: - MYSQL_ROOT_PASSWORD=123456 - MYSQL_DATABASE=wordpressweb: image: wordpress links: - mysql environment: - WORDPRESS_DB_PASSWORD=123456 ports: - &quot;127.0.0.3:8080:80&quot; working_dir: /var/www/html volumes: - wordpress:/var/www/html å¯åŠ¨ 2ä¸ª Container docker-compose up å…³é—­ 2ä¸ª Container docker-compose stop å…³é—­ä»¥åï¼Œè¿™ä¸¤ä¸ªå®¹å™¨æ–‡ä»¶è¿˜æ˜¯å­˜åœ¨çš„ï¼Œå†™åœ¨é‡Œé¢çš„æ•°æ®ä¸ä¼šä¸¢å¤±ã€‚ä¸‹æ¬¡å¯åŠ¨çš„æ—¶å€™ï¼Œè¿˜å¯ä»¥å¤ç”¨ã€‚ä¸‹é¢çš„å‘½ä»¤å¯ä»¥æŠŠè¿™ä¸¤ä¸ªå®¹å™¨æ–‡ä»¶åˆ é™¤ï¼ˆå®¹å™¨å¿…é¡»å·²ç»åœæ­¢è¿è¡Œï¼‰ã€‚ docker-compose rm Reference é˜®ä¸€å³°: Docker å…¥é—¨æ•™ç¨‹ é˜®ä¸€å³°: Docker å¾®æœåŠ¡æ•™ç¨‹ é˜®ä¸€å³°: developer æ‰‹å†Œ è’é‡ä¹‹è: Dockeræœ€ç®€æ•™ç¨‹ Hexo+Githubåšå®¢æœ€ç®€æ•™ç¨‹-Dockerfileè‡ªåŠ¨æ­å»º","categories":[{"name":"devops","slug":"devops","permalink":"http://iequa.com/categories/devops/"}],"tags":[{"name":"Docker","slug":"Docker","permalink":"http://iequa.com/tags/Docker/"}]},{"title":"Docker tutorial","slug":"devops/docker-tutorial","date":"2019-10-07T09:11:21.000Z","updated":"2020-12-06T06:24:21.710Z","comments":true,"path":"2019/10/07/devops/docker-tutorial/","link":"","permalink":"http://iequa.com/2019/10/07/devops/docker-tutorial/","excerpt":"","text":"ç”±äºç¯å¢ƒé…ç½®çš„éš¾é¢˜ï¼Œæ‰€ä»¥å¼€å‘è€…å¸¸å¸¸ä¼šè¯´ï¼šIt works on my machine ä¸ºäº†æ›´å¥½çš„å¼•å‡º Docker, å…ˆç®€å•ä»‹ç»ä¸‹ Linux å®¹å™¨: Linux Container ä¸æ˜¯æ¨¡æ‹Ÿä¸€ä¸ªå®Œæ•´çš„ OSï¼Œè€Œæ˜¯å¯¹è¿›ç¨‹è¿›è¡Œéš”ç¦»ã€‚æˆ–è€…è¯´ï¼Œåœ¨æ­£å¸¸è¿›ç¨‹çš„å¤–é¢å¥—äº†ä¸€ä¸ªä¿æŠ¤å±‚ã€‚å¯¹äº Container é‡Œé¢çš„è¿›ç¨‹æ¥è¯´ï¼Œå®ƒæ¥è§¦åˆ°çš„å„ç§èµ„æºéƒ½æ˜¯ virtualï¼Œä»è€Œå®ç°ä¸åº•å±‚ç³»ç»Ÿçš„éš”ç¦»ã€‚ Container æ˜¯è¿›ç¨‹çº§åˆ«çš„ï¼Œç›¸æ¯” virtual machine æœ‰å¾ˆå¤šä¼˜åŠ¿ã€‚ Container æœ‰ç‚¹åƒè½»é‡çº§çš„ virtual machineï¼Œèƒ½å¤Ÿæä¾› virtual_envï¼Œä½†æ˜¯æˆæœ¬å¼€é”€å°å¾—å¤š 1. docker what?Docker å±äº Linux å®¹å™¨çš„ä¸€ç§å°è£…ï¼Œæä¾›ç®€å•æ˜“ç”¨çš„å®¹å™¨ä½¿ç”¨æ¥å£ã€‚å®ƒæ˜¯ç›®å‰æœ€æµè¡Œçš„ Linux å®¹å™¨è§£å†³æ–¹æ¡ˆã€‚ Docker å°† Application ä¸è¯¥ç¨‹åºçš„ä¾èµ–ï¼Œæ‰“åŒ…åœ¨ä¸€ä¸ª image_file é‡Œé¢ã€‚è¿è¡Œè¿™ä¸ªæ–‡ä»¶ï¼Œå°±ä¼šç”Ÿæˆä¸€ä¸ªè™šæ‹Ÿå®¹å™¨ã€‚ ç¨‹åºåœ¨è¿™ä¸ª Container é‡Œè¿è¡Œï¼Œå°±å¥½åƒåœ¨çœŸå®çš„ç‰©ç†æœºä¸Šè¿è¡Œä¸€æ ·ã€‚æœ‰äº† Dockerï¼Œå°±ä¸ç”¨æ‹…å¿ƒç¯å¢ƒé—®é¢˜ã€‚ 2. docker function æä¾›ä¸€æ¬¡æ€§çš„ç¯å¢ƒ æä¾›å¼¹æ€§çš„äº‘æœåŠ¡ ç»„å»ºå¾®æœåŠ¡æ¶æ„ 3. docker installInstall Docker Desktop on Mac $ docker version# æˆ–è€…$ docker info 4. docker image file Docker æŠŠ Application åŠä¾èµ–ï¼Œæ‰“åŒ…åœ¨ image file é‡Œ. åªæœ‰é€šè¿‡è¿™ä¸ª image fileï¼Œæ‰èƒ½ç”Ÿæˆ Docker Container, image file å¯ä»¥çœ‹ä½œæ˜¯ template of container. Docker æ ¹æ® image file ç”Ÿæˆ instance of container. åŒä¸€ image æ–‡ä»¶ï¼Œå¯ä»¥ç”Ÿæˆå¤šä¸ªåŒæ—¶è¿è¡Œçš„ instance of container. # åˆ—å‡ºæœ¬æœºçš„æ‰€æœ‰ image æ–‡ä»¶ã€‚$ docker image ls# åˆ é™¤ image æ–‡ä»¶$ docker image rm [imageName] image æ–‡ä»¶æ˜¯é€šç”¨çš„ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œä¸ºäº†èŠ‚çœæ—¶é—´ï¼Œæˆ‘ä»¬åº”è¯¥å°½é‡ä½¿ç”¨åˆ«äººåˆ¶ä½œå¥½çš„ image æ–‡ä»¶ï¼Œè€Œä¸æ˜¯è‡ªå·±åˆ¶ä½œã€‚å³ä½¿è¦å®šåˆ¶ï¼Œä¹Ÿåº”è¯¥åŸºäºåˆ«äººçš„ image æ–‡ä»¶è¿›è¡ŒåŠ å·¥ï¼Œè€Œä¸æ˜¯ä»é›¶å¼€å§‹åˆ¶ä½œã€‚ ä¸ºäº†æ–¹ä¾¿å…±äº«ï¼Œimage æ–‡ä»¶åˆ¶ä½œå®Œæˆåï¼Œå¯ä»¥ä¸Šä¼ åˆ°ç½‘ä¸Šçš„ä»“åº“ã€‚Docker çš„å®˜æ–¹ä»“åº“ Docker Hub æ˜¯æœ€é‡è¦ã€æœ€å¸¸ç”¨çš„ image ä»“åº“ã€‚ 5. exampleï¼šhello worldæˆ‘ä»¬é€šè¿‡æœ€ç®€å•çš„ image æ–‡ä»¶â€hello worldâ€œï¼Œæ„Ÿå—ä¸€ä¸‹ Docker (1). å°† image æ–‡ä»¶ä»ä»“åº“æŠ“å–åˆ°æœ¬åœ° $ docker image pull library/hello-world#or$ docker image pull hello-world (2). æœ¬æœºçœ‹åˆ°è¿™ä¸ª image æ–‡ä»¶ $ docker image ls (3). è¿è¡Œè¿™ä¸ª image æ–‡ä»¶ $ docker container run hello-world è¿è¡ŒæˆåŠŸ: $ docker container run hello-worldHello from Docker!This message shows that your installation appears to be working correctly.... ... è¾“å‡ºè¿™æ®µæç¤ºä»¥åï¼Œhello worldå°±ä¼šåœæ­¢è¿è¡Œï¼Œå®¹å™¨è‡ªåŠ¨ç»ˆæ­¢ã€‚ (4). æ‰‹åŠ¨ç»ˆæ­¢å®¹å™¨ å¯¹äºé‚£äº›ä¸ä¼šè‡ªåŠ¨ç»ˆæ­¢çš„å®¹å™¨ï¼Œå¿…é¡»ä½¿ç”¨ docker container kill æ‰‹åŠ¨ç»ˆæ­¢. $ docker container kill [containID] 6. container fileimage file ç”Ÿæˆçš„ instance of containerï¼Œæœ¬èº«ä¹Ÿæ˜¯ä¸€ä¸ªæ–‡ä»¶ï¼Œç§°ä¸º container fileã€‚ ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸€æ—¦ container ç”Ÿæˆï¼Œå°±ä¼šåŒæ—¶å­˜åœ¨ 2 filesï¼š image file å’Œ container fileã€‚ ä¸” close container å¹¶ä¸ä¼š delete container fileï¼Œåªæ˜¯ container stop run. # åˆ—å‡ºæœ¬æœºæ­£åœ¨è¿è¡Œçš„å®¹å™¨$ docker container ls# åˆ—å‡ºæœ¬æœºæ‰€æœ‰å®¹å™¨ï¼ŒåŒ…æ‹¬ç»ˆæ­¢è¿è¡Œçš„å®¹å™¨$ docker container ls --all docker çš„å¸¸ç”¨å‘½ä»¤: docker --version #æŸ¥çœ‹Dockerç‰ˆæœ¬docker info #æŸ¥çœ‹Dockerå®‰è£…æœ‰å…³çš„æ‰€æœ‰ç»†èŠ‚ä¿¡æ¯docker version #æŸ¥çœ‹Dockerå®‰è£…æœ‰å…³çš„æ‰€æœ‰ç»†èŠ‚ä¿¡æ¯docker image ls #åˆ—å‡ºé•œåƒæ¸…å•docker container ls #åˆ—å‡ºå®¹å™¨æ¸…å•ï¼ˆåˆ—å‡ºè¿è¡Œä¸­çš„å®¹å™¨ï¼‰docker container ls --all #åˆ—å‡ºå®¹å™¨æ¸…å•ï¼ˆåˆ—å‡ºæ‰€æœ‰å®¹å™¨ï¼‰docker container ls --aq #åˆ—å‡ºå®¹å™¨æ¸…å•ï¼ˆåˆ—å‡ºæ‰€æœ‰å®¹å™¨ï¼Œç®€å•æ¨¡å¼ï¼Œåªæœ‰å®¹å™¨IDï¼‰docker run hello-world #æ‰§è¡ŒDockeré•œåƒï¼Œé•œåƒåå­—ä¸ºhello-world 7. Dockerfileå­¦ä¼šä½¿ç”¨ image æ–‡ä»¶ä»¥åï¼Œæ¥ä¸‹æ¥çš„é—®é¢˜å°±æ˜¯ï¼Œå¦‚ä½•ç”Ÿæˆ image æ–‡ä»¶ï¼Ÿ è¿™éœ€è¦ç”¨åˆ° Dockerfile æ–‡ä»¶ã€‚å®ƒæ˜¯ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶ï¼Œç”¨æ¥é…ç½® imageã€‚ Docker æ ¹æ® Dockerfile ç”ŸæˆäºŒè¿›åˆ¶çš„ image file . 8. Custom docker container8.1 make Dockerfile.gitnode_modulesnpm-debug.log 8.2 create image8.3 generate Container8.4 CMD8.5 Release imageåœ¨ hub.docker.com æˆ– cloud.docker.com æ³¨å†Œä¸€ä¸ªè´¦æˆ·ã€‚ç„¶åï¼Œç”¨ä¸‹é¢çš„å‘½ä»¤ç™»å½•ã€‚ $ docker login æ¥ç€ï¼Œä¸ºæœ¬åœ°çš„ image æ ‡æ³¨ç”¨æˆ·åå’Œç‰ˆæœ¬ï¼š $ docker image tag [imageName] [username]/[repository]:[tag]# å®ä¾‹$ docker image tag koa-demos:0.0.1 ruanyf/koa-demos:0.0.1 ä¹Ÿå¯ä»¥ä¸æ ‡æ³¨ç”¨æˆ·åï¼Œé‡æ–°æ„å»ºä¸€ä¸‹ image æ–‡ä»¶ä¹Ÿæ˜¯å¯ä»¥çš„: $ docker image build -t [username]/[repository]:[tag] . æœ€åï¼Œå‘å¸ƒ image æ–‡ä»¶: $ docker image push [username]/[repository]:[tag] 9. other docker commanddocker çš„ä¸»è¦ç”¨æ³•å°±æ˜¯ä¸Šé¢è¿™äº›ï¼Œæ­¤å¤–è¿˜æœ‰å‡ ä¸ªå‘½ä»¤ï¼Œä¹Ÿéå¸¸æœ‰ç”¨ docker container start [containerID]docker container stop [containerID]docker container logs [containerID]docker container exec [containerID]docker container cp [containerID] 9.1 container start å‘½ä»¤æ˜¯æ–°å»ºå®¹å™¨ï¼Œæ¯è¿è¡Œä¸€æ¬¡ï¼Œå°±ä¼šæ–°å»ºä¸€ä¸ªå®¹å™¨ã€‚åŒæ ·çš„å‘½ä»¤è¿è¡Œä¸¤æ¬¡ï¼Œå°±ä¼šç”Ÿæˆä¸¤ä¸ªä¸€æ¨¡ä¸€æ ·çš„å®¹å™¨æ–‡ä»¶ã€‚ $ docker container start [containerID] 9.2 container stopdocker container kill å‘½ä»¤ç»ˆæ­¢å®¹å™¨è¿è¡Œï¼Œç›¸å½“äºå‘å®¹å™¨é‡Œé¢çš„ä¸»è¿›ç¨‹å‘å‡º SIGKILL ä¿¡å·ã€‚ $ docker container kill [containerID] docker container stop å‘½ä»¤ä¹Ÿæ˜¯ç”¨æ¥ç»ˆæ­¢å®¹å™¨è¿è¡Œï¼Œç›¸å½“äºå‘å®¹å™¨é‡Œé¢çš„ä¸»è¿›ç¨‹å‘å‡º SIGTERM ä¿¡å·ï¼Œç„¶åè¿‡ä¸€æ®µæ—¶é—´å†å‘å‡º SIGKILL ä¿¡å· $ docker container stop [containerID] 9.3 container logsdocker container logs å‘½ä»¤ç”¨æ¥æŸ¥çœ‹ docker å®¹å™¨çš„è¾“å‡ºï¼Œå³å®¹å™¨é‡Œé¢ Shell çš„æ ‡å‡†è¾“å‡ºã€‚ $ docker container logs [containerID] 9.4 container execdocker container exec å‘½ä»¤ç”¨äºè¿›å…¥ä¸€ä¸ªæ­£åœ¨è¿è¡Œçš„ docker Container. $ docker container exec -it [containerID] /bin/bash 9.5 container cpdocker container cp å‘½ä»¤ç”¨äºä»æ­£åœ¨è¿è¡Œçš„ Docker å®¹å™¨é‡Œé¢ï¼Œå°†æ–‡ä»¶æ‹·è´åˆ°æœ¬æœº. $ docker container cp [containID]:[/path/to/file] . Reference é˜®ä¸€å³°: Docker å…¥é—¨æ•™ç¨‹ é˜®ä¸€å³°: Docker å¾®æœåŠ¡æ•™ç¨‹ Dockerfileæ–‡ä»¶è¯¦è§£ Docker å®¹å™¨ä»å…¥é—¨åˆ°å…¥é­” GOè¯­è¨€ã€DOCKER å’Œæ–°æŠ€æœ¯","categories":[{"name":"devops","slug":"devops","permalink":"http://iequa.com/categories/devops/"}],"tags":[{"name":"Docker","slug":"Docker","permalink":"http://iequa.com/tags/Docker/"}]},{"title":"Python WSGI åè®®è¯¦è§£","slug":"python/README","date":"2019-10-06T01:11:21.000Z","updated":"2019-10-20T04:30:35.007Z","comments":true,"path":"2019/10/06/python/README/","link":"","permalink":"http://iequa.com/2019/10/06/python/README/","excerpt":"","text":"Webåº”ç”¨ç¨‹åºçš„æœ¬è´¨: User é€šè¿‡ æµè§ˆå™¨ è®¿é—® äº’è”ç½‘ä¸ŠæŒ‡å®šçš„ ç½‘é¡µæ–‡ä»¶ å±•ç¤ºåˆ°æµè§ˆå™¨ä¸Šã€‚ æŠ€æœ¯è§’åº¦ï¼Œä»¥ä¸‹3ä¸ªæ­¥éª¤ï¼š æµè§ˆå™¨ï¼Œå°†è¦è¯·æ±‚çš„å†…å®¹æŒ‰ç…§HTTPåè®®å‘é€æœåŠ¡ç«¯ æœåŠ¡ç«¯ï¼Œæ ¹æ®è¯·æ±‚å†…å®¹æ‰¾åˆ°æŒ‡å®šçš„HTMLé¡µé¢ æµè§ˆå™¨ï¼Œè§£æè¯·æ±‚åˆ°çš„HTMLå†…å®¹å±•ç¤ºå‡ºæ¥ WEBå¼€å‘â€”â€”Python WSGIåè®®è¯¦è§£ 1. Web DEV é™æ€å¼€å‘ åŠ¨æ€å¼€å‘ åŠ¨æ€å¼€å‘ CGI WSGI CGI æµç¨‹ WSGI æµç¨‹ 2. Whatâ€™s WSGIWSGIå…¨ç§°æ˜¯Web Server Gateway Interfaceï¼Œå…¶ä¸»è¦ä½œç”¨æ˜¯WebæœåŠ¡å™¨ä¸Python Webåº”ç”¨ç¨‹åºæˆ–æ¡†æ¶ä¹‹é—´çš„å»ºè®®æ ‡å‡†æ¥å£ï¼Œä»¥ä¿ƒè¿›è·¨å„ç§WebæœåŠ¡å™¨çš„Webåº”ç”¨ç¨‹åºå¯ç§»æ¤æ€§ã€‚ WSGI åè®® åˆ†æˆä¸‰ä¸ªç»„ä»¶ Applicationã€Serverã€Middleware å’Œ åè®®ä¸­ä¼ è¾“çš„å†…å®¹ã€‚ Applicationï¼šDjangoï¼ŒFlaskç­‰ Serverï¼šå¸¸ç”¨çš„æœ‰uWSGIï¼Œgunicornç­‰ Middlewareï¼š Flaskç­‰æ¡†æ¶ä¸­çš„è£…é¥°å™¨ 2.1 Applicationåº”ç”¨ç¨‹åºï¼Œæ˜¯ä¸€ä¸ªå¯é‡å¤è°ƒç”¨çš„å¯è°ƒç”¨å¯¹è±¡ï¼Œåœ¨Pythonä¸­å¯ä»¥æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªç±»ï¼Œå¦‚æœæ˜¯ç±»çš„è¯è¦å®ç°callæ–¹æ³•ï¼Œè¦æ±‚è¿™ä¸ªå¯è°ƒç”¨å¯¹è±¡æ¥æ”¶2ä¸ªå‚æ•°ï¼Œè¿”å›ä¸€ä¸ªå†…å®¹ç»“æœã€‚ 2.2 ServerWebæœåŠ¡å™¨ï¼Œä¸»è¦æ˜¯å®ç°ç›¸åº”çš„ä¿¡æ¯è½¬æ¢ï¼Œå°†ç½‘ç»œè¯·æ±‚ä¸­çš„ä¿¡æ¯ï¼ŒæŒ‰ç…§HTTPåè®®å°†å†…å®¹æ‹¿å‡ºï¼ŒåŒæ—¶æŒ‰ç…§WSGIåè®®ç»„è£…æˆæ–°çš„æ•°æ®ï¼ŒåŒæ—¶å°†æä¾›çš„start_responseä¼ é€’ç»™Applicationã€‚æœ€åæ¥æ”¶Applicationè¿”å›çš„å†…å®¹ï¼ŒæŒ‰ç…§WSGIåè®®è§£æå‡ºã€‚æœ€ç»ˆæŒ‰ç…§HTTPåè®®ç»„ç»‡å¥½å†…å®¹è¿”å›å°±å®Œæˆäº†ä¸€æ¬¡è¯·æ±‚ã€‚ 2.3 MiddlewareMiddleware ä¸­é—´ä»¶ï¼Œå¯ä»¥ç†è§£ä¸ºå¯¹åº”ç”¨ç¨‹åºçš„ä¸€ç»„è£…é¥°å™¨ã€‚ åœ¨ Application ç«¯çœ‹æ¥ï¼Œå®ƒå¯ä»¥æä¾›ä¸€ä¸ªç±»start_responseå‡½æ•°ï¼Œå¯ä»¥åƒstart_responseå‡½æ•°ä¸€æ ·æ¥æ”¶HTTP STATUå’ŒHeadersï¼›å’Œenvironã€‚ åœ¨ Server çœ‹æ¥ï¼Œä»–å¯ä»¥æ¥æ”¶2ä¸ªå‚æ•°ï¼Œå¹¶ä¸”å¯ä»¥è¿”å›ä¸€ä¸ªç±» Applicationå¯¹è±¡ã€‚ 2.4 æ€»ç»“WSGI å¯¹äº application å¯¹è±¡æœ‰å¦‚ä¸‹ä¸‰ç‚¹è¦æ±‚ å¿…é¡»æ˜¯ä¸€ä¸ªå¯è°ƒç”¨çš„å¯¹è±¡ æ¥æ”¶ä¸¤ä¸ªå¿…é€‰å‚æ•° environã€start_responseã€‚ è¿”å›å€¼å¿…é¡»æ˜¯å¯è¿­ä»£å¯¹è±¡ï¼Œç”¨æ¥è¡¨ç¤º http bodyã€‚ 3. Python Web åº”ç”¨æ˜¯ä»€ä¹ˆ?ä¸€ä¸ª Python Web åº”ç”¨åŒ…å«ä¸¤ä¸ªéƒ¨åˆ†ï¼š åº”ç”¨çš„å¼€å‘ï¼šå®ç° Web åº”ç”¨çš„é€»è¾‘ï¼Œè¯»æ•°æ®åº“ï¼Œæ‹¼è£…é¡µé¢ï¼Œç”¨æˆ·ç™»å½• åº”ç”¨çš„éƒ¨ç½²ï¼šå°† Web åº”ç”¨è·‘èµ·æ¥ï¼Œå¤šçº¿ç¨‹ï¼Œå¤šè¿›ç¨‹ï¼Œå¼‚æ­¥ï¼Œç›‘å¬ç«¯å£ï¼Œæ‰€æœ‰æœåŠ¡å™¨è¯¥åšçš„äº‹æƒ… æˆ‘ä»¬å¸Œæœ›ç”¨å„ç§ä¸åŒçš„æŠ€æœ¯æ¥å¼€å‘åº”ç”¨ï¼Œç”¨å„ç§ä¸åŒçš„æœåŠ¡å™¨ç¨‹åºæ¥è·‘åº”ç”¨. è¿™å°±è¦æ±‚ å¼€å‘ å’Œ éƒ¨ç½² éµå¾ªç»Ÿä¸€çš„ é€šä¿¡æ¥å£ï¼Œè¿™æ¥å£å« Web Server Gateway Interfaceï¼Œç®€ç§°â€œWSGIâ€ã€‚ WSGI æ¥å£ å°±æ˜¯ä¸€ä¸ªæ»¡è¶³ç‰¹å®šè¦æ±‚çš„å‡½æ•° def application(environ, start_response): â€œâ€â€œ environï¼šåŒ…å«æ‰€æœ‰ HTTP è¯·æ±‚ä¿¡æ¯çš„ dict start_responseï¼šå‘é€ HTTP å“åº”çš„å‡½æ•° â€â€œâ€ start_response(&#x27;200 OK&#x27;, [(&#x27;Content-Type&#x27;, &#x27;text/html&#x27;)]) return &#x27;&lt;h1&gt;Hello, web!&lt;/h1&gt;&#x27; WSGI å®Œæ•´è¯´æ˜ï¼šPEP 333 : Python Web Server Gateway Interface v1.0.1WSGI ç®€å•è¯´æ˜ï¼š å»–é›ªå³°çš„å®˜æ–¹ç½‘ç«™Py Web åº”ç”¨æ¦‚è§ˆï¼šThe Hitchhikerâ€™s Guide To Python 4. Flask Web åº”ç”¨å¼€å‘åŸºæœ¬å½¢æ€ï¼šURL è·¯ç”±ï¼Œè·å–è¯·æ±‚ï¼Œæ„é€ å“åº” Flask ä½œä¸ºä¸€ä¸ª Web æ¡†æ¶ï¼Œå®ƒéµå¾ª WSGI æ¥å£ï¼Œå¹¶ä¸”åœ¨å…¶ä¹‹ä¸Šæ•´åˆäº† Werkzeug çš„ URL è·¯ç”±ä»¥åŠ WSGI å·¥å…·åº“ï¼ŒSQLAlchemy çš„æ•°æ®åº“è®¿é—®ï¼Œjinja2 çš„æ¨¡ç‰ˆæ¸²æŸ“ç­‰åŠŸèƒ½ã€‚ app å¯¹è±¡å®ç°äº† WSGI æ¥å£ Flaskï¼Œä»ç®€å•å¼€å§‹ 5. Flask-RESTPlusFlask-RESTPlus æ˜¯å¯¹Flaskçš„æ‰©å±•ï¼Œå®ƒå¢åŠ äº†å¯¹å¿«é€Ÿå¼€å‘REST APIçš„æ”¯æŒ. Flask-RESTPlus é¼“åŠ±ä»¥æœ€å°çš„è®¾ç½®æ¥å®ç°åŠŸèƒ½çš„å¼€å‘. Flask-RESTPlus æ—¢åŒ…å« Flask-RestfulåŒ… çš„åŠŸèƒ½ï¼ŒåˆåŒ…æ‹¬ swagger æ–‡æ¡£åŒ–åŠŸèƒ½ï¼ˆå…¶å®æ˜¯å°è£…äº†swaggerï¼‰. 5.1 quickstart hellofrom flask import Flaskfrom flask_restplus import Api# Flaskå®ä¾‹app = Flask(__name__)# åœ¨ä½¿ç”¨Flask-RESTPlusä¹‹å‰ï¼Œéœ€è¦é€šè¿‡ä¼ å…¥Flaskå®ä¾‹è¿›è¡Œåˆå§‹åŒ–, è¿›è¡Œåˆå§‹åŒ–.api = Api(app) æœ€ç®€å•çš„æ‰“å¼€ Flask-RESTPlus, API ç¤ºä¾‹: # file:simple_api.pyfrom flask import Flaskfrom flask_restplus import Resource, Apiapp = Flask(__name__)api = Api(app)@api.route(&#x27;/hello&#x27;)class HelloWorld(Resource): def get(self): return &#123;&#x27;hello&#x27;: &#x27;world&#x27;&#125;if __name__ == &#x27;__main__&#x27;: app.run(debug=True) # å¼€å¯äº†Flaskçš„è°ƒè¯•æ¨¡å¼ # ç”Ÿäº§ç¯å¢ƒç»å¯¹ä¸è¦å¼€å¯è°ƒè¯•æ¨¡å¼ï¼Œå› ä¸ºå®ƒä¼šä½¿ä½ çš„åå°æœåŠ¡å¤„äºè¢«æ”»å‡»çš„é£é™©ä¹‹ä¸­ï¼ run âœ python simple_api.py , then: http://localhost:5000/helloï¼š &#123;&quot;hello&quot;: &quot;world&quot;&#125; 5.2 Resourceful Routingé€šè¿‡åœ¨èµ„æºä¸Šå®šä¹‰æ–¹æ³•æ¥å¾ˆå®¹æ˜“åœ°è®¿é—®å¤šä¸ª HTTP æ–¹æ³•. from flask import Flask, requestfrom flask_restplus import Resource, Apiapp = Flask(__name__)api = Api(app)todos = &#123;&#125;@api.route(&#x27;/&lt;string:todo_id&gt;&#x27;)class TodoSimple(Resource): def get(self, todo_id): return &#123;todo_id: todos[todo_id]&#125; def put(self, todo_id): todos[todo_id] = request.form[&#x27;data&#x27;] return &#123;todo_id: todos[todo_id]&#125;if __name__ == &#x27;__main__&#x27;: app.run(debug=True) 5.3 Endpointså¤§å¤šæ•°æƒ…å†µä¸‹ï¼ŒæŸä¸ªèµ„æºéƒ½ä¼šæœ‰å¤šä¸ªURLã€‚ æˆ‘ä»¬å¯ä»¥ç”¨ route()è£…é¥°å™¨ ä¸­ä¼ å…¥å¤šä¸ªURLï¼Œè¿™æ ·æ¯ä¸ªURLéƒ½å°†ä¼šè·¯ç”±åˆ°è¯¥èµ„æºä¸Š. 5.4 Data Formattingfrom flask import Flaskfrom flask_restplus import fields, Api, Resourceapp = Flask(__name__)api = Api(app)model = api.model(&#x27;Model&#x27;, &#123; &#x27;task&#x27;: fields.String, &#x27;uri&#x27;: fields.Url(&#x27;todo_ep&#x27;,absolute=True) # absoluteå‚æ•°è¡¨ç¤ºç”Ÿæˆçš„urlæ˜¯å¦æ˜¯ç»å¯¹è·¯å¾„&#125;)class TodoDao(object): def __init__(self, todo_id, task): self.todo_id = todo_id self.task = task # è¯¥å­—æ®µä¸ä¼šå‘é€åˆ°å“åº”ç»“æœä¸­ self.status = &#x27;active&#x27;@api.route(&#x27;/todo&#x27;,endpoint=&#x27;todo_ep&#x27;)class Todo(Resource): @api.marshal_with(model) def get(self, **kwargs): return TodoDao(todo_id=&#x27;my_todo&#x27;, task=&#x27;Remember the milk&#x27;)if __name__ == &#x27;__main__&#x27;: app.run(debug=True) marshal_with()è£…é¥°å™¨å°±æ˜¯ç”¨æ¥å¯¹ç»“æœæŒ‰ç…§modelçš„ç»“æ„è¿›è¡Œè½¬æ¢çš„. flask-restplus quickstartflask-restplus example.html 5.5 Order Preservation Apiå…¨å±€ä¿ç•™ï¼šapi = Api(ordered = True) Namespaceå…¨å±€ä¿ç•™ï¼šns = Namespace(ordered=True) marshal()å±€éƒ¨ä¿ç•™ï¼šreturn marshal(data, fields, ordered=True) 5.6 Full examplefrom flask import Flaskfrom flask_restplus import Api, Resource, fieldsfrom werkzeug.contrib.fixers import ProxyFixapp = Flask(__name__)app.wsgi_app = ProxyFix(app.wsgi_app)api = Api(app, version=&#x27;1.0&#x27;, title=&#x27;TodoMVC API&#x27;, description=&#x27;A simple TodoMVC API&#x27;,)# å®šä¹‰å‘½åç©ºé—´ns = api.namespace(&#x27;todos&#x27;, description=&#x27;TODO operations&#x27;)todo = api.model(&#x27;Todo&#x27;, &#123; &#x27;id&#x27;: fields.Integer(readOnly=True, description=&#x27;The task unique identifier&#x27;), &#x27;task&#x27;: fields.String(required=True, description=&#x27;The task details&#x27;)&#125;)# DAOclass TodoDAO(object): def __init__(self): self.counter = 0 self.todos = [] def get(self, id): for todo in self.todos: if todo[&#x27;id&#x27;] == id: return todo api.abort(404, &quot;Todo &#123;&#125; doesn&#x27;t exist&quot;.format(id)) def create(self, data): todo = data todo[&#x27;id&#x27;] = self.counter = self.counter + 1 self.todos.append(todo) return todo def update(self, id, data): todo = self.get(id) todo.update(data) return todo def delete(self, id): todo = self.get(id) self.todos.remove(todo)DAO = TodoDAO()DAO.create(&#123;&#x27;task&#x27;: &#x27;Build an API&#x27;&#125;)DAO.create(&#123;&#x27;task&#x27;: &#x27;?????&#x27;&#125;)DAO.create(&#123;&#x27;task&#x27;: &#x27;profit!&#x27;&#125;)# å¯¹ all todo æ“ä½œ@ns.route(&#x27;/&#x27;)class TodoList(Resource): &#x27;&#x27;&#x27;è·å–æ‰€æœ‰todoså…ƒç´ ï¼Œå¹¶å…è®¸é€šè¿‡POSTæ¥æ·»åŠ æ–°çš„task&#x27;&#x27;&#x27; @ns.doc(&#x27;list_todos&#x27;) @ns.marshal_list_with(todo) def get(self): &#x27;&#x27;&#x27;è¿”å›æ‰€æœ‰task&#x27;&#x27;&#x27; return DAO.todos @ns.doc(&#x27;create_todo&#x27;) @ns.expect(todo) @ns.marshal_with(todo, code=201) def post(self): &#x27;&#x27;&#x27;åˆ›å»ºä¸€ä¸ªæ–°çš„task&#x27;&#x27;&#x27; return DAO.create(api.payload), 201# å¯¹å…¶ä¸­ æŸä¸ªid çš„ å®ä½“ æ“ä½œ@ns.route(&#x27;/&lt;int:id&gt;&#x27;)@ns.response(404, &#x27;Todo not found&#x27;)@ns.param(&#x27;id&#x27;, &#x27;The task identifier&#x27;)class Todo(Resource): &#x27;&#x27;&#x27;è·å–å•ä¸ªtodoé¡¹ï¼Œå¹¶å…è®¸åˆ é™¤æ“ä½œ&#x27;&#x27;&#x27; @ns.doc(&#x27;get_todo&#x27;) @ns.marshal_with(todo) def get(self, id): &#x27;&#x27;&#x27;è·å–idæŒ‡å®šçš„todoé¡¹&#x27;&#x27;&#x27; return DAO.get(id) @ns.doc(&#x27;delete_todo&#x27;) @ns.response(204, &#x27;Todo deleted&#x27;) def delete(self, id): &#x27;&#x27;&#x27;æ ¹æ®idåˆ é™¤å¯¹åº”çš„task&#x27;&#x27;&#x27; DAO.delete(id) return &#x27;&#x27;, 204 @ns.expect(todo) @ns.marshal_with(todo) def put(self, id): &#x27;&#x27;&#x27;æ›´æ–°idæŒ‡å®šçš„task&#x27;&#x27;&#x27; return DAO.update(id, api.payload)if __name__ == &#x27;__main__&#x27;: app.run(debug=True) get all curl &quot;http://localhost:5000/todos/&quot; get id curl -X GET &quot;http://localhost:5000/todos/1&quot; -H &quot;accept: application/json&quot; delete: curl -X DELETE &quot;http://localhost:5000/todos/2&quot; -H &quot;accept: application/json&quot; Reference èŠ±äº†ä¸¤ä¸ªæ˜ŸæœŸï¼Œæˆ‘ç»ˆäºæŠŠ WSGI æ•´æ˜ç™½äº† å°è¯•ç†è§£Flaskæºç  ä¹‹ ææ‡‚WSGIåè®® WEBå¼€å‘â€”â€”Python WSGIåè®®è¯¦è§£ Flaskï¼Œä»ç®€å•å¼€å§‹ HackHanæŠ€æœ¯åšå®¢:ã€Flask-RESTPlusç³»åˆ—ã€‘Flask-RESTPlusç³»åˆ—è¯‘æ–‡å¼€ç¯‡","categories":[{"name":"python","slug":"python","permalink":"http://iequa.com/categories/python/"}],"tags":[{"name":"WSGI","slug":"WSGI","permalink":"http://iequa.com/tags/WSGI/"}]},{"title":"Spark SQLå‡ ç§Joinå®ç°","slug":"spark/spark-sql-join-core","date":"2019-09-26T12:07:21.000Z","updated":"2021-02-08T06:38:30.376Z","comments":true,"path":"2019/09/26/spark/spark-sql-join-core/","link":"","permalink":"http://iequa.com/2019/09/26/spark/spark-sql-join-core/","excerpt":"","text":"æœ‰ä¸¤ç§æ–¹å¼ä½¿ç”¨SparkSQL Spark SQLæ€§èƒ½è°ƒä¼˜ä»¥åŠåŸç†å›¾ æ˜¯ç›´æ¥å†™sqlè¯­å¥ï¼Œè¿™ä¸ªéœ€è¦æœ‰å…ƒæ•°æ®åº“æ”¯æŒï¼Œä¾‹å¦‚Hiveç­‰ é€šè¿‡Dataset/DataFrameç¼–å†™Sparkåº”ç”¨ç¨‹åºã€‚ 1. SparkSQLæ€»ä½“æµç¨‹ 2. JoinåŸºæœ¬è¦ç´  JoinåŸºæœ¬å®ç°æµç¨‹ Sparkå°†å‚ä¸Joinçš„ä¸¤å¼ è¡¨æŠ½è±¡ä¸ºæµå¼éå†è¡¨(streamIter)å’ŒæŸ¥æ‰¾è¡¨(buildIter)ï¼Œé€šå¸¸streamIterä¸ºå¤§è¡¨ï¼ŒbuildIterä¸ºå°è¡¨ï¼Œæˆ‘ä»¬ä¸ç”¨æ‹…å¿ƒå“ªä¸ªè¡¨ä¸ºstreamIterï¼Œå“ªä¸ªè¡¨ä¸ºbuildIterï¼Œè¿™ä¸ªsparkä¼šæ ¹æ®joinè¯­å¥è‡ªåŠ¨å¸®æˆ‘ä»¬å®Œæˆ. 2.1 sort merge joinå®ç° è¦è®©ä¸¤æ¡è®°å½•èƒ½joinåˆ°ä¸€èµ·ï¼Œé¦–å…ˆéœ€è¦å°†å…·æœ‰ç›¸åŒkeyçš„è®°å½•åœ¨åŒä¸€ä¸ªåˆ†åŒºï¼Œæ‰€ä»¥é€šå¸¸æ¥è¯´ï¼Œéœ€è¦åšä¸€æ¬¡shuffleï¼Œmapé˜¶æ®µæ ¹æ®joinæ¡ä»¶ç¡®å®šæ¯æ¡è®°å½•çš„keyï¼ŒåŸºäºè¯¥keyåšshuffle writeï¼Œå°†å¯èƒ½joinåˆ°ä¸€èµ·çš„è®°å½•åˆ†åˆ°åŒä¸€ä¸ªåˆ†åŒºä¸­ï¼Œè¿™æ ·åœ¨shuffle readé˜¶æ®µå°±å¯ä»¥å°†ä¸¤ä¸ªè¡¨ä¸­å…·æœ‰ç›¸åŒkeyçš„è®°å½•æ‹‰åˆ°åŒä¸€ä¸ªåˆ†åŒºå¤„ç†. 2.2 broadcast joinå®ç°å½“buildIterçš„ä¼°è®¡å¤§å°ä¸è¶…è¿‡å‚æ•°spark.sql.autoBroadcastJoinThresholdè®¾å®šçš„å€¼(é»˜è®¤10M)ï¼Œé‚£ä¹ˆå°±ä¼šè‡ªåŠ¨é‡‡ç”¨broadcast joinï¼Œå¦åˆ™é‡‡ç”¨sort merge join. 2.3 hash joinå®ç°2.4 inner join2.5 left outer join2.6 right outer join2.7 full outer joinfull outer joinä»…é‡‡ç”¨sort merge joinå®ç°ï¼Œå·¦è¾¹å’Œå³è¡¨æ—¢è¦ä½œä¸ºstreamIterï¼Œåˆè¦ä½œä¸ºbuildIterï¼Œå…¶åŸºæœ¬å®ç°æµç¨‹å¦‚ä¸‹å›¾æ‰€ç¤º: 2.8 left semi join 2.9 left anti join3. Spark æ‰§è¡Œå›¾Joinæ˜¯æ•°æ®åº“æŸ¥è¯¢ä¸­ä¸€ä¸ªéå¸¸é‡è¦çš„è¯­æ³•ç‰¹æ€§ï¼Œåœ¨æ•°æ®åº“é¢†åŸŸå¯ä»¥è¯´æ˜¯â€œå¾—joinè€…å¾—å¤©ä¸‹â€ï¼ŒSparkSQLä½œä¸ºä¸€ç§åˆ†å¸ƒå¼æ•°æ®ä»“åº“ç³»ç»Ÿï¼Œç»™æˆ‘ä»¬æä¾›äº†å…¨é¢çš„joinæ”¯æŒï¼Œå¹¶åœ¨å†…éƒ¨å®ç°ä¸Šæ— å£°æ— æ¯åœ°åšäº†å¾ˆå¤šä¼˜åŒ–ï¼Œäº†è§£joinçš„å®ç°å°†æœ‰åŠ©äºæˆ‘ä»¬æ›´æ·±åˆ»çš„äº†è§£æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºçš„è¿è¡Œè½¨è¿¹. Reference Spark shuffleå†…å­˜ç®¡ç†ä¸è°ƒä¼˜ æ¯ä¸ª Spark å·¥ç¨‹å¸ˆéƒ½åº”è¯¥çŸ¥é“çš„äº”ç§ Join ç­–ç•¥ é¢è¯•å¿…çŸ¥çš„Spark SQLå‡ ç§Joinå®ç° Spark SQLä¸­Joinå¸¸ç”¨çš„å‡ ç§å®ç°","categories":[{"name":"spark","slug":"spark","permalink":"http://iequa.com/categories/spark/"}],"tags":[{"name":"spark","slug":"spark","permalink":"http://iequa.com/tags/spark/"}]},{"title":"Spark Tutorials 3 - RDD","slug":"spark/Spark-Tutorials-Part3","date":"2019-09-25T08:07:21.000Z","updated":"2020-12-06T04:07:34.095Z","comments":true,"path":"2019/09/25/spark/Spark-Tutorials-Part3/","link":"","permalink":"http://iequa.com/2019/09/25/spark/Spark-Tutorials-Part3/","excerpt":"","text":"very good SparkåŸç†ç¯‡ä¹‹RDDç‰¹å¾åˆ†æè®²è§£ spark åŸºç¡€çŸ¥è¯†æ•´ç†ï¼ˆä¸€ï¼‰ spark åŸºç¡€çŸ¥è¯†æ•´ç†ï¼ˆäºŒï¼‰- RDDä¸“é¢˜ Spark åˆ†åŒº(Partition)çš„è®¤è¯†ã€ç†è§£å’Œåº”ç”¨ 1. Create RDDs 2. RDD Persistence and CachingWhat is RDD persistence, Why do we need to call cache or persist on an RDD, What is the Difference between Cache() and Persist() method in Spark What is RDD Persistence and Caching The difference between cache() and persist() is that using cache() the default storage level is MEMORY_ONLY while using persist() we can use various storage levels (described below). Time efficient Cost efficient Lessen the execution time. Storage levels of Persisted RDDs MEMORY_ONLY MEMORY_AND_DISK MEMORY_ONLY_SER MEMORY_AND_DISK_SER DISK_ONLY How to Unpersist RDD in Spark? using RDD.unpersist() method. 3. RDD Features 3.1 In-memory computation 3.2 Lazy Evaluation3.3 Fault ToleranceFault tolerance in Apache Spark â€“ Reliable Spark Streaming 3.4 Immutability3.5 Persistence3.6 Partitioning3.7 ParallelRdd, process the data parallelly over the cluster. 3.8 Location-Stickiness3.9 Coarse-grained Operation3.10 TypedWe can have RDD of various types like: RDD [int], RDD [long], RDD [string]. 3.11 No limitation RDD Features good SparkåŸºæœ¬å·¥ä½œåŸç†å’ŒRDDç‰¹æ€§ Spark RDD ç‰¹å¾åŠå…¶ä¾èµ– 4. Paired RDDHere transformation operations are: groupByKey reduceByKey join left outer join right outer Join Whereas actions like countByKey 4.1 Objective in spark is designed as each dataset in RDD is divided into logical partitions. Further, we can say here each partition may be computed on different nodes of the cluster. 4.2 Spark Paired RDDfrom pyspark import SparkConf , SparkContextfrom operator import addsc.versionlines22 = sc.textFile(&quot;/Users/blair/ghome/github/spark3.0/pyspark/spark-src/word_count.text&quot;, 2)pairs22= lines22.map(lambda x: (x, 1))#pairs22.take(2)counts22 = pairs22.reduceByKey(add)counts22 4.3 Create Spark Paired RDDa. In Python language pairs = lines.map(lambda x: (x.split(â€ â€œ)[0], x)) 4.4 Paired RDD Operations No. Operations desc . Transformation Operations . map / flatMap / mapPartitions â€¦ 1. groupByKey The groupbykey operation generally groups all the values with the same key. rdd.groupByKey() 2. reduceByKey(fun) Here, the reduceByKey operation generally combines values with the same key. add.reduceByKey( (x, y) =&gt; x + y) 3. combineByKey(createCombiner, mergeValue, mergeCombiners, partitioner) CombineByKey uses a different result type, then combine those values with the same key. 4. mapValues(func) Pass each value in the key-value pair RDD through a map function without changing the keys; this also retains the original RDDâ€™s partitioning. 5. keys() Keys() Return an RDD with the keys of each tuple. 6. values() Return an RDD with the values of each tuple. 7. sortByKey(ascending=True, numPartitions=None, keyfunc=","categories":[{"name":"spark","slug":"spark","permalink":"http://iequa.com/categories/spark/"}],"tags":[{"name":"spark","slug":"spark","permalink":"http://iequa.com/tags/spark/"}]},{"title":"Spark Tutorials 2 - SparkContextã€Stageã€Executorã€RDD","slug":"spark/Spark-Tutorials-Part2","date":"2019-09-19T08:07:21.000Z","updated":"2020-12-06T04:07:28.391Z","comments":true,"path":"2019/09/19/spark/Spark-Tutorials-Part2/","link":"","permalink":"http://iequa.com/2019/09/19/spark/Spark-Tutorials-Part2/","excerpt":"","text":"1. Spark - SparkContext SparkContext allows your Spark Application to access Spark Cluster with the help of Resource Manager. The resource manager can be one of these three- Spark Standalone, YARN, Apache Mesos. The different contexts in which it can run are local, yarn-client, Mesos URL and Spark URL. 1.1 SparkContext Functions 1.2 SparkContext ConclusionHence, SparkContext provides the various functions in Spark like get the current status of Spark Application, set the configuration, cancel a job, Cancel a stage and much more. It is an entry point to the Spark functionality. Thus, it acts a backbone. 2. Spark - StageSpark Stage- An Introduction to Physical Execution plan ShuffleMapstage ResultStage 2.1 What are Stages in Spark? with the boundary of a stage in spark marked by shuffle dependencies. Ultimately, submission of Spark stage triggers the execution of a series of dependent parent stages. Although, there is a first Job Id present at every stage that is the id of the job which submits stage in Spark. 2.2 ShuffleMapStage ShuffleMapStage in Spark ResultStage in Spark 2.3 ResultStageResultStage implies as a final stage in a job that applies a function on one or many partitions of the target RDD in Spark. It also helps for computation of the result of an action. 3. Spark - ExecutorApache Spark Executor for Executing Spark Tasks 3.1 Spark Executor Some conditions in which we create Executor in Spark is: When CoarseGrainedExecutorBackend receives RegisteredExecutor message. Only for Spark Standalone and YARN. When LocalEndpoint is created for local mode. n. ç«¯ç‚¹ï¼›[åŒ–]æ»´å®šç»ˆç‚¹ 3.2 Creating Executor InstanceBy using the following, we can create the Spark Executor: From Executor ID. By using SparkEnv we can access the local MetricsSystem as well as BlockManager. Moreover, we can also access the local serializer by it. From Executorâ€™s hostname. To add to tasksâ€™ classpath, a collection of user-defined JARs. By default, it is empty. By flag whether it runs in local or cluster mode (disabled by default, i.e. cluster is preferred) Moreover, when creation is successful, the one INFO messages pop up in the logs. That is: INFO Executor: Starting executor ID [executorId] on host [executorHostname] 3.3 Heartbeat Sender Thread Basically, with a single thread, heartbeater is a daemon ScheduledThreadPoolExecutor.We call this thread pool a driver-heartbeater. 3.4 Launching Task Method3.5 executor.taskLaunch.workerThread Pool â€” ThreadPool Property executor 3.6 Conclusionwe have also learned how Spark Executors are helpful for executing tasks. The major advantage we have learned is, we can have as many executors we want. Therefore, Executors helps to enhance the Spark performance of the system. 4. Spark - RDDSpark RDD â€“ Introduction, Features &amp; Operations of RDD 4.1 resilient distributed dataset Resilient, i.e. fault-tolerant with the help of RDD lineage graph(DAG) and so able to recompute missing or damaged partitions due to node failures. Distributed, since Data resides on multiple nodes. Dataset represents records of the data you work with. The user can load the data set externally which can be either JSON file, CSV file, text file or database via JDBC with no specific data structure. 4.2 Why need RDD in Spark?Apache Spark evaluates RDDs lazily. It is called when needed, which saves lots of time and improves efficiency. The first time they are used in an action so that it can pipeline the transformation. Also, the programmer can call a persist method to state which RDD they want to use in future operations. 4.3 Features of Spark RDD 5. Spark RDD Operations Transformation Actions 5.1 Transformationsa. Narrow Transformations b. Wide Transformations 5.2 ActionsAn Action in Spark returns final result of RDD computations. It triggers execution using lineage graph to load the data into original RDD. Conclusion â€“ Spark RDDBecause of the above-stated limitations of RDD to make spark more versatile DataFrame and Dataset evolved. 6. Limitation of Spark RDDReference data-flair.training/blogs Spark RDD Operations-Transformation &amp; Action with Example Spark RDDå¸¸ç”¨ç®—å­å­¦ä¹ ç¬”è®°è¯¦è§£(pythonç‰ˆ) Sparkå¸¸ç”¨çš„Transformationç®—å­çš„ç®€å•ä¾‹å­","categories":[{"name":"spark","slug":"spark","permalink":"http://iequa.com/categories/spark/"}],"tags":[{"name":"spark","slug":"spark","permalink":"http://iequa.com/tags/spark/"}]},{"title":"Spark Tutorials 1 - Introduceã€Ecosysmã€Featuresã€Shell Commands","slug":"spark/Spark-Tutorials-Part1","date":"2019-09-18T23:07:21.000Z","updated":"2020-12-06T04:07:39.929Z","comments":true,"path":"2019/09/19/spark/Spark-Tutorials-Part1/","link":"","permalink":"http://iequa.com/2019/09/19/spark/Spark-Tutorials-Part1/","excerpt":"","text":"1. Spark - Introduction Objective â€“ Spark Tutorial Introduction to Spark Programming Spark Tutorial â€“ History Why Spark? Apache Spark Components a. Spark Coreb. Spark SQLc. Spark Streaming Spark Tutorial â€“ Learn Spark Programming 2. Spark - Ecosystem 3. Spark - Features 4. Spark - Shell Commands 4.1 Create a new RDDa) Read File from local filesystem and create an RDD. from pyspark import SparkConf , SparkContextlines = sc.textFile(&quot;/Users/blair/ghome/github/spark3.0/pyspark/spark-src/word_count.text&quot;, 2)lines.take(3) b) Create an RDD through Parallelized Collection from pyspark import SparkConf , SparkContextno = [1, 2, 3, 4, 5, 6, 8, 7]noData = sc.parallelize(no)#ParallelCollectionRDD[45] at readRDDFromFile at PythonRDD.scala:262 c) From Existing RDDs words= lines.map(lambda x : x + &quot;haha&quot;)words.take(3) 4.2 RDD Number of ItemsnoData.count()#8 4.3 Filter Operationscala&gt; val DFData = data.filter(line =&gt; line.contains(&quot;DataFlair&quot;)) 4.4 Transformation and Actionscala&gt; data.filter(line =&gt; line.contains(&quot;DataFlair&quot;)).count() 4.5 Read RDD first 5 itemscala&gt; data.first()scala&gt; data.take(5) Letâ€™s run some actions noData.count()noData.collect() 4.6 Spark WordCountfrom pyspark import SparkConf , SparkContextfrom operator import addsc.versionlines = sc.textFile(&quot;/Users/blair/ghome/github/spark3.0/pyspark/spark-src/word_count.text&quot;, 2)lines = lines.filter(lambda x: &#x27;New York&#x27; in x)#lines.take(3)words = lines.flatMap(lambda x: x.split(&#x27; &#x27;))#print(words.take(5))wco = words.map(lambda x: (x, 1))#print(wco.take(5))word_count = wco.reduceByKey(add)word_count.collect()# [# (&#x27;The&#x27;, 10),# (&#x27;of&#x27;, 33),# (&#x27;New&#x27;, 20),# (&#x27;begins&#x27;, 1),# (&#x27;around&#x27;, 4),# ...# ] 4.7 Write to HDFSword_count.saveAsTextFile(&quot;hdfs://localhost:9000/out&quot;) Reference data-flair.training/blogs Spark RDD Operations-Transformation &amp; Action with Example Spark RDDå¸¸ç”¨ç®—å­å­¦ä¹ ç¬”è®°è¯¦è§£(pythonç‰ˆ) Sparkå¸¸ç”¨çš„Transformationç®—å­çš„ç®€å•ä¾‹å­","categories":[{"name":"spark","slug":"spark","permalink":"http://iequa.com/categories/spark/"}],"tags":[{"name":"spark","slug":"spark","permalink":"http://iequa.com/tags/spark/"}]},{"title":"SQL vs NoSQL","slug":"dataware/SQL_vs_NoSQL","date":"2019-09-15T01:07:21.000Z","updated":"2020-12-06T04:10:13.908Z","comments":true,"path":"2019/09/15/dataware/SQL_vs_NoSQL/","link":"","permalink":"http://iequa.com/2019/09/15/dataware/SQL_vs_NoSQL/","excerpt":"","text":"ä»€ä¹ˆæ˜¯äº‹åŠ¡ï¼Ÿ äº‹åŠ¡æ˜¯æŒ‡æ˜¯ç¨‹åºä¸­ä¸€ç³»åˆ—ä¸¥å¯†çš„é€»è¾‘æ“ä½œï¼Œè€Œä¸”æ‰€æœ‰æ“ä½œå¿…é¡»å…¨éƒ¨æˆåŠŸå®Œæˆï¼Œå¦åˆ™åœ¨æ¯ä¸ªæ“ä½œä¸­æ‰€ä½œçš„æ‰€æœ‰æ›´æ”¹éƒ½ä¼šè¢«æ’¤æ¶ˆã€‚å¯ä»¥é€šä¿—ç†è§£ä¸ºï¼šå°±æ˜¯æŠŠå¤šä»¶äº‹æƒ…å½“åšä¸€ä»¶äº‹æƒ…æ¥å¤„ç†ï¼Œå¥½æ¯”å¤§å®¶åŒåœ¨ä¸€æ¡èˆ¹ä¸Šï¼Œè¦æ´»ä¸€èµ·æ´»ï¼Œè¦å®Œä¸€èµ·å®Œ. äº‹ç‰©çš„å››ä¸ªç‰¹æ€§ï¼ˆACIDï¼‰ â— åŸå­æ€§ï¼ˆAtomicityï¼‰â— ä¸€è‡´æ€§ï¼ˆConsistencyï¼‰â— éš”ç¦»æ€§ï¼ˆIsolationï¼‰â— æŒä¹…æ€§ï¼ˆDurabilityï¼‰ æ‰§è¡Œcount(1)ã€count(*) ä¸ count(åˆ—å) åˆ°åº•æœ‰ä»€ä¹ˆåŒºåˆ« behavior questions: how your manager judge about you during your previous job? Whatâ€™s your experience about a project that fails, and how would you redo the project? Whatâ€™s your Advantages and disadvantages in your personality? Whatâ€™s your best project and why you did better than others in your opinion? Whatâ€™s your plan about your future career? tech questions: a problem of top k problem RMDB vs NoSQL DB Why distributed NoSQL DB cannot always support transaction? Level traverse a binary tree in an online white board. random questions about spark, hadoop etc How osâ€™ thread works? General DWH concepts, Spark internals, mapreduce Explain the map reduce paradigm Reference ä»€ä¹ˆæ˜¯äº‹åŠ¡ï¼Ÿäº‹åŠ¡çš„å››ä¸ªç‰¹æ€§ä»¥åŠäº‹åŠ¡çš„éš”ç¦»çº§åˆ« å¹²è´§ | SQL ä¸ NoSQLè¿˜åœ¨å‚»å‚»åˆ†ä¸æ¸…ï¼Ÿ NoSqlå¯¹äºäº‹åŠ¡çš„æ”¯æŒ Thread in Operating System é¢è¯•å¿…è€ƒ | è¿›ç¨‹å’Œçº¿ç¨‹çš„åŒºåˆ«","categories":[{"name":"data-warehouse","slug":"data-warehouse","permalink":"http://iequa.com/categories/data-warehouse/"}],"tags":[{"name":"SQL","slug":"SQL","permalink":"http://iequa.com/tags/SQL/"}]},{"title":"HDFS æ¼”è¿›ä¹‹è·¯","slug":"hadoop/hdfs-NX-1","date":"2019-09-14T12:07:21.000Z","updated":"2020-12-06T04:12:17.686Z","comments":true,"path":"2019/09/14/hadoop/hdfs-NX-1/","link":"","permalink":"http://iequa.com/2019/09/14/hadoop/hdfs-NX-1/","excerpt":"","text":"æœ¬èŠ‚ç›®æ ‡ï¼š HDFS æ˜¯å¦‚ä½•å®ç°æœ‰çŠ¶æ€çš„é«˜å¯ç”¨æ¶æ„ HDFS æ˜¯å¦‚ä½•ä»æ¶æ„ä¸Šè§£å†³å•æœºå†…å­˜å—é™é—®é¢˜çš„ æ­ç§˜ HDFS èƒ½æ”¯æ’‘äº¿çº§æµé‡çš„æ ¸å¿ƒæºç è®¾è®¡ HDFS1 æ˜¯ä¸€ä¸ª ä¸»ä»å¼ æ¶æ„, ä¸»èŠ‚ç‚¹åªæœ‰ä¸€ä¸ªå« NameNode. ä»èŠ‚ç‚¹æœ‰å¤šä¸ªå« DataNode 1. HDFS1 æ¶æ„ 1.1 HDFS1 æ¶æ„ç¼ºé™· å•ç‚¹æ•…éšœé—®é¢˜ å†…å­˜å—é™é—®é¢˜ 1.2 å•ç‚¹æ•…éšœ Solution 1.3 å†…å­˜å—é™ Solution 2. HDFS2 ç»“æ„ Solution HDFS1 Question HA æ–¹æ¡ˆ (High Avaiable) è§£å†³ HDFS1 Namenode å•ç‚¹æ•…éšœé—®é¢˜ è”é‚¦æ–¹æ¡ˆ è§£å†³äº† HDFS1 å†…å­˜å—é™é—®é¢˜ 3. HDFS3 HA æ–¹æ¡ˆæ”¯æŒå¤šä¸ª Namenode å¼•å…¥çº åˆ ç æŠ€æœ¯ æ€è€ƒï¼š å› ä¸º NameNode ç®¡ç†äº†å…ƒæ•°æ®, ç”¨æˆ·æ‰€æœ‰çš„æ“ä½œè¯·æ±‚éƒ½è¦æ“ä½œ Namenodeï¼Œ å¤§ä¸€ç‚¹çš„å¹³å°ä¸€å¤©éœ€è¦è¿è¡Œå‡ åä¸‡ä¸Šç™¾ä¸‡çš„ä»»åŠ¡ã€‚ä¸€ä¸ªä»»åŠ¡å°±ä¼šæœ‰å¾ˆå¤šä¸ªè¯·æ±‚ï¼Œè¿™äº›æ‰€æœ‰çš„è¯·æ±‚éƒ½æ‰“åˆ° Namenode è¿™å„¿ (æ›´æ–°ç›®å½•æ ‘)ï¼Œ å¯¹äº Namenode æ¥è¯´è¿™å°±æ˜¯äº¿çº§çš„æµé‡. Namenode æ˜¯å¦‚ä½•æ”¯æ’‘äº¿çº§æµé‡çš„å‘¢ï¼Ÿ Reference 50ä¸ªHadoopçš„é¢è¯•é—®é¢˜ å¤§æ•°æ®å¼€å‘ç³»åˆ—ç›´æ’­è¯¾ â‘¢","categories":[{"name":"hadoop","slug":"hadoop","permalink":"http://iequa.com/categories/hadoop/"}],"tags":[{"name":"hdfs","slug":"hdfs","permalink":"http://iequa.com/tags/hdfs/"}]},{"title":"æœ€å…¨ Tensorflow2.0 å…¥é—¨æ•™ç¨‹æŒç»­æ›´æ–°","slug":"tensorflow/tf2.0-1-keras","date":"2019-09-05T05:17:21.000Z","updated":"2019-10-20T04:30:35.054Z","comments":true,"path":"2019/09/05/tensorflow/tf2.0-1-keras/","link":"","permalink":"http://iequa.com/2019/09/05/tensorflow/tf2.0-1-keras/","excerpt":"çŸ¥ä¹ï¼šæœ€å…¨Tensorflow2.0 å…¥é—¨æ•™ç¨‹æŒç»­æ›´æ–°","text":"çŸ¥ä¹ï¼šæœ€å…¨Tensorflow2.0 å…¥é—¨æ•™ç¨‹æŒç»­æ›´æ–° Reference tensorflow.org çŸ¥ä¹ï¼šæœ€å…¨Tensorflow2.0 å…¥é—¨æ•™ç¨‹æŒç»­æ›´æ–°","categories":[{"name":"tensorflow","slug":"tensorflow","permalink":"http://iequa.com/categories/tensorflow/"}],"tags":[{"name":"tensorflow","slug":"tensorflow","permalink":"http://iequa.com/tags/tensorflow/"}]},{"title":"Summary 20 dynamic programming","slug":"leetcode/summary_dp","date":"2019-08-31T02:54:16.000Z","updated":"2020-11-27T03:23:12.117Z","comments":true,"path":"2019/08/31/leetcode/summary_dp/","link":"","permalink":"http://iequa.com/2019/08/31/leetcode/summary_dp/","excerpt":"","text":"ä½¿ç”¨åŠ¨æ€è§„åˆ’è§£å†³é—®é¢˜ä¸€èˆ¬åˆ†ä¸ºä¸‰æ­¥ï¼š è¡¨ç¤ºçŠ¶æ€ æ‰¾å‡ºçŠ¶æ€è½¬ç§»æ–¹ç¨‹ è¾¹ç•Œå¤„ç† è¡¨ç¤ºçŠ¶æ€ åˆ†æé—®é¢˜çš„çŠ¶æ€æ—¶ï¼Œä¸è¦åˆ†ææ•´ä½“ï¼Œåªåˆ†ææœ€åä¸€ä¸ªé˜¶æ®µå³å¯ï¼å› ä¸ºåŠ¨æ€è§„åˆ’é—®é¢˜éƒ½æ˜¯åˆ’åˆ†ä¸ºå¤šä¸ªé˜¶æ®µçš„ï¼Œå„ä¸ªé˜¶æ®µçš„çŠ¶æ€è¡¨ç¤ºéƒ½æ˜¯ä¸€æ ·ï¼Œè€Œæˆ‘ä»¬çš„æœ€ç»ˆç­”æ¡ˆåœ¨å°±æ˜¯åœ¨æœ€åä¸€ä¸ªé˜¶æ®µã€‚ çˆ¬æ¥¼æ¢¯ climbing-stairs ï¼Œ âœ”ï¸ æ–°å»º{}or[] ,æ»šåŠ¨æ•°ç»„ ä¸åŒè·¯å¾„ II ï¼Œ âœ”ï¸ ç¼–è¾‘è·ç¦» ï¼Œ âœ”ï¸ æ‰”é¸¡è›‹ è¿ç»­å­æ•°ç»„çš„æœ€å¤§å’Œ // dp: F[i] = max(a[i], F[i-1]+a[i]); Longest Palindromic Substring/æœ€é•¿å›æ–‡å­ä¸² Edit Distance/ç¼–è¾‘è·ç¦» Distinct Subsequences/ä¸åŒå­åºåˆ— Interleaving String/äº¤é”™å­—ç¬¦ä¸² ) æŠŠæ•°å­—ç¿»è¯‘æˆå­—ç¬¦ä¸² Leetcode 64. Minimum Path Sum, æœ€å°è·¯å¾„å’Œ 115. Distinct Subsequences I (Hard) 940. ä¸åŒçš„å­åºåˆ— II (Hard) ä¸åŒè·¯å¾„ IIï¼š å¦‚æœå½“å‰æ²¡æœ‰éšœç¢ç‰©ï¼Œdp[m][n] = dp[m - 1][n] + dp[m][n - 1]å¦‚æœæœ‰éšœç¢ç‰©ï¼Œåˆ™dp[m][n] = 0 è¾“å…¥:[ [0,0,0], [0,1,0], [0,0,0]]è¾“å‡º: 2class Solution: def uniquePathsWithObstacles(self, obstacleGrid: List[List[int]]) -&gt; int: #æ–°å»ºçŸ©é˜µç‰ˆ height, width = len(obstacleGrid),len(obstacleGrid[0]) store = [[0]*width for i in range(height)] #ä»ä¸Šåˆ°ä¸‹ï¼Œä»å·¦åˆ°å³ for m in range(height):#æ¯ä¸€è¡Œ for n in range(width):#æ¯ä¸€åˆ— if not obstacleGrid[m][n]: #å¦‚æœè¿™ä¸€æ ¼æ²¡æœ‰éšœç¢ç‰© if m == n == 0: #æˆ–if not(m or n) store[m][n] = 1 else: a = store[m-1][n] if m!=0 else 0 #ä¸Šæ–¹æ ¼å­ b = store[m][n-1] if n!=0 else 0 #å·¦æ–¹æ ¼å­ store[m][n] = a+b return store[-1][-1] ç¼–è¾‘è·ç¦»ï¼š ç»™ä½ ä¸¤ä¸ªå•è¯ word1 å’Œ word2ï¼Œè¯·ä½ è®¡ç®—å‡ºå°† word1 è½¬æ¢æˆ word2 æ‰€ä½¿ç”¨çš„æœ€å°‘æ“ä½œæ•° ã€‚ä½ å¯ä»¥å¯¹ä¸€ä¸ªå•è¯è¿›è¡Œå¦‚ä¸‹ä¸‰ç§æ“ä½œï¼šæ’å…¥ä¸€ä¸ªå­—ç¬¦åˆ é™¤ä¸€ä¸ªå­—ç¬¦æ›¿æ¢ä¸€ä¸ªå­—ç¬¦è¾“å…¥ï¼šword1 = &quot;horse&quot;, word2 = &quot;ros&quot;è¾“å‡ºï¼š3è§£é‡Šï¼šhorse -&gt; rorse (å°† &#x27;h&#x27; æ›¿æ¢ä¸º &#x27;r&#x27;)rorse -&gt; rose (åˆ é™¤ &#x27;r&#x27;)rose -&gt; ros (åˆ é™¤ &#x27;e&#x27;) å¦‚æœå•è¯1ç¬¬i+1ä¸ªå­—ç¬¦å’Œå•è¯2ç¬¬j+1ä¸ªå­—ç¬¦ç›¸åŒï¼Œé‚£ä¹ˆå°±ä¸ç”¨æ“ä½œï¼Œåˆ™DP[i + 1][j + 1] = DP[i][j]; å¦‚æœä¸ç›¸åŒ,åˆ™æœ‰ä¸‰ç§å¯èƒ½æ“ä½œï¼Œå³å¢ï¼Œåˆ ï¼Œæ›¿æ¢ã€‚åˆ™å–è¿™ä¸‰ç§æ“ä½œçš„æœ€ä¼˜å€¼ï¼Œå³dp[i + 1][j + 1] = 1 + Math.min(dp[i][j], Math.min(dp[i][j + 1], dp[i + 1][j])); class Solution: def minDistance(self, word1, word2): &quot;&quot;&quot; :type word1: str :type word2: str :rtype: int &quot;&quot;&quot; n = len(word1) m = len(word2) # æœ‰ä¸€ä¸ªå­—ç¬¦ä¸²ä¸ºç©ºä¸² if n * m == 0: return n + m # dp æ•°ç»„ dp = [ [0] * (m + 1) for _ in range(n + 1)] # è¾¹ç•ŒçŠ¶æ€åˆå§‹åŒ– for i in range(n + 1): dp[i][0] = i for j in range(m + 1): dp[0][j] = j # è®¡ç®—æ‰€æœ‰ DP å€¼ for i in range(1, n + 1): for j in range(1, m + 1): left = dp[i - 1][j] + 1 right = dp[i][j - 1] + 1 left_right = dp[i - 1][j - 1] if word1[i - 1] != word2[j - 1]: left_right += 1 dp[i][j] = min(left, right, left_right) return dp[n][m] äºŒç»´DPå¸ƒå°”æ•°ç»„ (1). Longest Palindromic Substring/æœ€é•¿å›æ–‡å­ä¸² ï¼Œ $P(i,j)=P(i+1,jâˆ’1)âˆ§(Si == Sj)$ class Solution: def longestPalindrome(self, s: str) -&gt; str: n = len(s) dp = [[False] * n for _ in range(n)] ans = &quot;&quot; # æšä¸¾å­ä¸²çš„é•¿åº¦ l+1 for l in range(n): sub_len = l+1 # æšä¸¾å­ä¸²çš„èµ·å§‹ä½ç½® iï¼Œè¿™æ ·å¯ä»¥é€šè¿‡ j=i+l å¾—åˆ°å­ä¸²çš„ç»“æŸä½ç½® for i in range(n): j = i + l if j &gt;= len(s): break if sub_len == 1: dp[i][j] = True elif sub_len == 2: dp[i][j] = (s[i] == s[j]) else: dp[i][j] = (dp[i + 1][j - 1] and s[i] == s[j]) if dp[i][j] and sub_len &gt; len(ans): ans = s[i:j+1] # &quot;abcd&quot;[1:2] = b return ans (2). Interleaving String/äº¤é”™å­—ç¬¦ä¸² ç»™å®šä¸‰ä¸ªå­—ç¬¦ä¸² s1, s2, s3, éªŒè¯ s3 æ˜¯å¦æ˜¯ç”± s1 å’Œ s2 äº¤é”™ç»„æˆçš„ã€‚ ç¤ºä¾‹ 1ï¼šè¾“å…¥ï¼šs1 = &quot;aabcc&quot;, s2 = &quot;dbbca&quot;, s3 = &quot;aadbbcbcac&quot;è¾“å‡ºï¼štrueç¤ºä¾‹ 2ï¼šè¾“å…¥ï¼šs1 = &quot;aabcc&quot;, s2 = &quot;dbbca&quot;, s3 = &quot;aadbbbaccc&quot;è¾“å‡ºï¼šfalse è§£å†³è¿™ä¸ªé—®é¢˜çš„æ­£ç¡®æ–¹æ³•æ˜¯åŠ¨æ€è§„åˆ’ã€‚ é¦–å…ˆå¦‚æœ $|s_1| + |s_2| \\neq |s_3|$, é‚£ $s_3$ å¿…ç„¶ä¸å¯èƒ½ç”± $s_1$ å’Œ $s_2$ äº¤é”™ç»„æˆã€‚åœ¨ $|s_1| + |s_2| = |s_3|$æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨åŠ¨æ€è§„åˆ’æ¥æ±‚è§£ã€‚æˆ‘ä»¬å®šä¹‰ $f(i,j)$ è¡¨ç¤º $s_1$ çš„å‰ $i$ ä¸ªå…ƒç´ å’Œ $s_2$ çš„å‰ $j$ ä¸ªå…ƒç´ æ˜¯å¦èƒ½äº¤é”™ç»„æˆ $s_3$ çš„å‰ $i + j$ ä¸ªå…ƒç´ ã€‚å¦‚æœ $s_1$ çš„ç¬¬ $i$ ä¸ªå…ƒç´ å’Œ $s_3$ çš„ç¬¬ $i+j$ ä¸ªå…ƒç´ ç›¸ç­‰ï¼Œé‚£ä¹ˆ $s_1$ çš„å‰ $i$ ä¸ªå…ƒç´ å’Œ $s_2$ çš„å‰ $j$ ä¸ªå…ƒç´ æ˜¯å¦èƒ½äº¤é”™ç»„æˆ $s_3$ çš„å‰ $i+j$ ä¸ªå…ƒç´ å–å†³äº $s_1$ çš„å‰ $iâˆ’1$ ä¸ªå…ƒç´ å’Œ $s_2$ çš„å‰ $j$ ä¸ªå…ƒç´ æ˜¯å¦èƒ½äº¤é”™ç»„æˆ $s_3$ çš„å‰ $i + j - 1$ ä¸ªå…ƒç´ ï¼Œå³æ­¤æ—¶ $f(i, j)$ å–å†³äº $f(i - 1, j)$ï¼Œåœ¨æ­¤æƒ…å†µä¸‹å¦‚æœ $f(i - 1, j)$ ä¸ºçœŸï¼Œåˆ™ $f(i, j)$ ä¹Ÿä¸ºçœŸã€‚åŒæ ·çš„ï¼Œå¦‚æœ $s_2$ çš„ç¬¬ $j$ ä¸ªå…ƒç´ å’Œ $s_3$ çš„ç¬¬ $i + j$ ä¸ªå…ƒç´ ç›¸ç­‰å¹¶ä¸” $f(i, j - 1)$ ä¸ºçœŸï¼Œåˆ™ $f(i, j)$ ä¹Ÿä¸ºçœŸã€‚äºæ˜¯æˆ‘ä»¬å¯ä»¥æ¨å¯¼å‡ºè¿™æ ·çš„åŠ¨æ€è§„åˆ’è½¬ç§»æ–¹ç¨‹ï¼š f(i, j) = [f(i - 1, j) \\, {\\rm and} \\, s_1(i - 1) = s_3(p)] \\, {\\rm or} \\, [f(i, j - 1) \\, {\\rm and} \\, s_2(j - 1) = s_3(p)]å…¶ä¸­ $p = i + j - 1$ã€‚è¾¹ç•Œæ¡ä»¶ä¸º $f(0, 0) = {\\rm True}$ã€‚è‡³æ­¤ï¼Œæˆ‘ä»¬å¾ˆå®¹æ˜“å¯ä»¥ç»™å‡ºè¿™æ ·ä¸€ä¸ªå®ç°ï¼š class Solution: def isInterleave(self, s1: str, s2: str, s3: str) -&gt; bool: len1=len(s1) len2=len(s2) len3=len(s3) if(len1+len2!=len3): return False dp=[[False]*(len2+1) for i in range(len1+1)] dp[0][0]=True for i in range(1,len1+1): dp[i][0]=(dp[i-1][0] and s1[i-1]==s3[i-1]) for i in range(1,len2+1): dp[0][i]=(dp[0][i-1] and s2[i-1]==s3[i-1]) for i in range(1,len1+1): for j in range(1,len2+1): dp[i][j]=(dp[i][j-1] and s2[j-1]==s3[i+j-1]) or (dp[i-1][j] and s1[i-1]==s3[i+j-1]) return dp[-1][-1] (3). å‰‘æŒ‡ Offer 46. æŠŠæ•°å­—ç¿»è¯‘æˆå­—ç¬¦ä¸² ç»™å®šä¸€ä¸ªæ•°å­—ï¼Œæˆ‘ä»¬æŒ‰ç…§å¦‚ä¸‹è§„åˆ™æŠŠå®ƒç¿»è¯‘ä¸ºå­—ç¬¦ä¸²ï¼š0 ç¿»è¯‘æˆ â€œaâ€ ï¼Œ1 ç¿»è¯‘æˆ â€œbâ€ï¼Œâ€¦â€¦ï¼Œ11 ç¿»è¯‘æˆ â€œlâ€ï¼Œâ€¦â€¦ï¼Œ25 ç¿»è¯‘æˆ â€œzâ€ã€‚ä¸€ä¸ªæ•°å­—å¯èƒ½æœ‰å¤šä¸ªç¿»è¯‘ã€‚è¯·ç¼–ç¨‹å®ç°ä¸€ä¸ªå‡½æ•°ï¼Œç”¨æ¥è®¡ç®—ä¸€ä¸ªæ•°å­—æœ‰å¤šå°‘ç§ä¸åŒçš„ç¿»è¯‘æ–¹æ³•ã€‚ ç¤ºä¾‹ 1: è¾“å…¥: 12258è¾“å‡º: 5è§£é‡Š: 12258æœ‰5ç§ä¸åŒçš„ç¿»è¯‘ï¼Œåˆ†åˆ«æ˜¯&quot;bccfi&quot;, &quot;bwfi&quot;, &quot;bczi&quot;, &quot;mcfi&quot;å’Œ&quot;mzi&quot; åˆ†ææ‘˜è¦ï¼š è¦çš„æ˜¯ç§ç±»æ€»æ•°ï¼Œå¹¶ä¸æ˜¯è¦çš„æ˜¯è¯¦ç»†åˆ—è¡¨ï¼Œè¿™ç±»é—®é¢˜ï¼Œå¸¸è§æ–¹æ¡ˆæ˜¯ï¼š åŠ¨æ€è§„åˆ’ åˆ†ç±»è®¡æ•°ï¼š dp[i] è¡¨ç¤º nums[0â€¦i] dp[i] = dp[i-1] + dp[i-2] class Solution: def translateNum(self, num: int) -&gt; int: s = str(num) a = b = 1 for i in range(2, len(s) + 1): tmp = s[i - 2:i] c = a + b if &quot;10&quot; &lt;= tmp &lt;= &quot;25&quot; else a b = a a = c return a æ•°å­—æ•°ç»„ Leetcode 64. Minimum Path Sum, æœ€å°è·¯å¾„å’Œ çŸ©é˜µå·¦ä¸Šè§’å‡ºå‘åˆ°å³ä¸‹è§’ï¼Œåªèƒ½å‘å³æˆ–å‘ä¸‹èµ°ï¼Œæ‰¾å‡ºå“ªä¸€æ¡è·¯å¾„ä¸Šçš„æ•°å­—ä¹‹å’Œæœ€å°ã€‚ ç»™å®šä¸€ä¸ªåŒ…å«éè´Ÿæ•´æ•°çš„ m x n ç½‘æ ¼ï¼Œè¯·æ‰¾å‡ºä¸€æ¡ä»å·¦ä¸Šè§’åˆ°å³ä¸‹è§’çš„è·¯å¾„ï¼Œä½¿å¾—è·¯å¾„ä¸Šçš„æ•°å­—æ€»å’Œä¸ºæœ€å°ã€‚ è¯´æ˜ï¼šæ¯æ¬¡åªèƒ½å‘ä¸‹æˆ–è€…å‘å³ç§»åŠ¨ä¸€æ­¥ã€‚ ç¤ºä¾‹: è¾“å…¥:[ [1,3,1], [1,5,1], [4,2,1]]è¾“å‡º: 7è§£é‡Š: å› ä¸ºè·¯å¾„ 1â†’3â†’1â†’1â†’1 çš„æ€»å’Œæœ€å°ã€‚ 12. ä¸åŒçš„å­åºåˆ—ç¤ºä¾‹ 1ï¼šè¾“å…¥ï¼šS = &quot;rabbbit&quot;, T = &quot;rabbit&quot;è¾“å‡ºï¼š3è§£é‡Šï¼šå¦‚ä¸‹å›¾æ‰€ç¤º, æœ‰ 3 ç§å¯ä»¥ä» S ä¸­å¾—åˆ° &quot;rabbit&quot; çš„æ–¹æ¡ˆã€‚(ä¸Šç®­å¤´ç¬¦å· ^ è¡¨ç¤ºé€‰å–çš„å­—æ¯)rabbbit^^^^ ^^rabbbit^^ ^^^^rabbbit^^^ ^^^ dp[i][j] ä»£è¡¨ T å‰ i å­—ç¬¦ä¸²å¯ä»¥ç”± S j å­—ç¬¦ä¸²ç»„æˆæœ€å¤šä¸ªæ•°. [1, 1, 1, 1, 1, 1, 1, 1][0, 1, 1, 2, 2, 3, 3, 3][0, 0, 1, 1, 1, 1, 4, 4][0, 0, 0, 0, 1, 1, 1, 5]5 æ‰€ä»¥åŠ¨æ€æ–¹ç¨‹: å½“ S[j] == T[i] , dp[i][j] = dp[i-1][j-1] + dp[i][j-1]; å½“ S[j] != T[i] , dp[i][j] = dp[i][j-1] ä¸¾ä¸ªä¾‹å­,å¦‚ç¤ºä¾‹çš„ Reference çŸ¥ä¹ï¼š [Leetcode][åŠ¨æ€è§„åˆ’]ç›¸å…³é¢˜ç›®æ±‡æ€»/åˆ†æ/æ€»ç»“ ç®€ä¹¦ï¼š 2019 ç®—æ³•é¢è¯•ç›¸å…³(leetcode)â€”åŠ¨æ€è§„åˆ’(Dynamic Programming) CSDN leetcode DP åˆ·å®Œ700å¤šé¢˜åçš„é¦–æ¬¡æ€»ç»“ï¼šLeetCodeåº”è¯¥æ€ä¹ˆåˆ·ï¼Ÿ å°ç™½ä¸€è·¯èµ°æ¥ï¼Œè¿ç»­åˆ·é¢˜ä¸‰å¹´ï¼Œè°ˆè°ˆæˆ‘çš„ç®—æ³•å­¦ä¹ ç»éªŒ","categories":[{"name":"leetcode","slug":"leetcode","permalink":"http://iequa.com/categories/leetcode/"}],"tags":[{"name":"dp","slug":"dp","permalink":"http://iequa.com/tags/dp/"}]},{"title":"SparkSql - ç»“æ„åŒ–æ•°æ®å¤„ç† (ä¸‹)","slug":"spark/spark-aura-9.2-SparkSql","date":"2019-08-27T23:07:21.000Z","updated":"2020-12-06T06:03:47.601Z","comments":true,"path":"2019/08/28/spark/spark-aura-9.2-SparkSql/","link":"","permalink":"http://iequa.com/2019/08/28/spark/spark-aura-9.2-SparkSql/","excerpt":"","text":"1. spark æ•´åˆ yarn rdd.aggregateByKey(init_value: U) ((C, U) =&gt; (C,C) =&gt; C) Spark 2.3 on yarnçš„é…ç½®å®‰è£… 1.1 é…ç½® Spark æ•´åˆ YARN æŠŠ yarn-site.xml å¤åˆ¶åˆ° $SPARK_HOME/conf ç›®å½•ä¸­ åœ¨ä½¿ç”¨ spark-submit æäº¤ä»»åŠ¡æ—¶å€™è¯·è¿™ä¹ˆæ‰§è¡Œèµ„æºè°ƒåº¦ç³»ç»Ÿï¼š spark-submit â€”master yarn â€”deploy-mode client ä½†æ˜¯æœ‰å¯èƒ½å‡ºç°å¼‚å¸¸ 1.2 Spark-Shell æµ‹è¯•åªèƒ½è¿™ä¹ˆå¯åŠ¨spark-shell --master yarn --deploy-mode clientä¸èƒ½è¿™ä¹ˆå¯åŠ¨spark-shell --master yarn --deploy-mode clusteråŸå› ï¼š spark-shell spark-submit driver åŸæ¥ï¼š spark-shellspark-shell --master local[*] 1.3 Spark-Submit æµ‹è¯•åªèƒ½è¿™ä¹ˆå¯åŠ¨spark-submit --master yarn --deploy-mode clientä¹Ÿèƒ½è¿™ä¹ˆå¯åŠ¨spark-submit --master yarn --deploy-mode clusteråŸå› ï¼š spark-shell spark-submit driver 2. spark æ•´åˆ hive2.1 Spark è‡ªå¸¦å…ƒæ•°æ®åº“ &amp;å¦‚æœç”¨æˆ·ç›´æ¥è¿è¡Œbin/spark-sqlå‘½ä»¤ã€‚ä¼šå¯¼è‡´æˆ‘ä»¬çš„å…ƒæ•°æ®æœ‰ä¸¤ç§çŠ¶æ€ï¼š 1ã€in-memoryçŠ¶æ€: å¦‚æœSPARK-HOME/confç›®å½•ä¸‹æ²¡æœ‰æ”¾ç½®hive-site.xmlæ–‡ä»¶ï¼Œå…ƒæ•°æ®çš„çŠ¶æ€å°±æ˜¯in-memoryï¼Œ ä¹Ÿå°±æ˜¯ä½¿ç”¨è‡ªå¸¦çš„ derby åœ¨å½“å‰ä¼šè¯ä¸­æœ‰æ•ˆ create table student(id int, name string, sex string, age int, department string)row format delimited fields terminated by &quot;,&quot;load data local inpath &quot;/home/..&quot; spark-sql åœ¨ hadoop02 å’Œ hadoop03 ä¸­å¯åŠ¨çš„æ—¶å€™ï¼Œéƒ½å„è‡ªåˆå§‹åŒ–äº†ä¸€ä¸ªå…ƒæ•°æ®åº“ æ‰€ä»¥åœ¨ hadoop02 ä¸Šåˆ›å»ºçš„å…ƒæ•°æ®åº“ï¼Œåœ¨ hadoop03 ä¸Šå¯åŠ¨çš„ spark-sql ä¸èƒ½å…±ç”¨æ•°æ®. spark-sql çš„ä½¿ç”¨æœ‰2ç§æ¨¡å¼ 2.2 Spark æ•´åˆhiveé…ç½®2ã€hiveçŠ¶æ€ï¼š å¦‚æœæˆ‘ä»¬åœ¨SPARK-HOME/confç›®å½•ä¸‹æ”¾ç½®äº†ï¼Œhive-site.xmlæ–‡ä»¶ï¼Œé‚£ä¹ˆé»˜è®¤æƒ…å†µä¸‹ spark-sqlçš„å…ƒæ•°æ®çš„çŠ¶æ€å°±æ˜¯hive. 2.3 SparkSQL è„šæœ¬ä½¿ç”¨3. sparksqlå’Œhiveçš„è‡ªå®šä¹‰å‡½æ•°3.1 SparkSQL UDFshow functions; 3.2 SparkSQL UDAF3.3 ä½¿ç”¨æµ‹è¯•4. SparkSQL å¸¸ç”¨çª—å£åˆ†æå‡½æ•°5. ç»¼åˆç»ƒä¹ Reference Sparkå®ä¾‹-è‡ªå®šä¹‰èšåˆå‡½æ•° Spark UDFä½¿ç”¨è¯¦è§£åŠä»£ç ç¤ºä¾‹ çœ‹äº†ä¹‹åä¸å†è¿·ç³Š-Sparkå¤šç§è¿è¡Œæ¨¡å¼,ä¿ºæ˜¯äº®å“¥ Spark SQL, DataFrame å’Œ Dataset ç¼–ç¨‹æŒ‡å— Spark2.xå­¦ä¹ ç¬”è®°ï¼š14ã€Spark SQLç¨‹åºè®¾è®¡ SparkSQLå­¦ä¹  1 2 3 SparkSQLåœ¨æœ‰èµå¤§æ•°æ®çš„å®è·µï¼ˆäºŒï¼‰ How to convert rdd object to dataframe in spark äº‘è¯¾å ‚ SparkSQL çš„æ•°æ®æºæ“ä½œ å¤§æ•°æ®èµ„æ–™ç¬”è®°æ•´ç† HDOJ_1711_KMP æ±‚åŒ¹é…ä½ç½®","categories":[{"name":"spark","slug":"spark","permalink":"http://iequa.com/categories/spark/"}],"tags":[{"name":"spark","slug":"spark","permalink":"http://iequa.com/tags/spark/"}]},{"title":"RNN classifier in Keras","slug":"tensorflow/keras-1.5-RNN","date":"2019-08-22T12:17:21.000Z","updated":"2019-10-20T04:30:35.051Z","comments":true,"path":"2019/08/22/tensorflow/keras-1.5-RNN/","link":"","permalink":"http://iequa.com/2019/08/22/tensorflow/keras-1.5-RNN/","excerpt":"RNN, Recurrent Neural Networks è¿›è¡Œåˆ†ç±»ï¼ˆclassificationï¼‰ï¼Œé‡‡ç”¨ MNIST æ•°æ®é›†ï¼Œç”¨ SimpleRNN å±‚ã€‚","text":"RNN, Recurrent Neural Networks è¿›è¡Œåˆ†ç±»ï¼ˆclassificationï¼‰ï¼Œé‡‡ç”¨ MNIST æ•°æ®é›†ï¼Œç”¨ SimpleRNN å±‚ã€‚ LSTM in Keras import numpy as npnp.random.seed(1337) # for reproducibilityfrom keras.datasets import mnistfrom keras.utils import np_utilsfrom keras.models import Sequentialfrom keras.layers import SimpleRNN, Activation, Densefrom keras.optimizers import AdamTIME_STEPS = 28 # same as the height of the imageINPUT_SIZE = 28 # same as the width of the imageBATCH_SIZE = 50BATCH_INDEX = 0OUTPUT_SIZE = 10CELL_SIZE = 50LR = 0.001 1. data pre-processingMNISTé‡Œé¢çš„å›¾åƒåˆ†è¾¨ç‡æ˜¯28Ã—28ï¼Œä¸ºç”¨RNNï¼Œå°†å›¾åƒç†è§£ä¸ºåºåˆ—åŒ–æ•°æ®ã€‚ æ¯ä¸€è¡Œä½œä¸ºä¸€ä¸ªè¾“å…¥å•å…ƒï¼Œæ‰€ä»¥è¾“å…¥æ•°æ®å¤§å° INPUT_SIZE = 28ï¼› å…ˆæ˜¯ç¬¬1è¡Œè¾“å…¥ï¼Œå†æ˜¯ç¬¬2è¡Œï¼Œâ€¦ï¼Œç¬¬28è¡Œè¾“å…¥ï¼Œ è¿™å°±æ˜¯ä¸€å¼ å›¾ç‰‡ä¹Ÿå°±æ˜¯ä¸€ä¸ªåºåˆ—ï¼Œæ‰€ä»¥æ­¥é•¿ TIME_STEPS = 28ã€‚ è®­ç»ƒæ•°æ®è¦è¿›è¡Œ normalizeï¼Œå› ä¸ºåŸå§‹æ•°æ®æ˜¯ 8bit ç°åº¦å›¾åƒ, æ‰€ä»¥éœ€è¦é™¤ä»¥ 255ã€‚ # download the mnist to the path &#x27;~/.keras/datasets/&#x27; if it is the first time to be called# X shape (60,000 28x28), y shape (10,000, )(X_train, y_train), (X_test, y_test) = mnist.load_data()# data pre-processingX_train = X_train.reshape(-1, 28, 28) / 255. # normalizeX_test = X_test.reshape(-1, 28, 28) / 255. # normalizey_train = np_utils.to_categorical(y_train, num_classes=10)y_test = np_utils.to_categorical(y_test, num_classes=10) print(X_train.shape)print(y_train.shape)(60000, 28, 28)(60000, 10) 2. build model# build RNN modelmodel = Sequential()# RNN cellmodel.add(SimpleRNN( # for batch_input_shape, if using tensorflow as the backend, we have to put None for the batch_size. # Otherwise, model.evaluate() will get error. batch_input_shape=(None, TIME_STEPS, INPUT_SIZE), # Or: input_dim=INPUT_SIZE, input_length=TIME_STEPS, output_dim=CELL_SIZE, unroll=True,)) # output layermodel.add(Dense(OUTPUT_SIZE))model.add(Activation(&#x27;softmax&#x27;))# optimizeradam = Adam(LR)model.compile(optimizer=adam, loss=&#x27;categorical_crossentropy&#x27;, metrics=[&#x27;accuracy&#x27;])model.summary() _________________________________________________________________ Layer (type) Output Shape Param # ================================================================= simple_rnn_1 (SimpleRNN) (None, 50) 3950 _________________________________________________________________ dense_1 (Dense) (None, 10) 510 _________________________________________________________________ activation_1 (Activation) (None, 10) 0 _________________________________________________________________ dense_2 (Dense) (None, 10) 110 _________________________________________________________________ activation_2 (Activation) (None, 10) 0 ================================================================= Total params: 4,570 Trainable params: 4,570 Non-trainable params: 0 _________________________________________________________________ è®¾ç½®ä¼˜åŒ–æ–¹æ³•ï¼Œlosså‡½æ•° å’Œ metrics æ–¹æ³•ä¹‹åå°±å¯ä»¥å¼€å§‹è®­ç»ƒäº†ã€‚ æ¯æ¬¡è®­ç»ƒçš„æ—¶å€™å¹¶ä¸æ˜¯å–æ‰€æœ‰çš„æ•°æ®ï¼Œåªæ˜¯å– BATCH_SIZEä¸ªåºåˆ—ï¼Œæˆ–è€…ç§°ä¸º BATCH_SIZE å¼ å›¾ç‰‡ï¼Œè¿™æ ·å¯ä»¥å¤§å¤§é™ä½è¿ç®—æ—¶é—´ï¼Œæé«˜è®­ç»ƒæ•ˆç‡ã€‚ 3. training &amp; evaluateè¾“å‡º test ä¸Šçš„ loss å’Œ accuracy ç»“æœ # trainingfor step in range(4001): # data shape = (batch_num, steps, inputs/outputs) X_batch = X_train[BATCH_INDEX: BATCH_INDEX+BATCH_SIZE, :, :] Y_batch = y_train[BATCH_INDEX: BATCH_INDEX+BATCH_SIZE, :] cost = model.train_on_batch(X_batch, Y_batch) BATCH_INDEX += BATCH_SIZE BATCH_INDEX = 0 if BATCH_INDEX &gt;= X_train.shape[0] else BATCH_INDEX if step % 500 == 0: cost, accuracy = model.evaluate(X_test, y_test, batch_size=y_test.shape[0], verbose=False) print(&#x27;test cost: &#x27;, cost, &#x27;test accuracy: &#x27;, accuracy) test cost: 2.311124086380005 test accuracy: 0.0957999974489212 test cost: 1.6327736377716064 test accuracy: 0.5228999853134155 test cost: 1.3161704540252686 test accuracy: 0.559499979019165 test cost: 1.1487971544265747 test accuracy: 0.5494999885559082 test cost: 1.0471760034561157 test accuracy: 0.5713000297546387 test cost: 1.0110148191452026 test accuracy: 0.5630999803543091 test cost: 0.9520753622055054 test accuracy: 0.5877000093460083 test cost: 0.8796814680099487 test accuracy: 0.604200005531311 test cost: 0.858435869216919 test accuracy: 0.6585999727249146 Reference keras-cnã€ keras.io è«çƒ¦ Keras","categories":[{"name":"tensorflow","slug":"tensorflow","permalink":"http://iequa.com/categories/tensorflow/"}],"tags":[{"name":"keras","slug":"keras","permalink":"http://iequa.com/tags/keras/"}]},{"title":"CNN classifier in Keras","slug":"tensorflow/keras-1.4-CNN","date":"2019-08-22T07:17:21.000Z","updated":"2019-10-20T04:30:35.052Z","comments":true,"path":"2019/08/22/tensorflow/keras-1.4-CNN/","link":"","permalink":"http://iequa.com/2019/08/22/tensorflow/keras-1.4-CNN/","excerpt":"Convolutional Neural Networksï¼ŒCNN ä¹Ÿæ˜¯ä¸€ç§å‰é¦ˆç¥ç»ç½‘ç»œï¼Œå…¶ç‰¹ç‚¹æ˜¯æ¯å±‚çš„ç¥ç»å…ƒèŠ‚ç‚¹åªå“åº”å‰ä¸€å±‚å±€éƒ¨åŒºåŸŸèŒƒå›´å†…çš„ç¥ç»å…ƒï¼ˆå…¨è¿æ¥ç½‘ç»œä¸­æ¯ä¸ªç¥ç»å…ƒèŠ‚ç‚¹å“åº”å‰ä¸€å±‚çš„å…¨éƒ¨èŠ‚ç‚¹ï¼‰","text":"Convolutional Neural Networksï¼ŒCNN ä¹Ÿæ˜¯ä¸€ç§å‰é¦ˆç¥ç»ç½‘ç»œï¼Œå…¶ç‰¹ç‚¹æ˜¯æ¯å±‚çš„ç¥ç»å…ƒèŠ‚ç‚¹åªå“åº”å‰ä¸€å±‚å±€éƒ¨åŒºåŸŸèŒƒå›´å†…çš„ç¥ç»å…ƒï¼ˆå…¨è¿æ¥ç½‘ç»œä¸­æ¯ä¸ªç¥ç»å…ƒèŠ‚ç‚¹å“åº”å‰ä¸€å±‚çš„å…¨éƒ¨èŠ‚ç‚¹ï¼‰ Convolutional Neural Network in Keras pooling Convolutional Neural Network in Keras ç ”ç©¶å‘ç°, åœ¨æ¯ä¸€æ¬¡å·ç§¯çš„æ—¶å€™, ç¥ç»å±‚å¯èƒ½ä¼šæ— æ„åœ°ä¸¢å¤±ä¸€äº›ä¿¡æ¯. è¿™æ—¶, pooling å°±å¯ä»¥å¾ˆå¥½åœ°è§£å†³è¿™ä¸€é—®é¢˜. è€Œä¸”æ± åŒ–æ˜¯ä¸€ä¸ªç­›é€‰è¿‡æ»¤çš„è¿‡ç¨‹, èƒ½å°† layer ä¸­æœ‰ç”¨çš„ä¿¡æ¯ç­›é€‰å‡ºæ¥, ç»™ä¸‹ä¸€ä¸ªå±‚åˆ†æ. åŒæ—¶ä¹Ÿå‡è½»äº†ç¥ç»ç½‘ç»œçš„è®¡ç®—è´Ÿæ‹…. ä¹Ÿå°±æ˜¯è¯´åœ¨å·é›†çš„æ—¶å€™, æˆ‘ä»¬ä¸å‹ç¼©é•¿å®½, å°½é‡ä¿ç•™æ›´å¤šä¿¡æ¯, å‹ç¼©çš„å·¥ä½œå°±äº¤ç»™æ± åŒ–äº†,è¿™æ ·çš„ä¸€é¡¹é™„åŠ å·¥ä½œèƒ½å¤Ÿå¾ˆæœ‰æ•ˆçš„æé«˜å‡†ç¡®æ€§. æœ‰äº†è¿™äº›æŠ€æœ¯,æˆ‘ä»¬å°±å¯ä»¥æ­å»ºä¸€ä¸ª CNN. Convolutional Neural Network in Keras import numpy as npnp.random.seed(1337) # for reproducibilityfrom keras.datasets import mnistfrom keras.utils import np_utilsfrom keras.models import Sequentialfrom keras.layers import Dense, Activation, Convolution2D, MaxPooling2D, Flattenfrom keras.optimizers import Adam æ•°æ®é›† MNIST # download the mnist to the path &#x27;~/.keras/datasets/&#x27; if it is the first time to be called# training X shape (60000, 28x28), Y shape (60000, ). test X shape (10000, 28x28), Y shape (10000, )(X_train, y_train), (X_test, y_test) = mnist.load_data() 1. data pre-processingX_train = X_train.reshape(-1, 1,28, 28)/255.X_test = X_test.reshape(-1, 1,28, 28)/255.y_train = np_utils.to_categorical(y_train, num_classes=10)y_test = np_utils.to_categorical(y_test, num_classes=10) 2. build model# Another way to build your CNNmodel = Sequential()# Conv layer 1 output shape (32, 28, 28)model.add(Convolution2D( batch_input_shape=(None, 1, 28, 28), filters=32, kernel_size=5, strides=1, padding=&#x27;same&#x27;, # Padding method data_format=&#x27;channels_first&#x27;,))model.add(Activation(&#x27;relu&#x27;))# Pooling layer 1 (max pooling) output shape (32, 14, 14)model.add(MaxPooling2D( pool_size=2, strides=2, padding=&#x27;same&#x27;, # Padding method data_format=&#x27;channels_first&#x27;,)) å†æ·»åŠ ç¬¬äºŒ, å·ç§¯å±‚å’Œæ± åŒ–å±‚ # Conv layer 2 output shape (64, 14, 14)model.add(Convolution2D(64, 5, strides=1, padding=&#x27;same&#x27;, data_format=&#x27;channels_first&#x27;))model.add(Activation(&#x27;relu&#x27;))# Pooling layer 2 (max pooling) output shape (64, 7, 7)model.add(MaxPooling2D(2, 2, &#x27;same&#x27;, data_format=&#x27;channels_first&#x27;)) Fully connected layer 1 input shape (64 * 7 * 7) = (3136), output shape (1024) model.add(Flatten())model.add(Dense(1024))model.add(Activation(&#x27;relu&#x27;)) Fully connected layer 2 to shape (10) for 10 classes model.add(Dense(10))model.add(Activation(&#x27;softmax&#x27;)) define your optimizer # Another way to define your optimizeradam = Adam(lr=1e-4) keras.layers.Conv1D 1D å·ç§¯å±‚ (ä¾‹å¦‚æ—¶åºå·ç§¯)Keras Convolution1Dä¸Convolution2DåŒºåˆ« _________________________________________________________________ Layer (type) Output Shape Param # ================================================================= conv2d_3 (Conv2D) (None, 32, 28, 28) 832 _________________________________________________________________ activation_5 (Activation) (None, 32, 28, 28) 0 _________________________________________________________________ max_pooling2d_3 (MaxPooling2 (None, 32, 14, 14) 0 _________________________________________________________________ conv2d_4 (Conv2D) (None, 64, 14, 14) 51264 _________________________________________________________________ activation_6 (Activation) (None, 64, 14, 14) 0 _________________________________________________________________ max_pooling2d_4 (MaxPooling2 (None, 64, 7, 7) 0 _________________________________________________________________ flatten_2 (Flatten) (None, 3136) 0 _________________________________________________________________ dense_3 (Dense) (None, 1024) 3212288 _________________________________________________________________ activation_7 (Activation) (None, 1024) 0 _________________________________________________________________ dense_4 (Dense) (None, 10) 10250 _________________________________________________________________ activation_8 (Activation) (None, 10) 0 ================================================================= Total params: 3,274,634 Trainable params: 3,274,634 Non-trainable params: 0 _________________________________________________________________ 3. compile modelè®¾ç½®adamä¼˜åŒ–æ–¹æ³•ï¼Œlosså‡½æ•°, metricsæ–¹æ³•æ¥è§‚å¯Ÿè¾“å‡ºç»“æœ # We add metrics to get more results you want to seemodel.compile(optimizer=adam, loss=&#x27;categorical_crossentropy&#x27;, metrics=[&#x27;accuracy&#x27;]) 4. train modelprint(&#x27;Training ------------&#x27;)# Another way to train the modelmodel.fit(X_train, y_train, epochs=1, batch_size=64,) 5. evaluate modelprint(&#x27;\\nTesting ------------&#x27;)# Evaluate the model with the metrics we defined earlierloss, accuracy = model.evaluate(X_test, y_test)print(&#x27;\\ntest loss: &#x27;, loss)print(&#x27;\\ntest accuracy: &#x27;, accuracy) Reference keras-cnã€ keras.io è«çƒ¦ Keras","categories":[{"name":"tensorflow","slug":"tensorflow","permalink":"http://iequa.com/categories/tensorflow/"}],"tags":[{"name":"CNN","slug":"CNN","permalink":"http://iequa.com/tags/CNN/"}]},{"title":"Classifier in Keras","slug":"tensorflow/keras-1.3-classifier","date":"2019-08-22T06:17:21.000Z","updated":"2019-10-20T04:30:35.064Z","comments":true,"path":"2019/08/22/tensorflow/keras-1.3-classifier/","link":"","permalink":"http://iequa.com/2019/08/22/tensorflow/keras-1.3-classifier/","excerpt":"","text":"Classifier in Keras data preprocessing from keras.datasets import mnist# download the mnist to the path &#x27;~/.keras/datasets/&#x27; if it is the first time to be called# X shape (60,000 28x28), y shape (10,000, )(X_train, y_train), (X_test, y_test) = mnist.load_data()# data pre-processingX_train = X_train.reshape(X_train.shape[0], -1) / 255. # normalizeX_test = X_test.reshape(X_test.shape[0], -1) / 255. # normalizey_train = np_utils.to_categorical(y_train, num_classes=10)y_test = np_utils.to_categorical(y_test, num_classes=10)print(X_train[1].shape)&quot;&quot;&quot;(784,)&quot;&quot;&quot;#print(y_train[:3])&quot;&quot;&quot;[[ 0. 0. 0. 0. 0. 1. 0. 0. 0. 0.] [ 1. 0. 0. 0. 0. 0. 0. 0. 0. 0.] [ 0. 0. 0. 0. 1. 0. 0. 0. 0. 0.]]&quot;&quot;&quot; 1. build modelimport numpy as npnp.random.seed(1337) # for reproducibilityfrom keras.datasets import mnistfrom keras.utils import np_utilsfrom keras.models import Sequentialfrom keras.layers import Dense, Activationfrom keras.optimizers import RMSprop Another way to build your neural net # Another way to build your neural netmodel = Sequential([ Dense(32, input_dim=784), Activation(&#x27;relu&#x27;), Dense(10), Activation(&#x27;softmax&#x27;),])model.summary() _________________________________________________________________ Layer (type) Output Shape Param # ================================================================= dense_5 (Dense) (None, 32) 25120 _________________________________________________________________ activation_5 (Activation) (None, 32) 0 _________________________________________________________________ dense_6 (Dense) (None, 10) 330 _________________________________________________________________ activation_6 (Activation) (None, 10) 0 ================================================================= Total params: 25,450 Trainable params: 25,450 Non-trainable params: 0 _________________________________________________________________ # Another way to define your optimizerrmsprop = RMSprop(lr=0.001, rho=0.9, epsilon=1e-08, decay=0.0) 2. compile model# We add metrics to get more results you want to seemodel.compile(optimizer=rmsprop, loss=&#x27;categorical_crossentropy&#x27;, metrics=[&#x27;accuracy&#x27;]) 3. train modelprint(&#x27;Training ------------&#x27;)# Another way to train the modelmodel.fit(X_train, y_train, epochs=2, batch_size=32)# &quot;&quot;&quot;# Training ------------# Epoch 1/2# 60000/60000 [==============================] - 2s - loss: 0.3506 - acc: 0.9025 # Epoch 2/2# 60000/60000 [==============================] - 2s - loss: 0.1995 - acc: 0.9421 # &quot;&quot;&quot; 4. evaluate modelprint(&#x27;\\nTesting ------------&#x27;)# Evaluate the model with the metrics we defined earlierloss, accuracy = model.evaluate(X_test, y_test)print(&#x27;test loss: &#x27;, loss)print(&#x27;test accuracy: &#x27;, accuracy)&quot;&quot;&quot;Testing ------------ 9760/10000 [============================&gt;.] - ETA: 0stest loss: 0.1724540345test accuracy: 0.9489&quot;&quot;&quot; Reference keras-cnã€ keras.io è«çƒ¦ Keras","categories":[{"name":"tensorflow","slug":"tensorflow","permalink":"http://iequa.com/categories/tensorflow/"}],"tags":[{"name":"keras","slug":"keras","permalink":"http://iequa.com/tags/keras/"}]},{"title":"Regressor in Keras","slug":"tensorflow/keras-1.2-Regressor","date":"2019-08-21T05:17:21.000Z","updated":"2019-10-20T04:30:35.062Z","comments":true,"path":"2019/08/21/tensorflow/keras-1.2-Regressor/","link":"","permalink":"http://iequa.com/2019/08/21/tensorflow/keras-1.2-Regressor/","excerpt":"NN å¯ç”¨æ¥æ¨¡æ‹Ÿ regressionï¼Œç»™ä¸€ç»„æ•°æ®ï¼Œç”¨ä¸€æ¡çº¿å¯¹æ•°æ®è¿›è¡Œæ‹Ÿåˆï¼Œå¹¶å¯é¢„æµ‹æ–°è¾“å…¥ x çš„è¾“å‡ºå€¼ã€‚","text":"NN å¯ç”¨æ¥æ¨¡æ‹Ÿ regressionï¼Œç»™ä¸€ç»„æ•°æ®ï¼Œç”¨ä¸€æ¡çº¿å¯¹æ•°æ®è¿›è¡Œæ‹Ÿåˆï¼Œå¹¶å¯é¢„æµ‹æ–°è¾“å…¥ x çš„è¾“å‡ºå€¼ã€‚ Regressor in Keras åˆ›å»ºæ•°æ® import numpy as npnp.random.seed(1337) # for reproducibilityfrom keras.models import Sequentialfrom keras.layers import Denseimport matplotlib.pyplot as plt # å¯è§†åŒ–æ¨¡å—# create some dataX = np.linspace(-1, 1, 200)np.random.shuffle(X) # randomize the dataY = 0.5 * X + 2 + np.random.normal(0, 0.05, (200, )) # plot dataplt.scatter(X, Y)plt.show()X_train, Y_train = X[:160], Y[:160] # train å‰ 160 data pointsX_test, Y_test = X[160:], Y[160:] # test å 40 data points 1. build modelmodel = Sequential()model.add(Dense(output_dim=1, input_dim=1)) ç”¨ Sequential å»ºç«‹ modelï¼Œ å†ç”¨ model.add æ·»åŠ ç¥ç»å±‚ï¼Œæ·»åŠ çš„æ˜¯ Dense FC å±‚ å‚æ•°æœ‰ä¸¤ä¸ªï¼Œä¸€ä¸ªæ˜¯è¾“å…¥æ•°æ®å’Œè¾“å‡ºæ•°æ®çš„ç»´åº¦ï¼Œæœ¬ä»£ç çš„ä¾‹å­ä¸­ x å’Œ y æ˜¯ä¸€ç»´çš„ã€‚ å¦‚æœéœ€è¦æ·»åŠ ä¸‹ä¸€ä¸ªç¥ç»å±‚çš„æ—¶å€™ï¼Œä¸ç”¨å†å®šä¹‰è¾“å…¥çš„çº¬åº¦ï¼Œå› ä¸ºå®ƒé»˜è®¤å°±æŠŠå‰ä¸€å±‚çš„è¾“å‡ºä½œä¸ºå½“å‰å±‚çš„è¾“å…¥ã€‚åœ¨è¿™ä¸ªä¾‹å­é‡Œï¼Œåªéœ€è¦ä¸€å±‚å°±å¤Ÿäº†ã€‚ 2. compile model# choose loss function and optimizing methodmodel.compile(loss=&#x27;mse&#x27;, optimizer=&#x27;sgd&#x27;)# mse å‡æ–¹è¯¯å·®ï¼› optimizer sgd éšæœºæ¢¯åº¦ä¸‹é™æ³•. 3. train model# trainingprint(&#x27;Training -----------&#x27;)for step in range(301): cost = model.train_on_batch(X_train, Y_train) if step % 100 == 0: print(&#x27;train cost: &#x27;, cost)&quot;&quot;&quot;Training -----------train cost: 4.111329555511475train cost: 0.08777070790529251train cost: 0.007415373809635639train cost: 0.003544030711054802&quot;&quot;&quot; è®­ç»ƒçš„æ—¶å€™ç”¨ model.train_on_batch ä¸€æ‰¹ä¸€æ‰¹çš„è®­ç»ƒ X_train, Y_trainã€‚é»˜è®¤çš„è¿”å›å€¼æ˜¯ cost. 4. evaluate model# testprint(&#x27;\\nTesting ------------&#x27;)cost = model.evaluate(X_test, Y_test, batch_size=40)print(&#x27;test cost:&#x27;, cost)W, b = model.layers[0].get_weights()print(&#x27;Weights=&#x27;, W, &#x27;\\nbiases=&#x27;, b)&quot;&quot;&quot;Testing ------------40/40 [==============================] - 0stest cost: 0.004269329831Weights= [[ 0.54246825]] biases= [ 2.00056005]&quot;&quot;&quot; ç”¨åˆ°çš„å‡½æ•°æ˜¯ model.evaluateï¼Œè¾“å…¥æµ‹è¯•é›†çš„xå’Œyï¼Œ è¾“å‡º costï¼Œweights å’Œ biasesã€‚å…¶ä¸­ weights å’Œ biases æ˜¯å–åœ¨æ¨¡å‹çš„ç¬¬ä¸€å±‚ model.layers[0] å­¦ä¹ åˆ°çš„å‚æ•°ã€‚ ä»å­¦ä¹ åˆ°çš„ç»“æœå¯ä»¥çœ‹åˆ°, weights æ¯”è¾ƒæ¥è¿‘0.5ï¼Œbias æ¥è¿‘ 2ã€‚ 5. Visualization# plotting the predictionY_pred = model.predict(X_test)plt.scatter(X_test, Y_test)plt.plot(X_test, Y_pred)plt.show() 6. Gaussian Distributionå…ˆçœ‹ä¼Ÿå¤§çš„é«˜æ–¯åˆ†å¸ƒï¼ˆGaussian Distributionï¼‰çš„æ¦‚ç‡å¯†åº¦å‡½æ•°ï¼ˆprobability density functionï¼‰ f(x)=\\frac1{\\sqrt{2\\pi}\\sigma}\\exp(-\\frac{(x-\\mu)^2}{2\\sigma^2})å¯¹åº”äºnumpyä¸­ï¼š numpy.random.normal(loc=0.0, scale=1.0, size=None) Reference keras-cnã€ keras.io ä»np.random.normal()åˆ°æ­£æ€åˆ†å¸ƒçš„æ‹Ÿåˆ è«çƒ¦ Keras è«çƒ¦ Keras Model, Save &amp; reload","categories":[{"name":"tensorflow","slug":"tensorflow","permalink":"http://iequa.com/categories/tensorflow/"}],"tags":[{"name":"keras","slug":"keras","permalink":"http://iequa.com/tags/keras/"}]},{"title":"Keras Introduce","slug":"tensorflow/keras-1.1-intro","date":"2019-08-19T05:17:21.000Z","updated":"2019-10-20T04:30:35.053Z","comments":true,"path":"2019/08/19/tensorflow/keras-1.1-intro/","link":"","permalink":"http://iequa.com/2019/08/19/tensorflow/keras-1.1-intro/","excerpt":"Keras å¼€å‘é‡ç‚¹æ˜¯æ”¯æŒå¿«é€Ÿçš„å®éªŒã€‚èƒ½å¤Ÿä»¥æœ€å°çš„æ—¶å»¶æŠŠä½ çš„æƒ³æ³•è½¬æ¢ä¸ºå®éªŒç»“æœï¼Œæ˜¯åšå¥½ç ”ç©¶çš„å…³é”®ã€‚ Keras å¹¶ä¸å¤„ç†å¦‚å¼ é‡ä¹˜æ³•ã€å·ç§¯ç­‰åº•å±‚æ“ä½œã€‚è¿™äº›æ“ä½œä¾èµ–äºæŸç§ç‰¹å®šçš„ã€ä¼˜åŒ–è‰¯å¥½çš„å¼ é‡æ“ä½œåº“ã€‚","text":"Keras å¼€å‘é‡ç‚¹æ˜¯æ”¯æŒå¿«é€Ÿçš„å®éªŒã€‚èƒ½å¤Ÿä»¥æœ€å°çš„æ—¶å»¶æŠŠä½ çš„æƒ³æ³•è½¬æ¢ä¸ºå®éªŒç»“æœï¼Œæ˜¯åšå¥½ç ”ç©¶çš„å…³é”®ã€‚ Keras å¹¶ä¸å¤„ç†å¦‚å¼ é‡ä¹˜æ³•ã€å·ç§¯ç­‰åº•å±‚æ“ä½œã€‚è¿™äº›æ“ä½œä¾èµ–äºæŸç§ç‰¹å®šçš„ã€ä¼˜åŒ–è‰¯å¥½çš„å¼ é‡æ“ä½œåº“ã€‚ Keras + Tensorflow 1. Keras installpip install --upgrade pippip3 install keraspip3 install ipythonpip3 install notebookpip3 install tensorflowpip3 install --upgrade tensorflowpip3 install astkitpip3 install pandaspip3 install matplotlib 2. Basic conceptskeras-cn.readthedocs.io ä¸€äº›åŸºæœ¬æ¦‚å¿µ ç¬¦å·è®¡ç®— tensor å¼ é‡ data_format functional model API batch epochs è§„æ¨¡æœ€å°çš„å¼ é‡æ˜¯0é˜¶å¼ é‡ï¼Œå³æ ‡é‡ï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ªæ•°ã€‚ Keras æ¨¡å‹æœ‰ä¸€ç§å« Sequentialï¼Œä¹Ÿå°±æ˜¯å•è¾“å…¥å•è¾“å‡ºï¼Œä¸€æ¡è·¯é€šåˆ°åº•ï¼Œè·¨å±‚è¿æ¥ç»Ÿç»Ÿæ²¡æœ‰ã€‚ Keras ä¸­ç”¨çš„ä¼˜åŒ–å™¨SGDæ˜¯stochastic gradient descentçš„ç¼©å†™ï¼Œä¸æ˜¯ä¸€æ ·æœ¬æ›´æ–°ï¼Œè¿˜æ˜¯åŸºäºmini-batchçš„. å»–é›ªå³°çš„Pythonæ•™ç¨‹ import numpy as npa = np.array([[1,2],[3,4]])# 1 2# 3 4sum0 = np.sum(a, axis=0)sum1 = np.sum(a, axis=1)print(sum0)print(sum1)# [4 6]# [3 7] 3. Quickstart in 30s30sä¸Šæ‰‹Keras Sequentialæ¨¡å‹å¦‚ä¸‹ from keras.models import Sequentialmodel = Sequential() å°†ä¸€äº›ç½‘ç»œå±‚é€šè¿‡.add()å †å èµ·æ¥ï¼Œå°±æ„æˆäº†ä¸€ä¸ªæ¨¡å‹ï¼š from keras.layers import Dense, Activationmodel.add(Dense(units=64, input_dim=100))model.add(Activation(&quot;relu&quot;))model.add(Dense(units=10))model.add(Activation(&quot;softmax&quot;)) å®Œæˆæ¨¡å‹çš„æ­å»ºåï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨.compile()æ–¹æ³•æ¥ç¼–è¯‘æ¨¡å‹ï¼š model.compile(loss=&#x27;categorical_crossentropy&#x27;, optimizer=&#x27;sgd&#x27;, metrics=[&#x27;accuracy&#x27;])# from keras.optimizers import SGD# model.compile(loss=&#x27;categorical_crossentropy&#x27;, optimizer=SGD(lr=0.01, momentum=0.9, nesterov=True)) å®Œæˆæ¨¡å‹ç¼–è¯‘åï¼Œæˆ‘ä»¬åœ¨è®­ç»ƒæ•°æ®ä¸ŠæŒ‰batchè¿›è¡Œä¸€å®šæ¬¡æ•°çš„è¿­ä»£æ¥è®­ç»ƒç½‘ç»œ model.fit(x_train, y_train, epochs=5, batch_size=32) ä¹Ÿå¯ä»¥æ‰‹åŠ¨å°†ä¸€ä¸ªä¸ªbatchçš„æ•°æ®é€å…¥ç½‘ç»œä¸­è®­ç»ƒï¼Œè¿™æ—¶å€™éœ€è¦ä½¿ç”¨ï¼š model.train_on_batch(x_batch, y_batch) éšåï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸€è¡Œä»£ç å¯¹æˆ‘ä»¬çš„æ¨¡å‹è¿›è¡Œè¯„ä¼°ï¼Œçœ‹çœ‹æ¨¡å‹çš„æŒ‡æ ‡æ˜¯å¦æ»¡è¶³æˆ‘ä»¬çš„è¦æ±‚ï¼š loss_and_metrics = model.evaluate(x_test, y_test, batch_size=128) ä½¿ç”¨æ¨¡å‹ï¼Œå¯¹æ–°çš„æ•°æ®è¿›è¡Œé¢„æµ‹ï¼š classes = model.predict(x_test, batch_size=128) 4. Functional modelå¿«é€Ÿå¼€å§‹å‡½æ•°å¼ï¼ˆFunctionalï¼‰æ¨¡å‹ ç¬¬ä¸€ä¸ªæ¨¡å‹ï¼šå…¨è¿æ¥ç½‘ç»œ å¤šè¾“å…¥å’Œå¤šè¾“å‡ºæ¨¡å‹ å…±äº«å±‚, å±‚â€œèŠ‚ç‚¹â€çš„æ¦‚å¿µ 5. Sequential modelSequential model æ˜¯å¤šä¸ªç½‘ç»œå±‚çš„çº¿æ€§å †å ï¼Œä¹Ÿå°±æ˜¯â€œä¸€æ¡è·¯èµ°åˆ°é»‘â€ã€‚ model = Sequential()model.add(Dense(32, input_shape=(784,)))model.add(Activation(&#x27;relu&#x27;)) 5.1 input data shapemodel = Sequential()model.add(Dense(32, input_dim=784))model = Sequential()model.add(Dense(32, input_shape=(784,))) 5.2 compile and train (fit)Sequential model methods_cnã€Sequential model methods_en compile Arguments optimizer loss metrics # For a multi-class classification problemmodel.compile(optimizer=&#x27;rmsprop&#x27;, loss=&#x27;categorical_crossentropy&#x27;, metrics=[&#x27;accuracy&#x27;]) Keras ä»¥ Numpyæ•°ç»„ ä½œä¸º input_data å’Œ label çš„æ•°æ®ç±»å‹ã€‚è®­ç»ƒæ¨¡å‹ä¸€èˆ¬ä½¿ç”¨fitå‡½æ•°. # For a single-input model with 2 classes (binary classification):model = Sequential()model.add(Dense(32, activation=&#x27;relu&#x27;, input_dim=100))model.add(Dense(1, activation=&#x27;sigmoid&#x27;))model.compile(optimizer=&#x27;rmsprop&#x27;, loss=&#x27;binary_crossentropy&#x27;, metrics=[&#x27;accuracy&#x27;])# Generate dummy dataimport numpy as npdata = np.random.random((1000, 100))labels = np.random.randint(2, size=(1000, 1))# Train the model, iterating on the data in batches of 32 samplesmodel.fit(data, labels, epochs=10, batch_size=32) 6. Pre-knowledge6.1 python language Object-oriented, class, object, encapsulation, polymorphism, inheritance, scope, etc. Python çš„ç§‘å­¦è®¡ç®—åŒ…æœ‰ä¸€å®šäº†è§£ï¼Œnumpy, scipy, scikit-learn, pandasâ€¦ generatorï¼Œä»¥åŠå¦‚ä½•ç¼–å†™ generatorã€‚ä»€ä¹ˆæ˜¯åŒ¿åå‡½æ•°ï¼ˆlambdaï¼‰ 6.2 deep learning Supervised Learning, Unsupervised Learning, Classification, Clustering, Regression Neuron model, multilayer perceptronï¼ŒBP algorithm loss functionï¼Œactivation functionï¼ŒGradient descent Fully Connected NNã€CNNã€RNNã€LSTM Training set, test set, cross validation, under-fitting, over-fitting Reference keras-cn keras.io","categories":[{"name":"tensorflow","slug":"tensorflow","permalink":"http://iequa.com/categories/tensorflow/"}],"tags":[{"name":"keras","slug":"keras","permalink":"http://iequa.com/tags/keras/"}]},{"title":"Named Entity Recognitionï¼ŒNER","slug":"nlp/info-NER","date":"2019-08-15T03:00:21.000Z","updated":"2019-10-20T04:30:35.070Z","comments":true,"path":"2019/08/15/nlp/info-NER/","link":"","permalink":"http://iequa.com/2019/08/15/nlp/info-NER/","excerpt":"","text":"1. NER IntroduceNERç³»ç»Ÿ å°±æ˜¯ä»éç»“æ„åŒ–çš„è¾“å…¥æ–‡æœ¬ä¸­æŠ½å–å‡ºä¸Šè¿°å®ä½“ï¼Œå¹¶ä¸”å¯ä»¥æŒ‰ç…§ä¸šåŠ¡éœ€æ±‚è¯†åˆ«å‡ºæ›´å¤šç±»åˆ«çš„å®ä½“. å‘½åå®ä½“è¯†åˆ«æ˜¯æœªç™»å½•è¯ä¸­æ•°é‡æœ€å¤šã€è¯†åˆ«éš¾åº¦æœ€å¤§ã€å¯¹åˆ†è¯æ•ˆæœå½±å“æœ€å¤§çš„é—®é¢˜ï¼ŒåŒæ—¶å®ƒä¹Ÿæ˜¯ä¿¡æ¯æŠ½å–ã€ä¿¡æ¯æ£€ç´¢ã€æœºå™¨ç¿»è¯‘ã€é—®ç­”ç³»ç»Ÿç­‰å¤šç§è‡ªç„¶è¯­è¨€å¤„ç†æŠ€æœ¯å¿…ä¸å¯å°‘çš„ç»„æˆéƒ¨åˆ†ã€‚ 2. Deep Learning in NERNERå‘å±•è¶‹åŠ¿ Embedding+BiLSTM+CRF æ˜¯ä¸€ä¸ªéå¸¸å¼ºçš„ baseline æ¨¡å‹ï¼Œæ˜¯ç›®å‰åŸºäºæ·±åº¦å­¦ä¹ çš„ NER æ–¹æ³•ä¸­æœ€ä¸»æµçš„æ¨¡å‹ã€‚ 2.1 BiLSTM-CRFLongShort Term Memory ç½‘ç»œä¸€èˆ¬å«åšLSTMï¼Œæ˜¯RNNçš„ä¸€ç§ç‰¹æ®Šç±»å‹ï¼Œå¯ä»¥å­¦ä¹ é•¿è·ç¦»ä¾èµ–ä¿¡æ¯ã€‚ Information Extraction, NER LSTM åŒæ ·æ˜¯è¿™æ ·çš„ç»“æ„ï¼Œä½†æ˜¯é‡å¤çš„å•å…ƒæ‹¥æœ‰ä¸€ä¸ªä¸åŒçš„ç»“æ„ã€‚ä¸åŒäºæ™®é€šRNNå•å…ƒï¼Œè¿™é‡Œæ˜¯æœ‰å››ä¸ªï¼Œä»¥ä¸€ç§éå¸¸ç‰¹æ®Šçš„æ–¹å¼è¿›è¡Œäº¤äº’ã€‚ Information Extraction, NER LSTM é€šè¿‡ä¸‰ä¸ªé—¨ç»“æ„ï¼ˆè¾“å…¥é—¨ï¼Œé—å¿˜é—¨ï¼Œè¾“å‡ºé—¨ï¼‰ï¼Œé€‰æ‹©æ€§åœ°é—å¿˜éƒ¨åˆ†å†å²ä¿¡æ¯ï¼ŒåŠ å…¥éƒ¨åˆ†å½“å‰è¾“å…¥ä¿¡æ¯ï¼Œæœ€ç»ˆæ•´åˆåˆ°å½“å‰çŠ¶æ€å¹¶äº§ç”Ÿè¾“å‡ºçŠ¶æ€ã€‚ Information Extraction, NER åº”ç”¨äºNERä¸­çš„ biLSTM-CRF æ¨¡å‹ä¸»è¦ç”± Embeddingå±‚ï¼ˆä¸»è¦æœ‰è¯å‘é‡ï¼Œå­—å‘é‡ç­‰ç‰¹å¾ï¼‰ã€‚ æ— éœ€ç‰¹å¾å·¥ç¨‹ï¼Œä½¿ç”¨è¯å‘é‡ä»¥åŠå­—ç¬¦å‘é‡å°±å¯ä»¥è¾¾åˆ°å¾ˆå¥½çš„æ•ˆæœï¼Œå¦‚æœæœ‰é«˜è´¨é‡çš„è¯å…¸ç‰¹å¾ï¼Œèƒ½è¿›ä¸€æ­¥æé«˜ã€‚ 2.2 IDCNN-CRF3. å®æˆ˜åº”ç”¨3.1 è¯­æ–™å‡†å¤‡3.2 æ•°æ®å¢å¼º4. ELMO / GPT / BertELMO / GPT / Bert ELMO æ˜¯åŸºäºåŒå‘ LSTM çš„è¯­è¨€æ¨¡å‹. GPT æ˜¯å•å‘ Transformer è¯­è¨€æ¨¡å‹. Bert æ˜¯åŒå‘ Transformer è¯­è¨€æ¨¡å‹. NLP é¢†åŸŸå·²ç»å¼€å§‹ä»å•ä¸€ä»»åŠ¡å­¦ä¹ ï¼Œå‘å±•ä¸ºå¤šä»»åŠ¡ä¸¤é˜¶æ®µå­¦ä¹ ï¼š ç¬¬ä¸€é˜¶æ®µåˆ©ç”¨è¯­è¨€æ¨¡å‹è¿›è¡Œé¢„è®­ç»ƒï¼› ç¬¬äºŒä¸ªé˜¶æ®µåœ¨ä¸‹æ¸¸ä»»åŠ¡ä¸Š finetuneã€‚ è¿™äº›è¯­è¨€æ¨¡å‹åœ¨ NER éƒ½è¾¾åˆ°äº†éå¸¸å¥½çš„æ•ˆæœã€‚ å§œå…´åï¼Œæµ™æ±Ÿå¤§å­¦è®¡ç®—æœºç¡•å£« ï¼Œç ”ç©¶æ–¹å‘æœºå™¨å­¦ä¹ ï¼Œè‡ªç„¶è¯­è¨€å¤„ç†ï¼Œåœ¨ ACM-multimediaã€IJCAI ä¼šè®®ä¸Šå‘è¡¨è¿‡å¤šç¯‡æ–‡ç« ã€‚åœ¨ ByteCup2018 æ¯”èµ›ä¸­è·å¾—ç¬¬ä¸€åã€‚ å´”å¾·ç››ï¼ŒåŒ—äº¬é‚®ç”µå¤§å­¦æ¨¡å¼è¯†åˆ«å®éªŒå®¤ ï¼Œä¸»è¦çš„ç ”ç©¶æ–¹å‘æ˜¯è‡ªç„¶è¯­è¨€å¤„ç†å’Œå¹¿å‘Šæ¨èï¼Œæ›¾è· 2017 çŸ¥ä¹çœ‹å±±æ¯æŒ‘æˆ˜èµ›äºšå†›ï¼Œ2017 æ‘©æ‹œç®—æ³•æŒ‘æˆ˜èµ›å­£å†›ï¼Œ2019 æœç‹ç®—æ³•å¤§èµ›å† å†›ã€‚ 5. Summaryæœ€åè¿›è¡Œä¸€ä¸‹æ€»ç»“ï¼Œå°†ç¥ç»ç½‘ç»œä¸CRFæ¨¡å‹ç›¸ç»“åˆçš„CNN/RNN-CRFæˆä¸ºäº†ç›®å‰NERçš„ä¸»æµæ¨¡å‹ã€‚ å¯¹äºCNNä¸RNNï¼Œå„æœ‰å„çš„ä¼˜ç‚¹ã€‚ç”±äºRNNæœ‰å¤©ç„¶çš„åºåˆ—ç»“æ„ï¼Œæ‰€ä»¥RNN-CRFä½¿ç”¨æ›´ä¸ºå¹¿æ³›ã€‚ Reference æ‘˜è¦å¿ƒå¾—: baeline æ˜¯éå¸¸é‡è¦çš„. è¾¾è§‚æ•°æ®é«˜ç¿”è¯¦è§£æ–‡æœ¬æŠ½å–ï¼ˆé™„â€œè¾¾è§‚æ¯â€å‚èµ›æ–¹å¼ï¼‰ ç¬¬ä¸‰å±Šâ€œè¾¾è§‚æ¯â€æ–‡æœ¬æ™ºèƒ½ç®—æ³•å¤§èµ›å‚èµ›æŒ‡å— Named-entity recognition | NER ä¸€æ–‡è¯¦è§£æ·±åº¦å­¦ä¹ åœ¨å‘½åå®ä½“è¯†åˆ«(NER)ä¸­çš„åº”ç”¨","categories":[{"name":"nlp","slug":"nlp","permalink":"http://iequa.com/categories/nlp/"}],"tags":[{"name":"NER","slug":"NER","permalink":"http://iequa.com/tags/NER/"}]},{"title":"Spark Shuffle Optimize 10 items","slug":"spark/spark-ma-public-shuffle-optimization","date":"2019-08-12T12:07:21.000Z","updated":"2021-01-01T03:33:25.516Z","comments":true,"path":"2019/08/12/spark/spark-ma-public-shuffle-optimization/","link":"","permalink":"http://iequa.com/2019/08/12/spark/spark-ma-public-shuffle-optimization/","excerpt":"","text":"è°ƒä¼˜: å¼€å‘è°ƒä¼˜ èµ„æºè°ƒä¼˜ DataSkew shuffle ä»Šå¤©çš„å†…å®¹: ï¼ˆ1ï¼‰Spark Task æ‰§è¡Œè¿‡ç¨‹è¯¦ç»†æ¢³ç† ï¼ˆ2ï¼‰DataSkew å‘ç”Ÿæ—¶çš„ç°è±¡å’ŒåŸå› åˆ†æ ï¼ˆ3ï¼‰DataSkew åŸç†åˆ†æ ï¼ˆ4ï¼‰DataSkew é€‚ç”¨åœºæ™¯åˆ†æ ï¼ˆ5ï¼‰DataSkew solution ä¼˜ç¼ºç‚¹åˆ†æ ï¼ˆ6ï¼‰DataSkew solution å®è·µç»éªŒåˆ†äº« Preface1). å“ªä¸ªæ˜¯ çª„ä¾èµ– ï¼Ÿ B (è®¡ç®—ä¹‹å‰ä¹‹å 2ä¸ª RDD è®°å½•æ˜¯ 1å¯¹1) Aã€joinBã€filter map foreachCã€sortDã€group 2). å…³äºå¹¿æ’­å˜é‡ ï¼Ÿ BCD (åœ¨Driverå£°æ˜çš„ï¼Œç”¨æ¥åºåˆ—åŒ–åˆ°æ¯ä¸ªExecutorä¸­ä¾›Taskä½¿ç”¨) Bã€read-onlyCã€å­˜å‚¨åœ¨å„ä¸ªèŠ‚ç‚¹ ï¼ˆä»èŠ‚ç‚¹ï¼šWorkerè´Ÿè´£å¯åŠ¨å’Œç®¡ç† Executorï¼‰Dã€èƒ½å­˜å‚¨åœ¨ç£ç›˜æˆ–HDFS ï¼ˆé»˜è®¤æ˜¯å­˜å‚¨åœ¨å†…å­˜é‡Œé¢ï¼Œ[å­˜å‚¨å†…å­˜ æ‰§è¡Œå†…å­˜]ï¼‰ 3). Spark ä¸ºä»€ä¹ˆæ¯” MapReducer å¿«? ABC Aã€åŸºäºå†…å­˜è®¡ç®—ï¼Œå‡å°‘ä½æ•ˆçš„ç£ç›˜äº¤äº’Bã€é«˜æ•ˆçš„è°ƒåº¦ç®—æ³•, åŸºäº DAGCã€å®¹é”™æœºåˆ¶ Linageï¼Œç²¾åéƒ¨åˆ†å°±æ˜¯ DAG å’Œ Linage DAGå¼•æ“ï¼ == mapreduce spark èƒ½å¤ŸæŠŠä¸­é—´ç»“æœæ”¾åˆ°å†…å­˜é‡Œé¢spark å®˜æ–¹å®£ç§°ï¼š SPark hadoop 0.9:100 è¿­ä»£è®¡ç®— åšä¸€æ¬¡ 3ï¼š1 Distributed Computingåˆ†å¸ƒå¼è®¡ç®—ï¼Œä¸æ€•æ•°æ®é‡å¤§ï¼Œå°±æ€• DataSkew Shuffle è°ƒä¼˜ 10ç‚¹ (DataSkew Solution) 1. ä½¿ç”¨Hive ETLé¢„å¤„ç†æ•°æ®å¯¼è‡´ DataSkew çš„æ˜¯ Hive è¡¨ã€‚å¦‚æœè¯¥ Hive è¡¨ä¸­çš„æ•°æ®æœ¬èº«å¾ˆä¸å‡åŒ€(æ¯”å¦‚æŸä¸ª key å¯¹åº”äº† 100 ä¸‡æ•°æ®ï¼Œå…¶ä»– key æ‰å¯¹åº”äº† 10 æ¡æ•°æ®)ï¼Œè€Œä¸šåŠ¡åœºæ™¯éœ€è¦é¢‘ç¹ç”¨ Spark å¯¹ Hive è¡¨æ‰§è¡ŒæŸä¸ªåˆ†ææ“ä½œï¼Œé‚£ä¹ˆæ¯”è¾ƒé€‚åˆä½¿ç”¨è¿™ç§æŠ€æœ¯æ–¹æ¡ˆ: 2. è°ƒæ•´shuffleæ“ä½œçš„å¹¶è¡Œåº¦ ç¢°è¿æ°”åšæ³•ï¼š åŸæ¥çš„å¹¶è¡Œåº¦å¯¼è‡´äº†å€¾æ–œï¼Œè°ƒæ•´å¹¶è¡Œåº¦ï¼Œ å¦‚æœæ˜¯è‡ªå®šä¹‰çš„åˆ†åŒºè§„åˆ™å†³å®šå¿…é¡»æ˜¯nä¸ªåˆ†åŒºï¼Œnä¸ªTask ä¾ç„¶ä½¿ç”¨é»˜è®¤çš„HasPartitoinerï¼Œé‚£ä¹ˆè¿™ç§ç¢°è¿æ°”çš„æ–¹æ¡ˆæ˜¯æœ‰ç”¨çš„ å¤§é‡ä¸åŒçš„Keyè¢«åˆ†é…åˆ°äº†ç›¸åŒçš„Taské€ æˆè¯¥Taskæ•°æ®é‡è¿‡å¤§ã€‚ å¦‚æœæˆ‘ä»¬å¿…é¡»è¦å¯¹æ•°æ®å€¾æ–œè¿éš¾è€Œä¸Šï¼Œé‚£ä¹ˆå»ºè®®ä¼˜å…ˆä½¿ç”¨è¿™ç§æ–¹æ¡ˆï¼Œå› ä¸ºè¿™æ˜¯å¤„ç†æ•°æ®å€¾æ–œæœ€ç®€å•çš„ä¸€ ç§æ–¹æ¡ˆã€‚ä½†æ˜¯ä¹Ÿæ˜¯ä¸€ç§å±äº ç¢°è¿æ°”çš„æ–¹æ¡ˆã€‚å› ä¸ºè¿™ç§æ–¹æ¡ˆï¼Œå¹¶ä¸èƒ½è®©ä½ ä¸€å®šè§£å†³æ•°æ®å€¾æ–œï¼Œç”šè‡³æœ‰å¯èƒ½ åŠ é‡ã€‚é‚£å½“ç„¶ï¼Œæ€»å½’ï¼Œä½ ä¼šè°ƒæ•´åˆ°ä¸€ä¸ªåˆé€‚çš„å¹¶è¡Œåº¦æ˜¯èƒ½è§£å†³çš„ã€‚å‰ææ˜¯è¿™ç§æ–¹æ¡ˆé€‚ç”¨äº Hashæ•£åˆ—çš„ åˆ†åŒºæ–¹å¼ã€‚å‡‘å·§çš„æ˜¯ï¼Œå„ç§åˆ†å¸ƒå¼è®¡ç®—å¼•æ“ï¼Œæ¯”å¦‚MapReduceï¼ŒSpark ç­‰é»˜è®¤éƒ½æ˜¯ä½¿ç”¨ Hashæ•£åˆ—çš„æ–¹ å¼æ¥è¿›è¡Œæ•°æ®åˆ†åŒºã€‚ Spark åœ¨åš Shuffle æ—¶ï¼Œé»˜è®¤ä½¿ç”¨ HashPartitioner(éHash Shuffle)å¯¹æ•°æ®è¿›è¡Œåˆ†åŒºã€‚å¦‚æœå¹¶è¡Œåº¦è®¾ ç½®çš„ä¸åˆé€‚ï¼Œå¯èƒ½é€ æˆå¤§é‡ä¸ç›¸åŒçš„ Key å¯¹åº”çš„æ•°æ®è¢«åˆ†é…åˆ°äº†åŒä¸€ä¸ª Task ä¸Šï¼Œé€ æˆè¯¥ Task æ‰€å¤„ç†çš„ æ•°æ®è¿œå¤§äºå…¶å®ƒ Taskï¼Œä»è€Œé€ æˆ DataSkewã€‚ å¦‚æœè°ƒæ•´ Shuffle æ—¶çš„å¹¶è¡Œåº¦ï¼Œä½¿å¾—åŸæœ¬è¢«åˆ†é…åˆ°åŒä¸€ Task çš„ä¸åŒ Key å‘é…åˆ°ä¸åŒ Task ä¸Šå¤„ç†ï¼Œåˆ™å¯ é™ä½åŸ Task æ‰€éœ€å¤„ç†çš„æ•°æ®é‡ï¼Œä»è€Œç¼“è§£ DataSkew é€ æˆçš„çŸ­æ¿æ•ˆåº”ã€‚ 2.5. ä¼ä¸šæœ€ä½³å®è·µè¯¥æ–¹æ¡ˆé€šå¸¸æ— æ³•å½»åº•è§£å†³æ•°æ®å€¾æ–œï¼Œå› ä¸ºå¦‚æœå‡ºç°ä¸€äº›æç«¯æƒ…å†µï¼Œæ¯”å¦‚æŸä¸ªkeyå¯¹åº”çš„æ•°æ®é‡æœ‰100ä¸‡ï¼Œ é‚£ä¹ˆæ— è®ºä½ çš„taskæ•°é‡å¢åŠ åˆ°å¤šå°‘ï¼Œè¿™ä¸ªå¯¹åº”ç€100ä¸‡æ•°æ®çš„keyè‚¯å®šè¿˜æ˜¯ä¼šåˆ†é…åˆ°ä¸€ä¸ªtaskä¸­å»å¤„ç†ï¼Œ å› æ­¤æ³¨å®šè¿˜æ˜¯ä¼šå‘ç”Ÿæ•°æ®å€¾æ–œçš„ã€‚æ‰€ä»¥è¿™ç§æ–¹æ¡ˆåªèƒ½è¯´æ˜¯åœ¨å‘ç°æ•°æ®å€¾æ–œæ—¶å°è¯•ä½¿ç”¨çš„ç¬¬ä¸€ç§æ‰‹æ®µï¼Œå° è¯•å»ç”¨å˜´ç®€å•çš„æ–¹æ³•ç¼“è§£æ•°æ®å€¾æ–œè€Œå·²ï¼Œæˆ–è€…æ˜¯å’Œå…¶ä»–æ–¹æ¡ˆç»“åˆèµ·æ¥ä½¿ç”¨ã€‚ å¦‚æœä¹‹å‰çš„é¢å¹¶è¡Œåº¦æ˜¯12ï¼Œç°åœ¨è°ƒæ•´æˆä¸º 18 æœ‰ç”¨ä¹ˆ?å¹¶æ²¡æœ‰å¤šå¤§çš„æ”¹å–„ 10ä¸ª 11ä¸ª 13 ä¸è¦æ‹¥æœ‰ä¸€æ ·çš„å…¬çº¦æ•°, (ç‰¹åˆ«æ˜¯æœ€å¤§å…¬çº¦æ•°) 3. è¿‡æ»¤å°‘æ•°å¯¼è‡´å€¾æ–œçš„keyæ— ç”¨æ•°æ®ç›´æ¥è¿‡æ»¤ã€‚ äº§ç”Ÿæ•°æ®å€¾æ–œæ˜¯ç”±äºéƒ¨åˆ†æ— æ•ˆæ•°æ®å¯¼è‡´çš„ã€‚æŠŠè¿™éƒ¨åˆ†æ— æ•ˆæ•°æ®è¿‡æ»¤æ‰å³å¯ï¼ ä½ ä»¬çš„å¤§å®½è¡¨ï¼šæœ‰äº›å­—æ®µçš„å€¼ï¼šnull departmentselect department, count(*) as total from employee group by deparment;åº•å±‚çš„åˆ†åŒºè§„åˆ™ï¼Œä¸ç®¡æ˜¯ä»€ä¹ˆè§„åˆ™ï¼Œéƒ½ä¼šæŠŠæ‰€æœ‰çš„ null è®°å½•åˆ†å‘åˆ°åŒä¸€ä¸ªTaskGMè§’è‰²ï¼š select department, count(*) as total from employee group by deparment where role != &quot;gm&quot;; rdd = sparkContext.xxxx() rdd.filter(x =&gt; true | false) æŠŠæ— æ•ˆæ•°æ®è¿›è¡Œè¿‡æ»¤ 4. å°†reduce joinè½¬ä¸ºmap join å¤§å°è¡¨åšè¿æ¥, mapjoin sparkä¸­å¦‚ä½•å®ç° mapjoin çš„é€»è¾‘å‘¢ï¼Ÿ ä½¿ç”¨ sparkçš„å¹¿æ’­æœºåˆ¶ï¼ å°±æ˜¯å¯ä»¥æŠŠå°è¡¨æ•°æ®å½“åšå¹¿æ’­å˜é‡ï¼Œä½¿ç”¨å¹¿æ’­æœºåˆ¶ï¼ŒæŠŠè¯¥å˜é‡æ•°æ®ï¼Œå¹¿æ’­åˆ°æ‰€æœ‰çš„executoré‡Œé¢å»ã€‚ reduceJoin: mapJoin: 5. é‡‡æ ·å€¾æ–œ key å¹¶åˆ†æ‹† join æ“ä½œç°åœ¨å‡è®¾ä¸€ä¸ªæ•°æ®å€¾æ–œåœºæ™¯ä¸­çš„æ•°æ®åˆ†ä¸ºä¸¤ç§ï¼š ä¸€ç§æ˜¯å¯¼è‡´å€¾æ–œçš„æ•°æ®é›†åˆï¼š å•ç‹¬å¤„ç† ä¸€ç§æ˜¯ä¸å¯¼è‡´å€¾æ–œçš„æ•°æ®é›†åˆï¼š å•ç‹¬å¤„ç† æœ€åæŠŠç»“æœåˆèµ·æ¥ï¼ 6. ä¸¤é˜¶æ®µèšåˆ(å±€éƒ¨èšåˆ+å…¨å±€èšåˆ) æ–¹æ¡ˆå…­ï¼š ä¸¤é˜¶æ®µèšåˆ ï¼ˆèšåˆç±»é€»è¾‘çš„é€šç”¨è§£å†³æ–¹æ¡ˆï¼‰ çºµå‘åˆ‡åˆ† åŸæ¥ï¼šä¸€æ¬¡hashæ•£åˆ—å¯¼è‡´å€¾æ–œ ç°åœ¨ï¼šä¸€æ¬¡éšæœºshuffle + ä¸€æ¬¡hashæ•£åˆ— 7. ä½¿ç”¨éšæœºå‰ç¼€å’Œæ‰©å®¹ RDD è¿›è¡Œ joinæ–¹æ¡ˆä¸ƒï¼š å¢åŠ éšæœºå­—æ®µ/é“¾æ¥å­—æ®µ + æ‰©å®¹RDD è¡¨A è¡¨B RDD1 rdd2 ä¸¤ç§åœºæ™¯ï¼š 1ã€å¦‚æœ ä¸¤å¼ è¡¨åšç¬›å¡å°”ç§¯ 2ã€å¦‚æœä¸¤å¼ è¡¨åšjoinï¼Œå¹¶ä¸”å¯¼è‡´æ•°æ®å€¾æ–œçš„æŸäº›keyæ¯”è¾ƒå¤šã€‚ æ‹†åˆ†å‡ºæ¥å•ç‹¬å¤„ç†ï¼ˆä¾ç„¶å¯èƒ½æœ‰æ•°æ®å€¾æ–œ ==&gt; åŠ éšæœºå‰ç¼€ï¼‰ å¦‚æœæ˜¯å¯¼è‡´å€¾æ–œçš„keyåªæœ‰ä¸€ä¸ªï¼Œè¿™ä¸ªkeyçš„æ•°æ®é‡éå¸¸ã€‚ åŠ éšæœºå‰ç¼€ å¤åˆ¶ 1ã€ç¬›å¡å°”ç§¯ 2ã€å¯¼è‡´å€¾æ–œçš„keyçš„æ•°æ®ï¼›é‡ç‰¹åˆ«å¤§ã€‚ ä¸èƒ½ä½¿ç”¨å•ä¸ªtaskè§£å†³ 8. ä»»åŠ¡æ¨ªåˆ‡ï¼Œä¸€åˆ†ä¸ºäºŒï¼Œå•ç‹¬å¤„ç†9. å¤šç§æ–¹æ¡ˆç»„åˆä½¿ç”¨10. è‡ªå®šä¹‰ Partitioner11. bitmap æ±‚ Join Reference Sparkæ€§èƒ½ä¼˜åŒ–æŒ‡å—â€”â€”åŸºç¡€ç¯‡ Sparkæ€§èƒ½ä¼˜åŒ–æŒ‡å—â€”â€”é«˜çº§ç¯‡ å¤§æ•°æ®èµ„æ–™ç¬”è®°æ•´ç† å²è¯—çº§æœ€è¯¦ç»†10æ‹›Sparkæ•°æ®å€¾æ–œè°ƒä¼˜","categories":[{"name":"spark","slug":"spark","permalink":"http://iequa.com/categories/spark/"}],"tags":[{"name":"spark","slug":"spark","permalink":"http://iequa.com/tags/spark/"}]},{"title":"æ•°æ®æ¸…ç†ä¸­ï¼Œå¤„ç†ç¼ºå¤±å€¼çš„æ–¹æ³•æ˜¯?","slug":"ml/data_clean_process","date":"2019-08-10T02:06:16.000Z","updated":"2020-12-06T04:06:30.516Z","comments":true,"path":"2019/08/10/ml/data_clean_process/","link":"","permalink":"http://iequa.com/2019/08/10/ml/data_clean_process/","excerpt":"","text":"ç”±äºè°ƒæŸ¥ã€ç¼–ç å’Œå½•å…¥è¯¯å·®ï¼Œæ•°æ®ä¸­å¯èƒ½å­˜åœ¨ä¸€äº›æ— æ•ˆå€¼å’Œç¼ºå¤±å€¼ï¼Œéœ€è¦ç»™äºˆé€‚å½“çš„å¤„ç†ã€‚å¸¸ç”¨çš„å¤„ç†æ–¹æ³•æœ‰ï¼šä¼°ç®—ï¼Œæ•´ä¾‹åˆ é™¤ï¼Œå˜é‡åˆ é™¤å’Œæˆå¯¹åˆ é™¤ã€‚ 1.1 estimation ä¼°ç®—(estimation)ã€‚æœ€ç®€å•çš„åŠæ³•å°±æ˜¯ç”¨æŸä¸ªå˜é‡çš„æ ·æœ¬ å‡å€¼ã€ä¸­ä½æ•°æˆ–ä¼—æ•° ä»£æ›¿æ— æ•ˆå€¼å’Œç¼ºå¤±å€¼ã€‚ è¿™ç§åŠæ³•ç®€å•ï¼Œä½†æ²¡æœ‰å……åˆ†è€ƒè™‘æ•°æ®ä¸­å·²æœ‰çš„ä¿¡æ¯ï¼Œè¯¯å·®å¯èƒ½è¾ƒå¤§ã€‚å¦ä¸€ç§åŠæ³•å°±æ˜¯æ ¹æ®è°ƒæŸ¥å¯¹è±¡å¯¹å…¶ä»–é—®é¢˜çš„ç­”æ¡ˆï¼Œé€šè¿‡å˜é‡ä¹‹é—´çš„ç›¸å…³åˆ†ææˆ–é€»è¾‘æ¨è®ºè¿›è¡Œä¼°è®¡ã€‚ä¾‹å¦‚ï¼ŒæŸä¸€äº§å“çš„æ‹¥æœ‰æƒ…å†µå¯èƒ½ä¸å®¶åº­æ”¶å…¥æœ‰å…³ï¼Œå¯ä»¥æ ¹æ®è°ƒæŸ¥å¯¹è±¡çš„å®¶åº­æ”¶å…¥æ¨ç®—æ‹¥æœ‰è¿™ä¸€äº§å“çš„å¯èƒ½æ€§ã€‚ 1.2 casewise deletion æ•´ä¾‹åˆ é™¤(casewise deletion)æ˜¯å‰”é™¤å«æœ‰ç¼ºå¤±å€¼çš„æ ·æœ¬ã€‚ ç”±äºå¾ˆå¤šé—®å·éƒ½å¯èƒ½å­˜åœ¨ç¼ºå¤±å€¼ï¼Œè¿™ç§åšæ³•çš„ç»“æœå¯èƒ½å¯¼è‡´æœ‰æ•ˆæ ·æœ¬é‡å¤§å¤§å‡å°‘ï¼Œæ— æ³•å……åˆ†åˆ©ç”¨å·²ç»æ”¶é›†åˆ°çš„æ•°æ®ã€‚å› æ­¤ï¼Œåªé€‚åˆå…³é”®å˜é‡ç¼ºå¤±ï¼Œæˆ–è€…å«æœ‰æ— æ•ˆå€¼æˆ–ç¼ºå¤±å€¼çš„æ ·æœ¬æ¯”é‡å¾ˆå°çš„æƒ…å†µã€‚ 1.3 variable deletion å˜é‡åˆ é™¤(variable deletion)ã€‚ å¦‚æœæŸä¸€å˜é‡çš„æ— æ•ˆå€¼å’Œç¼ºå¤±å€¼å¾ˆå¤šï¼Œè€Œä¸”è¯¥å˜é‡å¯¹äºæ‰€ç ”ç©¶çš„é—®é¢˜ä¸æ˜¯ç‰¹åˆ«é‡è¦ï¼Œåˆ™å¯ä»¥è€ƒè™‘å°†è¯¥å˜é‡åˆ é™¤ã€‚è¿™ç§åšæ³•å‡å°‘äº†ä¾›åˆ†æç”¨çš„å˜é‡æ•°ç›®ï¼Œä½†æ²¡æœ‰æ”¹å˜æ ·æœ¬é‡ã€‚ 1.4 pairwise deletion æˆå¯¹åˆ é™¤(pairwise deletion)æ˜¯ç”¨ä¸€ä¸ªç‰¹æ®Šç (é€šå¸¸æ˜¯9ã€99ã€999ç­‰)ä»£è¡¨æ— æ•ˆå€¼å’Œç¼ºå¤±å€¼ï¼ŒåŒæ—¶ä¿ç•™æ•°æ®é›†ä¸­çš„å…¨éƒ¨å˜é‡å’Œæ ·æœ¬ã€‚ ä½†æ˜¯ï¼Œåœ¨å…·ä½“è®¡ç®—æ—¶åªé‡‡ç”¨æœ‰å®Œæ•´ç­”æ¡ˆçš„æ ·æœ¬ï¼Œå› è€Œä¸åŒçš„åˆ†æå› æ¶‰åŠçš„å˜é‡ä¸åŒï¼Œå…¶æœ‰æ•ˆæ ·æœ¬é‡ä¹Ÿä¼šæœ‰æ‰€ä¸åŒã€‚è¿™æ˜¯ä¸€ç§ä¿å®ˆçš„å¤„ç†æ–¹æ³•ï¼Œæœ€å¤§é™åº¦åœ°ä¿ç•™äº†æ•°æ®é›†ä¸­çš„å¯ç”¨ä¿¡æ¯ã€‚ é‡‡ç”¨ä¸åŒçš„å¤„ç†æ–¹æ³•å¯èƒ½å¯¹åˆ†æç»“æœäº§ç”Ÿå½±å“ï¼Œå°¤å…¶æ˜¯å½“ç¼ºå¤±å€¼çš„å‡ºç°å¹¶ééšæœºä¸”å˜é‡ä¹‹é—´æ˜æ˜¾ç›¸å…³æ—¶ã€‚å› æ­¤ï¼Œåœ¨è°ƒæŸ¥ä¸­åº”å½“å°½é‡é¿å…å‡ºç°æ— æ•ˆå€¼å’Œç¼ºå¤±å€¼ï¼Œä¿è¯æ•°æ®çš„å®Œæ•´æ€§ã€‚ 2. GBDT vs XGBoostGBDT åŸç† GBDTä¸ä¼ ç»Ÿçš„BoostingåŒºåˆ«è¾ƒå¤§ï¼Œå®ƒçš„æ¯ä¸€æ¬¡è®¡ç®—éƒ½æ˜¯ä¸ºäº†å‡å°‘ä¸Šä¸€æ¬¡çš„æ®‹å·®ï¼Œè€Œä¸ºäº†æ¶ˆé™¤æ®‹å·®ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æ®‹å·®å‡å°çš„æ¢¯åº¦æ–¹å‘ä¸Šå»ºç«‹æ¨¡å‹ XGBoost åŸç† XGBoostçš„æ€§èƒ½åœ¨GBDTä¸Šåˆæœ‰ä¸€æ­¥æå‡ï¼Œè€Œå…¶æ€§èƒ½ä¹Ÿèƒ½é€šè¿‡å„ç§æ¯”èµ›ç®¡çª¥ä¸€äºŒã€‚åŠé—´å¯¹XGBoostæœ€å¤§çš„è®¤çŸ¥åœ¨äºå…¶èƒ½å¤Ÿè‡ªåŠ¨åœ°è¿ç”¨CPUçš„å¤šçº¿ç¨‹è¿›è¡Œå¹¶è¡Œè®¡ç®—ï¼ŒåŒæ—¶åœ¨ç®—æ³•ç²¾åº¦ä¸Šä¹Ÿè¿›è¡Œäº†ç²¾åº¦çš„æé«˜ã€‚ ç”±äºGBDTåœ¨åˆç†çš„å‚æ•°è®¾ç½®ä¸‹ï¼Œå¾€å¾€è¦ç”Ÿæˆä¸€å®šæ•°é‡çš„æ ‘æ‰èƒ½è¾¾åˆ°ä»¤äººæ»¡æ„çš„å‡†ç¡®ç‡ï¼Œåœ¨æ•°æ®é›†è¾ƒå¤æ‚æ—¶ï¼Œæ¨¡å‹å¯èƒ½éœ€è¦å‡ åƒæ¬¡è¿­ä»£è¿ç®—ã€‚ä½†æ˜¯XGBooståˆ©ç”¨å¹¶è¡Œçš„CPUæ›´å¥½çš„è§£å†³äº†è¿™ä¸ªé—®é¢˜ã€‚ GBDT vs XGBoost (1). GBDTä»¥CARTæ ‘ä½œä¸ºåŸºå­¦ä¹ å™¨ï¼ŒXGBoostè¿˜æ”¯æŒçº¿æ€§åˆ†ç±»å™¨ï¼Œè¿™æ—¶XGBoostç›¸å½“äºL1å’ŒL2æ­£åˆ™åŒ–çš„LRï¼› (2). GBDTä¼˜åŒ–æ—¶å€™åªç”¨åˆ°ä¸€é˜¶å¯¼æ•°ä¿¡æ¯ï¼ŒXGBooståˆ™å¯¹ä»£ä»·å‡½æ•°è¿›è¡Œäº†äºŒé˜¶æ³°å‹’å±•å¼€ï¼Œå¾—åˆ°ä¸€é˜¶å’ŒäºŒé˜¶å¯¼æ•°ï¼› (3). XGBooståœ¨ä»£ä»·å‡½æ•°ä¸­åŠ å…¥äº†æ­£åˆ™é¡¹ï¼Œç”¨äºæ§åˆ¶æ¨¡å‹çš„å¤æ‚åº¦ã€‚ä»æƒè¡¡æ–¹å·®åå·®æ¥çœ‹ï¼Œå®ƒé™ä½äº†æ¨¡å‹çš„æ–¹å·®ï¼Œä½¿å­¦ä¹ å‡ºæ¥çš„æ¨¡å‹æ›´åŠ ç®€å•ï¼Œé˜²æ­¢è¿‡æ‹Ÿåˆï¼Œè¿™ä¹Ÿæ˜¯ XGBoost ä¼˜äºä¼ ç»ŸGBDTçš„ä¸€ä¸ªç‰¹æ€§ï¼› (4). shrinkageï¼ˆç¼©å‡ï¼‰ï¼Œç›¸å½“äºå­¦ä¹ é€Ÿç‡ï¼ˆXGBoostä¸­çš„etaï¼‰ã€‚XGBoost åœ¨è¿›è¡Œå®Œä¸€æ¬¡è¿­ä»£æ—¶ï¼Œä¼šå°†å¶å­èŠ‚ç‚¹çš„æƒå€¼ä¹˜ä¸Šè¯¥ç³»æ•°ï¼Œä¸»è¦æ˜¯ä¸ºäº†å‰Šå¼±æ¯æ£µæ ‘çš„å½±å“ï¼Œè®©åé¢æœ‰æ›´å¤§çš„å­¦ä¹ ç©ºé—´ã€‚ï¼ˆGBDTä¹Ÿæœ‰å­¦ä¹ é€Ÿç‡ï¼‰ï¼› (5) åˆ—æŠ½æ ·ã€‚XGBoost å€Ÿé‰´äº†éšæœºæ£®æ—çš„åšæ³•ï¼Œæ”¯æŒåˆ—æŠ½æ ·ï¼Œä¸ä»…é˜²æ­¢è¿‡æ‹Ÿåˆï¼Œè¿˜èƒ½å‡å°‘è®¡ç®—ï¼› (6) å¯¹ç¼ºå¤±å€¼çš„å¤„ç†ã€‚å¯¹äºç‰¹å¾çš„å€¼æœ‰ç¼ºå¤±çš„æ ·æœ¬ï¼ŒXGBoost è¿˜å¯ä»¥è‡ªåŠ¨ å­¦ä¹ å‡ºå®ƒçš„åˆ†è£‚æ–¹å‘ï¼› (7) XGBoost å·¥å…·æ”¯æŒå¹¶è¡Œã€‚ Boostingä¸æ˜¯ä¸€ç§ä¸²è¡Œçš„ç»“æ„å—?æ€ä¹ˆå¹¶è¡Œ çš„ï¼Ÿæ³¨æ„XGBoostçš„å¹¶è¡Œä¸æ˜¯treeç²’åº¦çš„å¹¶è¡Œï¼ŒXGBoostä¹Ÿæ˜¯ä¸€æ¬¡è¿­ä»£å®Œæ‰èƒ½è¿›è¡Œä¸‹ä¸€æ¬¡è¿­ä»£çš„ï¼ˆç¬¬tæ¬¡è¿­ä»£çš„ä»£ä»·å‡½æ•°é‡ŒåŒ…å«äº†å‰é¢t-1æ¬¡è¿­ä»£çš„é¢„æµ‹å€¼ï¼‰ã€‚ XGBoostçš„å¹¶è¡Œæ˜¯åœ¨ç‰¹å¾ç²’åº¦ä¸Šçš„ã€‚æˆ‘ä»¬çŸ¥é“ï¼Œå†³ç­–æ ‘çš„å­¦ä¹ æœ€è€—æ—¶çš„ä¸€ä¸ªæ­¥éª¤å°±æ˜¯å¯¹ç‰¹å¾çš„å€¼è¿›è¡Œæ’åºï¼ˆå› ä¸ºè¦ç¡®å®šæœ€ä½³åˆ†å‰²ç‚¹ï¼‰ï¼ŒXGBooståœ¨è®­ç»ƒä¹‹å‰ï¼Œé¢„å…ˆå¯¹æ•°æ®è¿›è¡Œäº†æ’åºï¼Œç„¶åä¿å­˜ä¸ºblockç»“æ„ï¼Œåé¢çš„è¿­ä»£ ä¸­é‡å¤åœ°ä½¿ç”¨è¿™ä¸ªç»“æ„ï¼Œå¤§å¤§å‡å°è®¡ç®—é‡ã€‚è¿™ä¸ªblockç»“æ„ä¹Ÿä½¿å¾—å¹¶è¡Œæˆä¸ºäº†å¯èƒ½ï¼Œåœ¨è¿›è¡ŒèŠ‚ç‚¹çš„åˆ†è£‚æ—¶ï¼Œéœ€è¦è®¡ç®—æ¯ä¸ªç‰¹å¾çš„å¢ç›Šï¼Œæœ€ç»ˆé€‰å¢ç›Šæœ€å¤§çš„é‚£ä¸ªç‰¹å¾å»åšåˆ†è£‚ï¼Œé‚£ä¹ˆå„ä¸ªç‰¹å¾çš„å¢ç›Šè®¡ç®—å°±å¯ä»¥å¼€å¤šçº¿ç¨‹è¿›è¡Œã€‚ Reference ç‰›å®¢ç½‘ å¤„ç†ç¼ºå¤±å€¼çš„æ–¹æ³• GBDTå’ŒXGBooståŒºåˆ«","categories":[{"name":"machine-learning","slug":"machine-learning","permalink":"http://iequa.com/categories/machine-learning/"}],"tags":[{"name":"estimation","slug":"estimation","permalink":"http://iequa.com/tags/estimation/"}]},{"title":"2019 Leetcode","slug":"leetcode/leetcode","date":"2019-07-01T02:54:16.000Z","updated":"2019-10-20T04:30:35.080Z","comments":true,"path":"2019/07/01/leetcode/leetcode/","link":"","permalink":"http://iequa.com/2019/07/01/leetcode/leetcode/","excerpt":"","text":"1ã€ä¸ƒç§å¸¸è§çš„æ•°ç»„æ’åºç®—æ³•æ•´ç†(Cè¯­è¨€ç‰ˆæœ¬)2ã€2019 ç®—æ³•é¢è¯•ç›¸å…³(leetcode)â€”æ•°ç»„å’Œé“¾è¡¨3ã€2019 ç®—æ³•é¢è¯•ç›¸å…³(leetcode)â€”å­—ç¬¦ä¸²4ã€2019 ç®—æ³•é¢è¯•ç›¸å…³(leetcode)â€”æ ˆå’Œé˜Ÿåˆ—5ã€2019 ç®—æ³•é¢è¯•ç›¸å…³(leetcode)â€”ä¼˜å…ˆé˜Ÿåˆ—6ã€2019 ç®—æ³•é¢è¯•ç›¸å…³(leetcode)â€”å“ˆå¸Œè¡¨7ã€2019 ç®—æ³•é¢è¯•ç›¸å…³(leetcode)â€”æ ‘ã€äºŒå‰æ ‘ã€äºŒå‰æœç´¢æ ‘8ã€2019 ç®—æ³•é¢è¯•ç›¸å…³(leetcode)â€”é€’å½’ä¸åˆ†æ²»9ã€2019 ç®—æ³•é¢è¯•ç›¸å…³(leetcode)â€”è´ªå¿ƒç®—æ³•10ã€2019 ç®—æ³•é¢è¯•ç›¸å…³(leetcode)â€”åŠ¨æ€è§„åˆ’(Dynamic Programming) Hot100 hot easy ä¸¤æ•°ä¹‹å’Œï¼Œ âœ”ï¸ åè½¬é“¾è¡¨ï¼Œ å›æ–‡é“¾è¡¨(1.å¿«æ…¢pæ‹†ï¼Œ2.ç¿»è½¬ 3. åˆ¤æ–­)ï¼Œ ç›¸äº¤é“¾è¡¨ï¼ˆf1: set() f2: A+Bå’ŒB+A f3:å¿«æ…¢pï¼‰ âœ”ï¸ æœ€å¤§å­åºå’Œ ï¼ˆåŠ¨æ€è§„åˆ’/åˆ†æ²»æ³•ï¼‰ï¼Œ âœ”ï¸ çˆ¬æ¥¼æ¢¯ï¼Œ æ‰“å®¶åŠ«èˆ &amp; ç¯å½¢é“¾è¡¨ , åˆå¹¶2ä¸ªæœ‰åºé“¾è¡¨ï¼Œ âœ”ï¸ æœ‰æ•ˆçš„æ‹¬å·ï¼Œ æœ€å°æ ˆ âœ”ï¸ ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœº-3, ä¸¤é˜¶æ®µï¼Œ âœ”ï¸ ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœº-4, è¶…éš¾ ç¿»è½¬äºŒå‰æ ‘ , æŠŠäºŒå‰æœç´¢æ ‘è½¬æ¢ä¸ºç´¯åŠ æ ‘ ï¼Œ âœ”ï¸ åªå‡ºç°ä¸€æ¬¡çš„æ•°å­—ï¼Œ æ±‰æ˜è·ç¦» x&amp;(x-1)æ¥ç»Ÿè®¡äºŒè¿›åˆ¶æ•°xä¸­1çš„ä¸ªæ•° âœ”ï¸ äºŒå‰æ ‘çš„ç›´å¾„ &amp; äºŒå‰æ ‘çš„æœ€å¤§æ·±åº¦ &amp; å¯¹ç§°äºŒå‰æ ‘, åˆå¹¶äºŒå‰æ ‘ ï¼Œ âœ”ï¸ æ±‚ä¼—æ•° ï¼Œç§»åŠ¨é›¶ ï¼Œæ‰¾åˆ°æ‰€æœ‰æ•°ç»„ä¸­æ¶ˆå¤±çš„æ•°å­— æœ€çŸ­æ— åºè¿ç»­å­æ•°ç»„,æ‰¾åˆ°å­—ç¬¦ä¸²ä¸­æ‰€æœ‰å­—æ¯å¼‚ä½è¯ , è·¯å¾„æ€»å’Œ III hot ä¸­ç­‰Page1 ä¸¤æ•°ä¹‹å’Œï¼ˆæ–¹æ³•ï¼šä¸€éå“ˆå¸Œè¡¨ï¼‰ Map &lt; Integer, Integer &gt; ï¼Œ âœ”ï¸ æœ€é•¿å›æ–‡å­ä¸² åè½¬é“¾è¡¨ ï¼Œ âœ”ï¸ LRUç¼“å­˜æœºåˆ¶ ç¼–è¾‘è·ç¦» æ— é‡å¤å­—ç¬¦çš„æœ€é•¿å­ä¸² æˆ³æ°”çƒ æ¥é›¨æ°´ ä¸¤æ•°ç›¸åŠ  (é“¾è¡¨+è¿›ä½carry)ï¼Œ âœ”ï¸ å¯»æ‰¾ä¸¤ä¸ªæœ‰åºæ•°ç»„çš„ä¸­ä½æ•° ä¸‰æ•°ä¹‹å’Œ ï¼ˆ2æ–¹æ³•ï¼š hash &amp; å¯¹æ’æŒ‡é’ˆï¼‰ ï¼Œ âœ”ï¸ æœ€å¤§å­åºå’Œ ï¼ˆåŠ¨æ€è§„åˆ’/åˆ†æ²»æ³•ï¼‰ï¼Œ âœ”ï¸ å­—ç¬¦ä¸²è§£ç  åˆ é™¤æ— æ•ˆçš„æ‹¬å· æœ€å¤§çŸ©å½¢ æœ‰éš¾åº¦ nok å…¨æ’åˆ— (äº¤æ¢æ³•ï¼Œç±»æ¯”å­—ç¬¦ä¸²æ€è·¯)ï¼Œ âœ”ï¸ åˆå¹¶ä¸¤ä¸ªæœ‰åºé“¾è¡¨ ï¼Œ âœ”ï¸ æ­£åˆ™è¡¨è¾¾å¼åŒ¹é… é›¶é’±å…‘æ¢ ï¼Œ âœ”ï¸ Page3 å•è¯æœç´¢ (DFS vector &lt; vector &lt; bool &gt; &gt; visit(row, vector &lt; bool &gt; (col, false))) æ‰“å®¶åŠ«èˆä¹‹ä¸‰ (DFS) æœ€å°è·¯å¾„å’Œ ç”µè¯å·ç çš„å­—æ¯ç»„åˆ æ¯æ—¥æ¸©åº¦ å›æ–‡å­ä¸² éªŒè¯äºŒå‰æœç´¢æ ‘ å•è¯æ‹†åˆ† é¢œè‰²åˆ†ç±» åœ¨æ’åºæ•°ç»„ä¸­æŸ¥æ‰¾å…ƒç´ çš„ç¬¬ä¸€ä¸ªå’Œæœ€åä¸€ä¸ªä½ç½® å­—æ¯å¼‚ä½è¯åˆ†ç»„ å®Œå…¨å¹³æ–¹æ•° ç¯å½¢é“¾è¡¨ II é™¤æ³•æ±‚å€¼ è¯¾ç¨‹è¡¨ æ ¹æ®èº«é«˜é‡å»ºé˜Ÿåˆ— é™¤è‡ªèº«ä»¥å¤–æ•°ç»„çš„ä¹˜ç§¯ ç›®æ ‡å’Œ æ¯”ç‰¹ä½è®¡æ•° public class Solution &#123; public int[] twoSum(int[] nums, int target) &#123; HashMap&lt;Integer, Integer&gt; m = new HashMap&lt;Integer, Integer&gt;(); int[] res = new int[2]; for (int i = 0; i &lt; nums.length; ++i) &#123; if (m.containsKey(target - nums[i])) &#123; res[0] = i; res[1] = m.get(target - nums[i]); break; &#125; m.put(nums[i], i); &#125; return res; &#125;&#125; çˆ¬æ¥¼æ¢¯ 1. Array1.1 easy äºŒç»´æ•°ç»„ä¸­çš„æŸ¥æ‰¾ bool Find(int b[][4], int rows, int cols, int value)ï¼Œ âœ”ï¸ æ›¿æ¢ç©ºæ ¼ char* replace(char* str, int len) â€˜ â€™-&gt;%20 åœ¨æºæ•°ç»„æ€»é•¿åº¦ï¼Œä»åå‘å‰ï¼Œé€ä¸ªèµ‹å€¼ï¼Œ âœ”ï¸ æ•°å­—åœ¨æ’åºæ•°ç»„ä¸­å‡ºç°çš„æ¬¡æ•° biSea(arr,k+0.5)-biSea(arr,k-0.5); / bina(*a, len, num, isLeft)ï¼Œ âœ”ï¸ æ—‹è½¬æ•°ç»„çš„æœ€å°å…ƒç´  while(low &lt; high) { if(a[m] &gt; a[high]) min[m+1,high], else [low,m]} âœ”ï¸ è°ƒæ•´æ•°ç»„ä½æ•°ä½¿å¥‡æ•°ä½äºå‰é¢ void odds(int[] arr) ï¼Œ âœ”ï¸ æ¬¡æ•°è¶…è¿‡ä¸€åŠçš„æ¬¡æ•° * int core(int *a, int len)ï¼Œ âœ”ï¸ ä¸‘æ•°, åªåŒ…å«è´¨å› å­2ã€3å’Œ5çš„æ•°ç§°ä½œä¸‘æ•°, 1, 2, 3, 5, 6, â€¦ ï¼Œ âœ”ï¸ å’Œä¸ºSçš„ä¸¤ä¸ªæ•°å­—(åŒæŒ‡é’ˆæ€æƒ³) ï¼Œ âœ”ï¸ æ‰‘å…‹ç‰Œé¡ºå­ (æ’åºåï¼Œç»Ÿè®¡å¤§å°ç‹æ•°é‡ + é—´éš”)ï¼Œ âœ”ï¸ æ„å»ºä¹˜ç§¯æ•°ç»„ (Aæ•°ç»„ï¼Œä»å‰å‘åï¼Œå†ä»åå‘å‰j-2,æ„é€  B)ï¼Œ âœ”ï¸ æ±‚1+2+3+â€¦+n (åˆ¤æ–­ &amp;&amp; é€’å½’)ï¼Œ âœ”ï¸ 1.2 medium å…«çš‡åï¼Œ void dfs(int n) for(int i = 0; i &lt; 8; i++) { pos[n] = i; ï¼Œ âœ”ï¸ å’ŒSè¿ç»­æ­£æ•°åº (3funï¼Œmid = (1+sum)/2; while(start&lt;mid), Sum(int start, int end), åŒvector)ï¼Œ âœ”ï¸ çº¦ç‘Ÿå¤«ç¯ LinkedList; (index = (index + m) %link.size();link.remove(index--);) link.get(0); ï¼Œ âœ”ï¸ æ•°ç»„æ’æˆæœ€å°çš„æ•° Arrays.sort(str, new Comparator(){ public int compare(String s1, String s2)ï¼Œâœ”ï¸ æ•°ç»„ä¸­åªå‡ºç°ä¸€æ¬¡çš„æ•°å­— , åˆ’åˆ†2æ•°ç»„ï¼Œnum &amp; (-num);äºŒè€…ä¸åå¾—åˆ°çš„æ•°ï¼Œå°†numæœ€å³è¾¹çš„1ä¿ç•™ä¸‹æ¥ï¼Œâœ”ï¸ 1.3 important æ•°ç»„ä¸­çš„é€†åºå¯¹(å½’å¹¶æ’åº). void mergeSort(int a[], int l, int r) ï¼Œ âœ”ï¸ æœ€å°çš„Kä¸ªæ•°(å †æ’åº)ï¼Œ æ•°æ®æµä¸­çš„ä¸­ä½æ•° ï¼ˆ2 PriorityQueueï¼‰. æœ€å°çš„Kä¸ªæ•° ï¼ˆ2funï¼‰å¿«æ’æ€æƒ³ part return l, å¤–else return left; void set_k(int* input, n, k) ï¼Œ âœ”ï¸ quickSort(a[],left,right), while(1) { (åŒwhile, if(l &gt;= r) break; swap) } swap(a[left], a[l]);ï¼Œ âœ”ï¸ æœ€çŸ­è·¯Floydï¼Œ âœ”ï¸ quickSort (1 while + [2while + break + swap] + swap + 2 quickSort) mergeSort (2 mergeSort + new *arr + 3 while + 1 for) 1.1 å…«çš‡å const int N = 105;int pos[N];int num = 8, cnt = 0;bool ok(int n) &#123; for(int i = 0; i &lt; n; i++) &#123; if(pos[i] == pos[n]) return false; if(abs(pos[n] - pos[i]) == n-i) return false; &#125; return true;&#125;void dfs(int n) &#123; if(n == num) &#123; cnt++; return; &#125; for(int i = 0; i &lt; num; i++) &#123; pos[n] = i; if(ok(n)) &#123; dfs(n+1); &#125; &#125;&#125;int main() &#123; res = dfs(0); cout &lt;&lt; res &lt;&lt; endl; return 0;&#125; 1.2 äºŒç»´æ•°ç»„ä¸­çš„æŸ¥æ‰¾ int a[][4] = &#123; &#123; 1, 2, 3, 4 &#125;, &#123; 5, 6, 7, 8 &#125;, &#123; 9, 10, 11, 12&#125;, &#123; 13, 14, 15, 16&#125;, &#123; 17, 18, 19, 20&#125;&#125;;bool Find(int b[][4], int rows, int cols, int value) &#123; int row = 0, col = cols - 1; while (b != NULL &amp;&amp; row &lt; rows &amp;&amp; col &gt;= 0) &#123; if (b[row][col] == value) &#123; cout &lt;&lt; &quot;row: &quot; &lt;&lt; row &lt;&lt; &quot; col: &quot; &lt;&lt; col &lt;&lt; end; return true; &#125; else if (b[row][col] &gt; value) &#123; col--; &#125; else &#123; row++; &#125; &#125; return false;&#125; 1.3 æ›¿æ¢ç©ºæ ¼ char* replace(char* str, int len) &#123; while(str[len] != &#x27;\\0&#x27;)&#123; if(str[len] == &#x27; &#x27;)&#123; konglen++; &#125; len++; &#125; return &#x27;\\0&#x27;;&#125; 1.4 æ—‹è½¬æ•°ç»„çš„æœ€å°å…ƒç´  void quickSort(int a[], int left, int right) &#123; if(left &lt; right) &#123; // exit. good idea! int l = left, r = right, x = a[l]; while(1) &#123; while(l &lt; r &amp;&amp; a[r] &gt;= x) r--; while(l &lt; r &amp;&amp; a[l] &lt;= x) l++; if(l &gt;= r) break; swap(a[r], a[l]); &#125; swap(a[left], a[l]); quickSort(a, left, l-1); quickSort(a, l+1, right); &#125;&#125; 1.5 è°ƒæ•´æ•°ç»„ä½æ•°ä½¿å¥‡æ•°ä½äºå‰é¢ void reorderOddEven(int[] arr, len) &#123; if (arr == NULL || len &lt;= 1 ) &#123; return; &#125; int l = 0, r = len - 1; while (l &lt; r) &#123; while (l &lt; r &amp;&amp; arr[r] % 2 == 0) &#123; r--; &#125; while (l &lt; r &amp;&amp; arr[l] % 2 == 1) &#123; l++; &#125; if (l &lt; r) &#123; swap(arr[l], arr[r]); l++, r--; &#125; &#125;&#125; 1.6 å‡ºç°æ¬¡æ•°è¶…è¿‡ä¸€åŠçš„æ¬¡æ•° int core(int *a, int len) &#123; if (arr == NULL || len &lt;= 0 ) &#123; return; &#125; int target = a[0], cnt = 1; for (int i = 1; i &lt; len; i++) &#123; if (a[i] == target) &#123; cnt++; &#125; else &#123; cnt--; if (cnt == 0) &#123; target = a[i]; cnt = 1; &#125; &#125; &#125; return target;&#125; 1.7 æœ€å°çš„Kä¸ªæ•° part å¿«æ’æ€æƒ³ const int N = 105;int a[N] = &#123;4, 5, 1, 6, 2, 7, 3, 8&#125;;int part (int *a, int left, int right) &#123; if(left &lt; right) &#123; int x = a[0], l = left, r = right; while(l &lt; r) &#123; while(l &lt; r &amp;&amp; a[r] &gt;= x) r--; while(l &lt; r &amp;&amp; a[l] &lt;= x) l++; if(l &gt;= r) break; swap(a[l], a[r]); &#125; swap(x, a[l]); return l; &#125; else return left;&#125;void set_k(int *input, int n, int k) &#123; if(input == NULL || k &gt; n || k &lt;= 0 || n &lt;= 0) &#123; return; &#125; int start = 0, end = n - 1; int index = part(input, start, end); while(index != k-1) &#123; if(index &gt; k-1) &#123; end = index - 1; &#125; else if(index &lt; k - 1) &#123; start = index + 1; &#125; else &#123; break; &#125; index = part(input, start, end); &#125;&#125; 1.8 æ•°ç»„ä¸­çš„é€†åºå¯¹ &amp; å½’å¹¶æ’åº void mergeSort(int a[], int l, int r) &#123; // 8, 5, 4, 9, 2, 3, 6 if(l &gt;= r) return; // exit. int mid = (l+r) / 2; // overflow &lt;-&gt; l + (r-l)/2 mergeSort(a, l, mid); mergeSort(a, mid+1, r); int *arr = new int[r-l+1]; int k = 0; int i = l, j = mid + 1; while(i &lt;= mid &amp;&amp; j &lt;= r) &#123; if(a[i] &lt;= a[j]) &#123; arr[k++] = a[i++]; &#125; else &#123; arr[k++] = a[j++]; // ans += (mid-i+1); &#125; &#125; while(i &lt;= mid) arr[k++] = a[i++]; while(j &lt;= r) arr[k++] = a[j++]; for(int i = l; i &lt;= r; i++) &#123; a[i] = arr[i-l]; &#125; delete []arr;&#125; 1.15 çº¦ç‘Ÿå¤«ç¯ import java.util.LinkedList;public class Solution &#123; public int LastRemaining_Solution(int n, int m) &#123; if(n &lt; 1 || m &lt; 1) return -1; LinkedList&lt;Integer&gt; link = new LinkedList&lt;Integer&gt;(); for(int i = 0; i &lt; n; i++) link.add(i); int index = -1; //èµ·æ­¥æ˜¯ -1 ä¸æ˜¯ 0 while(link.size() &gt; 1)&#123; index = (index + m) % link.size(); //å¯¹ linkçš„é•¿åº¦æ±‚ä½™ä¸æ˜¯å¯¹ n link.remove(index); index --; &#125; return link.get(0); &#125;&#125; 1.17 æ’åºæ•°ç»„ä¸­æŸæ•°å­—å‡ºç°çš„æ¬¡æ•° int bina(int *a, int len, int data) &#123; if(a == NULL || len &lt;= 0) return -1; int l = 0, r = len - 1; while(l &lt;= r) &#123; int mid = (l + r) / 2; if(a[mid] == data) return mid; else if(data &lt; a[mid]) &#123; r = mid - 1; &#125; else l = mid+1; &#125; return -1; &#125; 2. LinkedListlinkedlist_summary 2.1 easy: åœ¨ O(1) æ—¶é—´åˆ é™¤é“¾è¡¨èŠ‚ç‚¹ï¼Œ âœ”ï¸ åˆ é™¤å•é“¾è¡¨å€’æ•°ç¬¬ n ä¸ªèŠ‚ç‚¹ï¼Œ âœ”ï¸ æ±‚å•é“¾è¡¨çš„ä¸­é—´èŠ‚ç‚¹ï¼Œ âœ”ï¸ åˆ¤æ–­å•é“¾è¡¨æ˜¯å¦å­˜åœ¨ç¯ï¼Œ âœ”ï¸ ä»å°¾åˆ°å¤´æ‰“å°é“¾è¡¨, é€’å½’ ok.ï¼Œ âœ”ï¸ é“¾è¡¨ä¸­å€’æ•°ç¬¬kä¸ªç»“ç‚¹ ok.ï¼Œ âœ”ï¸ åˆ¤æ–­ä¸¤ä¸ªæ— ç¯å•é“¾è¡¨æ˜¯å¦ç›¸äº¤ï¼Œ âœ”ï¸ ä¸¤ä¸ªé“¾è¡¨ç›¸äº¤æ‰©å±•ï¼šæ±‚ä¸¤ä¸ªæ— ç¯å•é“¾è¡¨çš„ç¬¬ä¸€ä¸ªç›¸äº¤ç‚¹ï¼Œ âœ”ï¸ ä¸¤ä¸ªé“¾è¡¨çš„ç¬¬ä¸€ä¸ªå…¬å…±ç»“ç‚¹ ï¼Œ âœ”ï¸ æ—‹è½¬å•é“¾è¡¨ é¢˜ç›®æè¿°ï¼šç»™å®šä¸€ä¸ªå•é“¾è¡¨ï¼Œè®¾è®¡ä¸€ä¸ªç®—æ³•å®ç°é“¾è¡¨å‘å³æ—‹è½¬ K ä¸ªä½ç½®ã€‚ä¸¾ä¾‹ï¼š ç»™å®š 1-&gt;2-&gt;3-&gt;4-&gt;5-&gt;6-&gt;NULL, K=3åˆ™4-&gt;5-&gt;6-&gt;1-&gt;2-&gt;3-&gt;NULL ç¯è·¯çš„å…¥å£ç‚¹ åœ¨ç¬¬ 4 é¢˜ä¸¤ä¸ªæŒ‡é’ˆç›¸é‡åï¼Œè®©å…¶ä¸­ä¸€ä¸ªæŒ‡é’ˆå›åˆ°é“¾è¡¨çš„å¤´éƒ¨ï¼Œå¦ä¸€ä¸ªæŒ‡é’ˆåœ¨åŸåœ°ï¼ŒåŒæ—¶å¾€å‰æ¯æ¬¡èµ°ä¸€æ­¥ï¼Œå½“å®ƒä»¬å†æ¬¡ç›¸é‡æ—¶ï¼Œå°±æ˜¯åœ¨ç¯è·¯çš„å…¥å£ç‚¹ã€‚ 2.2 medium: åè½¬é“¾è¡¨ next=head-&gt;next, head-&gt;next=pre, pre=head, head=next; 4æ­¥ okï¼Œ âœ”ï¸ ç¿»è½¬éƒ¨åˆ†å•é“¾è¡¨ ä¸¾ä¾‹ï¼š1-&gt;2-&gt;3-&gt;4-&gt;5-&gt;null, from = 2, to = 4 ç»“æœï¼š1-&gt;4-&gt;3-&gt;2-&gt;5-&gt;null å¤æ‚é“¾è¡¨çš„å¤åˆ¶ okï¼Œ âœ”ï¸ é“¾è¡¨åˆ’åˆ† ï¼ˆé¢˜ç›®æè¿°ï¼š ç»™å®šä¸€ä¸ªå•é“¾è¡¨å’Œæ•°å€¼xï¼Œåˆ’åˆ†é“¾è¡¨ä½¿å¾—å°äºxçš„èŠ‚ç‚¹æ’åœ¨å¤§äºç­‰äºxçš„èŠ‚ç‚¹ä¹‹å‰ï¼‰ å•é“¾è¡¨æ’åº åˆå¹¶ä¸¤ä¸ªæˆ–kä¸ªæœ‰åºé“¾è¡¨ okï¼Œ é€’å½’ (ä¸‰å…ƒè¿ç®—ç¬¦). åˆ é™¤é“¾è¡¨é‡å¤ç»“ç‚¹ é“¾è¡¨1-&gt;2-&gt;3-&gt;3-&gt;4-&gt;4-&gt;5 å¤„ç†åä¸º 1-&gt;2-&gt;5. first-&gt;next=head, last, p ä¸‰é’ˆï¼Œ âœ”ï¸ é“¾è¡¨ä¸­ç¯çš„å…¥å£ç»“ç‚¹ï¼Œ âœ”ï¸ å•é“¾è¡¨æ’åº or åˆå¹¶ä¸¤ä¸ªæˆ–kä¸ªæœ‰åºé“¾è¡¨ struct Node &#123; Node *next; int value; &#125;; /* ä½ ä¸€å®šè¦ç›¸ä¿¡é€’å½’æ˜¯ä¸€ä¸ªå¼ºå¤§çš„æ€æƒ³ */Node* mergeList(Node* head1, Node* head2) &#123; // æœ‰åºé“¾è¡¨çš„åˆå¹¶ if(head1 == NULL) return head2; if(head2 == NULL) return head1; Node* tmp; if(head1-&gt;value &lt; head2-&gt;value) &#123; tmp = head1; head1 = head1-&gt;next; &#125; else &#123; tmp = head2; head2 = head2-&gt;next; &#125; tmp-&gt;next = mergeList(head1, head2); return tmp;&#125;Node* mergeSort(Node* head) &#123; if(head == NULL) return NULL; Node* r_head = head; Node* head1 = head; Node* head2 = head; while(head2-&gt;next != NULL &amp;&amp; head2-&gt;next-&gt;next != NULL) &#123; head1 = head1-&gt;next; head2 = head2-&gt;next-&gt;next; &#125; if(head1-&gt;next == NULL) return r_head; // åªæœ‰ä¸€ä¸ªèŠ‚ç‚¹ head2 = head1-&gt;next; head1 = head; r_head = mergeList(mergeSort(head1), mergeSort(head2)); return r_head;&#125; 2.3 difficul: é“¾è¡¨æ±‚å’Œ åè½¬é“¾è¡¨: public ListNode reverseList(ListNode head) &#123; ListNode next = null; ListNode pre = null while (head != null) &#123; next = head.next; (ä¿å­˜å½“å‰å¤´ç»“ç‚¹çš„ä¸‹ä¸ªèŠ‚ç‚¹) head.next = pre; (å°†å½“å‰å¤´ç»“ç‚¹çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹æŒ‡å‘â€œä¸Šä¸€ä¸ªèŠ‚ç‚¹â€ï¼Œè¿™ä¸€æ­¥æ˜¯å®ç°äº†åè½¬) pre = head; (å°†å½“å‰å¤´ç»“ç‚¹è®¾ç½®ä¸ºâ€œä¸Šä¸€ä¸ªèŠ‚ç‚¹â€) head = next; (å°†ä¿å­˜çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹è®¾ç½®ä¸ºå¤´ç»“ç‚¹) &#125; return pre;&#125; å¤æ‚é“¾è¡¨çš„å¤åˆ¶: /*public class RandomListNode &#123; int label; RandomListNode next = null; RandomListNode random = null; RandomListNode(int label) &#123; this.label = label; &#125;&#125;*/ public class Solution &#123; public RandomListNode Clone(RandomListNode pHead) &#123; if(pHead == null) return null; //å¤åˆ¶èŠ‚ç‚¹ A-&gt;B-&gt;C å˜æˆ A-&gt;A&#x27;-&gt;B-&gt;B&#x27;-&gt;C-&gt;C&#x27; RandomListNode head = pHead; while(head != null)&#123; RandomListNode node = new RandomListNode(head.label); node.next = head.next; head.next = node; head = node.next; &#125; //å¤åˆ¶random head = pHead; while(head != null)&#123; head.next.random = head.random == null ? null : head.random.next; head = head.next.next; &#125; //æŠ˜åˆ† head = pHead; RandomListNode chead = head.next; while(head != null)&#123; RandomListNode node = head.next; head.next = node.next; node.next = node.next == null ? null : node.next.next; head = head.next; &#125; return chead; &#125;&#125; é“¾è¡¨åˆ’åˆ†ï¼š ç»™å®šä¸€ä¸ªå•é“¾è¡¨å’Œæ•°å€¼xï¼Œåˆ’åˆ†é“¾è¡¨ä½¿å¾—æ‰€æœ‰å°äºxçš„èŠ‚ç‚¹æ’åœ¨å¤§äºç­‰äºxçš„èŠ‚ç‚¹ä¹‹å‰ã€‚ ä½ åº”è¯¥ä¿ç•™ä¸¤éƒ¨åˆ†å†…é“¾è¡¨èŠ‚ç‚¹åŸæœ‰çš„ç›¸å¯¹é¡ºåºã€‚ æ ·ä¾‹ç»™å®šé“¾è¡¨ 1-&gt;4-&gt;3-&gt;2-&gt;5-&gt;2-&gt;nullï¼Œå¹¶ä¸” x=3è¿”å› 1-&gt;2-&gt;2-&gt;4-&gt;3-&gt;5-&gt;null public ListNode partition(ListNode head, int x) &#123; // write your code here if(head == null) return null; ListNode leftDummy = new ListNode(0); ListNode rightDummy = new ListNode(0); ListNode left = leftDummy, right = rightDummy; while (head != null) &#123; if (head.val &lt; x) &#123; left.next = head; left = head; &#125; else &#123; right.next = head; right = head; &#125; head = head.next; &#125; right.next = null; left.next = rightDummy.next; return leftDummy.next; &#125;&#125; 3. String13 é“é¢˜æå®š BAT é¢è¯•â€”â€”å­—ç¬¦ä¸² å­—ç¬¦ä¸² # include &lt;iostream&gt;# include &lt;vector&gt;# include &lt;queue&gt;# include &lt;cstring&gt;using namespace std;int main() &#123; string x; cin &gt;&gt; x; sort(x.begin(), x.end()); reverse(x.begin(), x.end()); cout &lt;&lt; x &lt;&lt; endl; return 0;&#125; 3.1 easy: æ›¿æ¢ç©ºæ ¼ï¼Œ âœ”ï¸ åè½¬å­—ç¬¦ä¸² abcd -&gt; dcbaï¼Œ âœ”ï¸ ç¿»è½¬å•è¯é¡ºåºåˆ—ï¼Œ I am a student. -&gt; student. a am Iï¼Œ âœ”ï¸ æ—‹è½¬å­—ç¬¦ä¸²ï¼Œ abcde â€”2ä½â€”&gt; cdeab, è‹¥å¹²æ¬¡æ—‹è½¬æ“ä½œä¹‹åï¼ŒA èƒ½å˜æˆBï¼Œé‚£ä¹ˆè¿”å›Trueï¼Œ âœ”ï¸ å·¦æ—‹è½¬å­—ç¬¦ä¸² string LeftRotateString(string str, int n),string Reverse(string str)ï¼Œ âœ”ï¸ åè½¬å­—ä¸²å•è¯ string ReverseSentence(string str), reverse(str.begin(), str.end()); in lib algorithm 3.2 medium å­—ç¬¦æµä¸­ç¬¬ä¸€ä¸ªä¸é‡å¤çš„å­—ç¬¦ (å“ˆå¸Œæ¥å­˜æ¯ä¸ªå­—ç¬¦åŠå…¶å‡ºç°çš„æ¬¡æ•°ï¼Œå¦ç”¨ä¸€å­—ç¬¦ä¸² s æ¥ä¿å­˜å­—ç¬¦æµä¸­å­—ç¬¦é¡ºåº) ç¬¬ä¸€ä¸ªåªå‡ºç°ä¸€æ¬¡çš„å­—ç¬¦ å­—ç¬¦ä¸²å…¨æ’åˆ— void res(char *str, char *pStr), scanf(â€œ%sâ€, str); #include &lt; utility> å­—ç¬¦ä¸²è½¬æ•´å‹ int StrToInt(char* str) ok å­—ç¬¦ä¸²çš„æ’åˆ— (ç»™å®šä¸¤ä¸ªå­—ç¬¦ä¸² s1 å’Œ s2ï¼Œç¬¬ä¸€ä¸ªå­—ç¬¦ä¸²çš„æ’åˆ—ä¹‹ä¸€æ˜¯ç¬¬äºŒä¸ªå­—ç¬¦ä¸²çš„å­ä¸²) import java.util.HashMap;public class Solution &#123; HashMap&lt;Character, Integer&gt; map = new HashMap&lt;Character, Integer&gt;(); StringBuffer s = new StringBuffer(); //Insert one char from stringstream public void Insert(char ch) &#123; s.append(ch); if(map.containsKey(ch))&#123; map.put(ch, map.get(ch)+1); &#125;else&#123; map.put(ch, 1); &#125; &#125; //return the first appearence once char in current stringstream public char FirstAppearingOnce() &#123; for(int i = 0; i &lt; s.length(); i++)&#123; if(map.get(s.charAt(i)) == 1) return s.charAt(i); &#125; return &#x27;#&#x27;; &#125;&#125; 3.2 difficult KMP ç®—æ³• æœ€é•¿å…¬å…±å‰ç¼€ æœ€é•¿å›æ–‡ä¸² (3.1) éªŒè¯å›æ–‡ä¸² (3.2) æœ€é•¿å›æ–‡å­ä¸² (3.3) æœ€é•¿å›æ–‡å­åºåˆ— è¡¨ç¤ºæ•°å€¼çš„å­—ç¬¦ä¸² å‰‘æŒ‡offer: è¡¨ç¤ºæ•°å€¼çš„å­—ç¬¦ è¯·å®ç°ä¸€ä¸ªå‡½æ•°ç”¨æ¥åˆ¤æ–­å­—ç¬¦ä¸²æ˜¯å¦è¡¨ç¤ºæ•°å€¼ï¼ˆåŒ…æ‹¬æ•´æ•°å’Œå°æ•°ï¼‰ã€‚ä¾‹å¦‚ï¼Œå­—ç¬¦ä¸²â€+100â€³,â€5e2â€³,â€-123â€³,â€3.1416â€³å’Œâ€-1E-16â€³éƒ½è¡¨ç¤ºæ•°å€¼ã€‚ ä½†æ˜¯â€12eâ€,â€1a3.14â€³,â€1.2.3â€³,â€+-5â€³å’Œâ€12e+4.3â€³éƒ½ä¸æ˜¯ã€‚ 3.1 easy code 3.1.1 æ›¿æ¢ç©ºæ ¼ for(int i=tail; i&gt;len &amp;&amp; i&gt;=0; i--)&#123; if(str[len] == &#x27; &#x27;) &#123; str[i--] = &#x27;0&#x27;; str[i--] = &#x27;2&#x27;; str[i] = &#x27;%&#x27;; &#125; else &#123; str[i] = str[len]; &#125; len--;&#125; 3.1.4 æ—‹è½¬å­—ç¬¦ä¸² class Solution &#123; public boolean rotateString(String A, String B) &#123; return A.length() == B.length() &amp;&amp; (A+A).contains(B); &#125;&#125; 3.1.5 å·¦æ—‹è½¬å­—ç¬¦ä¸² å­—ç¬¦åºåˆ—S=â€abcXYZdefâ€,è¦æ±‚è¾“å‡ºå¾ªç¯å·¦ç§»3ä½åçš„ç»“æœï¼Œå³â€œXYZdefabcâ€ã€‚æ˜¯ä¸æ˜¯å¾ˆç®€å•ï¼ŸOKï¼Œæå®šå®ƒï¼ åœ¨ç¬¬ n ä¸ªå­—ç¬¦åé¢å°†åˆ‡ä¸€åˆ€ï¼Œå°†å­—ç¬¦ä¸²åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼Œå†é‡æ–°å¹¶æ¥èµ·æ¥å³å¯ã€‚æ³¨æ„å­—ç¬¦ä¸²é•¿åº¦ä¸º 0 çš„æƒ…å†µã€‚ public class Solution &#123; public String LeftRotateString(String str,int n) &#123; int len = str.length(); if(len == 0) return &quot;&quot;; n = n % len; String s1 = str.substring(n, len); String s2 = str.substring(0, n); return s1+s2; &#125;&#125; 3.2 medium code void res(char *str, char *pStr) &#123; if(*pStr == &#x27;\\0&#x27;) cout &lt;&lt; str &lt;&lt; endl; for(char *p = pStr; *p != &#x27;\\0&#x27;; ++p) &#123; char tmp = *p; *p = *pStr; *pStr = tmp; res(str, pStr+1); tmp = *p; *p = *pStr; *pStr = tmp; &#125;&#125; å­—ç¬¦æµä¸­ç¬¬ä¸€ä¸ªä¸é‡å¤çš„å­—ç¬¦ C++ /class Solution&#123;public: //Insert one char from stringstream // vectorç”¨æ¥è®°å½•å­—ç¬¦æµ vector&lt;char&gt; vec; // mapç”¨æ¥ç»Ÿè®¡å­—ç¬¦çš„ä¸ªæ•° map&lt;char, int&gt; table; void Insert(char ch) &#123; table[ch]++; vec.push_back(ch); &#125; //return the first appearence once char in current stringstream char FirstAppearingOnce() &#123; // éå†å­—ç¬¦æµï¼Œæ‰¾åˆ°ç¬¬ä¸€ä¸ªä¸º1çš„å­—ç¬¦ for (char c : vec) &#123; if (table[c] == 1) return c; &#125; return &#x27;#&#x27;; &#125;&#125;; å­—ç¬¦æµä¸­ç¬¬ä¸€ä¸ªä¸é‡å¤çš„å­—ç¬¦ Java import java.util.HashMap;public class Solution &#123; HashMap&lt;Character, Integer&gt; map = new HashMap&lt;Character, Integer&gt;(); StringBuffer s = new StringBuffer(); //Insert one char from stringstream public void Insert(char ch) &#123; s.append(ch); if(map.containsKey(ch))&#123; map.put(ch, map.get(ch)+1); &#125;else&#123; map.put(ch, 1); &#125; &#125; //return the first appearence once char in current stringstream public char FirstAppearingOnce() &#123; for(int i = 0; i &lt; s.length(); i++)&#123; if(map.get(s.charAt(i)) == 1) return s.charAt(i); &#125; return &#x27;#&#x27;; &#125;&#125; 4. Binary Tree ç®—æ³•&amp;æ•°æ®ç»“æ„ ï¼Œ 20Tree 4.1 easy é€’å½’ï¼š æ±‚äºŒå‰æ ‘ä¸­çš„èŠ‚ç‚¹ä¸ªæ•° ï¼Œ âœ”ï¸ é€’å½’ï¼š æ±‚äºŒå‰æ ‘çš„æœ€å¤§å±‚æ•°(æœ€å¤§æ·±åº¦) &amp; (æœ€å°æ·±åº¦) æœ€å°æ·±åº¦ç‰¹æ®Šæƒ…å†µï¼šleft || right==0 ï¼Œ âœ”ï¸ é€’å½’ï¼š æ±‚äºŒå‰æ ‘ç¬¬Kå±‚çš„èŠ‚ç‚¹ä¸ªæ•° get_k(root.left, k-1) + get_k(root.right, k-1); good ï¼Œ âœ”ï¸ é€’å½’ï¼š æ±‚äºŒå‰æ ‘ç¬¬Kå±‚çš„å¶å­èŠ‚ç‚¹ä¸ªæ•° if(k==1 and root.left and root.right is null) return 1; ï¼Œ âœ”ï¸ é€’å½’ï¼š äºŒå‰æ ‘å…ˆåºéå†/å‰åºéå† (fIno(Node* root) { while(1) {if else} é€’å½’ï¼š åˆ¤æ–­ä¸¤æ£µäºŒå‰æ ‘æ˜¯å¦ç»“æ„ç›¸åŒ ï¼Œ âœ”ï¸ é€’å½’ï¼š æ±‚äºŒå‰æ ‘çš„é•œåƒï¼ˆåè½¬äºŒå‰æ ‘ï¼‰ ï¼Œ ï¼ˆå·¦å³é€’å½’äº¤æ¢ï¼‰âœ”ï¸ é€’å½’ï¼š å¯¹ç§°äºŒå‰æ ‘ ï¼ˆåŒå‡½æ•°ï¼Œæ‰¿æ¥ä¸Šé¢˜äºŒå‰æ ‘çš„é•œåƒï¼Œ goodï¼‰ ï¼Œ âœ”ï¸ é€’å½’ï¼š æ±‚äºŒå‰æ ‘ä¸­ä¸¤ä¸ªèŠ‚ç‚¹çš„æœ€ä½å…¬å…±ç¥–å…ˆèŠ‚ç‚¹ good ï¼Œ âœ”ï¸ é€’å½’ï¼š æ±‚äºŒå‰æœç´¢æ ‘çš„æœ€è¿‘å…¬å…±ç¥–å…ˆ good ï¼Œ âœ”ï¸ é€’å½’ï¼š æ ¹æ®å‰åºå’Œä¸­åºé‡å»ºäºŒå‰æ ‘ ï¼Œ âœ”ï¸ åŒå‡½æ•°ï¼Œé€’å½’ æ ‘çš„å­ç»“æ„,éå†+åˆ¤æ–­, bool f5(Node* root1, Node* root2), bool son(Node* p1, Node* p2) ï¼Œ âœ”ï¸ åˆ¤æ–­äºŒå‰æ ‘æ˜¯ä¸æ˜¯å¹³è¡¡äºŒå‰æ ‘ bool isBalance(Node* root)ï¼Œ int maxHigh(Node* root) ï¼Œ âœ”ï¸ æ±‚äºŒå‰æ ‘çš„ç›´å¾„ ï¼ˆç›´å¾„é•¿åº¦æ˜¯ä»»æ„ä¸¤ä¸ªç»“ç‚¹è·¯å¾„é•¿åº¦ä¸­çš„æœ€å¤§å€¼ï¼‰ï¼Œ âœ”ï¸ 4.2 medium åˆ†å±‚éå† (åˆ¤æ–­äºŒå‰æ ‘æ˜¯ä¸æ˜¯å®Œå…¨äºŒå‰æ ‘) ï¼ˆéå†åˆ°äº†NULLç»“ç‚¹ï¼Œå¦‚åç»­è¿˜æœ‰éNULLç»“ç‚¹ï¼‰ï¼Œ âœ”ï¸ åˆ†å±‚éå† (è‡ªä¸‹è€Œä¸Šåˆ†å±‚éå†) bfs + vector&lt; vector &lt; int &gt; &gt;ï¼Œ âœ”ï¸ åˆ†å±‚éå† (æŒ‰ä¹‹å­—å½¢é¡ºåºæ‰“å°äºŒå‰æ ‘)ï¼Œ âœ”ï¸ 4.3 difficult: äºŒå‰æ ‘ä¸­å’Œä¸ºæŸä¸€å€¼çš„è·¯å¾„ void f4(Node* root, int exSum, int curSum, vecotr\\&lt; int >&amp; path)ï¼Œ âœ”ï¸ äºŒå‰æ ‘ä¸‹ä¸€ç»“ç‚¹:3æƒ…å†µ (1.æœ‰right.child 2.æ²¡æœ‰right.child,çˆ¶left.child 3.æ²¡æœ‰right.child,çˆ¶right.child)âœ”ï¸ åºåˆ—åŒ–äºŒå‰æ ‘ï¼Œ String serialize(TreeNode root), TreeNode deserialize(String data) Queue queue = new LinkedList&lt;&gt;(); âœ”ï¸ äºŒå‰æœç´¢æ ‘çš„ååºéå†åºåˆ— bool f6(int* sec, int len)ï¼Œ âœ”ï¸ äºŒå‰æœç´¢æ ‘ä¸åŒå‘é“¾è¡¨ void convert(Node* root, Node*&amp; pLast) ï¼Œ âœ”ï¸ äºŒå‰æœç´¢æ ‘çš„ç¬¬kä¸ªç»“ç‚¹ ï¼Œ âœ”ï¸ äºŒå‰æŸ¥æ‰¾æ ‘èŠ‚ç‚¹çš„åˆ é™¤. é‡è¦ 4.1 easy code 4.1.9 äºŒå‰æ ‘ä¸¤èŠ‚ç‚¹çš„æœ€ä½å…¬å…±ç¥–å…ˆ # include &lt;iostream&gt;# include &lt;vector&gt;# include &lt;cstring&gt;using namespace std;struct Node &#123; Node* lchild; Node* rchild; int value; Node(): value(0), lchild(NULL), rchild(NULL) &#123;&#125; &#125;;vector&lt;Node*&gt; vec1;vector&lt;Node*&gt; vec2;/** 1. æ‰¾åˆ°ç›®æ ‡èŠ‚ç‚¹1ï¼Œå¯»æ‰¾è·¯å¾„ï¼Œå­˜æ”¾åœ¨ vec1 ä¸­. 2. æ‰¾åˆ°ç›®æ ‡èŠ‚ç‚¹2ï¼Œå¯»æ‰¾è·¯å¾„ï¼Œå­˜æ”¾åœ¨ vec2 ä¸­. 3. åŒæ—¶éå† 2 ä¸ª */bool getNodePath(Node* root, Node* target, vector&lt;Node*&gt;&amp; vec) &#123; if (root == NULl) &#123; return false; &#125; vec.push_back(root); if (root == target) &#123; return true; &#125; bool flag = false; flag = getNodePath(root-&gt;lchild, target, vec) if (!flag &amp;&amp; root-&gt;rchild) &#123; flag = getNodePath(root-&gt;rchild, target, vec) &#125; if (!flag) &#123; vec.pop_back(); &#125; return flag;&#125;Node* getCom(const vector&lt;Node*&gt;&amp; v1, const vector&lt;Node*&gt;&amp; v2) &#123; vector&lt;Node*&gt;::const_iterator it1 = v1.begin(); vector&lt;Node*&gt;::const_iterator it2 = v2.begin(); Node* pLast = NULL; while (it1 != v1.end() &amp;&amp; it2 != v2.end()) &#123; if (*it1 != *it2) &#123; break; &#125; pLast = *it1; it1++; it2++; &#125; return pLast;&#125;int main() &#123; retunr 0;&#125; 4.1.10 æ±‚äºŒå‰æœç´¢æ ‘çš„æœ€è¿‘å…¬å…±ç¥–å…ˆ Node* lowestCommonAncestor(Node* root, Node* p, Node* q) &#123; if (root == NULL || p == NULL || q == NULL) &#123; return NULL; &#125; if (root-&gt;value &gt; p-&gt;value &amp;&amp; root &gt; q-&gt;value) &#123; return lowestCommonAncestor(root-&gt;lchild, p, q); &#125; if (root-&gt;value &lt; p-&gt;value &amp;&amp; root &lt; q-&gt;value) &#123; return lowestCommonAncestor(root-&gt;rchild, p, q); &#125; return root;&#125; 4.1.11 å‰åºä¸­åºé‡å»ºäºŒå‰æ ‘ Node* f3(int* pre, int* ino, int len) &#123; // pre : 1, 2, 4, 7, 3, 5, 6, 8 ino : 4, 7, 2, 1, 5, 3, 8, 6 if(pre == NULL || ino == NULL || len &lt;= 0) return NULL; int r_v = pre[0]; Node* root = new Node(); root-&gt;value = r_v; int i; for(i = 0; ; i++) &#123; if(ino[i] == r_v) break; &#125; root-&gt;lchild = f3(pre+1, ino, i); root-&gt;rchild = f3(pre+i+1, ino+i+1, len-1-i); return root;&#125; åŒå‡½æ•° + é€’å½’ 4.1.12 æ ‘2æ˜¯å¦æ˜¯æ ‘1çš„å­ç»“æ„ bool son(Node* p1, Node* p2) &#123; if (p2 == NULL) &#123; return true; &#125; if (p1 == NULL) &#123; return false; &#125; if (p1-&gt;value == p2-&gt;value) &#123; return son(p1-&gt;lchild, p2-lchild); &#125;&#125;bool son_tree(Node* root1, Node* root2) &#123; if (root2 == NULL) &#123; return true; &#125; if (root1 == NULL) &#123; return false; &#125; if (root1-&gt;value == root2-&gt;child) &#123; return son(root1, root2); &#125; bool flag = false flag = son_tree(root1-&gt;lchild, root2); if (!flag) &#123; return son_tree(root1-&gt;rchild, root2); &#125;&#125; 4.1.13 å¹³è¡¡äºŒå‰æ ‘ bool isBalanced(Node* root) &#123; if(root == NULL) return true; return (-1 &lt;= (maxHigh(root-&gt;lchild) - maxHigh(root-&gt;rchild)) &lt;= 1) &amp;&amp; isBalanced(root-&gt;lchild) &amp;&amp; isBalanced(root-&gt;lchild);&#125;int maxHigh(Node* root)&#123; if(root == NULL) return 0; return max(maxHigh(root-&gt;lchild), maxHigh(root-&gt;rchild))+1;&#125; 4.1.14 æ±‚äºŒå‰æ ‘çš„ç›´å¾„ private int diamHelper(TreeNode root)&#123; if(root == null) return 0; int left = diamHelper(root.left); int right = diamHelper(root.right); path = Math.max(path, left + right); return Math.max(left, right) + 1;&#125; 4.2 medium code 4.2.1 åˆ¤æ–­äºŒå‰æ ‘æ˜¯ä¸æ˜¯å®Œå…¨äºŒå‰æ ‘ bool checkCompleteTree(Node* root) &#123; bool flag = true; queue&lt;Node*&gt; q; if (root == null) return true; q.push(root); while(!q.empty())&#123; for (int i = 0; i &lt; q.size(); ++i) &#123; Node* tmp = q.front(); q.pop(); if (tmp-&gt;lchild == NULL &amp;&amp; tmp-&gt;rchild != NULL)&#123; flag = false; break; &#125; if (tmp-&gt;left != NULL) que.push(tmp-&gt;left); if (tmp-&gt;right != NULL) que.push(tmp-&gt;right); &#125; &#125; return flag; &#125; 4.2.2 åˆ†å±‚éå† (è‡ªä¸‹è€Œä¸Šåˆ†å±‚éå†) vector&lt;vector&lt;int&gt;&gt; bfs(Node* root) &#123; vector &lt;vector&lt;int&gt; &gt; ans; if (root == NULL) return ans; queue&lt;Node*&gt; q; q.push(root); while(!q.empty()) &#123; vector&lt;int&gt; tv; for (int i = 0; i &lt; q.size(); ++i) &#123; Node* tmp = q.front(); q.pop(); if (tmp-&gt;lchild == NULL &amp;&amp; tmp-&gt;rchild != NULL)&#123; flag = false; break; &#125; if (tmp-&gt;left != NULL) que.push(tmp-&gt;left); if (tmp-&gt;right != NULL) que.push(tmp-&gt;right); tv.push_back(tmp-&gt;value); &#125; ans.push_back(tv) &#125; return flag; &#125;// reverse(res[i].begin(), res[i].end()); 4.3 difficult code 4.3.1 äºŒå‰æ ‘ä¸­å’Œä¸ºæŸä¸€å€¼çš„è·¯å¾„ void f4(Node*, int, int, vector&lt;int&gt;&amp;);void f4(Node* root, int exSum) &#123; if(root == NULL) return; vector&lt;int&gt; V; int curSum = 0; f4(root, exSum, curSum, V);&#125;void f4(Node* root, int exSum, int curSum, vecotr&lt;int&gt;&amp; path) &#123; curSum += root-&gt;value; path.push_back(root-&gt;value); if(curSum == exSum &amp;&amp; root-&gt;lchild == NULL &amp;&amp; root-&gt;rchild == NULL) &#123; //; æ‰“å°vectorä¸­çš„è·¯å¾„ &#125; if(root-&gt;lchild) f4(root-&gt;lchild, exSum, curSum, path); if(root-&gt;rchild) f4(root-&gt;rchild, exSum, curSum, path); curSum -= root-&gt;value; path.pop_back();&#125; 4.3.3 åºåˆ—åŒ–äºŒå‰æ ‘ public String serialize(TreeNode root) &#123; if(root == null) return &quot;#,&quot;; StringBuffer res = new StringBuffer(root.val + &quot;,&quot;); res.append(serialize(root.left)); res.append(serialize(root.right)); return res.toString();&#125;// Decodes your encoded data to tree.public TreeNode deserialize(String data) &#123; String [] d = data.split(&quot;,&quot;); Queue&lt;String&gt; queue = new LinkedList&lt;&gt;(); for(int i = 0; i &lt; d.length; i++)&#123; queue.offer(d[i]); &#125; return pre(queue);&#125;public TreeNode pre(Queue&lt;String&gt; queue)&#123; String val = queue.poll(); if(val.equals(&quot;#&quot;)) return null; TreeNode node = new TreeNode(Integer.parseInt(val)); node.left = pre(queue); node.right = pre(queue); return node;&#125; 4.3.4 äºŒå‰æœç´¢æ ‘ååºéå†çš„ç»“æœ bool f6(int* sec, int len) &#123; if(sec == NULL) return false; if(len &lt;= 1) return true; int i, rv = sec[len-1]; for(i = 0; i &lt; len-1; i++) &#123; if(sec[i] &gt; rv) break; &#125; for(int j = i; j &lt; len-1; j++) &#123; if(sec[j] &lt; rv) return false; &#125; return f6(sec, i) &amp;&amp; f6(sec+i, len-i-1);&#125; 4.3.5 äºŒå‰æœç´¢æ ‘ä¸åŒå‘é“¾è¡¨ void convert(Node* root, Node*&amp; pLast) &#123; if(root == NULL) return; if(root-&gt;lchild) convert(root-&gt;lchild, pLast); Node* pCur = root; pCur-&gt;lchild = pLast; if(pLast) pLast-&gt;rchild = pCur; pLast = pCur; if(root-&gt;rchild) convert(root-&gt;rchild, pLast);&#125; 4.3.6 äºŒå‰æœç´¢æ ‘çš„ç¬¬kä¸ªç»“ç‚¹ ç»™å®šä¸€æ£µäºŒå‰æœç´¢æ ‘ï¼Œè¯·æ‰¾å‡ºå…¶ä¸­çš„ç¬¬kå°çš„ç»“ç‚¹ã€‚ä¾‹å¦‚ï¼Œ ï¼ˆ5ï¼Œ3ï¼Œ7ï¼Œ2ï¼Œ4ï¼Œ6ï¼Œ8ï¼‰ä¸­ï¼ŒæŒ‰ç»“ç‚¹æ•°å€¼å¤§å°é¡ºåºç¬¬ä¸‰å°ç»“ç‚¹çš„å€¼ä¸º4ã€‚ å› ä¸ºäºŒå‰æœç´¢æ ‘æŒ‰ç…§ä¸­åºéå†çš„é¡ºåºæ‰“å°å‡ºæ¥å°±æ˜¯æ’å¥½åºçš„ï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬æŒ‰ç…§ä¸­åºéå†æ‰¾åˆ°ç¬¬kä¸ªç»“ç‚¹å°±æ˜¯é¢˜ç›®æ‰€æ±‚çš„ç»“ç‚¹ã€‚ class Solution &#123; public int kthSmallest(TreeNode root, int k) &#123; if(root == null) return Integer.MIN_VALUE; Stack&lt;TreeNode&gt; stack = new Stack&lt;&gt;(); int count = 0; TreeNode p = root; while(p != null || !stack.isEmpty())&#123; if(p != null)&#123; stack.push(p); p = p.left; &#125;else&#123; TreeNode node = stack.pop(); count ++; if(count == k) return node.val; p = node.right; &#125; &#125; return Integer.MIN_VALUE; &#125;&#125; 5. é€’å½’ / å›æº¯5.1 æ–æ³¢æ‹‰å¥‘ æ–æ³¢æ‹‰å¥‘æ•°åˆ— &amp; è·³å°é˜¶ &amp; å˜æ€è·³å°é˜¶ 2 * Fib(n-1). ï¼Œ âœ”ï¸ çŸ©å½¢è¦†ç›– ï¼Œ âœ”ï¸ 5.2 å›æº¯ çŸ©é˜µä¸­çš„è·¯å¾„(BFS) æœºå™¨äººçš„è¿åŠ¨èŒƒå›´(DFS) public int count(int threshold, int rows, int cols, int i, int j, int[][] flag)&#123; if(i&lt;0 || j&lt;0 || i&gt;=rows || j&gt;=cols || sum(i)+sum(j) &gt; threshold || flag[i][j] == 1)&#123; return 0; &#125; flag[i][j] = 1; return 1 + count(threshold, rows, cols, i - 1, j, flag) + count(threshold, rows, cols, i + 1, j, flag) + count(threshold, rows, cols, i, j - 1, flag) + count(threshold, rows, cols, i, j + 1, flag);&#125; 5.3 ä½è¿ç®— äºŒè¿›åˆ¶ä¸­1çš„ä¸ªæ•° n &amp; n-1.ï¼Œ âœ”ï¸ æ•°å€¼çš„æ•´æ•°æ¬¡æ–¹ dp. ï¼Œ âœ”ï¸ æ•°ç»„ä¸­åªå‡ºç°ä¸€æ¬¡çš„æ•°å­— ok. ï¼Œ âœ”ï¸ 6. Stack &amp; Queue &amp; heapStack &amp; Queue ç”¨ä¸¤ä¸ªæ ˆå®ç°é˜Ÿåˆ— ï¼Œ âœ”ï¸ åŒ…å«minå‡½æ•°çš„æ ˆ ï¼Œ âœ”ï¸ æ ˆçš„å‹å…¥ã€å¼¹å‡ºåºåˆ— 6.1 ç”¨ä¸¤ä¸ªæ ˆå®ç°é˜Ÿåˆ—class MyQueue &#123; Stack&lt;Integer&gt; input = new Stack&lt;Integer&gt;(); Stack&lt;Integer&gt; output = new Stack&lt;Integer&gt;(); /** Push element x to the back of queue. */ public void push(int x) &#123; input.push(x); &#125; /** Removes the element from in front of queue and returns that element. */ public int pop() &#123; peek(); return output.pop(); &#125; /** Get the front element. */ public int peek() &#123; if(output.isEmpty())&#123; while(!input.isEmpty()) output.push(input.pop()); &#125; return output.peek(); &#125; /** Returns whether the queue is empty. */ public boolean empty() &#123; return input.isEmpty() &amp;&amp; output.isEmpty(); &#125;&#125; 6.2 åŒ…å«minå‡½æ•°çš„æ ˆclass MinStack &#123; Stack&lt;Integer&gt; stack = new Stack&lt;Integer&gt;(); Stack&lt;Integer&gt; temp = new Stack&lt;Integer&gt;(); public void push(int x) &#123; stack.push(x); if(temp.isEmpty() || temp.peek() &gt;= x) temp.push(x); &#125; public void pop() &#123; int x = stack.pop(); int min = temp.peek(); if(x == min) temp.pop(); &#125; public int top() &#123; return stack.peek(); &#125; public int getMin() &#123; return temp.peek(); &#125;&#125; 6.3 æ ˆçš„ push pop åºåˆ—æ ˆçš„ push pop åºåˆ—1 2 3 4 54 3 5 1 2 import java.util.ArrayList;import java.util.Stack;public class Solution &#123; public boolean IsPopOrder(int [] pushA, int [] popA) &#123; if(pushA.length != popA.length || pushA.length == 0 || popA.length == 0) return false; Stack&lt;Integer&gt; stack = new Stack&lt;&gt;(); int index = 0; for(int i = 0; i &lt; pushA.length; i++)&#123; stack.push(pushA[i]); while(!stack.empty() &amp;&amp; stack.peek() == popA[index])&#123; stack.pop(); index++; &#125; &#125; return stack.empty(); &#125;&#125; 7. PriorityQueue æœ€å°çš„Kä¸ªæ•° æ•°æ®æµä¸­çš„ç¬¬Kå¤§å…ƒç´  æ»‘åŠ¨çª—å£æœ€å¤§å€¼ å‰Kä¸ªé«˜é¢‘å•è¯ ä¼˜å…ˆé˜Ÿåˆ— 8. Dynamic Programming çˆ¬æ¥¼æ¢¯ ï¼Œ âœ”ï¸ ä¸åŒè·¯å¾„ II ï¼Œ âœ”ï¸ ç¼–è¾‘è·ç¦» ï¼Œ âœ”ï¸ ä¸åŒè·¯å¾„ II å¦‚æœå½“å‰æ²¡æœ‰éšœç¢ç‰©ï¼Œdp[m][n] = dp[m - 1][n] + dp[m][n - 1]å¦‚æœæœ‰éšœç¢ç‰©ï¼Œåˆ™dp[m][n] = 0 ç¼–è¾‘è·ç¦» å¦‚æœå•è¯1ç¬¬i+1ä¸ªå­—ç¬¦å’Œå•è¯2ç¬¬j+1ä¸ªå­—ç¬¦ç›¸åŒï¼Œé‚£ä¹ˆå°±ä¸ç”¨æ“ä½œï¼Œåˆ™DP[i + 1][j + 1] = DP[i][j]; å¦‚æœä¸ç›¸åŒ,åˆ™æœ‰ä¸‰ç§å¯èƒ½æ“ä½œï¼Œå³å¢ï¼Œåˆ ï¼Œæ›¿æ¢ã€‚åˆ™å–è¿™ä¸‰ç§æ“ä½œçš„æœ€ä¼˜å€¼ï¼Œå³dp[i + 1][j + 1] = 1 + Math.min(dp[i][j], Math.min(dp[i][j + 1], dp[i + 1][j])); 8.1 ä¸€ç»´DP è¿ç»­å­æ•°ç»„çš„æœ€å¤§å’Œ // dp: F[i] = max(a[i], F[i-1]+a[i]); 8.2 äºŒç»´DPå¸ƒå°”æ•°ç»„ Longest Palindromic Substring/æœ€é•¿å›æ–‡å­ä¸² ç»™å‡ºä¸€ä¸ªå­—ç¬¦ä¸²Sï¼Œæ‰¾åˆ°ä¸€ä¸ªæœ€é•¿çš„è¿ç»­å›æ–‡ä¸²ã€‚ Interleaving String/äº¤é”™å­—ç¬¦ä¸² è¾“å…¥ä¸‰ä¸ªå­—ç¬¦ä¸²s1ã€s2å’Œs3ï¼Œåˆ¤æ–­ç¬¬ä¸‰ä¸ªå­—ç¬¦ä¸²s3æ˜¯å¦ç”±å‰ä¸¤ä¸ªå­—ç¬¦ä¸²s1å’Œs2äº¤æ›¿è€Œæˆä¸”ä¸æ”¹å˜s1å’Œs2ä¸­å„ä¸ªå­—ç¬¦åŸæœ‰çš„ç›¸å¯¹é¡ºåºã€‚ æ•°å­—æ•°ç»„ Unique Paths II/ä¸åŒè·¯å¾„ (åˆå§‹åŒ–å¾ˆé‡è¦) ï¼Œ èµ·ç‚¹åˆ°ç»ˆç‚¹æœ‰å¤šå°‘æ¡ä¸åŒè·¯å¾„ï¼Œå‘å³æˆ–å‘ä¸‹èµ°ã€‚ Minimum Path Sum çŸ©é˜µå·¦ä¸Šè§’å‡ºå‘åˆ°å³ä¸‹è§’ï¼Œåªèƒ½å‘å³æˆ–å‘ä¸‹èµ°ï¼Œæ‰¾å‡ºå“ªä¸€æ¡è·¯å¾„ä¸Šçš„æ•°å­—ä¹‹å’Œæœ€å°ã€‚ Edit Distance/ç¼–è¾‘è·ç¦» æ±‚ä¸¤ä¸ªå­—ç¬¦ä¸²ä¹‹é—´çš„æœ€çŸ­ç¼–è¾‘è·ç¦»ï¼Œå³åŸæ¥çš„å­—ç¬¦ä¸²è‡³å°‘è¦ç»è¿‡å¤šå°‘æ¬¡æ“ä½œæ‰èƒ½å¤Ÿå˜æˆç›®æ ‡å­—ç¬¦ä¸²ï¼Œæ“ä½œåŒ…æ‹¬åˆ é™¤ä¸€ä¸ªå­—ç¬¦ã€æ’å…¥ä¸€ä¸ªå­—ç¬¦ã€æ›´æ–°ä¸€ä¸ªå­—ç¬¦ã€‚ Distinct Subsequences/ä¸åŒå­åºåˆ— ç»™å®šSå’ŒTä¸¤ä¸ªå­—ç¬¦ä¸²ï¼Œé—®æŠŠé€šè¿‡åˆ é™¤Sä¸­çš„æŸäº›å­—ç¬¦ï¼ŒæŠŠSå˜ä¸ºTæœ‰å‡ ç§æ–¹æ³•ï¼Ÿ è¡¥å……ï¼šäº¬ä¸œ2019å®ä¹ ç¼–ç¨‹é¢˜-åˆ é™¤0æˆ–éƒ¨åˆ†å­—ç¬¦ä½¿å…¶æˆä¸ºå›æ–‡ä¸² è§ç¬”è¯•æ•´ç†æ€»ç»“ 8.3 ä¸‰ç»´DP9. å‰‘æŒ‡offerç®—æ³•å­¦ä¹ 5 æ•°æ®æµä¸­çš„ä¸­ä½æ•° æ»‘åŠ¨çª—å£çš„æœ€å¤§å€¼ (åŒå‘é˜Ÿåˆ—) æ­£åˆ™è¡¨è¾¾å¼åŒ¹é… æ•°å€¼çš„æ•´æ•°æ¬¡æ–¹ ä¸¤ä¸ªé“¾è¡¨çš„ç¬¬ä¸€ä¸ªå…¬å…±èŠ‚ç‚¹ï¼ˆ2ä¸ªstack or é•¿çŸ­é“¾è¡¨ç›¸å‡ï¼‰ diffcult æ•´æ•°ä¸­1å‡ºç°çš„æ¬¡æ•° (åˆ¤æ–­æ¯ä¸€ä½ï¼Œ æ¯”å¦‚ç™¾ä½åˆ†åˆ«ä¸º 1, 0, 2~9, å2ç§æƒ…å†µå¯åˆå¹¶) LRU Cache éœ€è¦æ·±å…¥å­¦ä¹ Javaçš„Mapçš„å†…éƒ¨å®ç° vector: vector::iterator, Modifiers (push_back, pop_back, insert) array : len = sizeof(arr)/sizeof(int) import java.util.ArrayList;import java.util.LinkedList;public class Solution &#123; public ArrayList&lt;Integer&gt; maxInWindows(int [] num, int size)&#123; ArrayList&lt;Integer&gt; res = new ArrayList&lt;Integer&gt;(); LinkedList&lt;Integer&gt; deque = new LinkedList&lt;Integer&gt;(); if(num.length == 0 || size == 0) return res; for(int i = 0; i &lt; num.length; i++)&#123; if(!deque.isEmpty() &amp;&amp; deque.peekFirst() &lt;= i - size) deque.poll(); while(!deque.isEmpty() &amp;&amp; num[deque.peekLast()] &lt; num[i]) deque.removeLast(); deque.offerLast(i); if(i + 1 &gt;= size) res.add(num[deque.peekFirst()]); &#125; return res; &#125;&#125; 10. shopee &amp; sinashopee ä¸‹ä¸€ä¸ªæ›´å¤§å…ƒç´  (Stack &lt; Integer &gt; (), Map &lt; Int, Int &gt; map, map.getOrDefault(nums1[i], -1); åºåˆ—ä¸º 9 2 1 4 å€ŸåŠ©æ ˆå®ç°ï¼Œåˆ¤æ–­æ ˆé¡¶ å’Œ ä¸‹ä¸€ä¸ªå…ƒç´ çš„å¤§å° ï¼Œ âœ”ï¸ é¸¡è›‹æ‰è½ (DPé—®é¢˜ï¼Œéš¾) google æ‰”é¸¡è›‹ï¼ŒåŸé¢˜æ˜¯ 100 å±‚æ¥¼ï¼Œé¸¡è›‹æ— é™ï¼Œç­”æ¡ˆ 14 æ¬¡ã€‚ï¼Œ âœ”ï¸ äºŒå‰æ ‘çš„å³è§†å›¾ (å±‚æ¬¡éå†) res.push_back(q.back()-&gt;val);ï¼Œ âœ”ï¸ å¤æ‚é“¾è¡¨æŒ‡é’ˆ ï¼Œ âœ”ï¸ K ä¸ªä¸€ç»„ç¿»è½¬é“¾è¡¨ 1-&gt;2-&gt;3-&gt;4-&gt;5ï¼Œ å½“ k = 2 æ—¶ï¼Œåº”è¿”: 2-&gt;1-&gt;4-&gt;3-&gt;5 ï¼Œ âœ”ï¸ ä¸åŒçš„äºŒå‰æœç´¢æ ‘ ï¼Œ âœ”ï¸ é›¶é’±å…‘æ¢ å®Œå…¨èƒŒåŒ…é—®é¢˜ ï¼Œi=coins[j];i&lt;=amount;ï¼Œdp[i]=Math.min(dp[i],dp[i-coins[j]]+1); âœ”ï¸ ç›¸äº¤é“¾è¡¨ æœ‰æ•ˆçš„æ‹¬å· ï¼ˆStackæ¥è§£å†³ï¼‰ ï¼Œ âœ”ï¸ ä¸¤æ•°ç›¸åŠ  [LeetCode] 887. Super Egg Drop è¶…çº§é¸¡è›‹æ‰è½ ï¼Œ âœ”ï¸ dp[i][j] = min(dp[i][j], max(dp[i - 1][k - 1], dp[i][j - k]) + 1) ( 1 &lt;= k &lt;= j ) ä¹‹åå¯ä»¥å†ä¼˜åŒ–. class Solution: def isValid(self, s): &quot;&quot;&quot; :type s: str :rtype: bool &quot;&quot;&quot; stack = list() match = &#123;&#x27;&#123;&#x27;:&#x27;&#125;&#x27;, &#x27;[&#x27;:&#x27;]&#x27;, &#x27;(&#x27;:&#x27;)&#x27;&#125; for i in s: if i == &#x27;&#123;&#x27; or i == &#x27;(&#x27; or i == &#x27;[&#x27;: stack.append(i) else: if len(stack) == 0: return False top = stack.pop() if match[top] != i: return False if len(stack) != 0: return False return True sina ä¸¤æ•°ä¹‹å’Œ (é“¾è¡¨ carry) ï¼Œ âœ”ï¸ æœ€å¤§å­åºå’Œ ï¼Œ âœ”ï¸ åˆ†æ²»ï¼Ÿ æœå¯»åäºº (if (knows(res, i)) res = i;) ï¼Œ âœ”ï¸ è¿ç»­å‡ºç°çš„æ•°å­— ï¼Œ âœ”ï¸ æœç´¢äºŒç»´çŸ©é˜µ ï¼Œ âœ”ï¸ æ’åºé“¾è¡¨ ç¿»è½¬äºŒå‰æ ‘ ï¼Œ âœ”ï¸ ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœº ç³»åˆ— å­—ç¬¦ä¸²è½¬æ•´å‹ æ— é‡å¤å­—ç¬¦çš„æœ€é•¿å­ä¸² ï¼Œ âœ”ï¸ ï¼ˆå€ŸåŠ©hashmapï¼‰ Tencent Minimum Factorization æœ€å°å› æ•°åˆ†è§£[LeetCode æœ€å°åŸºå› å˜åŒ–ï¼ˆå¹¿åº¦ä¼˜å…ˆæœç´¢ï¼‰] class Solution &#123;public: ListNode* addTwoNumbers(ListNode* l1, ListNode* l2) &#123; int carry = 0; ListNode* fakeHead = new ListNode(-1); ListNode* curr = fakeHead; while (l1 != NULL || l2 != NULL | carry != 0) &#123; if (l1 != NULL) &#123; carry += l1-&gt;val; l1 = l1-&gt;next; &#125; if (l2 != NULL) &#123; carry += l2-&gt;val; l2 = l2-&gt;next; &#125; ListNode* node = new ListNode(carry % 10); carry /= 10; curr-&gt;next = node; curr = node; &#125; return fakeHead-&gt;next; &#125;&#125;; 11. æµ·é‡æ•°æ®m_15 äºŒå‰æ ‘éé€’å½’çš„ å…ˆæ ¹éå†å’Œä¸­åºéå† (å¿…ä¼šæ•°æ®ç»“æ„ä¹‹ä¸€) void fPre(Node* root) &#123; // å…ˆæ ¹éå† æ ¹-&gt;å·¦-&gt;å³ Node* p = root; stack&lt;Node*&gt; S; while(1) &#123; if(p != NULL) &#123; cout &lt;&lt; p-&gt;value &lt;&lt; &#x27; &#x27;; S.push(p); p = p-&gt;lchild; &#125; else &#123; if(S.empty()) return; p = S.top(); S.pop(); p = p-&gt;rchild; &#125; &#125;&#125;void fIno(Node* root) &#123; Node* p = root; stack&lt;Node*&gt; S; while(1) &#123; if(p != NULL) &#123; S.push(p); p = p-&gt;lchild; &#125; else &#123; if(S.empty()) return; p = S.top(); S.pop(); cout &lt;&lt; p-&gt;value &lt;&lt; &#x27; &#x27;; p = p-&gt;rchild; &#125; &#125;&#125; leetcode CN leetcode EN Reference çŸ¥ä¹ï¼š [Leetcode][åŠ¨æ€è§„åˆ’]ç›¸å…³é¢˜ç›®æ±‡æ€»/åˆ†æ/æ€»ç»“ ç®€ä¹¦ï¼š 2019 ç®—æ³•é¢è¯•ç›¸å…³(leetcode)â€”åŠ¨æ€è§„åˆ’(Dynamic Programming) CSDN leetcode DP","categories":[{"name":"icpc","slug":"icpc","permalink":"http://iequa.com/categories/icpc/"}],"tags":[{"name":"leetcode","slug":"leetcode","permalink":"http://iequa.com/tags/leetcode/"}]},{"title":"Fine-grained Sentiment Analysis of User Online Reviews","slug":"nlp/Fine-grained-Sentiment-Analysis-of-User-Online-Reviews","date":"2019-06-25T02:16:21.000Z","updated":"2019-10-20T04:30:35.067Z","comments":true,"path":"2019/06/25/nlp/Fine-grained-Sentiment-Analysis-of-User-Online-Reviews/","link":"","permalink":"http://iequa.com/2019/06/25/nlp/Fine-grained-Sentiment-Analysis-of-User-Online-Reviews/","excerpt":"","text":"AI-Challenger Challenger.AI Online reviews have become the critical factor to make consumption decision in recent years. They not only have a profound impact on the incisive understanding of shops, users, and the implied sentiment, but also have been widely used in Internet and e-commerce industry, such as personalized recommendation, intelligent search, product feedback, and business security. In this challenge, we provide a dataset of user reviews for fine-grained sentiment analysis from the catering industry, containning 335K public user reviews from Dianping.com. The dataset builds a two-layer labeling system according to the granularity, which contains 6 categories and 20 fine-grained elements. Training set: 105K Verification set: 15K Test set A: 15K Test set B: 200K There are four sentimental types for every fine-grained element: Positive, Neutral, Negative and Not mentioned, which are labelled as 1, 0, -1 and-2. The meaning of these four labels are listed below. An example of one labelled review: â€œå‘³é“ä¸é”™çš„é¢é¦†ï¼Œæ€§ä»·æ¯”ä¹Ÿç›¸å½“ä¹‹é«˜ï¼Œåˆ†é‡å¾ˆè¶³ï½å¥³ç”Ÿåƒå°ä»½ï¼Œèƒƒå£å°çš„ï¼Œå¯èƒ½åƒä¸å®Œå‘¢ã€‚ç¯å¢ƒåœ¨é¢é¦†æ¥è¯´ç®—æ˜¯å¥½çš„ï¼Œè‡³å°‘çœ‹ä¸Šå»å ‚å­å¾ˆäº®ï¼Œä¹Ÿæ¯”è¾ƒå¹²å‡€ï¼Œä¸€èˆ¬è‹è‡é¦†å­è¿˜æ˜¯æ¯”ä¸ä¸Šè¿™ä¸ªå«ç”ŸçŠ¶å†µçš„ã€‚ä¸­åˆé¥­ç‚¹çš„æ—¶å€™ï¼Œäººå¾ˆå¤šï¼Œäººè¡Œé“ä¸Šä¹Ÿæ˜¯è¦åæ»¡çš„ï¼Œéš”å£çš„å†’èœé¦†å­ï¼Œæ®è¯´æ˜¯ä¸€å®¶ï¼Œæœ‰æ—¶å€™ä¹Ÿä¼šå¼€æ”¾å‡ºæ¥ååƒé¢çš„äººã€‚â€œ ã€ŒAI Challengerã€æ˜¯é¢å‘å…¨çƒäººå·¥æ™ºèƒ½äººæ‰çš„å¼€æºæ•°æ®é›†å’Œç¼–ç¨‹ç«èµ›å¹³å°ã€‚AI Challenger 2018 ç”±åˆ›æ–°å·¥åœºã€æœç‹—ã€ç¾å›¢ç‚¹è¯„ã€ç¾å›¾å…¬å¸è”åˆä¸»åŠã€‚æœ‰ä¸Šä¸‡æ”¯å›¢é˜Ÿå‚èµ›ï¼Œ è¦†ç›– 81 ä¸ªå›½å®¶ã€1100 æ‰€é«˜æ ¡ã€990 å®¶å…¬å¸ã€‚ æ•´ä½“æµç¨‹ é—®é¢˜å»ºæ¨¡ æ¨¡å‹åŸºæœ¬æ¶æ„ æ•°æ®å¤„ç†ã€‚ã€‚ã€‚ æœ‰20ä¸ªç²’åº¦çš„è¯„ä»·æŒ‡æ ‡ï¼Œæ¯ä¸ªç²’åº¦åˆæœ‰4ç§æƒ…æ„ŸçŠ¶æ€ï¼Œä»å®˜æ–¹baselineæ¥çœ‹ï¼Œåˆ†åˆ«è®­ç»ƒäº†20ä¸ªï¼ˆ4æ ‡ç­¾ï¼‰åˆ†ç±»å™¨ã€‚ FastTextï¼ˆ0.573ï¼‰ã€Attention-RNN (0.637)ã€Attention-RCNN (0.669)ã€ELMO-likeï¼ˆ0.68830ï¼‰ 1. FastText baseline skiftï¼šscikit-learn wrappers for Python fastText. ä»€ä¹ˆæ˜¯ skift? skift åŒ…æ‹¬å‡ ä¸ª scikit-learnå…¼å®¹åŒ…è£å™¨, å°è£äº†fasttextæ¨¡å‹ï¼ŒfasttextåŸç†ç±»ä¼¼word2vecï¼Œä¸»è¦ç”¨äºæ–‡æœ¬å¿«é€Ÿåˆ†ç±»ã€‚å…¶ä¼˜åŠ¿åœ¨äºåˆ†ç±»é€Ÿåº¦å¿«ï¼Œä½¿ç”¨n-gram ç‰¹åˆ«å®¹æ˜“è·å¾—æ–‡æœ¬å¥å­å±€éƒ¨ä¿¡æ¯ã€æ„é€ æ–°è©ã€‚ fasttext ç¼ºç‚¹æ˜¯éšç€è¯­æ–™çš„å¢é•¿ï¼Œå…§å­˜éœ€æ±‚ä¹Ÿä¼šå¢é•¿ã€‚é‚£ä¹ˆå¦‚æœè§£æ±ºå…§å­˜é—®é¢˜å‘¢ï¼Ÿ è¿‡æ»¤æ‰æ¬¡æ•°å‡ºç°å°‘çš„è¯ï¼› é‡‡ç”¨wordç²’åº¦ï¼Œè€Œécharç²’åº¦ ä¾‹å¦‚å¥å­: æˆ‘å–œæ­¡å»ä¸­åœ‹ï¼Œ å¦‚æœæ¡ç”¨charç²’åº¦ï¼Œå‰‡ä½¿ç”¨2-gramçš„è©±ï¼Œç”¢ç”Ÿçš„ç‰¹å¾µçˆ²: æˆ‘å–œ å–œæ­¡ æ­¡ä¸­ ä¸­åœ‹ å¦‚æœæ¡ç”¨wordç²’åº¦çš„è©±ï¼Œç”¢ç”Ÿçš„ç‰¹å¾µçˆ² æˆ‘å–œæ­¡ å–œæ­¡å» å»ä¸­åœ‹ åˆ©ç”¨skiftå¯¦ç¾fasttextæ¨¡å‹ FastTextæ–‡æœ¬åˆ†ç±»ä»¥åŠç”Ÿæˆè¯å‘é‡ æç®€ä½¿ç”¨ï¸±Gensim-FastText è¯å‘é‡è®­ç»ƒä»¥åŠOOV fastTextåŸç†å’Œæ–‡æœ¬åˆ†ç±»å®æˆ˜ï¼Œçœ‹è¿™ä¸€ç¯‡å°±å¤Ÿäº† é»˜è®¤é…ç½®å‚æ•°è®­ç»ƒ fasttext å¤šæ¨¡å‹ï¼Œf1å‡å€¼ çº¦ä¸º 0.5513 çš„ fasttext å¤šåˆ†ç±»æ¨¡å‹(20ä¸ªï¼‰ 1.1 æ•°æ®æƒ…å†µè®°å½•fastText æ—¶å€™ï¼Œ è¯çš„ç²’åº¦ jieba åˆ†è¯ å»ºç«‹è¯å…¸æ—¶ï¼Œè¿‡æ»¤æ‰å‡ºç°æ¬¡æ•°å°äº 2~5 çš„è¯ è®­ç»ƒé›†ã€éªŒè¯é›† ä»¥åŠ æµ‹è¯•é›†Aç»„æˆçš„è¯­æ–™ï¼Œè¯å…¸å¤§å°ä¸º 66347 é¢„æµ‹å’Œè®­ç»ƒæ—¶ï¼Œè¯å…¸æ²¡æœ‰å‡ºç°çš„è¯ ç”¨ &lt;UNK&gt; ä»£æ›¿ 1.2 main codeåˆ©ç”¨è®­ç»ƒé›†ï¼Œæ¥è®­ç»ƒ 20 ä¸ª 4åˆ†ç±» åˆ†ç±»å™¨, è®­ç»ƒ 15 åˆ†é’Ÿ sk_clf = FirstColFtClassifier(lr=learning_rate, epoch=epoch, wordNgrams=word_ngrams, minCount=min_count, verbose=2)sk_clf.fit(train_data_format, train_label) min_countè®¾ç½®ä¸º2è²Œä¼¼ä¹Ÿæœ‰ä¸€äº›è´Ÿå‘å½±å“ï¼Œ word_ngrams 2ï¼Œ epoch 10 . 1.3 baseline æ•ˆæœservice_wait_time:0.5247890022873511service_waiters_attitude:0.6781093513108542service_parking_convenience:0.5828932335474249service_serving_speed:0.6146828053320519......f1_score: 0.5513 è°ƒå‚ï¼š python main_train.py -mn fasttext_model_wn2.pkl -wn 2 çº¦è·‘15åˆ†é’Ÿå·¦å³ï¼Œå­˜å‚¨çš„æ¨¡å‹å¤§çº¦åœ¨17Gï¼ŒéªŒè¯é›† macro F1å€¼ç»“æœå¦‚ä¸‹ï¼š service_wait_time:0.5247890022873511service_waiters_attitude:0.6881098513108542service_parking_convenience:0.5828935095474249service_serving_speed:0.6168828054420539...f1_score: 0.5783 è¿™ä¸ªç»“æœçœ‹èµ·æ¥è¿˜ä¸é”™ï¼Œæˆ‘ä»¬å¯ä»¥åŸºäºè¿™ä¸ªfasttextå¤šåˆ†ç±»æ¨¡å‹è¿›è¡Œæµ‹è¯•é›†çš„é¢„æµ‹ï¼š python main_predict.py -mn fasttext_wn2_model.pkl ä¼˜åŒ–æ–¹æ³•ï¼š å»åœç”¨è¯å’Œå»ä¸€äº›æ ‡ç‚¹ç¬¦å·ï¼Œè°ƒå‚ï¼Œlearning_rateçš„å½±å“æ˜¯æ¯”è¾ƒç›´æ¥çš„ï¼Œmin_count 1.4 fastText é€Ÿåº¦å¿«èƒ½å¤Ÿåšåˆ°æ•ˆæœå¥½ï¼Œé€Ÿåº¦å¿«ï¼Œä¸»è¦ä¾é ä¸¤ä¸ªç§˜å¯†æ­¦å™¨ï¼š åˆ©ç”¨äº† è¯å†…çš„n-gramä¿¡æ¯ (subword n-gram information) ç”¨åˆ°äº† å±‚æ¬¡åŒ–Softmaxå›å½’ (Hierarchical Softmax) çš„è®­ç»ƒ trick. 2. Attention RNNã€RCNN2.1 é¢„å¤„ç† dataç²—æš´ä½¿ç”¨charæ¨¡å‹ï¼Œç”¨åˆ°çš„åœç”¨è¯ä¹Ÿä¸å¤šã€‚ trainsets linesï¼š 501132ï¼Œ åˆæ³•ä¾‹å­ ï¼š 105000 validationset linesï¼š 70935, åˆæ³•ä¾‹å­ ï¼š 15000 testsets linesï¼š 72028ï¼Œ åˆæ³•ä¾‹å­ ï¼š 15000 æ•°æ®é¢„å¤„ç†ï¼Œç”Ÿæˆ train_char.csvã€test_char.csvã€test_char.csv ä¸‰ä¸ªæ–‡ä»¶: -rw-r--r-- 1 blair 10:36 test_char.csv-rw-r--r-- 1 blair 10:09 train_char.csv-rw-r--r-- 1 blair 10:32 validation_char.csv word2vecï¼š ç»´åº¦ 100ï¼Œ çª—å£ 10ï¼Œ è¿‡æ»¤æ‰æ¬¡æ•°å°äº 1~2 çš„å­— 3.1M chars.vector è¿‡æ»¤æ‰ä½é¢‘è¯ä¹‹åï¼š word2vec/chars.vector ä¸º 7983 * 100 2.2 Attention RCNN Attention-RNN (0.637)ã€Attention-RCNN (0.669) Attention å‚è€ƒè‡ª Kaggle çš„ Attention Model Kaggle å¸¸è§æ–‡æœ¬åˆ†ç±»ç»“æ„: 2å±‚GRU æ¥Attentionå±‚ï¼Œç„¶åå’Œ avgpoolã€maxpool concat æ¥èµ·æ¥. def model(self, embeddings_matrix, maxlen, word_index, num_class): ä¸ºäº†ä¹‹å summary çœ‹æ¸…æ¥šç½‘ç»œç»“æ„ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸€äº›å‚æ•°å…ˆå†™æ­»çœ‹ä¸€ä¸‹ï¼š import kerasfrom keras import Modelfrom keras.layers import *# from JoinAttLayer import Attentionmaxlen=1200inp = Input(shape=(maxlen,)) # å½“è¾“å…¥åºåˆ—çš„é•¿åº¦å›ºå®šæ—¶ï¼Œè¯¥å€¼ä¸ºå…¶é•¿åº¦ 1200 ï¼ˆä¸€ä¸ªæ–‡æ¡£docçš„æœ€å¤§é•¿åº¦ï¼‰encode = Bidirectional(CuDNNGRU(128, return_sequences=True))encode2 = Bidirectional(CuDNNGRU(128, return_sequences=True))# attention = Attention(maxlen)x_4 = Embedding(7555+ 1,#7983+1 # è¯æ±‡è¡¨å¤§å°ï¼Œ å³ï¼Œæœ€å¤§æ•´æ•° index + 1, len(word_index) + 1, # input_dim 100, # output_dim: int &gt;= 0ã€‚è¯å‘é‡çš„ç»´åº¦ã€‚ input_length=maxlen, # maxlen=1200, ä¸€ä¸ª doc æœ€å¤§é•¿åº¦ trainable=True)(inp) æ¥ä¸‹æ¥ï¼š x_3 = encode(x_4)x_3 = encode2(x_3)# è¾“å…¥shapeï¼Œ å½¢å¦‚ï¼ˆsamplesï¼Œstepsï¼Œfeaturesï¼‰çš„3Då¼ é‡# è¾“å‡ºshapeï¼Œ å½¢å¦‚(samples, features)çš„2Då¼ é‡avg_pool_3 = GlobalAveragePooling1D()(x_3) # GlobalAveragePooling1D ä¸ºæ—¶åŸŸä¿¡å·æ–½åŠ å…¨å±€å¹³å‡å€¼æ± åŒ–max_pool_3 = GlobalMaxPooling1D()(x_3) # å¯¹äºæ—¶é—´ä¿¡å·çš„å…¨å±€æœ€å¤§æ± åŒ–# attention_3 = attention(x_3)x = keras.layers.concatenate([avg_pool_3, max_pool_3], name=&quot;fc&quot;)x = Dense(4, activation=&quot;softmax&quot;)(x)adam = keras.optimizers.Adam(lr=0.001, beta_1=0.9, beta_2=0.999, epsilon=1e-08, amsgrad=True)rmsprop = keras.optimizers.RMSprop(lr=0.001, rho=0.9, epsilon=1e-06)model = Model(inputs=inp, outputs=x)model.compile( loss=&#x27;categorical_crossentropy&#x27;, optimizer=adam)# categorical_crossentropy ç”¨æ¥åšå¤šåˆ†ç±»é—®é¢˜# binary_crossentropy ç”¨æ¥åšå¤šæ ‡ç­¾åˆ†ç±»é—®é¢˜model.summary() RNNï¼š RCNNï¼š x_4 = Embedding(7555+ 1,#7983+1 # è¯æ±‡è¡¨å¤§å°ï¼Œ å³ï¼Œæœ€å¤§æ•´æ•° index + 1 100, input_length=maxlen, trainable=True)(inp)x_3 = encode(x_4)x_3 = encode2(x_3)x_3 = Conv1D(64, kernel_size=3, padding=&quot;valid&quot;, kernel_initializer=&quot;glorot_uniform&quot;)(x_3)# è¾“å…¥shapeï¼Œ å½¢å¦‚ï¼ˆsamplesï¼Œstepsï¼Œfeaturesï¼‰çš„3Då¼ é‡# è¾“å‡ºshapeï¼Œ å½¢å¦‚(samples, features)çš„2Då¼ é‡avg_pool_3 = GlobalAveragePooling1D()(x_3) # GlobalAveragePooling1D ä¸ºæ—¶åŸŸä¿¡å·æ–½åŠ å…¨å±€å¹³å‡å€¼æ± åŒ–max_pool_3 = GlobalMaxPooling1D()(x_3) # å¯¹äºæ—¶é—´ä¿¡å·çš„å…¨å±€æœ€å¤§æ± åŒ–# attention_3 = attention(x_3)x = keras.layers.concatenate([avg_pool_3, max_pool_3], name=&quot;fc&quot;)x = Dense(4, activation=&quot;softmax&quot;)(x)...model.summary() Input ä¸€ä¸ªç½‘ç»œå±‚æ¬¡ï¼Œè¾“å…¥å±‚ åœ¨ keras SpatialDropout1D ï¼Œé‚£ä¹ˆå¸¸è§„çš„ dropout å°†æ— æ³•ä½¿æ¿€æ´»æ­£åˆ™åŒ–ï¼Œä¸”å¯¼è‡´æœ‰æ•ˆçš„å­¦ä¹ é€Ÿç‡é™ä½ã€‚SpatialDropout1D ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒSpatialDropout1D å°†æœ‰åŠ©äºæé«˜ç‰¹å¾å›¾ä¹‹é—´çš„ç‹¬ç«‹æ€§ï¼Œåº”è¯¥ä½¿ç”¨å®ƒæ¥ä»£æ›¿ Dropoutã€‚ CuDNNGRU æ˜¯ åŸºäºCuDNNçš„å¿«é€ŸGRUå®ç°ï¼Œåªèƒ½åœ¨GPUä¸Šè¿è¡Œï¼Œåªèƒ½ä½¿ç”¨ tensoflow ä¸ºåç«¯CuDNNLSTM æ˜¯ åŸºäºCuDNNçš„å¿«é€ŸLSTMå®ç°ï¼Œåªèƒ½åœ¨GPUä¸Šè¿è¡Œï¼Œåªèƒ½ä½¿ç”¨ tensoflow ä¸ºåç«¯ attention = Attention(maxlen) EmbeddingåµŒå…¥å±‚å°†æ­£æ•´æ•°ï¼ˆä¸‹æ ‡ï¼‰è½¬æ¢ä¸ºå…·æœ‰å›ºå®šå¤§å°çš„å‘é‡ï¼Œå¦‚[4, [20]]-&gt;[[0.25, 0.1], [0.6, -0.2]] keras.layers.embeddings.Embedding( input_dim, output_dim, embeddings_initializer=&#x27;uniform&#x27;, # embeddings_regularizer=None, activity_regularizer=None, # embeddings_constraint=None, mask_zero=False, input_length=None) Embedding çš„ä¸€äº›å‚æ•°è§£é‡Šï¼š Embeddingå±‚åªèƒ½ä½œä¸ºæ¨¡å‹çš„ç¬¬ä¸€å±‚ input_dim: int &gt; 0ã€‚è¯æ±‡è¡¨å¤§å°ï¼Œ å³ï¼Œæœ€å¤§æ•´æ•° index + 1ã€‚output_dim: int &gt;= 0ã€‚è¯å‘é‡çš„ç»´åº¦ã€‚embeddings_initializer: åµŒå…¥çŸ©é˜µçš„åˆå§‹åŒ–æ–¹æ³•ï¼Œä¸ºé¢„å®šä¹‰åˆå§‹åŒ–æ–¹æ³•åçš„å­—ç¬¦ä¸²ï¼Œæˆ–ç”¨äºåˆå§‹åŒ–æƒé‡çš„åˆå§‹åŒ–å™¨ã€‚å‚è€ƒinitializersinput_lengthï¼šå½“è¾“å…¥åºåˆ—çš„é•¿åº¦å›ºå®šæ—¶ï¼Œè¯¥å€¼ä¸ºå…¶é•¿åº¦ã€‚å¦‚æœè¦åœ¨è¯¥å±‚åæ¥Flattenå±‚ï¼Œç„¶åæ¥Denseå±‚ï¼Œåˆ™å¿…é¡»æŒ‡å®šè¯¥å‚æ•°ï¼Œå¦åˆ™Denseå±‚çš„è¾“å‡ºç»´åº¦æ— æ³•è‡ªåŠ¨æ¨æ–­ã€‚ Convolutional Neural Networks (week1) - CNN , è¿ç”¨ PaddingTensorFlowä¸­CNNçš„ä¸¤ç§paddingæ–¹å¼â€œSAMEâ€å’Œâ€œVALIDâ€ word2vec : 7983 100 word2vec/chars.vector è¿‡æ»¤æ‰ä½é¢‘è¯ å¾ªç¯å·ç§¯ç¥ç»ç½‘ç»œ(RCNN)ï¼Œå¹¶å°†å…¶åº”ç”¨äºæ–‡æœ¬åˆ†ç±»çš„ä»»åŠ¡ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬åº”ç”¨ä¸€ä¸ªåŒå‘çš„å¾ªç¯ç»“æ„ï¼Œä¸ä¼ ç»Ÿçš„åŸºäºçª—å£çš„ç¥ç»ç½‘ç»œç›¸æ¯”ï¼Œå®ƒå¯ä»¥å¤§å¤§å‡å°‘å™ªå£°ï¼Œä»è€Œæœ€å¤§ç¨‹åº¦åœ°æ•æ‰ä¸Šä¸‹æ–‡ä¿¡æ¯ã€‚æ­¤å¤–ï¼Œè¯¥æ¨¡å‹åœ¨å­¦ä¹ æ–‡æœ¬è¡¨ç¤ºæ—¶å¯ä»¥ä¿ç•™æ›´å¤§èŒƒå›´çš„è¯åºã€‚å…¶æ¬¡ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†ä¸€ä¸ªå¯ä»¥è‡ªåŠ¨åˆ¤æ–­å“ªäº›ç‰¹æ€§åœ¨æ–‡æœ¬åˆ†ç±»ä¸­æ‰®æ¼”å…³é”®è§’è‰²çš„æ± åŒ–å±‚ï¼Œä»¥æ•è·æ–‡æœ¬ä¸­çš„å…³é”®ç»„ä»¶ã€‚æˆ‘ä»¬çš„æ¨¡å‹ç»“åˆäº†RNNçš„ç»“æ„å’Œæœ€å¤§æ± åŒ–å±‚ï¼Œåˆ©ç”¨äº†å¾ªç¯ç¥ç»æ¨¡å‹å’Œå·ç§¯ç¥ç»æ¨¡å‹çš„ä¼˜ç‚¹ã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬çš„æ¨¡å‹æ˜¾ç¤ºäº†O(n)çš„æ—¶é—´å¤æ‚åº¦ï¼Œå®ƒä¸æ–‡æœ¬é•¿åº¦çš„é•¿åº¦æ˜¯çº¿æ€§ç›¸å…³çš„ã€‚ RNN ä¼˜ç‚¹ï¼š æœ€å¤§ç¨‹åº¦æ•æ‰ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼Œè¿™å¯èƒ½æœ‰åˆ©äºæ•è·é•¿æ–‡æœ¬çš„è¯­ä¹‰ã€‚ RNN ç¼ºç‚¹ï¼š æ˜¯ä¸€ä¸ªæœ‰åå€šçš„æ¨¡å‹ï¼Œåœ¨è¿™ä¸ªæ¨¡å‹ä¸­ï¼Œåé¢çš„å•è¯æ¯”å…ˆå‰çš„å•è¯æ›´å…·ä¼˜åŠ¿ã€‚å› æ­¤ï¼Œå½“å®ƒè¢«ç”¨äºæ•è·æ•´ä¸ªæ–‡æ¡£çš„è¯­ä¹‰æ—¶ï¼Œå®ƒå¯èƒ½ä¼šé™ä½æ•ˆç‡ï¼Œå› ä¸ºå…³é”®ç»„ä»¶å¯èƒ½å‡ºç°åœ¨æ–‡æ¡£ä¸­çš„ä»»ä½•åœ°æ–¹ï¼Œè€Œä¸æ˜¯æœ€åã€‚ CNN ä¼˜ç‚¹ï¼š æå–æ•°æ®ä¸­çš„å±€éƒ¨ä½ç½®çš„ç‰¹å¾ï¼Œç„¶åå†æ‹¼æ¥æ± åŒ–å±‚ã€‚ CNNå¯ä»¥æ›´å¥½åœ°æ•æ‰æ–‡æœ¬çš„è¯­ä¹‰ã€‚æ˜¯O(n) CNN ä¼˜ç‚¹ï¼š ä¸€ä¸ªå¯ä»¥è‡ªåŠ¨åˆ¤æ–­å“ªäº›ç‰¹æ€§åœ¨æ–‡æœ¬åˆ†ç±»ä¸­æ‰®æ¼”å…³é”®è§’è‰²çš„æ± åŒ–å±‚ï¼Œä»¥æ•è·æ–‡æœ¬ä¸­çš„å…³é”®ç»„ä»¶ã€‚ é¦–å…ˆæˆ‘ä»¬æ¥ç†è§£ä¸‹ä»€ä¹ˆæ˜¯å·ç§¯æ“ä½œï¼Ÿå·ç§¯ï¼Œä½ å¯ä»¥æŠŠå®ƒæƒ³è±¡æˆä¸€ä¸ªåº”ç”¨åœ¨çŸ©é˜µä¸Šçš„æ»‘åŠ¨çª—å£å‡½æ•°ã€‚ å·ç§¯ç½‘ç»œä¹Ÿå°±æ˜¯å¯¹è¾“å…¥æ ·æœ¬è¿›è¡Œå¤šæ¬¡å·ç§¯æ“ä½œï¼Œæå–æ•°æ®ä¸­çš„å±€éƒ¨ä½ç½®çš„ç‰¹å¾ï¼Œç„¶åå†æ‹¼æ¥æ± åŒ–å±‚ï¼ˆå›¾ä¸­çš„Poolingå±‚ï¼‰åšè¿›ä¸€æ­¥çš„é™ç»´æ“ä½œ æˆ‘ä»¬å¯ä»¥æŠŠCNNç±»æ¯”N-gramæ¨¡å‹ï¼ŒN-gramä¹Ÿæ˜¯åŸºäºè¯çª—èŒƒå›´è¿™ç§å±€éƒ¨çš„æ–¹å¼å¯¹æ–‡æœ¬è¿›è¡Œç‰¹å¾æå–ï¼Œä¸CNNçš„åšæ³•å¾ˆç±»ä¼¼ è‡ªç„¶è¯­è¨€å¤„ç†ç³»åˆ—ï¼ˆ8ï¼‰ï¼šRCNN Kerasä¹‹æ–‡æœ¬åˆ†ç±»å®ç° from keras.backend.tensorflow_backend import set_sessionimport tensorflow as tfconfig = tf.ConfigProto()config.gpu_options.allow_growth = Trueset_session(tf.Session(config=config))import randomrandom.seed = 42import pandas as pdfrom tensorflow import set_random_seedset_random_seed(42)from keras.preprocessing import text, sequencefrom keras.callbacks import ModelCheckpoint, Callbackfrom sklearn.metrics import f1_score, recall_score, precision_scorefrom keras.layers import *from classifier_bigru import TextClassifierfrom gensim.models.keyedvectors import KeyedVectorsimport pickleimport gc 2.3 loss functionå¤šåˆ†ç±»å’Œå¤šæ ‡ç­¾åˆ†ç±», gensimè®­ç»ƒword2vecåŠç›¸å…³å‡½æ•° å¤šåˆ†ç±»ï¼šç±»åˆ«æ•°ç›®å¤§äº2ä¸ªï¼Œç±»åˆ«ä¹‹é—´æ˜¯äº’æ–¥çš„ã€‚æ¯”å¦‚æ˜¯çŒ«ï¼Œå°±ä¸èƒ½æ˜¯ç‹—ã€çŒªcategorical crossentropy ç”¨æ¥åšå¤šåˆ†ç±»é—®é¢˜binary crossentropy ç”¨æ¥åšå¤šæ ‡ç­¾åˆ†ç±»é—®é¢˜ sigmoid,softmax,binary/categorical crossentropyçš„è”ç³»ï¼Ÿ Binary cross-entropy å¸¸ç”¨äºäºŒåˆ†ç±»é—®é¢˜ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥ç”¨äºå¤šåˆ†ç±»é—®é¢˜ï¼Œé€šå¸¸éœ€è¦åœ¨ç½‘ç»œçš„æœ€åä¸€å±‚æ·»åŠ sigmoidè¿›è¡Œé…åˆä½¿ç”¨ Categorical cross-entropy é€‚ç”¨äºå¤šåˆ†ç±»é—®é¢˜ï¼Œå¹¶ä½¿ç”¨softmaxä½œä¸ºè¾“å‡ºå±‚çš„æ¿€æ´»å‡½æ•°çš„æƒ…å†µã€‚ 2.4 Early Stopéœ€è¦åœ¨æ¯ä¸ª epoch ç»“æŸä¹‹åå»è®¡ç®—æ¨¡å‹çš„ F1 å€¼ï¼Œè¿™æ ·å¯ä»¥æ›´å¥½çš„æŒæ¡æ¨¡å‹çš„è®­ç»ƒæƒ…å†µã€‚ Tips å¦‚æœæˆ‘ä»¬åœ¨è®­ç»ƒä¸­è®¾ç½® metric çš„è¯ï¼Œå¾—åˆ°æ˜¯æ¯ä¸ª batch çš„ F1 å€¼, æ˜¯ä¸é è°±çš„. ç±»ä¼¼è¿™æ ·: def getClassification(arr): arr = list(arr) if arr.index(max(arr)) == 0: return -2 elif arr.index(max(arr)) == 1: return -1 elif arr.index(max(arr)) == 2: return 0 else: return 1class Metrics(Callback): def on_train_begin(self, logs=&#123;&#125;): self.val_f1s = [] self.val_recalls = [] self.val_precisions = [] def on_epoch_end(self, epoch, logs=&#123;&#125;): ... return early_stopï¼Œå°±æ˜¯åœ¨è®­ç»ƒæ¨¡å‹çš„æ—¶å€™ï¼Œå½“åœ¨éªŒè¯é›†ä¸Šæ•ˆæœä¸å†æå‡çš„æ—¶å€™ï¼Œå°±æå‰åœæ­¢è®­ç»ƒï¼ŒèŠ‚çº¦æ—¶é—´ã€‚ 2.6 Max Length (padding) æ‰€æœ‰è¯„è®ºå¹³å‡çš„é•¿åº¦æ˜¯ 200 å·¦å³ï¼Œmax_length å– 2 * 200ï¼Œæ•ˆæœä¸€ç›´ä¸ç»™åŠ›. å°† max_length æ”¹ä¸º 1200 ï¼Œmacro f-score æ•ˆæœæ˜æ˜¾æå‡ Tipsï¼š å¤šåˆ†ç±»é—®é¢˜ä¸­ï¼Œé‚£äº›é•¿åº¦å¾ˆé•¿çš„è¯„è®ºå¯èƒ½ä¼šæœ‰éƒ¨åˆ†å±äºé‚£äº›æ ·æœ¬æ•°å¾ˆå°‘çš„ç±»åˆ«ï¼Œpaddingè¿‡çŸ­ä¼šå¯¼è‡´è¿™äº›é•¿è¯„è®ºæ— æ³•è¢«æ­£ç¡®åˆ’åˆ†ã€‚ 3. ELMO-Like ï¼ˆè…¾è®¯è¯å‘é‡ 16Gï¼Œ 800W * 200 = 5W * 200 + è‡ªè®­è¯å‘ 5W * 128 ï¼‰ + BiGRU ä¸­å±‚è¯­ä¹‰ + BiGRU é«˜å±‚è¯­ä¹‰ 10W+ æ•°æ®é›†ï¼Œè¯é¢‘å‰5Wçš„è¯, æ¯ä¸ªè¯„è®ºä¸€ä¸ª epoch è¾“å…¥1æ¬¡ï¼Œ å‚æ•°å…±äº« 328 + 256 + 256 è¿‘1000ç»´åº¦ï¼ŒBatch 128ï¼Œ 512ç»´åº¦çš„æ—¶å€™ï¼ŒBatch 256 å¯ä»¥æ”¾å¾—ä¸‹. æœºå™¨é…ç½®ï¼š 32G å†…å­˜ï¼Œ i9 CPUï¼Œ æ˜¾å¡å‹å· 1080ï¼Œ æ˜¾å­˜8G å¤šä»»åŠ¡å­¦ä¹  åˆ†åˆ«è®­ç»ƒ20ä¸ªåˆ†ç±»æ¨¡å‹çš„è®¡ç®—å¤æ‚åº¦è¾ƒé«˜ 20ä¸ªåˆ†ç±»æ¨¡å‹å ç”¨å­˜å‚¨ç©ºé—´ å¤šä»»åŠ¡å­¦ä¹ å¯ä»¥é€šè¿‡ç‰¹å¾å…±äº«é™ä½è¿‡æ‹Ÿåˆé£é™© epoch ä¸€æ¬¡è¾“å…¥ä¸€ä¸ªBatch=128æ¡è¯„è®ºï¼Œ20ä¸ªå±æ€§éƒ½4åˆ†ç±»æˆåŠŸï¼Œ 1 ä¸ª epochï¼Œ 1200ç§’=20å¤šåˆ†é’Ÿ æ¯ä¸ªè¯„è®ºä¸€ä¸ª epoch è¾“å…¥1æ¬¡ï¼Œ å‚æ•°å…±äº« maxLen 500 å·¦å³ 1.5W è·‘ä¸€æ¬¡æµ‹è¯•é›† 1~2 åˆ†é’Ÿ.20W, è·‘ä¸€æ¬¡æµ‹è¯•é›† 10å¤šåˆ†é’Ÿ å·¦å³ 4. Summary RNN ä¼˜ç‚¹ï¼š æœ€å¤§ç¨‹åº¦æ•æ‰ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼Œè¿™å¯èƒ½æœ‰åˆ©äºæ•è·é•¿æ–‡æœ¬çš„è¯­ä¹‰ã€‚ RNN ç¼ºç‚¹ï¼š æ˜¯ä¸€ä¸ªæœ‰åå€šçš„æ¨¡å‹ï¼Œåœ¨è¿™ä¸ªæ¨¡å‹ä¸­ï¼Œåé¢çš„å•è¯æ¯”å…ˆå‰çš„å•è¯æ›´å…·ä¼˜åŠ¿ã€‚å› æ­¤ï¼Œå½“å®ƒè¢«ç”¨äºæ•è·æ•´ä¸ªæ–‡æ¡£çš„è¯­ä¹‰æ—¶ï¼Œå®ƒå¯èƒ½ä¼šé™ä½æ•ˆç‡ï¼Œå› ä¸ºå…³é”®ç»„ä»¶å¯èƒ½å‡ºç°åœ¨æ–‡æ¡£ä¸­çš„ä»»ä½•åœ°æ–¹ï¼Œè€Œä¸æ˜¯æœ€åã€‚ CNN ä¼˜ç‚¹ï¼š æå–æ•°æ®ä¸­çš„å±€éƒ¨ä½ç½®çš„ç‰¹å¾ï¼Œç„¶åå†æ‹¼æ¥æ± åŒ–å±‚ã€‚ CNNå¯ä»¥æ›´å¥½åœ°æ•æ‰æ–‡æœ¬çš„è¯­ä¹‰ã€‚æ˜¯O(n) CNN ä¼˜ç‚¹ï¼š ä¸€ä¸ªå¯ä»¥è‡ªåŠ¨åˆ¤æ–­å“ªäº›ç‰¹æ€§åœ¨æ–‡æœ¬åˆ†ç±»ä¸­æ‰®æ¼”å…³é”®è§’è‰²çš„æ± åŒ–å±‚ï¼Œä»¥æ•è·æ–‡æœ¬ä¸­çš„å…³é”®ç»„ä»¶ã€‚ åœ¨æ–‡æœ¬åˆ†ç±»ä»»åŠ¡ä¸­ï¼Œæœ‰å“ªäº›å¯¹æ€§èƒ½æœ‰é‡è¦å½±å“çš„tricksï¼Ÿ æ•°æ®é¢„å¤„ç†æ—¶vocabçš„é€‰å–ï¼ˆå‰Nä¸ªé«˜é¢‘è¯æˆ–è€…è¿‡æ»¤æ‰å‡ºç°æ¬¡æ•°å°äº3çš„è¯ç­‰ç­‰ï¼‰ è¯å‘é‡çš„é€‰æ‹©ï¼Œå¯ä»¥ä½¿ç”¨é¢„è®­ç»ƒå¥½çš„è¯å‘é‡å¦‚è°·æ­Œã€facebookå¼€æºå‡ºæ¥çš„ï¼Œå½“è®­ç»ƒé›†æ¯”è¾ƒå¤§çš„æ—¶å€™ä¹Ÿå¯ä»¥è¿›è¡Œå¾®è°ƒæˆ–è€…éšæœºåˆå§‹åŒ–ä¸è®­ç»ƒåŒæ—¶è¿›è¡Œã€‚è®­ç»ƒé›†è¾ƒå°æ—¶å°±åˆ«å¾®è°ƒäº† ç»“åˆè¦ä½¿ç”¨çš„æ¨¡å‹ï¼Œè¿™é‡Œå¯ä»¥æŠŠæ•°æ®å¤„ç†æˆcharã€wordæˆ–è€…éƒ½ç”¨ç­‰ æœ‰æ—¶å°†è¯æ€§æ ‡æ³¨ä¿¡æ¯ä¹ŸåŠ å…¥è®­ç»ƒæ•°æ®ä¼šæ”¶åˆ°æ¯”è¾ƒå¥½çš„æ•ˆæœ è‡³äºPADçš„è¯ï¼Œå–å‡å€¼æˆ–è€…ä¸€ä¸ªç¨å¾®æ¯”è¾ƒå¤§çš„æ•°ï¼ˆæ¯”è¾ƒå¤§çš„å€¼ï¼Œè´¹ç‚¹ç©ºé—´ï¼Œè°¨æ…ä½¿ç”¨ï¼‰ ç¥ç»ç½‘ç»œç»“æ„çš„è¯åˆ°æ²¡æœ‰ä»€ä¹ˆè¦è¯´çš„ï¼ŒåŠ ä¸Šdropoutå’ŒBNå¯èƒ½ä¼šæ›´å¥½ã€‚æ¨¡å‹è¿™å—è¿˜æ˜¯è¦å…·ä½“é—®é¢˜å…·ä½“åˆ†æå§. æ–‡æœ¬é¢†åŸŸç”¨è¿‡æ•°æ®å¢å¼ºçš„æ–¹æ³•ï¼Œå°±æ˜¯å¯¹æ–‡æœ¬è¿›è¡Œéšæœºçš„shuffleå’Œdropç­‰æ“ä½œæ¥å¢åŠ æ•°æ®é‡ Reference æ·±åº¦å­¦ä¹ ä¸æ–‡æœ¬åˆ†ç±»æ€»ç»“ç¬¬ä¸€ç¯‡â€”å¸¸ç”¨æ¨¡å‹æ€»ç»“ ç”¨æ·±åº¦å­¦ä¹ ï¼ˆCNN RNN Attentionï¼‰è§£å†³å¤§è§„æ¨¡æ–‡æœ¬åˆ†ç±»é—®é¢˜ - ç»¼è¿°å’Œå®è·µ ä¸¥é‡æ•°æ®å€¾æ–œæ–‡æœ¬åˆ†ç±»ï¼Œæ¯”å¦‚æ­£åæ¯”1:20ï½100ï¼Œé€‚åˆä»€ä¹ˆmodel ç¬¬16åè§£å†³æ–¹æ¡ˆã€ ç¬¬17åè§£å†³æ–¹æ¡ˆã€ åŸºäºBertçš„å°è¯• ai-challenger-2018-æ–‡æœ¬æŒ–æ˜ç±»ç«èµ›ç›¸å…³è§£å†³æ–¹æ¡ˆåŠä»£ç æ±‡æ€» QAé—®ç­”ç³»ç»Ÿä¸­çš„æ·±åº¦å­¦ä¹ æŠ€æœ¯å®ç° æ·±åº¦å­¦ä¹ ä»£ç å¤ç°ä¹‹å‡å°‘éšæœºæ€§çš„å½±å“","categories":[{"name":"chatbot","slug":"chatbot","permalink":"http://iequa.com/categories/chatbot/"}],"tags":[{"name":"chatbot","slug":"chatbot","permalink":"http://iequa.com/tags/chatbot/"}]},{"title":"User Credit Score","slug":"datascience/credit-score","date":"2019-06-23T05:28:21.000Z","updated":"2021-06-14T05:16:52.522Z","comments":true,"path":"2019/06/23/datascience/credit-score/","link":"","permalink":"http://iequa.com/2019/06/23/datascience/credit-score/","excerpt":"","text":"Credit Score Card ä¿¡ç”¨è¯„åˆ†å¡æ¨¡å‹æ˜¯æœ€å¸¸è§çš„é‡‘èé£æ§æ‰‹æ®µä¹‹ä¸€ï¼Œå®ƒæ˜¯æŒ‡æ ¹æ®å®¢æˆ·çš„å„ç§å±æ€§å’Œè¡Œä¸ºæ•°æ®ï¼Œåˆ©ç”¨ä¸€å®šçš„ä¿¡ç”¨è¯„åˆ†æ¨¡å‹ï¼Œå¯¹å®¢æˆ·è¿›è¡Œä¿¡ç”¨è¯„åˆ†ï¼Œæ®æ­¤å†³å®šæ˜¯å¦ç»™äºˆæˆä¿¡ä»¥åŠæˆä¿¡çš„é¢åº¦å’Œåˆ©ç‡ï¼Œä»è€Œè¯†åˆ«å’Œå‡å°‘åœ¨é‡‘èäº¤æ˜“ä¸­å­˜åœ¨çš„äº¤æ˜“é£é™©ã€‚ æŒ‰ç…§å€Ÿè´·ç”¨æˆ·çš„å€Ÿè´·æ—¶é—´ï¼Œè¯„åˆ†å¡æ¨¡å‹å¯ä»¥åˆ’åˆ†ä¸ºä»¥ä¸‹ä¸‰ç§ï¼š è´·å‰ï¼š Application score cardï¼Œ åˆç§°ä¸ºAå¡ è´·ä¸­ï¼š Behavior score cardï¼Œ åˆç§°ä¸ºBå¡ è´·åï¼š Collection score cardï¼Œ åˆç§°ä¸ºCå¡ ç”³è¯·è¯„åˆ†å¡è¦æ±‚æœ€ä¸ºä¸¥æ ¼ï¼Œä¹Ÿæœ€ä¸ºé‡è¦ï¼Œå¯è§£é‡Šæ€§ä¹Ÿè¦æ±‚æœ€å¼ºï¼Œä¸€èˆ¬ä¸»æµæ¨¡å‹ä¸º LR. å¦‚éœ€äº†è§£æ›´å¤šå…³äº äº’è”ç½‘é‡‘èé£æ§ çš„ç›¸å…³èƒŒæ™¯çŸ¥è¯†ï¼Œè¯·å‚é˜…ï¼š Internet Financial Risk Control (part1) ï¼š The Fraud Risk of Financial Technology Enterprises Internet Financial Risk Control (part2) ï¼š model strategy Internet Financial Risk Control (part3) ï¼š Lending Club Data dev 1. æ•°æ®è·å– é‡‘èæœºæ„è‡ªèº«å­—æ®µï¼š å¹´é¾„ï¼Œæˆ·ç±ï¼Œæ€§åˆ«ï¼Œæ”¶å…¥ï¼Œâ€¦ï¼› ç¬¬ä¸‰æ–¹æœºæ„çš„æ•°æ®ï¼š æ¶ˆè´¹è¡Œä¸ºâ€¦ æ•°æ®æƒ…å†µï¼š 23W+ å»æ‰ä¸€äº›ç°ç”¨æˆ·ï¼Œå‰©ä½™ M1æ ‡å‡†ï¼š å¥½/å: 13W+ å 4K 30~50 : 1 éƒ½æ˜¯æ­£å¸¸çš„ 2. EDAExploratory Data Analysis æ¯ä¸ªå­—æ®µçš„ç¼ºå¤±å€¼æƒ…å†µã€å¼‚å¸¸å€¼æƒ…å†µã€å¹³å‡å€¼ã€ä¸­ä½æ•°ã€æœ€å¤§å€¼ã€æœ€å°å€¼ã€åˆ†å¸ƒæƒ…å†µç­‰ ç‰›é¡¿æ’å€¼çš„å‡ ä½•è§£é‡Šæ˜¯æ€ä¹ˆæ ·çš„ï¼Ÿ å¦‚ä½•ç›´è§‚åœ°ç†è§£æ‹‰æ ¼æœ—æ—¥æ’å€¼æ³•ï¼Ÿ ä»ç‰›é¡¿æ’å€¼æ³•åˆ°æ³°å‹’å…¬å¼ æ³°å‹’å…¬å¼ä¸€å¥è¯æè¿°ï¼šå°±æ˜¯ç”¨å¤šé¡¹å¼å‡½æ•°å»é€¼è¿‘å…‰æ»‘å‡½æ•° ç¼ºå¤±å€¼çš„å¤„ç†ï¼Œè¿˜å¯ä»¥ç”¨ RF å»æ‹Ÿåˆ. 3. æ•°æ®é¢„å¤„ç†(1). æ•°æ®æ¸…æ´— (2). å˜é‡åˆ†ç®± (3). WOE ç¼–ç  ç¼ºå¤±å€¼å¤ªå¤š éæ•°å€¼å˜é‡å¤š (emp_title..) id, member_id ç­‰ loan_amnt != df.funded_amnt ç©ºå€¼å¡«å……ä¸º 0 å¸¦ % çš„æµ®ç‚¹ï¼Œå»æ‰ % å¥½åæ¯”æ˜¯ 34:1 æ˜¯éå¸¸éš¾ä»¥å¤„ç†çš„æ ·æœ¬äº†. 3.1 æ•°æ®æ¸…æ´—ç¼ºå¤±å€¼å¤ªå¤š # å¤„ç†å¯¹è±¡ç±»å‹çš„ç¼ºå¤±ï¼Œuniquedf.select_dtypes(include=[&#x27;O&#x27;]).describe().T.\\assign(missing_pct=df.apply(lambda x : (len(x)-x.count())/float(len(x))))# ç¼ºå¤±å€¼ç‰¹åˆ«é«˜çš„å¯ä»¥åˆ é™¤æ‰# æˆ‘ä»¬å¯ä»¥å¯¹ éæ•°å€¼å‹ å˜é‡ï¼Œåšä¸€ä¸ªå¾ªç¯ï¼Œå‘ç° zip_code æœ‰ 873 ä¸ª unique çš„å€¼ï¼Œé‚£ä¹ˆå…ˆä¸å¤„ç†for col in df.select_dtypes(include=[&#x27;object&#x27;]).columns: print (&quot;Column &#123;&#125; has &#123;&#125; unique instances&quot;.format( col, len(df[col].unique())) ) 3.2 å˜é‡åˆ†ç®± å¯¹è¿ç»­å˜é‡è¿›è¡Œåˆ†æ®µç¦»æ•£åŒ–ï¼› å°†å¤šçŠ¶æ€çš„ç¦»æ•£å˜é‡è¿›è¡Œåˆå¹¶ï¼Œå‡å°‘ç¦»æ•£å˜é‡çš„çŠ¶æ€æ•°ã€‚ å…ˆå¯ä»¥ç²—åˆ†ç®±ï¼Œä¹‹ååœ¨åˆå¹¶ã€‚ æ¯”å¦‚ å¹´é¾„å–å€¼æ•°æœ‰ 30ä¸ªï¼Œé‚£ä¹ˆåˆ†ä¸º 30 ç®±ï¼Œæœ€ååˆä¸º 5 ç®±ã€‚å…¶ä»–å˜é‡å¯èƒ½ç²—åˆ†ç®±ä¸º 100 ç®±ï¼Œä¹‹ååˆå¹¶. åˆ†ç®±æ–¹æ³•å¾ˆå¤šï¼Œæœ€å¸¸è§çš„æ–¹æ³•ä¹‹ä¸€ï¼š Mergeåˆ†ç®±ä¸­çš„ Chimerge åˆ†ç®±. Chimerge å…¶åŸºæœ¬æ€æƒ³æ˜¯å¦‚æœä¸¤ä¸ªç›¸é‚»çš„åŒºé—´å…·æœ‰ç±»ä¼¼çš„ç±»åˆ†å¸ƒï¼Œåˆ™è¿™ä¸¤ä¸ªåŒºé—´åˆå¹¶ï¼›å¦åˆ™ï¼Œå®ƒä»¬åº”ä¿æŒåˆ†å¼€ã€‚Chimergeé€šå¸¸é‡‡ç”¨å¡æ–¹å€¼æ¥è¡¡é‡ä¸¤ç›¸é‚»åŒºé—´çš„ç±»åˆ†å¸ƒæƒ…å†µã€‚ è¿ç»­å€¼æŒ‰å‡åºæ’åˆ—ï¼Œç¦»æ•£å€¼å…ˆè½¬åŒ–ä¸ºåå®¢æˆ·çš„æ¯”ç‡ï¼Œç„¶åå†æŒ‰å‡åºæ’åˆ—ï¼› ä¸ºäº†å‡å°‘è®¡ç®—é‡ï¼Œå¯¹äºçŠ¶æ€æ•°å¤§äºæŸä¸€é˜ˆå€¼ (å»ºè®®ä¸º100) çš„å˜é‡ï¼Œåˆ©ç”¨ç­‰é¢‘åˆ†ç®±è¿›è¡Œç²—åˆ†ç®±ã€‚ è‹¥æœ‰ç¼ºå¤±å€¼ï¼Œåˆ™ç¼ºå¤±å€¼å•ç‹¬ä½œä¸ºä¸€ä¸ªåˆ†ç®±ã€‚ åˆ†ç®±çš„æœ€å¤§åŒºé—´æ•° &amp; åˆ†ç®±åˆå§‹åŒ– è¿™é‡Œæˆ‘å–ï¼š n = 5 è¿ç»­å€¼æŒ‰å‡åºæ’åˆ—ï¼Œç¦»æ•£å€¼å…ˆè½¬åŒ–ä¸ºåå®¢æˆ·çš„æ¯”ç‡ï¼Œç„¶åå†æŒ‰å‡åºæ’åˆ—ï¼› ä¸ºäº†å‡å°‘è®¡ç®—é‡ï¼Œå¯¹äºçŠ¶æ€æ•°å¤§äºæŸä¸€é˜ˆå€¼ (å»ºè®®ä¸º100) çš„å˜é‡ï¼Œåˆ©ç”¨ç­‰é¢‘åˆ†ç®±è¿›è¡Œç²—åˆ†ç®±ã€‚ è‹¥æœ‰ç¼ºå¤±å€¼ï¼Œåˆ™ç¼ºå¤±å€¼å•ç‹¬ä½œä¸ºä¸€ä¸ªåˆ†ç®±ã€‚ åˆå¹¶åŒºé—´ï¼š å°†å¡æ–¹å€¼æœ€å°çš„ä¸€å¯¹åŒºé—´åˆå¹¶ åˆ†ç®±åå¤„ç†ï¼š å¯¹äºåå®¢æˆ·æ¯”ä¾‹ä¸º 0 æˆ– 1 çš„åˆ†ç®±è¿›è¡Œåˆå¹¶ (ä¸€ä¸ªåˆ†ç®±å†…ä¸èƒ½å…¨ä¸ºå¥½å®¢æˆ·æˆ–è€…å…¨ä¸ºåå®¢æˆ·)ã€‚ å¯¹äºåˆ†ç®±åæŸä¸€ç®±æ ·æœ¬å æ¯”è¶…è¿‡ 95% çš„ç®±å­è¿›è¡Œåˆ é™¤ã€‚ æ£€æŸ¥ç¼ºå¤±åˆ†ç®±çš„åå®¢æˆ·æ¯”ä¾‹æ˜¯å¦å’Œéç¼ºå¤±åˆ†ç®±ç›¸ç­‰ï¼Œå¦‚æœç›¸ç­‰ï¼Œè¿›è¡Œåˆå¹¶ã€‚ æ€»ç»“ä¸€ä¸‹ç‰¹å¾åˆ†ç®±çš„ä¼˜åŠ¿ï¼š ç‰¹å¾åˆ†ç®±å¯ä»¥æœ‰æ•ˆå¤„ç†ç‰¹å¾ä¸­çš„ç¼ºå¤±å€¼å’Œå¼‚å¸¸å€¼ã€‚ ç‰¹å¾åˆ†ç®±åï¼Œæ•°æ®å’Œæ¨¡å‹ä¼šæ›´ç¨³å®šã€‚ ç‰¹å¾åˆ†ç®±å¯ä»¥ç®€åŒ–é€»è¾‘å›å½’æ¨¡å‹ï¼Œé™ä½æ¨¡å‹è¿‡æ‹Ÿåˆçš„é£é™©ï¼Œæé«˜æ¨¡å‹çš„æ³›åŒ–èƒ½åŠ›ã€‚ å°†æ‰€æœ‰ç‰¹å¾ç»Ÿä¸€å˜æ¢ä¸ºç±»åˆ«å‹å˜é‡ã€‚ åˆ†ç®±åå˜é‡æ‰å¯ä»¥ä½¿ç”¨æ ‡å‡†çš„è¯„åˆ†å¡æ ¼å¼ï¼Œå³å¯¹ä¸åŒçš„åˆ†æ®µè¿›è¡Œè¯„åˆ†ã€‚ åˆ—è¡¨å†…å®¹ç‰¹å¾ç¦»æ•£åŒ–åï¼Œæ¨¡å‹ä¼šæ›´ç¨³å®šï¼Œæ¯”å¦‚å¦‚æœå¯¹ç”¨æˆ·å¹´é¾„ç¦»æ•£åŒ–ï¼Œ20-30ä½œä¸ºä¸€ä¸ªåŒºé—´ï¼Œä¸ä¼šå› ä¸ºä¸€ä¸ªç”¨æˆ·å¹´é¾„é•¿äº†ä¸€å²å°±å˜æˆä¸€ä¸ªå®Œå…¨ä¸åŒçš„äººã€‚å½“ç„¶å¤„äºåŒºé—´ç›¸é‚»å¤„çš„æ ·æœ¬ä¼šåˆšå¥½ç›¸åï¼Œæ‰€ä»¥æ€ä¹ˆåˆ’åˆ†åŒºé—´æ˜¯é—¨å­¦é—®ï¼› å˜é‡åˆ†ç®±å®è·µ One-Hotç¼–ç ä¸å“‘å˜é‡ æ–¹å·®ã€æ ‡å‡†å·®å’Œå‡æ–¹æ ¹è¯¯å·®çš„åŒºåˆ«æ€»ç»“ åŸºäºå¡æ–¹åˆ†ç®±çš„è¯„åˆ†å¡å»ºæ¨¡ good åŸºäºå¡æ–¹åˆ†ç®±çš„è¯„åˆ†å¡å»ºæ¨¡ , å¡æ–¹åˆ†å¸ƒâ€”chi-square distribution, Ï‡2-distribution å¡æ–¹å€¼çš„æ„ä¹‰,ä¸¾ä¸ªä¾‹å­ï¼š æŸåŒ»é™¢å¯¹æŸç§ç—…ç—‡çš„æ‚£è€…ä½¿ç”¨äº† $A$ï¼Œ$B$ ä¸¤ç§ä¸åŒçš„ç–—æ³•ï¼Œç»“æœå¦‚è¡¨1ï¼Œé—®ä¸¤ç§ç–—æ³•æœ‰æ— å·®åˆ«ï¼Ÿ ç»„åˆ« æœ‰æ•ˆ æ— æ•ˆ åˆè®¡ æœ‰æ•ˆç‡ï¼ˆ%ï¼‰ Aç»„ 19 24 43 44.2 Bç»„ 34 10 44 77.3 åˆè®¡ 53 34 87 60.9 å¯ä»¥è®¡ç®—å‡ºå„æ ¼å†…çš„æœŸæœ›é¢‘æ•°ï¼š ç¬¬1è¡Œ1åˆ—ï¼š 43Ã—53/87=26.2 , ç¬¬1è¡Œ2åˆ—ï¼š 43Ã—34/87=16.8 , ç¬¬2è¡Œ1åˆ—ï¼š 44Ã—53/87=26.8 , ç¬¬2è¡Œ2åˆ—ï¼š 44Ã—34/87=17.2 Aç®± (26.2-19)*(26.2-19) / 26.2 -&gt; (26.2 æ˜¯ æ­£ç±»çš„æœŸæœ›é¢‘æ•°ï¼Œ 19 æ˜¯çœŸå®é¢‘æ•°) (16.8-24)*(16.8-24) / 16.8 (16.8 æ˜¯ è´Ÿç±»çš„æœŸæœ›é¢‘æ•°) Bç®± (26.8-34)*(26.8-34) / 26.8 (26.8 æ˜¯ æ­£ç±»çš„æœŸæœ›é¢‘æ•°) (17.2-10)*(17.2-10) / 17.2 (17.2 æ˜¯ è´Ÿç±»çš„æœŸæœ›é¢‘æ•°) å…ˆå»ºç«‹åŸå‡è®¾ï¼šAã€Bä¸¤ç§ç–—æ³•æ²¡æœ‰åŒºåˆ«ã€‚æ ¹æ®å¡æ–¹å€¼çš„è®¡ç®—å…¬å¼ï¼Œè®¡ç®—ï¼šå¡æ–¹å€¼=10.01ã€‚å¾—åˆ°å¡æ–¹å€¼ä»¥åï¼Œæ¥ä¸‹æ¥éœ€è¦æŸ¥è¯¢å¡æ–¹åˆ†å¸ƒè¡¨æ¥åˆ¤æ–­på€¼ï¼Œä»è€Œåšå‡ºæ¥å—æˆ–æ‹’ç»åŸå‡è®¾çš„å†³å®šã€‚ ç‚¹å‡»æ—¶çš„åŒºåŸŸæ ‡é¢˜ï¼š å¡æ–¹åˆ†å¸ƒâ€”chi-square distribution, Ï‡2-distribution **Ï‡2-distribution:** è‹¥ $k$ ä¸ªç‹¬ç«‹çš„éšæœºå˜é‡ $Z\\_1, Z\\_2, ..., Z\\_k$ æ»¡è¶³æ ‡å‡†æ­£æ€åˆ†å¸ƒ $N(0,1)$ , åˆ™è¿™ $k$ ä¸ªéšæœºå˜é‡çš„å¹³æ–¹å’Œï¼š å¡æ–¹æ£€éªŒâ€”Ï‡2æ£€éªŒæ˜¯ä»¥Ï‡2åˆ†å¸ƒä¸ºåŸºç¡€çš„ä¸€ç§å‡è®¾æ£€éªŒæ–¹æ³•ï¼Œä¸»è¦ç”¨äºåˆ†ç±»å˜é‡ä¹‹é—´çš„ç‹¬ç«‹æ€§æ£€éªŒ æ€æƒ³æ˜¯æ ¹æ®æ ·æœ¬æ•°æ®æ¨æ–­ **`æ€»ä½“åˆ†å¸ƒä¸æœŸæœ›åˆ†å¸ƒ æ˜¯å¦æœ‰æ˜¾è‘—æ€§å·®å¼‚`**ï¼Œæˆ–è€…æ¨æ–­ä¸¤ä¸ªåˆ†ç±»å˜é‡æ˜¯å¦ç›¸å…³æˆ–è€…ç‹¬ç«‹ã€‚ ä¸€èˆ¬å¯ä»¥è®¾åŸå‡è®¾ä¸º ï¼šè§‚å¯Ÿé¢‘æ•°ä¸æœŸæœ›é¢‘æ•°æ²¡æœ‰å·®å¼‚ï¼Œæˆ–è€…ä¸¤ä¸ªå˜é‡ç›¸äº’ç‹¬ç«‹ä¸ç›¸å…³ã€‚ å®é™…åº”ç”¨ä¸­ï¼Œæˆ‘ä»¬å…ˆå‡è®¾åŸå‡è®¾æˆç«‹ï¼Œè®¡ç®—å‡ºå¡æ–¹å€¼ï¼Œå¡æ–¹è¡¨ç¤ºè§‚å¯Ÿå€¼ä¸ç†è®ºå€¼é—´çš„åç¦»ç¨‹åº¦ã€‚ å¡æ–¹å€¼åªæ˜¯ä¸€ä¸ªä¸­é—´è¿‡ç¨‹ï¼Œé€šè¿‡å¡æ–¹å€¼è®¡ç®—å‡ºpå€¼ï¼Œpå€¼æ‰æ˜¯æˆ‘ä»¬æœ€é‡è¦éœ€è¦çš„ã€‚på°äº0.05æ„å‘³ç€å­˜åœ¨æ˜¾è‘—å·®å¼‚ã€‚ å¡æ–¹å€¼æ˜¯éå‚æ•°æ£€éªŒä¸­çš„ä¸€ä¸ªç»Ÿè®¡é‡ï¼Œä¸»è¦ç”¨äºéå‚æ•°ç»Ÿè®¡åˆ†æä¸­ã€‚å®ƒçš„ä½œç”¨æ˜¯æ£€éªŒæ•°æ®çš„ç›¸å…³æ€§ã€‚å¦‚æœå¡æ–¹å€¼çš„æ˜¾è‘—æ€§ï¼ˆå³SIG.ï¼‰å°äº0.05ï¼Œè¯´æ˜ä¸¤ä¸ªå˜é‡æ˜¯æ˜¾è‘—ç›¸å…³çš„ã€‚ 3.3 WOE (weight of evidence) WOE ç§°ä¸ºè¯æ®æƒé‡(weight of evidence) , å°†ç¦»æ•£å˜é‡è½¬åŒ–ä¸ºè¿ç»­å˜é‡ã€‚ WOE å°†é¢„æµ‹ç±»åˆ«çš„é›†ä¸­åº¦çš„å±æ€§ä½œä¸ºç¼–ç çš„æ•°å€¼ã€‚å¯¹äºè‡ªå˜é‡ç¬¬ $i$ ç®±çš„WOEå€¼ä¸ºï¼š $p_{i1}$ æ˜¯ç¬¬ $i$ ç®±ä¸­åå®¢æˆ·å æ‰€æœ‰åå®¢æˆ·æ¯”ä¾‹ $p_{i0}$ æ˜¯ç¬¬ $i$ ç®±ä¸­å¥½å®¢æˆ·å æ‰€æœ‰å¥½å®¢æˆ·æ¯”ä¾‹ WOE: å½“å‰åˆ†ç®±ä¸­åå®¢æˆ·å’Œå¥½å®¢æˆ·çš„æ¯”å€¼ï¼Œå’Œæ‰€æœ‰æ ·æœ¬ä¸­è¿™ä¸ªæ¯”å€¼çš„å·®å¼‚ å½“åˆ†ç®±ä¸­åå®¢æˆ·å’Œå¥½å®¢æˆ·çš„æ¯”ä¾‹ç­‰äºéšæœºåå®¢æˆ·å’Œå¥½å®¢æˆ·çš„æ¯”å€¼æ—¶ï¼Œè¯´æ˜è¿™ä¸ªåˆ†ç®±æ²¡æœ‰é¢„æµ‹èƒ½åŠ›ï¼Œå³WOE=0ã€‚ (WOEä¸º0ï¼Œè¯´æ˜è¯¥ç®±å‡ºçš„ç‰¹å¾å¯¹ç»“æœæ²¡æœ‰åŒºåˆ†åº¦) å®é™…ä¸ŠWOEç¼–ç ç›¸å½“äºæŠŠåˆ†ç®±åçš„ç‰¹å¾ä»éçº¿æ€§å¯åˆ†æ˜ å°„åˆ°è¿‘ä¼¼çº¿æ€§å¯åˆ†çš„ç©ºé—´å†…: æ€»ç»“ä¸€ä¸‹WOEç¼–ç çš„ä¼˜åŠ¿ï¼š å¯æå‡æ¨¡å‹çš„é¢„æµ‹æ•ˆæœ å°†è‡ªå˜é‡è§„èŒƒåˆ°åŒä¸€å°ºåº¦ä¸Š WOEèƒ½åæ˜ è‡ªå˜é‡å–å€¼çš„è´¡çŒ®æƒ…å†µ æœ‰åˆ©äºå¯¹å˜é‡çš„æ¯ä¸ªåˆ†ç®±è¿›è¡Œè¯„åˆ† è½¬åŒ–ä¸ºè¿ç»­å˜é‡ä¹‹åï¼Œä¾¿äºåˆ†æå˜é‡ä¸å˜é‡ä¹‹é—´çš„ç›¸å…³æ€§ ä¸ç‹¬çƒ­å‘é‡ç¼–ç ç›¸æ¯”ï¼Œå¯ä»¥ä¿è¯å˜é‡çš„å®Œæ•´æ€§ï¼ŒåŒæ—¶é¿å…ç¨€ç–çŸ©é˜µå’Œç»´åº¦ç¾éš¾ 4. å˜é‡ç­›é€‰ä¸»è¦è¡¡é‡æ ‡å‡†: å˜é‡çš„é¢„æµ‹èƒ½åŠ›å’Œå˜é‡çš„çº¿æ€§ç›¸å…³æ€§ã€‚ æŒ‘é€‰å…¥æ¨¡å˜é‡: å˜é‡çš„é¢„æµ‹èƒ½åŠ› å˜é‡ä¹‹é—´çš„çº¿æ€§ç›¸å…³æ€§ å˜é‡åœ¨ä¸šåŠ¡ä¸Šçš„å¯è§£é‡Šæ€§ å˜é‡ä¸¤ä¸¤ç›¸å…³æ€§åˆ†æï¼Œå˜é‡çš„å¤šé‡å…±çº¿æ€§åˆ†æã€‚ 4.1 å•å˜é‡ç­›é€‰IV ä¿¡æ¯ä»·å€¼(information value)ï¼Œè‡ªå˜é‡çš„IVå€¼è¶Šå¤§ï¼Œè¡¨ç¤ºè‡ªå˜é‡çš„é¢„æµ‹èƒ½åŠ›è¶Šå¼ºã€‚ ç±»ä¼¼æŒ‡æ ‡è¿˜æœ‰ä¿¡æ¯å¢ç›Šç­‰ã€‚ å˜é‡å¯¹åº”çš„IVå€¼ä¸ºæ‰€æœ‰åˆ†ç®±å¯¹åº”çš„ IV å€¼ä¹‹å’Œï¼š IV å€¼å®é™…ä¸Šå¼å˜é‡å„ä¸ªåˆ†ç®±çš„åŠ æƒæ±‚å’Œã€‚ä¸”å’Œå†³ç­–æ ‘ä¸­çš„äº¤å‰ç†µæœ‰å¼‚æ›²åŒå·¥ä¹‹å¦™ã€‚ä»¥ä¸‹ä¸ºäº¤å‰ç†µå…¬å¼ï¼š IVå€¼çš„å…·ä½“çš„è®¡ç®—æµç¨‹å¦‚ä¸‹ï¼š IVæ’åºåï¼Œé€‰æ‹©IV&gt;0.02çš„å˜é‡ï¼Œå…±58ä¸ªå˜é‡IV&gt;0.02 4.2 å¤šå˜é‡åˆ†æä¿ç•™ç›¸å…³æ€§ä½äºé˜ˆå€¼0.6çš„å˜é‡ï¼Œå‰©ä½™27ä¸ªå˜é‡ ä¸ºä»€ä¹ˆè¦è¿›è¡Œç›¸å…³æ€§åˆ†æï¼Ÿ ç†æƒ³çŠ¶æ€ä¸‹ï¼Œç³»æ•°æƒé‡ä¼šæœ‰æ— æ•°ç§å–æ³•ï¼Œä½¿ç³»æ•°æƒé‡å˜å¾—æ— æ³•è§£é‡Šï¼Œå¯¼è‡´å˜é‡çš„æ¯ä¸ªåˆ†æ®µçš„å¾—åˆ†ä¹Ÿæœ‰æ— æ•°ç§å–æ³•ï¼ˆåé¢æˆ‘ä»¬ä¼šå‘ç°å˜é‡ä¸­ä¸åŒåˆ†æ®µçš„è¯„åˆ†ä¼šç”¨åˆ°å˜é‡çš„ç³»æ•°ï¼‰ æ€»ç»“ä¸€ä¸‹å˜é‡ç­›é€‰çš„æ„ä¹‰ï¼š å‰”é™¤è·Ÿç›®æ ‡å˜é‡ä¸å¤ªç›¸å…³çš„ç‰¹å¾ æ¶ˆé™¤ç”±äºçº¿æ€§ç›¸å…³çš„å˜é‡ï¼Œé¿å…ç‰¹å¾å†—ä½™ å‡è½»åæœŸéªŒè¯ã€éƒ¨ç½²ã€ç›‘æ§çš„è´Ÿæ‹… ä¿è¯å˜é‡çš„å¯è§£é‡Šæ€§ ç‰¹å¾ç›¸å…³åº¦ç­›é€‰ cor = df.corr()cor.loc[:,:] = np.tril(cor, k=-1) # below main lower triangle of an arraycor = cor.stack()cor[(cor &gt; 0.55) | (cor &lt; -0.55)] # ç‰¹å¾ç›¸å…³åº¦ç­›é€‰ 4.3 æ˜¾è‘—æ€§åˆ†æåˆ é™¤På€¼ä¸æ˜¾è‘—çš„å˜é‡ï¼Œå‰©ä½™12ä¸ªå˜é‡äº†ã€‚ GBDT, GBRT, Xgboost, RF grid search param_grid = &#123; &#x27;learning_rate&#x27;: [0.1, 0.05, 0.02, 0.01], &#x27;max_depth&#x27;: [1,2,3,4], &#x27;min_samples_split&#x27;: [50,100,200,400], &#x27;n_estimators&#x27;: [100,200,400,800]&#125; ç‰¹å¾é‡è¦åº¦ï¼š # Top Tenï¼Œ GBRT top 10 çš„å‚æ•°æœ‰å“ªäº›ï¼Œå¯ä»¥ä½œä¸ºå‚è€ƒï¼Œ GBRT ä¸ä»…æ˜¯ä¸€ä¸ªåˆ†ç±»å™¨ï¼Œè¿˜èƒ½å¸®ä½ ç­›é€‰å˜é‡# æ¯”å¦‚ feature_importance = 0 çš„è¯ï¼Œé‚£ä¹ˆä¸‹ä¸€æ¬¡ è¿™ä¸ªç‰¹å¾ï¼Œä½ å°±å»æ‰å°±å¯ä»¥äº†# é‡æ–°ç”¨æ¨¡å‹GBRTé‡æ–°è·‘ï¼Œæˆ–è€…ç”¨å…¶ä»–æ¨¡å‹LRè·‘# æˆ–è€…å…¶ä»–çš„ RF ä¹Ÿå¯ä»¥å¸®åŠ©ä½ åšç‰¹å¾ç­›é€‰ æœ€åé€‰æ‹©å‡º 84 ä¸ªå˜é‡ï¼Œ ç„¶ååœ¨æ”¾åˆ°ä¸åŒçš„æ¨¡å‹ä¸­åšè®­ç»ƒï¼Œåœ¨ ensemble åº”è¯¥æ•ˆæœè¿˜æ˜¯ä¸é”™çš„ã€‚ ç‰¹å¾ä¸ç¨³å®šçš„ï¼Œä¸å¯ä»¥ä½œä¸ºå…¥æ¨¡å˜é‡ï¼š æŒ‘é€‰å˜é‡çš„æ—¶å€™ï¼Œå¼€å§‹æ¯ä¸ªæœˆæˆ‘ä¸€ç›´åœ¨çœ‹å®ƒçš„å‡å€¼å’Œæ–¹å·®çš„å˜åŒ–æ˜¯å¦åœ¨å®¹å¿çš„èŒƒå›´å†…ï¼Œè¶…è¿‡50%èˆ 5. è½¬åŒ–ä¸ºè¯„åˆ†å¡å°† odds å¸¦å…¥å¯å¾—ï¼š è¯„åˆ†å¡çš„åˆ†å€¼å¯ä»¥å®šä¹‰ä¸ºæ¯”ç‡å¯¹æ•°çš„çº¿æ€§è¡¨è¾¾æ¥ï¼Œå³ï¼š æœ€ç»ˆå¾—åˆ°è¯„åˆ†å¡æ¨¡å‹ï¼š éœ€è¦è®¾å®šä¸¤ä¸ªå‡è®¾ï¼š æŸä¸ªç‰¹å®šçš„è¿çº¦æ¦‚ç‡ä¸‹çš„é¢„æœŸè¯„åˆ†ï¼Œå³æ¯”ç‡ å³æ¯”ç‡ $\\text{odds}$ ä¸º $Î¸_0$ æ—¶çš„åˆ†æ•°ä¸º $P_0$ è¯¥oddsä¸º$2Î¸_0$æƒ…å†µä¸‹è¯„åˆ†çš„å‡å°‘é‡ï¼ˆPDOï¼‰ 6. KS è¯„ä¼°K-Sæ›²çº¿å…¶å®æ•°æ®æ¥æºå’Œæœ¬è´¨å’ŒROCæ›²çº¿æ˜¯ä¸€è‡´çš„ï¼Œåªæ˜¯ROCæ›²çº¿æ˜¯æŠŠçœŸæ­£ç‡å’Œå‡æ­£ç‡å½“ä½œæ¨ªçºµè½´ï¼Œè€ŒK-Sæ›²çº¿æ˜¯æŠŠçœŸæ­£ç‡å’Œå‡æ­£ç‡éƒ½å½“ä½œæ˜¯çºµè½´ï¼Œæ¨ªè½´åˆ™ç”±é€‰å®šçš„é˜ˆå€¼æ¥å……å½“ã€‚ ç”±äºkså€¼èƒ½æ‰¾å‡ºæ¨¡å‹ä¸­å·®å¼‚æœ€å¤§çš„ä¸€ä¸ªåˆ†æ®µï¼Œå› æ­¤é€‚åˆç”¨äºcut_offï¼Œåƒè¯„åˆ†å¡è¿™ç§å°±å¾ˆé€‚åˆç”¨kså€¼æ¥è¯„ä¼°ã€‚ä½†æ˜¯kså€¼åªèƒ½åæ˜ å‡ºå“ªä¸ªåˆ†æ®µæ˜¯åŒºåˆ†æœ€å¤§çš„ï¼Œè€Œä¸èƒ½æ€»ä½“åæ˜ å‡ºæ‰€æœ‰åˆ†æ®µçš„æ•ˆæœï¼Œå› æœAUCå€¼æ›´èƒ½èƒœä»»ã€‚ KSå€¼è¡¨ç¤ºäº†æ¨¡å‹å°†+å’Œ-åŒºåˆ†å¼€æ¥çš„èƒ½åŠ›ã€‚å€¼è¶Šå¤§ï¼Œæ¨¡å‹çš„é¢„æµ‹å‡†ç¡®æ€§è¶Šå¥½ã€‚ KS å€¼è¡¨ç¤ºäº†æ¨¡å‹åŒºåˆ†å¥½åå®¢æˆ·çš„èƒ½åŠ›ã€‚ ç­‰åˆ† 10 ä»½ï¼Œä¸¤æ¡æ´›ä¼¦å…¹æ›²çº¿ï¼Œ TPR ä¸ FPR çš„å·®å€¼. å¥½åå®¢æˆ·çš„åŒºç¨‹åº¦. å…¶å®è´¨æ˜¯ $TPR - FPR$ éšå¥½åå®¢æˆ·é˜ˆå€¼å˜åŒ–çš„æœ€å¤§å€¼ã€‚KS å€¼è¶Šå¤§ï¼Œæ¨¡å‹çš„é¢„æµ‹å‡†ç¡®æ€§è¶Šå¥½ã€‚ä¸€èˆ¬ï¼ŒKS &gt; 0.4 å³è®¤ä¸ºæ¨¡å‹æœ‰å¾ˆå¥½çš„é¢„æµ‹æ€§èƒ½ã€‚ Reference Pythonä¸‰å¤§è¯„åˆ†å¡ä¹‹è¡Œä¸ºè¯„åˆ†å¡ ç©è½¬é€»è¾‘å›å½’ä¹‹é‡‘èè¯„åˆ†å¡æ¨¡å‹ æ‹æ‹è´·æ•™ä½ å¦‚ä½•ç”¨GBDTåšè¯„åˆ†å¡ æ¨¡å‹åŒºåˆ†åº¦æŒ‡æ ‡ KS å€¼ åˆ†ç±»æ¨¡å‹è¯„åˆ¤æŒ‡æ ‡ ROCï¼ŒAUCï¼ŒGINIï¼ŒKS æ·±å…¥ç†è§£KS AUCå’ŒKSæŒ‡æ ‡ ä¸€æ–‡å®Œå…¨ç†è§£æ¨¡å‹ksæŒ‡æ ‡å«ä¹‰å¹¶ç”»å‡ºksæ›²çº¿","categories":[{"name":"data-science","slug":"data-science","permalink":"http://iequa.com/categories/data-science/"}],"tags":[{"name":"Credit-Score","slug":"Credit-Score","permalink":"http://iequa.com/tags/Credit-Score/"}]},{"title":"Bert æœ€ç®€å•çš„æ‰“å¼€å§¿åŠ¿","slug":"nlp/BERT_tutorial_1","date":"2019-06-21T03:00:21.000Z","updated":"2019-10-20T04:30:35.072Z","comments":true,"path":"2019/06/21/nlp/BERT_tutorial_1/","link":"","permalink":"http://iequa.com/2019/06/21/nlp/BERT_tutorial_1/","excerpt":"2018.10 google å‘å¸ƒ BERT æ¨¡å‹. å¼•çˆ†æ•´ä¸ªAIåœˆçš„ NLP æ¨¡å‹. åœ¨ NLPé¢†åŸŸ åˆ·æ–° 11 é¡¹è®°å½•. BERT åˆ›æ–°ç‚¹åœ¨äºæå‡ºäº†ä¸€å¥—å®Œæ•´çš„æ–¹æ¡ˆï¼Œåˆ©ç”¨ä¹‹å‰æœ€æ–°çš„ç®—æ³•æ¨¡å‹ï¼Œå»è§£å†³å„ç§å„æ ·çš„ NLP ä»»åŠ¡.","text":"2018.10 google å‘å¸ƒ BERT æ¨¡å‹. å¼•çˆ†æ•´ä¸ªAIåœˆçš„ NLP æ¨¡å‹. åœ¨ NLPé¢†åŸŸ åˆ·æ–° 11 é¡¹è®°å½•. BERT åˆ›æ–°ç‚¹åœ¨äºæå‡ºäº†ä¸€å¥—å®Œæ•´çš„æ–¹æ¡ˆï¼Œåˆ©ç”¨ä¹‹å‰æœ€æ–°çš„ç®—æ³•æ¨¡å‹ï¼Œå»è§£å†³å„ç§å„æ ·çš„ NLP ä»»åŠ¡. å½“Berté‡ä¸ŠKerasåœ¨Kerasä¸‹å¯¹Bertæœ€å¥½çš„å°è£…æ˜¯ï¼š keras-bertï¼šhttps://github.com/CyberZHG/keras-bert è¿™é‡Œç®€å•è§£é‡Šä¸€ä¸‹Tokenizerçš„è¾“å‡ºç»“æœã€‚é¦–å…ˆï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œåˆ†è¯åå¥å­é¦–ä½ä¼šåˆ†åˆ«åŠ ä¸Š[CLS]å’Œ[SEP]æ ‡è®°ï¼Œå…¶ä¸­[CLS]ä½ç½®å¯¹åº”çš„è¾“å‡ºå‘é‡æ˜¯èƒ½ä»£è¡¨æ•´å¥çš„å¥å‘é‡ï¼ˆåæ­£Bertæ˜¯è¿™æ ·è®¾è®¡çš„ï¼‰ï¼Œè€Œ[SEP]åˆ™æ˜¯å¥é—´çš„åˆ†éš”ç¬¦ï¼Œå…¶ä½™éƒ¨åˆ†åˆ™æ˜¯å•å­—è¾“å‡ºï¼ˆå¯¹äºä¸­æ–‡æ¥è¯´ï¼‰ Reference BERT: Pre-training of Deep Bidirectional Transformers for Language Understanding ã€ŠAttention is All You Needã€‹æµ…è¯»ï¼ˆç®€ä»‹+ä»£ç ï¼‰","categories":[{"name":"nlp","slug":"nlp","permalink":"http://iequa.com/categories/nlp/"}],"tags":[{"name":"BERT","slug":"BERT","permalink":"http://iequa.com/tags/BERT/"}]},{"title":"Chatbot Project","slug":"chatbot/chatbot-project","date":"2019-06-20T11:16:21.000Z","updated":"2020-10-23T02:03:18.011Z","comments":true,"path":"2019/06/20/chatbot/chatbot-project/","link":"","permalink":"http://iequa.com/2019/06/20/chatbot/chatbot-project/","excerpt":"","text":"chatbot \u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000èŠå¤©æœºå™¨äººï¼ˆchatbotï¼‰ï¼Œä¹Ÿè¢«ç§°ä¸ºä¼šè¯ä»£ç†æˆ–å¯¹è¯ç³»ç»Ÿï¼Œç°å·²æˆä¸ºäº†ä¸€ä¸ªçƒ­é—¨è¯é¢˜ã€‚å¾®è½¯åœ¨èŠå¤©æœºå™¨äººä¸ŠæŠ¼ä¸Šäº†é‡æ³¨ï¼ŒFacebookï¼ˆMï¼‰ã€è‹¹æœï¼ˆSiriï¼‰ã€è°·æ­Œ å’Œ Slack ç­‰å…¬å¸ä¹Ÿæ˜¯å¦‚æ­¤ã€‚ æ–°ä¸€æ³¢åˆ›ä¸šè€…ä»¬æ­£åœ¨å°è¯•æ”¹å˜æ¶ˆè´¹è€…ä¸æœåŠ¡çš„äº¤äº’æ–¹å¼ã€‚ Chatbot Research 1 - èŠå¤©æœºå™¨äººçš„è¡Œä¸šç»¼è¿° Chatbot Research 2 - NLP çš„åŸºç¡€çŸ¥è¯†å›é¡¾ Chatbot Research 3 - æœºå™¨å­¦ä¹ æ„å»º chatbot Chatbot Research 4 - æ·±åº¦å­¦ä¹ çŸ¥è¯†å›é¡¾ Chatbot Research 5 - åŸºäºæ·±åº¦å­¦ä¹ çš„æ£€ç´¢èŠå¤©æœºå™¨äºº Chatbot Research 6 - æ›´å¤šè®ºæ–‡ (æ„Ÿè°¢ PaperWeekly) Chatbot Research 7 - Dialog_Corpus å¸¸ç”¨æ•°æ®é›† Chatbot Research 8 - ç†è®º seq2seq+Attention æœºåˆ¶æ¨¡å‹è¯¦è§£ Chatbot Research 11 - ç¬¬äºŒä¸ªç‰ˆæœ¬ (æ–°ç‰ˆå®ç°) Chatbot Research 12 - ç†è®ºç¯‡ï¼š è¯„ä»·æŒ‡æ ‡ä»‹ç» Chatbot Research 13 - ç†è®ºç¯‡ï¼š MMI æ¨¡å‹ç†è®º Chatbot Useful Links é¢„å¤‡çŸ¥è¯† 1.1 è¯åµŒå…¥ï¼ˆword2vecï¼‰ 1.2 è¿‘ä¼¼è®­ç»ƒ 1.3 Word2vec çš„å®ç° 1.4 å­è¯åµŒå…¥ï¼ˆfastTextï¼‰ 1.5 å…¨å±€å‘é‡çš„è¯åµŒå…¥ï¼ˆGloVeï¼‰ 1.6 æ±‚è¿‘ä¹‰è¯å’Œç±»æ¯”è¯ 1.7 æ–‡æœ¬æƒ…æ„Ÿåˆ†ç±»ï¼šä½¿ç”¨ RNN 1.8 æ–‡æœ¬æƒ…æ„Ÿåˆ†ç±»ï¼šä½¿ç”¨ CNNï¼ˆtextCNNï¼‰ 1.9 ç¼–ç å™¨â€”è§£ç å™¨ï¼ˆseq2seqï¼‰ 1.10 æŸæœç´¢ beam-search 1.11 Attentionæœºåˆ¶ 1.12 tensorflowæ¨¡å‹çº¿ä¸Šéƒ¨ç½² 2. TensorFlowTensorFlow ç”¨äºæœºå™¨å­¦ä¹ å’Œç¥ç»ç½‘ç»œæ–¹é¢çš„ç ”ç©¶ï¼Œé‡‡ç”¨æ•°æ®æµå›¾æ¥è¿›è¡Œæ•°å€¼è®¡ç®—çš„å¼€æºè½¯ä»¶åº“. Keras å¼€å‘é‡ç‚¹æ˜¯æ”¯æŒå¿«é€Ÿçš„å®éªŒã€‚èƒ½å¤Ÿä»¥æœ€å°çš„æ—¶å»¶æŠŠä½ çš„æƒ³æ³•è½¬æ¢ä¸ºå®éªŒç»“æœï¼Œæ˜¯åšå¥½ç ”ç©¶çš„å…³é”®ã€‚ 2.1 TensorFlow ç®€ä»‹ 1.1 TensorFlow Why ? 1.2 TensorFlow å¿«é€Ÿå­¦ä¹  &amp; æ–‡æ¡£ 2.2 Tensorflow åŸºç¡€æ„æ¶ 2.1 å¤„ç†ç»“æ„: è®¡ç®—å›¾ 2.2 å®Œæ•´æ­¥éª¤ ä¾‹å­2 ğŸŒ°ï¼ˆåˆ›å»ºæ•°æ®ã€æ­å»ºæ¨¡å‹ã€è®¡ç®—è¯¯å·®ã€ä¼ æ’­è¯¯å·®ã€è®­ç»ƒï¼‰ 2.3 Session ä¼šè¯æ§åˆ¶ 2.4 Variable å˜é‡ 2.5 Placeholder ä¼ å…¥å€¼ 2.6 ä»€ä¹ˆæ˜¯æ¿€åŠ±å‡½æ•° (Activation Function) 2.7 æ¿€åŠ±å‡½æ•° Activation Function 2.8 TensorFlow åŸºæœ¬ç”¨æ³•æ€»ç»“ ğŸŒ°ğŸŒ°ğŸŒ° 2.3 å»ºé€ æˆ‘ä»¬ç¬¬ä¸€ä¸ªç¥ç»ç½‘ç»œ 3.1 æ·»åŠ å±‚ def add_layer() 3.2 å»ºé€ ç¥ç»ç½‘ç»œ ğŸŒ°ğŸŒ°ğŸŒ° 3.3 Speed Up Training &amp; Optimizer (è½¬è½½è‡ªè«çƒ¦) 2.4 Tensorboard 4.1 Tensorboard å¯è§†åŒ–å¥½å¸®æ‰‹ 1 2.5 Estimator 5.1 tf.contrib.learn å¿«é€Ÿå…¥é—¨ 5.2 tf.contrib.learn æ„å»ºè¾“å…¥å‡½æ•° 5.3 tf.contrib.learn åŸºç¡€çš„è®°å½•å’Œç›‘æ§æ•™ç¨‹ 5.4 tf.contrib.learn åˆ›å»º Estimator 5.5 TF ä¿å­˜å’ŒåŠ è½½æ¨¡å‹ - ç®€ä¹¦ 2.6 Language model ä»‹ç»è¯­è¨€æ¨¡å‹æ˜¯è‡ªç„¶è¯­è¨€å¤„ç†é—®é¢˜ä¸­ä¸€ç±»æœ€åŸºæœ¬çš„é—®é¢˜ï¼Œå®ƒæœ‰ç€éå¸¸å¹¿æ³›çš„åº”ç”¨ã€‚ 1.1 RNN å¾ªç¯ç¥ç»ç½‘ç»œ ç®€ä»‹ 1.2 LSTM &amp; Bi-RNN &amp; Deep RNN 1.3 Language model ä»‹ç» / è¯„ä»·æ–¹æ³• perplexity (not finish) 2.7 NNLM (ç¥ç»è¯­è¨€æ¨¡å‹) 2.2 PTB æ•°æ®çš„ batching æ–¹æ³• 2.3 RNN çš„è¯­è¨€æ¨¡å‹ TensorFlow å®ç° 2.8 MNIST æ•°å­—è¯†åˆ«é—®é¢˜ 3.1 ç®€å•å‰é¦ˆç½‘ç»œå®ç° mnist åˆ†ç±» 3.3 name / variable_scope 3.4 å¤šå±‚ LSTM é€šä¿—æ˜“æ‡‚ç‰ˆ 4. PythonPython å“²å­¦å°±æ˜¯ç®€å•ä¼˜é›…ï¼Œå°½é‡å†™å®¹æ˜“çœ‹æ˜ç™½çš„ä»£ç ï¼Œå°½é‡å†™å°‘çš„ä»£ç . Python æ•°æ®åˆ†ææ¨¡å—: Numpy &amp; Pandas, åŠå¼ºå¤§çš„ç”»å›¾å·¥å…· Matplotlib Python Numpy &amp; Pandas Matplotlib 5. Scikit-LearnSklearn æœºå™¨å­¦ä¹ é¢†åŸŸå½“ä¸­æœ€çŸ¥åçš„ Python æ¨¡å—ä¹‹ä¸€ why 1.1 : Sklearn Choosing The Right Estimator 1.2 : Sklearn General Learning Model 1.3 : Sklearn DataSets 1.4 : Sklearn Common Attributes and Functions 1.5 : Normalization 1.6 : Cross-validation 1 1.7 : Cross-validation 2 1.8 : Cross-validation 3 1.9 : Sklearn Save Model","categories":[{"name":"chatbot","slug":"chatbot","permalink":"http://iequa.com/categories/chatbot/"}],"tags":[{"name":"chatbot","slug":"chatbot","permalink":"http://iequa.com/tags/chatbot/"}]},{"title":"BERT å®Œå…¨æŒ‡å—","slug":"nlp/BERT_tutorial_2","date":"2019-06-20T03:00:21.000Z","updated":"2019-10-31T05:04:53.778Z","comments":true,"path":"2019/06/20/nlp/BERT_tutorial_2/","link":"","permalink":"http://iequa.com/2019/06/20/nlp/BERT_tutorial_2/","excerpt":"","text":"2018.10 google å‘å¸ƒ BERT æ¨¡å‹. å¼•çˆ†æ•´ä¸ªAIåœˆçš„ NLP æ¨¡å‹. åœ¨ NLPé¢†åŸŸ åˆ·æ–° 11 é¡¹è®°å½•. BERT å…¶å®æ˜¯ language_encoderï¼ŒæŠŠè¾“å…¥çš„ sentence æˆ– paragraph è½¬æˆ feature_vectorï¼ˆembeddingï¼‰. Paper: BERT: Pre-training of Deep Bidirectional Transformers for Language Understanding BERT åˆ›æ–°ç‚¹åœ¨äºæå‡ºäº†ä¸€å¥—å®Œæ•´çš„æ–¹æ¡ˆï¼Œåˆ©ç”¨ä¹‹å‰æœ€æ–°çš„ç®—æ³•æ¨¡å‹ï¼Œå»è§£å†³å„ç§å„æ ·çš„ NLP ä»»åŠ¡. 1. NLP çš„å‘å±•NLP ç¥ç»ç½‘ç»œå‘å±•å†å²ä¸­æœ€é‡è¦çš„ 8 ä¸ªé‡Œç¨‹ç¢‘ Language Model (è¯­è¨€æ¨¡å‹å°±æ˜¯è¦çœ‹åˆ°ä¸Šæ–‡é¢„æµ‹ä¸‹æ–‡, So NNLM) n-gram modelï¼ˆnå…ƒæ¨¡å‹ï¼‰ï¼ˆåŸºäº é©¬å°”å¯å¤«å‡è®¾ æ€æƒ³ï¼‰ä¸Šä¸‹æ–‡ç›¸å…³çš„ç‰¹æ€§ å»ºç«‹æ•°å­¦æ¨¡å‹ã€‚ 2001 - NNLM , @Bengio , ç«äº 2013 å¹´ï¼Œ æ²‰å¯‚åå¹´ç»ˆæ—¶æ¥è¿è½¬ã€‚ ä½†å¾ˆå¿«åˆè¢«NLPå·¥ä½œè€…ç¥­å…¥ç¥æ®¿ã€‚ 2008 - Multi-task learning 2013 - Word2Vec (Word Embeddingçš„å·¥å…·word2vec : CBOW å’Œ Skip-gram) 2014 - sequence-to-sequence 2015 - Attention 2015 - Memory-based networks 2018 - Pretrained language models good å¼ ä¿Šæ—: æ·±åº¦å­¦ä¹ ä¸­çš„æ³¨æ„åŠ›æ¨¡å‹ï¼ˆ2017ç‰ˆï¼‰ good å¼ ä¿Šæ—: ä»Word Embeddingåˆ°Bertæ¨¡å‹â€”è‡ªç„¶è¯­è¨€å¤„ç†ä¸­çš„é¢„è®­ç»ƒæŠ€æœ¯å‘å±•å² NNLM vs Word2Vec NNLM ç›®æ ‡ï¼š è®­ç»ƒè¯­è¨€æ¨¡å‹ï¼Œ è¯­è¨€æ¨¡å‹å°±æ˜¯è¦çœ‹ä¸Šæ–‡é¢„æµ‹ä¸‹æ–‡ï¼Œ word embedding åªæ˜¯æ— å¿ƒçš„ä¸€ä¸ªå‰¯äº§å“ã€‚ Word2Vecç›®æ ‡ï¼š å®ƒå•çº¯å°±æ˜¯è¦ word embedding çš„ï¼Œè¿™æ˜¯ä¸»äº§å“ã€‚ 2018 å¹´ä¹‹å‰çš„ Word Embedding æœ‰ä¸ªç¼ºç‚¹å°±æ˜¯æ— æ³•å¤„ç† å¤šä¹‰è¯ çš„é—®é¢˜, é™æ€è¯åµŒ. ELMO: Embedding from Language Models ELMOçš„è®ºæ–‡é¢˜ç›®ï¼šâ€œDeep contextualized word representationâ€ NAACL 2018 æœ€ä½³è®ºæ–‡ - ELMOï¼š Deep contextualized word representation ELMO æœ¬èº«æ˜¯ä¸ªæ ¹æ®å½“å‰ä¸Šä¸‹æ–‡å¯¹Word EmbeddingåŠ¨æ€è°ƒæ•´çš„æ€è·¯ã€‚ ELMO æœ‰ä»€ä¹ˆç¼ºç‚¹ï¼Ÿ LSTM æŠ½å–ç‰¹å¾èƒ½åŠ›è¿œå¼±äº Transformer æ‹¼æ¥æ–¹å¼åŒå‘èåˆç‰¹å¾èƒ½åŠ›åå¼± GPT (Generative Pre-Training) ç¬¬ä¸€ä¸ªé˜¶æ®µæ˜¯åˆ©ç”¨ language è¿›è¡Œ Pre-Training. ç¬¬äºŒé˜¶æ®µé€šè¿‡ Fine-tuning çš„æ¨¡å¼è§£å†³ä¸‹æ¸¸ä»»åŠ¡ã€‚ GPT: æœ‰ä»€ä¹ˆç¼ºç‚¹ï¼Ÿ è¦æ˜¯æŠŠ language model æ”¹é€ æˆåŒå‘å°±å¥½äº† ä¸å¤ªä¼šç‚’ä½œï¼ŒGPT ä¹Ÿæ˜¯éå¸¸é‡è¦çš„å·¥ä½œ. Bert äº®ç‚¹ : æ•ˆæœå¥½ å’Œ æ™®é€‚æ€§å¼º Transformer ç‰¹å¾æŠ½å–å™¨ Language Model ä½œä¸ºè®­ç»ƒä»»åŠ¡ (åŒå‘) Bert é‡‡ç”¨å’Œ GPT å®Œå…¨ç›¸åŒçš„ ä¸¤é˜¶æ®µ æ¨¡å‹ï¼š Pre-Train Language Modelï¼› Fine-&gt; Tuningæ¨¡å¼è§£å†³ä¸‹æ¸¸ä»»åŠ¡ã€‚ NLP çš„ 4å¤§ä»»åŠ¡ 4 NLP task description åºåˆ—æ ‡æ³¨ ç‰¹ç‚¹æ˜¯å¥å­ä¸­æ¯ä¸ªå•è¯è¦æ±‚æ¨¡å‹æ ¹æ®ä¸Šä¸‹æ–‡éƒ½è¦ç»™å‡ºä¸€ä¸ª åˆ†ç±»labelï¼› åˆ†ç±»ä»»åŠ¡ ç‰¹ç‚¹æ˜¯ä¸ç®¡æ–‡ç« æœ‰å¤šé•¿ï¼Œæ€»ä½“ç»™å‡ºä¸€ä¸ªåˆ†ç±»label å³å¯ï¼› å¥å­å…³ç³»åˆ¤æ–­ ç‰¹ç‚¹æ˜¯ç»™å®šä¸¤ä¸ªå¥å­ï¼Œæ¨¡å‹åˆ¤æ–­å‡ºä¸¤ä¸ªå¥å­ æ˜¯å¦å…·å¤‡æŸç§è¯­ä¹‰å…³ç³»ï¼› ç”Ÿæˆå¼ä»»åŠ¡ ç‰¹ç‚¹æ˜¯è¾“å…¥æ–‡æœ¬å†…å®¹åï¼Œéœ€è¦è‡ªä¸»ç”Ÿæˆå¦å¤–ä¸€æ®µæ–‡å­—ã€‚ good å¼ ä¿Šæ—: æ”¾å¼ƒå¹»æƒ³ï¼Œå…¨é¢æ‹¥æŠ±Transformerï¼šè‡ªç„¶è¯­è¨€å¤„ç†ä¸‰å¤§ç‰¹å¾æŠ½å–å™¨ï¼ˆCNN/RNN/TFï¼‰æ¯”è¾ƒ 2. Feature Extraction RNN äººè€ç é»„ï¼Œå·²ç»åŸºæœ¬å®Œæˆå®ƒçš„å†å²ä½¿å‘½ï¼Œå°†æ¥ä¼šé€æ­¥é€€å‡ºå†å²èˆå°ï¼› CNN å¦‚æœæ”¹é€ æˆåŠŸå¹¶è¶…å‡ºæœŸæœ›ï¼Œé‚£ä¹ˆè¿˜æœ‰ä¸€ä¸å¯èƒ½ç»§ç»­ç”Ÿå­˜å£®å¤§ï¼› Transformer æ˜æ˜¾ä¼šå¾ˆå¿«æˆä¸º NLPé‡Œ æ‹…å½“å¤§ä»»çš„æœ€ä¸»æµçš„ç‰¹å¾æŠ½å–å™¨ã€‚ ç‰¹å¾æŠ½å–å™¨èƒ½å¦å…·å¤‡é•¿è·ç¦»ç‰¹å¾æ•è·èƒ½åŠ›è¿™ä¸€ç‚¹å¯¹äºè§£å†³NLPä»»åŠ¡æ¥è¯´ä¹Ÿæ˜¯å¾ˆå…³é”®çš„ã€‚ ä¸€ä¸ªç‰¹å¾æŠ½å–å™¨æ˜¯å¦é€‚é…é—®é¢˜é¢†åŸŸçš„ç‰¹ç‚¹ï¼Œæœ‰æ—¶å€™å†³å®šäº†å®ƒçš„æˆè´¥ï¼Œè€Œå¾ˆå¤šæ¨¡å‹æ”¹è¿›çš„æ–¹å‘ï¼Œå…¶å®å°±æ˜¯æ”¹é€ å¾—ä½¿å¾—å®ƒæ›´åŒ¹é…é¢†åŸŸé—®é¢˜çš„ç‰¹æ€§ã€‚ Three Feature Extraction: â€œTransformerè€ƒä¸Šäº†åŒ—äº¬å¤§å­¦ï¼›CNNè¿›äº†ä¸­ç­‰æŠ€æœ¯å­¦æ ¡ï¼Œå¸Œæœ›æœ‰ä¸€å¤©èƒ½å¤Ÿè€ƒç ”è€ƒè¿›åŒ—äº¬å¤§å­¦ï¼›RNNåœ¨ç™¾è´§å…¬å¸å½“å”®è´§å‘˜ï¼šæˆ‘ä»¬éƒ½æœ‰çœ‹ä¼¼å…‰æ˜çš„å‰é€”ã€‚â€ 1. è¿›é€€ç»´è°·çš„ RNN RNN (åŒ…æ‹¬LSTMã€GRU + Attention) æ•ˆæœä¸ Transformer å·®è·å¾ˆæ˜æ˜¾ RNN å¾ˆéš¾å¹¶è¡Œè®¡ç®—ã€‚ ç”±äº RNN ç‰¹ç‚¹ ï¼š çº¿å½¢åºåˆ—æ”¶é›†å‰é¢çš„ä¿¡æ¯ã€‚ ä¸€ä¸ªä¸¥é‡é˜»ç¢RNNå°†æ¥ç»§ç»­èµ°çº¢çš„é—®é¢˜æ˜¯ï¼šRNNæœ¬èº«çš„åºåˆ—ä¾èµ–ç»“æ„å¯¹äºå¤§è§„æ¨¡å¹¶è¡Œè®¡ç®—æ¥è¯´ç›¸å½“ä¹‹ä¸å‹å¥½ã€‚é€šä¿—ç‚¹è¯´ï¼Œå°±æ˜¯RNNå¾ˆéš¾å…·å¤‡é«˜æ•ˆçš„å¹¶è¡Œè®¡ç®—èƒ½åŠ›ï¼Œè¿™ä¸ªä¹ä¸€çœ‹å¥½åƒä¸æ˜¯å¤ªå¤§çš„é—®é¢˜ï¼Œå…¶å®é—®é¢˜å¾ˆä¸¥é‡ã€‚ å¯¹äºå°æ•°æ®é›† RNN å¯èƒ½é€Ÿåº¦æ›´å¿«äº›ï¼Œ Transformer æ…¢äº›ï¼Œ ä½†æ˜¯å¯ä»¥æ”¹è¿› Transformer ç¼“è§£ï¼š å¯æŠŠBlockæ•°ç›®é™ä½ï¼Œå‡å°‘å‚æ•°é‡ï¼› å¼•å…¥Bertä¸¤é˜¶æ®µè®­ç»ƒæ¨¡å‹ï¼Œé‚£ä¹ˆå¯¹äºå°æ•°æ®é›†åˆæ¥è¯´ä¼šæå¤§ç¼“è§£æ•ˆæœé—®é¢˜ã€‚ 2. ä¸€å¸Œå°šå­˜çš„ CNN CNN å¤©ç”Ÿè‡ªå¸¦çš„é«˜å¹¶è¡Œè®¡ç®—èƒ½åŠ› ä¸€äº›æ·±åº¦ç½‘ç»œçš„ä¼˜åŒ–trickï¼ŒCNNåœ¨NLPé¢†åŸŸé‡Œçš„æ·±åº¦é€æ­¥èƒ½åšèµ·æ¥äº†ã€‚dilated CNN æ—©æœŸCNNåšä¸å¥½NLPçš„ä¸€ä¸ªå¾ˆå¤§åŸå› æ˜¯ç½‘ç»œæ·±åº¦åšä¸èµ·æ¥ã€‚ åŸç”Ÿçš„CNNåœ¨å¾ˆå¤šæ–¹é¢ä»ç„¶æ˜¯æ¯”ä¸è¿‡Transformerçš„ï¼Œå…¸å‹çš„è¿˜æ˜¯é•¿è·ç¦»ç‰¹å¾æ•è·èƒ½åŠ›æ–¹é¢ï¼Œè€Œè¿™ç‚¹åœ¨NLPç•Œç®—æ˜¯æ¯”è¾ƒä¸¥é‡çš„ç¼ºé™·ã€‚ å¯¹äºè¿œè·ç¦»ç‰¹å¾ï¼Œå•å±‚æ€€æ—§ç‰ˆCNNæ˜¯æ— æ³•æ•è·åˆ°çš„ï¼Œå¦‚æœæ»‘åŠ¨çª—å£kæœ€å¤§ä¸º2ï¼Œè€Œå¦‚æœæœ‰ä¸ªè¿œè·ç¦»ç‰¹å¾è·ç¦»æ˜¯5ï¼Œé‚£ä¹ˆæ— è®ºä¸Šå¤šå°‘ä¸ªå·ç§¯æ ¸ï¼Œéƒ½æ— æ³•è¦†ç›–åˆ°é•¿åº¦ä¸º5çš„è·ç¦»çš„è¾“å…¥ï¼Œæ‰€ä»¥å®ƒæ˜¯æ— æ³•æ•è·é•¿è·ç¦»ç‰¹å¾çš„ æ»‘åŠ¨çª—å£ä»å·¦åˆ°å³æ»‘åŠ¨ï¼Œæ•è·åˆ°çš„ç‰¹å¾ä¹Ÿæ˜¯å¦‚æ­¤é¡ºåºæ’åˆ—ï¼Œæ‰€ä»¥å®ƒåœ¨ç»“æ„ä¸Šå·²ç»è®°å½•äº†ç›¸å¯¹ä½ç½®ä¿¡æ¯äº†ã€‚ä½†æ˜¯å¦‚æœå·ç§¯å±‚åé¢ç«‹å³æ¥ä¸ŠPoolingå±‚çš„è¯ï¼ŒMax Poolingçš„æ“ä½œé€»è¾‘æ˜¯ï¼šä»ä¸€ä¸ªå·ç§¯æ ¸è·å¾—çš„ç‰¹å¾å‘é‡é‡Œåªé€‰ä¸­å¹¶ä¿ç•™æœ€å¼ºçš„é‚£ä¸€ä¸ªç‰¹å¾ï¼Œæ‰€ä»¥åˆ°äº†Poolingå±‚ï¼Œä½ç½®ä¿¡æ¯å°±è¢«æ‰”æ‰äº†ï¼Œè¿™åœ¨NLPé‡Œå…¶å®æ˜¯æœ‰ä¿¡æ¯æŸå¤±çš„ã€‚æ‰€ä»¥åœ¨NLPé¢†åŸŸé‡Œï¼Œç›®å‰CNNçš„ä¸€ä¸ªå‘å±•è¶‹åŠ¿æ˜¯æŠ›å¼ƒPoolingå±‚ï¼Œé å…¨å·ç§¯å±‚æ¥å åŠ ç½‘ç»œæ·±åº¦ã€‚ æ€€æ—§ç‰ˆ CNNæ¨¡å‹ ä¸€ç›´å¤„äºè¢« RNNæ¨¡å‹ å‹åˆ¶åˆ°æŠ‘éƒç—‡æ—©æœŸçš„å°´å°¬å±€é¢ã€‚ CNNçš„è¿›åŒ–ï¼šç‰©ç«å¤©æ‹©çš„æ¨¡å‹æ–—å…½åœº æ‘©ç™»CNNï¼ˆä½¿ç”¨Skip Connectionæ¥è¾…åŠ©ä¼˜åŒ–ï¼‰ã€Dilated CNN æƒ³æ–¹è®¾æ³•æŠŠCNNçš„æ·±åº¦åšèµ·æ¥ï¼Œéšç€æ·±åº¦çš„å¢åŠ ï¼Œå¾ˆå¤šçœ‹ä¼¼æ— å…³çš„é—®é¢˜å°±éšä¹‹è§£å†³äº†ã€‚ 3. Transformer Transformerä½œä¸ºæ–°æ¨¡å‹ï¼Œå¹¶ä¸æ˜¯å®Œç¾æ— ç¼ºçš„ã€‚å®ƒä¹Ÿæœ‰æ˜æ˜¾çš„ç¼ºç‚¹ï¼šé¦–å…ˆï¼Œå¯¹äºé•¿è¾“å…¥çš„ä»»åŠ¡ï¼Œå…¸å‹çš„æ¯”å¦‚ç¯‡ç« çº§åˆ«çš„ä»»åŠ¡ï¼ˆä¾‹å¦‚æ–‡æœ¬æ‘˜è¦ï¼‰ï¼Œå› ä¸ºä»»åŠ¡çš„è¾“å…¥å¤ªé•¿ï¼ŒTransformerä¼šæœ‰å·¨å¤§çš„è®¡ç®—å¤æ‚åº¦ï¼Œå¯¼è‡´é€Ÿåº¦ä¼šæ€¥å‰§å˜æ…¢ã€‚ åšè¯­ä¹‰ç‰¹å¾æŠ½å–èƒ½åŠ›æ¯”è¾ƒæ—¶ï¼Œç»“è®ºæ˜¯å¯¹äºè·ç¦»è¿œä¸13çš„é•¿è·ç¦»ç‰¹å¾ï¼ŒTransformeræ€§èƒ½å¼±äºRNNï¼Œæ¯”è¾ƒå‡ºä¹æ„æ–™ï¼Œå› ä¸ºTransformeré€šè¿‡Self attentionä½¿å¾—è¿œè·ç¦»ç‰¹å¾ç›´æ¥å‘ç”Ÿå…³ç³»ï¼ŒæŒ‰ç†è¯´è·ç¦»ä¸åº”è¯¥æˆä¸ºå®ƒçš„é—®é¢˜ï¼Œä½†æ˜¯æ•ˆæœç«Ÿç„¶ä¸å¦‚RNNï¼Œè¿™èƒŒåçš„åŸå› æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿè¿™ä¹Ÿæ˜¯å¾ˆæœ‰ä»·å€¼çš„ä¸€ä¸ªæ¢ç´¢ç‚¹ã€‚ åå±±è®ºå‰‘ï¼šä¸‰å¤§ç‰¹å¾æŠ½å–å™¨æ¯”è¾ƒ æ€»è€Œè¨€ä¹‹ï¼Œå…³äºä¸‰è€…é€Ÿåº¦å¯¹æ¯”æ–¹é¢ï¼Œç›®å‰çš„ä¸»æµç»éªŒç»“è®ºåŸºæœ¬å¦‚ä¸Šæ‰€è¿°ï¼šTransformer Baseæœ€å¿«ï¼ŒCNNæ¬¡ä¹‹ï¼Œå†æ¬¡Transformer Bigï¼Œæœ€æ…¢çš„æ˜¯RNNã€‚RNNæ¯”å‰ä¸¤è€…æ…¢äº†3å€åˆ°å‡ åå€ä¹‹é—´ã€‚ å•ä»ä»»åŠ¡ç»¼åˆæ•ˆæœæ–¹é¢æ¥è¯´ï¼ŒTransformeræ˜æ˜¾ä¼˜äºCNNï¼ŒCNNç•¥å¾®ä¼˜äºRNNã€‚é€Ÿåº¦æ–¹é¢Transformerå’ŒCNNæ˜æ˜¾å ä¼˜ï¼ŒRNNåœ¨è¿™æ–¹é¢åŠ£åŠ¿éå¸¸æ˜æ˜¾ã€‚è¿™ä¸¤è€…å†ç»¼åˆèµ·æ¥ï¼Œå¦‚æœæˆ‘ç»™çš„æ’åºç»“æœæ˜¯Transformer&gt;CNN&gt;RNN ä»é€Ÿåº¦å’Œæ•ˆæœæŠ˜è¡·çš„è§’åº¦çœ‹ï¼Œå¯¹äºå·¥ä¸šç•Œåº”ç”¨ï¼Œç‰¹å¾æŠ½å–é€‰æ‹©æ–¹é¢é…ç½®Transformer baseæ˜¯ä¸ªè¾ƒå¥½çš„é€‰æ‹©ã€‚ good å¼ ä¿Šæ—: æ”¾å¼ƒå¹»æƒ³ï¼Œå…¨é¢æ‹¥æŠ±Transformerï¼šè‡ªç„¶è¯­è¨€å¤„ç†ä¸‰å¤§ç‰¹å¾æŠ½å–å™¨ï¼ˆCNN/RNN/TFï¼‰æ¯”è¾ƒ NLP 4 å¤§ä»»åŠ¡ï¼š åºåˆ—æ ‡æ³¨ (åˆ†è¯ã€POS Tagã€NERã€è¯­ä¹‰æ ‡æ³¨) åˆ†ç±»ä»»åŠ¡ å¥å­å…³ç³»åˆ¤æ–­ ï¼ˆEntailmentã€QAã€è¯­ä¹‰æ”¹å†™ï¼‰ ç”Ÿæˆå¼ä»»åŠ¡ ï¼ˆæœºå™¨ç¿»è¯‘ã€æ–‡æœ¬æ‘˜è¦ã€å†™è¯—é€ å¥ã€çœ‹å›¾è¯´è¯ï¼‰ è§£å†³è¿™äº›ä¸åŒçš„ä»»åŠ¡ï¼Œä»æ¨¡å‹è§’åº¦æ¥è®²ä»€ä¹ˆæœ€é‡è¦ï¼Ÿæ˜¯ç‰¹å¾æŠ½å–å™¨çš„èƒ½åŠ›ã€‚å°¤å…¶æ˜¯æ·±åº¦å­¦ä¹ æµè¡Œå¼€æ¥åï¼Œè¿™ä¸€ç‚¹æ›´å‡¸æ˜¾å‡ºæ¥ã€‚å› ä¸ºæ·±åº¦å­¦ä¹ æœ€å¤§çš„ä¼˜ç‚¹æ˜¯â€œç«¯åˆ°ç«¯ï¼ˆend to endï¼‰â€ï¼Œå½“ç„¶è¿™é‡Œä¸æ˜¯æŒ‡çš„ä»å®¢æˆ·ç«¯åˆ°äº‘ç«¯ï¼Œæ„æ€æ˜¯ä»¥å‰ç ”å‘äººå‘˜å¾—è€ƒè™‘è®¾è®¡æŠ½å–å“ªäº›ç‰¹å¾ï¼Œè€Œç«¯åˆ°ç«¯æ—¶ä»£åï¼Œè¿™äº›ä½ å®Œå…¨ä¸ç”¨ç®¡ï¼ŒæŠŠåŸå§‹è¾“å…¥æ‰”ç»™å¥½çš„ç‰¹å¾æŠ½å–å™¨ï¼Œå®ƒè‡ªå·±ä¼šæŠŠæœ‰ç”¨çš„ç‰¹å¾æŠ½å–å‡ºæ¥ã€‚ 3. Attention Attention model ç‰©ç†å«ä¹‰: çœ‹ä½œæ˜¯è¾“å‡º Targetå¥å­ ä¸­æŸä¸ªå•è¯å’Œè¾“å…¥ Sourceå¥å­ æ¯ä¸ªå•è¯çš„ å¯¹é½æ¨¡å‹. Self Attention å¯ä»¥è®¤ä¸ºæ˜¯ä¸€ç§ç‰¹æ®Šçš„ Source == Target çš„æƒ…å†µ. good å¼ ä¿Šæ—: æ·±åº¦å­¦ä¹ ä¸­çš„ Attention Modelï¼ˆ2017ç‰ˆï¼‰ 4. TransformerBERT æ‰€é‡‡ç”¨çš„ç®—æ³•æ¥è‡ªäº 2017.12 google Transformer: Attenion Is All You Need å…¥é—¨ Transformer çš„å¯ä»¥å‚è€ƒä»¥ä¸‹ä¸‰ç¯‡æ–‡ç« ï¼š ç¬¬ä¸€ç¯‡æ˜¯ Jay Alammarâ€™s Blog Transformer The Illustrated Transformerã€è¯‘ã€‘ good The Illustrated Transformer ä¸­æ–‡ç‰ˆ Qã€Kã€V å®ƒä»¬éƒ½æ˜¯æœ‰åŠ©äºè®¡ç®—å’Œç†è§£æ³¨æ„åŠ›æœºåˆ¶çš„æŠ½è±¡æ¦‚å¿µ ç¬¬äºŒç¯‡æ˜¯ Calvoâ€™s Blog Dissecting BERT Part 1: The Encoder ç¬¬ä¸‰ç¯‡æ˜¯ å“ˆä½›å¤§å­¦NLPç ”ç©¶ç»„ The Annotated Transformer good Transformer çŸ¥ä¹æ¨¡å‹ç¬”è®°ï¼Œé˜…è¯»å¿ƒå¾— æœ¬æ–‡æ‰€è¯´çš„Transformerç‰¹å¾æŠ½å–å™¨å¹¶éåŸå§‹è®ºæ–‡æ‰€æŒ‡ã€‚å› ä¸ºEncoderéƒ¨åˆ†ç›®çš„æ¯”è¾ƒå•çº¯ï¼Œå°±æ˜¯ä»åŸå§‹å¥å­ä¸­æå–ç‰¹å¾ï¼Œè€ŒDecoderéƒ¨åˆ†åˆ™åŠŸèƒ½ç›¸å¯¹æ¯”è¾ƒå¤šï¼Œé™¤äº†ç‰¹å¾æå–åŠŸèƒ½å¤–ï¼Œè¿˜åŒ…å«è¯­è¨€æ¨¡å‹åŠŸèƒ½ï¼Œä»¥åŠç”¨attentionæœºåˆ¶è¡¨è¾¾çš„ç¿»è¯‘æ¨¡å‹åŠŸèƒ½ã€‚ å®Œå…¨å›¾è§£è‡ªç„¶è¯­è¨€å¤„ç†ä¸­çš„Transformerâ€”â€”BERTåŸºç¡€ï¼ˆå…¥é—¨é•¿æ–‡ï¼‰ tensor2tensor åŠ©äºç†è§£ Transformer çŸ¥è¯†ç‚¹ç†è§£ 4.1 stepåŠ¡å¿…é˜…è¯»ï¼š The Illustrated Transformer ä¸­æ–‡ç‰ˆ æ‰€æœ‰çš„ç¼–ç å™¨åœ¨ç»“æ„ä¸Šéƒ½æ˜¯ç›¸åŒçš„ï¼Œä½†å®ƒä»¬æ²¡æœ‰å…±äº«å‚æ•°ã€‚æ¯ä¸ªè§£ç å™¨éƒ½å¯ä»¥åˆ†è§£æˆä¸¤ä¸ªå­å±‚ã€‚ ä»ç¼–ç å™¨è¾“å…¥çš„å¥å­é¦–å…ˆä¼šç»è¿‡ä¸€ä¸ªè‡ªæ³¨æ„åŠ›ï¼ˆself-attentionï¼‰å±‚ è¿™å±‚å¸®åŠ©ç¼–ç å™¨åœ¨å¯¹æ¯ä¸ªå•è¯ç¼–ç æ—¶å…³æ³¨è¾“å…¥å¥å­çš„å…¶ä»–å•è¯ã€‚æˆ‘ä»¬å°†åœ¨ç¨åçš„æ–‡ç« ä¸­æ›´æ·±å…¥åœ°ç ”ç©¶è‡ªæ³¨æ„åŠ›ã€‚ è‡ªæ³¨æ„åŠ›å±‚çš„è¾“å‡ºä¼šä¼ é€’åˆ°å‰é¦ˆï¼ˆfeed-forwardï¼‰ç¥ç»ç½‘ç»œä¸­ã€‚æ¯ä¸ªä½ç½®çš„å•è¯å¯¹åº”çš„å‰é¦ˆç¥ç»ç½‘ç»œéƒ½å®Œå…¨ä¸€æ ·ï¼ˆè¯‘æ³¨ï¼šå¦ä¸€ç§è§£è¯»å°±æ˜¯ä¸€å±‚çª—å£ä¸ºä¸€ä¸ªå•è¯çš„ä¸€ç»´å·ç§¯ç¥ç»ç½‘ç»œï¼‰ã€‚ è§£ç å™¨ä¸­ä¹Ÿæœ‰ç¼–ç å™¨çš„è‡ªæ³¨æ„åŠ›ï¼ˆself-attentionï¼‰å±‚å’Œå‰é¦ˆï¼ˆfeed-forwardï¼‰å±‚ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œè¿™ä¸¤ä¸ªå±‚ä¹‹é—´è¿˜æœ‰ä¸€ä¸ªæ³¨æ„åŠ›å±‚ï¼Œç”¨æ¥å…³æ³¨è¾“å…¥å¥å­çš„ç›¸å…³éƒ¨åˆ†ï¼ˆå’Œseq2seqæ¨¡å‹çš„æ³¨æ„åŠ›ä½œç”¨ç›¸ä¼¼ï¼‰ã€‚ å°†å¼ é‡å¼•å…¥å›¾æ™¯ ç°åœ¨æˆ‘ä»¬å¼€å§‹â€œç¼–ç â€ è¿™ä¸ªsoftmaxåˆ†æ•°å†³å®šäº†æ¯ä¸ªå•è¯å¯¹ç¼–ç å½“ä¸‹ä½ç½®ï¼ˆâ€œThinkingâ€ï¼‰çš„è´¡çŒ®ã€‚æ˜¾ç„¶ï¼Œå·²ç»åœ¨è¿™ä¸ªä½ç½®ä¸Šçš„å•è¯å°†è·å¾—æœ€é«˜çš„softmaxåˆ†æ•°ï¼Œä½†æœ‰æ—¶å…³æ³¨å¦ä¸€ä¸ªä¸å½“å‰å•è¯ç›¸å…³çš„å•è¯ä¹Ÿä¼šæœ‰å¸®åŠ©ã€‚ ç¬¬äº”æ­¥æ˜¯å°†æ¯ä¸ªå€¼å‘é‡ä¹˜ä»¥softmaxåˆ†æ•°(è¿™æ˜¯ä¸ºäº†å‡†å¤‡ä¹‹åå°†å®ƒä»¬æ±‚å’Œ)ã€‚è¿™é‡Œçš„ç›´è§‰æ˜¯å¸Œæœ›å…³æ³¨è¯­ä¹‰ä¸Šç›¸å…³çš„å•è¯ï¼Œå¹¶å¼±åŒ–ä¸ç›¸å…³çš„å•è¯(ä¾‹å¦‚ï¼Œè®©å®ƒä»¬ä¹˜ä»¥0.001è¿™æ ·çš„å°æ•°)ã€‚ ç¬¬å…­æ­¥æ˜¯å¯¹åŠ æƒå€¼å‘é‡æ±‚å’Œï¼ˆè¯‘æ³¨ï¼šè‡ªæ³¨æ„åŠ›çš„å¦ä¸€ç§è§£é‡Šå°±æ˜¯åœ¨ç¼–ç æŸä¸ªå•è¯æ—¶ï¼Œå°±æ˜¯å°†æ‰€æœ‰å•è¯çš„è¡¨ç¤ºï¼ˆå€¼å‘é‡ï¼‰è¿›è¡ŒåŠ æƒæ±‚å’Œï¼Œè€Œæƒé‡æ˜¯é€šè¿‡è¯¥è¯çš„è¡¨ç¤ºï¼ˆé”®å‘é‡ï¼‰ä¸è¢«ç¼–ç è¯è¡¨ç¤ºï¼ˆæŸ¥è¯¢å‘é‡ï¼‰çš„ç‚¹ç§¯å¹¶é€šè¿‡softmaxå¾—åˆ°ã€‚ï¼‰ï¼Œç„¶åå³å¾—åˆ°è‡ªæ³¨æ„åŠ›å±‚åœ¨è¯¥ä½ç½®çš„è¾“å‡º(åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­æ˜¯å¯¹äºç¬¬ä¸€ä¸ªå•è¯)ã€‚ 5. BERTAction: hanxiaoå¤§ä½¬å¼€æºå‡ºæ¥çš„bert-as-serviceæ¡†æ¶å¾ˆé€‚åˆåˆå­¦è€… Netyccâ€™s blog åˆ©ç”¨Bertæ„å»ºå¥å‘é‡å¹¶è®¡ç®—ç›¸ä¼¼åº¦ BERTä½¿ç”¨è¯¦è§£(å®æˆ˜) BERTä¸­æ–‡æ–‡æœ¬ç›¸ä¼¼åº¦è®¡ç®—ä¸æ–‡æœ¬åˆ†ç±» Bertå®Œå…¨æŒ‡å— BERTå®Œå…¨æŒ‡å— Reference å¼ ä¿Šæ—: å¤©ç©ºä¹‹åŸï¼šæ‹‰é©¬åŠªé‡‘å¼æ€ç»´è®­ç»ƒæ³• äº’è”ç½‘äººåˆ°äº† 30 å²ï¼Œå¤§éƒ¨åˆ†éƒ½å»å¹²ä»€ä¹ˆäº†ï¼Ÿ AINLP BERTç›¸å…³è®ºæ–‡ã€æ–‡ç« å’Œä»£ç èµ„æºæ±‡æ€» è‡ªç„¶è¯­è¨€å¤„ç†ä¸­çš„Transformerå’ŒBERT RNNå’ŒLSTMå¼±ï¼çˆ†ï¼äº†ï¼æ³¨æ„åŠ›æ¨¡å‹æ‰æ˜¯ç‹é“ NLPçªç ´æ€§æˆæœ BERT æ¨¡å‹è¯¦ç»†è§£è¯» ä¸€æ­¥æ­¥ç†è§£BERT å½“Berté‡ä¸ŠKerasï¼šè¿™å¯èƒ½æ˜¯Bertæœ€ç®€å•çš„æ‰“å¼€å§¿åŠ¿","categories":[{"name":"nlp","slug":"nlp","permalink":"http://iequa.com/categories/nlp/"}],"tags":[{"name":"BERT","slug":"BERT","permalink":"http://iequa.com/tags/BERT/"}]},{"title":"Seq2Seq and Attention","slug":"deeplearning/Seq2Seq-Attention","date":"2019-06-17T02:00:21.000Z","updated":"2021-02-08T00:46:38.515Z","comments":true,"path":"2019/06/17/deeplearning/Seq2Seq-Attention/","link":"","permalink":"http://iequa.com/2019/06/17/deeplearning/Seq2Seq-Attention/","excerpt":"","text":"æˆ‘ä»¬å…ˆç»“åˆä¸Šç¯‡æ–‡ç« çš„å†…å®¹ï¼Œå°† language model å’Œ Machine translation model åšä¸€ä¸ªå¯¹æ¯”ï¼š å¯ä»¥çœ‹åˆ°ï¼Œæœºå™¨ç¿»è¯‘æ¨¡å‹çš„ååŠéƒ¨åˆ†å…¶å®å°±æ˜¯è¯­è¨€æ¨¡å‹ï¼ŒAndrew å°†å…¶ç§°ä¹‹ä¸º â€œæ¡ä»¶è¯­è¨€æ¨¡å‹â€. P(y^{},â€¦,y^{}|x^{},â€¦,x^{})1. Encoder-Decoder Source å’Œ Target åˆ†åˆ«ç”±å„è‡ªçš„å•è¯åºåˆ—æ„æˆï¼š Source = ({x}\\_1, {x}\\_2, ..., {x}\\_m) Target = ({y}\\_1, {y}\\_2, ..., {y}\\_n)Encoder é¡¾åæ€ä¹‰å°±æ˜¯å¯¹è¾“å…¥å¥å­Sourceè¿›è¡Œç¼–ç ï¼Œå°†è¾“å…¥å¥å­é€šè¿‡éçº¿æ€§å˜æ¢è½¬åŒ–ä¸ºä¸­é—´è¯­ä¹‰è¡¨ç¤ºCï¼š C = F({x}\\_1, {x}\\_2, ..., {x}\\_m)å¯¹äº Decoder æ¥è¯´ï¼Œå…¶ä»»åŠ¡æ˜¯æ ¹æ®å¥å­ Source çš„ ä¸­é—´è¯­ä¹‰è¡¨ç¤º C å’Œ ä¹‹å‰å·²ç»ç”Ÿæˆçš„å†å²ä¿¡æ¯ ({y}\\_1, {y}\\_2, ..., {y}\\_{i-1})æ¥ç”Ÿæˆ iæ—¶åˆ» è¦ç”Ÿæˆçš„å•è¯ ${y}_{i}$ y\\_{i} = g(C, {y}\\_1, {y}\\_2, ..., {y}\\_{i-1}) æ¯ä¸ª $y_i$ éƒ½ä¾æ¬¡è¿™ä¹ˆäº§ç”Ÿï¼Œé‚£ä¹ˆçœ‹èµ·æ¥å°±æ˜¯æ•´ä¸ªç³»ç»Ÿæ ¹æ®è¾“å…¥ å¥å­Source ç”Ÿæˆäº†ç›®æ ‡å¥å­Targetã€‚ (1). å¦‚æœSourceæ˜¯ä¸­æ–‡å¥å­ï¼ŒTargetæ˜¯è‹±æ–‡å¥å­ï¼Œé‚£ä¹ˆè¿™å°±æ˜¯è§£å†³æœºå™¨ç¿»è¯‘é—®é¢˜ï¼›(2). å¦‚æœSourceæ˜¯ä¸€ç¯‡æ–‡ç« ï¼ŒTargetæ˜¯æ¦‚æ‹¬æ€§çš„å‡ å¥æè¿°è¯­å¥ï¼Œé‚£ä¹ˆè¿™æ˜¯æ–‡æœ¬æ‘˜è¦ï¼›(3). å¦‚æœSourceæ˜¯ä¸€å¥é—®å¥ï¼ŒTargetæ˜¯ä¸€å¥å›ç­”ï¼Œé‚£ä¹ˆè¿™æ˜¯é—®ç­”ç³»ç»Ÿã€‚ Encoder-Decoderæ¡†æ¶ ä¸ä»…ä»…åœ¨æ–‡æœ¬é¢†åŸŸå¹¿æ³›ä½¿ç”¨ï¼Œåœ¨è¯­éŸ³è¯†åˆ«ã€å›¾åƒå¤„ç†ç­‰é¢†åŸŸä¹Ÿç»å¸¸ä½¿ç”¨. Learning Phrase Representations using RNN Encoderâ€“Decoder for Statistical Machine Translation 1.1 encoderç”¨å‡½æ•° $f$ è¡¨è¾¾ RNN éšè—å±‚çš„å˜æ¢ï¼š \\boldsymbol{h}\\_t = f(\\boldsymbol{x}\\_t, \\boldsymbol{h}\\_{t-1}).ç„¶å Encoder é€šè¿‡è‡ªå®šä¹‰å‡½æ•° $q$ å°†å„ä¸ªæ—¶é—´æ­¥çš„éšè—çŠ¶æ€å˜æ¢ä¸ºèƒŒæ™¯å˜é‡ \\boldsymbol{c} = q(\\boldsymbol{h}\\_1, \\ldots, \\boldsymbol{h}\\_T).ä¾‹å¦‚ï¼Œå½“é€‰æ‹© $q(\\boldsymbol{h}_1, \\ldots, \\boldsymbol{h}_T) = \\boldsymbol{h}_T$ æ—¶ï¼ŒèƒŒæ™¯å˜é‡æ˜¯è¾“å…¥åºåˆ—æœ€ç»ˆæ—¶é—´æ­¥çš„éšè—çŠ¶æ€ $\\boldsymbol{h}_T$ã€‚ ä»¥ä¸Šæè¿°çš„ç¼–ç å™¨æ˜¯ä¸€ä¸ªå•å‘çš„ RNNï¼Œæ¯ä¸ªæ—¶é—´æ­¥çš„éšè—çŠ¶æ€åªå–å†³äºè¯¥æ—¶é—´æ­¥åŠä¹‹å‰çš„è¾“å…¥å­åºåˆ—ã€‚æˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨ Bi-RNN æ„é€ ç¼–ç å™¨ã€‚ è¿™ç§æƒ…å†µä¸‹ï¼Œç¼–ç å™¨æ¯ä¸ªæ—¶é—´æ­¥çš„éšè—çŠ¶æ€åŒæ—¶å–å†³äºè¯¥æ—¶é—´æ­¥ä¹‹å‰å’Œä¹‹åçš„å­åºåˆ—ï¼ˆåŒ…æ‹¬å½“å‰æ—¶é—´æ­¥çš„è¾“å…¥ï¼‰ï¼Œå¹¶ç¼–ç äº†æ•´ä¸ªåºåˆ—çš„ä¿¡æ¯ã€‚ 1.2 decoder ä¸Šå°èŠ‚ Encode ç¼–ç å™¨è¾“å‡ºçš„èƒŒæ™¯å˜é‡ $c$ ç¼–ç äº†æ•´ä¸ªè¾“å…¥åºåˆ— $x_1, \\ldots, x_T$ çš„ä¿¡æ¯ã€‚ ç»™å®š train sample çš„ input sequenceï¼š $y_1, y_2, \\ldots, y_{Tâ€™}$ï¼Œå¯¹æ¯ä¸ªæ—¶é—´æ­¥ $tâ€™$ï¼ˆç¬¦å·ä¸ input sequence æˆ– encoder çš„æ—¶é—´æ­¥ $t$ æœ‰åŒºåˆ«ï¼‰ï¼Œ decoder è¾“å‡º $y_{tâ€™}$ çš„æ¡ä»¶æ¦‚ç‡å°†åŸºäºä¹‹å‰çš„ output sequenceï¼š $y_1,\\ldots,y_{tâ€™-1}$ å’Œ $c$. å³: P(y\\_{t'} \\mid y\\_1, \\ldots, y\\_{t'-1}, \\boldsymbol{c})ä¸ºæ­¤ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¦ä¸€ä¸ªRNNä½œä¸ºè§£ç å™¨ã€‚ åœ¨è¾“å‡ºåºåˆ—çš„æ—¶é—´æ­¥ $t^\\prime$ï¼Œè§£ç å™¨å°†ä¸Šä¸€æ—¶é—´æ­¥çš„è¾“å‡º $y_{t^\\prime-1}$ ä»¥åŠèƒŒæ™¯å˜é‡ $c$ ä½œä¸ºè¾“å…¥ï¼Œå¹¶å°†å®ƒä»¬ä¸ä¸Šä¸€æ—¶é—´æ­¥çš„éšè—çŠ¶æ€ $\\boldsymbol{h}_{t^\\prime-1}$ å˜æ¢ä¸ºå½“å‰æ—¶é—´æ­¥çš„éšè—çŠ¶æ€ $\\boldsymbol{h}_{t^\\prime}$ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨å‡½æ•° $g$ è¡¨è¾¾è§£ç å™¨éšè—å±‚çš„å˜æ¢ï¼š \\boldsymbol{h}\\_{t^\\prime} = g(y\\_{t^\\prime-1}, \\boldsymbol{c}, \\boldsymbol{h}\\_{t^\\prime-1}).å¯ä½¿ç”¨è‡ªå®šä¹‰çš„ output layer å’Œ softmax è®¡ç®— ${P}(y_{t^\\prime} \\mid y_1, \\ldots, y_{t^\\prime-1}, \\boldsymbol{c})$ï¼Œè®¡ç®—å½“å‰æ—¶é—´æ­¥è¾“å‡º $y_{t^\\prime}$ çš„æ¦‚ç‡åˆ†å¸ƒ. 1.3 decoder greedy searchåœ¨è¯­è¨€æ¨¡å‹ä¹‹å‰æœ‰ä¸€ ä¸ªæ¡ä»¶ä¹Ÿå°±æ˜¯è¢«ç¿»è¯‘çš„å¥å­: P(y^{},â€¦,y^{}|x^{},â€¦,x^{}) ä½†æ˜¯æˆ‘ä»¬çŸ¥é“ç¿»è¯‘æ˜¯æœ‰å¾ˆå¤šç§æ–¹å¼çš„ï¼ŒåŒä¸€å¥è¯å¯ä»¥ç¿»è¯‘æˆå¾ˆå¤šä¸åŒçš„å¥å­ï¼Œé‚£ä¹ˆå¦‚ä½•åˆ¤æ–­å“ªä¸€å¥å­æ˜¯æœ€å¥½çš„å‘¢ï¼Ÿ è¿˜æ˜¯ç¿»è¯‘ä¸Šé¢é‚£å¥è¯ï¼Œæœ‰å¦‚ä¸‹å‡ ç§ç¿»è¯‘ç»“æœï¼š â€œJane is visiting China in September.â€ â€œJane is going to visit China in September.â€ â€œIn September, Jane will visit Chinaâ€ â€œJaneâ€™s Chinese friend welcomed her in September.â€ â€¦. å¾—åˆ°æœ€å¥½çš„ç¿»è¯‘ç»“æœï¼Œè½¬æ¢æˆæ•°å­¦å…¬å¼å°±æ˜¯: argmax P(y^{},â€¦,y^{}|x^{},â€¦,x^{})é‚£ä¹ˆ Greedy Search å°±æ˜¯æ¯æ¬¡è¾“å‡ºçš„é‚£ä¸ªéƒ½å¿…é¡»æ˜¯æœ€å¥½çš„ã€‚è¿˜æ˜¯ä»¥ç¿»è¯‘é‚£å¥è¯ä¸ºä¾‹ã€‚ ç°åœ¨å‡è®¾é€šè¿‡è´ªå©ªæœç´¢å·²ç»ç¡®å®šæœ€å¥½çš„ç¿»è¯‘çš„å‰ä¸¤ä¸ªå•è¯æ˜¯ï¼šâ€Jane is â€œ ç„¶åå› ä¸º â€œgoingâ€ å‡ºç°é¢‘ç‡è¾ƒé«˜å’Œå…¶å®ƒåŸå› ï¼Œæ‰€ä»¥æ ¹æ®è´ªå©ªç®—æ³•å¾—å‡ºæ­¤æ—¶ç¬¬ä¸‰ä¸ªå•è¯çš„æœ€å¥½ç»“æœæ˜¯ â€œgoingâ€ã€‚ æ‰€ä»¥æ®è´ªå©ªç®—æ³•æœ€åçš„ç¿»è¯‘ç»“æœå¯èƒ½æ˜¯ä¸‹å›¾ä¸­çš„ç¬¬äºŒä¸ªå¥å­ï¼Œä½†ç¬¬ä¸€å¥å¯èƒ½ä¼šæ›´å¥½. æ‰€ä»¥ Greedy Search çš„ç¼ºç‚¹æ˜¯å±€éƒ¨æœ€ä¼˜å¹¶ä¸ä»£è¡¨å…¨å±€æœ€ä¼˜. Greedy Search æ›´åŠ çŸ­è§†ï¼Œçœ‹çš„ä¸é•¿è¿œã€‚ 1.4 decoder beam searchBeam Search æ˜¯ greedy search çš„åŠ å¼ºç‰ˆæœ¬ï¼Œé¦–å…ˆè¦é¢„è®¾ä¸€ä¸ªå€¼ beam widthï¼Œè¿™é‡Œç­‰äº 3 (å¦‚æœç­‰äº 1 å°±æ˜¯ greedy search)ã€‚ç„¶ååœ¨æ¯ä¸€æ­¥ä¿å­˜æœ€ä½³çš„ 3 ä¸ªç»“æœè¿›è¡Œä¸‹ä¸€æ­¥çš„é€‰æ‹©ï¼Œä»¥æ­¤ç›´åˆ°é‡åˆ°å¥å­çš„ç»ˆç»“ç¬¦. 1.4.1 step 1å¦‚ä¸‹å›¾ç¤ºï¼Œå› ä¸ºbeam width=3ï¼Œæ‰€ä»¥æ ¹æ®è¾“å…¥çš„éœ€è¦ç¿»è¯‘çš„å¥å­é€‰å‡º 3 ä¸ª $y^{}$æœ€å¯èƒ½çš„è¾“å‡ºå€¼ã€‚ å³é€‰å‡º $P(y^{}|x)$ æœ€å¤§çš„å‰3ä¸ªå€¼ã€‚ å‡è®¾åˆ†åˆ«æ˜¯ â€œinâ€, â€œjaneâ€, â€œseptemberâ€ 1.4.2 step 2ä»¥â€inâ€œä¸ºä¾‹è¿›è¡Œè¯´æ˜ï¼Œå…¶ä»–åŒç†. å¦‚ä¸‹å›¾ç¤ºï¼Œåœ¨ç»™å®šè¢«ç¿»è¯‘å¥å­ $x$ å’Œç¡®å®š $y^{}$ = â€œinâ€œ çš„æ¡ä»¶ä¸‹ï¼Œä¸‹ä¸€ä¸ªè¾“å‡ºå€¼çš„æ¡ä»¶æ¦‚ç‡æ˜¯ $P(y^{}|x,â€inâ€)$ã€‚ æ­¤æ—¶éœ€è¦ä» 10000 ç§å¯èƒ½ä¸­æ‰¾å‡ºæ¡ä»¶æ¦‚ç‡æœ€é«˜çš„å‰ 3 ä¸ª. åˆç”±å…¬å¼: P(y^{},y^{}|x)=P(y^{}|x) P(y^{}|x, y^{})æˆ‘ä»¬æ­¤æ—¶å·²ç»å¾—åˆ°äº†ç»™å®šè¾“å…¥æ•°æ®ï¼Œå‰ä¸¤ä¸ªè¾“å‡ºå€¼çš„è¾“å‡ºæ¦‚ç‡æ¯”è¾ƒå¤§çš„ç»„åˆäº†. å¦å¤– 2 ä¸ªå•è¯ä¹ŸåšåŒæ ·çš„è®¡ç®— æ­¤æ—¶æˆ‘ä»¬å¾—åˆ°äº† 9 ç»„ $P(y^{},y^{}|x)$, æ­¤æ—¶æˆ‘ä»¬å†ä»è¿™ 9ç»„ ä¸­é€‰å‡ºæ¦‚ç‡å€¼æœ€é«˜çš„å‰ 3 ä¸ªã€‚ å¦‚ä¸‹å›¾ç¤ºï¼Œå‡è®¾æ˜¯è¿™3ä¸ªï¼š â€œin septemberâ€ â€œjane isâ€ â€œjane visitsâ€ 1.4.3 step 3ç»§ç»­ step 2 çš„è¿‡ç¨‹ï¼Œæ ¹æ® $P(y^{}|x,y^{},y^{})$ é€‰å‡º $P(y^{},y^{},y^{}|x)$ æœ€å¤§çš„å‰3ä¸ªç»„åˆ. åé¢é‡å¤ä¸Šè¿°æ­¥éª¤å¾—å‡ºç»“æœ. 1.4.4 summaryæ€»ç»“ä¸€ä¸‹ä¸Šé¢çš„æ­¥éª¤å°±æ˜¯ï¼š (1). ç»è¿‡ encoder ä»¥åï¼Œdecoder ç»™å‡ºæœ€æœ‰å¯èƒ½çš„ä¸‰ä¸ªå¼€å¤´è¯ä¾æ¬¡ä¸º â€œinâ€, â€œjaneâ€, â€œseptemberâ€ P(y^{}|x) (2). ç» step 1 å¾—åˆ°çš„å€¼è¾“å…¥åˆ° step 2 ä¸­ï¼Œæœ€å¯èƒ½çš„ä¸‰ä¸ªç¿»è¯‘ä¸º â€œin septemberâ€, â€œjane isâ€, â€œjane visitsâ€ P(y^{}|x,y^{})(è¿™é‡Œï¼Œseptemberå¼€å¤´çš„å¥å­ç”±äºæ¦‚ç‡æ²¡æœ‰å…¶ä»–çš„å¯èƒ½æ€§å¤§ï¼Œå·²ç»å¤±å»äº†ä½œä¸ºå¼€å¤´è¯èµ„æ ¼) (3). ç»§ç»­è¿™ä¸ªè¿‡ç¨‹â€¦ P(y^{}|x,y^{},y^{}) 1.5 refinements to beam search P(y^{},â€¦.,P(y^{T\\_y})|x)=P(y^{}|x)P(y^{}|x,y^{})â€¦P(y^{}|x,y^{},â€¦y^{})æ‰€ä»¥è¦æ»¡è¶³ $argmax P(y^{},â€¦.,P(y^{T_y})|x)$, ä¹Ÿå°±ç­‰åŒäºè¦æ»¡è¶³ argmax \\prod\\_{t=1}^{T\\_y}P(y^{}|x,y^{},â€¦y^{})ä½†æ˜¯ä¸Šé¢çš„å…¬å¼å­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼Œå› ä¸ºæ¦‚ç‡éƒ½æ˜¯å°äº1çš„ï¼Œç´¯ä¹˜ä¹‹åä¼šè¶Šæ¥è¶Šå°ï¼Œå¯èƒ½å°åˆ°è®¡ç®—æœºæ— æ³•ç²¾ç¡®å­˜å‚¨ï¼Œæ‰€ä»¥å¯ä»¥å°†å…¶è½¬å˜æˆ log å½¢å¼ï¼ˆå› ä¸º log æ˜¯å•è°ƒé€’å¢çš„ï¼Œæ‰€ä»¥å¯¹æœ€ç»ˆç»“æœä¸ä¼šæœ‰å½±å“ï¼‰ï¼Œå…¶å…¬å¼å¦‚ä¸‹ï¼š argmax \\sum\\_{t=1}^{T\\_y}logP(y^{}|x,y^{},â€¦y^{}) Butï¼ï¼ï¼ä¸Šè¿°å…¬å¼ä»ç„¶å­˜åœ¨bugï¼Œè§‚å¯Ÿå¯ä»¥çŸ¥é“ï¼Œæ¦‚ç‡å€¼éƒ½æ˜¯å°äº1çš„ï¼Œé‚£ä¹ˆlogä¹‹åéƒ½æ˜¯è´Ÿæ•°ï¼Œæ‰€ä»¥ä¸ºäº†ä½¿å¾—æœ€åçš„å€¼æœ€å¤§ï¼Œé‚£ä¹ˆåªè¦ä¿è¯ç¿»è¯‘çš„å¥å­è¶ŠçŸ­ï¼Œé‚£ä¹ˆå€¼å°±è¶Šå¤§ï¼Œæ‰€ä»¥å¦‚æœä½¿ç”¨è¿™ä¸ªå…¬å¼ï¼Œé‚£ä¹ˆæœ€åç¿»è¯‘çš„å¥å­é€šå¸¸éƒ½æ˜¯æ¯”è¾ƒçŸ­çš„å¥å­ï¼Œè¿™æ˜¾ç„¶ä¸è¡Œã€‚ æ‰€ä»¥æˆ‘ä»¬å¯ä»¥é€šè¿‡å½’ä¸€åŒ–çš„æ–¹å¼æ¥çº æ­£ï¼Œå³ä¿è¯å¹³å‡åˆ°æ¯ä¸ªå•è¯éƒ½èƒ½å¾—åˆ°æœ€å¤§å€¼ã€‚å…¶å…¬å¼å¦‚ä¸‹ï¼š argmax \\frac{1}{T\\_y}\\sum\\_{t=1}^{T\\_y}logP(y^{}|x,y^{},â€¦y^{})å½’ä¸€åŒ–çš„ç¡®èƒ½å¾ˆå¥½çš„è§£å†³ä¸Šè¿°é—®é¢˜ï¼Œä½†æ˜¯åœ¨å®é™…è¿ç”¨ä¸­ï¼Œä¼šé¢å¤–æ·»åŠ ä¸€ä¸ªå‚æ•° $Î±$, å…¶å¤§å°ä»‹äº 0 å’Œ 1 ä¹‹é—´ argmax \\frac{1}{T\\_y^Î±}\\sum\\_{t=1}^{T\\_y}logP(y^{}|x,y^{},â€¦y^{}) $T_y$ ä¸ºè¾“å‡ºå¥å­ä¸­å•è¯çš„ä¸ªæ•°ï¼Œ$Î±$ æ˜¯ä¸€ä¸ªè¶…å‚æ•° (å¯ä»¥è®¾ç½®ä¸º 0.7) $Î±$ == 1. åˆ™ä»£è¡¨ å®Œå…¨ç”¨å¥å­é•¿åº¦å½’ä¸€åŒ–$Î±$ == 0. åˆ™ä»£è¡¨ æ²¡æœ‰å½’ä¸€åŒ–$Î±$ == 0~1. åˆ™ä»£è¡¨ åœ¨ å¥å­é•¿åº¦å½’ä¸€åŒ– ä¸ æ²¡æœ‰å½’ä¸€åŒ– ä¹‹é—´çš„æŠ˜ä¸­ç¨‹åº¦. beam width = B = 3~10~100 æ˜¯ä¼šæœ‰ä¸€ä¸ªæ˜æ˜¾çš„å¢é•¿ï¼Œä½†æ˜¯ B ä» 1000 ~ 3000 æ˜¯å¹¶æ²¡æœ‰ä¸€ä¸ªæ˜æ˜¾å¢é•¿çš„. 1.6 train seq2seq modelæ ¹æ®æœ€å¤§ä¼¼ç„¶ä¼°è®¡ï¼Œæˆ‘ä»¬å¯ä»¥æœ€å¤§åŒ–è¾“å‡ºåºåˆ—åŸºäºè¾“å…¥åºåˆ—çš„æ¡ä»¶æ¦‚ç‡ \\begin{split}\\begin{aligned} {P}(y\\_1, \\ldots, y\\_{T'} \\mid x\\_1, \\ldots, x\\_T) &= \\prod\\_{t'=1}^{T'} {P}(y\\_{t'} \\mid y\\_1, \\ldots, y\\_{t'-1}, x\\_1, \\ldots, x\\_T)\\\\\\\\ &= \\prod\\_{t'=1}^{T'} {P}(y\\_{t'} \\mid y\\_1, \\ldots, y\\_{t'-1}, \\boldsymbol{c}), \\end{aligned}\\end{split}å¹¶å¾—åˆ°è¯¥è¾“å‡ºåºåˆ—çš„æŸå¤± - \\log{P}(y\\_1, \\ldots, y\\_{T'} \\mid x\\_1, \\ldots, x\\_T) = -\\sum\\_{t'=1}^{T'} \\log {P}(y\\_{t'} \\mid y\\_1, \\ldots, y\\_{t'-1}, \\boldsymbol{c}), åœ¨æ¨¡å‹è®­ç»ƒä¸­ï¼Œæ‰€æœ‰è¾“å‡ºåºåˆ—æŸå¤±çš„å‡å€¼é€šå¸¸ä½œä¸ºéœ€è¦æœ€å°åŒ–çš„æŸå¤±å‡½æ•°ã€‚åœ¨å›¾ä¸­æ‰€æè¿°çš„æ¨¡å‹é¢„æµ‹ä¸­ï¼Œæˆ‘ä»¬éœ€è¦å°†decodeåœ¨ä¸Šä¸€ä¸ªæ—¶é—´æ­¥çš„è¾“å‡ºä½œä¸ºå½“å‰æ—¶é—´æ­¥çš„è¾“å…¥ã€‚ä¸æ­¤ä¸åŒï¼Œåœ¨è®­ç»ƒä¸­æˆ‘ä»¬ä¹Ÿå¯ä»¥å°†æ ‡ç­¾åºåˆ—åœ¨ä¸Šä¸€ä¸ªæ—¶é—´æ­¥çš„æ ‡ç­¾ä½œä¸ºdecodeåœ¨å½“å‰æ—¶é—´æ­¥çš„è¾“å…¥ã€‚è¿™å«åšå¼ºåˆ¶æ•™å­¦ï¼ˆteacher forcingï¼‰ã€‚ 1.7 summary ç¼–ç å™¨ - è§£ç å™¨ï¼ˆseq2seqï¼‰å¯ä»¥è¾“å…¥å¹¶è¾“å‡ºä¸å®šé•¿çš„åºåˆ—ã€‚ ç¼–ç å™¨â€”è§£ç å™¨ä½¿ç”¨äº†ä¸¤ä¸ª RNNã€‚ åœ¨ç¼–ç å™¨â€”è§£ç å™¨çš„è®­ç»ƒä¸­ï¼Œæˆ‘ä»¬å¯ä»¥é‡‡ç”¨ teacher forcingã€‚(è¿™ä¹Ÿæ˜¯ Seq2Seq 2 çš„å†…å®¹) 2. Seq2Seq æ¡†æ¶2Seq2Seq model æ¥è‡ªäº â€œSequence to Sequence Learning with Neural Networksâ€ å…¶æ¨¡å‹ç»“æ„å›¾å¦‚ä¸‹æ‰€ç¤ºï¼š ä¸ä¸Šé¢æ¨¡å‹æœ€å¤§çš„åŒºåˆ«åœ¨äºå…¶sourceç¼–ç åçš„ å‘é‡$C$ ç›´æ¥ä½œä¸º Decoder RNN çš„ init stateï¼Œè€Œä¸æ˜¯åœ¨æ¯æ¬¡decodeæ—¶éƒ½ä½œä¸º RNN cell çš„è¾“å…¥ã€‚æ­¤å¤–ï¼Œdecode æ—¶ RNN çš„è¾“å…¥æ˜¯ labelï¼Œè€Œä¸æ˜¯å‰ä¸€æ—¶åˆ»çš„è¾“å‡ºã€‚ Encoder é˜¶æ®µï¼š æ¯ä¸ªè¯ç»è¿‡ RNN éƒ½ä¼šç¼–ç ä¸º hidden (e0,e1,e2), sourceåºåˆ— çš„ç¼–ç å‘é‡e å°±æ˜¯ æœ€ç»ˆçš„ hidden state e2 Tipsï¼š è¿™é‡Œ $e_0, e_1, e_2$ æ˜¯ hidden stateï¼Œ å¹¶æ²¡æœ‰ç»è¿‡ g å’Œ softmax . Decoder é˜¶æ®µï¼š eå‘é‡ ä»…ä½œä¸º RNN çš„ init state ä¼ å…¥decodeæ¨¡å‹ï¼Œæ¯ä¸€æ—¶åˆ»è¾“å…¥éƒ½æ˜¯å‰ä¸€æ—¶åˆ»çš„æ­£ç¡®labelã€‚ç›´åˆ°æœ€ç»ˆè¾“å…¥ç¬¦å·æˆªæ­¢. 3. Seq2Seq Attentionè¯·åŠ¡å¿…è¦é˜…è¯»ï¼š å¼ ä¿Šæ— æ·±åº¦å­¦ä¹ ä¸­çš„æ³¨æ„åŠ›æ¨¡å‹ï¼ˆ2017ç‰ˆï¼‰ decode åœ¨å„ä¸ªæ—¶é—´æ­¥ä¾èµ–ç›¸åŒçš„ èƒŒæ™¯å˜é‡ $c$ æ¥è·å–è¾“å…¥åºåˆ—ä¿¡æ¯ã€‚å½“ encode ä¸º RNN æ—¶ï¼ŒèƒŒæ™¯å˜é‡$c$ æ¥è‡ªå®ƒæœ€ç»ˆæ—¶é—´æ­¥çš„ hidden stateã€‚ è‹±è¯­è¾“å…¥ï¼šâ€œTheyâ€ã€â€œareâ€ã€â€œwatchingâ€ã€â€œ.â€æ³•è¯­è¾“å‡ºï¼šâ€œIlsâ€ã€â€œregardentâ€ã€â€œ.â€ ç¿»è¯‘ä¾‹å­ï¼šè¾“å…¥ä¸ºè‹±è¯­åºåˆ—â€œTheyâ€ã€â€œareâ€ã€â€œwatchingâ€ã€â€œ.â€ï¼Œè¾“å‡ºä¸ºæ³•è¯­åºåˆ—â€œIlsâ€ã€â€œregardentâ€ã€â€œ.â€ã€‚ï¼Œdecode åœ¨ç”Ÿæˆè¾“å‡ºåºåˆ—ä¸­çš„æ¯ä¸€ä¸ªè¯æ—¶å¯èƒ½åªéœ€åˆ©ç”¨è¾“å…¥åºåˆ—æŸä¸€éƒ¨åˆ†çš„ä¿¡æ¯ã€‚ä¾‹å¦‚ï¼Œåœ¨è¾“å‡ºåºåˆ—çš„æ—¶é—´æ­¥ 1ï¼Œè§£ç å™¨å¯ä»¥ä¸»è¦ä¾èµ–â€œTheyâ€ã€â€œareâ€çš„ä¿¡æ¯æ¥ç”Ÿæˆâ€œIlsâ€ï¼Œåœ¨æ—¶é—´æ­¥ 2 åˆ™ä¸»è¦ä½¿ç”¨æ¥è‡ªâ€œwatchingâ€çš„ç¼–ç ä¿¡æ¯ç”Ÿæˆâ€œregardentâ€ï¼Œæœ€ååœ¨æ—¶é—´æ­¥ 3 åˆ™ç›´æ¥æ˜ å°„å¥å·â€œ.â€ã€‚è¿™çœ‹ä¸Šå»å°±åƒæ˜¯åœ¨ decode çš„æ¯ä¸€æ—¶é—´æ­¥å¯¹è¾“å…¥åºåˆ—ä¸­ä¸åŒæ—¶é—´æ­¥çš„ç¼–ç ä¿¡æ¯åˆ†é…ä¸åŒçš„æ³¨æ„åŠ›ä¸€æ ·ã€‚è¿™ä¹Ÿæ˜¯æ³¨æ„åŠ›æœºåˆ¶çš„ç”±æ¥ 1ã€‚ ä»ä»¥ RNN ä¸ºä¾‹ï¼ŒAttention é€šè¿‡å¯¹ Encode æ‰€æœ‰æ—¶é—´æ­¥çš„éšè—çŠ¶æ€åšåŠ æƒå¹³å‡æ¥å¾—åˆ°èƒŒæ™¯å˜é‡$c$ã€‚Decode åœ¨æ¯ä¸€æ—¶é—´æ­¥è°ƒæ•´è¿™äº›æƒé‡ï¼Œå³ Attention weightï¼Œä»è€Œèƒ½å¤Ÿåœ¨ä¸åŒæ—¶é—´æ­¥åˆ†åˆ«å…³æ³¨è¾“å…¥åºåˆ—ä¸­çš„ä¸åŒéƒ¨åˆ†å¹¶ç¼–ç è¿›ç›¸åº”æ—¶é—´æ­¥çš„èƒŒæ™¯å˜é‡$c$ã€‚æœ¬èŠ‚æˆ‘ä»¬å°†è®¨è®º Attentionæœºåˆ¶ æ˜¯æ€ä¹ˆå·¥ä½œçš„ã€‚ åœ¨â€œencoder-decoderï¼ˆseq2seqï¼‰â€, Decoder åœ¨æ—¶é—´æ­¥ $tâ€™$ çš„ hidden state \\boldsymbol{s}\\_{t'} = g(\\boldsymbol{y}\\_{t'-1}, \\boldsymbol{c}, \\boldsymbol{s}\\_{t'-1})åœ¨ Attentionæœºåˆ¶ ä¸­, Decoder çš„æ¯ä¸€æ—¶é—´æ­¥å°†ä½¿ç”¨å¯å˜çš„èƒŒæ™¯å˜é‡$c$ \\boldsymbol{s}\\_{t'} = g(\\boldsymbol{y}\\_{t'-1}, \\boldsymbol{c}\\_{t'}, \\boldsymbol{s}\\_{t'-1}).å…³é”®æ˜¯å¦‚ä½•è®¡ç®—èƒŒæ™¯å˜é‡ $\\boldsymbol{c}_{tâ€™}$ å’Œå¦‚ä½•åˆ©ç”¨å®ƒæ¥æ›´æ–°éšè—çŠ¶æ€ $\\boldsymbol{s}_{tâ€™}$ã€‚ä»¥ä¸‹å°†åˆ†åˆ«æè¿°è¿™ä¸¤ä¸ªå…³é”®ç‚¹ã€‚ 3.1 è®¡ç®—èƒŒæ™¯å˜é‡ c \\boldsymbol{c}\\_{t'} = \\sum\\_{t=1}^T \\alpha\\_{t' t} \\boldsymbol{h}\\_t,å…¶ä¸­ç»™å®š $tâ€™$ æ—¶ï¼Œæƒé‡ $\\alpha_{tâ€™ t}$ åœ¨ $t=1,\\ldots,T$ çš„å€¼æ˜¯ä¸€ä¸ªæ¦‚ç‡åˆ†å¸ƒã€‚ä¸ºäº†å¾—åˆ°æ¦‚ç‡åˆ†å¸ƒï¼Œå¯ä»¥ä½¿ç”¨ softmax è¿ç®—: \\alpha\\_{t' t} = \\frac{\\exp(e\\_{t' t})}{ \\sum\\_{k=1}^T \\exp(e\\_{t' k}) },\\quad t=1,\\ldots,T.ç°åœ¨ï¼Œæˆ‘ä»¬éœ€è¦å®šä¹‰å¦‚ä½•è®¡ç®—ä¸Šå¼ä¸­ softmax è¿ç®—çš„è¾“å…¥ $e_{tâ€™ t}$ã€‚ç”±äº $e_{tâ€™ t}$ åŒæ—¶å–å†³äºdecodeçš„æ—¶é—´æ­¥ $tâ€™$ å’Œencodeçš„æ—¶é—´æ­¥ $t$ï¼Œæˆ‘ä»¬ä¸å¦¨ä»¥è§£ç å™¨åœ¨æ—¶é—´æ­¥ $tâ€™âˆ’1$ çš„éšè—çŠ¶æ€ $\\boldsymbol{s}_{tâ€™ - 1}$ ä¸ç¼–ç å™¨åœ¨æ—¶é—´æ­¥ $t$ çš„éšè—çŠ¶æ€ $h_t$ ä¸ºè¾“å…¥ï¼Œå¹¶é€šè¿‡å‡½æ•° $a$ è®¡ç®— $e_{tâ€™ t}$ï¼š e\\_{t' t} = a(\\boldsymbol{s}\\_{t' - 1}, \\boldsymbol{h}\\_t).è¿™é‡Œå‡½æ•° a æœ‰å¤šç§é€‰æ‹©ï¼Œå¦‚æœä¸¤ä¸ªè¾“å…¥å‘é‡é•¿åº¦ç›¸åŒï¼Œä¸€ä¸ªç®€å•çš„é€‰æ‹©æ˜¯è®¡ç®—å®ƒä»¬çš„å†…ç§¯ $a(\\boldsymbol{s}, \\boldsymbol{h})=\\boldsymbol{s}^\\top \\boldsymbol{h}$ã€‚è€Œæœ€æ—©æå‡ºAttentionæœºåˆ¶çš„è®ºæ–‡åˆ™å°†è¾“å…¥è¿ç»“åé€šè¿‡å«å•éšè—å±‚çš„å¤šå±‚æ„ŸçŸ¥æœºMLP å˜æ¢ a(\\boldsymbol{s}, \\boldsymbol{h}) = \\boldsymbol{v}^\\top \\tanh(\\boldsymbol{W}\\_s \\boldsymbol{s} + \\boldsymbol{W}\\_h \\boldsymbol{h}),å…¶ä¸­ $vã€W_sã€W_h$ éƒ½æ˜¯å¯ä»¥å­¦ä¹ çš„æ¨¡å‹å‚æ•°ã€‚ 3.2 update hidden stateä»¥ GRU ä¸ºä¾‹ï¼Œåœ¨è§£ç å™¨ä¸­æˆ‘ä»¬å¯ä»¥å¯¹ GRU çš„è®¾è®¡ç¨ä½œä¿®æ”¹ã€‚è§£ç å™¨åœ¨æ—¶é—´æ­¥ $tâ€™$ çš„éšè—çŠ¶æ€ä¸º \\boldsymbol{s}\\_{t'} = \\boldsymbol{z}\\_{t'} \\odot \\boldsymbol{s}\\_{t'-1} + (1 - \\boldsymbol{z}\\_{t'}) \\odot \\tilde{\\boldsymbol{s}}\\_{t'},å…¶ä¸­çš„é‡ç½®é—¨ã€æ›´æ–°é—¨å’Œå€™é€‰éšå«çŠ¶æ€åˆ†åˆ«ä¸º : \\begin{split}\\begin{aligned} \\boldsymbol{r}\\_{t'} &= \\sigma(\\boldsymbol{W}\\_{yr} \\boldsymbol{y}\\_{t'-1} + \\boldsymbol{W}\\_{sr} \\boldsymbol{s}\\_{t' - 1} + \\boldsymbol{W}\\_{cr} \\boldsymbol{c}\\_{t'} + \\boldsymbol{b}\\_r),\\\\\\\\ \\boldsymbol{z}\\_{t'} &= \\sigma(\\boldsymbol{W}\\_{yz} \\boldsymbol{y}\\_{t'-1} + \\boldsymbol{W}\\_{sz} \\boldsymbol{s}\\_{t' - 1} + \\boldsymbol{W}\\_{cz} \\boldsymbol{c}\\_{t'} + \\boldsymbol{b}\\_z),\\\\\\\\ \\tilde{\\boldsymbol{s}}\\_{t'} &= \\text{tanh}(\\boldsymbol{W}\\_{ys} \\boldsymbol{y}\\_{t'-1} + \\boldsymbol{W}\\_{ss} (\\boldsymbol{s}\\_{t' - 1} \\odot \\boldsymbol{r}\\_{t'}) + \\boldsymbol{W}\\_{cs} \\boldsymbol{c}\\_{t'} + \\boldsymbol{b}\\_s), \\end{aligned}\\end{split}å…¶ä¸­å«ä¸‹æ ‡çš„ W å’Œ b åˆ†åˆ«ä¸º GRU çš„æƒé‡å‚æ•°å’Œåå·®å‚æ•°ã€‚ 3.3 attention summary å¯ä»¥åœ¨decodeçš„æ¯ä¸ªæ—¶é—´æ­¥ä½¿ç”¨ä¸åŒçš„èƒŒæ™¯å˜é‡ï¼Œå¹¶å¯¹è¾“å…¥åºåˆ—ä¸­ä¸åŒæ—¶é—´æ­¥ç¼–ç çš„ä¿¡æ¯åˆ†é…ä¸åŒçš„æ³¨æ„åŠ›ã€‚ Attentionæœºåˆ¶å¯ä»¥é‡‡ç”¨æ›´ä¸ºé«˜æ•ˆçš„çŸ¢é‡åŒ–è®¡ç®—ã€‚ é™¤æ­¤ä¹‹å¤–æ¨¡å‹ä¸ºäº†å–å¾—æ¯”è¾ƒå¥½çš„æ•ˆæœè¿˜æ˜¯ç”¨äº†ä¸‹é¢ä¸‰ä¸ªå°æŠ€å·§æ¥æ”¹å–„æ€§èƒ½ï¼š æ·±å±‚æ¬¡çš„LSTMï¼šä½œè€…ä½¿ç”¨äº†4å±‚LSTMä½œä¸ºencoderå’Œdecoderæ¨¡å‹ï¼Œå¹¶ä¸”è¡¨ç¤ºæ·±å±‚æ¬¡çš„æ¨¡å‹æ¯”shallowçš„æ¨¡å‹æ•ˆæœè¦å¥½ï¼ˆå•å±‚ï¼Œç¥ç»å…ƒä¸ªæ•°å¤šï¼‰ã€‚ å°†sourceè¿›è¡Œååºè¾“å…¥ï¼šè¾“å…¥çš„æ—¶å€™å°†â€œABCâ€å˜æˆâ€œCBAâ€ï¼Œè¿™æ ·åšçš„å¥½å¤„æ˜¯è§£å†³äº†é•¿åºåˆ—çš„long-termä¾èµ–ï¼Œä½¿å¾—æ¨¡å‹å¯ä»¥å­¦ä¹ åˆ°æ›´å¤šçš„å¯¹åº”å…³ç³»ï¼Œä»è€Œè¾¾åˆ°æ¯”è¾ƒå¥½çš„æ•ˆæœã€‚ æ³¨æ„åŠ›æœºåˆ¶æ˜¯ä¸€ç§æ€æƒ³ï¼Œå¯ä»¥æœ‰å¤šç§ä¸åŒçš„å®ç°æ–¹å¼ï¼Œåœ¨ Seq2Seq æ¨¡å‹ä»¥å¤–çš„åœºæ™¯ä¹Ÿæœ‰ä¸å°‘åº”ç”¨ 4. Attention æœ¬è´¨æ€æƒ³æŠŠAttentionæœºåˆ¶ä»ä¸Šæ–‡è®²è¿°ä¾‹å­ä¸­çš„Encoder-Decoderæ¡†æ¶ä¸­å‰¥ç¦»ï¼Œå¹¶è¿›ä¸€æ­¥åšæŠ½è±¡ï¼Œå¯ä»¥æ›´å®¹æ˜“æ‡‚: 4.1 Attention çš„ä¸‰é˜¶æ®µ ç¬¬ä¸€ä¸ªé˜¶æ®µæ ¹æ®Queryå’ŒKeyè®¡ç®—ä¸¤è€…çš„ç›¸ä¼¼æ€§æˆ–è€…ç›¸å…³æ€§ï¼› ç¬¬äºŒä¸ªé˜¶æ®µå¯¹ç¬¬ä¸€é˜¶æ®µçš„åŸå§‹åˆ†å€¼è¿›è¡Œå½’ä¸€åŒ–å¤„ç†ï¼› æ ¹æ®æƒé‡ç³»æ•°å¯¹Valueè¿›è¡ŒåŠ æƒæ±‚å’Œã€‚ 4.2 Self AttentionAttentioné¡¾åæ€ä¹‰ï¼ŒæŒ‡çš„ä¸æ˜¯Targetå’ŒSourceä¹‹é—´çš„Attentionæœºåˆ¶ï¼Œè€Œæ˜¯Sourceå†…éƒ¨å…ƒç´ ä¹‹é—´æˆ–è€…Targetå†…éƒ¨å…ƒç´ ä¹‹é—´å‘ç”Ÿçš„Attentionæœºåˆ¶ï¼Œä¹Ÿå¯ä»¥ç†è§£ä¸ºTarget=Sourceè¿™ç§ç‰¹æ®Šæƒ…å†µä¸‹çš„æ³¨æ„åŠ›è®¡ç®—æœºåˆ¶ã€‚ å¼•å…¥Self Attentionåä¼šæ›´å®¹æ˜“æ•è·å¥å­ä¸­é•¿è·ç¦»çš„ç›¸äº’ä¾èµ–çš„ç‰¹å¾ï¼Œå› ä¸ºå¦‚æœæ˜¯RNNæˆ–è€…LSTMï¼Œéœ€è¦ä¾æ¬¡åºåºåˆ—è®¡ç®—ï¼Œå¯¹äºè¿œè·ç¦»çš„ç›¸äº’ä¾èµ–çš„ç‰¹å¾ï¼Œè¦ç»è¿‡è‹¥å¹²æ—¶é—´æ­¥æ­¥éª¤çš„ä¿¡æ¯ç´¯ç§¯æ‰èƒ½å°†ä¸¤è€…è”ç³»èµ·æ¥ï¼Œè€Œè·ç¦»è¶Šè¿œï¼Œæœ‰æ•ˆæ•è·çš„å¯èƒ½æ€§è¶Šå°ã€‚ è¯·åŠ¡å¿…è¦é˜…è¯»ï¼š å¼ ä¿Šæ— æ·±åº¦å­¦ä¹ ä¸­çš„æ³¨æ„åŠ›æ¨¡å‹ï¼ˆ2017ç‰ˆï¼‰ Reference åŠ¨æ‰‹å­¦æ·±åº¦å­¦ä¹ ç¬¬åå…«è¯¾ï¼šseq2seqï¼ˆç¼–ç å™¨å’Œè§£ç å™¨ï¼‰å’Œæ³¨æ„åŠ›æœºåˆ¶ seq2seq+Attentionæœºåˆ¶æ¨¡å‹è¯¦è§£ æ·±åº¦å­¦ä¹ å‰æ²¿ç¬”è®° ç™¾é¢ seq2seqæ¨¡å‹ ç™¾é¢ æ³¨æ„åŠ›æœºåˆ¶ Berté‡ä¸ŠKeras Sequence-Models-week3 seq2seqä¸­çš„beam searchç®—æ³•è¿‡ç¨‹ æ·±åº¦å­¦ä¹ ä¸­çš„æ³¨æ„åŠ›æ¨¡å‹ï¼ˆ2017ç‰ˆï¼‰","categories":[{"name":"deeplearning","slug":"deeplearning","permalink":"http://iequa.com/categories/deeplearning/"}],"tags":[{"name":"Seq2Seq","slug":"Seq2Seq","permalink":"http://iequa.com/tags/Seq2Seq/"}]},{"title":"Language Model and Perplexity","slug":"nlp/Language-Model-and-Word-Embedding","date":"2019-06-16T03:00:21.000Z","updated":"2021-02-08T00:47:24.070Z","comments":true,"path":"2019/06/16/nlp/Language-Model-and-Word-Embedding/","link":"","permalink":"http://iequa.com/2019/06/16/nlp/Language-Model-and-Word-Embedding/","excerpt":"","text":"è®¡ç®—æœºå¾ˆå¤šäº‹æƒ…æ¯”äººç±»åšå¾—å¥½ï¼Œé‚£ä¹ˆæœºå™¨æ˜¯å¦èƒ½æ‡‚ Natural Language? ä¸€äº› NLP æŠ€æœ¯çš„åº”ç”¨: ç®€å•çš„ä»»åŠ¡ï¼šæ‹¼å†™æ£€æŸ¥ï¼Œå…³é”®è¯æ£€ç´¢ï¼ŒåŒä¹‰è¯æ£€ç´¢ç­‰ å¤æ‚çš„ä»»åŠ¡ï¼šä¿¡æ¯æå–ã€æƒ…æ„Ÿåˆ†æã€æ–‡æœ¬åˆ†ç±»ç­‰ æ›´å¤æ‚ä»»åŠ¡ï¼šæœºå™¨ç¿»è¯‘ã€äººæœºå¯¹è¯ã€QAç³»ç»Ÿ Natural Language é€æ¸æ¼”å˜æˆä¸€ç§ ä¸Šä¸‹æ–‡ä¿¡æ¯è¡¨è¾¾ å’Œ ä¼ é€’ çš„æ–¹å¼ã€‚ è®©è®¡ç®—æœºå¤„ç†è‡ªç„¶è¯­è¨€ï¼Œä¸€ä¸ªåŸºæœ¬çš„é—®é¢˜å°±æ˜¯ä¸º è‡ªç„¶è¯­è¨€ è¿™ç§ ä¸Šä¸‹æ–‡ç›¸å…³çš„ç‰¹æ€§ å»ºç«‹æ•°å­¦æ¨¡å‹ã€‚ 1. Language Model ç¾è”å‚¨ä¸»å¸­æ˜¨å¤©å‘Šè¯‰åª’ä½“ 7000 äº¿ç¾é‡‘çš„æ•‘åŠ©èµ„é‡‘å°†å€Ÿç»™ä¸Šç™¾å®¶é“¶è¡Œã€æ±½è½¦å…¬å¸ã€‚ ç¾è”å‚¨ä¸»å¸­æ˜¨å¤© 7000 äº¿ç¾é‡‘çš„æ•‘åŠ©èµ„é‡‘å‘Šè¯‰åª’ä½“å°†å€Ÿç»™ä¸Šç™¾å®¶é“¶è¡Œã€æ±½è½¦å…¬å¸ã€‚ ç¾è”å‚¨ä¸»å¸­æ˜¨å¤© å‘Šåª’è¯‰ä½“ 70 äº¿00ç¾é‡‘çš„æ•‘åŠ©èµ„é‡‘ä¸Šç™¾å®¶é“¶è¡Œå°†å€Ÿç»™ã€æ±½è½¦å…¬å¸ã€‚ ä¸Šä¸–çºª70å¹´ä»£ç§‘å­¦å®¶ä»¬è¯•å›¾ç”¨è§„åˆ™æ–‡æ³•åˆ¤æ–­å¥å­æ˜¯å¦åˆç†ã€‚è´¾é‡Œå°¼å…‹ç”¨ç»Ÿè®¡æ¨¡å‹è§£å†³æ–¹æ³•æ›´æœ‰æ•ˆã€‚ å¦‚æœ S è¡¨ç¤ºä¸€è¿ä¸²ç‰¹å®šé¡ºåºæ’åˆ—çš„è¯ $w_1$ï¼Œ $w_2$ï¼Œâ€¦ï¼Œ $w_n$ ï¼Œæ¢å¥è¯è¯´ï¼ŒS è¡¨ç¤ºçš„æ˜¯ä¸€ä¸ªæœ‰æ„ä¹‰çš„å¥å­ã€‚æœºå™¨å¯¹è¯­è¨€çš„è¯†åˆ«ä»æŸç§è§’åº¦æ¥è¯´ï¼Œå°±æ˜¯æƒ³çŸ¥é“ S åœ¨æ–‡æœ¬ä¸­å‡ºç°çš„å¯èƒ½æ€§ï¼Œä¹Ÿå°±æ˜¯æ•°å­¦ä¸Šæ‰€è¯´çš„ S çš„æ¦‚ç‡ç”¨ P(S) æ¥è¡¨ç¤ºã€‚åˆ©ç”¨æ¡ä»¶æ¦‚ç‡çš„å…¬å¼ï¼ŒS è¿™ä¸ªåºåˆ—å‡ºç°çš„æ¦‚ç‡ç­‰äºæ¯ä¸€ä¸ªè¯å‡ºç°çš„æ¦‚ç‡ç›¸ä¹˜ï¼Œäºæ˜¯ P(S) å¯å±•å¼€ä¸ºï¼š P(S) = P(w_1)P(w_2|w_1)P(w_3| w_1 w_2)â€¦P(w_n|w_1 w_2â€¦w_{n-1})1.1 Markov assumptionå‡å®šæ–‡æœ¬ä¸­çš„æ¯ä¸ªè¯ $wi$ å’Œ å‰é¢N-1ä¸ªè¯æœ‰å…³ï¼Œè€Œå’Œæ›´å‰é¢çš„è¯æ— å…³ï¼Œè¿™æ ·å½“å‰è¯ $w_i$ çš„æ¦‚ç‡å€¼å–å†³äºå‰é¢ N-1ä¸ªè¯ $P(w{i-N+1}, w{i-N+2}, â€¦, w{i-1})$ P(w_{i}|w_{1}, w_{2}, ..., w_{i-1}) = P(w_i | w_{i-N+1}, w_{i-N+2}, ..., w_{i-1}) Nå…ƒæ¨¡å‹ï¼Œ N=2 æ—¶ï¼Œä¸ºäºŒå…ƒæ¨¡å‹ã€‚ åœ¨å®é™…ä¸­åº”ç”¨æœ€å¤šçš„æ˜¯ N=3 çš„ä¸‰å…ƒæ¨¡å‹. 1.2 n-gram, n=2 P(S) = P(w_1)P(w_2|w_1)P(w_3|w_2)â€¦P(w_i|w_{i-1})â€¦æ¥ä¸‹æ¥å¦‚ä½•ä¼°è®¡ $P (wi|w{i-1})$ã€‚åªè¦æœºå™¨æ•°ä¸€æ•°è¿™å¯¹è¯ $(wi{-1}, w_i)$ åœ¨ç»Ÿè®¡çš„æ–‡æœ¬ä¸­å‡ºç°äº†å¤šå°‘æ¬¡ï¼Œä»¥åŠ $w{i-1}$ æœ¬èº«åœ¨åŒæ ·çš„æ–‡æœ¬ä¸­å‰åç›¸é‚»å‡ºç°äº†å¤šå°‘æ¬¡ï¼Œç„¶åç”¨ä¸¤ä¸ªæ•°ä¸€é™¤å°±å¯ä»¥äº†, P(w_i|w_{i-1}) = \\frac {P(w_{i-1}, w_i)} {P(w_{i-1})}2. Perplexity, PPLè¯­è¨€æ¨¡å‹æ•ˆæœçš„å¸¸ç”¨æŒ‡æ ‡ perplexityï¼Œ åœ¨æµ‹è¯•é›†ä¸Š perplexity è¶Šä½ï¼Œè¯´æ˜å»ºæ¨¡æ•ˆæœè¶Šå¥½. è®¡ç®—perplexityçš„å…¬å¼å¦‚ä¸‹ï¼š perplexity åˆ»ç”»çš„æ˜¯è¯­è¨€æ¨¡å‹é¢„æµ‹ä¸€ä¸ªè¯­è¨€æ ·æœ¬çš„èƒ½åŠ›. æ¯”å¦‚å·²ç»çŸ¥é“ (w1,w2,w3,â€¦,wm) è¿™å¥è¯ä¼šå‡ºç°åœ¨è¯­æ–™åº“ä¹‹ä¸­ï¼Œé‚£ä¹ˆé€šè¿‡è¯­è¨€æ¨¡å‹è®¡ç®—å¾—åˆ°çš„è¿™å¥è¯çš„æ¦‚ç‡è¶Šé«˜ï¼Œè¯´æ˜è¯­è¨€æ¨¡å‹å¯¹è¿™ä¸ªè¯­æ–™åº“æ‹Ÿåˆå¾—è¶Šå¥½ã€‚ perplexity å®é™…æ˜¯è®¡ç®—æ¯ä¸€ä¸ªå•è¯å¾—åˆ°çš„æ¦‚ç‡å€’æ•°çš„å‡ ä½•å¹³å‡ï¼Œå› æ­¤ perplexity å¯ä»¥ç†è§£ä¸ºå¹³å‡åˆ†æ”¯ç³»æ•°ï¼ˆaverage branching factorï¼‰ï¼Œå³æ¨¡å‹é¢„æµ‹ä¸‹ä¸€ä¸ªè¯æ—¶çš„å¹³å‡å¯é€‰æ‹©æ•°é‡ã€‚ ä¾‹å¦‚ï¼Œè€ƒè™‘ä¸€ä¸ªç”±0~9è¿™10ä¸ªæ•°å­—éšæœºç»„æˆçš„é•¿åº¦ä¸ºmçš„åºåˆ—ï¼Œç”±äºè¿™10ä¸ªæ•°å­—å‡ºç°çš„æ¦‚ç‡æ˜¯éšæœºçš„ï¼Œæ‰€ä»¥æ¯ä¸ªæ•°å­—å‡ºç°çš„æ¦‚ç‡æ˜¯ ã€‚å› æ­¤ï¼Œåœ¨ä»»æ„æ—¶åˆ»ï¼Œæ¨¡å‹éƒ½æœ‰10ä¸ªç­‰æ¦‚ç‡çš„å€™é€‰ç­”æ¡ˆå¯ä»¥é€‰æ‹©ï¼Œäºæ˜¯perplexityå°±æ˜¯10ï¼ˆæœ‰10ä¸ªåˆç†çš„ç­”æ¡ˆï¼‰ã€‚ perplexityçš„è®¡ç®—è¿‡ç¨‹å¦‚ä¸‹ï¼š åœ¨è¯­è¨€æ¨¡å‹çš„è®­ç»ƒä¸­ï¼Œé€šå¸¸é‡‡ç”¨ perplexity çš„å¯¹æ•°è¡¨è¾¾å½¢å¼ï¼š ç›¸æ¯”è¾ƒä¹˜ç§¯æ±‚å¹³æ–¹æ ¹çš„æ–¹å¼ï¼ŒåŠ æ³•çš„å½¢å¼å¯åŠ é€Ÿè®¡ç®—ï¼ŒåŒæ—¶é¿å…æ¦‚ç‡ä¹˜ç§¯æ•°å€¼è¿‡å°è€Œå¯¼è‡´æµ®ç‚¹æ•°å‘ä¸‹æº¢å‡ºçš„é—®é¢˜. åœ¨æ•°å­¦ä¸Šï¼Œlog perplexity å¯ä»¥çœ‹ä½œçœŸå®åˆ†å¸ƒä¸é¢„æµ‹åˆ†å¸ƒä¹‹é—´çš„äº¤å‰ç†µ Cross Entropy, äº¤å‰ç†µæè¿°äº†ä¸¤ä¸ªæ¦‚ç‡åˆ†å¸ƒä¹‹é—´çš„ä¸€ç§è·ç¦». log perplexity å’Œ Cross Entropy æ˜¯ç­‰ä»·çš„ åœ¨ç¥ç»ç½‘ç»œæ¨¡å‹ä¸­ï¼Œ$P(wi | w{1}, , â€¦, w_{i-1})$ åˆ†å¸ƒé€šå¸¸æ˜¯ç”±ä¸€ä¸ª softmaxå±‚ äº§ç”Ÿçš„ï¼ŒTensorFlow ä¸­æä¾›äº†ä¸¤ä¸ªæ–¹ä¾¿è®¡ç®—äº¤å‰ç†µçš„å‡½æ•°ï¼Œå¯ä»¥å°† logits ç»“æœç›´æ¥æ”¾å…¥è¾“å…¥ï¼Œæ¥å¸®åŠ©è®¡ç®— softmax ç„¶åå†è¿›è¡Œè®¡ç®— Cross Entropy. cross_entropy = tf.nn.softmax_cross_entropy_with_logits(labels = y, logits = y)cross_entropy = tf.nn.sparse_softmax_cross_entropy_with_logits(labels = y, logits = y) çŸ¥ä¹_ä¹ ç¿”å®‡ 3. NNLMNNLM,ç›´æ¥ä»è¯­è¨€æ¨¡å‹å‡ºå‘ï¼Œå°†æ¨¡å‹æœ€ä¼˜åŒ–è¿‡ç¨‹è½¬åŒ–ä¸ºæ±‚è¯å‘é‡è¡¨ç¤ºçš„è¿‡ç¨‹. æ—¢ç„¶ç¦»æ•£çš„è¡¨ç¤ºæœ‰è¾£ä¹ˆå¤šç¼ºç‚¹ï¼Œäºæ˜¯æœ‰å°ä¼™ä¼´å°±å°è¯•ç€ç”¨æ¨¡å‹æœ€ä¼˜åŒ–çš„è¿‡ç¨‹å»è½¬æ¢è¯å‘é‡äº†. è®¡ç®—å¤æ‚åº¦ï¼š ($N * D + N * D * H + H * V$) ç›¸å½“ä¹‹é«˜, äºæ˜¯æœ‰äº† CBOW å’Œ Skip-Gram . NN è®­ç»ƒ è¯­è¨€æ¨¡å‹ï¼Œ ä¼šé¡ºå¸¦äº§ç”Ÿä¸€ä¸ª Word Embedding çŸ©é˜µ. è¯åµŒçŸ©é˜µ * å•è¯çš„ç‹¬çƒ­ç¼–ç  = å•è¯çš„è¯åµŒ (300, 10000) * (10000, 1) = (300, 1) å¯ä»¥é€šè¿‡è®­ç»ƒç¥ç»ç½‘ç»œçš„æ–¹å¼æ„å»ºè¯åµŒè¡¨ E . ä¸‹å›¾å±•ç¤ºäº†é¢„æµ‹å•è¯çš„æ–¹æ³•ï¼Œå³ç»™å‡ºç¼ºå°‘ä¸€ä¸ªå•è¯çš„å¥å­ï¼š â€œI want a glass of orange _â€ è®¡ç®—æ–¹æ³•æ˜¯å°†å·²çŸ¥å•è¯çš„ç‰¹å¾å‘é‡éƒ½ä½œä¸ºè¾“å…¥æ•°æ®é€åˆ°ç¥ç»ç½‘ç»œä¸­å»ï¼Œç„¶åç»è¿‡ä¸€ç³»åˆ—è®¡ç®—åˆ°è¾¾ Softmaxåˆ†ç±»å±‚ï¼Œåœ¨è¯¥ä¾‹ä¸­è¾“å‡ºèŠ‚ç‚¹æ•°ä¸º 10000ä¸ªã€‚ç»è¿‡è®¡ç®— juice æ¦‚ç‡æœ€é«˜ï¼Œæ‰€ä»¥é¢„æµ‹ä¸º â€œI want a glass of orange juiceâ€ åœ¨è¿™ä¸ªè®­ç»ƒæ¨¡å¼ä¸­ï¼Œæ˜¯é€šè¿‡å…¨éƒ¨çš„å•è¯å»é¢„æµ‹æœ€åä¸€ä¸ªå•è¯ç„¶ååå‘ä¼ æ’­æ›´æ–°è¯åµŒè¡¨ $E$ å‡è®¾è¦é¢„æµ‹çš„å•è¯ä¸º $W$ï¼Œè¯åµŒè¡¨ä»ç„¶ä¸º $E$ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯è®­ç»ƒè¯åµŒè¡¨å’Œé¢„æµ‹ $W$ æ˜¯ä¸¤ä¸ªä¸åŒçš„ä»»åŠ¡ã€‚ å¦‚æœä»»åŠ¡æ˜¯é¢„æµ‹ $W$ï¼Œæœ€ä½³æ–¹æ¡ˆæ˜¯ä½¿ç”¨ $W$ å‰é¢ $n$ ä¸ªå•è¯æ„å»ºè¯­å¢ƒã€‚ å¦‚æœä»»åŠ¡æ˜¯è®­ç»ƒ $E$ï¼Œé™¤äº†ä½¿ç”¨ $W$ å‰å…¨éƒ¨å•è¯è¿˜å¯ä»¥é€šè¿‡ï¼šå‰åå„4ä¸ªå•è¯ã€å‰é¢å•ç‹¬çš„ä¸€ä¸ªè¯ã€å‰é¢è¯­å¢ƒä¸­éšæœºçš„ä¸€ä¸ªè¯ï¼ˆè¿™ä¸ªæ–¹å¼ä¹Ÿå«åš Skip Gram ç®—æ³•ï¼‰ï¼Œè¿™äº›æ–¹æ³•éƒ½èƒ½æä¾›å¾ˆå¥½çš„ç»“æœã€‚ 3.1 Word Representationå•è¯ä¸å•è¯ä¹‹é—´æ˜¯æœ‰å¾ˆå¤šå…±æ€§çš„ï¼Œæˆ–åœ¨æŸä¸€ç‰¹æ€§ä¸Šç›¸è¿‘ï¼Œæ¯”å¦‚â€œè‹¹æœâ€å’Œâ€œæ©™å­â€éƒ½æ˜¯æ°´æœï¼›æˆ–è€…åœ¨æŸä¸€ç‰¹æ€§ä¸Šç›¸åï¼Œæ¯”å¦‚â€œçˆ¶äº²â€åœ¨æ€§åˆ«ä¸Šæ˜¯ç”·æ€§ï¼Œâ€œæ¯äº²â€åœ¨æ€§åˆ«ä¸Šæ˜¯å¥³æ€§ï¼Œé€šè¿‡æ„å»ºä»–ä»¬å…¶ä¸­çš„è”ç³»å¯ä»¥å°†åœ¨ä¸€ä¸ªå•è¯å­¦ä¹ åˆ°çš„å†…å®¹åº”ç”¨åˆ°å…¶ä»–çš„å•è¯ä¸Šæ¥æé«˜æ¨¡å‹çš„å­¦ä¹ çš„æ•ˆç‡ï¼Œè¿™é‡Œç”¨ä¸€ä¸ªç®€åŒ–çš„è¡¨æ ¼è¯´æ˜: Man (5391) Woman (9853) Apple (456) Orange (6257) æ€§åˆ« -1 1 0 0.1 å¹´é¾„ 0.01 0.02 -0.01 0.00 é£Ÿç‰© 0.04 0.01 0.95 0.97 é¢œè‰² 0.03 0.01 0.70 0.30 åœ¨è¡¨æ ¼ä¸­å¯ä»¥çœ‹åˆ°ä¸åŒçš„è¯è¯­å¯¹åº”ç€ä¸åŒçš„ç‰¹æ€§æœ‰ä¸åŒçš„ç³»æ•°å€¼ï¼Œä»£è¡¨ç€è¿™ä¸ªè¯è¯­ä¸å½“å‰ç‰¹æ€§çš„å…³ç³»ã€‚æ‹¬å·é‡Œçš„æ•°å­—ä»£è¡¨è¿™ä¸ªå•è¯åœ¨ç‹¬çƒ­ç¼–ç ä¸­çš„ä½ç½®ï¼Œå¯ä»¥ç”¨è¿™ä¸ªæ•°å­—ä»£è¡¨è¿™ä¸ªå•è¯æ¯”å¦‚ Man = ï¼ŒMan çš„ç‰¹æ€§ç”¨ ï¼Œä¹Ÿå°±æ˜¯é‚£ä¸€çºµåˆ—ã€‚ åœ¨å®é™…çš„åº”ç”¨ä¸­ï¼Œç‰¹æ€§çš„æ•°é‡è¿œä¸æ­¢ 4 ç§ï¼Œå¯èƒ½æœ‰å‡ ç™¾ç§ï¼Œç”šè‡³æ›´å¤šã€‚å¯¹äºå•è¯ â€œorangeâ€ å’Œ â€œappleâ€ æ¥è¯´ä»–ä»¬ä¼šå…±äº«å¾ˆå¤šçš„ç‰¹æ€§ï¼Œæ¯”å¦‚éƒ½æ˜¯æ°´æœï¼Œéƒ½æ˜¯åœ†å½¢ï¼Œéƒ½å¯ä»¥åƒï¼Œä¹Ÿæœ‰äº›ä¸åŒçš„ç‰¹æ€§æ¯”å¦‚é¢œè‰²ä¸åŒï¼Œå‘³é“ä¸åŒï¼Œä½†å› ä¸ºè¿™äº›ç‰¹æ€§è®© RNN æ¨¡å‹ç†è§£äº†ä»–ä»¬çš„å…³ç³»ï¼Œä¹Ÿå°±å¢åŠ äº†é€šè¿‡å­¦ä¹ ä¸€ä¸ªå•è¯å»é¢„æµ‹å¦ä¸€ä¸ªçš„å¯èƒ½æ€§ã€‚ å‹ç¼©åˆ°äºŒç»´çš„å¯è§†åŒ–å¹³é¢ä¸Šï¼Œæ¯ä¸€ä¸ªå•è¯ åµŒå…¥ å±äºè‡ªå·±çš„ä¸€ä¸ªä½ç½®ï¼Œç›¸ä¼¼çš„å•è¯ç¦»çš„è¿‘ï¼Œæ²¡æœ‰å…±æ€§çš„å•è¯ç¦»å¾—è¿œï¼Œè¿™ä¸ªå°±æ˜¯ â€œWord Embeddingsâ€ çš„æ¦‚å¿µ. ä¸Šå›¾é€šè¿‡èšç±»å°†è¯æ€§ç›¸ç±»ä¼¼çš„å•è¯åœ¨äºŒç»´ç©ºé—´èšä¸ºä¸€ç±». 3.2 Word Embeddingså…ˆä¸‹ä¸€ä¸ªéæ­£è§„å®šä¹‰ â€œè¯åµŒ - æè¿°äº†è¯æ€§ç‰¹å¾çš„æ€»é‡ï¼Œä¹Ÿæ˜¯åœ¨é«˜ç»´è¯æ€§ç©ºé—´ä¸­åµŒå…¥çš„ä½ç½®ï¼Œæ‹¥æœ‰è¶Šå¤šå…±æ€§çš„è¯ï¼Œè¯åµŒç¦»å¾—è¶Šè¿‘ï¼Œåä¹‹åˆ™è¶Šè¿œâ€ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œè¡¨è¾¾è¿™ä¸ªâ€œä½ç½®â€ï¼Œéœ€è¦ä½¿ç”¨æ‰€æœ‰è®¾å®šçš„è¯æ€§ç‰¹å¾ï¼Œå‡å¦‚æœ‰ 300 ä¸ªç‰¹å¾ï¼ˆæ€§åˆ«ï¼Œé¢œè‰²ï¼Œâ€¦ï¼‰ï¼Œé‚£ä¹ˆè¯åµŒçš„ç©ºé—´ç»´åº¦å°±æ˜¯ 300. 3.3 ä½¿ç”¨è¯åµŒä¸‰æ­¥ è·å¾—è¯åµŒï¼šè·å¾—çš„æ–¹å¼å¯ä»¥é€šè¿‡è®­ç»ƒå¤§çš„æ–‡æœ¬é›†æˆ–è€…ä¸‹è½½å¾ˆå¤šå¼€æºçš„è¯åµŒåº“ åº”ç”¨è¯åµŒï¼šå°†è·å¾—çš„è¯åµŒåº”ç”¨åœ¨æˆ‘ä»¬çš„è®­ç»ƒä»»åŠ¡ä¸­ å¯é€‰ï¼šé€šè¿‡æˆ‘ä»¬çš„è®­ç»ƒä»»åŠ¡æ›´æ–°è¯åµŒåº“ï¼ˆå¦‚æœè®­ç»ƒé‡å¾ˆå°å°±ä¸è¦æ›´æ–°äº†ï¼‰ è¯åµŒå®ç”¨åœºæ™¯: No. sencentce replace word target 1 Sally Johnson is an orange farmer. orange Sally Johnson 2 Robert Lin is an apple farmer. apple Robert Lin 3 Robert Lin is a durian cultivator. durian cultivator Robert Lin æˆ‘ä»¬ç»§ç»­æ›¿æ¢ï¼Œæˆ‘ä»¬å°† apple farmer æ›¿æ¢æˆä¸å¤ªå¸¸è§çš„ durian cultivator (æ¦´è²ç¹æ®–å‘˜)ã€‚æ­¤æ—¶è¯åµŒå…¥ä¸­å¯èƒ½å¹¶æ²¡æœ‰ durian è¿™ä¸ªè¯ï¼Œcultivator ä¹Ÿæ˜¯ä¸å¸¸ç”¨çš„è¯æ±‡ã€‚è¿™ä¸ªæ—¶å€™æ€ä¹ˆåŠå‘¢ï¼Ÿæˆ‘ä»¬å¯ä»¥ç”¨åˆ°è¿ç§»å­¦ä¹ ã€‚ è¯åµŒå…¥è¿ç§»å­¦ä¹ æ­¥éª¤å¦‚ä¸‹ï¼š å­¦ä¹ å«æœ‰å¤§é‡æ–‡æœ¬è¯­æ–™åº“çš„è¯åµŒå…¥ (ä¸€èˆ¬å«æœ‰ 10äº¿ åˆ° 1000äº¿ å•è¯)ï¼Œæˆ–è€…ä¸‹è½½é¢„è®­ç»ƒå¥½çš„è¯åµŒå…¥ å°†å­¦åˆ°çš„è¯åµŒå…¥è¿ç§»åˆ°ç›¸å¯¹è¾ƒå°è§„æ¨¡çš„è®­ç»ƒé›† (ä¾‹å¦‚ 10ä¸‡ è¯æ±‡). (å¯é€‰) è¿™ä¸€æ­¥éª¤å°±æ˜¯å¯¹æ–°çš„æ•°æ®è¿›è¡Œ fine-tuneã€‚ 4. word2vecword2vec å¹¶ä¸æ˜¯ä¸€ä¸ªæ¨¡å‹ï¼Œ è€Œæ˜¯ä¸€ä¸ª 2013å¹´ google å‘è¡¨çš„å·¥å…·. è¯¥å·¥å…·åŒ…å«2ä¸ªæ¨¡å‹ï¼š Skip-Gram å’Œ CBOW. åŠä¸¤ç§é«˜æ•ˆè®­ç»ƒæ–¹æ³•ï¼š negative sampling å’Œ hierarchicam softmax. CBOW Continous Bag of Words Model Skip-Gram Model è¯å‘é‡ï¼ˆè¯çš„ç‰¹å¾å‘é‡ï¼‰æ—¢èƒ½å¤Ÿé™ä½ç»´åº¦ï¼Œåˆèƒ½å¤Ÿcaptureåˆ°å½“å‰è¯åœ¨æœ¬å¥å­ä¸­ä¸Šä¸‹æ–‡çš„ä¿¡æ¯. Word2VecWord2Vecè¯åµŒå…¥çŸ©é˜µ 4.1 CBOW çº é”™ : ä¸Šå›¾â€ç›®æ ‡å‡½æ•°â€œçš„ç¬¬ä¸€ä¸ªå…¬å¼ï¼Œåº”è¯¥æ˜¯ è¿ä¹˜ å…¬å¼ï¼Œä¸æ˜¯ è¿åŠ  è¿ç®—ã€‚ ç†è§£ : èƒŒæ™¯è¯å‘é‡ä¸ ä¸­å¿ƒè¯å‘é‡ å†…ç§¯ ç­‰éƒ¨åˆ†ï¼Œä½ å¯è€ƒè™‘ softmax $w * x+b$ ä¸­ $x$ å’Œ $w$ çš„å…³ç³»æ¥ç†è§£. 4.2 Skip-Gramè·³å­—æ¨¡å‹å‡è®¾åŸºäºæŸä¸ªè¯æ¥ç”Ÿæˆå®ƒåœ¨æ–‡æœ¬åºåˆ—å‘¨å›´çš„è¯ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œå‡è®¾æ–‡æœ¬åºåˆ—æ˜¯â€œtheâ€â€œmanâ€â€œlovesâ€â€œhisâ€â€œsonâ€ã€‚ä»¥â€œlovesâ€ä½œä¸ºä¸­å¿ƒè¯ï¼Œè®¾èƒŒæ™¯çª—å£å¤§å°ä¸º2ã€‚å¦‚å›¾10.1æ‰€ç¤ºï¼Œè·³å­—æ¨¡å‹æ‰€å…³å¿ƒçš„æ˜¯ï¼Œç»™å®šä¸­å¿ƒè¯â€œlovesâ€ï¼Œç”Ÿæˆä¸å®ƒè·ç¦»ä¸è¶…è¿‡2ä¸ªè¯çš„èƒŒæ™¯è¯â€œtheâ€â€œmanâ€â€œhisâ€â€œsonâ€çš„æ¡ä»¶æ¦‚ç‡ï¼Œå³ P(\\textrm{the},\\textrm{man},\\textrm{his},\\textrm{son}\\mid\\textrm{loves}).å‡è®¾ç»™å®šä¸­å¿ƒè¯çš„æƒ…å†µä¸‹ï¼ŒèƒŒæ™¯è¯çš„ç”Ÿæˆæ˜¯ç›¸äº’ç‹¬ç«‹çš„ï¼Œé‚£ä¹ˆä¸Šå¼å¯ä»¥æ”¹å†™æˆ P(\\textrm{the}\\mid\\textrm{loves})\\cdot P(\\textrm{man}\\mid\\textrm{loves})\\cdot P(\\textrm{his}\\mid\\textrm{loves})\\cdot P(\\textrm{son}\\mid\\textrm{loves}). è®­ç»ƒ Skip-Gram è·³å­—æ¨¡å‹çš„å‚æ•°æ˜¯æ¯ä¸ªè¯æ‰€å¯¹åº”çš„ä¸­å¿ƒè¯å‘é‡å’ŒèƒŒæ™¯è¯å‘é‡ã€‚è®­ç»ƒä¸­æˆ‘ä»¬é€šè¿‡æœ€å¤§åŒ–ä¼¼ç„¶å‡½æ•°æ¥å­¦ä¹ æ¨¡å‹å‚æ•°ï¼Œå³æœ€å¤§ä¼¼ç„¶ä¼°è®¡ã€‚è¿™ç­‰ä»·äºæœ€å°åŒ–ä»¥ä¸‹æŸå¤±å‡½æ•°ï¼š - \\sum_{t=1}^{T} \\sum_{-m \\leq j \\leq m,\\ j \\neq 0} \\text{log}\\, P(w^{(t+j)} \\mid w^{(t)}).å¦‚æœä½¿ç”¨éšæœºæ¢¯åº¦ä¸‹é™ï¼Œé‚£ä¹ˆåœ¨æ¯ä¸€æ¬¡è¿­ä»£é‡Œæˆ‘ä»¬éšæœºé‡‡æ ·ä¸€ä¸ªè¾ƒçŸ­çš„å­åºåˆ—æ¥è®¡ç®—æœ‰å…³è¯¥å­åºåˆ—çš„æŸå¤±ï¼Œç„¶åè®¡ç®—æ¢¯åº¦æ¥æ›´æ–°æ¨¡å‹å‚æ•°ã€‚æ¢¯åº¦è®¡ç®—çš„å…³é”®æ˜¯æ¡ä»¶æ¦‚ç‡çš„å¯¹æ•°æœ‰å…³ä¸­å¿ƒè¯å‘é‡å’ŒèƒŒæ™¯è¯å‘é‡çš„æ¢¯åº¦ã€‚æ ¹æ®å®šä¹‰ï¼Œé¦–å…ˆçœ‹åˆ° \\log P(w_o \\mid w_c) = \\boldsymbol{u}_o^\\top \\boldsymbol{v}_c - \\log\\left(\\sum_{i \\in \\mathcal{V}} \\text{exp}(\\boldsymbol{u}_i^\\top \\boldsymbol{v}_c)\\right) å®ƒçš„è®¡ç®—éœ€è¦è¯å…¸ä¸­æ‰€æœ‰è¯ä»¥ $w_c$ ä¸ºä¸­å¿ƒè¯çš„æ¡ä»¶æ¦‚ç‡ã€‚æœ‰å…³å…¶ä»–è¯å‘é‡çš„æ¢¯åº¦åŒç†å¯å¾—ã€‚ è®­ç»ƒç»“æŸåï¼Œå¯¹äºè¯å…¸ä¸­çš„ä»»ä¸€ç´¢å¼•ä¸º $i$ çš„è¯ï¼Œæˆ‘ä»¬å‡å¾—åˆ°è¯¥è¯ä½œä¸ºä¸­å¿ƒè¯å’ŒèƒŒæ™¯è¯çš„ä¸¤ç»„è¯å‘é‡ $v_i$ å’Œ $u_i$ ã€‚åœ¨è‡ªç„¶è¯­è¨€å¤„ç†åº”ç”¨ä¸­ï¼Œä¸€èˆ¬ä½¿ç”¨è·³å­—æ¨¡å‹çš„ä¸­å¿ƒè¯å‘é‡ä½œä¸ºè¯çš„è¡¨å¾å‘é‡ã€‚ ä¸¤ä¸ªå‘é‡è¶Šç›¸ä¼¼ï¼Œä»–ä»¬çš„ç‚¹ä¹˜ä¹Ÿå°±è¶Šå¤§. å°ç»“ï¼š æœ€å¤§ä¼¼ç„¶ä¼°è®¡ MLE æœ€å°åŒ–æŸå¤±å‡½æ•°ï¼ˆä¸ç¬¬ä¸€æ­¥ç­‰ä»·ï¼‰ï¼ŒæŸå¤±å‡½æ•°å¯¹æ•°è”åˆæ¦‚ç‡çš„ç›¸åæ•° æè¿°æ¦‚ç‡å‡½æ•°ï¼Œè¯¥å‡½æ•°çš„è‡ªå˜é‡æ˜¯è¯å‘é‡ï¼ˆuå’Œvï¼‰ï¼Œè¯å‘é‡ä¹Ÿæ˜¯æ¨¡å‹å‚æ•° å¯¹ç¬¬äºŒæ­¥ä¸­æ¯ä¸€é¡¹æ±‚æ¢¯åº¦ã€‚æœ‰äº†æ¢¯åº¦å°±å¯ä»¥ä¼˜åŒ–ç¬¬äºŒæ­¥ä¸­çš„æŸå¤±å‡½æ•°ï¼Œä»è€Œè¿­ä»£å­¦ä¹ åˆ°æ¨¡å‹å‚æ•°ï¼Œä¹Ÿå°±æ˜¯è¯å‘é‡ã€‚ 4.3 é«˜æ•ˆè¿‘ä¼¼è®­ç»ƒ hierarchicam softmax negative sampling 5. fastTextFastTextæ˜¯ä¸€ä¸ªå¿«é€Ÿæ–‡æœ¬åˆ†ç±»ç®—æ³•ï¼Œåœ¨ä½¿ç”¨æ ‡å‡†å¤šæ ¸CPUçš„æƒ…å†µä¸‹ï¼Œåœ¨10åˆ†é’Ÿå†…å¯ä»¥å¯¹è¶…è¿‡10äº¿ä¸ªå•è¯è¿›è¡Œè®­ç»ƒã€‚ ä¸éœ€è¦ä½¿ç”¨é¢„å…ˆè®­ç»ƒå¥½çš„è¯å‘é‡ï¼Œå› ä¸ºFastTextä¼šè‡ªå·±è®­ç»ƒè¯å‘é‡ã€‚ æ–‡æœ¬åˆ†ç±»ï¼š æƒ…æ„Ÿåˆ†ç±»: fastText èƒ½å¤Ÿåšåˆ°æ•ˆæœå¥½ï¼Œé€Ÿåº¦å¿«ï¼Œä¸»è¦ä¾é ä¸¤ä¸ªç§˜å¯†æ­¦å™¨ï¼š åˆ©ç”¨äº† è¯å†…çš„n-gramä¿¡æ¯ (subword n-gram information) ç”¨åˆ°äº† å±‚æ¬¡åŒ–Softmaxå›å½’ (Hierarchical Softmax) çš„è®­ç»ƒ trick. fastText å’Œ word2vec çš„åŒºåˆ«: ä¸¤è€…è¡¨é¢çš„ä¸åŒï¼š æ¨¡å‹çš„è¾“å‡ºå±‚ï¼š word2vecçš„è¾“å‡ºå±‚ï¼Œå¯¹åº”çš„æ˜¯æ¯ä¸€ä¸ªtermï¼Œè®¡ç®—æŸtermçš„æ¦‚ç‡æœ€å¤§ï¼›è€Œfasttextçš„è¾“å‡ºå±‚å¯¹åº”çš„æ˜¯ åˆ†ç±»çš„labelã€‚ä¸è¿‡ä¸ç®¡è¾“å‡ºå±‚å¯¹åº”çš„æ˜¯ä»€ä¹ˆå†…å®¹ï¼Œèµ·å¯¹åº”çš„vectoréƒ½ä¸ä¼šè¢«ä¿ç•™å’Œä½¿ç”¨ï¼› æ¨¡å‹çš„è¾“å…¥å±‚ï¼š word2vecçš„è¾“å‡ºå±‚ï¼Œæ˜¯ context window å†…çš„termï¼›è€Œfasttextå¯¹åº”çš„æ•´ä¸ªsentenceçš„å†…å®¹ï¼ŒåŒ…æ‹¬termï¼Œä¹ŸåŒ…æ‹¬ n-gramçš„å†…å®¹ï¼› ä¸¤è€…æœ¬è´¨çš„ä¸åŒï¼Œä½“ç°åœ¨ h-softmax çš„ä½¿ç”¨ï¼š Wordvecçš„ç›®çš„æ˜¯å¾—åˆ°è¯å‘é‡ï¼Œè¯¥è¯å‘é‡æœ€ç»ˆæ˜¯åœ¨è¾“å…¥å±‚å¾—åˆ°ï¼Œè¾“å‡ºå±‚å¯¹åº”çš„ h-softmaxä¹Ÿä¼šç”Ÿæˆä¸€ç³»åˆ—çš„å‘é‡ï¼Œä½†æœ€ç»ˆéƒ½è¢«æŠ›å¼ƒï¼Œä¸ä¼šä½¿ç”¨ã€‚ fasttextåˆ™å……åˆ†åˆ©ç”¨äº†h-softmaxçš„åˆ†ç±»åŠŸèƒ½ï¼Œéå†åˆ†ç±»æ ‘çš„æ‰€æœ‰å¶èŠ‚ç‚¹ï¼Œæ‰¾åˆ°æ¦‚ç‡æœ€å¤§çš„labelï¼ˆä¸€ä¸ªæˆ–è€…Nä¸ªï¼‰ Reference ã€Šæ•°å­¦ä¹‹ç¾ã€‹ è¯»ä¹¦ç¬”è®° word2vecå‰ä¸–ä»Šç”Ÿ CS224N NLP with Deep Learning: Lecture 1 è¯¾ç¨‹ç¬”è®° good, sklearn ä¸­ CountVectorizerã€TfidfTransformer å’Œ TfidfVectorizer","categories":[{"name":"nlp","slug":"nlp","permalink":"http://iequa.com/categories/nlp/"}],"tags":[{"name":"PPL","slug":"PPL","permalink":"http://iequa.com/tags/PPL/"}]},{"title":"Recurrent Neural Networks","slug":"deeplearning/RNN-LSTM-GRU","date":"2019-06-14T02:06:16.000Z","updated":"2019-10-20T04:30:35.015Z","comments":true,"path":"2019/06/14/deeplearning/RNN-LSTM-GRU/","link":"","permalink":"http://iequa.com/2019/06/14/deeplearning/RNN-LSTM-GRU/","excerpt":"","text":"ä½œä¸ºç”Ÿç‰©ä½“ï¼Œæˆ‘ä»¬çš„è§†è§‰å’Œå¬è§‰ä¸æ–­åœ°è·å¾—å¸¦æœ‰åºåˆ—çš„å£°éŸ³å’Œå›¾åƒä¿¡å·ï¼Œå¹¶äº¤ç”±å¤§è„‘ç†è§£ï¼› äº’è”ç½‘æ•°æ®ä¸­ï¼Œå¾ˆå¤šæ˜¯ä»¥åºåˆ—å½¢å¼å­˜åœ¨çš„ï¼Œä¾‹å¦‚æ–‡æœ¬ã€è¯­éŸ³ã€è§†é¢‘ã€ç‚¹å‡»æµç­‰ç­‰ã€‚ RNN åŸºç¡€çŸ¥è¯†ï¼Œè¯¦å‚æœ¬åšï¼š Sequence Models 1. RNN Basicåœ¨ä»‹ç» RNN ä¹‹å‰ï¼Œé¦–å…ˆè§£é‡Šä¸€ä¸‹ä¸ºä»€ä¹ˆä¹‹å‰çš„æ ‡å‡†ç½‘ç»œä¸å†é€‚ç”¨äº†ã€‚å› ä¸ºå®ƒæœ‰ä¸¤ä¸ªç¼ºç‚¹ï¼š è¾“å…¥å’Œè¾“å‡ºçš„é•¿åº¦ä¸å°½ç›¸åŒ æ— æ³•å…±äº«ä»å…¶ä»–ä½ç½®å­¦æ¥çš„ç‰¹å¾ ä¼ ç»Ÿæ–¹æ³•æ–‡æœ¬åˆ†ç±»ï¼š ç”¨ä¸€ç¯‡æ–‡ç« çš„ TF-IDF å‘é‡ä½œä¸ºè¾“å…¥ï¼Œå…¶ä¸­ TF-IDF å‘é‡æ˜¯è¯æ±‡è¡¨å¤§å°. Typical RNN Structure: åœ¨ $h_T$ åé¢ç›´æ¥æ¥ä¸€ä¸ª Softmax å±‚ï¼Œè¾“å‡ºæ–‡æœ¬æ‰€å±ç±»åˆ«çš„é¢„æµ‹æ¦‚ç‡ $y$ï¼Œå°±å¯ä»¥å®ç°æ–‡æœ¬åˆ†ç±». å¯åº”ç”¨äºå¤šç§å…·ä½“ä»»åŠ¡ï¼š net\\_{t}=U x\\_{t}+W h\\_{t-1} h\\_{t}=f\\left(\\text {net}\\_{t}\\right) y=g\\left(V h\\_{T}\\right)å…¶ä¸­ $f$ å’Œ $g$ ä¸ºæ¿€æ´»å‡½æ•°ï¼Œ$U$ ä¸ºè¾“å…¥å±‚åˆ°éšå«å±‚çš„æƒé‡çŸ©é˜µï¼Œ$W$ ä¸ºéšå«å±‚ä»ä¸Šä¸€æ—¶åˆ»åˆ°ä¸‹ä¸€æ—¶åˆ»çŠ¶æ€è½¬ç§»çš„æƒé‡çŸ©é˜µã€‚åœ¨æ–‡æœ¬åˆ†ç±»ä»»åŠ¡ä¸­ï¼Œ$f$ å¯ä»¥é€‰å– Tanh å‡½æ•°æˆ–è€… ReLU å‡½æ•°ï¼Œ$g$ å¯ä»¥é‡‡ç”¨ Softmax å‡½æ•°ã€‚ 1.1 TensorFlow RNN æ›´å¤šè¯¦æƒ…å‚è§æœ¬åšï¼š TensorFlowï¼šç¬¬8ç«  Recurrent Neural Networks 1 1.2 Forward Propagation $a^{}=\\vec{0}$ $a^{}=g_1(W_{aa}a^{}+W_{ax}x^{}+b_a)$ $y^{}=g_2(W_{ya}a^{}+b_y)$ $a^{&lt;{t}&gt;}=g_1(W_{aa}a^{&lt;{t-1}&gt;}+W_{ax}x^{&lt;{t}&gt;}+b_a)$ $y^{&lt;{t}&gt;}=g_2(W_{ya}a^{&lt;{t}&gt;}+b_y)$ æ¿€æ´»å‡½æ•°ï¼š$g_1$ ä¸€èˆ¬ä¸º tanhå‡½æ•° (or Reluå‡½æ•°)ï¼Œ$g_2$ ä¸€èˆ¬æ˜¯ Sigmod or softmax å‡½æ•°. 1.3 RNN vs CNN RNN ä¼˜ç‚¹ï¼š æœ€å¤§ç¨‹åº¦æ•æ‰ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼Œè¿™å¯èƒ½æœ‰åˆ©äºæ•è·é•¿æ–‡æœ¬çš„è¯­ä¹‰ã€‚ RNN ç¼ºç‚¹ï¼š æ˜¯ä¸€ä¸ªæœ‰åå€šçš„æ¨¡å‹ï¼Œåœ¨è¿™ä¸ªæ¨¡å‹ä¸­ï¼Œåé¢çš„å•è¯æ¯”å…ˆå‰çš„å•è¯æ›´å…·ä¼˜åŠ¿ã€‚å› æ­¤ï¼Œå½“å®ƒè¢«ç”¨äºæ•è·æ•´ä¸ªæ–‡æ¡£çš„è¯­ä¹‰æ—¶ï¼Œå®ƒå¯èƒ½ä¼šé™ä½æ•ˆç‡ï¼Œå› ä¸ºå…³é”®ç»„ä»¶å¯èƒ½å‡ºç°åœ¨æ–‡æ¡£ä¸­çš„ä»»ä½•åœ°æ–¹ï¼Œè€Œä¸æ˜¯æœ€åã€‚ CNN ä¼˜ç‚¹ï¼š æå–æ•°æ®ä¸­çš„å±€éƒ¨ä½ç½®çš„ç‰¹å¾ï¼Œç„¶åå†æ‹¼æ¥æ± åŒ–å±‚ã€‚ CNNå¯ä»¥æ›´å¥½åœ°æ•æ‰æ–‡æœ¬çš„è¯­ä¹‰ã€‚æ˜¯O(n) CNN ä¼˜ç‚¹ï¼š ä¸€ä¸ªå¯ä»¥è‡ªåŠ¨åˆ¤æ–­å“ªäº›ç‰¹æ€§åœ¨æ–‡æœ¬åˆ†ç±»ä¸­æ‰®æ¼”å…³é”®è§’è‰²çš„æ± åŒ–å±‚ï¼Œä»¥æ•è·æ–‡æœ¬ä¸­çš„å…³é”®ç»„ä»¶ã€‚ 2. Language model æ­¤æ—¶å°±éœ€è¦é€šè¿‡è¯­è¨€æ¨¡å‹æ¥é¢„æµ‹æ¯å¥è¯çš„æ¦‚ç‡ï¼š 2.1 RNN Language Model é¦–å…ˆæˆ‘ä»¬éœ€è¦ä¸€ä¸ªå¾ˆå¤§çš„è¯­æ–™åº“ (Corpus) å°†æ¯ä¸ªå•è¯å­—ç¬¦åŒ– (Tokenizeï¼Œå³ä½¿ç”¨One-shotç¼–ç ) å¾—åˆ°è¯å…¸,ï¼Œå‡è®¾æœ‰ 10000 ä¸ªå•è¯ è¿˜éœ€è¦æ·»åŠ ä¸¤ä¸ªç‰¹æ®Šçš„å•è¯ end of sentence. ç»ˆæ­¢ç¬¦ï¼Œè¡¨ç¤ºå¥å­ç»“æŸ. UNknown, ä¹‹å‰çš„ç¬”è®°å·²ä»‹ç»è¿‡ 2.2 Language Model Exampleå‡è®¾è¦å¯¹è¿™å¥è¯è¿›è¡Œå»ºæ¨¡ï¼šCats average 15 hours of sleep a day. 1. åˆå§‹åŒ– è¿™ä¸€æ­¥æ¯”è¾ƒç‰¹æ®Šï¼Œå³ $x^{}$ å’Œ $a^{}$ éƒ½éœ€è¦åˆå§‹åŒ–ä¸º $\\vec{0}$ .æ­¤æ—¶ $\\hat{y}^{}$ å°†ä¼šå¯¹ç¬¬ä¸€ä¸ªå­—å¯èƒ½å‡ºç°çš„æ¯ä¸€ä¸ªå¯èƒ½è¿›è¡Œæ¦‚ç‡çš„åˆ¤æ–­,å³ $\\hat{y}^{}=[p(a),â€¦,p(cats),â€¦]$. å½“ç„¶åœ¨æœ€å¼€å§‹çš„æ—¶å€™æ²¡æœ‰ä»»ä½•çš„ä¾æ®ï¼Œå¯èƒ½å¾—åˆ°çš„æ˜¯å®Œå…¨ä¸ç›¸å¹²çš„å­—ï¼Œå› ä¸ºåªæ˜¯æ ¹æ®åˆå§‹çš„å€¼å’Œæ¿€æ´»å‡½æ•°åšå‡ºçš„å–æ ·ã€‚ 2. å°†çœŸå®å€¼ä½œä¸ºè¾“å…¥å€¼: ä¹‹æ‰€ä»¥å°†çœŸå®å€¼ä½œä¸ºè¾“å…¥å€¼å¾ˆå¥½ç†è§£ï¼Œå¦‚æœæˆ‘ä»¬ä¸€ç›´ä¼ é”™è¯¯çš„å€¼ï¼Œå°†æ°¸è¿œä¹Ÿæ— æ³•å¾—åˆ°å­—ä¸å­—ä¹‹é—´çš„å…³ç³» å¦‚ä¸‹å›¾ç¤ºï¼Œå°† $y^{}$ æ‰€è¡¨ç¤ºçš„çœŸå®å€¼ Cats ä½œä¸ºè¾“å…¥ï¼Œå³ $x^{}=y^{}$ å¾—åˆ° $\\hat{y}^{}$ æ­¤æ—¶çš„ $\\hat{y}^{}=[p(a|cats),â€¦,p(average|cats),â€¦]$ åŒç†æœ‰ $\\hat{y}^{}=[p(a|cats\\, average),â€¦,p(average|cats\\,average),â€¦]$ å¦å¤–è¾“å…¥å€¼æ»¡è¶³ï¼š $x^{&lt;{t}&gt;}=y^{&lt;{t-1}&gt;}$ 3. è®¡ç®—å‡ºæŸå¤±å€¼: ä¸‹å›¾ç»™å‡ºäº†æ„å»ºæ¨¡å‹çš„è¿‡ç¨‹ä»¥åŠæŸå¤±å€¼è®¡ç®—å…¬å¼: éšç€è®­ç»ƒçš„æ¬¡æ•°çš„å¢å¤šï¼Œæˆ–è€…å¸¸ç”¨è¯å‡ºç°çš„é¢‘ç‡çš„å¢å¤šï¼Œè¯­è¨€æ¨¡å‹ä¾¿æ…¢æ…¢çš„ä¼šå¼€å§‹æŒæ¡ç®€å•çš„è¯è¯­æ¯”å¦‚â€œå¹³å‡â€ï¼Œâ€œæ¯å¤©â€ï¼Œâ€œå°æ—¶â€ã€‚ä¸€ä¸ªå®Œå–„çš„è¯­è¨€æ¨¡å‹çœ‹åˆ°ç±»ä¼¼â€œ 10 ä¸ªå°â€çš„æ—¶å€™ï¼Œåº”è¯¥å°±èƒ½å‡†ç¡®çš„åˆ¤å®šä¸‹ä¸€ä¸ªå­—æ˜¯â€œæ—¶â€ã€‚ ï¼ˆå½“ç„¶ä¹Ÿè®¸å®é™…æƒ…å†µæ˜¯â€œ 10 ä¸ªå°æœ‹å‹â€ï¼Œæ‰€ä»¥é€šå¸¸ä¼šæœ‰æ›´å¤šçš„åˆ¤æ–­å› ç´ ï¼Œè¿™é‡Œåªæ˜¯ä¸€ä¸ªä¾‹å­ï¼‰ 3. Vanishing gradients with RNNs ç›®å‰è¿™ç§åŸºæœ¬çš„ RNN ä¹Ÿä¸æ“…é•¿æ•è·è¿™ç§é•¿æœŸä¾èµ–æ•ˆåº”. æ¢¯åº¦çˆ†ç‚¸å¯ä»¥ç”¨æ¢¯åº¦æ¶ˆå‡è§£å†³ã€æ¢¯åº¦æ¶ˆå¤±å°±æœ‰ç‚¹éº»çƒ¦äº†ï¼Œéœ€è¦ç”¨ GRU æ¥è§£å†³. gradient value åœ¨ RNN ä¸­ä¹Ÿå¯èƒ½å› ä¸ºåå‘ä¼ æ’­çš„å±‚æ¬¡å¤ªå¤šå¯¼è‡´ è¿‡å° æˆ– è¿‡å¤§ å½“æ¢¯åº¦å€¼è¿‡å°çš„æ—¶å€™ï¼Œç½‘ç»œæ— æ³•æœ‰æ•ˆè°ƒæ•´è‡ªå·±æƒé‡çŸ©é˜µè‡´è®­ç»ƒæ•ˆæœä¸ä½³ï¼Œç§°ä¸º gradient vanishingï¼› è¿‡å¤§æ—¶ç›´æ¥å½±å“åˆ°ç¨‹åºçš„è¿ä½œå› ä¸ºç¨‹åºå·²æ— æ³•å­˜å‚¨é‚£ä¹ˆå¤§çš„å€¼ï¼Œä¼šè¿”å› NaN ï¼Œç§°ä¸º gradient exploding. å½“ gradient è¿‡å¤§æ—¶, å¯ä»¥æ¯æ¬¡å°†è¿”å›çš„æ¢¯åº¦å€¼è¿›è¡Œæ£€æŸ¥ï¼Œè¶…å‡ºé¢„å®šèŒƒå›´ï¼Œåˆ™æ‰‹åŠ¨è®¾ä¸ºèŒƒå›´çš„è¾¹ç•Œå€¼ï¼š if (gradient &gt; max) &#123; gradient = max&#125; ä½†æ¢¯åº¦å€¼è¿‡å°çš„è§£å†³æ–¹æ¡ˆè¦ç¨å¾®å¤æ‚ä¸€ç‚¹ï¼Œæ¯”å¦‚ä¸‹é¢ä¸¤å¥è¯ï¼š â€œThe catï¼Œwhich already ate appleï¼Œyogurtï¼Œbananaï¼Œâ€¦, was full.â€â€œThe catsï¼Œwhich already ate appleï¼Œyogurtï¼Œbananaï¼Œâ€¦, were full.â€ é‡ç‚¹æ ‡å‡ºçš„ cat(s) å’Œ be åŠ¨è¯ï¼ˆwas, wereï¼‰ æ˜¯æœ‰é‡è¦å…³è”çš„ï¼Œä½†æ˜¯ä¸­é—´éš”äº†ä¸€ä¸ª which å¼•å¯¼çš„å®šè¯­ä»å¥ï¼Œå¯¹äºå‰é¢æ‰€ä»‹ç»çš„åŸºç¡€çš„ RNNç½‘ç»œ å¾ˆéš¾å­¦ä¹ åˆ°è¿™ä¸ªä¿¡æ¯ï¼Œå°¤å…¶æ˜¯å½“å‡ºç°æ¢¯åº¦æ¶ˆå¤±æ—¶ï¼Œè€Œä¸”è¿™ç§æƒ…å†µå¾ˆå®¹æ˜“å‘ç”Ÿ. ç¥ç»ç½‘ç»œå±‚æ¬¡å¾ˆå¤šæ—¶ï¼Œåå‘ä¼ æ’­å¾ˆéš¾å½±å“å‰é¢å±‚æ¬¡çš„å‚æ•°ã€‚è§£å†³ gradient vanishingï¼Œæå‡ºäº† GRU å•å…ƒ. å°†åœ¨æ¥ä¸‹æ¥çš„ä¸¤ä¸ªç« èŠ‚ä»‹ç»ä¸¤ç§æ–¹æ³•æ¥è§£å†³ æ¢¯åº¦è¿‡å° é—®é¢˜ï¼Œç›®æ ‡æ˜¯å½“ä¸€äº›é‡è¦çš„å•è¯ç¦»å¾—å¾ˆè¿œçš„æ—¶å€™ï¼Œæ¯”å¦‚ä¾‹å­ä¸­çš„ â€œcatâ€ å’Œ â€œwasâ€ï¼Œèƒ½è®©è¯­è¨€æ¨¡å‹å‡†ç¡®çš„è¾“å‡ºå•æ•°äººç§°è¿‡å»æ—¶çš„ â€œwasâ€ï¼Œè€Œä¸æ˜¯ â€œisâ€ æˆ–è€… â€œwereâ€. ä¸¤ä¸ªæ–¹æ³•éƒ½å°†å¼•å…¥â€œè®°å¿†â€çš„æ¦‚å¿µï¼Œä¹Ÿå°±æ˜¯ä¸º RNN èµ‹äºˆä¸€ä¸ªè®°å¿†çš„åŠŸèƒ½. 4. GRU - Gated Recurrent UnitGRU æ˜¯ä¸€ç§ç”¨æ¥è§£å†³æ¢¯åº¦å€¼è¿‡å°çš„æ–¹æ³•ï¼Œé¦–å…ˆæ¥çœ‹ä¸‹åœ¨ä¸€ä¸ªæ—¶åˆ»ä¸‹çš„ RNNå•å…ƒï¼Œæ¿€æ´»å‡½æ•°ä¸º tanh 4.1 å›é¡¾ RNNè¾“å…¥æ•°æ®ä¸º $a^{&lt;{t-1}&gt;}$ å’Œ $x^{&lt;{t}&gt;}$, ä¸å‚æ•° $W_a$ è¿›è¡Œçº¿æ€§è¿ç®—åå†ä½¿ç”¨ $tanh$ å‡½æ•° è½¬åŒ–å¾—åˆ° $a^{&lt;{t}&gt;}$. å½“ç„¶ $a^{&lt;{t}&gt;}$, å†ä½¿ç”¨ softmax å‡½æ•°å¤„ç†å¯ä»¥å¾—åˆ°é¢„æµ‹å€¼. 4.2 GRUç»“æ„åœ¨ GRUä¸­ ä¼šç”¨åˆ° â€œè®°å¿†ç»†èƒ(Memory cell)â€ è¿™ä¸ªæ¦‚å¿µ, æˆ‘ä»¬ç”¨å˜é‡Cè¡¨ç¤ºã€‚è¿™ä¸ªè®°å¿†ç»†èƒæä¾›äº†è®°å¿†åŠŸèƒ½ï¼Œä¾‹å¦‚å®ƒèƒ½å¤Ÿå¸®åŠ©è®°ä½ cat å¯¹åº” was, cats å¯¹åº” were. è€Œåœ¨ $t$ æ—¶åˆ»ï¼Œè®°å¿†ç»†èƒæ‰€åŒ…å«çš„å€¼å…¶å®å°±æ˜¯ Activation function å€¼ï¼Œå³ $c^{&lt;{t}&gt;}=a^{&lt;{t}&gt;}$ æ³¨æ„ï¼šåœ¨è¿™é‡Œä¸¤ä¸ªå˜é‡çš„å€¼è™½ç„¶ä¸€æ ·ï¼Œä½†æ˜¯å«ä¹‰ä¸åŒã€‚ å¦å¤–åœ¨ä¸‹èŠ‚å°†ä»‹ç»çš„ LSTM ä¸­ï¼ŒäºŒè€…å€¼çš„å¤§å°æœ‰å¯èƒ½æ˜¯ä¸ä¸€æ ·çš„ï¼Œæ‰€ä»¥æœ‰å¿…è¦ä½¿ç”¨è¿™ä¸¤ç§å˜é‡è¿›è¡ŒåŒºåˆ†. ä¸ºäº†æ›´æ–° memory_cell çš„å€¼ï¼Œæˆ‘ä»¬å¼•å…¥ $\\tilde{c}$ æ¥ä½œä¸ºå€™é€‰å€¼ä»è€Œæ¥æ›´æ–° $c^{&lt;{t}&gt;}$ï¼Œå…¶å…¬å¼ä¸ºï¼š \\tilde{c}=tanh(W\\_c [c^{}, x^{}]+b\\_c)æ›´æ–°é—¨ (update gate): æ›´æ–°é—¨æ˜¯ GRU çš„æ ¸å¿ƒæ¦‚å¿µï¼Œå®ƒçš„ä½œç”¨æ˜¯ç”¨äºåˆ¤æ–­æ˜¯å¦éœ€è¦è¿›è¡Œæ›´æ–°. æ›´æ–°é—¨ç”¨ $\\Gamma_u$ è¡¨ç¤ºï¼Œå…¶å…¬å¼ä¸ºï¼š \\Gamma\\_u=Ïƒ(W\\_u [c^{}, x^{}]+b\\_u) å¦‚ä¸Šå›¾ç¤ºï¼Œ$\\Gamma_u$ å€¼çš„å¤§å°å¤§å¤šåˆ†å¸ƒåœ¨ 0 æˆ–è€… 1ï¼Œæ‰€ä»¥å¯ä»¥å°†å…¶å€¼çš„å¤§å°ç²—ç•¥çš„è§†ä¸º 0 æˆ–è€… 1ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬å°±å¯ä»¥å°†å…¶ç†è§£ä¸ºä¸€æ‰‡é—¨ï¼Œå¦‚æœ $\\Gamma_u=1$ , å°±è¡¨ç¤ºæ­¤æ—¶éœ€è¦æ›´æ–°å€¼ï¼Œåä¹‹ä¸ç”¨. $t$ æ—¶åˆ»è®°å¿†ç»†èƒ: æœ‰äº†æ›´æ–°é—¨å…¬å¼åï¼Œæˆ‘ä»¬åˆ™å¯ä»¥ç»™å‡º $t$ æ—¶åˆ» memory_cell çš„å€¼çš„è®¡ç®—å…¬å¼: c^{} = \\Gamma\\_u \\* \\tilde{c} + (1-\\Gamma\\_u) \\* c^{} å…¬å¼å¾ˆå¥½ç†è§£ï¼Œå¦‚æœ $\\Gamma_u=1$ï¼Œé‚£ä¹ˆ $t$ æ—¶åˆ» è®°å¿†ç»†èƒçš„å€¼å°±ç­‰äºå€™é€‰å€¼ $\\tilde{c}$, åä¹‹ç­‰äºå‰ä¸€æ—¶åˆ»è®°å¿†ç»†èƒçš„å€¼. æ³¨ï¼šä¸Šé¢å…¬å¼ä¸­çš„ * è¡¨ç¤ºå…ƒç´ ä¹‹é—´è¿›è¡Œä¹˜æ³•è¿ç®—ï¼Œè€Œå…¶ä»–å…¬å¼æ˜¯ çŸ©é˜µè¿ç®—. ä¸‹å›¾ç»™å‡ºäº†è¯¥å…¬å¼å¾ˆç›´è§‚çš„è§£é‡Šï¼š åœ¨è¯»åˆ° â€œcatâ€ æ—¶å€™ï¼Œå…¶ä»–æ—¶å€™ä¸€ç›´ä¸º 0ï¼ŒçŸ¥é“è¦è¾“å‡º â€œwasâ€ çš„æ—¶åˆ»ï¼Œæˆ‘ä»¬çŸ¥é“ â€œcatâ€ çš„å­˜åœ¨ï¼Œä¹Ÿå°±çŸ¥é“å®ƒä¸ºå•æ•° GRU ç»“æ„ç¤ºæ„å›¾ 4.3 å®Œæ•´ç‰ˆ GRUä¸Šé¢ç®€åŒ–äº† GRUï¼Œåœ¨å®Œæ•´ç‰ˆä¸­è¿˜å­˜åœ¨å¦ä¸€ä¸ªç¬¦å· ï¼Œè¿™ç¬¦å·çš„æ„ä¹‰æ˜¯æ§åˆ¶ $\\tilde{c}$ å’Œ $c^{&lt;{t-1}&gt;}$ ä¹‹é—´çš„è”ç³»å¼ºå¼±ï¼Œå®Œæ•´ç‰ˆå¦‚ä¸‹ï¼š æ³¨æ„ï¼Œå®Œæ•´å…¬å¼ä¸­å¤šå‡ºäº†ä¸€ä¸ª $\\Gamma_r$, è¿™ä¸ªç¬¦å·çš„ä½œç”¨æ˜¯æ§åˆ¶ $\\tilde{c}^{&lt;{t}&gt;}$ å’Œ $c^{&lt;{t}&gt;}$ ä¹‹é—´è”ç³»çš„å¼ºå¼±. 5. LSTM - Long Short Termä»‹ç»å®Œ GRU åï¼Œå†ä»‹ç» LSTM ä¼šæ›´åŠ å®¹æ˜“ç†è§£ã€‚ 5.1 GRU and LSTMGRU åªæœ‰ä¸¤ä¸ªé—¨ï¼Œè€Œ LSTM æœ‰ä¸‰ä¸ªé—¨ï¼Œåˆ†åˆ«æ˜¯æ›´æ–°é—¨ $\\Gamma_u$ (æ˜¯å¦éœ€è¦æ›´æ–°ä¸º $\\tilde{c}^{&lt;{t}&gt;}$)ï¼Œé—å¿˜é—¨ $\\Gamma_f$ (æ˜¯å¦éœ€è¦ä¸¢å¼ƒä¸Šä¸€ä¸ªæ—¶åˆ»çš„å€¼)ï¼Œè¾“å‡ºé—¨ $\\Gamma_o$ (æ˜¯å¦éœ€è¦è¾“å‡ºæœ¬æ—¶åˆ»çš„å€¼) ä¸‹å›¾æ˜¯ LSTM çš„ç»“æ„ç¤ºæ„å›¾ï¼š 5.2 LSTM Structure LSTM ä»æ˜¯ $x_t$ å’Œ $h_{tâˆ’1}$ æ¥è®¡ç®— $h_t$ï¼Œä½†å¯¹å†…éƒ¨çš„ç»“æ„è¿›è¡Œäº†æ›´åŠ ç²¾å¿ƒçš„è®¾è®¡ï¼ŒåŠ å…¥ 3 Gate å’Œ 1 memory_cell. è¾“å…¥é—¨ $\\Gamma_u$ï¼š æ§åˆ¶ å½“å‰è®¡ç®—çš„æ–°çŠ¶æ€ ä»¥å¤šå¤§ç¨‹åº¦æ›´æ–°åˆ°è®°å¿†å•å…ƒä¸­ ï¼ˆä¹Ÿå«æ›´æ–°é—¨ï¼‰; é—å¿˜é—¨ $\\Gamma_f$ï¼š æ§åˆ¶ å‰ä¸€æ­¥è®°å¿†å•å…ƒ ä¸­çš„ä¿¡æ¯æœ‰å¤šå¤§ç¨‹åº¦è¢«é—å¿˜æ‰; è¾“å‡ºé—¨ $\\Gamma_o$ï¼š æ§åˆ¶å½“å‰çš„è¾“å‡ºæœ‰å¤šå¤§ç¨‹åº¦ä¸Šå–å†³äº å½“å‰çš„è®°å¿†å•å…ƒ; è®°å¿†å•å…ƒ memory cell $c_t$. h\\_{t}=o\\_{t} \\odot \\operatorname{Tanh}\\left(c\\_{t}\\right) 5.3 Activation functionåœ¨ LSTM ä¸­, å…³äº activation function çš„é€‰å–ï¼š $\\Gamma_f$ã€$\\Gamma_i{u}$ å’Œ $\\Gamma_o$ ä½¿ç”¨ Sigmoid å‡½æ•°ä½œä¸ºæ¿€æ´»å‡½æ•°ï¼› åœ¨ç”Ÿæˆå€™é€‰è®°å¿†æ—¶ï¼Œä½¿ç”¨ Tanh ä½œä¸ºæ¿€æ´»å‡½æ•°ã€‚ æ³¨ï¼š è¿™ä¸¤ä¸ªæ¿€æ´»å‡½æ•°éƒ½æ˜¯é¥±å’Œçš„ï¼Œä¹Ÿå°±æ˜¯è¯´åœ¨è¾“å…¥è¾¾åˆ°ä¸€å®šå€¼çš„æƒ…å†µä¸‹ï¼Œè¾“å‡ºå°±ä¸ä¼šå‘ç”Ÿæ˜æ˜¾å˜åŒ–äº†ã€‚å¦‚æœæ˜¯ç”¨éé¥±å’Œçš„æ¿€æ´»å‡½æ•°ï¼Œä¾‹å¦‚ ReLUï¼Œé‚£ä¹ˆå°†éš¾ä»¥å®ç°é—¨æ§çš„æ•ˆæœã€‚ ä½¿ç”¨è¿™ä¸ªæ¿€æ´»å‡½æ•°çš„åŸå› å¦‚ä¸‹ï¼š (1). Sigmoid è¾“å‡ºåœ¨ 0ï½1 ä¹‹é—´ã€‚ä¸”å½“è¾“å…¥è¾ƒå¤§æˆ–è¾ƒå°æ—¶ï¼Œå…¶è¾“å‡ºä¼šéå¸¸æ¥è¿‘1æˆ–0ï¼Œä»è€Œä¿è¯è¯¥é—¨å¼€æˆ–å…³ã€‚ (2). åœ¨ç”Ÿæˆå€™é€‰è®°å¿†æ—¶ï¼Œä½¿ç”¨ Tanh å‡½æ•°ï¼Œæ˜¯å› ä¸ºå…¶è¾“å‡ºåœ¨ âˆ’1~1 ä¹‹é—´ï¼Œè¿™ä¸å¤§å¤šæ•°åœºæ™¯ä¸‹ç‰¹å¾åˆ†å¸ƒæ˜¯ 0 ä¸­å¿ƒçš„å»åˆã€‚æ­¤å¤–ï¼ŒTanh å‡½æ•°åœ¨è¾“å…¥ä¸º 0 é™„è¿‘ç›¸æ¯” Sigmoid å‡½æ•°æœ‰æ›´å¤§çš„æ¢¯åº¦ï¼Œé€šå¸¸ä½¿æ¨¡å‹æ”¶æ•›æ›´å¿«ã€‚ æ€»è€Œè¨€ä¹‹ï¼ŒLSTM ç»å†äº† 20 å¹´çš„å‘å±•ï¼Œå…¶æ ¸å¿ƒæ€æƒ³ä¸€è„‰ç›¸æ‰¿ï¼Œä½†å„ä¸ªç»„ä»¶éƒ½å‘ç”Ÿäº†å¾ˆå¤šæ¼”åŒ–ã€‚ GRU vs LSTM GRU å’Œ LSTM çš„æ•ˆæœåœ¨å¾ˆå¤šä»»åŠ¡ä¸Šä¸åˆ†ä¼¯ä»²ã€‚ GRU å‚æ•°æ›´å°‘å› æ­¤æ›´å®¹æ˜“æ”¶æ•›ï¼Œä½†æ˜¯æ•°æ®é›†å¾ˆå¤§çš„æƒ…å†µä¸‹ï¼ŒLSTMè¡¨è¾¾æ•ˆæœæ›´å¥½ï¼Œä½†è®¡ç®—é‡æ›´å¤§ã€‚ ä»ç»“æ„ä¸Šæ¥è¯´ï¼š GRU åªæœ‰ä¸¤ä¸ªé—¨ï¼ˆupdateå’Œresetï¼‰ï¼ŒLSTM æœ‰ä¸‰ä¸ªé—¨ï¼ˆforgetï¼Œinputï¼Œoutputï¼‰ GRU ç›´æ¥å°† hidden state ä¼ ç»™ä¸‹ä¸€ä¸ªå•å…ƒï¼Œè€Œ LSTM åˆ™ç”¨ memory cell æŠŠhidden state åŒ…è£…èµ·æ¥ã€‚ 6. Bidirectional RNNå‰é¢ä»‹ç»çš„éƒ½æ˜¯å•å‘çš„ RNN ç»“æ„ï¼Œåœ¨å¤„ç†æŸäº›é—®é¢˜ä¸Šå¾—åˆ°çš„æ•ˆæœä¸å°½äººæ„ å¦‚ä¸‹é¢ä¸¤å¥è¯ï¼Œæˆ‘ä»¬è¦ä»ä¸­æ ‡å‡ºäººåï¼š He said, â€œTeddy Roosevelt was a great Presidentâ€.He said, â€œTeddy bears are on saleâ€. ç¬¬ä¸€å¥ä¸­çš„ Teddy Roosevelt æ˜¯äººå ç¬¬äºŒå¥ä¸­çš„ Teddy bears æ˜¯æ³°è¿ªç†Šï¼ŒåŒæ ·éƒ½æ˜¯å•è¯ Teddy å¯¹åº”çš„è¾“å‡ºåœ¨ç¬¬ä¸€å¥ä¸­åº”è¯¥æ˜¯ 1ï¼Œç¬¬äºŒå¥ä¸­åº”è¯¥æ˜¯ 0 åƒè¿™æ ·çš„ä¾‹å­å¦‚æœæƒ³è®©æˆ‘ä»¬çš„åºåˆ—æ¨¡å‹æ˜ç™½å°±éœ€è¦å€ŸåŠ©ä¸åŒçš„ç»“æ„æ¯”å¦‚ - åŒå‘é€’å½’ç¥ç»ç½‘ç»œ(Bidirectional RNN).è¯¥ç¥ç»ç½‘ç»œé¦–å…ˆä»æ­£é¢ç†è§£ä¸€éè¿™å¥è¯ï¼Œå†ä»åæ–¹å‘ç†è§£ä¸€é. ä¸‹å›¾æ‘˜è‡ªå¤§æ•°æ®æ–‡æ‘˜æ•´ç† 7. Deep RNNsæ·±å±‚ï¼Œé¡¾åæ€ä¹‰å°±æ˜¯å±‚æ¬¡å¢åŠ ã€‚å¦‚ä¸‹å›¾æ˜¯æ·±å±‚å¾ªç¯ç¥ç»ç½‘ç»œçš„ç¤ºæ„å›¾ æ¨ªå‘è¡¨ç¤ºæ—¶é—´å±•å¼€ï¼Œçºµå‘åˆ™æ˜¯å±‚æ¬¡å±•å¼€ã€‚ æ³¨æ„æ¿€æ´»å€¼çš„è¡¨è¾¾å½¢å¼æœ‰æ‰€æ”¹å˜ï¼Œä»¥ $a^{[1]}$ ä¸ºä¾‹è¿›è¡Œè§£é‡Šï¼š [1] è¡¨ç¤ºç¬¬ä¸€å±‚ è¡¨ç¤ºç¬¬ä¸€ä¸ªæ¿€æ´»å€¼ å¦å¤–å„ä¸ªæ¿€æ´»å€¼çš„è®¡ç®—å…¬å¼ä¹Ÿç•¥æœ‰ä¸åŒï¼Œä»¥ $a^{[2]}$ ä¸ºä¾‹ï¼Œå…¶è®¡ç®—å…¬å¼å¦‚ä¸‹ï¼š Reference ã€Šç™¾é¢æœºå™¨å­¦ä¹ ã€‹ RNN and CNN LSTM é•¿çŸ­æœŸè®°å¿†ç½‘ç»œ","categories":[{"name":"deeplearning","slug":"deeplearning","permalink":"http://iequa.com/categories/deeplearning/"}],"tags":[{"name":"RNN","slug":"RNN","permalink":"http://iequa.com/tags/RNN/"}]},{"title":"Convolutional Neural Networks","slug":"deeplearning/CNN","date":"2019-06-13T02:06:16.000Z","updated":"2019-10-20T04:30:35.022Z","comments":true,"path":"2019/06/13/deeplearning/CNN/","link":"","permalink":"http://iequa.com/2019/06/13/deeplearning/CNN/","excerpt":"","text":"CNN åŸºç¡€çŸ¥è¯†ï¼Œè¯¦å‚æœ¬åšï¼š Convolutional-Neural-Networks Convolutional Neural Networksï¼ŒCNN ä¹Ÿæ˜¯ä¸€ç§å‰é¦ˆç¥ç»ç½‘ç»œï¼Œå…¶ç‰¹ç‚¹æ˜¯æ¯å±‚çš„ç¥ç»å…ƒèŠ‚ç‚¹åªå“åº”å‰ä¸€å±‚å±€éƒ¨åŒºåŸŸèŒƒå›´å†…çš„ç¥ç»å…ƒï¼ˆå…¨è¿æ¥ç½‘ç»œä¸­æ¯ä¸ªç¥ç»å…ƒèŠ‚ç‚¹å“åº”å‰ä¸€å±‚çš„å…¨éƒ¨èŠ‚ç‚¹ï¼‰ã€‚ ä¸€ä¸ª DCNN é€šå¸¸ç”±è‹¥å¹² Convolutional-Layer å åŠ è‹¥å¹² Fully-Connected ç»„æˆï¼Œä¸­é—´ä¹ŸåŒ…å«å„ç§ Non-Linear æ“ä½œä»¥åŠ Pooling æ“ä½œã€‚ Convolution operation çš„å‚æ•°å…±äº«ç‰¹æ€§ä½¿å¾—éœ€è¦ä¼˜åŒ–çš„å‚æ•°æ•°ç›®å¤§å¤§ç¼©å‡ï¼Œæé«˜äº†æ¨¡å‹çš„è®­ç»ƒæ•ˆç‡ä»¥åŠå¯æ‰©å±•æ€§ã€‚ 1. Convolutional Function1.1 Sparse Interaction&nbsp;&nbsp;ç¨ å¯†çš„è¿æ¥ç»“æ„, ç¥ç»å…ƒ $s_i$ ä¸è¾“å…¥çš„æ‰€æœ‰ç¥ç»å…ƒ $x_j$ å‡æœ‰è¿æ¥ï¼š &nbsp;&nbsp;å·ç§¯ï¼Œ æ¯ä¸ªè¾“å‡ºç¥ç»å…ƒä»…ä¸å‰ä¸€å±‚ç‰¹å®šå±€éƒ¨åŒºåŸŸå†…çš„ç¥ç»å…ƒå­˜åœ¨è¿æ¥ï¼š ç¥ç»å…ƒ $s_i$ ä»…ä¸å‰ä¸€å±‚ä¸­çš„ $x_{iâˆ’1}$, $x_i$ å’Œ $x_{i+1}$ ç›¸è¿ã€‚å…·ä½“æ¥è®²å¦‚æœé™å®šæ¯ä¸ªè¾“å‡ºä¸å‰ä¸€å±‚ç¥ç»å…ƒçš„è¿æ¥æ•°ä¸º k ï¼Œé‚£ä¹ˆè¯¥å±‚çš„å‚æ•°æ€»é‡ä¸º $kÃ—n$ã€‚åœ¨å®é™…åº”ç”¨ä¸­ï¼Œä¸€èˆ¬ $k$ å€¼è¿œå°äº $m$ å°±å¯ä»¥å–å¾—è¾ƒä¸ºå¯è§‚çš„æ•ˆæœï¼›å¤æ‚åº¦å°†ä¼šå‡å°å‡ ä¸ªæ•°é‡çº§ï¼Œè¿‡æ‹Ÿåˆçš„æƒ…å†µæ”¹å–„. ç¨€ç–äº¤äº’çš„ç‰©ç†æ„ä¹‰ï¼š 1.2 Parameter Sharing Fully-Connected Networksï¼Œè®¡ç®—æ¯å±‚çš„è¾“å‡ºæ—¶ï¼Œæƒå€¼å‚æ•°çŸ©é˜µä¸­çš„æ¯ä¸ªå…ƒç´ åªä½œç”¨äºæŸä¸ªè¾“å…¥å…ƒç´ ä¸€æ¬¡ï¼› CNNï¼Œå·ç§¯æ ¸ä¸­çš„æ¯ä¸€ä¸ªå…ƒç´ å°†ä½œç”¨äºæ¯ä¸€æ¬¡å±€éƒ¨è¾“å…¥çš„ç‰¹å®šä½ç½®ä¸Šã€‚ æ ¹æ®å‚æ•°å…±äº«çš„æ€æƒ³ï¼Œæˆ‘ä»¬åªéœ€è¦å­¦ä¹ ä¸€ç»„å‚æ•°é›†åˆï¼Œè€Œä¸éœ€è¦é’ˆå¯¹æ¯ä¸ªä½ç½®çš„æ¯ä¸ªå‚æ•°éƒ½è¿›è¡Œä¼˜åŒ–ï¼Œä»è€Œå¤§å¤§é™ä½äº†æ¨¡å‹çš„å­˜å‚¨éœ€æ±‚ã€‚ å‚æ•°å…±äº«çš„ç‰©ç†æ„ä¹‰æ˜¯ä½¿å¾—å·ç§¯å±‚å…·æœ‰å¹³ç§»ç­‰å˜æ€§ã€‚ä»€ä¹ˆæ„æ€ï¼Ÿå‡å¦‚å›¾åƒä¸­æœ‰ä¸€åªçŒ«ï¼Œé‚£ä¹ˆæ— è®ºå®ƒå‡ºç°åœ¨å›¾åƒä¸­çš„ä»»ä½•ä½ç½®ï¼Œæˆ‘ä»¬éƒ½åº”è¯¥å°†å®ƒè¯†åˆ«ä¸ºçŒ«ï¼Œä¹Ÿå°±æ˜¯è¯´ç¥ç»ç½‘ç»œçš„è¾“å‡ºå¯¹äºå¹³ç§»å˜æ¢æ¥è¯´åº”å½“æ˜¯ç­‰å˜çš„ã€‚ 2. Pooling Function mean pooling max pooling pooling çš„æœ¬è´¨æ˜¯é™é‡‡æ ·. pooling é™¤äº†èƒ½æ˜¾è‘—é™ä½å‚æ•°é‡å¤–ï¼Œè¿˜èƒ½å¤Ÿä¿æŒå¯¹å¹³ç§»ã€ä¼¸ç¼©ã€æ—‹è½¬æ“ä½œçš„ä¸å˜æ€§ã€‚ 3. CNN æ–‡æœ¬åˆ†ç±»ä»»åŠ¡CNN çš„æ ¸å¿ƒæ€æƒ³æ˜¯æ•æ‰å±€éƒ¨ç‰¹å¾ï¼Œèµ·åˆåœ¨å›¾åƒé¢†åŸŸå–å¾—äº†å·¨å¤§çš„æˆåŠŸï¼Œåæ¥åœ¨æ–‡æœ¬é¢†åŸŸä¹Ÿå¾—åˆ°äº†å¹¿æ³›çš„åº”ç”¨ã€‚å¯¹äºæ–‡æœ¬æ¥è¯´ï¼Œå±€éƒ¨ç‰¹å¾å°±æ˜¯ç”±è‹¥å¹²å•è¯ç»„æˆçš„æ»‘åŠ¨çª—å£ï¼Œç±»ä¼¼äº N-gram. CNN çš„ä¼˜åŠ¿åœ¨äºèƒ½å¤Ÿè‡ªåŠ¨åœ°å¯¹ N-gram ç‰¹å¾è¿›è¡Œç»„åˆå’Œç­›é€‰ï¼Œè·å¾—ä¸åŒæŠ½è±¡å±‚æ¬¡çš„è¯­ä¹‰ä¿¡æ¯ã€‚ (1). è¾“å…¥å±‚æ˜¯ä¸€ä¸ª $NÃ—K$ çš„çŸ©é˜µï¼Œå…¶ä¸­ $N$ ä¸ºæ–‡ç« æ‰€å¯¹åº”çš„å•è¯æ€»æ•°ï¼Œ$K$ æ˜¯æ¯ä¸ªè¯å¯¹åº”çš„è¡¨ç¤ºå‘é‡çš„ç»´åº¦. (2). å·ç§¯å±‚ã€‚åœ¨è¾“å…¥çš„ $NÃ—K$ ç»´çŸ©é˜µä¸Šï¼Œæˆ‘ä»¬å®šä¹‰ä¸åŒå¤§å°çš„æ»‘åŠ¨çª—å£è¿›è¡Œå·ç§¯æ“ä½œ. (3). æ± åŒ–å±‚ï¼Œç½‘ç»œé‡‡ç”¨äº† 1-MaxPool, è¾¾åˆ°çš„æ•ˆæœéƒ½æ˜¯å°†ä¸åŒé•¿åº¦çš„å¥å­é€šè¿‡æ± åŒ–å¾—åˆ°ä¸€ä¸ªå®šé•¿çš„å‘é‡è¡¨ç¤ºã€‚ (4). å¾—åˆ°æ–‡æœ¬çš„å‘é‡è¡¨ç¤ºä¹‹åï¼Œæ¥ä¸€ä¸ªå…¨è¿æ¥å±‚ï¼Œå¹¶ä½¿ç”¨ Softmax æ¿€æ´»å‡½æ•°è¾“å‡ºæ¯ä¸ªç±»åˆ«çš„æ¦‚ç‡ã€‚ æ•´ä¸ªæ¨¡å‹ç”±å››éƒ¨åˆ†æ„æˆï¼š è¾“å…¥å±‚ã€å·ç§¯å±‚ã€æ± åŒ–å±‚ã€å…¨è¿æ¥å±‚ã€‚ æ›´å¤šèµ„æ–™è¯¦è§ï¼š TextCNNæ–‡æœ¬åˆ†ç±» é’ˆå¯¹æµ·é‡çš„æ–‡æœ¬å¤šåˆ†ç±»æ•°æ®ï¼Œä¹Ÿå¯ä»¥å°è¯•ä¸€ä¸‹æµ…å±‚çš„æ·±åº¦å­¦ä¹ æ¨¡å‹ FastTextæ¨¡å‹ï¼Œè¯¥æ¨¡å‹çš„åˆ†ç±»æ•ˆç‡æ›´é«˜. 4. ResNetæ·±åº¦ç¥ç»ç½‘ç»œçš„å±‚æ•°å†³å®šäº†æ¨¡å‹çš„å®¹é‡ï¼Œç„¶è€Œéšç€ç¥ç»ç½‘ç»œå±‚æ•°çš„åŠ æ·±ï¼š ä¼˜åŒ–å‡½æ•°è¶Šæ¥è¶Šé™·å…¥å±€éƒ¨æœ€ä¼˜è§£ã€‚ åŒæ—¶ï¼Œéšç€ç½‘ç»œå±‚æ•°çš„å¢åŠ ï¼Œæ¢¯åº¦æ¶ˆå¤±çš„é—®é¢˜æ›´åŠ ä¸¥é‡ï¼Œè¿™æ˜¯å› ä¸ºæ¢¯åº¦åœ¨åå‘ä¼ æ’­æ—¶ä¼šé€æ¸è¡°å‡ã€‚ç‰¹åˆ«æ˜¯åˆ©ç”¨ Sigmoid æ¿€æ´»å‡½æ•°æ—¶ï¼Œä½¿å¾—è¿œç¦»è¾“å‡ºå±‚ï¼ˆå³æ¥è¿‘è¾“å…¥å±‚ï¼‰çš„ç½‘ç»œå±‚ä¸èƒ½å¤Ÿå¾—åˆ°æœ‰æ•ˆçš„å­¦ä¹ ï¼Œå½±å“äº†æ¨¡å‹æ³›åŒ–çš„æ•ˆæœã€‚ Deep Residual Networkï¼ŒResNet çš„æå‡ºèƒŒæ™¯å’Œæ ¸å¿ƒç†è®ºæ˜¯ä»€ä¹ˆï¼Ÿ ResNet çš„æå‡ºèƒŒæ™¯æ˜¯è§£å†³æˆ–ç¼“è§£ Deep Neural Networks è®­ç»ƒä¸­çš„ Gradients Vanishing é—®é¢˜ ResNetåœ¨ ImageNet ç«èµ›å’Œ AlphaGo Zero çš„åº”ç”¨ä¸­éƒ½å–å¾—äº†éå¸¸å¥½çš„æ•ˆæœ. Reference ã€Šç™¾é¢æœºå™¨å­¦ä¹ ã€‹ è¿­ä»£è‡ªå·± DCNN","categories":[{"name":"deeplearning","slug":"deeplearning","permalink":"http://iequa.com/categories/deeplearning/"}],"tags":[{"name":"CNN","slug":"CNN","permalink":"http://iequa.com/tags/CNN/"}]},{"title":"Deep Feedforward Networks","slug":"deeplearning/Deep-Feedforward-Networks","date":"2019-06-12T02:06:16.000Z","updated":"2019-10-20T04:30:35.016Z","comments":true,"path":"2019/06/12/deeplearning/Deep-Feedforward-Networks/","link":"","permalink":"http://iequa.com/2019/06/12/deeplearning/Deep-Feedforward-Networks/","excerpt":"","text":"æ›´å¤šåŸºç¡€çŸ¥è¯†ç³»åˆ—è¯¦æƒ…å‚è§ : Deep Learning Notes Feedforward Networks æ˜¯ä¸€ç§æœ€ç®€å•çš„ç¥ç»ç½‘ç»œï¼Œå„ç¥ç»å…ƒåˆ†å±‚æ’åˆ—ã€‚æ¯ä¸ªç¥ç»å…ƒåªä¸å‰ä¸€å±‚çš„ç¥ç»å…ƒç›¸è¿ã€‚æ¥æ”¶å‰ä¸€å±‚çš„è¾“å‡ºï¼Œå¹¶è¾“å‡ºç»™ä¸‹ä¸€å±‚ï¼å„å±‚é—´æ²¡æœ‰åé¦ˆã€‚ Feedforward Networks æ˜¯ä¸€ç±»ç½‘ç»œçš„ç»Ÿç§°: MLPã€Autoencoderã€RBMã€CNN ç­‰éƒ½å±äºè¿™ç±». å¯¹äºä¸­é—´å±‚æ¥è¯´, å¾€å¾€æ˜¯ ReLU çš„æ•ˆæœæœ€å¥½.è™½ç„¶ z &lt; 0, çš„æ—¶å€™ï¼Œæ–œç‡ä¸º0ï¼Œ ä½†åœ¨å®è·µä¸­ï¼Œæœ‰è¶³å¤Ÿå¤šçš„éšè—å•å…ƒ ä»¤ z &gt; 0, å¯¹å¤§å¤šæ•°è®­ç»ƒæ ·æœ¬æ¥è¯´æ˜¯å¾ˆå¿«çš„. so the one place you might use as linear activation function others usually in the output layer. 1. Neural Networks Basics 2. Activation functionså››ç§å¸¸ç”¨çš„æ¿€æ´»å‡½æ•°: Sigmoid, Tanh, ReLU, Leaky ReLU. å…¶ä¸­ sigmoid æˆ‘ä»¬å·²ç»è§è¿‡äº†, å®ƒçš„è¾“å‡ºå¯çœ‹æˆä¸€ä¸ªæ¦‚ç‡å€¼, å¾€å¾€ç”¨åœ¨è¾“å‡ºå±‚. å¯¹äºä¸­é—´å±‚æ¥è¯´, å¾€å¾€ReLUæ•ˆæœæœ€å¥½. Tanh æ•°æ®å¹³å‡å€¼ä¸º 0ï¼Œå…·æœ‰æ•°æ®ä¸­å¿ƒåŒ–çš„æ•ˆæœï¼Œå‡ ä¹åœ¨ä»»ä½•åœºåˆéƒ½ä¼˜äº Sigmoid ä¸ºä»€ä¹ˆéœ€è¦æ¿€æ´»å‡½æ•°? å¦‚æœæ²¡æœ‰æ¿€æ´»å‡½æ•°, é‚£ä¹ˆä¸è®ºå¤šå°‘å±‚çš„ç¥ç»ç½‘ç»œéƒ½åªç›¸å½“äºä¸€ä¸ªLR: it turns out that if you use a linear activation function or alternatively if you donâ€™t have an activation function, then no matter how many layers your neural network has, always doing just computing a linear activation function, so you might as well not have any hidden layers. so unless you throw a non-linearity in there, then youâ€™re not computing more interesting functions ReLU (rectified linear unit çŸ«æ­£çº¿æ€§å•å…ƒ) tanh å’Œ sigmoid éƒ½æœ‰ä¸€ä¸ªç¼ºç‚¹ï¼Œå°±æ˜¯ z éå¸¸å¤§æˆ–è€…éå¸¸å°ï¼Œå‡½æ•°çš„æ–œç‡(å¯¼æ•°æ¢¯åº¦)å°±ä¼šéå¸¸å°, æ¢¯åº¦ä¸‹é™å¾ˆæ…¢. the slope of the function you know ends up being close to zero, and so this can slow down gradient descent ReLU (rectified linear unit) is well, z = 0 çš„æ—¶å€™ï¼Œä½ å¯ä»¥ç»™å¯¼æ•°èµ‹å€¼ä¸º 0 or 1ï¼Œè™½ç„¶è¿™ä¸ªç‚¹æ˜¯ä¸å¯å¾®çš„. ä½†å®ç°æ²¡æœ‰å½±å“. è™½ç„¶ z &lt; 0, çš„æ—¶å€™ï¼Œæ–œç‡ä¸º0ï¼Œ ä½†åœ¨å®è·µä¸­ï¼Œæœ‰è¶³å¤Ÿå¤šçš„éšè—å•å…ƒ ä»¤ z &gt; 0, å¯¹å¤§å¤šæ•°è®­ç»ƒæ ·æœ¬æ¥è¯´æ˜¯å¾ˆå¿«çš„. æ¿€æ´»å‡½æ•°çš„å¯¹æ¯”: Sigmoid å’Œ Tanh ä¸ºä»€ä¹ˆä¼šå¯¼è‡´ Vanishing/Exploding gradients ? Tanh å€¼åŸŸ (-1,1) Sigmoid å€¼åŸŸ (0,1) ReLU çš„ä¼˜ç‚¹ï¼Œå’Œå±€é™æ€§åˆ†åˆ«æ˜¯ä»€ä¹ˆ? è°ˆè°ˆæ¿€æ´»å‡½æ•° Sigmoid,Tanh,ReLu,softplus,softmax 3. Initialization weightsåœ¨ LR ä¸­æˆ‘ä»¬çš„å‚æ•° $w$ åˆå§‹åŒ–ä¸º 0, å¦‚æœåœ¨ç¥ç»ç½‘ç»œä¸­ä¹Ÿæ˜¯ç”¨ç›¸åŒçš„åˆå§‹åŒ–, é‚£ä¹ˆä¸€ä¸ªéšè—å±‚çš„æ¯ä¸ªèŠ‚ç‚¹éƒ½æ˜¯ç›¸åŒçš„, ä¸è®ºè¿­ä»£å¤šå°‘æ¬¡. è¿™æ˜¾ç„¶æ˜¯ä¸åˆç†çš„, æ‰€ä»¥æˆ‘ä»¬åº”è¯¥ éšæœºåœ°åˆå§‹åŒ– $w$ ä»è€Œè§£å†³è¿™ä¸ª sysmmetry breaking problem. ç ´åå¯¹ç§°é—®é¢˜ å…·ä½“åˆå§‹åŒ–ä»£ç å¯å‚è§ä¸‹å›¾, å…¶ä¸­ ä¹˜ä»¥ 0.01 æ˜¯ä¸ºäº†è®©å‚æ•° $w$ è¾ƒå°, åŠ é€Ÿæ¢¯åº¦ä¸‹é™ å¦‚æ¿€æ´»ä¸º tanh æ—¶, è‹¥å‚æ•°è¾ƒå¤§åˆ™ $z$ ä¹Ÿè¾ƒå¤§, æ­¤æ—¶æ¢¯åº¦æ¥è¿‘äº 0, æ›´æ–°ç¼“æ…¢. å¦‚ä¸æ˜¯ tanh or sigmoid åˆ™é—®é¢˜ä¸å¤§. this is a relatively shallow neural network without too many hidden layers, so 0.01 maybe work ok. finally it turns out that sometimes there can be better constants than 0.01. 4. Improving DNNæ·±åº¦å­¦ä¹ çš„å®ç”¨å±‚é¢ ï¼š èƒ½å¤Ÿé«˜æ•ˆåœ°ä½¿ç”¨ç¥ç»ç½‘ç»œé€šç”¨çš„æŠ€å·§ï¼ŒåŒ…æ‹¬ åˆå§‹åŒ–ã€L2å’Œdropoutæ­£åˆ™åŒ–ã€Batchå½’ä¸€åŒ–ã€æ¢¯åº¦æ£€éªŒã€‚ èƒ½å¤Ÿå®ç°å¹¶åº”ç”¨å„ç§ä¼˜åŒ–ç®—æ³•ï¼Œä¾‹å¦‚ Mini-batchã€Momentumã€RMSpropã€Adamï¼Œå¹¶æ£€æŸ¥å®ƒä»¬çš„æ”¶æ•›ç¨‹åº¦ã€‚ ç†è§£æ·±åº¦å­¦ä¹ æ—¶ä»£å…³äºå¦‚ä½• æ„å»ºè®­ç»ƒ/å¼€å‘/æµ‹è¯•é›† ä»¥åŠ åå·®/æ–¹å·®åˆ†æ æœ€æ–°æœ€æœ‰æ•ˆçš„æ–¹æ³•. 4.1 Train/dev/testä¼ ç»Ÿçš„æœºå™¨å­¦ä¹ ä¸­ï¼š é€šå¸¸æŒ‰ç…§ 70/30 æ¥æ•°æ®é›†, æˆ–è€…æŒ‰ç…§ 60/20/20 çš„æ¯”ä¾‹åˆ†ä¸º Train/Validation/Test. æ·±åº¦å­¦ä¹ é—®é¢˜ä¸­: æˆ‘ä»¬å¯ç”¨çš„æ•°æ®é›†çš„é‡çº§éå¸¸å¤§. è¿™æ—¶æˆ‘ä»¬å°±ä¸éœ€è¦ç»™éªŒè¯é›†å’Œæµ‹è¯•é›†å¤ªå¤§çš„æ¯”ä¾‹, ä¾‹å¦‚ 98/1/1. 4.2 Regularizationä¸ºä»€ä¹ˆæ­£åˆ™åŒ–æ²¡æœ‰åŠ  $\\frac{\\lambda}{2m} b^2$: å› ä¸º $w$ é€šå¸¸æ˜¯ä¸€ä¸ªé«˜ç»´å‚æ•°çŸ¢é‡, å·²ç»å¯ä»¥è¡¨è¾¾ High bias çš„é—®é¢˜, $w$ å¯èƒ½å«æœ‰å¾ˆå¤šå‚æ•°ï¼Œæˆ‘ä»¬ä¸å¯èƒ½æ‹Ÿåˆæ‰€æœ‰å‚æ•°, è€Œ $b$ åªæ˜¯å•ä¸ªæ•°å­—, æ‰€ä»¥ $w$ å‡ ä¹è¦†ç›–äº†æ‰€æœ‰å‚æ•°ï¼Œè€Œä¸æ˜¯ $b$, å¦‚æœåŠ äº† $b$ ä¹Ÿæ²¡æœ‰å½±å“ï¼Œå› ä¸º $b$ åªæ˜¯ä¼—å¤šå‚æ•°ä¸­çš„ä¸€ä¸ª. L1 regularization : å¦‚æœç”¨çš„æ˜¯ L1 regularization, then $w$ will end up being sprase ç¨€ç–çš„, ä¹Ÿå°±æ˜¯è¯´ $w$ å‘é‡ä¸­æœ‰å¾ˆå¤š 0. æœ‰äººè¯´è¿™æ ·æœ‰åˆ©äºå‹ç¼©æ¨¡å‹ï¼Œä½†æ˜¯æˆ‘è§‰å¾—ä¸æ˜¯å¾ˆåˆé€‚. è¶Šæ¥è¶Šå¤šçš„äººä½¿ç”¨ L2. Notes: ä¸ç§°ä¸º:çŸ©é˜µ L2 èŒƒæ•°ï¼Œ æŒ‰ç…§æƒ¯ä¾‹æˆ‘ä»¬ç§°ä¸º: Frobenius norm of a matrix, å…¶å®å°±æ˜¯ : çŸ©é˜µ L2. L2 regularization : L2 regularization ä¸‹çš„ Cost Function å¦‚ä¸‹æ‰€ç¤º, åªéœ€è¦æ·»åŠ æ­£åˆ™é¡¹ $\\frac{\\lambda}{2m}\\sum_{l=1}^L||w^{[l]}||^2_F$, å…¶ä¸­ F ä»£è¡¨ Frobenius Norm. åœ¨æ·»åŠ äº†æ­£åˆ™é¡¹ä¹‹å, ç›¸åº”çš„æ¢¯åº¦ä¹Ÿè¦å˜åŒ–, æ‰€ä»¥åœ¨æ›´æ–°å‚æ•°çš„æ—¶å€™éœ€è¦åŠ ä¸Šå¯¹åº”çš„é¡¹. è¿™é‡Œæ³¨æ„ä¸€ç‚¹, æˆ‘ä»¬åªå¯¹å‚æ•° $w$ æ­£åˆ™, è€Œä¸å¯¹ $b$. å› ä¸ºå¯¹äºæ¯ä¸€å±‚æ¥è¯´, $w$ æœ‰å¾ˆé«˜çš„ç»´åº¦, è€Œ $b$ åªæ˜¯ä¸€ä¸ªæ ‡é‡. $w$ å¯¹æ•´ä¸ªæ¨¡å‹çš„å½±å“è¿œå¤§äº $b$. ä¸‹é¢ç»™å‡ºæ·»åŠ  regularization ä¸ºä»€ä¹ˆèƒ½é˜²æ­¢è¿‡æ‹Ÿåˆç»™å‡ºç›´è§‚çš„è§£é‡Š: å½“æˆ‘ä»¬çš„ Î» æ¯”è¾ƒå¤§çš„æ—¶å€™, æ¨¡å‹å°±ä¼šåŠ å¤§å¯¹ w çš„æƒ©ç½š, è¿™æ ·æœ‰äº› w å°±ä¼šå˜å¾—å¾ˆå° (L2 Regularization ä¹Ÿå«æƒé‡è¡°å‡, weights decay). æ•ˆæœå°±æ˜¯æ•´ä¸ªç¥ç»ç½‘ç»œå˜å¾—ç®€å•äº†(ä¸€äº›éšè—å±‚ç”šè‡³ $w$ è¶‹å‘äº 0), ä»è€Œé™ä½äº†è¿‡æ‹Ÿåˆçš„é£é™©. é‚£äº› éšè—å±‚ å¹¶æ²¡æœ‰è¢«æ¶ˆé™¤ï¼Œåªæ˜¯å½±å“å˜å¾—æ›´å°äº†ï¼Œç¥ç»ç½‘ç»œå˜å¾—ç®€å•äº†. ä»å¦ä¸€ä¸ªè§’åº¦æ¥çœ‹. ä»¥ tanhæ¿€æ´»å‡½æ•° ä¸ºä¾‹, å½“ $Î»$ å¢åŠ æ—¶, $w$ ä¼šåå°, è¿™æ · $z = wa +b$ ä¹Ÿä¼šåå°, æ­¤æ—¶çš„æ¿€æ´»å‡½æ•°å¤§è‡´æ˜¯çº¿æ€§çš„. è¿™æ ·æ¨¡å‹çš„å¤æ‚åº¦ä¹Ÿå°±é™ä½äº†, å³é™ä½äº†è¿‡æ‹Ÿåˆçš„é£é™©. å¦‚æœç¥ç»ç½‘ç»œæ¯å±‚éƒ½æ˜¯çº¿æ€§çš„ï¼Œå…¶å®æ•´ä¸ªè¿˜æ˜¯ä¸€ä¸ªçº¿æ€§çš„, å³ä½¿æ˜¯ä¸€ä¸ªå¾ˆæ·±çš„ç½‘ç»œï¼Œå› ä¸ºçº¿æ€§æ¿€æ´»å‡½æ•°çš„ç‰¹å¾ï¼Œæœ€ç»ˆæˆ‘ä»¬åªèƒ½è®¡ç®—çº¿æ€§å‡½æ•°. Other Regularization Data augmentation Early stopping W å¼€å§‹æ˜¯å˜å°çš„ï¼Œä¹‹åä¼šéšç€è¿­ä»£è¶Šæ¥è¶Šå¤§. early stopping å°±æ˜¯åœ¨ä¸­é—´ç‚¹åœæ­¢è¿­ä»£è¿‡ç¨‹. å…¶å®å¯ä»¥è®¾ç½®åœ¨ J ä¸åœ¨æ˜æ˜¾ä¸‹é™çš„æ—¶å€™ï¼Œè®¾ç½® Early Stopping. Notes: &nbsp;&nbsp; 1. early stopping ç¼ºç‚¹æ˜¯ ææ—©åœæ­¢ï¼Œw æ˜¯é˜²æ­¢äº†è¿‡æ‹Ÿåˆï¼Œä½†æ˜¯ J æ²¡æœ‰è¢«ç»§ç»­ä¸‹é™.&nbsp;&nbsp; 2. L2 æ­£åˆ™åŒ– çš„ç¼ºç‚¹æ˜¯ï¼Œè¦ç”¨å¤§é‡ç²¾åŠ›æœç´¢åˆé€‚çš„ Î» . 4.3 Dropoutdropout ä¹Ÿæ˜¯ä¸€ç§æ­£åˆ™åŒ–çš„æ‰‹æ®µ, åœ¨è®­ç»ƒæ—¶ä»¥ 1-keep_prob éšæœºåœ°â€ä¸¢å¼ƒâ€ä¸€äº›èŠ‚ç‚¹. å¦‚ä¸‹å›¾æ‰€ç¤º. dropout å°†äº§ç”Ÿæ”¶ç¼©æƒé‡çš„å¹³æ–¹èŒƒæ•°çš„æ•ˆæœ, å’Œ L2 ç±»ä¼¼ï¼Œå®æ–½ dropout çš„ç»“æœæ˜¯å®ƒä¼šå‹ç¼©æƒé‡ï¼Œå¹¶å®Œæˆä¸€äº›é¢„é˜²è¿‡æ‹Ÿåˆçš„å¤–å±‚æ­£åˆ™åŒ–ï¼Œäº‹å®è¯æ˜ dropout è¢«æ­£å¼åœ°ä½œä¸ºä¸€ç§æ­£åˆ™åŒ–çš„æ›¿ä»£å½¢å¼ L2 å¯¹ä¸åŒæƒé‡çš„è¡°å‡æ˜¯ä¸åŒçš„ï¼Œå®ƒå–å†³äºå€å¢çš„æ¿€æ´»å‡½æ•°çš„å¤§å°. dropout çš„åŠŸèƒ½ç±»ä¼¼äº L2 æ­£åˆ™åŒ–. ç”šè‡³ dropout æ›´é€‚ç”¨äºä¸åŒçš„è¾“å…¥èŒƒå›´. å…¶ä»– : è®¡ç®—æœºè§†è§‰çš„äººå‘˜éå¸¸é’Ÿæƒ… dropout å‡½æ•°. Notes: dropout çš„ä¸€å¤§ç¼ºç‚¹å°±æ˜¯ J ä¸ä¼šè¢«æ˜ç¡®å®šä¹‰. æ¯æ¬¡è¿­ä»£éƒ½ä¼šè¢«éšæœºåˆ é™¤ä¸€äº›èŠ‚ç‚¹. å¦‚æœå†ä¸‰æ£€æŸ¥æ¢¯åº¦ä¸‹é™çš„æ€§èƒ½ï¼Œå®é™…ä¸Šæ˜¯å¾ˆéš¾å¤æŸ¥çš„. å®šä¹‰æ˜ç¡®çš„ä»£ä»·å‡½æ•°ï¼Œæ¯æ¬¡è¿­ä»£éƒ½ä¼šä¸‹é™. å› ä¸º dropout ä½¿å¾— J æ²¡æœ‰è¢«æ˜ç¡®å®šä¹‰ï¼Œæˆ–è€…åœ¨æŸç§ç¨‹åº¦ä¸Šå¾ˆéš¾è®¡ç®—. æ‰€ä»¥æˆ‘ä»¬å¤±å»äº†è°ƒè¯•å·¥å…·ï¼Œæˆ‘é€šå¸¸ä¼šå…³é—­ dropout. keep_prob è®¾ç½®ä¸º 1ï¼Œ è¿è¡Œä»£ç ï¼Œç¡®ä¿ J å‡½æ•°å•è°ƒé€’å‡, ç„¶ååœ¨æ‰“å¼€ dropout, åœ¨ dropout çš„è¿‡ç¨‹ä¸­ï¼Œä»£ç å¹¶æœªå¼•å…¥bug. 4.4 Normalization 0 å‡å€¼åŒ– å½’ä¸€åŒ– æ–¹å·® ä¸Šå›¾2ï¼Œ ç‰¹å¾ x1 çš„æ–¹å·® æ¯” ç‰¹å¾ x2 çš„æ–¹å·® å¤§å¾ˆå¤šä¸Šå›¾3ï¼Œ ç‰¹å¾ x1 å’Œ ç‰¹å¾ x2 çš„ æ–¹å·® éƒ½æ˜¯ 1 æ³¨æ„: è®­ç»ƒé›† å’Œ æµ‹è¯•é›†ï¼Œéƒ½æ˜¯é€šè¿‡ç›¸åŒçš„ $\\mu$ å’Œ ${\\sigma}^2$ å®šä¹‰çš„ç›¸åŒæ•°æ®è½¬æ¢, å…¶ä¸­ $\\mu$ å’Œ ${\\sigma}^2$ æ˜¯ç”±è®­ç»ƒæ•°æ®è®¡ç®—è€Œæ¥. å¼ ä¿Šæ— - Batch Normalizationå¯¼è¯» ã€ å¼ ä¿Šæ— - æ·±åº¦å­¦ä¹ ä¸­çš„Normalizationæ¨¡å‹ Internal Covariate Shift &amp; Independent and identically distributedï¼Œç¼©å†™ä¸º IID Batch Normalization å¯ä»¥æœ‰æ•ˆé¿å…å¤æ‚å‚æ•°å¯¹ç½‘ç»œè®­ç»ƒäº§ç”Ÿçš„å½±å“ï¼Œä¹Ÿå¯æé«˜æ³›åŒ–èƒ½åŠ›. ç¥ç»ç½‘è·¯çš„è®­ç»ƒè¿‡ç¨‹çš„æœ¬è´¨æ˜¯å­¦ä¹ æ•°æ®åˆ†å¸ƒï¼Œå¦‚æœè®­ç»ƒæ•°æ®ä¸æµ‹è¯•æ•°æ®åˆ†å¸ƒä¸åŒï¼Œå°†å¤§å¤§é™ä½ç½‘ç»œæ³›åŒ–èƒ½åŠ›ï¼Œ BN æ˜¯é’ˆå¯¹æ¯ä¸€æ‰¹æ•°æ®ï¼Œåœ¨ç½‘ç»œçš„æ¯ä¸€å±‚è¾“å…¥ä¹‹å‰å¢åŠ  BNï¼Œ(å‡å€¼0ï¼Œæ ‡å‡†å·®1)ã€‚ Dropout å¯ä»¥æŠ‘åˆ¶è¿‡æ‹Ÿåˆï¼Œä½œç”¨äºæ¯ä»½å°æ‰¹é‡çš„è®­ç»ƒæ•°æ®ï¼Œéšæœºä¸¢å¼ƒéƒ¨åˆ†ç¥ç»å…ƒæœºåˆ¶. bagging åŸç†. MLç®—æ³•ï¼š å…³äºé˜²æ­¢è¿‡æ‹Ÿåˆï¼Œæ•´ç†äº† 8 æ¡è¿­ä»£æ–¹å‘ 4.5 Vanishing/ExplodingVanishing/Exploding gradients æŒ‡çš„æ˜¯éšç€å‰å‘ä¼ æ’­ä¸æ–­åœ°è¿›è¡Œ, æ¿€æ´»å•å…ƒçš„å€¼ä¼šé€å±‚æŒ‡æ•°çº§åœ°å¢åŠ æˆ–å‡å°, ä»è€Œå¯¼è‡´æ¢¯åº¦æ— é™å¢å¤§æˆ–è€…è¶‹è¿‘äºé›¶, è¿™æ ·ä¼šä¸¥é‡å½±å“ç¥ç»ç½‘ç»œçš„è®­ç»ƒ. å¦‚ä¸‹å›¾. å¯ä»¥å‡å°è¿™ç§æƒ…å†µå‘ç”Ÿçš„æ–¹æ³•, å°±æ˜¯ç”¨æœ‰æ•ˆçš„å‚æ•°åˆå§‹åŒ– (è¯¥æ–¹æ³•å¹¶ä¸èƒ½å®Œå…¨è§£å†³è¿™ä¸ªé—®é¢˜). ä½†æ˜¯ä¹Ÿæ˜¯æœ‰æ„ä¹‰çš„ è®¾ç½®åˆç†çš„æƒé‡ï¼Œå¸Œæœ›ä½ è®¾ç½®çš„æƒé‡çŸ©é˜µï¼Œæ—¢ä¸ä¼šå¢é•¿è¿‡å¿«ï¼Œä¹Ÿä¸ä¼šä¸‹é™è¿‡å¿«åˆ° 0. æƒ³æ›´åŠ äº†è§£å¦‚ä½•åˆå§‹åŒ–æƒé‡å¯ä»¥çœ‹ä¸‹è¿™ç¯‡æ–‡ç«  ç¥ç»ç½‘ç»œæƒé‡åˆå§‹åŒ–é—®é¢˜ï¼Œå…¶ä¸­å¾ˆè¯¦ç»†çš„ä»‹ç»äº†æƒé‡åˆå§‹åŒ–é—®é¢˜ã€‚ 5. Optimization &amp; Hyperparamå…³äºä¼˜åŒ–ç®—æ³•ä¸è¶…å‚æ•°è°ƒä¼˜ï¼Œä»¥åŠ BN ç­‰æ›´å¤šï¼Œè¯¦æƒ…å‚é˜…æœ¬åšä¸‹é¢é“¾æ¥ï¼š Improving DNN (week2) - Optimization Algorithm Improving DNN (week3) - Hyperparameterã€Batch Regularization Reference Andrew Ng Notes","categories":[{"name":"deeplearning","slug":"deeplearning","permalink":"http://iequa.com/categories/deeplearning/"}],"tags":[{"name":"MLP","slug":"MLP","permalink":"http://iequa.com/tags/MLP/"}]},{"title":"SVM å’Œ LR çš„åŒºåˆ«ä¸è”ç³»ï¼Ÿ","slug":"ml/SVM-vs-LR","date":"2019-06-10T02:06:16.000Z","updated":"2019-10-20T04:30:35.039Z","comments":true,"path":"2019/06/10/ml/SVM-vs-LR/","link":"","permalink":"http://iequa.com/2019/06/10/ml/SVM-vs-LR/","excerpt":"","text":"å…³äº SVM çš„è¯¦ç»†åŸç†ä¸æ¨å¯¼è¿‡ç¨‹ï¼Œè¯¦è§ï¼š Support Vecor Machine (å…­éƒ¨æ›²) å…¶å®æˆ‘è®¤ä¸º SVM çš„ä½¿ç”¨ç‡å·²ç»æ˜æ˜¾åœ¨ä¸‹é™è¶‹åŠ¿äº†ï¼Œä¸»è¦åŸå› æ˜¯éšç€ç¥ç»ç½‘ç»œçš„å…´èµ·ä¹‹åï¼Œæ‰€ä»¥æˆ‘ä¸å»ºè®®ä¸€å®šè¦èŠ±éå¸¸å¤šçš„ç»å†å»å­¦ä¹  SVM çš„åŸç†å’Œæ¨å¯¼äº†ï¼Œå¯ä»¥ç®€å•äº†è§£ä¸‹ã€‚ ä¸»è¦è¿˜æ˜¯äº†è§£ä¸‹é€‚ç”¨èŒƒå›´å’Œåœºæ™¯ç­‰å°±å¯ä»¥äº†ã€‚ 1. LR vs SVMè¦è¯´æœ‰ä»€ä¹ˆæœ¬è´¨åŒºåˆ«ï¼Œé‚£å°±æ˜¯ loss function ä¸åŒï¼Œä¸¤è€…å¯¹æ•°æ®å’Œå‚æ•°çš„æ•æ„Ÿç¨‹åº¦ä¸åŒ (1). å¯¹éçº¿æ€§è¡¨è¾¾ä¸Šï¼ŒLR åªèƒ½é€šè¿‡äººå·¥çš„ç‰¹å¾ç»„åˆæ¥å®ç°ï¼Œè€Œ SVM å¼•å…¥æ ¸å‡½æ•°æ¥å®ç°éçº¿æ€§è¡¨è¾¾ã€‚ (2). LR äº§å‡ºçš„æ˜¯æ¦‚ç‡å€¼ï¼Œè€Œ SVM åªèƒ½äº§å‡ºæ˜¯æ­£ç±»è¿˜æ˜¯è´Ÿç±»ï¼Œä¸èƒ½äº§å‡ºæ¦‚ç‡ã€‚ (3). Linear SVM ä¾èµ–æ•°æ®è¡¨è¾¾çš„è·ç¦»æµ‹åº¦ï¼Œæ‰€ä»¥éœ€è¦å¯¹æ•°æ®å…ˆåš normalizationï¼›LRä¸å—å…¶å½±å“. (4). SVM ä¸ç›´æ¥ä¾èµ–æ•°æ®åˆ†å¸ƒï¼Œè€ŒLRåˆ™ä¾èµ–, SVM ä¸»è¦å…³æ³¨çš„æ˜¯â€œæ”¯æŒå‘é‡â€ï¼Œä¹Ÿå°±æ˜¯å’Œåˆ†ç±»æœ€ç›¸å…³çš„å°‘æ•°ç‚¹ï¼Œå³å…³æ³¨å±€éƒ¨å…³é”®ä¿¡æ¯ï¼›è€Œ LR æ˜¯åœ¨å…¨å±€è¿›è¡Œä¼˜åŒ–çš„ã€‚è¿™å¯¼è‡´ SVM å¤©ç„¶æ¯” LR æœ‰æ›´å¥½çš„æ³›åŒ–èƒ½åŠ›ï¼Œé˜²æ­¢è¿‡æ‹Ÿåˆã€‚ LRåˆ™å—æ‰€æœ‰æ•°æ®ç‚¹çš„å½±å“ï¼Œå¦‚æœæ•°æ®ä¸åŒç±»åˆ« strongly unbalance ä¸€èˆ¬éœ€è¦å…ˆå¯¹æ•°æ®åš balancingã€‚ (5). æŸå¤±å‡½æ•°çš„ä¼˜åŒ–æ–¹æ³•ä¸åŒï¼ŒLR æ˜¯ä½¿ç”¨ GD æ¥æ±‚è§£ å¯¹æ•°ä¼¼ç„¶å‡½æ•° çš„æœ€ä¼˜è§£ï¼›SVM ä½¿ç”¨ (Sequnential Minimal Optimal) é¡ºåºæœ€å°ä¼˜åŒ–ï¼Œæ¥æ±‚è§£æ¡ä»¶çº¦æŸæŸå¤±å‡½æ•°çš„å¯¹å¶å½¢å¼ã€‚ ä¸€èˆ¬ç”¨çº¿æ€§æ ¸å’Œé«˜æ–¯æ ¸ï¼Œä¹Ÿå°±æ˜¯Linearæ ¸ä¸RBFæ ¸éœ€è¦æ³¨æ„çš„æ˜¯éœ€è¦å¯¹ æ•°æ®å½’ä¸€åŒ–å¤„ç†. ä¸€èˆ¬æƒ…å†µä¸‹RBFæ•ˆæœæ˜¯ä¸ä¼šå·®äºLinearä½†æ˜¯æ—¶é—´ä¸ŠRBFä¼šè€—è´¹æ›´å¤š æ‰©å±•ç‚¹ï¼š æ³¨ï¼šä¸å¸¦æ­£åˆ™åŒ–çš„LRï¼Œå…¶åš normalization çš„ç›®çš„æ˜¯ä¸ºäº†æ–¹ä¾¿é€‰æ‹©ä¼˜åŒ–è¿‡ç¨‹çš„èµ·å§‹å€¼ï¼Œä¸ä»£è¡¨æœ€åçš„è§£çš„ performance ä¼šè·Ÿ normalization ç›¸å…³ï¼Œè€Œå…¶çº¿æ€§çº¦æŸæ˜¯å¯ä»¥è¢«æ”¾ç¼©çš„ï¼ˆç­‰å¼ä¸¤è¾¹å¯åŒæ—¶ä¹˜ä»¥ä¸€ä¸ªç³»æ•°ï¼‰ï¼Œæ‰€ä»¥åš normalization åªæ˜¯ä¸ºäº†æ±‚è§£ä¼˜åŒ–æ¨¡å‹è¿‡ç¨‹ä¸­æ›´å®¹æ˜“é€‰æ‹©åˆå§‹å€¼ 2. Andrew Ng å¦‚æœFeatureçš„æ•°é‡å¾ˆå¤§ï¼Œè·Ÿæ ·æœ¬æ•°é‡å·®ä¸å¤šï¼Œè¿™æ—¶å€™é€‰ç”¨LRæˆ–è€…æ˜¯Linear Kernelçš„SVM å¦‚æœFeatureçš„æ•°é‡æ¯”è¾ƒå°ï¼Œæ ·æœ¬æ•°é‡ä¸€èˆ¬ï¼Œä¸ç®—å¤§ä¹Ÿä¸ç®—å°ï¼Œé€‰ç”¨SVM+Gaussian Kernel å¦‚æœFeatureçš„æ•°é‡æ¯”è¾ƒå°ï¼Œè€Œæ ·æœ¬æ•°é‡å¾ˆå¤šï¼Œéœ€è¦æ‰‹å·¥æ·»åŠ ä¸€äº›featureå˜æˆç¬¬ä¸€ç§æƒ…å†µ å¦‚ä½•é‡åŒ– feature number å’Œ sample numberï¼š n æ˜¯featureçš„æ•°é‡, mæ˜¯æ ·æœ¬æ•° 1). feature number &gt;&gt; sample numberï¼Œåˆ™ä½¿ç”¨LRç®—æ³•æˆ–è€…ä¸å¸¦æ ¸å‡½æ•°çš„SVMï¼ˆçº¿æ€§åˆ†ç±»ï¼‰ &nbsp;&nbsp;&nbsp;&nbsp; feature number = 1Wï¼Œ sample number = 1K 2). fn å°ï¼Œ sample number ä¸€èˆ¬1Wï¼Œä½¿ç”¨å¸¦æœ‰ kernelå‡½æ•° çš„ SVMç®—æ³•. 3). fn å°ï¼Œ sample number å¾ˆå¤§5W+ï¼ˆn=1-1000ï¼Œm=50000+ï¼‰&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; å¢åŠ æ›´å¤šçš„ feature ç„¶åä½¿ç”¨LR ç®—æ³•æˆ–è€… not have kernel çš„ SVM Reference LR ä¸ SVMçš„å¼‚åŒ æ‡’æ­»éª†é©¼ - ç»Ÿè®¡å­¦ä¹ æ–¹æ³•ç¬”è®°(ä¸€) çŸ¥ä¹ : æœ€å°äºŒä¹˜ã€æå¤§ä¼¼ç„¶ã€æ¢¯åº¦ä¸‹é™æœ‰ä½•åŒºåˆ«ï¼Ÿ çŸ¥ä¹ : Linear SVM å’Œ LR æœ‰ä»€ä¹ˆå¼‚åŒï¼Ÿ ç™½å¼€æ°´åŠ ç³– SVMä¸LRçš„æ¯”è¾ƒ æ‡’æ­»éª†é©¼ - å£è¿°æ¨¡å‹æ•´ç† æ”¯æŒå‘é‡æœº(SVM)ç¡¬æ ¸å…¥é—¨-åŸºç¡€ç¯‡ scikit-learn é€»è¾‘å›å½’ç±»åº“ä½¿ç”¨å°ç»“ LR æ­£è´Ÿæ ·æœ¬ä¸å‡è¡¡é—®é¢˜","categories":[{"name":"machine-learning","slug":"machine-learning","permalink":"http://iequa.com/categories/machine-learning/"}],"tags":[{"name":"SVM","slug":"SVM","permalink":"http://iequa.com/tags/SVM/"}]},{"title":"L1ã€L2 Regularization","slug":"ml/ERM-SRM-L1-L2","date":"2019-06-09T02:06:16.000Z","updated":"2019-10-20T04:30:35.040Z","comments":true,"path":"2019/06/09/ml/ERM-SRM-L1-L2/","link":"","permalink":"http://iequa.com/2019/06/09/ml/ERM-SRM-L1-L2/","excerpt":"","text":"Supervised Learning: â€œminimizeyour error while regularizing your parametersâ€ w^*=argmin_w\\sum_iL(y_i,f(x_i;w))+\\lambda\\Omega(w) æˆ‘ä»¬ä¸ä»…è¦ä¿è¯è®­ç»ƒè¯¯å·®æœ€å°ï¼Œæˆ‘ä»¬æ›´å¸Œæœ›æˆ‘ä»¬çš„æ¨¡å‹æµ‹è¯•è¯¯å·®å°. ç¬¬äºŒé¡¹ $\\lambda\\Omega(w)$ï¼Œä¹Ÿå°±æ˜¯å¯¹å‚æ•°$w$çš„è§„åˆ™åŒ–å‡½æ•° $Î©(w)$ å»çº¦æŸæˆ‘ä»¬çš„æ¨¡å‹å°½é‡çš„ç®€å•. ç¬¬ä¸€é¡¹å¯¹åº”æ¨¡å‹çš„è®­ç»ƒæŸå¤±å‡½æ•° (Square Lossã€Hinge lossã€Exp lossã€Log loss) ç¬¬äºŒé¡¹å¯¹åº”æ¨¡å‹çš„æ­£åˆ™åŒ–é¡¹ ï¼ˆæ¨¡å‹å‚æ•°å‘é‡çš„èŒƒæ•°ï¼‰ ç»éªŒé£é™©æœ€å°åŒ– empirical risk minimization, ç»“æ„é£é™©æœ€å°åŒ– structural risk minimization ææ²æ›¾ç»è¯´è¿‡ï¼š modelæ˜¯ç”¨ç¦»æ•£ç‰¹å¾è¿˜æ˜¯è¿ç»­ç‰¹å¾ï¼Œå…¶å®æ˜¯â€œæµ·é‡ç¦»æ•£ç‰¹å¾+ç®€å•æ¨¡å‹â€ åŒ â€œå°‘é‡è¿ç»­ç‰¹å¾+å¤æ‚æ¨¡å‹â€çš„æƒè¡¡ã€‚ æ—¢å¯ä»¥ç¦»æ•£åŒ–ç”¨çº¿æ€§æ¨¡å‹ï¼Œä¹Ÿå¯ä»¥ç”¨è¿ç»­ç‰¹å¾åŠ æ·±åº¦å­¦ä¹ ã€‚å°±çœ‹æ˜¯å–œæ¬¢æŠ˜è…¾ feature è¿˜æ˜¯æŠ˜è…¾ model äº†ã€‚é€šå¸¸æ¥è¯´ï¼Œå‰è€…å®¹æ˜“ï¼Œè€Œä¸”å¯ä»¥nä¸ªäººä¸€èµ·å¹¶è¡Œåšï¼Œæœ‰æˆåŠŸç»éªŒï¼›åè€…ç›®å‰çœ‹å¾ˆèµï¼Œèƒ½èµ°å¤šè¿œè¿˜é¡»æ‹­ç›®ä»¥å¾…ã€‚ ç»“æ„é£é™©æœ€å°åŒ–: è§„åˆ™åŒ–é¡¹æ˜¯ç»“æ„é£é™©æœ€å°åŒ–ç­–ç•¥çš„å®ç°ï¼Œå³åœ¨ç»éªŒé£é™©ä¸ŠåŠ ä¸€ä¸ªæ­£åˆ™åŒ–é¡¹æˆ–æƒ©ç½šé¡¹ æœ€å°åŒ–è¯¯å·®æ˜¯ä¸ºäº†è®©æˆ‘ä»¬çš„æ¨¡å‹æ‹Ÿåˆæˆ‘ä»¬çš„è®­ç»ƒæ•°æ®ï¼Œregularized parametersæ˜¯é˜²æ­¢æˆ‘ä»¬çš„æ¨¡å‹è¿‡åˆ†æ‹Ÿåˆæˆ‘ä»¬çš„è®­ç»ƒæ•°æ®ã€‚ å› ä¸ºå‚æ•°å¤ªå¤šï¼Œä¼šå¯¼è‡´æˆ‘ä»¬çš„æ¨¡å‹å¤æ‚åº¦ä¸Šå‡ï¼Œå®¹æ˜“è¿‡æ‹Ÿåˆï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬çš„è®­ç»ƒè¯¯å·®ä¼šå¾ˆå°ã€‚ä½†è®­ç»ƒè¯¯å·®å°å¹¶ä¸æ˜¯æˆ‘ä»¬çš„æœ€ç»ˆç›®æ ‡ï¼Œæˆ‘ä»¬çš„ç›®æ ‡æ˜¯å¸Œæœ›æ¨¡å‹çš„æµ‹è¯•è¯¯å·®å°ï¼Œä¹Ÿå°±æ˜¯èƒ½å‡†ç¡®çš„é¢„æµ‹æ–°çš„æ ·æœ¬ã€‚ æˆ‘ä»¬éœ€è¦ä¿è¯æ¨¡å‹â€œç®€å•â€çš„åŸºç¡€ä¸Šæœ€å°åŒ–è®­ç»ƒè¯¯å·®ï¼Œè¿™æ ·å¾—åˆ°çš„å‚æ•°æ‰å…·æœ‰å¥½çš„æ³›åŒ–æ€§èƒ½ï¼ˆä¹Ÿå°±æ˜¯æµ‹è¯•è¯¯å·®ä¹Ÿå°ï¼‰. è€Œæ¨¡å‹â€œç®€å•â€å°±æ˜¯é€šè¿‡è§„åˆ™å‡½æ•°æ¥å®ç°çš„ã€‚regularized itemçš„ä½¿ç”¨è¿˜å¯ä»¥çº¦æŸæˆ‘ä»¬çš„æ¨¡å‹çš„ç‰¹æ€§ã€‚è¿™æ ·å°±å¯ä»¥å°†äººå¯¹è¿™ä¸ªæ¨¡å‹çš„å…ˆéªŒçŸ¥è¯†èå…¥åˆ°æ¨¡å‹çš„å­¦ä¹ å½“ä¸­ï¼Œå¼ºè¡Œåœ°è®©å­¦ä¹ åˆ°çš„æ¨¡å‹å…·æœ‰äººæƒ³è¦çš„ç‰¹æ€§ï¼Œä¾‹å¦‚ ç¨€ç–ã€ä½ç§©ã€å¹³æ»‘ ç­‰ç­‰ã€‚ äººçš„å…ˆéªŒæ˜¯éå¸¸é‡è¦çš„ã€‚å‰äººçš„ç»éªŒä¼šè®©ä½ å°‘èµ°å¾ˆå¤šå¼¯è·¯ï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬å¹³æ—¶å­¦ä¹ æœ€å¥½æ‰¾ä¸ªå¤§ç‰›å¸¦å¸¦çš„åŸå› ã€‚ä¸€å¥ç‚¹æ‹¨å¯ä»¥ä¸ºæˆ‘ä»¬æ‹¨å¼€çœ¼å‰ä¹Œäº‘ï¼Œè¿˜æˆ‘ä»¬ä¸€ç‰‡æ™´ç©ºä¸‡é‡Œï¼Œé†é†çŒé¡¶ã€‚å¯¹æœºå™¨å­¦ä¹ ä¹Ÿæ˜¯ä¸€æ ·ï¼Œå¦‚æœè¢«æˆ‘ä»¬äººç¨å¾®ç‚¹æ‹¨ä¸€ä¸‹ï¼Œå®ƒè‚¯å®šèƒ½æ›´å¿«çš„å­¦ä¹ ç›¸åº”çš„ä»»åŠ¡ã€‚åªæ˜¯ç”±äºäººå’Œæœºå™¨çš„äº¤æµç›®å‰è¿˜æ²¡æœ‰é‚£ä¹ˆç›´æ¥çš„æ–¹æ³•ï¼Œç›®å‰åªèƒ½ç”±è§„åˆ™é¡¹æ¥æ‹…å½“äº†. 1. Supervised Learning Objç¬¬ä¸€é¡¹å¯¹åº”æ¨¡å‹çš„è®­ç»ƒæŸå¤±å‡½æ•°: Square Loss â€“&gt; æœ€å°äºŒä¹˜ Hinge Loss â€“&gt; SVM Exp Loss â€“&gt; AdaBoost Log Loss â€“&gt; LR ç¬¬äºŒé¡¹å¯¹åº”æ¨¡å‹çš„æ­£åˆ™åŒ–é¡¹: (ä¸€èˆ¬æ˜¯æ¨¡å‹å¤æ‚åº¦çš„å•è°ƒé€’å¢å‡½æ•°) æ¨¡å‹å‚æ•°å‘é‡çš„èŒƒæ•°ï¼Œä¸åŒçš„é€‰æ‹©å¯¹å‚æ•°çš„çº¦æŸä¸åŒï¼Œå–å¾—çš„æ•ˆæœä¹Ÿä¸åŒ è®ºæ–‡ä¸­å¸¸éƒ½èšé›†åœ¨ï¼šé›¶èŒƒæ•°ã€ä¸€èŒƒæ•°ã€äºŒèŒƒæ•°ã€æ ¸èŒƒæ•°ç­‰ç­‰ã€‚è¿™ä¹ˆå¤šèŒƒæ•°ï¼Œåˆ°åº•å®ƒä»¬è¡¨è¾¾å•¥æ„æ€ï¼Ÿå…·æœ‰å•¥èƒ½åŠ›ï¼Ÿ 2. Normåœ¨æœºå™¨å­¦ä¹ ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸ä½¿ç”¨ç§°ä¸ºèŒƒæ•°(norm)çš„å‡½æ•°æ¥è¡¡é‡å‘é‡å¤§å°. $L^p$ èŒƒæ•°å®šä¹‰å¦‚ä¸‹ï¼š \\|x\\|\\_{p}=\\left(\\sum\\_{i}\\left|x\\_{i}\\right|^{p}\\right)^{\\frac{1}{p}} $L^0$ èŒƒæ•°ï¼š$|x|_{0}$ ä¸º $x$ å‘é‡å„ä¸ªéé›¶å…ƒç´ çš„ä¸ªæ•°ã€‚ $L^1$ èŒƒæ•°ï¼š$|x|_{1}$ ä¸º $x$ å‘é‡å„ä¸ªå…ƒç´ ç»å¯¹å€¼ä¹‹å’Œï¼Œä¹Ÿå«â€œç¨€ç–è§„åˆ™ç®—å­â€ï¼ˆLasso Regularizationï¼‰ã€‚ $L^2$ èŒƒæ•°ï¼š$|x|_{2}$ ä¸º $x$ å‘é‡å„ä¸ªå…ƒç´ å¹³æ–¹å’Œçš„ $1/2$ æ¬¡æ–¹ï¼Œ$L^2$ èŒƒæ•°åˆç§° Euclideanã€ Frobenius èŒƒæ•°ã€‚ 3. L1 RegularizationL1 å¯ä»¥å®ç°ç¨€ç–ï¼Œä¸ºä»€ä¹ˆè¦ç¨€ç–ï¼Ÿ \\|\\boldsymbol{x}\\|\\_{1}=\\sum\\_{i}\\left|x\\_{i}\\right|è®©æˆ‘ä»¬çš„å‚æ•°ç¨€ç–æœ‰ä»€ä¹ˆå¥½å¤„å‘¢ï¼Ÿè¿™é‡Œæ‰¯ä¸¤ç‚¹ï¼š ç‰¹å¾é€‰æ‹©(Feature Selection)ï¼š å¤§å®¶å¯¹ç¨€ç–è§„åˆ™åŒ–è¶‹ä¹‹è‹¥é¹œçš„ä¸€ä¸ªå…³é”®åŸå› åœ¨äºå®ƒèƒ½å®ç°ç‰¹å¾çš„è‡ªåŠ¨é€‰æ‹©ã€‚$x_i$ çš„å¤§éƒ¨åˆ†å…ƒç´ ï¼ˆä¹Ÿå°±æ˜¯ç‰¹å¾ï¼‰éƒ½æ˜¯å’Œæœ€ç»ˆçš„è¾“å‡º $y_i$ æ²¡æœ‰å…³ç³»æˆ–è€…ä¸æä¾›ä»»ä½•ä¿¡æ¯çš„ï¼Œåœ¨æœ€å°åŒ–ç›®æ ‡å‡½æ•°çš„æ—¶å€™è€ƒè™‘$x_i$è¿™äº›é¢å¤–çš„ç‰¹å¾ï¼Œè™½ç„¶å¯ä»¥è·å¾—æ›´å°çš„è®­ç»ƒè¯¯å·®ï¼Œä½†åœ¨é¢„æµ‹æ–°çš„æ ·æœ¬æ—¶ï¼Œè¿™äº›æ²¡ç”¨çš„ä¿¡æ¯åè€Œä¼šè¢«è€ƒè™‘ï¼Œä»è€Œå¹²æ‰°äº†å¯¹æ­£ç¡®$y_i$çš„é¢„æµ‹ã€‚ç¨€ç–è§„åˆ™åŒ–ç®—å­çš„å¼•å…¥å°±æ˜¯ä¸ºäº†å®Œæˆç‰¹å¾è‡ªåŠ¨é€‰æ‹©çš„å…‰è£ä½¿å‘½ï¼Œå®ƒä¼šå­¦ä¹ åœ°å»æ‰è¿™äº›æ²¡æœ‰ä¿¡æ¯çš„ç‰¹å¾ï¼Œä¹Ÿå°±æ˜¯æŠŠè¿™äº›ç‰¹å¾å¯¹åº”çš„æƒé‡ç½®ä¸º0ã€‚ å¯è§£é‡Šæ€§(Interpretability)ï¼š æ¨¡å‹æ›´å®¹æ˜“è§£é‡Šã€‚ä¾‹å¦‚æ‚£æŸç§ç—…çš„æ¦‚ç‡æ˜¯$y$ï¼Œæˆ‘ä»¬æ”¶é›†åˆ°çš„æ•°æ®$x$æ˜¯ 1000 ç»´çš„ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬éœ€è¦å¯»æ‰¾è¿™ 1000ç§ å› ç´ åˆ°åº•æ˜¯æ€ä¹ˆå½±å“æ‚£ä¸Šè¿™ç§ç—…çš„æ¦‚ç‡çš„ã€‚ å‡è®¾æˆ‘ä»¬è¿™ä¸ªæ˜¯ä¸ªå›å½’æ¨¡å‹ï¼š$y=w_1 x_1 + w_2 x_2 + w_{1000} x_{1000} + b$ï¼ˆå½“ç„¶äº†ï¼Œä¸ºäº†è®© $y$ é™å®šåœ¨[0,1]çš„èŒƒå›´ï¼Œä¸€èˆ¬è¿˜å¾—åŠ ä¸ªLogisticå‡½æ•°ï¼‰ã€‚ é€šè¿‡å­¦ä¹ ï¼Œå¦‚æœæœ€åå­¦ä¹ åˆ°çš„ $w*$ å°±åªæœ‰å¾ˆå°‘çš„éé›¶å…ƒç´ ï¼Œä¾‹å¦‚åªæœ‰5ä¸ªéé›¶çš„ $w_i$ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±æœ‰ç†ç”±ç›¸ä¿¡ï¼Œè¿™äº›å¯¹åº”çš„ç‰¹å¾åœ¨æ‚£ç—…åˆ†æä¸Šé¢æä¾›çš„ä¿¡æ¯æ˜¯å·¨å¤§çš„ï¼Œå†³ç­–æ€§çš„ã€‚ æ‚£ä¸æ‚£è¿™ç§ç—…åªå’Œè¿™5ä¸ªå› ç´ æœ‰å…³ï¼Œé‚£åŒ»ç”Ÿå°±å¥½åˆ†æå¤šäº†ã€‚ä½†å¦‚æœ1000ä¸ª $w_i$ éƒ½é0ï¼ŒåŒ»ç”Ÿé¢å¯¹è¿™1000ç§å› ç´ ï¼Œç´¯è§‰ä¸çˆ±. 4. L2 Regularization4.1 L2 èƒ½é˜²æ­¢è¿‡æ‹Ÿåˆï¼Ÿé€šè¿‡ L2èŒƒæ•° çš„è§„åˆ™é¡¹æœ€å°æ¥ä½¿å‚æ•°å€¼éƒ½è¾ƒå°ã€ç”šè‡³è¶‹äº0(ä½†ä¸ä¼šä¸º0)ï¼Œæ¨¡å‹å‚æ•°å€¼è¶Šå°åˆ™å¯¹åº”çš„ç‰¹å¾å¯¹äºæ¨¡å‹çš„å½±å“å°±æ¯”è¾ƒå°ï¼Œè¿™æ ·ç›¸å½“äºå¯¹è¿™éƒ¨åˆ†æ— å…³ç‰¹å¾åšäº†ä¸€ä¸ªæƒ©ç½šï¼Œå³ä½¿ä»–ä»¬çš„å€¼æ³¢åŠ¨æ¯”è¾ƒå¤§ï¼Œå—é™äºå‚æ•°å€¼å¾ˆå°ï¼Œä¹Ÿä¸ä¼šå¯¹æ¨¡å‹çš„è¾“å‡ºç»“æœé€ æˆå¤ªå¤§å½±å“ï¼Œä¹Ÿå°±ä½¿å¾—æ¨¡å‹ä¸ä¼šä¹ å¾—è¿™éƒ¨åˆ†ç‰¹å¾è€Œå‘ç”Ÿè¿‡æ‹Ÿåˆ 4.2 L2 èŒƒæ•°çš„å¥½å¤„ å­¦ä¹ ç†è®ºçš„è§’åº¦ï¼šå¯ä»¥é˜²æ­¢è¿‡æ‹Ÿåˆï¼Œæå‡æ¨¡å‹çš„æ³›åŒ–èƒ½åŠ› ä¼˜åŒ–ã€æ•°å€¼è®¡ç®—çš„è§’åº¦ï¼šL2èŒƒæ•°èƒ½å¤Ÿè®©æˆ‘ä»¬çš„ä¼˜åŒ–æ±‚è§£å˜å¾—ç¨³å®šå’Œå¿«é€Ÿ. Reference æ‡’æ­»éª†é©¼ æœºå™¨å­¦ä¹ ä¸­çš„èŒƒæ•°è§„åˆ™åŒ–ä¹‹ï¼ˆä¸€ï¼‰L0ã€L1ä¸L2èŒƒæ•° æœºå™¨å­¦ä¹ ç®—æ³•ç³»åˆ—ï¼ˆ28ï¼‰ï¼šL1ã€L2æ­£åˆ™åŒ– L1 / L2 æ­£è§„åŒ– ä»€ä¹ˆæ˜¯è¿‡æ‹Ÿåˆ (Overfitting) è¿­ä»£è‡ªå·±: èŒƒæ•°","categories":[{"name":"machine-learning","slug":"machine-learning","permalink":"http://iequa.com/categories/machine-learning/"}],"tags":[{"name":"L1-L2","slug":"L1-L2","permalink":"http://iequa.com/tags/L1-L2/"}]},{"title":"Probabilistic Graphical Model","slug":"ml/Probabilistic_Graphical_Model","date":"2019-06-08T02:06:16.000Z","updated":"2019-10-20T04:30:35.042Z","comments":true,"path":"2019/06/08/ml/Probabilistic_Graphical_Model/","link":"","permalink":"http://iequa.com/2019/06/08/ml/Probabilistic_Graphical_Model/","excerpt":"","text":"å¯¹äºä¸€ä¸ªå®é™…é—®é¢˜ï¼Œç›®æ ‡ï¼š èƒ½å¤ŸæŒ–æ˜éšå«åœ¨æ•°æ®ä¸­çš„çŸ¥è¯†ã€‚ æ€æ ·æ‰èƒ½ä½¿ç”¨æ¦‚ç‡å›¾æ¨¡å‹æŒ–æ˜è¿™äº›éšè—çŸ¥è¯†å‘¢ï¼Ÿ ç”¨è§‚æµ‹ç»“ç‚¹è¡¨ç¤ºè§‚æµ‹åˆ°çš„æ•°æ®ï¼Œç”¨éšå«ç»“ç‚¹è¡¨ç¤ºæ½œåœ¨çš„çŸ¥è¯†ï¼Œç”¨è¾¹æ¥æè¿°çŸ¥è¯†ä¸æ•°æ®çš„ç›¸äº’å…³ç³»ï¼Œè·ä¸€æ¦‚ç‡åˆ†å¸ƒã€‚ 1. Probabilistic Graphical Modelæ¦‚ç‡å›¾ä¸­çš„èŠ‚ç‚¹åˆ†ä¸ºï¼š éšå«èŠ‚ç‚¹ è§‚æµ‹èŠ‚ç‚¹ æ¦‚ç‡å›¾ä¸­çš„è¾¹ åˆ†ä¸ºï¼š æœ‰å‘è¾¹ æ— å‘è¾¹ å¸¸è§çš„æ¦‚ç‡å›¾æ¨¡å‹ ï¼š Native Bayesã€æœ€å¤§ç†µã€éšé©¬å°”ç§‘å¤«æ¨¡å‹ã€CRFã€LDA ç­‰. PGM è”åˆæ¦‚ç‡: æ¦‚ç‡å›¾æ¨¡å‹æœ€ä¸ºâ€œç²¾å½©â€çš„éƒ¨åˆ†å°±æ˜¯èƒ½å¤Ÿç”¨ç®€æ´æ¸…æ™°çš„å›¾ç¤ºå½¢å¼è¡¨è¾¾æ¦‚ç‡ç”Ÿæˆçš„å…³ç³»: åœ¨ç»™å®šAçš„æ¡ä»¶ä¸‹Bå’ŒCæ˜¯æ¡ä»¶ç‹¬ç«‹çš„ï¼ŒåŸºäºæ¡ä»¶æ¦‚ç‡çš„å®šä¹‰å¯å¾—ï¼š \\begin{aligned} P(C | A, B) &=\\frac{P(B, C | A)}{P(B A)}=\\frac{P(B | A) P(C | A)}{P(B | A)} \\\\\\\\ &=P(C | A) \\end{aligned}åŒç†ï¼Œåœ¨ç»™å®šBå’ŒCçš„æ¡ä»¶ä¸‹Aå’ŒDæ˜¯æ¡ä»¶ç‹¬ç«‹çš„ï¼Œå¯å¾—ï¼š \\begin{aligned} P(D | A, B, C) &= \\frac{P(A, D | B, C)}{P(A | B, C)}=\\frac{P(A | B, C) P(D | B, C)}{P(A | B, C)} \\\\\\\\ &= P(D | B, C) \\end{aligned}ç»“åˆä¸Šé¢çš„ä¸¤ä¸ªè¡¨è¾¾å¼å¯å¾—è”åˆæ¦‚ç‡ï¼š \\begin{aligned} P(A,B,C,D)&=P(A)P(B|A)P(C|A,B)P(D|A,B,C) \\\\\\\\ &= P(A)P(B|A)P(C|A)P(D|B,C) \\end{aligned}\\tag{6.3}2. PGM Expressionè§£é‡Šæœ´ç´ è´å¶æ–¯æ¨¡å‹çš„åŸç†ï¼Œå¹¶ç»™å‡ºæ¦‚ç‡å›¾æ¨¡å‹è¡¨ç¤º: é€šè¿‡é¢„æµ‹æŒ‡å®šæ ·æœ¬å±äºç‰¹å®šç±»åˆ«çš„æ¦‚ç‡ y=\\max \\_{y\\_{i}} P\\left(y\\_{i} | x\\right)å¯ä»¥å†™æˆï¼š P\\left(y\\_{i} | x\\right)=\\frac{P\\left(x | y\\_{i}\\right) P\\left(y\\_{i}\\right)}{P(x)}å…¶ä¸­ $x=\\left(x_{1}, x_{2}, \\ldots \\ldots, x_{n}\\right)$, ä¸ºæ ·æœ¬å¯¹åº”çš„ç‰¹å¾å‘é‡ï¼Œ $P(x)$ ä¸ºæ ·æœ¬çš„å…ˆéªŒæ¦‚ç‡ã€‚ 3. Generative vs Discriminative3.1 Generativegenerative approach ç”±æ•°æ®å­¦ä¹ åˆ°è”åˆæ¦‚ç‡åˆ†å¸ƒ $P(X,Y)$ï¼Œç„¶åæ±‚å‡ºæ¡ä»¶æ¦‚ç‡åˆ†å¸ƒ $P(Y\\mid X)$ ä½œä¸ºé¢„æµ‹çš„æ¨¡å‹ï¼š P(Y\\mid X)=\\frac{P(X,Y)}{P(X)} å…¸å‹çš„ç”Ÿæˆå¼æ¨¡å‹åŒ…æ‹¬ï¼š Native Bayesã€HMMã€Bayes Net 3.2 Discriminativediscriminative approach ç”±æ•°æ®ç›´æ¥å­¦åˆ°å†³ç­–å‡½æ•° $f(X)$ æˆ–æ¡ä»¶æ¦‚ç‡åˆ†å¸ƒ $P(Y\\mid X)$ ä½œä¸ºé¢„æµ‹çš„æ¨¡å‹ï¼š f(X), P(Y\\mid X)åˆ¤åˆ«å¼æ¨¡å‹å…³å¿ƒçš„æ˜¯å¯¹äºç»™å®šçš„è¾“å…¥ $X$, åº”è¯¥é¢„æµ‹ä»€ä¹ˆæ ·çš„è¾“å‡º $Y$, åˆ¤åˆ«æ¨¡å‹å°±æ˜¯åˆ¤åˆ«æ•°æ®è¾“å‡ºé‡çš„æ¨¡å‹ã€‚ å…¸å‹çš„åˆ¤åˆ«å¼æ¨¡å‹åŒ…æ‹¬ï¼š LRã€NNã€SVMã€CRFã€CART 3.3 generative vs discriminative vs generative approach discriminative approach å®šä¹‰ ç”±æ•°æ®å­¦ä¹ è”åˆæ¦‚ç‡åˆ†å¸ƒ$P(X,Y)$ ç„¶å,æ±‚å‡ºåœ¨$X$æƒ…å†µä¸‹ï¼Œ$P(Y)$ä½œä¸ºé¢„æµ‹çš„æ¨¡å‹ å†³ç­–å‡½æ•°$f(x)$æˆ–æ¡ä»¶æ¦‚ç‡åˆ†å¸ƒ$P(X)$ä½œä¸ºé¢„æµ‹æ¨¡å‹ ç‰¹ç‚¹ 1. å¯è¿˜åŸå‡º$P(X,Y)$ï¼› 2. å­¦ä¹ æ”¶æ•›é€Ÿåº¦æ›´å¿«ï¼› 3. å­˜åœ¨éšå˜é‡æ—¶ä»å¯ç”¨ 1. ç›´æ¥é¢å¯¹é¢„æµ‹ï¼Œå‡†ç¡®ç‡æ›´é«˜äº›; 2. ä¾¿äºæ•°æ®æŠ½è±¡ï¼Œç‰¹å¾å®šä¹‰ä½¿ç”¨; æ¨¡å‹ native bayesã€hidden markov Logistic Regressionã€SVMã€Gradient Boostingã€CRF.. Note ç»™å®šè¾“å…¥ $X$ äº§ç”Ÿè¾“å‡º $Y$ çš„ç”Ÿæˆå…³ç³» å¯¹ç»™å®šçš„è¾“å…¥ $X$ï¼Œåº”é¢„æµ‹ä»€ä¹ˆæ ·çš„è¾“å‡º $Y$ Reference äº§ç”Ÿå¼æ¨¡å‹ä¸åˆ¤åˆ«å¼æ¨¡å‹ è¿­ä»£è‡ªå·± æ¦‚ç‡å›¾è¡¨ç¤º","categories":[{"name":"machine-learning","slug":"machine-learning","permalink":"http://iequa.com/categories/machine-learning/"}],"tags":[{"name":"entropy","slug":"entropy","permalink":"http://iequa.com/tags/entropy/"}]},{"title":"Information Entropy","slug":"ml/Entropy","date":"2019-06-07T08:06:16.000Z","updated":"2019-10-20T04:30:35.040Z","comments":true,"path":"2019/06/07/ml/Entropy/","link":"","permalink":"http://iequa.com/2019/06/07/ml/Entropy/","excerpt":"","text":"1. Infomation Entropy2014 å¹´ä¸¾è¡Œäº†ä¸–ç•Œæ¯è¶³çƒèµ›ï¼Œå¤§å®¶éƒ½å¾ˆå…³å¿ƒè°ä¼šæ˜¯å† å†›ã€‚å‡å¦‚æˆ‘é”™è¿‡äº†çœ‹ä¸–ç•Œæ¯ï¼Œèµ›åæˆ‘é—®ä¸€ä¸ªçŸ¥é“æ¯”èµ›ç»“æœçš„è§‚ä¼—â€œå“ªåªçƒé˜Ÿæ˜¯å† å†›â€ï¼Ÿä»–ä¸æ„¿æ„ç›´æ¥å‘Šè¯‰æˆ‘ï¼Œè€Œè®©æˆ‘çŒœï¼Œå¹¶ä¸”æˆ‘æ¯çŒœä¸€æ¬¡ï¼Œä»–è¦æ”¶æˆ‘ä¸€å…ƒé’±æ‰è‚¯å‘Šè¯‰æˆ‘æ˜¯å¦çŒœå¯¹äº†ï¼Œé‚£ä¹ˆæˆ‘è¦æå¤šå°‘é’±æ‰èƒ½çŸ¥é“è°æ˜¯å† å†›å‘¢ï¼Ÿæˆ‘å¯ä»¥æŠŠçƒé˜Ÿç¼–ä¸Šå·ï¼Œä» 1 åˆ° 32ï¼Œç„¶åæé—®ï¼šâ€œå† å†›åœ¨ 1~16 å·ä¸­å—ï¼Ÿâ€å‡å¦‚ä»–å‘Šè¯‰æˆ‘çŒœå¯¹äº†ï¼Œæˆ‘ä¼šæ¥ç€æé—®ï¼šâ€œå† å†›åœ¨ 1~8 å·ä¸­å—ï¼Ÿâ€å‡å¦‚ä»–å‘Šè¯‰æˆ‘çŒœé”™äº†ï¼Œæˆ‘è‡ªç„¶çŸ¥é“å† å†›åœ¨ 9~16 å·ä¸­ã€‚è¿™æ ·æˆ‘åªéœ€è¦ 5 æ¬¡ï¼Œå°±èƒ½çŸ¥é“å“ªåªçƒé˜Ÿæ˜¯å† å†›ã€‚æ‰€ä»¥ï¼Œè°æ˜¯ä¸–ç•Œæ¯å† å†›è¿™æ¡æ¶ˆæ¯çš„ä¿¡æ¯é‡åªå€¼ 5 å—é’±ã€‚ H=-(p\\_1\\cdot\\log p\\_1+p\\_2\\cdot\\log p\\_2+\\cdots+p\\_{32}\\cdot\\log p\\_{32}) å…¶ä¸­ $p_1,p_2,\\cdots,p_{32}$ åˆ†åˆ«æ˜¯è¿™ 32 æ”¯çƒé˜Ÿå¤ºå† çš„æ¦‚ç‡ã€‚é¦™å†œæŠŠå®ƒç§°ä¸ºä¿¡æ¯ç†µ(Entropy)ï¼Œä¸€èˆ¬ç”¨ç¬¦å· $H$ è¡¨ç¤ºï¼Œå•ä½æ¯”ç‰¹ã€‚å¾ˆå®¹æ˜“è®¡ç®—å‡ºï¼Œå½“ 32 æ”¯çƒé˜Ÿå¤ºå† æ¦‚ç‡ç›¸åŒæ—¶ï¼Œå¯¹åº”çš„ä¿¡æ¯ç†µç­‰äº 5 æ¯”ç‰¹ã€‚ 1.1 ä¿¡æ¯ç†µçš„å®šä¹‰å¯¹äºä»»æ„ä¸€ä¸ªç¦»æ•£å‹éšæœºå˜é‡ $X$ï¼Œå®ƒçš„ç†µ $H(X)$ å®šä¹‰ä¸º: H(X)=-\\sum\\_{x\\in X}p(x)\\log p(x)å…¶ä¸­ï¼Œçº¦å®š $0\\log0=0$ã€‚$H(X)$ å¯ä»¥å†™ä¸º $H(p)$ã€‚ å˜é‡çš„ä¸ç¡®å®šæ€§è¶Šå¤§ï¼Œç†µä¹Ÿå°±è¶Šå¤§ï¼Œè¦æŠŠå®ƒææ¸…æ¥šï¼Œæ‰€éœ€ä¿¡æ¯é‡ä¹Ÿå°±è¶Šå¤§ã€‚ ä¿¡æ¯ç†µçš„ç‰©ç†å«ä¹‰æ˜¯å¯¹ä¸€ä¸ªä¿¡æ¯ç³»ç»Ÿä¸ç¡®å®šæ€§çš„åº¦é‡ï¼Œå’Œçƒ­åŠ›å­¦ä¸­ç†µæœ‰ç›¸ä¼¼ä¹‹å¤„ï¼Œåè€…å°±æ˜¯ä¸€ä¸ªç³»ç»Ÿæ— åºçš„åº¦é‡ã€‚ ä»å¦ä¸€è§’åº¦è®²ä¹Ÿæ˜¯å¯¹ä¸€ç§ ä¸ç¡®å®šæ€§çš„åº¦é‡ã€‚ 1.2 ä¿¡æ¯ç†µçš„ä¾‹å­è®¾ä¸€æ¬¡éšæœºäº‹ä»¶ï¼ˆç”¨éšæœºå˜é‡$X$è¡¨ç¤ºï¼‰å®ƒå¯èƒ½ä¼šæœ‰ $x_1ï¼Œx_2ï¼Œâ‹¯ï¼Œx_m$ å…± m ä¸ªä¸åŒçš„ç»“æœï¼Œæ¯ä¸ªç»“æœå‡ºç°çš„æ¦‚ç‡åˆ†åˆ«ä¸º $p_1ï¼Œp_2ï¼Œâ‹¯ï¼Œp_m$ï¼Œé‚£ä¹ˆ $X$ çš„ä¸ç¡®å®šåº¦ï¼Œå³ä¿¡æ¯Entropyä¸ºï¼š H(X) =\\sum\\_{i=1}^{m} p\\_i \\cdot \\log\\_{2} \\frac{1}{p\\_i} = - \\sum\\_{i=1}^{m} p\\_i \\cdot \\log\\_{2} p\\_iå°†ä¸€ä¸ªç«‹æ–¹ä½“AæŠ›å‘ç©ºä¸­ï¼Œè®°è½åœ°æ—¶ç€åœ°çš„é¢ä¸º $c$, $c$ çš„å–å€¼ä¸º{1,2,3,4,5,6} info(c) = - (1/6 \\cdot log\\_{2}(1/6)+...+1/6 \\cdot log\\_{2}(1/6)) = -1 \\cdot log(1/6) = 2.58ï¼› å››é¢ä½“æŠ›å…¥ç©ºä¸­ : info(c) = - (1/4 \\cdot log\\_{2}(1/4)+...+1/4 \\cdot log\\_{2}(1/4)) = -1 \\cdot log(1/4) = 2ï¼› çƒä½“æŠ›å…¥ç©ºä¸­ : info(c) = -1 \\cdot log(1) = 0ï¼›æ­¤æ—¶è¡¨ç¤ºä¸ç¡®å®šç¨‹åº¦ä¸º0ï¼Œä¹Ÿå°±æ˜¯ç€åœ°æ—¶å‘ä¸‹çš„é¢æ˜¯ç¡®å®šçš„ã€‚ 1.3 æœ€å¤§ç†µâ€œæœ€å¤§ç†µâ€è¿™ä¸ªåè¯å¬èµ·æ¥å¾ˆæ·±å¥¥ï¼Œä½†æ˜¯å®ƒçš„åŸç†å¾ˆç®€å•ï¼Œæˆ‘ä»¬æ¯å¤©éƒ½åœ¨ç”¨ã€‚è¯´ç™½äº†ï¼Œå°±æ˜¯è¦ä¿ç•™å…¨éƒ¨çš„ä¸ç¡®å®šæ€§ï¼Œå°†é£é™©é™åˆ°æœ€å°ã€‚ \\hat{p}=\\arg\\max\\_{p\\in C}H(p)æœ€å¤§ç†µåŸç†æŒ‡å‡ºï¼Œå¯¹ä¸€ä¸ªéšæœºäº‹ä»¶çš„æ¦‚ç‡åˆ†å¸ƒè¿›è¡Œé¢„æµ‹æ—¶ï¼Œæˆ‘ä»¬çš„é¢„æµ‹åº”å½“æ»¡è¶³å…¨éƒ¨å·²çŸ¥çš„æ¡ä»¶ï¼Œè€Œå¯¹æœªçŸ¥çš„æƒ…å†µä¸è¦åšä»»ä½•ä¸»è§‚å‡è®¾ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ¦‚ç‡åˆ†å¸ƒæœ€å‡åŒ€ï¼Œé¢„æµ‹çš„é£é™©æœ€å°ã€‚å› ä¸ºè¿™æ—¶æ¦‚ç‡åˆ†å¸ƒçš„ä¿¡æ¯ç†µæœ€å¤§ï¼Œæ‰€ä»¥äººä»¬æŠŠè¿™ç§æ¨¡å‹ç§°ä½œâ€œæœ€å¤§ç†µæ¨¡å‹â€ã€‚æˆ‘ä»¬å¸¸è¯´çš„ï¼Œä¸è¦æŠŠæ‰€æœ‰çš„é¸¡è›‹æ”¾åœ¨ä¸€ä¸ªç¯®å­é‡Œï¼Œå…¶å®å°±æ˜¯æœ€å¤§ç†µåŸç†çš„ä¸€ä¸ªæœ´ç´ çš„è¯´æ³•ï¼Œå› ä¸ºå½“æˆ‘ä»¬é‡åˆ°ä¸ç¡®å®šæ—¶ï¼Œå°±è¦ä¿ç•™å„ç§å¯èƒ½æ€§ã€‚ 2. Conditional Entropyè‡ªå¤ä»¥æ¥ï¼Œä¿¡æ¯å’Œæ¶ˆé™¤ä¸ç¡®å®šæ€§æ˜¯ç›¸è”ç³»çš„ã€‚åœ¨è‹±è¯­é‡Œï¼Œä¿¡æ¯å’Œæƒ…æŠ¥æ˜¯åŒä¸€ä¸ªè¯ï¼ˆInfomationï¼‰ï¼Œè€Œæˆ‘ä»¬çŸ¥é“æƒ…æŠ¥çš„ä½œç”¨å°±æ˜¯æ’é™¤ä¸ç¡®å®šæ€§ã€‚ (äºŒæˆ˜æ—¶æœŸï¼Œæ–¯å¤§æ—æ— å…µå¯æ´¾åˆ°æ¬§æ´²æˆ˜åœºï¼Œä½†åœ¨è¿œä¸œæœ‰60ä¸‡å¤§å†›ï¼Œæƒ…æŠ¥å¾—çŸ¥ Japan ä¸ä¼šåŒ—ä¸Š) ä¸€ä¸ªäº‹ç‰©å†…éƒ¨ä¼šå­˜æœ‰éšæœºæ€§ï¼Œä¹Ÿå°±æ˜¯ä¸ç¡®å®šæ€§ï¼Œå‡å®šä¸º $U$, è€Œä»å¤–éƒ¨æ¶ˆé™¤è¿™ä¸ªä¸ç¡®å®šæ€§çš„å”¯ä¸€çš„æ–¹æ³•æ˜¯å¼•å…¥ä¿¡æ¯ $I$ï¼Œ è€Œå¼•å…¥çš„ä¿¡æ¯é‡å–å†³äºè¿™ä¸ªä¸ç¡®å®šæ€§çš„å¤§å°, å½“ $I &lt; U$ æ—¶ï¼Œè¿™äº›ä¿¡æ¯å¯ä»¥æ¶ˆé™¤ä¸€éƒ¨åˆ†ä¸ç¡®å®šæ€§. æ–°çš„ä¸ç¡®å®šæ€§ï¼š U'=U-I å‡ ä¹æ‰€æœ‰çš„è‡ªç„¶è¯­è¨€å¤„ç†ã€ä¿¡æ¯ä¸ä¿¡å·å¤„ç†çš„åº”ç”¨éƒ½æ˜¯ä¸€ä¸ªæ¶ˆé™¤ä¸ç¡®å®šæ€§çš„è¿‡ç¨‹ã€‚ è‡ªç„¶è¯­è¨€çš„ç»Ÿè®¡æ¨¡å‹ï¼Œå…¶ä¸­çš„ä¸€å…ƒæ¨¡å‹å°±æ˜¯é€šè¿‡æŸä¸ªè¯æœ¬èº«çš„æ¦‚ç‡åˆ†å¸ƒï¼Œæ¥æ¶ˆé™¤ä¸ç¡®å®šæ€§ï¼›äºŒå…ƒåŠæ›´é«˜é˜¶çš„è¯­è¨€æ¨¡å‹åˆ™è¿˜ä½¿ç”¨äº†ä¸Šä¸‹æ–‡çš„ä¿¡æ¯ï¼Œé‚£å°±èƒ½å‡†ç¡®é¢„æµ‹ä¸€ä¸ªå¥å­ä¸­å½“å‰çš„è¯æ±‡äº†ã€‚åœ¨æ•°å­¦ä¸Šå¯ä»¥ä¸¥æ ¼åœ°è¯æ˜ä¸ºä»€ä¹ˆè¿™äº›â€œç›¸å…³çš„â€ä¿¡æ¯ä¹Ÿèƒ½å¤Ÿæ¶ˆé™¤ä¸ç¡®å®šæ€§ã€‚ä¸ºæ­¤ï¼Œéœ€è¦å¼•å…¥æ¡ä»¶ç†µ(Conditional Entropy)çš„æ¦‚å¿µã€‚ 2.1 æ¡ä»¶ç†µçš„å®šä¹‰å‡å®š $X$ å’Œ $Y$ æ˜¯ä¸¤ä¸ªéšæœºå˜é‡ï¼Œ$X$ æ˜¯æˆ‘ä»¬éœ€è¦äº†è§£çš„ã€‚å‡å®šæˆ‘ä»¬ç°åœ¨çŸ¥é“äº† $X$ çš„éšæœºåˆ†å¸ƒ$P(X)$ï¼Œé‚£ä¹ˆä¹Ÿå°±çŸ¥é“äº† $X$ çš„ç†µï¼š H(X)=-\\sum\\_{x\\in X}P(x)\\cdot\\log P(x)é‚£ä¹ˆå®ƒçš„ä¸ç¡®å®šæ€§å°±æ˜¯è¿™ä¹ˆå¤§ã€‚ç°åœ¨å‡å®šæˆ‘ä»¬è¿˜çŸ¥é“ $Y$ çš„ä¸€äº›æƒ…å†µï¼ŒåŒ…æ‹¬å®ƒå’Œ $X$ ä¸€èµ·å‡ºç°çš„æ¦‚ç‡ï¼Œåœ¨æ•°å­¦ä¸Šç§°ä¸ºè”åˆæ¦‚ç‡åˆ†å¸ƒ(Joint Probability)ï¼Œä»¥åŠåœ¨ $Y$ å–ä¸åŒå€¼çš„å‰æä¸‹ $X$ çš„æ¦‚ç‡åˆ†å¸ƒï¼Œåœ¨æ•°å­¦ä¸Šç§°ä¸ºæ¡ä»¶æ¦‚ç‡åˆ†å¸ƒ(Conditional Probability)ã€‚å®šä¹‰åœ¨ $Y$ æ¡ä»¶ä¸‹ $X$ çš„æ¡ä»¶ç†µä¸ºï¼š \\begin{align}H(X \\mid Y) &= \\sum\\_{y\\in Y}P(y)H(X \\mid Y=y) \\\\\\&=\\sum\\_{y\\in Y}P(y)\\big[-\\sum\\_{x\\in X}P(x\\mid y)\\log P(x\\mid y)\\big]\\\\\\&=-\\sum\\_{x\\in X,y \\in Y}P(x,y)\\log P(x\\mid y)\\end{align}å¯ä»¥è¯æ˜ $H(X)\\ge H(X\\mid Y)$ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå¤šäº† $Y$ çš„ä¿¡æ¯ä¹‹åï¼Œå…³äº $X$ çš„ä¸ç¡®å®šæ€§ä¸‹é™äº†ï¼åœ¨ç»Ÿè®¡è¯­è¨€æ¨¡å‹ä¸­ï¼Œå¦‚æœæŠŠ $Y$ çœ‹æˆæ˜¯å‰ä¸€ä¸ªå­—ï¼Œé‚£ä¹ˆåœ¨æ•°å­¦ä¸Šå°±è¯æ˜äº†äºŒå…ƒæ¨¡å‹çš„ä¸ç¡®å®šæ€§å°äºä¸€å…ƒæ¨¡å‹ã€‚åŒç†ï¼Œå¯ä»¥å®šä¹‰æœ‰ä¸¤ä¸ªæ¡ä»¶çš„æ¡ä»¶ç†µï¼š H(X\\mid Y,Z)=-\\sum\\_{x\\in X,y\\in Y,z\\in Z}P(x,y,z)\\log P(x\\mid y,z)è¿˜å¯ä»¥è¯æ˜ $H(X\\mid Y)\\ge H(X\\mid Y,Z)$ã€‚ä¹Ÿå°±è¯´ï¼Œä¸‰å…ƒæ¨¡å‹åº”è¯¥æ¯”äºŒå…ƒçš„å¥½ã€‚ 2.2 ä¸€ä¸ªæœ‰æ„æ€çš„é—®é¢˜æ€è€ƒä¸€ä¸‹ï¼Œä¸Šè¿°å¼å­ä¸­çš„ç­‰å·ä»€ä¹ˆæ—¶å€™æˆç«‹ï¼Ÿç­‰å·æˆç«‹è¯´æ˜å¢åŠ äº†ä¿¡æ¯ï¼Œä¸ç¡®å®šæ€§å´æ²¡æœ‰é™ä½ï¼Œè¿™å¯èƒ½å—ï¼Ÿ ç­”æ¡ˆæ˜¯è‚¯å®šçš„ï¼Œå¦‚æœæˆ‘ä»¬è·å–çš„ä¿¡æ¯ä¸è¦ç ”ç©¶çš„äº‹ç‰©æ¯«æ— å…³ç³»ï¼Œç­‰å·å°±æˆç«‹ã€‚é‚£ä¹ˆå¦‚ä½•åˆ¤æ–­äº‹ç‰©ä¹‹é—´æ˜¯å¦å­˜åœ¨å…³ç³»ï¼Œæˆ–è€…è¯´æˆ‘ä»¬åº”è¯¥å¦‚ä½•å»åº¦é‡ä¸¤ä¸ªäº‹ç‰©ä¹‹é—´çš„å…³è”æ€§å‘¢ï¼Ÿè¿™è‡ªç„¶è€Œç„¶å°±å¼•å‡ºäº†äº’ä¿¡æ¯(Mutual Infomation)çš„æ¦‚å¿µã€‚ 3. Mutual Infomationè·å–çš„ä¿¡æ¯å’Œè¦ç ”ç©¶çš„äº‹ç‰©â€œæœ‰å…³ç³»â€æ—¶ï¼Œè¿™äº›ä¿¡æ¯æ‰èƒ½å¸®åŠ©æˆ‘ä»¬æ¶ˆé™¤ä¸ç¡®å®šæ€§ã€‚å½“ç„¶â€œæœ‰å…³ç³»â€è¿™ç§è¯´æ³•å¤ªæ¨¡ç³Šï¼Œå¤ªä¸ç§‘å­¦ï¼Œæœ€å¥½èƒ½å¤Ÿé‡åŒ–åœ°åº¦é‡â€œç›¸å…³æ€§â€ã€‚ä¸ºæ­¤ï¼Œé¦™å†œåœ¨ä¿¡æ¯è®ºä¸­æå‡ºäº†ä¸€ä¸ªäº’ä¿¡æ¯(Mutual Infomation)çš„æ¦‚å¿µä½œä¸ºä¸¤ä¸ªéšæœºäº‹ä»¶â€œç›¸å…³æ€§â€çš„é‡åŒ–åº¦é‡ã€‚ å‡å®šæœ‰ä¸¤ä¸ªéšæœºäº‹ä»¶ $X$ å’Œ $Y$ï¼Œå®ƒä»¬ä¹‹é—´çš„äº’ä¿¡æ¯å®šä¹‰å¦‚ä¸‹ï¼š I(X;Y)=\\sum_{x\\in X,y\\in Y}P(x,y)\\log\\frac{P(x,y)}{P(x)P(y)}å¯ä»¥è¯æ˜ï¼Œäº’ä¿¡æ¯ $I(X;Y)$ å°±æ˜¯éšæœºäº‹ä»¶ $X$ çš„ä¸ç¡®å®šæ€§ï¼ˆç†µ $H(X)$ ä¸åœ¨çŸ¥é“éšæœºäº‹ä»¶ $Y$ æ¡ä»¶ä¸‹ $X$ çš„ä¸ç¡®å®šæ€§ï¼ˆæ¡ä»¶ç†µ $H(Xâˆ£Y)$ï¼‰ä¹‹é—´çš„å·®å¼‚ï¼Œå³ï¼š I(X;Y)=H(X)-H(X\\mid Y)æ‰€è°“ä¸¤ä¸ªäº‹ä»¶ç›¸å…³æ€§çš„é‡åŒ–åº¦é‡ï¼Œå°±æ˜¯åœ¨äº†è§£äº†å…¶ä¸­ä¸€ä¸ª $Y$ çš„å‰æä¸‹ï¼Œå¯¹æ¶ˆé™¤å¦ä¸€ä¸ª $X$ ä¸ç¡®å®šæ€§æ‰€æä¾›çš„ä¿¡æ¯é‡ã€‚äº’ä¿¡æ¯æ˜¯ä¸€ä¸ªå–å€¼åœ¨ 0 åˆ° $min(H(X),H(Y))$ ä¹‹é—´çš„å‡½æ•°ï¼Œå½“ $X$ å’Œ $Y$ å®Œå…¨ç›¸å…³æ—¶ï¼Œå®ƒçš„å–å€¼æ˜¯ 1ï¼›å½“äºŒè€…å®Œå…¨æ— å…³æ—¶ï¼Œå®ƒçš„å–å€¼æ˜¯ 0ã€‚ 4. Relative Entropyç›¸å¯¹ç†µä¹Ÿç”¨æ¥è¡¡é‡ç›¸å…³æ€§ï¼Œä½†å’Œå˜é‡çš„äº’ä¿¡æ¯ä¸åŒï¼Œå®ƒç”¨æ¥è¡¡é‡ä¸¤ä¸ªå–å€¼ä¸ºæ­£æ•°çš„å‡½æ•°çš„ç›¸ä¼¼æ€§ã€‚å®ƒçš„å®šä¹‰å¦‚ä¸‹ï¼š KL(f(x) || g(x))=\\sum\\_{x\\in X}f(x)\\cdot\\log \\frac{f(x)}{g(x)}å¤§å®¶ä¸å¿…å…³å¿ƒå…¬å¼æœ¬èº«ï¼Œåªéœ€è®°ä½ä¸‹é¢ä¸‰æ¡ç»“è®ºå°±å¥½ï¼š (1). å¯¹äºä¸¤ä¸ªå®Œå…¨ç›¸åŒçš„å‡½æ•°ï¼Œå®ƒä»¬çš„ç›¸å¯¹ç†µç­‰äºé›¶ã€‚ (2). ç›¸å¯¹ç†µè¶Šå¤§ï¼Œä¸¤ä¸ªå‡½æ•°å·®å¼‚è¶Šå¤§ï¼›åä¹‹ï¼Œç›¸å¯¹ç†µè¶Šå°ï¼Œä¸¤ä¸ªå‡½æ•°å·®å¼‚è¶Šå°ã€‚ (3). å¯¹äºæ¦‚ç‡åˆ†å¸ƒæˆ–è€…æ¦‚ç‡å¯†åº¦å‡½æ•°ï¼Œå¦‚æœå–å€¼å‡å¤§äºé›¶ï¼Œç›¸å¯¹ç†µå¯ä»¥åº¦é‡ä¸¤ä¸ªéšæœºåˆ†å¸ƒçš„å·®å¼‚æ€§ã€‚ ç¬¬ (3) æ¡ï¼š å¯ä»¥å¯¹æ ‡ï¼ŒCrossEntropy çš„æ„ä¹‰. æ³¨æ„ï¼Œç›¸å¯¹ç†µæ˜¯ä¸å¯¹ç§°çš„ï¼Œå³ï¼š KL(f(x)||g(x))\\ne KL(g(x)||f(x))ä¸ºäº†è®©å®ƒå¯¹ç§°ï¼Œè©¹æ£®å’Œé¦™å†œæå‡ºä¸€ç§æ–°çš„ç›¸å¯¹ç†µçš„è®¡ç®—æ–¹æ³• JS(f(x)||g(x))=\\frac{1}{2}\\big[KL(f(x)||g(x))+KL(g(x)||f(x))\\big] ç›¸å¯¹ç†µæœ€æ—©ç”¨åœ¨ä¿¡å·å¤„ç†ä¸Šã€‚å¦‚ä¸¤ä¸ªéšæœºä¿¡å·ï¼Œå®ƒä»¬ç›¸å¯¹ç†µè¶Šå°ï¼Œè¯´æ˜è¿™ä¸¤ä¸ªä¿¡å·è¶Šæ¥è¿‘ï¼Œå¦åˆ™ä¿¡å·çš„å·®å¼‚è¶Šå¤§ã€‚ Reference å´å†›ã€Šæ•°å­¦ä¹‹ç¾ã€‹ å®—æˆåº†ã€Šç»Ÿè®¡è‡ªç„¶è¯­è¨€å¤„ç†ã€‹ ä¿¡æ¯çš„åº¦é‡å’Œä½œç”¨","categories":[{"name":"machine-learning","slug":"machine-learning","permalink":"http://iequa.com/categories/machine-learning/"}],"tags":[{"name":"entropy","slug":"entropy","permalink":"http://iequa.com/tags/entropy/"}]},{"title":"Evaluation Metric","slug":"ml/Evaluation_Metric","date":"2019-06-03T02:01:21.000Z","updated":"2019-10-20T04:30:35.035Z","comments":true,"path":"2019/06/03/ml/Evaluation_Metric/","link":"","permalink":"http://iequa.com/2019/06/03/ml/Evaluation_Metric/","excerpt":"","text":"é€‰æ‹©ä¸é—®é¢˜ç›¸åŒ¹é…çš„è¯„ä¼°æ–¹æ³•ï¼Œæ‰èƒ½å¿«é€Ÿå‘ç°åœ¨ æ¨¡å‹é€‰æ‹©å’Œè®­ç»ƒè¿‡ç¨‹ ä¸­å¯èƒ½å‡ºç°çš„é—®é¢˜ï¼Œè¿­ä»£åœ°å¯¹æ¨¡å‹è¿›è¡Œä¼˜åŒ–. é’ˆå¯¹ åˆ†ç±»ã€æ’åºã€å›å½’ã€åºåˆ—é¢„æµ‹ ç­‰ä¸åŒç±»å‹çš„æœºå™¨å­¦ä¹ é—®é¢˜ï¼Œè¯„ä¼°æŒ‡æ ‡çš„é€‰æ‹©ä¹Ÿæœ‰æ‰€ä¸åŒ: æœ¬æ–‡å°†è°ˆè°ˆæœºå™¨å­¦ä¹ ä¸­ï¼Œå¸¸ç”¨çš„æ€§èƒ½è¯„ä¼°æŒ‡æ ‡ï¼š å…³äºæ¨¡å‹è¯„ä¼°çš„åŸºç¡€æ¦‚å¿µ: ã€è¯¯å·®(error)ã€‘ï¼šå­¦ä¹ å™¨çš„é¢„æµ‹è¾“å‡ºä¸æ ·æœ¬çš„çœŸå®è¾“å‡ºä¹‹é—´çš„å·®å¼‚ã€‚æ ¹æ®äº§ç”Ÿè¯¯å·®çš„æ•°æ®é›†ï¼Œå¯åˆ†ä¸ºï¼š Training errorï¼šåˆç§°ä¸ºç»éªŒè¯¯å·®(empirical error)ï¼Œå­¦ä¹ å™¨åœ¨è®­ç»ƒé›†ä¸Šçš„è¯¯å·®ã€‚ Test errorï¼šå­¦ä¹ å™¨åœ¨æµ‹è¯•é›†ä¸Šçš„è¯¯å·®ã€‚ Generalization errorï¼šå­¦ä¹ å™¨åœ¨æœªçŸ¥æ–°æ ·æœ¬ä¸Šçš„è¯¯å·®ã€‚ éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä¸Šè¿°æ‰€è¯´çš„â€œè¯¯å·®â€å‡æŒ‡è¯¯å·®æœŸæœ›ï¼Œæ’é™¤æ•°æ®é›†å¤§å°çš„å½±å“ã€‚ åº”è¯¥ä»è®­ç»ƒæ ·æœ¬ä¸­å°½å¯èƒ½å­¦å‡ºé€‚ç”¨äºæ‰€æœ‰ æ½œåœ¨æ ·æœ¬çš„â€œæ™®éè§„å¾‹â€ï¼Œè¿™æ ·æ‰èƒ½åœ¨é‡åˆ°æ–°æ ·æœ¬æ—¶åšå‡ºæ­£ç¡®çš„åˆ¤åˆ«ã€‚å› ä¸ºï¼Œæ³›åŒ–è¯¯å·®æ— æ³•æµ‹é‡ï¼Œå› æ­¤ï¼Œé€šå¸¸æˆ‘ä»¬ä¼šå°† Test error è¿‘ä¼¼ç­‰åŒäº Generalization errorã€‚ 1. Classification Metric1.1 Accuracyå‡†ç¡®ç‡ï¼šæŒ‡çš„æ˜¯åˆ†ç±»æ­£ç¡®çš„æ ·æœ¬æ•°é‡å æ ·æœ¬æ€»æ•°çš„æ¯”ä¾‹ï¼Œå®šä¹‰å¦‚ä¸‹ï¼š Accuracy = \\frac{n\\_{correct}}{n\\_{total}}, Error = \\frac{n\\_{error}}{n\\_{total}}æ­£åæ¯”ä¾‹ä¸¥é‡å¤±è¡¡ï¼Œåˆ™æ²¡æ„ä¹‰ï¼Œå­˜åœ¨ accuracy paradox ç°è±¡. accuracy å‡†ç¡®ç‡ = (TP+TN)/(TP+TN+FP+FN), å‡†ç¡®ç‡å¯ä»¥åˆ¤æ–­æ€»çš„æ­£ç¡®ç‡ 1.2 Precisionprecision æŸ¥å‡†ç‡ (80% = ä½ ä¸€å…±é¢„æµ‹äº†100ä¸ªæ­£ä¾‹ï¼Œ80ä¸ªæ˜¯å¯¹çš„æ­£ä¾‹) Precision = TP/(TP+FP) 1.3 Recallrecall (æ ·æœ¬ä¸­çš„æ­£ä¾‹æœ‰å¤šå°‘è¢«é¢„æµ‹æ­£ç¡® TPR = TP/(TP+FN)) 1.4 F1-score multi-class classification å¦‚æœéè¦ç”¨ä¸€ä¸ªç»¼åˆè€ƒé‡çš„ metric çš„è¯ï¼Œ macro-averageï¼ˆå®å¹³å‡ï¼‰- åˆ†å¸ƒè®¡ç®—æ¯ä¸ªç±»åˆ«çš„F1ï¼Œç„¶ååšå¹³å‡ï¼ˆå„ç±»åˆ«F1çš„æƒé‡ç›¸åŒï¼‰ micro-averageï¼ˆå¾®å¹³å‡ï¼‰- é€šè¿‡å…ˆè®¡ç®—æ€»ä½“çš„TPï¼ŒFNå’ŒFPçš„æ•°é‡ï¼Œå†è®¡ç®—F1 macro-averageï¼ˆå®å¹³å‡ï¼‰ ä¼šæ¯” micro-averageï¼ˆå¾®å¹³å‡ï¼‰å¥½ä¸€äº›å“¦ï¼Œå› ä¸º macro ä¼šå— minority class å½±å“æ›´å¤§ï¼Œä¹Ÿå°±æ˜¯è¯´æ›´èƒ½ä½“ç°åœ¨ small class ä¸Šçš„ performance. sklearnä¸­ F1-micro ä¸ F1-macro åŒºåˆ«å’Œè®¡ç®—åŸç† precision &amp; recall precision æ˜¯ç›¸å¯¹ä½ è‡ªå·±çš„æ¨¡å‹é¢„æµ‹è€Œè¨€recall æ˜¯ç›¸å¯¹çœŸå®çš„ç­”æ¡ˆè€Œè¨€ 1.5 P-R curveP-Ræ›²çº¿çš„æ¨ªè½´æ˜¯å¬å›ç‡ï¼Œçºµè½´æ˜¯ç²¾ç¡®ç‡ã€‚å¯¹äºä¸€ä¸ªæ’åºæ¨¡å‹æ¥è¯´ï¼Œå…¶P-Ræ›²çº¿ä¸Šçš„ä¸€ä¸ªç‚¹ä»£è¡¨ç€ï¼Œåœ¨æŸä¸€é˜ˆå€¼ä¸‹ï¼Œæ¨¡å‹å°†å¤§äºè¯¥é˜ˆå€¼çš„ç»“æœåˆ¤å®šä¸ºæ­£æ ·æœ¬ï¼Œ å°äºè¯¥é˜ˆå€¼çš„ç»“æœåˆ¤å®šä¸ºè´Ÿæ ·æœ¬ï¼Œæ­¤æ—¶è¿”å›ç»“æœå¯¹åº”çš„å¬å›ç‡å’Œç²¾ç¡®ç‡ã€‚ æ•´æ¡ P-R æ›²çº¿æ˜¯é€šè¿‡å°†é˜ˆå€¼ä»é«˜åˆ°ä½ç§»åŠ¨è€Œç”Ÿæˆçš„ã€‚ å®çº¿ï¼šA modelï¼Œ è™šçº¿ï¼šB model ä¸Šé¢è¯´çš„é˜ˆå€¼ä»é«˜åˆ°ä½åŸå› ï¼šé˜ˆå€¼é«˜ï¼Œç²¾ç¡®ç‡é«˜ï¼Œé˜ˆå€¼ä½ï¼Œå¬å›ç‡é«˜ 1.6 ROCQ1: ä»€ä¹ˆæ˜¯ROCæ›²çº¿ï¼Ÿ ROC curve ï¼ˆTPR çºµè½´ï¼ŒFPR æ¨ªè½´ï¼ŒTPï¼ˆçœŸæ­£ç‡ï¼‰å’Œ FPï¼ˆå‡æ­£ç‡ï¼‰ï¼Œè®¾ä¸€ä¸ªé˜ˆå€¼ï¼‰ ROCï¼ˆReceiver Operating Characteristic Curveï¼‰æ›²çº¿ã€‚ ROC æ›²çº¿ æ˜¯åŸºäºæ··æ·†çŸ©é˜µå¾—å‡ºçš„ã€‚ TPR = recall = çµæ•åº¦ = Pï¼ˆX=1 | Y=1ï¼‰ï¼Œ FPR = ç‰¹å¼‚åº¦ = Pï¼ˆX=0 | Y=0ï¼‰ æ³¨æ„ï¼š ROC æ›²çº¿æ˜¯ FPR è¶Šå°ï¼ŒTPR è¶Šå¤§ æœ€å¥½. (ä¹Ÿå°±æ˜¯æ›²çº¿ x è½´è¶Šå°ï¼Œyè½´è¶Šå¤§ æœ€å¥½) ROCæ›²çº¿çš„é€‚ç”¨åœºæ™¯æ›´å¤šï¼Œè¢«å¹¿æ³›ç”¨äºæ’åºã€æ¨èã€å¹¿å‘Šç­‰é¢†åŸŸ Q2: å¦‚ä½•ç»˜åˆ¶ROCæ›²çº¿ï¼Ÿ ä¸å‰é¢çš„P-Ræ›²çº¿ç±»ä¼¼ï¼Œ ROCæ›²çº¿æ˜¯é€šè¿‡ä¸æ–­ç§»åŠ¨åˆ†ç±»å™¨çš„â€œæˆªæ–­ç‚¹â€æ¥ç”Ÿæˆæ›²çº¿ä¸Šçš„ä¸€ç»„å…³é”®ç‚¹çš„, æˆªæ–­ç‚¹æŒ‡çš„æ˜¯åŒºåˆ†æ­£è´Ÿé¢„æµ‹ç»“æœçš„é˜ˆå€¼: (1). è¿˜æœ‰ä¸€ç§æ›´ç›´è§‚åœ°ç»˜åˆ¶ROCçš„æ–¹æ³•ã€‚æ ¹æ®æ ·æœ¬æ ‡ç­¾ç»Ÿè®¡æ­£è´Ÿæ ·æœ¬æ•°é‡ï¼Œå‡è®¾æ­£æ ·æœ¬æ•°é‡ Pï¼Œè´Ÿæ ·æœ¬æ•°é‡ N. (2). æ¥ä¸‹æ¥æŠŠæ¨ªè½´åˆ»åº¦é—´éš”è®¾ç½®ä¸º 1 / N, çºµè½´çš„åˆ»åº¦é—´éš”è®¾ç½®ä¸º 1 / Pã€‚ (3). å†æ ¹æ®æ¨¡å‹è¾“å‡ºçš„é¢„æµ‹æ¦‚ç‡å¯¹æ ·æœ¬è¿›è¡Œæ’åºï¼ˆä»é«˜åˆ°ä½ï¼‰ï¼›ä¾æ¬¡éå†æ ·æœ¬ï¼ŒåŒæ—¶ä»é›¶ç‚¹å¼€å§‹ç»˜åˆ¶ROCæ›²çº¿ï¼Œæ¯é‡åˆ°ä¸€ä¸ªæ­£æ ·æœ¬å°±æ²¿ç€çºµè½´æ–¹å‘ç»˜åˆ¶ä¸€ä¸ªåˆ»åº¦é—´éš”çš„æ›²çº¿ï¼Œæ¯é‡åˆ°ä¸€ä¸ªè´Ÿæ ·æœ¬å°±æ²¿æ¨ªè½´æ–¹å‘ç»˜åˆ¶ä¸€ä¸ªåˆ»åº¦é—´éš”çš„æ›²çº¿ï¼Œç›´åˆ°éå†å®Œæ‰€æœ‰æ ·æœ¬ï¼Œæ›²çº¿æœ€ç»ˆåœåœ¨ï¼ˆ1ï¼Œ1ï¼‰æ•´ä¸ªROCæ›²çº¿ç»˜åˆ¶å®Œæˆã€‚è¿™æ ·å°±å¾ˆå¥½ç†è§£ä¸ºä»€ä¹ˆé¢ç§¯è¶Šå¤§ï¼Œåˆ†ç±»æ€§èƒ½è¶Šå¥½äº†ï¼Œæƒ³è±¡è¿™ä¸ªè¿‡ç¨‹å³å¯ã€‚ ROCæ›²çº¿æ— è§†æ ·æœ¬ä¸å¹³è¡¡ ç²¾ç¡®ç‡ã€å¬å›ç‡ã€F1 å€¼ã€ROCã€AUC å„è‡ªçš„ä¼˜ç¼ºç‚¹æ˜¯ä»€ä¹ˆï¼Ÿ æœºå™¨å­¦ä¹ ä¹‹ç±»åˆ«ä¸å¹³è¡¡é—®é¢˜ (2) â€”â€” ROCå’ŒPRæ›²çº¿ 1.7 AUCAUC = 0.5ï¼Œè·ŸéšæœºçŒœæµ‹ä¸€æ ·ï¼Œ ROC çºµè½´ TPR è¶Šå¤§ï¼Œ æ¨ªè½´ FPR è¶Šå° æ¨¡å‹è¶Šå¥½ 0.5 - 0.7ï¼šæ•ˆæœè¾ƒä½ï¼Œä½†ç”¨äºé¢„æµ‹è‚¡ç¥¨å·²ç»å¾ˆä¸é”™äº†0.7 - 0.85ï¼šæ•ˆæœä¸€èˆ¬0.85 - 0.95ï¼šæ•ˆæœå¾ˆå¥½ real world data ç»å¸¸ä¼šé¢ä¸´ class imbalance é—®é¢˜ï¼Œå³æ­£è´Ÿæ ·æœ¬æ¯”ä¾‹å¤±è¡¡ã€‚ æ ¹æ®è®¡ç®—å…¬å¼å¯ä»¥æ¨çŸ¥ï¼Œåœ¨ testing set å‡ºç° imbalance æ—¶ ROCæ›²çº¿ èƒ½ä¿æŒä¸å˜ï¼Œè€Œ PR åˆ™ä¼šå‡ºç°å¤§å˜åŒ–ã€‚ 2 Regression Metric2.1 MSEMSE ï¼ˆMean Squared Errorï¼‰ç§°ä¸ºå‡æ–¹è¯¯å·®ï¼Œï¼Œåˆè¢«ç§°ä¸º L2èŒƒæ•°æŸå¤±: MSE=\\frac{1}{n}\\sum_{i=1}^n{(f\\_i - y\\_i)^2}2.2 RMSEå‡æ–¹æ ¹è¯¯å·®(Root Mean Squared Error, RMSE)ï¼Œå®šä¹‰å¦‚ä¸‹ï¼š RMSE=\\sqrt{MSE}2.3 MAE MAE = \\frac{1}{n}\\sum\\_{i=1}^n|f\\_i-y\\_i| ç¼ºç‚¹ï¼šå› ä¸ºå®ƒä½¿ç”¨çš„æ˜¯å¹³å‡è¯¯å·®ï¼Œè€Œå¹³å‡è¯¯å·®å¯¹å¼‚å¸¸ç‚¹è¾ƒæ•æ„Ÿï¼Œå¦‚æœå›å½’å™¨å¯¹æŸä¸ªç‚¹çš„å›å½’å€¼å¾ˆä¸åˆç†ï¼Œé‚£ä¹ˆå®ƒçš„è¯¯å·®åˆ™æ¯”è¾ƒå¤§ï¼Œä»è€Œä¼šå¯¹RMSEçš„å€¼æœ‰è¾ƒå¤§å½±å“ï¼Œå³å¹³å‡å€¼æ˜¯éé²æ£’çš„ã€‚ 2.4 MAPEå…¨ç§°æ˜¯ Mean Absolute Percentage Errorï¼ˆWikiPediaï¼‰, ä¹Ÿå« mean absolute percentage deviation (MAPD)ï¼Œåœ¨ç»Ÿè®¡é¢†åŸŸæ˜¯ä¸€ä¸ªé¢„æµ‹å‡†ç¡®æ€§çš„è¡¡é‡æŒ‡æ ‡ã€‚ MAPE=\\frac{100}{n}\\sum\\_{t=1}^{n}|\\frac{y\\_i-f\\_i}{y\\_i}|3. ä½™å¼¦ç›¸ä¼¼åº¦ vs æ¬§å¼è·ç¦»ä½™å¼¦ç›¸ä¼¼åº¦ ï¼š åæ ‡ç³»ä¸­ä¸¤ä¸ªå‘é‡ï¼Œæ¥è®¡ç®—ä¸¤å‘é‡ä¹‹é—´çš„å¤¹è§’, å€¼åŸŸ [-1, 1] ä½™å¼¦è·ç¦» ï¼š å€¼åŸŸ [0, 1] 1 - cosæ¬§å¼è·ç¦» ï¼š åæ ‡ç³»ä¸­ä¸¤ä¸ªç‚¹ï¼Œæ¥è®¡ç®—ä¸¤ç‚¹ä¹‹é—´çš„è·ç¦»ï¼› å‡è®¾äºŒç»´ç©ºé—´ä¸¤ä¸ªç‚¹ï¼š ç„¶åå½’ä¸€åŒ–ä¸ºå•ä½å‘é‡ï¼š ä½™å¼¦ç›¸ä¼¼åº¦å°±æ˜¯ï¼š æ¬§å¼è·ç¦»å°±æ˜¯ï¼š åŒ–ç®€åå°±æ˜¯ï¼š å¾ˆæ˜æ˜¾ï¼Œæ˜¯ä¸€ä¸ªå•è°ƒå‡½æ•°ï¼ˆå›¾åƒç±»ä¼¼äºå•ä½å…ƒçš„ç¬¬ä¸€è±¡é™éƒ¨åˆ†ï¼‰ï¼Œä¹Ÿå°±æ„å‘³ç€ï¼Œä¸¤è€…åœ¨å½’ä¸€åŒ–ä¸ºå•ä½å‘é‡çš„æ—¶å€™è®¡ç®—ç›¸ä¼¼åº¦ç»“æœå®Œå…¨ä¸€æ ·ã€‚åªä¸è¿‡ä½™å¼¦ç›¸ä¼¼åº¦æ˜¯å€¼è¶Šå¤§æœˆç›¸ä¼¼ï¼Œæ¬§å¼è·ç¦»æ˜¯å€¼è¶Šå°è¶Šç›¸ä¼¼ã€‚ çŸ¥è¯†ç‚¹ ï¼š ä½™å¼¦ç›¸ä¼¼åº¦ã€ä½™å¼¦è·ç¦»ã€æ¬§å¼è·ç¦»ã€è·ç¦»çš„å®šä¹‰ 4. A/B æµ‹è¯•çš„é™·é˜±Q1ï¼šåœ¨å¯¹æ¨¡å‹è¿›è¡Œå……åˆ†çš„ç¦»çº¿è¯„ä¼°ä¹‹åï¼Œä¸ºä»€ä¹ˆè¿˜è¦è¿›è¡Œåœ¨çº¿A/Bæµ‹è¯•ï¼Ÿ ï¼ˆ1ï¼‰ç¦»çº¿è¯„ä¼°æ— æ³•å®Œå…¨æ¶ˆé™¤æ¨¡å‹è¿‡æ‹Ÿåˆçš„å½±å“ã€‚ ï¼ˆ2ï¼‰ç¦»çº¿è¯„ä¼°æ— æ³•å®Œå…¨è¿˜åŸçº¿ä¸Šçš„å·¥ç¨‹ç¯å¢ƒã€‚çº¿ä¸Šçš„å·¥ç¨‹ç¯å¢ƒåŒ…æ‹¬æ•°æ®å»¶è¿Ÿã€æ•°æ®ç¼ºå¤±ã€æ ‡ç­¾ç¼ºå¤±ç­‰æƒ…å†µã€‚ ï¼ˆ3ï¼‰çº¿ä¸Šç³»ç»Ÿçš„æŸäº›å•†ä¸šæŒ‡æ ‡åœ¨ç¦»çº¿è¯„ä¼°ä¸­æ— æ³•è®¡ç®—ã€‚ ç¦»çº¿æ¨¡å‹è¯„ä¼°çš„æŒ‡æ ‡åŒ…æ‹¬å‡†ç¡®ç‡ï¼Œå¬å›ç‡å’ŒROCæ›²çº¿ç­‰ã€‚ è€Œçº¿ä¸Šè¯„ä¼°å¯ä»¥å…¨é¢äº†è§£è¯¥æ¨èç®—æ³•å¸¦æ¥çš„ç”¨æˆ·ç‚¹å‡»ç‡ã€ç•™å­˜æ—¶é•¿ã€PVè®¿é—®é‡ç­‰çš„å˜åŒ–ã€‚è¿™äº›éƒ½è¦ç”±A/Bæµ‹è¯•æ¥è¿›è¡Œå…¨é¢çš„è¯„ä¼°ã€‚ Q2ï¼šå¦‚ä½•è¿›è¡Œçº¿ä¸ŠABæµ‹è¯•ï¼Ÿ ç­”ï¼šè¿›è¡ŒABæµ‹è¯•çš„ä¸»è¦æ‰‹æ®µæ˜¯è¿›è¡Œç”¨æˆ·åˆ†æ¡¶ï¼Œå³å°†ç”¨æˆ·åˆ†æˆå®éªŒç»„å’Œå¯¹ç…§ç»„ï¼Œå¯¹å®éªŒç»„çš„ç”¨æˆ·æ–½ä»¥æ–°æ¨¡å‹ï¼Œå¯¹å¯¹ç…§ç»„çš„ç”¨æˆ·æ–½ä»¥æ—§æ¨¡å‹ã€‚ åˆ†æ¡¶çš„è¿‡ç¨‹ä¸­ï¼Œè¦æ³¨æ„ æ ·æœ¬çš„ç‹¬ç«‹æ€§ å’Œ é‡‡æ ·æ–¹å¼çš„æ— åæ€§. 5. æ¨¡å‹è¯„ä¼°æ–¹æ³•Q1: åœ¨æ¨¡å‹è¯„ä¼°è¿‡ç¨‹ä¸­ï¼Œæœ‰å“ªäº›ä¸»è¦çš„éªŒè¯æ–¹æ³•ï¼Œå®ƒä»¬çš„ä¼˜ç¼ºç‚¹æ˜¯ä»€ä¹ˆï¼Ÿ Holdoutæ£€éªŒ äº¤å‰æ£€éªŒ (k-foldäº¤å‰éªŒè¯, åœ¨å®é™…å®éªŒä¸­ï¼Œç»å¸¸å–10ã€‚) è‡ªåŠ©æ³• Q2ï¼šåœ¨è‡ªåŠ©æ³•çš„é‡‡æ ·è¿‡ç¨‹ä¸­ï¼Œå¯¹nä¸ªæ ·æœ¬è¿›è¡Œnæ¬¡è‡ªåŠ©æŠ½æ ·ï¼Œå½“nè¶‹äºæ— ç©·å¤§æ—¶ï¼Œæœ€ç»ˆæœ‰å¤šå°‘æ•°æ®ä»æœªè¢«é€‰æ‹©è¿‡? æ ¹æ®é‡è¦æé™ï¼Œå½“æ ·æœ¬é‡å¾ˆå¤§æ—¶ï¼Œå¤§çº¦æœ‰ 0.368 çš„æ ·æœ¬ä»æœªè¢«é€‰æ‹©è¿‡ï¼Œå¯åšä¸ºéªŒè¯é›†ã€‚ 6. è¶…å‚æ•°è°ƒä¼˜ ç½‘æ ¼æœç´¢ éšæœºæœç´¢ è´å¶æ–¯ä¼˜åŒ– (æœªç ”ç©¶) 7. è¿‡æ‹Ÿåˆ/æ¬ æ‹Ÿåˆé˜²æ­¢ overfiting çš„ 8 æ¡ 1). get more data2). Data augmentation3). Regularizationï¼ˆæƒå€¼è¡°å‡ï¼‰. (L1 æ‹‰æ™®æ‹‰æ–¯å…ˆéªŒ, L2 é«˜æ–¯å…ˆéªŒ)4). Dropout (ç±»ä¼¼ RF bagging ä½œç”¨ï¼Œæœ€åä»¥æŠ•ç¥¨çš„æ–¹å¼é™ä½è¿‡æ‹Ÿåˆï¼›)5). Choosing Right Network Structure6). Early stopping7). Model Ensumble8). Batch Normalization 8. å…¶ä»–è¯„ä»·æŒ‡æ ‡ è®¡ç®—é€Ÿåº¦ï¼šæ¨¡å‹è®­ç»ƒå’Œé¢„æµ‹éœ€è¦çš„æ—¶é—´ï¼› é²æ£’æ€§ï¼šå¤„ç†ç¼ºå¤±å€¼å’Œå¼‚å¸¸å€¼çš„èƒ½åŠ›ï¼› å¯æ‹“å±•æ€§ï¼šå¤„ç†å¤§æ•°æ®é›†çš„èƒ½åŠ›ï¼› å¯è§£é‡Šæ€§ï¼šæ¨¡å‹é¢„æµ‹æ ‡å‡†çš„å¯ç†è§£æ€§ï¼Œæ¯”å¦‚å†³ç­–æ ‘äº§ç”Ÿçš„è§„åˆ™å°±å¾ˆå®¹æ˜“ç†è§£ï¼Œè€Œç¥ç»ç½‘ç»œè¢«ç§°ä¸ºé»‘ç›’å­çš„åŸå› å°±æ˜¯å®ƒçš„å¤§é‡å‚æ•°å¹¶ä¸å¥½ç†è§£ã€‚ Reference ç²¾ç¡®ç‡ã€å¬å›ç‡ã€F1 å€¼ã€ROCã€AUC å„è‡ªçš„ä¼˜ç¼ºç‚¹æ˜¯ä»€ä¹ˆï¼Ÿ æœºå™¨å­¦ä¹ ä¹‹ç±»åˆ«ä¸å¹³è¡¡é—®é¢˜ (2) â€”â€” ROCå’ŒPRæ›²çº¿ sklearnä¸­ F1-micro ä¸ F1-macro åŒºåˆ«å’Œè®¡ç®—åŸç† Bias-Variance Tradeoff ç¨‹åºå‘˜å¤§æœ¬è¥-ç™¾é¢ CSDN æ¨¡å‹è¯„ä¼° ç®€å•èŠèŠæ¨¡å‹çš„æ€§èƒ½è¯„ä¼°æ ‡å‡† ä»0å¼€å§‹æœºå™¨å­¦ä¹ -ä¸ºä»€ä¹ˆè¦åšAï¼B Test ç™¾é¢æ¨¡å‹è¯„ä¼°","categories":[{"name":"machine-learning","slug":"machine-learning","permalink":"http://iequa.com/categories/machine-learning/"}],"tags":[{"name":"Metric","slug":"Metric","permalink":"http://iequa.com/tags/Metric/"}]},{"title":"Rondom Forest vs GBDT","slug":"ml/Random_Forest_and_GBDT","date":"2019-06-02T02:01:21.000Z","updated":"2019-10-20T04:30:35.039Z","comments":true,"path":"2019/06/02/ml/Random_Forest_and_GBDT/","link":"","permalink":"http://iequa.com/2019/06/02/ml/Random_Forest_and_GBDT/","excerpt":"","text":"1. Random ForestRondom Forest æ˜¯ä¸€ä¸ªå…¸å‹çš„å¤šä¸ªå†³ç­–æ ‘çš„ç»„åˆåˆ†ç±»å™¨. Rondom Forest, çš„ Random ä½“ç°åœ¨ 2 ä¸ªæ–¹é¢ï¼š data random feature random RFã€baggingã€boostingã€GBDTã€xgboostç®—æ³•æ€»ç»“ Sample data Randomï¼š Feature Randomï¼š ä¸æ•°æ®é›†çš„éšæœºé€‰å–ç±»ä¼¼ï¼Œéšæœºæ£®æ—ä¸­çš„å­æ ‘çš„æ¯ä¸€ä¸ªåˆ†è£‚è¿‡ç¨‹å¹¶æœªç”¨åˆ°æ‰€æœ‰çš„å¾…é€‰ç‰¹å¾ï¼Œè€Œæ˜¯ä»æ‰€æœ‰çš„å¾…é€‰ç‰¹å¾ä¸­éšæœºé€‰å–ä¸€å®šçš„ç‰¹å¾ï¼Œä¹‹åå†åœ¨éšæœºé€‰å–çš„ç‰¹å¾ä¸­é€‰å–æœ€ä¼˜çš„ç‰¹å¾ã€‚è¿™æ ·èƒ½å¤Ÿä½¿å¾—éšæœºæ£®æ—ä¸­çš„å†³ç­–æ ‘éƒ½èƒ½å¤Ÿå½¼æ­¤ä¸åŒï¼Œæå‡ç³»ç»Ÿçš„å¤šæ ·æ€§ï¼Œä»è€Œæå‡åˆ†ç±»æ€§èƒ½ã€‚ 2. GBDTGBDT æ˜¯ä»¥å†³ç­–æ ‘ï¼ˆCARTï¼‰ä¸ºåŸºå­¦ä¹ å™¨çš„ GBç®—æ³•ï¼Œæ˜¯è¿­ä»£æ ‘ï¼Œè€Œä¸æ˜¯åˆ†ç±»æ ‘ã€‚ ä¸€èˆ¬ Boosting ç®—æ³•éƒ½æ˜¯ä¸€ä¸ªè¿­ä»£çš„è¿‡ç¨‹ï¼Œæ¯ä¸€æ¬¡æ–°çš„è®­ç»ƒéƒ½æ˜¯ä¸ºäº†æ”¹è¿›ä¸Šä¸€æ¬¡çš„ç»“æœã€‚ GBDT çš„æ ¸å¿ƒå°±åœ¨äºï¼šæ¯ä¸€æ£µæ ‘å­¦çš„æ˜¯ä¹‹å‰æ‰€æœ‰æ ‘ç»“è®ºå’Œçš„æ®‹å·®ï¼Œè¿™ä¸ªæ®‹å·®å°±æ˜¯ä¸€ä¸ªåŠ é¢„æµ‹å€¼åèƒ½å¾—çœŸå®å€¼çš„ç´¯åŠ é‡ã€‚ 3. RF vs GBDT ç»„æˆ RF çš„æ ‘å¯ä»¥æ˜¯åˆ†ç±»æ ‘ï¼Œä¹Ÿå¯ä»¥æ˜¯å›å½’æ ‘ï¼›è€ŒGBDTåªç”±å›å½’æ ‘ç»„æˆ ç»„æˆ RF çš„æ ‘å¯ä»¥å¹¶è¡Œç”Ÿæˆï¼›è€Œ GBDT åªèƒ½æ˜¯ä¸²è¡Œç”Ÿæˆ. å¯¹äºæœ€ç»ˆçš„è¾“å‡ºç»“æœè€Œè¨€ï¼Œéšæœºæ£®æ—é‡‡ç”¨å¤šæ•°æŠ•ç¥¨ç­‰ï¼›è€Œ GBDT åˆ™æ˜¯å°†æ‰€æœ‰ç»“æœç´¯åŠ èµ·æ¥ï¼Œæˆ–è€…åŠ æƒç´¯åŠ èµ·æ¥. RF å¯¹å¼‚å¸¸å€¼ä¸æ•æ„Ÿï¼ŒGBDT å¯¹å¼‚å¸¸å€¼éå¸¸æ•æ„Ÿ. RF å¯¹è®­ç»ƒé›†ä¸€è§†åŒä»ï¼ŒGBDT æ˜¯åŸºäºæƒå€¼çš„å¼±åˆ†ç±»å™¨çš„é›†æˆ. RF æ˜¯é€šè¿‡å‡å°‘æ¨¡å‹æ–¹å·®æé«˜æ€§èƒ½ï¼ŒGBDTæ˜¯é€šè¿‡å‡å°‘æ¨¡å‹åå·®æé«˜æ€§èƒ½. 4. Xgboost vs GBDTXgboostç›¸æ¯”äºGBDTæ¥è¯´ï¼Œæ›´åŠ æœ‰æ•ˆåº”ç”¨äº†æ•°å€¼ä¼˜åŒ–ï¼Œæœ€é‡è¦æ˜¯å¯¹æŸå¤±å‡½æ•°ï¼ˆé¢„æµ‹å€¼å’ŒçœŸå®å€¼çš„è¯¯å·®ï¼‰å˜å¾—æ›´å¤æ‚ã€‚ç›®æ ‡å‡½æ•°ä¾ç„¶æ˜¯æ‰€æœ‰æ ‘çš„é¢„æµ‹å€¼ç›¸åŠ ç­‰äºé¢„æµ‹å€¼ã€‚ äºŒé˜¶æ³°å‹’å±•å¼€ï¼ŒåŒæ—¶ç”¨åˆ°äº†ä¸€é˜¶å’ŒäºŒé˜¶å¯¼æ•° xgbooståœ¨ä»£ä»·å‡½æ•°é‡ŒåŠ å…¥äº†æ­£åˆ™é¡¹ï¼Œç”¨äºæ§åˆ¶æ¨¡å‹çš„å¤æ‚åº¦ Shrinkageï¼ˆç¼©å‡ï¼‰ï¼Œç›¸å½“äºå­¦ä¹ é€Ÿç‡ï¼ˆxgboostä¸­çš„etaï¼‰ åˆ—æŠ½æ ·ï¼ˆcolumn subsamplingï¼‰ã€‚xgboostå€Ÿé‰´RFåšæ³•ï¼Œæ”¯æŒåˆ—æŠ½æ ·ï¼ˆå³æ¯æ¬¡çš„è¾“å…¥ç‰¹å¾ä¸æ˜¯å…¨éƒ¨ç‰¹å¾) å¹¶è¡ŒåŒ–å¤„ç†ï¼š é¢„å…ˆå¯¹æ¯ä¸ªç‰¹å¾å†…éƒ¨è¿›è¡Œäº†æ’åºæ‰¾å‡ºå€™é€‰åˆ‡å‰²ç‚¹.å„ä¸ªfeatureçš„å¢ç›Šè®¡ç®—å°±å¯ä»¥å¼€å¤šçº¿ç¨‹è¿›è¡Œ. å¥½çš„æ¨¡å‹éœ€è¦å…·å¤‡ä¸¤ä¸ªåŸºæœ¬è¦ç´ ï¼š æ˜¯è¦æœ‰å¥½çš„ç²¾åº¦ï¼ˆå³å¥½çš„æ‹Ÿåˆç¨‹åº¦ï¼‰ æ˜¯æ¨¡å‹è¦å°½å¯èƒ½çš„ç®€å•ï¼ˆå¤æ‚çš„æ¨¡å‹å®¹æ˜“å‡ºç°è¿‡æ‹Ÿåˆï¼Œå¹¶ä¸”æ›´åŠ ä¸ç¨³å®šï¼‰ å› æ­¤ï¼Œæˆ‘ä»¬æ„å»ºçš„ç›®æ ‡å‡½æ•°å³è¾¹ç¬¬ä¸€é¡¹æ˜¯æ¨¡å‹çš„è¯¯å·®é¡¹ï¼Œç¬¬äºŒé¡¹æ˜¯æ­£åˆ™åŒ–é¡¹ï¼ˆä¹Ÿå°±æ˜¯æ¨¡å‹å¤æ‚åº¦çš„æƒ©ç½šé¡¹ï¼‰ å¸¸ç”¨çš„è¯¯å·®é¡¹æœ‰å¹³æ–¹è¯¯å·®å’Œé€»è¾‘æ–¯è’‚è¯¯å·®ï¼Œå¸¸è§çš„æƒ©ç½šé¡¹æœ‰l1ï¼Œl2æ­£åˆ™ï¼Œl1æ­£åˆ™æ˜¯å°†æ¨¡å‹å„ä¸ªå…ƒç´ è¿›è¡Œæ±‚å’Œï¼Œl2æ­£åˆ™æ˜¯å¯¹å…ƒç´ æ±‚å¹³æ–¹ã€‚ ID3ã€C4.5ã€CARTã€éšæœºæ£®æ—ã€baggingã€boostingã€Adaboostã€GBDTã€xgboostç®—æ³•æ€»ç»“ 5. Bagging vs Boostingä¸¤ç§æ–¹æ³•çš„é‡‡æ ·å’Œå¤„ç†æ–¹å¼éƒ½ä¸åŒï¼Œä¸»è¦ä»£è¡¨ç®—æ³•ä¾¿æ˜¯ï¼š Rondom Forestã€ GBDT. 5.1 BaggingBagging çš„æ€æƒ³æ¯”è¾ƒç®€å•ï¼Œå³æ¯ä¸€æ¬¡ä»åŸå§‹æ•°æ®ä¸­æ ¹æ® å‡åŒ€æ¦‚ç‡åˆ†å¸ƒæœ‰æ”¾å›çš„æŠ½å–å’ŒåŸå§‹æ•°æ®å¤§å°ç›¸åŒçš„æ ·æœ¬é›†åˆï¼Œæ ·æœ¬ç‚¹å¯èƒ½å‡ºç°é‡å¤ï¼Œç„¶åå¯¹æ¯ä¸€æ¬¡äº§ç”Ÿçš„è®­ç»ƒé›†æ„é€ ä¸€ä¸ªåˆ†ç±»å™¨ï¼Œå†å¯¹åˆ†ç±»å™¨è¿›è¡Œç»„åˆã€‚ 5.2 BoostingBoosting çš„æ¯ä¸€æ¬¡æŠ½æ ·çš„ æ ·æœ¬åˆ†å¸ƒéƒ½æ˜¯ä¸ä¸€æ · çš„ã€‚æ¯ä¸€æ¬¡è¿­ä»£ï¼Œéƒ½æ ¹æ®ä¸Šä¸€æ¬¡è¿­ä»£çš„ç»“æœï¼Œå¢åŠ è¢«é”™è¯¯åˆ†ç±»çš„æ ·æœ¬çš„æƒé‡ï¼Œä½¿å¾—æ¨¡å‹èƒ½åœ¨ä¹‹åçš„è¿­ä»£ä¸­æ›´åŠ æ³¨æ„åˆ° éš¾ä»¥åˆ†ç±»çš„æ ·æœ¬ï¼Œè¿™æ˜¯ä¸€ä¸ª ä¸æ–­å­¦ä¹ çš„è¿‡ç¨‹ï¼Œä¹Ÿæ˜¯ä¸€ä¸ªä¸æ–­æå‡ çš„è¿‡ç¨‹ï¼Œè¿™ä¹Ÿå°±æ˜¯boostingæ€æƒ³çš„æœ¬è´¨æ‰€åœ¨ã€‚ è¿­ä»£ä¹‹åï¼Œå°†æ¯æ¬¡è¿­ä»£çš„åŸºåˆ†ç±»å™¨è¿›è¡Œé›†æˆã€‚é‚£ä¹ˆå¦‚ä½•è¿›è¡Œæ ·æœ¬æƒé‡çš„è°ƒæ•´å’Œåˆ†ç±»å™¨çš„é›†æˆæ˜¯æˆ‘ä»¬éœ€è¦è€ƒè™‘çš„å…³é”®é—®é¢˜ã€‚ 6. ç‰¹å¾é‡è¦åº¦6.1 RF ç‰¹å¾åº¦é‡(1ï¼‰å¯¹æ¯ä¸€é¢—å†³ç­–æ ‘ï¼Œé€‰æ‹©ç›¸åº”çš„è¢‹å¤–æ•°æ®ï¼ˆout of bagï¼ŒOOBï¼‰â€‹è®¡ç®—è¢‹å¤–æ•°æ®è¯¯å·®ï¼Œè®°ä¸ºerrOOB1. æ‰€è°“è¢‹å¤–æ•°æ®æ˜¯æŒ‡ï¼Œæ¯æ¬¡å»ºç«‹å†³ç­–æ ‘æ—¶ï¼Œé€šè¿‡é‡å¤æŠ½æ ·å¾—åˆ°ä¸€ä¸ªæ•°æ®ç”¨äºè®­ç»ƒâ€‹å†³ç­–æ ‘ï¼Œè¿™æ—¶è¿˜æœ‰å¤§çº¦1/3çš„æ•°æ®æ²¡æœ‰è¢«åˆ©ç”¨ï¼Œæ²¡æœ‰å‚ä¸å†³ç­–æ ‘çš„å»ºç«‹ã€‚è¿™éƒ¨åˆ†æ•°æ®å¯ä»¥ç”¨äºå¯¹å†³ç­–æ ‘çš„æ€§èƒ½è¿›è¡Œè¯„ä¼°ï¼Œè®¡ç®—æ¨¡å‹çš„é¢„æµ‹é”™è¯¯ç‡ï¼Œç§°ä¸ºè¢‹å¤–æ•°æ®è¯¯å·®ã€‚ â€‹è¿™å·²ç»ç»è¿‡è¯æ˜æ˜¯æ— åä¼°è®¡çš„,æ‰€ä»¥åœ¨éšæœºæ£®æ—ç®—æ³•ä¸­ä¸éœ€è¦å†è¿›è¡Œäº¤å‰éªŒè¯æˆ–è€…å•ç‹¬çš„æµ‹è¯•é›†æ¥è·å–æµ‹è¯•é›†è¯¯å·®çš„æ— åä¼°è®¡ã€‚ â€‹(2ï¼‰éšæœºå¯¹è¢‹å¤–æ•°æ®OOBæ‰€æœ‰æ ·æœ¬çš„ç‰¹å¾$X$åŠ å…¥å™ªå£°å¹²æ‰°ï¼ˆå¯ä»¥éšæœºæ”¹å˜æ ·æœ¬åœ¨ç‰¹å¾Xå¤„çš„å€¼ï¼‰ï¼Œå†æ¬¡è®¡ç®—è¢‹å¤–æ•°æ®è¯¯å·®ï¼Œè®°ä¸ºerrOOB2ã€‚ (3ï¼‰â€‹å‡è®¾æ£®æ—ä¸­æœ‰Næ£µæ ‘ï¼Œåˆ™ç‰¹å¾Xçš„é‡è¦æ€§=âˆ‘ï¼ˆerrOOB2-errOOB1ï¼‰/Nã€‚è¿™ä¸ªæ•°å€¼ä¹‹æ‰€ä»¥èƒ½å¤Ÿè¯´æ˜ç‰¹å¾çš„é‡è¦æ€§æ˜¯å› ä¸ºï¼Œå¦‚æœåŠ å…¥éšæœºå™ªå£°åï¼Œè¢‹å¤–æ•°æ®å‡†ç¡®ç‡å¤§å¹…åº¦ä¸‹é™ï¼ˆå³errOOB2ä¸Šå‡ï¼‰ï¼Œè¯´æ˜è¿™ä¸ªç‰¹å¾å¯¹äºæ ·æœ¬çš„é¢„æµ‹ç»“æœæœ‰å¾ˆå¤§å½±å“ï¼Œè¿›è€Œè¯´æ˜é‡è¦ç¨‹åº¦æ¯”è¾ƒé«˜ã€‚ 6.2 GBDT ç‰¹å¾åº¦é‡ä¸»è¦æ˜¯é€šè¿‡è®¡ç®—ç‰¹å¾iåœ¨å•æ£µæ ‘ä¸­é‡è¦åº¦çš„å¹³å‡å€¼ï¼Œè®¡ç®—å…¬å¼å¦‚ä¸‹ï¼š å…¶ä¸­ï¼ŒMæ˜¯æ ‘çš„æ•°é‡ã€‚ç‰¹å¾iåœ¨å•æ£µæ ‘çš„é‡è¦åº¦ä¸»è¦æ˜¯é€šè¿‡è®¡ç®—æŒ‰è¿™ä¸ªç‰¹å¾iåˆ†è£‚ä¹‹åæŸå¤±çš„å‡å°‘å€¼. å…¶ä¸­ï¼ŒLæ˜¯å¶å­èŠ‚ç‚¹çš„æ•°é‡ï¼ŒL-1å°±æ˜¯éå¶å­ç»“ç‚¹çš„æ•°é‡ã€‚ 6.3 XgboostXGboostæ˜¯é€šè¿‡è¯¥ç‰¹å¾æ¯æ£µæ ‘ä¸­åˆ†è£‚æ¬¡æ•°çš„å’Œå»è®¡ç®—çš„ï¼Œæ¯”å¦‚è¿™ä¸ªç‰¹å¾åœ¨ç¬¬ä¸€æ£µæ ‘åˆ†è£‚1æ¬¡ï¼Œç¬¬äºŒæ£µæ ‘2æ¬¡â€¦â€¦ï¼Œé‚£ä¹ˆè¿™ä¸ªç‰¹å¾çš„å¾—åˆ†å°±æ˜¯(1+2+â€¦)ã€‚ Reference éšæœºæ£®æ—è¿›è¡Œç‰¹å¾é‡è¦æ€§åº¦é‡çš„è¯¦ç»†è¯´æ˜ ä»€ä¹ˆæ˜¯æ— åä¼°è®¡ï¼Ÿ GBDT PDF æœºå™¨å­¦ä¹ ç®—æ³•ä¸­ GBDT å’Œ XGBOOST çš„åŒºåˆ«æœ‰å“ªäº›ï¼Ÿ","categories":[{"name":"machine-learning","slug":"machine-learning","permalink":"http://iequa.com/categories/machine-learning/"}],"tags":[{"name":"Rondom_Forest","slug":"Rondom-Forest","permalink":"http://iequa.com/tags/Rondom-Forest/"}]},{"title":"Logistic Regression","slug":"ml/Logistic_Regression","date":"2019-05-31T02:01:21.000Z","updated":"2020-11-25T09:18:02.251Z","comments":true,"path":"2019/05/31/ml/Logistic_Regression/","link":"","permalink":"http://iequa.com/2019/05/31/ml/Logistic_Regression/","excerpt":"","text":"Logistic Regression æ˜¯ä¸€ç§ç”¨äºè§£å†³äºŒåˆ†ç±»ï¼ˆ0 or 1ï¼‰é—®é¢˜çš„æœºå™¨å­¦ä¹ æ–¹æ³•.ä¸¾ä¸ªğŸŒ° : (1). ç”¨æˆ·è´­ä¹°æŸå•†å“çš„å¯èƒ½æ€§ (2). æŸç—…äººæ‚£æœ‰æŸç§ç–¾ç—…çš„å¯èƒ½æ€§ (3). æŸå¹¿å‘Šè¢«ç”¨æˆ·ç‚¹å‡»çš„å¯èƒ½æ€§ç­‰ 1. Logistic vs Linear RegressionLogistic Regression å’Œ Linear Regression éƒ½æ˜¯ä¸€ç§å¹¿ä¹‰çº¿æ€§æ¨¡å‹ï¼ˆgeneralized linear modelï¼‰ã€‚ é€»è¾‘å›å½’å‡è®¾å› å˜é‡ y æœä»ä¼¯åŠªåˆ©åˆ†å¸ƒï¼Œè€Œçº¿æ€§å›å½’å‡è®¾å› å˜é‡ y æœä»é«˜æ–¯åˆ†å¸ƒã€‚ å› æ­¤ä¸çº¿æ€§å›å½’æœ‰å¾ˆå¤šç›¸åŒä¹‹å¤„ï¼Œå»é™¤ Sigmoid æ˜ å°„å‡½æ•°çš„è¯ï¼Œé€»è¾‘å›å½’ç®—æ³•å°±æ˜¯ä¸€ä¸ªçº¿æ€§å›å½’ã€‚å¯ä»¥è¯´ï¼Œé€»è¾‘å›å½’æ˜¯ä»¥çº¿æ€§å›å½’ä¸ºç†è®ºæ”¯æŒçš„ï¼Œä½†æ˜¯é€»è¾‘å›å½’é€šè¿‡ Sigmoidå‡½æ•° å¼•å…¥äº†éçº¿æ€§å› ç´ ï¼Œå› æ­¤å¯ä»¥è½»æ¾å¤„ç† 0/1 åˆ†ç±»é—®é¢˜ã€‚ 1.1 Linear Regression z={\\theta\\_{0}}+{\\theta\\_{1}x\\_{1}}+{\\theta\\_{2}x\\_{2}+{\\theta\\_{3}x\\_{3}}...+{\\theta\\_{n}x\\_{n}}}=\\theta^Tx ä½¿ç”¨æœ€å°äºŒä¹˜æ³•æ±‚è§£ Linear Regression æ—¶ï¼Œæˆ‘ä»¬è®¤ä¸ºå› å˜é‡ y æœä»æ­£æ€åˆ†å¸ƒã€‚ çº¿æ€§å›å½’å‡è®¾å› å˜é‡ y æœä»é«˜æ–¯åˆ†å¸ƒ: çœŸå®å€¼yä¸æ‹Ÿåˆå€¼Yä¹‹é—´çš„å·®å€¼æ˜¯ä¸æ˜¯ç¬¦åˆæ­£æ€åˆ†å¸ƒã€‚ 1.2 Logistic Regression h\\_{\\theta}(x)=\\frac{1}{1+e^{-z}}=\\frac{1}{1+e^{-\\theta^Tx}} log\\frac{p}{1-p} = \\theta^Tx ä¸€ä»¶äº‹å‘ç”Ÿçš„å‡ ç‡ $odds = \\frac{p}{1-p}$ï¼Œ $p = P(y=1|x)$ Logistic Regression å¯ä»¥çœ‹ä½œæ˜¯å¯¹äº â€œy=1|xâ€ è¿™ä¸€äº‹ä»¶çš„å¯¹æ•°å‡ ç‡çš„çº¿æ€§å›å½’. é€»è¾‘å›å½’é€šè¿‡å¯¹ä¼¼ç„¶å‡½æ•° $L(\\theta)=\\prod_{i=1}^{N}P(y_i|x_i;\\theta)=\\prod_{i=1}^{N}(\\pi(x_i))^{y_i}(1-\\pi(x_i))^{1-y_i} $ çš„å­¦ä¹ ï¼Œå¾—åˆ°æœ€ä½³å‚æ•° Î¸. Logistic ä¸ Linear Regression äºŒè€…éƒ½ä½¿ç”¨äº†æå¤§ä¼¼ç„¶ä¼°è®¡æ¥å¯¹è®­ç»ƒæ ·æœ¬è¿›è¡Œå»ºæ¨¡ è¿­ä»£è‡ªå·± Logistic Regression 2. LR Hypothesis function å…¶å‡½æ•°æ›²çº¿å¦‚ä¸‹ï¼š Logistic Regression å‡è®¾å‡½æ•°å½¢å¼å¦‚ä¸‹ï¼š æ‰€ä»¥ï¼š ä¸€ä¸ªæœºå™¨å­¦ä¹ çš„æ¨¡å‹ï¼Œå®é™…ä¸Šæ˜¯æŠŠå†³ç­–å‡½æ•°é™å®šåœ¨æŸä¸€ç»„æ¡ä»¶ä¸‹ï¼Œè¿™ç»„é™å®šæ¡ä»¶å°±å†³å®šäº†æ¨¡å‹çš„å‡è®¾ç©ºé—´ã€‚å½“ç„¶ï¼Œæˆ‘ä»¬è¿˜å¸Œæœ›è¿™ç»„é™å®šæ¡ä»¶ç®€å•è€Œåˆç†ã€‚è€Œé€»è¾‘å›å½’æ¨¡å‹æ‰€åšçš„å‡è®¾æ˜¯ï¼š è¿™ä¸ªå‡½æ•°çš„æ„æ€å°±æ˜¯åœ¨ç»™å®š x å’Œ 0 çš„æ¡ä»¶ä¸‹ y=1 çš„æ¦‚ç‡ 3. Cost FunctionCost Functionï¼š Loss Functionï¼š ä¸Šé¢çš„æ–¹ç¨‹ç­‰ä»·äºï¼š é€‰æ‹© Cost_Function æ—¶ï¼Œæœ€å¥½æŒ‘é€‰å¯¹å‚æ•° $\\theta$ å¯å¾®çš„å‡½æ•°ï¼ˆå…¨å¾®åˆ†å­˜åœ¨ï¼Œåå¯¼æ•°ä¸€å®šå­˜åœ¨ï¼‰ å¯¹äºæ¯ç§ç®—æ³•æ¥è¯´ï¼ŒCost_Function ä¸æ˜¯å”¯ä¸€çš„ï¼› Cost_Function æ˜¯å‚æ•° $\\theta$ çš„å‡½æ•°ï¼› Cost Function æ˜¯å¯¹æ‰€æœ‰æ ·æœ¬è€Œè¨€, Loss Function æ˜¯å¯¹å•ä¸€æ ·æœ¬è€Œè¨€. $J(\\theta)$ æ˜¯ä¸€ä¸ªæ ‡é‡, æˆ‘ä»¬éœ€è¦ min æœ€å°åŒ–å®ƒ. LR ä¸­ï¼Œä»£ä»·å‡½æ•°æ˜¯äº¤å‰ç†µ (Cross Entropy)ï¼Œäº¤å‰ç†µæ˜¯ä¸€ä¸ªå¸¸è§çš„ä»£ä»·å‡½æ•°: good ç®€å•çš„äº¤å‰ç†µæŸå¤±å‡½æ•°ï¼Œä½ çœŸçš„æ‡‚äº†å—ï¼Ÿ 4. Cross EntropyCross Entropy æ˜¯ä¿¡æ¯è®ºä¸­çš„ä¸€ä¸ªæ¦‚å¿µï¼Œè¦æƒ³äº†è§£äº¤å‰ç†µçš„æœ¬è´¨ï¼Œéœ€è¦å…ˆä»æœ€åŸºæœ¬çš„æ¦‚å¿µè®²èµ·ã€‚ ä¿¡æ¯é‡ã€ç†µã€ç›¸å¯¹ç†µï¼ˆKLæ•£åº¦ï¼‰ã€äº¤å‰ç†µ åŒä¸€ä¸ªéšæœºå˜é‡ x æœ‰ä¸¤ä¸ªå•ç‹¬çš„æ¦‚ç‡åˆ†å¸ƒ P(x) å’Œ Q(x)ï¼Œ ç”¨ KLæ•£åº¦ æ¥è¡¡é‡è¿™ä¸¤ä¸ªåˆ†å¸ƒçš„å·®å¼‚ã€‚ $D_{KL}(p||q)=\\sum_{i=1}^np(x_i)log(\\frac{p(x_i)}{q(x_i)}) \\tag{3.1}$ \\begin{eqnarray} D\\_{KL}(p||q) &=& \\sum\\_{i=1}^np(x\\_i)log(p(x\\_i))-\\sum\\_{i=1}^np(x\\_i)log(q(x\\_i))\\end{eqnarray}ç­‰å¼çš„å‰ä¸€éƒ¨åˆ†æ°å·§å°±æ˜¯pçš„ç†µï¼Œç­‰å¼çš„åä¸€éƒ¨åˆ†ï¼Œå°±æ˜¯äº¤å‰ç†µï¼š \\begin{eqnarray} =& -H(p(x))+[-\\sum\\_{i=1}^np(x\\_i)log(q(x\\_i))] \\end{eqnarray}åœ¨æœºå™¨å­¦ä¹ ä¸­ï¼Œæˆ‘ä»¬éœ€è¦è¯„ä¼°labelå’Œpredictsä¹‹é—´çš„å·®è·ï¼Œä½¿ç”¨KLæ•£åº¦åˆšåˆšå¥½ï¼Œå³ $D_{KL}(y||\\hat{y})$ . ç”±äºKLæ•£åº¦ä¸­çš„å‰ä¸€éƒ¨åˆ† $-H(y)$ ä¸å˜ï¼Œæ•…åœ¨ä¼˜åŒ–è¿‡ç¨‹ä¸­ï¼Œåªéœ€è¦å…³æ³¨ Cross Entropy å°±å¯ä»¥äº†ã€‚ æ‰€ä»¥ä¸€èˆ¬åœ¨æœºå™¨å­¦ä¹ ä¸­ç›´æ¥ç”¨ç”¨ Cross Entropy Lossï¼Œè¯„ä¼°æ¨¡å‹ã€‚ $D_{KL}$ çš„å€¼è¶Šå°ï¼Œè¡¨ç¤º qåˆ†å¸ƒ å’Œ påˆ†å¸ƒ è¶Šæ¥è¿‘. ä¸€æ–‡ææ‡‚äº¤å‰ç†µåœ¨æœºå™¨å­¦ä¹ ä¸­çš„ä½¿ç”¨ äº¤å‰ç†µåœ¨å¤šåˆ†ç±»é—®é¢˜ä¸­çš„ä½¿ç”¨, sigmoid 1ï¼‰CrossEntropy lossFunction äºŒåˆ†ç±»: æ„ä¹‰ï¼šèƒ½è¡¨å¾ çœŸå®æ ·æœ¬æ ‡ç­¾ å’Œ é¢„æµ‹æ¦‚ç‡ ä¹‹é—´çš„å·®å€¼ 2ï¼‰æœ€å°åŒ–äº¤å‰ç†µçš„æœ¬è´¨å°±æ˜¯å¯¹æ•°ä¼¼ç„¶å‡½æ•°çš„æœ€å¤§åŒ–ï¼› 3ï¼‰å¯¹æ•°ä¼¼ç„¶å‡½æ•°çš„æœ¬è´¨å°±æ˜¯è¡¡é‡åœ¨æŸä¸ªå‚æ•°ä¸‹ï¼Œæ•´ä½“çš„ä¼°è®¡å’ŒçœŸå®æƒ…å†µä¸€æ ·çš„æ¦‚ç‡ï¼Œè¶Šå¤§ä»£è¡¨è¶Šç›¸è¿‘ï¼› 4ï¼‰æŸå¤±å‡½æ•°çš„æœ¬è´¨å°±æ˜¯è¡¡é‡é¢„æµ‹å€¼å’ŒçœŸå®å€¼ä¹‹é—´çš„å·®è·ï¼Œè¶Šå¤§ä»£è¡¨è¶Šä¸ç›¸è¿‘ã€‚ 4.1 Log è®¾è®¡ç†å¿µé¢„æµ‹è¾“å‡ºä¸ y å·®å¾—è¶Šå¤šï¼ŒL çš„å€¼è¶Šå¤§ï¼Œä¹Ÿå°±æ˜¯è¯´å¯¹å½“å‰æ¨¡å‹çš„ â€œ æƒ©ç½š â€ è¶Šå¤§ï¼Œè€Œä¸”æ˜¯éçº¿æ€§å¢å¤§ï¼Œæ˜¯ä¸€ç§ç±»ä¼¼æŒ‡æ•°å¢é•¿çš„çº§åˆ«ã€‚è¿™æ˜¯ç”± log å‡½æ•°æœ¬èº«çš„ç‰¹æ€§æ‰€å†³å®šçš„ã€‚è¿™æ ·çš„å¥½å¤„æ˜¯ æ¨¡å‹ä¼šå€¾å‘äºè®©é¢„æµ‹è¾“å‡ºæ›´æ¥è¿‘çœŸå®æ ·æœ¬æ ‡ç­¾ yã€‚ æˆ‘ä»¬å¸Œæœ› log P(y|x) è¶Šå¤§è¶Šå¥½ï¼Œåè¿‡æ¥ï¼Œåªè¦ log P(y|x) çš„è´Ÿå€¼ -log P(y|x) è¶Šå°å°±è¡Œäº†ã€‚é‚£æˆ‘ä»¬å°±å¯ä»¥å¼•å…¥æŸå¤±å‡½æ•°ï¼Œä¸”ä»¤ Loss = -log P(y|x)å³å¯ã€‚åˆ™å¾—åˆ°æŸå¤±å‡½æ•°ä¸ºï¼š å›¾å¯ä»¥å¸®åŠ©æˆ‘ä»¬å¯¹ CrossEntropy lossFunction æœ‰æ›´ç›´è§‚çš„ç†è§£ã€‚æ— è®ºçœŸå®æ ·æœ¬æ ‡ç­¾ y æ˜¯ 0 è¿˜æ˜¯ 1ï¼ŒL éƒ½è¡¨å¾äº†é¢„æµ‹è¾“å‡ºä¸ y çš„å·®è·ã€‚ 4.2 MLE æœ€å¤§ä¼¼ç„¶å°±æ˜¯åˆ©ç”¨å·²çŸ¥çš„æ ·æœ¬ç»“æœä¿¡æ¯ï¼Œåæ¨æœ€å…·æœ‰å¯èƒ½ï¼ˆæœ€å¤§æ¦‚ç‡ï¼‰å¯¼è‡´è¿™äº›æ ·æœ¬ç»“æœå‡ºç°çš„ æ¨¡å‹å‚æ•°å€¼ï¼ è¾“å…¥æœ‰ä¸¤ä¸ªï¼š$x$ è¡¨ç¤ºæŸä¸€ä¸ªå…·ä½“çš„æ•°æ®ï¼›$Î¸$ è¡¨ç¤ºæ¨¡å‹çš„å‚æ•°ã€‚ Probability Functionï¼š å¯¹äºè¿™ä¸ªå‡½æ•°ï¼š $P(x|Î¸)$ ï¼Œ å¦‚æœ $Î¸$ æ˜¯å·²çŸ¥ç¡®å®šçš„ï¼Œ$x$ æ˜¯å˜é‡ï¼Œè¿™ä¸ªå‡½æ•°å«åšæ¦‚ç‡å‡½æ•° (probability function)ï¼Œå®ƒæè¿°å¯¹äºä¸åŒçš„æ ·æœ¬ç‚¹ $x$ï¼Œå…¶å‡ºç°æ¦‚ç‡æ˜¯å¤šå°‘ã€‚ Likelihood Functionï¼š å¦‚æœ $x$ æ˜¯å·²çŸ¥ç¡®å®šçš„ï¼Œ$Î¸$ æ˜¯å˜é‡ï¼Œè¿™ä¸ªå‡½æ•°å«åšä¼¼ç„¶å‡½æ•°(likelihood function), å®ƒæè¿°å¯¹äºä¸åŒçš„æ¨¡å‹å‚æ•°ï¼Œå‡ºç° $x$ è¿™ä¸ªæ ·æœ¬ç‚¹çš„æ¦‚ç‡æ˜¯å¤šå°‘ã€‚ MLE æä¾›äº†ä¸€ç§ ç»™å®šè§‚å¯Ÿæ•°æ®æ¥è¯„ä¼°æ¨¡å‹å‚æ•° çš„æ–¹æ³•ï¼Œå³ï¼šâ€œæ¨¡å‹å·²å®šï¼Œå‚æ•°æœªçŸ¥â€ã€‚ MLE ä¸­ é‡‡æ · éœ€æ»¡è¶³ä¸€ä¸ªé‡è¦çš„å‡è®¾ï¼Œå°±æ˜¯æ‰€æœ‰çš„é‡‡æ ·éƒ½æ˜¯ ç‹¬ç«‹åŒåˆ†å¸ƒ çš„. ä¸€å¥è¯æ€»ç»“ï¼šæ¦‚ç‡æ˜¯å·²çŸ¥æ¨¡å‹å’Œå‚æ•°ï¼Œæ¨æ•°æ®ã€‚ç»Ÿè®¡æ˜¯å·²çŸ¥æ•°æ®ï¼Œæ¨æ¨¡å‹å’Œå‚æ•°ã€‚ 5. æœ€å°äºŒä¹˜æ³• vs æœ€å¤§ä¼¼ç„¶ä¼°è®¡æ€»ç»“ä¸€å¥è¯ï¼š æœ€å°äºŒä¹˜æ³•çš„æ ¸å¿ƒæ˜¯æƒè¡¡ï¼Œå› ä¸ºä½ è¦åœ¨å¾ˆå¤šæ¡çº¿ä¸­é—´é€‰æ‹©ï¼Œé€‰æ‹©å‡ºè·ç¦»æ‰€æœ‰çš„ç‚¹ä¹‹å’Œæœ€çŸ­çš„ï¼› è€Œæå¤§ä¼¼ç„¶çš„æ ¸å¿ƒæ˜¯è‡ªæ‹ï¼Œè¦ç›¸ä¿¡è‡ªå·±æ˜¯å¤©é€‰ä¹‹å­ï¼Œè‡ªå·±çœ‹åˆ°çš„ï¼Œå°±æ˜¯å†¥å†¥ä¹‹ä¸­æœ€æ¥è¿‘çœŸç›¸çš„ã€‚^_^ Reference é€»è¾‘å›å½’ï¼ˆLogistic Regressionï¼‰ï¼ˆä¸€ï¼‰ å¹¿ä¹‰çº¿æ€§æ¨¡å‹ï¼ˆGeneralized Linear Modelï¼‰ GLM(å¹¿ä¹‰çº¿æ€§æ¨¡å‹) ä¸ LR(é€»è¾‘å›å½’) è¯¦è§£ æ€æ ·ç”¨é€šä¿—æ˜“æ‡‚çš„æ–‡å­—è§£é‡Šæ­£æ€åˆ†å¸ƒåŠå…¶æ„ä¹‰ï¼Ÿ æœ€å¤§ä¼¼ç„¶ä¼°è®¡å’Œæœ€å°äºŒä¹˜æ³•æ€ä¹ˆç†è§£ï¼Ÿ çŸ¥ä¹ï¼šä¸€æ–‡ææ‡‚æå¤§ä¼¼ç„¶ä¼°è®¡ CSDNï¼šè¯¦è§£æœ€å¤§ä¼¼ç„¶ä¼°è®¡ï¼ˆMLEï¼‰ã€æœ€å¤§åéªŒæ¦‚ç‡ä¼°è®¡ï¼ˆMAPï¼‰ï¼Œä»¥åŠè´å¶æ–¯å…¬å¼çš„ç†è§£ ä¸€æ–‡ææ‡‚äº¤å‰ç†µåœ¨æœºå™¨å­¦ä¹ ä¸­çš„ä½¿ç”¨ï¼Œé€å½»ç†è§£äº¤å‰ç†µèƒŒåçš„ç›´è§‰","categories":[{"name":"machine-learning","slug":"machine-learning","permalink":"http://iequa.com/categories/machine-learning/"}],"tags":[{"name":"Logistic_Regression","slug":"Logistic-Regression","permalink":"http://iequa.com/tags/Logistic-Regression/"}]},{"title":"Dimensionality Reductionï¼š PCA","slug":"ml/PCA","date":"2019-04-21T09:01:21.000Z","updated":"2019-10-20T04:30:35.038Z","comments":true,"path":"2019/04/21/ml/PCA/","link":"","permalink":"http://iequa.com/2019/04/21/ml/PCA/","excerpt":"","text":"å¸¸è§çš„ Dimensionality Reduction æ–¹æ³•ï¼š PCAã€LDA ç­‰ã€‚ PCAä¸»æˆåˆ†åˆ†æ Machine Learning ä¸­çš„æ•°æ®ç»´æ•° ä¸ ç°å®ä¸–ç•Œä¸­çš„ç©ºé—´ç»´åº¦æœ¬åŒæœ«ç¦»ã€‚åœ¨ Machine Learning ä¸­ï¼Œæ•°æ®é€šå¸¸éœ€è¦è¢«è¡¨ç¤ºæˆå‘é‡å½¢å¼ä»¥è¾“å…¥æ¨¡å‹è¿›è¡Œè®­ç»ƒã€‚ç”¨ä¸€ä¸ª ä½ç»´åº¦çš„å‘é‡ è¡¨ç¤ºåŸå§‹ é«˜çº¬åº¦çš„ç‰¹å¾ æ˜¾å¾—å°¤ä¸ºé‡è¦ã€‚ é™ç»´çš„å¥½å¤„å¾ˆæ˜æ˜¾ï¼Œå®ƒä¸ä»…å¯ä»¥æ•°æ®å‡å°‘å¯¹å†…å­˜çš„å ç”¨ï¼Œè€Œä¸”è¿˜å¯ä»¥åŠ å¿«å­¦ä¹ ç®—æ³•çš„æ‰§è¡Œ PCA æ˜¯ä¸€ç§ç»å…¸çš„é™ç»´æ–¹æ³•ï¼Œæ˜¯ä¸€ç§çº¿æ€§ã€éç›‘ç£ã€å…¨å±€çš„é™ç»´æ–¹æ³•ï¼Œæ˜¯é¢è¯•å¸¸è§é—®é¢˜. 1. Motivationå¦‚æœæˆ‘ä»¬æœ‰è®¸å¤šå†—ä½™çš„æ•°æ®ï¼Œæˆ‘ä»¬å¯èƒ½éœ€è¦å¯¹ç‰¹å¾é‡è¿›è¡Œé™ç»´(Dimensionality Reduction) 1.1 Data Compression å¦‚å›¾10-2æ‰€ç¤ºçš„3ç»´åˆ°2ç»´çš„ä¾‹å­ï¼Œé€šè¿‡å¯¹x1,x2,x3çš„å¯è§†åŒ–ï¼Œå‘ç°è™½ç„¶æ ·æœ¬å¤„äº3ç»´ç©ºé—´ï¼Œä½†æ˜¯ä»–ä»¬å¤§å¤šæ•°éƒ½åˆ†å¸ƒåœ¨åŒä¸€ä¸ªå¹³é¢ä¸­ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥é€šè¿‡æŠ•å½±ï¼Œå°†3ç»´é™ä¸º2ç»´ã€‚ 1.2 Visualizationç‰¹å¾é‡ç»´æ•°å¤§äº3æ—¶ï¼Œæˆ‘ä»¬å‡ ä¹ä¸èƒ½å¯¹æ•°æ®è¿›è¡Œå¯è§†åŒ–ã€‚æ‰€ä»¥ï¼Œæœ‰æ—¶ä¸ºäº†å¯¹æ•°æ®è¿›è¡Œå¯è§†åŒ–ï¼Œæˆ‘ä»¬éœ€è¦å¯¹å…¶è¿›è¡Œé™ç»´ã€‚æˆ‘ä»¬å¯ä»¥æ‰¾åˆ°2ä¸ªæˆ–3ä¸ªå…·æœ‰ä»£è¡¨æ€§çš„ç‰¹å¾é‡ï¼Œä»–ä»¬(å¤§è‡´)å¯ä»¥æ¦‚æ‹¬å…¶ä»–çš„ç‰¹å¾é‡ã€‚ ä¾‹å¦‚ï¼Œæè¿°ä¸€ä¸ªå›½å®¶æœ‰å¾ˆå¤šç‰¹å¾é‡ï¼Œæ¯”å¦‚GDPï¼Œäººå‡GDPï¼Œäººå‡å¯¿å‘½ï¼Œå¹³å‡å®¶åº­æ”¶å…¥ç­‰ç­‰ã€‚ 2. Principal Component Analysisä¸»æˆåˆ†åˆ†æ(Principal Component Analysis : PCA)æ˜¯æœ€å¸¸ç”¨çš„é™ç»´ç®—æ³•ã€‚ 2.1 Problem formulationé¦–å…ˆæˆ‘ä»¬æ€è€ƒå¦‚ä¸‹é—®é¢˜ï¼Œå¯¹äºæ­£äº¤å±æ€§ç©ºé—´(å¯¹2ç»´ç©ºé—´å³ä¸ºç›´è§’åæ ‡ç³»)ä¸­çš„æ ·æœ¬ç‚¹ï¼Œå¦‚ä½•ç”¨ä¸€ä¸ªè¶…å¹³é¢(ç›´çº¿/å¹³é¢çš„é«˜ç»´æ¨å¹¿)å¯¹æ‰€æœ‰æ ·æœ¬è¿›è¡Œæ°å½“çš„è¡¨è¾¾ï¼Ÿ äº‹å®ä¸Šï¼Œè‹¥å­˜åœ¨è¿™æ ·çš„è¶…å¹³é¢ï¼Œé‚£ä¹ˆå®ƒå¤§æ¦‚åº”å…·æœ‰è¿™æ ·çš„æ€§è´¨ï¼š æœ€è¿‘é‡æ„æ€§ : æ ·æœ¬ç‚¹åˆ°è¿™ä¸ªè¶…å¹³é¢çš„è·ç¦»éƒ½è¶³å¤Ÿè¿‘ï¼› æœ€å¤§å¯åˆ†æ€§ : æ ·æœ¬ç‚¹åœ¨è¿™ä¸ªè¶…å¹³é¢ä¸Šçš„æŠ•å½±èƒ½å°½å¯èƒ½åˆ†å¼€ã€‚ å¯¹å½“å‰æ ·æœ¬è€Œè¨€ï¼Œs1å¹³é¢æ¯”s2å¹³é¢çš„æœ€è¿‘é‡æ„æ€§è¦å¥½ï¼ˆæ ·æœ¬ç¦»å¹³é¢çš„è·ç¦»æ›´è¿‘ï¼‰ï¼› å¯¹å½“å‰æ ·æœ¬è€Œè¨€ï¼Œs1å¹³é¢(å·¦è¾¹) æ¯”s2å¹³é¢çš„æœ€å¤§å¯åˆ†æ€§è¦å¥½(æ ·æœ¬ç‚¹æ›´åˆ†æ•£)ã€‚ æ€»ç»“: è®©ä¸Šé¢çš„ä¾‹å­ä¹Ÿè¯´æ˜äº† æœ€è¿‘é‡æ„æ€§ å’Œ æœ€å¤§å¯åˆ†æ€§ å¯ä»¥åŒæ—¶æ»¡è¶³ã€‚åˆ†åˆ«ä»¥æœ€è¿‘é‡æ„æ€§å’Œæœ€å¤§å¯åˆ†æ€§ä¸ºç›®æ ‡ï¼Œèƒ½å¤Ÿå¾—åˆ° PCA çš„ä¸¤ç§ç­‰ä»·æ¨å¯¼ã€‚ ä¸¢å¤±ä¿¡æ¯å¯¹æ¯”ï¼š s2å¹³é¢ è¿›è¡ŒæŠ•å½±é™ç»´ï¼Œæˆ‘ä»¬ä¼šä¸¢å¤±æ›´å¤šï¼ˆç›¸å½“å¤šï¼‰çš„ç‰¹å¾é‡ä¿¡æ¯ï¼Œå› ä¸ºå®ƒçš„æŠ•å½±ç»“æœç”šè‡³å¯ä»¥åœ¨è½¬åŒ–ä¸º1ç»´ã€‚ è€Œ s1å¹³é¢ ä¸Šçš„æŠ•å½±åŒ…å«æ›´å¤šçš„ä¿¡æ¯(ä¸¢å¤±çš„æ›´å°‘)ã€‚ å°†ç‰¹å¾é‡ä»nç»´é™åˆ°kç»´ï¼š ä»¥æœ€è¿‘é‡æ„æ€§ä¸ºç›®æ ‡ï¼ŒPCAçš„ç›®æ ‡æ˜¯æ‰¾åˆ°kä¸ªå‘é‡ï¼Œå°†æ‰€æœ‰æ ·æœ¬æŠ•å½±åˆ°è¿™kä¸ªå‘é‡æ„æˆçš„è¶…å¹³é¢ï¼Œä½¿å¾—æŠ•å½±çš„è·ç¦»æœ€å°ï¼ˆæˆ–è€…è¯´æŠ•å½±è¯¯å·®projection erroræœ€å°ï¼‰ã€‚ ä»¥æœ€å¤§å¯åˆ†æ€§ä¸ºç›®æ ‡ï¼ŒPCAçš„ç›®æ ‡æ˜¯æ‰¾åˆ°kä¸ªå‘é‡ï¼Œå°†æ‰€æœ‰æ ·æœ¬æŠ•å½±åˆ°è¿™kä¸ªå‘é‡æ„æˆçš„è¶…å¹³é¢ï¼Œä½¿å¾—æ ·æœ¬ç‚¹çš„æŠ•å½±èƒ½å¤Ÿå°½å¯èƒ½çš„åˆ†å¼€ï¼Œä¹Ÿå°±æ˜¯ä½¿æŠ•å½±åçš„æ ·æœ¬ç‚¹æ–¹å·®æœ€å¤§åŒ–ã€‚ æ‘˜è¦ï¼š PCA ä¸ çº¿æ€§å›å½’ æœ‰ä¸€ç‚¹ç›¸ä¼¼ï¼Œä½†æ˜¯ä»–ä»¬æ˜¯2ç§ä¸åŒçš„ç®—æ³•. good CSDN ä¸»æˆåˆ†åˆ†æPCAä¹‹åæ–¹å·®çŸ©é˜µçš„ç†è§£ çŸ¥ä¹: å¦‚ä½•ç›´è§‚åœ°ç†è§£ã€Œåæ–¹å·®çŸ©é˜µã€ï¼Ÿ PCAä¸ºä»€ä¹ˆè¦ç”¨åæ–¹å·®çŸ©é˜µï¼Ÿ çº¿æ€§é™ç»´æ–¹æ³•ï¼ˆä»£ç ç¯‡ï¼‰| æœºå™¨å­¦ä¹ ä½ ä¼šé‡åˆ°çš„â€œå‘â€ ä¸»æˆåˆ†åˆ†æï¼ˆPCAï¼‰åŸç†æ€»ç»“ åˆ˜å»ºå¹³Pinard ç”¨scikit-learnå­¦ä¹ ä¸»æˆåˆ†åˆ†æ(PCA) PCAä¸ºä»€ä¹ˆè¦ç”¨åæ–¹å·®çŸ©é˜µçš„ç‰¹å¾å‘é‡çŸ©é˜µæ¥åšæŠ•å½±çŸ©é˜µå‘¢ï¼Ÿä¸ºç¥é©¬å•Šä¸ºç¥é©¬ï¼Ÿ é™ç»´çš„ç›®çš„å°±æ˜¯â€œé™å™ªâ€å’Œâ€œå»å†—ä½™â€ã€‚â€œé™å™ªâ€çš„ç›®çš„å°±æ˜¯ä½¿ä¿ç•™ä¸‹æ¥çš„ç»´åº¦é—´çš„ç›¸å…³æ€§å°½å¯èƒ½å°ï¼Œè€Œâ€œå»å†—ä½™â€çš„ç›®çš„å°±æ˜¯ä½¿ä¿ç•™ä¸‹æ¥çš„ç»´åº¦å«æœ‰çš„â€œèƒ½é‡â€å³æ–¹å·®å°½å¯èƒ½å¤§ã€‚é‚£é¦–å…ˆçš„é¦–å…ˆï¼Œæˆ‘ä»¬å¾—éœ€è¦çŸ¥é“å„ç»´åº¦é—´çš„ç›¸å…³æ€§ä»¥åŠä¸ªç»´åº¦ä¸Šçš„æ–¹å·®å•Šï¼é‚£æœ‰ä»€ä¹ˆæ•°æ®ç»“æ„èƒ½åŒæ—¶è¡¨ç°ä¸åŒç»´åº¦é—´çš„ç›¸å…³æ€§ä»¥åŠå„ä¸ªç»´åº¦ä¸Šçš„æ–¹å·®å‘¢ï¼Ÿè‡ªç„¶æ˜¯åæ–¹å·®çŸ©é˜µï¼ åæ–¹å·®çŸ©é˜µåº¦é‡çš„æ˜¯ç»´åº¦ä¸ç»´åº¦ä¹‹é—´çš„å…³ç³»ï¼Œè€Œéæ ·æœ¬ä¸æ ·æœ¬ä¹‹é—´ã€‚åæ–¹å·®çŸ©é˜µçš„ä¸»å¯¹è§’çº¿ä¸Šçš„å…ƒç´ æ˜¯å„ä¸ªç»´åº¦ä¸Šçš„æ–¹å·®(å³èƒ½é‡)ï¼Œå…¶ä»–å…ƒç´ æ˜¯ä¸¤ä¸¤ç»´åº¦é—´çš„åæ–¹å·®(å³ç›¸å…³æ€§)ã€‚æˆ‘ä»¬è¦çš„ä¸œè¥¿åæ–¹å·®çŸ©é˜µéƒ½æœ‰äº†ï¼Œå…ˆæ¥çœ‹â€œé™å™ªâ€ï¼Œè®©ä¿ç•™ä¸‹çš„ä¸åŒç»´åº¦é—´çš„ç›¸å…³æ€§å°½å¯èƒ½å°ï¼Œä¹Ÿå°±æ˜¯è¯´è®©åæ–¹å·®çŸ©é˜µä¸­éå¯¹è§’çº¿å…ƒç´ éƒ½åŸºæœ¬ä¸ºé›¶ã€‚è¾¾åˆ°è¿™ä¸ªç›®çš„çš„æ–¹å¼è‡ªç„¶ä¸ç”¨è¯´ï¼Œçº¿ä»£ä¸­å¥–çš„å¾ˆæ˜ç¡®â€”â€”çŸ©é˜µå¯¹è§’åŒ–ã€‚ æ–¹å·®æ˜¯ç”¨æ¥åº¦é‡å•ä¸ªéšæœºå˜é‡çš„ç¦»æ•£ç¨‹åº¦ï¼Œè€Œåæ–¹å·®åˆ™ä¸€èˆ¬ç”¨æ¥åˆ»ç”»ä¸¤ä¸ªéšæœºå˜é‡çš„ç›¸ä¼¼ç¨‹åº¦. 2.2 PCA Algorithmè¾“å…¥ï¼š è®­ç»ƒé›† $x^{(1)}, x^{(2)}, â€¦, x^{(m)}$ å’Œ ä½ç»´ç©ºé—´ç»´æ•° $k$ è¿‡ç¨‹ï¼š (1) æ•°æ®é¢„å¤„ç†ï¼šå¯¹æ‰€æœ‰æ ·æœ¬è¿›è¡Œä¸­å¿ƒåŒ–(å³ä½¿å¾—æ ·æœ¬å’Œä¸º0) (2) è®¡ç®—æ ·æœ¬çš„åæ–¹å·®çŸ©é˜µ (3) å¯¹2ä¸­æ±‚å¾—çš„åæ–¹å·®çŸ©é˜µSigmaè¿›è¡Œç‰¹å¾å€¼åˆ†è§£ &nbsp;&nbsp;&nbsp;&nbsp;åœ¨å®è·µä¸­é€šå¸¸å¯¹åæ–¹å·®çŸ©é˜µè¿›è¡Œ SVDåˆ†è§£ ä»£æ›¿ ç‰¹å¾å€¼åˆ†è§£. [U, S, V] = svd(Sigma);(4) å–æœ€å¤§çš„kä¸ªç‰¹å¾å€¼æ‰€å¯¹åº”çš„ç‰¹å¾å‘é‡ $u^{(1)}, u^{(2)}, â€¦, u^{(k)}$ 2.3 Choosing the Number of Principal Componentså¦‚ä½•é€‰æ‹©kï¼ˆåˆç§°ä¸ºä¸»æˆåˆ†çš„ä¸ªæ•°ï¼‰çš„å€¼ï¼Ÿ é¦–å…ˆï¼Œè¯•æƒ³æˆ‘ä»¬å¯ä»¥ä½¿ç”¨PCAæ¥å‹ç¼©æ•°æ®ï¼Œæˆ‘ä»¬åº”è¯¥å¦‚ä½•è§£å‹ï¼Ÿæˆ–è€…è¯´å¦‚ä½•å›åˆ°åŸæœ¬çš„æ ·æœ¬å€¼ï¼Ÿäº‹å®ä¸Šæˆ‘ä»¬å¯ä»¥åˆ©ç”¨ä¸‹åˆ—ç­‰å¼è®¡ç®—å‡ºåŸå§‹æ•°æ®çš„è¿‘ä¼¼å€¼Xapproxï¼š 2.4 Advice for Applying PCA PCA é€šå¸¸ç”¨æ¥åŠ å¿«ç›‘ç£å­¦ä¹ ç®—æ³•. PCA åº”è¯¥åªæ˜¯é€šè¿‡ è®­ç»ƒé›†çš„ç‰¹å¾é‡ æ¥è·å– æŠ•å½±çŸ©é˜µ Ureduceï¼Œè€Œä¸æ˜¯äº¤å‰æ£€éªŒé›†æˆ–æµ‹è¯•é›†ã€‚&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ä½†æ˜¯è·å–åˆ° Ureduce ä¹‹åå¯ä»¥åº”ç”¨åœ¨äº¤å‰æ£€éªŒé›†å’Œæµ‹è¯•é›†ã€‚ é¿å…ä½¿ç”¨ PCA æ¥é˜²æ­¢ overfitingï¼ŒPCA åªæ˜¯å¯¹ ç‰¹å¾ $X$ è¿›è¡Œé™ç»´ï¼Œå¹¶æ²¡æœ‰è€ƒè™‘ $Y$ çš„å€¼ï¼› ä¸åº”åœ¨é¡¹ç›®å¼€å§‹å°±ç”¨PCA: èŠ±å¤§é‡æ—¶é—´æ¥é€‰æ‹©kå€¼ï¼Œå¯èƒ½é¡¹ç›®å¹¶ä¸éœ€ç”¨PCAæ¥é™ç»´ã€‚åŒæ—¶é™ç»´å®šä¼šä¸¢å¤±ä¸€äº›ä¿¡æ¯ã€‚ ä»…åœ¨éœ€ç”¨ PCA çš„æ—¶ä½¿ç”¨ PCA: é™ç»´ä¸¢å¤±çš„ä¿¡æ¯å¯èƒ½åœ¨ä¸€å®šç¨‹åº¦ä¸Šæ˜¯å™ªå£°ï¼Œä½¿ç”¨ PCA å¯ä»¥èµ·åˆ°ä¸€å®šçš„å»å™ªæ•ˆæœã€‚ PCA é€šå¸¸ç”¨æ¥ Data Compression ä»¥åŠ å¿«ç®—æ³•ï¼Œå‡å°‘å†…å­˜ä½¿ç”¨æˆ–ç£ç›˜å ç”¨ï¼Œæˆ–è€…ç”¨äºå¯è§†åŒ–(k=2, 3)ã€‚ Reference article ç™¾é¢æœºå™¨å­¦ä¹  Stanford Machine Learning ç½‘æ˜“äº‘è¯¾å ‚","categories":[{"name":"machine-learning","slug":"machine-learning","permalink":"http://iequa.com/categories/machine-learning/"}],"tags":[{"name":"PCA","slug":"PCA","permalink":"http://iequa.com/tags/PCA/"}]},{"title":"FastText ç”¨äºé«˜æ•ˆæ–‡æœ¬åˆ†ç±»çš„æŠ€å·§","slug":"nlp/fastText","date":"2018-12-18T23:00:21.000Z","updated":"2019-10-20T04:30:35.066Z","comments":true,"path":"2018/12/19/nlp/fastText/","link":"","permalink":"http://iequa.com/2018/12/19/nlp/fastText/","excerpt":"","text":"fasttext word2vec fastText æ˜¯ 2016å¹´ FAIR(Facebook AIResearch) æ¨å‡ºçš„ä¸€æ¬¾æ–‡æœ¬åˆ†ç±»ä¸å‘é‡åŒ–å·¥å…·ã€‚ fastText æ˜¯ æ™ºæ…§ä¸ç¾è²Œå¹¶é‡çš„ æ–‡æœ¬åˆ†ç±» and å‘é‡åŒ–å·¥å…· çš„é¡¹ç›®ï¼Œå®ƒæ˜¯æœ‰ä¸¤éƒ¨åˆ†ç»„æˆçš„ã€‚ è®ºæ–‡1é“¾æ¥ï¼š Bag of Tricks for Efficient Text Classification è®ºæ–‡2é“¾æ¥ï¼š Enriching Word Vectors with Subword Information githubé“¾æ¥ï¼š facebookresearch/fastText fastText èƒ½å¤Ÿåšåˆ°æ•ˆæœå¥½ï¼Œé€Ÿåº¦å¿«ï¼Œä¸»è¦ä¾é ä¸¤ä¸ªç§˜å¯†æ­¦å™¨ï¼š åˆ©ç”¨äº†è¯å†…çš„n-gramä¿¡æ¯(subword n-gram information) ç”¨åˆ°äº†å±‚æ¬¡åŒ–Softmaxå›å½’(Hierarchical Softmax) çš„è®­ç»ƒ trick. fastText èƒŒæ™¯ è‹±è¯­å•è¯é€šå¸¸æœ‰å…¶å†…éƒ¨ç»“æ„å’Œå½¢æˆæ–¹å¼ã€‚ä¾‹å¦‚æˆ‘ä»¬å¯ä»¥ä»â€œdogâ€ã€â€œdogsâ€å’Œâ€œdogcatcherâ€çš„å­—é¢ä¸Šæ¨æµ‹ä»–ä»¬çš„å…³ç³»ã€‚è¿™äº›è¯éƒ½æœ‰åŒä¸€ä¸ªè¯æ ¹â€œdogâ€ï¼Œè¿™ä¸ªå…³è”å¯ä»¥æ¨å¹¿è‡³å…¶ä»–è¯æ±‡ã€‚ä¾‹å¦‚ï¼Œâ€œdogâ€å’Œâ€œdogsâ€çš„å…³ç³»å¦‚åŒâ€œcatâ€å’Œâ€œcatsâ€çš„å…³ç³»ï¼Œâ€œboyâ€å’Œâ€œboyfriendâ€çš„å…³ç³»å¦‚åŒâ€œgirlâ€å’Œâ€œgirlfriendâ€çš„å…³ç³»ã€‚å¾ˆå¤šè¯æ ¹æ®åœºæ™¯ä¸åŒæœ‰å¤šç§ä¸åŒçš„å½¢æ€ã€‚æ„è¯å­¦ï¼ˆmorphologyï¼‰ä½œä¸ºè¯­è¨€å­¦çš„ä¸€ä¸ªé‡è¦åˆ†æ”¯ï¼Œç ”ç©¶çš„æ­£æ˜¯è¯çš„å†…éƒ¨ç»“æ„å’Œå½¢æˆæ–¹å¼ã€‚ åœ¨ word2vec ä¸­ï¼Œæˆ‘ä»¬å¹¶æ²¡æœ‰ç›´æ¥åˆ©ç”¨æ„è¯å­¦ä¸­çš„ä¿¡æ¯ã€‚æ— è®ºæ˜¯åœ¨ skip-gram è¿˜æ˜¯ CBOW ä¸­ï¼Œæˆ‘ä»¬å°†å½¢æ€ä¸åŒçš„å•è¯ç”¨ä¸åŒçš„å‘é‡æ¥è¡¨ç¤ºã€‚ä¾‹å¦‚ï¼Œâ€œdogâ€å’Œâ€œdogsâ€åˆ†åˆ«ç”¨ä¸¤ä¸ªä¸åŒçš„å‘é‡è¡¨ç¤ºï¼Œè€Œæ¨¡å‹ä¸­å¹¶æœªç›´æ¥è¡¨è¾¾è¿™ä¸¤ä¸ªå‘é‡ä¹‹é—´çš„å…³ç³»ã€‚æœ‰é‰´äºæ­¤ï¼ŒfastText æå‡ºäº†å­è¯åµŒå…¥ï¼ˆsubword embeddingï¼‰çš„æ–¹æ³•ï¼Œä»è€Œè¯•å›¾å°†æ„è¯ä¿¡æ¯å¼•å…¥ word2vec ä¸­çš„ skip-gramã€‚ å­è¯åµŒå…¥ subword embedding åœ¨ fastText ä¸­ï¼Œæ¯ä¸ªä¸­å¿ƒè¯è¢«è¡¨ç¤ºæˆå­è¯çš„é›†åˆã€‚ä¸‹é¢æˆ‘ä»¬ç”¨å•è¯â€œwhereâ€ä½œä¸ºä¾‹å­æ¥äº†è§£å­è¯æ˜¯å¦‚ä½•äº§ç”Ÿçš„ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬åœ¨å•è¯çš„é¦–å°¾åˆ†åˆ«æ·»åŠ ç‰¹æ®Šå­—ç¬¦â€œ&lt;â€å’Œâ€œ&gt;â€ä»¥åŒºåˆ†ä½œä¸ºå‰åç¼€çš„å­è¯ã€‚ç„¶åï¼Œå°†å•è¯å½“æˆä¸€ä¸ªç”±å­—ç¬¦æ„æˆçš„åºåˆ—æ¥æå– $n$ å…ƒè¯­æ³•ã€‚ä¾‹å¦‚å½“ $n=3$ æ—¶ï¼Œæˆ‘ä»¬å¾—åˆ°æ‰€æœ‰é•¿åº¦ä¸º 3 çš„å­è¯ï¼š ä»¥åŠç‰¹æ®Šå­è¯ â€œ&lt;.where&gt;â€ã€‚ åœ¨ fastText ä¸­ï¼Œå¯¹äºä¸€ä¸ªè¯ $w$ï¼Œå°†å®ƒæ‰€æœ‰é•¿åº¦åœ¨ 3 åˆ° 6 çš„å­è¯å’Œç‰¹æ®Šå­è¯çš„å¹¶é›†è®°ä¸º $\\mathcal{G}_w$ã€‚é‚£ä¹ˆè¯å…¸åˆ™æ˜¯æ‰€æœ‰è¯çš„å­è¯é›†åˆçš„å¹¶é›†ã€‚å‡è®¾è¯å…¸ä¸­å­è¯ $g$ çš„å‘é‡ä¸º $\\boldsymbol{z}_g$ï¼Œé‚£ä¹ˆè·³å­—æ¨¡å‹ä¸­è¯ $w$ çš„ä½œä¸ºä¸­å¿ƒè¯çš„å‘é‡ $\\boldsymbol{v}_w$ åˆ™è¡¨ç¤ºæˆ \\boldsymbol{v}\\_w = \\sum\\_{g\\in\\mathcal{G}\\_w} \\boldsymbol{z}\\_g.FastText çš„å…¶ä½™éƒ¨åˆ†åŒ skip-gram ä¸€è‡´ï¼Œä¸åœ¨æ­¤é‡å¤ã€‚å¯ä»¥çœ‹åˆ°ï¼ŒåŒ skip-gram ç›¸æ¯”ï¼ŒfastText ä¸­è¯å…¸è§„æ¨¡æ›´å¤§ï¼Œé€ æˆæ¨¡å‹å‚æ•°æ›´å¤šï¼ŒåŒæ—¶ä¸€ä¸ªè¯çš„å‘é‡éœ€è¦å¯¹æ‰€æœ‰å­è¯å‘é‡æ±‚å’Œï¼Œç»§è€Œå¯¼è‡´è®¡ç®—å¤æ‚åº¦æ›´é«˜ã€‚ä½†ä¸æ­¤åŒæ—¶ï¼Œè¾ƒç”Ÿåƒ»çš„å¤æ‚å•è¯ï¼Œç”šè‡³æ˜¯è¯å…¸ä¸­æ²¡æœ‰çš„å•è¯ï¼Œå¯èƒ½ä¼šä»åŒå®ƒç»“æ„ç±»ä¼¼çš„å…¶ä»–è¯é‚£é‡Œè·å–æ›´å¥½çš„è¯å‘é‡è¡¨ç¤ºã€‚ 1. å‰ç½®çŸ¥è¯†1.1 Softmax RegressionSoftmax Regression (å›å½’) åˆè¢«ç§°ä½œå¤šé¡¹LRï¼ˆmultinomial logistic regressionï¼‰ï¼Œå®ƒæ˜¯LRåœ¨å¤šç±»åˆ«ä»»åŠ¡ä¸Šçš„æ¨å¹¿ã€‚ 1.2 Hierarchical Softmax1.3 n-gramâ€™s featureåœ¨æ–‡æœ¬ç‰¹å¾æå–ä¸­ï¼Œå¸¸å¸¸èƒ½çœ‹åˆ° n-gram çš„èº«å½±ã€‚å®ƒæ˜¯ä¸€ç§åŸºäºè¯­è¨€æ¨¡å‹çš„ç®—æ³•ï¼ŒåŸºæœ¬æ€æƒ³æ˜¯å°†æ–‡æœ¬å†…å®¹æŒ‰ç…§å­—èŠ‚é¡ºåºè¿›è¡Œå¤§å°ä¸º N çš„æ»‘åŠ¨çª—å£æ“ä½œï¼Œæœ€ç»ˆå½¢æˆé•¿åº¦ä¸º N çš„å­—èŠ‚ç‰‡æ®µåºåˆ—ã€‚çœ‹ä¸‹é¢çš„ä¾‹å­ï¼š å­—ç²’åº¦ æˆ‘æ¥åˆ°è¾¾è§‚æ•°æ®å‚è§‚ ç›¸åº”çš„bigramç‰¹å¾ä¸ºï¼šæˆ‘æ¥ æ¥åˆ° åˆ°è¾¾ è¾¾è§‚ è§‚æ•° æ•°æ® æ®å‚ å‚è§‚ ç›¸åº”çš„trigramç‰¹å¾ä¸ºï¼šæˆ‘æ¥åˆ° æ¥åˆ°è¾¾ åˆ°è¾¾è§‚ è¾¾è§‚æ•° è§‚æ•°æ® æ•°æ®å‚ æ®å‚è§‚ è¯ç²’åº¦ æˆ‘ æ¥åˆ° è¾¾è§‚æ•°æ® å‚è§‚ ç›¸åº”çš„bigramç‰¹å¾ä¸ºï¼šæˆ‘/æ¥åˆ° æ¥åˆ°/è¾¾è§‚æ•°æ® è¾¾è§‚æ•°æ®/å‚è§‚ ç›¸åº”çš„trigramç‰¹å¾ä¸ºï¼šæˆ‘/æ¥åˆ°/è¾¾è§‚æ•°æ® æ¥åˆ°/è¾¾è§‚æ•°æ®/å‚è§‚ å°ç»“ï¼š n-gramä¸­çš„gramæ ¹æ®ç²’åº¦ä¸åŒã€‚å®ƒå¯ä»¥æ˜¯å­—ç²’åº¦ï¼Œä¹Ÿå¯ä»¥æ˜¯è¯ç²’åº¦çš„ã€‚ n-gram äº§ç”Ÿçš„ç‰¹å¾åªæ˜¯ä½œä¸ºæ–‡æœ¬ç‰¹å¾çš„å€™é€‰é›†ï¼Œä½ åé¢å¯èƒ½ä¼šé‡‡ç”¨ä¿¡æ¯ç†µã€å¡æ–¹ç»Ÿè®¡ã€IDFç­‰æ–‡æœ¬ç‰¹å¾é€‰æ‹©æ–¹å¼ç­›é€‰å‡ºæ¯”è¾ƒé‡è¦ç‰¹å¾ã€‚ 2. word2vec æ¶æ„åŸç†2.1 CBOW æ¨¡å‹æ¶æ„2.2 å‰å‘ä¼ æ’­2.3 åå‘ä¼ æ’­3. fastText æ ¸å¿ƒæ€æƒ³3.1 å­—ç¬¦çº§ n-gram3.2 æ¨¡å‹æ¶æ„3.3 æ ¸å¿ƒæ€æƒ³ä»”ç»†è§‚å¯Ÿæ¨¡å‹çš„ååŠéƒ¨åˆ†ï¼Œå³ä»éšå«å±‚è¾“å‡ºåˆ°è¾“å‡ºå±‚è¾“å‡ºï¼Œä¼šå‘ç°å®ƒå°±æ˜¯ä¸€ä¸ªsoftmaxçº¿æ€§å¤šç±»åˆ«åˆ†ç±»å™¨ï¼Œåˆ†ç±»å™¨çš„è¾“å…¥æ˜¯ä¸€ä¸ªç”¨æ¥è¡¨å¾å½“å‰æ–‡æ¡£çš„å‘é‡ï¼›æ¨¡å‹çš„å‰åŠéƒ¨åˆ†ï¼Œå³ä»è¾“å…¥å±‚è¾“å…¥åˆ°éšå«å±‚è¾“å‡ºéƒ¨åˆ†ï¼Œä¸»è¦åœ¨åšä¸€ä»¶äº‹æƒ…ï¼šç”Ÿæˆç”¨æ¥è¡¨å¾æ–‡æ¡£çš„å‘é‡ã€‚é‚£ä¹ˆå®ƒæ˜¯å¦‚ä½•åšçš„å‘¢ï¼Ÿå åŠ æ„æˆè¿™ç¯‡æ–‡æ¡£çš„æ‰€æœ‰è¯åŠn-gramçš„è¯å‘é‡ï¼Œç„¶åå–å¹³å‡ã€‚å åŠ è¯å‘é‡èƒŒåçš„æ€æƒ³å°±æ˜¯ä¼ ç»Ÿçš„è¯è¢‹æ³•ï¼Œå³å°†æ–‡æ¡£çœ‹æˆä¸€ä¸ªç”±è¯æ„æˆçš„é›†åˆã€‚ äºæ˜¯fastTextçš„æ ¸å¿ƒæ€æƒ³å°±æ˜¯ï¼šå°†æ•´ç¯‡æ–‡æ¡£çš„è¯åŠn-gramå‘é‡å åŠ å¹³å‡å¾—åˆ°æ–‡æ¡£å‘é‡ï¼Œç„¶åä½¿ç”¨æ–‡æ¡£å‘é‡åšsoftmaxå¤šåˆ†ç±»ã€‚è¿™ä¸­é—´æ¶‰åŠåˆ°ä¸¤ä¸ªæŠ€å·§ï¼šå­—ç¬¦çº§n-gramç‰¹å¾çš„å¼•å…¥ä»¥åŠåˆ†å±‚Softmaxåˆ†ç±»ã€‚ 3.4 åˆ†ç±»æ•ˆæœè¿˜æœ‰ä¸ªé—®é¢˜ï¼Œå°±æ˜¯ä¸ºä½•fastTextçš„åˆ†ç±»æ•ˆæœå¸¸å¸¸ä¸è¾“äºä¼ ç»Ÿçš„éçº¿æ€§åˆ†ç±»å™¨ï¼Ÿ å‡è®¾æˆ‘ä»¬æœ‰ä¸¤æ®µæ–‡æœ¬ï¼š æˆ‘ æ¥åˆ° è¾¾è§‚æ•°æ® ä¿º å»äº† è¾¾è€Œè§‚ä¿¡æ¯ç§‘æŠ€ è¿™ä¸¤æ®µæ–‡æœ¬æ„æ€å‡ ä¹ä¸€æ¨¡ä¸€æ ·ï¼Œå¦‚æœè¦åˆ†ç±»ï¼Œè‚¯å®šè¦åˆ†åˆ°åŒä¸€ä¸ªç±»ä¸­å»ã€‚ä½†åœ¨ä¼ ç»Ÿçš„åˆ†ç±»å™¨ä¸­ï¼Œç”¨æ¥è¡¨å¾è¿™ä¸¤æ®µæ–‡æœ¬çš„å‘é‡å¯èƒ½å·®è·éå¸¸å¤§ã€‚ä¼ ç»Ÿçš„æ–‡æœ¬åˆ†ç±»ä¸­ï¼Œä½ éœ€è¦è®¡ç®—å‡ºæ¯ä¸ªè¯çš„æƒé‡ï¼Œæ¯”å¦‚tfidfå€¼ï¼Œ â€œæˆ‘â€å’Œâ€œä¿ºâ€ ç®—å‡ºçš„tfidfå€¼ç›¸å·®å¯èƒ½ä¼šæ¯”è¾ƒå¤§ï¼Œå…¶å®ƒè¯ç±»ä¼¼ï¼Œäºæ˜¯ï¼ŒVSMï¼ˆå‘é‡ç©ºé—´æ¨¡å‹ï¼‰ä¸­ç”¨æ¥è¡¨å¾è¿™ä¸¤æ®µæ–‡æœ¬çš„æ–‡æœ¬å‘é‡å·®åˆ«å¯èƒ½æ¯”è¾ƒå¤§ã€‚ ä½†æ˜¯fastTextå°±ä¸ä¸€æ ·äº†ï¼Œå®ƒæ˜¯ç”¨å•è¯çš„embeddingå åŠ è·å¾—çš„æ–‡æ¡£å‘é‡ï¼Œè¯å‘é‡çš„é‡è¦ç‰¹ç‚¹å°±æ˜¯å‘é‡çš„è·ç¦»å¯ä»¥ç”¨æ¥è¡¡é‡å•è¯é—´çš„è¯­ä¹‰ç›¸ä¼¼ç¨‹åº¦ï¼Œäºæ˜¯ï¼Œåœ¨fastTextæ¨¡å‹ä¸­ï¼Œè¿™ä¸¤æ®µæ–‡æœ¬çš„å‘é‡åº”è¯¥æ˜¯éå¸¸ç›¸ä¼¼çš„ï¼Œäºæ˜¯ï¼Œå®ƒä»¬å¾ˆå¤§æ¦‚ç‡ä¼šè¢«åˆ†åˆ°åŒä¸€ä¸ªç±»ä¸­ã€‚ fastTextæ•ˆæœå¥½çš„åŸå› ï¼š ä½¿ç”¨è¯embeddingè€Œéè¯æœ¬èº«ä½œä¸ºç‰¹å¾ å­—ç¬¦çº§n-gramç‰¹å¾çš„å¼•å…¥å¯¹åˆ†ç±»æ•ˆæœä¼šæœ‰ä¸€äº›æå‡ 4. fastText keras å®æˆ˜6. å°ç»“ FastText æå‡ºäº†å­è¯åµŒå…¥æ–¹æ³•ã€‚åœ¨ word2vec skip-gram åŸºç¡€ä¸Šï¼Œå°†ä¸­å¿ƒè¯å‘é‡è¡¨ç¤ºæˆå•è¯çš„å­è¯å‘é‡ä¹‹å’Œã€‚ å­è¯åµŒå…¥ï¼ˆsubword embeddingï¼‰åˆ©ç”¨æ„è¯ä¸Šçš„è§„å¾‹ï¼Œé€šå¸¸å¯ä»¥æå‡ç”Ÿåƒ»è¯è¡¨ç¤ºçš„è´¨é‡ã€‚ fastText è®­ç»ƒæ—¶å¤æ‚åº¦ é‡‡ç”¨å±‚æ¬¡åŒ– softmax ä¹‹åï¼Œå‡å°‘ä¸º O(hlogK) çº§åˆ«, é¢„æµ‹æ—¶è¿˜æ˜¯ O(Kh) Reference å­è¯åµŒå…¥ï¼ˆfastTextï¼‰ fastTextï¼Œæ™ºæ…§ä¸ç¾è²Œå¹¶é‡çš„æ–‡æœ¬åˆ†ç±»åŠå‘é‡åŒ–å·¥å…· NLPï¸±é«˜çº§è¯å‘é‡è¡¨è¾¾ï¼ˆäºŒï¼‰â€”â€”FastTextï¼ˆç®€è¿°ã€å­¦ä¹ ç¬”è®°ï¼‰ å¦‚ä½•åœ¨python éå¸¸ç®€å•è®­ç»ƒFastText æˆ‘çˆ±è‡ªç„¶è¯­è¨€å¤„ç†-fastTextåŸç†åŠå®è·µ FastTextæ–‡æœ¬åˆ†ç±»ç®—æ³•å­¦ä¹ ç¬”è®°ï¼ˆå¥½æ–‡ï¼‰ FastTextçš„å†…éƒ¨æœºåˆ¶ åˆ©ç”¨skiftå®ç°fasttextæ¨¡å‹ CSDN å±‚æ¬¡softmax","categories":[{"name":"nlp","slug":"nlp","permalink":"http://iequa.com/categories/nlp/"}],"tags":[{"name":"fastText","slug":"fastText","permalink":"http://iequa.com/tags/fastText/"}]},{"title":"K-means","slug":"ml/K-Means","date":"2018-12-18T02:01:21.000Z","updated":"2019-10-20T04:30:35.035Z","comments":true,"path":"2018/12/18/ml/K-Means/","link":"","permalink":"http://iequa.com/2018/12/18/ml/K-Means/","excerpt":"","text":"åœ¨æ•°æ®æŒ–æ˜ä¸­ï¼Œ k-Means ç®—æ³•æ˜¯ä¸€ç§ cluster analysis çš„ç®—æ³•ï¼Œå…¶ä¸»è¦æ˜¯æ¥è®¡ç®—æ•°æ®èšé›†çš„ç®—æ³•ï¼Œä¸»è¦é€šè¿‡ä¸æ–­åœ°å–ç¦»ç§å­ç‚¹æœ€è¿‘å‡å€¼çš„ç®—æ³•ã€‚ 1. é—®é¢˜K-Meansç®—æ³•ä¸»è¦è§£å†³çš„é—®é¢˜å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œåœ¨å›¾çš„å·¦è¾¹æœ‰ä¸€äº›ç‚¹ï¼Œæˆ‘ä»¬ç”¨è‚‰çœ¼å¯ä»¥çœ‹å‡ºæ¥æœ‰å››ä¸ªç‚¹ç¾¤ï¼Œä½†æ˜¯æˆ‘ä»¬æ€ä¹ˆé€šè¿‡è®¡ç®—æœºç¨‹åºæ‰¾å‡ºè¿™å‡ ä¸ªç‚¹ç¾¤æ¥å‘¢ï¼Ÿäºæ˜¯å°±å‡ºç°äº†æˆ‘ä»¬çš„K-Meansç®—æ³•. Kå‡å€¼èšç±»çš„åŸºæœ¬æ€æƒ³æ˜¯ï¼Œé€šè¿‡è¿­ä»£æ–¹å¼å¯»æ‰¾Kä¸ªç°‡(Cluster)çš„ä¸€ç§åˆ’åˆ†æ–¹æ¡ˆï¼Œä½¿å¾—èšç±»ç»“æœå¯¹åº”çš„ä»£ä»·å‡½æ•°æœ€å°ã€‚ç‰¹åˆ«çš„ï¼Œä»£ä»·å‡½æ•°å¯ä»¥å®šä¹‰ä¸ºå„ä¸ªæ ·æœ¬è·ç¦»æ‰€å±ç°‡ä¸­å¿ƒç‚¹çš„è¯¯å·®å¹³æ–¹å’Œ 2. ç®—æ³•æ¦‚è¦è¿™ä¸ªç®—æ³•å…¶å®å¾ˆç®€å•ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š ä»ä¸Šå›¾ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼ŒA, B, C, D, E æ˜¯äº”ä¸ªåœ¨å›¾ä¸­ç‚¹ã€‚è€Œç°è‰²çš„ç‚¹æ˜¯æˆ‘ä»¬çš„ç§å­ç‚¹ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬ç”¨æ¥æ‰¾ç‚¹ç¾¤çš„ç‚¹ã€‚æœ‰ä¸¤ä¸ªç§å­ç‚¹ï¼Œæ‰€ä»¥K=2ã€‚ ç„¶åï¼ŒK-Meansçš„ç®—æ³•å¦‚ä¸‹ï¼š 1). éšæœºåœ¨å›¾ä¸­å–Kï¼ˆè¿™é‡ŒK=2ï¼‰ä¸ªç§å­ç‚¹ã€‚ 2). ç„¶åå¯¹å›¾ä¸­çš„æ‰€æœ‰ç‚¹æ±‚åˆ°è¿™Kä¸ªç§å­ç‚¹çš„è·ç¦»ï¼Œå‡å¦‚ç‚¹Piç¦»ç§å­ç‚¹Siæœ€è¿‘ï¼Œé‚£ä¹ˆPiå±äºSiç‚¹ç¾¤ã€‚ï¼ˆä¸Šå›¾ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°A,Bå±äºä¸Šé¢çš„ç§å­ç‚¹ï¼ŒC,D,Eå±äºä¸‹é¢ä¸­éƒ¨çš„ç§å­ç‚¹ï¼‰. 3). æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬è¦ç§»åŠ¨ç§å­ç‚¹åˆ°å±äºä»–çš„â€œç‚¹ç¾¤â€çš„ä¸­å¿ƒã€‚ï¼ˆè§å›¾ä¸Šçš„ç¬¬ä¸‰æ­¥ï¼‰. 4). ç„¶åé‡å¤ ç¬¬2ï¼‰å’Œ ç¬¬3ï¼‰æ­¥ï¼Œç›´åˆ°ï¼Œç§å­ç‚¹æ²¡æœ‰ç§»åŠ¨ï¼ˆæˆ‘ä»¬å¯ä»¥çœ‹åˆ°å›¾ä¸­çš„ç¬¬å››æ­¥ä¸Šé¢çš„ç§å­ç‚¹èšåˆäº†A,B,Cï¼Œä¸‹é¢çš„ç§å­ç‚¹ èšåˆäº†Dï¼ŒEï¼‰ã€‚ è¿™ä¸ªç®—æ³•å¾ˆç®€å•ã€‚ 3. K-Means å…·ä½“æ­¥éª¤ (1). æ•°æ®é¢„å¤„ç†ã€å½’ä¸€åŒ–ã€ç¦»ç¾¤ç‚¹å¤„ç†ã€‚ (2). éšæœºé€‰æ‹© K ä¸ªç°‡ä¸­å¿ƒï¼Œè®°ä¸º ${\\mu_1}^{(0)}, {\\mu_2}^{(0)}, {\\mu_3}^{(0)}, â€¦, {\\mu_k}^{(0)}$ (3). å®šä¹‰ä»£ä»·å‡½æ•° : (4). ä»¤ t=0,1,2,â€¦ ä¸ºè¿­ä»£è½®æ•°ï¼Œé‡å¤ä¸‹é¢çš„è¿‡ç¨‹çŸ¥é“ J æ”¶æ•›: å¯¹äºæ¯ä¸€ä¸ªæ ·æœ¬ $x_i$, å°†å…¶åˆ†é…åˆ°è·ç¦»æœ€è¿‘çš„ç°‡. å¯¹äºæ¯ä¸€ä¸ªç±»ç°‡ $k$, é‡æ–°è®¡ç®—è¯¥ç±»ç°‡çš„ä¸­å¿ƒ 4. K-Means ä¼˜ç¼ºç‚¹Advantageï¼š å¯¹äºå¤§æ•°æ®é›†ï¼ŒKå‡å€¼ é«˜æ•ˆä¸”å¯ä¼¸ç¼©ï¼Œå®ƒçš„å¤æ‚åº¦æ˜¯ $O(NKt)$ï¼Œæ¥è¿‘äºçº¿æ€§ã€‚ å…¶ä¸­ tæ˜¯è¿­ä»£è½®æ•°ã€‚ Disadvantageï¼š (1) éœ€è¦äººå·¥é¢„è®¾Kå€¼ï¼Œä¸”è¯¥å€¼å’ŒçœŸå®æ•°æ®åˆ†å¸ƒæœªå¿…å»åˆï¼› (2) å—åˆå€¼å’Œç¦»ç¾¤ç‚¹çš„å½±å“ï¼Œæ¯æ¬¡çš„ç»“æœä¸ç¨³å®šï¼› (3) å—åˆå€¼å½±å“ï¼Œç»“æœé€šå¸¸æ˜¯å±€éƒ¨æœ€ä¼˜ï¼› (4) æ— æ³•å¾ˆå¥½åœ°è§£å†³æ•°æ®ç°‡åˆ†å¸ƒå·®åˆ«æ¯”è¾ƒå¤§çš„æƒ…å†µ(å¦‚ä¸€ç±»æ˜¯å¦ä¸€ç±»æ ·æœ¬æ•°é‡çš„100å€)ï¼› (5) ä¸å¤ªé€‚ç”¨äºç¦»æ•£åˆ†å¸ƒï¼›æ ·æœ¬ç‚¹åªèƒ½è¢«åˆ’åˆ†åˆ°å•ä¸€çš„ç±»ä¸­ã€‚ 5. K-Means++ K-means æœ€å¼€å§‹æ˜¯éšæœºé€‰å–æ•°æ®é›†ä¸­çš„Kä¸ªç‚¹ä½œä¸ºèšç±»ä¸­å¿ƒ. K-means++ æ”¹è¿›äº†åˆå§‹å€¼çš„é€‰æ‹©ï¼Œä¼šå°½é‡ä½¿èšç±»ä¸­å¿ƒè¶Šè¿œè¶Šå¥½. 6. æ‰©å±• ISODATAç®—æ³•(è¿­ä»£è‡ªç»„ç»‡æ•°æ®åˆ†ææ³•) é«˜æ–¯æ··åˆæ¨¡å‹ã€EM è‡ªç»„ç»‡æ˜ å°„ç¥ç»ç½‘ç»œ (SOM) èšç±»ç®—æ³•çš„è¯„ä¼° Reference article ç™¾é¢æœºå™¨å­¦ä¹  ã€ ç½‘æ˜“äº‘è¯¾å ‚ COOLSHELL K-MEANS ç®—æ³• K NEAREST NEIGHBOR å•ä½çŸ©é˜µå’Œé€†çŸ©é˜µ","categories":[{"name":"machine-learning","slug":"machine-learning","permalink":"http://iequa.com/categories/machine-learning/"}],"tags":[{"name":"Kmeans","slug":"Kmeans","permalink":"http://iequa.com/tags/Kmeans/"}]},{"title":"TextCNN æ–‡æœ¬æƒ…æ„Ÿåˆ†ç±»çš„å·ç§¯ç¥ç»ç½‘ç»œ","slug":"nlp/textCNN","date":"2018-12-15T23:00:21.000Z","updated":"2019-10-20T04:30:35.068Z","comments":true,"path":"2018/12/16/nlp/textCNN/","link":"","permalink":"http://iequa.com/2018/12/16/nlp/textCNN/","excerpt":"","text":"textCNN æ˜¯ 2014å¹´ æå‡ºçš„ç”¨æ¥åšæ–‡æœ¬åˆ†ç±»çš„å·ç§¯ç¥ç»ç½‘ç»œï¼Œç»“æ„ç®€å•ã€æ•ˆæœå¥½. è®ºæ–‡é“¾æ¥ï¼š Convolutional Neural Networks for Sentence Classification åœ¨æ–‡æœ¬åˆ†ç±»ç­‰ NLP é¢†åŸŸåº”ç”¨å¹¿æ³›. ä¸€èˆ¬ç»“æ„ï¼š é™ç»´ -&gt; conv -&gt; æœ€å¤§æ± åŒ– -&gt; å®Œå…¨è¿æ¥å±‚ -&gt; softmax . å°†æ–‡æœ¬å½“åšæ˜¯ä¸€ç»´å›¾åƒï¼Œä»è€Œå¯ä»¥ç”¨ä¸€ç»´å·ç§¯ç¥ç»ç½‘ç»œæ¥æ•æ‰ä¸´è¿‘è¯ä¹‹é—´çš„å…³è”ã€‚ 1. ä¸€ç»´å·ç§¯å±‚åœ¨ä»‹ç»æ¨¡å‹å‰æˆ‘ä»¬å…ˆæ¥è§£é‡Šä¸€ç»´å·ç§¯å±‚çš„å·¥ä½œåŸç†ã€‚å’ŒäºŒç»´å·ç§¯å±‚ä¸€æ ·ï¼Œä¸€ç»´å·ç§¯å±‚ä½¿ç”¨ä¸€ç»´çš„äº’ç›¸å…³è¿ç®—ã€‚åœ¨ä¸€ç»´äº’ç›¸å…³è¿ç®—ä¸­ï¼Œå·ç§¯çª—å£ä»è¾“å…¥æ•°ç»„çš„æœ€å·¦æ–¹å¼€å§‹ï¼ŒæŒ‰ä»å·¦å¾€å³çš„é¡ºåºï¼Œä¾æ¬¡åœ¨è¾“å…¥æ•°ç»„ä¸Šæ»‘åŠ¨ã€‚ å½“å·ç§¯çª—å£æ»‘åŠ¨åˆ°æŸä¸€ä½ç½®æ—¶ï¼Œçª—å£ä¸­çš„è¾“å…¥å­æ•°ç»„ä¸æ ¸æ•°ç»„æŒ‰å…ƒç´ ç›¸ä¹˜å¹¶æ±‚å’Œï¼Œå¾—åˆ°è¾“å‡ºæ•°ç»„ä¸­ç›¸åº”ä½ç½®çš„å…ƒç´ ã€‚ 1.1 å¤šè¾“å…¥é€šé“ * ä¸€ç»´äº’ç›¸å…³å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œè¾“å…¥æ˜¯ä¸€ä¸ªå®½ä¸º 7 çš„ä¸€ç»´æ•°ç»„ï¼Œæ ¸æ•°ç»„çš„å®½ä¸º 2ã€‚å¯ä»¥çœ‹åˆ°è¾“å‡ºçš„å®½åº¦ä¸º 7âˆ’2+1=6ï¼Œä¸”ç¬¬ä¸€ä¸ªå…ƒç´ æ˜¯ç”±è¾“å…¥çš„æœ€å·¦è¾¹çš„å®½ä¸º 2 çš„å­æ•°ç»„ä¸æ ¸æ•°ç»„æŒ‰å…ƒç´ ç›¸ä¹˜åå†ç›¸åŠ å¾—åˆ°çš„ã€‚ ä¸€ç»´äº’ç›¸å…³è¿ç®—ã€‚é˜´å½±éƒ¨åˆ†ä¸ºç¬¬ä¸€ä¸ªè¾“å‡ºå…ƒç´ åŠå…¶è®¡ç®—æ‰€ä½¿ç”¨çš„è¾“å…¥å’Œæ ¸æ•°ç»„å…ƒç´ ï¼š0Ã—1+1Ã—2=2ã€‚ 1.2 å¤šè¾“å…¥é€šé“ * ä¸€ç»´äº’ç›¸å…³å¤šè¾“å…¥é€šé“çš„ä¸€ç»´äº’ç›¸å…³è¿ç®—ä¹Ÿä¸å¤šè¾“å…¥é€šé“çš„äºŒç»´äº’ç›¸å…³è¿ç®—ç±»ä¼¼ï¼šåœ¨æ¯ä¸ªé€šé“ä¸Šï¼Œå°†æ ¸ä¸ç›¸åº”çš„è¾“å…¥åšä¸€ç»´äº’ç›¸å…³è¿ç®—ï¼Œå¹¶å°†é€šé“ä¹‹é—´çš„ç»“æœç›¸åŠ å¾—åˆ°è¾“å‡ºç»“æœã€‚ä¸‹å›¾å±•ç¤ºäº†å« 3 ä¸ªè¾“å…¥é€šé“çš„ä¸€ç»´äº’ç›¸å…³è¿ç®—ã€‚ å«3ä¸ªè¾“å…¥é€šé“çš„ä¸€ç»´äº’ç›¸å…³è¿ç®—ã€‚é˜´å½±éƒ¨åˆ†ä¸ºç¬¬ä¸€ä¸ªè¾“å‡ºå…ƒç´ åŠå…¶è®¡ç®—æ‰€ä½¿ç”¨çš„è¾“å…¥å’Œæ ¸æ•°ç»„å…ƒç´ ï¼š 0Ã—1+1Ã—2+1Ã—3+2Ã—4+2Ã—(âˆ’1)+3Ã—(âˆ’3)=2 1.3 å•è¾“å…¥é€šé“ * äºŒç»´äº’ç›¸å…³ 2Ã—(âˆ’1)+3Ã—(âˆ’3)+1Ã—3+2Ã—4+0Ã—1+1Ã—2=2ç»“è®º ï¼š å¤šè¾“å…¥é€šé“ ä¸€ç»´äº’ç›¸å…³ &lt;=&gt; å•è¾“å…¥é€šé“ äºŒç»´äº’ç›¸å…³ 1.4 å¤šè¾“å…¥é€šé“ * äºŒç»´äº’ç›¸å…³ (1Ã—1+2Ã—2+4Ã—3+5Ã—4)+(0Ã—0+1Ã—1+3Ã—2+4Ã—3)=56 1.5 å¤šè¾“å‡ºé€šé“ 1Ã—1 å·ç§¯å±‚å½“è¾“å…¥é€šé“æœ‰å¤šä¸ªæ—¶ï¼Œç”±äºæˆ‘ä»¬å¯¹å„ä¸ªé€šé“çš„ç»“æœåšäº†ç´¯åŠ ï¼Œæ‰€ä»¥ä¸è®ºè¾“å…¥é€šé“æ•°æ˜¯å¤šå°‘ï¼Œè¾“å‡ºé€šé“æ•°æ€»æ˜¯ä¸º 1 1.6 å°ç»“ ä½¿ç”¨å¤šé€šé“å¯ä»¥æ‹“å±•å·ç§¯å±‚çš„æ¨¡å‹å‚æ•°. å‡è®¾å°†é€šé“ç»´å½“åšæ˜¯ç‰¹å¾ç»´ï¼Œå°†é«˜å’Œå®½ç»´åº¦ä¸Šçš„å…ƒç´ å½“æˆæ•°æ®æ ·æœ¬ï¼Œé‚£ä¹ˆ 1Ã—1 å·ç§¯å±‚çš„ä½œç”¨ä¸å…¨è¿æ¥å±‚ç­‰ä»·. 1Ã—1 å·ç§¯å±‚é€šå¸¸ç”¨æ¥è°ƒæ•´ç½‘ç»œå±‚ä¹‹é—´çš„é€šé“æ•°ï¼Œå¹¶æ§åˆ¶æ¨¡å‹å¤æ‚åº¦. 2. æ—¶åºæœ€å¤§æ± åŒ–å±‚ç±»ä¼¼åœ°ï¼Œæˆ‘ä»¬æœ‰ä¸€ç»´æ± åŒ–å±‚ã€‚TextCNN ä¸­ä½¿ç”¨çš„æ—¶åºæœ€å¤§æ± åŒ–å±‚ï¼ˆmax-over-time poolingï¼‰å®é™…ä¸Šå¯¹åº”ä¸€ç»´å…¨å±€æœ€å¤§æ± åŒ–å±‚ï¼šå‡è®¾è¾“å…¥åŒ…å«å¤šä¸ªé€šé“ï¼Œå„é€šé“ç”±ä¸åŒæ—¶é—´æ­¥ä¸Šçš„æ•°å€¼ç»„æˆï¼Œå„é€šé“çš„è¾“å‡ºå³è¯¥é€šé“æ‰€æœ‰æ—¶é—´æ­¥ä¸­æœ€å¤§çš„æ•°å€¼ã€‚å› æ­¤ï¼Œæ—¶åºæœ€å¤§æ± åŒ–å±‚çš„è¾“å…¥åœ¨å„ä¸ªé€šé“ä¸Šçš„æ—¶é—´æ­¥æ•°å¯ä»¥ä¸åŒã€‚ ä¸ºæå‡è®¡ç®—æ€§èƒ½ï¼Œæˆ‘ä»¬å¸¸å¸¸å°†ä¸åŒé•¿åº¦çš„æ—¶åºæ ·æœ¬ç»„æˆä¸€ä¸ªå°Batchï¼Œå¹¶é€šè¿‡åœ¨è¾ƒçŸ­åºåˆ—åé™„åŠ ç‰¹æ®Šå­—ç¬¦ï¼ˆä¾‹å¦‚ 0ï¼‰ä»¤æ‰¹é‡ä¸­å„æ—¶åºæ ·æœ¬é•¿åº¦ç›¸åŒã€‚è¿™äº›äººä¸ºæ·»åŠ çš„ç‰¹æ®Šå­—ç¬¦å½“ç„¶æ˜¯æ— æ„ä¹‰çš„ã€‚ç”±äºæ—¶åºæœ€å¤§æ± åŒ–çš„ä¸»è¦ç›®çš„æ˜¯æŠ“å–æ—¶åºä¸­æœ€é‡è¦çš„ç‰¹å¾ï¼Œå®ƒé€šå¸¸èƒ½ä½¿æ¨¡å‹ä¸å—äººä¸ºæ·»åŠ å­—ç¬¦çš„å½±å“ã€‚ 3. TextCNN æ¨¡å‹TextCNN ä¸»è¦ä½¿ç”¨äº†ä¸€ç»´å·ç§¯å±‚å’Œæ—¶åºæœ€å¤§æ± åŒ–å±‚ã€‚å‡è®¾è¾“å…¥çš„æ–‡æœ¬åºåˆ—ç”± n ä¸ªè¯ç»„æˆï¼Œæ¯ä¸ªè¯ç”¨ d ç»´çš„è¯å‘é‡è¡¨ç¤ºã€‚é‚£ä¹ˆè¾“å…¥æ ·æœ¬çš„å®½ä¸º nï¼Œé«˜ä¸º 1ï¼Œè¾“å…¥é€šé“æ•°ä¸º dã€‚ textCNN çš„è®¡ç®—ä¸»è¦åˆ†ä¸ºä»¥ä¸‹å‡ æ­¥ï¼š (1). å·ç§¯å±‚ï¼š å®šä¹‰å¤šä¸ªä¸€ç»´å·ç§¯æ ¸ï¼Œå¹¶ä½¿ç”¨è¿™äº›å·ç§¯æ ¸å¯¹è¾“å…¥åˆ†åˆ«åšå·ç§¯è®¡ç®—ã€‚å®½åº¦ä¸åŒçš„å·ç§¯æ ¸å¯èƒ½ä¼šæ•æ‰åˆ°ä¸åŒä¸ªæ•°çš„ç›¸é‚»è¯çš„ç›¸å…³æ€§ã€‚ (2). æ± åŒ–å±‚ï¼š å¯¹è¾“å‡ºçš„æ‰€æœ‰é€šé“åˆ†åˆ«åšæ—¶åºæœ€å¤§æ± åŒ–ï¼Œå†å°†è¿™äº›é€šé“çš„æ± åŒ–è¾“å‡ºå€¼è¿ç»“ä¸ºå‘é‡ã€‚ (3). å…¨è¿å±‚ï¼š é€šè¿‡å…¨è¿æ¥å±‚å°†è¿ç»“åçš„å‘é‡å˜æ¢ä¸ºæœ‰å…³å„ç±»åˆ«çš„è¾“å‡ºã€‚è¿™ä¸€æ­¥å¯ä»¥ä½¿ç”¨ä¸¢å¼ƒå±‚åº”å¯¹è¿‡æ‹Ÿåˆã€‚ ç”¨ä¸€ä¸ªä¾‹å­è§£é‡Šäº† textCNN çš„è®¾è®¡ã€‚è¿™é‡Œçš„è¾“å…¥æ˜¯ä¸€ä¸ªæœ‰ 11 ä¸ªè¯çš„å¥å­ï¼Œæ¯ä¸ªè¯ç”¨ 6 ç»´è¯å‘é‡è¡¨ç¤ºã€‚å› æ­¤è¾“å…¥åºåˆ—çš„å®½ä¸º 11ï¼Œè¾“å…¥é€šé“æ•°ä¸º 6ã€‚ç»™å®š 2 ä¸ªä¸€ç»´å·ç§¯æ ¸ï¼Œæ ¸å®½åˆ†åˆ«ä¸º 2 å’Œ 4ï¼Œè¾“å‡ºé€šé“æ•°åˆ†åˆ«è®¾ä¸º 4 å’Œ 5ã€‚å› æ­¤ï¼Œä¸€ç»´å·ç§¯è®¡ç®—åï¼Œ4 ä¸ªè¾“å‡ºé€šé“çš„å®½ä¸º 11âˆ’2+1=10ï¼Œè€Œå…¶ä»– 5 ä¸ªé€šé“çš„å®½ä¸º 11âˆ’4+1=8ã€‚å°½ç®¡æ¯ä¸ªé€šé“çš„å®½ä¸åŒï¼Œæˆ‘ä»¬ä¾ç„¶å¯ä»¥å¯¹å„ä¸ªé€šé“åšæ—¶åºæœ€å¤§æ± åŒ–ï¼Œå¹¶å°† 9 ä¸ªé€šé“çš„æ± åŒ–è¾“å‡ºè¿ç»“æˆä¸€ä¸ª 9 ç»´å‘é‡ã€‚æœ€ç»ˆï¼Œæˆ‘ä»¬ä½¿ç”¨å…¨è¿æ¥å°† 9 ç»´å‘é‡å˜æ¢ä¸º 2 ç»´è¾“å‡ºï¼šæ­£é¢æƒ…æ„Ÿå’Œè´Ÿé¢æƒ…æ„Ÿçš„é¢„æµ‹ã€‚ 4. CNN çš„ç‰¹ç‚¹CNNçš„ä¸‰ä¸ªä¼˜ç‚¹ï¼š sparse interaction(ç¨€ç–çš„äº¤äº’) parameter sharing(å‚æ•°å…±äº«) equivalent respresentation(ç­‰ä»·è¡¨ç¤º)ã€‚ ç»å…¸çš„ç®€åŒ–å·ç§¯å…¬å¼è¡¨ç¤ºå¦‚ä¸‹ï¼š å‡è®¾æ¯ä¸ªè¯ç”¨ä¸‰ç»´å‘é‡è¡¨ç¤ºï¼Œå·¦è¾¹æ˜¯4ä¸ªè¯ï¼Œå³è¾¹æ˜¯å·ç§¯çŸ©é˜µï¼Œé‚£ä¹ˆå¾—åˆ°è¾“å‡ºä¸ºï¼š å¦‚æœåŸºäºè¿™ä¸ªç»“æœåš1-MaxPoolæ± åŒ–(æœ€å¤§å€¼æ± åŒ–)ï¼Œé‚£ä¹ˆå°±å–å·ç§¯å±‚ç»“æœ o ä¸­çš„æœ€å¤§å€¼ï¼Œå³æå–æœ€æ˜¾è‘—çš„ç‰¹å¾ã€‚ é’ˆå¯¹æµ·é‡çš„æ–‡æœ¬å¤šåˆ†ç±»æ•°æ®ï¼Œä¹Ÿå¯ä»¥å°è¯•ä¸€ä¸‹æµ…å±‚çš„æ·±åº¦å­¦ä¹ æ¨¡å‹FastTextæ¨¡å‹ï¼Œè¯¥æ¨¡å‹çš„åˆ†ç±»æ•ˆç‡æ›´é«˜ã€‚ æ•´ä¸ªæ¨¡å‹ç”±å››éƒ¨åˆ†æ„æˆï¼š è¾“å…¥å±‚ã€å·ç§¯å±‚ã€æ± åŒ–å±‚ã€å…¨è¿æ¥å±‚ã€‚ 5. å°ç»“ æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸€ç»´å·ç§¯æ¥å¤„ç†å’Œåˆ†ææ—¶åºæ•°æ®ã€‚ å¤šè¾“å…¥é€šé“çš„ä¸€ç»´äº’ç›¸å…³è¿ç®—å¯ä»¥çœ‹ä½œæ˜¯å•è¾“å…¥é€šé“çš„äºŒç»´äº’ç›¸å…³è¿ç®—ã€‚ æ—¶åºæœ€å¤§æ± åŒ–å±‚çš„è¾“å…¥åœ¨å„ä¸ªé€šé“ä¸Šçš„æ—¶é—´æ­¥æ•°å¯ä»¥ä¸åŒã€‚ TextCNN ä¸»è¦ä½¿ç”¨äº†ä¸€ç»´å·ç§¯å±‚å’Œæ—¶åºæœ€å¤§æ± åŒ–å±‚ã€‚ Reference æ–‡æœ¬æƒ…æ„Ÿåˆ†ç±»ï¼šä½¿ç”¨å·ç§¯ç¥ç»ç½‘ç»œï¼ˆtextCNNï¼‰ æˆ‘çˆ±è‡ªç„¶è¯­è¨€å¤„ç† å¾çˆ±NLP(4)â€”åŸºäºText-CNNæ¨¡å‹çš„ä¸­æ–‡æ–‡æœ¬åˆ†ç±»å®æˆ˜ fastTextã€TextCNNã€TextRNNâ€¦â€¦è¿™é‡Œæœ‰ä¸€å¥—NLPæ–‡æœ¬åˆ†ç±»æ·±åº¦å­¦ä¹ æ–¹æ³•åº“ä¾›ä½ é€‰æ‹© å¤§è§„æ¨¡æ–‡æœ¬åˆ†ç±»ç½‘ç»œTextCNNä»‹ç»","categories":[{"name":"nlp","slug":"nlp","permalink":"http://iequa.com/categories/nlp/"}],"tags":[{"name":"TextCNN","slug":"TextCNN","permalink":"http://iequa.com/tags/TextCNN/"}]},{"title":"Chatbot Research 13 - ç†è®ºç¯‡ï¼š MMI æ¨¡å‹ç†è®º","slug":"chatbot/chatbot-research13","date":"2018-12-05T14:00:21.000Z","updated":"2019-10-20T04:30:35.026Z","comments":true,"path":"2018/12/05/chatbot/chatbot-research13/","link":"","permalink":"http://iequa.com/2018/12/05/chatbot/chatbot-research13/","excerpt":"æœ¬æ–‡æå‡ºäº†ä¸¤ç§æ¨¡å‹ï¼ˆå…¶å®å°±æ˜¯æ”¹äº†ä¸‹ç›®æ ‡å‡½æ•°ï¼Œè€Œä¸”è®­ç»ƒè¿‡ç¨‹ä¸­ä»ç„¶ä½¿ç”¨likelihoodï¼Œä»…åœ¨æµ‹è¯•çš„æ—¶å€™ä½¿ç”¨æ–°çš„ç›®æ ‡å‡½æ•°å°†æœ‰æ„ä¹‰çš„å“åº”çš„æ¦‚ç‡å˜å¤§~~ï¼‰ï¼ŒMMI-antiLMå’ŒMMI-bidiï¼Œä¸‹é¢åˆ†åˆ«è¿›è¡Œä»‹ç»ã€‚","text":"æœ¬æ–‡æå‡ºäº†ä¸¤ç§æ¨¡å‹ï¼ˆå…¶å®å°±æ˜¯æ”¹äº†ä¸‹ç›®æ ‡å‡½æ•°ï¼Œè€Œä¸”è®­ç»ƒè¿‡ç¨‹ä¸­ä»ç„¶ä½¿ç”¨likelihoodï¼Œä»…åœ¨æµ‹è¯•çš„æ—¶å€™ä½¿ç”¨æ–°çš„ç›®æ ‡å‡½æ•°å°†æœ‰æ„ä¹‰çš„å“åº”çš„æ¦‚ç‡å˜å¤§~~ï¼‰ï¼ŒMMI-antiLMå’ŒMMI-bidiï¼Œä¸‹é¢åˆ†åˆ«è¿›è¡Œä»‹ç»ã€‚ æœ¬æ–‡æ˜¯æçºªä¸ºçš„è®ºæ–‡â€œA Diversity-Promoting Objective Function for Neural Conversation Modelsâ€é˜…è¯»ç¬”è®°ã€‚è¿ç« æå‡ºä½¿ç”¨MMIä»£æ›¿åŸå§‹çš„maximum likelihoodä½œä¸ºç›®æ ‡å‡½æ•°ï¼Œç›®çš„æ˜¯ä½¿ç”¨äº’ä¿¡æ¯å‡å°â€œI donâ€™t Knowâ€è¿™ç±»æ— èŠå“åº”çš„ç”Ÿæˆæ¦‚ç‡ã€‚ä¸€èˆ¬çš„seq2seqæ¨¡å‹ï¼Œå€¾å‘äºç”Ÿæˆå®‰å…¨ã€æ™®é€‚çš„å“åº”ï¼Œå› ä¸ºè¿™ç§å“åº”æ›´ç¬¦åˆè¯­æ³•è§„åˆ™ï¼Œåœ¨è®­ç»ƒé›†ä¸­å‡ºç°é¢‘ç‡ä¹Ÿè¾ƒé«˜ï¼Œæœ€ç»ˆç”Ÿæˆçš„æ¦‚ç‡ä¹Ÿæœ€å¤§ï¼Œè€Œæœ‰æ„ä¹‰çš„å“åº”ç”Ÿæˆæ¦‚ç‡å¾€å¾€æ¯”ä»–ä»¬å°ã€‚é€šè¿‡MMIæ¥è®¡ç®—è¾“å…¥è¾“å‡ºä¹‹é—´çš„ä¾èµ–æ€§å’Œç›¸å…³æ€§ï¼Œå¯ä»¥å‡å°‘æ¨¡å‹å¯¹ä»–ä»¬çš„ç”Ÿæˆæ¦‚ç‡ã€‚ æ–°çš„ç›®æ ‡å‡½æ•°â€¦ Reference","categories":[{"name":"chatbot","slug":"chatbot","permalink":"http://iequa.com/categories/chatbot/"}],"tags":[{"name":"Chatbot","slug":"Chatbot","permalink":"http://iequa.com/tags/Chatbot/"}]},{"title":"Chatbot Research 12 - ç†è®ºç¯‡ï¼š è¯„ä»·æŒ‡æ ‡ä»‹ç»","slug":"chatbot/chatbot-research12","date":"2018-12-01T14:00:21.000Z","updated":"2019-10-20T04:30:35.027Z","comments":true,"path":"2018/12/01/chatbot/chatbot-research12/","link":"","permalink":"http://iequa.com/2018/12/01/chatbot/chatbot-research12/","excerpt":"å¯¹è¯ç³»ç»Ÿä¹‹æ‰€ä»¥æ²¡æœ‰å–å¾—çªç ´æ€§çš„è¿›å±•ï¼Œå¾ˆå¤§ç¨‹åº¦æ˜¯å› ä¸ºæ²¡æœ‰ä¸€ä¸ªå¯ä»¥å‡†ç¡®è¡¨ç¤ºå›ç­”æ•ˆæœå¥½åçš„è¯„ä»·æ ‡å‡†ã€‚å¯¹è¯ç³»ç»Ÿä¸­å¤§éƒ½ä½¿ç”¨æœºå™¨ç¿»è¯‘ã€æ‘˜è¦ç”Ÿæˆé¢†åŸŸæå‡ºæ¥çš„è¯„ä»·æŒ‡æ ‡ï¼Œä½†æ˜¯å¾ˆæ˜æ˜¾å¯¹è¯ç³»ç»Ÿçš„åœºæ™¯å’Œéœ€æ±‚ä¸ä»–ä»¬æ˜¯å­˜åœ¨å·®åˆ«çš„.","text":"å¯¹è¯ç³»ç»Ÿä¹‹æ‰€ä»¥æ²¡æœ‰å–å¾—çªç ´æ€§çš„è¿›å±•ï¼Œå¾ˆå¤§ç¨‹åº¦æ˜¯å› ä¸ºæ²¡æœ‰ä¸€ä¸ªå¯ä»¥å‡†ç¡®è¡¨ç¤ºå›ç­”æ•ˆæœå¥½åçš„è¯„ä»·æ ‡å‡†ã€‚å¯¹è¯ç³»ç»Ÿä¸­å¤§éƒ½ä½¿ç”¨æœºå™¨ç¿»è¯‘ã€æ‘˜è¦ç”Ÿæˆé¢†åŸŸæå‡ºæ¥çš„è¯„ä»·æŒ‡æ ‡ï¼Œä½†æ˜¯å¾ˆæ˜æ˜¾å¯¹è¯ç³»ç»Ÿçš„åœºæ™¯å’Œéœ€æ±‚ä¸ä»–ä»¬æ˜¯å­˜åœ¨å·®åˆ«çš„. 1. è¯„ä»·æŒ‡æ ‡*æ¦‚è§ˆå¯¹äºæŸä¸€è½®å¯¹è¯è€Œè¨€: å¯ä½¿ç”¨å“åº”çš„é€‚å½“æ€§ã€æµç•…åº¦ã€ç›¸å…³æ€§ï¼› å¯¹äºå¤šè½®å¯¹è¯è€Œè¨€: å…³æ³¨æµç•…æ€§ã€å¯¹è¯æ·±åº¦ã€å¤šæ ·æ€§ã€ä¸€è‡´è¿è´¯æ€§ç­‰æŒ‡æ ‡ å¯¹äºæ•´ä¸ªå¯¹è¯ç³»ç»Ÿ: æˆ‘ä»¬åˆ™å¸Œæœ›ä»–å¯ä»¥æ¶µç›–æ›´å¤šçš„è¯é¢˜ã€å›å¤çœŸå®å¯ä¿¡ç­‰ç­‰ã€‚ è¿™äº›éƒ½æ˜¯æˆ‘ä»¬æƒ³è¦å¯¹è¯ç³»ç»Ÿæ‰€æ‹¥æœ‰çš„èƒ½åŠ›ï¼Œä½†æ˜¯å¾€å¾€åœ¨ä¸€ä¸ªå…·ä½“çš„ä»»åŠ¡ä¸­æˆ‘ä»¬åªèƒ½å…³æ³¨æŸä¸€é¡¹æˆ–è€…å‡ é¡¹æŒ‡æ ‡ï¼Œè¿™é‡Œæˆ‘ä»¬ä¸»è¦é’ˆå¯¹å¼€æ”¾åŸŸç”Ÿæˆå¼å¯¹è¯æ¨¡å‹çš„è¯„ä»·æŒ‡æ ‡è¿›è¡Œæ€»ç»“ã€‚ 2. è¯é‡å è¯„ä»·æŒ‡æ ‡é¦–å…ˆæ¥çœ‹è¯é‡å è¯„ä»·æŒ‡æ ‡ï¼Œä»–ä»¬è®¤ä¸ºæœ‰æ•ˆåœ°å›ç­”åº”è¯¥å’ŒçœŸå®å›ç­”ä¹‹é—´å­˜åœ¨å¤§é‡çš„è¯é‡å ï¼ˆä½†æ˜¯å¯¹è¯ç³»ç»Ÿçš„ç­”æ¡ˆç©ºé—´å¾€å¾€æ˜¯å‘æ•£çš„ï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ªé—®é¢˜çš„ç­”æ¡ˆå¯èƒ½æ˜¯å®Œå…¨ä¸åŒçš„ä¸¤å¥è¯ï¼Œè¿™ç§æƒ…å†µä¸‹è¯¥è¯„ä»·æŒ‡æ ‡æ•ˆæœä¸å¥½ï¼‰ï¼Œä¹Ÿå°±æ˜¯è¯´è¿™æ˜¯ä¸€ä¸ªéå¸¸å¼ºçš„å‡è®¾ã€‚ï¼ˆä»¥ä¸‹ç¯èŠ‚ä¸­rè¡¨ç¤ºçœŸæ˜¯å“åº”ï¼Œr^è¡¨ç¤ºç³»ç»Ÿç”Ÿæˆå“åº”ï¼‰ 3. BLEUè¯¥è¯„ä»·æŒ‡æ ‡æœ‰IBMåœ¨2002å¹´æå‡ºï¼Œå‚è€ƒè®ºæ–‡â€œBLEU: a Method for Automatic Evaluation of Machine Translationâ€ï¼Œå¸¸ä½œä¸ºæœºå™¨ç¿»è¯‘ç³»ç»Ÿè¯„ä»·æŒ‡æ ‡ã€‚å…¶å®å°±æ˜¯ç»Ÿè®¡ç”Ÿæˆå“åº”å’ŒçœŸå®å“åº”ä¸­çš„n-gramè¯ç»„åœ¨æ•´ä¸ªè®­ç»ƒè¯­æ–™ä¸­å‡ºç°æ¬¡æ•°ã€‚å…¬å¼å¦‚ä¸‹æ‰€ç¤ºï¼š ROUGE : è¯¥æŒ‡æ ‡å¸¸ç”¨äºæ–‡æœ¬æ‘˜è¦é¢†åŸŸMETEOR: BLEU çš„å‡çº§ç‰ˆ 4. è¯å‘é‡è¯„ä»·æŒ‡æ ‡ä¸Šé¢çš„è¯é‡å è¯„ä»·æŒ‡æ ‡åŸºæœ¬ä¸Šéƒ½æ˜¯n-gramæ–¹å¼ï¼Œå»è®¡ç®—ç”Ÿæˆå“åº”å’ŒçœŸå®å“åº”ä¹‹é—´çš„é‡åˆç¨‹åº¦ï¼Œå…±ç°ç¨‹åº¦ç­‰æŒ‡æ ‡ã€‚è€Œè¯å‘é‡åˆ™æ˜¯é€šè¿‡Word2Vecç­‰æ–¹æ³•å°†å¥å­è½¬æ¢ä¸ºå‘é‡è¡¨ç¤ºï¼Œè¿™æ ·ä¸€ä¸ªå¥å­å°±è¢«æ˜ å°„åˆ°ä¸€ä¸ªä½ç»´ç©ºé—´ï¼Œå¥å‘é‡åœ¨ä¸€å®šç¨‹åº¦ä¸Šè¡¨å¾äº†å…¶å«ä¹‰ï¼Œåœ¨é€šè¿‡ä½™å¼¦ç›¸ä¼¼åº¦ç­‰æ–¹æ³•å°±å¯ä»¥è®¡ç®—ä¸¤ä¸ªå¥å­ä¹‹é—´çš„ç›¸ä¼¼ç¨‹åº¦ã€‚ä½¿ç”¨è¯å‘é‡çš„å¥½å¤„æ˜¯ï¼Œå¯ä»¥ä¸€å®šç¨‹åº¦ä¸Šå¢åŠ ç­”æ¡ˆçš„å¤šæ ·æ€§ï¼Œå› ä¸ºè¿™é‡Œå¤§å¤šé‡‡ç”¨è¯è¯­ç›¸ä¼¼åº¦è¿›è¡Œè¡¨å¾ï¼Œç›¸æ¯”è¯é‡å ä¸­è¦æ±‚å‡ºç°å®Œå…¨ç›¸åŒçš„è¯è¯­ï¼Œé™åˆ¶é™ä½äº†å¾ˆå¤šã€‚ 5. perplexityå›°æƒ‘åº¦perplexityæ˜¯è¯­è¨€æ¨¡å‹ä¸­çš„æŒ‡æ ‡ï¼Œç”¨äºè¯„ä»·è¯­è¨€æ¨¡å‹çš„å¥½åï¼Œå…¶å®å°±æ˜¯ä¼°ç®—ä¸€å¥è¯å‡ºç°çš„æ¦‚ç‡ï¼Œçœ‹ä¸€å¥è¯æ˜¯å¦é€šé¡ºã€‚ä¹Ÿç»å¸¸ä¼šåœ¨å¯¹è¯ç³»ç»Ÿä¸­å‡ºç°è¯„ä»·ç”Ÿæˆçš„å“åº”æ˜¯å¦ç¬¦åˆè¯­è¨€è§„åˆ™ï¼Œè®¡ç®—æ–¹æ³•ä¹Ÿå¾ˆç®€å•ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š æ‰€ä»¥å½“æˆ‘ä»¬ä½¿ç”¨tf.contrib.seq2seq.sequence_loss()å‡½æ•°è®¡ç®—æ¨¡å‹lossçš„æ—¶å€™ï¼Œperplexityçš„è®¡ç®—å°±æ˜¾å¾—å¾ˆç®€å•äº†ï¼Œç›´æ¥å¯¹è®¡ç®—å‡ºæ¥çš„losså–ä¸ªæŒ‡æ•°å°±è¡Œäº†ï¼Œå‘½ä»¤å¦‚ä¸‹æ‰€ç¤ºï¼š train_perp = math.exp(float(mean_loss)) if mean_loss &lt; 300 else math.inf ç°åœ¨æˆ‘è®­ç»ƒçš„å¯¹è¯ç³»ç»Ÿï¼Œä¸€èˆ¬éƒ½åªæ˜¯ç”¨äº†perplexityæ¥è¯„åˆ¤æ¨¡å‹çš„æ•ˆæœï¼Œæœ€ç»ˆperplexityå¯ä»¥é™åˆ°20å·¦å³ï¼ˆè¶Šå°è¶Šå¥½ï¼Œè¯´æ˜è¶Šæ¥è¿‘äºè‡ªç„¶è¯­è¨€ï¼‰ã€‚ 6. äººå·¥æŒ‡æ ‡æœ€åè¯´ä¸€ä¸‹äººå·¥è¯„ä»·ï¼Œé¦–å…ˆæ¥è®²ï¼Œä¸Šé¢è¯´äº†è¿™ä¹ˆå¤šçš„è¯„ä»·æŒ‡æ ‡ï¼Œå¹¶æ²¡æœ‰ä¸€ä¸ªå¯ä»¥å¾ˆå¥½çš„è§£å†³å¯¹è¯ç³»ç»Ÿçš„é—®é¢˜ï¼Œå°±åƒâ€œHow NOT To Evaluate Your Dialogue Systemâ€è®ºæ–‡ä¸­è¯´åˆ°çš„é‚£æ ·ï¼Œå½“ä¸‹çš„è¿™äº›è¯„ä»·æŒ‡æ ‡éƒ½è·Ÿäººå·¥è¯„ä»·æˆå¼±ç›¸å…³æˆ–è€…å®Œå…¨æ²¡æœ‰å…³ç³»ï¼Œç›¸å…³ç¨‹åº¦è·Ÿå…·ä½“çš„æ•°æ®é›†æœ‰å…³ã€‚ ä»¥ä¸‹æ‘˜è‡ªå¾é˜¿è¡¡çš„å›ç­”ï¼š åœ¨é—²èŠæ€§è´¨çš„æ•°æ®é›†ä¸Šï¼Œä¸Šè¿° metric å’Œäººå·¥åˆ¤æ–­æœ‰ä¸€å®šå¾®å¼±çš„å…³è” (only a small positive correlation on chitchat oriented Twitter dataset) åœ¨æŠ€æœ¯ç±»çš„æ•°æ®é›†ä¸Šï¼Œä¸Šè¿° metric å’Œäººå·¥åˆ¤æ–­å®Œå…¨æ²¡æœ‰å…³è”(no correlation at all on the technical UDC) å½“å±€é™äºä¸€ä¸ªç‰¹åˆ«å…·ä½“çš„é¢†åŸŸæ—¶ï¼ŒBLEU ä¼šæœ‰ä¸é”™çš„è¡¨ç° éšç€å‘å±•ï¼Œè¿˜é€æ¸æœ‰äº†ä¸€äº›åˆ«çš„è¯„ä»·æ–¹æ³•ï¼Œæ¯”å¦‚ä½¿ç”¨GANç½‘ç»œæ¥è¯„ä»·ç”Ÿæˆçš„å›å¤æ˜¯å¦è·Ÿäººç±»å›å¤ç›¸ä¼¼ç­‰ç­‰ã€‚ã€‚ã€‚ Reference","categories":[{"name":"chatbot","slug":"chatbot","permalink":"http://iequa.com/categories/chatbot/"}],"tags":[{"name":"Chatbot","slug":"Chatbot","permalink":"http://iequa.com/tags/Chatbot/"}]},{"title":"Chatbot Common Useful Links","slug":"chatbot/chatbot-common-links","date":"2018-12-01T11:16:21.000Z","updated":"2019-10-20T04:30:35.024Z","comments":true,"path":"2018/12/01/chatbot/chatbot-common-links/","link":"","permalink":"http://iequa.com/2018/12/01/chatbot/chatbot-common-links/","excerpt":"Here are some useful links about Chatbot","text":"Here are some useful links about Chatbot Tensorflow TensorFlowä¸­global_stepçš„ç®€å•åˆ†æ Tensorflow å…¥é—¨ï¼Œ å¾ˆå¥½çš„æ•™ç¨‹ Tensorflow å­¦ä¹ ç¬”è®° æ•°æ®å¤„ç† sequence_mask tensorflow å­¦ä¹ ç¬”è®°â€” tf.reduce_maxã€tf.sequence_mask tf.nn.embedding_lookupå‡½æ•°çš„ç”¨æ³• ä½¿ç”¨Seq2Seq+attentionå®ç°ç®€å•çš„Chatbot tf.strided_sliceå‡½æ•° Tensorlow ä¸­æ–‡API: å¸¸é‡(constants) - 5. tf.fill ã€TensorFlowã€‘tf.concatçš„ç”¨æ³• [ç¬¬ 28 å¤©] æ·±åº¦å­¸ç¿’ï¼ˆ2ï¼‰TensorBoard tf.identityçš„æ„ä¹‰ä»¥åŠç”¨ä¾‹ TensorflowåŠ¨æ€seq2seqä½¿ç”¨æ€»ç»“ï¼ˆr1.3ï¼‰- Loss Function tensorflowå­¦ä¹ ç¬”è®°(äºŒåä¸€):tensorflowå¯è§†åŒ– tensorflowâ€”tf.gradients()ç®€å•å®ç”¨æ•™ç¨‹ tf.clip_by_global_normç†è§£ Tensorflow å­¦ä¹ ç¬”è®°ï¼ˆå…­ï¼‰ â€”â€”â€”â€” Optimizer Tensorflowä¸­çš„Seq2Seqå…¨å®¶æ¡¶ map() ä¸ nest.map_structureï¼ˆï¼‰ çš„åŒºåˆ«åŠç”¨æ³• Seq2Seq sampled softmax Csdn wuzqChom å¦‚ä½•é€šä¿—ç†è§£sampled softmaxæœºåˆ¶ï¼Ÿ","categories":[{"name":"chatbot","slug":"chatbot","permalink":"http://iequa.com/categories/chatbot/"}],"tags":[{"name":"Useful-Links","slug":"Useful-Links","permalink":"http://iequa.com/tags/Useful-Links/"}]},{"title":"Tensorflow Sequence_loss","slug":"tensorflow/sequence_loss","date":"2018-12-01T05:36:21.000Z","updated":"2019-10-20T04:30:35.058Z","comments":true,"path":"2018/12/01/tensorflow/sequence_loss/","link":"","permalink":"http://iequa.com/2018/12/01/tensorflow/sequence_loss/","excerpt":"sequence_loss æ˜¯ nlpç®—æ³• ä¸­éå¸¸é‡è¦çš„ä¸€ä¸ªå‡½æ•°. rnn,lstm,attentionéƒ½è¦ç”¨åˆ°è¿™ä¸ªå‡½æ•°.çœ‹ä¸‹é¢ä»£ç :","text":"sequence_loss æ˜¯ nlpç®—æ³• ä¸­éå¸¸é‡è¦çš„ä¸€ä¸ªå‡½æ•°. rnn,lstm,attentionéƒ½è¦ç”¨åˆ°è¿™ä¸ªå‡½æ•°.çœ‹ä¸‹é¢ä»£ç : 1. ç‰¹æ®Šçš„ğŸŒ°# coding: utf-8import numpy as npimport tensorflow as tffrom tensorflow.contrib.seq2seq import sequence_losslogits_np = np.array([ [[0.5, 0.5, 0.5, 0.5], [0.5, 0.5, 0.5, 0.5], [0.5, 0.5, 0.5, 0.5]], [[0.5, 0.5, 0.5, 0.5], [0.5, 0.5, 0.5, 0.5], [0.5, 0.5, 0.5, 0.5]]])targets_np = np.array([ [0, 0, 0], [0, 0, 0]], dtype=np.int32)logits = tf.convert_to_tensor(logits_np)targets = tf.convert_to_tensor(targets_np)cost = sequence_loss(logits=logits, targets=targets, weights=tf.ones_like(targets, dtype=tf.float64))init = tf.global_variables_initializer()with tf.Session() as sess: sess.run(init) r = sess.run(cost) print(r) å…ˆå¯¹æ¯ä¸ª[0.5,0.5,0.5,0.5]å–softmax. softmax([0.5,0.5,0.5,0.5])=(0.25,0.25,0.25,0.25)ç„¶åå†è®¡ç®—-ln(0.25)*6/6=1.38629436112. 2. ä¸€èˆ¬çš„ğŸŒ°# coding:utf-8from __future__ import unicode_literalsfrom __future__ import print_functionfrom __future__ import divisionfrom tensorflow.contrib.seq2seq import sequence_lossimport tensorflow as tfimport numpy as np# 2ä¸ªå¥å­ï¼Œ3ä¸ªæ—¶åˆ»ï¼Œ4ä¸ªå€¼(è¯æ±‡è¡¨)output_np = np.array( [ [[0.6, 0.5, 0.3, 0.2], [0.9, 0.5, 0.3, 0.2], [1.0, 0.5, 0.3, 0.2]], [[0.2, 0.5, 0.3, 0.2], [0.3, 0.5, 0.3, 0.2], [0.4, 0.5, 0.3, 0.2]] ])print(output_np.shape)# 2ä¸ªå¥å­ï¼Œtarget_np = np.array([[0, 1, 2], [3, 0, 1]], dtype=np.int32)print(target_np.shape)output = tf.convert_to_tensor(output_np, np.float32)target = tf.convert_to_tensor(target_np, np.int32)cost = sequence_loss(output, target, tf.ones_like(target, dtype=np.float32))init = tf.global_variables_initializer()with tf.Session() as sess: sess.run(init) cost_r = sess.run(cost) print(cost_r) è¿™ä¸ªä»£ç ä½œç”¨å’Œä¸‹é¢çš„tf.reduce_mean(softmax_cross_entropy_with_logits)ä½œç”¨ä¸€è‡´. # coding:utf-8from __future__ import unicode_literalsfrom __future__ import print_functionfrom __future__ import divisionimport tensorflow as tfimport numpy as npdef to_onehot(a): max_index = np.max(a) b = np.zeros((a.shape[0], max_index + 1)) b[np.arange(a.shape[0]), a] = 1 return blogits_ph = tf.placeholder(tf.float32, shape=(None, None))labels_ph = tf.placeholder(tf.float32, shape=(None, None))output_np = np.array([ [0.6, 0.5, 0.3, 0.2], [0.9, 0.5, 0.3, 0.2], [1.0, 0.5, 0.3, 0.2], [0.2, 0.5, 0.3, 0.2], [0.3, 0.5, 0.3, 0.2], [0.4, 0.5, 0.3, 0.2]])cost = tf.reduce_mean(tf.nn.softmax_cross_entropy_with_logits(labels=labels_ph, logits=logits_ph))target_np = np.array([0, 1, 2, 3, 0, 1])init = tf.global_variables_initializer()with tf.Session() as sess: sess.run(init) cost_r = sess.run(cost, feed_dict=&#123;logits_ph: output_np, labels_ph: to_onehot(target_np)&#125;) print(cost_r) å†å–äº¤å‰ç†µ,å†å–å¹³å‡. seq2seq çš„åº”ç”¨chatbot åº”ç”¨ seq2seq éœ€è¦ç”¨åˆ° sequence_loss Reference","categories":[{"name":"tensorflow","slug":"tensorflow","permalink":"http://iequa.com/categories/tensorflow/"}],"tags":[{"name":"sequence_loss","slug":"sequence-loss","permalink":"http://iequa.com/tags/sequence-loss/"}]},{"title":"Chatbot Research 11 - Chatbot çš„ç¬¬äºŒä¸ªç‰ˆæœ¬ (æ–°APIå®ç°)","slug":"chatbot/chatbot-research11","date":"2018-11-29T14:00:21.000Z","updated":"2020-10-23T02:03:18.012Z","comments":true,"path":"2018/11/29/chatbot/chatbot-research11/","link":"","permalink":"http://iequa.com/2018/11/29/chatbot/chatbot-research11/","excerpt":"æˆ‘ä»¬ä½¿ç”¨ tf.contrib.legacy_seq2seq ä¸‹çš„ API æ„å»ºäº†ä¸€ä¸ªç®€å•çš„ chatbot å¯¹è¯ç³»ç»Ÿ. ä»£ç æ˜¯1.0ä¹‹å‰æ—§ç‰ˆ. æœ¬ç¯‡æˆ‘ä»¬å­¦ä¹ æ–°ç‰ˆæœ¬çµæ´»çš„çš„APIï¼Œè¿™é‡Œå…ˆæ¥è¯´ä¸€ä¸‹äºŒè€…çš„ä¸åŒï¼š","text":"æˆ‘ä»¬ä½¿ç”¨ tf.contrib.legacy_seq2seq ä¸‹çš„ API æ„å»ºäº†ä¸€ä¸ªç®€å•çš„ chatbot å¯¹è¯ç³»ç»Ÿ. ä»£ç æ˜¯1.0ä¹‹å‰æ—§ç‰ˆ. æœ¬ç¯‡æˆ‘ä»¬å­¦ä¹ æ–°ç‰ˆæœ¬çµæ´»çš„çš„APIï¼Œè¿™é‡Œå…ˆæ¥è¯´ä¸€ä¸‹äºŒè€…çš„ä¸åŒï¼š æ–°ç‰ˆæœ¬APIï¼š ç”¨ dynamic_rnn æ¥æ„é€  RNNæ¨¡å‹ï¼Œè¿™æ ·å°±é¿å…äº†æ•°æ®é•¿åº¦ä¸åŒæ‰€å¸¦æ¥çš„å›°æ‰°ï¼Œä¸éœ€è¦å†ä½¿ç”¨ model_with_buckets è¿™ç§æ–¹æ³•æ¥æ„å»ºæ¨¡å‹ï¼Œä½¿å¾—æˆ‘ä»¬æ•°æ®å¤„ç†å’Œæ¨¡å‹ä»£ç éƒ½ç®€æ´å¾ˆå¤šã€‚ æ–°ç‰ˆæœ¬å°† Attentionã€ Decoder ç­‰å‡ ä¸ªä¸»è¦çš„åŠŸèƒ½éƒ½åˆ†åˆ«è¿›è¡Œå°è£…ï¼Œç›´æ¥è°ƒç”¨ç›¸åº”çš„ Wapperå‡½æ•° è¿›è¡Œå°è£…å³å¯ï¼Œæ›´åŠ çµæ´»æ–¹ä¾¿ï¼Œè€Œä¸”åªéœ€è¦å†™å‡ ä¸ªç®€å•çš„å‡½æ•°æ—¢å¯ä»¥è‡ªå®šä¹‰çš„å„ä¸ªæ¨¡å—ä»¥æ»¡è¶³æˆ‘ä»¬ä¸ªæ€§åŒ–çš„éœ€æ±‚ã€‚ å®ç°äº†beam_searchåŠŸèƒ½ï¼Œå¯ç›´æ¥è°ƒç”¨ã€‚ tensor flow dynamic_rnn ä¸rnnæœ‰å•¥åŒºåˆ«ï¼Ÿ dynamic_rnn åªåœ¨ä¸€ä¸ª batch å†…éƒ¨è¿›è¡Œè‡ªåŠ¨ paddingï¼Œ ä¸åŒ batch padding é•¿åº¦å¯ä»¥ä¸åŒ 1. æ•°æ®å¤„ç† word2id is : { â€˜decorationsâ€™: 12002, â€˜scrapsâ€™: 4599, â€¦} id2word is : { 0: â€˜â€˜, 1: â€˜â€˜, 2: â€˜â€˜, 3: â€˜â€˜, 4: â€˜canâ€™, 5: â€˜weâ€™, 6: â€˜makeâ€™, â€¦ } trainingSamples is : [ [ [793, 138, 65], [35, 209, 110, 9016, 208, 382, 35, 22] ], [ [35, 209, 110, 9016, 208, 382, 35, 22], [26, 92, 1906, 47, 254, 65] ], â€¦ ] 2. æ¨¡å‹æ„å»ºä»£ç ä¸»è¦æ˜¯ä» tensorflowå®˜ç½‘ ç»™å‡ºçš„nmtä¾‹å­çš„ä»£ç ç®€åŒ–è€Œæ¥ï¼Œå®ç°äº†æœ€åŸºæœ¬çš„ attention å’Œ beam_search ç­‰åŠŸèƒ½ï¼ŒåŒæ—¶æœ‰å°†nmtä»£ç ä¸­ç¹æ‚çš„ä»£ç é€»è¾‘è¿›è¡Œç®€åŒ–ã€‚è¿™é‡Œå‚è€ƒnmtä¸­æ‰€æåˆ°çš„æ„å»ºtrainã€evalã€inference , ä¸‰ä¸ªå›¾è¿›è¡Œæ¨¡å‹æ„å»ºï¼Œå¥½å¤„åœ¨äº nmtå®˜æ–¹æ–‡æ¡£ Building Training, Eval, and Inference Graphs inferenceå›¾ å¾€å¾€ä¸ train å’Œ evalç»“æ„ å­˜åœ¨è¾ƒå¤§å·®å¼‚ï¼Œæ‰€ä»¥å¾€å¾€éœ€è¦å•ç‹¬è¿›è¡Œæ„å»º. ï¼ˆæ²¡æœ‰decoderè¾“å…¥å’Œç›®æ ‡ï¼Œéœ€è¦ä½¿ç”¨ greedy æˆ– beam_search è¿›è¡Œ decodeï¼Œbatch_size ä¹Ÿä¸åŒç­‰ç­‰ï¼‰ evalå›¾ï¼Œä¸éœ€è¦è¿›è¡Œåå‘ä¼ æ’­ï¼Œåªéœ€è¦å¾—åˆ°ä¸€ä¸ª loss å’Œ accå€¼ æ•°æ®è¿›è¡Œ feedï¼Œç®€åŒ–æ•°æ®æ“ä½œ å˜é‡é‡ç”¨å˜å¾—ç®€å•ï¼Œå› ä¸º trainã€eval å­˜åœ¨ä¸€äº›å…¬ç”¨å˜é‡å’Œä»£ç å—ï¼Œå°±ä¸éœ€è¦æˆ‘ä»¬é‡å¤å®šä¹‰ åªéœ€è¦åœ¨ train æ—¶ä¸æ–­ä¿å­˜æ¨¡å‹å‚æ•°ï¼Œç„¶ååœ¨ eval å’Œ infer çš„æ—¶å€™ restoreå‚æ•° å³å¯ ä»¥ä¸Šï¼Œæ‰€ä»¥æˆ‘ä»¬æ„å»ºäº† trainã€evalã€infer ä¸‰ä¸ªå‡½æ•°æ¥å®ç°ä¸Šé¢çš„åŠŸèƒ½ã€‚åœ¨çœ‹ä»£ç ä¹‹å‰æˆ‘ä»¬å…ˆæ¥ç®€å•è¯´ä¸€ä¸‹æ–°ç‰ˆAPIå‡ ä¸ªä¸»è¦çš„æ¨¡å—ä»¥åŠç›¸äº’ä¹‹é—´çš„è°ƒç”¨å…³ç³»ã€‚tf.contrib.seq2seqæ–‡ä»¶å¤¹ä¸‹é¢ä¸»è¦æœ‰ä¸‹é¢6ä¸ªæ–‡ä»¶ï¼Œé™¤äº†lossæ–‡ä»¶å’Œä¹‹å‰çš„sequence_losså‡½æ•°æ²¡æœ‰å¾ˆå¤§åŒºåˆ«ï¼Œè¿™é‡Œä¸ä»‹ç»ä¹‹å¤–ï¼Œå…¶ä»–å‡ ä¸ªæ–‡ä»¶éƒ½ä¼šç®€å•çš„è¯´ä¸€ä¸‹ï¼Œè¿™é‡Œä¸»è¦ä»‹ç»å‡½æ•°å’Œç±»çš„åŠŸèƒ½ï¼Œæºç ä¼šæ”¾åœ¨ä¸‹ç¯‡æ–‡ç« ä¸­ä»‹ç»ã€‚ decoder basic_decoder helper attention_wrapper beam_search_decoder loss 2.1 BasicDecoder ç±»å’Œ dynamic_decodedecoderæ–‡ä»¶ä¸­å®šä¹‰äº† DecoderæŠ½è±¡ç±» dynamic_decodeå‡½æ•° dynamic_decode å¯ä»¥è§†ä¸ºæ•´ä¸ªè§£ç è¿‡ç¨‹çš„å…¥å£ï¼Œéœ€è¦ä¼ å…¥çš„å‚æ•°å°±æ˜¯ Decoder çš„ä¸€ä¸ªå®ä¾‹ï¼Œä»–ä¼šåŠ¨æ€çš„è°ƒç”¨ Decoder çš„ stepå‡½æ•° æŒ‰æ­¥æ‰§è¡Œ decodeï¼Œå¯ä»¥ç†è§£ä¸ºDecoderç±»å®šä¹‰äº†å•æ­¥è§£ç ï¼ˆæ ¹æ®è¾“å…¥æ±‚å‡ºè¾“å‡ºï¼Œå¹¶å°†è¯¥è¾“å‡ºå½“åšä¸‹ä¸€æ—¶åˆ»è¾“å…¥ï¼‰ï¼Œè€Œdynamic_decodeåˆ™ä¼šè°ƒç”¨control_flow_ops.while_loopè¿™ä¸ªå‡½æ•°æ¥å¾ªç¯æ‰§è¡Œç›´åˆ°è¾“å‡ºç»“æŸç¼–ç è¿‡ç¨‹. 2.2 cellç±»å‹ï¼ˆAttentionç±»å‹ï¼‰# åˆ†ä¸º3æ­¥ï¼Œ#. 1. å®šä¹‰attentionæœºåˆ¶#. 2. å®šä¹‰è¦æ˜¯ç”¨çš„åŸºç¡€çš„RNNCell#. 3. ä½¿ç”¨AttentionWrapperè¿›è¡Œå°è£…# 1. å®šä¹‰è¦ä½¿ç”¨çš„attentionæœºåˆ¶ã€‚attention_mechanism = tf.contrib.seq2seq.BahdanauAttention(num_units=self.rnn_size, memory=encoder_outputs, memory_sequence_length=encoder_inputs_length)# 2. å®šä¹‰decoderé˜¶æ®µè¦æ˜¯ç”¨çš„LSTMCellï¼Œç„¶åä¸ºå…¶å°è£…attention wrapperdecoder_cell = self._create_rnn_cell()# 3. ä½¿ç”¨AttentionWrapperè¿›è¡Œå°è£…decoder_cell = tf.contrib.seq2seq.AttentionWrapper(cell=decoder_cell, attention_mechanism=attention_mechanism, attention_layer_size=self.rnn_size, name=&#x27;Attention_Wrapper&#x27;) 2.3 helperç±»å‹helperå…¶å®å°±æ˜¯decodeé˜¶æ®µå¦‚ä½•æ ¹æ®é¢„æµ‹ç»“æœå¾—åˆ°ä¸‹ä¸€æ—¶åˆ»çš„è¾“å…¥ï¼Œæ¯”å¦‚trainè®­ç»ƒè¿‡ç¨‹ä¸­åº”è¯¥ç›´æ¥ä½¿ç”¨ä¸Šä¸€æ—¶åˆ»çš„çœŸå®å€¼ä½œä¸ºä¸‹ä¸€æ—¶åˆ»è¾“å…¥ï¼Œé¢„æµ‹è¿‡ç¨‹ä¸­å¯ä»¥ä½¿ç”¨è´ªå©ªçš„æ–¹æ³•é€‰æ‹©æ¦‚ç‡æœ€å¤§çš„é‚£ä¸ªå€¼ä½œä¸ºä¸‹ä¸€æ—¶åˆ»ç­‰ç­‰ã€‚ Reference Tensorflowæ–°ç‰ˆSeq2Seqæ¥å£ä½¿ç”¨ tensorflowå®˜ç½‘APIæŒ‡å¯¼ DeepQA Neural_Conversation_Models","categories":[{"name":"chatbot","slug":"chatbot","permalink":"http://iequa.com/categories/chatbot/"}],"tags":[{"name":"Chatbot","slug":"Chatbot","permalink":"http://iequa.com/tags/Chatbot/"}]},{"title":"å·¥ç¨‹å¸ˆåº”è¯¥å¦‚ä½•æ³¨æ„èº«ä½“å¥åº·ï¼Ÿ","slug":"tools/body-health","date":"2018-11-26T09:26:48.000Z","updated":"2019-10-20T04:30:34.995Z","comments":true,"path":"2018/11/26/tools/body-health/","link":"","permalink":"http://iequa.com/2018/11/26/tools/body-health/","excerpt":"IT å·¥ç¨‹å¸ˆç¾¤ä½“æ˜¯èŒä¸šç—…é«˜å‘äººç¾¤ï¼ˆä¸è¯´äº†ï¼Œéƒ½æ˜¯æ³ªâ€¦ï¼‰","text":"IT å·¥ç¨‹å¸ˆç¾¤ä½“æ˜¯èŒä¸šç—…é«˜å‘äººç¾¤ï¼ˆä¸è¯´äº†ï¼Œéƒ½æ˜¯æ³ªâ€¦ï¼‰ ç¨‹åºå‘˜å¸¸è§çš„èŒä¸šç—… é¢ˆæ¤ç—… è…°æ¤ç—… ä¹…åå¯¹å‰åˆ—è…ºçš„å±å®³ä»¥åŠè‚¥èƒ–é—®é¢˜ çœ¼ç–²åŠ³ã€ç”¨çœ¼è¿‡åº¦ é¥®é£Ÿã€ä½œæ¯ä¸è§„å¾‹å¯¼è‡´çš„èƒƒç—…ç­‰ä¸€ç³»åˆ—é—®é¢˜ å…¨æ–‡ç›®å½•ï¼š é¢ˆæ¤ã€è…°æ¤ç—…é˜²æ²»ã€ä¹…åå¯¹å‰åˆ—è…ºã€è‚›é—¨çš„å±å®³ä»¥åŠè‚¥èƒ–é—®é¢˜ æ¢ä¸€æŠŠäººä½“å·¥å­¦æ¤…ï¼Œé™„ä¸åŒä»·ä½å“ç‰Œæ¨è ç«™ç«‹å¼åŠå…¬ äººä½“å·¥å­¦æ¤…å’Œç«™ç«‹å¼åŠå…¬ï¼Œåº”è¯¥é€‰æ‹©å“ªä¸ªï¼Ÿ ç”¨çœ¼è¿‡åº¦ã€çœ¼ç–²åŠ³ æŠ¤çœ¼å® è½¯ä»¶ Gunnar é˜²è“å…‰çœ¼é•œ f.lux è½¯ä»¶ Reference ç¨‹åºå‘˜åº”è¯¥å¦‚ä½•æ³¨æ„èº«ä½“å¥åº·ï¼Ÿå¯èƒ½æ‚£å“ªäº›èŒä¸šç—…ï¼Ÿå¦‚ä½•é˜²æ²»ï¼Ÿ","categories":[{"name":"tools","slug":"tools","permalink":"http://iequa.com/categories/tools/"}],"tags":[{"name":"body","slug":"body","permalink":"http://iequa.com/tags/body/"}]},{"title":"Chatbot Research 8 - ç†è®º seq2seq+Attention æœºåˆ¶æ¨¡å‹è¯¦è§£","slug":"chatbot/chatbot-research8","date":"2018-11-17T14:00:21.000Z","updated":"2020-10-23T02:03:18.014Z","comments":true,"path":"2018/11/17/chatbot/chatbot-research8/","link":"","permalink":"http://iequa.com/2018/11/17/chatbot/chatbot-research8/","excerpt":"ä»å…·ä½“çš„æ¨¡å‹ç»†èŠ‚ã€å…¬å¼æ¨å¯¼ã€ç»“æ„å›¾ä»¥åŠå˜å½¢ç­‰å‡ ä¸ªæ–¹å‘è¯¦ç»†ä»‹ç»ä¸€ä¸‹ Seq-to-Seq æ¨¡å‹ã€‚","text":"ä»å…·ä½“çš„æ¨¡å‹ç»†èŠ‚ã€å…¬å¼æ¨å¯¼ã€ç»“æ„å›¾ä»¥åŠå˜å½¢ç­‰å‡ ä¸ªæ–¹å‘è¯¦ç»†ä»‹ç»ä¸€ä¸‹ Seq-to-Seq æ¨¡å‹ã€‚ Seq-to-Seq æ¡†æ¶1 Seq-to-Seq æ¡†æ¶2ï¼ˆteacher forcingï¼‰ Seq-to-Seq with Attentionï¼ˆNMTï¼‰ Seq-to-Seq with Attention å„ç§å˜å½¢ Seq-to-Seq with Beam-Search å½“è¾“å…¥è¾“å‡ºéƒ½æ˜¯ä¸å®šé•¿åºåˆ—æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ç¼–ç å™¨â€”è§£ç å™¨ï¼ˆencoder-decoderï¼‰1 æˆ–è€… seq2seq æ¨¡å‹ 2ã€‚è¿™ä¸¤ä¸ªæ¨¡å‹æœ¬è´¨ä¸Šéƒ½ç”¨åˆ°äº†ä¸¤ä¸ªå¾ªç¯ç¥ç»ç½‘ç»œï¼Œåˆ†åˆ«å«åšç¼–ç å™¨å’Œè§£ç å™¨ã€‚ç¼–ç å™¨ç”¨æ¥åˆ†æè¾“å…¥åºåˆ—ï¼Œè§£ç å™¨ç”¨æ¥ç”Ÿæˆè¾“å‡ºåºåˆ—ã€‚ 1. Seq2Seq æ¡†æ¶1 Learning Phrase Representations using RNN Encoderâ€“Decoder for Statistical Machine Translation 1.1 encode ç¼–ç å™¨ç¼–ç å™¨çš„ä½œç”¨æ˜¯æŠŠä¸€ä¸ªä¸å®šé•¿çš„è¾“å…¥åºåˆ—å˜æ¢æˆä¸€ä¸ªå®šé•¿çš„èƒŒæ™¯å˜é‡ $c$ï¼Œå¹¶åœ¨è¯¥èƒŒæ™¯å˜é‡ä¸­ç¼–ç è¾“å…¥åºåˆ—ä¿¡æ¯ã€‚å¸¸ç”¨çš„ç¼–ç å™¨æ˜¯å¾ªç¯ç¥ç»ç½‘ç»œã€‚ è®©æˆ‘ä»¬è€ƒè™‘æ‰¹é‡å¤§å°ä¸º 1 çš„æ—¶åºæ•°æ®æ ·æœ¬ã€‚å‡è®¾è¾“å…¥åºåˆ—æ˜¯ $x_1,\\ldots,x_T$, ä¾‹å¦‚ $x_i$ æ˜¯è¾“å…¥å¥å­ä¸­çš„ç¬¬ $i$ ä¸ªè¯ã€‚åœ¨æ—¶é—´æ­¥ $t$ï¼Œå¾ªç¯ç¥ç»ç½‘ç»œå°†è¾“å…¥ $x_t$ çš„ç‰¹å¾å‘é‡ $x_t$ å’Œä¸Šä¸ªæ—¶é—´æ­¥çš„éšè—çŠ¶æ€ $\\boldsymbol{h}_{t-1}$ å˜æ¢ä¸ºå½“å‰æ—¶é—´æ­¥çš„éšè—çŠ¶æ€ $h_t$ã€‚æˆ‘ä»¬å¯ä»¥ç”¨å‡½æ•° $f$ è¡¨è¾¾å¾ªç¯ç¥ç»ç½‘ç»œéšè—å±‚çš„å˜æ¢ï¼š \\boldsymbol{h}\\_t = f(\\boldsymbol{x}\\_t, \\boldsymbol{h}\\_{t-1}).æ¥ä¸‹æ¥ç¼–ç å™¨é€šè¿‡è‡ªå®šä¹‰å‡½æ•° $q$ å°†å„ä¸ªæ—¶é—´æ­¥çš„éšè—çŠ¶æ€å˜æ¢ä¸ºèƒŒæ™¯å˜é‡ \\boldsymbol{c} = q(\\boldsymbol{h}\\_1, \\ldots, \\boldsymbol{h}\\_T).ä¾‹å¦‚ï¼Œå½“é€‰æ‹© $q(\\boldsymbol{h}_1, \\ldots, \\boldsymbol{h}_T) = \\boldsymbol{h}_T$ æ—¶ï¼ŒèƒŒæ™¯å˜é‡æ˜¯è¾“å…¥åºåˆ—æœ€ç»ˆæ—¶é—´æ­¥çš„éšè—çŠ¶æ€ $\\boldsymbol{h}_T$ã€‚ ä»¥ä¸Šæè¿°çš„ç¼–ç å™¨æ˜¯ä¸€ä¸ªå•å‘çš„ RNNï¼Œæ¯ä¸ªæ—¶é—´æ­¥çš„éšè—çŠ¶æ€åªå–å†³äºè¯¥æ—¶é—´æ­¥åŠä¹‹å‰çš„è¾“å…¥å­åºåˆ—ã€‚æˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨ Bi-RNN æ„é€ ç¼–ç å™¨ã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œç¼–ç å™¨æ¯ä¸ªæ—¶é—´æ­¥çš„éšè—çŠ¶æ€åŒæ—¶å–å†³äºè¯¥æ—¶é—´æ­¥ä¹‹å‰å’Œä¹‹åçš„å­åºåˆ—ï¼ˆåŒ…æ‹¬å½“å‰æ—¶é—´æ­¥çš„è¾“å…¥ï¼‰ï¼Œå¹¶ç¼–ç äº†æ•´ä¸ªåºåˆ—çš„ä¿¡æ¯ã€‚ 1.2 decode è§£ç å™¨Encode ç¼–ç å™¨è¾“å‡ºçš„èƒŒæ™¯å˜é‡ $c$ ç¼–ç äº†æ•´ä¸ªè¾“å…¥åºåˆ— $x_1, \\ldots, x_T$ çš„ä¿¡æ¯ã€‚ç»™å®šè®­ç»ƒæ ·æœ¬ä¸­çš„è¾“å‡ºåºåˆ— $y_1, y_2, \\ldots, y_{Tâ€™}$ï¼Œå¯¹æ¯ä¸ªæ—¶é—´æ­¥ $tâ€™$ï¼ˆç¬¦å·ä¸è¾“å…¥åºåˆ—æˆ–ç¼–ç å™¨çš„æ—¶é—´æ­¥ $t$ æœ‰åŒºåˆ«ï¼‰ï¼Œ è§£ç å™¨è¾“å‡º $y_{tâ€™}$ çš„æ¡ä»¶æ¦‚ç‡å°†åŸºäºä¹‹å‰çš„è¾“å‡ºåºåˆ— $y_1,\\ldots,y_{tâ€™-1}$ å’ŒèƒŒæ™¯å˜é‡ $c$ï¼Œå³ $\\mathbb{P}(y_{tâ€™} \\mid y_1, \\ldots, y_{tâ€™-1}, \\boldsymbol{c})$ã€‚ ä¸ºæ­¤ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¦ä¸€ä¸ªRNNä½œä¸ºè§£ç å™¨ã€‚ åœ¨è¾“å‡ºåºåˆ—çš„æ—¶é—´æ­¥ $t^\\prime$ï¼Œè§£ç å™¨å°†ä¸Šä¸€æ—¶é—´æ­¥çš„è¾“å‡º $y_{t^\\prime-1}$ ä»¥åŠèƒŒæ™¯å˜é‡ $c$ ä½œä¸ºè¾“å…¥ï¼Œå¹¶å°†å®ƒä»¬ä¸ä¸Šä¸€æ—¶é—´æ­¥çš„éšè—çŠ¶æ€ $\\boldsymbol{h}_{t^\\prime-1}$ å˜æ¢ä¸ºå½“å‰æ—¶é—´æ­¥çš„éšè—çŠ¶æ€ $\\boldsymbol{h}_{t^\\prime}$ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨å‡½æ•° $g$ è¡¨è¾¾è§£ç å™¨éšè—å±‚çš„å˜æ¢ï¼š \\boldsymbol{h}\\_{t^\\prime} = g(y\\_{t^\\prime-1}, \\boldsymbol{c}, \\boldsymbol{h}\\_{t^\\prime-1}).æœ‰äº†decodeçš„éšè—çŠ¶æ€åï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨è‡ªå®šä¹‰çš„è¾“å‡ºå±‚å’Œ softmax è¿ç®—æ¥è®¡ç®— $\\mathbb{P}(y_{t^\\prime} \\mid y_1, \\ldots, y_{t^\\prime-1}, \\boldsymbol{c})$ï¼Œä¾‹å¦‚åŸºäºå½“å‰æ—¶é—´æ­¥çš„è§£ç å™¨éšè—çŠ¶æ€ $\\boldsymbol{h}_{t^\\prime}$ã€ä¸Šä¸€æ—¶é—´æ­¥çš„è¾“å‡º $y_{t^\\prime-1}$ ä»¥åŠèƒŒæ™¯å˜é‡ $c$ æ¥è®¡ç®—å½“å‰æ—¶é—´æ­¥è¾“å‡º $y_{t^\\prime}$ çš„æ¦‚ç‡åˆ†å¸ƒã€‚ 1.3 train æ¨¡å‹è®­ç»ƒæ ¹æ®æœ€å¤§ä¼¼ç„¶ä¼°è®¡ï¼Œæˆ‘ä»¬å¯ä»¥æœ€å¤§åŒ–è¾“å‡ºåºåˆ—åŸºäºè¾“å…¥åºåˆ—çš„æ¡ä»¶æ¦‚ç‡ \\begin{split}\\begin{aligned} \\mathbb{P}(y\\_1, \\ldots, y\\_{T'} \\mid x\\_1, \\ldots, x\\_T) &= \\prod\\_{t'=1}^{T'} \\mathbb{P}(y\\_{t'} \\mid y\\_1, \\ldots, y\\_{t'-1}, x\\_1, \\ldots, x\\_T)\\\\\\\\ &= \\prod\\_{t'=1}^{T'} \\mathbb{P}(y\\_{t'} \\mid y\\_1, \\ldots, y\\_{t'-1}, \\boldsymbol{c}), \\end{aligned}\\end{split}å¹¶å¾—åˆ°è¯¥è¾“å‡ºåºåˆ—çš„æŸå¤± - \\log\\mathbb{P}(y\\_1, \\ldots, y\\_{T'} \\mid x\\_1, \\ldots, x\\_T) = -\\sum\\_{t'=1}^{T'} \\log \\mathbb{P}(y\\_{t'} \\mid y\\_1, \\ldots, y\\_{t'-1}, \\boldsymbol{c}), åœ¨æ¨¡å‹è®­ç»ƒä¸­ï¼Œæ‰€æœ‰è¾“å‡ºåºåˆ—æŸå¤±çš„å‡å€¼é€šå¸¸ä½œä¸ºéœ€è¦æœ€å°åŒ–çš„æŸå¤±å‡½æ•°ã€‚åœ¨å›¾ä¸­æ‰€æè¿°çš„æ¨¡å‹é¢„æµ‹ä¸­ï¼Œæˆ‘ä»¬éœ€è¦å°†decodeåœ¨ä¸Šä¸€ä¸ªæ—¶é—´æ­¥çš„è¾“å‡ºä½œä¸ºå½“å‰æ—¶é—´æ­¥çš„è¾“å…¥ã€‚ä¸æ­¤ä¸åŒï¼Œåœ¨è®­ç»ƒä¸­æˆ‘ä»¬ä¹Ÿå¯ä»¥å°†æ ‡ç­¾åºåˆ—åœ¨ä¸Šä¸€ä¸ªæ—¶é—´æ­¥çš„æ ‡ç­¾ä½œä¸ºdecodeåœ¨å½“å‰æ—¶é—´æ­¥çš„è¾“å…¥ã€‚è¿™å«åšå¼ºåˆ¶æ•™å­¦ï¼ˆteacher forcingï¼‰ã€‚ 1.4 å°ç»“ ç¼–ç å™¨ - è§£ç å™¨ï¼ˆseq2seqï¼‰å¯ä»¥è¾“å…¥å¹¶è¾“å‡ºä¸å®šé•¿çš„åºåˆ—ã€‚ ç¼–ç å™¨â€”è§£ç å™¨ä½¿ç”¨äº†ä¸¤ä¸ªå¾ªç¯ç¥ç»ç½‘ç»œã€‚ åœ¨ç¼–ç å™¨â€”è§£ç å™¨çš„è®­ç»ƒä¸­ï¼Œæˆ‘ä»¬å¯ä»¥é‡‡ç”¨å¼ºåˆ¶æ•™å­¦ã€‚ ï¼ˆè¿™ä¹Ÿæ˜¯ Seq2Seq 2 çš„å†…å®¹ï¼‰ 2. Seq2Seq æ¡†æ¶2ç¬¬äºŒä¸ªè¦è®²çš„Seq-to-Seqæ¨¡å‹æ¥è‡ªäº â€œSequence to Sequence Learning with Neural Networksâ€ï¼Œå…¶æ¨¡å‹ç»“æ„å›¾å¦‚ä¸‹æ‰€ç¤ºï¼š ä¸ä¸Šé¢æ¨¡å‹æœ€å¤§çš„åŒºåˆ«åœ¨äºå…¶sourceç¼–ç åçš„ å‘é‡$C$ ç›´æ¥ä½œä¸ºDecoderé˜¶æ®µRNNçš„åˆå§‹åŒ–stateï¼Œè€Œä¸æ˜¯åœ¨æ¯æ¬¡decodeæ—¶éƒ½ä½œä¸ºRNN cellçš„è¾“å…¥ã€‚æ­¤å¤–ï¼Œdecodeæ—¶RNNçš„è¾“å…¥æ˜¯ç›®æ ‡å€¼ï¼Œè€Œä¸æ˜¯å‰ä¸€æ—¶åˆ»çš„è¾“å‡ºã€‚é¦–å…ˆçœ‹ä¸€ä¸‹ç¼–ç é˜¶æ®µï¼š å°±æ˜¯ç®€å•çš„RNNæ¨¡å‹ï¼Œæ¯ä¸ªè¯ç»è¿‡RNNä¹‹åéƒ½ä¼šç¼–ç ä¸ºhidden stateï¼ˆe0,e1,e2ï¼‰ï¼Œå¹¶ä¸”sourceåºåˆ—çš„ç¼–ç å‘é‡eå°±æ˜¯æœ€ç»ˆçš„hidden state e2ã€‚æ¥ä¸‹æ¥å†çœ‹ä¸€ä¸‹è§£ç é˜¶æ®µï¼š eå‘é‡ä»…ä½œä¸ºRNNçš„åˆå§‹åŒ–çŠ¶æ€ä¼ å…¥decodeæ¨¡å‹ã€‚æ¥ä¸‹æ¥å°±æ˜¯æ ‡å‡†çš„å¾ªç¯ç¥ç»ç½‘ç»œï¼Œæ¯ä¸€æ—¶åˆ»è¾“å…¥éƒ½æ˜¯å‰ä¸€æ—¶åˆ»çš„æ­£ç¡®labelã€‚ç›´åˆ°æœ€ç»ˆè¾“å…¥ç¬¦å·æˆªæ­¢æ»šåŠ¨ã€‚ 3. Seq2Seq Attentiondecode åœ¨å„ä¸ªæ—¶é—´æ­¥ä¾èµ–ç›¸åŒçš„ èƒŒæ™¯å˜é‡ $c$ æ¥è·å–è¾“å…¥åºåˆ—ä¿¡æ¯ã€‚å½“ encode ä¸º RNN æ—¶ï¼ŒèƒŒæ™¯å˜é‡$c$ æ¥è‡ªå®ƒæœ€ç»ˆæ—¶é—´æ­¥çš„éšè—çŠ¶æ€ã€‚ è‹±è¯­è¾“å…¥ï¼šâ€œTheyâ€ã€â€œareâ€ã€â€œwatchingâ€ã€â€œ.â€æ³•è¯­è¾“å‡ºï¼šâ€œIlsâ€ã€â€œregardentâ€ã€â€œ.â€ ç¿»è¯‘ä¾‹å­ï¼šè¾“å…¥ä¸ºè‹±è¯­åºåˆ—â€œTheyâ€ã€â€œareâ€ã€â€œwatchingâ€ã€â€œ.â€ï¼Œè¾“å‡ºä¸ºæ³•è¯­åºåˆ—â€œIlsâ€ã€â€œregardentâ€ã€â€œ.â€ã€‚ï¼Œdecode åœ¨ç”Ÿæˆè¾“å‡ºåºåˆ—ä¸­çš„æ¯ä¸€ä¸ªè¯æ—¶å¯èƒ½åªéœ€åˆ©ç”¨è¾“å…¥åºåˆ—æŸä¸€éƒ¨åˆ†çš„ä¿¡æ¯ã€‚ä¾‹å¦‚ï¼Œåœ¨è¾“å‡ºåºåˆ—çš„æ—¶é—´æ­¥ 1ï¼Œè§£ç å™¨å¯ä»¥ä¸»è¦ä¾èµ–â€œTheyâ€ã€â€œareâ€çš„ä¿¡æ¯æ¥ç”Ÿæˆâ€œIlsâ€ï¼Œåœ¨æ—¶é—´æ­¥ 2 åˆ™ä¸»è¦ä½¿ç”¨æ¥è‡ªâ€œwatchingâ€çš„ç¼–ç ä¿¡æ¯ç”Ÿæˆâ€œregardentâ€ï¼Œæœ€ååœ¨æ—¶é—´æ­¥ 3 åˆ™ç›´æ¥æ˜ å°„å¥å·â€œ.â€ã€‚è¿™çœ‹ä¸Šå»å°±åƒæ˜¯åœ¨ decode çš„æ¯ä¸€æ—¶é—´æ­¥å¯¹è¾“å…¥åºåˆ—ä¸­ä¸åŒæ—¶é—´æ­¥çš„ç¼–ç ä¿¡æ¯åˆ†é…ä¸åŒçš„æ³¨æ„åŠ›ä¸€æ ·ã€‚è¿™ä¹Ÿæ˜¯æ³¨æ„åŠ›æœºåˆ¶çš„ç”±æ¥ 1ã€‚ ä»ä»¥ RNN ä¸ºä¾‹ï¼ŒAttention é€šè¿‡å¯¹ Encode æ‰€æœ‰æ—¶é—´æ­¥çš„éšè—çŠ¶æ€åšåŠ æƒå¹³å‡æ¥å¾—åˆ°èƒŒæ™¯å˜é‡$c$ã€‚Decode åœ¨æ¯ä¸€æ—¶é—´æ­¥è°ƒæ•´è¿™äº›æƒé‡ï¼Œå³ Attention weightï¼Œä»è€Œèƒ½å¤Ÿåœ¨ä¸åŒæ—¶é—´æ­¥åˆ†åˆ«å…³æ³¨è¾“å…¥åºåˆ—ä¸­çš„ä¸åŒéƒ¨åˆ†å¹¶ç¼–ç è¿›ç›¸åº”æ—¶é—´æ­¥çš„èƒŒæ™¯å˜é‡$c$ã€‚æœ¬èŠ‚æˆ‘ä»¬å°†è®¨è®º Attentionæœºåˆ¶ æ˜¯æ€ä¹ˆå·¥ä½œçš„ã€‚ åœ¨â€œç¼–ç å™¨â€”è§£ç å™¨ï¼ˆseq2seqï¼‰â€, è§£ç å™¨åœ¨æ—¶é—´æ­¥ $tâ€™$ çš„éšè—çŠ¶æ€ \\boldsymbol{s}\\_{t'} = g(\\boldsymbol{y}\\_{t'-1}, \\boldsymbol{c}, \\boldsymbol{s}\\_{t'-1})åœ¨ Attentionæœºåˆ¶ ä¸­, è§£ç å™¨çš„æ¯ä¸€æ—¶é—´æ­¥å°†ä½¿ç”¨å¯å˜çš„èƒŒæ™¯å˜é‡$c$ \\boldsymbol{s}\\_{t'} = g(\\boldsymbol{y}\\_{t'-1}, \\boldsymbol{c}\\_{t'}, \\boldsymbol{s}\\_{t'-1}).å…³é”®æ˜¯å¦‚ä½•è®¡ç®—èƒŒæ™¯å˜é‡ $\\boldsymbol{c}_{tâ€™}$ å’Œå¦‚ä½•åˆ©ç”¨å®ƒæ¥æ›´æ–°éšè—çŠ¶æ€ $\\boldsymbol{s}_{tâ€™}$ã€‚ä»¥ä¸‹å°†åˆ†åˆ«æè¿°è¿™ä¸¤ä¸ªå…³é”®ç‚¹ã€‚ 3.1 è®¡ç®—èƒŒæ™¯å˜é‡ c \\boldsymbol{c}\\_{t'} = \\sum\\_{t=1}^T \\alpha\\_{t' t} \\boldsymbol{h}\\_t,å…¶ä¸­ç»™å®š $tâ€™$ æ—¶ï¼Œæƒé‡ $\\alpha_{tâ€™ t}$ åœ¨ $t=1,\\ldots,T$ çš„å€¼æ˜¯ä¸€ä¸ªæ¦‚ç‡åˆ†å¸ƒã€‚ä¸ºäº†å¾—åˆ°æ¦‚ç‡åˆ†å¸ƒï¼Œå¯ä»¥ä½¿ç”¨ softmax è¿ç®—: \\alpha\\_{t' t} = \\frac{\\exp(e\\_{t' t})}{ \\sum\\_{k=1}^T \\exp(e\\_{t' k}) },\\quad t=1,\\ldots,T.ç°åœ¨ï¼Œæˆ‘ä»¬éœ€è¦å®šä¹‰å¦‚ä½•è®¡ç®—ä¸Šå¼ä¸­ softmax è¿ç®—çš„è¾“å…¥ $e_{tâ€™ t}$ã€‚ç”±äº $e_{tâ€™ t}$ åŒæ—¶å–å†³äºdecodeçš„æ—¶é—´æ­¥ $tâ€™$ å’Œencodeçš„æ—¶é—´æ­¥ $t$ï¼Œæˆ‘ä»¬ä¸å¦¨ä»¥è§£ç å™¨åœ¨æ—¶é—´æ­¥ $tâ€™âˆ’1$ çš„éšè—çŠ¶æ€ $\\boldsymbol{s}_{tâ€™ - 1}$ ä¸ç¼–ç å™¨åœ¨æ—¶é—´æ­¥ $t$ çš„éšè—çŠ¶æ€ $h_t$ ä¸ºè¾“å…¥ï¼Œå¹¶é€šè¿‡å‡½æ•° $a$ è®¡ç®— $e_{tâ€™ t}$ï¼š e\\_{t' t} = a(\\boldsymbol{s}\\_{t' - 1}, \\boldsymbol{h}\\_t).è¿™é‡Œå‡½æ•° a æœ‰å¤šç§é€‰æ‹©ï¼Œå¦‚æœä¸¤ä¸ªè¾“å…¥å‘é‡é•¿åº¦ç›¸åŒï¼Œä¸€ä¸ªç®€å•çš„é€‰æ‹©æ˜¯è®¡ç®—å®ƒä»¬çš„å†…ç§¯ $a(\\boldsymbol{s}, \\boldsymbol{h})=\\boldsymbol{s}^\\top \\boldsymbol{h}$ã€‚è€Œæœ€æ—©æå‡ºAttentionæœºåˆ¶çš„è®ºæ–‡åˆ™å°†è¾“å…¥è¿ç»“åé€šè¿‡å«å•éšè—å±‚çš„å¤šå±‚æ„ŸçŸ¥æœºMLP å˜æ¢ a(\\boldsymbol{s}, \\boldsymbol{h}) = \\boldsymbol{v}^\\top \\tanh(\\boldsymbol{W}\\_s \\boldsymbol{s} + \\boldsymbol{W}\\_h \\boldsymbol{h}),å…¶ä¸­ $vã€W_sã€W_h$ éƒ½æ˜¯å¯ä»¥å­¦ä¹ çš„æ¨¡å‹å‚æ•°ã€‚ 3.2 æ›´æ–°éšè—çŠ¶æ€ä»¥é—¨æ§å¾ªç¯å•å…ƒä¸ºä¾‹ï¼Œåœ¨è§£ç å™¨ä¸­æˆ‘ä»¬å¯ä»¥å¯¹é—¨æ§å¾ªç¯å•å…ƒçš„è®¾è®¡ç¨ä½œä¿®æ”¹ã€‚è§£ç å™¨åœ¨æ—¶é—´æ­¥ $tâ€™$ çš„éšè—çŠ¶æ€ä¸º \\boldsymbol{s}\\_{t'} = \\boldsymbol{z}\\_{t'} \\odot \\boldsymbol{s}\\_{t'-1} + (1 - \\boldsymbol{z}\\_{t'}) \\odot \\tilde{\\boldsymbol{s}}\\_{t'},å…¶ä¸­çš„é‡ç½®é—¨ã€æ›´æ–°é—¨å’Œå€™é€‰éšå«çŠ¶æ€åˆ†åˆ«ä¸º : \\begin{split}\\begin{aligned} \\boldsymbol{r}\\_{t'} &= \\sigma(\\boldsymbol{W}\\_{yr} \\boldsymbol{y}\\_{t'-1} + \\boldsymbol{W}\\_{sr} \\boldsymbol{s}\\_{t' - 1} + \\boldsymbol{W}\\_{cr} \\boldsymbol{c}\\_{t'} + \\boldsymbol{b}\\_r),\\\\\\\\ \\boldsymbol{z}\\_{t'} &= \\sigma(\\boldsymbol{W}\\_{yz} \\boldsymbol{y}\\_{t'-1} + \\boldsymbol{W}\\_{sz} \\boldsymbol{s}\\_{t' - 1} + \\boldsymbol{W}\\_{cz} \\boldsymbol{c}\\_{t'} + \\boldsymbol{b}\\_z),\\\\\\\\ \\tilde{\\boldsymbol{s}}\\_{t'} &= \\text{tanh}(\\boldsymbol{W}\\_{ys} \\boldsymbol{y}\\_{t'-1} + \\boldsymbol{W}\\_{ss} (\\boldsymbol{s}\\_{t' - 1} \\odot \\boldsymbol{r}\\_{t'}) + \\boldsymbol{W}\\_{cs} \\boldsymbol{c}\\_{t'} + \\boldsymbol{b}\\_s), \\end{aligned}\\end{split}å…¶ä¸­å«ä¸‹æ ‡çš„ W å’Œ b åˆ†åˆ«ä¸ºé—¨æ§å¾ªç¯å•å…ƒçš„æƒé‡å‚æ•°å’Œåå·®å‚æ•°ã€‚ 3.3 å°ç»“ å¯ä»¥åœ¨decodeçš„æ¯ä¸ªæ—¶é—´æ­¥ä½¿ç”¨ä¸åŒçš„èƒŒæ™¯å˜é‡ï¼Œå¹¶å¯¹è¾“å…¥åºåˆ—ä¸­ä¸åŒæ—¶é—´æ­¥ç¼–ç çš„ä¿¡æ¯åˆ†é…ä¸åŒçš„æ³¨æ„åŠ›ã€‚ Attentionæœºåˆ¶å¯ä»¥é‡‡ç”¨æ›´ä¸ºé«˜æ•ˆçš„çŸ¢é‡åŒ–è®¡ç®—ã€‚ 4. Seq2Seq Attentionå„ç§å˜å½¢ç¬¬å››ä¸ªSeq-to-Seqæ¨¡å‹ï¼Œæ¥è‡ªäºè®ºæ–‡ Effective Approaches to Attention-based Neural Machine Translation è¿™ç¯‡è®ºæ–‡æå‡ºäº†ä¸¤ç§ Seq2Seqæ¨¡å‹ åˆ†åˆ«æ˜¯global Attention å’Œ local Attentionã€‚ 5. Seq2Seq with Beam-Searchä¸Šé¢è®²çš„å‡ ç§Seq2Seqæ¨¡å‹éƒ½æ˜¯ä»æ¨¡å‹ç»“æ„ä¸Šè¿›è¡Œçš„æ”¹è¿›ï¼Œä¹Ÿå°±è¯´ä¸ºäº†ä»è®­ç»ƒçš„å±‚é¢ä¸Šæ”¹å–„æ¨¡å‹çš„æ•ˆæœï¼Œä½†è¿™é‡Œè¦ä»‹ç»çš„beam-searchæ˜¯åœ¨æµ‹è¯•çš„æ—¶å€™æ‰ç”¨åˆ°çš„æŠ€æœ¯ã€‚ Reference åŠ¨æ‰‹å­¦æ·±åº¦å­¦ä¹ ç¬¬åå…«è¯¾ï¼šseq2seqï¼ˆç¼–ç å™¨å’Œè§£ç å™¨ï¼‰å’Œæ³¨æ„åŠ›æœºåˆ¶ é—¨æ§å¾ªç¯å•å…ƒï¼ˆGRUï¼‰ seq2seq+Attentionæœºåˆ¶æ¨¡å‹è¯¦è§£ ä¸‰åˆ†é’Ÿå¸¦ä½ å¯¹ Softmax åˆ’é‡ç‚¹ Softmax å›å½’","categories":[{"name":"chatbot","slug":"chatbot","permalink":"http://iequa.com/categories/chatbot/"}],"tags":[{"name":"Attention","slug":"Attention","permalink":"http://iequa.com/tags/Attention/"}]},{"title":"Glove å’Œ fastText","slug":"nlp/glove_p1","date":"2018-11-15T23:00:21.000Z","updated":"2019-10-20T04:30:35.068Z","comments":true,"path":"2018/11/16/nlp/glove_p1/","link":"","permalink":"http://iequa.com/2018/11/16/nlp/glove_p1/","excerpt":"æœ¬èŠ‚ä»‹ç»ä¸¤ç§æ›´æ–°ä¸€ç‚¹çš„è¯å‘é‡ã€‚åˆ†åˆ«æ˜¯2014å¹´Stanfordå‘è¡¨çš„Gloveå’Œ2017å¹´ç”±Facebookå‘è¡¨çš„fastText.","text":"æœ¬èŠ‚ä»‹ç»ä¸¤ç§æ›´æ–°ä¸€ç‚¹çš„è¯å‘é‡ã€‚åˆ†åˆ«æ˜¯2014å¹´Stanfordå‘è¡¨çš„Gloveå’Œ2017å¹´ç”±Facebookå‘è¡¨çš„fastText. è®©æˆ‘ä»¬å…ˆå›é¡¾ä¸€ä¸‹ word2vec ä¸­çš„è·³å­—æ¨¡å‹ã€‚å°†è·³å­—æ¨¡å‹ä¸­ä½¿ç”¨ softmax è¿ç®—è¡¨è¾¾çš„æ¡ä»¶æ¦‚ç‡ $\\mathbb{P}(w_j\\mid w_i)$. è®°ä½œ $q_{ij}$ï¼Œå³ q\\_{ij}=\\frac{\\exp(\\mathbf{u}\\_j^\\top \\mathbf{v}\\_i)}{ \\sum\\_{k \\in \\mathcal{V}} \\text{exp}(\\mathbf{u}\\_k^\\top \\mathbf{v}\\_i)},GloVe æ¨¡å‹æœ‰é‰´äºæ­¤ï¼Œä½œä¸ºåœ¨ word2vec ä¹‹åæå‡ºçš„è¯åµŒå…¥æ¨¡å‹ï¼ŒGloVe é‡‡ç”¨äº†å¹³æ–¹æŸå¤±ï¼Œå¹¶åŸºäºè¯¥æŸå¤±å¯¹è·³å­—æ¨¡å‹åšäº†ä¸‰ç‚¹æ”¹åŠ¨ ä»æ¡ä»¶æ¦‚ç‡æ¯”å€¼ç†è§£ GloVeæˆ‘ä»¬è¿˜å¯ä»¥ä»å¦å¤–ä¸€ä¸ªè§’åº¦æ¥ç†è§£ GloVe è¯åµŒå…¥ã€‚æ²¿ç”¨æœ¬èŠ‚å‰é¢çš„ç¬¦å·ï¼Œ$\\mathbb{P}(w_j \\mid w_i)$ è¡¨ç¤ºæ•°æ®é›†ä¸­ä»¥ $w_i$ ä¸ºä¸­å¿ƒè¯ç”ŸæˆèƒŒæ™¯è¯ $w_j$ çš„æ¡ä»¶æ¦‚ç‡ï¼Œå¹¶è®°ä½œ $p_{ij}$ã€‚ä½œä¸ºæºäºæŸå¤§å‹è¯­æ–™åº“çš„çœŸå®ä¾‹å­ï¼Œä»¥ä¸‹åˆ—ä¸¾äº†ä¸¤ç»„åˆ†åˆ«ä»¥â€œiceâ€ï¼ˆâ€œå†°â€ï¼‰å’Œâ€œsteamâ€ï¼ˆâ€œè’¸æ±½â€ï¼‰ä¸ºä¸­å¿ƒè¯çš„æ¡ä»¶æ¦‚ç‡ä»¥åŠå®ƒä»¬ä¹‹é—´çš„æ¯”å€¼ [1]ï¼š $w_k$= â€œsolidâ€ â€œgasâ€ â€œwaterâ€ â€œfashionâ€ $p_1=\\mathbb{P}(w_k\\mid\\text{â€œiceâ€})$ 0.00019 0.000066 0.003 0.000017 $p_2=\\mathbb{P}(w_k\\mid\\text{â€œsteamâ€})$ 0.000022 0.00078 0.0022 0.000018 $p_1/p_2$ 8.9 0.085 1.36 0.96 æˆ‘ä»¬å¯ä»¥è§‚å¯Ÿåˆ°ä»¥ä¸‹ç°è±¡ï¼š å¯¹äºä¸â€œiceâ€ç›¸å…³è€Œä¸â€œsteamâ€ä¸ç›¸å…³çš„è¯ $w_k$ï¼Œä¾‹å¦‚ $w_k=$â€œsolidâ€ï¼ˆâ€œå›ºä½“â€ï¼‰ï¼Œæˆ‘ä»¬æœŸæœ›æ¡ä»¶æ¦‚ç‡æ¯”å€¼è¾ƒå¤§ï¼Œä¾‹å¦‚ä¸Šè¡¨æœ€åä¸€è¡Œä¸­çš„å€¼ 8.9ï¼› å¯¹äºä¸â€œiceâ€ä¸ç›¸å…³è€Œä¸ steam ç›¸å…³çš„è¯ $w_k$ï¼Œä¾‹å¦‚ $w_k=$â€œgasâ€ï¼ˆâ€œæ°”ä½“â€ï¼‰ï¼Œæˆ‘ä»¬æœŸæœ›æ¡ä»¶æ¦‚ç‡æ¯”å€¼è¾ƒå°ï¼Œä¾‹å¦‚ä¸Šè¡¨æœ€åä¸€è¡Œä¸­çš„å€¼ 0.085ï¼› å¯¹äºä¸â€œiceâ€å’Œâ€œsteamâ€éƒ½ç›¸å…³çš„è¯ $w_k$ï¼Œä¾‹å¦‚ $w_k=$â€œwaterâ€ï¼ˆâ€œæ°´â€ï¼‰ï¼Œæˆ‘ä»¬æœŸæœ›æ¡ä»¶æ¦‚ç‡æ¯”å€¼æ¥è¿‘ 1ï¼Œä¾‹å¦‚ä¸Šè¡¨æœ€åä¸€è¡Œä¸­çš„å€¼ 1.36ï¼› å¯¹äºä¸â€œiceâ€å’Œâ€œsteamâ€éƒ½ä¸ç›¸å…³çš„è¯ $w_k$ï¼Œä¾‹å¦‚ $w_k=$â€œfashionâ€ï¼ˆâ€œæ—¶å°šâ€ï¼‰ï¼Œæˆ‘ä»¬æœŸæœ›æ¡ä»¶æ¦‚ç‡æ¯”å€¼æ¥è¿‘ 1ï¼Œä¾‹å¦‚ä¸Šè¡¨æœ€åä¸€è¡Œä¸­çš„å€¼ 0.96ã€‚ ç”±æ­¤å¯è§ï¼Œæ¡ä»¶æ¦‚ç‡æ¯”å€¼èƒ½æ¯”è¾ƒç›´è§‚åœ°è¡¨è¾¾è¯ä¸è¯ä¹‹é—´çš„å…³ç³»ã€‚æˆ‘ä»¬å¯ä»¥æ„é€ ä¸€ä¸ªè¯å‘é‡å‡½æ•°ä½¿å¾—å®ƒèƒ½æœ‰æ•ˆæ‹Ÿåˆæ¡ä»¶æ¦‚ç‡æ¯”å€¼ã€‚æˆ‘ä»¬çŸ¥é“ï¼Œä»»æ„ä¸€ä¸ªè¿™æ ·çš„æ¯”å€¼éœ€è¦ä¸‰ä¸ªè¯ $w_i$ã€$w_j$ å’Œ $w_k$ã€‚ä»¥ $w_i$ ä½œä¸ºä¸­å¿ƒè¯çš„æ¡ä»¶æ¦‚ç‡æ¯”å€¼ä¸º ${p_{ij}}/{p_{ik}}$ã€‚æˆ‘ä»¬å¯ä»¥æ‰¾ä¸€ä¸ªå‡½æ•°ï¼Œå®ƒä½¿ç”¨è¯å‘é‡æ¥æ‹Ÿåˆè¿™ä¸ªæ¡ä»¶æ¦‚ç‡æ¯”å€¼ f(\\boldsymbol{u}\\_j, \\boldsymbol{u}\\_k, {\\boldsymbol{v}}\\_i) \\approx \\frac{p\\_{ij}}{p\\_{ik}}.è¿™é‡Œå‡½æ•° $f$ å¯èƒ½çš„è®¾è®¡å¹¶ä¸å”¯ä¸€ï¼Œæˆ‘ä»¬åªéœ€è€ƒè™‘ä¸€ç§è¾ƒä¸ºåˆç†çš„å¯èƒ½æ€§ã€‚æ³¨æ„åˆ°æ¡ä»¶æ¦‚ç‡æ¯”å€¼æ˜¯ä¸€ä¸ªæ ‡é‡ï¼Œæˆ‘ä»¬å¯ä»¥å°† $f$ é™åˆ¶ä¸ºä¸€ä¸ªæ ‡é‡å‡½æ•°ï¼š$f(\\boldsymbol{u}_j, \\boldsymbol{u}_k, {\\boldsymbol{v}}_i) = f\\left((\\boldsymbol{u}_j - \\boldsymbol{u}_k)^\\top {\\boldsymbol{v}}_i\\right)$ã€‚äº¤æ¢ç´¢å¼• $j$ å’Œ $k$ åå¯ä»¥çœ‹åˆ°å‡½æ•° $f$ åº”è¯¥æ»¡è¶³ $f(x)f(-x)=1$ï¼Œå› æ­¤ä¸€ä¸ªå¯èƒ½æ˜¯ $f(x)=\\exp(x)$ï¼Œäºæ˜¯ f(\\boldsymbol{u}\\_j, \\boldsymbol{u}\\_k, {\\boldsymbol{v}}\\_i) = \\frac{\\exp\\left(\\boldsymbol{u}\\_j^\\top {\\boldsymbol{v}}\\_i\\right)}{\\exp\\left(\\boldsymbol{u}\\_k^\\top {\\boldsymbol{v}}\\_i\\right)} \\approx \\frac{p\\_{ij}}{p\\_{ik}}.æ»¡è¶³æœ€å³è¾¹çº¦ç­‰å·çš„ä¸€ä¸ªå¯èƒ½æ˜¯ $\\exp\\left(\\boldsymbol{u}_j^\\top {\\boldsymbol{v}}_i\\right) \\approx \\alpha p_{ij}$ï¼Œè¿™é‡Œ $\\alpha$ æ˜¯ä¸€ä¸ªå¸¸æ•°ã€‚è€ƒè™‘åˆ° $p_{ij}=x{ij}/x_i$ï¼Œå–å¯¹æ•°å $\\boldsymbol{u}_j^\\top {\\boldsymbol{v}}_i \\approx \\log\\,\\alpha + \\log\\,x\\{ij} - \\log\\,x_i$ã€‚æˆ‘ä»¬ä½¿ç”¨é¢å¤–çš„åå·®é¡¹æ¥æ‹Ÿåˆ $- \\log\\,\\alpha + \\log\\,x_i$ï¼Œä¾‹å¦‚ä¸­å¿ƒè¯åå·®é¡¹ $b_i$ å’ŒèƒŒæ™¯è¯åå·®é¡¹ $c_j$ï¼š \\boldsymbol{u}\\_j^\\top \\boldsymbol{v}\\_i + b\\_i + c\\_j \\approx \\log(x\\_{ij}).å¯¹ä¸Šå¼å·¦å³ä¸¤è¾¹å–å¹³æ–¹è¯¯å·®å¹¶åŠ æƒï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ° GloVe çš„æŸå¤±å‡½æ•°ã€‚ å°ç»“ åœ¨æœ‰äº›æƒ…å†µä¸‹ï¼Œäº¤å‰ç†µæŸå¤±å‡½æ•°æœ‰åŠ£åŠ¿ã€‚GloVe é‡‡ç”¨äº†å¹³æ–¹æŸå¤±ï¼Œå¹¶é€šè¿‡è¯å‘é‡æ‹Ÿåˆé¢„å…ˆåŸºäºæ•´ä¸ªæ•°æ®é›†è®¡ç®—å¾—åˆ°çš„å…¨å±€ç»Ÿè®¡ä¿¡æ¯ã€‚ ä»»æ„è¯çš„ä¸­å¿ƒè¯å‘é‡å’ŒèƒŒæ™¯è¯å‘é‡åœ¨ GloVe ä¸­æ˜¯ç­‰ä»·çš„ã€‚ Reference åŠ¨æ‰‹å­¦æ·±åº¦å­¦ä¹ ç¬¬åä¸ƒè¯¾ï¼šGloVeã€fastTextå’Œä½¿ç”¨é¢„è®­ç»ƒçš„è¯å‘é‡","categories":[{"name":"nlp","slug":"nlp","permalink":"http://iequa.com/categories/nlp/"}],"tags":[{"name":"Glove","slug":"Glove","permalink":"http://iequa.com/tags/Glove/"}]},{"title":"TensorFlowï¼šç¬¬8ç«  LSTM & Bi-RNN & Deep RNN","slug":"tensorflow/tf-google-8-rnn-2","date":"2018-11-10T05:00:21.000Z","updated":"2019-10-20T04:30:35.063Z","comments":true,"path":"2018/11/10/tensorflow/tf-google-8-rnn-2/","link":"","permalink":"http://iequa.com/2018/11/10/tensorflow/tf-google-8-rnn-2/","excerpt":"LSTM å¯ä»¥å­¦ä¹ åˆ°è·ç¦»å¾ˆè¿œçš„ä¿¡æ¯ï¼Œè§£å†³äº†RNNæ— æ³•é•¿æœŸä¾èµ–çš„é—®é¢˜ã€‚ Bidirectional RNN è§£å†³çš„æ˜¯ å½“å‰æ—¶åˆ»çš„è¾“å‡ºä¸ä»…å’Œä¹‹å‰çš„çŠ¶æ€æœ‰å…³ç³»ï¼Œä¹Ÿå’Œä¹‹åçš„çŠ¶æ€ç›¸å…³ã€‚ Deep RNNs æ˜¯ ä¸ºäº†å¢å¼ºæ¨¡å‹çš„è¡¨è¾¾èƒ½åŠ›ï¼Œå¯ä»¥åœ¨ç½‘ç»œä¸­è®¾ç½®å¤šä¸ªå¾ªç¯å±‚ï¼Œå°†æ¯å±‚ RNN çš„è¾“å‡ºä¼ ç»™ä¸‹ä¸€å±‚å¤„ç†ã€‚","text":"LSTM å¯ä»¥å­¦ä¹ åˆ°è·ç¦»å¾ˆè¿œçš„ä¿¡æ¯ï¼Œè§£å†³äº†RNNæ— æ³•é•¿æœŸä¾èµ–çš„é—®é¢˜ã€‚ Bidirectional RNN è§£å†³çš„æ˜¯ å½“å‰æ—¶åˆ»çš„è¾“å‡ºä¸ä»…å’Œä¹‹å‰çš„çŠ¶æ€æœ‰å…³ç³»ï¼Œä¹Ÿå’Œä¹‹åçš„çŠ¶æ€ç›¸å…³ã€‚ Deep RNNs æ˜¯ ä¸ºäº†å¢å¼ºæ¨¡å‹çš„è¡¨è¾¾èƒ½åŠ›ï¼Œå¯ä»¥åœ¨ç½‘ç»œä¸­è®¾ç½®å¤šä¸ªå¾ªç¯å±‚ï¼Œå°†æ¯å±‚ RNN çš„è¾“å‡ºä¼ ç»™ä¸‹ä¸€å±‚å¤„ç†ã€‚ 1. LSTM å•å±‚LSTMç»“æ„å®ç°Tensorflowä¸­å®ç°äº†ä»¥ä¸‹æ¨¡å— :tf.nn.rnn_cellï¼ŒåŒ…æ‹¬äº†10ä¸ªç±»ï¼š class BasicLSTMCell: Basic LSTM recurrent network cell. class BasicRNNCell: The most basic RNN cell. class DeviceWrapper: Operator that ensures an RNNCell runs on a particular device. class DropoutWrapper: Operator adding dropout to inputs and outputs of the given cell. class GRUCell: Gated Recurrent Unit cell (cf. http://arxiv.org/abs/1406.1078). class LSTMCell: Long short-term memory unit (LSTM) recurrent network cell. class LSTMStateTuple: Tuple used by LSTM Cells for state_size, zero_state, and output state. class MultiRNNCell: RNN cell composed sequentially of multiple simple cells. class RNNCell: Abstract object representing an RNN cell. class ResidualWrapper: RNNCell wrapper that ensures cell inputs are added to the outputs. åœ¨åŸºæœ¬çš„ LSTM cell ä¸­æˆ‘ä»¬ç”¨ç¬¬ä¸€ä¸ªç±»æ¥è¿›è¡Œå®ç°ï¼Œä»–æ˜¯ tf.contrib.rnn.BasicLSTMCell åŒåç±»ï¼Œå®šä¹‰åœ¨ tensorflow/python/ops/rnn_cell_impl.py ä¸­ _init__( num_units, forget_bias=1.0, state_is_tuple=True, activation=None, reuse=None, name=None) å…¶ä¸­å‚æ•°è¡¨ç¤ºï¼š num_units è¡¨ç¤ºç¥ç»å…ƒçš„ä¸ªæ•° forget_bias å°±æ˜¯LSTMä»¬çš„å¿˜è®°ç³»æ•°ï¼Œå¦‚æœç­‰äº1ï¼Œå°±æ˜¯ä¸ä¼šå¿˜è®°ä»»ä½•ä¿¡æ¯ã€‚å¦‚æœç­‰äº0ï¼Œå°±éƒ½å¿˜è®° state_is_tuple é»˜è®¤å°±æ˜¯Trueï¼Œè¡¨ç¤ºè¿”å›çš„çŠ¶æ€æ˜¯ä¸€ä¸ª 2-tuple (c_state, m_state) activation è¡¨ç¤ºå†…éƒ¨çŠ¶æ€çš„æ¿€æ´»å‡½æ•°ï¼Œé»˜è®¤æ˜¯ tanh name è¡¨ç¤ºè¿™ä¸€å±‚çš„åå­—ï¼ŒåŒæ ·åå­—çš„å±‚ä¼šå…±äº«æƒé‡ï¼Œå¦‚æœä¸ºäº†é¿å…è¿™æ ·çš„æƒ…å†µéœ€è¦è®¾ç½®reuse=True é‡‡ç”¨BasicLSTMCellæ¥å£°æ˜LSTMç»“æ„å¦‚ä¸‹æ‰€ç¤ºï¼Œæˆ‘ä»¬ç”¨ä¼ªä»£ç å’Œæ³¨é‡Šæ¥è¿›è¡Œè¯´æ˜ã€‚ import tensorflow as tf# å®šä¹‰ä¸€ä¸ªlstmç»“æ„ï¼Œåœ¨tensorflowä¸­é€šè¿‡ä¸€å¥è¯å°±èƒ½å®ç°ä¸€ä¸ªå®Œæ•´çš„lstmç»“æ„# lstm_hidden_size è¡¨ç¤º LSTM cell ä¸­ç¥ç»å…ƒçš„æ•°é‡ã€‚ cellå…¶å®å°±æ˜¯ä¸€ä¸ªRNNçš„ç½‘ç»œã€‚lstm = tf.nn.rnn_cell.BasicLSTMCell(lstm_hidden_size)# å°†lstmä¸­çš„çŠ¶æ€åˆå§‹åŒ–ä¸ºå…¨0æ•°ç»„ï¼ŒBasicLSTMCellæä¾›äº†zero_stateæ¥ç”Ÿæˆå…¨0æ•°ç»„# åœ¨ä¼˜åŒ–RNNæ—¶æ¯æ¬¡ä¹Ÿä¼šä½¿ç”¨ä¸€ä¸ªbatchçš„è®­ç»ƒæ ·æœ¬ï¼Œbatch_sizeç»™å‡ºäº†ä¸€ä¸ªbatchçš„å¤§å°state = lstm.zero_state(batch_size, tf.float32)# å®šä¹‰æŸå¤±å‡½æ•°loss = 0.0# ä¸ºäº†åœ¨è®­ç»ƒä¸­é¿å…æ¢¯åº¦å¼¥æ•£çš„æƒ…å†µï¼Œè§„å®šä¸€ä¸ªæœ€å¤§çš„åºåˆ—é•¿åº¦num_stepsfor i in range(num_steps): # åœ¨ç¬¬ä¸€ä¸ªæ—¶åˆ»å£°æ˜lstmç»“æ„ä¸­ä½¿ç”¨çš„å˜é‡ï¼Œåœ¨ä¹‹åçš„æ—¶åˆ»éƒ½éœ€è¦é‡å¤ä½¿ç”¨ä¹‹å‰å®šä¹‰å¥½çš„å˜é‡ if i&gt;0: tf.get_variable_scope().reuse_variables() # æ¯ä¸€æ­¥å¤„ç†æ—¶é—´åºåˆ—ä¸­çš„ä¸€ä¸ªæ—¶åˆ»ï¼Œå°†å½“å‰è¾“å…¥current_inputå’Œå‰ä¸€æ—¶åˆ»çŠ¶æ€stateä¼ å…¥LSTMç»“æ„ # å°±å¯ä»¥å¾—åˆ°å½“å‰lstmç»“æ„çš„è¾“å‡ºlstm_outputå’Œæ›´æ–°åçš„çŠ¶æ€state lstm_output, state = lstm(current_input, state) # å°†å½“å‰æ—¶åˆ»lstmè¾“å‡ºä¼ å…¥ä¸€ä¸ªå…¨è¿æ¥å±‚å¾—åˆ°æœ€åçš„è¾“å‡º final_output = fully_connected(lstm_output) # è®¡ç®—å½“å‰æ—¶åˆ»è¾“å‡ºçš„æŸå¤± loss += calc_loss(final_output, expected_output) 2. Bidirectional RNN Bidirectional RNN åŒå‘é€’å½’ç¥ç»ç½‘ç»œ. è¯¥ç¥ç»ç½‘ç»œé¦–å…ˆä»æ­£é¢ç†è§£ä¸€éè¿™å¥è¯ï¼Œå†ä»åæ–¹å‘ç†è§£ä¸€é. 3. Deep RNNs Deep RNNs æ·±å±‚ï¼Œé¡¾åæ€ä¹‰å°±æ˜¯å±‚æ¬¡å¢ã€‚ æ¨ªå‘è¡¨ç¤ºæ—¶é—´å±•å¼€ï¼Œçºµå‘åˆ™æ˜¯å±‚æ¬¡å±•å¼€ã€‚ MultiRNNCellçš„åˆå§‹åŒ–æ–¹æ³•å¦‚ä¸‹ __init__( cells, state_is_tuple=True) å…¶ä¸­ cells è¡¨ç¤º RNNCells çš„ listï¼ŒæŒ‰ç…§é¡ºåºä»è¾“å…¥åˆ°è¾“å‡ºæ¥è¡¨ç¤ºä¸åŒå±‚çš„å¾ªç¯å±‚ state_is_tuple è¡¨ç¤º æ¥å—å’Œè¿”å›çš„çŠ¶æ€éƒ½æ˜¯ n-tuples, å…¶ä¸­ n = len(cells)ï¼Œå»ºè®®é‡‡ç”¨True åŒæ ·MultiRNNCellæä¾›äº†çŠ¶æ€åˆå§‹åŒ–çš„å‡½æ•° zero_state( batch_size, dtype) æˆ‘ä»¬æ¥ä¸‹æ¥ç”¨ä¼ªä»£ç å’Œæ³¨é‡Šæ¥è¯´æ˜Deep RNNå¦‚ä½•å®ç° # å®šä¹‰ä¸€ä¸ªåŸºæœ¬çš„LSTMç»“æ„ä½œä¸ºå¾ªç¯ä½“çš„åŸºç¡€ç»“æ„ï¼Œå½“ç„¶ä¹Ÿæ”¯æŒä½¿ç”¨å…¶ä»–çš„å¾ªç¯ä½“ç»“æ„lstm_cell = tf.nn.rnn_cell.BasicLSTMCell# é€šè¿‡MultiRNNCellsç±»æ¥å®ç°Deep RNNï¼Œå…¶ä¸­number_of_layersè¡¨ç¤ºæœ‰å¤šå°‘å±‚ï¼Œlstm_sizeè¡¨ç¤ºæ¯å±‚çš„å•å…ƒæ•°é‡stacked_lstm = tf.nn.rnn_cell.MultiRNNCell([lstm_cell(lstm_size) for _ in range(number_of_layers)])# åˆå§‹åŒ–å¹¶è·å–åˆå§‹çŠ¶æ€state = stacked_lstm.zeros_state(batch_size, tf.float32)foor i in range(len(num_steps)): if i &gt; 0: tf.get_variable_scope().reuse_variables() # æ ¹æ®å½“å‰è¾“å…¥current_input(x_t) å’Œå‰ä¸€é˜¶æ®µçŠ¶æ€state(h_(t-1), s_(t-1)) æ¥å‰å‘è®¡ç®—å¾—åˆ°å½“å‰çŠ¶æ€state(h_t, s_t) å’Œè¾“å‡ºstacked_lstm_output (h_t) stacked_lstm_output, state = stacked_lstm(current_input, state) # è¾“å‡ºå–‚ç»™å…¨è”æ¥å±‚ final_output = fully_connected(stacked_lstm_output) # è®¡ç®—æŸå¤± loss += calc_loss(final_output, expected_output) # è¿›è¡Œä¼˜åŒ– ....... Reference æ·±å…¥æµ…å‡ºTensorflowï¼ˆäº”ï¼‰ï¼šå¾ªç¯ç¥ç»ç½‘ç»œç®€ä»‹ Tensorflowå®æˆ˜(1): å®ç°æ·±å±‚å¾ªç¯ç¥ç»ç½‘ç»œ zh.gluon.ai åŠ¨æ‰‹å­¦æ·±åº¦å­¦ä¹  æ­£ç¡®ç†è§£ cell ä¸ hidden size çš„åŒºåˆ«","categories":[{"name":"tensorflow","slug":"tensorflow","permalink":"http://iequa.com/categories/tensorflow/"}],"tags":[{"name":"RNN","slug":"RNN","permalink":"http://iequa.com/tags/RNN/"}]},{"title":"TensorFlowï¼š ç¬¬8ç«  å¾ªç¯ç¥ç»ç½‘ç»œ 1","slug":"tensorflow/tf-google-8-rnn-1","date":"2018-11-08T14:00:21.000Z","updated":"2019-10-20T04:30:35.056Z","comments":true,"path":"2018/11/08/tensorflow/tf-google-8-rnn-1/","link":"","permalink":"http://iequa.com/2018/11/08/tensorflow/tf-google-8-rnn-1/","excerpt":"å®æˆ˜Googleæ·±åº¦å­¦ä¹ æ¡†æ¶ ç¬”è®°-ç¬¬8ç«  å¾ªç¯ç¥ç»ç½‘ç»œ-1-å‰å‘ä¼ æ’­ã€‚ Github: RNN-1-Forward_Propagation.ipynb","text":"å®æˆ˜Googleæ·±åº¦å­¦ä¹ æ¡†æ¶ ç¬”è®°-ç¬¬8ç«  å¾ªç¯ç¥ç»ç½‘ç»œ-1-å‰å‘ä¼ æ’­ã€‚ Github: RNN-1-Forward_Propagation.ipynb è¿ç®—çš„æµç¨‹å›¾å¯å‚è€ƒä¸‹é¢è¿™å¼ å›¾ RNN Forward PropagationRNN å‰å‘ä¼ æ’­çŸ¥è¯†å›é¡¾ $a^{}=\\vec{0}$ $a^{}=g_1(W_{aa}a^{}+W_{ax}x^{}+b_a)$ $y^{}=g_2(W_{ya}a^{}+b_y)$ $a^{&lt;{t}&gt;}=g_1(W_{aa}a^{&lt;{t-1}&gt;}+W_{ax}x^{&lt;{t}&gt;}+b_a)$ $y^{&lt;{t}&gt;}=g_2(W_{ya}a^{&lt;{t}&gt;}+b_y)$ æ¿€æ´»å‡½æ•°ï¼š$g_1$ ä¸€èˆ¬ä¸º tanhå‡½æ•° (æˆ–è€…æ˜¯ Reluå‡½æ•°)ï¼Œ$g_2$ ä¸€èˆ¬æ˜¯ Sigmodå‡½æ•°. æ³¨æ„: å‚æ•°çš„ä¸‹æ ‡æ˜¯æœ‰é¡ºåºå«ä¹‰çš„ï¼Œå¦‚ $W_{ax}$ ä¸‹æ ‡çš„ç¬¬ä¸€ä¸ªå‚æ•°è¡¨ç¤ºè¦è®¡ç®—çš„é‡çš„ç±»å‹ï¼Œå³è¦è®¡ç®— $a$ çŸ¢é‡ï¼Œç¬¬äºŒä¸ªå‚æ•°è¡¨ç¤ºè¦è¿›è¡Œä¹˜æ³•è¿ç®—çš„æ•°æ®ç±»å‹ï¼Œå³éœ€è¦ä¸ $x$ çŸ¢é‡åšè¿ç®—ã€‚å¦‚ $W_{ax} x^{t}\\rightarrow{a}$ 1. å®šä¹‰RNNçš„å‚æ•°è¿™ä¸ªä¾‹å­æ˜¯ç”¨npå†™çš„ï¼Œæ²¡ç”¨åˆ°tensorflow import numpy as np# åˆå§‹åŒ–ï¼Œ state = a^&#123;&lt;0&gt;&#125; ä¸ å®šä¹‰ X æ—¶é—´åºåˆ—å‚æ•°X = [1, 2]state = [0.0, 0.0] # a^&#123;&lt;0&gt;&#125;# åˆ†å¼€å®šä¹‰ä¸åŒè¾“å…¥éƒ¨åˆ†çš„æƒé‡ä»¥æ–¹ä¾¿æ“ä½œw_cell_state = np.asarray([[0.1, 0.2], [0.3, 0.4]]) # W_&#123;aa&#125;w_cell_input = np.asarray([[0.5, 0.6]]) # W_&#123;ax&#125;b_cell = np.asarray([0.1, -0.1])# å®šä¹‰ç”¨äºè¾“å‡ºçš„å…¨è¿æ¥å±‚å‚æ•°ï¼Œ ä¸ state = a^&#123;&lt;i&gt;&#125; çš„ shape ç›¸åç½®w_output = np.asarray([[0.1], [2.0]])b_output = 0.1 2. æ‰§è¡Œå‰å‘ä¼ æ’­çš„è¿‡ç¨‹# æŒ‰ç…§æ—¶é—´é¡ºåºæ‰§è¡Œå¾ªç¯å®¡è®¡ç½‘ç»œçš„å‰å‘ä¼ æ’­è¿‡ç¨‹for i in range(len(X)): # è®¡ç®—å¾ªç¯ä½“ä¸­çš„å…¨è¿æ¥å±‚ç¥ç»ç½‘ç»œ before_activation = np.dot(state, w_cell_state) + X[i] * w_cell_input + b_cell state = np.tanh(before_activation) final_output = np.dot(state, w_output) + b_output print(&quot;iteration round:&quot;, i+1) print(&quot;before activation: &quot;, before_activation) print(&quot;state: &quot;, state) print(&quot;output: &quot;, final_output) output: iteration round: 1before activation: [[0.95107374 1.0254142 ]]state: [[0.74026877 0.7720626 ]]output: [[1.71815207]]iteration round: 2before activation: [[1.40564566 1.55687879]]state: [[0.88656589 0.91491336]]output: [[2.0184833]] å’Œå…¶ä»–ç¥ç»ç½‘ç»œç±»ä¼¼ï¼Œåœ¨å®šä¹‰å®ŒæŸå¤±å‡½æ•°ä¹‹åï¼Œå¥—ç”¨ç¬¬4ç« ä¸­ä»‹ç»çš„ä¼˜åŒ–æ¡†æ¶TensorFlowå°±å¯ä»¥è‡ªåŠ¨å®Œæˆæ¨¡å‹è®­ç»ƒçš„è¿‡ç¨‹ã€‚è¿™é‡Œå”¯ä¸€éœ€è¦ç‰¹åˆ«æŒ‡å‡ºçš„æ˜¯ï¼Œç†è®ºä¸Šå¾ªç¯ç¥ç»ç½‘ç»œå¯ä»¥æ”¯æŒä»»æ„é•¿åº¦çš„åºåˆ—ï¼Œç„¶è€Œåœ¨å®é™…ä¸­ï¼Œå¦‚æœåºåˆ—è¿‡é•¿ä¼šå¯¼è‡´ä¼˜åŒ–æ—¶å‡ºç°æ¢¯åº¦æ¶ˆæ•£çš„é—®é¢˜ï¼ˆthe vanishing gradient problemï¼‰ (8) ï¼Œæ‰€ä»¥å®é™…ä¸­ä¸€èˆ¬ä¼šè§„å®šä¸€ä¸ªæœ€å¤§é•¿åº¦ï¼Œå½“åºåˆ—é•¿åº¦è¶…è¿‡è§„å®šé•¿åº¦ä¹‹åä¼šå¯¹åºåˆ—è¿›è¡Œæˆªæ–­ã€‚ Reference çŸ¥ä¹ï¼šã€ŠTensorFlowï¼šå®æˆ˜Googleæ·±åº¦å­¦ä¹ æ¡†æ¶ã€‹ç¬”è®°ã€ä»£ç åŠå‹˜è¯¯-ç¬¬8ç«  å¾ªç¯ç¥ç»ç½‘ç»œ-1-å‰å‘ä¼ æ’­ 7å¤©æ—¶é—´ï¼š å¾ªç¯ç¥ç»ç½‘ç»œç®€ä»‹ (1)","categories":[{"name":"tensorflow","slug":"tensorflow","permalink":"http://iequa.com/categories/tensorflow/"}],"tags":[{"name":"RNN","slug":"RNN","permalink":"http://iequa.com/tags/RNN/"}]},{"title":"TensorFlow - tf.contrib.learn åˆ›å»º Estimator","slug":"tensorflow/tf-5.4-contrib-learn-Estimator","date":"2018-11-04T02:10:21.000Z","updated":"2019-10-20T04:30:35.061Z","comments":true,"path":"2018/11/04/tensorflow/tf-5.4-contrib-learn-Estimator/","link":"","permalink":"http://iequa.com/2018/11/04/tensorflow/tf-5.4-contrib-learn-Estimator/","excerpt":"tf.contrib.learn æ¡†æ¶å¯ä»¥é€šè¿‡å…¶é«˜çº§åˆ«çš„ Estimator API è½»æ¾æ„å»ºå’Œè®­ç»ƒæœºå™¨å­¦ä¹ æ¨¡å‹. Estimator æä¾›æ‚¨å¯ä»¥å®ä¾‹åŒ–çš„ç±»ä»¥å¿«é€Ÿé…ç½®å¸¸è§çš„æ¨¡å‹ç±»å‹ï¼Œå¦‚ regressors å’Œ classifiersï¼š","text":"tf.contrib.learn æ¡†æ¶å¯ä»¥é€šè¿‡å…¶é«˜çº§åˆ«çš„ Estimator API è½»æ¾æ„å»ºå’Œè®­ç»ƒæœºå™¨å­¦ä¹ æ¨¡å‹. Estimator æä¾›æ‚¨å¯ä»¥å®ä¾‹åŒ–çš„ç±»ä»¥å¿«é€Ÿé…ç½®å¸¸è§çš„æ¨¡å‹ç±»å‹ï¼Œå¦‚ regressors å’Œ classifiersï¼š tf.contrib.learn.LinearClassifier tf.contrib.learn.LinearRegressor tf.contrib.learn.DNNClassifier tf.contrib.learn.DNNRegressor tf.contrib.learnâ€¦â€¦ å®Œæ•´ä»£ç ï¼š Github é²é±¼å¹´é¾„é¢„æµ‹å™¨ r1.11 Abalone Age Predictor Reference åœ¨tf.contrib.learnä¸­åˆ›å»ºä¼°ç®—å™¨","categories":[{"name":"tensorflow","slug":"tensorflow","permalink":"http://iequa.com/categories/tensorflow/"}],"tags":[{"name":"tensorflow","slug":"tensorflow","permalink":"http://iequa.com/tags/tensorflow/"}]},{"title":"TensorFlow - tf.contrib.learn åŸºç¡€çš„è®°å½•å’Œç›‘æ§æ•™ç¨‹","slug":"tensorflow/tf-5.3-contrib-learn-MonitorAPI","date":"2018-11-04T01:10:21.000Z","updated":"2019-10-20T04:30:35.060Z","comments":true,"path":"2018/11/04/tensorflow/tf-5.3-contrib-learn-MonitorAPI/","link":"","permalink":"http://iequa.com/2018/11/04/tensorflow/tf-5.3-contrib-learn-MonitorAPI/","excerpt":"è®­ç»ƒæ¨¡å‹æ—¶ï¼Œå®æ—¶è·Ÿè¸ªå’Œè¯„ä¼°è¿›åº¦é€šå¸¸å¾ˆæœ‰ä»·å€¼ã€‚ å­¦ä¹ ä½¿ç”¨TensorFlowçš„æ—¥å¿—è®°å½•åŠŸèƒ½å’ŒMonitorAPIæ¥ç›‘ç£æ­£åœ¨ç”¨ç¥ç»ç½‘ç»œåˆ†ç±»å™¨åˆ†ç±»irisesçš„è®­ç»ƒæƒ…å†µã€‚","text":"è®­ç»ƒæ¨¡å‹æ—¶ï¼Œå®æ—¶è·Ÿè¸ªå’Œè¯„ä¼°è¿›åº¦é€šå¸¸å¾ˆæœ‰ä»·å€¼ã€‚ å­¦ä¹ ä½¿ç”¨TensorFlowçš„æ—¥å¿—è®°å½•åŠŸèƒ½å’ŒMonitorAPIæ¥ç›‘ç£æ­£åœ¨ç”¨ç¥ç»ç½‘ç»œåˆ†ç±»å™¨åˆ†ç±»irisesçš„è®­ç»ƒæƒ…å†µã€‚ å®Œæ•´ä»£ç ï¼š # -*- coding: UTF-8 -*-import osimport urllibimport numpy as npimport tensorflow as tf# Data setsIRIS_TRAINING = &quot;iris_training.csv&quot;IRIS_TEST = &quot;iris_test.csv&quot;tf.logging.set_verbosity(tf.logging.INFO)def main(): # First download iris_training.csv and iris_test.csv # Load datasets. training_set = tf.contrib.learn.datasets.base.load_csv_with_header( filename=IRIS_TRAINING, target_dtype=np.int, features_dtype=np.float32) test_set = tf.contrib.learn.datasets.base.load_csv_with_header( filename=IRIS_TEST, target_dtype=np.int, features_dtype=np.float32) # Specify that all features have real-value data feature_columns = [tf.contrib.layers.real_valued_column(&quot;&quot;, dimension=4)] # [_RealValuedColumn(column_name=&#x27;&#x27;, dimension=4, default_value=None, dtype=tf.float32, normalizer=None)] validation_monitor = tf.contrib.learn.monitors.ValidationMonitor( test_set.data, test_set.target, every_n_steps=50) # Build 3 layer DNN with 10, 20, 10 units respectively. classifier = tf.contrib.learn.DNNClassifier( feature_columns=feature_columns, hidden_units=[10, 20, 10], n_classes=3, model_dir=&quot;/tmp/iris_model&quot;, config=tf.contrib.learn.RunConfig(save_checkpoints_secs=1)) # Fit model. classifier.fit(x=training_set.data, y=training_set.target, steps=2000, monitors=[validation_monitor])if __name__ == &quot;__main__&quot;: main() ä»£ç å‚è§ Blairâ€˜s Github - tf.contrib.learn åŸºç¡€çš„è®°å½•å’Œç›‘æ§æ•™ç¨‹ æ•™ç¨‹å‚è§ cwiki.apachecn.org tf.contrib.learn åŸºç¡€çš„è®°å½•å’Œç›‘æ§æ•™ç¨‹ 1. ä½¿ç”¨TensorFlowå¯ç”¨æ—¥å¿—è®°å½•é»˜è®¤æƒ…å†µä¸‹ï¼ŒTensorFlowè¢«é…ç½®åœ¨WARNæ—¥å¿—çº§åˆ«ï¼Œä½†æ˜¯å½“è·Ÿè¸ªæ¨¡å‹è®­ç»ƒæ—¶ï¼Œæ‚¨éœ€è¦å°†çº§åˆ«è°ƒæ•´ä¸ºINFOã€‚ ä»£ç çš„å¼€å¤´ï¼ˆåœ¨importå¯¼å…¥ä¹‹åï¼‰ï¼š tf.logging.set_verbosity(tf.logging.INFO) è¿è¡Œä»£ç æ—¶ï¼Œä¼šçœ‹åˆ°å¦‚ä¸‹æ‰€ç¤ºçš„å…¶ä»–æ—¥å¿—è¾“å‡ºï¼š INFO:tensorflow:loss = 1.18812, step = 1INFO:tensorflow:loss = 0.210323, step = 101INFO:tensorflow:loss = 0.109025, step = 201 ä½¿ç”¨INFOçº§åˆ«æ—¥å¿—è®°å½•ï¼Œtf.contrib.learnä¼šåœ¨æ¯100æ­¥ä¹‹åè‡ªåŠ¨å°†training-loss metricsè¾“å‡ºåˆ°stderrã€‚ 2. é…ç½®éªŒè¯ç›‘è§†å™¨è¿›è¡Œæµè¯„ä¼°è®°å½•è®­ç»ƒæŸå¤±æœ‰åŠ©äºäº†è§£æ‚¨çš„æ¨¡å‹æ˜¯å¦æ”¶æ•›ï¼Œä½†å¦‚æœæ‚¨æƒ³è¿›ä¸€æ­¥äº†è§£è®­ç»ƒä¸­å‘ç”Ÿçš„æƒ…å†µæ€ä¹ˆåŠï¼Ÿtf.contrib.learnæä¾›äº†å‡ ä¸ªé«˜çº§åˆ«Monitorï¼Œæ‚¨å¯ä»¥é™„åŠ åˆ°æ‚¨çš„fitæ“ä½œï¼Œä»¥è¿›ä¸€æ­¥è·Ÿè¸ªmetrics/è°ƒè¯•æ¨¡å‹è®­ç»ƒæœŸé—´çš„æ›´ä½çº§åˆ«TensorFlowæ“ä½œ 2.1 æ¯éš”Næ­¥è¯„ä¼°å¯¹äºirisç¥ç»ç½‘ç»œåˆ†ç±»å™¨ï¼Œåœ¨è®°å½•è®­ç»ƒæŸå¤±æ—¶ï¼Œæ‚¨å¯èƒ½è¿˜éœ€è¦åŒæ—¶å¯¹æµ‹è¯•æ•°æ®è¿›è¡Œè¯„ä¼°ï¼Œä»¥äº†è§£è¯¥æ¨¡å‹çš„æ³›åŒ–ç¨‹åº¦ã€‚ validation_monitor = tf.contrib.learn.monitors.ValidationMonitor( test_set.data, test_set.target, every_n_steps=50) å°†æ­¤ä»£ç æ”¾åœ¨å®ä¾‹åŒ–classifieré‚£è¡Œä¹‹å‰ã€‚ ValidationMonitorä¾é ä¿å­˜çš„checkpointsæ‰§è¡Œè¯„ä¼°æ“ä½œï¼Œå› æ­¤æ‚¨éœ€è¦æ·»åŠ åŒ…å«save_checkpoints_secsçš„tf.contrib.learn.RunConfigå»ä¿®æ”¹classifierçš„å®ä¾‹åŒ–ï¼Œè¯¥å‚æ•°æŒ‡å®šåœ¨è®­ç»ƒæœŸé—´ç»è¿‡å¤šå°‘ç§’ä¿å­˜checkpointã€‚ ç”±äºirisæ•°æ®é›†ç›¸å½“å°ï¼Œå› æ­¤è®­ç»ƒé€Ÿåº¦å¾ˆå¿«ï¼Œè®¾ç½®save_checkpoints_secsä¸º1ï¼ˆæ¯1ç§’ä¿å­˜checkpointï¼‰ï¼š classifier = tf.contrib.learn.DNNClassifier( feature_columns=feature_columns, hidden_units=[10, 20, 10], n_classes=3, model_dir=&quot;/tmp/iris_model&quot;, config=tf.contrib.learn.RunConfig(save_checkpoints_secs=1)) validation_monitorï¼Œæ›´æ–°åŒ…å¿«è°ƒç”¨monitorså‚æ•°çš„fitï¼Œè¯¥å‚æ•°åœ¨æ¨¡å‹è®­ç»ƒæœŸé—´ç”ŸæˆåŒ…å«æ‰€æœ‰monitorsçš„listï¼š classifier.fit(x=training_set.data, y=training_set.target, steps=2000, monitors=[validation_monitor]) é‡æ–°è¿è¡Œä»£ç æ—¶ï¼Œæ‚¨åº”è¯¥åœ¨æ—¥å¿—è¾“å‡ºä¸­çœ‹åˆ°éªŒè¯metricsï¼Œä¾‹å¦‚ï¼š (ä½†æ˜¯æˆ‘è¿™é‡Œè¯•éªŒçš„æ—¶å€™ï¼Œå¹¶æ²¡æœ‰å‡ºç°) INFO:tensorflow:Validation (step 50): loss = 1.71139, global_step = 0, accuracy = 0.266667...INFO:tensorflow:Validation (step 300): loss = 0.0714158, global_step = 268, accuracy = 0.966667...INFO:tensorflow:Validation (step 1750): loss = 0.0574449, global_step = 1729, accuracy = 0.966667 2.2 ä½¿ç”¨MetricSpecå®šä¹‰Evaluation Metrics è¯¦æƒ…å‚è§ cwiki.apachecn.org tf.contrib.learn åŸºç¡€çš„è®°å½•å’Œç›‘æ§æ•™ç¨‹ 2.3 é€šè¿‡ValidationMonitoræå‰åœæ­¢è®­ç»ƒ è¯¦æƒ…å‚è§ cwiki.apachecn.org tf.contrib.learn åŸºç¡€çš„è®°å½•å’Œç›‘æ§æ•™ç¨‹ 3. ç”¨TensorBoardå¯è§†åŒ–æ—¥å¿—æ•°æ®è¯»å–é€šè¿‡ValidationMonitoråœ¨è®­ç»ƒæœŸé—´äº§ç”Ÿå¤§é‡å…³äºæ¨¡å‹æ€§èƒ½çš„åŸå§‹æ•°æ®çš„æ—¥å¿—ï¼Œæ­¤æ•°æ®çš„å¯è§†åŒ–ï¼Œå¯¹è¿›ä¸€æ­¥äº†è§£è¶‹åŠ¿å¯èƒ½ä¼šæœ‰å¸®åŠ©ï¼Œä¾‹å¦‚å‡†ç¡®æ€§å¦‚ä½•éšç€æ­¥æ•°è€Œå˜åŒ–ã€‚ $ tensorboard --logdir=/tmp/iris_model/Starting TensorBoard 39 on port 6006 Reference tf.contrib.learnåŸºç¡€çš„è®°å½•å’Œç›‘æ§æ•™ç¨‹","categories":[{"name":"tensorflow","slug":"tensorflow","permalink":"http://iequa.com/categories/tensorflow/"}],"tags":[{"name":"tensorflow","slug":"tensorflow","permalink":"http://iequa.com/tags/tensorflow/"}]},{"title":"å¤§æ•°æ®å¹³å°CDH6.0é›†ç¾¤åœ¨çº¿å®‰è£…","slug":"hadoop/ops-install-CDH6.0.1","date":"2018-11-02T06:16:21.000Z","updated":"2019-10-20T04:30:35.047Z","comments":true,"path":"2018/11/02/hadoop/ops-install-CDH6.0.1/","link":"","permalink":"http://iequa.com/2018/11/02/hadoop/ops-install-CDH6.0.1/","excerpt":"ä»‹ç»äº† CDH é›†ç¾¤çš„æ­å»ºä¸å®‰è£… æ ‡ç­¾ï¼š Cloudera-Manager CDH Hadoop éƒ¨ç½² é›†ç¾¤","text":"ä»‹ç»äº† CDH é›†ç¾¤çš„æ­å»ºä¸å®‰è£… æ ‡ç­¾ï¼š Cloudera-Manager CDH Hadoop éƒ¨ç½² é›†ç¾¤ ç›®å‰Hadoopæ¯”è¾ƒæµè¡Œçš„ä¸»è¦æœ‰2ä¸ªç‰ˆæœ¬ï¼ŒApacheå’ŒClouderaç‰ˆæœ¬ã€‚ Apache Hadoopï¼šç»´æŠ¤äººå‘˜æ¯”è¾ƒå¤šï¼Œæ›´æ–°é¢‘ç‡æ¯”è¾ƒå¿«ï¼Œä½†æ˜¯ç¨³å®šæ€§æ¯”è¾ƒå·®ã€‚ Cloudera Hadoopï¼ˆCDHï¼‰ï¼šCDHï¼šClouderaå…¬å¸çš„å‘è¡Œç‰ˆæœ¬ï¼ŒåŸºäºApache Hadoopçš„äºŒæ¬¡å¼€å‘ï¼Œä¼˜åŒ–äº†ç»„ä»¶å…¼å®¹å’Œäº¤äº’æ¥å£ã€ç®€åŒ–å®‰è£…é…ç½®ã€å¢åŠ Clouderaå…¼å®¹ç‰¹æ€§ã€‚ 1. æ“ä½œç¯å¢ƒ CentOS 7.3 x64 ï¼ˆ4C/10G/50Gï¼‰ Cloudera Managerï¼š6.0.1 CDH: 6.0.1 ç›¸å…³åŒ…åœ°å€ Cloudera Managerä¸‹è½½åœ°å€ï¼šhttps://archive.cloudera.com/cm6/6.0.0/redhat7/yum/RPMS/x86_64/ cloudera-manager-agent-6.0.0-530873.el7.x86_64.rpm cloudera-manager-daemons-6.0.0-530873.el7.x86_64.rpm cloudera-manager-server-6.0.0-530873.el7.x86_64.rpm cloudera-manager-server-db-2-6.0.0-530873.el7.x86_64.rpm oracle-j2sdk1.8-1.8.0+update141-1.x86_64.rpm CDHå®‰è£…åŒ…åœ°å€ï¼šhttps://archive.cloudera.com/cdh6/6.0.0/parcels/ CDH-6.0.0-1.cdh6.0.0.p0.537114-el7.parcel CDH-6.0.0-1.cdh6.0.0.p0.537114-el7.parcel.sha256 manifest.json æ³¨æ„ï¼šä»¥ä¸‹æ“ä½œå‡ç”¨rootç”¨æˆ·æ“ä½œã€‚ 2. ç½‘ç»œé…ç½®(æ‰€æœ‰èŠ‚ç‚¹)åœ¨æ‰€æœ‰èŠ‚ç‚¹ä¸ŠæŠŠIPå’Œä¸»æœºåçš„å¯¹åº”å…³ç³»å†™å…¥ vim /etc/hosts# æ³¨é‡Šæ‰åŸæœ‰çš„è¯­å¥, å¢åŠ ï¼š192.192.0.25 server192.192.0.26 chdagent1192.192.0.27 chdagent2 åœ¨ç›¸åº”çš„èŠ‚ç‚¹ä¸»æœºä¸Šä¿®æ”¹ä¸»æœºå vim /etc/sysconfig/networkNETWORKING=yesHOSTNAME=cdhserver# ä¿®æ”¹æˆ–è€…æ·»åŠ  HOSTNAME=cdhserver cdhserver æ˜¯ä½ èµ·çš„çš„ä¸»æœºåå­— æ‰§è¡Œå‘½ä»¤ # hostname cdhserver CentOS7è¦å¤šæ‰§è¡Œä»¥ä¸‹è¿™æ­¥ï¼š hostnamectl set-hostname cdhserver 3. æ‰“é€šSSHè®¾ç½®sshæ— å¯†ç ç™»é™†ï¼ˆæ‰€æœ‰èŠ‚ç‚¹ï¼‰ 4. å…³é—­é˜²ç«å¢™å’ŒSELinuxæ³¨æ„ï¼š éœ€è¦åœ¨æ‰€æœ‰çš„èŠ‚ç‚¹ä¸Šæ‰§è¡Œï¼Œå› ä¸ºæ¶‰åŠåˆ°çš„ç«¯å£å¤ªå¤šäº†ï¼Œä¸´æ—¶å…³é—­é˜²ç«å¢™æ˜¯ä¸ºäº†å®‰è£…èµ·æ¥æ›´æ–¹ä¾¿ï¼Œå®‰è£…å®Œæ¯•åå¯ä»¥æ ¹æ®éœ€è¦è®¾ç½®é˜²ç«å¢™ç­–ç•¥ï¼Œä¿è¯é›†ç¾¤å®‰å…¨ã€‚ å…³é—­é˜²ç«å¢™å¹¶å…³é—­è‡ªå¯åŠ¨ï¼š systemctl stop firewalldsystemctl disable firewalld 5. æ‰€æœ‰èŠ‚ç‚¹é…ç½®NTPæœåŠ¡é›†ç¾¤ä¸­æ‰€æœ‰ä¸»æœºå¿…é¡»ä¿æŒæ—¶é—´åŒæ­¥ï¼Œå¦‚æœæ—¶é—´ç›¸å·®è¾ƒå¤§ä¼šå¼•èµ·å„ç§é—®é¢˜ã€‚ å…·ä½“æ€è·¯å¦‚ä¸‹ï¼š masterèŠ‚ç‚¹ä½œä¸ºntpæœåŠ¡å™¨ä¸å¤–ç•Œå¯¹æ—¶ä¸­å¿ƒåŒæ­¥æ—¶é—´ï¼Œéšåå¯¹æ‰€æœ‰datanodeèŠ‚ç‚¹æä¾›æ—¶é—´åŒæ­¥æœåŠ¡ã€‚ æ‰€æœ‰datanodeèŠ‚ç‚¹ä»¥masterèŠ‚ç‚¹ä¸ºåŸºç¡€åŒæ­¥æ—¶é—´ã€‚ æ‰€æœ‰èŠ‚ç‚¹å®‰è£…ç›¸å…³ç»„ä»¶ï¼š yum install ntp å¯åŠ¨æœåŠ¡ï¼š systemctl start ntpd é…ç½®å¼€æœºå¯åŠ¨ï¼š systemctl enable ntpd 6. å®‰è£… python 2.7å¿…é¡»æ˜¯python2.7ç‰ˆæœ¬ï¼ŒCentOS 7 ç³»ç»Ÿå¯ä»¥ä¸ç”¨è£…ï¼Œç³»ç»Ÿè‡ªå¸¦çš„ã€‚ #ä¸‹è½½å¹¶å®‰è£…EPELï¼Œå®‰è£…python-pipï¼Œpsycopg2æœ‰ä¾èµ–[root@localhost ~]# wget http://dl.fedoraproject.org/pub/epel/epel-release-latest-7.noarch.rpm[root@localhost ~]# rpm -ivh epel-release-latest-7.noarch.rpm[root@localhost ~]# yum repolist #æ£€æŸ¥æ˜¯å¦å·²æ·»åŠ è‡³æºåˆ—è¡¨ å‡çº§è½¯ä»¶ä¾èµ–ç‰ˆæœ¬ Starting with CDH 6, PostgreSQL-backed Hue requires the Psycopg2 version to be at least 2.5.4 é¦–å…ˆå®‰è£…epelæ‰©å±•æºï¼š yum -y install epel-releaseyum -y install python-pippip install --upgrade psycopg2 7. å‡†å¤‡Parcelsï¼Œç”¨ä»¥å®‰è£…CDH6å°†CHD6ç›¸å…³çš„ParcelåŒ…æ”¾åˆ°ä¸»èŠ‚ç‚¹çš„/opt/cloudera/parcel-repo/ç›®å½•ä¸­ï¼Œå¦‚æœæ²¡æœ‰æ­¤ç›®å½•ï¼Œå¯ä»¥è‡ªå·±åˆ›å»ºã€‚ CDH-6.0.0-1.cdh6.0.0.p0.537114-el7.parcel CDH-6.0.0-1.cdh6.0.0.p0.537114-el7.parcel.sha256 manifest.json æ³¨æ„ï¼šæœ€åå°†CDH-6.0.0-1.cdh6.0.0.p0.537114-el7.parcel.sha256ï¼Œé‡å‘½åä¸ºCDH-6.0.0-1.cdh6.0.0.p0.537114-el7.parcel.sha å®‰è£…repo: wget https://archive.cloudera.com/cm6/6.0.0/redhat7/yum/cloudera-manager.repo -P /etc/yum.repos.d/ å¯¼å…¥GPG key: rpm --import https://archive.cloudera.com/cm6/6.0.0/redhat7/yum/RPM-GPG-KEY-cloudera JDK install: yum install oracle-j2sdk1.8 æ³¨æ„ ï¼š ä½¿ç”¨ yum ä¸‹è½½ï¼Œéœ€è¦ç¡®å®šç‰ˆæœ¬ä¸å®‰è£…CDH6å®˜æ–¹è¦æ±‚çš„éœ€è¦çš„ç‰ˆæœ¬ä¸€è‡´ ä¹Ÿå¯ä¸ä½¿ç”¨ yum å®‰è£…ï¼Œä½¿ç”¨è‡ªå·±ä¸‹è½½ JDKï¼Œç„¶åæ‰‹åŠ¨ç»¿è‰²å®‰è£…é…ç½® ä¹Ÿå¯åœ¨å®‰è£… CM çš„æ—¶å€™ï¼Œå†æ ¹æ®æç¤ºæ¥å®‰è£…éœ€è¦çš„ JDK ä¸‰ç§æ–¹å¼ä»»é€‰å…¶ä¸€ä¾¿å¯ yumå®‰è£…CM: yum install cloudera-manager-server 8. å®‰è£…MySqlwget http://repo.mysql.com/mysql-community-release-el7-5.noarch.rpmrpm -ivh mysql-community-release-el7-5.noarch.rpmyum updateyum install mysql-serversystemctl start mysqldsystemctl enable mysqld åˆå§‹åŒ–Mysql /usr/bin/mysql_secure_installation é…ç½®JDBC wget https://dev.mysql.com/get/Downloads/Connector-J/mysql-connector-java-5.1.46.tar.gztar zxvf mysql-connector-java-5.1.46.tar.gzmkdir -p /usr/share/java/cd mysql-connector-java-5.1.46cp mysql-connector-java-5.1.46-bin.jar /usr/share/java/mysql-connector-java.jar å»ºåº“ï¼šæ ¹æ®å®˜æ–¹æ–‡æ¡£æä¾›çš„å‘½åå»ºåº“ï¼Œæ–¹ä¾¿è®°å¿†ã€‚(åœ¨CMé…ç½®CDHçš„æ—¶å€™ä¼šç”¨åˆ°è¿™äº›åº“å) Set up the Cloudera Manager Databaseï¼š/opt/cloudera/cm/schema/scm_prepare_database.sh mysql scm scm å‡ºç°å¦‚ä¸‹æ—¥å¿—ï¼š JAVA_HOME=/usr/java/jdk1.8.0_141-clouderaVerifying that we can write to /etc/cloudera-scm-serverCreating SCM configuration file in /etc/cloudera-scm-serverExecuting: /usr/java/jdk1.8.0_141-cloudera/bin/java -cp /usr/share/java/mysql-connector-java.jar:/usr/share/java/oracle-connector-java.jar:/usr/share/java/postgresql-connector-java.jar:/opt/cloudera/cm/schema/../lib/* com.cloudera.enterprise.dbutil.DbCommandExecutor /etc/cloudera-scm-server/db.properties com.cloudera.cmf.db.[main] DbCommandExecutor INFO Successfully connected to database.All done, your SCM database is configured correctly! 9. å¯åŠ¨CMæœåŠ¡å¯åŠ¨ï¼š systemctl start cloudera-scm-server æŸ¥çœ‹æ—¥å¿—ï¼š tail -f /var/log/cloudera-scm-server/cloudera-scm-server.log å‡ºç°ï¼šINFO WebServerImpl:com.cloudera.server.cmf.WebServerImpl: Started Jetty server.åˆ™è¡¨ç¤ºæœåŠ¡æ­£å¸¸å¯åŠ¨ ç™»å½• http://:7180 è´¦å·ï¼šadmin Reference CDH 6.0.0 æ­å»º CDH6.0.0è¯¦ç»†å®‰è£…æ•™ç¨‹åŠæ‰€é‡åˆ°çš„é—®é¢˜ å®˜æ–¹æ–‡æ¡£ - Cloudera Installation Guide","categories":[{"name":"hadoop","slug":"hadoop","permalink":"http://iequa.com/categories/hadoop/"}],"tags":[{"name":"CDH","slug":"CDH","permalink":"http://iequa.com/tags/CDH/"}]},{"title":"TensorFlow - tf.contrib.learn æ„å»ºè¾“å…¥å‡½æ•°","slug":"tensorflow/tf-5.2-contrib-learn-Input-fn","date":"2018-11-01T08:10:21.000Z","updated":"2019-10-20T04:30:35.056Z","comments":true,"path":"2018/11/01/tensorflow/tf-5.2-contrib-learn-Input-fn/","link":"","permalink":"http://iequa.com/2018/11/01/tensorflow/tf-5.2-contrib-learn-Input-fn/","excerpt":"ä»‹ç»å¦‚ä½•åœ¨tf.contrib.learnä¸­åˆ›å»ºè¾“å…¥å‡½æ•°ã€‚äº†è§£å¦‚ä½•æ„å»ºinput_fnå»é¢„å¤„ç†å’Œå°†æ•°æ®è¾“åˆ°æ¨¡å‹ä¸­çš„æ¦‚è¿°ã€‚ å®ç°åˆ©ç”¨input_fnå°†è®­ç»ƒï¼Œè¯„ä¼°å’Œé¢„æµ‹æ•°æ®æä¾›ç»™ç¥ç»ç½‘ç»œå›å½’å™¨ï¼Œç”¨äºé¢„æµ‹æˆ¿ä»·ä¸­ä½æ•°ã€‚","text":"ä»‹ç»å¦‚ä½•åœ¨tf.contrib.learnä¸­åˆ›å»ºè¾“å…¥å‡½æ•°ã€‚äº†è§£å¦‚ä½•æ„å»ºinput_fnå»é¢„å¤„ç†å’Œå°†æ•°æ®è¾“åˆ°æ¨¡å‹ä¸­çš„æ¦‚è¿°ã€‚ å®ç°åˆ©ç”¨input_fnå°†è®­ç»ƒï¼Œè¯„ä¼°å’Œé¢„æµ‹æ•°æ®æä¾›ç»™ç¥ç»ç½‘ç»œå›å½’å™¨ï¼Œç”¨äºé¢„æµ‹æˆ¿ä»·ä¸­ä½æ•°ã€‚ 1. åˆ©ç”¨input_fnè‡ªå®šä¹‰è¾“å…¥Pipelineså½“ä½¿ç”¨ tf.contrib.learn è®­ç»ƒç¥ç»ç½‘ç»œï¼Œå®ƒå¯ä»¥ç›´æ¥é€šè¿‡æ‚¨çš„ç‰¹å¾å’Œç›®æ ‡æ•°æ®è¿›è¡Œè®­ç»ƒï¼Œåˆ†ææˆ–é¢„æµ‹æ“ä½œã€‚è¿™æ˜¯ä¸€ä¸ªä»tf.contrib.learnå¿«é€Ÿå…¥é—¨æ•™ç¨‹ä¸­è·å–çš„ç¤ºä¾‹ï¼š training_set = tf.contrib.learn.datasets.base.load_csv_with_header( filename=IRIS_TRAINING, target_dtype=np.int, features_dtype=np.float32)test_set = tf.contrib.learn.datasets.base.load_csv_with_header( filename=IRIS_TEST, target_dtype=np.int, features_dtype=np.float32)... classifier.fit(x=training_set.data, y=training_set.target, steps=2000) å½“éœ€è¦å¯¹æºæ•°æ®è¿›è¡Œå°‘é‡æ“ä½œæ—¶ï¼Œè¿™ç§æ–¹æ³•è¿è¡Œè‰¯å¥½ã€‚ä½†æ˜¯åœ¨éœ€è¦æ›´å¤šç‰¹å¾å·¥ç¨‹çš„æƒ…å†µä¸‹ï¼Œ tf.contrib.learnæ”¯æŒä½¿ç”¨è‡ªå®šä¹‰è¾“å…¥å‡½æ•°ï¼ˆinput_fnï¼‰å°†é¢„å¤„ç†å’Œpipelineæ•°æ®çš„é€»è¾‘å°è£…åˆ°æ¨¡å‹ä¸­ã€‚ 1.1 è§£æinput_fnä»¥ä¸‹ä»£ç é˜è¿°äº†è¾“å…¥å‡½æ•°çš„åŸºæœ¬æ¡†æ¶ï¼š def my_input_fn(): # Preprocess your data here... # ...then return 1) a mapping of feature columns to Tensors with # the corresponding feature data, and 2) a Tensor containing labels return feature_cols, labels è¾“å…¥å‡½æ•°éƒ¨åˆ†åŒ…å«ç”¨äºé¢„å¤„ç†è¾“å…¥æ•°æ®çš„ç‰¹å®šé€»è¾‘ï¼Œä¾‹å¦‚æ“¦é™¤ä¸è‰¯ç¤ºä¾‹æˆ–feature scalingã€‚ è¾“å…¥å‡½æ•°å¿…é¡»è¿”å›ä»¥ä¸‹ä¸¤ä¸ªå€¼ï¼Œå…¶ä¸­åŒ…å«è¦é¦ˆé€åˆ°æ¨¡å‹ä¸­çš„æœ€ç»ˆç‰¹å¾å’Œæ ‡ç­¾æ•°æ®ï¼ˆå¦‚ä¸Šè¿°ä»£ç æ¡†æ¶æ‰€ç¤ºï¼‰ï¼š feature_cols å°†ç‰¹å¾åˆ—åç§°æ˜ å°„åˆ°ç›¸åº”ç‰¹å¾æ•°æ®çš„Tensorsï¼ˆæˆ–SparseTensorsï¼‰çš„keys/valueså¯¹çš„å­—å…¸ã€‚ labels åŒ…å«æ‚¨çš„æ ‡ç­¾ï¼ˆç›®æ ‡ï¼‰å€¼çš„å¼ é‡ï¼šæ‚¨çš„æ¨¡å‹é¢„æµ‹çš„å€¼ã€‚ 1.2 å°†ç‰¹å¾æ•°æ®è½¬æ¢ä¸ºå¼ é‡å¦‚æœç‰¹å¾/æ ‡ç­¾æ•°æ®å­˜å‚¨åœ¨pandas æ•°æ®æ¶æ„æˆ–numpyæ•°ç»„ï¼Œä½ éœ€è¦å°†å…¶è½¬æ¢ä¸ºTensoråœ¨å®ƒä»input_fnè¿”å›ä¹‹å‰ã€‚ å¯¹äºè¿ç»­æ•°æ®ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨tf.constantåˆ›å»ºå’Œå¡«å……Tensorï¼š feature_column_data = [1, 2.4, 0, 9.9, 3, 120]feature_tensor = tf.constant(feature_column_data) 2. è¯¦è§ä»£ç  Blairâ€™s Github tf.contrib.learnæ„å»ºè¾“å…¥å‡½æ•° import itertools import pandas as pdimport tensorflow as tf tf.logging.set_verbosity(tf.logging.INFO)# 1. å®šä¹‰æ•°æ®é›†ä¸­çš„åˆ—åCOLUMNSã€‚ ä¸ºäº†åŒºåˆ†æ ‡ç­¾çš„ featureï¼Œè¿˜è¦å®šä¹‰ FEATURES å’Œ LABELã€‚COLUMNS = [&quot;crim&quot;, &quot;zn&quot;, &quot;indus&quot;, &quot;nox&quot;, &quot;rm&quot;, &quot;age&quot;, &quot;dis&quot;, &quot;tax&quot;, &quot;ptratio&quot;, &quot;medv&quot;]FEATURES = [&quot;crim&quot;, &quot;zn&quot;, &quot;indus&quot;, &quot;nox&quot;, &quot;rm&quot;, &quot;age&quot;, &quot;dis&quot;, &quot;tax&quot;, &quot;ptratio&quot;]LABEL = &quot;medv&quot; training_set = pd.read_csv(&quot;boston_train.csv&quot;, skipinitialspace=True, skiprows=1, names=COLUMNS)test_set = pd.read_csv(&quot;boston_test.csv&quot;, skipinitialspace=True, skiprows=1, names=COLUMNS)prediction_set = pd.read_csv(&quot;boston_predict.csv&quot;, skipinitialspace=True, skiprows=1, names=COLUMNS)# print(training_set.head(2))# print(test_set.head(2))# 2. å®šä¹‰FeatureColumnså¹¶åˆ›å»ºå›å½’feature_cols = [tf.contrib.layers.real_valued_column(k) for k in FEATURES]feature_cols# 3. å®ä¾‹åŒ–ä¸€ä¸ªDNNRegressorç¥ç»ç½‘ç»œå›å½’æ¨¡å‹regressor = tf.contrib.learn.DNNRegressor(feature_columns=feature_cols, hidden_units=[10, 10], model_dir=&quot;/tmp/boston_model&quot;) # 4. æ„å»ºinput_fn def input_fn(data_set): feature_cols = &#123;k: tf.constant(data_set[k].values) for k in FEATURES&#125; labels = tf.constant(data_set[LABEL].values) return feature_cols, labels# 5. è®­ç»ƒå›å½’å™¨regressor.fit(input_fn=lambda: input_fn(training_set), steps=5000)# 6. è¯„ä¼°æ¨¡å‹ev = regressor.evaluate(input_fn=lambda: input_fn(test_set), steps=1)loss_score = ev[&quot;loss&quot;]print(&quot;Loss: &#123;0:f&#125;&quot;.format(loss_score))# 7. é¢„æµ‹y = regressor.predict_scores(input_fn=lambda: input_fn(prediction_set), batch_size=None)# .predict() returns an iterator; convert to a list and print predictionspredictions = list(itertools.islice(y, 6))print(&quot;Predictions: &#123;&#125;&quot;.format(str(predictions))) 3. å…¶ä»–èµ„æºä¸ºç¥ç»ç½‘ç»œå›å½’å™¨åˆ›å»ºä¸€ä¸ªinput_fnã€‚è¦äº†è§£æœ‰å…³å°†input_fnç”¨äºå…¶ä»–ç±»å‹æ¨¡å‹çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·æŸ¥çœ‹ä»¥ä¸‹èµ„æºï¼š TensorFlowçš„å¤§è§„æ¨¡çº¿æ€§æ¨¡å‹ï¼šä»‹ç»TensorFlowä¸­çº¿æ€§æ¨¡å‹ï¼Œæä¾›è½¬æ¢è¾“å…¥æ•°æ®çš„ç‰¹å¾åˆ—å’ŒæŠ€æœ¯çš„é«˜çº§æ¦‚è¿°ã€‚ TensorFlowçº¿æ€§æ¨¡å‹æ•™ç¨‹ï¼šFeatureColumnså’Œ input_fnï¼Œçº¿æ€§åˆ†ç±»æ¨¡å‹ï¼Œæ®äººå£è´¢äº§æ™®æŸ¥æ•°æ®é¢„æµ‹æ”¶å…¥èŒƒå›´ã€‚ TensorFlow Wideï¼†Deep Learningæ•™ç¨‹ï¼šåŸºäºçº¿æ€§æ¨¡å‹æ•™ç¨‹ï¼Œæœ¬æ•™ç¨‹æ¶µç›– FeatureColumn å’Œ input_fnï¼Œåˆ›å»ºäº†ä¸€ä¸ªâ€œå®½è€Œæ·±â€çš„æ¨¡å‹ï¼Œå®ƒèåˆäº†ä¸€ä¸ªçº¿æ€§æ¨¡å‹å’Œä½¿ç”¨ DNNLinearCombinedClassifier çš„ç¥ç»ç½‘ç»œ ã€‚ Reference ä½¿ç”¨tf.contrib.learnæ„å»ºè¾“å…¥å‡½æ•° é«˜æ•ˆçš„ itertools æ¨¡å— pandas.read_csvå‚æ•°æ•´ç†","categories":[{"name":"tensorflow","slug":"tensorflow","permalink":"http://iequa.com/categories/tensorflow/"}],"tags":[{"name":"tensorflow","slug":"tensorflow","permalink":"http://iequa.com/tags/tensorflow/"}]},{"title":"TensorFlow - tf.contrib.learn å¿«é€Ÿå…¥é—¨","slug":"tensorflow/tf-5.1-contrib-learn-Quickstart","date":"2018-10-31T08:10:21.000Z","updated":"2019-10-20T04:30:35.060Z","comments":true,"path":"2018/10/31/tensorflow/tf-5.1-contrib-learn-Quickstart/","link":"","permalink":"http://iequa.com/2018/10/31/tensorflow/tf-5.1-contrib-learn-Quickstart/","excerpt":"TensorFlow çš„é«˜çº§æœºå™¨å­¦ä¹ APIï¼ˆtf.contrib.learnï¼‰å¯ä»¥è½»æ¾é…ç½®ï¼Œè®­ç»ƒå’Œè¯„ä¼°å„ç§æœºå™¨å­¦ä¹ æ¨¡å‹ã€‚ ä½¿ç”¨tf.contrib.learnæ„å»º ç¥ç»ç½‘ç»œ åˆ†ç±»å™¨å¹¶åœ¨Irisæ•°æ®é›†ä¸Šè¿›è¡Œè®­ç»ƒ. åŸºäºèŠ±è¼/èŠ±ç“£å‡ ä½•å½¢çŠ¶æ¥é¢„æµ‹èŠ±ç§ã€‚","text":"TensorFlow çš„é«˜çº§æœºå™¨å­¦ä¹ APIï¼ˆtf.contrib.learnï¼‰å¯ä»¥è½»æ¾é…ç½®ï¼Œè®­ç»ƒå’Œè¯„ä¼°å„ç§æœºå™¨å­¦ä¹ æ¨¡å‹ã€‚ ä½¿ç”¨tf.contrib.learnæ„å»º ç¥ç»ç½‘ç»œ åˆ†ç±»å™¨å¹¶åœ¨Irisæ•°æ®é›†ä¸Šè¿›è¡Œè®­ç»ƒ. åŸºäºèŠ±è¼/èŠ±ç“£å‡ ä½•å½¢çŠ¶æ¥é¢„æµ‹èŠ±ç§ã€‚ ä¾ç…§ä»¥ä¸‹äº”ä¸ªæ­¥éª¤ç¼–å†™ä»£ç ï¼š å°†åŒ…å«Irisè®­ç»ƒ/æµ‹è¯•æ•°æ®çš„CSVåŠ è½½åˆ°TensorFlowæ•°æ®é›†ä¸­ æ„å»ºç¥ç»ç½‘ç»œåˆ†ç±»å™¨ ä½¿ç”¨è®­ç»ƒæ•°æ®æ‹Ÿåˆæ¨¡å‹ è¯„ä¼°æ¨¡å‹çš„å‡†ç¡®æ€§ åˆ†ç±»æ–°æ ·æœ¬ 1. å®Œæ•´çš„ç¥ç»ç½‘ç»œæºä»£ç # -*- coding: UTF-8 -*-import osimport urllibimport numpy as npimport tensorflow as tf# Data setsIRIS_TRAINING = &quot;iris_training.csv&quot;IRIS_TRAINING_URL = &quot;http://download.tensorflow.org/data/iris_training.csv&quot;IRIS_TEST = &quot;iris_test.csv&quot;IRIS_TEST_URL = &quot;http://download.tensorflow.org/data/iris_test.csv&quot;def main(): # First download iris_training.csv and iris_test.csv # Load datasets. training_set = tf.contrib.learn.datasets.base.load_csv_with_header( filename=IRIS_TRAINING, target_dtype=np.int, features_dtype=np.float32) test_set = tf.contrib.learn.datasets.base.load_csv_with_header( filename=IRIS_TEST, target_dtype=np.int, features_dtype=np.float32) # Specify that all features have real-value data feature_columns = [tf.contrib.layers.real_valued_column(&quot;&quot;, dimension=4)] # Build 3 layer DNN with 10, 20, 10 units respectively. classifier = tf.contrib.learn.DNNClassifier(feature_columns=feature_columns, hidden_units=[10, 20, 10], n_classes=3, model_dir=&quot;/tmp/iris_model&quot;) # Define the training inputs def get_train_inputs(): x = tf.constant(training_set.data) y = tf.constant(training_set.target) return x, y # Fit model. classifier.fit(input_fn=get_train_inputs, steps=2000) # Define the test inputs def get_test_inputs(): x = tf.constant(test_set.data) y = tf.constant(test_set.target) return x, y &#x27;&#x27;&#x27;Evaluate accuracy&#x27;&#x27;&#x27; # &#123;&#x27;loss&#x27;: 0.098150678, &#x27;accuracy&#x27;: 0.96666664, &#x27;global_step&#x27;: 4000&#125; accuracy_score = classifier.evaluate(input_fn=get_test_inputs, steps=1)[&quot;accuracy&quot;] print(&quot;\\nTest Accuracy: &#123;0:f&#125;\\n&quot;.format(accuracy_score)) # Classify two new flower samples. def new_samples(): return np.array( [[6.4, 3.2, 4.5, 1.5], [5.8, 3.1, 5.0, 1.7]], dtype=np.float32) predictions = list(classifier.predict(input_fn=new_samples)) print( &quot;New Samples, Class Predictions: &#123;&#125;\\n&quot; .format(predictions))if __name__ == &quot;__main__&quot;: main() 2. å°†Iris CSVæ•°æ®åŠ è½½åˆ°TFä¸­è¯¥Iris data setåŒ…å«150è¡Œæ•°æ®ï¼ŒåŒ…æ‹¬æ¥è‡ªæ¯ä¸‰ä¸ªç›¸å…³Irisç§ç±»çš„50ä¸ªæ ·å“ï¼š ris setosa, Iris virginica, ä»¥åŠ Iris versicolorã€‚ ä»å·¦åˆ°å³ï¼Œ Iris setosaï¼ˆ Radomilï¼ŒCC BY-SA 3.0ï¼‰ï¼Œ Iris versicolorï¼ˆDlangloisï¼ŒCC BY-SA 3.0ï¼‰å’ŒIris virginicaï¼ˆFrank Mayfieldï¼ŒCC BY-SA 2.0ï¼‰ï¼‰ã€‚ æ¯è¡ŒåŒ…å«æ¯ä¸ªèŠ±æ ·å“çš„ä»¥ä¸‹æ•°æ®ï¼š èŠ±è¼é•¿åº¦ï¼ŒèŠ±è¼å®½åº¦ï¼Œ èŠ±ç“£é•¿åº¦ï¼ŒèŠ±ç“£å®½åº¦å’ŒèŠ±ç§ã€‚èŠ±ç§ä»¥æ•´æ•°è¡¨ç¤ºï¼Œ0è¡¨ç¤ºIris setosaï¼Œ1è¡¨ç¤ºIris versicolorï¼Œ2è¡¨ç¤ºIris virginicaã€‚ Irisæ•°æ®å·²è¢«éšæœºåˆ†ä¸ºä¸¤ä¸ªç‹¬ç«‹çš„CSVï¼š å«120ä¸ªæ ·æœ¬çš„è®­ç»ƒé›†ï¼ˆiris_training.csvï¼‰ å«30ä¸ªæ ·æœ¬çš„æµ‹è¯•é›†ï¼ˆiris_test.csvï¼‰ã€‚ æ¥ä¸‹æ¥ï¼Œä½¿ç”¨learn.datasets.baseä¸­çš„load_csv_with_header() æ–¹æ³•å°†è®­ç»ƒé›†å’Œæµ‹è¯•é›†åŠ è½½åˆ°datasetsä¸­ã€‚è¯¥load_csv_with_header()æ–¹æ³•éœ€è¦ä¸‰ä¸ªå¿…ä¸å¯å°‘çš„å‚æ•°ï¼š filenameï¼Œå¸¦æœ‰æ–‡ä»¶è·¯å¾„çš„CSVæ–‡ä»¶ã€‚ target_dtypeï¼Œæ•°æ®é›†çš„å½¢å¼ä¸ºnumpy æ•°æ®ç±»å‹ã€‚ features_dtypeï¼Œæ•°æ®ç‰¹å¾é›†çš„å½¢å¼ä¸ºnumpy æ•°æ®ç±»å‹ã€‚ åœ¨è¿™é‡Œï¼Œç›®æ ‡ï¼ˆä½ æ­£åœ¨è®­ç»ƒé¢„æµ‹æ¨¡å‹çš„å€¼ï¼‰æ˜¯èŠ±ç§ï¼Œå®ƒæ˜¯0-2çš„æ•´æ•°ï¼Œæ‰€ä»¥é€‚å½“çš„numpyæ•°æ®ç±»å‹æ˜¯np.intï¼š # Load datasets.training_set = tf.contrib.learn.datasets.base.load_csv_with_header( filename=IRIS_TRAINING, target_dtype=np.int, features_dtype=np.float32) test_set = tf.contrib.learn.datasets.base.load_csv_with_header( filename=IRIS_TEST, target_dtype=np.int, features_dtype=np.float32) test_set æ•°æ®å½¢å¼ Dataset( data=array([ [ 5.9000001 , 3. , 4.19999981, 1.5], [ 6.9000001 , 3.0999999 , 5.4000001 , 2.0999999 ], ...... [ 6.69999981, 3.29999995, 5.69999981, 2.5 ], [ 6.4000001 , 2.9000001 , 4.30000019, 1.29999995] ], dtype=float32), target=array( [1, 2, 0, 1, 1, 1, 0, 2, 1, 2, 2, 0, 2, 1, 1, 0, 1, 0, 0, 2, 0, 1, 2,1, 1, 1, 0, 1, 2, 1])) test_set.data æ•°æ®å½¢å¼ [[ 5.9000001 3. 4.19999981 1.5 ] [ 6.9000001 3.0999999 5.4000001 2.0999999 ] ...... [ 6.4000001 2.9000001 4.30000019 1.29999995]] test_set.target æ•°æ®å½¢å¼ [1 2 0 1 1 1 0 2 1 2 2 0 2 1 1 0 1 0 0 2 0 1 2 1 1 1 0 1 2 1] tf.contrib.learnä¸­çš„datasetsè¢«å‘½åä¸º tuples ; æ‚¨å¯ä»¥é€šè¿‡dataå’Œtarget å±æ€§è®¿é—®ç‰¹å¾æ•°æ®å’Œç›®æ ‡å€¼ã€‚è¿™é‡Œçš„training_set.dataï¼Œtraining_set.targetåŒ…å«è®­ç»ƒé›†çš„ç‰¹å¾æ•°æ®å’Œç›®æ ‡å€¼ï¼Œtest_set.data ï¼Œtest_set.targetåŒ…å«æµ‹è¯•é›†çš„ç‰¹å¾æ•°æ®å’Œç›®æ ‡å€¼ã€‚ åœ¨ â€œåœ¨Irisè®­ç»ƒæ•°æ®ä¸­æ‹ŸåˆDNNCåˆ†ç±»å™¨â€ï¼Œ æ‚¨å°†ä½¿ç”¨training_set.dataå’Œ training_set.targetè®­ç»ƒæ‚¨çš„æ¨¡å‹ï¼Œåœ¨ â€œè¯„ä¼°æ¨¡å‹ç²¾åº¦â€ æ—¶ï¼Œæ‚¨å°†ä½¿ç”¨test_set.dataå’Œ test_set.targetã€‚ 3. æ„å»ºæ·±å±‚ç¥ç»ç½‘ç»œåˆ†ç±»å™¨tf.contrib.learnæä¾›äº†å„ç§é¢„å®šä¹‰çš„æ¨¡å‹ï¼Œç§°ä¸º Estimatorsï¼Œæ‚¨å¯ä»¥ä½¿ç”¨â€œout of the boxâ€æ–¹å¼å¯¹æ•°æ®è¿›è¡Œè®­ç»ƒå’Œè¯„ä¼°æ“ä½œã€‚ åœ¨è¿™é‡Œï¼Œæ‚¨å°†é…ç½®æ·±å±‚ç¥ç»ç½‘ç»œåˆ†ç±»å™¨æ¨¡å‹ä»¥æ‹ŸåˆIrisæ•°æ®ã€‚åˆ©ç”¨tf.contrib.learnï¼Œæ‚¨å¯ä»¥ä½¿ç”¨å‡ è¡Œä»£ç å®ä¾‹åŒ–tf.contrib.learn.DNNClassifierï¼š # Specify that all features have real-value datafeature_columns = [tf.contrib.layers.real_valued_column(&quot;&quot;, dimension=4)] # Build 3 layer DNN with 10, 20, 10 units respectively.classifier = tf.contrib.learn.DNNClassifier(feature_columns=feature_columns, hidden_units=[10, 20, 10], n_classes=3, model_dir=&quot;/tmp/iris_model&quot;) 3.1 feature_columns å½¢å¼[_RealValuedColumn(column_name=&#x27;&#x27;, dimension=4, default_value=None, dtype=tf.float32, normalizer=None)] ä¸Šé¢çš„ä»£ç é¦–å…ˆå®šä¹‰äº†æ¨¡å‹çš„ç‰¹å¾åˆ—ï¼Œå®ƒä»¬æŒ‡å®šæ•°æ®é›†ä¸­çš„ç‰¹å¾æ•°æ®ç±»å‹ã€‚æ‰€æœ‰çš„ç‰¹å¾æ•°æ®æ˜¯è¿ç»­çš„ï¼Œæ‰€ä»¥tf.contrib.layers.real_valued_columnä½¿ç”¨ç›¸åº”çš„å‡½æ•°æ¥æ„é€ ç‰¹å¾åˆ—ã€‚æ•°æ®é›†ä¸­æœ‰å››ä¸ªç‰¹å¾ï¼ˆèŠ±è¼å®½åº¦ï¼ŒèŠ±è¼é«˜åº¦ï¼ŒèŠ±ç“£å®½åº¦å’ŒèŠ±ç“£é«˜åº¦ï¼‰ï¼Œå› æ­¤dimension å¿…é¡»è®¾ç½®ä¸º4ä¿å­˜æ‰€æœ‰æ•°æ®ã€‚ 3.2 classifier å½¢å¼DNNClassifier(params=&#123;&#x27;head&#x27;: &lt;tensorflow.contrib.learn.python.learn.estimators.head._MultiClassHead object at 0x1089c0c18&gt;, &#x27;hidden_units&#x27;: [10, 20, 10], &#x27;feature_columns&#x27;: (_RealValuedColumn(column_name=&#x27;&#x27;, dimension=4, default_value=None, dtype=tf.float32, normalizer=None),), &#x27;optimizer&#x27;: None, &#x27;activation_fn&#x27;: &lt;function relu at 0x11590ad08&gt;, &#x27;dropout&#x27;: None, &#x27;gradient_clip_norm&#x27;: None, &#x27;embedding_lr_multipliers&#x27;: None, &#x27;input_layer_min_slice_size&#x27;: None&#125;) ç„¶åï¼Œä»£ç ä½¿ç”¨ä»¥ä¸‹å‚æ•°åˆ›å»ºä¸€ä¸ªDNNClassifieræ¨¡å‹ï¼š feature_columns=feature_columnsã€‚ä¸Šé¢å®šä¹‰çš„ç‰¹å¾åˆ—é›†åˆã€‚ hidden_units=[10, 20, 10]ã€‚ä¸‰ä¸ªéšå«å±‚ï¼Œåˆ†åˆ«å«æœ‰10,20å’Œ10ä¸ªç¥ç»å…ƒã€‚ n_classes=3ã€‚ä¸‰ä¸ªç›®æ ‡ç±»åˆ«ï¼Œä»£è¡¨ä¸‰ç§Irisç‰©ç§ã€‚ model_dir=/tmp/iris_modelã€‚TensorFlowå°†åœ¨æ¨¡å‹è®­ç»ƒæœŸé—´ä¿å­˜æ£€æŸ¥ç‚¹æ•°æ®çš„ç›®å½•ã€‚æœ‰å…³ä½¿ç”¨TensorFlowè¿›è¡Œæ—¥å¿—è®°å½•å’Œç›‘è§†çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚é˜…Logging and Monitoring Basics with tf.contrib.learn.ã€‚ 4. è®­ç»ƒçš„è¾“å…¥æµtf.contrib.learnAPIä½¿ç”¨è¾“å…¥å‡½æ•°ï¼Œåˆ›å»ºä¸ºæ¨¡å‹ç”Ÿæˆæ•°æ®çš„TensorFlowæ“ä½œã€‚æœ¬ä¾‹ä¸­ï¼Œæ•°æ®è¶³å¤Ÿå°ï¼Œå¯ä»¥TensorFlow constants å­˜å‚¨ã€‚ä»¥ä¸‹ä»£ç ç”Ÿæˆæœ€ç®€å•çš„è¾“å…¥ï¼š # Define the test inputsdef get_train_inputs(): x = tf.constant(training_set.data) y = tf.constant(training_set.target) return x, y 5. åœ¨Irisè®­ç»ƒæ•°æ®ä¸Šæ‹ŸåˆDNNåˆ†ç±»å™¨ç°åœ¨æ‚¨å·²ç»é…ç½®äº†DNN classifieræ¨¡å‹ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨è¯¥fitæ–¹æ³•å°†å…¶æ‹ŸåˆIrisè®­ç»ƒæ•°æ®ã€‚å°†get_train_inputsä¼ é€’ç»™input_fnï¼ŒæŒ‡å®šè®­ç»ƒçš„æ­¥éª¤ï¼ˆè¿™é‡Œå–2000ï¼‰ï¼š # Fit model.classifier.fit(input_fn=get_train_inputs, steps=2000) æ¨¡å‹çš„çŠ¶æ€ä¿ç•™åœ¨classifierï¼Œè¿™æ„å‘³ç€å¦‚æœä½ å–œæ¬¢ï¼Œä½ å¯ä»¥åˆ†å¸ƒè®­ç»ƒã€‚ä¾‹å¦‚ï¼Œä»¥ä¸Šä»£ç ç›¸å½“äºï¼š classifier.fit(x=training_set.data, y=training_set.target, steps=1000)classifier.fit(x=training_set.data, y=training_set.target, steps=1000) ä½†æ˜¯ï¼Œå¦‚æœæ‚¨å¸Œæœ›åœ¨è®­ç»ƒæ—¶è·Ÿè¸ªæ¨¡å‹ï¼Œåˆ™å¯èƒ½éœ€è¦ä½¿ç”¨TensorFlow monitor æ¥æ‰§è¡Œæ—¥å¿—è®°å½•æ“ä½œã€‚æœ‰å…³æ­¤ä¸»é¢˜çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚é˜…â€œLogging and Monitoring Basics with tf.contrib.learnâ€æ•™ç¨‹ ã€‚ 6. è¯„ä¼°æ¨¡å‹ç²¾åº¦æ‚¨å·²ç»åœ¨Irisè®­ç»ƒæ•°æ®ä¸Šæ‹ŸåˆDNNClassifieræ¨¡å‹; ç°åœ¨ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨è¯¥evaluateæ–¹æ³•æ£€æŸ¥å…¶å¯¹Irisæµ‹è¯•æ•°æ®çš„å‡†ç¡®æ€§ ã€‚æ­£å¦‚fitï¼Œ evaluateéœ€è¦ä¸€ä¸ªæ„å»ºå…¶è¾“å…¥æ¸ é“çš„è¾“å…¥å‡½æ•°ã€‚evaluate è¿”å›ä¸€ä¸ªè¯„ä¼°ç»“æœdictã€‚ä¸‹é¢çš„ä»£ç é€šè¿‡Irisæµ‹è¯•æ•°æ®- test_set.dataå’Œtest_set.targetè¿›è¡Œevaluateå¹¶æ‰“å°ç»“æœçš„ç²¾åº¦ï¼š # Define the test inputsdef get_test_inputs(): x = tf.constant(test_set.data) y = tf.constant(test_set.target) return x, y &#x27;&#x27;&#x27;Evaluate accuracy.&#x27;&#x27;&#x27; # &#123;&#x27;loss&#x27;: 0.098150678, &#x27;accuracy&#x27;: 0.96666664, &#x27;global_step&#x27;: 4000&#125;accuracy_score = classifier.evaluate(input_fn=get_test_inputs, steps=1)[&quot;accuracy&quot;] print(&quot;\\nTest Accuracy: &#123;0:f&#125;\\n&quot;.format(accuracy_score)) æ³¨æ„ï¼šè¿™é‡Œçš„stepså‚æ•°å¯¹evaluateå¾ˆé‡è¦ã€‚ evaluateç›´åˆ°å®ƒåˆ°è¾¾è¾“å…¥çš„æœ«å°¾æ‰åœæ­¢è¿è¡Œã€‚ 7. åˆ†ç±»æ–°æ ·æœ¬ä½¿ç”¨estimatorçš„predict()æ–¹æ³•å¯¹æ–°æ ·æœ¬è¿›è¡Œåˆ†ç±»ã€‚ä¾‹å¦‚ï¼Œè¯´ä½ æœ‰è¿™ä¸¤ä¸ªæ–°çš„èŠ±æœµæ ·ä¾‹ï¼š # Classify two new flower samples.def new_samples(): return np.array( [[6.4, 3.2, 4.5, 1.5], [5.8, 3.1, 5.0, 1.7]], dtype=np.float32) predictions = list(classifier.predict(input_fn=new_samples)) print( &quot;New Samples, Class Predictions: &#123;&#125;\\n&quot; .format(predictions)) æ‚¨å¯ä»¥ä½¿ç”¨è¯¥predict()æ–¹æ³•é¢„æµ‹å…¶ç‰©ç§ã€‚predictè¿”å›ä¸€ä¸ªç”Ÿæˆå™¨ï¼Œå¯ä»¥å¾ˆå®¹æ˜“åœ°è½¬æ¢æˆä¸€ä¸ªåˆ—è¡¨ã€‚ä»¥ä¸‹ä»£ç å–å¾—å¹¶æ‰“å°åˆ†ç±»çš„é¢„æµ‹ç»“æœï¼š New Samples, Class Predictions: [1 2] 8. å…¶ä»–èµ„æº å…¶ä»–èµ„æºæœ‰å…³tf.contrib.learnçš„æ›´å¤šå‚è€ƒèµ„æ–™ï¼Œè¯·å‚é˜…å®˜æ–¹ APIæ–‡æ¡£ã€‚ æœ‰å…³ä½¿ç”¨tf.contrib.learnåˆ›å»ºçº¿æ€§æ¨¡å‹çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚é˜… Large-scale Linear Models with TensorFlow. è¦ä½¿ç”¨tf.contrib.learn APIæ„å»ºè‡ªå·±çš„Estimatorï¼Œè¯·æŸ¥çœ‹åœ¨ tf.contrib.learnä¸­åˆ›å»ºä¼°è®¡å™¨ã€‚ è¦åœ¨æµè§ˆå™¨ä¸­å®éªŒç¥ç»ç½‘ç»œå»ºæ¨¡å’Œå¯è§†åŒ–ï¼Œè¯·æŸ¥çœ‹Deep Playgroundã€‚ æœ‰å…³ç¥ç»ç½‘ç»œçš„æ›´å¤šé«˜çº§æ•™ç¨‹ï¼Œè¯·å‚é˜… å·ç§¯ç¥ç»ç½‘ç»œå’Œå¾ªç¯ç¥ç»ç½‘ç»œã€‚ Reference GPUé›†ç¾¤æŠ˜è…¾æ‰‹è®°â€”â€”2015 TensorFlow R1.2 ä¸­æ–‡æ–‡æ¡£","categories":[{"name":"tensorflow","slug":"tensorflow","permalink":"http://iequa.com/categories/tensorflow/"}],"tags":[{"name":"tensorflow","slug":"tensorflow","permalink":"http://iequa.com/tags/tensorflow/"}]},{"title":"Tensorflow è¸©å‘è®°ä¹‹ tf.metrics","slug":"tensorflow/tf-metrics_learn","date":"2018-10-23T08:10:21.000Z","updated":"2019-10-20T04:30:35.064Z","comments":true,"path":"2018/10/23/tensorflow/tf-metrics_learn/","link":"","permalink":"http://iequa.com/2018/10/23/tensorflow/tf-metrics_learn/","excerpt":"æ€»ç»“ä¸€ä¸‹ tf.metrics é‡åˆ°çš„ä¸€äº›å‘ã€‚","text":"æ€»ç»“ä¸€ä¸‹ tf.metrics é‡åˆ°çš„ä¸€äº›å‘ã€‚ ç²¾ç¡®ç‡çš„è®¡ç®—å…¬å¼ Reference Tensorflowè¸©å‘è®°ä¹‹tf.metrics TensorFlow Github tf.metrics å®è·µ Ronny Restrepo - tf.metrics.accuracy()è®²è§£æ»´å¾ˆæ¸…æ¥š ApacheCN å¼€æºç»„ç»‡ tf.contrib.learnåŸºç¡€çš„è®°å½•å’Œç›‘æ§æ•™ç¨‹ ApacheCN å¼€æºç»„ç»‡ TensorFlowå…¥é—¨","categories":[{"name":"tensorflow","slug":"tensorflow","permalink":"http://iequa.com/categories/tensorflow/"}],"tags":[{"name":"tensorflow","slug":"tensorflow","permalink":"http://iequa.com/tags/tensorflow/"}]},{"title":"Tensorflow tf.app.run()ä¸å‘½ä»¤è¡Œå‚æ•°è§£æ","slug":"tensorflow/tf-app_run_&_tf_flags","date":"2018-10-23T05:10:21.000Z","updated":"2019-10-20T04:30:35.063Z","comments":true,"path":"2018/10/23/tensorflow/tf-app_run_&_tf_flags/","link":"","permalink":"http://iequa.com/2018/10/23/tensorflow/tf-app_run_&_tf_flags/","excerpt":"tf.app.run() ä¸ å‘½ä»¤è¡Œå‚æ•°è§£æ tf.flags","text":"tf.app.run() ä¸ å‘½ä»¤è¡Œå‚æ•°è§£æ tf.flags é¦–å…ˆç»™å‡ºä¸€æ®µå¸¸è§çš„ä»£ç ï¼š if __name__ == &#x27;__main__&#x27;: tf.app.run() æ‰¾åˆ° Tensorflow ä¸­å…³äºä¸Šè¿° å‡½æ•°run() çš„æºç ï¼š def run(main=None, argv=None): &quot;&quot;&quot;Runs the program with an optional &#x27;main&#x27; function and &#x27;argv&#x27; list.&quot;&quot;&quot; f = flags.FLAGS # Extract the args from the optional `argv` list. args = argv[1:] if argv else None # Parse the known flags from that list, or from the command # line otherwise. # pylint: disable=protected-access flags_passthrough = f._parse_flags(args=args) # pylint: enable=protected-access main = main or _sys.modules[&#x27;__main__&#x27;].main # Call the main function, passing through any arguments # to the final program. _sys.exit(main(_sys.argv[:1] + flags_passthrough))_allowed_symbols = [ &#x27;run&#x27;, # Allowed submodule. &#x27;flags&#x27;,]remove_undocumented(__name__, _allowed_symbols) å¯ä»¥çœ‹åˆ°æºç ä¸­çš„è¿‡ç¨‹æ˜¯é¦–å…ˆåŠ è½½ flags çš„å‚æ•°é¡¹ï¼Œç„¶åæ‰§è¡Œ main å‡½æ•°ã€‚å‚æ•°æ˜¯ä½¿ç”¨tf.app.flags.FLAGS å®šä¹‰çš„ã€‚ tf.app.flags.FLAGSå…³äº tf.app.flags.FLAGS çš„ä½¿ç”¨ï¼š # fila_name: temp.pyimport tensorflow as tfFLAGS = tf.app.flags.FLAGStf.app.flags.DEFINE_string(&#x27;string&#x27;, &#x27;train&#x27;, &#x27;This is a string&#x27;)tf.app.flags.DEFINE_float(&#x27;learning_rate&#x27;, 0.001, &#x27;This is the rate in training&#x27;)tf.app.flags.DEFINE_boolean(&#x27;flag&#x27;, True, &#x27;This is a flag&#x27;)print(&#x27;string: &#x27;, FLAGS.string)print(&#x27;learning_rate: &#x27;, FLAGS.learning_rate)print(&#x27;flag: &#x27;, FLAGS.flag) è¾“å‡ºï¼š (&#x27;string: &#x27;, &#x27;train&#x27;)(&#x27;learning_rate: &#x27;, 0.001)(&#x27;flag: &#x27;, True) Reference tf.app.run()ä¸å‘½ä»¤è¡Œå‚æ•°è§£æ TensorFlowä¸­çš„å°çŸ¥è¯†ï¼štf.flags.DEFINE_xxx() Tensorflow 1.0ï¼šè€å¸æœºç«‹ä¸‹çš„Flag Tensorflowæ•™ç¨‹(åå››) å‘½ä»¤è¡Œå‚æ•°tf.flagsçš„ä½¿ç”¨","categories":[{"name":"tensorflow","slug":"tensorflow","permalink":"http://iequa.com/categories/tensorflow/"}],"tags":[{"name":"tensorflow","slug":"tensorflow","permalink":"http://iequa.com/tags/tensorflow/"}]},{"title":"SparkSQL åº•å±‚å®ç°åŸç†","slug":"spark/sparkSQL-all-knowleage","date":"2018-10-17T07:28:21.000Z","updated":"2020-11-30T22:59:13.609Z","comments":true,"path":"2018/10/17/spark/sparkSQL-all-knowleage/","link":"","permalink":"http://iequa.com/2018/10/17/spark/sparkSQL-all-knowleage/","excerpt":"","text":"1.sparksqlæ¦‚è¿°1.1 sparksqlçš„å‰ä¸–ä»Šç”Ÿ ==Sharkæ˜¯ä¸“é—¨é’ˆå¯¹äºsparkçš„æ„å»ºå¤§è§„æ¨¡æ•°æ®ä»“åº“ç³»ç»Ÿçš„ä¸€ä¸ªæ¡†æ¶== Sharkä¸Hiveå…¼å®¹ã€åŒæ—¶ä¹Ÿä¾èµ–äºSparkç‰ˆæœ¬ Hivesqlåº•å±‚æŠŠsqlè§£ææˆäº†mapreduceç¨‹åºï¼ŒSharkæ˜¯æŠŠsqlè¯­å¥è§£ææˆäº†Sparkä»»åŠ¡ éšç€æ€§èƒ½ä¼˜åŒ–çš„ä¸Šé™ï¼Œä»¥åŠé›†æˆSQLçš„ä¸€äº›å¤æ‚çš„åˆ†æåŠŸèƒ½ï¼Œå‘ç°Hiveçš„MapReduceæ€æƒ³é™åˆ¶äº†Sharkçš„å‘å±•ã€‚ æœ€åDatabrickså…¬å¸ç»ˆæ­¢å¯¹Sharkçš„å¼€å‘ å†³å®šå•ç‹¬å¼€å‘ä¸€ä¸ªæ¡†æ¶ï¼Œä¸åœ¨ä¾èµ–hiveï¼ŒæŠŠé‡ç‚¹è½¬ç§»åˆ°äº†==sparksql==è¿™ä¸ªæ¡†æ¶ä¸Šã€‚ 1.2 ä»€ä¹ˆæ˜¯sparksql Spark SQL is Apache Sparkâ€™s module for working with structured data. SparkSQLæ˜¯apache Sparkç”¨æ¥å¤„ç†ç»“æ„åŒ–æ•°æ®çš„ä¸€ä¸ªæ¨¡å— 2. sparksqlçš„å››å¤§ç‰¹æ€§ ==1ã€æ˜“æ•´åˆ== å°†SQLæŸ¥è¯¢ä¸Sparkç¨‹åºæ— ç¼æ··åˆ å¯ä»¥ä½¿ç”¨ä¸åŒçš„è¯­è¨€è¿›è¡Œä»£ç å¼€å‘ java scala python R ==2ã€ç»Ÿä¸€çš„æ•°æ®æºè®¿é—®== ä»¥ç›¸åŒçš„æ–¹å¼è¿æ¥åˆ°ä»»ä½•æ•°æ®æº sparksqlåæœŸå¯ä»¥é‡‡ç”¨ä¸€ç§ç»Ÿä¸€çš„æ–¹å¼å»å¯¹æ¥ä»»æ„çš„å¤–éƒ¨æ•°æ®æº val dataFrame = sparkSession.read.æ–‡ä»¶æ ¼å¼çš„æ–¹æ³•å(&quot;è¯¥æ–‡ä»¶æ ¼å¼çš„è·¯å¾„&quot;) ==3ã€å…¼å®¹hive== sparksqlå¯ä»¥æ”¯æŒhivesqlè¿™ç§è¯­æ³• sparksqlå…¼å®¹hivesql ==4ã€æ”¯æŒæ ‡å‡†çš„æ•°æ®åº“è¿æ¥== sparksqlæ”¯æŒæ ‡å‡†çš„æ•°æ®åº“è¿æ¥JDBCæˆ–è€…ODBC spark-coreâ€”â€”-&gt;å»æ“ä½œRDDâ€”â€”&gt;å°è£…äº†æ•°æ® spark-sqlâ€”â€”â€”&gt;ç¼–ç¨‹æŠ½è±¡DataFrame 3. DataFrameæ¦‚è¿°3.1 DataFrameå‘å±• DataFrameå‰èº«æ˜¯schemaRDD,è¿™ä¸ªschemaRDDæ˜¯ç›´æ¥ç»§æ‰¿è‡ªRDDï¼Œå®ƒæ˜¯RDDçš„ä¸€ä¸ªå®ç°ç±» åœ¨spark1.3.0ä¹‹åæŠŠschemaRDDæ”¹åä¸ºDataFrame,å®ƒä¸åœ¨ç»§æ‰¿è‡ªRDDï¼Œè€Œæ˜¯è‡ªå·±å®ç°RDDä¸Šçš„ä¸€äº›åŠŸèƒ½ ä¹Ÿå¯ä»¥æŠŠdataFrameè½¬æ¢æˆä¸€ä¸ªrddï¼Œè°ƒç”¨rddè¿™ä¸ªæ–¹æ³• ä¾‹å¦‚ val rdd1=dataFrame.rdd 3.2 DataFrameæ˜¯ä»€ä¹ˆ åœ¨Sparkä¸­ï¼ŒDataFrameæ˜¯ä¸€ç§==ä»¥RDDä¸ºåŸºç¡€çš„åˆ†å¸ƒå¼æ•°æ®é›†==ï¼Œç±»ä¼¼äº==ä¼ ç»Ÿæ•°æ®åº“çš„äºŒç»´è¡¨æ ¼== DataFrameå¸¦æœ‰==Schemaå…ƒä¿¡æ¯==ï¼Œå³DataFrameæ‰€è¡¨ç¤ºçš„äºŒç»´è¡¨æ•°æ®é›†çš„æ¯ä¸€åˆ—éƒ½å¸¦æœ‰åç§°å’Œç±»å‹ï¼Œä½†åº•å±‚åšäº†æ›´å¤šçš„ä¼˜åŒ– DataFrameå¯ä»¥ä»å¾ˆå¤šæ•°æ®æºæ„å»º æ¯”å¦‚ï¼šå·²ç»å­˜åœ¨çš„RDDã€ç»“æ„åŒ–æ–‡ä»¶ã€å¤–éƒ¨æ•°æ®åº“ã€Hiveè¡¨ã€‚ RDDå¯ä»¥æŠŠå®ƒå†…éƒ¨å…ƒç´ çœ‹æˆæ˜¯ä¸€ä¸ªjavaå¯¹è±¡ DataFrameå¯ä»¥æŠŠå†…éƒ¨æ˜¯ä¸€ä¸ªRowå¯¹è±¡ï¼Œå®ƒè¡¨ç¤ºä¸€è¡Œä¸€è¡Œçš„æ•°æ® å¯ä»¥æŠŠDataFrameè¿™æ ·å»ç†è§£ RDD+schemaå…ƒä¿¡æ¯ dataFrameç›¸æ¯”äºrddæ¥è¯´ï¼Œå¤šäº†å¯¹æ•°æ®çš„æè¿°ä¿¡æ¯ï¼ˆschemaå…ƒä¿¡æ¯ï¼‰ 3.3 DataFrameå’ŒRDDçš„ä¼˜ç¼ºç‚¹ ==1ã€RDD== ==ä¼˜ç‚¹== 1ã€ç¼–è¯‘æ—¶ç±»å‹å®‰å…¨ å¼€å‘ä¼šè¿›è¡Œç±»å‹æ£€æŸ¥ï¼Œåœ¨ç¼–è¯‘çš„æ—¶å€™åŠæ—¶å‘ç°é”™è¯¯ 2ã€å…·æœ‰é¢å‘å¯¹è±¡ç¼–ç¨‹çš„é£æ ¼ ==ç¼ºç‚¹== 1ã€æ„å»ºå¤§é‡çš„javaå¯¹è±¡å ç”¨äº†å¤§é‡heapå †ç©ºé—´ï¼Œå¯¼è‡´é¢‘ç¹çš„GC ç”±äºæ•°æ®é›†RDDå®ƒçš„æ•°æ®é‡æ¯”è¾ƒå¤§ï¼ŒåæœŸéƒ½éœ€è¦å­˜å‚¨åœ¨heapå †ä¸­ï¼Œè¿™é‡Œæœ‰heapå †ä¸­çš„å†…å­˜ç©ºé—´æœ‰é™ï¼Œå‡ºç°é¢‘ç¹çš„åƒåœ¾å›æ”¶ï¼ˆGCï¼‰ï¼Œç¨‹åºåœ¨è¿›è¡Œåƒåœ¾å›æ”¶çš„è¿‡ç¨‹ä¸­ï¼Œæ‰€æœ‰çš„ä»»åŠ¡éƒ½æ˜¯æš‚åœã€‚å½±å“ç¨‹åºæ‰§è¡Œçš„æ•ˆç‡ 2ã€æ•°æ®çš„åºåˆ—åŒ–å’Œååºåˆ—æ€§èƒ½å¼€é”€å¾ˆå¤§ åœ¨åˆ†å¸ƒå¼ç¨‹åºä¸­ï¼Œå¯¹è±¡(å¯¹è±¡çš„å†…å®¹å’Œç»“æ„)æ˜¯å…ˆè¿›è¡Œåºåˆ—åŒ–ï¼Œå‘é€åˆ°å…¶ä»–æœåŠ¡å™¨ï¼Œè¿›è¡Œå¤§é‡çš„ç½‘ç»œä¼ è¾“ï¼Œç„¶åæ¥å—åˆ°è¿™äº›åºåˆ—åŒ–çš„æ•°æ®ä¹‹åï¼Œå†è¿›è¡Œååºåˆ—åŒ–æ¥æ¢å¤è¯¥å¯¹è±¡ ==2ã€DataFrame== ==DataFrameå¼•å…¥äº†schemaå…ƒä¿¡æ¯å’Œoff-heap(å †å¤–)== ==ä¼˜ç‚¹== 1ã€DataFrameå¼•å…¥off-heapï¼Œå¤§é‡çš„å¯¹è±¡æ„å»ºç›´æ¥ä½¿ç”¨æ“ä½œç³»ç»Ÿå±‚é¢ä¸Šçš„å†…å­˜ï¼Œä¸åœ¨ä½¿ç”¨heapå †ä¸­çš„å†…å­˜ï¼Œè¿™æ ·ä¸€æ¥heapå †ä¸­çš„å†…å­˜ç©ºé—´å°±æ¯”è¾ƒå……è¶³ï¼Œä¸ä¼šå¯¼è‡´é¢‘ç¹GCï¼Œç¨‹åºçš„è¿è¡Œæ•ˆç‡æ¯”è¾ƒé«˜ï¼Œå®ƒæ˜¯è§£å†³äº†RDDæ„å»ºå¤§é‡çš„javaå¯¹è±¡å ç”¨äº†å¤§é‡heapå †ç©ºé—´ï¼Œå¯¼è‡´é¢‘ç¹çš„GCè¿™ä¸ªç¼ºç‚¹ã€‚ 2ã€DataFrameå¼•å…¥äº†schemaå…ƒä¿¡æ¯â€”-å°±æ˜¯æ•°æ®ç»“æ„çš„æè¿°ä¿¡æ¯ï¼ŒåæœŸsparkç¨‹åºä¸­çš„å¤§é‡å¯¹è±¡åœ¨è¿›è¡Œç½‘ç»œä¼ è¾“çš„æ—¶å€™ï¼Œåªéœ€è¦æŠŠæ•°æ®çš„å†…å®¹æœ¬èº«è¿›è¡Œåºåˆ—åŒ–å°±å¯ä»¥ï¼Œæ•°æ®ç»“æ„ä¿¡æ¯å¯ä»¥çœç•¥æ‰ã€‚è¿™æ ·ä¸€æ¥æ•°æ®ç½‘ç»œä¼ è¾“çš„æ•°æ®é‡æ˜¯æœ‰æ‰€å‡å°‘ï¼Œæ•°æ®çš„åºåˆ—åŒ–å’Œååºåˆ—æ€§èƒ½å¼€é”€å°±ä¸æ˜¯å¾ˆå¤§äº†ã€‚å®ƒæ˜¯è§£å†³äº†RDDæ•°æ®çš„åºåˆ—åŒ–å’Œååºåˆ—æ€§èƒ½å¼€é”€å¾ˆå¤§è¿™ä¸ªç¼ºç‚¹ ==ç¼ºç‚¹== DataFrameå¼•å…¥äº†schemaå…ƒä¿¡æ¯å’Œoff-heap(å †å¤–)å®ƒæ˜¯åˆ†åˆ«è§£å†³äº†RDDçš„ç¼ºç‚¹ï¼ŒåŒæ—¶å®ƒä¹Ÿä¸¢å¤±äº†RDDçš„ä¼˜ç‚¹ 1ã€ç¼–è¯‘æ—¶ç±»å‹ä¸å®‰å…¨ ç¼–è¯‘æ—¶ä¸ä¼šè¿›è¡Œç±»å‹çš„æ£€æŸ¥ï¼Œè¿™é‡Œä¹Ÿå°±æ„å‘³ç€å‰æœŸæ˜¯æ— æ³•åœ¨ç¼–è¯‘çš„æ—¶å€™å‘ç°é”™è¯¯ï¼Œåªæœ‰åœ¨è¿è¡Œçš„æ—¶å€™æ‰ä¼šå‘ç° 2ã€ä¸åœ¨å…·æœ‰é¢å‘å¯¹è±¡ç¼–ç¨‹çš„é£æ ¼ 4. è¯»å–æ–‡ä»¶æ„å»ºDataFrame4.1 è¯»å–æ–‡æœ¬æ–‡ä»¶åˆ›å»ºDataFrame ç¬¬ä¸€ç§æ–¹å¼ å°†æ•°æ®person.txtä¸Šä¼ åˆ°node01çš„/kkb/install/sparkdatasæœ¬åœ°è·¯å¾„ä¸‹ node01æ‰§è¡Œä»¥ä¸‹å‘½ä»¤è¿›å…¥spark-shellcd /kkb/install/spark-2.3.3-bin-hadoop2.7/bin/spark-shell --master local[2] --jars /kkb/install/hadoop-2.6.0-cdh5.14.2/share/hadoop/common/hadoop-lzo-0.4.20.jarval personDF=spark.read.text(&quot;file:///kkb/install/sparkdatas/person.txt&quot;)//org.apache.spark.sql.DataFrame = [value: string]//æ‰“å°schemaä¿¡æ¯personDF.printSchema//å±•ç¤ºæ•°æ®personDF.show ç¬¬äºŒç§æ–¹å¼ //åŠ è½½æ•°æ®val rdd1=sc.textFile(&quot;file:///kkb/install/sparkdatas/person.txt&quot;).map(x=&gt;x.split(&quot; &quot;))//å®šä¹‰ä¸€ä¸ªæ ·ä¾‹ç±»case class Person(id:String,name:String,age:Int)//æŠŠrddä¸æ ·ä¾‹ç±»è¿›è¡Œå…³è”val personRDD=rdd1.map(x=&gt;Person(x(0),x(1),x(2).toInt))//æŠŠrddè½¬æ¢æˆDataFrameval personDF=personRDD.toDF//æ‰“å°schemaä¿¡æ¯personDF.printSchema//å±•ç¤ºæ•°æ®personDF.show 4.2 è¯»å–jsonæ–‡ä»¶åˆ›å»ºDataFrameval peopleDF=spark.read.json(&quot;file:///kkb/install/spark-2.3.3-bin-hadoop2.7/examples/src/main/resources/people.json&quot;)//æ‰“å°schemaä¿¡æ¯peopleDF.printSchema//å±•ç¤ºæ•°æ®peopleDF.show 4.3 è¯»å–parquetæ–‡ä»¶åˆ›å»ºDataFrameval usersDF=spark.read.parquet(&quot;file:////kkb/install/spark-2.3.3-bin-hadoop2.7/examples/src/main/resources/users.parquet&quot;)//æ‰“å°schemaä¿¡æ¯usersDF.printSchema//å±•ç¤ºæ•°æ®usersDF.show 5. DataFrameå¸¸ç”¨æ“ä½œ5.1 DSLé£æ ¼è¯­æ³•åˆ›å»ºmavenå·¥ç¨‹ï¼Œå¯¼å…¥jaråŒ… &lt;repositories&gt; &lt;repository&gt; &lt;id&gt;cloudera&lt;/id&gt; &lt;url&gt;https://repository.cloudera.com/artifactory/cloudera-repos&lt;/url&gt; &lt;/repository&gt; &lt;/repositories&gt; &lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.apache.spark&lt;/groupId&gt; &lt;artifactId&gt;spark-core_2.11&lt;/artifactId&gt; &lt;version&gt;2.3.3&lt;/version&gt; &lt;exclusions&gt; &lt;exclusion&gt; &lt;groupId&gt;org.apache.avro&lt;/groupId&gt; &lt;artifactId&gt;avro-mapred&lt;/artifactId&gt; &lt;/exclusion&gt; &lt;/exclusions&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;mysql&lt;/groupId&gt; &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt; &lt;version&gt;5.1.38&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.apache.commons&lt;/groupId&gt; &lt;artifactId&gt;commons-lang3&lt;/artifactId&gt; &lt;version&gt;3.7&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.apache.hadoop&lt;/groupId&gt; &lt;artifactId&gt;hadoop-core&lt;/artifactId&gt; &lt;version&gt;2.6.0-mr1-cdh5.14.2&lt;/version&gt; &lt;exclusions&gt; &lt;exclusion&gt; &lt;groupId&gt;org.apache.zookeeper&lt;/groupId&gt; &lt;artifactId&gt;zookeeper&lt;/artifactId&gt; &lt;/exclusion&gt; &lt;/exclusions&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.apache.hbase&lt;/groupId&gt; &lt;artifactId&gt;hbase-server&lt;/artifactId&gt; &lt;version&gt;1.2.0-cdh5.14.2&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.apache.hbase&lt;/groupId&gt; &lt;artifactId&gt;hbase-common&lt;/artifactId&gt; &lt;version&gt;1.2.0-cdh5.14.2&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.apache.hbase&lt;/groupId&gt; &lt;artifactId&gt;hbase-client&lt;/artifactId&gt; &lt;version&gt;1.2.0-cdh5.14.2&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.apache.hbase&lt;/groupId&gt; &lt;artifactId&gt;hbase-spark&lt;/artifactId&gt; &lt;version&gt;1.2.0-cdh5.14.2&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.apache.spark&lt;/groupId&gt; &lt;artifactId&gt;spark-streaming_2.11&lt;/artifactId&gt; &lt;version&gt;2.3.3&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.apache.spark&lt;/groupId&gt; &lt;artifactId&gt;spark-sql_2.11&lt;/artifactId&gt; &lt;version&gt;2.3.3&lt;/version&gt; &lt;/dependency&gt; &lt;/dependencies&gt; &lt;build&gt; &lt;plugins&gt; &lt;plugin&gt; &lt;groupId&gt;net.alchim31.maven&lt;/groupId&gt; &lt;artifactId&gt;scala-maven-plugin&lt;/artifactId&gt; &lt;version&gt;3.2.2&lt;/version&gt; &lt;executions&gt; &lt;execution&gt; &lt;goals&gt; &lt;goal&gt;compile&lt;/goal&gt; &lt;goal&gt;testCompile&lt;/goal&gt; &lt;/goals&gt; &lt;configuration&gt; &lt;args&gt; &lt;arg&gt;-dependencyfile&lt;/arg&gt; &lt;arg&gt;$&#123;project.build.directory&#125;/.scala_dependencies&lt;/arg&gt; &lt;/args&gt; &lt;/configuration&gt; &lt;/execution&gt; &lt;/executions&gt; &lt;/plugin&gt; &lt;plugin&gt; &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt; &lt;artifactId&gt;maven-shade-plugin&lt;/artifactId&gt; &lt;version&gt;2.4.3&lt;/version&gt; &lt;executions&gt; &lt;execution&gt; &lt;phase&gt;package&lt;/phase&gt; &lt;goals&gt; &lt;goal&gt;shade&lt;/goal&gt; &lt;/goals&gt; &lt;configuration&gt; &lt;filters&gt; &lt;filter&gt; &lt;artifact&gt;*:*&lt;/artifact&gt; &lt;excludes&gt; &lt;exclude&gt;META-INF/*.SF&lt;/exclude&gt; &lt;exclude&gt;META-INF/*.DSA&lt;/exclude&gt; &lt;exclude&gt;META-INF/*.RSA&lt;/exclude&gt; &lt;/excludes&gt; &lt;/filter&gt; &lt;/filters&gt; &lt;transformers&gt; &lt;transformer implementation=&quot;org.apache.maven.plugins.shade.resource.ManifestResourceTransformer&quot;&gt; &lt;mainClass&gt;&lt;/mainClass&gt; &lt;/transformer&gt; &lt;/transformers&gt; &lt;/configuration&gt; &lt;/execution&gt; &lt;/executions&gt; &lt;/plugin&gt; &lt;/plugins&gt; &lt;/build&gt; å°±æ˜¯sparksqlä¸­çš„DataFrameè‡ªèº«æä¾›äº†ä¸€å¥—è‡ªå·±çš„Apiï¼Œå¯ä»¥å»ä½¿ç”¨è¿™å¥—apiæ¥åšç›¸åº”çš„å¤„ç† import org.apache.spark.&#123;SparkConf, SparkContext&#125;import org.apache.spark.sql.SparkSession//å®šä¹‰ä¸€ä¸ªæ ·ä¾‹ç±»case class Person(id:String,name:String,age:Int)object SparkDSL &#123; def main(args: Array[String]): Unit = &#123; val sparkConf: SparkConf = new SparkConf().setMaster(&quot;local[2]&quot;).setAppName(&quot;sparkDSL&quot;) val sparkSession: SparkSession = SparkSession.builder().config(sparkConf).getOrCreate() val sc: SparkContext = sparkSession.sparkContext sc.setLogLevel(&quot;WARN&quot;) //åŠ è½½æ•°æ® val rdd1=sc.textFile(&quot;file:///D:\\\\å¼€è¯¾å§è¯¾ç¨‹èµ„æ–™\\\\15ã€scalaä¸sparkè¯¾ç¨‹èµ„æ–™\\\\2ã€sparkè¯¾ç¨‹\\\\spark_day05\\\\æ•°æ®/person.txt&quot;).map(x=&gt;x.split(&quot; &quot;)) //æŠŠrddä¸æ ·ä¾‹ç±»è¿›è¡Œå…³è” val personRDD=rdd1.map(x=&gt;Person(x(0),x(1),x(2).toInt)) //æŠŠrddè½¬æ¢æˆDataFrame import sparkSession.implicits._ // éšå¼è½¬æ¢ val personDF=personRDD.toDF //æ‰“å°schemaä¿¡æ¯ personDF.printSchema //å±•ç¤ºæ•°æ® personDF.show //æŸ¥è¯¢æŒ‡å®šçš„å­—æ®µ personDF.select(&quot;name&quot;).show personDF.select($&quot;name&quot;).show //å®ç°age+1 personDF.select($&quot;name&quot;,$&quot;age&quot;,$&quot;age&quot;+1).show() //å®ç°ageå¤§äº30è¿‡æ»¤ personDF.filter($&quot;age&quot; &gt; 30).show //æŒ‰ç…§ageåˆ†ç»„ç»Ÿè®¡æ¬¡æ•° personDF.groupBy(&quot;age&quot;).count.show //æŒ‰ç…§ageåˆ†ç»„ç»Ÿè®¡æ¬¡æ•°é™åº personDF.groupBy(&quot;age&quot;).count().sort($&quot;count&quot;.desc).show sparkSession.stop() sc.stop() &#125;&#125; 5.2 SQLé£æ ¼è¯­æ³• å¯ä»¥æŠŠDataFrameæ³¨å†Œæˆä¸€å¼ è¡¨ï¼Œç„¶åé€šè¿‡==sparkSession.sql(sqlè¯­å¥)==æ“ä½œ //DataFrameæ³¨å†Œæˆè¡¨personDF.createTempView(&quot;person&quot;)//ä½¿ç”¨SparkSessionè°ƒç”¨sqlæ–¹æ³•ç»Ÿè®¡æŸ¥è¯¢spark.sql(&quot;select * from person&quot;).showspark.sql(&quot;select name from person&quot;).showspark.sql(&quot;select name,age from person&quot;).showspark.sql(&quot;select * from person where age &gt;30&quot;).showspark.sql(&quot;select count(*) from person where age &gt;30&quot;).showspark.sql(&quot;select age,count(*) from person group by age&quot;).showspark.sql(&quot;select age,count(*) as count from person group by age&quot;).showspark.sql(&quot;select * from person order by age desc&quot;).show 6. DataSetæ¦‚è¿°6.1 DataSetæ˜¯ä»€ä¹ˆ DataSetæ˜¯åˆ†å¸ƒå¼çš„æ•°æ®é›†åˆï¼ŒDatasetæä¾›äº†==å¼ºç±»å‹æ”¯æŒ==ï¼Œä¹Ÿæ˜¯åœ¨RDDçš„æ¯è¡Œæ•°æ®åŠ äº†ç±»å‹çº¦æŸã€‚ DataSetæ˜¯åœ¨Spark1.6ä¸­æ·»åŠ çš„æ–°çš„æ¥å£ã€‚å®ƒé›†ä¸­äº†RDDçš„ä¼˜ç‚¹ï¼ˆå¼ºç±»å‹å’Œå¯ä»¥ç”¨å¼ºå¤§lambdaå‡½æ•°ï¼‰ä»¥åŠä½¿ç”¨äº†Spark SQLä¼˜åŒ–çš„æ‰§è¡Œå¼•æ“ã€‚ 6.2 DataFrameã€DataSetåŒºåˆ« å‡è®¾RDDä¸­çš„ä¸¤è¡Œæ•°æ®é•¿è¿™æ · é‚£ä¹ˆDataFrameä¸­çš„æ•°æ®é•¿è¿™æ · Datasetä¸­çš„æ•°æ®é•¿è¿™æ · æˆ–è€…é•¿è¿™æ ·ï¼ˆæ¯è¡Œæ•°æ®æ˜¯ä¸ªObjectï¼‰ â€‹ DataSetåŒ…å«äº†DataFrameçš„åŠŸèƒ½ï¼ŒSpark2.0ä¸­ä¸¤è€…ç»Ÿä¸€ï¼ŒDataFrameè¡¨ç¤ºä¸ºDataSet[Row]ï¼Œå³DataSetçš„å­é›†ã€‚ï¼ˆ1ï¼‰DataSetå¯ä»¥åœ¨ç¼–è¯‘æ—¶æ£€æŸ¥ç±»å‹ï¼ˆ2ï¼‰å¹¶ä¸”æ˜¯é¢å‘å¯¹è±¡çš„ç¼–ç¨‹æ¥å£ 6.3 DataFrameä¸DataSetäº’è½¬ 1ã€æŠŠä¸€ä¸ªDataFrameè½¬æ¢æˆDataSet val dataSet=dataFrame.as[å¼ºç±»å‹] 2ã€æŠŠä¸€ä¸ªDataSetè½¬æ¢æˆDataFrame val dataFrame=dataSet.toDF è¡¥å……è¯´æ˜ å¯ä»¥ä»dataFrameå’ŒdataSetè·å–å¾—åˆ°rdd val rdd1=dataFrame.rdd val rdd2=dataSet.rdd 6.4 æ„å»ºDataSet 1ã€ é€šè¿‡sparkSessionè°ƒç”¨createDatasetæ–¹æ³• val ds=spark.createDataset(1 to 10) //scalaé›†åˆval ds=spark.createDataset(sc.textFile(&quot;/person.txt&quot;)) //rdd 2ã€ä½¿ç”¨scalaé›†åˆå’Œrddè°ƒç”¨toDSæ–¹æ³• sc.textFile(&quot;/person.txt&quot;).toDSList(1,2,3,4,5).toDS 3ã€æŠŠä¸€ä¸ªDataFrameè½¬æ¢æˆDataSet val dataSet=dataFrame.as[å¼ºç±»å‹] 4ã€é€šè¿‡ä¸€ä¸ªDataSetè½¬æ¢ç”Ÿæˆä¸€ä¸ªæ–°çš„DataSet List(1,2,3,4,5).toDS.map(x=&gt;x*10) 6.5 RDDä»¥åŠDataFrameä»¥åŠDataSetçš„å…³ç³» é¦–å…ˆï¼ŒSpark RDDã€DataFrameå’ŒDataSetæ˜¯Sparkçš„ä¸‰ç±»APIï¼Œä¸‹å›¾æ˜¯ä»–ä»¬çš„å‘å±•è¿‡ç¨‹ï¼š DataFrameæ˜¯spark1.3.0ç‰ˆæœ¬æå‡ºæ¥çš„ï¼Œspark1.6.0ç‰ˆæœ¬åˆå¼•å…¥äº†DateSetçš„ï¼Œä½†æ˜¯åœ¨spark2.0ç‰ˆæœ¬ä¸­ï¼ŒDataFrameå’ŒDataSetåˆå¹¶ä¸ºDataSetã€‚ é‚£ä¹ˆä½ å¯èƒ½ä¼šé—®äº†ï¼šé‚£ä¹ˆï¼Œåœ¨2.0ä»¥åçš„ç‰ˆæœ¬é‡Œï¼ŒRDDæ˜¯ä¸æ˜¯ä¸éœ€è¦äº†å‘¢ï¼Ÿ ç­”æ¡ˆæ˜¯ï¼šNOï¼é¦–å…ˆï¼ŒDataFrameå’ŒDataSetæ˜¯åŸºäºRDDçš„ï¼Œè€Œä¸”è¿™ä¸‰è€…ä¹‹é—´å¯ä»¥é€šè¿‡ç®€å•çš„APIè°ƒç”¨è¿›è¡Œæ— ç¼åˆ‡æ¢ã€‚ ä¸‹é¢ï¼Œä¾æ¬¡ä»‹ç»è¿™ä¸‰ç±»APIçš„ç‰¹ç‚¹ä¸€ã€RDD RDDçš„ä¼˜ç‚¹ï¼š1.ç›¸æ¯”äºä¼ ç»Ÿçš„MapReduceæ¡†æ¶ï¼ŒSparkåœ¨RDDä¸­å†…ç½®å¾ˆå¤šå‡½æ•°æ“ä½œï¼Œgroupï¼Œmapï¼Œfilterç­‰ï¼Œæ–¹ä¾¿å¤„ç†ç»“æ„åŒ–æˆ–éç»“æ„åŒ–æ•°æ®ã€‚2.é¢å‘å¯¹è±¡ç¼–ç¨‹ï¼Œç›´æ¥å­˜å‚¨çš„javaå¯¹è±¡ï¼Œç±»å‹è½¬åŒ–ä¹Ÿå®‰å…¨ RDDçš„ç¼ºç‚¹ï¼š1.ç”±äºå®ƒåŸºæœ¬å’Œhadoopä¸€æ ·ä¸‡èƒ½çš„ï¼Œå› æ­¤æ²¡æœ‰é’ˆå¯¹ç‰¹æ®Šåœºæ™¯çš„ä¼˜åŒ–ï¼Œæ¯”å¦‚å¯¹äºç»“æ„åŒ–æ•°æ®å¤„ç†ç›¸å¯¹äºsqlæ¥æ¯”éå¸¸éº»çƒ¦2.é»˜è®¤é‡‡ç”¨çš„æ˜¯javaåºåˆ—å·æ–¹å¼ï¼Œåºåˆ—åŒ–ç»“æœæ¯”è¾ƒå¤§ï¼Œè€Œä¸”æ•°æ®å­˜å‚¨åœ¨javaå †å†…å­˜ä¸­ï¼Œå¯¼è‡´gcæ¯”è¾ƒé¢‘ç¹ äºŒã€DataFrameDataFrameçš„ä¼˜ç‚¹ï¼š1.ç»“æ„åŒ–æ•°æ®å¤„ç†éå¸¸æ–¹ä¾¿ï¼Œæ”¯æŒAvro, CSV, elastic search, and Cassandraç­‰kvæ•°æ®ï¼Œä¹Ÿæ”¯æŒHIVE tables, MySQLç­‰ä¼ ç»Ÿæ•°æ®è¡¨ 2.æœ‰é’ˆå¯¹æ€§çš„ä¼˜åŒ–ï¼Œå¦‚é‡‡ç”¨Kryoåºåˆ—åŒ–ï¼Œç”±äºæ•°æ®ç»“æ„å…ƒä¿¡æ¯sparkå·²ç»ä¿å­˜ï¼Œåºåˆ—åŒ–æ—¶ä¸éœ€è¦å¸¦ä¸Šå…ƒä¿¡æ¯ï¼Œå¤§å¤§çš„å‡å°‘äº†åºåˆ—åŒ–å¤§å°ï¼Œè€Œä¸”æ•°æ®ä¿å­˜åœ¨å †å¤–å†…å­˜ä¸­ï¼Œå‡å°‘äº†gcæ¬¡æ•°,æ‰€ä»¥è¿è¡Œæ›´å¿«ã€‚ 3.hiveå…¼å®¹ï¼Œæ”¯æŒhqlã€udfç­‰ DataFrameçš„ç¼ºç‚¹ï¼š1.ç¼–è¯‘æ—¶ä¸èƒ½ç±»å‹è½¬åŒ–å®‰å…¨æ£€æŸ¥ï¼Œè¿è¡Œæ—¶æ‰èƒ½ç¡®å®šæ˜¯å¦æœ‰é—®é¢˜2.å¯¹äºå¯¹è±¡æ”¯æŒä¸å‹å¥½ï¼Œrddå†…éƒ¨æ•°æ®ç›´æ¥ä»¥javaå¯¹è±¡å­˜å‚¨ï¼Œdataframeå†…å­˜å­˜å‚¨çš„æ˜¯rowå¯¹è±¡è€Œä¸èƒ½æ˜¯è‡ªå®šä¹‰å¯¹è±¡ ä¸‰ã€DateSet DateSetçš„ä¼˜ç‚¹ï¼š1.DateSetæ•´åˆäº†RDDå’ŒDataFrameçš„ä¼˜ç‚¹ï¼Œæ”¯æŒç»“æ„åŒ–å’Œéç»“æ„åŒ–æ•°æ®2.å’ŒRDDä¸€æ ·ï¼Œæ”¯æŒè‡ªå®šä¹‰å¯¹è±¡å­˜å‚¨3.å’ŒDataFrameä¸€æ ·ï¼Œæ”¯æŒç»“æ„åŒ–æ•°æ®çš„sqlæŸ¥è¯¢4.é‡‡ç”¨å †å¤–å†…å­˜å­˜å‚¨ï¼Œgcå‹å¥½ 5.ç±»å‹è½¬åŒ–å®‰å…¨ï¼Œä»£ç å‹å¥½ 7. é€šè¿‡IDEAå¼€å‘ç¨‹åºå®ç°æŠŠRDDè½¬æ¢DataFrame7.1 åˆ©ç”¨åå°„æœºåˆ¶ å®šä¹‰ä¸€ä¸ªæ ·ä¾‹ç±»ï¼ŒåæœŸç›´æ¥æ˜ å°„æˆDataFrameçš„schemaä¿¡æ¯ åº”ç”¨åœºæ™¯ åœ¨å¼€å‘ä»£ç ä¹‹å‰ï¼Œæ˜¯å¯ä»¥å…ˆç¡®å®šå¥½DataFrameçš„schemaå…ƒä¿¡æ¯case class Person(id:String,name:String,age:Int) ä»£ç å¼€å‘ import org.apache.spark.SparkContextimport org.apache.spark.rdd.RDDimport org.apache.spark.sql.&#123;Column, DataFrame, Row, SparkSession&#125;//todo:åˆ©ç”¨åå°„æœºåˆ¶å®ç°æŠŠrddè½¬æˆdataFramecase class Person(id:String,name:String,age:Int)object CaseClassSchema &#123; def main(args: Array[String]): Unit = &#123; //1ã€æ„å»ºSparkSessionå¯¹è±¡ val spark: SparkSession = SparkSession.builder().appName(&quot;CaseClassSchema&quot;).master(&quot;local[2]&quot;).getOrCreate() //2ã€è·å–sparkContextå¯¹è±¡ val sc: SparkContext = spark.sparkContext sc.setLogLevel(&quot;warn&quot;) //3ã€è¯»å–æ–‡ä»¶æ•°æ® val data: RDD[Array[String]] = sc.textFile(&quot;file:///D:\\\\å¼€è¯¾å§è¯¾ç¨‹èµ„æ–™\\\\15ã€scalaä¸sparkè¯¾ç¨‹èµ„æ–™\\\\2ã€sparkè¯¾ç¨‹\\\\spark_day05\\\\æ•°æ®&quot;).map(x=&gt;x.split(&quot; &quot;)) //4ã€å®šä¹‰ä¸€ä¸ªæ ·ä¾‹ç±» //5ã€å°†rddä¸æ ·ä¾‹ç±»è¿›è¡Œå…³è” val personRDD: RDD[Person] = data.map(x=&gt;Person(x(0),x(1),x(2).toInt)) //6ã€å°†rddè½¬æ¢æˆdataFrame //éœ€è¦æ‰‹åŠ¨å¯¼å…¥éšå¼è½¬æ¢ import spark.implicits._ val personDF: DataFrame = personRDD.toDF //7ã€å¯¹dataFrameè¿›è¡Œç›¸åº”çš„è¯­æ³•æ“ä½œ //todoï¼š----------------- DSLé£æ ¼è¯­æ³•-----------------start //æ‰“å°schema personDF.printSchema() //å±•ç¤ºæ•°æ® personDF.show() //è·å–ç¬¬ä¸€è¡Œæ•°æ® val first: Row = personDF.first() println(&quot;first:&quot;+first) //å–å‡ºå‰3ä½æ•°æ® val top3: Array[Row] = personDF.head(3) top3.foreach(println) //è·å–nameå­—æ®µ personDF.select(&quot;name&quot;).show() personDF.select($&quot;name&quot;).show() personDF.select(new Column(&quot;name&quot;)).show() personDF.select(&quot;name&quot;,&quot;age&quot;).show() //å®ç°age +1 personDF.select($&quot;name&quot;,$&quot;age&quot;,$&quot;age&quot;+1).show() //æŒ‰ç…§ageè¿‡æ»¤ personDF.filter($&quot;age&quot; &gt;30).show() val count: Long = personDF.filter($&quot;age&quot; &gt;30).count() println(&quot;count:&quot;+count) //åˆ†ç»„ personDF.groupBy(&quot;age&quot;).count().show() personDF.show() personDF.foreach(row =&gt; println(row)) //ä½¿ç”¨foreachè·å–æ¯ä¸€ä¸ªrowå¯¹è±¡ä¸­çš„nameå­—æ®µ personDF.foreach(row =&gt;println(row.getAs[String](&quot;name&quot;))) personDF.foreach(row =&gt;println(row.get(1))) personDF.foreach(row =&gt;println(row.getString(1))) personDF.foreach(row =&gt;println(row.getAs[String](1))) //todoï¼š----------------- DSLé£æ ¼è¯­æ³•--------------------end //todoï¼š----------------- SQLé£æ ¼è¯­æ³•-----------------start personDF.createTempView(&quot;person&quot;) //ä½¿ç”¨SparkSessionè°ƒç”¨sqlæ–¹æ³•ç»Ÿè®¡æŸ¥è¯¢ spark.sql(&quot;select * from person&quot;).show spark.sql(&quot;select name from person&quot;).show spark.sql(&quot;select name,age from person&quot;).show spark.sql(&quot;select * from person where age &gt;30&quot;).show spark.sql(&quot;select count(*) from person where age &gt;30&quot;).show spark.sql(&quot;select age,count(*) from person group by age&quot;).show spark.sql(&quot;select age,count(*) as count from person group by age&quot;).show spark.sql(&quot;select * from person order by age desc&quot;).show //todoï¼š----------------- SQLé£æ ¼è¯­æ³•----------------------end //å…³é—­sparkSessionå¯¹è±¡ spark.stop() &#125;&#125; 7.2 é€šè¿‡StructTypeåŠ¨æ€æŒ‡å®šSchema åº”ç”¨åœºæ™¯ åœ¨å¼€å‘ä»£ç ä¹‹å‰ï¼Œæ˜¯æ— æ³•ç¡®å®šéœ€è¦çš„DataFrameå¯¹åº”çš„schemaå…ƒä¿¡æ¯ã€‚éœ€è¦åœ¨å¼€å‘ä»£ç çš„è¿‡ç¨‹ä¸­åŠ¨æ€æŒ‡å®šã€‚ ä»£ç å¼€å‘ import org.apache.spark.SparkContextimport org.apache.spark.rdd.RDDimport org.apache.spark.sql.types.&#123;IntegerType, StringType, StructField, StructType&#125;import org.apache.spark.sql.&#123;DataFrame, Row, SparkSession&#125;//todoï¼›é€šè¿‡åŠ¨æ€æŒ‡å®šdataFrameå¯¹åº”çš„schemaä¿¡æ¯å°†rddè½¬æ¢æˆdataFrameobject StructTypeSchema &#123; def main(args: Array[String]): Unit = &#123; //1ã€æ„å»ºSparkSessionå¯¹è±¡ val spark: SparkSession = SparkSession.builder().appName(&quot;StructTypeSchema&quot;).master(&quot;local[2]&quot;).getOrCreate() //2ã€è·å–sparkContextå¯¹è±¡ val sc: SparkContext = spark.sparkContext sc.setLogLevel(&quot;warn&quot;) //3ã€è¯»å–æ–‡ä»¶æ•°æ® val data: RDD[Array[String]] = sc.textFile(&quot;file:///D:\\\\å¼€è¯¾å§è¯¾ç¨‹èµ„æ–™\\\\15ã€scalaä¸sparkè¯¾ç¨‹èµ„æ–™\\\\2ã€sparkè¯¾ç¨‹\\\\spark_day05\\\\æ•°æ®&quot;).map(x=&gt;x.split(&quot; &quot;)) //4ã€å°†rddä¸Rowå¯¹è±¡è¿›è¡Œå…³è” val rowRDD: RDD[Row] = data.map(x=&gt;Row(x(0),x(1),x(2).toInt)) //5ã€æŒ‡å®šdataFrameçš„schemaä¿¡æ¯ //è¿™é‡ŒæŒ‡å®šçš„å­—æ®µä¸ªæ•°å’Œç±»å‹å¿…é¡»è¦è·ŸRowå¯¹è±¡ä¿æŒä¸€è‡´ val schema=StructType( StructField(&quot;id&quot;,StringType):: StructField(&quot;name&quot;,StringType):: StructField(&quot;age&quot;,IntegerType)::Nil ) val dataFrame: DataFrame = spark.createDataFrame(rowRDD,schema) dataFrame.printSchema() dataFrame.show() dataFrame.createTempView(&quot;user&quot;) spark.sql(&quot;select * from user&quot;).show() spark.stop() &#125;&#125; 8ã€sparkSQLè¯»å–sqlæ•°æ®spark sqlå¯ä»¥é€šè¿‡ JDBC ä»å…³ç³»å‹æ•°æ®åº“ä¸­è¯»å–æ•°æ®çš„æ–¹å¼åˆ›å»ºDataFrameï¼Œé€šè¿‡å¯¹DataFrameä¸€ç³»åˆ—çš„è®¡ç®—åï¼Œè¿˜å¯ä»¥å°†æ•°æ®å†å†™å›å…³ç³»å‹æ•°æ®åº“ä¸­ æ·»åŠ mysqlè¿æ¥é©±åŠ¨jaråŒ… &lt;dependency&gt; &lt;groupId&gt;mysql&lt;/groupId&gt; &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt; &lt;version&gt;5.1.38&lt;/version&gt;&lt;/dependency&gt; ä»£ç å¼€å‘ import java.util.Propertiesimport org.apache.spark.SparkConfimport org.apache.spark.sql.&#123;DataFrame, SparkSession&#125;//todo:åˆ©ç”¨sparksqlåŠ è½½mysqlè¡¨ä¸­çš„æ•°æ®object DataFromMysql &#123; def main(args: Array[String]): Unit = &#123; //1ã€åˆ›å»ºSparkConfå¯¹è±¡ val sparkConf: SparkConf = new SparkConf().setAppName(&quot;DataFromMysql&quot;).setMaster(&quot;local[2]&quot;) //2ã€åˆ›å»ºSparkSessionå¯¹è±¡ val spark: SparkSession = SparkSession.builder().config(sparkConf).getOrCreate() //3ã€è¯»å–mysqlè¡¨çš„æ•°æ® //3.1 æŒ‡å®šmysqlè¿æ¥åœ°å€ val url=&quot;jdbc:mysql://localhost:3306/mydb?characterEncoding=UTF-8&quot; //3.2 æŒ‡å®šè¦åŠ è½½çš„è¡¨å val tableName=&quot;jobdetail&quot; // 3.3 é…ç½®è¿æ¥æ•°æ®åº“çš„ç›¸å…³å±æ€§ val properties = new Properties() //ç”¨æˆ·å properties.setProperty(&quot;user&quot;,&quot;root&quot;) //å¯†ç  properties.setProperty(&quot;password&quot;,&quot;123456&quot;) val mysqlDF: DataFrame = spark.read.jdbc(url,tableName,properties) //æ‰“å°schemaä¿¡æ¯ mysqlDF.printSchema() //å±•ç¤ºæ•°æ® mysqlDF.show() //æŠŠdataFrameæ³¨å†Œæˆè¡¨ mysqlDF.createTempView(&quot;job_detail&quot;) spark.sql(&quot;select * from job_detail where city = &#x27;å¹¿ä¸œ&#x27; &quot;).show() spark.stop() &#125;&#125; 9ã€sparkSQLæ“ä½œCSVæ–‡ä»¶å¹¶å°†ç»“æœå†™å…¥mysqlä½¿ç”¨sparkç¨‹åºè¯»å–CSVæ–‡ä»¶ï¼Œç„¶åå°†è¯»å–åˆ°çš„æ•°æ®å†…å®¹ï¼Œä¿å­˜åˆ°mysqlé‡Œé¢å»ï¼Œæ³¨æ„csvæ–‡ä»¶çš„æ¢è¡Œé—®é¢˜ã€‚ import java.util.Propertiesimport org.apache.spark.SparkConfimport org.apache.spark.sql.&#123;DataFrame, SaveMode, SparkSession&#125;object CSVOperate &#123; def main(args: Array[String]): Unit = &#123; val sparkConf: SparkConf = new SparkConf().setMaster(&quot;local[8]&quot;).setAppName(&quot;sparkCSV&quot;) val session: SparkSession = SparkSession.builder().config(sparkConf).getOrCreate() session.sparkContext.setLogLevel(&quot;WARN&quot;) val frame: DataFrame = session .read .format(&quot;csv&quot;) .option(&quot;timestampFormat&quot;, &quot;yyyy/MM/dd HH:mm:ss ZZ&quot;) .option(&quot;header&quot;, &quot;true&quot;) .option(&quot;multiLine&quot;, true) .load(&quot;file:///D:\\\\å¼€è¯¾å§è¯¾ç¨‹èµ„æ–™\\\\15ã€scalaä¸sparkè¯¾ç¨‹èµ„æ–™\\\\2ã€sparkè¯¾ç¨‹\\\\spark_day05\\\\æ•°æ®\\\\æ‹›è˜æ•°æ®&quot;) frame.createOrReplaceTempView(&quot;job_detail&quot;) //session.sql(&quot;select job_name,job_url,job_location,job_salary,job_company,job_experience,job_class,job_given,job_detail,company_type,company_person,search_key,city from job_detail where job_company = &#x27;åŒ—äº¬æ— ææ…§é€šç§‘æŠ€æœ‰é™å…¬å¸&#x27; &quot;).show(80) val prop = new Properties() prop.put(&quot;user&quot;, &quot;root&quot;) prop.put(&quot;password&quot;, &quot;123456&quot;) frame.write.mode(SaveMode.Append).jdbc(&quot;jdbc:mysql://localhost:3306/mydb?useSSL=false&amp;useUnicode=true&amp;characterEncoding=UTF-8&quot;, &quot;mydb.jobdetail_copy&quot;, prop) &#125;&#125; 10ã€spark on hive ä¸hive on sparkSpark on hive ä¸ Hive on Spark çš„åŒºåˆ« Spark on hive Sparké€šè¿‡Spark-SQLä½¿ç”¨hive è¯­å¥,æ“ä½œhive,åº•å±‚è¿è¡Œçš„è¿˜æ˜¯ spark rddã€‚ ï¼ˆ1ï¼‰å°±æ˜¯é€šè¿‡sparksqlï¼ŒåŠ è½½hiveçš„é…ç½®æ–‡ä»¶ï¼Œè·å–åˆ°hiveçš„å…ƒæ•°æ®ä¿¡æ¯ ï¼ˆ2ï¼‰spark sqlè·å–åˆ°hiveçš„å…ƒæ•°æ®ä¿¡æ¯ä¹‹åå°±å¯ä»¥æ‹¿åˆ°hiveçš„æ‰€æœ‰è¡¨çš„æ•°æ® ï¼ˆ3ï¼‰æ¥ä¸‹æ¥å°±å¯ä»¥é€šè¿‡spark sqlæ¥æ“ä½œhiveè¡¨ä¸­çš„æ•°æ® Hive on Spark æ˜¯æŠŠhiveæŸ¥è¯¢ä»mapreduce çš„mr (Hadoopè®¡ç®—å¼•æ“)æ“ä½œæ›¿æ¢ä¸ºspark rddï¼ˆspark æ‰§è¡Œå¼•æ“ï¼‰ æ“ä½œ. ç›¸å¯¹äºspark on hive,è¿™ä¸ªè¦å®ç°èµ·æ¥åˆ™éº»çƒ¦å¾ˆå¤š, å¿…é¡»é‡æ–°ç¼–è¯‘ä½ çš„sparkå’Œå¯¼å…¥jaråŒ…ï¼Œä¸è¿‡ç›®å‰å¤§éƒ¨åˆ†ä½¿ç”¨çš„æ˜¯spark on hiveã€‚ sparkä¸hive.pptx 1ã€spark_sqlä¸hiveè¿›è¡Œæ•´åˆç¬¬ä¸€æ­¥ï¼šæ‹·è´hive-site.xmlé…ç½®æ–‡ä»¶å°†node03æœåŠ¡å™¨å®‰è£…çš„hiveå®¶ç›®å½•ä¸‹çš„confæ–‡ä»¶å¤¹ä¸‹é¢çš„hive-site.xmlæ‹·è´åˆ°sparkå®‰è£…çš„å„ä¸ªæœºå™¨èŠ‚ç‚¹ï¼Œnode03æ‰§è¡Œä»¥ä¸‹å‘½ä»¤è¿›è¡Œæ‹·è´ cd /kkb/install/hive-1.1.0-cdh5.14.2/confscp hive-site.xml node01:/kkb/install/spark-2.3.3-bin-hadoop2.7/conf/scp hive-site.xml node02:/kkb/install/spark-2.3.3-bin-hadoop2.7/conf/scp hive-site.xml node03:/kkb/install/spark-2.3.3-bin-hadoop2.7/conf/ ç¬¬äºŒæ­¥ï¼šæ‹·è´mysqlè¿æ¥é©±åŠ¨åŒ…å°†hiveå½“ä¸­mysqlçš„è¿æ¥é©±åŠ¨åŒ…æ‹·è´åˆ°sparkå®‰è£…å®¶ç›®å½•ä¸‹çš„libç›®å½•ä¸‹ï¼Œnode03æ‰§è¡Œä¸‹å‘½ä»¤æ‹·è´mysqlçš„libé©±åŠ¨åŒ… cd /kkb/install/hive-1.1.0-cdh5.14.2/lib/scp mysql-connector-java-5.1.38.jar node01:/kkb/install/spark-2.3.3-bin-hadoop2.7/jars/scp mysql-connector-java-5.1.38.jar node02:/kkb/install/spark-2.3.3-bin-hadoop2.7/jars/scp mysql-connector-java-5.1.38.jar node03:/kkb/install/spark-2.3.3-bin-hadoop2.7/jars/ ç¬¬ä¸‰æ­¥ï¼šè¿›å…¥spark-sqlç›´æ¥æ“ä½œhiveæ•°æ®åº“å½“ä¸­çš„æ•°æ®åœ¨spark2.0ç‰ˆæœ¬åç”±äºå‡ºç°äº†sparkSessionï¼Œåœ¨åˆå§‹åŒ–sqlContextçš„æ—¶å€™ï¼Œä¼šè®¾ç½®é»˜è®¤çš„==spark.sql.warehouse.dir=spark-warehouse==, æ­¤æ—¶å°†hiveä¸sparksqlæ•´åˆå®Œæˆä¹‹åï¼Œåœ¨é€šè¿‡spark-sqlè„šæœ¬å¯åŠ¨çš„æ—¶å€™ï¼Œè¿˜æ˜¯ä¼šåœ¨å“ªé‡Œå¯åŠ¨spark-sqlè„šæœ¬ï¼Œå°±ä¼šåœ¨å½“å‰ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªspark.sql.warehouse.dirä¸ºspark-warehouseçš„ç›®å½•ï¼Œå­˜æ”¾ç”±spark-sqlåˆ›å»ºæ•°æ®åº“å’Œåˆ›å»ºè¡¨çš„æ•°æ®ä¿¡æ¯ï¼Œä¸ä¹‹å‰hiveçš„æ•°æ®æ¯ä¸æ˜¯æ”¾åœ¨åŒä¸€ä¸ªè·¯å¾„ä¸‹ï¼ˆå¯ä»¥äº’ç›¸è®¿é—®ï¼‰ã€‚ä½†æ˜¯æ­¤æ—¶spark-sqlä¸­è¡¨çš„æ•°æ®åœ¨æœ¬åœ°ï¼Œä¸åˆ©äºæ“ä½œï¼Œä¹Ÿä¸å®‰å…¨ã€‚ æ‰€æœ‰åœ¨å¯åŠ¨çš„æ—¶å€™éœ€è¦åŠ ä¸Šè¿™æ ·ä¸€ä¸ªå‚æ•°ï¼š â€”conf spark.sql.warehouse.dir=hdfs://node01:8020/user/hive/warehouse ä¿è¯spark-sqlå¯åŠ¨æ—¶ä¸åœ¨äº§ç”Ÿæ–°çš„å­˜æ”¾æ•°æ®çš„ç›®å½•ï¼Œsparksqlä¸hiveæœ€ç»ˆä½¿ç”¨çš„æ˜¯hiveåŒä¸€å­˜æ”¾æ•°æ®çš„ç›®å½•ã€‚ node01ç›´æ¥æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œè¿›å…¥spark-sqläº¤äº’ç•Œé¢ï¼Œç„¶åæ“ä½œhiveå½“ä¸­çš„æ•°æ®ï¼Œ cd /kkb/install/spark-2.3.3-bin-hadoop2.7/bin/spark-sql --master local[2] \\--executor-memory 512m --total-executor-cores 3 \\--conf spark.sql.warehouse.dir=hdfs://node01:8020/user/hive/warehouse \\--jars /kkb/install/hadoop-2.6.0-cdh5.14.2/share/hadoop/common/hadoop-lzo-0.4.20.jar ä½¿ç”¨sparkSQLæœ‰hiveè¿›è¡Œæ•´åˆä¹‹åï¼Œå°±å¯ä»¥é€šè¿‡sparkSQLè¯­å¥æ¥æ“ä½œhiveè¡¨æ•°æ®äº† åº”ç”¨åœºæ™¯ #!/bin/sh#å®šä¹‰sparksqlæäº¤è„šæœ¬çš„å¤´ä¿¡æ¯SUBMITINFO=&quot;spark-sql --master spark://node01:7077 --executor-memory 1g --total-executor-cores 4 --conf spark.sql.warehouse.dir=hdfs://node01:8020/user/hive/warehouse&quot; #å®šä¹‰ä¸€ä¸ªsqlè¯­å¥SQL=&quot;select * from default.hive_source;&quot; #æ‰§è¡Œsqlè¯­å¥ ç±»ä¼¼äº hive -e sqlè¯­å¥echo &quot;$SUBMITINFO&quot; echo &quot;$SQL&quot;$SUBMITINFO -e &quot;$SQL&quot; 2ã€å¯ç”¨sparkçš„thrift serverä¸hiveè¿›è¡Œè¿œç¨‹äº¤äº’é™¤äº†å¯ä»¥é€šè¿‡spark-shellæ¥ä¸hiveè¿›è¡Œæ•´åˆä¹‹å¤–ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡sparkçš„thriftæœåŠ¡æ¥è¿œç¨‹ä¸hiveè¿›è¡Œäº¤äº’ ç¬¬ä¸€æ­¥ï¼šä¿®æ”¹hive-site.xmlçš„é…ç½®node03æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ä¿®æ”¹hive-site.xmlçš„é…ç½®å±æ€§ï¼Œæ·»åŠ ä»¥ä¸‹å‡ ä¸ªé…ç½® cd /kkb/install/hive-1.1.0-cdh5.14.2/confvim hive-site.xml&lt;property&gt; &lt;name&gt;hive.metastore.uris&lt;/name&gt; &lt;value&gt;thrift://node03:9083&lt;/value&gt; &lt;description&gt;Thrift URI for the remote metastore&lt;/description&gt; &lt;/property&gt; &lt;property&gt; &lt;name&gt;hive.server2.thrift.min.worker.threads&lt;/name&gt; &lt;value&gt;5&lt;/value&gt; &lt;/property&gt; &lt;property&gt; &lt;name&gt;hive.server2.thrift.max.worker.threads&lt;/name&gt; &lt;value&gt;500&lt;/value&gt; &lt;/property&gt; &lt;property&gt; &lt;name&gt;hive.server2.thrift.port&lt;/name&gt; &lt;value&gt;10000&lt;/value&gt; &lt;/property&gt; &lt;property&gt; &lt;name&gt;hive.server2.thrift.bind.host&lt;/name&gt; &lt;value&gt;node03&lt;/value&gt; &lt;/property&gt; ç¬¬äºŒæ­¥ï¼šä¿®æ”¹å®Œçš„é…ç½®æ–‡ä»¶åˆ†å‘åˆ°å…¶ä»–æœºå™¨node03æ‰§è¡Œä»¥ä¸‹å‘½ä»¤åˆ†å‘hiveé…ç½®æ–‡ä»¶ cd /kkb/install/hive-1.1.0-cdh5.14.2/confscp hive-site.xml node01:/kkb/install/spark-2.3.3-bin-hadoop2.7/conf/scp hive-site.xml node02:/kkb/install/spark-2.3.3-bin-hadoop2.7/conf/scp hive-site.xml node03:/kkb/install/spark-2.3.3-bin-hadoop2.7/conf/ ç¬¬ä¸‰æ­¥ï¼šnode03å¯åŠ¨metastoreæœåŠ¡node03æ‰§è¡Œä»¥ä¸‹å‘½ä»¤å¯åŠ¨metastoreæœåŠ¡ cd /kkb/install/hive-1.1.0-cdh5.14.2/bin/hive --service metastore ç¬¬å››æ­¥ï¼šnode03æ‰§è¡Œä»¥ä¸‹å‘½ä»¤å¯åŠ¨sparkçš„thrift server==æ³¨æ„ï¼šhiveå®‰è£…åœ¨å“ªä¸€å°ï¼Œå°±åœ¨å“ªä¸€å°æœåŠ¡å™¨å¯åŠ¨sparkçš„thrift server== æˆ‘çš„hiveå®‰è£…åœ¨node03æœåŠ¡å™¨ï¼Œæ‰€ä»¥æˆ‘åœ¨node03æœåŠ¡å™¨ä¸Šé¢å¯åŠ¨sparkçš„thrift serveræœåŠ¡ node03æ‰§è¡Œä»¥ä¸‹å‘½ä»¤å¯åŠ¨thrift serveræœåŠ¡ cd /kkb/install/spark-2.3.3-bin-hadoop2.7sbin/start-thriftserver.sh --master local[2] --executor-memory 5g --total-executor-cores 5 --jars /kkb/install/hadoop-2.6.0-cdh5.14.2/share/hadoop/common/hadoop-lzo-0.4.20.jar ç¬¬äº”æ­¥ï¼šç›´æ¥ä½¿ç”¨beelineæ¥è¿æ¥ç›´æ¥åœ¨node03æœåŠ¡å™¨ä¸Šé¢ä½¿ç”¨beelineæ¥è¿›è¡Œè¿æ¥spark-sql cd /kkb/install/spark-2.3.3-bin-hadoop2.7bin/beeline beeline&gt; !connect jdbc:hive2://node03:10000Connecting to jdbc:hive2://node03:10000Enter username for jdbc:hive2://node03:10000: hadoopEnter password for jdbc:hive2://node03:10000: ****** 11ã€sparkSQLè‡ªå®šä¹‰å‡½æ•°ç”¨æˆ·è‡ªå®šä¹‰å‡½æ•°ç±»åˆ«åˆ†ä¸ºä»¥ä¸‹ä¸‰ç§ï¼š 1).UDFï¼šè¾“å…¥ä¸€è¡Œï¼Œè¿”å›ä¸€ä¸ªç»“æœ(ä¸€å¯¹ä¸€)ï¼Œåœ¨ä¸Šç¯‡æ¡ˆä¾‹ ä½¿ç”¨SparkSQLå®ç°æ ¹æ®ipåœ°å€è®¡ç®—å½’å±åœ°äºŒ ä¸­å®ç°çš„è‡ªå®šä¹‰å‡½æ•°å°±æ˜¯UDFï¼Œè¾“å…¥ä¸€ä¸ªåè¿›åˆ¶çš„ipåœ°å€ï¼Œè¿”å›ä¸€ä¸ªçœä»½ 2).UDTFï¼šè¾“å…¥ä¸€è¡Œï¼Œè¿”å›å¤šè¡Œ(ä¸€å¯¹å¤š)ï¼Œåœ¨SparkSQLä¸­æ²¡æœ‰ï¼Œå› ä¸ºSparkä¸­ä½¿ç”¨flatMapå³å¯å®ç°è¿™ä¸ªåŠŸèƒ½ 3).UDAFï¼šè¾“å…¥å¤šè¡Œï¼Œè¿”å›ä¸€è¡Œï¼Œè¿™é‡Œçš„Aæ˜¯aggregateï¼Œèšåˆçš„æ„æ€ï¼Œå¦‚æœä¸šåŠ¡å¤æ‚ï¼Œéœ€è¦è‡ªå·±å®ç°èšåˆå‡½æ•° 1ã€è‡ªå®šä¹‰UDFå‡½æ•°è¯»å–æ·±åœ³äºŒæ‰‹æˆ¿æˆäº¤æ•°æ®ï¼Œå¯¹æˆ¿å­çš„å¹´ä»½è¿›è¡Œè‡ªå®šä¹‰å‡½æ•°å¤„ç†ï¼Œå¦‚æœæ²¡æœ‰å¹´ä»½ï¼Œé‚£ä¹ˆå°±ç»™é»˜è®¤å€¼1990 import java.util.regex.&#123;Matcher, Pattern&#125;import org.apache.spark.SparkConfimport org.apache.spark.sql.api.java.UDF1import org.apache.spark.sql.types.DataTypesimport org.apache.spark.sql.&#123;DataFrame, SparkSession&#125;object SparkUDF &#123; def main(args: Array[String]): Unit = &#123; val sparkConf: SparkConf = new SparkConf().setMaster(&quot;local[8]&quot;).setAppName(&quot;sparkCSV&quot;) val session: SparkSession = SparkSession.builder().config(sparkConf).getOrCreate() session.sparkContext.setLogLevel(&quot;WARN&quot;) val frame: DataFrame = session .read .format(&quot;csv&quot;) .option(&quot;timestampFormat&quot;, &quot;yyyy/MM/dd HH:mm:ss ZZ&quot;) .option(&quot;header&quot;, &quot;true&quot;) .option(&quot;multiLine&quot;, true) .load(&quot;file:///D:\\\\å¼€è¯¾å§è¯¾ç¨‹èµ„æ–™\\\\15ã€scalaä¸sparkè¯¾ç¨‹èµ„æ–™\\\\2ã€sparkè¯¾ç¨‹\\\\spark_day05\\\\æ•°æ®\\\\æ·±åœ³é“¾å®¶äºŒæ‰‹æˆ¿æˆäº¤æ˜ç»†&quot;) frame.createOrReplaceTempView(&quot;house_sale&quot;) session.udf.register(&quot;house_udf&quot;,new UDF1[String,String] &#123; val pattern: Pattern = Pattern.compile(&quot;^[0-9]*$&quot;) override def call(input: String): String = &#123; val matcher: Matcher = pattern.matcher(input) if(matcher.matches())&#123; input &#125;else&#123; &quot;1990&quot; &#125; &#125; &#125;,DataTypes.StringType) session.sql(&quot;select house_udf(house_age) from house_sale limit 200&quot;).show() session.stop() &#125;&#125; 2ã€è‡ªå®šä¹‰UDAFå‡½æ•°éœ€æ±‚ï¼šè‡ªå®šä¹‰UDAFå‡½æ•°ï¼Œè¯»å–æ·±åœ³äºŒæ‰‹æˆ¿æ•°æ®ï¼Œç„¶åæŒ‰ç…§æ¥¼å±‚è¿›è¡Œåˆ†ç»„ï¼Œæ±‚å–æ¯ä¸ªæ¥¼å±‚çš„å¹³å‡æˆäº¤é‡‘é¢ import org.apache.spark.SparkConfimport org.apache.spark.sql.&#123;DataFrame, Row, SparkSession&#125;import org.apache.spark.sql.expressions.&#123;MutableAggregationBuffer, UserDefinedAggregateFunction&#125;import org.apache.spark.sql.types._class MyAverage extends UserDefinedAggregateFunction &#123; // èšåˆå‡½æ•°è¾“å…¥å‚æ•°çš„æ•°æ®ç±»å‹ def inputSchema: StructType = StructType(StructField(&quot;floor&quot;, DoubleType) :: Nil) // èšåˆç¼“å†²åŒºä¸­å€¼å¾—æ•°æ®ç±»å‹ def bufferSchema: StructType = &#123; StructType(StructField(&quot;sum&quot;, DoubleType) :: StructField(&quot;count&quot;, LongType) :: Nil) &#125; // è¿”å›å€¼çš„æ•°æ®ç±»å‹ def dataType: DataType = DoubleType // å¯¹äºç›¸åŒçš„è¾“å…¥æ˜¯å¦ä¸€ç›´è¿”å›ç›¸åŒçš„è¾“å‡ºã€‚ def deterministic: Boolean = true // åˆå§‹åŒ– def initialize(buffer: MutableAggregationBuffer): Unit = &#123; // ç”¨äºå­˜å‚¨ä¸åŒç±»å‹çš„æ¥¼æˆ¿çš„æ€»æˆäº¤é¢ buffer(0) = 0D // ç”¨äºå­˜å‚¨ä¸åŒç±»å‹çš„æ¥¼æˆ¿çš„æ€»ä¸ªæ•° buffer(1) = 0L &#125; // ç›¸åŒExecuteé—´çš„æ•°æ®åˆå¹¶ã€‚ def update(buffer: MutableAggregationBuffer, input: Row): Unit = &#123; if (!input.isNullAt(0)) &#123; buffer(0) = buffer.getDouble(0) + input.getDouble(0) buffer(1) = buffer.getLong(1) + 1 &#125; &#125; // ä¸åŒExecuteé—´çš„æ•°æ®åˆå¹¶ def merge(buffer1: MutableAggregationBuffer, buffer2: Row): Unit = &#123; buffer1(0) = buffer1.getDouble(0) + buffer2.getDouble(0) buffer1(1) = buffer1.getLong(1) + buffer2.getLong(1) &#125; // è®¡ç®—æœ€ç»ˆç»“æœ def evaluate(buffer: Row): Double = buffer.getDouble(0) / buffer.getLong(1)&#125;object MyAverage&#123; def main(args: Array[String]): Unit = &#123; val sparkConf: SparkConf = new SparkConf().setMaster(&quot;local[8]&quot;).setAppName(&quot;sparkCSV&quot;) val session: SparkSession = SparkSession.builder().config(sparkConf).getOrCreate() session.sparkContext.setLogLevel(&quot;WARN&quot;) val frame: DataFrame = session .read .format(&quot;csv&quot;) .option(&quot;timestampFormat&quot;, &quot;yyyy/MM/dd HH:mm:ss ZZ&quot;) .option(&quot;header&quot;, &quot;true&quot;) .option(&quot;multiLine&quot;, true) .load(&quot;file:///D:\\\\å¼€è¯¾å§è¯¾ç¨‹èµ„æ–™\\\\15ã€scalaä¸sparkè¯¾ç¨‹èµ„æ–™\\\\2ã€sparkè¯¾ç¨‹\\\\spark_day05\\\\æ•°æ®\\\\æ·±åœ³é“¾å®¶äºŒæ‰‹æˆ¿æˆäº¤æ˜ç»†&quot;) frame.createOrReplaceTempView(&quot;house_sale&quot;) session.sql(&quot;select floor from house_sale limit 30&quot;).show() session.udf.register(&quot;udaf&quot;,new MyAverage) session.sql(&quot;select floor, udaf(house_sale_money) from house_sale group by floor&quot;).show() frame.printSchema() session.stop() &#125;&#125; 12ã€sparkSQLæ¶æ„è®¾è®¡sparkSQLæ˜¯sparkæŠ€æœ¯æ ˆå½“ä¸­åˆä¸€éå¸¸å‡ºå½©çš„æ¨¡å—ï¼Œé€šè¿‡å¼•å…¥SQLçš„æ”¯æŒï¼Œå¤§å¤§é™ä½äº†å¼€å‘äººå‘˜å’Œå­¦ä¹ äººå‘˜çš„ä½¿ç”¨æˆæœ¬ï¼Œè®©æˆ‘ä»¬å¼€å‘äººå‘˜ç›´æ¥ä½¿ç”¨SQLçš„æ–¹å¼å°±èƒ½å¤Ÿå®ç°å¤§æ•°æ®çš„å¼€å‘ï¼Œå®ƒåŒæ—¶æ”¯æŒDSLä»¥åŠSQLçš„è¯­æ³•é£æ ¼ï¼Œç›®å‰åœ¨sparkçš„æ•´ä¸ªæ¶æ„è®¾è®¡å½“ä¸­ï¼Œæ‰€æœ‰çš„sparkæ¨¡å—ï¼Œä¾‹å¦‚SQLï¼ŒSparkMLï¼ŒsparkGrahpxä»¥åŠStructed Streamingç­‰éƒ½æ˜¯åŸºäº Catalyst Optimization &amp; Tungsten Executionæ¨¡å—ä¹‹ä¸Šè¿è¡Œï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºå°±æ˜¾ç¤ºäº†sparkçš„æ•´ä½“æ¶æ„æ¨¡å—è®¾è®¡ 1ã€sparkSQLçš„æ¶æ„è®¾è®¡å®ç°sparkSQL æ‰§è¡Œå…ˆä¼šç»è¿‡ SQL Parser è§£æ SQLï¼Œç„¶åç»è¿‡ Catalyst ä¼˜åŒ–å™¨å¤„ç†ï¼Œæœ€ååˆ° Spark æ‰§è¡Œã€‚è€Œ Catalyst çš„è¿‡ç¨‹åˆåˆ†ä¸ºå¾ˆå¤šä¸ªè¿‡ç¨‹ï¼Œå…¶ä¸­åŒ…æ‹¬ï¼š Analysisï¼šä¸»è¦åˆ©ç”¨ Catalog ä¿¡æ¯å°† Unresolved Logical Plan è§£ææˆ Analyzed logical planï¼› Logical Optimizationsï¼šåˆ©ç”¨ä¸€äº› Rule ï¼ˆè§„åˆ™ï¼‰å°† Analyzed logical plan è§£ææˆ Optimized Logical Planï¼› Physical Planningï¼šå‰é¢çš„ logical plan ä¸èƒ½è¢« Spark æ‰§è¡Œï¼Œè€Œè¿™ä¸ªè¿‡ç¨‹æ˜¯æŠŠ logical plan è½¬æ¢æˆå¤šä¸ª physical plansï¼Œç„¶ååˆ©ç”¨ä»£ä»·æ¨¡å‹ï¼ˆcost modelï¼‰é€‰æ‹©æœ€ä½³çš„ physical planï¼› Code Generationï¼šè¿™ä¸ªè¿‡ç¨‹ä¼šæŠŠ SQL æŸ¥è¯¢ç”Ÿæˆ Java å­— èŠ‚ç ã€‚ sparkSQLæ¶æ„è®¾è®¡.pptx ä¾‹å¦‚æ‰§è¡Œä»¥ä¸‹SQLè¯­å¥ï¼š select temp1.class,sum(temp1.degree),avg(temp1.degree) from (SELECT students.sno AS ssno,students.sname,students.ssex,students.sbirthday,students.class, scores.sno,scores.degree,scores.cno FROM students LEFT JOIN scores ON students.sno = scores.sno ) temp1 group by temp1.class ä»£ç å®ç°è¿‡ç¨‹å¦‚ä¸‹ï¼š package com.kkb.sparksqlimport java.util.Propertiesimport org.apache.spark.SparkConfimport org.apache.spark.sql.&#123;DataFrame, SparkSession&#125;//todo:åˆ©ç”¨sparksqlåŠ è½½mysqlè¡¨ä¸­çš„æ•°æ®object DataFromMysqlPlan &#123; def main(args: Array[String]): Unit = &#123; //1ã€åˆ›å»ºSparkConfå¯¹è±¡ val sparkConf: SparkConf = new SparkConf().setAppName(&quot;DataFromMysql&quot;).setMaster(&quot;local[2]&quot;) //sparkConf.set(&quot;spark.sql.codegen.wholeStage&quot;,&quot;true&quot;) //2ã€åˆ›å»ºSparkSessionå¯¹è±¡ val spark: SparkSession = SparkSession.builder().config(sparkConf).getOrCreate() spark.sparkContext.setLogLevel(&quot;WARN&quot;) //3ã€è¯»å–mysqlè¡¨çš„æ•°æ® //3.1 æŒ‡å®šmysqlè¿æ¥åœ°å€ val url=&quot;jdbc:mysql://localhost:3306/mydb?characterEncoding=UTF-8&quot; //3.2 æŒ‡å®šè¦åŠ è½½çš„è¡¨å val student=&quot;students&quot; val score=&quot;scores&quot; // 3.3 é…ç½®è¿æ¥æ•°æ®åº“çš„ç›¸å…³å±æ€§ val properties = new Properties() //ç”¨æˆ·å properties.setProperty(&quot;user&quot;,&quot;root&quot;) //å¯†ç  properties.setProperty(&quot;password&quot;,&quot;123456&quot;) val studentFrame: DataFrame = spark.read.jdbc(url,student,properties) val scoreFrame: DataFrame = spark.read.jdbc(url,score,properties) //æŠŠdataFrameæ³¨å†Œæˆè¡¨ studentFrame.createTempView(&quot;students&quot;) scoreFrame.createOrReplaceTempView(&quot;scores&quot;) //spark.sql(&quot;SELECT temp1.class,SUM(temp1.degree),AVG(temp1.degree) FROM (SELECT students.sno AS ssno,students.sname,students.ssex,students.sbirthday,students.class, scores.sno,scores.degree,scores.cno FROM students LEFT JOIN scores ON students.sno = scores.sno ) temp1 GROUP BY temp1.class; &quot;).show() val resultFrame: DataFrame = spark.sql(&quot;SELECT temp1.class,SUM(temp1.degree),AVG(temp1.degree) FROM (SELECT students.sno AS ssno,students.sname,students.ssex,students.sbirthday,students.class, scores.sno,scores.degree,scores.cno FROM students LEFT JOIN scores ON students.sno = scores.sno WHERE degree &gt; 60 AND sbirthday &gt; &#x27;1973-01-01 00:00:00&#x27; ) temp1 GROUP BY temp1.class&quot;) resultFrame.explain(true) resultFrame.show() spark.stop() &#125;&#125; é€šè¿‡explainæ–¹æ³•æ¥æŸ¥çœ‹sqlçš„æ‰§è¡Œè®¡åˆ’ï¼Œå¾—åˆ°ä»¥ä¸‹ä¿¡æ¯ == Parsed Logical Plan ==&#x27;Aggregate [&#x27;temp1.class], [&#x27;temp1.class, unresolvedalias(&#x27;SUM(&#x27;temp1.degree), None), unresolvedalias(&#x27;AVG(&#x27;temp1.degree), None)]+- &#x27;SubqueryAlias temp1 +- &#x27;Project [&#x27;students.sno AS ssno#16, &#x27;students.sname, &#x27;students.ssex, &#x27;students.sbirthday, &#x27;students.class, &#x27;scores.sno, &#x27;scores.degree, &#x27;scores.cno] +- &#x27;Filter ((&#x27;degree &gt; 60) &amp;&amp; (&#x27;sbirthday &gt; 1973-01-01 00:00:00)) +- &#x27;Join LeftOuter, (&#x27;students.sno = &#x27;scores.sno) :- &#x27;UnresolvedRelation `students` +- &#x27;UnresolvedRelation `scores`== Analyzed Logical Plan ==class: string, sum(degree): decimal(20,1), avg(degree): decimal(14,5)Aggregate [class#4], [class#4, sum(degree#12) AS sum(degree)#27, avg(degree#12) AS avg(degree)#28]+- SubqueryAlias temp1 +- Project [sno#0 AS ssno#16, sname#1, ssex#2, sbirthday#3, class#4, sno#10, degree#12, cno#11] +- Filter ((cast(degree#12 as decimal(10,1)) &gt; cast(cast(60 as decimal(2,0)) as decimal(10,1))) &amp;&amp; (cast(sbirthday#3 as string) &gt; 1973-01-01 00:00:00)) +- Join LeftOuter, (sno#0 = sno#10) :- SubqueryAlias students : +- Relation[sno#0,sname#1,ssex#2,sbirthday#3,class#4] JDBCRelation(students) [numPartitions=1] +- SubqueryAlias scores +- Relation[sno#10,cno#11,degree#12] JDBCRelation(scores) [numPartitions=1]== Optimized Logical Plan ==Aggregate [class#4], [class#4, sum(degree#12) AS sum(degree)#27, cast((avg(UnscaledValue(degree#12)) / 10.0) as decimal(14,5)) AS avg(degree)#28]+- Project [class#4, degree#12] +- Join Inner, (sno#0 = sno#10) :- Project [sno#0, class#4] : +- Filter ((isnotnull(sbirthday#3) &amp;&amp; (cast(sbirthday#3 as string) &gt; 1973-01-01 00:00:00)) &amp;&amp; isnotnull(sno#0)) : +- Relation[sno#0,sname#1,ssex#2,sbirthday#3,class#4] JDBCRelation(students) [numPartitions=1] +- Project [sno#10, degree#12] +- Filter ((isnotnull(degree#12) &amp;&amp; (degree#12 &gt; 60.0)) &amp;&amp; isnotnull(sno#10)) +- Relation[sno#10,cno#11,degree#12] JDBCRelation(scores) [numPartitions=1]== Physical Plan ==*(6) HashAggregate(keys=[class#4], functions=[sum(degree#12), avg(UnscaledValue(degree#12))], output=[class#4, sum(degree)#27, avg(degree)#28])+- Exchange hashpartitioning(class#4, 200) +- *(5) HashAggregate(keys=[class#4], functions=[partial_sum(degree#12), partial_avg(UnscaledValue(degree#12))], output=[class#4, sum#32, sum#33, count#34L]) +- *(5) Project [class#4, degree#12] +- *(5) SortMergeJoin [sno#0], [sno#10], Inner :- *(2) Sort [sno#0 ASC NULLS FIRST], false, 0 : +- Exchange hashpartitioning(sno#0, 200) : +- *(1) Project [sno#0, class#4] : +- *(1) Filter (cast(sbirthday#3 as string) &gt; 1973-01-01 00:00:00) : +- *(1) Scan JDBCRelation(students) [numPartitions=1] [sno#0,class#4,sbirthday#3] PushedFilters: [*IsNotNull(sbirthday), *IsNotNull(sno)], ReadSchema: struct&lt;sno:string,class:string,sbirthday:timestamp&gt; +- *(4) Sort [sno#10 ASC NULLS FIRST], false, 0 +- Exchange hashpartitioning(sno#10, 200) +- *(3) Scan JDBCRelation(scores) [numPartitions=1] [sno#10,degree#12] PushedFilters: [*IsNotNull(degree), *GreaterThan(degree,60.0), *IsNotNull(sno)], ReadSchema: struct&lt;sno:string,degree:decimal(10,1)&gt; 2ã€ Catalystæ‰§è¡Œè¿‡ç¨‹ä»ä¸Šé¢çš„æŸ¥è¯¢è®¡åˆ’æˆ‘ä»¬å¯ä»¥çœ‹å¾—å‡ºæ¥ï¼Œæˆ‘ä»¬ç¼–å†™çš„sqlè¯­å¥ï¼Œç»è¿‡å¤šæ¬¡è½¬æ¢ï¼Œæœ€ç»ˆè¿›è¡Œç¼–è¯‘æˆä¸ºå­—èŠ‚ç æ–‡ä»¶è¿›è¡Œæ‰§è¡Œï¼Œè¿™ä¸€æ•´ä¸ªè¿‡ç¨‹ç»è¿‡äº†å¥½å¤šä¸ªæ­¥éª¤ï¼Œå…¶ä¸­åŒ…æ‹¬ä»¥ä¸‹å‡ ä¸ªé‡è¦æ­¥éª¤ sqlè§£æé˜¶æ®µ parse ç”Ÿæˆé€»è¾‘è®¡åˆ’ Analyzer sqlè¯­å¥è°ƒä¼˜é˜¶æ®µ Optimizer ç”Ÿæˆç‰©ç†æŸ¥è¯¢è®¡åˆ’ planner 1ã€sqlè§£æé˜¶æ®µ Parseråœ¨spark2.xçš„ç‰ˆæœ¬å½“ä¸­ï¼Œä¸ºäº†è§£æsparkSQLçš„sqlè¯­å¥ï¼Œå¼•å…¥äº†==Antlr==ã€‚Antlr æ˜¯ä¸€æ¬¾å¼ºå¤§çš„è¯­æ³•ç”Ÿæˆå™¨å·¥å…·ï¼Œå¯ç”¨äºè¯»å–ã€å¤„ç†ã€æ‰§è¡Œå’Œç¿»è¯‘ç»“æ„åŒ–çš„æ–‡æœ¬æˆ–äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œæ˜¯å½“å‰ Java è¯­è¨€ä¸­ä½¿ç”¨æœ€ä¸ºå¹¿æ³›çš„è¯­æ³•ç”Ÿæˆå™¨å·¥å…·ï¼Œæˆ‘ä»¬å¸¸è§çš„å¤§æ•°æ® SQL è§£æéƒ½ç”¨åˆ°äº†è¿™ä¸ªå·¥å…·ï¼ŒåŒ…æ‹¬ Hiveã€Cassandraã€Phoenixã€Pig ä»¥åŠ presto ç­‰ã€‚ç›®å‰æœ€æ–°ç‰ˆæœ¬çš„ Spark ä½¿ç”¨çš„æ˜¯==ANTLR4==ï¼Œé€šè¿‡è¿™ä¸ªå¯¹ SQL è¿›è¡Œè¯æ³•åˆ†æå¹¶æ„å»ºè¯­æ³•æ ‘ã€‚ æˆ‘ä»¬å¯ä»¥é€šè¿‡githubå»æŸ¥çœ‹sparkçš„æºç ï¼Œå…·ä½“è·¯å¾„å¦‚ä¸‹ï¼š https://github.com/apache/spark/blob/master/sql/catalyst/src/main/antlr4/org/apache/spark/sql/catalyst/parser/SqlBase.g4 æŸ¥çœ‹å¾—åˆ°sparkSQLæ”¯æŒçš„SQLè¯­æ³•ï¼Œæ‰€æœ‰sparkSQLæ”¯æŒçš„è¯­æ³•éƒ½å®šä¹‰åœ¨äº†è¿™ä¸ªæ–‡ä»¶å½“ä¸­ã€‚å¦‚æœæˆ‘ä»¬éœ€è¦é‡æ„sparkSQLçš„è¯­æ³•ï¼Œé‚£ä¹ˆæˆ‘ä»¬åªéœ€è¦é‡æ–°å®šä¹‰å¥½ç›¸å…³è¯­æ³•ï¼Œç„¶åä½¿ç”¨Antlr4å¯¹SqlBase.g4è¿›è¡Œè¯­æ³•è§£æï¼Œç”Ÿæˆç›¸å…³çš„javaç±»ï¼Œå…¶ä¸­å°±åŒ…å«é‡è¦çš„è¯æ³•è§£æå™¨SqlBaseLexer.javaå’Œè¯­æ³•è§£æå™¨SqlBaseParser.javaã€‚åœ¨æˆ‘ä»¬è¿è¡Œä¸Šé¢çš„javaçš„æ—¶å€™ï¼Œç¬¬ä¸€æ­¥å°±æ˜¯é€šè¿‡SqlBaseLexeræ¥è§£æå…³é”®è¯ä»¥åŠå„ç§æ ‡è¯†ç¬¦ï¼Œç„¶åä½¿ç”¨SqlBaseParseræ¥æ„å»ºè¯­æ³•æ ‘ã€‚ æœ€ç»ˆé€šè¿‡Lexerä»¥åŠparseè§£æä¹‹åï¼Œç”Ÿæˆè¯­æ³•æ ‘ï¼Œç”Ÿæˆè¯­æ³•æ ‘ä¹‹åï¼Œä½¿ç”¨AstBuilderå°†è¯­æ³•æ ‘è½¬æ¢æˆä¸ºLogicalPlanï¼Œè¿™ä¸ªLogicalPlanä¹Ÿè¢«ç§°ä¸ºUnresolved LogicalPlanã€‚è§£æä¹‹åçš„é€»è¾‘è®¡åˆ’å¦‚ä¸‹ï¼Œ == Parsed Logical Plan ==&#x27;Aggregate [&#x27;temp1.class], [&#x27;temp1.class, unresolvedalias(&#x27;SUM(&#x27;temp1.degree), None), unresolvedalias(&#x27;AVG(&#x27;temp1.degree), None)]+- &#x27;SubqueryAlias temp1 +- &#x27;Project [&#x27;students.sno AS ssno#16, &#x27;students.sname, &#x27;students.ssex, &#x27;students.sbirthday, &#x27;students.class, &#x27;scores.sno, &#x27;scores.degree, &#x27;scores.cno] +- &#x27;Filter ((&#x27;degree &gt; 60) &amp;&amp; (&#x27;sbirthday &gt; 1973-01-01 00:00:00)) +- &#x27;Join LeftOuter, (&#x27;students.sno = &#x27;scores.sno) :- &#x27;UnresolvedRelation `students` +- &#x27;UnresolvedRelation `scores` ä»ä¸Šå›¾å¯ä»¥çœ‹å¾—åˆ°ï¼Œä¸¤ä¸ªè¡¨è¢«joinä¹‹åç”Ÿæˆäº†UnresolvedRelationï¼Œé€‰æ‹©çš„åˆ—ä»¥åŠèšåˆçš„å­—æ®µéƒ½æœ‰äº†ï¼Œsqlè§£æçš„ç¬¬ä¸€ä¸ªé˜¶æ®µå°±å·²ç»å®Œæˆï¼Œæ¥ç€å‡†å¤‡è¿›å…¥åˆ°ç¬¬äºŒä¸ªé˜¶æ®µ 2ã€ç»‘å®šé€»è¾‘è®¡åˆ’Analyzeråœ¨sqlè§£æparseé˜¶æ®µï¼Œç”Ÿæˆäº†å¾ˆå¤šçš„unresolvedalias ï¼Œ UnresolvedRelationç­‰å¾ˆå¤šæœªè§£æå‡ºæ¥çš„æœ‰äº›å…³é”®å­—ï¼Œè¿™äº›éƒ½æ˜¯å±äº Unresolved LogicalPlanè§£æçš„éƒ¨åˆ†ã€‚ Unresolved LogicalPlanä»…ä»…æ˜¯ä¸€ç§æ•°æ®ç»“æ„ï¼Œä¸åŒ…å«ä»»ä½•æ•°æ®ä¿¡æ¯ï¼Œä¾‹å¦‚ä¸çŸ¥é“æ•°æ®æºï¼Œæ•°æ®ç±»å‹ï¼Œä¸åŒçš„åˆ—æ¥è‡ªå“ªå¼ è¡¨ç­‰ç­‰ã€‚ã€‚Analyzer é˜¶æ®µä¼šä½¿ç”¨äº‹å…ˆå®šä¹‰å¥½çš„ Rule ä»¥åŠ SessionCatalog ç­‰ä¿¡æ¯å¯¹ Unresolved LogicalPlan è¿›è¡Œ transformã€‚SessionCatalog ä¸»è¦ç”¨äºå„ç§==å‡½æ•°èµ„æºä¿¡æ¯å’Œå…ƒæ•°æ®ä¿¡æ¯==ï¼ˆæ•°æ®åº“ã€æ•°æ®è¡¨ã€æ•°æ®è§†å›¾ã€æ•°æ®åˆ†åŒºä¸å‡½æ•°ç­‰ï¼‰çš„ç»Ÿä¸€ç®¡ç†ã€‚è€ŒRule æ˜¯å®šä¹‰åœ¨ Analyzer é‡Œé¢çš„ï¼Œå…·ä½“çš„ç±»çš„è·¯å¾„å¦‚ä¸‹ï¼š org.apache.spark.sql.catalyst.analysis.Analyzerå…·ä½“çš„ruleè§„åˆ™å®šä¹‰å¦‚ä¸‹ï¼š lazy val batches: Seq[Batch] = Seq( Batch(&quot;Hints&quot;, fixedPoint, new ResolveHints.ResolveBroadcastHints(conf), ResolveHints.RemoveAllHints), Batch(&quot;Simple Sanity Check&quot;, Once, LookupFunctions), Batch(&quot;Substitution&quot;, fixedPoint, CTESubstitution, WindowsSubstitution, EliminateUnions, new SubstituteUnresolvedOrdinals(conf)), Batch(&quot;Resolution&quot;, fixedPoint, ResolveTableValuedFunctions :: ResolveRelations :: ResolveReferences :: ResolveCreateNamedStruct :: ResolveDeserializer :: ResolveNewInstance :: ResolveUpCast :: ResolveGroupingAnalytics :: ResolvePivot :: ResolveOrdinalInOrderByAndGroupBy :: ResolveAggAliasInGroupBy :: ResolveMissingReferences :: ExtractGenerator :: ResolveGenerate :: ResolveFunctions :: ResolveAliases :: ResolveSubquery :: ResolveSubqueryColumnAliases :: ResolveWindowOrder :: ResolveWindowFrame :: ResolveNaturalAndUsingJoin :: ExtractWindowExpressions :: GlobalAggregates :: ResolveAggregateFunctions :: TimeWindowing :: ResolveInlineTables(conf) :: ResolveTimeZone(conf) :: ResolvedUuidExpressions :: TypeCoercion.typeCoercionRules(conf) ++ extendedResolutionRules : _*), Batch(&quot;Post-Hoc Resolution&quot;, Once, postHocResolutionRules: _*), Batch(&quot;View&quot;, Once, AliasViewChild(conf)), Batch(&quot;Nondeterministic&quot;, Once, PullOutNondeterministic), Batch(&quot;UDF&quot;, Once, HandleNullInputsForUDF), Batch(&quot;FixNullability&quot;, Once, FixNullability), Batch(&quot;Subquery&quot;, Once, UpdateOuterReferences), Batch(&quot;Cleanup&quot;, fixedPoint, CleanupAliases) ) ä»ä¸Šé¢ä»£ç å¯ä»¥çœ‹å‡ºï¼Œå¤šä¸ªæ€§è´¨ç±»ä¼¼çš„ Rule ç»„æˆä¸€ä¸ª Batchï¼Œæ¯”å¦‚ä¸Šé¢åä¸º Hints çš„ Batchå°±æ˜¯ç”±å¾ˆå¤šä¸ª Hints Rule ç»„æˆï¼›è€Œå¤šä¸ª Batch æ„æˆä¸€ä¸ª batchesã€‚è¿™äº› batches ä¼šç”± RuleExecutor æ‰§è¡Œï¼Œå…ˆæŒ‰ä¸€ä¸ªä¸€ä¸ª Batch é¡ºåºæ‰§è¡Œï¼Œç„¶åå¯¹ Batch é‡Œé¢çš„æ¯ä¸ª Rule é¡ºåºæ‰§è¡Œã€‚æ¯ä¸ª Batch ä¼šæ‰§è¡Œä¸€æ¬¡ï¼ˆOnceï¼‰æˆ–å¤šæ¬¡ï¼ˆFixedPointï¼Œç”±spark.sql.optimizer.maxIterations å‚æ•°å†³å®šï¼‰ï¼Œæ‰§è¡Œè¿‡ç¨‹å¦‚ä¸‹ï¼š æ‰€ä»¥ä¸Šé¢çš„ SQL ç»è¿‡è¿™ä¸ªé˜¶æ®µç”Ÿæˆçš„ Analyzed Logical Plan å¦‚ä¸‹ï¼š == Analyzed Logical Plan ==class: string, sum(degree): decimal(20,1), avg(degree): decimal(14,5)Aggregate [class#4], [class#4, sum(degree#12) AS sum(degree)#27, avg(degree#12) AS avg(degree)#28]+- SubqueryAlias temp1 +- Project [sno#0 AS ssno#16, sname#1, ssex#2, sbirthday#3, class#4, sno#10, degree#12, cno#11] +- Filter ((cast(degree#12 as decimal(10,1)) &gt; cast(cast(60 as decimal(2,0)) as decimal(10,1))) &amp;&amp; (cast(sbirthday#3 as string) &gt; 1973-01-01 00:00:00)) +- Join LeftOuter, (sno#0 = sno#10) :- SubqueryAlias students : +- Relation[sno#0,sname#1,ssex#2,sbirthday#3,class#4] JDBCRelation(students) [numPartitions=1] +- SubqueryAlias scores +- Relation[sno#10,cno#11,degree#12] JDBCRelation(scores) [numPartitions=1] ä»ä¸Šé¢çš„è§£æè¿‡ç¨‹æ¥çœ‹ï¼Œstudentså’Œscoresè¡¨å·²ç»è¢«è§£ææˆä¸ºäº†å¸¦æœ‰sno#0 AS ssno#16, sname#1, ssex#2, sbirthday#3, class#4, sno#10, degree#12, cno#11è¿™ä¹ˆå…·ä½“çš„å­—æ®µï¼Œå…¶ä¸­è¿˜æœ‰èšåˆå‡½æ•° Aggregate [class#4], [class#4, sum(degree#12) AS sum(degree)#27, avg(degree#12) AS avg(degree)#28]ï¼Œå¹¶ä¸”æœ€ç»ˆè¿”å›çš„å››ä¸ªå­—æ®µçš„ç±»å‹ä¹Ÿå·²ç»ç¡®å®šäº†class: string, sum(degree): decimal(20,1), avg(degree): decimal(14,5)ï¼Œè€Œä¸”ä¹Ÿå·²ç»çŸ¥é“äº†æ•°æ®æ¥æºæ˜¯JDBCRelation(students)è¡¨å’Œ JDBCRelation(scores)è¡¨ã€‚æ€»ç»“æ¥çœ‹Analyzed Logical Planä¸»è¦å°±æ˜¯å¹²äº†ä¸€äº›è¿™äº›äº‹æƒ… 1ã€ç¡®å®šæœ€ç»ˆè¿”å›å­—æ®µåç§°ä»¥åŠè¿”å›ç±»å‹ï¼š â€‹ class: string, sum(degree): decimal(20,1), avg(degree): decimal(14,5) 2ã€ç¡®å®šèšåˆå‡½æ•° Aggregate [class#4], [class#4, sum(degree#12) AS sum(degree)#27, avg(degree#12) AS avg(degree)#28] 3ã€ç¡®å®šè¡¨å½“ä¸­è·å–çš„æŸ¥è¯¢å­—æ®µ â€‹ Project [sno#0 AS ssno#16, sname#1, ssex#2, sbirthday#3, class#4, sno#10, degree#12, cno#11] 4ã€ç¡®å®šè¿‡æ»¤æ¡ä»¶ Filter ((cast(degree#12 as decimal(10,1)) &gt; cast(cast(60 as decimal(2,0)) as decimal(10,1))) &amp;&amp; (cast(sbirthday#3 as string) &gt; 1973-01-01 00:00:00)) 5ã€ç¡®å®šjoinæ–¹å¼ Join LeftOuter, (sno#0 = sno#10) 6ã€ç¡®å®šè¡¨å½“ä¸­çš„æ•°æ®æ¥æºä»¥åŠåˆ†åŒºä¸ªæ•° JDBCRelation(students) [numPartitions=1] JDBCRelation(scores) [numPartitions=1] è‡³æ­¤Analyzed Logical Planå·²ç»å®Œæˆã€‚å¯¹æ¯”Unresolved Logical Planåˆ°Analyzed Logical Plan è¿‡ç¨‹å¦‚ä¸‹å›¾ åˆ°è¿™é‡Œï¼Œ Analyzed LogicalPlan å°±å®Œå…¨ç”Ÿæˆäº† 3ã€é€»è¾‘ä¼˜åŒ–é˜¶æ®µOptimizeråœ¨å‰æ–‡çš„ç»‘å®šé€»è¾‘è®¡åˆ’é˜¶æ®µå¯¹ Unresolved LogicalPlan è¿›è¡Œç›¸å…³ transform æ“ä½œå¾—åˆ°äº† Analyzed Logical Planï¼Œè¿™ä¸ª Analyzed Logical Plan æ˜¯å¯ä»¥ç›´æ¥è½¬æ¢æˆ Physical Plan ç„¶ååœ¨ [Spark] ä¸­æ‰§è¡Œã€‚ä½†æ˜¯å¦‚æœç›´æ¥è¿™ä¹ˆå¼„çš„è¯ï¼Œå¾—åˆ°çš„ Physical Plan å¾ˆå¯èƒ½ä¸æ˜¯æœ€ä¼˜çš„ï¼Œå› ä¸ºåœ¨å®é™…åº”ç”¨ä¸­ï¼Œå¾ˆå¤šä½æ•ˆçš„å†™æ³•ä¼šå¸¦æ¥æ‰§è¡Œæ•ˆç‡çš„é—®é¢˜ï¼Œéœ€è¦è¿›ä¸€æ­¥å¯¹Analyzed Logical Plan è¿›è¡Œå¤„ç†ï¼Œå¾—åˆ°æ›´ä¼˜çš„é€»è¾‘ç®—å­æ ‘ã€‚äºæ˜¯ï¼Œ é’ˆå¯¹ SQL é€»è¾‘ç®—å­æ ‘çš„ä¼˜åŒ–å™¨ Optimizer åº”è¿è€Œç”Ÿã€‚ è¿™ä¸ªé˜¶æ®µçš„ä¼˜åŒ–å™¨ä¸»è¦æ˜¯åŸºäºè§„åˆ™çš„ï¼ˆRule-based Optimizerï¼Œç®€ç§° ==RBO==ï¼‰ï¼Œè€Œç»å¤§éƒ¨åˆ†çš„è§„åˆ™éƒ½æ˜¯å¯å‘å¼è§„åˆ™ï¼Œä¹Ÿå°±æ˜¯åŸºäºç›´è§‚æˆ–ç»éªŒè€Œå¾—å‡ºçš„è§„åˆ™ï¼Œæ¯”å¦‚==åˆ—è£å‰ª==ï¼ˆè¿‡æ»¤æ‰æŸ¥è¯¢ä¸éœ€è¦ä½¿ç”¨åˆ°çš„åˆ—ï¼‰ã€==è°“è¯ä¸‹æ¨==ï¼ˆå°†è¿‡æ»¤å°½å¯èƒ½åœ°ä¸‹æ²‰åˆ°æ•°æ®æºç«¯ï¼‰ã€å¸¸é‡ç´¯åŠ ï¼ˆæ¯”å¦‚ 1 + 2 è¿™ç§äº‹å…ˆè®¡ç®—å¥½ï¼‰ ä»¥åŠå¸¸é‡æ›¿æ¢ï¼ˆæ¯”å¦‚ SELECT FROM table WHERE i = 5 AND j = i + 3 å¯ä»¥è½¬æ¢æˆ SELECT FROM table WHERE i = 5 AND j = 8ï¼‰ç­‰ç­‰ã€‚ ä¸å‰æ–‡ä»‹ç»ç»‘å®šé€»è¾‘è®¡åˆ’é˜¶æ®µç±»ä¼¼ï¼Œè¿™ä¸ªé˜¶æ®µæ‰€æœ‰çš„è§„åˆ™ä¹Ÿæ˜¯å®ç° Rule æŠ½è±¡ç±»ï¼Œå¤šä¸ªè§„åˆ™ç»„æˆä¸€ä¸ª Batchï¼Œå¤šä¸ª Batch ç»„æˆä¸€ä¸ª batchesï¼ŒåŒæ ·ä¹Ÿæ˜¯åœ¨ RuleExecutor ä¸­è¿›è¡Œæ‰§è¡Œ è¿™é‡ŒæŒ‰ç…§ Rule æ‰§è¡Œé¡ºåºä¸€ä¸€è¿›è¡Œè¯´æ˜ã€‚ è°“è¯ä¸‹æ¨è°“è¯ä¸‹æ¨åœ¨ SparkQL æ˜¯ç”± PushDownPredicate å®ç°çš„ï¼Œè¿™ä¸ªè¿‡ç¨‹ä¸»è¦å°†è¿‡æ»¤æ¡ä»¶å°½å¯èƒ½åœ°ä¸‹æ¨åˆ°åº•å±‚ï¼Œæœ€å¥½æ˜¯æ•°æ®æºã€‚æ‰€ä»¥é’ˆå¯¹æˆ‘ä»¬ä¸Šé¢ä»‹ç»çš„ SQLï¼Œä½¿ç”¨è°“è¯ä¸‹æ¨ä¼˜åŒ–å¾—åˆ°çš„é€»è¾‘è®¡åˆ’å¦‚ä¸‹ï¼š ä»ä¸Šå›¾å¯ä»¥çœ‹å‡ºï¼Œè°“è¯ä¸‹æ¨å°† Filter ç®—å­ç›´æ¥ä¸‹æ¨åˆ° Join ä¹‹å‰äº†ï¼ˆæ³¨æ„ï¼Œä¸Šå›¾æ˜¯ä»ä¸‹å¾€ä¸Šçœ‹çš„ï¼‰ ã€‚ä¹Ÿå°±æ˜¯åœ¨æ‰«æ studentè¡¨çš„æ—¶å€™ä½¿ç”¨æ¡ä»¶è¿‡æ»¤æ¡ä»¶è¿‡æ»¤å‡ºæ»¡è¶³æ¡ä»¶çš„æ•°æ®ï¼›åŒæ—¶åœ¨æ‰«æ t2 è¡¨çš„æ—¶å€™ä¼šå…ˆä½¿ç”¨ isnotnull(id#8) &amp;&amp; (id#8 &gt; 50000) è¿‡æ»¤æ¡ä»¶è¿‡æ»¤å‡ºæ»¡è¶³æ¡ä»¶çš„æ•°æ®ã€‚ç»è¿‡è¿™æ ·çš„æ“ä½œï¼Œå¯ä»¥å¤§å¤§å‡å°‘ Join ç®—å­å¤„ç†çš„æ•°æ®é‡ï¼Œä»è€ŒåŠ å¿«è®¡ç®—é€Ÿåº¦ã€‚ åˆ—è£å‰ªåˆ—è£å‰ªåœ¨ Spark SQL æ˜¯ç”± ColumnPruning å®ç°çš„ã€‚å› ä¸ºæˆ‘ä»¬æŸ¥è¯¢çš„è¡¨å¯èƒ½æœ‰å¾ˆå¤šä¸ªå­—æ®µï¼Œä½†æ˜¯æ¯æ¬¡æŸ¥è¯¢æˆ‘ä»¬å¾ˆå¤§å¯èƒ½ä¸éœ€è¦æ‰«æå‡ºæ‰€æœ‰çš„å­—æ®µï¼Œè¿™ä¸ªæ—¶å€™åˆ©ç”¨åˆ—è£å‰ªå¯ä»¥æŠŠé‚£äº›æŸ¥è¯¢ä¸éœ€è¦çš„å­—æ®µè¿‡æ»¤æ‰ï¼Œä½¿å¾—æ‰«æçš„æ•°æ®é‡å‡å°‘ã€‚æ‰€ä»¥é’ˆå¯¹æˆ‘ä»¬ä¸Šé¢ä»‹ç»çš„ SQLï¼Œä½¿ç”¨åˆ—è£å‰ªä¼˜åŒ–å¾—åˆ°çš„é€»è¾‘è®¡åˆ’å¦‚ä¸‹ï¼š ä»ä¸Šå›¾å¯ä»¥çœ‹å‡ºï¼Œç»è¿‡åˆ—è£å‰ªåï¼Œstudents è¡¨åªéœ€è¦æŸ¥è¯¢ snoå’Œ class ä¸¤ä¸ªå­—æ®µï¼›scores è¡¨åªéœ€è¦æŸ¥è¯¢ sno,degree å­—æ®µã€‚è¿™æ ·å‡å°‘äº†æ•°æ®çš„ä¼ è¾“ï¼Œè€Œä¸”å¦‚æœåº•å±‚çš„æ–‡ä»¶æ ¼å¼ä¸ºåˆ—å­˜ï¼ˆæ¯”å¦‚ Parquetï¼‰ï¼Œå¯ä»¥å¤§å¤§æé«˜æ•°æ®çš„æ‰«æé€Ÿåº¦çš„ã€‚ å¸¸é‡æ›¿æ¢å¸¸é‡æ›¿æ¢åœ¨ Spark SQL æ˜¯ç”± ConstantPropagation å®ç°çš„ã€‚ä¹Ÿå°±æ˜¯å°†å˜é‡æ›¿æ¢æˆå¸¸é‡ï¼Œæ¯”å¦‚ SELECT FROM table WHERE i = 5 AND j = i + 3 å¯ä»¥è½¬æ¢æˆ SELECT FROM table WHERE i = 5 AND j = 8ã€‚è¿™ä¸ªçœ‹èµ·æ¥å¥½åƒæ²¡ä»€ä¹ˆçš„ï¼Œä½†æ˜¯å¦‚æœæ‰«æçš„è¡Œæ•°éå¸¸å¤šå¯ä»¥å‡å°‘å¾ˆå¤šçš„è®¡ç®—æ—¶é—´çš„å¼€é”€çš„ã€‚ç»è¿‡è¿™ä¸ªä¼˜åŒ–ï¼Œå¾—åˆ°çš„é€»è¾‘è®¡åˆ’å¦‚ä¸‹ æˆ‘ä»¬çš„æŸ¥è¯¢ä¸­æœ‰ t1.cid = 1 AND t1.did = t1.cid + 1 æŸ¥è¯¢è¯­å¥ï¼Œä»é‡Œé¢å¯ä»¥çœ‹å‡º t1.cid å…¶å®å·²ç»æ˜¯ç¡®å®šçš„å€¼äº†ï¼Œæ‰€ä»¥æˆ‘ä»¬å®Œå…¨å¯ä»¥ä½¿ç”¨å®ƒè®¡ç®—å‡º t1.didã€‚ å¸¸é‡ç´¯åŠ å¸¸é‡ç´¯åŠ åœ¨ Spark SQL æ˜¯ç”± ConstantFolding å®ç°çš„ã€‚è¿™ä¸ªå’Œå¸¸é‡æ›¿æ¢ç±»ä¼¼ï¼Œä¹Ÿæ˜¯åœ¨è¿™ä¸ªé˜¶æ®µæŠŠä¸€äº›å¸¸é‡è¡¨è¾¾å¼äº‹å…ˆè®¡ç®—å¥½ã€‚è¿™ä¸ªçœ‹èµ·æ¥æ”¹åŠ¨çš„ä¸å¤§ï¼Œä½†æ˜¯åœ¨æ•°æ®é‡éå¸¸å¤§çš„æ—¶å€™å¯ä»¥å‡å°‘å¤§é‡çš„è®¡ç®—ï¼Œå‡å°‘ CPU ç­‰èµ„æºçš„ä½¿ç”¨ã€‚ç»è¿‡è¿™ä¸ªä¼˜åŒ–ï¼Œå¾—åˆ°çš„é€»è¾‘è®¡åˆ’å¦‚ä¸‹ï¼š æ‰€ä»¥ç»è¿‡ä¸Šé¢å››ä¸ªæ­¥éª¤çš„ä¼˜åŒ–ä¹‹åï¼Œå¾—åˆ°çš„ä¼˜åŒ–ä¹‹åçš„é€»è¾‘è®¡åˆ’ä¸ºï¼š == Optimized Logical Plan ==Aggregate [class#4], [class#4, sum(degree#12) AS sum(degree)#27, cast((avg(UnscaledValue(degree#12)) / 10.0) as decimal(14,5)) AS avg(degree)#28]+- Project [class#4, degree#12] +- Join Inner, (sno#0 = sno#10) :- Project [sno#0, class#4] : +- Filter ((isnotnull(sbirthday#3) &amp;&amp; (cast(sbirthday#3 as string) &gt; 1973-01-01 00:00:00)) &amp;&amp; isnotnull(sno#0)) : +- Relation[sno#0,sname#1,ssex#2,sbirthday#3,class#4] JDBCRelation(students) [numPartitions=1] +- Project [sno#10, degree#12] +- Filter ((isnotnull(degree#12) &amp;&amp; (degree#12 &gt; 60.0)) &amp;&amp; isnotnull(sno#10)) +- Relation[sno#10,cno#11,degree#12] JDBCRelation(scores) [numPartitions=1] åˆ°æ­¤ä¸ºæ­¢ï¼Œä¼˜åŒ–é€»è¾‘é˜¶æ®µåŸºæœ¬å®Œæˆï¼Œå¦å¤–æ›´å¤šçš„å…¶ä»–ä¼˜åŒ–ï¼Œå‚è§sparkæºç ï¼š https://github.com/apache/spark/blob/master/sql/catalyst/src/main/scala/org/apache/spark/sql/catalyst/optimizer/Optimizer.scala#L59 4ã€ç”Ÿæˆå¯æ‰§è¡Œçš„ç‰©ç†è®¡åˆ’é˜¶æ®µPhysical Planç»è¿‡å‰é¢å¤šä¸ªæ­¥éª¤ï¼ŒåŒ…æ‹¬parseï¼Œanalyzerä»¥åŠOptimizerç­‰å¤šä¸ªé˜¶æ®µï¼Œå¾—åˆ°ç»è¿‡ä¼˜åŒ–ä¹‹åçš„sqlè¯­å¥ï¼Œä½†æ˜¯è¿™ä¸ªsqlè¯­å¥ä»ç„¶ä¸èƒ½æ‰§è¡Œï¼Œä¸ºäº†èƒ½å¤Ÿæ‰§è¡Œè¿™ä¸ªsqlï¼Œæœ€ç»ˆå¿…é¡»å¾—è¦ç¿»è¯‘æˆä¸ºå¯ä»¥è¢«æ‰§è¡Œçš„ç‰©ç†è®¡åˆ’ï¼Œåˆ°è¿™ä¸ªé˜¶æ®µsparkå°±çŸ¥é“è¯¥å¦‚ä½•æ‰§è¡Œè¿™ä¸ªsqläº†ï¼Œå’Œå‰é¢é€»è¾‘è®¡åˆ’ç»‘å®šå’Œä¼˜åŒ–ä¸ä¸€æ ·ï¼Œè¿™ä¸ªé˜¶æ®µä½¿ç”¨çš„æ˜¯ç­–ç•¥strategyï¼Œè€Œä¸”ç»è¿‡å‰é¢ä»‹ç»çš„é€»è¾‘è®¡åˆ’ç»‘å®šå’Œ Transformations åŠ¨ä½œä¹‹åï¼Œæ ‘çš„ç±»å‹å¹¶æ²¡æœ‰æ”¹å˜ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼šExpression ç»è¿‡ Transformations ä¹‹åå¾—åˆ°çš„è¿˜æ˜¯ Transformations ï¼›Logical Plan ç»è¿‡ Transformations ä¹‹åå¾—åˆ°çš„è¿˜æ˜¯ Logical Planã€‚è€Œåˆ°äº†è¿™ä¸ªé˜¶æ®µï¼Œç»è¿‡ Transformations åŠ¨ä½œä¹‹åï¼Œæ ‘çš„ç±»å‹æ”¹å˜äº†ï¼Œç”± Logical Plan è½¬æ¢æˆ Physical Plan äº†ã€‚ ä¸€ä¸ªé€»è¾‘è®¡åˆ’ï¼ˆLogical Planï¼‰ç»è¿‡ä¸€ç³»åˆ—çš„ç­–ç•¥å¤„ç†ä¹‹åï¼Œå¾—åˆ°å¤šä¸ªç‰©ç†è®¡åˆ’ï¼ˆPhysical Plansï¼‰ï¼Œç‰©ç†è®¡åˆ’åœ¨ Spark æ˜¯ç”± SparkPlan å®ç°çš„ã€‚å¤šä¸ªç‰©ç†è®¡åˆ’å†ç»è¿‡ä»£ä»·æ¨¡å‹ï¼ˆCost Modelï¼‰å¾—åˆ°é€‰æ‹©åçš„ç‰©ç†è®¡åˆ’ï¼ˆSelected Physical Planï¼‰ï¼Œæ•´ä¸ªè¿‡ç¨‹å¦‚ä¸‹æ‰€ç¤ºï¼š Cost Model å¯¹åº”çš„å°±æ˜¯åŸºäºä»£ä»·çš„ä¼˜åŒ–ï¼ˆCost-based Optimizationsï¼ŒCBOï¼Œä¸»è¦ç”±åä¸ºçš„å¤§ä½¬ä»¬å®ç°çš„ï¼Œè¯¦è§ SPARK-16026 ï¼‰ï¼Œæ ¸å¿ƒæ€æƒ³æ˜¯è®¡ç®—æ¯ä¸ªç‰©ç†è®¡åˆ’çš„ä»£ä»·ï¼Œç„¶åå¾—åˆ°æœ€ä¼˜çš„ç‰©ç†è®¡åˆ’ã€‚ä½†æ˜¯åœ¨ç›®å‰æœ€æ–°ç‰ˆçš„ Spark 2.4.3ï¼Œè¿™ä¸€éƒ¨åˆ†å¹¶æ²¡æœ‰å®ç°ï¼Œç›´æ¥è¿”å›å¤šä¸ªç‰©ç†è®¡åˆ’åˆ—è¡¨çš„ç¬¬ä¸€ä¸ªä½œä¸ºæœ€ä¼˜çš„ç‰©ç†è®¡åˆ’ï¼Œå¦‚ä¸‹ lazy val sparkPlan: SparkPlan = &#123; SparkSession.setActiveSession(sparkSession) // TODO: We use next(), i.e. take the first plan returned by the planner, here for now, // but we will implement to choose the best plan. planner.plan(ReturnAnswer(optimizedPlan)).next()&#125; è€Œ SPARK-16026 å¼•å…¥çš„ CBO ä¼˜åŒ–ä¸»è¦æ˜¯åœ¨å‰é¢ä»‹ç»çš„ä¼˜åŒ–é€»è¾‘è®¡åˆ’é˜¶æ®µ - Optimizer é˜¶æ®µè¿›è¡Œçš„ï¼Œå¯¹åº”çš„ Rule ä¸º CostBasedJoinReorderï¼Œå¹¶ä¸”é»˜è®¤æ˜¯å…³é—­çš„ï¼Œéœ€è¦é€šè¿‡ spark.sql.cbo.enabled æˆ– spark.sql.cbo.joinReorder.enabled å‚æ•°å¼€å¯ã€‚æ‰€ä»¥åˆ°äº†è¿™ä¸ªèŠ‚ç‚¹ï¼Œæœ€åå¾—åˆ°çš„ç‰©ç†è®¡åˆ’å¦‚ä¸‹ï¼š == Physical Plan ==*(6) HashAggregate(keys=[class#4], functions=[sum(degree#12), avg(UnscaledValue(degree#12))], output=[class#4, sum(degree)#27, avg(degree)#28])+- Exchange hashpartitioning(class#4, 200) +- *(5) HashAggregate(keys=[class#4], functions=[partial_sum(degree#12), partial_avg(UnscaledValue(degree#12))], output=[class#4, sum#32, sum#33, count#34L]) +- *(5) Project [class#4, degree#12] +- *(5) SortMergeJoin [sno#0], [sno#10], Inner :- *(2) Sort [sno#0 ASC NULLS FIRST], false, 0 : +- Exchange hashpartitioning(sno#0, 200) : +- *(1) Project [sno#0, class#4] : +- *(1) Filter (cast(sbirthday#3 as string) &gt; 1973-01-01 00:00:00) : +- *(1) Scan JDBCRelation(students) [numPartitions=1] [sno#0,class#4,sbirthday#3] PushedFilters: [*IsNotNull(sbirthday), *IsNotNull(sno)], ReadSchema: struct&lt;sno:string,class:string,sbirthday:timestamp&gt; +- *(4) Sort [sno#10 ASC NULLS FIRST], false, 0 +- Exchange hashpartitioning(sno#10, 200) +- *(3) Scan JDBCRelation(scores) [numPartitions=1] [sno#10,degree#12] PushedFilters: [*IsNotNull(degree), *GreaterThan(degree,60.0), *IsNotNull(sno)], ReadSchema: struct&lt;sno:string,degree:decimal(10,1)&gt; ä»ä¸Šé¢çš„ç»“æœå¯ä»¥çœ‹å‡ºï¼Œç‰©ç†è®¡åˆ’é˜¶æ®µå·²ç»çŸ¥é“æ•°æ®æºæ˜¯ä» JDBCé‡Œé¢è¯»å–äº†ï¼Œä¹ŸçŸ¥é“æ–‡ä»¶çš„è·¯å¾„ï¼Œæ•°æ®ç±»å‹ç­‰ã€‚è€Œä¸”åœ¨è¯»å–æ–‡ä»¶çš„æ—¶å€™ï¼Œç›´æ¥å°†è¿‡æ»¤æ¡ä»¶ï¼ˆPushedFiltersï¼‰åŠ è¿›å»äº† åŒæ—¶ï¼Œè¿™ä¸ª Join å˜æˆäº† SortMergeJoinï¼Œ åˆ°è¿™é‡Œï¼Œ Physical Plan å°±å®Œå…¨ç”Ÿæˆäº† 5ã€ä»£ç ç”Ÿæˆé˜¶æ®µä»ä»¥ä¸Šå¤šä¸ªè¿‡ç¨‹æ‰§è¡Œå®Œæˆä¹‹åï¼Œä¾‹å¦‚parserï¼Œanalyzerï¼ŒOptimizerï¼ŒphysicalPlanç­‰ï¼Œæœ€ç»ˆæˆ‘ä»¬å¾—åˆ°çš„ç‰©ç†æ‰§è¡Œè®¡åˆ’ï¼Œè¿™ä¸ªç‰©ç†æ‰§è¡Œè®¡åˆ’æ ‡æ˜äº†æ•´ä¸ªçš„ä»£ç æ‰§è¡Œè¿‡ç¨‹å½“ä¸­æˆ‘ä»¬ä»£ç å±‚é¢çš„æ‰§è¡Œè¿‡ç¨‹ï¼Œä»¥åŠæœ€ç»ˆè¦å¾—åˆ°çš„æ•°æ®å­—æ®µä»¥åŠå­—æ®µç±»å‹ï¼Œä¹ŸåŒ…å«äº†æˆ‘ä»¬å¯¹åº”çš„æ•°æ®æºçš„ä½ç½®ï¼Œè™½ç„¶å¾—åˆ°äº†ç‰©ç†æ‰§è¡Œè®¡åˆ’ï¼Œä½†æ˜¯è¿™ä¸ªç‰©ç†æ‰§è¡Œè®¡åˆ’æƒ³è¦è¢«æ‰§è¡Œï¼Œæœ€ç»ˆè¿˜æ˜¯å¾—è¦ç”Ÿæˆå®Œæ•´çš„ä»£ç ï¼Œåº•å±‚è¿˜æ˜¯åŸºäºsparkRDDå»è¿›è¡Œå¤„ç†çš„ï¼Œsparkæœ€åä¹Ÿè¿˜ä¼šæœ‰ä¸€äº›Ruleå¯¹ç”Ÿæˆçš„ç‰©ç†æ‰§è¡Œè®¡åˆ’è¿›è¡Œå¤„ç†ï¼Œè¿™ä¸ªå¤„ç†è¿‡ç¨‹å°±æ˜¯prepareForExecutionï¼Œè¿™äº›ruleè§„åˆ™å®šä¹‰åœ¨ org.apache.spark.sql.execution.QueryExecution è¿™ä¸ªç±»å½“ä¸­çš„è¿™ä¸ªæ–¹æ³•é‡Œé¢ protected def prepareForExecution(plan: SparkPlan): SparkPlan = &#123; preparations.foldLeft(plan) &#123; case (sp, rule) =&gt; rule.apply(sp) &#125; &#125; /** A sequence of rules that will be applied in order to the physical plan before execution. */ protected def preparations: Seq[Rule[SparkPlan]] = Seq( python.ExtractPythonUDFs, //æŠ½å–pythonçš„è‡ªå®šä¹‰å‡½æ•° PlanSubqueries(sparkSession), //å­æŸ¥è¯¢ç‰©ç†è®¡åˆ’å¤„ç† EnsureRequirements(sparkSession.sessionState.conf), //ç¡®ä¿æ‰§è¡Œè®¡åˆ’åˆ†åŒºæ’åºæ­£ç¡® CollapseCodegenStages(sparkSession.sessionState.conf), //æ”¶é›†ç”Ÿæˆä»£ç  ReuseExchange(sparkSession.sessionState.conf), //èŠ‚ç‚¹é‡ç”¨ ReuseSubquery(sparkSession.sessionState.conf)) //å­æŸ¥è¯¢é‡ç”¨ ä¸Šé¢çš„ Rule ä¸­ CollapseCodegenStages æ˜¯é‡å¤´æˆï¼Œè¿™å°±æ˜¯å¤§å®¶ç†ŸçŸ¥çš„å…¨ä»£ç é˜¶æ®µç”Ÿæˆï¼ŒCatalyst å…¨é˜¶æ®µä»£ç ç”Ÿæˆçš„å…¥å£å°±æ˜¯è¿™ä¸ªè§„åˆ™ã€‚å½“ç„¶ï¼Œå¦‚æœéœ€è¦ Spark è¿›è¡Œå…¨é˜¶æ®µä»£ç ç”Ÿæˆï¼Œéœ€è¦å°† spark.sql.codegen.wholeStage è®¾ç½®ä¸º trueï¼ˆé»˜è®¤ï¼‰ã€‚ ç”Ÿæˆä»£ç ä¸sqlè§£æå¼•æ“çš„åŒºåˆ«åœ¨sparkSQLå½“ä¸­ï¼Œé€šè¿‡ç”Ÿæˆä»£ç ï¼Œæ¥å®ç°sqlè¯­å¥çš„æœ€ç»ˆç”Ÿæˆï¼Œè¯´ç™½äº†æœ€ååº•å±‚æ‰§è¡Œçš„è¿˜æ˜¯ä»£ç ï¼Œé‚£ä¹ˆä¸ºä»€ä¹ˆè¦è¿™ä¹ˆéº»çƒ¦ï¼Œä½¿ç”¨ä»£ç çš„æ–¹å¼æ¥æ‰§è¡Œæˆ‘ä»¬çš„sqlè¯­å¥ï¼Œéš¾é“æ²¡æœ‰sqlçš„è§£æå¼•æ“ç›´æ¥æ‰§è¡Œsqlè¯­å¥å˜›ï¼Ÿå½“ç„¶æ˜¯æœ‰çš„ï¼Œåœ¨spark2.0ç‰ˆæœ¬ä¹‹å‰ä½¿ç”¨çš„éƒ½æ˜¯åŸºäºVolcano Iterator Modelï¼ˆå‚è§ ã€ŠVolcano-An Extensible and Parallel Query Evaluation Systemã€‹ï¼‰ æ¥å®ç°sqlçš„è§£æçš„ï¼Œè¿™ä¸ªæ˜¯ç”± Goetz Graefe åœ¨ 1993 å¹´æå‡ºçš„ï¼Œå½“ä»Šç»å¤§å¤šæ•°æ•°æ®åº“ç³»ç»Ÿå¤„ç† SQL åœ¨åº•å±‚éƒ½æ˜¯åŸºäºè¿™ä¸ªæ¨¡å‹çš„ã€‚è¿™ä¸ªæ¨¡å‹çš„æ‰§è¡Œå¯ä»¥æ¦‚æ‹¬ä¸ºï¼šé¦–å…ˆæ•°æ®åº“å¼•æ“ä¼šå°† SQL ç¿»è¯‘æˆä¸€ç³»åˆ—çš„å…³ç³»ä»£æ•°ç®—å­æˆ–è¡¨è¾¾å¼ï¼Œç„¶åä¾èµ–è¿™äº›å…³ç³»ä»£æ•°ç®—å­é€æ¡å¤„ç†è¾“å…¥æ•°æ®å¹¶äº§ç”Ÿç»“æœã€‚æ¯ä¸ªç®—å­åœ¨åº•å±‚éƒ½å®ç°åŒæ ·çš„æ¥å£ï¼Œæ¯”å¦‚éƒ½å®ç°äº† next() æ–¹æ³•ï¼Œç„¶åæœ€é¡¶å±‚çš„ç®—å­ next() è°ƒç”¨å­ç®—å­çš„ next()ï¼Œå­ç®—å­çš„ next() åœ¨è°ƒç”¨å­™ç®—å­çš„ next()ï¼Œç›´åˆ°æœ€åº•å±‚çš„ next()ï¼Œå…·ä½“è¿‡ç¨‹å¦‚ä¸‹å›¾è¡¨ç¤ºï¼š Volcano Iterator Model çš„ä¼˜ç‚¹æ˜¯æŠ½è±¡èµ·æ¥å¾ˆç®€å•ï¼Œå¾ˆå®¹æ˜“å®ç°ï¼Œè€Œä¸”å¯ä»¥é€šè¿‡ä»»æ„ç»„åˆç®—å­æ¥è¡¨è¾¾å¤æ‚çš„æŸ¥è¯¢ã€‚ä½†æ˜¯ç¼ºç‚¹ä¹Ÿå¾ˆæ˜æ˜¾ï¼Œå­˜åœ¨å¤§é‡çš„==è™šå‡½æ•°è°ƒç”¨==ï¼Œä¼šå¼•èµ· CPU çš„ä¸­æ–­ï¼Œæœ€ç»ˆå½±å“äº†æ‰§è¡Œæ•ˆç‡ã€‚databricksçš„å®˜æ–¹åšå®¢å¯¹æ¯”è¿‡ä½¿ç”¨ Volcano Iterator Model å’Œæ‰‹å†™ä»£ç çš„æ‰§è¡Œæ•ˆç‡ï¼Œç»“æœå‘ç°==æ‰‹å†™çš„ä»£ç æ‰§è¡Œæ•ˆç‡è¦é«˜å‡ºåå€==ï¼ æ‰€ä»¥æ€»ç»“èµ·æ¥å°±æ˜¯å°†sqlè§£ææˆä¸ºä»£ç ï¼Œæ¯”sqlå¼•æ“ç›´æ¥è§£æsqlè¯­å¥æ•ˆç‡è¦å¿«ï¼Œæ‰€ä»¥spark2.0æœ€ç»ˆé€‰æ‹©ä½¿ç”¨ä»£ç ç”Ÿæˆçš„æ–¹å¼æ¥æ‰§è¡Œsqlè¯­å¥ åŸºäºä¸Šé¢çš„å‘ç°ï¼Œä» Apache Spark 2.0 å¼€å§‹ï¼Œç¤¾åŒºå¼€å§‹å¼•å…¥äº† Whole-stage Code Generationï¼Œå‚è§ SPARK-12795ï¼Œä¸»è¦å°±æ˜¯æƒ³é€šè¿‡è¿™ä¸ªæ¥æ¨¡æ‹Ÿæ‰‹å†™ä»£ç ï¼Œä»è€Œæå‡ Spark SQL çš„æ‰§è¡Œæ•ˆç‡ã€‚Whole-stage Code Generation æ¥è‡ªäº2011å¹´ Thomas Neumann å‘è¡¨çš„ Efficiently Compiling Efficient Query Plans for Modern Hardwareè®ºæ–‡ï¼Œè¿™ä¸ªä¹Ÿæ˜¯ Tungsten è®¡åˆ’çš„ä¸€éƒ¨åˆ†ã€‚ Tungsten ä»£ç ç”Ÿæˆåˆ†ä¸ºä¸‰éƒ¨åˆ†ï¼š è¡¨è¾¾å¼ä»£ç ç”Ÿæˆï¼ˆexpression codegenï¼‰ å…¨é˜¶æ®µä»£ç ç”Ÿæˆï¼ˆWhole-stage Code Generationï¼‰ åŠ é€Ÿåºåˆ—åŒ–å’Œååºåˆ—åŒ–ï¼ˆspeed up serialization/deserializationï¼‰ è¡¨è¾¾å¼ä»£ç ç”Ÿæˆï¼ˆexpression codegenï¼‰è¿™ä¸ªå…¶å®åœ¨ Spark 1.x å°±æœ‰äº†ã€‚è¡¨è¾¾å¼ä»£ç ç”Ÿæˆçš„åŸºç±»æ˜¯ org.apache.spark.sql.catalyst.expressions.codegen.CodeGeneratorï¼Œå…¶ä¸‹æœ‰ä¸ƒä¸ªå­ç±»ï¼š æˆ‘ä»¬å‰æ–‡çš„ SQL ç”Ÿæˆçš„é€»è¾‘è®¡åˆ’ä¸­çš„ (isnotnull(sbirthday#3) &amp;&amp; (cast(sbirthday#3 as string) &gt; 1973-01-01 00:00:00) å°±æ˜¯æœ€åŸºæœ¬çš„è¡¨è¾¾å¼ã€‚å®ƒä¹Ÿæ˜¯ä¸€ç§ Predicateï¼Œæ‰€ä»¥ä¼šè°ƒç”¨ org.apache.spark.sql.catalyst.expressions.codegen.GeneratePredicate æ¥ç”Ÿæˆè¡¨è¾¾å¼çš„ä»£ç ã€‚ å…¨é˜¶æ®µä»£ç ç”Ÿæˆï¼ˆWhole-stage Code Generationï¼‰ å…¨é˜¶æ®µä»£ç ç”Ÿæˆï¼ˆWhole-stage Code Generationï¼‰ï¼Œç”¨æ¥å°†å¤šä¸ªå¤„ç†é€»è¾‘æ•´åˆåˆ°å•ä¸ªä»£ç æ¨¡å—ä¸­ï¼Œå…¶ä¸­ä¹Ÿä¼šç”¨åˆ°ä¸Šé¢çš„è¡¨è¾¾å¼ä»£ç ç”Ÿæˆã€‚å’Œå‰é¢ä»‹ç»çš„è¡¨è¾¾å¼ä»£ç ç”Ÿæˆä¸ä¸€æ ·ï¼Œè¿™ä¸ªæ˜¯å¯¹æ•´ä¸ª SQL è¿‡ç¨‹è¿›è¡Œä»£ç ç”Ÿæˆï¼Œå‰é¢çš„è¡¨è¾¾å¼ä»£ç ç”Ÿæˆä»…å¯¹äºè¡¨è¾¾å¼çš„ã€‚å…¨é˜¶æ®µä»£ç ç”Ÿæˆéƒ½æ˜¯ç»§æ‰¿è‡ª org.apache.spark.sql.execution.BufferedRowIterator çš„ï¼Œç”Ÿæˆçš„ä»£ç éœ€è¦å®ç° processNext() æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•ä¼šåœ¨ org.apache.spark.sql.execution.WholeStageCodegenExec é‡Œé¢çš„ doExecute æ–¹æ³•é‡Œé¢è¢«è°ƒç”¨ã€‚è€Œè¿™ä¸ªæ–¹æ³•é‡Œé¢çš„ rdd ä¼šå°†æ•°æ®ä¼ è¿›ç”Ÿæˆçš„ä»£ç é‡Œé¢ ï¼Œæ¯”å¦‚æˆ‘ä»¬ä¸Šæ–‡ SQL è¿™ä¸ªä¾‹å­çš„æ•°æ®æºæ˜¯ JDBCæ–‡ä»¶ï¼Œåº•å±‚ä½¿ç”¨ org.apache.spark.sql.execution.RowDataSourceScanExecè¿™ä¸ªç±»è¯»å–æ–‡ä»¶ï¼Œç„¶åç”Ÿæˆ inputRDDï¼Œè¿™ä¸ª rdd åœ¨ WholeStageCodegenExec ç±»ä¸­çš„ doExecute æ–¹æ³•é‡Œé¢è°ƒç”¨ç”Ÿæˆçš„ä»£ç ï¼Œç„¶åæ‰§è¡Œæˆ‘ä»¬å„ç§åˆ¤æ–­å¾—åˆ°æœ€åçš„ç»“æœã€‚WholeStageCodegenExec ç±»ä¸­çš„ doExecute æ–¹æ³•éƒ¨åˆ†ä»£ç å¦‚ä¸‹ï¼š /** * WholeStageCodegen compiles a subtree of plans that support codegen together into single Java * function. * * Here is the call graph of to generate Java source (plan A supports codegen, but plan B does not): * * WholeStageCodegen Plan A FakeInput Plan B * ========================================================================= * * -&gt; execute() * | * doExecute() ---------&gt; inputRDDs() -------&gt; inputRDDs() ------&gt; execute() * | * +-----------------&gt; produce() * | * doProduce() -------&gt; produce() * | * doProduce() * | * doConsume() &lt;--------- consume() * | * doConsume() &lt;-------- consume() * * SparkPlan A should override `doProduce()` and `doConsume()`. * * `doCodeGen()` will create a `CodeGenContext`, which will hold a list of variables for input, * used to generated code for [[BoundReference]]. */override def doExecute(): RDD[InternalRow] = &#123; val (ctx, cleanedSource) = doCodeGen() // try to compile and fallback if it failed val (_, maxCodeSize) = try &#123; CodeGenerator.compile(cleanedSource) &#125; catch &#123; case _: Exception if !Utils.isTesting &amp;&amp; sqlContext.conf.codegenFallback =&gt; // We should already saw the error message logWarning(s&quot;Whole-stage codegen disabled for plan (id=$codegenStageId):\\n $treeString&quot;) return child.execute() &#125; // Check if compiled code has a too large function if (maxCodeSize &gt; sqlContext.conf.hugeMethodLimit) &#123; logInfo(s&quot;Found too long generated codes and JIT optimization might not work: &quot; + s&quot;the bytecode size ($maxCodeSize) is above the limit &quot; + s&quot;$&#123;sqlContext.conf.hugeMethodLimit&#125;, and the whole-stage codegen was disabled &quot; + s&quot;for this plan (id=$codegenStageId). To avoid this, you can raise the limit &quot; + s&quot;`$&#123;SQLConf.WHOLESTAGE_HUGE_METHOD_LIMIT.key&#125;`:\\n$treeString&quot;) child match &#123; // The fallback solution of batch file source scan still uses WholeStageCodegenExec case f: FileSourceScanExec if f.supportsBatch =&gt; // do nothing case _ =&gt; return child.execute() &#125; &#125; val references = ctx.references.toArray val durationMs = longMetric(&quot;pipelineTime&quot;) val rdds = child.asInstanceOf[CodegenSupport].inputRDDs() assert(rdds.size &lt;= 2, &quot;Up to two input RDDs can be supported&quot;) if (rdds.length == 1) &#123; rdds.head.mapPartitionsWithIndex &#123; (index, iter) =&gt; val (clazz, _) = CodeGenerator.compile(cleanedSource) val buffer = clazz.generate(references).asInstanceOf[BufferedRowIterator] buffer.init(index, Array(iter)) new Iterator[InternalRow] &#123; override def hasNext: Boolean = &#123; val v = buffer.hasNext if (!v) durationMs += buffer.durationMs() v &#125; override def next: InternalRow = buffer.next() &#125; &#125; &#125; else &#123; // Right now, we support up to two input RDDs. rdds.head.zipPartitions(rdds(1)) &#123; (leftIter, rightIter) =&gt; Iterator((leftIter, rightIter)) // a small hack to obtain the correct partition index &#125;.mapPartitionsWithIndex &#123; (index, zippedIter) =&gt; val (leftIter, rightIter) = zippedIter.next() val (clazz, _) = CodeGenerator.compile(cleanedSource) val buffer = clazz.generate(references).asInstanceOf[BufferedRowIterator] buffer.init(index, Array(leftIter, rightIter)) new Iterator[InternalRow] &#123; override def hasNext: Boolean = &#123; val v = buffer.hasNext if (!v) durationMs += buffer.durationMs() v &#125; override def next: InternalRow = buffer.next() &#125; &#125; &#125; &#125; åœ¨WholeStageCodegenExec è¿™ä¸ªç±»çš„æ³¨é‡Šå½“ä¸­ä¹Ÿè¯´æ˜äº†ï¼Œæœ€ç»ˆç”Ÿæˆçš„ä»£ç è¿‡ç¨‹å¦‚ä¸‹ /** * WholeStageCodegen compiles a subtree of plans that support codegen together into single Java * function. * * Here is the call graph of to generate Java source (plan A supports codegen, but plan B does not): * * WholeStageCodegen Plan A FakeInput Plan B * ========================================================================= * * -&gt; execute() * | * doExecute() ---------&gt; inputRDDs() -------&gt; inputRDDs() ------&gt; execute() * | * +-----------------&gt; produce() * | * doProduce() -------&gt; produce() * | * doProduce() * | * doConsume() &lt;--------- consume() * | * doConsume() &lt;-------- consume() * * SparkPlan A should override `doProduce()` and `doConsume()`. * * `doCodeGen()` will create a `CodeGenContext`, which will hold a list of variables for input, * used to generated code for [[BoundReference]]. */ ç›¸æ¯” Volcano Iterator Modelï¼Œå…¨é˜¶æ®µä»£ç ç”Ÿæˆçš„æ‰§è¡Œè¿‡ç¨‹å¦‚ä¸‹ï¼š é€šè¿‡å¼•å…¥å…¨é˜¶æ®µä»£ç ç”Ÿæˆï¼Œå¤§å¤§å‡å°‘äº†è™šå‡½æ•°çš„è°ƒç”¨ï¼Œå‡å°‘äº† CPU çš„è°ƒç”¨ï¼Œä½¿å¾— SQL çš„æ‰§è¡Œé€Ÿåº¦æœ‰å¾ˆå¤§æå‡ã€‚ ä»£ç ç¼–è¯‘ç”Ÿæˆä»£ç ä¹‹åéœ€è¦è§£å†³çš„å¦ä¸€ä¸ªé—®é¢˜æ˜¯å¦‚ä½•å°†ç”Ÿæˆçš„ä»£ç è¿›è¡Œç¼–è¯‘ç„¶ååŠ è½½åˆ°åŒä¸€ä¸ª JVM ä¸­å»ã€‚åœ¨æ—©æœŸ Spark ç‰ˆæœ¬æ˜¯ä½¿ç”¨ Scala çš„ Reflection å’Œ Quasiquotes æœºåˆ¶æ¥å®ç°ä»£ç ç”Ÿæˆçš„ã€‚Quasiquotes æ˜¯ä¸€ä¸ªç®€æ´çš„ç¬¦å·ï¼Œå¯ä»¥è®©æˆ‘ä»¬è½»æ¾æ“ä½œ Scala è¯­æ³•æ ‘ï¼Œå…·ä½“å‚è§ è¿™é‡Œã€‚è™½ç„¶ Quasiquotes å¯ä»¥å¾ˆå¥½çš„ä¸ºæˆ‘ä»¬è§£å†³ä»£ç ç”Ÿæˆç­‰ç›¸å…³çš„é—®é¢˜ï¼Œä½†æ˜¯å¸¦æ¥çš„æ–°é—®é¢˜æ˜¯ç¼–è¯‘ä»£ç æ—¶é—´æ¯”è¾ƒé•¿ï¼ˆå¤§çº¦ 50ms - 500msï¼‰ï¼æ‰€ä»¥ç¤¾åŒºä¸å¾—ä¸é»˜è®¤å…³é—­è¡¨è¾¾å¼ä»£ç ç”Ÿæˆã€‚ ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒSpark å¼•å…¥äº† Janino é¡¹ç›®ï¼Œå‚è§ SPARK-7956ã€‚Janino æ˜¯ä¸€ä¸ªè¶…çº§å°ä½†åˆè¶…çº§å¿«çš„ Javaâ„¢ ç¼–è¯‘å™¨. å®ƒä¸ä»…èƒ½åƒ javac å·¥å…·é‚£æ ·å°†ä¸€ç»„æºæ–‡ä»¶ç¼–è¯‘æˆå­—èŠ‚ç æ–‡ä»¶ï¼Œè¿˜å¯ä»¥å¯¹ä¸€äº› Java è¡¨è¾¾å¼ï¼Œä»£ç å—ï¼Œç±»ä¸­çš„æ–‡æœ¬(class body)æˆ–è€…å†…å­˜ä¸­æºæ–‡ä»¶è¿›è¡Œç¼–è¯‘ï¼Œå¹¶æŠŠç¼–è¯‘åçš„å­—èŠ‚ç ç›´æ¥åŠ è½½åˆ°åŒä¸€ä¸ª JVM ä¸­è¿è¡Œã€‚Janino ä¸æ˜¯ä¸€ä¸ªå¼€å‘å·¥å…·, è€Œæ˜¯ä½œä¸ºè¿è¡Œæ—¶çš„åµŒå…¥å¼ç¼–è¯‘å™¨ï¼Œæ¯”å¦‚ä½œä¸ºè¡¨è¾¾å¼æ±‚å€¼çš„ç¿»è¯‘å™¨æˆ–ç±»ä¼¼äº JSP çš„æœåŠ¡ç«¯é¡µé¢å¼•æ“ï¼Œå…³äº Janino çš„æ›´å¤šçŸ¥è¯†è¯·å‚è§è¿™é‡Œã€‚é€šè¿‡å¼•å…¥äº† Janino æ¥ç¼–è¯‘ç”Ÿæˆçš„ä»£ç ï¼Œç»“æœæ˜¾ç¤º SQL è¡¨è¾¾å¼çš„ç¼–è¯‘æ—¶é—´å‡å°‘åˆ° 5msã€‚åœ¨ Spark ä¸­ä½¿ç”¨äº† ClassBodyEvaluator æ¥ç¼–è¯‘ç”Ÿæˆä¹‹åçš„ä»£ç ï¼Œå‚è§ org.apache.spark.sql.catalyst.expressions.codegen.CodeGeneratorã€‚ éœ€è¦ä¸»è¦çš„æ˜¯ï¼Œä»£ç ç”Ÿæˆæ˜¯åœ¨ Driver ç«¯è¿›è¡Œçš„ï¼Œè€Œä»£ç ç¼–è¯‘æ˜¯åœ¨ Executor ç«¯è¿›è¡Œçš„ã€‚ SQLæ‰§è¡Œç»ˆäºåˆ°äº† SQL çœŸæ­£æ‰§è¡Œçš„åœ°æ–¹äº†ã€‚è¿™ä¸ªæ—¶å€™ Spark ä¼šæ‰§è¡Œä¸Šé˜¶æ®µç”Ÿæˆçš„ä»£ç ï¼Œç„¶åå¾—åˆ°æœ€ç»ˆçš„ç»“æœï¼ŒDAG æ‰§è¡Œå›¾å¦‚ä¸‹ï¼š 3ã€sparkSQLæ‰§è¡Œè¿‡ç¨‹æ·±åº¦æ€»ç»“ sparkSQLæ‰§è¡Œè¿‡ç¨‹æ€»ç»“.pptx ä»ä¸Šé¢å¯ä»¥çœ‹å¾—å‡ºæ¥ï¼ŒsparkSQLçš„æ‰§è¡Œä¸»è¦ç»è¿‡äº†è¿™ä¹ˆå‡ ä¸ªå¤§çš„æ­¥éª¤ 1ã€è¾“å…¥sqlï¼ŒdataFrameæˆ–è€…dataSet 2ã€ç»è¿‡Catalystè¿‡ç¨‹ï¼Œç”Ÿæˆæœ€ç»ˆæˆ‘ä»¬å¾—åˆ°çš„æœ€ä¼˜çš„ç‰©ç†æ‰§è¡Œè®¡åˆ’ â€‹ 1ã€parseré˜¶æ®µ â€‹ ä¸»è¦æ˜¯é€šè¿‡Antlr4è§£æSqlBase.g4 ï¼Œæ‰€æœ‰sparkâ€™æ”¯æŒçš„è¯­æ³•æ–¹å¼éƒ½æ˜¯å®šä¹‰åœ¨sqlBase.g4é‡Œé¢äº†ï¼Œå¦‚æœéœ€è¦æ‰©å±•sparkSQLçš„è¯­æ³•ï¼Œæˆ‘ä»¬åªéœ€è¦æ‰©å±•sqlBase.g4å³å¯ï¼Œé€šè¿‡antlr4è§£æsqlBase.g4æ–‡ä»¶ï¼Œç”Ÿæˆäº†æˆ‘ä»¬çš„è¯­æ³•è§£æå™¨SqlBaseLexer.javaå’Œè¯æ³•è§£æå™¨SqlBaseParser.java â€‹ parseé˜¶æ®µ ==ã€‹ antlr4 ==ã€‹è§£æ ==ã€‹ SqlBase.g4 ==ã€‹å¾—åˆ° ==ã€‹ è¯­æ³•è§£æå™¨SqlBaseLexer.java + è¯æ³•è§£æå™¨SqlBaseParser.java â€‹ 2ã€analyzeré˜¶æ®µ â€‹ ä½¿ç”¨åŸºäºRuleçš„è§„åˆ™è§£æä»¥åŠSession Catalogæ¥å®ç°å‡½æ•°èµ„æºä¿¡æ¯å’Œå…ƒæ•°æ®ç®¡ç†ä¿¡æ¯ â€‹ Analyzer é˜¶æ®µ ==ã€‹ ä½¿ç”¨ ==ã€‹ Rule + Session Catalog ==ã€‹å¤šä¸ªrule ==ã€‹ ç»„æˆä¸€ä¸ªbatch â€‹ session CataLog ==ã€‹ ä¿å­˜å‡½æ•°èµ„æºä¿¡æ¯ä»¥åŠå…ƒæ•°æ®ä¿¡æ¯ç­‰ â€‹ 3ã€optimizeré˜¶æ®µ â€‹ optimizerè°ƒä¼˜é˜¶æ®µ ==ã€‹ åŸºäºè§„åˆ™çš„RBOä¼˜åŒ–rule-based optimizer ==&gt; è°“è¯ä¸‹æ¨ + åˆ—å‰ªæ + å¸¸é‡æ›¿æ¢ + å¸¸é‡ç´¯åŠ  â€‹ 4ã€planneré˜¶æ®µ â€‹ é€šè¿‡analyzerç”Ÿæˆå¤šä¸ªç‰©ç†è®¡åˆ’ ==ã€‹ ç»è¿‡Cost Modelè¿›è¡Œæœ€ä¼˜é€‰æ‹© ==ã€‹åŸºäºä»£ä»·çš„CBOä¼˜åŒ– ==ã€‹ æœ€ç»ˆé€‰å®šå¾—åˆ°çš„æœ€ä¼˜ç‰©ç†æ‰§è¡Œè®¡åˆ’ â€‹ 5ã€é€‰å®šæœ€ç»ˆçš„ç‰©ç†è®¡åˆ’ï¼Œå‡†å¤‡æ‰§è¡Œ â€‹ æœ€ç»ˆé€‰å®šçš„æœ€ä¼˜ç‰©ç†æ‰§è¡Œè®¡åˆ’ ==ã€‹ å‡†å¤‡ç”Ÿæˆä»£ç å»å¼€å§‹æ‰§è¡Œ 3ã€å°†æœ€ç»ˆå¾—åˆ°çš„ç‰©ç†æ‰§è¡Œè®¡åˆ’è¿›è¡Œä»£ç ç”Ÿæˆï¼Œæäº¤ä»£ç å»æ‰§è¡Œæˆ‘ä»¬çš„æœ€ç»ˆä»»åŠ¡ 13ã€sparkSQLè°ƒä¼˜1ã€æ•°æ®ç¼“å­˜æ€§èƒ½è°ƒä¼˜ä¸»è¦æ˜¯å°†æ•°æ®æ”¾å…¥å†…å­˜ä¸­æ“ä½œï¼Œsparkç¼“å­˜æ³¨å†Œè¡¨çš„æ–¹æ³• ç¼“å­˜sparkè¡¨ï¼š spark.catalog.cacheTable(â€œtableNameâ€)ç¼“å­˜è¡¨ é‡Šæ”¾ç¼“å­˜è¡¨ï¼š spark.catalog.uncacheTable(â€œtableNameâ€)è§£é™¤ç¼“å­˜ 2ã€æ€§èƒ½ä¼˜åŒ–ç›¸å…³å‚æ•°Sparksqlä»…ä»…ä¼šç¼“å­˜å¿…è¦çš„åˆ—ï¼Œå¹¶ä¸”è‡ªåŠ¨è°ƒæ•´å‹ç¼©ç®—æ³•æ¥å‡å°‘å†…å­˜å’ŒGCå‹åŠ›ã€‚ å±æ€§ é»˜è®¤å€¼ æè¿° spark.sql.inMemoryColumnarStorage.compressed true Spark SQL å°†ä¼šåŸºäºç»Ÿè®¡ä¿¡æ¯è‡ªåŠ¨åœ°ä¸ºæ¯ä¸€åˆ—é€‰æ‹©ä¸€ç§å‹ç¼©ç¼–ç æ–¹å¼ã€‚ spark.sql.inMemoryColumnarStorage.batchSize 10000 ç¼“å­˜æ‰¹å¤„ç†å¤§å°ã€‚ç¼“å­˜æ•°æ®æ—¶, è¾ƒå¤§çš„æ‰¹å¤„ç†å¤§å°å¯ä»¥æé«˜å†…å­˜åˆ©ç”¨ç‡å’Œå‹ç¼©ç‡ï¼Œä½†åŒæ—¶ä¹Ÿä¼šå¸¦æ¥ OOMï¼ˆOut Of Memoryï¼‰çš„é£é™©ã€‚ spark.sql.files.maxPartitionBytes 128 MB è¯»å–æ–‡ä»¶æ—¶å•ä¸ªåˆ†åŒºå¯å®¹çº³çš„æœ€å¤§å­—èŠ‚æ•°ï¼ˆä¸è¿‡ä¸æ¨èæ‰‹åŠ¨ä¿®æ”¹ï¼Œå¯èƒ½åœ¨åç»­ç‰ˆæœ¬è‡ªåŠ¨çš„è‡ªé€‚åº”ä¿®æ”¹ï¼‰ spark.sql.files.openCostInBytes 4M æ‰“å¼€æ–‡ä»¶çš„ä¼°ç®—æˆæœ¬, æŒ‰ç…§åŒä¸€æ—¶é—´èƒ½å¤Ÿæ‰«æçš„å­—èŠ‚æ•°æ¥æµ‹é‡ã€‚å½“å¾€ä¸€ä¸ªåˆ†åŒºå†™å…¥å¤šä¸ªæ–‡ä»¶çš„æ—¶å€™ä¼šä½¿ç”¨ã€‚é«˜ä¼°æ›´å¥½, è¿™æ ·çš„è¯å°æ–‡ä»¶åˆ†åŒºå°†æ¯”å¤§æ–‡ä»¶åˆ†åŒºæ›´å¿« (å…ˆè¢«è°ƒåº¦)ã€‚ 3ã€è¡¨æ•°æ®å¹¿æ’­åœ¨è¿›è¡Œè¡¨joinçš„æ—¶å€™ï¼Œå°†å°è¡¨å¹¿æ’­å¯ä»¥æé«˜æ€§èƒ½ï¼Œspark2.+ä¸­å¯ä»¥è°ƒæ•´ä»¥ä¸‹å‚æ•°ã€ å±æ€§ é»˜è®¤å€¼ æè¿° spark.sql.broadcastTimeout 300 å¹¿æ’­ç­‰å¾…è¶…æ—¶æ—¶é—´ï¼Œå•ä½ç§’ spark.sql.autoBroadcastJoinThreshold 10M ç”¨äºé…ç½®ä¸€ä¸ªè¡¨åœ¨æ‰§è¡Œ join æ“ä½œæ—¶èƒ½å¤Ÿå¹¿æ’­ç»™æ‰€æœ‰ worker èŠ‚ç‚¹çš„æœ€å¤§å­—èŠ‚å¤§å°ã€‚é€šè¿‡å°†è¿™ä¸ªå€¼è®¾ç½®ä¸º -1 å¯ä»¥ç¦ç”¨å¹¿æ’­ã€‚æ³¨æ„ï¼Œå½“å‰æ•°æ®ç»Ÿè®¡ä»…æ”¯æŒå·²ç»è¿è¡Œäº† ANALYZE TABLE COMPUTE STATISTICS noscan å‘½ä»¤çš„ Hive Metastore è¡¨ã€‚ 4ã€åˆ†åŒºæ•°çš„æ§åˆ¶sparkä»»åŠ¡å¹¶è¡Œåº¦çš„è®¾ç½®ä¸­ï¼Œsparkæœ‰ä¸¤ä¸ªå‚æ•°å¯ä»¥è®¾ç½® å±æ€§ é»˜è®¤å€¼ æè¿° spark.sql.shuffle.partitions 200 ç”¨äºé…ç½® join æˆ–aggregate shuffleæ•°æ®æ—¶ä½¿ç”¨çš„åˆ†åŒºæ•°ã€‚ spark.default.parallelism å¯¹äºåˆ†å¸ƒå¼shuffleæ“ä½œåƒreduceByKeyå’Œjoinï¼Œçˆ¶RDDä¸­åˆ†åŒºçš„æœ€å¤§æ•°ç›®ã€‚å¯¹äºæ— çˆ¶RDDçš„å¹¶è¡ŒåŒ–ç­‰æ“ä½œï¼Œå®ƒå–å†³äºç¾¤é›†ç®¡ç†å™¨ï¼š-æœ¬åœ°æ¨¡å¼ï¼šæœ¬åœ°è®¡ç®—æœºä¸Šçš„æ ¸å¿ƒæ•°-Mesos fine grained modeï¼š8-å…¶ä»–ï¼šæ‰€æœ‰æ‰§è¡ŒèŠ‚ç‚¹ä¸Šçš„æ ¸å¿ƒæ€»æ•°æˆ–2ï¼Œä»¥è¾ƒå¤§è€…ä¸ºå‡† åˆ†å¸ƒå¼shuffleæ“ä½œçš„åˆ†åŒºæ•° çœ‹èµ·æ¥å®ƒä»¬çš„å®šä¹‰ä¼¼ä¹ä¹Ÿå¾ˆç›¸ä¼¼ï¼Œä½†åœ¨å®é™…æµ‹è¯•ä¸­ï¼Œ spark.default.parallelismåªæœ‰åœ¨å¤„ç†RDDæ—¶æ‰ä¼šèµ·ä½œç”¨ï¼Œå¯¹Spark SQLçš„æ— æ•ˆã€‚ spark.sql.shuffle.partitionsåˆ™æ˜¯å¯¹sparks SQLä¸“ç”¨çš„è®¾ç½® 5. æ–‡ä»¶ä¸åˆ†åŒºè¿™ä¸ªæ€»å…±æœ‰ä¸¤ä¸ªå‚æ•°å¯ä»¥è°ƒæ•´ï¼š è¯»å–æ–‡ä»¶çš„æ—¶å€™ä¸€ä¸ªåˆ†åŒºæ¥å—å¤šå°‘æ•°æ®ï¼› æ–‡ä»¶æ‰“å¼€çš„å¼€é”€ï¼Œé€šä¿—ç†è§£å°±æ˜¯å°æ–‡ä»¶åˆå¹¶çš„é˜ˆå€¼ã€‚ æ–‡ä»¶æ‰“å¼€æ˜¯æœ‰å¼€é”€çš„ï¼Œå¼€é”€çš„è¡¡é‡ï¼ŒSpark é‡‡ç”¨äº†ä¸€ä¸ªæ¯”è¾ƒå¥½çš„æ–¹å¼å°±æ˜¯æ‰“å¼€æ–‡ä»¶çš„å¼€é”€ç”¨ï¼Œç›¸åŒæ—¶é—´èƒ½æ‰«æçš„æ•°æ®çš„å­—èŠ‚æ•°æ¥è¡¡é‡ã€‚ å‚æ•°ä»‹ç»å¦‚ä¸‹ï¼š å±æ€§ é»˜è®¤å€¼ æè¿° spark.sql.files.maxPartitionBytes 134217728 (128 MB) æ‰“åŒ…ä¼ å…¥ä¸€ä¸ªåˆ†åŒºçš„æœ€å¤§å­—èŠ‚ï¼Œåœ¨è¯»å–æ–‡ä»¶çš„æ—¶å€™ spark.sql.files.openCostInBytes 4194304 (4 MB) ç”¨ç›¸åŒæ—¶é—´å†…å¯ä»¥æ‰«æçš„æ•°æ®çš„å¤§å°æ¥è¡¡é‡æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶çš„å¼€é”€ã€‚å½“å°†å¤šä¸ªæ–‡ä»¶å†™å…¥åŒä¸€ä¸ªåˆ†åŒºçš„æ—¶å€™è¯¥å‚æ•°æœ‰ç”¨ã€‚è¯¥å€¼è®¾ç½®å¤§ä¸€ç‚¹æœ‰å¥½å¤„ï¼Œæœ‰å°æ–‡ä»¶çš„åˆ†åŒºä¼šæ¯”å¤§æ–‡ä»¶åˆ†åŒºå¤„ç†é€Ÿåº¦æ›´å¿«ï¼ˆä¼˜å…ˆè°ƒåº¦ï¼‰ spark.sql.files.maxPartitionBytesè¯¥å€¼çš„è°ƒæ•´è¦ç»“åˆä½ æƒ³è¦çš„å¹¶å‘åº¦åŠå†…å­˜çš„å¤§å°æ¥è¿›è¡Œã€‚ spark.sql.files.openCostInBytesè¯´ç›´ç™½ä¸€äº›è¿™ä¸ªå‚æ•°å°±æ˜¯åˆå¹¶å°æ–‡ä»¶çš„é˜ˆå€¼ï¼Œå°äºè¿™ä¸ªé˜ˆå€¼çš„æ–‡ä»¶å°†ä¼šåˆå¹¶ 6ã€æ•°æ®çš„æœ¬åœ°æ€§åˆ†å¸ƒå¼è®¡ç®—ç³»ç»Ÿçš„ç²¾ç²¹åœ¨äºç§»åŠ¨è®¡ç®—è€Œéç§»åŠ¨æ•°æ®ï¼Œä½†æ˜¯åœ¨å®é™…çš„è®¡ç®—è¿‡ç¨‹ä¸­ï¼Œæ€»å­˜åœ¨ç€ç§»åŠ¨æ•°æ®çš„æƒ…å†µï¼Œé™¤éæ˜¯åœ¨é›†ç¾¤çš„æ‰€æœ‰èŠ‚ç‚¹ä¸Šéƒ½ä¿å­˜æ•°æ®çš„å‰¯æœ¬ã€‚ç§»åŠ¨æ•°æ®ï¼Œå°†æ•°æ®ä»ä¸€ä¸ªèŠ‚ç‚¹ç§»åŠ¨åˆ°å¦ä¸€ä¸ªèŠ‚ç‚¹è¿›è¡Œè®¡ç®—ï¼Œä¸ä½†æ¶ˆè€—äº†ç½‘ç»œIOï¼Œä¹Ÿæ¶ˆè€—äº†ç£ç›˜IOï¼Œé™ä½äº†æ•´ä¸ªè®¡ç®—çš„æ•ˆç‡ã€‚ä¸ºäº†æé«˜æ•°æ®çš„æœ¬åœ°æ€§ï¼Œé™¤äº†ä¼˜åŒ–ç®—æ³•ï¼ˆä¹Ÿå°±æ˜¯ä¿®æ”¹sparkå†…å­˜ï¼Œéš¾åº¦æœ‰ç‚¹é«˜ï¼‰ï¼Œå°±æ˜¯åˆç†è®¾ç½®æ•°æ®çš„å‰¯æœ¬ã€‚è®¾ç½®æ•°æ®çš„å‰¯æœ¬ï¼Œè¿™éœ€è¦é€šè¿‡é…ç½®å‚æ•°å¹¶é•¿æœŸè§‚å¯Ÿè¿è¡ŒçŠ¶æ€æ‰èƒ½è·å–çš„ä¸€ä¸ªç»éªŒå€¼ã€‚ å…ˆæ¥çœ‹çœ‹ä¸€ä¸ª stage é‡Œæ‰€æœ‰ task è¿è¡Œçš„ä¸€äº›æ€§èƒ½æŒ‡æ ‡ï¼Œå…¶ä¸­çš„ä¸€äº›è¯´æ˜ï¼š Scheduler Delay : spark åˆ†é… task æ‰€èŠ±è´¹çš„æ—¶é—´ Executor Computing Time : executor æ‰§è¡Œ task æ‰€èŠ±è´¹çš„æ—¶é—´ Getting Result Time : è·å– task æ‰§è¡Œç»“æœæ‰€èŠ±è´¹çš„æ—¶é—´ Result Serialization Time : task æ‰§è¡Œç»“æœåºåˆ—åŒ–æ—¶é—´ Task Deserialization Time : task ååºåˆ—åŒ–æ—¶é—´ Shuffle Write Time : shuffle å†™æ•°æ®æ—¶é—´ Shuffle Read Time : shuffle è¯»æ•°æ®æ‰€èŠ±è´¹æ—¶é—´ â€‹ ä¸‹é¢æ˜¯spark webUIç›‘æ§Stageçš„ä¸€ä¸ªå›¾ï¼š PROCESS_LOCALæ˜¯æŒ‡è¯»å–ç¼“å­˜åœ¨æœ¬åœ°èŠ‚ç‚¹çš„æ•°æ® NODE_LOCALæ˜¯æŒ‡è¯»å–æœ¬åœ°èŠ‚ç‚¹ç¡¬ç›˜æ•°æ® ANYæ˜¯æŒ‡è¯»å–éæœ¬åœ°èŠ‚ç‚¹æ•°æ® é€šå¸¸è¯»å–æ•°æ®PROCESS_LOCAL&gt;NODE_LOCAL&gt;ANYï¼Œå°½é‡ä½¿æ•°æ®ä»¥PROCESS_LOCALæˆ–NODE_LOCALæ–¹å¼è¯»å–ã€‚å…¶ä¸­PROCESS_LOCALè¿˜å’Œcacheæœ‰å…³ã€‚ 7ã€sparkSQLå‚æ•°è°ƒä¼˜æ€»ç»“//1.ä¸‹åˆ—Hiveå‚æ•°å¯¹SparkåŒæ ·èµ·ä½œç”¨ã€‚set hive.exec.dynamic.partition=true; // æ˜¯å¦å…è®¸åŠ¨æ€ç”Ÿæˆåˆ†åŒºset hive.exec.dynamic.partition.mode=nonstrict; // æ˜¯å¦å®¹å¿æŒ‡å®šåˆ†åŒºå…¨éƒ¨åŠ¨æ€ç”Ÿæˆset hive.exec.max.dynamic.partitions = 100; // åŠ¨æ€ç”Ÿæˆçš„æœ€å¤šåˆ†åŒºæ•°//2.è¿è¡Œè¡Œä¸ºset spark.sql.autoBroadcastJoinThreshold; // å¤§è¡¨ JOIN å°è¡¨ï¼Œå°è¡¨åšå¹¿æ’­çš„é˜ˆå€¼set spark.dynamicAllocation.enabled; // å¼€å¯åŠ¨æ€èµ„æºåˆ†é…set spark.dynamicAllocation.maxExecutors; //å¼€å¯åŠ¨æ€èµ„æºåˆ†é…åï¼Œæœ€å¤šå¯åˆ†é…çš„Executoræ•°set spark.dynamicAllocation.minExecutors; //å¼€å¯åŠ¨æ€èµ„æºåˆ†é…åï¼Œæœ€å°‘å¯åˆ†é…çš„Executoræ•°set spark.sql.shuffle.partitions; // éœ€è¦shuffleæ˜¯mapperç«¯å†™å‡ºçš„partitionä¸ªæ•°set spark.sql.adaptive.enabled; // æ˜¯å¦å¼€å¯è°ƒæ•´partitionåŠŸèƒ½ï¼Œå¦‚æœå¼€å¯ï¼Œspark.sql.shuffle.partitionsè®¾ç½®çš„partitionå¯èƒ½ä¼šè¢«åˆå¹¶åˆ°ä¸€ä¸ªreduceré‡Œè¿è¡Œset spark.sql.adaptive.shuffle.targetPostShuffleInputSize; //å¼€å¯spark.sql.adaptive.enabledåï¼Œä¸¤ä¸ªpartitionçš„å’Œä½äºè¯¥é˜ˆå€¼ä¼šåˆå¹¶åˆ°ä¸€ä¸ªreducerset spark.sql.adaptive.minNumPostShufflePartitions; // å¼€å¯spark.sql.adaptive.enabledåï¼Œæœ€å°çš„åˆ†åŒºæ•°set spark.hadoop.mapreduce.input.fileinputformat.split.maxsize; //å½“å‡ ä¸ªstripeçš„å¤§å°å¤§äºè¯¥å€¼æ—¶ï¼Œä¼šåˆå¹¶åˆ°ä¸€ä¸ªtaskä¸­å¤„ç†//3.executorèƒ½åŠ›set spark.executor.memory; // executorç”¨äºç¼“å­˜æ•°æ®ã€ä»£ç æ‰§è¡Œçš„å †å†…å­˜ä»¥åŠJVMè¿è¡Œæ—¶éœ€è¦çš„å†…å­˜set spark.yarn.executor.memoryOverhead; //Sparkè¿è¡Œè¿˜éœ€è¦ä¸€äº›å †å¤–å†…å­˜ï¼Œç›´æ¥å‘ç³»ç»Ÿç”³è¯·ï¼Œå¦‚æ•°æ®ä¼ è¾“æ—¶çš„nettyç­‰ã€‚set spark.sql.windowExec.buffer.spill.threshold; //å½“ç”¨æˆ·çš„SQLä¸­åŒ…å«çª—å£å‡½æ•°æ—¶ï¼Œå¹¶ä¸ä¼šæŠŠä¸€ä¸ªçª—å£ä¸­çš„æ‰€æœ‰æ•°æ®å…¨éƒ¨è¯»è¿›å†…å­˜ï¼Œè€Œæ˜¯ç»´æŠ¤ä¸€ä¸ªç¼“å­˜æ± ï¼Œå½“æ± ä¸­çš„æ•°æ®æ¡æ•°å¤§äºè¯¥å‚æ•°è¡¨ç¤ºçš„é˜ˆå€¼æ—¶ï¼Œsparkå°†æ•°æ®å†™åˆ°ç£ç›˜set spark.executor.cores; //å•ä¸ªexecutorä¸Šå¯ä»¥åŒæ—¶è¿è¡Œçš„taskæ•° 14ã€sparkçš„åŠ¨æ€èµ„æºåˆ’åˆ†åŠ¨æ€èµ„æºåˆ’åˆ†ï¼Œä¸»è¦æ˜¯sparkå½“ä¸­ç”¨äºå¯¹è®¡ç®—çš„æ—¶å€™èµ„æºå¦‚æœä¸å¤Ÿæˆ–è€…èµ„æºå‰©ä½™çš„æƒ…å†µä¸‹è¿›è¡ŒåŠ¨æ€çš„èµ„æºåˆ’åˆ†ï¼Œä»¥æ±‚èµ„æºçš„åˆ©ç”¨ç‡è¾¾åˆ°æœ€å¤§ http://spark.apache.org/docs/2.3.3/configuration.html#dynamic-allocation Sparkä¸­ï¼Œæ‰€è°“èµ„æºå•ä½ä¸€èˆ¬æŒ‡çš„æ˜¯executorsï¼Œå’ŒYarnä¸­çš„Containersä¸€æ ·ï¼Œåœ¨Spark On Yarnæ¨¡å¼ä¸‹ï¼Œé€šå¸¸ä½¿ç”¨â€“num-executorsæ¥æŒ‡å®šApplicationä½¿ç”¨çš„executorsæ•°é‡ï¼Œè€Œâ€“executor-memoryå’Œâ€“executor-coresåˆ†åˆ«ç”¨æ¥æŒ‡å®šæ¯ä¸ªexecutoræ‰€ä½¿ç”¨çš„å†…å­˜å’Œè™šæ‹ŸCPUæ ¸æ•° å‡è®¾æœ‰è¿™æ ·çš„åœºæ™¯ï¼Œå¦‚æœä½¿ç”¨Hiveï¼Œå¤šä¸ªç”¨æˆ·åŒæ—¶ä½¿ç”¨hive-cliåšæ•°æ®å¼€å‘å’Œåˆ†æï¼Œåªæœ‰å½“ç”¨æˆ·æäº¤æ‰§è¡Œäº†Hive SQLæ—¶å€™ï¼Œæ‰ä¼šå‘YARNç”³è¯·èµ„æºï¼Œæ‰§è¡Œä»»åŠ¡ï¼Œå¦‚æœä¸æäº¤æ‰§è¡Œï¼Œæ— éå°±æ˜¯åœç•™åœ¨Hive-cliå‘½ä»¤è¡Œï¼Œä¹Ÿå°±æ˜¯ä¸ªJVMè€Œå·²ï¼Œå¹¶ä¸ä¼šæµªè´¹YARNçš„èµ„æºã€‚ç°åœ¨æƒ³ç”¨Spark-SQLä»£æ›¿Hiveæ¥åšæ•°æ®å¼€å‘å’Œåˆ†æï¼Œä¹Ÿæ˜¯å¤šç”¨æˆ·åŒæ—¶ä½¿ç”¨ï¼Œå¦‚æœæŒ‰ç…§ä¹‹å‰çš„æ–¹å¼ï¼Œä»¥yarn-clientæ¨¡å¼è¿è¡Œspark-sqlå‘½ä»¤è¡Œï¼Œåœ¨å¯åŠ¨æ—¶å€™æŒ‡å®šâ€“num-executors 10ï¼Œé‚£ä¹ˆæ¯ä¸ªç”¨æˆ·å¯åŠ¨æ—¶å€™éƒ½ä½¿ç”¨äº†10ä¸ªYARNçš„èµ„æºï¼ˆContainerï¼‰ï¼Œè¿™10ä¸ªèµ„æºå°±ä¼šä¸€ç›´è¢«å ç”¨ç€ï¼Œåªæœ‰å½“ç”¨æˆ·é€€å‡ºspark-sqlå‘½ä»¤è¡Œæ—¶æ‰ä¼šé‡Šæ”¾ã€‚ä¾‹å¦‚é€šè¿‡ä»¥ä¸‹è¿™ç§æ–¹å¼ä½¿ç”¨spark-sql ç›´æ¥é€šè¿‡-eæ¥æ‰§è¡Œä»»åŠ¡ï¼Œæ‰§è¡Œå®Œæˆä»»åŠ¡ä¹‹åï¼Œå›æ”¶èµ„æºcd /kkb/install/spark-2.3.3-bin-hadoop2.7bin/spark-sql --master yarn-client \\--executor-memory 512m â€“num-executors 10 \\--conf spark.sql.warehouse.dir=hdfs://node01:8020/user/hive/warehouse \\--jars /kkb/install/hadoop-2.6.0-cdh5.14.2/share/hadoop/common/hadoop-lzo-0.4.20.jar \\-e &quot;select count(*) from game_center.ods_task_log;&quot;è¿›å…¥spark-sqlå®¢æˆ·ç«¯ï¼Œä½†æ˜¯ä¸æ‰§è¡Œä»»åŠ¡ï¼Œä¸€ç›´æŒç»­å æœ‰èµ„æºcd /kkb/install/spark-2.3.3-bin-hadoop2.7bin/spark-sql --master yarn-client \\--executor-memory 512m â€“num-executors 10 \\--conf spark.sql.warehouse.dir=hdfs://node01:8020/user/hive/warehouse \\--jars /kkb/install/hadoop-2.6.0-cdh5.14.2/share/hadoop/common/hadoop-lzo-0.4.20.jar åœ¨è¿™ç§æ¨¡å¼ä¸‹ï¼Œå°±ç®—ä½ ä¸æäº¤èµ„æºï¼Œç”³è¯·çš„èµ„æºä¹Ÿä¼šä¸€ç›´å¸¸é©»ï¼Œè¿™æ ·å°±æ˜æ˜¾ä¸åˆç†äº† spark-sql On Yarnï¼Œèƒ½ä¸èƒ½åƒHiveä¸€æ ·ï¼Œæ‰§è¡ŒSQLçš„æ—¶å€™æ‰å»ç”³è¯·èµ„æºï¼Œä¸æ‰§è¡Œçš„æ—¶å€™å°±é‡Šæ”¾æ‰èµ„æºå‘¢ï¼Œå…¶å®ä»Spark1.2ä¹‹åï¼Œå¯¹äºOn Yarnæ¨¡å¼ï¼Œå·²ç»æ”¯æŒåŠ¨æ€èµ„æºåˆ†é…ï¼ˆDynamic Resource Allocationï¼‰ï¼Œè¿™æ ·ï¼Œå°±å¯ä»¥æ ¹æ®Applicationçš„è´Ÿè½½ï¼ˆTaskæƒ…å†µï¼‰ï¼ŒåŠ¨æ€çš„å¢åŠ å’Œå‡å°‘executorsï¼Œè¿™ç§ç­–ç•¥éå¸¸é€‚åˆåœ¨YARNä¸Šä½¿ç”¨spark-sqlåšæ•°æ®å¼€å‘å’Œåˆ†æï¼Œä»¥åŠå°†spark-sqlä½œä¸ºé•¿æœåŠ¡æ¥ä½¿ç”¨çš„åœºæ™¯ã€‚ sparkå½“ä¸­æ”¯æŒé€šè¿‡åŠ¨æ€èµ„æºåˆ’åˆ†çš„æ–¹å¼æ¥å®ç°åŠ¨æ€èµ„æºçš„é…ç½®ï¼Œå°½é‡å‡å°‘å†…å­˜çš„æŒä¹…å ç”¨ï¼Œä½†æ˜¯åŠ¨æ€èµ„æºåˆ’åˆ†åˆä¼šäº§ç”Ÿè¿›ä¸€æ­¥çš„é—®é¢˜ä¾‹å¦‚ï¼š executoråŠ¨æ€è°ƒæ•´çš„èŒƒå›´ï¼Ÿæ— é™å‡å°‘ï¼Ÿæ— é™åˆ¶å¢åŠ ï¼ŸexecutoråŠ¨æ€è°ƒæ•´é€Ÿç‡ï¼Ÿçº¿æ€§å¢å‡ï¼ŸæŒ‡æ•°å¢å‡ï¼Ÿä½•æ—¶ç§»é™¤Executorï¼Ÿä½•æ—¶æ–°å¢Executoräº†ï¼Ÿåªè¦ç”±æ–°æäº¤çš„Taskå°±æ–°å¢Executorå—ï¼ŸSparkä¸­çš„executorä¸ä»…ä»…æä¾›è®¡ç®—èƒ½åŠ›ï¼Œè¿˜å¯èƒ½å­˜å‚¨æŒä¹…åŒ–æ•°æ®ï¼Œè¿™äº›æ•°æ®åœ¨å®¿ä¸»executorè¢«killåï¼Œè¯¥å¦‚ä½•è®¿é—®ï¼Ÿ é€šè¿‡spark-shellå½“ä¸­æœ€ç®€å•çš„wordcountä¸ºä¾‹æ¥æŸ¥çœ‹sparkå½“ä¸­çš„èµ„æºåˆ’åˆ† # ä»¥yarnæ¨¡å¼æ‰§è¡Œï¼Œå¹¶æŒ‡å®šexecutorä¸ªæ•°ä¸º1$ spark-shell --master=yarn --num-executors=1# æäº¤Job1 wordcountscala&gt; sc.textFile(&quot;file:///etc/hosts&quot;).flatMap(line =&gt; line.split(&quot; &quot;)).map(word =&gt; (word,1)).reduceByKey(_ + _).count();# æäº¤Job2 wordcountscala&gt; sc.textFile(&quot;file:///etc/profile&quot;).flatMap(line =&gt; line.split(&quot; &quot;)).map(word =&gt; (word,1)).reduceByKey(_ + _).count();# Ctrl+C Kill JVM ä¸Šè¿°çš„Sparkåº”ç”¨ä¸­ï¼Œä»¥yarnæ¨¡å¼å¯åŠ¨spark-shellï¼Œå¹¶é¡ºåºæ‰§è¡Œä¸¤æ¬¡wordcountï¼Œæœ€åCtrl+Cé€€å‡ºspark-shellã€‚æ­¤ä¾‹ä¸­Executorçš„ç”Ÿå‘½å‘¨æœŸå¦‚ä¸‹å›¾ï¼š ä»ä¸Šå›¾å¯ä»¥çœ‹å‡ºï¼ŒExecutoråœ¨æ•´ä¸ªåº”ç”¨æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œå…¶çŠ¶æ€ä¸€ç›´å¤„äºBusyï¼ˆæ‰§è¡ŒTaskï¼‰æˆ–Idleï¼ˆç©ºç­‰ï¼‰ã€‚å¤„äºIdleçŠ¶æ€çš„Executoré€ æˆèµ„æºæµªè´¹è¿™ä¸ªé—®é¢˜å·²ç»åœ¨ä¸Šé¢æåˆ°ã€‚ä¸‹é¢é‡ç‚¹çœ‹ä¸‹å¼€å¯SparkåŠ¨æ€èµ„æºåˆ†é…åŠŸèƒ½åï¼ŒExecutorå¦‚ä½•è¿ä½œã€‚ ä¸‹é¢åˆ†æä¸‹ä¸Šå›¾ä¸­å„ä¸ªæ­¥éª¤ï¼š spark-shell Startï¼šå¯åŠ¨spark-shellåº”ç”¨ï¼Œå¹¶é€šè¿‡â€”num-executoræŒ‡å®šäº†1ä¸ªæ‰§è¡Œå™¨ã€‚ Executor1 Startï¼šå¯åŠ¨æ‰§è¡Œå™¨Executor1ã€‚æ³¨æ„ï¼šExecutorå¯åŠ¨å‰å­˜åœ¨ä¸€ä¸ªAMå‘ResourceManagerç”³è¯·èµ„æºçš„è¿‡ç¨‹ï¼Œæ‰€ä»¥å¯åŠ¨æ—¶æœºç•¥å¾®æ»åä¸Driverã€‚ Job1 Startï¼šæäº¤ç¬¬ä¸€ä¸ªwordcountä½œä¸šï¼Œæ­¤æ—¶ï¼ŒExecutor1å¤„äºBusyçŠ¶æ€ã€‚ Job1 Endï¼šä½œä¸š1ç»“æŸï¼ŒExecutor1åˆå¤„äºIdleçŠ¶æ€ã€‚ Executor1 timeoutï¼šExecutor1ç©ºé—²ä¸€æ®µæ—¶é—´åï¼Œè¶…æ—¶è¢«Killã€‚ Job2 Submitï¼šæäº¤ç¬¬äºŒä¸ªwordcountï¼Œæ­¤æ—¶ï¼Œæ²¡æœ‰Activeçš„Executorå¯ç”¨ã€‚Job2å¤„äºPendingçŠ¶æ€ã€‚ Executor2 Startï¼šæ£€æµ‹åˆ°æœ‰Pendingçš„ä»»åŠ¡ï¼Œæ­¤æ—¶Sparkä¼šå¯åŠ¨Executor2ã€‚ Job2 Startï¼šæ­¤æ—¶ï¼Œå·²ç»æœ‰Activeçš„æ‰§è¡Œå™¨ï¼ŒJob2ä¼šè¢«åˆ†é…åˆ°Executor2ä¸Šæ‰§è¡Œã€‚ Job2 Endï¼šJob2ç»“æŸã€‚ Executor2 Endï¼šCtrl+C æ€æ­»Driverï¼ŒExecutor2ä¹Ÿä¼šè¢«RMæ€æ­»ã€‚ ä¸Šè¿°æµç¨‹ä¸­éœ€è¦é‡ç‚¹å…³æ³¨çš„å‡ ä¸ªé—®é¢˜ï¼š Executorè¶…æ—¶ï¼šå½“Executorä¸æ‰§è¡Œä»»ä½•ä»»åŠ¡æ—¶ï¼Œä¼šè¢«æ ‡è®°ä¸ºIdleçŠ¶æ€ã€‚ç©ºé—²ä¸€æ®µæ—¶é—´åå³è¢«è®¤ä¸ºè¶…æ—¶ï¼Œä¼šè¢«killã€‚è¯¥ç©ºé—²æ—¶é—´ç”±spark.dynamicAllocation.executorIdleTimeoutå†³å®šï¼Œé»˜è®¤å€¼60sã€‚å¯¹åº”ä¸Šå›¾ä¸­ï¼šJob1 Endåˆ°Executor1 timeoutä¹‹é—´çš„æ—¶é—´ã€‚ èµ„æºä¸è¶³æ—¶ï¼Œä½•æ—¶æ–°å¢Executorï¼šå½“æœ‰Taskå¤„äºpendingçŠ¶æ€ï¼Œæ„å‘³ç€èµ„æºä¸è¶³ï¼Œæ­¤æ—¶éœ€è¦å¢åŠ Executorã€‚è¿™æ®µæ—¶é—´ç”±spark.dynamicAllocation.schedulerBacklogTimeoutæ§åˆ¶ï¼Œé»˜è®¤1sã€‚å¯¹åº”ä¸Šè¿°step6å’Œstep7ä¹‹é—´çš„æ—¶é—´ã€‚ è¯¥æ–°å¢å¤šå°‘Executorï¼šæ–°å¢Executorçš„ä¸ªæ•°ä¸»è¦ä¾æ®æ˜¯å½“å‰è´Ÿè½½æƒ…å†µï¼Œå³runningå’Œpendingä»»åŠ¡æ•°ä»¥åŠå½“å‰Executorä¸ªæ•°å†³å®šã€‚ç”¨maxNumExecutorsNeededä»£è¡¨å½“å‰å®é™…éœ€è¦çš„æœ€å¤§Executorä¸ªæ•°ï¼ŒmaxNumExecutorsNeededå’Œå½“å‰Executorä¸ªæ•°çš„å·®å€¼å³æ˜¯æ½œåœ¨çš„æ–°å¢Executorçš„ä¸ªæ•°ã€‚æ³¨æ„ï¼šä¹‹æ‰€ä»¥è¯´æ½œåœ¨çš„ä¸ªæ•°ï¼Œæ˜¯å› ä¸ºæœ€ç»ˆæ–°å¢çš„Executorä¸ªæ•°è¿˜æœ‰åˆ«çš„å› ç´ éœ€è¦è€ƒè™‘ï¼Œåé¢ä¼šæœ‰åˆ†æã€‚ä¸‹é¢æ˜¯maxNumExecutorsNeededè®¡ç®—æ–¹æ³•ï¼š private def maxNumExecutorsNeeded(): Int = &#123; val numRunningOrPendingTasks = listener.totalPendingTasks + listener.totalRunningTasks math.ceil(numRunningOrPendingTasks * executorAllocationRatio / tasksPerExecutorForFullParallelism) .toInt&#125; å…¶ä¸­numRunningOrPendingTasksä¸ºå½“å‰runningå’Œpendingä»»åŠ¡æ•°ä¹‹å’Œã€‚ executorAllocationRatioï¼šæœ€ç†æƒ³çš„æƒ…å†µä¸‹ï¼Œæœ‰å¤šå°‘å¾…æ‰§è¡Œçš„ä»»åŠ¡ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±æ–°å¢å¤šå°‘ä¸ªExecutorï¼Œä»è€Œè¾¾åˆ°æœ€å¤§çš„ä»»åŠ¡å¹¶å‘åº¦ã€‚ä½†æ˜¯è¿™ä¹Ÿæœ‰å‰¯ä½œç”¨ï¼Œå¦‚æœå½“å‰ä»»åŠ¡éƒ½æ˜¯å°ä»»åŠ¡ï¼Œé‚£ä¹ˆè¿™ä¸€ç­–ç•¥å°±ä¼šé€ æˆèµ„æºæµªè´¹ã€‚å¯èƒ½æœ€åç”³è¯·çš„Executorè¿˜æ²¡å¯åŠ¨ï¼Œè¿™äº›å°ä»»åŠ¡å·²ç»è¢«æ‰§è¡Œå®Œäº†ã€‚è¯¥å€¼æ˜¯ä¸€ä¸ªç³»æ•°å€¼ï¼ŒèŒƒå›´[0~1]ã€‚é»˜è®¤1. tasksPerExecutorForFullParallelismï¼šæ¯ä¸ªExecutorçš„æœ€å¤§å¹¶å‘æ•°ï¼Œç®€å•ç†è§£ä¸ºï¼šcpuæ ¸å¿ƒæ•°ï¼ˆspark.executor.coresï¼‰/ æ¯ä¸ªä»»åŠ¡å ç”¨çš„æ ¸å¿ƒæ•°ï¼ˆspark.task.cpusï¼‰ã€‚ é—®é¢˜1ï¼šexecutoråŠ¨æ€è°ƒæ•´çš„èŒƒå›´ï¼Ÿæ— é™å‡å°‘ï¼Ÿæ— é™åˆ¶å¢åŠ ï¼Ÿè°ƒæ•´é€Ÿç‡ï¼Ÿè¦å®ç°èµ„æºçš„åŠ¨æ€è°ƒæ•´ï¼Œé‚£ä¹ˆé™å®šè°ƒæ•´èŒƒå›´æ˜¯æœ€å…ˆè€ƒè™‘çš„äº‹æƒ…ï¼ŒSparké€šè¿‡ä¸‹é¢å‡ ä¸ªå‚æ•°å®ç°ï¼š spark.dynamicAllocation.minExecutorsï¼šExecutorè°ƒæ•´ä¸‹é™ã€‚ï¼ˆé»˜è®¤å€¼ï¼š0ï¼‰ spark.dynamicAllocation.maxExecutorsï¼šExecutorè°ƒæ•´ä¸Šé™ã€‚ï¼ˆé»˜è®¤å€¼ï¼šInteger.MAX_VALUEï¼‰ spark.dynamicAllocation.initialExecutorsï¼šExecutoråˆå§‹æ•°é‡ï¼ˆé»˜è®¤å€¼ï¼šminExecutorsï¼‰ã€‚ ä¸‰è€…çš„å…³ç³»å¿…é¡»æ»¡è¶³ï¼šminExecutors &lt;= initialExecutors &lt;= maxExecutors æ³¨æ„ï¼šå¦‚æœæ˜¾ç¤ºæŒ‡å®šäº†num-executorså‚æ•°ï¼Œé‚£ä¹ˆinitialExecutorså°±æ˜¯num-executoræŒ‡å®šçš„å€¼ã€‚ é—®é¢˜2ï¼šSparkä¸­çš„Executoræ—¢æä¾›è®¡ç®—èƒ½åŠ›ï¼Œä¹Ÿæä¾›å­˜å‚¨èƒ½åŠ›ã€‚è¿™äº›å› è¶…æ—¶è¢«æ€æ­»çš„Executorä¸­æŒä¹…åŒ–çš„æ•°æ®å¦‚ä½•å¤„ç†ï¼Ÿå¦‚æœExecutorä¸­ç¼“å­˜äº†æ•°æ®ï¼Œé‚£ä¹ˆè¯¥Executorçš„Idle-timeoutæ—¶é—´å°±ä¸æ˜¯ç”±executorIdleTimeoutå†³å®šï¼Œè€Œæ˜¯ç”¨spark.dynamicAllocation.cachedExecutorIdleTimeoutæ§åˆ¶ï¼Œé»˜è®¤å€¼ï¼šInteger.MAX_VALUEã€‚å¦‚æœæ‰‹åŠ¨è®¾ç½®äº†è¯¥å€¼ï¼Œå½“è¿™äº›ç¼“å­˜æ•°æ®çš„Executorè¢«killåï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡NodeMananngerçš„External Shuffle Serveræ¥è®¿é—®è¿™äº›æ•°æ®ã€‚è¿™å°±è¦æ±‚NodeManagerä¸­spark.shuffle.service.enabledå¿…é¡»å¼€å¯ã€‚ å¦‚ä½•é…ç½®sparkçš„åŠ¨æ€èµ„æºåˆ’åˆ†ç¬¬ä¸€æ­¥ï¼šä¿®æ”¹yarn-site.xmlé…ç½®æ–‡ä»¶&lt;property&gt; &lt;name&gt;yarn.nodemanager.aux-services&lt;/name&gt; &lt;value&gt;mapreduce_shuffle,spark_shuffle&lt;/value&gt;&lt;/property&gt;&lt;property&gt; &lt;name&gt;yarn.nodemanager.aux-services.spark_shuffle.class&lt;/name&gt; &lt;value&gt;org.apache.spark.network.yarn.YarnShuffleService&lt;/value&gt;&lt;/property&gt;&lt;property&gt; &lt;name&gt;spark.shuffle.service.port&lt;/name&gt; &lt;value&gt;7337&lt;/value&gt;&lt;/property&gt; ç¬¬äºŒæ­¥ï¼šé…ç½®sparkçš„é…ç½®æ–‡ä»¶ä¿®æ”¹spark-confçš„é…ç½®é€‰é¡¹ï¼Œå¼€å¯åŠ¨æ€èµ„æºåˆ’åˆ†ï¼Œæˆ–è€…ç›´æ¥ä¿®æ”¹spark-defaults.confï¼Œå¢åŠ ä»¥ä¸‹å‚æ•°ï¼š spark.shuffle.service.enabled true //å¯ç”¨External shuffle ServiceæœåŠ¡spark.shuffle.service.port 7337 //Shuffle ServiceæœåŠ¡ç«¯å£ï¼Œå¿…é¡»å’Œyarn-siteä¸­çš„ä¸€è‡´spark.dynamicAllocation.enabled true //å¼€å¯åŠ¨æ€èµ„æºåˆ†é…spark.dynamicAllocation.minExecutors 1 //æ¯ä¸ªApplicationæœ€å°åˆ†é…çš„executoræ•°spark.dynamicAllocation.maxExecutors 30 //æ¯ä¸ªApplicationæœ€å¤§å¹¶å‘åˆ†é…çš„executoræ•°spark.dynamicAllocation.schedulerBacklogTimeout 1s spark.dynamicAllocation.sustainedSchedulerBacklogTimeout 5s åŠ¨æ€èµ„æºåˆ†é…ç­–ç•¥ï¼š å¼€å¯åŠ¨æ€åˆ†é…ç­–ç•¥åï¼Œapplicationä¼šåœ¨taskå› æ²¡æœ‰è¶³å¤Ÿèµ„æºè¢«æŒ‚èµ·çš„æ—¶å€™å»åŠ¨æ€ç”³è¯·èµ„æºï¼Œè¿™ç§æƒ…å†µæ„å‘³ç€è¯¥applicationç°æœ‰çš„executoræ— æ³•æ»¡è¶³æ‰€æœ‰taskå¹¶è¡Œè¿è¡Œã€‚sparkä¸€è½®ä¸€è½®çš„ç”³è¯·èµ„æºï¼Œå½“æœ‰taskæŒ‚èµ·æˆ–ç­‰å¾…spark.dynamicAllocation.schedulerBacklogTimeout(é»˜è®¤1s)æ—¶é—´çš„æ—¶å€™ï¼Œä¼šå¼€å§‹åŠ¨æ€èµ„æºåˆ†é…ï¼›ä¹‹åä¼šæ¯éš”spark.dynamicAllocation.sustainedSchedulerBacklogTimeout(é»˜è®¤1s)æ—¶é—´ç”³è¯·ä¸€æ¬¡ï¼Œç›´åˆ°ç”³è¯·åˆ°è¶³å¤Ÿçš„èµ„æºã€‚æ¯æ¬¡ç”³è¯·çš„èµ„æºé‡æ˜¯æŒ‡æ•°å¢é•¿çš„ï¼Œå³1,2,4,8ç­‰ã€‚ä¹‹æ‰€ä»¥é‡‡ç”¨æŒ‡æ•°å¢é•¿ï¼Œå‡ºäºä¸¤æ–¹é¢è€ƒè™‘ï¼šå…¶ä¸€ï¼Œå¼€å§‹ç”³è¯·çš„å°‘æ˜¯è€ƒè™‘åˆ°å¯èƒ½applicationä¼šé©¬ä¸Šå¾—åˆ°æ»¡è¶³ï¼›å…¶æ¬¡è¦æˆå€å¢åŠ ï¼Œæ˜¯ä¸ºäº†é˜²æ­¢applicationéœ€è¦å¾ˆå¤šèµ„æºï¼Œè€Œè¯¥æ–¹å¼å¯ä»¥åœ¨å¾ˆå°‘æ¬¡æ•°çš„ç”³è¯·ä¹‹åå¾—åˆ°æ»¡è¶³ã€‚ åŠ¨æ€èµ„æºå›æ”¶ç­–ç•¥ï¼š å½“applicationçš„executorç©ºé—²æ—¶é—´è¶…è¿‡spark.dynamicAllocation.executorIdleTimeoutï¼ˆé»˜è®¤60sï¼‰åï¼Œå°±ä¼šè¢«å›æ”¶ã€‚","categories":[{"name":"spark","slug":"spark","permalink":"http://iequa.com/categories/spark/"}],"tags":[{"name":"sparkSQL","slug":"sparkSQL","permalink":"http://iequa.com/tags/sparkSQL/"}]},{"title":"ä» Encoder åˆ° Decoder å®ç° Seq2Seq æ¨¡å‹","slug":"tensorflow/tf-seq2seq","date":"2018-10-15T05:10:21.000Z","updated":"2019-10-20T04:30:35.059Z","comments":true,"path":"2018/10/15/tensorflow/tf-seq2seq/","link":"","permalink":"http://iequa.com/2018/10/15/tensorflow/tf-seq2seq/","excerpt":"ç®€å•çš„ Seq2Seq å®ç°ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ TensorFlow æ¥å®ç°ä¸ªåŸºç¡€ç‰ˆçš„ Seq2Seqï¼Œä¸»è¦å¸®åŠ©ç†è§£ Seq2Seq ä¸­çš„åŸºç¡€æ¶æ„ã€‚","text":"ç®€å•çš„ Seq2Seq å®ç°ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ TensorFlow æ¥å®ç°ä¸ªåŸºç¡€ç‰ˆçš„ Seq2Seqï¼Œä¸»è¦å¸®åŠ©ç†è§£ Seq2Seq ä¸­çš„åŸºç¡€æ¶æ„ã€‚ è‡ªå·±åšäº†ä¸€ä¸ªç¤ºæ„å›¾ï¼Œå¸Œæœ›å¸®åŠ©åˆå­¦è€…æ›´å¥½åœ°ç†è§£. Reference æŠ€æœ¯äººå‘˜çš„å‘å±•ä¹‹è·¯ ä» Encoder åˆ° Decoder å®ç° Seq2Seq æ¨¡å‹ zhihu/basic_seq2seq/ éš”å£å°ç‹ LSTM ç¥ç»ç½‘ç»œè¾“å…¥è¾“å‡ºç©¶ç«Ÿæ˜¯æ€æ ·çš„ï¼Ÿ colab.research.google zh.gluon.ai åŠ¨æ‰‹å­¦æ·±åº¦å­¦ä¹  discuss.gluon.ai è®ºå›","categories":[{"name":"tensorflow","slug":"tensorflow","permalink":"http://iequa.com/categories/tensorflow/"}],"tags":[{"name":"tensorflow","slug":"tensorflow","permalink":"http://iequa.com/tags/tensorflow/"}]},{"title":"å¤šå±‚ LSTM é€šä¿—ç‰ˆ","slug":"tensorflow/tf-simple-lstms","date":"2018-10-07T05:10:21.000Z","updated":"2020-07-03T03:34:24.021Z","comments":true,"path":"2018/10/07/tensorflow/tf-simple-lstms/","link":"","permalink":"http://iequa.com/2018/10/07/tensorflow/tf-simple-lstms/","excerpt":"å®˜æ–¹ç»™å‡ºçš„ä¾‹å­ï¼Œç”¨å¤šå±‚ LSTM æ¥å®ç° PTBModel è¯­è¨€æ¨¡å‹ï¼Œæ¯”å¦‚ï¼š tensorflowç¬”è®°ï¼šå¤šå±‚LSTMä»£ç åˆ†æ æ„Ÿè§‰è¿™äº›ä¾‹å­è¿˜æ˜¯å¤ªå¤æ‚äº†ï¼Œæ‰€ä»¥è¿™é‡Œå†™äº†ä¸ªæ¯”è¾ƒç®€å•çš„ç‰ˆæœ¬","text":"å®˜æ–¹ç»™å‡ºçš„ä¾‹å­ï¼Œç”¨å¤šå±‚ LSTM æ¥å®ç° PTBModel è¯­è¨€æ¨¡å‹ï¼Œæ¯”å¦‚ï¼š tensorflowç¬”è®°ï¼šå¤šå±‚LSTMä»£ç åˆ†æ æ„Ÿè§‰è¿™äº›ä¾‹å­è¿˜æ˜¯å¤ªå¤æ‚äº†ï¼Œæ‰€ä»¥è¿™é‡Œå†™äº†ä¸ªæ¯”è¾ƒç®€å•çš„ç‰ˆæœ¬ å£°æ˜ï¼š æœ¬æ–‡éƒ¨åˆ†å†…å®¹è½¬è‡ª æ°¸æ°¸å¤œ Tensorflowå­¦ä¹ ä¹‹è·¯ è‡ªå·±åšäº†ä¸€ä¸ªç¤ºæ„å›¾ï¼Œå¸Œæœ›å¸®åŠ©åˆå­¦è€…æ›´å¥½åœ°ç†è§£ å¤šå±‚RNN. é€šè¿‡æœ¬ä¾‹ï¼Œä½ å¯ä»¥äº†è§£åˆ°å•å±‚ LSTM çš„å®ç°ï¼Œå¤šå±‚ LSTM çš„å®ç°ã€‚è¾“å…¥è¾“å‡ºæ•°æ®çš„æ ¼å¼ã€‚ RNN çš„ dropout layer çš„å®ç°ã€‚ MNIST èƒŒæ™¯å‡†å¤‡æ•°æ® MNIST æ˜¯åœ¨æœºå™¨å­¦ä¹ é¢†åŸŸä¸­çš„ä¸€ä¸ªç»å…¸é—®é¢˜ã€‚è¯¥é—®é¢˜è§£å†³çš„æ˜¯æŠŠ 28x28åƒç´  çš„ç°åº¦æ‰‹å†™æ•°å­—å›¾ç‰‡è¯†åˆ«ä¸ºç›¸åº”çš„æ•°å­—ï¼Œå…¶ä¸­æ•°å­—çš„èŒƒå›´ä» 0åˆ°9. MNIST æ•°æ®é›† åŒ…å«äº† 60000 å¼ å›¾ç‰‡æ¥ä½œä¸ºè®­ç»ƒæ•°æ®ï¼Œ10000 å¼ å›¾ç‰‡ä½œä¸ºæµ‹è¯•æ•°æ®ã€‚æ¯å¼ å›¾ç‰‡éƒ½ä»£è¡¨äº† 0~9 ä¸­çš„ä¸€ä¸ªæ•°å­—ã€‚å›¾ç‰‡å¤§å°éƒ½ä¸º 28*28ï¼Œå¤„ç†åçš„æ¯å¼ å›¾ç‰‡æ˜¯ä¸€ä¸ªé•¿åº¦ä¸º 784 çš„ä¸€ç»´æ•°ç»„ï¼Œè¿™ä¸ªæ•°ç»„ä¸­çš„å…ƒç´ å¯¹åº”å›¾ç‰‡åƒç´ çŸ©é˜µæä¾›ç»™ç¥ç»ç½‘ç»œçš„è¾“å…¥å±‚ï¼Œåƒç´ çŸ©é˜µä¸­å…ƒç´ çš„å–å€¼èŒƒå›´ [0, 1]ï¼Œ å®ƒä»£è¡¨äº†é¢œè‰²çš„æ·±æµ…ã€‚å…¶ä¸­ 0 è¡¨ç¤ºç™½è‰²èƒŒæ™¯(background)ï¼Œ1 è¡¨ç¤ºé»‘è‰²å‰æ™¯(foreground)ã€‚ # -*- coding:utf-8 -*-import tensorflow as tfimport numpy as npfrom tensorflow.contrib import rnnfrom tensorflow.examples.tutorials.mnist import input_data# è®¾ç½® GPU æŒ‰éœ€å¢é•¿config = tf.ConfigProto()config.gpu_options.allow_growth = Truesess = tf.Session(config=config)# é¦–å…ˆå¯¼å…¥æ•°æ®ï¼Œçœ‹ä¸€ä¸‹æ•°æ®çš„å½¢å¼mnist = input_data.read_data_sets(&#x27;MNIST_data&#x27;, one_hot=True)print(mnist.train.images.shape) Extracting MNIST_data/train-images-idx3-ubyte.gzExtracting MNIST_data/train-labels-idx1-ubyte.gzExtracting MNIST_data/t10k-images-idx3-ubyte.gzExtracting MNIST_data/t10k-labels-idx1-ubyte.gz(55000, 784) # è®­ç»ƒé›†å›¾ç‰‡ - 55000 å¼  * 784ç»´ä¸€ç»´æ•°ç»„ æ‰§è¡Œ input_data.read_data_sets åè‡ªåŠ¨åˆ›å»ºä¸€ä¸ªç›®å½• MNIST_dataï¼Œå¹¶å¼€å§‹ä¸‹è½½æ•°æ® (anaconda3)# ~/ghome/github/TensorFlowExamples [master âœ— (98591d9)] [16:15:03]âœ lltotal 24drwxr-xr-x 6 blair staff 192B Oct 9 16:14 MNIST_data-rw-r--r-- 1 blair staff 2.3K Oct 9 16:13 simple-lstms.ipynb(anaconda3)# ~/ghome/github/TensorFlowExamples [master âœ— (98591d9)] [16:15:06]âœ ll MNIST_datatotal 22672-rw-r--r-- 1 blair staff 1.6M Oct 9 16:14 t10k-images-idx3-ubyte.gz-rw-r--r-- 1 blair staff 4.4K Oct 9 16:14 t10k-labels-idx1-ubyte.gz-rw-r--r-- 1 blair staff 9.5M Oct 9 16:14 train-images-idx3-ubyte.gz-rw-r--r-- 1 blair staff 28K Oct 9 16:14 train-labels-idx1-ubyte.gz(anaconda3)# ~/ghome/github/TensorFlowExamples [master âœ— (98591d9)] [16:15:12] æ–‡ä»¶ å†…å®¹ train-images-idx3-ubyte.gz è®­ç»ƒé›†å›¾ç‰‡ - 55000 å¼  è®­ç»ƒå›¾ç‰‡, 5000 å¼  éªŒè¯å›¾ç‰‡ train-labels-idx1-ubyte.gz è®­ç»ƒé›†å›¾ç‰‡å¯¹åº”çš„æ•°å­—æ ‡ç­¾ t10k-images-idx3-ubyte.gz æµ‹è¯•é›†å›¾ç‰‡ - 10000 å¼  å›¾ç‰‡ t10k-labels-idx1-ubyte.gz æµ‹è¯•é›†å›¾ç‰‡å¯¹åº”çš„æ•°å­—æ ‡ç­¾ print(&#x27;training data shape &#x27;, mnist.train.images.shape)print(&#x27;training label shape &#x27;, mnist.train.labels.shape)# training data shape (55000, 784)# training label shape (55000, 10) 1. é¦–å…ˆè®¾ç½®å¥½æ¨¡å‹ç”¨åˆ°çš„å„ä¸ªè¶…å‚æ•°lr = 1e-3 # 0.001# åœ¨è®­ç»ƒå’Œæµ‹è¯•çš„æ—¶å€™ï¼Œæˆ‘ä»¬æƒ³ç”¨ä¸åŒçš„ batch_size.æ‰€ä»¥é‡‡ç”¨å ä½ç¬¦çš„æ–¹å¼batch_size = tf.placeholder(tf.int32, []) # æ³¨æ„ç±»å‹å¿…é¡»ä¸º tf.int32keep_prob = tf.placeholder(tf.float32, [])# æ¯ä¸ªæ—¶åˆ»çš„è¾“å…¥ç‰¹å¾æ˜¯28ç»´çš„ï¼Œå°±æ˜¯æ¯ä¸ªæ—¶åˆ»è¾“å…¥ä¸€è¡Œï¼Œä¸€è¡Œæœ‰ 28 ä¸ªåƒç´ input_size = 28# æ—¶åºæŒç»­é•¿åº¦ä¸º28ï¼Œå³æ¯åšä¸€æ¬¡é¢„æµ‹ï¼Œéœ€è¦å…ˆè¾“å…¥28è¡Œtimestep_size = 28# æ¯ä¸ªéšå«å±‚çš„èŠ‚ç‚¹æ•°hidden_size = 256# LSTM layer çš„å±‚æ•°layer_num = 2# æœ€åè¾“å‡ºåˆ†ç±»ç±»åˆ«æ•°é‡ï¼Œå¦‚æœæ˜¯å›å½’é¢„æµ‹çš„è¯åº”è¯¥æ˜¯ 1class_num = 10_X = tf.placeholder(tf.float32, [None, 784])y = tf.placeholder(tf.float32, [None, class_num]) 2. å¼€å§‹æ­å»º LSTM æ¨¡å‹ï¼Œå…¶å®æ™®é€š RNNs æ¨¡å‹ä¹Ÿä¸€æ ·# æŠŠ784ä¸ªç‚¹çš„å­—ç¬¦ä¿¡æ¯è¿˜åŸæˆ 28 * 28 çš„å›¾ç‰‡# ä¸‹é¢å‡ ä¸ªæ­¥éª¤æ˜¯å®ç° RNN / LSTM çš„å…³é”®#################################################################### tf.reshape(tensor, shape, name=None) å‡½æ•°çš„ä½œç”¨æ˜¯å°† tensor å˜æ¢ä¸ºå‚æ•°shapeçš„å½¢å¼## **æ­¥éª¤1ï¼šRNN çš„è¾“å…¥shape = (batch_size, timestep_size, input_size) X = tf.reshape(_X, [-1, 28, 28]) # **æ­¥éª¤2ï¼šå®šä¹‰ä¸€å±‚ LSTM_cellï¼Œåªéœ€è¦è¯´æ˜ hidden_size, å®ƒä¼šè‡ªåŠ¨åŒ¹é…è¾“å…¥çš„ X çš„ç»´åº¦lstm_cell = rnn.BasicLSTMCell(num_units=hidden_size, forget_bias=1.0, state_is_tuple=True)# **æ­¥éª¤3ï¼šæ·»åŠ  dropout layer, ä¸€èˆ¬åªè®¾ç½® output_keep_problstm_cell = rnn.DropoutWrapper(cell=lstm_cell, input_keep_prob=1.0, output_keep_prob=keep_prob)# **æ­¥éª¤4ï¼šè°ƒç”¨ MultiRNNCell æ¥å®ç°å¤šå±‚ LSTMmlstm_cell = rnn.MultiRNNCell([lstm_cell] * layer_num, state_is_tuple=True)# **æ­¥éª¤5ï¼šç”¨å…¨é›¶æ¥åˆå§‹åŒ–stateinit_state = mlstm_cell.zero_state(batch_size, dtype=tf.float32)# **æ­¥éª¤6ï¼šæ–¹æ³•ä¸€ï¼Œè°ƒç”¨ dynamic_rnn() æ¥è®©æˆ‘ä»¬æ„å»ºå¥½çš„ç½‘ç»œè¿è¡Œèµ·æ¥# ** å½“ time_major==False æ—¶ï¼Œ outputs.shape = [batch_size, timestep_size, hidden_size] # ** æ‰€ä»¥ï¼Œå¯ä»¥å– h_state = outputs[:, -1, :] ä½œä¸ºæœ€åè¾“å‡º# ** state.shape = [layer_num, 2, batch_size, hidden_size], # ** æˆ–è€…ï¼Œå¯ä»¥å– h_state = state[-1][1] ä½œä¸ºæœ€åè¾“å‡º# ** æœ€åè¾“å‡ºç»´åº¦æ˜¯ [batch_size, hidden_size]# outputs, state = tf.nn.dynamic_rnn(mlstm_cell, inputs=X, initial_state=init_state, time_major=False)# h_state = outputs[:, -1, :] # æˆ–è€… h_state = state[-1][1]# *************** ä¸ºäº†æ›´å¥½çš„ç†è§£ LSTM å·¥ä½œåŸç†ï¼Œæˆ‘ä»¬æŠŠä¸Šé¢ æ­¥éª¤6 ä¸­çš„å‡½æ•°è‡ªå·±æ¥å®ç° ***************# é€šè¿‡æŸ¥çœ‹æ–‡æ¡£ä½ ä¼šå‘ç°ï¼Œ RNNCell éƒ½æä¾›äº†ä¸€ä¸ª __call__()å‡½æ•°ï¼ˆè§æœ€åé™„ï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨å®ƒæ¥å±•å¼€å®ç°LSTMæŒ‰æ—¶é—´æ­¥è¿­ä»£ã€‚# **æ­¥éª¤6ï¼šæ–¹æ³•äºŒï¼ŒæŒ‰æ—¶é—´æ­¥å±•å¼€è®¡ç®— (æš‚æ—¶æ²¡æœ‰è¿è¡Œé€šè¿‡)outputs = list()state = init_statewith tf.variable_scope(&#x27;RNN&#x27;): for timestep in range(timestep_size): if timestep &gt; 0: tf.get_variable_scope().reuse_variables() # è¿™é‡Œçš„stateä¿å­˜äº†æ¯ä¸€å±‚ LSTM çš„çŠ¶æ€ (cell_output, state) = mlstm_cell(X[:, timestep, :], state) outputs.append(cell_output)h_state = outputs[-1]# X[:, timestep, :] å°±æ˜¯å–ç¬¬timestepä¸ªæ—¶åˆ»çš„ç‰¹å¾ x_t è¾“å…¥ mlstm_cell ä¸­è®¡ç®—ï¼Œå› ä¸ºæ¯æ¬¡ç”¨ batch_size ä¸ªæ ·æœ¬æ¥è®­ç»ƒï¼Œæ‰€ä»¥ç›¸å½“äºï¼ˆå¹¶è¡Œï¼‰è¾“å…¥ batch_size ä¸ª x_t åˆ° mlstm_cell ä¸­è®¡ç®—ã€‚ 3. è®¾ç½® loss function å’Œ ä¼˜åŒ–å™¨ï¼Œå±•å¼€è®­ç»ƒå¹¶å®Œæˆæµ‹è¯•# ä¸Šé¢ LSTM éƒ¨åˆ†çš„è¾“å‡ºä¼šæ˜¯ä¸€ä¸ª [hidden_size] çš„ tensorï¼Œæˆ‘ä»¬è¦åˆ†ç±»çš„è¯ï¼Œè¿˜éœ€è¦æ¥ä¸€ä¸ª softmax å±‚# é¦–å…ˆå®šä¹‰ softmax çš„è¿æ¥æƒé‡çŸ©é˜µå’Œåç½®# out_W = tf.placeholder(tf.float32, [hidden_size, class_num], name=&#x27;out_Weights&#x27;)# out_bias = tf.placeholder(tf.float32, [class_num], name=&#x27;out_bias&#x27;)# å¼€å§‹è®­ç»ƒå’Œæµ‹è¯•W = tf.Variable(tf.truncated_normal([hidden_size, class_num], stddev=0.1), dtype=tf.float32)bias = tf.Variable(tf.constant(0.1,shape=[class_num]), dtype=tf.float32)y_pre = tf.nn.softmax(tf.matmul(h_state, W) + bias)# æŸå¤±å’Œè¯„ä¼°å‡½æ•°cross_entropy = -tf.reduce_mean(y * tf.log(y_pre))train_op = tf.train.AdamOptimizer(lr).minimize(cross_entropy)correct_prediction = tf.equal(tf.argmax(y_pre,1), tf.argmax(y,1))accuracy = tf.reduce_mean(tf.cast(correct_prediction, &quot;float&quot;))sess.run(tf.global_variables_initializer())for i in range(2000): _batch_size = 128 batch = mnist.train.next_batch(_batch_size) sess.run(train_op, feed_dict=&#123;_X: batch[0], y: batch[1], keep_prob: 0.5, batch_size: _batch_size&#125;) if (i+1)%200 == 0: train_accuracy = sess.run(accuracy, feed_dict=&#123; _X:batch[0], y: batch[1], keep_prob: 1.0, batch_size: _batch_size&#125;) # å·²ç»è¿­ä»£å®Œæˆçš„ epoch æ•°: mnist.train.epochs_completed print &quot;Iter%d, step %d, training accuracy %g&quot; % ( mnist.train.epochs_completed, (i+1), train_accuracy) # è®¡ç®—æµ‹è¯•æ•°æ®çš„å‡†ç¡®ç‡print &quot;test accuracy %g&quot;% sess.run(accuracy, feed_dict=&#123; _X: mnist.test.images, y: mnist.test.labels, keep_prob: 1.0, batch_size:mnist.test.images.shape[0]&#125;) Iter0, step 200, training accuracy 0.851562Iter0, step 400, training accuracy 0.960938Iter1, step 600, training accuracy 0.984375Iter1, step 800, training accuracy 0.960938Iter2, step 1000, training accuracy 0.984375Iter2, step 1200, training accuracy 0.9375Iter3, step 1400, training accuracy 0.96875Iter3, step 1600, training accuracy 0.984375Iter4, step 1800, training accuracy 0.992188Iter4, step 2000, training accuracy 0.984375test accuracy 0.9858 æˆ‘ä»¬ä¸€å…±åªè¿­ä»£ä¸åˆ° 5 ä¸ª epochï¼Œåœ¨æµ‹è¯•é›†ä¸Šå°±å·²ç»è¾¾åˆ°äº† 0.98 çš„å‡†ç¡®ç‡ï¼Œå¯ä»¥çœ‹å‡ºæ¥ LSTM åœ¨åšè¿™ä¸ªå­—ç¬¦åˆ†ç±»çš„ä»»åŠ¡ä¸Šè¿˜æ˜¯æ¯”è¾ƒæœ‰æ•ˆçš„ï¼Œè€Œä¸”æˆ‘ä»¬æœ€åä¸€æ¬¡æ€§å¯¹ 10000 å¼ æµ‹è¯•å›¾ç‰‡è¿›è¡Œé¢„æµ‹ï¼Œæ‰å äº† 725 MiB çš„æ˜¾å­˜ã€‚è€Œæˆ‘ä»¬åœ¨ä¹‹å‰çš„ä¸¤å±‚ CNNs ç½‘ç»œä¸­ï¼Œé¢„æµ‹ 10000 å¼ å›¾ç‰‡ä¸€å…±ç”¨äº† 8721 MiB çš„æ˜¾å­˜ï¼Œå·®äº†æ•´æ•´ 12 å€å‘€ï¼ï¼ è¿™ä¸»è¦æ˜¯å› ä¸º RNN/LSTM ç½‘ç»œä¸­ï¼Œæ¯ä¸ªæ—¶é—´æ­¥æ‰€ç”¨çš„æƒå€¼çŸ©é˜µéƒ½æ˜¯å…±äº«çš„ï¼Œå¯ä»¥é€šè¿‡å‰é¢ä»‹ç»çš„ LSTM çš„ç½‘ç»œç»“æ„åˆ†æä¸€ä¸‹ï¼Œæ•´ä¸ªç½‘ç»œçš„å‚æ•°éå¸¸å°‘ã€‚ Reference å¤§å­¦ä¹‹é“ï¼Œåœ¨æ˜æ˜å¾· æ°¸æ°¸å¤œ Tensorflowå­¦ä¹ ä¹‹è·¯ tensorflowç¬”è®°ï¼šå¤šå±‚LSTMä»£ç åˆ†æ æå®¢å­¦é™¢ MNIST æ•°æ®ä¸‹è½½ éš”å£å°ç‹ LSTM ç¥ç»ç½‘ç»œè¾“å…¥è¾“å‡ºç©¶ç«Ÿæ˜¯æ€æ ·çš„ï¼Ÿ colab.research.google zh.gluon.ai åŠ¨æ‰‹å­¦æ·±åº¦å­¦ä¹  discuss.gluon.ai è®ºå› roll_jjï¼š åšä¸»ä½ å¥½ï¼Œ outputs, state = tf.nn.dynamic_rnn(mlstm_cell, inputs=X, initial_state=init_state, time_major=False) h_state = outputs[:, -1, :] è¿™ä¸¤å¥è¯é‡Œï¼Œoutputsçš„ä¸‰ä¸ªç»´åº¦æ˜¯ä»€ä¹ˆæ„æ€ï¼Œä¸ºä»€ä¹ˆæŠŠä¸­é—´é‚£ä¸ªç»´åº¦å»æ‰å°±æ˜¯æˆ‘ä»¬è¦çš„è¾“å‡ºç»“æœäº†ï¼Ÿ(1å¹´å‰#6æ¥¼)æ”¶èµ·å›å¤ä¸¾æŠ¥å›å¤Jerr__yCQU_HYXå›å¤ roll_jjï¼š æ˜¯çš„(1å¹´å‰)roll_jjroll_jjå›å¤ CQU_HYXï¼š è°¢è°¢åšä¸»è§£ç­”ã€‚æˆ‘çœ‹å®˜æ–¹çš„é‚£ä¸ªPTBä¾‹å­é‡Œï¼Œæ²¡æœ‰å–[-1]çš„è¿™ä¸ªæ“ä½œï¼Œè€Œæ˜¯ç”¨äº†output = tf.reshape(tf.concat(1, outputs), [-1, size])æ“ä½œï¼Œè¿™æ˜¯å› ä¸ºé¢„æµ‹ç›®æ ‡çš„ä¸åŒä¹ˆï¼Ÿ(1å¹´å‰)Jerr__yCQU_HYXå›å¤ roll_jjï¼š åŸæ–‡æ³¨é‡Šä¸Šé¢æœ‰è¯´äº†ï¼Œoutputs.shape = [batch_size, timestep_size, hidden_size]ã€‚ å› ä¸ºæ˜¯åˆ†ç±»é—®é¢˜ï¼Œæ‰€æœ‰åªéœ€è¦åœ¨çœ‹å®Œæœ€åä¸€è¡Œåƒç´ åæ‰è¾“å‡ºåˆ†ç±»ç»“æœã€‚-1 è¡¨ç¤ºå–æœ€åä¸€ä¸ª timestep çš„ç»“æœï¼Œ è€Œä¸æ˜¯è¯´æŠŠä¸­é—´ç»´åº¦å»æ‰","categories":[{"name":"tensorflow","slug":"tensorflow","permalink":"http://iequa.com/categories/tensorflow/"}],"tags":[{"name":"tensorflow","slug":"tensorflow","permalink":"http://iequa.com/tags/tensorflow/"}]},{"title":"(è½¬) ç†è§£ LSTM ç½‘ç»œ ï¼ˆUnderstanding LSTM Networks by colahï¼‰","slug":"tensorflow/tf-Understanding-LSTMs","date":"2018-10-06T08:10:21.000Z","updated":"2020-07-03T03:34:29.375Z","comments":true,"path":"2018/10/06/tensorflow/tf-Understanding-LSTMs/","link":"","permalink":"http://iequa.com/2018/10/06/tensorflow/tf-Understanding-LSTMs/","excerpt":"åŸæ–‡é“¾æ¥1ï¼š Understanding LSTM NetworksåŸæ–‡é“¾æ¥2ï¼š ç†è§£ LSTM ç½‘ç»œ @ç¿»è¯‘ï¼šhuangyongye","text":"åŸæ–‡é“¾æ¥1ï¼š Understanding LSTM NetworksåŸæ–‡é“¾æ¥2ï¼š ç†è§£ LSTM ç½‘ç»œ @ç¿»è¯‘ï¼šhuangyongye Reference å¤§å­¦ä¹‹é“ï¼Œåœ¨æ˜æ˜å¾· æ°¸æ°¸å¤œ Tensorflowå­¦ä¹ ä¹‹è·¯ Understanding LSTM Networks å¤§å­¦ä¹‹é“ï¼Œåœ¨æ˜æ˜å¾· æ°¸æ°¸å¤œ ç†è§£ LSTM ç½‘ç»œ ï¼ˆUnderstanding LSTM Networks by colahï¼‰","categories":[{"name":"tensorflow","slug":"tensorflow","permalink":"http://iequa.com/categories/tensorflow/"}],"tags":[{"name":"tensorflow","slug":"tensorflow","permalink":"http://iequa.com/tags/tensorflow/"}]},{"title":"TensorFlow å‘½åæ–¹æ³• name_scope / variable_scope","slug":"tensorflow/tf-4.3-name-variable_scope","date":"2018-10-05T04:10:21.000Z","updated":"2020-07-03T03:32:11.907Z","comments":true,"path":"2018/10/05/tensorflow/tf-4.3-name-variable_scope/","link":"","permalink":"http://iequa.com/2018/10/05/tensorflow/tf-4.3-name-variable_scope/","excerpt":"æœ¬ä¾‹ä¸»è¦ä»‹ç» name_scope å’Œ variable_scope çš„æ­£ç¡®ä½¿ç”¨æ–¹å¼ï¼Œå­¦ä¹ å¹¶ç†è§£æœ¬ä¾‹ä¹‹åï¼Œä½ å°±èƒ½å¤ŸçœŸæ­£è¯»æ‡‚ TensorFlow çš„å¾ˆå¤šä»£ç å¹¶èƒ½å¤Ÿæ¸…æ™°åœ°ç†è§£æ¨¡å‹ç»“æ„äº†.","text":"æœ¬ä¾‹ä¸»è¦ä»‹ç» name_scope å’Œ variable_scope çš„æ­£ç¡®ä½¿ç”¨æ–¹å¼ï¼Œå­¦ä¹ å¹¶ç†è§£æœ¬ä¾‹ä¹‹åï¼Œä½ å°±èƒ½å¤ŸçœŸæ­£è¯»æ‡‚ TensorFlow çš„å¾ˆå¤šä»£ç å¹¶èƒ½å¤Ÿæ¸…æ™°åœ°ç†è§£æ¨¡å‹ç»“æ„äº†. scope èƒ½è®©ä½ å‘½åå˜é‡çš„æ—¶å€™è½»æ¾å¾ˆå¤š. åŒæ—¶ä¹Ÿä¼šåœ¨ reusing variable ä»£ç ä¸­å¸¸å¸¸è§åˆ°. æ‰€ä»¥ä»Šå¤©æˆ‘ä»¬ä¼šæ¥è®¨è®ºä¸‹ tensorflow å½“ä¸­çš„ä¸¤ç§å®šä¹‰ scope çš„æ–¹å¼. æœ€åå¹¶é™„åŠ ä¸€ä¸ª RNN è¿ç”¨ reuse variable çš„ä¾‹å­. åœ¨ TensorFlow ä¸­ï¼Œç»å¸¸çœ‹åˆ° name_scope å’Œ variable_scope ä¸¤ä¸ªä¸œä¸œï¼Œè¿™åˆ°åº•æ˜¯ä»€ä¹ˆé¬¼ï¼Œåˆ°åº•ç³»åšå’©å™¶!!! åœ¨åš LSTM çš„æ—¶å€™é‡åˆ°äº†ä¸‹é¢çš„é”™è¯¯ï¼š ValueError: Variable rnn/basic_lstm_cell/weights already exists, disallowed. 1. å…ˆè¯´ç»“è®ºè¦ç†è§£ name_scope å’Œ variable_scopeï¼Œ é¦–å…ˆå¿…é¡»æ˜ç¡®äºŒè€…çš„ä½¿ç”¨ç›®çš„ã€‚æˆ‘ä»¬éƒ½çŸ¥é“ï¼Œå’Œæ™®é€šæ¨¡å‹ç›¸æ¯”ï¼Œç¥ç»ç½‘ç»œçš„èŠ‚ç‚¹éå¸¸å¤šï¼ŒèŠ‚ç‚¹èŠ‚ç‚¹ä¹‹é—´çš„è¿æ¥ï¼ˆæƒå€¼çŸ©é˜µï¼‰ä¹Ÿéå¸¸å¤šã€‚æ‰€ä»¥æˆ‘ä»¬è´¹å°½å¿ƒæ€ï¼Œå‡†å¤‡æ­å»ºä¸€ä¸ªç½‘ç»œï¼Œç„¶åæœ‰äº†å›¾1çš„ç½‘ç»œï¼ŒWTF! å› ä¸ºå˜é‡å¤ªå¤šï¼Œæˆ‘ä»¬æ„é€ å®Œç½‘ç»œä¹‹åï¼Œä¸€çœ‹ï¼Œä»€ä¹ˆé¬¼ï¼Œè¿™ä¸ªå˜é‡åˆ°åº•æ˜¯å“ªå±‚çš„ï¼Ÿï¼Ÿ ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å¼•å…¥äº† name_scope å’Œ variable_scopeï¼Œ äºŒè€…åˆåˆ†åˆ«æ‰¿æ‹…ç€ä¸åŒçš„è´£ä»»ï¼š name_scope: ä¸ºäº†æ›´å¥½åœ°ç®¡ç†å˜é‡çš„å‘½åç©ºé—´è€Œæå‡ºçš„ã€‚æ¯”å¦‚åœ¨ tensorboard ä¸­ï¼Œå› ä¸ºå¼•å…¥äº† name_scopeï¼Œ æˆ‘ä»¬çš„ Graph çœ‹èµ·æ¥æ‰äº•ç„¶æœ‰åºã€‚ variable_scope: å¤§å¤§å¤§éƒ¨åˆ†æƒ…å†µä¸‹ï¼Œè·Ÿ tf.get_variable() é…åˆä½¿ç”¨ï¼Œå®ç°å˜é‡å…±äº«çš„åŠŸèƒ½ã€‚ ä¸‹é¢é€šè¿‡ä¸¤ç»„å®éªŒæ¥æ¢ç´¢ TensorFlow çš„å‘½åæœºåˆ¶ã€‚ 2. name_scope/variable_scope å®éªŒ ğŸŒ°å®éªŒ 1 ä¸‰ç§æ–¹å¼åˆ›å»ºå˜é‡ï¼š ä¸‰ç§æ–¹å¼åˆ›å»ºå˜é‡ï¼š tf.placeholder, tf.Variable, tf.get_variable import tensorflow as tf# è®¾ç½®GPUæŒ‰éœ€å¢é•¿config = tf.ConfigProto()config.gpu_options.allow_growth = Truesess = tf.Session(config=config) 2.1 placeholder# 1.placeholder v1 = tf.placeholder(tf.float32, shape=[2,3,4])print(v1.name)v1 = tf.placeholder(tf.float32, shape=[2,3,4], name=&#x27;ph&#x27;)print(v1.name)v1 = tf.placeholder(tf.float32, shape=[2,3,4], name=&#x27;ph&#x27;)print(v1.name)print(type(v1))print(v1) Placeholder:0ph:0ph_1:0&lt;class &#x27;tensorflow.python.framework.ops.Tensor&#x27;&gt;Tensor(&quot;ph_1:0&quot;, shape=(2, 3, 4), dtype=float32) 2.2 tf.Variable()# 2. tf.Variable()v2 = tf.Variable([1,2], dtype=tf.float32)print(v2.name)v2 = tf.Variable([1,2], dtype=tf.float32, name=&#x27;V&#x27;)print(v2.name)v2 = tf.Variable([1,2], dtype=tf.float32, name=&#x27;V&#x27;)print(v2.name)print(type(v2))print(v2) Variable:0V:0V_1:0&lt;class &#x27;tensorflow.python.ops.variables.Variable&#x27;&gt;Tensor(&quot;V_1/read:0&quot;, shape=(2,), dtype=float32) 2.3 tf.get_variable()# 3.tf.get_variable() åˆ›å»ºå˜é‡çš„æ—¶å€™å¿…é¡»è¦æä¾› namev3 = tf.get_variable(name=&#x27;gv&#x27;, shape=[]) print(v3.name)v4 = tf.get_variable(name=&#x27;gv&#x27;, shape=[2])print(v4.name) gv:0---------------------------------------------------------------------------ValueError Traceback (most recent call last)&lt;ipython-input-7-29efaac2d76c&gt; in &lt;module&gt;() 2 v3 = tf.get_variable(name=&#x27;gv&#x27;, shape=[]) 3 print(v3.name)----&gt; 4 v4 = tf.get_variable(name=&#x27;gv&#x27;, shape=[2]) 5 print(v4.name)æ­¤å¤„è¿˜æœ‰ä¸€å †é”™è¯¯ä¿¡æ¯ã€‚ã€‚ã€‚ValueError: Variable gv already exists, disallowed. Did you mean to set reuse=True in VarScope? Originally defined at:... print(type(v3))print(v3) &lt;class &#x27;tensorflow.python.ops.variables.Variable&#x27;&gt;Tensor(&quot;gv/read:0&quot;, shape=(), dtype=float32) è¿˜è®°å¾—æœ‰è¿™ä¹ˆä¸ªå‡½æ•°å—ï¼Ÿ tf.trainable_variables(), å®ƒèƒ½å¤Ÿå°†æˆ‘ä»¬å®šä¹‰çš„æ‰€æœ‰çš„ trainable=True çš„æ‰€æœ‰å˜é‡ä»¥ä¸€ä¸ª list çš„å½¢å¼è¿”å›ã€‚ very good, ç°åœ¨è¦æ´¾ä¸Šç”¨åœºäº†ã€‚ vs = tf.trainable_variables()print(len(vs))for v in vs: print(v) 4Tensor(&quot;Variable/read:0&quot;, shape=(2,), dtype=float32)Tensor(&quot;V/read:0&quot;, shape=(2,), dtype=float32)Tensor(&quot;V_1/read:0&quot;, shape=(2,), dtype=float32)Tensor(&quot;gv/read:0&quot;, shape=(), dtype=float32) å®éªŒ1 ç»“è®º: ä»ä¸Šé¢çš„å®éªŒç»“æœæ¥çœ‹ï¼Œè¿™ä¸‰ç§æ–¹å¼æ‰€å®šä¹‰çš„å˜é‡å…·æœ‰ç›¸åŒçš„ç±»å‹ã€‚ åªæœ‰ tf.get_variable() åˆ›å»ºçš„å˜é‡ä¹‹é—´ä¼šå‘ç”Ÿ å‘½åå†²çªã€‚åœ¨å®é™…ä½¿ç”¨ä¸­ï¼Œä¸‰ç§åˆ›å»ºå˜é‡æ–¹å¼çš„ç”¨é€”åˆ†å·¥éå¸¸æ˜ç¡®ã€‚ tf.placeholder() å ä½ç¬¦ã€‚ trainable==False tf.Variable() ä¸€èˆ¬å˜é‡ç”¨è¿™ç§æ–¹å¼å®šä¹‰ã€‚ å¯ä»¥é€‰æ‹© trainable ç±»å‹ tf.get_variable() ä¸€èˆ¬éƒ½æ˜¯å’Œ tf.variable_scope() é…åˆä½¿ç”¨ï¼Œä»è€Œå®ç°å˜é‡å…±äº«çš„åŠŸèƒ½ã€‚ å¯ä»¥é€‰æ‹© trainable ç±»å‹ 3. æ¢ç´¢ name_scope å’Œ variable_scopeå®éªŒç›®çš„ï¼š ç†Ÿæ‚‰ä¸¤ç§å‘½åç©ºé—´çš„åº”ç”¨æƒ…æ™¯ 3.1 tf.name_scope()with tf.name_scope(&#x27;nsc1&#x27;): v1 = tf.Variable([1], name=&#x27;v1&#x27;) with tf.variable_scope(&#x27;vsc1&#x27;): v2 = tf.Variable([1], name=&#x27;v2&#x27;) v3 = tf.get_variable(name=&#x27;v3&#x27;, shape=[])print(&#x27;v1.name: &#x27;, v1.name)print(&#x27;v2.name: &#x27;, v2.name)print(&#x27;v3.name: &#x27;, v3.name) v1.name: nsc1/v1:0v2.name: nsc1/vsc1/v2:0v3.name: vsc1/v3:0 with tf.name_scope(&#x27;nsc1&#x27;): v4 = tf.Variable([1], name=&#x27;v4&#x27;)print(&#x27;v4.name: &#x27;, v4.name) # v4.name: nsc1_1/v4:0 tf.name_scope() å¹¶ä¸ä¼šå¯¹ tf.get_variable() åˆ›å»ºçš„å˜é‡æœ‰ä»»ä½•å½±å“ã€‚ tf.name_scope() ä¸»è¦æ˜¯ç”¨æ¥ç®¡ç†å‘½åç©ºé—´çš„ï¼Œè¿™æ ·å­è®©æˆ‘ä»¬çš„æ•´ä¸ªæ¨¡å‹æ›´åŠ æœ‰æ¡ç†ã€‚ tf.variable_scope() çš„ä½œç”¨æ˜¯ä¸ºäº†å®ç°å˜é‡å…±äº«ï¼Œå®ƒå’Œ tf.get_variable() æ¥å®Œæˆå˜é‡å…±äº«çš„åŠŸèƒ½ã€‚ 3.2 tf.variable_scope()å¦‚æœæƒ³è¦è¾¾åˆ°é‡å¤åˆ©ç”¨å˜é‡çš„æ•ˆæœ, æˆ‘ä»¬å°±è¦ä½¿ç”¨ tf.variable_scope(), å¹¶æ­é… tf.get_variable() è¿™ç§æ–¹å¼äº§ç”Ÿå’Œæå–å˜é‡. ä¸åƒ tf.Variable() æ¯æ¬¡éƒ½ä¼šäº§ç”Ÿæ–°çš„å˜é‡, tf.get_variable() å¦‚æœé‡åˆ°äº†åŒæ ·åå­—çš„å˜é‡æ—¶, å®ƒä¼šå•çº¯çš„æå–è¿™ä¸ªåŒæ ·åå­—çš„å˜é‡(é¿å…äº§ç”Ÿæ–°å˜é‡). è€Œåœ¨é‡å¤ä½¿ç”¨çš„æ—¶å€™, ä¸€å®šè¦åœ¨ä»£ç ä¸­å¼ºè°ƒ scope.reuse_variables(), å¦åˆ™ç³»ç»Ÿå°†ä¼šæŠ¥é”™, ä»¥ä¸ºä½ åªæ˜¯å•çº¯çš„ä¸å°å¿ƒé‡å¤ä½¿ç”¨åˆ°äº†ä¸€ä¸ªå˜é‡. with tf.variable_scope(&quot;a_variable_scope&quot;) as scope: initializer = tf.constant_initializer(value=3) var3 = tf.get_variable(name=&#x27;var3&#x27;, shape=[1], dtype=tf.float32, initializer=initializer) scope.reuse_variables() var3_reuse = tf.get_variable(name=&#x27;var3&#x27;,) var4 = tf.Variable(name=&#x27;var4&#x27;, initial_value=[4], dtype=tf.float32) var4_reuse = tf.Variable(name=&#x27;var4&#x27;, initial_value=[4], dtype=tf.float32) with tf.Session() as sess: sess.run(tf.global_variables_initializer()) print(var3.name) # a_variable_scope/var3:0 print(sess.run(var3)) # [ 3.] print(var3_reuse.name) # a_variable_scope/var3:0 print(sess.run(var3_reuse)) # [ 3.] print(var4.name) # a_variable_scope/var4:0 print(sess.run(var4)) # [ 4.] print(var4_reuse.name) # a_variable_scope/var4_1:0 print(sess.run(var4_reuse)) # [ 4.] é¦–å…ˆæˆ‘ä»¬è¦ç¡®ç«‹ä¸€ç§ Graph çš„æ€æƒ³ã€‚åœ¨ TensorFlow ä¸­ï¼Œæˆ‘ä»¬å®šä¹‰ä¸€ä¸ªå˜é‡ï¼Œç›¸å½“äºå¾€ Graph ä¸­æ·»åŠ äº†ä¸€ä¸ªèŠ‚ç‚¹ã€‚å’Œæ™®é€šçš„ python å‡½æ•°ä¸ä¸€æ ·ï¼Œåœ¨ä¸€èˆ¬çš„å‡½æ•°ä¸­ï¼Œæˆ‘ä»¬å¯¹è¾“å…¥è¿›è¡Œå¤„ç†ï¼Œç„¶åè¿”å›ä¸€ä¸ªç»“æœï¼Œè€Œå‡½æ•°é‡Œè¾¹å®šä¹‰çš„ä¸€äº›å±€éƒ¨å˜é‡æˆ‘ä»¬å°±ä¸ç®¡äº†ã€‚ä½†æ˜¯åœ¨ TensorFlow ä¸­ï¼Œæˆ‘ä»¬åœ¨å‡½æ•°é‡Œè¾¹åˆ›å»ºäº†ä¸€ä¸ªå˜é‡ï¼Œå°±æ˜¯å¾€ Graph ä¸­æ·»åŠ äº†ä¸€ä¸ªèŠ‚ç‚¹ã€‚å‡ºäº†è¿™ä¸ªå‡½æ•°åï¼Œè¿™ä¸ªèŠ‚ç‚¹è¿˜æ˜¯å­˜åœ¨äº Graph ä¸­çš„ã€‚ 4. RNN åº”ç”¨ä¾‹å­æ•´ä¸ª RNN çš„ç»“æ„å·²ç»åœ¨è¿™é‡Œå®šä¹‰å¥½äº†. åœ¨ training RNN å’Œ test RNN çš„æ—¶å€™, RNN çš„ time_steps ä¼šæœ‰ä¸åŒçš„å–å€¼, è¿™å°†ä¼šå½±å“åˆ°æ•´ä¸ª RNN çš„ç»“æ„, æ‰€ä»¥å¯¼è‡´åœ¨ test çš„æ—¶å€™, ä¸èƒ½å•çº¯åœ°ä½¿ç”¨ training æ—¶å»ºç«‹çš„é‚£ä¸ª RNN. ä½†æ˜¯ training RNN å’Œ test RNN åˆå¿…é¡»æ˜¯æœ‰åŒæ ·çš„ weights biases çš„å‚æ•°. æ‰€ä»¥, è¿™æ—¶, å°±æ˜¯ä½¿ç”¨ reuse variable çš„å¥½æ—¶æœº. é¦–å…ˆå®šä¹‰ training å’Œ test çš„ä¸åŒå‚æ•°. class TrainConfig: batch_size = 20 time_steps = 20 input_size = 10 output_size = 2 cell_size = 11 learning_rate = 0.01class TestConfig(TrainConfig): time_steps = 1 train_config = TrainConfig()test_config = TestConfig() ç„¶åè®© train_rnn å’Œ test_rnn åœ¨åŒä¸€ä¸ª tf.variable_scope(&#39;rnn&#39;) ä¹‹ä¸‹. å¹¶ä¸”å®šä¹‰ scope.reuse_variables(), ä½¿æˆ‘ä»¬èƒ½æŠŠ train_rnn çš„æ‰€æœ‰ weights, biases å‚æ•°å…¨éƒ¨ç»‘å®šåˆ° test_rnn ä¸­. è¿™æ ·, ä¸ç®¡ä¸¤è€…çš„ time_steps æœ‰å¤šä¸åŒ, ç»“æ„æœ‰å¤šä¸åŒ, train_rnn W, b å‚æ•°æ›´æ–°æˆä»€ä¹ˆæ ·, test_rnn çš„å‚æ•°ä¹Ÿæ›´æ–°æˆä»€ä¹ˆæ ·. with tf.variable_scope(&#x27;rnn&#x27;) as scope: sess = tf.Session() train_rnn = RNN(train_config) scope.reuse_variables() test_rnn = RNN(test_config) sess.run(tf.global_variables_initializer()) Reference å¤§å­¦ä¹‹é“ï¼Œåœ¨æ˜æ˜å¾· æ°¸æ°¸å¤œ Tensorflowå­¦ä¹ ä¹‹è·¯ morvanzhou, scope å‘½åæ–¹æ³•","categories":[{"name":"tensorflow","slug":"tensorflow","permalink":"http://iequa.com/categories/tensorflow/"}],"tags":[{"name":"tensorflow","slug":"tensorflow","permalink":"http://iequa.com/tags/tensorflow/"}]},{"title":"ç®€å•å‰é¦ˆç½‘ç»œå®ç° mnist åˆ†ç±»","slug":"tensorflow/tf-mnist-1-beginners","date":"2018-10-04T13:10:21.000Z","updated":"2019-10-20T04:30:35.053Z","comments":true,"path":"2018/10/04/tensorflow/tf-mnist-1-beginners/","link":"","permalink":"http://iequa.com/2018/10/04/tensorflow/tf-mnist-1-beginners/","excerpt":"æˆ‘ä»¬æ¥å®ç°ä¸€ä¸ªéå¸¸ç®€å•çš„ä¸¤å±‚ FC å…¨è¿æ¥ç½‘ç»œæ¥å®Œæˆ MNISTæ•°æ® çš„åˆ†ç±»","text":"æˆ‘ä»¬æ¥å®ç°ä¸€ä¸ªéå¸¸ç®€å•çš„ä¸¤å±‚ FC å…¨è¿æ¥ç½‘ç»œæ¥å®Œæˆ MNISTæ•°æ® çš„åˆ†ç±» è¾“å…¥ [-1,28*28]ï¼Œ FC1 æœ‰ 1024 ä¸ªneuronsï¼Œ FC2 æœ‰ 10 ä¸ªneuronsã€‚ è¿™ä¹ˆç®€å•çš„ä¸€ä¸ªå…¨è¿æ¥ç½‘ç»œï¼Œç»“æœæµ‹è¯•å‡†ç¡®ç‡è¾¾åˆ°äº† 0.98ã€‚è¿˜æ˜¯éå¸¸æ£’çš„ï¼ï¼ï¼ MNIST æ•°æ®é›† åŒ…å«äº† 60000 å¼ å›¾ç‰‡æ¥ä½œä¸ºè®­ç»ƒæ•°æ®ï¼Œ10000 å¼ å›¾ç‰‡ä½œä¸ºæµ‹è¯•æ•°æ®ã€‚æ¯å¼ å›¾ç‰‡éƒ½ä»£è¡¨äº† 0~9 ä¸­çš„ä¸€ä¸ªæ•°å­—ã€‚å›¾ç‰‡å¤§å°éƒ½ä¸º 28*28ï¼Œå¤„ç†åçš„æ¯å¼ å›¾ç‰‡æ˜¯ä¸€ä¸ªé•¿åº¦ä¸º 784 çš„ä¸€ç»´æ•°ç»„ï¼Œè¿™ä¸ªæ•°ç»„ä¸­çš„å…ƒç´ å¯¹åº”å›¾ç‰‡åƒç´ çŸ©é˜µæä¾›ç»™ç¥ç»ç½‘ç»œçš„è¾“å…¥å±‚ï¼Œåƒç´ çŸ©é˜µä¸­å…ƒç´ çš„å–å€¼èŒƒå›´ [0, 1]ï¼Œ å®ƒä»£è¡¨äº†é¢œè‰²çš„æ·±æµ…ã€‚å…¶ä¸­ 0 è¡¨ç¤ºç™½è‰²èƒŒæ™¯(background)ï¼Œ1 è¡¨ç¤ºé»‘è‰²å‰æ™¯(foreground)ã€‚ ä¸ºäº†æ–¹ä¾¿ä½¿ç”¨éšæœºæ¢¯åº¦ä¸‹é™ï¼Œ input_data.read_data_sets å‡½æ•°ç”Ÿæˆçš„ç±»è¿˜æä¾›äº† mnist.train.next.batch å‡½æ•°ï¼Œå®ƒå¯ä»¥ä»æ‰€æœ‰è®­ç»ƒæ•°æ®ä¸­è¯»å–ä¸€å°éƒ¨åˆ†ä½œä¸ºä¸€ä¸ªè®­ç»ƒ batchã€‚ MNIST æ•°æ®ä¸‹è½½åœ°å€å’Œå†…å®¹ å†…å®¹ Extracting MNIST_data/train-images-idx3-ubyte.gz è®­ç»ƒæ•°æ®å›¾ç‰‡ Extracting MNIST_data/train-labels-idx1-ubyte.gz è®­ç»ƒæ•°æ®ç­”æ¡ˆ Extracting MNIST_data/t10k-images-idx3-ubyte.gz æµ‹è¯•æ•°æ®å›¾ç‰‡ Extracting MNIST_data/t10k-labels-idx1-ubyte.gz æµ‹è¯•æ•°æ®ç­”æ¡ˆ import numpy as npimport tensorflow as tf# è®¾ç½®æŒ‰éœ€ä½¿ç”¨ GPUconfig = tf.ConfigProto()config.gpu_options.allow_growth = Truesess = tf.InteractiveSession(config=config) 1. å¯¼å…¥æ•°æ®# ç”¨tensorflow å¯¼å…¥æ•°æ®from tensorflow.examples.tutorials.mnist import input_data# input_data.read_data_sets è‡ªåŠ¨å°† MNIST æ•°æ®é›†åˆ’åˆ†ä¸º trainã€validationã€test ä¸‰ä¸ªæ•°æ®é›†mnist = input_data.read_data_sets(&#x27;MNIST_data&#x27;, one_hot=True)# train é›†åˆæœ‰ 55000 å¼ å›¾ç‰‡# validation é›†åˆæœ‰ 5000 å¼ å›¾ç‰‡# test é›†åˆæœ‰ 10000 å¼ å›¾ç‰‡ï¼Œå›¾ç‰‡æ¥è‡ª MNIST æä¾›çš„æµ‹è¯•æ•°æ®é›† print(&#x27;training data shape &#x27;, mnist.train.images.shape)print(&#x27;training label shape &#x27;, mnist.train.labels.shape)# training data shape (55000, 784)# training label shape (55000, 10) 2. æ„å»ºç½‘ç»œ# æƒå€¼åˆå§‹åŒ–def weight_variable(shape): # ç”¨æ­£æ€åˆ†å¸ƒæ¥åˆå§‹åŒ–æƒå€¼ initial = tf.truncated_normal(shape, stddev=0.1) return tf.Variable(initial)def bias_variable(shape): # æœ¬ä¾‹ä¸­ç”¨reluæ¿€æ´»å‡½æ•°ï¼Œæ‰€ä»¥ç”¨ä¸€ä¸ªå¾ˆå°çš„æ­£åç½®è¾ƒå¥½ initial = tf.constant(0.1, shape=shape) return tf.Variable(initial)# input_layerX_ = tf.placeholder(tf.float32, [None, 784])y_ = tf.placeholder(tf.float32, [None, 10])# FC1W_fc1 = weight_variable([784, 1024])b_fc1 = bias_variable([1024])h_fc1 = tf.nn.relu(tf.matmul(X_, W_fc1) + b_fc1)# FC2W_fc2 = weight_variable([1024, 10])b_fc2 = bias_variable([10])y_pre = tf.nn.softmax(tf.matmul(h_fc1, W_fc2) + b_fc2) 3. è®­ç»ƒå’Œè¯„ä¼°# 1.æŸå¤±å‡½æ•°ï¼šcross_entropycross_entropy = -tf.reduce_sum(y_ * tf.log(y_pre))# 2.ä¼˜åŒ–å‡½æ•°ï¼šAdamOptimizer, ä¼˜åŒ–é€Ÿåº¦è¦æ¯” GradientOptimizer å¿«å¾ˆå¤štrain_step = tf.train.AdamOptimizer(0.001).minimize(cross_entropy)# 3.é¢„æµ‹ç»“æœè¯„ä¼°# é¢„æµ‹å€¼ä¸­æœ€å¤§å€¼ï¼ˆï¼‘ï¼‰å³åˆ†ç±»ç»“æœï¼Œæ˜¯å¦ç­‰äºåŸå§‹æ ‡ç­¾ä¸­çš„ï¼ˆï¼‘ï¼‰çš„ä½ç½®ã€‚argmax()å–æœ€å¤§å€¼æ‰€åœ¨çš„ä¸‹æ ‡correct_prediction = tf.equal(tf.argmax(y_pre, 1), tf.arg_max(y_, 1)) accuracy = tf.reduce_mean(tf.cast(correct_prediction, tf.float32))# å¼€å§‹è¿è¡Œsess.run(tf.global_variables_initializer())# è¿™å¤§æ¦‚è¿­ä»£äº†ä¸åˆ° 10 ä¸ª epochï¼Œ è®­ç»ƒå‡†ç¡®ç‡å·²ç»è¾¾åˆ°äº†0.98for i in range(5000): X_batch, y_batch = mnist.train.next_batch(batch_size=100) train_step.run(feed_dict=&#123;X_: X_batch, y_: y_batch&#125;) if (i+1) % 200 == 0: train_accuracy = accuracy.eval(feed_dict=&#123;X_: mnist.train.images, y_: mnist.train.labels&#125;) print(&quot;step %d, training acc %g&quot; % (i+1, train_accuracy)) if (i+1) % 1000 == 0: test_accuracy = accuracy.eval(feed_dict=&#123;X_: mnist.test.images, y_: mnist.test.labels&#125;) print(&quot;= &quot; * 10, &quot;step %d, testing acc %g&quot; % (i+1, test_accuracy)) Output: step 200, training acc 0.937364step 400, training acc 0.965818step 600, training acc 0.973364step 800, training acc 0.977709step 1000, training acc 0.981528= = = = = = = = = = step 1000, testing acc 0.9688step 1200, training acc 0.988437step 1400, training acc 0.988728step 1600, training acc 0.987491step 1800, training acc 0.993873step 2000, training acc 0.992527= = = = = = = = = = step 2000, testing acc 0.9789step 2200, training acc 0.995309step 2400, training acc 0.995455step 2600, training acc 0.9952step 2800, training acc 0.996073step 3000, training acc 0.9964= = = = = = = = = = step 3000, testing acc 0.9778step 3200, training acc 0.996709step 3400, training acc 0.998109step 3600, training acc 0.997455step 3800, training acc 0.995055step 4000, training acc 0.997291= = = = = = = = = = step 4000, testing acc 0.9808step 4200, training acc 0.997746step 4400, training acc 0.996073step 4600, training acc 0.998564step 4800, training acc 0.997946step 5000, training acc 0.998673= = = = = = = = = = step 5000, testing acc 0.98 Reference å¤§å­¦ä¹‹é“ï¼Œåœ¨æ˜æ˜å¾· æ°¸æ°¸å¤œ Tensorflowå­¦ä¹ ä¹‹è·¯ W3cschool MNISTæ•°æ®é›† ä¾†é¾å»è„ˆè¬›è§£çš„æ¸…æ¸…æ¥šæ¥š Visual-Information äº¤å‰ç†µ","categories":[{"name":"tensorflow","slug":"tensorflow","permalink":"http://iequa.com/categories/tensorflow/"}],"tags":[{"name":"tensorflow","slug":"tensorflow","permalink":"http://iequa.com/tags/tensorflow/"}]},{"title":"RNN çš„è¯­è¨€æ¨¡å‹ TensorFlow å®ç°","slug":"tensorflow/tf-nlp-9.2.3","date":"2018-10-02T13:00:21.000Z","updated":"2019-10-20T04:30:35.053Z","comments":true,"path":"2018/10/02/tensorflow/tf-nlp-9.2.3/","link":"","permalink":"http://iequa.com/2018/10/02/tensorflow/tf-nlp-9.2.3/","excerpt":"ä¸Šç¯‡ PTB æ•°æ®é›† batching ä¸­æˆ‘ä»¬ä»‹ç»äº†å¦‚ä½•å¯¹ PTB æ•°æ®é›†è¿›è¡Œ è¿æ¥ã€åˆ‡å‰² æˆå¤šä¸ª batchï¼Œä½œä¸º NNLM çš„è¾“å…¥ã€‚ æœ¬æ–‡å°†ä»‹ç»å¦‚ä½•é‡‡ç”¨ TensorFlow å®ç° RNN-based NNLMã€‚","text":"ä¸Šç¯‡ PTB æ•°æ®é›† batching ä¸­æˆ‘ä»¬ä»‹ç»äº†å¦‚ä½•å¯¹ PTB æ•°æ®é›†è¿›è¡Œ è¿æ¥ã€åˆ‡å‰² æˆå¤šä¸ª batchï¼Œä½œä¸º NNLM çš„è¾“å…¥ã€‚ æœ¬æ–‡å°†ä»‹ç»å¦‚ä½•é‡‡ç”¨ TensorFlow å®ç° RNN-based NNLMã€‚ 1. Embedding å±‚å°† word ç¼–å· è½¬åŒ–ä¸º word embedding ä¸¤å¤§ä½œç”¨ : No. function desc 1. é™ä½è¾“å…¥çš„ç»´åº¦ è¯å‘é‡çš„ç»´åº¦é€šå¸¸åœ¨ 200 ~ 1000 ä¹‹é—´, å¤§å¤§å‡å°‘ RNN ç½‘ç»œçš„å‚æ•°æ•°é‡ ä¸ è®¡ç®—é‡ 2. å¢åŠ è¯­ä¹‰ä¿¡æ¯ ç®€å•çš„å•è¯ç¼–å·æ˜¯ä¸åŒ…å«ä»»ä½•è¯­ä¹‰ä¿¡æ¯çš„. è¯å‘é‡ç»´åº¦: EMB_SIZEï¼Œè¯æ±‡è¡¨å¤§å°: VOCAB_SIZE æ‰€æœ‰å•è¯çš„è¯å‘é‡å¯ä»¥æ”¾å…¥ä¸€ä¸ªå¤§å°ä¸º (EMB_SIZE, VOCAB_SIZE) çš„çŸ©é˜µå†… åœ¨è¯»å–è¯å‘é‡æ—¶ï¼Œå¯ä»¥è°ƒç”¨ tf.nn.embedding_lookup æ–¹æ³•ã€‚ ç”¨ tf.Variable æ¥è¡¨ç¤ºè¯å‘é‡ï¼Œè¿™æ ·å°±å¯ä»¥é‡‡ç”¨ä»»æ„åˆå§‹åŒ–çš„è¯å‘é‡ï¼Œå­¦ä¹ è¿‡ç¨‹ä¸­ä¹Ÿä¼šä¼˜åŒ–è¯å‘é‡ã€‚ # å®šä¹‰å•è¯çš„è¯å‘é‡çŸ©é˜µembedding = tf.get_variable(&quot;embedding&quot;, [VOCAB_SIZE, EMB_SIZE])# å°†æ•°æ®è½¬åŒ–ä¸ºè¯å‘é‡è¡¨ç¤ºinputs = tf.nn.embedding_lookup(embedding, input_data) å…¶ä¸­è¾“å…¥æ•°æ® input_data çš„ç»´åº¦æ˜¯ (batch_size * num_steps) è€Œè¾“å‡ºçš„ input_embedding çš„ç»´åº¦æˆä¸º (batch_size * num_steps * EMB_SIZE). åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬è¾“å…¥æ•°æ®ç»´åº¦æ˜¯ ($20 \\times 35$) ï¼ŒEMB_SIZE = 300, è¾“å…¥è¯å‘é‡ç»´åº¦æ—¶ ($20 \\times 35 \\times 300$) . 2. Softmax å±‚Softmaxå±‚ çš„ä½œç”¨æ˜¯å°† RNN çš„è¾“å‡º è½¬åŒ–ä¸ºä¸€ä¸ªå•è¯è¡¨ä¸­æ¯ä¸ªå•è¯çš„è¾“å‡ºæ¦‚ç‡ï¼Œä¸ºæ­¤éœ€è¦ä¸¤ä¸ªæ­¥éª¤ï¼š 2.1 ç¬¬ä¸€æ­¥ä½¿ç”¨ä¸€ä¸ªçº¿æ€§æ˜ å°„å°† RNN çš„è¾“å‡ºæ˜ å°„ä¸ºä¸€ä¸ªç»´åº¦ä¸è¯æ±‡è¡¨å¤§å°ç›¸åŒçš„å‘é‡ï¼Œè¿™ä¸€æ­¥çš„è¾“å‡ºå«åš logits. ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š # é¦–å…ˆå®šä¹‰æ˜ å°„ç”¨åˆ°çš„å‚æ•°# HIDDEN_SIZE æ˜¯ RNN çš„éšè—çŠ¶æ€ç»´åº¦ï¼ŒVOCAB_SIZE æ˜¯è¯æ±‡è¡¨å¤§å°weight = tf.get_variable(&quot;weight&quot;, [HIDDEN_ZIZE, VOCAB_SIZE])bias = tf.get_variable(&quot;bias&quot;, [VOCAB_SIZE])# è®¡ç®—çº¿æ€§æ˜ å°„logits = tf.matmul(output, weight) + bias å…¶ä¸­ output æ˜¯ RNN çš„è¾“å‡ºï¼Œç»´åº¦æ˜¯ [batch_size * num_steps, HIDDEN_SIZE] ç»è¿‡çº¿æ€§æ˜ å°„åï¼Œè¾“å‡ºç»“æœæ˜¯ [batch_size * num_steps, VOCAB_SIZE]. Reference tensorflow.org tf.nn.embedding_lookupå‡½æ•°åŸç†ï¼Ÿ æ±‚é€šä¿—è®²è§£ä¸‹tensorflowçš„embedding_lookupæ¥å£çš„æ„æ€ï¼Ÿ Tomas Mikolov PTB æ•°æ® å¦‚ä½•ç†è§£æ·±åº¦å­¦ä¹ æºç é‡Œç»å¸¸å‡ºç°çš„logitsï¼Ÿ åŸºäºå¾ªç¯ç¥ç»ç½‘ç»œçš„è¯­è¨€æ¨¡å‹çš„ä»‹ç»ä¸TensorFlowå®ç°(4)ï¼šTensorFlowå®ç°RNN-basedè¯­è¨€æ¨¡å‹","categories":[{"name":"tensorflow","slug":"tensorflow","permalink":"http://iequa.com/categories/tensorflow/"}],"tags":[{"name":"tensorflow","slug":"tensorflow","permalink":"http://iequa.com/tags/tensorflow/"}]},{"title":"PTB æ•°æ®çš„ batching æ–¹æ³•","slug":"tensorflow/tf-nlp-9.2.2","date":"2018-10-01T03:00:21.000Z","updated":"2019-10-20T04:30:35.053Z","comments":true,"path":"2018/10/01/tensorflow/tf-nlp-9.2.2/","link":"","permalink":"http://iequa.com/2018/10/01/tensorflow/tf-nlp-9.2.2/","excerpt":"PTB æ•°æ®é›† batching ä»‹ç», å¦‚ä½•å¯¹ PTB æ•°æ®é›†è¿›è¡Œ è¿æ¥ã€åˆ‡å‰² æˆå¤šä¸ª batchã€‚ é‡ç‚¹äº†è§£ batch_sizeã€num_batchã€num_step è¿™ä¸‰ä¸ªæ¦‚å¿µã€‚","text":"PTB æ•°æ®é›† batching ä»‹ç», å¦‚ä½•å¯¹ PTB æ•°æ®é›†è¿›è¡Œ è¿æ¥ã€åˆ‡å‰² æˆå¤šä¸ª batchã€‚ é‡ç‚¹äº†è§£ batch_sizeã€num_batchã€num_step è¿™ä¸‰ä¸ªæ¦‚å¿µã€‚ batchingå…ˆçœ‹ä¸‹é¢è¿™æ®µï¼Œæ‘˜å–è‡ª çŸ¥ä¹ ä½œè€…ï¼šdalida ç”»å›¾å¾ˆå¼±ï¼Œç›´æ¥å°±å¾’æ‰‹ç”»äº†ã€‚ä»¥æœ±è‡ªæ¸…çš„ã€ŠèƒŒå½±ã€‹ä¸­çš„èŠ‚é€‰æ®µè½ä¸ºä¾‹ã€‚å­—æœ‰ç‚¹éš¾çœ‹ï¼Œè¯·å¿½ç•¥ï½(ï¿£â–½ï¿£ï½)~ è¿™æ˜¯å•ä¸ªå­—ç¬¦çº§åˆ«çš„ RNNï¼Œæ¢æˆè¯è¯­ä¹Ÿä¸€æ ·ã€‚ num_batch å…¶å®å°±æ˜¯ batch çš„æ•°é‡ï¼Œè¿™é‡Œåªç”»äº†ä¸‰ä¸ªï¼Œå¯ä»¥ä¸€ç›´æ¥ä¸‹å»â€¦.è¿™æ ·ä¸€æ¬¡å®Œæˆ 6ä¸ªå­—ç¬¦ (num_step=6) çš„å¤„ç†ï¼Œè€Œä¸”èƒ½ä¿è¯ batch ä¹‹é—´çš„è¿ç»­æ€§ã€‚ä½†æ˜¯è¡Œä¸è¡Œä¹‹é—´çš„è¿ç»­æ€§ç¡®å®æ˜¯ä¸¢å¤±äº†ã€‚ ç»“è®º : batch_size = 3 num_batch = 3 num_step = 6 batch_size ä¹Ÿæ˜¯ä¸€æ¬¡è¾“å…¥çš„å¥å­æ•° æœ±è‡ªæ¸…ã€ŠèƒŒå½±ã€‹æˆ‘ä»¬è¿‡äº†æ±Ÿï¼Œè¿›äº†è½¦ç«™ã€‚æˆ‘ä¹°ç¥¨ï¼Œä»–å¿™ç€ç…§çœ‹è¡Œæã€‚è¡Œæå¤ªå¤šäº†ï¼Œå¾—å‘è„šå¤«è¡Œäº›å°è´¹ï¼Œæ‰å¯è¿‡å»ã€‚ä»–ä¾¿åˆå¿™ç€å’Œä»–ä»¬è®²ä»·é’±ã€‚æˆ‘é‚£æ—¶çœŸæ˜¯èªæ˜è¿‡åˆ†ï¼Œæ€»è§‰ä»–è¯´è¯ä¸å¤§æ¼‚äº®ï¼Œéè‡ªå·±æ’å˜´ä¸å¯ã€‚ä½†ä»–ç»ˆäºè®²å®šäº†ä»·é’±ï¼›å°±é€æˆ‘ä¸Šè½¦ã€‚ä»–ç»™æˆ‘æ‹£å®šäº†é è½¦é—¨çš„ä¸€å¼ æ¤…å­ï¼›æˆ‘å°†ä»–ç»™æˆ‘åšçš„ç´«æ¯›å¤§è¡£é“ºå¥½åä½ã€‚ä»–å˜±æˆ‘è·¯ä¸Šå°å¿ƒï¼Œå¤œé‡Œè­¦é†’äº›ï¼Œä¸è¦å—å‡‰ã€‚åˆå˜±æ‰˜èŒ¶æˆ¿å¥½å¥½ç…§åº”æˆ‘ã€‚æˆ‘å¿ƒé‡Œæš—ç¬‘ä»–çš„è¿‚ï¼›ä»–ä»¬åªè®¤å¾—é’±ï¼Œæ‰˜ä»–ä»¬ç›´æ˜¯ç™½æ‰˜ï¼è€Œä¸”æˆ‘è¿™æ ·å¤§å¹´çºªçš„äººï¼Œéš¾é“è¿˜ä¸èƒ½æ–™ç†è‡ªå·±ä¹ˆï¼Ÿå”‰ï¼Œæˆ‘ç°åœ¨æƒ³æƒ³ï¼Œé‚£æ—¶çœŸæ˜¯å¤ªèªæ˜äº†ï¼ æˆ‘è¯´é“ï¼Œâ€œçˆ¸çˆ¸ï¼Œä½ èµ°å§ã€‚â€ä»–æœ›è½¦å¤–çœ‹äº†çœ‹ï¼Œè¯´ï¼Œâ€œæˆ‘ä¹°å‡ ä¸ªæ©˜å­å»ã€‚ä½ å°±åœ¨æ­¤åœ°ï¼Œä¸è¦èµ°åŠ¨ã€‚â€æˆ‘çœ‹é‚£è¾¹æœˆå°çš„æ …æ å¤–æœ‰å‡ ä¸ªå–ä¸œè¥¿çš„ç­‰ç€é¡¾å®¢ã€‚èµ°åˆ°é‚£è¾¹æœˆå°ï¼Œé¡»ç©¿è¿‡é“é“ï¼Œé¡»è·³ä¸‹å»åˆçˆ¬ä¸Šå»ã€‚çˆ¶äº²æ˜¯ä¸€ä¸ªèƒ–å­ï¼Œèµ°è¿‡å»è‡ªç„¶è¦è´¹äº‹äº›ã€‚æˆ‘æœ¬æ¥è¦å»çš„ï¼Œä»–ä¸è‚¯ï¼Œåªå¥½è®©ä»–å»ã€‚æˆ‘çœ‹è§ä»–æˆ´ç€é»‘å¸ƒå°å¸½ï¼Œç©¿ç€é»‘å¸ƒå¤§é©¬è¤‚ï¼Œæ·±é’å¸ƒæ£‰è¢ï¼Œè¹’è·šåœ°èµ°åˆ°é“é“è¾¹ï¼Œæ…¢æ…¢æ¢èº«ä¸‹å»ï¼Œå°šä¸å¤§éš¾ã€‚å¯æ˜¯ä»–ç©¿è¿‡é“é“ï¼Œè¦çˆ¬ä¸Šé‚£è¾¹æœˆå°ï¼Œå°±ä¸å®¹æ˜“äº†ã€‚ä»–ç”¨ä¸¤æ‰‹æ”€ç€ä¸Šé¢ï¼Œä¸¤è„šå†å‘ä¸Šç¼©ï¼›ä»–è‚¥èƒ–çš„èº«å­å‘å·¦å¾®å€¾ï¼Œæ˜¾å‡ºåŠªåŠ›çš„æ ·å­ã€‚è¿™æ—¶æˆ‘çœ‹è§ä»–çš„èƒŒå½±ï¼Œæˆ‘çš„æ³ªå¾ˆå¿«åœ°æµä¸‹æ¥äº†ã€‚æˆ‘èµ¶ç´§æ‹­å¹²äº†æ³ªï¼Œæ€•ä»–çœ‹è§ï¼Œä¹Ÿæ€•åˆ«äººçœ‹è§ã€‚æˆ‘å†å‘å¤–çœ‹æ—¶ï¼Œä»–å·²æŠ±äº†æœ±çº¢çš„æ©˜å­æœ›å›èµ°äº†ã€‚è¿‡é“é“æ—¶ï¼Œä»–å…ˆå°†æ©˜å­æ•£æ”¾åœ¨åœ°ä¸Šï¼Œè‡ªå·±æ…¢æ…¢çˆ¬ä¸‹ï¼Œå†æŠ±èµ·æ©˜å­èµ°ã€‚åˆ°è¿™è¾¹æ—¶ï¼Œæˆ‘èµ¶ç´§å»æ€ä»–ã€‚ä»–å’Œæˆ‘èµ°åˆ°è½¦ä¸Šï¼Œå°†æ©˜å­ä¸€è‚¡è„‘å„¿æ”¾åœ¨æˆ‘çš„çš®å¤§è¡£ä¸Šã€‚äºæ˜¯æ‰‘æ‰‘è¡£ä¸Šçš„æ³¥åœŸï¼Œå¿ƒé‡Œå¾ˆè½»æ¾ä¼¼çš„ï¼Œè¿‡ä¸€ä¼šè¯´ï¼Œâ€œæˆ‘èµ°äº†ï¼›åˆ°é‚£è¾¹æ¥ä¿¡ï¼â€æˆ‘æœ›ç€ä»–èµ°å‡ºå»ã€‚ä»–èµ°äº†å‡ æ­¥ï¼Œå›è¿‡å¤´çœ‹è§æˆ‘ï¼Œè¯´ï¼Œâ€œè¿›å»å§ï¼Œé‡Œè¾¹æ²¡äººã€‚â€ç­‰ä»–çš„èƒŒå½±æ··å…¥æ¥æ¥å¾€å¾€çš„äººé‡Œï¼Œå†æ‰¾ä¸ç€äº†ï¼Œæˆ‘ä¾¿è¿›æ¥åä¸‹ï¼Œæˆ‘çš„çœ¼æ³ªåˆæ¥äº†ã€‚ è¿‘å‡ å¹´æ¥ï¼Œçˆ¶äº²å’Œæˆ‘éƒ½æ˜¯ä¸œå¥”è¥¿èµ°ï¼Œå®¶ä¸­å…‰æ™¯æ˜¯ä¸€æ—¥ä¸å¦‚ä¸€æ—¥ã€‚ä»–å°‘å¹´å‡ºå¤–è°‹ç”Ÿï¼Œç‹¬åŠ›æ”¯æŒï¼Œåšäº†è®¸å¤šå¤§äº‹ã€‚é‚£çŸ¥è€å¢ƒå´å¦‚æ­¤é¢“å”ï¼ä»–è§¦ç›®ä¼¤æ€€ï¼Œè‡ªç„¶æƒ…ä¸èƒ½è‡ªå·²ã€‚æƒ…éƒäºä¸­ï¼Œè‡ªç„¶è¦å‘ä¹‹äºå¤–ï¼›å®¶åº­çå±‘ä¾¿å¾€å¾€è§¦ä»–ä¹‹æ€’ã€‚ä»–å¾…æˆ‘æ¸æ¸ä¸åŒå¾€æ—¥ã€‚ä½†æœ€è¿‘ä¸¤å¹´çš„ä¸è§ï¼Œä»–ç»ˆäºå¿˜å´æˆ‘çš„ä¸å¥½ï¼Œåªæ˜¯æƒ¦è®°ç€æˆ‘ï¼Œæƒ¦è®°ç€æˆ‘çš„å„¿å­ã€‚æˆ‘åŒ—æ¥åï¼Œä»–å†™äº†ä¸€ä¿¡ç»™æˆ‘ï¼Œä¿¡ä¸­è¯´é“ï¼Œâ€œæˆ‘èº«ä½“å¹³å®‰ï¼ŒæƒŸè†€å­ç–¼ç—›åˆ©å®³ï¼Œä¸¾ç®¸æç¬”ï¼Œè¯¸å¤šä¸ä¾¿ï¼Œå¤§çº¦å¤§å»ä¹‹æœŸä¸è¿œçŸ£ã€‚â€æˆ‘è¯»åˆ°æ­¤å¤„ï¼Œåœ¨æ™¶è¹çš„æ³ªå…‰ä¸­ï¼Œåˆçœ‹è§é‚£è‚¥èƒ–çš„ï¼Œé’å¸ƒæ£‰è¢ï¼Œé»‘å¸ƒé©¬è¤‚çš„èƒŒå½±ã€‚å”‰ï¼æˆ‘ä¸çŸ¥ä½•æ—¶å†èƒ½ä¸ä»–ç›¸è§ï¼ å†çœ‹è¿™ä¸ªå›¾ï¼š Reference å…³äºbatchingå¤šå¥å­åˆ‡å‰²batchç–‘é—®ï¼Ÿ [L2]ä½¿ç”¨LSTMå®ç°è¯­è¨€æ¨¡å‹-æ•°æ®batching TensorFlowå…¥é—¨ï¼ˆäº”ï¼‰å¤šå±‚ LSTM é€šä¿—æ˜“æ‡‚ç‰ˆ","categories":[{"name":"tensorflow","slug":"tensorflow","permalink":"http://iequa.com/categories/tensorflow/"}],"tags":[{"name":"tensorflow","slug":"tensorflow","permalink":"http://iequa.com/tags/tensorflow/"}]},{"title":"TensorFlowï¼š ç¬¬6ç«  å›¾ç‰‡è¯†åˆ«ä¸CNN","slug":"tensorflow/tf-google-6-cnn-1","date":"2018-09-28T02:00:21.000Z","updated":"2019-10-20T04:30:35.058Z","comments":true,"path":"2018/09/28/tensorflow/tf-google-6-cnn-1/","link":"","permalink":"http://iequa.com/2018/09/28/tensorflow/tf-google-6-cnn-1/","excerpt":"å®æˆ˜Googleæ·±åº¦å­¦ä¹ æ¡†æ¶ ç¬”è®°-ç¬¬6ç«  å›¾ç‰‡è¯†åˆ« ä¸ CNN ä»‹ç» CNN åœ¨å›¾ç‰‡è¯†åˆ«çš„åº”ç”¨ å’Œ CNN åŸºæœ¬åŸç† ä»¥åŠ å¦‚ä½•ä½¿ç”¨ TensorFlow æ¥å®ç° CNN .","text":"å®æˆ˜Googleæ·±åº¦å­¦ä¹ æ¡†æ¶ ç¬”è®°-ç¬¬6ç«  å›¾ç‰‡è¯†åˆ« ä¸ CNN ä»‹ç» CNN åœ¨å›¾ç‰‡è¯†åˆ«çš„åº”ç”¨ å’Œ CNN åŸºæœ¬åŸç† ä»¥åŠ å¦‚ä½•ä½¿ç”¨ TensorFlow æ¥å®ç° CNN . 1. å›¾åƒè¯†åˆ«ä»‹ç»ä¸ç»å…¸æ•°æ®é›†è§†è§‰æ˜¯äººç±»è®¤è¯†ä¸–ç•Œéå¸¸é‡è¦çš„ä¸€ç§çŸ¥è§‰. ç»å…¸æ•°æ®é›† MNIST CIFAR ImageNet CIFAR æ•°æ®é›†æ˜¯ä¸€ä¸ªå½±å“åŠ›å¾ˆå¤§çš„å›¾åƒåˆ†ç±»æ•°æ®é›†, æ˜¯å›¾åƒè¯å…¸é¡¹ç›®ï¼ˆVisual Dictionaryï¼‰ (7) ä¸­800ä¸‡å¼ å›¾ç‰‡çš„ä¸€ä¸ªå­é›†ï¼Œ éƒ½æ˜¯ 32Ã—32çš„å½©è‰²å›¾ç‰‡, ç”±Alex Krizhevskyæ•™æˆã€Vinod Nairåšå£«å’ŒGeoffrey Hintonæ•™æˆæ•´ç†çš„. CIFAR-10 é—®é¢˜æ”¶é›†äº†æ¥è‡ª 10ä¸ª ä¸åŒç§ç±»çš„ 60000å¼ å›¾ç‰‡, Cifar-10ä¸­çš„å›¾ç‰‡å¤§å°éƒ½æ˜¯å›ºå®šçš„ä¸”æ¯ä¸€å¼ å›¾ç‰‡ä¸­ä»…åŒ…å«ä¸€ä¸ªç§ç±»çš„å®ä½“ ImageNet æ˜¯ä¸ºäº†æ›´åŠ è´´è¿‘çœŸå®ç¯å¢ƒä¸‹çš„å›¾åƒè¯†åˆ«é—®é¢˜ï¼ŒåŸºäº WordNetï¼Œ ç”±æ–¯å¦ç¦å¤§å­¦ï¼ˆStanford Universityï¼‰çš„æé£é£ï¼ˆFeifei Liï¼‰å¸¦å¤´æ•´ç†çš„ImageNetå¾ˆå¤§ç¨‹åº¦åœ°è§£å†³äº†è¿™ä¸¤ä¸ªé—®é¢˜ã€‚ ILSVRC2012 åŒ…å«æ¥è‡ª 1000 ä¸ªç±»åˆ« 120ä¸‡ å¼ å›¾ç‰‡. 2. CNN ä»‹ç»ä¸å¸¸ç”¨ç»“æ„è¿™éƒ¨åˆ†å†…å®¹è¯¦è§ Convolutional Neural Networks å¦‚ä½•æ­å»ºä¸€ä¸ªç¥ç»ç½‘ç»œï¼ŒåŒ…æ‹¬æœ€æ–°çš„å˜ä½“ï¼Œå¦‚: ResNet 3. ç»å…¸ CNN æ¨¡å‹ LeNet-5 Inception ResNet 3.1 LeNet-5 æ¨¡å‹è¯¥ç½‘ç»œ 1980s æå‡ºï¼Œä¸»è¦é’ˆå¯¹ç°åº¦å›¾åƒè®­ç»ƒçš„ï¼Œç”¨äºè¯†åˆ«æ‰‹å†™æ•°å­—ã€‚ 3.2 Inception-v3 æ¨¡å‹4. CNN è¿ç§»å­¦ä¹ 4.1 è¿ç§»å­¦ä¹ ä»‹ç»Reference çŸ¥ä¹ï¼šã€ŠTensorFlowï¼šå®æˆ˜Googleæ·±åº¦å­¦ä¹ æ¡†æ¶ã€‹ç¬”è®°ã€ä»£ç åŠå‹˜è¯¯-ç¬¬6ç«  å›¾åƒè¯†åˆ«ä¸å·ç§¯ç¥ç»ç½‘ç»œ-1 7å¤©æ—¶é—´è¯»ä¹¦ Tensorflow å®æˆ˜ Google æ·±åº¦å­¦ä¹ æ¡†æ¶ MNISTè¯†åˆ«è‡ªå·±æ‰‹å†™çš„æ•°å­—â€”è¿›é˜¶ç¯‡ï¼ˆCNNï¼‰","categories":[{"name":"tensorflow","slug":"tensorflow","permalink":"http://iequa.com/categories/tensorflow/"}],"tags":[{"name":"CNN","slug":"CNN","permalink":"http://iequa.com/tags/CNN/"}]},{"title":"Chatbot Research 7 - Dialog_Corpus å¸¸ç”¨æ•°æ®é›†","slug":"chatbot/chatbot-research7","date":"2018-09-26T06:00:21.000Z","updated":"2020-10-23T02:03:18.014Z","comments":true,"path":"2018/09/26/chatbot/chatbot-research7/","link":"","permalink":"http://iequa.com/2018/09/26/chatbot/chatbot-research7/","excerpt":"ä¸€äº›ç”¨äº Dialog å¯¹è¯ç³»ç»Ÿçš„æ•°æ®é›†èµ„æ–™æ±‡æ€»","text":"ä¸€äº›ç”¨äº Dialog å¯¹è¯ç³»ç»Ÿçš„æ•°æ®é›†èµ„æ–™æ±‡æ€» å¯¹è¯ç³»ç»Ÿå¸¸ç”¨æ•°æ®é›† ä»‹ç»ä¸€ä¸‹å…¬å¼€çš„æ•°æ®é›† : å¯ä»¥å‚è€ƒâ€œA Survey of Available Corpora for Building Data-Driven Dialogue Systemsâ€è¿™ç¯‡è®ºæ–‡ï¼Œè€Œä¸”ä½œè€…æŠŠæ‰€æœ‰çš„æ•°æ®é›†æŒ‰ç…§ä¸åŒç±»åˆ«è¿›è¡Œåˆ†ç±»æ€»ç»“ï¼Œé‡Œé¢æ¶µç›–äº†å¾ˆå¤šæ•°æ®é›†ï¼Œè¯¦æƒ…è¯·æˆ³ Dialogue datasets è‹±æ–‡æ•°æ®é›† Cornell Movie Dialogs Ubuntu Dialogue Corpus OpenSubtitlesï¼šç”µå½±å­—å¹• Twitterï¼štwitteræ•°æ®é›† Papaya Conversational Data Setï¼šåŸºäºCornellã€Redditç­‰æ•°æ®é›†é‡æ–°æ•´ç† ç›¸å…³æ•°æ®é›†çš„å¤„ç†ä»£ç å¯å‚è§ä¸‹é¢ä¸¤ä¸ªgithubé¡¹ç›®ï¼š DeepQA chat_corpus ä¸­æ–‡æ•°æ®é›† dgk_shooter_min.convï¼šä¸­æ–‡ç”µå½±å°è¯æ•°æ®é›† ç™½é¹­æ—¶ä»£ä¸­æ–‡é—®ç­”è¯­æ–™ï¼šç™½é¹­æ—¶ä»£è®ºå›é—®ç­”æ•°æ® å¾®åšæ•°æ®é›†ï¼šåä¸ºæèˆªå®éªŒå®¤å‘å¸ƒ ä¹Ÿæ˜¯è®ºæ–‡â€œNeural Responding Machine for Short-Text Conversationâ€ä½¿ç”¨çš„æ•°æ®é›† æ–°æµªå¾®åšæ•°æ®é›†ï¼Œè¯„è®ºå›å¤çŸ­å¥ Reference Github ç”¨äºå¯¹è¯ç³»ç»Ÿçš„ä¸­è‹±æ–‡è¯­æ–™ æ±‡æ€»åˆé›† ç¾å‰§ ï¼š è¿‘1GBçš„ä¸‰åƒä¸‡èŠå¤©è¯­æ–™ - 10å…ƒ chatterbot-corpus chinese ç®€ä¹¦ ï¼š é«˜è´¨é‡çš„å¯¹è¯è¯­æ–™ çŸ¥ä¹ ï¼š ç°åœ¨æœ‰å“ªäº›ä¸­æ–‡çš„èŠå¤©è¯­æ–™åº“ï¼Ÿ æ·±åº¦å­¦ä¹ å¯¹è¯ç³»ç»Ÿç†è®ºç¯‡â€”æ•°æ®é›†å’Œè¯„ä»·æŒ‡æ ‡ä»‹ç»","categories":[{"name":"chatbot","slug":"chatbot","permalink":"http://iequa.com/categories/chatbot/"}],"tags":[{"name":"Dialog_Corpus","slug":"Dialog-Corpus","permalink":"http://iequa.com/tags/Dialog-Corpus/"}]},{"title":"Tensorboard å¯è§†åŒ–å¥½å¸®æ‰‹ 1","slug":"tensorflow/tf-4.1-tensorboard1","date":"2018-09-12T07:00:21.000Z","updated":"2020-07-03T03:32:18.869Z","comments":true,"path":"2018/09/12/tensorflow/tf-4.1-tensorboard1/","link":"","permalink":"http://iequa.com/2018/09/12/tensorflow/tf-4.1-tensorboard1/","excerpt":"å­¦ä¼šç”¨ Tensorflow è‡ªå¸¦çš„ tensorboard å»å¯è§†åŒ–æˆ‘ä»¬æ‰€å»ºé€ å‡ºæ¥çš„ç¥ç»ç½‘ç»œæ˜¯ä¸€ä¸ªå¾ˆå¥½çš„å­¦ä¹ ç†è§£æ–¹å¼. ç”¨æœ€ç›´è§‚çš„æµç¨‹å›¾å‘Šè¯‰ä½ , ä½ çš„ç¥ç»ç½‘ç»œæ˜¯é•¿æ€æ ·,æœ‰åŠ©äºä½ å‘ç°ç¼–ç¨‹ä¸­é—´çš„é—®é¢˜å’Œç–‘é—®.","text":"å­¦ä¼šç”¨ Tensorflow è‡ªå¸¦çš„ tensorboard å»å¯è§†åŒ–æˆ‘ä»¬æ‰€å»ºé€ å‡ºæ¥çš„ç¥ç»ç½‘ç»œæ˜¯ä¸€ä¸ªå¾ˆå¥½çš„å­¦ä¹ ç†è§£æ–¹å¼. ç”¨æœ€ç›´è§‚çš„æµç¨‹å›¾å‘Šè¯‰ä½ , ä½ çš„ç¥ç»ç½‘ç»œæ˜¯é•¿æ€æ ·,æœ‰åŠ©äºä½ å‘ç°ç¼–ç¨‹ä¸­é—´çš„é—®é¢˜å’Œç–‘é—®. æ•ˆæœè¿™æ¬¡æˆ‘ä»¬ä¼šä»‹ç»å¦‚ä½•å¯è§†åŒ–ç¥ç»ç½‘ç»œã€‚å› ä¸ºå¾ˆå¤šæ—¶å€™æˆ‘ä»¬éƒ½æ˜¯åšå¥½äº†ä¸€ä¸ªç¥ç»ç½‘ç»œï¼Œä½†æ˜¯æ²¡æœ‰ä¸€ä¸ªå›¾åƒå¯ä»¥å±•ç¤ºç»™å¤§å®¶çœ‹ã€‚ TensorFlow çš„å¯è§†åŒ–å·¥å…· Tensorboard : é€šè¿‡ä½¿ç”¨è¿™ä¸ªå·¥å…·æˆ‘ä»¬å¯ä»¥å¾ˆç›´è§‚çš„çœ‹åˆ°æ•´ä¸ªç¥ç»ç½‘ç»œçš„ç»“æ„ã€æ¡†æ¶ã€‚ ä»Šå¤©è¦æ˜¾ç¤ºçš„ç¥ç»ç½‘ç»œå·®ä¸å¤šæ˜¯è¿™æ ·å­çš„ åŒæ—¶æˆ‘ä»¬ä¹Ÿå¯ä»¥å±•å¼€çœ‹æ¯ä¸ªlayerä¸­çš„ä¸€äº›å…·ä½“çš„ç»“æ„ï¼š å¥½ï¼Œé€šè¿‡é˜…è¯»ä»£ç å’Œä¹‹å‰çš„å›¾ç‰‡æˆ‘ä»¬å¤§æ¦‚çŸ¥é“äº†æ­¤å¤„æ˜¯æœ‰: ä¸€ä¸ªè¾“å…¥å±‚ï¼ˆinputsï¼‰ ä¸€ä¸ªéšå«å±‚ï¼ˆlayerï¼‰ ä¸€ä¸ªè¾“å‡ºå±‚ï¼ˆoutputï¼‰ ç°åœ¨å¯ä»¥çœ‹çœ‹å¦‚ä½•è¿›è¡Œå¯è§†åŒ–. æ­å»ºå›¾çº¸é¦–å…ˆä» Input å¼€å§‹ï¼š # define placeholder for inputs to networkxs = tf.placeholder(tf.float32, [None, 1])ys = tf.placeholder(tf.float32, [None, 1]) å¯¹äº input æˆ‘ä»¬è¿›è¡Œå¦‚ä¸‹ä¿®æ”¹ï¼š é¦–å…ˆï¼Œå¯ä»¥ä¸ºxsæŒ‡å®šåç§°ä¸ºx_in, ys åŒæ ·ã€‚ : xs= tf.placeholder(tf.float32, [None, 1],name=&#x27;x_in&#x27;)ys= tf.placeholder(tf.loat32, [None, 1],name=&#x27;y_in&#x27;) è¿™é‡ŒæŒ‡å®šçš„åç§°å°†æ¥ä¼šåœ¨å¯è§†åŒ–çš„å›¾å±‚ inputs ä¸­æ˜¾ç¤ºå‡ºæ¥ ä½¿ç”¨ with tf.name_scope(&#39;inputs&#39;) å¯ä»¥å°† xs å’Œ ys åŒ…å«è¿›æ¥ï¼Œå½¢æˆä¸€ä¸ªå¤§çš„å›¾å±‚ï¼Œå›¾å±‚çš„åå­—å°±æ˜¯ with tf.name_scope() æ–¹æ³•é‡Œçš„å‚æ•° with tf.name_scope(&#x27;inputs&#x27;): # define placeholder for inputs to network xs = tf.placeholder(tf.float32, [None, 1]) ys = tf.placeholder(tf.float32, [None, 1]) æ¥ä¸‹æ¥å¼€å§‹ç¼–è¾‘ layer ï¼Œ è¯·çœ‹ç¼–è¾‘å‰çš„ç¨‹åºç‰‡æ®µ ï¼š def add_layer(inputs, in_size, out_size, activation_function=None): # add one more layer and return the output of this layer Weights = tf.Variable(tf.random_normal([in_size, out_size])) biases = tf.Variable(tf.zeros([1, out_size]) + 0.1) Wx_plus_b = tf.add(tf.matmul(inputs, Weights), biases) if activation_function is None: outputs = Wx_plus_b else: outputs = activation_function(Wx_plus_b, ) return outputs 2.1 ç¼–è¾‘å add_layerç¼–è¾‘åï¼Œ è¿™é‡Œçš„åå­—åº”è¯¥å« layer, ä¸‹é¢æ˜¯ç¼–è¾‘åçš„: def add_layer(inputs, in_size, out_size, activation_function=None): # add one more layer and return the output of this layer with tf.name_scope(&#x27;layer&#x27;): Weights= tf.Variable(tf.random_normal([in_size, out_size])) # and so on... åœ¨å®šä¹‰å®Œå¤§çš„æ¡†æ¶layerä¹‹åï¼ŒåŒæ—¶ä¹Ÿéœ€è¦å®šä¹‰æ¯ä¸€ä¸ªâ€™æ¡†æ¶â€˜é‡Œé¢çš„å°éƒ¨ä»¶ï¼š(Weights biases å’Œ activation function): ç°åœ¨ç°å¯¹ Weights å®šä¹‰ï¼š å®šä¹‰çš„æ–¹æ³•åŒä¸Šï¼Œå¯ä»¥ä½¿ç”¨tf.name.scope() æ–¹æ³•ï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥åœ¨ Weights ä¸­æŒ‡å®šåç§° W ã€‚ å³ä¸ºï¼š æ¥ç€ç»§ç»­å®šä¹‰ biases ï¼Œ å®šä¹‰æ–¹å¼åŒä¸Šã€‚ activation_function çš„è¯ï¼Œå¯ä»¥æš‚æ—¶å¿½ç•¥ã€‚å› ä¸ºå½“ä½ è‡ªå·±é€‰æ‹©ç”¨ tensorflow ä¸­çš„æ¿€åŠ±å‡½æ•°ï¼ˆactivation functionï¼‰çš„æ—¶å€™ï¼Œtensorflowä¼šé»˜è®¤æ·»åŠ åç§°ã€‚ æœ€ç»ˆï¼Œlayerå½¢å¼å¦‚ä¸‹ï¼š def add_layer(inputs, in_size, out_size, activation_function=None): # add one more layer and return the output of this layer with tf.name_scope(&#x27;layer&#x27;): with tf.name_scope(&#x27;weights&#x27;): Weights = tf.Variable( tf.random_normal([in_size, out_size]), name=&#x27;W&#x27;) with tf.name_scope(&#x27;biases&#x27;): biases = tf.Variable( tf.zeros([1, out_size]) + 0.1, name=&#x27;b&#x27;) with tf.name_scope(&#x27;Wx_plus_b&#x27;): Wx_plus_b = tf.add( tf.matmul(inputs, Weights), biases) if activation_function is None: outputs = Wx_plus_b else: outputs = activation_function(Wx_plus_b, ) return outputs æ•ˆæœå¦‚ä¸‹ï¼šï¼ˆæœ‰æ²¡æœ‰çœ‹è§åˆšæ‰å®šä¹‰ layer é‡Œé¢çš„â€œå†…éƒ¨æ„ä»¶â€å‘¢ï¼Ÿï¼‰ æœ€åç¼–è¾‘ loss éƒ¨åˆ†ï¼šå°† with tf.name_scope() æ·»åŠ åœ¨ loss ä¸Šæ–¹ï¼Œå¹¶ä¸ºå®ƒèµ·åä¸º loss # the error between prediciton and real datawith tf.name_scope(&#x27;loss&#x27;): loss = tf.reduce_mean( tf.reduce_sum( tf.square(ys - prediction), eduction_indices=[1] )) è¿™å¥è¯å°±æ˜¯â€œç»˜åˆ¶â€ loss äº†ï¼Œ å¦‚ä¸‹ï¼š ä½¿ç”¨ with tf.name_scope() å†æ¬¡å¯¹ train_step éƒ¨åˆ†è¿›è¡Œç¼–è¾‘, å¦‚ä¸‹ï¼š with tf.name_scope(&#x27;train&#x27;): train_step = tf.train.GradientDescentOptimizer(0.1).minimize(loss) æˆ‘ä»¬éœ€è¦ä½¿ç”¨ tf.summary.FileWriter() å°†ä¸Šé¢â€˜ç»˜ç”»â€™å‡ºçš„å›¾ä¿å­˜åˆ°ä¸€ä¸ªç›®å½•ä¸­ï¼Œä»¥æ–¹ä¾¿åæœŸåœ¨æµè§ˆå™¨ä¸­å¯ä»¥æµè§ˆã€‚ è¿™ä¸ªæ–¹æ³•ä¸­çš„ç¬¬äºŒä¸ªå‚æ•°éœ€è¦ä½¿ç”¨ sess.graph ï¼Œ å› æ­¤æˆ‘ä»¬éœ€è¦æŠŠè¿™å¥è¯æ”¾åœ¨è·å– session çš„åé¢ã€‚ è¿™é‡Œçš„ graph æ˜¯å°†å‰é¢å®šä¹‰çš„æ¡†æ¶ä¿¡æ¯æ”¶é›†èµ·æ¥ï¼Œç„¶åæ”¾åœ¨ logs/ ç›®å½•ä¸‹é¢ã€‚ sess = tf.Session() # get session# tf.train.SummaryWriter soon be deprecated, use followingwriter = tf.summary.FileWriter(&quot;logs/&quot;, sess.graph) æœ€ååœ¨ä½ çš„terminalï¼ˆç»ˆç«¯ï¼‰ä¸­ ï¼Œä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ tensorboard --logdir logs åŒæ—¶å°†ç»ˆç«¯ä¸­è¾“å‡ºçš„ç½‘å€å¤åˆ¶åˆ°æµè§ˆå™¨ä¸­ï¼Œä¾¿å¯ä»¥çœ‹åˆ°ä¹‹å‰å®šä¹‰çš„è§†å›¾æ¡†æ¶äº†ã€‚ tensorboard è¿˜æœ‰å¾ˆå¤šå…¶ä»–çš„å‚æ•°ï¼Œå¸Œæœ›å¤§å®¶å¯ä»¥å¤šå¤šäº†è§£, å¯ä»¥ä½¿ç”¨ tensorboard â€”help æŸ¥çœ‹tensorboardçš„è¯¦ç»†å‚æ•° æœ€ç»ˆçš„å…¨éƒ¨ä»£ç åœ¨è¿™é‡Œ å¯èƒ½ä¼šé‡åˆ°çš„é—®é¢˜(1) ä¸ Tensorboard å…¼å®¹çš„æµè§ˆå™¨æ˜¯ â€œGoogle Chromeâ€. ä½¿ç”¨å…¶ä»–çš„æµè§ˆå™¨ä¸ä¿è¯æ‰€æœ‰å†…å®¹éƒ½èƒ½æ­£å¸¸æ˜¾ç¤º. (2) è¯·ä½¿ç”¨ http://localhost:6006, å¤§å¤šæ•°æœ‹å‹éƒ½æ˜¯è¿™ä¸ªé—®é¢˜. (3) è¯·ç¡®ä¿ä½ çš„ tensorboard æŒ‡ä»¤æ˜¯åœ¨ä½ çš„ logs æ–‡ä»¶æ ¹ç›®å½•æ‰§è¡Œçš„. å¦‚æœåœ¨å…¶ä»–ç›®å½•ä¸‹, æ¯”å¦‚ Desktop ç­‰, å¯èƒ½ä¸ä¼šæˆåŠŸçœ‹åˆ°å›¾. æ¯”å¦‚åœ¨ä¸‹é¢è¿™ä¸ªç›®å½•, ä½ è¦ cd åˆ° project è¿™ä¸ªåœ°æ–¹æ‰§è¡Œ /project &gt; tensorboard --logdir logs - project - logs model.py env.py æœ‰çš„æœ‹å‹ä½¿ç”¨ anaconda ä¸‹çš„ python3.5 çš„è™šæ‹Ÿç¯å¢ƒ, å¦‚æœä½ è¾“å…¥ tensorboard çš„æŒ‡ä»¤, å‡ºç°æŠ¥é”™: &quot;tensorboard&quot; is not recognized as an internal or external command... è§£å†³æ–¹æ³•çš„å…³é”®å°±æ˜¯éœ€è¦æ¿€æ´»TensorFlow. ç®¡ç†å‘˜æ¨¡å¼æ‰“å¼€ Anaconda Prompt, è¾“å…¥ activate tensorflow, æ¥ç€æŒ‰ç…§ä¸Šé¢çš„æµç¨‹æ‰§è¡Œ tensorboard æŒ‡ä»¤. Reference tensorflow.org è«çƒ¦Python è«çƒ¦ä»£ç  tf14_tensorboard/full_code.py","categories":[{"name":"tensorflow","slug":"tensorflow","permalink":"http://iequa.com/categories/tensorflow/"}],"tags":[{"name":"tensorflow","slug":"tensorflow","permalink":"http://iequa.com/tags/tensorflow/"}]},{"title":"Tensorflow Speed Up Training","slug":"tensorflow/tf-3.3-A-speed-up-learning","date":"2018-09-12T01:10:21.000Z","updated":"2020-07-03T03:32:25.512Z","comments":true,"path":"2018/09/12/tensorflow/tf-3.3-A-speed-up-learning/","link":"","permalink":"http://iequa.com/2018/09/12/tensorflow/tf-3.3-A-speed-up-learning/","excerpt":"æ€ä¹ˆæ ·åŠ é€Ÿä½ çš„ç¥ç»ç½‘ç»œè®­ç»ƒè¿‡ç¨‹. Speed Up Training","text":"æ€ä¹ˆæ ·åŠ é€Ÿä½ çš„ç¥ç»ç½‘ç»œè®­ç»ƒè¿‡ç¨‹. Speed Up Training å­¦ä¹ èµ„æ–™: cs231n å„ç§ Optimizer çš„å¯¹æ¯” é“¾æ¥ (è‹±æ–‡) Tensorflow çš„å¯ç”¨ Optimizer é“¾æ¥ Improving DNN (week2) Optimization Algorithm é“¾æ¥ åŒ…æ‹¬ä»¥ä¸‹å‡ ç§æ¨¡å¼: Stochastic Gradient Descent (SGD) Momentum AdaGrad RMSProp Adam è¶Šå¤æ‚çš„ç¥ç»ç½‘ç»œ , è¶Šå¤šçš„æ•°æ® , æˆ‘ä»¬éœ€è¦åœ¨è®­ç»ƒç¥ç»ç½‘ç»œçš„è¿‡ç¨‹ä¸ŠèŠ±è´¹çš„æ—¶é—´ä¹Ÿå°±è¶Šå¤š. åŸå› å¾ˆç®€å•, å°±æ˜¯å› ä¸ºè®¡ç®—é‡å¤ªå¤§äº†. å¯æ˜¯å¾€å¾€æœ‰æ—¶å€™ä¸ºäº†è§£å†³å¤æ‚çš„é—®é¢˜, å¤æ‚çš„ç»“æ„å’Œå¤§æ•°æ®åˆæ˜¯ä¸èƒ½é¿å…çš„, æ‰€ä»¥æˆ‘ä»¬éœ€è¦å¯»æ‰¾ä¸€äº›æ–¹æ³•, è®©ç¥ç»ç½‘ç»œèªæ˜èµ·æ¥, å¿«èµ·æ¥. 1. Stochastic Gradient Descent (SGD) æ‰€ä»¥, æœ€åŸºç¡€çš„æ–¹æ³•å°±æ˜¯ SGD å•¦, æƒ³åƒçº¢è‰²æ–¹å—æ˜¯æˆ‘ä»¬è¦è®­ç»ƒçš„ data, å¦‚æœç”¨æ™®é€šçš„è®­ç»ƒæ–¹æ³•, å°±éœ€è¦é‡å¤ä¸æ–­çš„æŠŠæ•´å¥—æ•°æ®æ”¾å…¥ç¥ç»ç½‘ç»œ NN è®­ç»ƒ, è¿™æ ·æ¶ˆè€—çš„è®¡ç®—èµ„æºä¼šå¾ˆå¤§. æˆ‘ä»¬æ¢ä¸€ç§æ€è·¯, å¦‚æœæŠŠè¿™äº›æ•°æ®æ‹†åˆ†æˆå°æ‰¹å°æ‰¹çš„, ç„¶åå†åˆ†æ‰¹ä¸æ–­æ”¾å…¥ NN ä¸­è®¡ç®—, è¿™å°±æ˜¯æˆ‘ä»¬å¸¸è¯´çš„ SGD çš„æ­£ç¡®æ‰“å¼€æ–¹å¼äº†. æ¯æ¬¡ä½¿ç”¨æ‰¹æ•°æ®, è™½ç„¶ä¸èƒ½åæ˜ æ•´ä½“æ•°æ®çš„æƒ…å†µ, ä¸è¿‡å´å¾ˆå¤§ç¨‹åº¦ä¸ŠåŠ é€Ÿäº† NN çš„è®­ç»ƒè¿‡ç¨‹, è€Œä¸”ä¹Ÿä¸ä¼šä¸¢å¤±å¤ªå¤šå‡†ç¡®ç‡.å¦‚æœè¿ç”¨ä¸Šäº† SGD, ä½ è¿˜æ˜¯å«Œè®­ç»ƒé€Ÿåº¦æ…¢, é‚£æ€ä¹ˆåŠ? æ²¡é—®é¢˜, äº‹å®è¯æ˜, SGD å¹¶ä¸æ˜¯æœ€å¿«é€Ÿçš„è®­ç»ƒæ–¹æ³•, çº¢è‰²çš„çº¿æ˜¯ SGD, ä½†å®ƒåˆ°è¾¾å­¦ä¹ ç›®æ ‡çš„æ—¶é—´æ˜¯åœ¨è¿™äº›æ–¹æ³•ä¸­æœ€é•¿çš„ä¸€ç§. æˆ‘ä»¬è¿˜æœ‰å¾ˆå¤šå…¶ä»–çš„é€”å¾„æ¥åŠ é€Ÿè®­ç»ƒ. 2. Momentum æ›´æ–°æ–¹æ³• å¤§å¤šæ•°å…¶ä»–é€”å¾„æ˜¯åœ¨æ›´æ–°ç¥ç»ç½‘ç»œå‚æ•°é‚£ä¸€æ­¥ä¸ŠåŠ¨åŠ¨æ‰‹è„š. ä¼ ç»Ÿçš„å‚æ•° W çš„æ›´æ–°æ˜¯æŠŠåŸå§‹çš„ W ç´¯åŠ ä¸Šä¸€ä¸ªè´Ÿçš„å­¦ä¹ ç‡(learning rate) ä¹˜ä»¥æ ¡æ­£å€¼ (dx). è¿™ç§æ–¹æ³•å¯èƒ½ä¼šè®©å­¦ä¹ è¿‡ç¨‹æ›²æŠ˜æ— æ¯”, çœ‹èµ·æ¥åƒ å–é†‰çš„äººå›å®¶æ—¶, æ‘‡æ‘‡æ™ƒæ™ƒèµ°äº†å¾ˆå¤šå¼¯è·¯. æ‰€ä»¥æˆ‘ä»¬æŠŠè¿™ä¸ªäººä»å¹³åœ°ä¸Šæ”¾åˆ°äº†ä¸€ä¸ªæ–œå¡ä¸Š, åªè¦ä»–å¾€ä¸‹å¡çš„æ–¹å‘èµ°ä¸€ç‚¹ç‚¹, ç”±äºå‘ä¸‹çš„æƒ¯æ€§, ä»–ä¸è‡ªè§‰åœ°å°±ä¸€ç›´å¾€ä¸‹èµ°, èµ°çš„å¼¯è·¯ä¹Ÿå˜å°‘äº†. è¿™å°±æ˜¯ Momentum å‚æ•°æ›´æ–°. å¦å¤–ä¸€ç§åŠ é€Ÿæ–¹æ³•å« AdaGrad. 3. AdaGrad æ›´æ–°æ–¹æ³• è¿™ç§æ–¹æ³•æ˜¯åœ¨å­¦ä¹ ç‡ä¸Šé¢åŠ¨æ‰‹è„š, ä½¿å¾—æ¯ä¸€ä¸ªå‚æ•°æ›´æ–°éƒ½ä¼šæœ‰è‡ªå·±ä¸ä¼—ä¸åŒçš„å­¦ä¹ ç‡, ä»–çš„ä½œç”¨å’Œ momentum ç±»ä¼¼, ä¸è¿‡ä¸æ˜¯ç»™å–é†‰é…’çš„äººå®‰æ’å¦ä¸€ä¸ªä¸‹å¡, è€Œæ˜¯ç»™ä»–ä¸€åŒä¸å¥½èµ°è·¯çš„é‹å­, ä½¿å¾—ä»–ä¸€æ‘‡æ™ƒç€èµ°è·¯å°±è„šç–¼, é‹å­æˆä¸ºäº†èµ°å¼¯è·¯çš„é˜»åŠ›, é€¼ç€ä»–å¾€å‰ç›´ç€èµ°. ä»–çš„æ•°å­¦å½¢å¼æ˜¯è¿™æ ·çš„. æ¥ä¸‹æ¥åˆæœ‰ä»€ä¹ˆæ–¹æ³•å‘¢? å¦‚æœæŠŠä¸‹å¡å’Œä¸å¥½èµ°è·¯çš„é‹å­åˆå¹¶èµ·æ¥, æ˜¯ä¸æ˜¯æ›´å¥½å‘¢? æ²¡é”™, è¿™æ ·æˆ‘ä»¬å°±æœ‰äº† RMSProp æ›´æ–°æ–¹æ³•. 4. RMSProp æ›´æ–°æ–¹æ³• æœ‰äº† momentum çš„æƒ¯æ€§åŸåˆ™ , åŠ ä¸Š adagrad çš„å¯¹é”™è¯¯æ–¹å‘çš„é˜»åŠ›, æˆ‘ä»¬å°±èƒ½åˆå¹¶æˆè¿™æ ·. è®© RMSPropåŒæ—¶å…·å¤‡ä»–ä»¬ä¸¤ç§æ–¹æ³•çš„ä¼˜åŠ¿. ä¸è¿‡ç»†å¿ƒçš„åŒå­¦ä»¬è‚¯å®šçœ‹å‡ºæ¥äº†, ä¼¼ä¹åœ¨ RMSProp ä¸­å°‘äº†äº›ä»€ä¹ˆ. åŸæ¥æ˜¯æˆ‘ä»¬è¿˜æ²¡æŠŠ Momentumåˆå¹¶å®Œå…¨, RMSProp è¿˜ç¼ºå°‘äº† momentum ä¸­çš„ è¿™ä¸€éƒ¨åˆ†. æ‰€ä»¥, æˆ‘ä»¬åœ¨ Adam æ–¹æ³•ä¸­è¡¥ä¸Šäº†è¿™ç§æƒ³æ³•. 5. Adam æ›´æ–°æ–¹æ³• è®¡ç®—m æ—¶æœ‰ momentum ä¸‹å¡çš„å±æ€§, è®¡ç®— v æ—¶æœ‰ adagrad é˜»åŠ›çš„å±æ€§, ç„¶åå†æ›´æ–°å‚æ•°æ—¶ æŠŠ m å’Œ V éƒ½è€ƒè™‘è¿›å». å®éªŒè¯æ˜, å¤§å¤šæ•°æ—¶å€™, ä½¿ç”¨ adam éƒ½èƒ½åˆå¿«åˆå¥½çš„è¾¾åˆ°ç›®æ ‡, è¿…é€Ÿæ”¶æ•›. æ‰€ä»¥è¯´, åœ¨åŠ é€Ÿç¥ç»ç½‘ç»œè®­ç»ƒçš„æ—¶å€™, ä¸€ä¸ªä¸‹å¡, ä¸€åŒç ´é‹å­, åŠŸä¸å¯æ²¡. Reference tensorflow.org è«çƒ¦Python","categories":[{"name":"tensorflow","slug":"tensorflow","permalink":"http://iequa.com/categories/tensorflow/"}],"tags":[{"name":"tensorflow","slug":"tensorflow","permalink":"http://iequa.com/tags/tensorflow/"}]},{"title":"numpy.random.normal å‡½æ•°","slug":"python/numpy-pandas/py-numpy-9-numpy.random.normal","date":"2018-09-11T08:16:21.000Z","updated":"2019-10-20T04:30:35.001Z","comments":true,"path":"2018/09/11/python/numpy-pandas/py-numpy-9-numpy.random.normal/","link":"","permalink":"http://iequa.com/2018/09/11/python/numpy-pandas/py-numpy-9-numpy.random.normal/","excerpt":"numpy.random.normal å‡½æ•°ï¼Œæœ‰ä¸‰ä¸ªå‚æ•°ï¼ˆloc, scale, sizeï¼‰ï¼Œä»£è¡¨ç”Ÿæˆçš„é«˜æ–¯åˆ†å¸ƒéšæœºæ•°çš„å‡å€¼ã€æ–¹å·®ä»¥åŠè¾“å‡ºçš„ size.","text":"numpy.random.normal å‡½æ•°ï¼Œæœ‰ä¸‰ä¸ªå‚æ•°ï¼ˆloc, scale, sizeï¼‰ï¼Œä»£è¡¨ç”Ÿæˆçš„é«˜æ–¯åˆ†å¸ƒéšæœºæ•°çš„å‡å€¼ã€æ–¹å·®ä»¥åŠè¾“å‡ºçš„ size. ä¾‹å­ï¼š np.random.normal(0, 0.05, (7,1)).astype(np.float32) Output : array([[-0.05229944], [ 0.01754326], [ 0.01764081], [-0.03058357], [-0.05406121], [-0.07284269], [ 0.00289147]], dtype=float32) Scipy Help: numpy.random.normal Parameters: loc : float or array_like of floatsMean (â€œcentreâ€) of the distribution.scale : float or array_like of floatsStandard deviation (spread or â€œwidthâ€) of the distribution.size : int or tuple of ints, optionalOutput shape. If the given shape is, e.g., (m, n, k), then m * n * k samples are drawn. If size is None (default), a single value is returned if loc and scale are both scalars. Otherwise, np.broadcast(loc, scale).size samples are drawn.Returns: out : ndarray or scalarDrawn samples from the parameterized normal distribution. Reference numpy.random.normal","categories":[{"name":"python","slug":"python","permalink":"http://iequa.com/categories/python/"}],"tags":[{"name":"numpy","slug":"numpy","permalink":"http://iequa.com/tags/numpy/"}]},{"title":"numpy.newaxis è½¬å˜çŸ©é˜µçš„å½¢ç‹€","slug":"python/numpy-pandas/py-numpy-9-newaxis","date":"2018-09-11T07:37:21.000Z","updated":"2019-10-20T04:30:35.000Z","comments":true,"path":"2018/09/11/python/numpy-pandas/py-numpy-9-newaxis/","link":"","permalink":"http://iequa.com/2018/09/11/python/numpy-pandas/py-numpy-9-newaxis/","excerpt":"æœ‰ä¸€å€‹ä¸€ç¶­é™£åˆ— x1ï¼Œæˆ‘åˆ†åˆ¥æƒ³è¦æŠŠå®ƒè®Šæˆä¸€å€‹ 3*1 çš„çŸ©é™£ x2ï¼Œä»¥åŠ 1*3 çš„çŸ©é™£ x3ï¼Œä½œæ³•å¦‚ä¸‹ã€‚","text":"æœ‰ä¸€å€‹ä¸€ç¶­é™£åˆ— x1ï¼Œæˆ‘åˆ†åˆ¥æƒ³è¦æŠŠå®ƒè®Šæˆä¸€å€‹ 3*1 çš„çŸ©é™£ x2ï¼Œä»¥åŠ 1*3 çš„çŸ©é™£ x3ï¼Œä½œæ³•å¦‚ä¸‹ã€‚ import numpy as npx1 = np.array([10, 20, 30], float)# æœ‰ä¸€å€‹ä¸€ç¶­é™£åˆ—x1ï¼Œæˆ‘åˆ†åˆ¥æƒ³è¦æŠŠå®ƒè®Šæˆä¸€å€‹ 3*1 çš„çŸ©é™£x2ï¼Œä»¥åŠ 1*3 çš„çŸ©é™£x3ï¼Œä½œæ³•å¦‚ä¸‹ã€‚print(&quot;shape of x1 is &quot;, x1.shape)print(x1)print(&quot;-------------&quot;)x2 = x1[:, np.newaxis]print(&quot;shape of x2 is &quot;, x2.shape)print(x2)print(&quot;-------------&quot;)x3 = x1[np.newaxis, :]print(&quot;shape of x3 is &quot;, x3.shape)print(x3) output: shape of x1 is (3,)[ 10. 20. 30.]-------------shape of x2 is (3, 1)[[ 10.] [ 20.] [ 30.]]-------------shape of x3 is (1, 3)[[ 10. 20. 30.]] Reference åˆ©ç”¨numpyçš„newaxisè½‰è®ŠçŸ©é™£çš„å½¢ç‹€","categories":[{"name":"python","slug":"python","permalink":"http://iequa.com/categories/python/"}],"tags":[{"name":"newaxis","slug":"newaxis","permalink":"http://iequa.com/tags/newaxis/"}]},{"title":"Tensorflow ä¾‹å­3 ï¼š å»ºé€ ç¥ç»ç½‘ç»œ","slug":"tensorflow/tf-3.2-create-NN","date":"2018-09-11T06:37:21.000Z","updated":"2020-07-03T03:32:32.282Z","comments":true,"path":"2018/09/11/tensorflow/tf-3.2-create-NN/","link":"","permalink":"http://iequa.com/2018/09/11/tensorflow/tf-3.2-create-NN/","excerpt":"è¿™æ¬¡æåˆ°äº†æ€æ ·å»ºé€ ä¸€ä¸ªå®Œæ•´çš„ç¥ç»ç½‘ç»œ, åŒ…æ‹¬æ·»åŠ  ç¥ç»å±‚, è®¡ç®—è¯¯å·®, è®­ç»ƒæ­¥éª¤, åˆ¤æ–­æ˜¯å¦åœ¨å­¦ä¹ .","text":"è¿™æ¬¡æåˆ°äº†æ€æ ·å»ºé€ ä¸€ä¸ªå®Œæ•´çš„ç¥ç»ç½‘ç»œ, åŒ…æ‹¬æ·»åŠ  ç¥ç»å±‚, è®¡ç®—è¯¯å·®, è®­ç»ƒæ­¥éª¤, åˆ¤æ–­æ˜¯å¦åœ¨å­¦ä¹ . 1. add_layer åŠŸèƒ½é¦–å…ˆï¼Œæˆ‘ä»¬å¯¼å…¥æœ¬æ¬¡æ‰€éœ€çš„æ¨¡å— import tensorflow as tfimport numpy as np# æ„é€ æ·»åŠ ä¸€ä¸ªç¥ç»å±‚çš„å‡½æ•°def add_layer(inputs, in_size, out_size, activation_function=None): Weights = tf.Variable(tf.random_normal([in_size, out_size])) biases = tf.Variable(tf.zeros([1, out_size]) + 0.1) Wx_plus_b = tf.matmul(inputs, Weights) + biases if activation_function is None: outputs = Wx_plus_b else: outputs = activation_function(Wx_plus_b) return outputs TensorFlowéšæœºå€¼: tf.random_normalå‡½æ•°ï¼š å°†è¿”å›ä¸€ä¸ªæŒ‡å®šå½¢çŠ¶çš„å¼ é‡ï¼Œé€šè¿‡éšæœºçš„æ­£å¸¸å€¼å¡«å…… tf.random_normal(shape, mean=0.0, stddev=1.0, dtype=tf.float32, seed=None, name=None) 2. å¯¼å…¥æ•°æ®æ„å»ºæ‰€éœ€çš„æ•°æ®ã€‚ è¿™é‡Œçš„ x_data å’Œ y_data å¹¶ä¸æ˜¯ä¸¥æ ¼çš„ä¸€å…ƒäºŒæ¬¡å‡½æ•°çš„å…³ç³»ï¼Œå› ä¸ºæˆ‘ä»¬å¤šåŠ äº†ä¸€ä¸ª noise, è¿™æ ·çœ‹èµ·æ¥ä¼šæ›´åƒçœŸå®æƒ…å†µ x_data = np.linspace(-1,1,300, dtype=np.float32)[:, np.newaxis]# numpy.linspace(start, stop, num=50, endpoint=True, retstep=False, dtype=None)# å¾—åˆ° 300 ä¸ªå¤§å°çš„ä¸€ç»´æ•°ç»„ï¼Œ é€šè¿‡ [:, np.newaxis] è¡Œå˜åˆ—ï¼Œå˜ä¸º 300 è¡Œï¼Œ1 åˆ— çš„äºŒç»´ æ•°ç»„# numpy.random.normal(loc=0.0 å‡å€¼, scale=1.0 æ ‡å‡†å·®, size=None å½¢çŠ¶)noise = np.random.normal(0, 0.05, x_data.shape).astype(np.float32)y_data = np.square(x_data) - 0.5 + noise# åˆ©ç”¨å ä½ç¬¦å®šä¹‰æˆ‘ä»¬æ‰€éœ€çš„ç¥ç»ç½‘ç»œçš„è¾“å…¥ã€‚ `tf.placeholder()` å°±æ˜¯ä»£è¡¨å ä½ç¬¦# è¿™é‡Œçš„ `None` ä»£è¡¨æ— è®ºè¾“å…¥æœ‰å¤šå°‘éƒ½å¯ä»¥ï¼Œå› ä¸ºè¾“å…¥åªæœ‰ä¸€ä¸ªç‰¹å¾ï¼Œæ‰€ä»¥è¿™é‡Œæ˜¯ `1`ã€‚xs = tf.placeholder(tf.float32, [None, 1])ys = tf.placeholder(tf.float32, [None, 1]) æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°±å¯ä»¥å¼€å§‹å®šä¹‰ç¥ç»å±‚äº†ã€‚ é€šå¸¸ç¥ç»å±‚éƒ½åŒ…æ‹¬ inputè¾“å…¥å±‚ã€hideéšè—å±‚ å’Œ outputè¾“å‡ºå±‚ã€‚è¿™é‡Œçš„è¾“å…¥å±‚åªæœ‰ä¸€ä¸ªå±æ€§ï¼Œ æ‰€ä»¥æˆ‘ä»¬å°±åªæœ‰ä¸€ä¸ªè¾“å…¥ï¼›éšè—å±‚æˆ‘ä»¬å¯ä»¥è‡ªå·±å‡è®¾ï¼Œè¿™é‡Œæˆ‘ä»¬å‡è®¾éšè—å±‚æœ‰10ä¸ªç¥ç»å…ƒï¼› è¾“å‡ºå±‚å’Œè¾“å…¥å±‚çš„ç»“æ„æ˜¯ä¸€æ ·çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬çš„è¾“å‡ºå±‚ä¹Ÿæ˜¯åªæœ‰ä¸€å±‚ã€‚ æ‰€ä»¥ï¼Œæˆ‘ä»¬æ„å»ºçš„æ˜¯â€”â€”è¾“å…¥å±‚1ä¸ªã€éšè—å±‚10ä¸ªã€è¾“å‡ºå±‚1ä¸ªçš„ç¥ç»ç½‘ç»œã€‚ 3. æ­å»ºç½‘ç»œ# å®šä¹‰ hideéšè—å±‚ï¼Œ åˆ©ç”¨ä¹‹å‰çš„ `add_layer()` å‡½æ•°ï¼Œè¿™é‡Œä½¿ç”¨ Tensorflow è‡ªå¸¦çš„æ¿€åŠ±å‡½æ•° `tf.nn.relu`ã€‚l1 = add_layer(xs, 1, 10, activation_function=tf.nn.relu)# æ¥ç€ï¼Œå®šä¹‰è¾“å‡ºå±‚ã€‚æ­¤æ—¶çš„è¾“å…¥å°±æ˜¯éšè—å±‚çš„è¾“å‡º â€”â€” `l1`ï¼Œè¾“å…¥æœ‰ 10 å±‚ï¼ˆéšè—å±‚çš„è¾“å‡ºå±‚ï¼‰ï¼Œè¾“å‡ºæœ‰ 1 å±‚ã€‚prediction = add_layer(l1, 10, 1, activation_function=None)# è®¡ç®—é¢„æµ‹å€¼ `prediction` å’Œ çœŸå®å€¼çš„è¯¯å·®ï¼Œå¯¹äºŒè€…å·®çš„å¹³æ–¹æ±‚å’Œå†å–å¹³å‡ã€‚loss = tf.reduce_mean(tf.reduce_sum(tf.square(ys - prediction), reduction_indices=[1]))# æ¥ä¸‹æ¥ï¼Œæ˜¯å¾ˆå…³é”®çš„ä¸€æ­¥ï¼Œå¦‚ä½•è®©æœºå™¨å­¦ä¹ æå‡å®ƒçš„å‡†ç¡®ç‡ã€‚# `tf.train.GradientDescentOptimizer()` ä¸­çš„å€¼é€šå¸¸éƒ½å°äº `1`ï¼Œè¿™é‡Œå–çš„æ˜¯ `0.1`ï¼Œä»£è¡¨ä»¥ `0.1` çš„æ•ˆç‡æ¥æœ€å°åŒ–è¯¯å·® `loss`ã€‚train_step = tf.train.GradientDescentOptimizer(0.1).minimize(loss)# ä½¿ç”¨å˜é‡æ—¶ï¼Œéƒ½è¦å¯¹å®ƒè¿›è¡Œåˆå§‹åŒ–ï¼Œè¿™æ˜¯å¿…ä¸å¯å°‘çš„ã€‚init = tf.global_variables_initializer() # æ›¿æ¢æˆè¿™æ ·å°±å¥½# å®šä¹‰ `Session`ï¼Œå¹¶ç”¨ `Session` æ¥æ‰§è¡Œ `init` åˆå§‹åŒ–æ­¥éª¤ã€‚ #ï¼ˆæ³¨æ„ï¼šåœ¨ `tensorflow` ä¸­ï¼Œåªæœ‰session.run()æ‰ä¼šæ‰§è¡Œæˆ‘ä»¬å®šä¹‰çš„è¿ç®—ã€‚ï¼‰sess = tf.Session()sess.run(init) 4. è®­ç»ƒä¸‹é¢ï¼Œè®©æœºå™¨å¼€å§‹å­¦ä¹ ã€‚ æ¯”å¦‚è¿™é‡Œï¼Œæˆ‘ä»¬è®©æœºå™¨å­¦ä¹ 1000æ¬¡ã€‚æœºå™¨å­¦ä¹ çš„å†…å®¹æ˜¯ train_step, ç”¨ Session æ¥ run æ¯ä¸€æ¬¡ training çš„æ•°æ®ï¼Œé€æ­¥æå‡ç¥ç»ç½‘ç»œçš„é¢„æµ‹å‡†ç¡®æ€§ã€‚ (æ³¨æ„ï¼šå½“è¿ç®—è¦ç”¨åˆ° placeholder æ—¶ï¼Œå°±éœ€è¦ feed_dict è¿™ä¸ªå­—å…¸æ¥æŒ‡å®šè¾“å…¥ã€‚) for i in range(1000): # training sess.run(train_step, feed_dict=&#123;xs: x_data, ys: y_data&#125;) # æ¯ 50 æ­¥ æˆ‘ä»¬è¾“å‡ºä¸€ä¸‹æœºå™¨å­¦ä¹ çš„è¯¯å·®ã€‚ if i % 50 == 0: print(sess.run(loss, feed_dict=&#123;xs: x_data, ys: y_data&#125;)) åœ¨ç”µè„‘ä¸Šè¿è¡Œæœ¬æ¬¡ä»£ç çš„ç»“æœä¸ºï¼š 0.05878680.004164270.003126240.002913270.002820260.00275770.002705460.002669430.002652780.00263559 é€šè¿‡ä¸Šå›¾å¯ä»¥çœ‹å‡ºï¼Œè¯¯å·®åœ¨é€æ¸å‡å°ï¼Œè¿™è¯´æ˜æœºå™¨å­¦ä¹ æ˜¯æœ‰ç§¯æçš„æ•ˆæœçš„ Reference tensorflow.org è«çƒ¦Python Tensorflow æä¾›çš„ä¸€äº› æ¿€åŠ±å‡½æ•° åˆ©ç”¨numpyçš„newaxisè½‰è®ŠçŸ©é™£çš„å½¢ç‹€","categories":[{"name":"tensorflow","slug":"tensorflow","permalink":"http://iequa.com/categories/tensorflow/"}],"tags":[{"name":"tensorflow","slug":"tensorflow","permalink":"http://iequa.com/tags/tensorflow/"}]},{"title":"Tensorflow ä¾‹å­3 ï¼š æ·»åŠ å±‚ def add_layer()","slug":"tensorflow/tf-3.1-add-layer","date":"2018-09-09T01:37:21.000Z","updated":"2020-07-03T03:32:37.901Z","comments":true,"path":"2018/09/09/tensorflow/tf-3.1-add-layer/","link":"","permalink":"http://iequa.com/2018/09/09/tensorflow/tf-3.1-add-layer/","excerpt":"åœ¨ Tensorflow é‡Œå®šä¹‰ä¸€ä¸ª æ·»åŠ å±‚çš„å‡½æ•°ï¼Œ å¯ä»¥å¾ˆå®¹æ˜“çš„ æ·»åŠ ç¥ç»å±‚, ä¸ºä¹‹åçš„æ·»åŠ çœä¸‹ä¸å°‘æ—¶é—´.","text":"åœ¨ Tensorflow é‡Œå®šä¹‰ä¸€ä¸ª æ·»åŠ å±‚çš„å‡½æ•°ï¼Œ å¯ä»¥å¾ˆå®¹æ˜“çš„ æ·»åŠ ç¥ç»å±‚, ä¸ºä¹‹åçš„æ·»åŠ çœä¸‹ä¸å°‘æ—¶é—´. å®šä¹‰ add_layer()ç¥ç»å±‚é‡Œå¸¸è§çš„å‚æ•°é€šå¸¸æœ‰ weightsã€biases å’Œæ¿€åŠ±å‡½æ•°ã€‚ é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦å¯¼å…¥ tensorflow æ¨¡å—ã€‚ import tensorflow as tf ç„¶åå®šä¹‰æ·»åŠ ç¥ç»å±‚çš„å‡½æ•° def add_layer(), å®ƒæœ‰å››ä¸ªå‚æ•°ï¼šè¾“å…¥å€¼ã€è¾“å…¥çš„å¤§å°ã€è¾“å‡ºçš„å¤§å°å’Œæ¿€åŠ±å‡½æ•°ï¼Œæˆ‘ä»¬è®¾å®šé»˜è®¤çš„æ¿€åŠ±å‡½æ•°æ˜¯ Noneã€‚ def add_layer(inputs, in_size, out_size, activation_function=None): æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å¼€å§‹å®šä¹‰ weights å’Œ biasesã€‚ å› ä¸ºåœ¨ç”Ÿæˆåˆå§‹å‚æ•°æ—¶ï¼Œéšæœºå˜é‡(normal distribution)ä¼šæ¯”å…¨éƒ¨ä¸º0è¦å¥½å¾ˆå¤šï¼Œæ‰€ä»¥æˆ‘ä»¬è¿™é‡Œçš„ weights ä¸ºä¸€ä¸ª in_size è¡Œ, out_size åˆ—çš„éšæœºå˜é‡çŸ©é˜µã€‚ Weights = tf.Variable(tf.random_normal([in_size, out_size])) åœ¨æœºå™¨å­¦ä¹ ä¸­ï¼Œbiases çš„æ¨èå€¼ä¸ä¸º0ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿™é‡Œæ˜¯åœ¨0å‘é‡çš„åŸºç¡€ä¸ŠåˆåŠ äº†0.1ã€‚ biases = tf.Variable(tf.zeros([1, out_size]) + 0.1) ä¸‹é¢ï¼Œæˆ‘ä»¬å®šä¹‰ Wx_plus_b, å³ç¥ç»ç½‘ç»œæœªæ¿€æ´»çš„å€¼ã€‚å…¶ä¸­ï¼Œtf.matmul() æ˜¯çŸ©é˜µçš„ä¹˜æ³•ã€‚ Wx_plus_b = tf.matmul(inputs, Weights) + biases å½“ activation_function ä¸º None æ—¶ï¼Œè¾“å‡ºå°±æ˜¯å½“å‰çš„é¢„æµ‹å€¼ Wx_plus_bï¼Œä¸ä¸º None æ—¶ï¼Œå°±æŠŠ Wx_plus_b ä¼ åˆ° activation_function() å‡½æ•°ä¸­å¾—åˆ°è¾“å‡ºã€‚ if activation_function is None: outputs = Wx_plus_belse: outputs = activation_function(Wx_plus_b) æœ€åï¼Œè¿”å›è¾“å‡ºï¼Œæ·»åŠ ä¸€ä¸ªç¥ç»å±‚çš„å‡½æ•° def add_layer() å°±å®šä¹‰å¥½äº†ã€‚ return outputs Reference tensorflow.org è«çƒ¦Python Tensorflow æä¾›çš„ä¸€äº› æ¿€åŠ±å‡½æ•°","categories":[{"name":"tensorflow","slug":"tensorflow","permalink":"http://iequa.com/categories/tensorflow/"}],"tags":[{"name":"tensorflow","slug":"tensorflow","permalink":"http://iequa.com/tags/tensorflow/"}]},{"title":"CNN (week4) - Face recognition & Neural style transfer","slug":"deeplearning/Convolutional-Neural-Networks-week4","date":"2018-09-08T07:00:21.000Z","updated":"2019-10-20T04:30:35.014Z","comments":true,"path":"2018/09/08/deeplearning/Convolutional-Neural-Networks-week4/","link":"","permalink":"http://iequa.com/2018/09/08/deeplearning/Convolutional-Neural-Networks-week4/","excerpt":"Face recognition &amp; Neural style transfer èƒ½å¤Ÿåœ¨å›¾åƒã€è§†é¢‘ä»¥åŠå…¶ä»– 2D æˆ– 3D æ•°æ®ä¸Šåº”ç”¨è¿™äº›ç®—æ³•ã€‚","text":"Face recognition &amp; Neural style transfer èƒ½å¤Ÿåœ¨å›¾åƒã€è§†é¢‘ä»¥åŠå…¶ä»– 2D æˆ– 3D æ•°æ®ä¸Šåº”ç”¨è¿™äº›ç®—æ³•ã€‚ 1. What is face recognition?è¿™ä¸€èŠ‚ä¸­çš„äººè„¸è¯†åˆ«æŠ€æœ¯çš„æ¼”ç¤ºçš„ç¡®å¾ˆNBâ€¦, æ¼”æŠ€ä¸é”™ï¼ŒğŸ˜„ 2. One Shot Learningä½œä¸ºè€æ¿å¸Œæœ›ä¸æ—¶ä¿±è¿›ï¼Œæ‰€ä»¥æƒ³ä½¿ç”¨äººè„¸è¯†åˆ«æŠ€æœ¯æ¥å®ç°æ‰“å¡ã€‚ å‡å¦‚æˆ‘ä»¬å…¬å¸åªæœ‰4ä¸ªå‘˜å·¥ï¼ŒæŒ‰ç…§ä¹‹å‰çš„æ€è·¯æˆ‘ä»¬è®­ç»ƒçš„ç¥ç»ç½‘ç»œæ¨¡å‹åº”è¯¥å¦‚ä¸‹ï¼š å¦‚å›¾ç¤ºï¼Œè¾“å…¥ä¸€å¼ å›¾åƒï¼Œç»è¿‡CNNï¼Œæœ€åå†é€šè¿‡ Softmax è¾“å‡º 5 ä¸ªå¯èƒ½å€¼çš„å¤§å° (4ä¸ªå‘˜å·¥ä¸­çš„ä¸€ä¸ªï¼Œæˆ–è€…éƒ½ä¸æ˜¯ï¼Œæ‰€ä»¥å…±5ç§å¯èƒ½æ€§)ã€‚ çœ‹èµ·æ¥å¥½åƒæ²¡ä»€ä¹ˆæ¯›ç—…ï¼Œä½†æ˜¯æˆ‘ä»¬è¦ç›¸ä¿¡æˆ‘ä»¬çš„å…¬å¸ä¼šè¶Šæ¥è¶Šå¥½å•Šï¼Œæ‰€ä»¥éš¾é“å…¬å¸æ¯å¢åŠ ä¸€ä¸ªäººå°±è¦é‡æ–°è®­ç»ƒCNN åŠ æœ€åä¸€å±‚çš„è¾“å‡ºæ•°é‡å— ï¼Ÿ one-shotï¼š è¿™æ˜¾ç„¶æœ‰é—®é¢˜ï¼Œæ‰€ä»¥æœ‰äººæå‡ºäº†ä¸€æ¬¡å­¦ä¹ (one-shot)ï¼Œæ›´å…·ä½“åœ°è¯´æ˜¯é€šè¿‡ä¸€ä¸ªå‡½æ•°æ¥æ±‚å‡ºè¾“å…¥å›¾åƒä¸æ•°æ®åº“ä¸­çš„å›¾åƒçš„å·®å¼‚åº¦ï¼Œç”¨ $d(img1,img2)$ è¡¨ç¤ºã€‚ å¦‚ä¸Šå›¾ç¤ºï¼Œå¦‚æœä¸¤ä¸ªå›¾åƒä¹‹é—´çš„å·®å¼‚åº¦ä¸å¤§äºæŸä¸€ä¸ªé˜ˆå€¼ Ï„ï¼Œé‚£ä¹ˆåˆ™è®¤ä¸ºä¸¤å¼ å›¾åƒæ˜¯åŒä¸€ä¸ªäººã€‚åä¹‹ï¼Œäº¦ç„¶ã€‚ ä¸‹ä¸€å°èŠ‚ä»‹ç»äº†å¦‚ä½•è®¡ç®—å·®å€¼ã€‚ 3. Siamese Networkæ³¨æ„ï¼šä¸‹å›¾ä¸­ä¸¤ä¸ªç½‘ç»œå‚æ•°æ˜¯ä¸€æ ·çš„ã€‚ å…ˆçœ‹ä¸Šé¢çš„ç½‘ç»œã€‚è®°è¾“å…¥å›¾åƒä¸º $x^{(1)}$ï¼Œç»è¿‡å·ç§¯å±‚ï¼Œæ± åŒ–å±‚ å’Œ å…¨è¿æ¥å±‚ åå¾—åˆ°äº†ç®­å¤´æ‰€æŒ‡ä½ç½®çš„æ•°æ® (ä¸€èˆ¬åé¢è¿˜ä¼šæ¥ä¸Š $softmax$ å±‚ï¼Œä½†åœ¨è¿™é‡Œæš‚æ—¶ä¸ç”¨ç®¡)ï¼Œå‡è®¾æœ‰ 128 ä¸ªèŠ‚ç‚¹ï¼Œè¯¥å±‚ç”¨ $f(x^{(1)})$ è¡¨ç¤ºï¼Œå¯ä»¥ç†è§£ä¸ºè¾“å…¥ $x^{(1)}$ çš„ç¼–ç ã€‚ é‚£ä¹ˆä¸‹ä¸€ä¸ªç½‘ç»œåŒç†ï¼Œä¸å†èµ˜è¿°ã€‚ å› æ­¤ä¸Šä¸€èŠ‚ä¸­æ‰€è¯´çš„å·®å¼‚åº¦å‡½æ•°å³ä¸º d(x^{(1)},x^{(2)})=||f(x^{(1)})-f(x^{(2)})||^2 é—®é¢˜çœ‹èµ·æ¥å¥½åƒè§£å†³äº†ï¼Œä½†æ„Ÿè§‰è¿˜æ¼äº†ç‚¹ä»€ä¹ˆã€‚ã€‚ç¥ç»ç½‘ç»œçš„å‚æ•°å’‹ç¡®å®šå•Šï¼Ÿä¹Ÿå°±æ˜¯è¯´ $f(x^{(i)})$ çš„å‚æ•°æ€ä¹ˆè®¡ç®—å‘¢ï¼Ÿ é¦–å…ˆå¯ä»¥å¾ˆæ˜ç¡®çš„æ˜¯å¦‚æœä¸¤ä¸ªå›¾åƒæ˜¯åŒä¸€ä¸ªäººï¼Œé‚£æ‰€å¾—åˆ°çš„å‚æ•°åº”è¯¥ä½¿å¾— $||f(x^{(1)})-f(x^{(2)})||^2$ çš„å€¼è¾ƒå°ï¼Œåä¹‹è¾ƒå¤§ã€‚ 4. Triplet Loss4.1 Learning Objectiveè¿™é‡Œé¦–å…ˆä»‹ç»ä¸€ä¸ªä¸‰å…ƒç»„ï¼Œå³ (Anchor, Positive, Negative)ï¼Œç®€å†™ä¸º(A,P,N) (A,P,N) ä¸‰å…ƒç»„ å„ä¸ªå«ä¹‰ Anchor å¯ä»¥ç†è§£ä¸ºç”¨äºè¯†åˆ«çš„å›¾åƒ ï¼ˆé”šï¼‰ Positive è¡¨ç¤ºæ˜¯è¿™ä¸ªäºº Negative è¡¨ç¤ºä¸æ˜¯åŒä¸€ä¸ªäºº ç”±ä¸Šä¸€èŠ‚ä¸­çš„æ€è·¯ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°å¦‚ä¸‹ä¸ç­‰å¼ï¼š $d(A,P)\\leqq d(A,N)$, å³ $||f(A)-f(P)||^2-||f(A)-f(N)||^2\\leqq0$ (å¦‚ä¸‹å›¾ç¤º) ä½†æ˜¯è¿™æ ·å­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼Œå³å¦‚æœç¥ç»ç½‘ç»œä»€ä¹ˆéƒ½æ²¡å­¦åˆ°ï¼Œè¿”å›çš„å€¼æ˜¯0ï¼Œä¹Ÿå°±æ˜¯è¯´å¦‚æœ $f(x)=\\vec{0}$ çš„è¯ï¼Œé‚£ä¹ˆè¿™ä¸ªä¸ç­‰å¼æ˜¯å§‹ç»ˆæˆç«‹çš„ã€‚(å¦‚ä¸‹å›¾ç¤º) ä¸ºäº†é¿å…ä¸Šè¿°ç‰¹æ®Šæƒ…å†µï¼Œä¸”å·¦è¾¹å€¼å¿…é¡»å°äº0ï¼Œæ‰€ä»¥åœ¨å³è¾¹å‡å»ä¸€ä¸ªå˜é‡Î±ï¼Œä½†æŒ‰ç…§æƒ¯ä¾‹æ˜¯åŠ ä¸Šä¸€ä¸ªå€¼ï¼Œæ‰€ä»¥å°†Î±åŠ åœ¨å·¦è¾¹ã€‚ ç»¼ä¸Šï¼Œæ‰€å¾—åˆ°çš„å‚æ•°éœ€è¦æ»¡è¶³å¦‚ä¸‹ä¸ç­‰å¼ ||f(A)-f(P)||^2-||f(A)-f(N)||^2+Î±\\leqq04.2 Lost functionä»‹ç»å®Œä¸‰å…ƒç»„åï¼Œæˆ‘ä»¬å¯ä»¥å¯¹å•ä¸ªå›¾åƒå®šä¹‰å¦‚ä¸‹çš„æŸå¤±å‡½æ•°(å¦‚ä¸‹å›¾ç¤º) L(A,P,N)=max(||f(A)-f(P)||^2-||f(A)-f(N)||^2+Î±,0) è§£é‡Šä¸€ä¸‹ä¸ºä»€ä¹ˆç”¨maxå‡½æ•°ï¼Œå› ä¸ºå¦‚æœåªè¦æ»¡è¶³ $||f(A)-f(P)||^2-||f(A)-f(N)||^2+Î±\\leqq0$ï¼Œæˆ‘ä»¬å°±è®¤ä¸ºå·²ç»æ­£ç¡®è¯†åˆ«å‡ºäº†å›¾åƒä¸­çš„äººï¼Œæ‰€ä»¥å¯¹äºè¯¥å›¾åƒçš„æŸå¤±å€¼æ˜¯ 0. æ‰€ä»¥æ€»çš„æŸå¤±å‡½æ•°æ˜¯ : $J=\\sum{L(A^{(i)},P^{(i)},N^{(i)})}$ è¦æ³¨æ„çš„æ˜¯ä½¿ç”¨è¿™ç§æ–¹æ³•è¦ä¿è¯æ¯ä¸€ä¸ªäººä¸æ­¢æœ‰ä¸€å¼ å›¾åƒï¼Œå¦åˆ™æ— æ³•è®­ç»ƒã€‚å¦å¤–è¦æ³¨æ„ä¸å‰é¢çš„ One-shot åŒºåˆ†å¼€æ¥ï¼Œè¿™é‡Œæ˜¯åœ¨è®­ç»ƒæ¨¡å‹ï¼Œæ‰€ä»¥è®­ç»ƒé›†çš„æ•°é‡è¦å¤šä¸€äº›ï¼Œæ¯ä¸ªäººè¦æœ‰å¤šå¼ ç…§ç‰‡ã€‚è€ŒOne-shotæ˜¯è¿›è¡Œæµ‹è¯•äº†ï¼Œæ‰€ä»¥åªéœ€ä¸€å¼ ç”¨äºè¾“å…¥çš„ç…§ç‰‡å³å¯ã€‚ 4.3 Choosing the triplets(A,P,N)è¿˜æœ‰ä¸€ä¸ªå¾ˆé‡è¦çš„é—®é¢˜å°±æ˜¯å¦‚ä½•é€‰æ‹©ä¸‰å…ƒç»„ (A,P,N)ã€‚å› ä¸ºå®é™…ä¸Šè¦æ»¡è¶³ä¸ç­‰å¼ $d(A,P)+Î±\\leqq d(A,N)$ æ˜¯æ¯”è¾ƒç®€å•çš„,å³åªè¦å°† Negative é€‰æ‹©çš„æ¯”è¾ƒæç«¯ä¾¿å¯ï¼Œæ¯”å¦‚ Anchor æ˜¯ä¸€ä¸ªå°å¥³å­©ï¼Œè€Œ Negative é€‰æ‹©ä¸€ä¸ªè€å¤§çˆ·ã€‚ æ‰€ä»¥è¿˜åº”è¯¥å°½é‡æ»¡è¶³ $d(A,N)\\approx{d(A,N)}$ 5. Face Verification and Binary Classificationé€šè¿‡ä»¥ä¸Šå†…å®¹ï¼Œæˆ‘ä»¬å¯ä»¥ç¡®å®šä¸‹å›¾ä¸­çš„ç½‘ç»œçš„å‚æ•°äº†ï¼Œé‚£ä¹ˆç°åœ¨å¼€å§‹è¿›è¡Œé¢éƒ¨éªŒè¯äº†ã€‚ ä¸Šé¢çš„æ˜¯æµ‹è¯•å›¾ï¼Œä¸‹é¢çš„æ˜¯æ•°æ®åº“ä¸­çš„ä¸€å¼ ç…§ç‰‡ å’Œä¹‹å‰ä¸€æ ·å‡è®¾ $f(x^{(i)})$ æœ‰ 128ä¸ªèŠ‚ç‚¹ï¼Œä¹‹åè¿™ä¸¤ä¸ªæ•°æ®ä½œä¸ºè¾“å…¥æ•°æ®è¾“å…¥åˆ°åé¢çš„é€»è¾‘å›å½’æ¨¡å‹ä¸­å»ï¼Œå³ \\hat{y} = Ïƒ(\\sum\\_{k=1}^{128}w\\_i|f(x^{(i)})\\_k-f(x^{(j)})\\_k|+b\\_i)è‹¥ $\\hat{y}=1$, ä¸ºåŒä¸€äººã€‚åä¹‹ï¼Œä¸æ˜¯ã€‚ å¦‚ä¸‹å›¾ç¤ºï¼Œç»¿è‰²ä¸‹åˆ’çº¿éƒ¨åˆ†å¯ä»¥ç”¨å…¶ä»–å…¬å¼æ›¿æ¢ï¼Œå³æœ‰ \\hat{y}=Ïƒ(\\sum\\_{k=1}^{128}w\\_i \\frac{(f(x^{(i)})\\_k-f(x^{(j)})\\_k)^2}{f(x^{(i)})\\_k+f(x^{(j)})\\_k}+b\\_i) å½“ç„¶æ•°æ®åº“ä¸­çš„å›¾åƒä¸ç”¨æ¯æ¬¡æ¥ä¸€å¼ éœ€è¦éªŒè¯çš„å›¾åƒéƒ½é‡æ–°è®¡ç®—ï¼Œå…¶å®å¯ä»¥æå‰è®¡ç®—å¥½ï¼Œå°†ç»“æœä¿å­˜èµ·æ¥ï¼Œè¿™æ ·å°±å¯ä»¥åŠ å¿«è¿ç®—çš„é€Ÿåº¦äº†ã€‚ 6. What is neural style transfer? 7. What are deep ConvNets learning? ç¬¬ä¸€å±‚åªèƒ½çœ‹åˆ°å°éƒ¨åˆ†å·ç§¯ç¥ç». ä½ é€‰æ‹©ä¸€ä¸ªéšè—å•å…ƒï¼Œå‘ç°æœ‰9ä¸ªå›¾ç‰‡ï¼Œæœ€å¤§åŒ–äº†å•å…ƒæ¿€æ´»ï¼Œä½ å¯èƒ½æ‰¾åˆ°ç±»ä¼¼è¿™æ ·çš„å›¾ç‰‡æµ…å±‚åŒºåŸŸ. 8. Cost Functionå¦‚ä¸‹å›¾ç¤ºï¼š å·¦ä¸Šè§’çš„åŒ…å« Content çš„å›¾ç‰‡ç®€ç§°ä¸º Cï¼Œå³ä¸Šè§’åŒ…å« Style çš„ç®€ç§° Sï¼ŒäºŒè€…èåˆåå¾—åˆ°çš„å›¾ç‰‡ç®€ç§°ä¸º Gã€‚ æˆ‘ä»¬çŸ¥é“è®¡ç®—é—®é¢˜é¡»æ˜¯æœ‰é™çš„ï¼Œæ‰€ä»¥èåˆçš„æ ‡å‡†æ˜¯ä»€ä¹ˆï¼Ÿä¹Ÿå°±æ˜¯è¯´ Content çš„ä¿ç•™ç¨‹åº¦å’Œ Style çš„è¿ç”¨ç¨‹åº¦å¦‚ä½•å–èˆå‘¢ï¼Ÿ æ­¤æ—¶å¼•å…¥æŸå¤±å‡½æ•°ï¼Œå¹¶å¯¹å…¶è¿›è¡Œæœ€ä¼˜åŒ–ï¼Œè¿™æ ·ä¾¿å¯å¾—åˆ°æœ€ä¼˜è§£ã€‚ J(G)=Î±J\\_{Content}(C,G)+Î²J\\_{Style}(S,G) $J(G)$ å®šä¹‰ç”¨æ¥ç”Ÿæˆå›¾åƒçš„å¥½åï¼Œ$J_{Content}(C,G)$ è¡¨ç¤º å›¾åƒ$C$ å’Œ å›¾åƒ$G$ ä¹‹é—´çš„å·®å¼‚ï¼Œ$J_{Style}(S,G)$ åŒç†ã€‚ è®¡ç®—è¿‡ç¨‹ç¤ºä¾‹ï¼š éšæœºåˆå§‹åŒ–å›¾åƒ $G$ï¼Œå‡è®¾ä¸º 100*100*3 ï¼ˆmaybe 500*500*3ï¼‰ (å¦‚ä¸‹å›¾å³è¾¹å››ä¸ªå›¾åƒæœ€ä¸Šé¢é‚£ä¸ªæ‰€ç¤º) ä½¿ç”¨æ¢¯åº¦ä¸‹é™ä¸æ–­ä¼˜åŒ– $J(G)$ã€‚ (ä¼˜åŒ–è¿‡ç¨‹å¦‚ä¸‹å›¾å³è¾¹ä¸‹é¢3ä¸ªå›¾åƒæ‰€ç¤º) ä¸‹é¢ä¸€å°èŠ‚å°†å…·ä½“ä»‹ç» Cost Function çš„è®¡ç®—ã€‚ 9. Content Cost Functioné¦–å…ˆå‡è®¾æˆ‘ä»¬ä½¿ç”¨ ç¬¬ $l$ å±‚ éšè—å±‚ æ¥è®¡ç®— $J_{Content}(C,G)$ï¼Œæ³¨æ„è¿™é‡Œçš„ $l$ ä¸€èˆ¬å–åœ¨ä¸­é—´å±‚ï¼Œè€Œä¸æ˜¯æœ€å‰é¢çš„å±‚ï¼Œæˆ–è€…æœ€åå±‚ åŸå› å¦‚ä¸‹ï¼š å‡å¦‚å–ç¬¬1å±‚ï¼Œé‚£ä¹ˆå¾—åˆ°çš„ $G$ å›¾åƒ å°†ä¼šä¸ å›¾åƒ$C$ åƒç´ çº§åˆ«çš„ç›¸ä¼¼ï¼Œè¿™æ˜¾ç„¶ä¸è¡Œã€‚ å‡å¦‚å–å¾ˆæ·±å±‚ï¼Œé‚£ä¹ˆè¯¥å±‚å·²ç»æå–å‡ºäº†æ¯”è¾ƒé‡è¦çš„ç‰¹å¾ï¼Œä¾‹å¦‚ å›¾åƒ$C$ ä¸­æœ‰ä¸€æ¡ç‹—ï¼Œé‚£ä¹ˆå¾—åˆ°çš„ å›¾åƒ$G$ ä¼šè¿‡åº¦çš„ä¿ç•™è¿™ä¸ªç‰¹å¾ã€‚ ç„¶åä½¿ç”¨é¢„å…ˆè®­ç»ƒå¥½çš„å·ç§¯ç¥ç»ç½‘ç»œï¼Œå¦‚ VGGç½‘ç»œã€‚è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥å¾—åˆ° å›¾åƒ$C$ å’Œ å›¾åƒ$G$ åœ¨ç¬¬$l$å±‚çš„æ¿€æ´»å‡½æ•°å€¼ï¼Œåˆ†åˆ«è®°ä¸º $a^{[l][C]},a^{[l][G]}$ å†…å®¹æŸå¤±å‡½æ•° $J_{Content}(C,G) = \\frac{1}{2} || a^{[l][C]} - a^{[l][G]} ||^2$ 10. Style Cost Function10.1 ä»€ä¹ˆæ˜¯â€œé£æ ¼â€è¦è®¡ç®—é£æ ¼æŸå¤±å‡½æ•°ï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦çŸ¥é“â€œé£æ ¼(Style)â€æ˜¯ä»€ä¹ˆã€‚ æˆ‘ä»¬ä½¿ç”¨ $l$ å±‚çš„æ¿€æ´»æ¥åº¦é‡â€œStyleâ€ï¼Œå°†â€œStyleâ€å®šä¹‰ä¸ºé€šé“é—´æ¿€æ´»å€¼ä¹‹é—´çš„ç›¸å…³ç³»æ•°ã€‚(Define style as correlation between activation across channels) é‚£ä¹ˆæˆ‘ä»¬å¦‚ä½•è®¡ç®—è¿™ä¸ªæ‰€è°“çš„ç›¸å…³ç³»æ•°å‘¢ï¼Ÿ ä¸‹å›¾æ˜¯æˆ‘ä»¬ä»ä¸Šå›¾ä¸­æ‰€æ ‡è¯†çš„ç¬¬ $l$ å±‚ï¼Œä¸ºæ–¹ä¾¿è¯´æ˜ï¼Œå‡è®¾åªæœ‰ 5 å±‚é€šé“ã€‚ å¦‚ä¸Šå›¾ç¤ºï¼Œçº¢è‰²é€šé“å’Œé»„è‰²é€šé“å¯¹åº”ä½ç½®éƒ½æœ‰æ¿€æ´»é¡¹ï¼Œè€Œæˆ‘ä»¬è¦æ±‚çš„ä¾¿æ˜¯å®ƒä»¬ä¹‹é—´çš„ç›¸å…³ç³»æ•°ã€‚ ä½†æ˜¯ä¸ºä»€ä¹ˆè¿™ä¹ˆæ±‚å‡ºæ¥æ˜¯æœ‰æ•ˆçš„å‘¢ï¼Ÿä¸ºä»€ä¹ˆå®ƒä»¬èƒ½å¤Ÿåæ˜ å‡ºé£æ ¼å‘¢ï¼Ÿ ç»§ç»­å¾€ä¸‹çœ‹â†“ 10.2 å›¾åƒé£æ ¼çš„ç›´è§‚ç†è§£å¦‚å›¾é£æ ¼å›¾åƒæœ‰ 5 å±‚é€šé“ï¼Œä¸”è¯¥å›¾åƒçš„å¯è§†åŒ–ç‰¹å¾å¦‚ å·¦ä¸‹è§’å›¾ æ‰€ç¤ºã€‚ å…¶ä¸­çº¢è‰²é€šé“å¯è§†åŒ–ç‰¹å¾å¦‚å›¾ä¸­ç®­å¤´æ‰€æŒ‡æ˜¯å‚ç›´æ¡çº¹ï¼Œè€Œé»„è‰²é€šé“çš„ç‰¹å¾åˆ™æ˜¯æ©˜è‰²èƒŒæ™¯ã€‚é‚£ä¹ˆé€šè¿‡è®¡ç®—è¿™ä¸¤å±‚é€šé“çš„ç›¸å…³ç³»æ•°æœ‰ä»€ä¹ˆç”¨å‘¢ï¼Ÿ å…¶å®å¾ˆå¥½ç†è§£ï¼Œå¦‚æœäºŒè€…ç›¸å…³ç³»æ•°æ€§å¼ºï¼Œé‚£ä¹ˆå¦‚æœå‡ºç°æ©˜è‰²èƒŒæ™¯ï¼Œé‚£ä¹ˆå°±åº”è¯¥å¾ˆå¤§æ¦‚ç‡å‡ºç°å‚ç›´æ¡çº¹ã€‚åä¹‹ï¼Œäº¦ç„¶ã€‚ 10.3 é£æ ¼ç›¸å…³ç³»æ•°çŸ©é˜µä»¤ $a_{i,j,k}^{[l]}$ è¡¨ç¤º (i,j,k) çš„æ¿€æ´»é¡¹ï¼Œå…¶ä¸­ i,j,k åˆ†åˆ«è¡¨ç¤ºé«˜åº¦å€¼(H)ï¼Œå®½åº¦å€¼(W) åŠ æ‰€åœ¨é€šé“å±‚æ¬¡(C)ã€‚ é£æ ¼çŸ©é˜µ(ä¹Ÿç§°ä¸ºâ€œGram Matrixâ€)ç”¨ $G^{[l]}$ è¡¨ç¤ºï¼Œå…¶å¤§å°ä¸º $n_c^{l]}*n_c^{l]}$. å› æ­¤é£æ ¼å›¾åƒçš„é£æ ¼çŸ©é˜µä¸ºï¼š G\\_{kk'}^{[l](S)}=\\sum\\_{i=1}^{n\\_H^{[l]}}\\sum\\_{j=1}^{n\\_W^{[l]}}a\\_{i,j,k}^{[l](S)}a\\_{i,j,k'}^{[l](S)}ç”Ÿæˆå›¾åƒçš„ç›¸å…³ç³»æ•°çŸ©é˜µ G\\_{kk'}^{[l](G)}=\\sum\\_{i=1}^{n\\_H^{[l]}}\\sum\\_{j=1}^{n\\_W^{[l]}}a\\_{i,j,k}^{[l](G)}a\\_{i,j,k'}^{[l](G)} 10.4 é£æ ¼æŸå¤±å‡½æ•° ç¬¬ $l$ å±‚çš„é£æ ¼æŸå¤±å‡½æ•°ä¸ºï¼š J\\_{Style}^{[l]} (S, G) = \\frac {1} { (2n\\_H^{[l]} n\\_W^{[l]} n\\_C^{[l]})^2 } \\sum\\_{k}\\sum\\_{k'} (G\\_{kk'}^{[l]\\(S\\)} - G\\_{kk'}^{[l]\\(G\\)})æ€»çš„é£æ ¼æŸå¤±å‡½æ•°ï¼š J\\_{Style}(S,G) = \\sum\\_{l}Î»^{[l]}J\\_{Style}C4^{[l]}(S,G)11. 1D and 3D Generalizations1D generalizations of models 3D generalizations of models åŒ»å­¦å›¾åƒ ä¸ è§†é¢‘æ£€æµ‹ éƒ½æ˜¯ 3D çš„. Reference ç½‘æ˜“äº‘è¯¾å ‚ - deeplearning DeepLearning.aiå­¦ä¹ ç¬”è®°æ±‡æ€»","categories":[{"name":"deeplearning","slug":"deeplearning","permalink":"http://iequa.com/categories/deeplearning/"}],"tags":[{"name":"deeplearning.ai","slug":"deeplearning-ai","permalink":"http://iequa.com/tags/deeplearning-ai/"}]},{"title":"TensorFlow åŸºæœ¬ç”¨æ³•æ€»ç»“","slug":"tensorflow/tf-2.8-tensorflow-basic-summary","date":"2018-09-08T06:27:21.000Z","updated":"2020-07-03T03:32:44.977Z","comments":true,"path":"2018/09/08/tensorflow/tf-2.8-tensorflow-basic-summary/","link":"","permalink":"http://iequa.com/2018/09/08/tensorflow/tf-2.8-tensorflow-basic-summary/","excerpt":"tensorflow ä¸­æ–‡æ–‡æ¡£å­¦ä¹  tensorflow çš„åŸºæœ¬ç”¨æ³•ã€‚","text":"tensorflow ä¸­æ–‡æ–‡æ¡£å­¦ä¹  tensorflow çš„åŸºæœ¬ç”¨æ³•ã€‚ æŒ‰ç…§æ–‡æ¡£è¯´æ˜ï¼Œä¸€ç‚¹çŸ¥è¯†ç‚¹å°æ€»ç»“ï¼š å°±æ˜¯ Session() å’Œ InteractiveSession() çš„ç”¨æ³•ã€‚åè€…ç”¨ Tensor.eval() å’Œ Operation.run() æ¥æ›¿ä»£äº† Session.run(). å…¶ä¸­æ›´å¤šçš„æ˜¯ç”¨Tensor.eval()ï¼Œæ‰€æœ‰çš„è¡¨è¾¾å¼éƒ½å¯ä»¥çœ‹ä½œæ˜¯ Tensor. tf è¡¨è¾¾å¼ä¸­æ‰€æœ‰çš„ varå˜é‡ æˆ– constantå¸¸é‡ éƒ½åº”è¯¥æ˜¯ tf çš„ç±»å‹ã€‚ åªè¦æ˜¯å£°æ˜äº† varå˜é‡ï¼Œå°±å¾—ç”¨ sess.run(tf.global_variables_initializer()) æ–¹æ³•æ¥åˆå§‹åŒ–æ‰èƒ½ç”¨ã€‚ 1. å¹³é¢æ‹Ÿåˆé€šè¿‡æœ¬ä¾‹å¯ä»¥çœ‹åˆ°æœºå™¨å­¦ä¹ çš„ä¸€ä¸ªé€šç”¨è¿‡ç¨‹ï¼š å‡†å¤‡æ•°æ® æ„é€ æ¨¡å‹ï¼ˆè®¾ç½®æ±‚è§£ç›®æ ‡å‡½æ•°ï¼‰ æ±‚è§£æ¨¡å‹ import tensorflow as tfimport numpy as np# 1.å‡†å¤‡æ•°æ®ï¼šä½¿ç”¨ NumPy ç”Ÿæˆå‡æ•°æ®(phony data), æ€»å…± 100 ä¸ªç‚¹.x_data = np.float32(np.random.rand(2, 100)) # éšæœºè¾“å…¥y_data = np.dot([0.100, 0.200], x_data) + 0.300# 2.æ„é€ ä¸€ä¸ªçº¿æ€§æ¨¡å‹b = tf.Variable(tf.zeros([1]))W = tf.Variable(tf.random_uniform([1, 2], -1.0, 1.0))y = tf.matmul(W, x_data) + b# 3.æ±‚è§£æ¨¡å‹# è®¾ç½®æŸå¤±å‡½æ•°ï¼šè¯¯å·®çš„å‡æ–¹å·®loss = tf.reduce_mean(tf.square(y - y_data))# é€‰æ‹©æ¢¯åº¦ä¸‹é™çš„æ–¹æ³•optimizer = tf.train.GradientDescentOptimizer(0.5)# è¿­ä»£çš„ç›®æ ‡ï¼šæœ€å°åŒ–æŸå¤±å‡½æ•°train = optimizer.minimize(loss)############################################################# ä»¥ä¸‹æ˜¯ç”¨ tf æ¥è§£å†³ä¸Šé¢çš„ä»»åŠ¡# 1.åˆå§‹åŒ–å˜é‡ï¼štf çš„å¿…å¤‡æ­¥éª¤ï¼Œä¸»è¦å£°æ˜äº†å˜é‡ï¼Œå°±å¿…é¡»åˆå§‹åŒ–æ‰èƒ½ç”¨init = tf.global_variables_initializer()# è®¾ç½®tensorflowå¯¹GPUçš„ä½¿ç”¨æŒ‰éœ€åˆ†é…config = tf.ConfigProto()config.gpu_options.allow_growth = True# 2.å¯åŠ¨å›¾ (graph)sess = tf.Session(config=config)sess.run(init)# 3.è¿­ä»£ï¼Œåå¤æ‰§è¡Œä¸Šé¢çš„æœ€å°åŒ–æŸå¤±å‡½æ•°è¿™ä¸€æ“ä½œï¼ˆtrain opï¼‰,æ‹Ÿåˆå¹³é¢for step in xrange(0, 201): sess.run(train) if step % 20 == 0: print step, sess.run(W), sess.run(b)# å¾—åˆ°æœ€ä½³æ‹Ÿåˆç»“æœ W: [[0.100 0.200]], b: [0.300] 0 [[ 0.27467242 0.81889796]] [-0.13746099]20 [[ 0.1619305 0.39317462]] [ 0.18206716]40 [[ 0.11901411 0.25831661]] [ 0.2642329]60 [[ 0.10580806 0.21761954]] [ 0.28916073]80 [[ 0.10176832 0.20532639]] [ 0.29671678]100 [[ 0.10053726 0.20161074]] [ 0.29900584]120 [[ 0.100163 0.20048723]] [ 0.29969904]140 [[ 0.10004941 0.20014738]] [ 0.29990891]160 [[ 0.10001497 0.20004457]] [ 0.29997244]180 [[ 0.10000452 0.20001349]] [ 0.29999167]200 [[ 0.10000138 0.2000041 ]] [ 0.29999748] 2. ä¸¤ä¸ªæ•°æ±‚å’Œinput1 = tf.constant(2.0)input2 = tf.constant(3.0)input3 = tf.constant(5.0)intermd = tf.add(input1, input2)mul = tf.multiply(input2, input3)with tf.Session() as sess: result = sess.run([mul, intermd]) # ä¸€æ¬¡æ‰§è¡Œå¤šä¸ªop print(result) print(type(result)) print(type(result[0])) [15.0, 5.0]&lt;class &#x27;list&#x27;&gt;&lt;class &#x27;numpy.float32&#x27;&gt; 3. å˜é‡ï¼Œå¸¸é‡3.1 tensorflow å®ç°è®¡æ•°å™¨ä¸»è¦æ˜¯è®¾è®¡äº†åœ¨å¾ªç¯ä¸­è°ƒç”¨åŠ æ³•å®ç°è®¡æ•° # åˆ›å»ºå˜é‡ï¼Œåˆå§‹åŒ–ä¸º0state = tf.Variable(0, name=&quot;counter&quot;)# åˆ›å»ºä¸€ä¸ª op , å…¶ä½œç”¨æ˜¯æ—¶ state å¢åŠ  1one = tf.constant(1) # ç›´æ¥ç”¨ 1 ä¹Ÿå°±è¡Œäº†new_value = tf.add(state, 1)update = tf.assign(state, new_value)# å¯åŠ¨å›¾ä¹‹åï¼Œ è¿è¡Œ update opwith tf.Session() as sess: # åˆ›å»ºå¥½å›¾ä¹‹åï¼Œå˜é‡å¿…é¡»ç»è¿‡â€˜åˆå§‹åŒ–â€™ sess.run(tf.global_variables_initializer()) # æŸ¥çœ‹stateçš„åˆå§‹åŒ–å€¼ print(sess.run(state)) for _ in range(3): sess.run(update) # è¿™æ ·å­æ¯ä¸€æ¬¡è¿è¡Œstate éƒ½è¿˜æ˜¯1 print(sess.run(state)) output: 0123 3.2 ç”¨ tf æ¥å®ç°å¯¹ä¸€ç»„æ•°æ±‚å’Œï¼Œå†è®¡ç®—å¹³å‡import tensorflow as tfimport numpy as nph_sum = tf.Variable(0.0, dtype=tf.float32)# h_vec = tf.random_normal(shape=([10]))h_vec = tf.constant([1.0,2.0,3.0,4.0])# æŠŠ h_vec çš„æ¯ä¸ªå…ƒç´ åŠ åˆ° h_sum ä¸­ï¼Œç„¶åå†é™¤ä»¥ 10 æ¥è®¡ç®—å¹³å‡å€¼# å¾…æ·»åŠ çš„æ•°h_add = tf.placeholder(tf.float32)# æ·»åŠ ä¹‹åçš„å€¼h_new = tf.add(h_sum, h_add)# æ›´æ–° h_new çš„ opupdate = tf.assign(h_sum, h_new)with tf.Session() as sess: sess.run(tf.global_variables_initializer()) # æŸ¥çœ‹åŸå§‹å€¼ print(&#x27;s_sum =&#x27;, sess.run(h_sum)) print(&quot;vec = &quot;, sess.run(h_vec)) # å¾ªç¯æ·»åŠ  for _ in range(4): sess.run(update, feed_dict=&#123;h_add: sess.run(h_vec[_])&#125;) print(&#x27;h_sum =&#x27;, sess.run(h_sum))# print &#x27;the mean is &#x27;, sess.run(sess.run(h_sum) / 4) # è¿™æ ·å†™ 4 æ˜¯é”™è¯¯çš„ï¼Œ å¿…é¡»è½¬ä¸º tf å˜é‡æˆ–è€…å¸¸é‡ print(&#x27;the mean is &#x27;, sess.run(sess.run(h_sum) / tf.constant(4.0))) 3.3 åªç”¨ä¸€ä¸ªå˜é‡æ¥å®ç°è®¡æ•°å™¨ä¸Šé¢çš„è®¡æ•°å™¨æ˜¯ TensorFlow å®˜æ–¹æ–‡æ¡£çš„ä¾‹å­ï¼Œä½†æ˜¯è§‰å¾—å¥½è‡ƒè‚¿ï¼Œæ‰€ä»¥ä¸‹é¢è¿™ä¸ªæ˜¯æ›´åŠ ç®€å•çš„ï¼Œåªéœ€è¦å®šä¹‰ä¸€ä¸ªå˜é‡å’Œä¸€ä¸ª åŠ  1 çš„æ“ä½œï¼ˆopï¼‰ã€‚é€šè¿‡forå¾ªç¯å°±èƒ½å¤Ÿå®ç°äº†ã€‚ # å¦‚æœä¸æ˜¯ assign() é‡æ–°èµ‹å€¼çš„è¯ï¼Œæ¯ä¸€æ¬¡ sess.run()éƒ½ä¼šæŠŠ stateå†æ¬¡åˆå§‹åŒ–ä¸º 0.0state = tf.Variable(0.0, tf.float32)# é€šè¿‡ assign æ“ä½œæ¥æ”¹å˜stateçš„å€¼ã€‚add_op = tf.assign(state, state+1)sess.run(tf.global_variables_initializer())print &#x27;init state &#x27;, sess.run(state)for _ in xrange(3): sess.run(add_op) print(sess.run(state)) init state 0.01.02.03.0 è¿™æ ·å­å’Œæˆ‘ä»¬å¹³æ—¶å®ç°è®¡æ•°å™¨çš„æ–¹æ³•åŸºæœ¬ä¸Šå°±ä¸€è‡´äº†ã€‚æˆ‘ä»¬è¦é‡ç‚¹ç†è§£çš„æ˜¯ï¼Œ TensorFlow ä¸­é€šè¿‡ tf.assign(ref, value) çš„æ–¹å¼æ¥æŠŠ value å€¼èµ‹ç»™ ref å˜é‡ã€‚è¿™æ ·å­ï¼Œæ¯ä¸€æ¬¡å¾ªç¯çš„æ—¶å€™ï¼Œref å˜é‡æ‰ä¸ä¼šå†åšå®šä¹‰æ—¶å€™çš„åˆå§‹åŒ–æ“ä½œã€‚ 4. InteractiveSession() çš„ç”¨æ³•InteractiveSession() ä¸»è¦æ˜¯é¿å… Sessionï¼ˆä¼šè¯ï¼‰è¢«ä¸€ä¸ªå˜é‡æŒæœ‰ a = tf.constant(1.0)b = tf.constant(2.0)c = a + b# ä¸‹é¢çš„ä¸¤ç§æƒ…å†µæ˜¯ç­‰ä»·çš„with tf.Session(): # ä¸ç”¨ close() print(c.eval())sess = tf.InteractiveSession()print(c.eval())sess.close() output: 3.03.0 4.1 InteractiveSession()ã€evalã€inita = tf.constant(1.0)b = tf.constant(2.0)c = tf.Variable(3.0)d = a + bsess = tf.InteractiveSession()sess.run(tf.global_variables_initializer())#################### è¿™æ ·å†™æ˜¯é”™è¯¯çš„# print(a.run())# print(d.run())##################### è¿™æ ·æ‰æ˜¯æ­£ç¡®çš„print(a.eval())print(d.eval())# run() æ–¹æ³•ä¸»è¦ç”¨æ¥x = tf.Variable(1.2)# print(x.eval()) # è¿˜æ²¡åˆå§‹åŒ–ï¼Œä¸èƒ½ç”¨x.initializer.run() # x.initializer å°±æ˜¯ä¸€ä¸ªåˆå§‹åŒ–çš„ opï¼Œ op æ‰è°ƒç”¨run() æ–¹æ³•print(x.eval())sess.close() output: 1.03.01.2 4.2 ä½¿ç”¨ tf.InteractiveSession() æ¥å®Œæˆä¸Šé¢ æ±‚å’Œã€å¹³å‡ çš„æ“ä½œå‘¢?h_sum = tf.Variable(0.0, dtype=tf.float32)# h_vec = tf.random_normal(shape=([10]))h_vec = tf.constant([1.0,2.0,3.0,4.0])# æŠŠ h_vec çš„æ¯ä¸ªå…ƒç´ åŠ åˆ° h_sum ä¸­ï¼Œç„¶åå†é™¤ä»¥ 10 æ¥è®¡ç®—å¹³å‡å€¼# å¾…æ·»åŠ çš„æ•°h_add = tf.placeholder(tf.float32)# æ·»åŠ ä¹‹åçš„å€¼h_new = tf.add(h_sum, h_add)# æ›´æ–° h_new çš„ opupdate = tf.assign(h_sum, h_new)sess = tf.InteractiveSession()sess.run(tf.global_variables_initializer())print(&#x27;s_sum =&#x27;, h_sum.eval())print(&quot;vec = &quot;, h_vec.eval())print(&quot;vec = &quot;, h_vec[0].eval())for _ in range(4): update.eval(feed_dict=&#123;h_add: h_vec[_].eval()&#125;) print(&#x27;h_sum =&#x27;, h_sum.eval())sess.close() output: s_sum = 0.0vec = [ 1. 2. 3. 4.]vec = 1.0h_sum = 1.0h_sum = 3.0h_sum = 6.0h_sum = 10.0 4.3 ä½¿ç”¨ feed æ¥å¯¹å˜é‡èµ‹å€¼è¿™äº›éœ€è¦ç”¨åˆ° feed æ¥èµ‹å€¼çš„æ“ä½œå¯ä»¥é€šè¿‡ tf.placeholder() è¯´æ˜ï¼Œä»¥åˆ›å»ºå ä½ç¬¦ã€‚ ä¸‹é¢çš„ä¾‹å­ä¸­å¯ä»¥çœ‹å‡º session.run([output], â€¦) å’Œ session.run(output, â€¦) çš„åŒºåˆ«ã€‚å‰è€…è¾“å‡ºäº† output çš„ç±»å‹ç­‰è¯¦ç»†ä¿¡æ¯ï¼Œåè€…åªè¾“å‡ºç®€å•ç»“æœã€‚ ğŸŒ°ğŸŒ°1ï¼šfeed input1 = tf.placeholder(tf.float32)input2 = tf.placeholder(tf.float32)output = tf.multiply(input1, input2)with tf.Session() as sess: print(sess.run([output], feed_dict=&#123;input1:[7.0], input2:[2.0]&#125;)) output: [array([ 14.], dtype=float32)] ğŸŒ°ğŸŒ°2ï¼š input1:[7.0], input2:[2.0] with tf.Session() as sess: result = sess.run(output, feed_dict=&#123;input1:[7.0], input2:[2.0]&#125;) print(type(result)) print(result) output: &lt;type &#x27;numpy.ndarray&#x27;&gt;[ 14.] ğŸŒ°ğŸŒ°3ï¼š input1:7.0, input2:2.0 with tf.Session() as sess: result = sess.run(output, feed_dict=&#123;input1:7.0, input2:2.0&#125;) print(type(result)) print(result) output: &lt;type &#x27;numpy.float32&#x27;&gt;14.0 ğŸŒ°ğŸŒ°4ï¼š [output], output with tf.Session() as sess: print(sess.run([output], feed_dict=&#123;input1:[7.0, 3.0], input2:[2.0, 1.0]&#125;)) print() print(sess.run(output, feed_dict=&#123;input1:[7.0, 3.0], input2:[2.0, 1.0]&#125;)) output: [array([ 14., 3.], dtype=float32)][ 14. 3.] Reference tensorflow.org TensorFlowå…¥é—¨ï¼ˆä¸€ï¼‰åŸºæœ¬ç”¨æ³•","categories":[{"name":"tensorflow","slug":"tensorflow","permalink":"http://iequa.com/categories/tensorflow/"}],"tags":[{"name":"tensorflow","slug":"tensorflow","permalink":"http://iequa.com/tags/tensorflow/"}]},{"title":"Activation Function æ¿€åŠ±å‡½æ•°","slug":"tensorflow/tf-2.6-B-activation-function","date":"2018-09-07T06:27:21.000Z","updated":"2020-07-03T03:32:57.125Z","comments":true,"path":"2018/09/07/tensorflow/tf-2.6-B-activation-function/","link":"","permalink":"http://iequa.com/2018/09/07/tensorflow/tf-2.6-B-activation-function/","excerpt":"Tensorflow æä¾›çš„ä¸€äº› Activation Function tensorflow/api_guides/python/nn","text":"Tensorflow æä¾›çš„ä¸€äº› Activation Function tensorflow/api_guides/python/nn æ¿€åŠ±å‡½æ•°è¿è¡Œæ—¶æ¿€æ´»ç¥ç»ç½‘ç»œä¸­æŸä¸€éƒ¨åˆ†ç¥ç»å…ƒï¼Œå°†æ¿€æ´»ä¿¡æ¯å‘åä¼ å…¥ä¸‹ä¸€å±‚çš„ç¥ç»ç³»ç»Ÿã€‚ æ¿€åŠ±å‡½æ•°çš„å®è´¨æ˜¯éçº¿æ€§æ–¹ç¨‹ã€‚ Tensorflow çš„ç¥ç»ç½‘ç»œ é‡Œé¢å¤„ç†è¾ƒä¸ºå¤æ‚çš„é—®é¢˜æ—¶éƒ½ä¼šéœ€è¦è¿ç”¨ activation function ã€‚ ä¸‹é¢æ˜¯ä¸€ä¸ª TensorFlow æ­å»ºçš„ ç®€å•ç‰ˆç¥ç»ç½‘ç»œ æ•°æ®æµå›¾ : Layer2 å±•å¼€éƒ¨åˆ†ï¼ŒLayer1 å‡ºæ¥çš„æ•°æ®ï¼Œå†è¾“å…¥åˆ° Layer2 ä¸­ è¯¦ç»†ä»‹ç»è¯·å‰å¾€ Whatâ€™s Activation Function Reference tensorflow.org è«çƒ¦Python Tensorflow æä¾›çš„ä¸€äº› æ¿€åŠ±å‡½æ•°","categories":[{"name":"tensorflow","slug":"tensorflow","permalink":"http://iequa.com/categories/tensorflow/"}],"tags":[{"name":"tensorflow","slug":"tensorflow","permalink":"http://iequa.com/tags/tensorflow/"}]},{"title":"What's Activation Function","slug":"tensorflow/tf-2.6-A-activation-function","date":"2018-09-07T06:15:21.000Z","updated":"2020-07-03T03:32:51.715Z","comments":true,"path":"2018/09/07/tensorflow/tf-2.6-A-activation-function/","link":"","permalink":"http://iequa.com/2018/09/07/tensorflow/tf-2.6-A-activation-function/","excerpt":"ç°ä»£ç¥ç»ç½‘ç»œä¸­ å¿…ä¸å¯å°‘çš„ä¸€ä¸ªç»„æˆéƒ¨åˆ†, æ¿€åŠ±å‡½æ•°, activation function.","text":"ç°ä»£ç¥ç»ç½‘ç»œä¸­ å¿…ä¸å¯å°‘çš„ä¸€ä¸ªç»„æˆéƒ¨åˆ†, æ¿€åŠ±å‡½æ•°, activation function. æœ¬æ–‡å¤§éƒ¨åˆ†å†…å®¹è½¬è½½è‡ª è«çƒ¦Python /Tensorflow-Tutorial éçº¿æ€§æ–¹ç¨‹æˆ‘ä»¬ä¸ºä»€ä¹ˆè¦ä½¿ç”¨æ¿€åŠ±å‡½æ•°? ç”¨ç®€å•çš„è¯­å¥æ¥æ¦‚æ‹¬. å°±æ˜¯å› ä¸º, ç°å®å¹¶æ²¡æœ‰æˆ‘ä»¬æƒ³è±¡çš„é‚£ä¹ˆç¾å¥½ã€‚æ¿€åŠ±å‡½æ•°ä¹Ÿå°±æ˜¯ä¸ºäº†è§£å†³æˆ‘ä»¬æ—¥å¸¸ç”Ÿæ´»ä¸­ ä¸èƒ½ç”¨çº¿æ€§æ–¹ç¨‹æ‰€æ¦‚æ‹¬çš„é—®é¢˜. è¯´åˆ°çº¿æ€§æ–¹ç¨‹, æˆ‘ä»¬ä¸å¾—ä¸æåˆ°å¦å¤–ä¸€ç§æ–¹ç¨‹, éçº¿æ€§æ–¹ç¨‹ (nonlinear function). æˆ‘ä»¬å‡è®¾, å¥³ç”Ÿé•¿å¾—è¶Šæ¼‚äº®, è¶Šå¤šç”·ç”Ÿçˆ±. è¿™å°±å¯ä»¥è¢«å½“åšä¸€ä¸ªçº¿æ€§é—®é¢˜. ä½†æ˜¯å¦‚æœæˆ‘ä»¬å‡è®¾è¿™ä¸ªåœºæ™¯æ˜¯å‘ç”Ÿåœ¨æ ¡å›­é‡Œ. æ ¡å›­é‡Œçš„ç”·ç”Ÿæ•°æ˜¯æœ‰é™çš„, å¥³ç”Ÿå†æ¼‚äº®, ä¹Ÿä¸å¯èƒ½ä¼šæœ‰æ— ç©·å¤šçš„ç”·ç”Ÿå–œæ¬¢å¥¹. æ‰€ä»¥è¿™å°±å˜æˆäº†ä¸€ä¸ªéçº¿æ€§é—®é¢˜.å†è¯´..å¥³ç”Ÿä¹Ÿä¸å¯èƒ½æ˜¯æ— ç©·æ¼‚äº®çš„. è¿™ä¸ªé—®é¢˜æˆ‘ä»¬ä»¥åæœ‰æ—¶é—´ç§ä¸‹è®¨è®º. ç„¶åæˆ‘ä»¬å°±å¯ä»¥æ¥è®¨è®ºå¦‚ä½•åœ¨ç¥ç»ç½‘ç»œä¸­è¾¾æˆæè¿°éçº¿æ€§çš„ä»»åŠ¡äº†. æˆ‘ä»¬å¯ä»¥æŠŠæ•´ä¸ªç½‘ç»œç®€åŒ–æˆè¿™æ ·ä¸€ä¸ªå¼å­. $Y = WX$, $W$ å°±æ˜¯æˆ‘ä»¬è¦æ±‚çš„å‚æ•°, $y$ æ˜¯é¢„æµ‹å€¼, $x$ æ˜¯è¾“å…¥å€¼. ç”¨è¿™ä¸ªå¼å­, æˆ‘ä»¬å¾ˆå®¹æ˜“å°±èƒ½æè¿°åˆšåˆšçš„é‚£ä¸ªçº¿æ€§é—®é¢˜, å› ä¸º $W$ æ±‚å‡ºæ¥å¯ä»¥æ˜¯ä¸€ä¸ªå›ºå®šçš„æ•°. ä¸è¿‡è¿™ä¼¼ä¹å¹¶ä¸èƒ½è®©è¿™æ¡ç›´çº¿å˜å¾—æ‰­èµ·æ¥ , æ¿€åŠ±å‡½æ•°è§çŠ¶, æ‹”åˆ€ç›¸åŠ©, ç«™å‡ºæ¥è¯´é“: â€œè®©æˆ‘æ¥æ°å¼¯å®ƒ!â€. æ¿€åŠ±å‡½æ•° è¿™é‡Œçš„ AF å°±æ˜¯æŒ‡æ¿€åŠ±å‡½æ•°. æ¿€åŠ±å‡½æ•°æ‹¿å‡ºè‡ªå·±æœ€æ“…é•¿çš„â€æ°å¼¯åˆ©å™¨â€, å¥—åœ¨åŸå‡½æ•°ä¸Šç”¨åŠ›ä¸€æ‰­, åŸæ¥çš„ $WX$ ç»“æœå°±è¢«æ‰­å¼¯äº†. å…¶å®è¿™ä¸ª AF, æ°å¼¯åˆ©å™¨, ä¹Ÿä¸æ˜¯ä»€ä¹ˆè§¦ä¸å¯åŠçš„ä¸œè¥¿. å®ƒå…¶å®å°±æ˜¯å¦å¤–ä¸€ä¸ªéçº¿æ€§å‡½æ•°. æ¯”å¦‚è¯´relu, sigmoid, tanh. å°†è¿™äº›æ°å¼¯åˆ©å™¨åµŒå¥—åœ¨åŸæœ‰çš„ç»“æœä¹‹ä¸Š, å¼ºè¡ŒæŠŠåŸæœ‰çš„çº¿æ€§ç»“æœç»™æ‰­æ›²äº†. ä½¿å¾—è¾“å‡ºç»“æœ $y$ ä¹Ÿæœ‰äº†éçº¿æ€§çš„ç‰¹å¾. ä¸¾ä¸ªä¾‹å­, æ¯”å¦‚æˆ‘ä½¿ç”¨äº† relu è¿™ä¸ªæ°å¼¯åˆ©å™¨, å¦‚æœæ­¤æ—¶ $Wx$ çš„ç»“æœæ˜¯ 1, $y$ è¿˜å°†æ˜¯ 1, ä¸è¿‡ $WX$ ä¸º -1 çš„æ—¶å€™, $y$ ä¸å†æ˜¯ -1, è€Œä¼šæ˜¯ 0. ä½ ç”šè‡³å¯ä»¥åˆ›é€ è‡ªå·±çš„æ¿€åŠ±å‡½æ•°æ¥å¤„ç†è‡ªå·±çš„é—®é¢˜, ä¸è¿‡è¦ç¡®ä¿çš„æ˜¯è¿™äº›æ¿€åŠ±å‡½æ•°å¿…é¡»æ˜¯å¯ä»¥å¾®åˆ†çš„, å› ä¸ºåœ¨ backpropagation è¯¯å·®åå‘ä¼ é€’çš„æ—¶å€™, åªæœ‰è¿™äº›å¯å¾®åˆ†çš„æ¿€åŠ±å‡½æ•°æ‰èƒ½æŠŠè¯¯å·®ä¼ é€’å›å». å¸¸ç”¨é€‰æ‹© æƒ³è¦æ°å½“ä½¿ç”¨è¿™äº›æ¿€åŠ±å‡½æ•°, è¿˜æ˜¯æœ‰çªé—¨çš„. æ¯”å¦‚å½“ä½ çš„ç¥ç»ç½‘ç»œå±‚åªæœ‰ä¸¤ä¸‰å±‚, ä¸æ˜¯å¾ˆå¤šçš„æ—¶å€™, å¯¹äºéšè—å±‚, ä½¿ç”¨ä»»æ„çš„æ¿€åŠ±å‡½æ•°, éšä¾¿æ°å¼¯æ˜¯å¯ä»¥çš„, ä¸ä¼šæœ‰ç‰¹åˆ«å¤§çš„å½±å“. ä¸è¿‡, å½“ä½ ä½¿ç”¨ç‰¹åˆ«å¤šå±‚çš„ç¥ç»ç½‘ç»œ, åœ¨æ°å¼¯çš„æ—¶å€™, ç©ç©ä¸å¾—éšæ„é€‰æ‹©åˆ©å™¨. å› ä¸ºè¿™ä¼šæ¶‰åŠåˆ°æ¢¯åº¦çˆ†ç‚¸, æ¢¯åº¦æ¶ˆå¤±çš„é—®é¢˜. å› ä¸ºæ—¶é—´çš„å…³ç³», æˆ‘ä»¬å¯èƒ½ä¼šåœ¨ä»¥åæ¥å…·ä½“è°ˆè°ˆè¿™ä¸ªé—®é¢˜. æœ€åæˆ‘ä»¬è¯´è¯´, åœ¨å…·ä½“çš„ä¾‹å­ä¸­, æˆ‘ä»¬é»˜è®¤é¦–é€‰çš„æ¿€åŠ±å‡½æ•°æ˜¯å“ªäº›. åœ¨å°‘é‡å±‚ç»“æ„ä¸­, æˆ‘ä»¬å¯ä»¥å°è¯•å¾ˆå¤šç§ä¸åŒçš„æ¿€åŠ±å‡½æ•°. åœ¨å·ç§¯ç¥ç»ç½‘ç»œ Convolutional neural networks çš„å·ç§¯å±‚ä¸­, æ¨èçš„æ¿€åŠ±å‡½æ•°æ˜¯ relu. åœ¨å¾ªç¯ç¥ç»ç½‘ç»œä¸­ Recurrent neural networks, æ¨èçš„æ˜¯ tanh æˆ–è€…æ˜¯ relu (è¿™ä¸ªå…·ä½“æ€ä¹ˆé€‰, æˆ‘ä¼šåœ¨ä»¥å å¾ªç¯ç¥ç»ç½‘ç»œ çš„ä»‹ç»ä¸­åœ¨è¯¦ç»†è®²è§£). Reference tensorflow.org è«çƒ¦Python Tensorflow æä¾›çš„ä¸€äº› æ¿€åŠ±å‡½æ•°","categories":[{"name":"tensorflow","slug":"tensorflow","permalink":"http://iequa.com/categories/tensorflow/"}],"tags":[{"name":"tensorflow","slug":"tensorflow","permalink":"http://iequa.com/tags/tensorflow/"}]},{"title":"Summary SQL - Leetcode","slug":"leetcode/summary.sql","date":"2018-09-06T02:54:16.000Z","updated":"2020-12-04T01:00:48.654Z","comments":true,"path":"2018/09/06/leetcode/summary.sql/","link":"","permalink":"http://iequa.com/2018/09/06/leetcode/summary.sql/","excerpt":"","text":"175. Combine Two Tables SELECT FirstName, LastName, City, StateFROM Person LEFT JOIN Address ON Person.PersonId = Address.PersonId; Reference çŸ¥ä¹ï¼š [Leetcode][åŠ¨æ€è§„åˆ’]ç›¸å…³é¢˜ç›®æ±‡æ€»/åˆ†æ/æ€»ç»“ ç®€ä¹¦ï¼š 2019 ç®—æ³•é¢è¯•ç›¸å…³(leetcode)â€”åŠ¨æ€è§„åˆ’(Dynamic Programming) CSDN leetcode DP åˆ·å®Œ700å¤šé¢˜åçš„é¦–æ¬¡æ€»ç»“ï¼šLeetCodeåº”è¯¥æ€ä¹ˆåˆ·ï¼Ÿ å°ç™½ä¸€è·¯èµ°æ¥ï¼Œè¿ç»­åˆ·é¢˜ä¸‰å¹´ï¼Œè°ˆè°ˆæˆ‘çš„ç®—æ³•å­¦ä¹ ç»éªŒ","categories":[{"name":"leetcode","slug":"leetcode","permalink":"http://iequa.com/categories/leetcode/"}],"tags":[{"name":"leetcode","slug":"leetcode","permalink":"http://iequa.com/tags/leetcode/"}]},{"title":"Summary Python","slug":"python/language/py_summary","date":"2018-09-03T02:07:21.000Z","updated":"2020-12-04T01:01:19.629Z","comments":true,"path":"2018/09/03/python/language/py_summary/","link":"","permalink":"http://iequa.com/2018/09/03/python/language/py_summary/","excerpt":"","text":"ç„¦å›½å³°çš„éšç¬”æ—¥è®° - sortä¸sortedçš„åŒºåˆ«pythonä¸­mapå’Œæ˜Ÿå·çš„ç®€å•è¿ç”¨ Reference What the f*ck Python! ğŸ 8ä¸ªè¶…å¥½ç”¨çš„Pythonå†…ç½®å‡½æ•°ï¼Œæå‡æ•ˆç‡å¿…å¤‡ 110é“Pythoné¢è¯•é¢˜ï¼ˆçœŸé¢˜ï¼‰ åè¡€æ€»ç»“ï¼50é“Pythoné¢è¯•é¢˜é›†é”¦ï¼ˆé™„ç­”æ¡ˆï¼‰ taizilongxu/interview_python Pythoné¢è¯•é¢˜ä¹‹Pythoné¢è¯•é¢˜æ±‡æ€»","categories":[{"name":"python","slug":"python","permalink":"http://iequa.com/categories/python/"}],"tags":[{"name":"interview","slug":"interview","permalink":"http://iequa.com/tags/interview/"}]},{"title":"æ·±åº¦å­¦ä¹ ä¸è®¡ç®—æœºè§†è§‰ - å†å²å›é¡¾ä¸ä»‹ç»","slug":"deeplearning/deeplearning-CS231n-P1","date":"2018-09-01T12:00:21.000Z","updated":"2019-10-20T04:30:35.016Z","comments":true,"path":"2018/09/01/deeplearning/deeplearning-CS231n-P1/","link":"","permalink":"http://iequa.com/2018/09/01/deeplearning/deeplearning-CS231n-P1/","excerpt":"1966å¹´æ˜¯è®¡ç®—æœºè§†è§‰çš„è¯ç”Ÿå¹´ CVPRã€ICCV","text":"1966å¹´æ˜¯è®¡ç®—æœºè§†è§‰çš„è¯ç”Ÿå¹´ CVPRã€ICCV ç¬¬ä¸€é¢†æ‚Ÿ : Hubel å’Œ Wiesel ä»ç®€å•çš„å½¢çŠ¶å¼€å§‹ç¬¬äºŒé¢†æ‚Ÿ : David Marr ã€Šè§†è§‰ã€‹ è§†è§‰æ˜¯åˆ†å±‚çš„ æ·±åº¦å­¦ä¹ æ¶æ„çš„åŸºçŸ³ æ„ŸçŸ¥åˆ†ç»„ ImageNet 2012å¹´æ˜¯å†å²æ€§æ—¶åˆ»çš„ä¸€å¹´ï¼Œæå‡ºäº† CNN . ImageNet ç«èµ› 2010å¹´ å¼€å§‹ä¸¾åŠç«èµ›ImageNet ç«èµ› 2012å¹´ 7å±‚ CNN è·èƒœImageNet ç«èµ› 2015å¹´ 151å±‚ CNN è·èƒœï¼Œ MS æ·±åº¦æ®‹å·®ç½‘ç»œ. è®¡ç®—æœºè§†è§‰æ™ºèƒ½æ¯”ç‰©ä½“è¯†åˆ«è¦æ›´ä¸ºä»»é‡è€Œé“è¿œ è®¡ç®—æœºè§†è§‰çš„æ„¿æ™¯æ˜¯ ï¼š å¯ä»¥çœ‹å›¾è®²æ•…äº‹ Reference ç½‘æ˜“äº‘è¯¾å ‚ - deeplearning DeepLearning.aiå­¦ä¹ ç¬”è®°æ±‡æ€» æ–¯å¦ç¦CS231Nè¯¾ç¨‹å­¦ä¹ ç¬”è®°ï¼ˆä¸€ï¼‰.è¯¾ç¨‹ç®€ä»‹ä¸å‡†å¤‡ æé£é£CS231n2017è¯¾ç¨‹åŒè¯­å­—å¹•ç‰ˆä¸Šçº¿ !ï¼ˆé™„è¯¾ç¨‹é“¾æ¥ï¼‰","categories":[{"name":"deeplearning","slug":"deeplearning","permalink":"http://iequa.com/categories/deeplearning/"}],"tags":[{"name":"CS231n","slug":"CS231n","permalink":"http://iequa.com/tags/CS231n/"}]},{"title":"Convolutional Neural Networks (week3) - Object detection","slug":"deeplearning/Convolutional-Neural-Networks-week3","date":"2018-09-01T07:00:21.000Z","updated":"2019-10-20T04:30:35.022Z","comments":true,"path":"2018/09/01/deeplearning/Convolutional-Neural-Networks-week3/","link":"","permalink":"http://iequa.com/2018/09/01/deeplearning/Convolutional-Neural-Networks-week3/","excerpt":"çŸ¥é“å¦‚ä½•å°†å·ç§¯ç½‘ç»œåº”ç”¨åˆ°è§†è§‰æ£€æµ‹å’Œè¯†åˆ«ä»»åŠ¡ã€‚ çŸ¥é“å¦‚ä½•ä½¿ç”¨ç¥ç»é£æ ¼è¿ç§»ç”Ÿæˆè‰ºæœ¯ã€‚","text":"çŸ¥é“å¦‚ä½•å°†å·ç§¯ç½‘ç»œåº”ç”¨åˆ°è§†è§‰æ£€æµ‹å’Œè¯†åˆ«ä»»åŠ¡ã€‚ çŸ¥é“å¦‚ä½•ä½¿ç”¨ç¥ç»é£æ ¼è¿ç§»ç”Ÿæˆè‰ºæœ¯ã€‚ 1. Object Localizationè¿™ä¸€å°èŠ‚è§†é¢‘ä¸»è¦ä»‹ç»äº†æˆ‘ä»¬åœ¨å®ç°ç›®æ ‡å®šä½æ—¶æ ‡ç­¾è¯¥å¦‚ä½•å®šä¹‰ è¾“å‡º softmax çš„åŒæ—¶ï¼Œåœ¨è¾“å‡º4ä¸ªå€¼ $b_x,b_y,b_w,b_h$, è¾¹ç•Œæ¡†çš„å…·ä½“ä½ç½® ï¼ˆå›¾ç‰‡å·¦ä¸Šè§’åæ ‡ä¸º (0, 0)ï¼Œ å³ä¸‹è§’ä¸º (1, 1) ) åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œ$b_x$ çš„å€¼å¤§çº¦ä¸º 0.5ï¼Œ$b_y$ çš„å€¼å¤§çº¦ä¸º 0.7ï¼Œæœ€ä½³ä½ç½®. how we define the target label $y$ for this as a supervised learning task. ä¸Šå›¾å·¦ä¸‹è§’ç»™å‡ºäº†æŸå¤±å‡½æ•°çš„è®¡ç®—å…¬å¼ (è¿™é‡Œä½¿ç”¨çš„æ˜¯å¹³æ–¹å·®) æ³¨æ„: æˆ‘ä»¬å‡è®¾å›¾åƒä¸­å­˜åœ¨è¿™ä¸‰è€… (pedestrianï¼Œcarï¼Œmotorcycles) ä¸­çš„ä¸€ç§ æˆ–è€… éƒ½ä¸å­˜åœ¨ï¼Œæ‰€ä»¥å…±æœ‰å››ç§å¯èƒ½. $P_c=1$ è¡¨ç¤ºæœ‰ä¸‰è€…ä¸­çš„ä¸€ç§ $C_1=1$ è¡¨ç¤ºæœ‰ pedestrianï¼Œåä¹‹æ²¡æœ‰ $C_2=1$ è¡¨ç¤ºæœ‰ car $C_3=1$ è¡¨ç¤ºæœ‰ motorcycles $b_*$ ç”¨äºæ ‡è¯†æ‰€è¯†åˆ«é£Ÿç‰©çš„ä½ç½® $b_x,b_y$: è¡¨ç¤ºè¯†åˆ«ç‰©ä½“çš„ä¸­å¿ƒåæ ‡ $b_w,b_h$: è¡¨ç¤ºè¯†åˆ«ç‰©ä½“çš„å®½å’Œé«˜ æ³¨æ„: $P_c=0$ è¡¨ç¤ºä¸‰è€…éƒ½æ²¡æœ‰ï¼Œæ‰€ä»¥æ­¤æ—¶ $C_*,b_*$ çš„å€¼æˆ‘ä»¬å¹¶ä¸åœ¨ä¹äº†. ä¸ºäº†è®©å¤§å®¶ä¾¿äºäº†è§£å¯¹è±¡å®šä½çš„ç»†èŠ‚ï¼Œè¿™é‡Œæˆ‘ç”¨å¹³æ–¹è¯¯å·®ç®€åŒ–äº†æè¿°è¿‡ç¨‹. (å®é™…åº”ç”¨ä¸­ $P_c$ æ›´å¤šæ˜¯åº”ç”¨é€»è¾‘å›å½’å‡½æ•°) 2. Landmark Detectionç‰¹å¾ç‚¹æ£€æµ‹ï¼Œè¿™ä¸€èŠ‚çš„å†…å®¹å’Œä¸Šä¸€èŠ‚æ„Ÿè§‰å¾ˆç±»ä¼¼. è¦è¾“å‡ºçœ¼è§’çš„ä½ç½®ï¼Œä½ å¯ä»¥è®©ç¥ç»ç½‘ç»œè¾“å‡ºçš„æœ€åä¸€å±‚ï¼Œå¤šè¾“å‡º 2 ä¸ªæ•°å­— $l_x, l_y$. å‡è®¾ è„¸éƒ¨ æœ‰ 64 ä¸ªç‰¹å¾ç‚¹. å…·ä½“åšæ³•æ˜¯å‡†å¤‡ä¸€ä¸ª CNN å’Œ ä¸€äº›å…³é”®ç‰¹å¾é›†. å°†äººè„¸å›¾ç‰‡è¾“å…¥ CNN. è¾“å‡º 1 æˆ–è€… 0. 1 è¡¨ç¤ºæœ‰ äººè„¸ã€‚ è¿™é‡Œä¸€å…±æœ‰ 128 + 1 ä¸ªè¾“å‡ºå•å…ƒï¼Œå› ä¸ºæœ‰ 64 ä¸ªç‰¹å¾ 64 * 2ï¼Œ æ¥å®ç°å¯¹äººè„¸çš„æ£€æµ‹å’Œå®šä½. Snapchat åº”ç”¨ï¼ŒAR (Augmented Reality) å¢å¼ºç°å® Filter æœ‰æ‰€äº†è§£ï¼ŒSnapchat Filter å®ç°äº†åœ¨äººè„¸ä¸Šç”»çš‡å†  è¿˜æœ‰ä¸€äº›å…¶ä»–æ•ˆæœã€‚æ£€æµ‹è„¸éƒ¨ç‰¹å¾ä¹Ÿæ˜¯è®¡ç®—æœºå›¾å½¢å­¦çš„å…³é”®æ„é€ æ¨¡å—. æœ€åä¸€ä¸ªä¾‹å­æ˜¯ï¼Œæ£€æµ‹äººä½“å§¿æ€. 3. Object Detectionå‡è®¾ä½ æƒ³æ„é€ ä¸€ä¸ªæ±½è½¦æ£€æµ‹ç®—æ³•: é¦–å…ˆï¼Œåˆ›å»ºä¸€ä¸ªæ ‡ç­¾è®­ç»ƒé›† Training Setï¼Œ ä¹Ÿå°±æ˜¯ $x$ å’Œ $y$ é€‰å®šä¸€ä¸ªå¤§å°ç¡®å®šçš„çª—å£ï¼Œè¾“å…¥ CNNï¼ŒCNN å¼€å§‹é¢„æµ‹çº¢è‰²æ–¹æ¡†ä¸­æ˜¯å¦æœ‰æ±½è½¦. ç„¶åï¼Œæ»‘åŠ¨çª—å£ç»§ç»­, çº¢è‰²æ–¹æ¡†ç¨å‘å³æ»‘åŠ¨ä¹‹åçš„åŒºåŸŸ, å¤„ç†ä¸‹ä¸€ä¸ªï¼Œè¾“å…¥ CNN.. ä¾æ¬¡é‡å¤æ“ä½œ.., çŸ¥é“è¿™ä¸ªçº¢è‰²çš„çª—å£æ»‘è¿‡æ¯ä¸€ä¸ªè§’è½ã€‚ å¦‚æœä¸Šé¢åˆ°æœ€åè§’è½è¿˜æ˜¯æ²¡æœ‰æ£€æµ‹åˆ°æ±½è½¦ï¼Œ é‚£ä¹ˆé€‰ç”¨æ›´å¤§çš„çª—å£ï¼Œç„¶åè¿˜æ˜¯ä»¥å›ºå®šæ­¥é•¿..ä¾æ¬¡é‡å¤..æ»‘è¿‡..æ£€æµ‹ è¿™ä¸ªç®—æ³•å«åš : æ»‘åŠ¨çª—å£ç›®æ ‡æ£€æµ‹ ç›®æ ‡æ£€æµ‹å¸¸ä½¿ç”¨çš„æ˜¯æ»‘åŠ¨çª—å£æŠ€æœ¯æ£€æµ‹ï¼Œå³ä½¿ç”¨ä¸€å®šå¤§å°çš„çª—å£æŒ‰ç…§æŒ‡å®šçš„æ­¥é•¿å¯¹å›¾åƒè¿›è¡Œéå† å› ä¸ºå›¾åƒä¸­è½¦è¾†çš„å¤§å°æˆ‘ä»¬æ˜¯ä¸çŸ¥é“çš„ï¼Œæ‰€ä»¥å¯ä»¥æ›´æ”¹çª—å£å¤§å°ï¼Œä»è€Œè¯†åˆ«å¹¶å®šä½å‡ºè½¦è¾†çš„ä½ç½®ã€‚ æ»‘åŠ¨çª—å£ç›®æ ‡æ£€æµ‹ ç®—æ³•çš„ç¼ºç‚¹å°±æ˜¯è®¡ç®—æˆæœ¬çš„é—®é¢˜. å¦‚æœä½ æŠŠçª—å£è°ƒå¤§ï¼Œæ˜¾ç„¶ä¼šå‡å°‘è¾“å…¥CNNçš„çª—å£ä¸ªæ•°ï¼Œä½†æ˜¯ç²—ç²’åº¦å¯èƒ½ä¼šå½±å“æ€§èƒ½. å¦‚æœé‡‡ç”¨å°ç²’åº¦ï¼Œé‚£ä¹ˆè¾“å…¥ç»™CNNçš„çª—å£ä¸ªæ•°å°±ä¼šç‰¹åˆ«å¤šã€‚è¿™æ„å‘³ç€è¶…é«˜è®¡ç®—æˆæœ¬. äººä»¬é€šå¸¸é‡‡ç”¨æ›´ç®€å•çš„åˆ†ç±»å™¨åšå¯¹è±¡æ£€æµ‹. æ¯”å¦‚ç®€å•çš„çº¿æ€§åˆ†ç±»å™¨. è®¡ç®—æˆæœ¬å°±ä¼šå¾ˆä½. æ»‘åŠ¨çª—å£ç®—æ³•è¡¨ç°è‰¯å¥½. ç„¶è€Œ CNN è¿è¡Œå•ä¸ªåˆ†ç±»ä»»åŠ¡çš„æˆæœ¬ç¡®é«˜å¾—å¤šã€‚ è¿™æ ·çš„æ»‘åŠ¨çª—å£å¤ªæ…¢äº†ã€‚ åº†å¹¸çš„æ˜¯ï¼Œäººä»¬å·²ç»æ‰¾åˆ°äº†æ–¹æ³•è§£å†³è®¡ç®—æˆæœ¬ï¼Œä¸‹ä¸€èŠ‚è§. 4. Convolutional Implementation of Sliding Windows æ³¨æ„ï¼šè¯¥èŠ‚è§†é¢‘çš„ä¾‹å­å’Œä¸Šä¸€èŠ‚ä¸€æ ·ï¼Œéƒ½æ˜¯è¯†åˆ«å›¾åƒä¸­æ˜¯å¦æœ‰ pedestrianï¼Œcarï¼Œmotorcyclesï¼Œbackgroundï¼Œæ‰€ä»¥æœ€åè¾“å‡ºyæ˜¯ 4ä¸ªèŠ‚ç‚¹ 4.1 å…¨è¿æ¥å±‚â†’å·ç§¯å±‚åœ¨ä»‹ç»å·ç§¯æ»‘åŠ¨çª—å£ä¹‹å‰æˆ‘ä»¬é¦–å…ˆè¦çŸ¥é“å¦‚ä½•æŠŠç¥ç»ç½‘ç»œçš„å…¨è¿æ¥å±‚è½¬åŒ–æˆå·ç§¯å±‚ï¼Œä¸‹é¢æ˜¯ä½¿ç”¨äº†å…¨è¿æ¥å±‚çš„ç½‘ç»œç»“æ„ é‚£ä¹ˆå¦‚ä½•å°†å…¨è¿æ¥å±‚è½¬åŒ–æˆå·ç§¯å±‚å‘¢ï¼Ÿå¦‚ä¸‹å›¾ç¤º æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ç»è¿‡ Max Pooling ä¹‹åçš„æ•°æ®å¤§å°æ˜¯ (5, 5, 16), ç¬¬ä¸€ä¸ªFCå±‚æ˜¯ 400 ä¸ªèŠ‚ç‚¹ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ 400 ä¸ª 5*5 çš„è¿‡æ»¤å™¨è¿›è¡Œå·ç§¯è¿ç®—ï¼Œéšåæˆ‘ä»¬å°±å¾—åˆ°äº† (1, 1, 400) çš„çŸ©é˜µã€‚ ç¬¬äºŒä¸ª FCå±‚ ä¹Ÿæ˜¯ 400 ä¸ªèŠ‚ç‚¹ï¼Œç”±ä¹‹å‰çš„ 1*1 è¿‡æ»¤å™¨çš„ç‰¹ç‚¹ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ 400 ä¸ª 1*1 çš„è¿‡æ»¤å™¨ï¼Œä¹Ÿå¯ä»¥å¾—åˆ° (1,1,400) çš„çŸ©é˜µã€‚è‡³æ­¤ï¼Œæˆ‘ä»¬å·²ç»æˆåŠŸå°†å…¨è¿æ¥å±‚è½¬åŒ–æˆäº†å·ç§¯å±‚ã€‚ ä»¥ä¸Šå°±æ˜¯ç”¨å·ç§¯å±‚ä»£æ›¿å…¨è¿æ¥å±‚çš„è¿‡ç¨‹ï¼Œ ä¸‹é¢å†çœ‹å¦‚ä½•é€šè¿‡å·ç§¯å®ç°æ»‘åŠ¨çª—å£å¯¹è±¡æ£€æµ‹ç®—æ³•ï¼Œå€Ÿé‰´ OverFeat Paperã€‚ 4.2 å·ç§¯æ»‘åŠ¨çª—å£å®ç°ç›®æ ‡æ£€æµ‹ä¸€èŠ‚ä¸­ä»‹ç»äº†æ»‘åŠ¨çª—å£ã€‚è¦å®ç°çª—å£éå†ï¼Œé‚£ä¹ˆå°±éœ€è¦å¾ˆå¤§çš„è®¡ç®—é‡ï¼ŒBut å¤§ç¥ä»¬è‡ªç„¶å·²ç»æœ‰äº†è§£å†³åŠæ³•ã€‚ æ³¨æ„: ä¸‹é¢çš„ç¬¬ä¸€å¹…å›¾ï¼ŒAndrew Ng ä¸ºäº†æ–¹ä¾¿åªèŠ±äº†å¹³é¢å›¾ï¼Œå°±æ²¡æœ‰ç”»å‡º3Dçš„æ•ˆæœäº†ã€‚ é¦–å…ˆæˆ‘ä»¬å…ˆçœ‹ä¸‹å›¾ï¼Œè¿™å°±æ˜¯ä¸Šé¢æåˆ°çš„å°†å…¨è¿æ¥å±‚è½¬åŒ–æˆå·ç§¯å±‚çš„ç¤ºæ„å›¾: ä¸‹é¢ï¼Œå‡è®¾æˆ‘ä»¬çš„æµ‹è¯•å›¾å¤§å°æ˜¯ 16*16ï¼Œå¹¶ä»¤æ»‘åŠ¨çª—å£å¤§å°æ˜¯ 14*14 çš„ (ä¸ºäº†æ–¹ä¾¿ç†è§£ï¼Œä¸‹å›¾ç”¨è“è‰²æ¸…æ¥šåœ°è¡¨æ˜äº† 14*14 çª—å£çš„å¤§å°), æ­¥é•¿æ˜¯ 2ï¼Œæ‰€ä»¥è¿™ä¸ªæµ‹è¯•å›¾å¯ä»¥è¢«çª—å£åˆ’åˆ†æˆ 4 ä¸ªéƒ¨åˆ†ã€‚éšåå’Œä¸Šé¢æ‰§è¡Œä¸€æ ·çš„æ“ä½œï¼Œæœ€åå¯ä»¥å¾—åˆ° (2,2,4) çš„çŸ©é˜µï¼ˆè¿™æ ·å‘ç°å¾ˆå¤šè®¡ç®—éƒ¨åˆ†æ˜¯é‡å¤çš„ï¼‰ï¼Œæ­¤æ—¶æˆ‘ä»¬ä¸éš¾çœ‹å‡ºæµ‹è¯•å›¾è¢«æ»‘åŠ¨çª—å£é€‰å–çš„å·¦ä¸Šè§’éƒ¨åˆ†å¯¹åº”çš„ç»“æœä¹Ÿæ˜¯è¾“å‡ºçŸ©é˜µçš„å·¦ä¸Šè§’éƒ¨åˆ†ï¼Œå…¶ä»–3ä¸ªéƒ¨åˆ†åŒç†ã€‚ æ‰€ä»¥è¿™è¯´æ˜äº†ä»€ä¹ˆï¼Ÿ è¯´æ˜æˆ‘ä»¬æ²¡æœ‰å¿…è¦ç”¨æ»‘åŠ¨çª—å£æˆªå–ä¸€éƒ¨åˆ†ï¼Œç„¶åå¸¦å…¥å·ç§¯ç½‘ç»œè¿ç®—ã€‚ç›¸åæˆ‘ä»¬å¯ä»¥æ•´ä½“è¿›è¡Œè¿ç®—ï¼Œè¿™æ ·é€Ÿåº¦å°±å¿«å¾ˆå¤šäº†ã€‚ ä¸‹å›¾å¾ˆæ¸…æ¥šçš„å±•ç¤ºäº†å·ç§¯æ»‘åŠ¨çª—å£çš„å®ç°ã€‚æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å›¾ç‰‡è¢«åˆ’åˆ†æˆäº† 64 å— ç›®å‰è¿™ä¸ªç®—æ³•è¿˜æœ‰ä¸€ä¸ªç¼ºç‚¹ï¼Œå°±æ˜¯è¾¹ç•Œæ¡†çš„ä½ç½®å¯èƒ½ä¸å¤Ÿå‡†ç¡®ï¼Œä¸‹ä¸€èŠ‚ï¼Œæˆ‘ä»¬å°†å­¦ä¹ è§£å†³è¿™ä¸ªç¼ºç‚¹ã€‚ 5. Bounding Box Predictionsä¸Šé¢ä»‹ç»çš„æ»‘åŠ¨çª—å£æ–¹æ³•å­˜åœ¨ä¸€ä¸ªé—®é¢˜å°±æ˜¯å¾ˆå¤šæƒ…å†µä¸‹æ»‘åŠ¨çª—å£å¹¶ä¸èƒ½å¾ˆå¥½çš„åˆ‡å‰²å‡ºè½¦ä½“ï¼Œå¦‚ä¸‹å›¾ç¤ºï¼š ä¸Šé¢ä¸­çš„è“è‰²æ¡†å¯èƒ½æ˜¯æ»‘åŠ¨çª—å£çš„æ—¶å€™ï¼Œæœ€ä½³çš„åŒ¹é…ä½ç½®äº†ï¼Œä½†æ˜¯å…¶å®æˆ‘ä»¬äººçœ‹åï¼Œå…¶å®å¾ˆæ˜æ˜¾å‘ç°ï¼Œè¿™å¹¶ä¸æ˜¯ï¼Œè¿™å°±æ˜¯æˆ‘ä»¬è¦è§£å†³çš„é—®é¢˜æ‰€åœ¨. å…¶å®æœ€ä½³çš„åŒ¹é…ä½ç½®åº”è¯¥æ˜¯çº¢è‰²çš„æ¡†ï¼Œç¨å¾®æœ‰ç‚¹é•¿æ–¹å½¢ï¼Œé•¿å®½æ¯”æœ‰ç‚¹å‘æ°´å¹³æ–¹å‘å»¶ä¼¸. ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå°±æœ‰äº† YOLO (you only look once) ç®—æ³•ï¼Œå³åªéœ€è¦è®¡ç®—ä¸€æ¬¡ä¾¿å¯ç¡®å®šéœ€è¦è¯†åˆ«ç‰©ä½“çš„ä½ç½®çš„å¤§å°ã€‚ åŸç†å¦‚ä¸‹ï¼š é¦–å…ˆå°†å›¾åƒåˆ’åˆ†æˆ 3*3 (å³9ä»½)ï¼Œæ¯ä¸€ä»½æœ€åç”±ä¸€ä¸ªå‘é‡è¡¨ç¤ºï¼Œè¿™ä¸ªå‘é‡åœ¨æœ¬æ–‡æœ€å‰é¢ä»‹ç»è¿‡ï¼Œå³ y=[P\\_c,b\\_x,b\\_y,b\\_h,b\\_w,c\\_1,c\\_2,c\\_3] å¦‚æœä¸€ä¸ªæ ¼å­ä¸­æœ‰ä¸¤ä¸ªå¯¹è±¡ï¼Œé‚£ä¹ˆå°±å½“åšè¿™ä¸ªæ ¼å­ä¸­ä¸å­˜åœ¨å¯¹è±¡. æŒ‰ç…§ $P_c = 0$ å¤„ç†. (å¦‚æœæ˜¯ 19 * 19 çš„æƒ…å†µï¼Œä¸¤ä¸ªå¯¹è±¡çš„ä¸­ç‚¹åˆ†é…åˆ°ä¸€ä¸ªæ ¼å­çš„æƒ…å†µï¼Œå…¶å®ç‰¹åˆ«ä½) å› ä¸ºæœ‰ 9 ä»½ï¼Œæ‰€ä»¥æœ€åè¾“å‡ºçŸ©é˜µå¤§å°æ˜¯ (3,3,8) , å¦‚ä¸‹å›¾ç¤ºï¼š é‚£ä¹ˆå¦‚ä½•æ„å»ºå·ç§¯ç½‘ç»œå‘¢ï¼Ÿ è¾“å…¥çŸ©é˜µæ˜¯ (100, 100, 3), ç„¶åæ˜¯ Convï¼ŒMaxpool å±‚ï¼Œâ€¦â€¦ï¼Œæœ€ååªè¦ç¡®ä¿è¾“å‡ºçŸ©é˜µå¤§å°æ˜¯ (3,3,8) å³å¯ã€‚ è¿™æ˜¯ä¸€ä¸ªå·ç§¯å®ç°ï¼Œä½ å¹¶æ²¡æœ‰åœ¨ 3 * 3 ç½‘æ ¼ä¸Šè·‘ 9 æ¬¡ç®—æ³•ï¼Œ19 * 19 åŒæ ·ä½ ä¸éœ€è¦ç½‘æ ¼ä¸Šè·‘ 361 æ¬¡ï¼Œç›¸åè¿™æ˜¯å•æ¬¡å·ç§¯çš„å®ç°ï¼Œä½†ä½ ä½¿ç”¨äº†ä¸€ä¸ªå·ç§¯ç½‘ç»œï¼Œæœ‰å¾ˆå¤šå…±äº«è®¡ç®—æ­¥éª¤ï¼Œæ¯”å¦‚åœ¨å¤„ç†è¿™ 3 * 3 è®¡ç®—ä¸­å¾ˆå¤šè®¡ç®—æ­¥éª¤æ˜¯å…±äº«çš„. æ‰€ä»¥è¿™ä¸ªç®—æ³•çš„æ•ˆç‡å¾ˆé«˜. YOLO ç®—æ³•æœ‰ä¸€ä¸ªå¥½å¤„æ˜¯ï¼Œå®ƒçš„è®¡ç®—ç‰¹åˆ«å¿«ï¼Œå¯ä»¥è¾¾åˆ°å®æ—¶è¯†åˆ«ã€‚ ä¸‹å›¾æ˜¯ä»¥å³è¾¹çš„è½¦è¾†ä½œä¸ºç¤ºä¾‹ä»‹ç»è¯¥è½¦è¾†æ‰€åœ¨æ¡†çš„è¾“å‡ºçŸ©é˜µ å¾ˆæ˜¾ç„¶ $P_c=1$ ç„¶å $b_x,b_y$ çš„å€¼æ˜¯å³è¾¹è½¦è¾†çš„ä¸­å¿ƒç‚¹ç›¸å¯¹äºè¯¥æ¡†çš„ä½ç½®,æ‰€ä»¥å®ƒä»¬çš„å€¼æ˜¯ä¸€å®šå°äº 1 çš„ï¼Œæˆ‘ä»¬å¯ä»¥å¾ˆå®¹æ˜“çš„å¾—åˆ°è¿‘ä¼¼å€¼ $b_x=0.4, b_y=0.3$ $b_h,b_w$ çš„å€¼åŒç†ä¹Ÿæ˜¯è½¦è¾†çš„å®½é«˜ç›¸å¯¹äºå…¶æ‰€åœ¨æ¡†çš„æ¯”ä¾‹ï¼Œä½†æ˜¯è¦æ³¨æ„çš„æ˜¯è¿™ä¸¤ä¸ªå€¼æ˜¯å¯ä»¥å¤§äº 1 çš„ï¼Œå› ä¸ºæœ‰å¯èƒ½éƒ¨åˆ†è½¦èº«åœ¨æ¡†å¤–ã€‚ä½†æ˜¯ä¹Ÿå¯ä»¥ä½¿ç”¨ sigmoidå‡½æ•° å°†å€¼æ§åˆ¶åœ¨ 1 ä»¥å†…ã€‚ è¿™é‡Œæˆ‘ç”¨ 3 * 3 çš„ç½‘æ ¼è¯´æ˜ï¼Œåœ¨å®è·µä¸­å¯èƒ½ 19 * 19 çš„ç½‘æ ¼ä¼šç²¾ç»†çš„å¤š. é¿å…æŠŠ å¤šä¸ª å¯¹è±¡åˆ†é…åˆ°åŒä¸€ä¸ªæ ¼å­ä¸­ï¼Œè§‚å¯Ÿè¿™ä¸ªå¯¹è±¡çš„ä¸­ç‚¹ï¼Œç„¶åå°†å›¾åƒå¯¹è±¡åˆ†é…åˆ°å…¶ä¸­ç‚¹æ‰€åœ¨çš„æ ¼å­. 19 * 19 çš„ç½‘æ ¼, ä¸¤ä¸ªå¯¹è±¡çš„ä¸­ç‚¹å¤„äºåŒä¸€ä¸ªæ ¼å­çš„æ¦‚ç‡ä¼šæ›´ä½. ä¸Šé¢å´å¤§å¤§ç»™å‡ºçš„æ˜¯ä¸€ä¸ªåˆç†çš„çº¦å®šï¼Œä½¿ç”¨èµ·æ¥åº”è¯¥æ²¡ä»€ä¹ˆé—®é¢˜. å…¶å®è¿˜æœ‰å…¶ä»–æ›´å¤æ‚çš„å‚æ•°åŒ–å½¢å¼. YOLO çš„è®ºæ–‡æ˜¯ç›¸å¯¹éš¾åº¦è¾ƒé«˜çš„è®ºæ–‡, Andrew Ng çœ‹çš„æ—¶å€™ä¹Ÿçœ‹ä¸æ‡‚å¾ˆå¤š. 6. Intersection Over Unionå¦‚ä½•è¯„ä»·å¯¹è±¡æ£€æµ‹ç®—æ³•å‘¢ï¼ŒIOU äº¤å¹¶æ¯”å‡½æ•°å¯ä»¥ç”¨æ¥è¯„ä»·å¯¹è±¡æ£€æµ‹ç®—æ³•ã€‚ å‰é¢è¯´åˆ°äº†å®ç°ç›®æ ‡å®šä½æ—¶å¯èƒ½å­˜åœ¨ æ»‘åŠ¨çª—å£ ä¸ çœŸå®è¾¹æ¡† å­˜åœ¨å‡ºå…¥ï¼Œå¦‚ä¸‹å›¾ç¤ºï¼š çº¢è‰²æ¡†æ˜¯è½¦èº«è¾¹ç•Œï¼Œç´«è‰²æ¡†æ˜¯æ»‘åŠ¨çª—å£ï¼Œé‚£ä¹ˆæ­¤çª—å£è¿”å›çš„å€¼æ˜¯æœ‰è½¦è¿˜æ˜¯æ— è½¦å‘¢ï¼Ÿ ä¸ºäº†è§£å†³ä¸Šé¢çš„é—®é¢˜å¼•å…¥äº†äº¤å¹¶æ¯”(IoU)ï¼Œä¹Ÿå°±æ˜¯ä¸¤ä¸ªæ¡†ä¹‹é—´çš„äº¤é›†ä¸å¹¶é›†ä¹‹æ¯”ï¼Œä¾æ®è¿™ä¸ªå€¼å¯ä»¥è¯„ä»·å®šä½ç®—æ³•æ˜¯å¦ç²¾å‡†ã€‚ ä¸Šå›¾é»„è‰²åŒºåŸŸè¡¨ç¤ºç´«è‰²æ¡†å’Œçº¢è‰²æ¡†çš„äº¤é›†ï¼Œç»¿è‰²åŒºåŸŸè¡¨ç¤ºç´«è‰²æ¡†å’Œçº¢è‰²æ¡†çš„å¹¶é›†ï¼Œäº¤å¹¶æ¯”(IoU)å°±ç­‰äº é»„è‰²åŒºåŸŸå¤§å° æ¯”ä¸Š ç»¿è‰²åŒºåŸŸå¤§å°ã€‚ å¦‚æœ $IoU\\geq0.5$ï¼Œåˆ™è¡¨ç¤ºç´«è‰²æ¡†ä¸­æœ‰è½¦è¾†ï¼Œåä¹‹æ²¡æœ‰ã€‚ å½“ç„¶ 0.5 è¿™ä¸ªé˜ˆå€¼æ˜¯äººä¸ºè®¾å®šçš„ï¼Œæ²¡æœ‰æ·±å…¥çš„ç§‘å­¦æ¢ç©¶ï¼Œæ‰€ä»¥å¦‚æœå¸Œæœ›ç»“æœæ›´åŠ ç²¾ç¡®ï¼Œä¹Ÿå¯ä»¥ç”¨ 0.6 æˆ– 0.7 è®¾ä¸ºé˜ˆå€¼ï¼Œä½†æ˜¯ä¸å»ºè®®ç”¨å°äº 0.5 çš„é˜ˆå€¼ã€‚ ä¸‹ä¸€èŠ‚è®¨è®ºè¿™ä¸ª Non-max Suppression å·¥å…·ï¼Œå¯ä»¥è®© YOLO å·¥ä½œçš„æ›´å¥½ 7. Non-max Suppression éæå¤§å€¼æŠ‘åˆ¶å¯ä»¥ç¡®ä¿ä½ å¯¹æ¯ä¸ªå¯¹è±¡åªæ£€æµ‹ä¸€æ¬¡ã€‚ ç®—æ³•å¤§è‡´æ€è·¯ å‰é¢ Bounding Box ä¸€èŠ‚ä¸­ä»‹ç»åˆ°å°†å›¾ç‰‡åˆ’åˆ†æˆè‹¥å¹²ç­‰åˆ†ï¼Œä¾‹å¦‚ 3*3ï¼Œé‚£ä¹ˆä¸€å…±å°±æœ‰9å—ï¼Œå¦‚ä¸‹å›¾ç¤ºï¼Œæˆ‘ä»¬å¯ä»¥å¾ˆæ¸…æ¥šçš„çœ‹åˆ°ç¬¬äºŒè¡Œç¬¬ä¸€å—å’Œç¬¬ä¸‰å—éƒ½æœ‰è½¦ï¼Œæ‰€ä»¥å¯ä»¥æ ‡å‡ºä¸€ä¸ªä¸­å¿ƒç‚¹åæ ‡ $(b_x,b_y)$ï¼Œè¿™æ ·æˆ‘ä»¬å°±èƒ½é€šè¿‡æœ€ç»ˆçš„è¾“å‡ºç»“æœçŸ¥é“è¿™ä¸¤ä¸ªæ¡†ä¸­æœ‰è½¦ã€‚ ä½†æ˜¯å¦‚æœæˆ‘ä»¬åˆ’åˆ†çš„æ•°é‡å˜å¤šä¹‹åå‘¢ï¼Ÿå¦‚ä¸‹å›¾ç¤ºåˆ’åˆ†æˆäº† 19*19ï¼Œå›¾ä¸­æ ‡å‡ºçš„ 3 ä¸ªé»„æ¡†å’Œ 3 ä¸ªç»¿æ¡†æœ€ç»ˆç»“æœéƒ½ä¼šéƒ½ä¼šè¿”å›[$P_x=1,b_x=,b_y=â€¦â€¦$]ï¼Œä½†æ˜¯æœ€åæˆ‘ä»¬è¯¥ä¿¡è°çš„å‘¢ï¼Ÿæ˜¯è¿™ä¸‰ä¸ªæ¡†çœŸçš„æœ‰è½¦ï¼Œè€Œä¸”è¿˜ä¸æ˜¯åŒä¸€è¾†è½¦ï¼Ÿè¿˜æ˜¯åªæ˜¯åŒä¸€è¾†è½¦ï¼Ÿæ‰€ä»¥å°±æœ‰äº†éæå¤§å€¼æŠ‘åˆ¶æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚ Non-max Suppression åšçš„å°±æ˜¯æ¸…ç†è¿™äº›æ£€æµ‹ç»“æœï¼Œè¿™æ ·ä¸€è¾†è½¦åªæ£€æµ‹ä¸€æ¬¡ï¼Œè€Œä¸æ˜¯æ¯è¾†è½¦éƒ½å‡ºå‘å¤šæ¬¡æ£€æµ‹ã€‚ å…¶æ€è·¯å¤§è‡´å¦‚ä¸‹ (ä¸ºäº†æ–¹ä¾¿è¯´æ˜å’Œç†è§£ï¼Œæˆ‘ä»¬ä¸ä½¿ç”¨ 19*19 çš„æ–¹æ¡†)ï¼š é¦–å…ˆæ¯ä¸ªæ¡†ä¼šå¯¹æ˜¯å¦æœ‰ç›®æ ‡è¿”å›ä¸€ä¸ª $P_c$ çš„æ¦‚ç‡å€¼ (ä¹Ÿå¯ä»¥æ˜¯ $P_c*C_1*C_2*C_3$ çš„æ¦‚ç‡ä¹‹ç§¯)ï¼Œå¦‚ä¸‹å›¾ç¤ºï¼š ç„¶åæ‰¾åˆ° $P_c$ æœ€å¤§çš„ä¸€ä¸ªæ¡†ï¼Œæ˜¾ç„¶ 0.9 çš„æ¡†æœ‰è½¦çš„æ¦‚ç‡æœ€å¤§ï¼Œæ‰€ä»¥è¯¥è¾¹æ¡†é¢œè‰²é«˜äº® ç„¶åç®—æ³•éå†å…¶ä»–è¾¹æ¡†ï¼Œæ‰¾å‡ºä¸ä¸Šä¸€ä¸ªè¾¹æ¡†çš„äº¤å¹¶æ¯”å¤§äº 0.5 çš„è¾¹æ¡†ï¼Œå¾ˆæ˜¾ç„¶å³è¾¹å‰©ä½™ä¸¤ä¸ªè¾¹æ¡†ç¬¦åˆæ¡ä»¶ï¼Œæ‰€ä»¥è¿™ä¸¤ä¸ªè¾¹æ¡†å˜æš— å·¦è¾¹çš„è½¦åŒç†ï¼Œä¸åŠ èµ˜è¿° ä¸‹é¢ç»“åˆä¸€ä¸ªä¾‹å­æ€»ç»“ä¸€ä¸‹ éæå¤§å€¼æŠ‘åˆ¶ ç®—æ³•çš„å®ç°æ­¥éª¤ï¼š åœ¨è¿™é‡Œå‡è®¾åªéœ€è¦è¯†åˆ«å®šä½è½¦è¾†å³å¯ï¼Œæ‰€ä»¥è¾“å‡ºæ ¼å¼ä¸º $P_c,b_x,b_y,b_h,b_w$ è¿™ä¸ªä¾‹å­ä¸­å°†å›¾åƒåˆ’åˆ†æˆ 19*19 æ–¹æ ¼ï¼Œå‡è®¾æ¯ä¸ªæ–¹æ ¼éƒ½å·²ç»è®¡ç®—å‡º $P_c$ çš„æ¦‚ç‡å€¼ å»æ‰æ‰€æœ‰æ»¡è¶³ $P_c â‰¤ 0.6$ çš„æ–¹æ ¼ (0.6ä¹Ÿå¯ä»¥è¿›è¡Œäººä¸ºä¿®æ”¹) å¯¹å‰©ä¸‹çš„æ–¹æ ¼è¿›è¡Œå¦‚ä¸‹å¾ªç¯æ“ä½œï¼š ä»å‰©ä¸‹çš„æ–¹æ ¼ä¸­é€‰å– $P_c$ æœ€å¤§çš„ä¸€ä¸ªä½œä¸ºé¢„æµ‹å€¼è¾“å‡ºï¼Œå‡è®¾è¿™ä¸ªæ–¹æ ¼ä¸º $A$ å°†ä¸ $A$ æ–¹æ ¼äº¤å¹¶æ¯”å¤§äº 0.5 çš„å‰”é™¤ 8. Anchor Boxeså‰é¢ä»‹ç»äº†é‚£ä¹ˆå¤šï¼Œéƒ½åªæ˜¯è¯†åˆ«å•ä¸ªç‰©ä½“ï¼Œå¦‚æœè¦åŒæ—¶è¯†åˆ«å¤šä¸ªç‰©ä½“è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿè€Œä¸”è¯†åˆ«çš„ä¸åŒç‰©ä½“çš„ä¸­å¿ƒç‚¹åœ¨åŒä¸€ä¸ªæ¡†ä¸­åˆè¯¥æ€ä¹ˆå‘¢ (å¦‚ä¸‹å›¾ç¤ºï¼Œäººå’Œè½¦çš„ä¸­å¿ƒéƒ½åœ¨çº¢ç‚¹ä½ç½®ï¼Œå¤„äºåŒä¸€ä¸ªæ¡†ä¸­)ï¼Ÿè¿™æ—¶å°±éœ€è¦ä½¿ç”¨ Anchor Boxes äº†ã€‚ Anchor Boxes æ€è·¯æ˜¯å¯¹äºä¸åŒç‰©ä½“äº‹å…ˆé‡‡ç”¨ä¸åŒçš„æ¡†ï¼Œä¾‹å¦‚äººç›¸å¯¹äºè½¦å±äºç˜¦é«˜çš„ï¼Œæ‰€ä»¥ä½¿ç”¨ä¸‹å›¾ä¸­çš„ Anchor Box 1ï¼Œç›¸åè½¦è¾†å°±ä½¿ç”¨ Anchor Box 2. ä¹‹å‰çš„è¾“å‡ºå€¼çš„æ ¼å¼éƒ½æ˜¯ $y=[P_x,b_x,b]_y,b_h,b_w,C_1,C_2,C_3]$ï¼Œæœ€åè¾“å‡ºçš„çŸ©é˜µå¤§å°(ä»¥è¯¥å›¾ä¸ºä¾‹) æ˜¯ (3,3,8), ä½†æ˜¯è¿™æ ·åªèƒ½ç¡®å®šä¸€ä¸ªç‰©ä½“ã€‚ æ‰€ä»¥ä¸ºäº†åŒæ—¶æ£€æµ‹ä¸åŒç‰©ä½“ï¼Œå¾ˆè‡ªç„¶çš„æˆ‘ä»¬å¯ä»¥é‡å¤è¾“å‡ºè¿™ä¸ªä¸Šé¢çš„å€¼å³å¯ï¼Œå³ $y = [P_x, b_x, b_y, b_h, b_w, C_1, C_2, C_3, P_x, b_x, b_y, b_h, b_w, C_1, C_2, C_3]$, æ‰€ä»¥è¾“å‡ºçŸ©é˜µæ˜¯ (3,3,16), ä¹Ÿå¯ä»¥æ˜¯(3,3,2,8)ã€‚ è¦æ³¨æ„çš„æ˜¯æˆ‘ä»¬éœ€è¦æå‰è®¾å®šå¥½è¾“å‡ºå€¼å‰é¢çš„å€¼å¯¹åº” Anchor Box 1ï¼Œåé¢çš„å¯¹åº” Anchor Box 2. ä¾‹å¦‚æˆ‘ä»¬å¾—åˆ°äº†å›¾ä¸­äººçš„è¾¹æ¡†ä¿¡æ¯å€¼ï¼Œç„¶åç»è¿‡è®¡ç®—å‘ç°å…¶è¾¹æ¡†ä¸ Anchor Box 1æ›´ä¸ºæ¥è¿‘ï¼Œæ‰€ä»¥æœ€åå°†äººçš„è¾¹æ¡†ä¿¡æ¯å¯¹åº”åœ¨å‰é¢ï¼ŒåŒç†è½¦è¾†è¾¹æ¡†ä¿¡æ¯å¯¹åº”åœ¨åé¢ã€‚ æ€»ç»“èµ·æ¥ Anchor Boxç®—æ³• å’Œ ä¹‹å‰çš„ç®—æ³•åŒºåˆ«å¦‚ä¸‹ï¼š ä¹‹å‰çš„ç®—æ³•ï¼š å¯¹äºè®­ç»ƒé›†å›¾åƒä¸­çš„æ¯ä¸ªå¯¹è±¡ï¼Œéƒ½æ ¹æ®é‚£ä¸ªå¯¹è±¡çš„ä¸­ç‚¹ä½ç½®åˆ†é…åˆ°å¯¹åº”çš„æ ¼å­ä¸­,æ‰€ä»¥åœ¨ä¸Šé¢çš„ç¤ºä¾‹ä¸­è¾“å‡ºyå°±æ˜¯(3,3,8) Anchor Boxes ç®—æ³• ç°åœ¨æ¯ä¸ªå¯¹è±¡éƒ½å’Œä¹‹å‰ä¸€æ ·åˆ†é…åˆ°åŒä¸€ä¸ªæ ¼å­ä¸­, å³å¯¹è±¡ä¸­å¿ƒæ‰€åœ¨çš„æ ¼å­ã€‚ä¸åŒçš„æ˜¯ä¹Ÿéœ€è¦åˆ†é…åˆ°å’Œå¯¹è±¡å½¢çŠ¶äº¤å¹¶æ¯”æœ€é«˜çš„ Anchor Boxã€‚ ä¾‹å¦‚ä¸‹å›¾ä¸­çš„çº¢è‰²æ¡†ä¸ä»…è¦åˆ†é…åˆ°å…¶ä¸­å¿ƒæ‰€åœ¨çš„å›¾åƒä¸Šçš„æ ¼å­ä¸­ï¼Œè€Œä¸”è¿˜éœ€è¦åˆ†é…åˆ°ä¸å…¶äº¤å¹¶æ¯”æœ€å¤§çš„ Anchor Box ä¸­ï¼Œå³ç«–æ¡çš„ç´«è‰²æ–¹æ ¼ã€‚ å›åˆ°æœ¬å°èŠ‚æœ€å¼€å§‹çš„ä¾‹å­ï¼Œæœ€åçš„è¾“å‡ºå€¼å¦‚ä¸‹å›¾ç¤ºï¼š å›¾ä¸­äººçš„å¯¹åº” Anchor Box 1ï¼Œ è¾“å‡ºå€¼å¯¹åº”å›¾ä¸­çš„é»„è‰²å­—ä½“ï¼›è½¦è¾†åŒç†ï¼Œå¯¹åº”ç»¿è‰²å­—ä½“ å¦‚æœä¸¤ä¸ªå¯¹è±¡æ‰€åœ¨ä¸€ä¸ªæ ¼å­ï¼Œä¸”ä¸¤ä¸ªå¯¹è±¡åœˆå‡ºæ¥çš„æ¡†ä¹Ÿæ˜¯ä¸€æ ·çš„ï¼Œè¿™ç§æƒ…å†µéå¸¸éå¸¸å°‘è§ï¼Œæˆ‘ä»¬ç”¨å…¶ä»–æ–¹æ³•æ¥ç‰¹æ®Šå¤„ç†. 9. YOLO Algorithm YOLO Algorithm, that also encompasses many of the best ideas across the entire computer vision literature the relate to object detection. YOLO è®¡ç®—æœºè§†è§‰å¯¹è±¡æ£€æµ‹é¢†åŸŸæ–‡çŒ®ä¸­æœ€ç²¾å¦™çš„æ€è·¯ã€‚ 10. Region Proposals (Optional)å€™é€‰åŒºåŸŸï¼Œè¿™äº›ç›®å‰å·¥ä½œå…¶å®ç”¨çš„å¾ˆå°‘ï¼Œä½†æ˜¯è¿˜æ˜¯éå¸¸æœ‰æ„ä¹‰çš„ï¼Œæ‰€ä»¥æˆ‘ä½œä¸ºå¯é€‰è§†é¢‘å¯å­¦ä¹ .â€‹â€‹â€‹â€‹ å´å¤§å¤§è®¤ä¸º YOLO è¿™ç§åªçœ‹ä¸€æ¬¡çš„ç®—æ³•ï¼Œé•¿è¿œè€Œè¨€æ˜¯CVé¢†åŸŸæ›´æœ‰å¸Œæœ›çš„æ–¹å‘ Reference ç½‘æ˜“äº‘è¯¾å ‚ - deeplearning DeepLearning.aiå­¦ä¹ ç¬”è®°æ±‡æ€»","categories":[{"name":"deeplearning","slug":"deeplearning","permalink":"http://iequa.com/categories/deeplearning/"}],"tags":[{"name":"deeplearning.ai","slug":"deeplearning-ai","permalink":"http://iequa.com/tags/deeplearning-ai/"}]},{"title":"Python ä¸­ 4 ä¸ªé­”æ³•æ–¹æ³•ï¼Œ __len__,__getitem__,__setitem__,__iter__","slug":"python/language/py-language-9-class","date":"2018-09-01T02:00:21.000Z","updated":"2019-10-20T04:30:35.005Z","comments":true,"path":"2018/09/01/python/language/py-language-9-class/","link":"","permalink":"http://iequa.com/2018/09/01/python/language/py-language-9-class/","excerpt":"pythonä¸­é™¤äº†å¯ä»¥ä½¿ç”¨å†…å»ºçš„ç±»å‹ï¼Œå¦‚ list,tuple,dictï¼Œè¿˜å¯ä»¥åˆ›å»ºè‡ªå·±çš„å¯¹è±¡æ¥å®ç°åƒè¿™äº›å†…å»ºç±»å‹çš„è®¿é—® ä¸è¿‡éœ€è¦åœ¨å®šä¹‰ç±»çš„æ—¶å€™å¯¹è¿™äº›é­”æ³•æ–¹æ³•å®ç°: __len__, __getitem__, __setitem__, __iter__","text":"pythonä¸­é™¤äº†å¯ä»¥ä½¿ç”¨å†…å»ºçš„ç±»å‹ï¼Œå¦‚ list,tuple,dictï¼Œè¿˜å¯ä»¥åˆ›å»ºè‡ªå·±çš„å¯¹è±¡æ¥å®ç°åƒè¿™äº›å†…å»ºç±»å‹çš„è®¿é—® ä¸è¿‡éœ€è¦åœ¨å®šä¹‰ç±»çš„æ—¶å€™å¯¹è¿™äº›é­”æ³•æ–¹æ³•å®ç°: __len__, __getitem__, __setitem__, __iter__ Reference pythonçš„è¿­ä»£å™¨ä¸ºä»€ä¹ˆä¸€å®šè¦å®ç°iteræ–¹æ³•ï¼Ÿ python liaoxuefeng","categories":[{"name":"python","slug":"python","permalink":"http://iequa.com/categories/python/"}],"tags":[{"name":"python","slug":"python","permalink":"http://iequa.com/tags/python/"}]},{"title":"Placeholder ä¼ å…¥å€¼","slug":"tensorflow/tf-2.5-placeholde","date":"2018-08-30T03:45:21.000Z","updated":"2020-07-03T03:33:11.131Z","comments":true,"path":"2018/08/30/tensorflow/tf-2.5-placeholde/","link":"","permalink":"http://iequa.com/2018/08/30/tensorflow/tf-2.5-placeholde/","excerpt":"placeholder æ˜¯ Tensorflow ä¸­çš„å ä½ç¬¦ï¼Œæš‚æ—¶å‚¨å­˜å˜é‡.","text":"placeholder æ˜¯ Tensorflow ä¸­çš„å ä½ç¬¦ï¼Œæš‚æ—¶å‚¨å­˜å˜é‡. Tensorflow å¦‚æœæƒ³è¦ä»å¤–éƒ¨ä¼ å…¥data, é‚£å°±éœ€è¦ç”¨åˆ° tf.placeholder(), ç„¶åä»¥è¿™ç§å½¢å¼ä¼ è¾“æ•°æ® sess.run(**, feed_dict=&#123;input: **&#125;). ä¸¾ä¸ªğŸŒ°: import tensorflow as tf#åœ¨ Tensorflow ä¸­éœ€è¦å®šä¹‰ placeholder çš„ type ï¼Œä¸€èˆ¬ä¸º float32 å½¢å¼input1 = tf.placeholder(tf.float32)input2 = tf.placeholder(tf.float32)# mul = multiply æ˜¯å°†input1å’Œinput2 åšä¹˜æ³•è¿ç®—ï¼Œå¹¶è¾“å‡ºä¸º output ouput = tf.multiply(input1, input2) æ¥ä¸‹æ¥, ä¼ å€¼çš„å·¥ä½œäº¤ç»™äº† sess.run() , éœ€è¦ä¼ å…¥çš„å€¼æ”¾åœ¨äº† feed_dict=&#123;&#125; å¹¶ä¸€ä¸€å¯¹åº”æ¯ä¸€ä¸ª input. placeholder ä¸ feed_dict=&#123;&#125; æ˜¯ç»‘å®šåœ¨ä¸€èµ·å‡ºç°çš„ã€‚ with tf.Session() as sess: print(sess.run(ouput, feed_dict=&#123;input1: [7.], input2: [2.]&#125;))# [ 14.] Reference tensorflow.org è«çƒ¦Python","categories":[{"name":"tensorflow","slug":"tensorflow","permalink":"http://iequa.com/categories/tensorflow/"}],"tags":[{"name":"tensorflow","slug":"tensorflow","permalink":"http://iequa.com/tags/tensorflow/"}]},{"title":"Variable å˜é‡","slug":"tensorflow/tf-2.4-variable","date":"2018-08-29T02:07:21.000Z","updated":"2020-07-03T03:33:16.990Z","comments":true,"path":"2018/08/29/tensorflow/tf-2.4-variable/","link":"","permalink":"http://iequa.com/2018/08/29/tensorflow/tf-2.4-variable/","excerpt":"åœ¨ Tensorflow ä¸­ä½¿ç”¨ Variableã€‚ åœ¨ Tensorflow ä¸­ï¼Œå®šä¹‰äº†æŸå­—ç¬¦ä¸²æ˜¯å˜é‡ï¼Œå®ƒæ‰æ˜¯å˜é‡ï¼Œè¿™ä¸€ç‚¹æ˜¯ä¸ Python æ‰€ä¸åŒçš„ã€‚","text":"åœ¨ Tensorflow ä¸­ä½¿ç”¨ Variableã€‚ åœ¨ Tensorflow ä¸­ï¼Œå®šä¹‰äº†æŸå­—ç¬¦ä¸²æ˜¯å˜é‡ï¼Œå®ƒæ‰æ˜¯å˜é‡ï¼Œè¿™ä¸€ç‚¹æ˜¯ä¸ Python æ‰€ä¸åŒçš„ã€‚ å®šä¹‰è¯­æ³•ï¼š state = tf.Variable() import tensorflow as tfstate = tf.Variable(0, name=&#x27;counter&#x27;)# å®šä¹‰å¸¸é‡ oneone = tf.constant(1)# å®šä¹‰åŠ æ³•æ­¥éª¤ (æ³¨: æ­¤æ­¥å¹¶æ²¡æœ‰ç›´æ¥è®¡ç®—)new_value = tf.add(state, one)# å°† State æ›´æ–°æˆ new_valueupdate = tf.assign(state, new_value) å¦‚æœä½ åœ¨ Tensorflow ä¸­è®¾å®šäº†å˜é‡ï¼Œé‚£ä¹ˆåˆå§‹åŒ–å˜é‡æ˜¯æœ€é‡è¦çš„ï¼ï¼æ‰€ä»¥å®šä¹‰äº†å˜é‡ä»¥å, ä¸€å®šè¦å®šä¹‰ init = tf.initialize_all_variables(). åˆ°è¿™é‡Œå˜é‡è¿˜æ˜¯æ²¡æœ‰è¢«æ¿€æ´»ï¼Œéœ€è¦å†åœ¨ sess é‡Œ, sess.run(init) , æ¿€æ´» init è¿™ä¸€æ­¥. # å¦‚æœå®šä¹‰ Variable, å°±ä¸€å®šè¦ initialize# init = tf.initialize_all_variables() # tf é©¬ä¸Šå°±è¦åºŸå¼ƒè¿™ç§å†™æ³•init = tf.global_variables_initializer() # æ›¿æ¢æˆè¿™æ ·å°±å¥½ # ä½¿ç”¨ Sessionwith tf.Session() as sess: sess.run(init) print(sess.run(new_value)) for i in range(3): sess.run(update) # ç›¸å½“äºè¿è¡Œäº†ä¸€é tf.assign(state, new_value+100)ï¼Œ å› ä¸ºè¿™æ˜¯ update print(sess.run(state)) print(&quot;Sess Hello !&quot;) æ³¨æ„ï¼šç›´æ¥ print(state) ä¸èµ·ä½œç”¨ï¼ï¼ ä¸€å®šè¦æŠŠ sess çš„æŒ‡é’ˆæŒ‡å‘ state å†è¿›è¡Œ print æ‰èƒ½å¾—åˆ°æƒ³è¦çš„ç»“æœï¼ Reference tensorflow.org è«çƒ¦Python æ–°ç‰ˆå¯è§†åŒ–æ•™å­¦ä»£ç ","categories":[{"name":"tensorflow","slug":"tensorflow","permalink":"http://iequa.com/categories/tensorflow/"}],"tags":[{"name":"tensorflow","slug":"tensorflow","permalink":"http://iequa.com/tags/tensorflow/"}]},{"title":"Session ä¼šè¯æ§åˆ¶","slug":"tensorflow/tf-2.3-session","date":"2018-08-28T08:07:21.000Z","updated":"2020-07-03T03:33:24.472Z","comments":true,"path":"2018/08/28/tensorflow/tf-2.3-session/","link":"","permalink":"http://iequa.com/2018/08/28/tensorflow/tf-2.3-session/","excerpt":"Session æ˜¯ Tensorflow ä¸ºäº†æ§åˆ¶,å’Œè¾“å‡ºæ–‡ä»¶çš„æ‰§è¡Œè¯­å¥. è¿è¡Œ session.run() å¯ä»¥è·å¾—ä½ è¦å¾—çŸ¥çš„è¿ç®—ç»“æœ.","text":"Session æ˜¯ Tensorflow ä¸ºäº†æ§åˆ¶,å’Œè¾“å‡ºæ–‡ä»¶çš„æ‰§è¡Œè¯­å¥. è¿è¡Œ session.run() å¯ä»¥è·å¾—ä½ è¦å¾—çŸ¥çš„è¿ç®—ç»“æœ. import tensorflow as tfa = tf.constant([1.0, 2.0], name=&quot;a&quot;)b = tf.constant([2.0, 3.0], name=&quot;b&quot;) # a, b å®šä¹‰ä¸º 2 ä¸ªå¸¸é‡ å‘é‡result = a + bsess = tf.Session()sess.run(result) # array([ 3., 5.], dtype=float32) è¦è¾“å‡ºç›¸åŠ å¾—åˆ°çš„ç»“æœï¼Œä¸èƒ½ç®€å•åœ°ç›´æ¥è¾“å‡º resultï¼Œè€Œéœ€è¦å…ˆç”Ÿæˆä¸€ä¸ª Sessionï¼Œå¹¶é€šè¿‡è¿™ä¸ª Session æ¥è®¡ç®—ç»“æœã€‚ ğŸŒ°ğŸŒ°ğŸŒ° è¿™æ¬¡éœ€è¦åŠ è½½ Tensorflow ï¼Œç„¶åå»ºç«‹ä¸¤ä¸ª matrix , è¾“å‡ºä¸¤ä¸ª matrix çŸ©é˜µç›¸ä¹˜çš„ç»“æœã€‚ import tensorflow as tf# create two matrixesmatrix1 = tf.constant([[3,3]])matrix2 = tf.constant([[2], [2]])product = tf.matmul(matrix1,matrix2) æˆ‘ä»¬ä¼šè¦ä½¿ç”¨ Session æ¥æ¿€æ´» product å¹¶å¾—åˆ°è®¡ç®—ç»“æœ. æœ‰ä¸¤ç§å½¢å¼ä½¿ç”¨ä¼šè¯æ§åˆ¶ Session ã€‚ # method 1sess = tf.Session()result = sess.run(product)print(result) # [[12]]sess.close()# [[12]]# method 2with tf.Session() as sess: result2 = sess.run(product) print(result2)# [[12]] ä»¥ä¸Šå°±æ˜¯æˆ‘ä»¬ä»Šå¤©æ‰€å­¦çš„ä¸¤ç§ Session æ‰“å¼€æ¨¡å¼ã€‚ è®©æˆ‘ä»¬å­¦ä¹ ä¸‹ä¸€èŠ‚ â€” Tensorflow ä¸­çš„ Variableã€‚ Reference tensorflow.org è«çƒ¦Python æ–°ç‰ˆå¯è§†åŒ–æ•™å­¦ä»£ç ","categories":[{"name":"tensorflow","slug":"tensorflow","permalink":"http://iequa.com/categories/tensorflow/"}],"tags":[{"name":"tensorflow","slug":"tensorflow","permalink":"http://iequa.com/tags/tensorflow/"}]},{"title":"Tensorflow å…¥é—¨ä¾‹å­","slug":"tensorflow/tf-2.2-example","date":"2018-08-27T03:27:21.000Z","updated":"2020-07-03T03:33:29.986Z","comments":true,"path":"2018/08/27/tensorflow/tf-2.2-example/","link":"","permalink":"http://iequa.com/2018/08/27/tensorflow/tf-2.2-example/","excerpt":"Tensorflow æ˜¯éå¸¸é‡è§†ç»“æ„çš„, æˆ‘ä»¬å»ºç«‹å¥½äº†ç¥ç»ç½‘ç»œçš„ç»“æ„, æ‰èƒ½å°†æ•°å­—æ”¾è¿›å», è¿è¡Œè¿™ä¸ªç»“æ„.","text":"Tensorflow æ˜¯éå¸¸é‡è§†ç»“æ„çš„, æˆ‘ä»¬å»ºç«‹å¥½äº†ç¥ç»ç½‘ç»œçš„ç»“æ„, æ‰èƒ½å°†æ•°å­—æ”¾è¿›å», è¿è¡Œè¿™ä¸ªç»“æ„. è¿™ä¸ªä¾‹å­ç®€å•çš„é˜è¿°äº† tensorflow å½“ä¸­å¦‚ä½•ç”¨ä»£ç æ¥è¿è¡Œæˆ‘ä»¬æ­å»ºçš„ç»“æ„. 1. åˆ›å»ºæ•°æ®é¦–å…ˆ, æˆ‘ä»¬è¿™æ¬¡éœ€è¦åŠ è½½ tensorflow å’Œ numpy ä¸¤ä¸ªæ¨¡å—, å¹¶ä¸”ä½¿ç”¨ numpy æ¥åˆ›å»ºæˆ‘ä»¬çš„æ•°æ®. import tensorflow as tfimport numpy as np# create datax_data = np.random.rand(100).astype(np.float32)y_data = x_data*0.1 + 0.3 æ¥ç€, æˆ‘ä»¬ç”¨ tf.Variable æ¥åˆ›å»ºæè¿° y çš„å‚æ•°. æˆ‘ä»¬å¯ä»¥æŠŠ y_data = x_data*0.1 + 0.3 æƒ³è±¡æˆ y=Weights * x + biases, ç„¶åç¥ç»ç½‘ç»œä¹Ÿå°±æ˜¯å­¦ç€æŠŠ Weights å˜æˆ 0.1, biases å˜æˆ 0.3. 2. æ­å»ºæ¨¡å‹Weights = tf.Variable(tf.random_uniform([1], -1.0, 1.0))biases = tf.Variable(tf.zeros([1]))y = Weights*x_data + biases 3. è®¡ç®—è¯¯å·®æ¥ç€å°±æ˜¯è®¡ç®— y å’Œ y_data çš„è¯¯å·®: loss = tf.reduce_mean(tf.square(y-y_data)) 4. ä¼ æ’­è¯¯å·®åå‘ä¼ é€’è¯¯å·®çš„å·¥ä½œå°±æ•™ç»™ optimizer äº†, æˆ‘ä»¬ä½¿ç”¨çš„è¯¯å·®ä¼ é€’æ–¹æ³•æ˜¯æ¢¯åº¦ä¸‹é™æ³•: Gradient Descent ç„¶åæˆ‘ä»¬ä½¿ç”¨ optimizer æ¥è¿›è¡Œå‚æ•°çš„æ›´æ–°. optimizer = tf.train.GradientDescentOptimizer(0.5)train = optimizer.minimize(loss) 5. è®­ç»ƒåˆ°ç›®å‰ä¸ºæ­¢, æˆ‘ä»¬åªæ˜¯å»ºç«‹äº†ç¥ç»ç½‘ç»œçš„ç»“æ„, è¿˜æ²¡æœ‰ä½¿ç”¨è¿™ä¸ªç»“æ„. åœ¨ä½¿ç”¨è¿™ä¸ªç»“æ„ä¹‹å‰, æˆ‘ä»¬å¿…é¡»å…ˆåˆå§‹åŒ–æ‰€æœ‰ä¹‹å‰å®šä¹‰çš„ Variable, æ‰€ä»¥è¿™ä¸€æ­¥æ˜¯å¾ˆé‡è¦çš„! init = tf.global_variables_initializer() # æ›¿æ¢æˆè¿™æ ·å°±å¥½ æ¥ç€,æˆ‘ä»¬å†åˆ›å»ºä¼šè¯ Session. æˆ‘ä»¬ä¼šåœ¨ä¸‹ä¸€èŠ‚ä¸­è¯¦ç»†è®²è§£ Session. æˆ‘ä»¬ç”¨ Session æ¥æ‰§è¡Œ init åˆå§‹åŒ–æ­¥éª¤. å¹¶ä¸”, ç”¨ Session æ¥ run æ¯ä¸€æ¬¡ training çš„æ•°æ®. é€æ­¥æå‡ç¥ç»ç½‘ç»œçš„é¢„æµ‹å‡†ç¡®æ€§. sess = tf.Session()sess.run(init) # Very importantfor step in range(201): sess.run(train) if step % 20 == 0: print(step, sess.run(Weights), sess.run(biases)) 6. Reference tensorflow.org è«çƒ¦Python","categories":[{"name":"tensorflow","slug":"tensorflow","permalink":"http://iequa.com/categories/tensorflow/"}],"tags":[{"name":"tensorflow","slug":"tensorflow","permalink":"http://iequa.com/tags/tensorflow/"}]},{"title":"Tensorflow å¤„ç†ç»“æ„","slug":"tensorflow/tf-2.1-structure","date":"2018-08-25T03:17:21.000Z","updated":"2020-07-03T03:33:42.953Z","comments":true,"path":"2018/08/25/tensorflow/tf-2.1-structure/","link":"","permalink":"http://iequa.com/2018/08/25/tensorflow/tf-2.1-structure/","excerpt":"Tensorflow é¦–å…ˆè¦å®šä¹‰ç¥ç»ç½‘ç»œçš„ç»“æ„, ç„¶åå†æŠŠæ•°æ®æ”¾å…¥ç»“æ„å½“ä¸­å»è¿ç®— å’Œ training.","text":"Tensorflow é¦–å…ˆè¦å®šä¹‰ç¥ç»ç½‘ç»œçš„ç»“æ„, ç„¶åå†æŠŠæ•°æ®æ”¾å…¥ç»“æ„å½“ä¸­å»è¿ç®— å’Œ training. è®¡ç®—å›¾ å› ä¸º TensorFlow æ˜¯é‡‡ç”¨æ•°æ®æµå›¾ï¼ˆdata flow graphsï¼‰æ¥è®¡ç®—, æ‰€ä»¥é¦–å…ˆæˆ‘ä»¬å¾—åˆ›å»ºä¸€ä¸ªæ•°æ®æµå›¾, ç„¶åå†å°†æˆ‘ä»¬çš„æ•°æ®ï¼ˆæ•°æ®ä»¥å¼ é‡(tensor)çš„å½¢å¼å­˜åœ¨ï¼‰æ”¾åœ¨æ•°æ®æµå›¾ä¸­è®¡ç®—. Nodes åœ¨å›¾ä¸­è¡¨ç¤ºæ•°å­¦æ“ä½œ Edges åœ¨å›¾ä¸­åˆ™è¡¨ç¤ºåœ¨èŠ‚ç‚¹é—´ç›¸äº’è”ç³»çš„å¤šç»´æ•°æ®æ•°ç»„ï¼Œå³å¼ é‡ï¼ˆtensorï¼‰ è®­ç»ƒæ¨¡å‹æ—¶ tensor ä¼šä¸æ–­çš„ä»æ•°æ®æµå›¾ä¸­çš„ä¸€ä¸ªèŠ‚ç‚¹ flow åˆ°å¦ä¸€èŠ‚ç‚¹, è¿™å°±æ˜¯ TensorFlow åå­—çš„ç”±æ¥. Tensor å¼ é‡æ„ä¹‰å¼ é‡ï¼ˆTensor): å¼ é‡æœ‰å¤šç§. é›¶é˜¶å¼ é‡ä¸º çº¯é‡æˆ–æ ‡é‡ (scalar) ä¹Ÿå°±æ˜¯ä¸€ä¸ªæ•°å€¼. æ¯”å¦‚ [1] ä¸€é˜¶å¼ é‡ä¸º å‘é‡ (vector), æ¯”å¦‚ ä¸€ç»´çš„ [1, 2, 3] äºŒé˜¶å¼ é‡ä¸º çŸ©é˜µ (matrix), æ¯”å¦‚ äºŒç»´çš„ [[1, 2, 3],[4, 5, 6],[7, 8, 9]] ä»¥æ­¤ç±»æ¨, è¿˜æœ‰ ä¸‰é˜¶ ä¸‰ç»´çš„ â€¦ Reference tensorflow.org","categories":[{"name":"tensorflow","slug":"tensorflow","permalink":"http://iequa.com/categories/tensorflow/"}],"tags":[{"name":"tensorflow","slug":"tensorflow","permalink":"http://iequa.com/tags/tensorflow/"}]},{"title":"Convolutional Neural Networks (week2) - deep CNN","slug":"deeplearning/Convolutional-Neural-Networks-week2","date":"2018-08-24T12:00:21.000Z","updated":"2019-10-20T04:30:35.021Z","comments":true,"path":"2018/08/24/deeplearning/Convolutional-Neural-Networks-week2/","link":"","permalink":"http://iequa.com/2018/08/24/deeplearning/Convolutional-Neural-Networks-week2/","excerpt":"ç†è§£å¦‚ä½•æ­å»ºä¸€ä¸ªç¥ç»ç½‘ç»œï¼ŒåŒ…æ‹¬æœ€æ–°çš„å˜ä½“ï¼Œä¾‹å¦‚æ®‹ä½™ç½‘ç»œã€‚","text":"ç†è§£å¦‚ä½•æ­å»ºä¸€ä¸ªç¥ç»ç½‘ç»œï¼ŒåŒ…æ‹¬æœ€æ–°çš„å˜ä½“ï¼Œä¾‹å¦‚æ®‹ä½™ç½‘ç»œã€‚ 1. Why look at case studies?é€šè¿‡ä»–äººçš„å®ä¾‹å¯ä»¥æ›´å¥½çš„ç†è§£å¦‚ä½•æ„å»ºå·ç§¯ç¥ç»ç½‘ç»œï¼Œæœ¬å‘¨è¯¾ç¨‹ä¸»è¦ä¼šä»‹ç»å¦‚ä¸‹ç½‘ç»œ LeNet-5 AlexNet VGG ResNet (æœ‰152å±‚) Inception 2. Classic networks2.1 LeNet-5è¯¥ç½‘ç»œ 1980s æå‡ºï¼Œä¸»è¦é’ˆå¯¹ç°åº¦å›¾åƒè®­ç»ƒçš„ï¼Œç”¨äºè¯†åˆ«æ‰‹å†™æ•°å­—ã€‚ å½“æ—¶å¾ˆå°‘ç”¨åˆ° Paddingï¼Œæ‰€ä»¥çœ‹åˆ°éšç€ç½‘ç»œå±‚æ¬¡å¢åŠ ï¼Œå›¾åƒçš„é«˜åº¦å’Œå®½åº¦éƒ½æ˜¯é€æ¸å‡å°çš„ï¼Œæ·±åº¦åˆ™ä¸æ–­å¢åŠ . å½“æ—¶äººä»¬ä¼šæ›´å€¾å‘äºä½¿ç”¨ Average Poolingï¼Œä½†æ˜¯ç°åœ¨åˆ™æ›´æ¨èä½¿ç”¨ Max Pooling. æœ€åçš„é¢„æµ‹æ²¡æœ‰ä½¿ç”¨ softmaxï¼Œè€Œæ˜¯ä½¿ç”¨äº†ä¸€èˆ¬çš„æ–¹æ³•. è®ºæ–‡ä¸­ä½ ä¼šå‘ç°ï¼Œè¿‡å»äººä»¬ä½¿ç”¨ Sigmoidå‡½æ•° å’Œ Tanhå‡½æ•°ï¼Œè€Œä¸æ˜¯ ReLuï¼Œ è¿™ç§ç½‘è·¯ç»“æ„çš„ç‰¹åˆ«ä¹‹å¤„è¿˜åœ¨äºå„ç½‘ç»œå±‚ä¹‹é—´æ˜¯æœ‰å…³è”çš„. 2.2 AlexNetAlexNet å…¶å®å’Œ LetNet-5 æœ‰å¾ˆå¤šç›¸ä¼¼çš„åœ°æ–¹ï¼Œå¦‚å¤§è‡´çš„ç½‘ç»œç»“æ„ã€‚ä¸åŒçš„åœ°æ–¹ä¸»è¦æœ‰å¦‚ä¸‹ï¼š æ¿€æ´»å‡½æ•°ä½¿ç”¨çš„æ˜¯ Reluï¼Œæœ€åä¸€å±‚ä½¿ç”¨çš„æ˜¯ Softmax å‚æ•°æ›´å¤šï¼Œæœ‰6000ä¸‡ä¸ªå‚æ•°ï¼Œè€Œ LeNet-5 åªæœ‰6ä¸‡ä¸ªå·¦å³ ä½¿ç”¨ Max Pooling Local Response Normalization å±€éƒ¨å“åº”å½’ä¸€åŒ– - LRNå±‚ï¼Œä¸é‡è¦åˆ’æ‰. è¿™ç¯‡è®ºæ–‡ä¹‹åï¼Œæ·±åº¦å­¦ä¹ é€æ¸åœ¨ CV æ–¹é¢çš„å…³æ³¨ï¼Œä¸æ—¥ä¿±å¢. AlexNet æ¯”è¾ƒå¤æ‚ï¼ŒåŒ…å«å¤§é‡è¶…å‚æ•°. 2.3 VGG-16 è¿™ä¸ªç½‘ç»œå¤ªç‰›äº†ï¼Œå› ä¸ºå®ƒæœ‰å°†è¿‘ 1.38äº¿ä¸ªå‚æ•°ï¼Œå³ä½¿æ”¾åˆ°ç°åœ¨ä¹Ÿæ˜¯ä¸€ä¸ªå¾ˆå¤§çš„ç½‘ç»œï¼Œä½†æ˜¯è¿™ä¸ªç½‘ç»œçš„ç»“æ„å¹¶ä¸å¤æ‚ã€‚ä¸‹é¢ä¸»è¦ä»‹ç»ä¸€ä¸‹ä¸Šå›¾ç½‘ç»œã€‚ é¦–å…ˆè¯¥ç½‘ç»œä½¿ç”¨çš„æ˜¯ Sameå·ç§¯ï¼Œå³ä¿è¯é«˜åº¦å’Œå®½åº¦ä¸å˜ï¼Œå¦å¤–å› ä¸ºæ€»å…±æœ‰16å±‚å·ç§¯æ“ä½œï¼Œæ‰€ä»¥å°±ä¸æŠŠæ¯ä¸€å±‚éƒ½ç”¨å›¾åƒçš„æ–¹å¼è¡¨ç°å‡ºæ¥äº†ï¼Œä¾‹å¦‚ [CONV 64 X2] è¡¨ç¤ºçš„æ˜¯ç”¨ 64ä¸ª è¿‡æ»¤å™¨è¿›è¡Œ Sameå·ç§¯ æ“ä½œ2æ¬¡ï¼Œå³å³ä¸Šè§’æ‰€ç”»çš„ç¤ºæ„å›¾ï¼Œ(224,224,3) -&gt; (224,224,64) -&gt; (224,224,64) Andrew Ng : æˆ‘æœ€å–œæ¬¢å®ƒçš„ä¸€ç‚¹æ˜¯ï¼Œéšç€ç½‘ç»œçš„åŠ æ·±ï¼Œå›¾åƒçš„ Height å’Œ Width éƒ½åœ¨ä»¥ä¸€å®šçš„è§„å¾‹ä¸æ–­ç¼©å°ï¼Œæ¯æ¬¡æ± åŒ–ä¹‹ååˆšå¥½ç¼©å°ä¸€åŠï¼Œè€Œä¿¡é“æ•°é‡åœ¨ä¸æ–­å¢åŠ . è€Œåˆšå¥½ä¹Ÿæ˜¯åœ¨æ¯ç»„å·ç§¯æ“ä½œåå¢åŠ ä¸€å€. ä¹Ÿå°±æ˜¯è¯´ ï¼š å›¾åƒç¼©å°çš„æ¯”ä¾‹å’Œä¿¡é“å¢åŠ çš„æ¯”ä¾‹æ˜¯æœ‰è§„å¾‹çš„. ä¸Šé¢ä¸‰ä¸ªæ˜¯æ¯”è¾ƒç»å…¸çš„ç½‘ç»œï¼Œå¯é˜…è¯»å…¶è®ºæ–‡ï¼ŒNgå´å¤§å¸ˆ å»ºè®®çš„é˜…è¯»é¡ºåºæ˜¯ AlexNet-&gt;VGG-&gt;LeNetã€‚ 3. Residual Network (ResNets)ResNets å‘æ˜è€…æ˜¯ ä½•æºæ˜ã€å¼ ç¿”å®‡ã€ä»»å°‘å¿ã€å­™å‰‘ å´å¤§å¸ˆè¡¨ç¤º â€œéå¸¸æ·±çš„ç½‘ç»œæ˜¯å¾ˆéš¾è®­ç»ƒçš„ï¼Œå› ä¸ºå­˜åœ¨æ¢¯åº¦æ¶ˆå¤±å’Œæ¢¯åº¦çˆ†ç‚¸çš„é—®é¢˜â€ï¼Œä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå¼•å…¥äº† Skip Connection (è·³è¿œé“¾æ¥)ï¼Œæ®‹å·®ç½‘ç»œæ­£æ˜¯ä½¿ç”¨äº†è¿™ä¸ªæ–¹æ³•ã€‚ 3.1 æ®‹å·®å— (Residual Block)é¦–å…ˆä»‹ç»ç»„æˆæ®‹å·®ç½‘ç»œçš„å•å…ƒï¼šæ®‹å·®å—(Residual Block)ï¼Œå¦‚ä¸‹å›¾ç¤ºï¼š æ®‹å·®å—æ˜¯ç”±ä¸¤å±‚ç½‘ç»œèŠ‚ç‚¹ç»„æˆçš„, $a^{[l]}$ ç»è¿‡çº¿æ€§å˜åŒ–ï¼Œå†é€šè¿‡Reluæ¿€æ´»å‡½æ•°åå¾—åˆ° $a^{[l+1]}$ï¼Œ $a^{[l+2]}$ ä¹ŸåŒç†ï¼Œå…·ä½“è¿‡ç¨‹å¦‚ä¸‹å›¾ç¤ºï¼š ç‰¹åˆ«æ³¨æ„ä¸Šå›¾ä¸­çš„ç´«è‰²çº¿è¿æ¥ï¼Œ$a^{[{l}]}$ é€šè¿‡è¿™æ¡çº¿ç›´æ¥å°†æ•°æ®ä¼ é€’ç»™ $a^{[l+2]}$ï¼Œ æ‰€ä»¥ $a^{[l+2]}=g(z^{[l+1]}+a^{[l]})$ ï¼Œè¿™æ¡ç´«è‰²çº¿ä¹Ÿå«ä½œshort cut(æˆ–skip connection) 3.2 æ®‹å·®ç½‘ç»œ å¦‚å›¾ç¤ºï¼Œæ®‹å·®ç½‘ç»œæ¯ä¸¤å±‚ç½‘ç»œèŠ‚ç‚¹ç»„æˆä¸€ä¸ªæ®‹å·®å—ï¼Œè¿™ä¹Ÿå°±æ˜¯å…¶ä¸æ™®é€šç½‘ç»œ(Plain Network)çš„å·®åˆ«ã€‚ éšç€ç½‘ç»œæ·±åº¦çš„åŠ æ·±ï¼Œä¼˜åŒ–ç®—æ³•ä¼šè¶Šæ¥è¶Šéš¾è®­ç»ƒï¼Œè®­ç»ƒé”™è¯¯ä¼šè¶Šæ¥è¶Šå¤šï¼Œä½†æ˜¯æœ‰äº† ResNets å°±ä¸ä¸€æ ·äº†. ä¹Ÿå¯ä»¥åœ¨ä¸€å®šç¨‹åº¦ä¸Šç¼“è§£æ¢¯åº¦æ¶ˆå¤±å’Œæ¢¯åº¦çˆ†ç‚¸é—®é¢˜. å¦ä¸€è§’åº¦ï¼Œç½‘ç»œè¶Šæ·±ä¼šæ¯”è¾ƒè‡ƒè‚¿ï¼Œä½†æ˜¯ ResNet ç¡®å®åœ¨è®­ç»ƒæ·±åº¦ç½‘ç»œæ–¹é¢éå¸¸æœ‰æ•ˆ. ç»“åˆä¹‹å‰çš„è¯¾ç¨‹æˆ‘ä»¬çŸ¥é“å¦‚æœä½¿ç”¨æ™®é€šç½‘ç»œè®­ç»ƒæ¨¡å‹ï¼Œè®­ç»ƒè¯¯å·®ä¼šéšç€ç½‘ç»œå±‚æ¬¡åŠ æ·±å…ˆå‡å°ï¼Œè€Œåä¼šå¼€å§‹å¢åŠ ï¼Œè€Œæ®‹å·®ç½‘ç»œåˆ™ä¸ä¼šæœ‰è¿™ç§æƒ…å†µï¼Œåè€Œå®ƒä¼šéšç€å±‚æ¬¡å¢åŠ ï¼Œè¯¯å·®ä¹Ÿä¼šè¶Šæ¥è¶Šå°ï¼Œè¿™ä¸ç†è®ºç›¸ç¬¦ã€‚ éšç€ç½‘ç»œæ·±åº¦çš„åŠ æ·±ï¼Œä¼˜åŒ–ç®—æ³•ä¼šè¶Šæ¥è¶Šéš¾è®­ç»ƒï¼Œè®­ç»ƒé”™è¯¯ä¼šè¶Šæ¥è¶Šå¤šï¼Œä½†æ˜¯æœ‰äº† ResNets å°±ä¸ä¸€æ ·äº†. ä¹Ÿå¯ä»¥åœ¨ä¸€å®šç¨‹åº¦ä¸Šç¼“è§£æ¢¯åº¦æ¶ˆå¤±å’Œæ¢¯åº¦çˆ†ç‚¸é—®é¢˜. å¦ä¸€è§’åº¦ï¼Œç½‘ç»œè¶Šæ·±ä¼šæ¯”è¾ƒè‡ƒè‚¿ï¼Œä½†æ˜¯ ResNet ç¡®å®åœ¨è®­ç»ƒæ·±åº¦ç½‘ç»œæ–¹é¢éå¸¸æœ‰æ•ˆ. 4. Why ResNets workå´å¤§è¡¨ç¤º: ç½‘ç»œåœ¨è®­ç»ƒé›†ä¸Šè¡¨ç°å¥½ï¼Œæ‰èƒ½ Hold-out äº¤å‰éªŒè¯é›† æˆ– devé›†ã€æµ‹è¯•é›†ä¸Šè¡¨ç°å¥½ï¼Œæ‰€ä»¥è®­ç»ƒé›†ä¸Šè¡¨ç°å¥½æ˜¯ç¬¬ä¸€æ­¥. ä¸ºäº†ç›´è§‚è§£é‡Šæ®‹å·®ç½‘ç»œä¸ºä»€ä¹ˆæœ‰ç”¨ï¼Œå‡è®¾æˆ‘ä»¬å·²ç»é€šè¿‡ä¸€ä¸ªå¾ˆå¤§çš„ç¥ç»ç½‘ç»œå¾—åˆ°äº† $a^{[l]}$ã€‚ è€Œç°åœ¨æˆ‘ä»¬åˆéœ€è¦æ·»åŠ ä¸¤å±‚ç½‘ç»œè¿›å»ï¼Œæˆ‘ä»¬çœ‹çœ‹å¦‚æœæ·»åŠ çš„æ˜¯æ®‹å·®å—ä¼šæœ‰ä»€ä¹ˆæ•ˆæœã€‚å¦‚ä¸‹å›¾ç¤ºï¼š ç”± æ®‹å·®å—Residual Block çš„ç‰¹ç‚¹æˆ‘ä»¬çŸ¥é“ $a^{[l+2]}=g(z^{[l+1]}+a^{[l]})=g(W^{[l+1]}a^{[l]}+b^{[l+1]}+a^{[l]})$ æˆ‘ä»¬å…ˆè€ƒè™‘ä¸€ä¸ªæç«¯æƒ…å†µï¼Œå³ $W^{[l+1]}=0,b^{[l+1]}=0$ï¼Œ é‚£ä¹ˆ $a^{[l+2]}=g(a^{[l]})=a^{[l]}$ (å› ä¸ºæ¿€æ´»å‡½æ•°æ˜¯Relu)ï¼Œæ‰€ä»¥åœ¨æ·»åŠ äº†é¢å¤–çš„ä¸¤å±‚ç½‘ç»œåï¼Œå³ä½¿æœ€åæƒ…å†µä¹Ÿæ˜¯ä¿æŒå’Œä¹‹å‰ç»“æœä¸€æ ·ã€‚(è€Œå¦‚æœåªæ˜¯åŠ ä¸Šæ™®é€šçš„ä¸¤å±‚ç½‘ç»œï¼Œå¯èƒ½ç»“æœä¼šæ›´å¥½ï¼Œä½†æ˜¯ä¹Ÿå¾ˆæœ‰å¯èƒ½ç»“æœä¼šè¶Šæ¥è¶Šç³Ÿç³•, å› ä¸ºæ™®é€šç½‘ç»œå°±ç®—æ˜¯é€‰æ‹©ç”¨æ¥å­¦ä¹ æ’ç­‰å‡½æ•°çš„å‚æ•°éƒ½å¾ˆå›°éš¾)ï¼Œæ®‹å·®ç½‘ç»œèµ·ä½œç”¨çš„ä¸»è¦åŸå› æ˜¯è¿™äº›æ®‹å·®å—å­¦ä¹ æ’ç­‰å‡½æ•°éå¸¸å®¹æ˜“, è¿™ä¹Ÿå°±æ˜¯ä¸ºä»€ä¹ˆæ®‹å·®ç½‘ç»œèƒ½å¤Ÿä¿è¯æ·±åº¦ç½‘ç»œä¾æ—§æœ‰ç”¨çš„åŸå› äº†ã€‚ æ³¨æ„ ï¼š å„å±‚ç½‘ç»œçš„ç»´åº¦ï¼Œå› ä¸º $a^{[l+2]}=g(z^{[l+1]}+a^{[l]})$, é‚£ä¹ˆå°±è¦æ±‚ $z^{[l+1]}$ è¦å’Œ $a^{[l]}$ ä¿æŒç›¸åŒçš„ç»´åº¦æ‰€ä»¥æ®‹å·®ç½‘ç»œä½¿ç”¨çš„æ˜¯Sameå·ç§¯ã€‚ ä½†æ˜¯å¦‚æœå”¯ç‹¬ä¸ä¸€æ ·ä¹Ÿæ²¡å…³ç³»ï¼Œå¯ä»¥ç»™ $a^{[l]}$ ä¹˜ä¸Šä¸€ä¸ª $W_s$ æ¥ä¿æŒç›¸åŒç»´åº¦ã€‚ $W_s$ çš„å€¼å¯ä»¥é€šè¿‡å­¦ä¹ è·å¾— æ™®é€šç½‘ç»œ å’Œ ResNets å¸¸ç”¨çš„ç»“æ„æ˜¯ Conv -&gt; Conv -&gt; Conv -&gt; Pool -&gt; Conv -&gt; Conv -&gt; Conv -&gt; Pool ä¾æ¬¡é‡å¤ä¹‹.. ç›´åˆ°æœ‰ä¸€ä¸ªé€šè¿‡ Softmax è¿›è¡Œé¢„æµ‹çš„å…¨è¿æ¥å±‚. 5. in Network and 1Ã—1 convolutions$1 * 1$ å·ç§¯ä¹çœ‹èµ·æ¥å¥½åƒå¾ˆæ²¡ç”¨ï¼Œå¦‚ä¸‹å›¾ä¸Šï¼Œâ€‹ä½†æ˜¯å¦‚æœè¿™ä¸ª $1 * 1$ çš„å·ç§¯æœ‰æ·±åº¦å‘¢ï¼Ÿâ€‹ è¯´ä¸ªæ›´åŠ ç›´è§‚çš„ç†è§£å°±æ˜¯ä½¿ç”¨ $1*1$ å·ç§¯å¯ä»¥å¾ˆæ–¹ä¾¿çš„å‡å°‘æ·±åº¦ï¼Œè€Œä¸æ”¹å˜é«˜åº¦å’Œå®½åº¦ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š åªéœ€è¦ç”¨ 32 ä¸ª ($1*1*192$) çš„ Filter å³å¯, å¦‚æœä¸ç”¨ $1 * 1$ å·ç§¯ï¼Œä¾‹å¦‚é‡‡ç”¨ $2*2$ å·ç§¯,è¦æƒ³å®ç°åªæ”¹å˜æ·±åº¦ï¼Œé‚£ä¹ˆè¿˜éœ€è¦ä½¿ç”¨ paddingï¼Œç›¸æ¯”èµ·æ¥æ›´åŠ éº»çƒ¦äº†. 6. Inception network motivation å¦‚ä¸Šå›¾ç¤ºï¼Œæˆ‘ä»¬ä½¿ç”¨äº†å„ç§è¿‡æ»¤å™¨ï¼Œä¹Ÿæ˜¯ç”¨äº† Max Poolingã€‚ä½†æ˜¯è¿™äº›å¹¶ä¸éœ€è¦äººå·¥çš„é€‰æ‹©å…¶ä¸ªæ•°ï¼Œè¿™äº›éƒ½å¯ä»¥é€šè¿‡å­¦ä¹ æ¥ç¡®å®šä¸‹æ¥ã€‚æ‰€ä»¥è¿™ç§æ–¹æ³•å¾ˆå¥½çš„å¸®åŠ©æˆ‘ä»¬é€‰æ‹©ä½•ç§ Filter çš„é—®é¢˜ï¼Œè¿™ä¹Ÿå°±æ˜¯ Inceptionç½‘ç»œã€‚ 6.1 è®¡ç®—æˆæœ¬æ³¨æ„éšä¹‹è€Œæ¥çš„è®¡ç®—æˆæœ¬ï¼Œå°¤å…¶æ˜¯ $5*5$ çš„ Filterï¼Œä¸‹é¢ä»¥è¿™ä¸ª Filter ä¸¾ä¾‹è¿›è¡Œè¯´æ˜ï¼š å¦‚ä¸Šå›¾ç¤ºï¼Œä½¿ç”¨ 32 ä¸ª $(5*5*192)$ çš„ Filterï¼Œå¯¹ $(28,28,192)$ è¿›è¡Œ Sameå·ç§¯ è¿ç®—å¾—åˆ° $(28,28,32)$ çš„è¾“å‡ºçŸ©é˜µï¼Œè¯¥å·ç§¯éœ€è¦æ‰§è¡Œçš„ä¹˜æ³•è¿ç®—æœ‰å¤šå°‘æ¬¡å‘¢ï¼Ÿ è¾“å‡ºçŸ©é˜µä¸­çš„ä¸€ä¸ªæ•°æ®æ˜¯ç»è¿‡ $(5*5*192)$ æ¬¡ä¹˜æ³•å¾—åˆ°çš„ï¼Œé‚£ä¹ˆæ€»å…±çš„ä¹˜æ³•è¿ç®—æ¬¡æ•°åˆ™æ˜¯ $(5*5*192*28*28*32=1.2)$ äº¿ 6.2 ç“¶é¢ˆå±‚(Bottleneck layer)ä¸Šé¢è¿ç®—æ¬¡æ•°å¤šå¤§1.2äº¿æ¬¡ï¼Œè¿ç®—é‡ç›¸å½“å¤§ï¼Œå› æ­¤æœ‰å¦ä¸€ç§ç½‘ç»œç»“æ„å¯¹æ­¤è¿›è¡Œä¼˜åŒ–ï¼Œä¸”å¯ä»¥è¾¾åˆ°åŒæ ·æ•ˆæœï¼Œå³é‡‡ç”¨ 1 * 1 å·ç§¯ å¦‚å›¾ç¤ºè¿›è¡Œäº†ä¸¤æ¬¡å·ç§¯ï¼Œæˆ‘ä»¬è®¡ç®—ä¸€ä¸‹æ€»å…±çš„ä¹˜æ³•æ¬¡æ•°ã€‚ ç¬¬ä¸€æ¬¡å·ç§¯ï¼š28 * 28 * 16 * 192 = 2.4 millionç¬¬äºŒæ¬¡å·ç§¯ï¼š28 * 28 * 32 * 5 * 5 * 16 = 10 millionæ€»å…±ä¹˜æ³•æ¬¡æ•°æ˜¯ 12.4 millionï¼Œè¿™ä¸ä¸Šé¢ç›´æ¥ç”¨ 5 * 5 Filter çš„è¿ç®—æ¬¡æ•°æ•´æ•´å°‘äº†åå€ã€‚ 7. Inception network ä¸ºäº†å¯ä»¥é˜²æ­¢è¿‡æ‹Ÿåˆï¼Œè¿˜æœ‰ä¸ªç‰¹åˆ«çš„ inception networkï¼Œæ˜¯ä¸€ä¸ª Google å‘˜å·¥å¼€å‘çš„å«åš GoogLeNetï¼Œè¿™ä¸ªåå­—æ˜¯ä¸ºäº†å‘ LeNet è‡´æ•¬. è¿™æ ·éå¸¸å¥½ï¼Œæ·±åº¦å­¦ä¹ çš„ç ”ç©¶äººå‘˜å¦‚ä½•é‡è§†åä½œï¼Œæ·±åº¦å­¦ä¹ å·¥ä½œè€…å¯¹å½¼æ­¤çš„å·¥ä½œæˆæœï¼Œéƒ½æœ‰ä¸€ç§å¼ºçƒˆçš„æ•¬æ„. 8. Using open-source implPractical advice for using ConvNets 9. Transfer Learningç®€å•è¯´å°±æ˜¯åœ¨ä»–äººçš„åŸºç¡€ä¸Šå®ç°è‡ªå·±æƒ³è¦çš„æ¨¡å‹ï¼Œä¸¾ä¸ªğŸŒ°ï¼Œå‡å¦‚æˆ‘ä»¬ç°åœ¨éœ€è¦è¯†åˆ«å®¶é‡Œå…»çš„ä¸¤åªçŒ«ï¼Œåˆ†åˆ«å« å°èŠ± å’Œ å°ç™½ï¼Œä½†æ˜¯æˆ‘ä»¬åªæœ‰æ¯”è¾ƒå°‘çš„å›¾ç‰‡ã€‚å¹¸è¿çš„æ˜¯ç½‘ä¸Šå·²ç»æœ‰ä¸€ä¸ªå·²ç»è®­ç»ƒå¥½çš„æ¨¡å‹ï¼Œæ˜¯ç”¨æ¥åŒºåˆ†1000ä¸ªä¸åŒäº‹ç‰©çš„(åŒ…æ‹¬çŒ«)ï¼Œå…¶ç½‘ç»œæ¨¡å‹å¦‚ä¸‹ï¼š æˆ‘ä»¬çš„éœ€æ±‚æ˜¯æœ€åç»“æœæœ‰ä¸‰ç§ï¼šæ˜¯ å°èŠ±ï¼Œor å°ç™½ï¼Œor éƒ½ä¸æ˜¯ã€‚â€‹æ‰€ä»¥éœ€è¦å¯¹ softmax åšå¦‚ä¸‹å›¾ä¿®æ”¹. ç”±äºæ•°æ®è¾ƒå°‘ï¼Œæ‰€ä»¥å¯ä»¥å¯¹ä»–äººçš„æ¨¡å‹çš„å‰é¢çš„ç»“æ„ä¸­çš„å‚æ•°è¿›è¡Œå†»ç»“ï¼Œå³ æƒé‡ weight å’Œ åå·® bias ä¸åšæ”¹åŠ¨ã€‚ â€‹å½“ç„¶ï¼Œå¦‚æœæˆ‘ä»¬æœ‰ä¸€å®šé‡çš„æ•°æ®ï¼Œé‚£ä¹ˆ freeze çš„èŒƒå›´ä¹Ÿå¯ä»¥éšä¹‹å‡å°‘ï¼Œå³æ‹¿æ¥è®­ç»ƒçš„å±‚æ¬¡å¯ä»¥å¢å¤šâ€‹â€‹ you find that for a lot of computer vision applications, you just do much better if you download someone elseâ€™s open source weights and use that as initialization for your problem. I think that computer vision is one where transfer learning is something that you should almost always do. ï¼ˆunless you actually have a very very large data set..ï¼‰ 10. Data augmentation10.1 Common augmentation æ—‹è½¬(rotation) ä¿®å‰ª(shearing) å±€éƒ¨å˜å½¢(local warping) é•œåƒ(mirroring) â€‹ ä»¥ä¸Šä»‹ç»çš„æ–¹æ³•ï¼ŒåŒæ—¶ä½¿ç”¨å¹¶æ²¡æœ‰ä»€ä¹ˆåå¤„ï¼Œä½†æ˜¯åœ¨å®è·µä¸­ï¼Œå› ä¸ºå¤ªå¤æ‚äº†ï¼Œæ‰€ä»¥ä½¿ç”¨çš„å¾ˆå°‘ã€‚ æ›´ç»å¸¸ä½¿ç”¨çš„æ–¹æ³•å¯èƒ½ä¸‹é¢è¦ä»‹ç»çš„ Color shifting ã€‚ 10.2 Color shiftingæˆ‘ä»¬éƒ½çŸ¥é“å›¾åƒæ˜¯ç”± RGB ä¸‰ç§é¢œè‰²æ„æˆçš„ï¼Œæ‰€ä»¥è¯¥æ•°æ®æ‰©å……æ–¹æ³•å¸¸é‡‡ç”¨ PCA color augmentationï¼Œå³å‡å¦‚ä¸€ä¸ªå›¾ç‰‡çš„ R å’Œ G æˆåˆ†è¾ƒå¤šï¼Œé‚£ä¹ˆè¯¥ç®—æ³•åˆ™ R,G çš„å€¼ä¼šå‡å°‘å¾ˆå¤šï¼Œè€Œ B çš„å€¼å˜åŒ–ä¼šå°‘ä¸€äº›ï¼Œæ‰€ä»¥ä½¿å¾—æ€»ä½“çš„é¢œè‰²ä¿æŒä¸€è‡´. â€‹ å¦‚æœä½ çœ‹ä¸æ‡‚è¿™äº›ï¼Œé‚£ä¹ˆæ²¡å…³ç³»ï¼Œå¯ä»¥çœ‹çœ‹ AlexNet è®ºæ–‡ä¸­çš„ç»†èŠ‚ï¼Œä½ ä¹Ÿèƒ½æ‰¾åˆ° PCA é¢œè‰²å¢å¼ºçš„å¼€æºå®ç°æ–¹æ³•. 11. The state of CVâ€‹ â€‹ â€‹â€‹ Reference ç½‘æ˜“äº‘è¯¾å ‚ - deeplearning DeepLearning.aiå­¦ä¹ ç¬”è®°æ±‡æ€»","categories":[{"name":"deeplearning","slug":"deeplearning","permalink":"http://iequa.com/categories/deeplearning/"}],"tags":[{"name":"deeplearning.ai","slug":"deeplearning-ai","permalink":"http://iequa.com/tags/deeplearning-ai/"}]},{"title":"Convolutional Neural Networks (week1) - CNN","slug":"deeplearning/Convolutional-Neural-Networks-week1","date":"2018-08-21T02:00:21.000Z","updated":"2019-10-20T04:30:35.015Z","comments":true,"path":"2018/08/21/deeplearning/Convolutional-Neural-Networks-week1/","link":"","permalink":"http://iequa.com/2018/08/21/deeplearning/Convolutional-Neural-Networks-week1/","excerpt":"ç†è§£å¦‚ä½•æ­å»ºä¸€ä¸ªç¥ç»ç½‘ç»œï¼ŒåŒ…æ‹¬æœ€æ–°çš„å˜ä½“ï¼Œä¾‹å¦‚æ®‹ä½™ç½‘ç»œã€‚ çŸ¥é“å¦‚ä½•å°†å·ç§¯ç½‘ç»œåº”ç”¨åˆ°è§†è§‰æ£€æµ‹å’Œè¯†åˆ«ä»»åŠ¡ã€‚ çŸ¥é“å¦‚ä½•ä½¿ç”¨ç¥ç»é£æ ¼è¿ç§»ç”Ÿæˆè‰ºæœ¯ã€‚ èƒ½å¤Ÿåœ¨å›¾åƒã€è§†é¢‘ä»¥åŠå…¶ä»–2Dæˆ–3Dæ•°æ®ä¸Šåº”ç”¨è¿™äº›ç®—æ³•ã€‚","text":"ç†è§£å¦‚ä½•æ­å»ºä¸€ä¸ªç¥ç»ç½‘ç»œï¼ŒåŒ…æ‹¬æœ€æ–°çš„å˜ä½“ï¼Œä¾‹å¦‚æ®‹ä½™ç½‘ç»œã€‚ çŸ¥é“å¦‚ä½•å°†å·ç§¯ç½‘ç»œåº”ç”¨åˆ°è§†è§‰æ£€æµ‹å’Œè¯†åˆ«ä»»åŠ¡ã€‚ çŸ¥é“å¦‚ä½•ä½¿ç”¨ç¥ç»é£æ ¼è¿ç§»ç”Ÿæˆè‰ºæœ¯ã€‚ èƒ½å¤Ÿåœ¨å›¾åƒã€è§†é¢‘ä»¥åŠå…¶ä»–2Dæˆ–3Dæ•°æ®ä¸Šåº”ç”¨è¿™äº›ç®—æ³•ã€‚ 1. Computer vision å¦‚å›¾ç¤ºï¼Œä¹‹å‰è¯¾ç¨‹ä¸­ä»‹ç»çš„éƒ½æ˜¯ 64 * 64 * 3çš„å›¾åƒ (3 ä»£è¡¨:å› ä¸ºæ¯ä¸ªå›¾ç‰‡éƒ½æœ‰3ä¸ªé¢œè‰²é€šé“ channels, 12288 So $X$, the input features has dimension 12288)ï¼Œè€Œä¸€æ—¦å›¾åƒè´¨é‡å¢åŠ ï¼Œä¾‹å¦‚å˜æˆ 1000 * 1000 * 3 çš„æ—¶å€™é‚£ä¹ˆæ­¤æ—¶çš„ç¥ç»ç½‘ç»œçš„è®¡ç®—é‡ä¼šå·¨å¤§ï¼Œæ˜¾ç„¶è¿™ä¸ç°å®ã€‚æ‰€ä»¥éœ€è¦å¼•å…¥å…¶ä»–çš„æ–¹æ³•æ¥è§£å†³è¿™ä¸ªé—®é¢˜. 2. Edge detection exampleä½¿ç”¨è¾¹ç¼˜æ£€æµ‹ä½œä¸ºå…¥é—¨æ ·ä¾‹, you see how the convolution operation works. è¾¹ç¼˜æ£€æµ‹å¯ä»¥æ˜¯å‚ç›´è¾¹ç¼˜æ£€æµ‹ï¼Œä¹Ÿå¯ä»¥æ˜¯æ°´å¹³è¾¹ç¼˜æ£€æµ‹ï¼Œå¦‚ä¸Šå›¾æ‰€ç¤º. è‡³äºç®—æ³•å¦‚ä½•å®ç°ï¼Œä¸‹é¢ä¸¾ä¸€ä¸ªæ¯”è¾ƒç›´è§‚çš„ä¾‹å­ï¼š å¯ä»¥å¾ˆæ˜æ˜¾çš„çœ‹å‡ºåŸæ¥ 6 * 6 çš„çŸ©é˜µæœ‰æ˜æ˜¾çš„å‚ç›´è¾¹ç¼˜ï¼Œé€šè¿‡ 3 * 3 çš„è¿‡æ»¤å™¨ filter (ä¹Ÿå«åš â€œæ ¸â€)å·ç§¯ä¹‹åï¼Œä»ç„¶ä¿ç•™äº†åŸæ¥çš„å‚ç›´è¾¹ç¼˜ç‰¹å¾ï¼Œè™½ç„¶è¿™ä¸ªè¾¹ç¼˜è²Œä¼¼æœ‰ç‚¹ç²—ï¼Œè¿™æ˜¯å› ä¸ºæ•°æ®ä¸å¤Ÿå¤§çš„åŸå› ï¼Œå¦‚æœè¾“å…¥æ•°æ®å¾ˆå¤§çš„è¯è¿™ä¸ªä¸æ˜¯å¾ˆæ˜æ˜¾äº†. å…³äºç”¨ç¼–ç¨‹è¯­è¨€å®ç°ï¼špython / tensorflow / keras ç­‰ï¼Œéƒ½æœ‰ä¸€äº›å‡½æ•°æ¥å®ç°å·ç§¯è¿ç®—. 3. More edge detection é™¤äº†ä¸Šé¢çš„å‚ç›´ï¼Œæ°´å¹³è¾¹ç¼˜æ£€æµ‹ï¼Œå…¶å®ä¹Ÿå¯ä»¥æ£€æµ‹åˆé¢œè‰²è¿‡åº¦å˜åŒ–ï¼Œä¾‹å¦‚æ˜¯äº®å˜æš—ï¼Œè¿˜æ˜¯æš—å˜äº®ï¼Ÿ åœ¨è®¡ç®—æœºè§†è§‰çš„å†å²ä¸Šï¼Œå±‚æ›¾ç»å…¬å¹³çš„äº‰è®ºè¿‡å“ªäº›ä»€ä¹ˆæ ·çš„ filter æ•°å­—ç»„åˆæ‰æ˜¯æœ€å¥½çš„: ä¸‹é¢æ˜¯ä¸€äº›å¸¸è§çš„è¿‡æ»¤å™¨ï¼Œç¬¬äºŒä¸ªæ˜¯Sobel filterï¼Œå…·æœ‰è¾ƒå¼ºçš„é²æ£’æ€§ï¼Œç¬¬ä¸‰ä¸ªæ˜¯Schoss filter. Filter desc Sobel Filter it puts a little bit more weight to the central row å¢åŠ äº†ä¸­é—´ä¸€è¡Œçš„æƒé‡ Schoss Filter å®é™…å®ƒä¹Ÿæ˜¯ä¸€ç§å‚ç›´è¾¹ç¼˜æ£€æµ‹ ç¿»è½¬90åº¦ï¼Œå®ƒå°±å˜ä¸ºæ°´å¹³è¾¹ç¼˜æ£€æµ‹ Other Filter 9ä¸ªå‚æ•°ä¹Ÿå¯ä»¥é€šè¿‡å­¦ä¹ (åå‘ä¼ æ’­)çš„æ–¹å¼è·å¾— å…¶å®è¿‡æ»¤å™¨çš„9ä¸ªå‚æ•°ä¹Ÿå¯ä»¥é€šè¿‡å­¦ä¹ (åå‘ä¼ æ’­)çš„æ–¹å¼è·å¾—ï¼Œè™½ç„¶æ¯”è¾ƒè´¹åŠ²ï¼Œä½†æ˜¯å¯èƒ½ä¼šå­¦åˆ°å¾ˆå¤šå…¶ä»–é™¤äº†å‚ç›´ï¼Œæ°´å¹³çš„è¾¹ç¼˜ç‰¹å¾ï¼Œä¾‹å¦‚ 45Â°ï¼Œ70Â° ç­‰å„ç§ç‰¹å¾. 4. Padding ç”±å‰é¢çš„ä¾‹å­, å·ç§¯çš„æ–¹æ³•ï¼Œæœ‰2ä¸ªç¼ºç‚¹: æ¯ç»è¿‡ä¸€æ¬¡å·ç§¯è®¡ç®—ï¼ŒåŸæ•°æ®éƒ½ä¼šå‡å°ï¼Œä½†æœ‰æ—¶æˆ‘ä»¬å¹¶ä¸å¸Œæœ›è¿™æ ·ã€‚ä¸¾ä¸ªæ¯”è¾ƒæç«¯çš„ä¾‹å­ï¼šå‡è®¾åŸæ•°æ®æ˜¯ 30 * 30 çš„ä¸€åªçŒ«çš„å›¾åƒï¼Œç»è¿‡10æ¬¡å·ç§¯ (è¿‡æ»¤å™¨æ˜¯3 * 3) åï¼Œæœ€åå›¾åƒåªå‰©ä¸‹äº† 10 * 10 äº† ğŸ˜³ğŸ˜³ ç”±å·ç§¯çš„è®¡ç®—æ–¹æ³•å¯çŸ¥ï¼Œå›¾åƒè¾¹ç¼˜ç‰¹å¾è®¡ç®—æ¬¡æ•°æ˜¾ç„¶å°‘äºå›¾åƒä¸­é—´ä½ç½®çš„åƒç´ ç‚¹ï¼Œå¦‚ä¸‹å›¾ç¤º (ç»¿è‰²çš„ä½ç½®æ˜æ˜¾æ˜¯å†·å®«), å›¾åƒè¾¹ç¼˜çš„å¤§éƒ¨åˆ†ä¿¡æ¯éƒ½ä¸¢å¤±äº†. 4.1 è¿ç”¨ Padding çš„åŸå›  åŸæ¥çš„ 6 * 6 å¡«å……åå˜æˆäº† 8 * 8ï¼Œæ­¤æ—¶åœ¨ç»è¿‡ä¸€æ¬¡å·ç§¯å¾—åˆ°çš„ä»æ—§æ˜¯ 6 * 6 çš„çŸ©é˜µã€‚ ä¸‹é¢æ€»ç»“ä¸€ä¸‹å·ç§¯ä¹‹åå¾—åˆ°çŸ©é˜µå¤§å°çš„è®¡ç®—æ–¹æ³•ï¼Œå‡è®¾ï¼š Title Size desc åŸæ•°æ® $n * n$ çŸ©é˜µ $n * n$ Filter $f * f$ è¿‡æ»¤å™¨ Padding $p * p$ å¡«å……æ•°é‡ ç»¼ä¸Šï¼š $n+2p-f+1$ å¾—åˆ°çš„çŸ©é˜µå¤§å° padding åï¼Œè™½ç„¶è¾¹ç¼˜åƒç´ ç‚¹ä»æ—§è®¡ç®—çš„æ¯”è¾ƒå°‘ï¼Œä½†æ˜¯è¿™ä¸ªç¼ºç‚¹è‡³å°‘ä¸€å®šç¨‹åº¦ä¸Šè¢«å‰Šå¼±äº†. 4.2 å¦‚ä½• padding çš„å¤§å° Type desc Size Valid convolutions ä¸æ·»åŠ  padding $n - f + 1$ Same convolutions Pad so that output size is the same as the input size. ä¿æŒåŸå›¾åƒçŸ©é˜µçš„å¤§å° æ»¡è¶³ $n+2p-f+1 = n$ å³ $p=\\frac{f-1}{2}$, ä¸ºäº†æ»¡è¶³ä¸Šå¼ï¼Œ$f$ ä¸€èˆ¬å¥‡æ•° 5. Strided convolutionsè¿‡æ»¤å™¨ çºµå‘ã€æ¨ªå‘ éƒ½éœ€è¦æŒ‰ æ­¥é•¿ $S$ æ¥ç§»åŠ¨ï¼Œå¦‚å›¾ç¤º: ç»“åˆä¹‹å‰çš„å†…å®¹ï¼Œè¾“å‡ºçŸ©é˜µå¤§å°è®¡ç®—å…¬å¼æ–¹æ³•ä¸ºï¼Œå‡è®¾ï¼š Title Size desc åŸæ•°æ® $n * n$ çŸ©é˜µ $n * n$ Filter $f * f$ è¿‡æ»¤å™¨ Padding $p * p$ å¡«å……æ•°é‡ Stride $s * s$ æ­¥é•¿ ç»¼ä¸Šï¼š å¾—åˆ°çš„çŸ©é˜µå¤§å°æ˜¯ âŒŠ$\\frac{n+2p-f}{s}$âŒ‹ * âŒŠ$\\frac{n+2p-f}{s}$âŒ‹ âŒŠâŒ‹: å‘ä¸‹å–æ•´ç¬¦å· âŒŠ59/60âŒ‹ = 0 âŒˆâŒ‰: å‘ä¸Šå–æ•´ç¬¦å· âŒˆ59/60âŒ‰ = 1 6. Convolutions Over Volumesè¿™ä¸€èŠ‚ç”¨ç«‹ä½“å·ç§¯æ¥è§£é‡Š å¦‚å›¾: è¾“å…¥çŸ©é˜µæ˜¯ $6 * 6 * 3$ (height * width * channels), è¿‡æ»¤å™¨æ˜¯ $3 * 3 * 3$ï¼Œè®¡ç®—æ–¹æ³•æ˜¯ä¸€ä¸€å¯¹åº”ç›¸ä¹˜ç›¸åŠ  æœ€åå¾—åˆ° $4 * 4$ çš„äºŒç»´çŸ©é˜µ. æœ‰æ—¶å¯èƒ½éœ€è¦æ£€æµ‹ æ°´å¹³è¾¹ç¼˜ æˆ– å‚ç›´è¾¹ç¼˜ï¼Œæˆ– å…¶ä»–ç‰¹å¾ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¤šä¸ªè¿‡æ»¤å™¨ã€‚ä¸Šå›¾åˆ™ä½¿ç”¨äº†ä¸¤ä¸ªè¿‡æ»¤å™¨ (é»„è‰²å’Œæ©˜é»„è‰²)ï¼Œå¾—åˆ°çš„ç‰¹å¾çŸ©é˜µå¤§å°ä¸º $4 * 4 * 2$. Filter æ•°å­—ç»„åˆå‚æ•°çš„é€‰æ‹©ä¸åŒï¼Œä½ å¯ä»¥å¾—åˆ°ä¸åŒçš„ç‰¹å¾æ£€æµ‹å™¨. 7. One Layer of CNN Example å¦‚å›¾ç¤ºå¾—åˆ° $4 * 4$ çš„çŸ©é˜µåè¿˜éœ€è¦åŠ ä¸Šä¸€ä¸ªåå·® $b_n$ (Python å¹¿æ’­æœºåˆ¶)ï¼Œä¹‹åè¿˜è¦è¿›è¡Œéçº¿æ€§è½¬æ¢ï¼Œå³ç”¨ ReLU å‡½æ•°. å› æ­¤å‡å¦‚åœ¨æŸä¸€å·ç§¯å±‚ä¸­ä½¿ç”¨äº† 10 ä¸ª $3 * 3$ çš„ Filter è¿‡æ»¤å™¨ï¼Œé‚£ä¹ˆä¸€å…±æœ‰ $(3*3+1)*10=280$ ä¸ªå‚æ•°. ä¸‹é¢æ€»ç»“äº†å„é¡¹å‚æ•°çš„å¤§å°å’Œè¡¨ç¤ºæ–¹æ³•ï¼š Title Formula desc è¾“å…¥çŸ©é˜µ $n_H^{l-1} * n_W^{l-1} * n_c^{l-1}$ $height * width * channels = 6 * 6 * 3$ è¿‡æ»¤å™¨å¤§å° $f^{[l]}$ Padding $p^{[l]}$ Stride $s^l$ æ­¥é•¿ Each Filter is $f^{l} * f^{l} * n_c^{[l-1]}$ $3 * 3 * 3$ , $n_c^{[l-1]} = 3$ æ¯ä¸€å·ç§¯å±‚çš„è¿‡æ»¤å™¨çš„é€šé“çš„å¤§å° = è¾“å…¥å±‚çš„é€šé“å¤§å° $n_c^{[l-1]}$ Activations æ¿€æ´»å‡½æ•° $a^{l}$ = $n_H^{l} * n_W^{l} * n_c^{l}$ $A^{l}$ = $m * n_H^{l} * n_W^{l} * n_c^{l}$ï¼Œ($m$ä¸ªä¾‹å­) æƒé‡ weight $f^{l} * f^{l} * n_c^{[l-1]} * n_c^{[l]}$ $Filter * è¿‡æ»¤å™¨ä¸ªæ•°$ è¿‡æ»¤å™¨çš„ä¸ªæ•° = è¾“å‡ºå±‚çš„é€šé“çš„å¤§å° $n_c^{l}$ åå·® bias $1 * 1 * 1 * n_c^{[l]}$ è¾“å‡ºçŸ©é˜µ $n_H^{l} * n_W^{l} * n_c^{l}$ $height * width * channels$ Output $n_{H/W}^{[l]}=[\\frac{n_{H/W}^{[l-1]}+2p^{[l]}-f^{[l]}}{s^{[l]}}+1]$ è¾“å‡ºå±‚ä¸è¾“å…¥å±‚è®¡ç®—å…¬å¼ 8. A Simple Convolution Network ä¸Šå›¾ç®€å•ä»‹ç»äº†å·ç§¯ç½‘ç»œçš„è®¡ç®—è¿‡ç¨‹ï¼Œéœ€è¦å†ä»‹ç»çš„ä¸€ç‚¹æ˜¯æœ€åä¸€å±‚çš„å…¨è¿æ¥å±‚ï¼Œå³å°† $7 * 7 * 40$ çš„è¾“å‡ºçŸ©é˜µå±•å¼€ï¼Œå¾—åˆ° $1960$ ä¸ªèŠ‚ç‚¹ï¼Œç„¶åå†é‡‡ç”¨ Softmax æ¥è¿›è¡Œé¢„æµ‹. ä¸€èˆ¬çš„ CNN ä¸­ï¼Œæ¯ä¸€å±‚çŸ©é˜µçš„ height å’Œ width æ˜¯é€æ¸å‡å°çš„ï¼Œè€Œ channel åˆ™æ˜¯å¢åŠ çš„ ($n_c$ åœ¨å¢åŠ ï¼Œ$n_H$ å’Œ $n_W$ åœ¨å‡å°‘). CNN ä¸­å¸¸è§çš„ 3 ç§ç±»å‹çš„ layerï¼š Convolution (Conv å·ç§¯å±‚) Pooling (Pool æ± åŒ–å±‚) Fully connected (FC å…¨è¿æ¥å±‚) 9. Pooling Layersä½¿ç”¨æ± åŒ–å±‚æ¥ç¼©å‡æ¨¡å‹çš„å¤§å°ï¼Œæé«˜è®¡ç®—é€Ÿåº¦ï¼ŒåŒæ—¶æé«˜æå–ç‰¹å¾çš„é²æ£’æ€§. æœ€å¤§æ± åŒ–çš„ç›´è§‚ç†è§£: ä½ å¯ä»¥æŠŠä¸Šé¢ $4 * 4$ è¾“å…¥çœ‹åšæ˜¯æŸäº›ç‰¹å¾çš„é›†åˆ (ä¹Ÿè®¸ä¸æ˜¯)ï¼Œä¹Ÿå°±æ˜¯ç¥ç»ç½‘ç»œä¸­æŸä¸€å±‚çš„åæ¿€æ´»å€¼ï¼Œæ•°å­—å¤§æ„å‘³ç€å¯èƒ½æå–äº†æŸäº›ç‰¹å®šç‰¹å¾. å·¦ä¸Šè±¡é™å…·æœ‰è¿™ä¸ªç‰¹å¾ï¼Œå¯èƒ½æ˜¯ä¸€ä¸ªå‚ç›´è¾¹ç¼˜. or maybe an eyeï¼Œ æ˜¾ç„¶å·¦ä¸Šè±¡é™å…·æœ‰è¿™ä¸ªç‰¹å¾. æœ€å¤§åŒ–æ“ä½œçš„åŠŸèƒ½å°±æ˜¯åªè¦åœ¨ä»»ä½•ä¸€ä¸ªè±¡é™å†…æå–åˆ°æŸä¸ªç‰¹å¾ï¼Œå®ƒå°±ä¼šä¿ç•™åœ¨æœ€å¤§æ± åŒ–çš„è¾“å‡ºé‡Œ. æœ€å¤§åŒ–æ“ä½œçš„å®é™…ä½œç”¨å°±æ˜¯ï¼šå¦‚æœåœ¨ Filter ä¸­æå–åˆ°æŸä¸ªç‰¹å¾ é‚£ä¹ˆä¿ç•™å…¶æœ€å¤§å€¼. å¦‚æœæ²¡æœ‰æå–åˆ°è¿™ä¸ªç‰¹å¾ï¼Œæ¯”å¦‚è¯´ å³ä¸Šè±¡é™ ä¸­ï¼Œé‚£ä¹ˆå…¶æœ€å¤§å€¼ä¹Ÿè¿˜æ˜¯å¾ˆå°. Max Pooling çš„è¶…çº§å‚æ•° $f=2 / 3$ï¼Œ$s=2$ æ˜¯æœ€å¸¸ç”¨çš„ï¼Œæ•ˆæœç›¸å½“äºé«˜åº¦å’Œå®½åº¦ç¼©å‡ä¸€åŠ. Max Pooling å¾ˆå°‘ç”¨ paddingï¼Œ by far, is $p = 0$ï¼ŒAverage Pooling è¿™ä¸ªç”¨çš„ä¸å¤šï¼Œè¿™ä¸ªä¹Ÿä¼šåŠ å…¥æ›´å¤šçš„è®¡ç®—é‡. 10. A CNN Exampleåœ¨ Andrew Ng çš„è¯¾ä»¶ä¸­å°† Conv layer å’Œ Pooling layer åˆå¹¶åœ¨ä¸€èµ·è§†ä¸ºä¸€å±‚ï¼Œå› ä¸ºæ± åŒ–å±‚æ²¡æœ‰å‚æ•° (å› ä¸ºæ± åŒ–å±‚çš„è¿‡æ»¤å™¨ æ— å‚æ•°ï¼Œæœ‰è¶…å‚æ•°ï¼Œè€Œä¸”å…¶å¤§å°å¯ä»¥äº‹å…ˆç¡®å®šå¥½)ã€‚ ä½†æ˜¯åœ¨å…¶ä»–æ–‡çŒ®ä¸­æœ‰å¯èƒ½ä¼šæŠŠæ± åŒ–å±‚ç®—æˆå•ç‹¬çš„å±‚ï¼Œæ‰€ä»¥è§†æƒ…å†µè€Œå®šã€‚ æ± åŒ–å±‚å‚æ•°ä¸ªæ•°ä¸º 0ï¼Œå·ç§¯å±‚å‚æ•°ä¸ªæ•°ä¸€èˆ¬å¤šï¼Œfully connected layer å…¨è¿æ¥å±‚ å‚æ•°å¾ˆå¤š. 11. Why Convolutions ? å·ç§¯ ç›¸æ¯”äº FCå…¨è¿æ¥ çš„å¥½å¤„æœ€ç›´è§‚çš„å°±æ˜¯ä½¿ç”¨çš„å‚æ•°æ›´å°‘ï¼Œå‚æ•°å…±äº« å’Œ ç¨€ç–è¿æ¥ï¼š 11.1 Parameter sharingç‰¹å¾æ£€æµ‹å¦‚å‚ç›´è¾¹ç¼˜æ£€æµ‹å¦‚æœé€‚ç”¨äºå›¾ç‰‡çš„æŸä¸ªåŒºåŸŸï¼Œé‚£ä¹ˆå®ƒä¹Ÿå¯èƒ½é€‚ç”¨äºå›¾ç‰‡çš„å…¶ä»–åŒºåŸŸï¼Œä¹Ÿå°±æ˜¯è¯´å¦‚æœä½ ç”¨ä¸€ä¸ª $3 * 3$ çš„ Filter æ£€æµ‹å‚ç›´è¾¹ç¼˜. é‚£ä¹ˆå›¾ç‰‡çš„å·¦ä¸Šè§’åŒºåŸŸä»¥åŠæ—è¾¹çš„å„ä¸ªåŒºåŸŸéƒ½å¯ä»¥ä½¿ç”¨è¿™ä¸ª $3 * 3$ çš„è¿‡æ»¤å™¨. æ¯ä¸ªç‰¹å¾æ£€æµ‹å™¨ä»¥åŠè¾“å‡ºéƒ½å¯ä»¥åœ¨è¾“å…¥å›¾ç‰‡çš„ä¸åŒåŒºåŸŸä¸­ä½¿ç”¨åŒæ ·çš„å‚æ•°ï¼Œä»¥ä¾¿æå–å‚ç›´è¾¹ç¼˜æˆ–å…¶ä»–ç‰¹å¾ï¼Œå®ƒä¸ä»…é€‚ç”¨äºè¾¹ç¼˜ç‰¹å¾è¿™æ ·çš„ä½é˜¶ç‰¹å¾ï¼ŒåŒæ ·é€‚ç”¨äºé«˜é˜¶ç‰¹å¾. ä¾‹å¦‚ï¼šæå–è„¸ä¸Šçš„çœ¼ç› ç­‰æˆ–è€…å…¶ä»–å¯¹è±¡. è¿™ç§æ˜¯æ•´å¼ å›¾ç‰‡å…±äº«ç‰¹å¾æ£€æµ‹å™¨ æå–æ•ˆæœä¹Ÿå¾ˆå¥½ 11.2 Sparsity of Connectionså³è¾¹å›¾ çš„è¾¹ç¼˜ï¼Œä»…ä¸ 36 ä¸ªè¾“å…¥ç‰¹å¾ä¸­çš„ 9 ä¸ªç›¸è¿æ¥, è€Œä¸”å…¶ä»–åƒç´ å€¼éƒ½ä¸ä¼šå¯¹è¾“å‡ºäº§ç”Ÿä»»ä½•å½±å“, è¿™å°±æ˜¯ç¨€ç–è¿æ¥çš„æ¦‚å¿µ. æŸä¸ªè¾“å‡ºç‚¹ï¼Œçœ‹ä¸Šå»åªæœ‰è¿™ 9 ä¸ªè¾“å…¥ç‰¹å¾ä¸è¾“å‡ºç›¸è¿æ¥. å…¶ä»–åƒç´ å¯¹è¾“å‡ºæ²¡æœ‰ä»»ä½•å½±å“. ç¥ç»ç½‘ç»œå¯ä»¥é€šè¿‡è¿™ä¸¤ç§æœºåˆ¶å‡å°‘å‚æ•°. ä»¥ä¾¿äºæˆ‘ä»¬ç”¨æ›´å°çš„è®­ç»ƒé›†è®­ç»ƒå®ƒï¼Œä»è€Œé¢„é˜²è¿‡åº¦æ‹Ÿåˆ. (å·ç§¯æœ‰ä¸€ä¸ªå¹³ç§»ä¸å˜å±æ€§) ç»¼ä¸Šè¿™äº›å°±æ˜¯å·ç§¯ç¥ç»ç½‘ç»œ CNN è¡¨ç°è‰¯å¥½çš„åŸå› . Reference ç½‘æ˜“äº‘è¯¾å ‚ - deeplearning DeepLearning.aiå­¦ä¹ ç¬”è®°æ±‡æ€» CNNå…¥é—¨è®²è§£ï¼šå·ç§¯å±‚æ˜¯å¦‚ä½•æå–ç‰¹å¾çš„ï¼Ÿ","categories":[{"name":"deeplearning","slug":"deeplearning","permalink":"http://iequa.com/categories/deeplearning/"}],"tags":[{"name":"deeplearning.ai","slug":"deeplearning-ai","permalink":"http://iequa.com/tags/deeplearning-ai/"}]},{"title":"Chatbot Research 6 - æ›´å¤šè®ºæ–‡ (æ„Ÿè°¢ PaperWeekly)","slug":"chatbot/chatbot-research6","date":"2018-08-16T06:00:21.000Z","updated":"2020-10-23T02:03:18.014Z","comments":true,"path":"2018/08/16/chatbot/chatbot-research6/","link":"","permalink":"http://iequa.com/2018/08/16/chatbot/chatbot-research6/","excerpt":"Chatbot æ›´å¤š Paper è®ºæ–‡å’Œå‚è€ƒèµ„æ–™ (æ„Ÿè°¢ PaperWeekly)","text":"Chatbot æ›´å¤š Paper è®ºæ–‡å’Œå‚è€ƒèµ„æ–™ (æ„Ÿè°¢ PaperWeekly) Paper 1ã€ŠA Neural Conversational Modelã€‹ ä»£ç : https://github.com/Conchylicultor/DeepQA 2128 star ä½œè€…: æ¥è‡ª Google Brainï¼Œæ¯•ä¸šäº UC Berkeley çš„ Oriol Vinyalsåšå£« å¯¹æ¯” cleverbot (ç¬¬äºŒä»£åŸºäºæ£€ç´¢çš„èŠå¤©æœºå™¨äºº)ï¼Œéƒ¨åˆ†å›ç­” æ›´æ™ºèƒ½ã€‚ å¦‚ä½•å®¢è§‚åœ°è¯„ä»·ç”Ÿæˆçš„æ•ˆæœ? æœ‰ä¸€äº›é—®é¢˜æ²¡æœ‰æ ‡å‡†ç­”æ¡ˆ æ¥è¯´ï¼Œè‡ªåŠ¨è¯„ä»· VS ç”¨æˆ·è¯„ä»· ä½œè€…å¯¹ä¸€äº›è¯„ä¼°æ–¹æ³•æå‡ºäº†ä¸€äº›è‡ªå·±çš„æ€è€ƒæ–¹å¼ DeepQA chatbot è®­ç»ƒçš„éƒ¨åˆ† chatbot_website æœåŠ¡çš„éƒ¨åˆ†ï¼Œç½‘é¡µç«¯ DeepQA/chatbot/ è¿™å‡ ä¸ªæ–‡ä»¶æ¯”è¾ƒé‡è¦ from chatbot.corpus.cornelldata import CornellDatafrom chatbot.corpus.opensubsdata import OpensubsDatafrom chatbot.corpus.scotusdata import ScotusDatafrom chatbot.corpus.ubuntudata import UbuntuDatafrom chatbot.corpus.lightweightdata import LightweightData è¯­æ–™å¤ªå¤§çš„æƒ…å†µä¸‹ï¼Œåšä¸€äº›é‡‡æ ·æˆ–è€…å±‚æ¬¡åŒ–çš„ softmax å¯è¡Œ if 0 &lt; self.args.softmaxSamples &lt; self.textData.getVocabularySize(): outputProjection = ProjectionOp( (self.textData.getVocabularySize(), self.args.hiddenSize), scope=&#x27;softmax_projection&#x27;, dtype=self.dtype ) def sampledSoftmax(labels, inputs): Paper 2ã€ŠA Diversity-Promoting Objective Function for Neural Conversation Modelsã€‹ ä½œè€…ï¼š Jiwei Liï¼Œ Jiwei Liâ€™s Github å…³äºã€ŠA Persona-Based Neural Conversation Modelã€‹çš„pre-paper Seq2seq å®¹æ˜“äº§å‡ºâ€å‘µå‘µâ€ï¼Œâ€éƒ½å¯ä»¥â€ï¼Œâ€æˆ‘ä¸çŸ¥é“â€è¿™ç§ safe ä½†æ— æ„ä¹‰çš„å›ç­” NLG é—®é¢˜ï¼Œå¸¸ä½¿ç”¨ MLE ä½œä¸ºç›®æ ‡å‡½æ•°ï¼Œäº§å‡ºçš„ç»“æœé€šç•…ï¼Œä½† diversity å·®ï¼Œå¯è€ƒè™‘ decoder äº§å‡º n-best, å† rank æå‡º Maximum Mutual Information(MMI) ä½œä¸ºç›®æ ‡å‡½æ•°ï¼Œ æœ‰ MMI-antiLM å’ŒMMI-bidi 2ç§ Paper 3ã€ŠA Persona-Based Neural Conversation Modelã€‹ Speaker Model å’Œ Speaker-Addressee Model ä½œè€…ï¼š Jiwei Liï¼Œ Jiwei Liâ€™s Github ä»£ç ï¼š https://github.com/jiweil/Neural-Dialogue-Generation è§£å†³å¤šè½®å¯¹è¯å›ç­”ä¸ä¸€è‡´é—®é¢˜ Model ä¸­èå…¥ user identity (æ¯”å¦‚èƒŒæ™¯ä¿¡æ¯ã€ç”¨æˆ·ç”»åƒï¼Œå¹´é¾„ç­‰ä¿¡æ¯)ï¼Œæ„å»ºå‡ºä¸ªæ€§åŒ–çš„ seq2seq æ¨¡å‹ï¼Œä¸ºä¸åŒçš„ userï¼Œ ä»¥åŠ åŒä¸€ä¸ªuser å¯¹ä¸åŒçš„å¯¹è±¡å¯¹è¯ç”Ÿæˆä¸åŒé£æ ¼çš„ response Paper 4ã€ŠA Hierarchical Latent Variable Encoder-Decoder Model for Generating Dialoguesã€‹ ä»£ç : https://github.com/julianser/hed-dlg-truncated ä½œè€…: æ¥è‡ªè’™ç‰¹åˆ©å°”å¤§å­¦å’ŒMaluubaå…¬å¸ æ„åœ¨è§£å†³è¯­è¨€æ¨¡å‹ç”Ÿæˆéƒ¨åˆ†å­˜åœ¨çš„é—®é¢˜ æ•´ä¸ª seq2seq æ¡†æ¶ä¸­ decoderç”Ÿæˆéƒ¨åˆ†çš„é—®é¢˜ï¼Œä¸ä»…æ˜¯ boté¢†åŸŸå¯¹è¯ç”Ÿæˆçš„é—®é¢˜ï¼Œéƒ½å¯ä»¥å°è¯•ç”¨è¿™ä¸ªæ–¹å¼ã€‚ Paper 5æ›´å¤šè®ºæ–‡å’Œå‚è€ƒèµ„æ–™(æ„Ÿè°¢PaperWeekly) ã€ŠEnd-to-end LSTM-based dialog control optimized with supervised and reinforcement learningã€‹http://rsarxiv.github.io/2016/07/17/End-to-end-LSTM-based-dialog-control-optimized-with-supervised-and-reinforcement-learning-PaperWeekly/ ã€ŠA Network-based End-to-End Trainable Task-oriented Dialogue Systemã€‹http://rsarxiv.github.io/2016/07/12/A-Network-based-End-to-End-Trainable-Task-oriented-Dialogue-System-PaperWeekly ã€ŠA Neural Network Approach to Context-Sensitive Generation of Conversational Responsesã€‹http://rsarxiv.github.io/2016/07/15/A-Neural-Network-Approach-to-Context-Sensitive-Generation-of-Conversational-Responses-PaperWeekly/ Sequence to Backward and Forward Sequences: A Content-Introducing Approach to Generative Short-Text Conversationhttp://rsarxiv.github.io/2016/07/09/Sequence-to-Backward-and-Forward-Sequences-A-Content-Introducing-Approach-to-Generative-Short-Text-Conversation-PaperWeekly/ Reference 2015 DeepQA èŠå¤©æœºå™¨äººæ·±åº¦å­¦ä¹ åº”ç”¨-part1ï¼šå¼•è¨€ dennybritz/chatbot-retrieval æ›´å¤šè®ºæ–‡å’Œå‚è€ƒèµ„æ–™(æ„Ÿè°¢PaperWeekly)","categories":[{"name":"chatbot","slug":"chatbot","permalink":"http://iequa.com/categories/chatbot/"}],"tags":[{"name":"PaperWeekly","slug":"PaperWeekly","permalink":"http://iequa.com/tags/PaperWeekly/"}]},{"title":"Chatbot Research 5 - åŸºäºæ·±åº¦å­¦ä¹ çš„æ£€ç´¢èŠå¤©æœºå™¨äºº","slug":"chatbot/chatbot-research5","date":"2018-08-15T06:00:21.000Z","updated":"2020-10-23T02:03:18.013Z","comments":true,"path":"2018/08/15/chatbot/chatbot-research5/","link":"","permalink":"http://iequa.com/2018/08/15/chatbot/chatbot-research5/","excerpt":"ä»‹ç»åŸºäºæ£€ç´¢å¼æœºå™¨äººã€‚æ£€ç´¢å¼æ¶æ„æœ‰é¢„å®šå¥½çš„è¯­æ–™ç­”å¤åº“ã€‚ æ£€ç´¢å¼æ¨¡å‹çš„è¾“å…¥æ˜¯ä¸Šä¸‹æ–‡æ½œåœ¨çš„ç­”å¤ã€‚æ¨¡å‹è¾“å‡ºå¯¹è¿™äº›ç­”å¤çš„æ‰“åˆ†ï¼Œå¯ä»¥é€‰æ‹©æœ€é«˜åˆ†çš„ç­”æ¡ˆä½œä¸ºå›å¤ã€‚","text":"ä»‹ç»åŸºäºæ£€ç´¢å¼æœºå™¨äººã€‚æ£€ç´¢å¼æ¶æ„æœ‰é¢„å®šå¥½çš„è¯­æ–™ç­”å¤åº“ã€‚ æ£€ç´¢å¼æ¨¡å‹çš„è¾“å…¥æ˜¯ä¸Šä¸‹æ–‡æ½œåœ¨çš„ç­”å¤ã€‚æ¨¡å‹è¾“å‡ºå¯¹è¿™äº›ç­”å¤çš„æ‰“åˆ†ï¼Œå¯ä»¥é€‰æ‹©æœ€é«˜åˆ†çš„ç­”æ¡ˆä½œä¸ºå›å¤ã€‚ æ—¢ç„¶ç”Ÿæˆå¼çš„æ¨¡å‹æ›´å¼¹æ€§ï¼Œä¹Ÿä¸éœ€è¦é¢„å®šä¹‰çš„è¯­æ–™ï¼Œä¸ºä½•ä¸é€‰æ‹©å®ƒå‘¢ï¼Ÿ ç”Ÿæˆå¼æ¨¡å‹çš„é—®é¢˜å°±æ˜¯å®é™…ä½¿ç”¨èµ·æ¥å¹¶ä¸èƒ½å¥½å¥½å·¥ä½œï¼Œè‡³å°‘ç°åœ¨æ˜¯ã€‚å› ä¸ºç­”å¤æ¯”è¾ƒè‡ªç”±ï¼Œå®¹æ˜“çŠ¯è¯­æ³•é”™è¯¯å’Œä¸ç›¸å…³ã€ä¸åˆé€»è¾‘çš„ç­”æ¡ˆï¼Œå¹¶ä¸”éœ€è¦å¤§é‡çš„æ•°æ®ä¸”å¾ˆéš¾åšä¼˜åŒ–ã€‚ å¤§é‡çš„ç”Ÿäº§ç³»ç»Ÿä¸Šè¿˜æ˜¯é‡‡ç”¨ æ£€ç´¢æ¨¡å‹ æˆ–è€… æ£€ç´¢æ¨¡å‹ å’Œ ç”Ÿæˆæ¨¡å‹ ç»“åˆçš„æ–¹å¼ã€‚ ä¾‹å¦‚ google çš„ smart replyã€‚ ç”Ÿæˆæ¨¡å‹æ˜¯ç ”ç©¶çš„çƒ­é—¨é¢†åŸŸï¼Œä½†æ˜¯æˆ‘ä»¬è¿˜æ²¡åˆ°åº”ç”¨å®ƒçš„ç¨‹åº¦ã€‚å¦‚æœä½ æƒ³è¦åšä¸€ä¸ªèŠå¤©æœºå™¨äººï¼Œæœ€å¥½è¿˜æ˜¯é€‰ç”¨æ£€ç´¢å¼æ¨¡å‹ æ›´èªæ˜çš„èŠå¤©æœºå™¨äºº ï¼š ç”Ÿæˆå¼æ¨¡å‹ VS æ£€ç´¢åŒ¹é…æ¨¡å‹ Chatterbotçš„è¿›åŒ–: æ·±åº¦å­¦ä¹ æé«˜æ™ºèƒ½åº¦ æ¨¡å‹æ„å»º ï¼š é—®é¢˜çš„åˆ†æä¸è½¬åŒ– æ•°æ®é›†ä¸æ ·æœ¬æ„é€ æ–¹æ³• ç½‘ç»œç»“æ„çš„æ„å»º æ¨¡å‹çš„è¯„ä¼° ä»£ç å®ç°ä¸è§£æ 1. èŠå¤©æœºå™¨äºº 1.1 åŸºäºæ£€ç´¢çš„ chatbot æ ¹æ® input å’Œ contextï¼Œç»“åˆçŸ¥è¯†åº“çš„ç®—æ³•å¾—åˆ°åˆé€‚å›å¤ ä»ä¸€ä¸ªå›ºå®šçš„æ•°æ®é›†ä¸­æ‰¾åˆ°åˆé€‚çš„å†…å®¹ä½œä¸ºå›å¤ æ£€ç´¢å’ŒåŒ¹é…çš„æ–¹å¼æœ‰å¾ˆå¤šç§ æ•°æ®å’ŒåŒ¹é…æ–¹æ³•å¯¹è´¨é‡æœ‰å¾ˆå¤§å½±å“ 1.2 åŸºäºç”Ÿæˆæ¨¡å‹çš„chatbot å…¸å‹çš„æ˜¯ seq2seq çš„æ–¹æ³• ç”Ÿæˆçš„ç»“æœéœ€è¦è€ƒè™‘é€šç•…åº¦å’Œå‡†ç¡®åº¦ ä»¥å‰è€…ä¸ºä¸»(å¯æ§åº¦é«˜)ï¼Œåè€…ä¸ºè¾… 2. å›é¡¾ chatterbot 2.1 chatterbot çš„é—®é¢˜åº”ç­”æ¨¡å¼çš„åŒ¹é…æ–¹å¼å¤ªç²—æš´ ç¼–è¾‘è·ç¦»æ— æ³•æ•è·æ·±å±‚è¯­ä¹‰ä¿¡æ¯ æ ¸å¿ƒè¯ + word2vec æ— æ³•æ•è·æ•´å¥è¯è¯­ä¹‰ LSTM ç­‰ RNNæ¨¡å‹ èƒ½æ•è·åºåˆ—ä¿¡æ¯â€¦ç”¨æ·±åº¦å­¦ä¹ æ¥æé«˜åŒ¹é…é˜¶æ®µå‡†ç¡®ç‡!! å¿ƒå¾— : Open Domain çš„ chatbot å¾ˆéš¾åšï¼Œè¯é¢˜å¤ªå¹¿ï¼Œå› ä¸ºæ— æ³•é¢„çŸ¥ç”¨æˆ·ä¼šé—®åˆ°ä»€ä¹ˆé—®é¢˜. ä½ æƒ³åƒä»€ä¹ˆ ï¼š éšä¾¿ä½ æ„Ÿè§‰æ€ä¹ˆæ · : è¿˜å¥½ æ²¡é—®é¢˜å…¶å® æ‰€ä»¥é’ˆå¯¹ä¸€ä¸ª Closed Domain + æ£€ç´¢ + çŸ¥è¯†åº“ï¼Œè¿˜åº”è¯¥å¯ä»¥åšä¸€ä¸ªå¯ä»¥ç”¨çš„æœºå™¨äºº. 2.2 åº”è¯¥æ€ä¹ˆåšåŒ¹é…æœ¬èº«æ˜¯ä¸€ä¸ªæ¨¡ç³Šçš„åœºæ™¯ è½¬æˆæ’åºé—®é¢˜ æ’åºé—®é¢˜æ€ä¹ˆå¤„ç†? è½¬æˆèƒ½è¾“å‡ºæ¦‚ç‡çš„01åˆ†ç±»é—®é¢˜ Q1 -&gt; { R1: 0.8, R2: 0.1, R3: 0.05, R4: 0.2 } Query &lt;&gt; Response æ•°æ®æ„å»º? æˆ‘ä»¬éœ€è¦æ­£æ ·æœ¬(æ­£ç¡®çš„å›ç­”) å’Œ è´Ÿæ ·æœ¬(ä¸å¯¹çš„å›ç­”) { æ­£æ ·æœ¬ : Q1-R1 1 }, { è´Ÿæ ·æœ¬ : Q1-R3 0 } Loss function? å›å¿†ä¸€ä¸‹ logistic regression å¿ƒå¾— : å®šä¹‰é—®é¢˜ å’Œ è§£å†³é—®é¢˜ å¾ˆé‡è¦ æœ‰ä¸€ä¸ªé—®é¢˜ï¼Œå¯ä»¥è½¬æ¢ä¸º æœºå™¨å­¦ä¹  æˆ– æ·±åº¦å­¦ä¹  å¯ä»¥è§£å†³çš„é—®é¢˜ï¼Œè¿™éå¸¸é‡è¦ã€‚ 3. ç”¨æ·±åº¦å­¦ä¹ æ¥å®Œæˆ ä¸ç®¡ç½‘ç»œç»“æ„å¦‚ä½•ï¼Œä½ æŠ“ä½æœ€å¥½çš„ loss function 100 W æ ·æœ¬ï¼Œ50W+ï¼Œ 50W-ï¼Œ è¿™æ ·çš„æ•°æ®é›† æˆ‘ä»¬æ‹¿æ¥åšè®­ç»ƒï¼Œè¿™æ ·çš„ç½‘ç»œç»“æ„ï¼Œä¸ç®¡å¦‚ä½•æ­å»ºï¼Œéƒ½ä¸è¦å¤ªæ‹…å¿ƒï¼Œä½ å°±æŠ“ä½ loss functionï¼Œä½ çš„æŸå¤±å‡½æ•°ç”± c å’Œ r å†³å®šçš„ã€‚ c å’Œ r æ˜¯ç”±äºä¸Šé¢çš„ç»“æ„äº§ç”Ÿçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å°±å¯ä»¥ç”¨ BPTT åšè®­ç»ƒäº†. Query å’Œ Respon éƒ½æ˜¯æˆ‘ä»¬åˆ†è¯åç”¨çš„ word embmmingï¼ŒçŒå…¥ RNN ä¸­ï¼Œæˆ‘ä»¬æŠŠ LSTM é¡ºç€æ•æ‰ä¸‹æ¥ï¼Œå½“åšé—®é¢˜å’Œå›ç­”ï¼Œä¸¤ä¸ªæ•æ‰çš„ä¿¡æ¯æ¥åšåŒ¹é…ï¼Œæˆ‘æ‰¾äº†ä¸ªå‚æ•° Mï¼Œæ¥åš c å’Œ r çš„åŒ¹é…ã€‚ M æ˜¯ä¸€å®šçš„ï¼ŒåŒ¹é…ç¨‹åº¦å’Œæ–¹å¼ä¸€è‡´. M åˆå§‹åŒ–çš„æ—¶å€™å¯ä»¥ç”± radom æ˜¯ç”Ÿæˆ. M ä¹‹åæ˜¯å¯ä»¥é€šè¿‡è®­ç»ƒåšæ›´æ–°çš„. 2016 Google Brain deep-learning-for-chatbots-2-retrieval-based-model-tensorflow, wildml blog 4. æ•°æ® - Ubuntu å¯¹è¯è¯­æ–™åº“æˆ‘ä»¬å°†ä½¿ç”¨Ubuntuå¯¹è¯æ•°æ®é›†ï¼ˆè®ºæ–‡æ¥æº githubåœ°å€ï¼‰ã€‚è¿™ä¸ªæ•°æ®é›†ï¼ˆUbuntu Dialog Corpus, UDCï¼‰æ˜¯ç›®å‰æœ€å¤§çš„å…¬å¼€å¯¹è¯æ•°æ®é›†ä¹‹ä¸€ï¼Œå®ƒæ˜¯æ¥è‡ª Ubuntu çš„ IRCç½‘ç»œ ä¸Šçš„å¯¹è¯æ—¥å¿—ã€‚è¿™ç¯‡è®ºæ–‡ä»‹ç»äº†è¯¥æ•°æ®é›†ç”Ÿæˆçš„å…·ä½“ç»†èŠ‚ã€‚ä¸‹é¢ç®€å•ä»‹ç»ä¸€ä¸‹æ•°æ®çš„æ ¼å¼ã€‚ è®­ç»ƒæ•°æ®æœ‰ 100W æ¡å®ä¾‹ï¼Œå…¶ä¸­ä¸€åŠæ˜¯æ­£ä¾‹ï¼ˆlabelä¸º1ï¼‰ï¼Œä¸€åŠæ˜¯è´Ÿä¾‹ï¼ˆlabelä¸º0ï¼Œè´Ÿä¾‹ä¸ºéšæœºç”Ÿæˆï¼‰ã€‚æ¯æ¡å®ä¾‹åŒ…æ‹¬ä¸€æ®µä¸Šä¸‹æ–‡ä¿¡æ¯ï¼ˆcontextï¼‰ï¼Œå³Queryï¼›å’Œä¸€æ®µå¯èƒ½çš„å›å¤å†…å®¹ï¼Œå³Responseï¼›Labelä¸º1è¡¨ç¤ºè¯¥Responseç¡®å®æ˜¯Queryçš„å›å¤ï¼ŒLabelä¸º0åˆ™è¡¨ç¤ºä¸æ˜¯ã€‚ä¸‹é¢æ˜¯æ•°æ®ç¤ºä¾‹ï¼š æ•°æ®é›†ç”Ÿæˆè„šæœ¬å·²ç”¨NLTKåšäº†ä¸€ç³»åˆ—çš„è¯­æ–™å¤„ç†åŒ…æ‹¬ï¼ˆåˆ†è¯ï¼Œstemmedï¼Œlemmatizedï¼‰ç­‰æ–‡æœ¬é¢„å¤„ç†æ­¥éª¤ï¼› ä½¿ç”¨äº†NERæŠ€æœ¯ï¼Œå°†æ–‡æœ¬ä¸­çš„å®ä½“ï¼Œå¦‚ å§“åã€åœ°ç‚¹ã€ç»„ç»‡ã€URL ç­‰æ›¿æ¢æˆç‰¹æ®Šå­—ç¬¦ã€‚ è¿™äº›é¢„å¤„ç†ä¸æ˜¯ä¸¥æ ¼å¿…è¦çš„ï¼Œä½†æ˜¯èƒ½æ”¹å–„ä¸€äº›ç³»ç»Ÿçš„è¡¨ç°ã€‚ è¯­æ–™çš„ä¸Šä¸‹æ–‡å¹³å‡æœ‰86ä¸ªè¯è¯­ï¼Œç­”å¤å¹³å‡æœ‰17ä¸ªè¯è¯­é•¿ã€‚æœ‰äººåšäº†è¯­æ–™çš„ç»Ÿè®¡åˆ†æï¼šdata analysis æ•°æ®é›†ä¹ŸåŒ…æ‹¬äº† Test / Validation setsï¼Œä½†è¿™ä¸¤éƒ¨åˆ†çš„æ•°æ®å’Œè®­ç»ƒæ•°æ®åœ¨æ ¼å¼ä¸Šä¸å¤ªä¸€æ ·ã€‚ åœ¨ Test / Validation sets ä¸­ï¼Œå¯¹äºæ¯ä¸€æ¡å®ä¾‹ï¼Œæœ‰ä¸€ä¸ªæ­£ä¾‹å’Œä¹ä¸ªè´Ÿä¾‹æ•°æ®ï¼ˆä¹Ÿç§°ä¸ºå¹²æ‰°æ•°æ®ï¼‰ã€‚ æ¨¡å‹çš„ç›®æ ‡åœ¨äºç»™æ­£ä¾‹çš„å¾—åˆ†å°½å¯èƒ½çš„é«˜ï¼Œè€Œç»™è´Ÿä¾‹çš„å¾—åˆ†å°½å¯èƒ½çš„ä½ã€‚ä¸‹é¢æ˜¯æ•°æ®ç¤ºä¾‹ï¼š 4.1 Train sets 4.2 Test / Validation sets æ¯ä¸ªæ ·æœ¬ï¼Œæœ‰ä¸€ä¸ªæ­£ä¾‹å’Œä¹ä¸ªè´Ÿä¾‹æ•°æ® (ä¹Ÿç§°ä¸ºå¹²æ‰°æ•°æ®)ã€‚ å»ºæ¨¡çš„ç›®æ ‡åœ¨äºç»™æ­£ä¾‹çš„å¾—åˆ†å°½å¯èƒ½çš„é«˜ï¼Œè€Œç»™è´Ÿä¾‹çš„å¾—åˆ†å°½å¯èƒ½çš„ä½ã€‚(æœ‰ç‚¹ç±»ä¼¼åˆ†ç±»ä»»åŠ¡) è¯­æ–™åšè¿‡åˆ†è¯ã€stemmedã€lemmatized ç­‰æ–‡æœ¬é¢„å¤„ç†ã€‚ NLTK stemmed from nltk.stem.porter import PorterStemmerp = PorterStemmer()p.stem(&#x27;wenting&#x27;) NLTK Lemma from nltk.stem import WordNetLemmatizerwordnet_lemmatizer = WordNetLemmatizer()wordnet_lemmatizer.lemmatize(â€˜dogsâ€™)uâ€™dogâ€™ ç”¨ NER(å‘½åå®ä½“è¯†åˆ«) å°†æ–‡æœ¬ä¸­çš„ å®ä½“ï¼Œå¦‚å§“åã€åœ°ç‚¹ã€ç»„ç»‡ã€URLç­‰ æ›¿æ¢æˆç‰¹æ®Šå­—ç¬¦ 5. è¯„ä¼°å‡†åˆ™ BASELINERecall@K å¸¸è§çš„ Kaggle æ¯”èµ›è¯„åˆ¤å‡†åˆ™ ç»æ¨¡å‹å¯¹å€™é€‰çš„ response æ’åºåï¼Œå‰ k ä¸ªå€™é€‰ä¸­ å­˜åœ¨æ­£ä¾‹æ•°æ®(æ­£ç¡®çš„é‚£ä¸ª)çš„å æ¯”ã€‚ è®© K=10ï¼Œè¿™å°±å¾—åˆ°ä¸€ä¸ª 100% çš„å¬å›ç‡ï¼Œå› æœ€å¤šå°± 10 ä¸ªå¤‡é€‰ã€‚å¦‚æœ K=1ï¼Œæ¨¡å‹åªä¸€æ¬¡æœºä¼šé€‰ä¸­æ­£ç¡®ç­”æ¡ˆã€‚ K å€¼ è¶Šå¤§ï¼ŒæŒ‡æ ‡å€¼è¶Šé«˜ï¼Œå¯¹æ¨¡å‹æ€§èƒ½çš„è¦æ±‚è¶Šæ¾ã€‚ 9ä¸ªå¹²æ‰°é¡¹ç›®æ€ä¹ˆé€‰å‡ºæ¥ è¿™ä¸ªæ•°æ®é›†é‡Œæ˜¯éšæœºçš„æ–¹æ³•é€‰æ‹©çš„ã€‚ ä½†æ˜¯ç°å®ä¸–ç•Œé‡Œä½ å¯èƒ½æ•°ç™¾ä¸‡çš„å¯èƒ½ç­”å¤ï¼Œå¹¶ä¸”ä½ å¹¶ä¸çŸ¥é“ç­”å¤æ˜¯å¦åˆç†æ­£ç¡®ã€‚ä½ æ²¡èƒ½åŠ›ä»æ•°ç™¾ä¸‡çš„å¯èƒ½çš„ç­”å¤é‡Œå»æŒ‘é€‰ä¸€ä¸ªå¾—åˆ†æœ€é«˜çš„æ­£ç¡®ç­”å¤ã€‚æˆæœ¬å¤ªé«˜äº†ï¼ google çš„ smart reply ç”¨åˆ†å¸ƒå¼é›†ç¾¤æŠ€æœ¯è®¡ç®—ä¸€ç³»åˆ—çš„å¯èƒ½ç­”å¤å»æŒ‘é€‰,. å¯èƒ½ä½ åªæœ‰ç™¾æ¥ä¸ªå¤‡é€‰ç­”æ¡ˆï¼Œå¯ä»¥å»è¯„ä¼°æ¯ä¸€ä¸ªã€‚ def evaluate_recall(y, y_test, k=1): num_examples = float(len(y)) num_correct = 0 for predictions, label in zip(y, y_test): if label in predictions[:k]: num_correct += 1 return num_correct/num_examples å…¶ä¸­ï¼Œy æ˜¯æ‰€é¢„æµ‹çš„ä»¥é™åºæ’åˆ—çš„æ¨¡å‹é¢„æµ‹åˆ†å€¼ï¼Œy_test æ˜¯å®é™…çš„ label å€¼ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œå‡è®¾ y çš„å€¼ä¸º [0,3,1,2,5,6,4,7,8,9]ï¼Œè¿™è¯´æ˜ ç¬¬0å· çš„å€™é€‰çš„é¢„æµ‹åˆ†å€¼æœ€é«˜ã€ä½œä¸ºå›å¤çš„å¯èƒ½æ€§æœ€é«˜ï¼Œè€Œ9å·åˆ™æœ€ä½ã€‚è¿™é‡Œçš„ ç¬¬0å· åŒæ—¶ä¹Ÿæ˜¯æ­£ç¡®çš„é‚£ä¸ªï¼Œå³æ­£ä¾‹æ•°æ®ï¼Œæ ‡å·ä¸º 1-9 çš„ä¸ºéšæœºç”Ÿæˆçš„è´Ÿä¾‹æ•°æ®ã€‚ 5.1 åŸºçº¿æ¨¡å‹:random guessç†è®ºä¸Šï¼Œæœ€baseçš„éšæœºæ¨¡å‹ï¼ˆRandom Predictorï¼‰çš„recall@1çš„å€¼ä¸º10%ï¼Œrecall@2çš„å€¼ä¸º20%. ç›¸åº”çš„ä»£ç å¦‚ä¸‹ï¼š # Random Predictordef predict_random(context, utterances): return np.random.choice(len(utterances), 10, replace=False) #np.random.choice(5, 3) array([0, 3, 4]) # å¯ä»¥ä»ä¸€ä¸ª intæ•°å­— æˆ– 1ç»´ array é‡Œéšæœºé€‰å–å†…å®¹ï¼Œå¹¶å°†é€‰å–ç»“æœæ”¾å…¥ nç»´ array ä¸­è¿”å›# Evaluate Random predictory_random = [predict_random(test_df.Context[x], test_df.iloc[x,1:].values) for x in range(len(test_df))]y_test = np.zeros(len(y_random))for n in [1, 2, 5, 10]: print(&quot;Recall @ (&#123;&#125;, 10): &#123;:g&#125;&quot;.format(n, evaluate_recall(y_random, y_test, n))) å®é™…çš„æ¨¡å‹ç»“æœå¦‚ä¸‹ï¼š Recall @ (1, 10): 0.0937632Recall @ (2, 10): 0.194503Recall @ (5, 10): 0.49297Recall @ (10, 10): 1 è¿™ä¸ç†è®ºé¢„æœŸç›¸ç¬¦ï¼Œä½†è¿™ä¸æ˜¯æˆ‘ä»¬æ‰€è¿½æ±‚çš„ç»“æœã€‚ 5.2 åŸºçº¿æ¨¡å‹:TF-IDFæ£€ç´¢å¦å¤–ä¸€ä¸ª baseline çš„æ¨¡å‹ä¸º tfidf predictorã€‚ç›´è§‚ä¸Šï¼Œä¸¤ç¯‡æ–‡æ¡£å¯¹åº”çš„ tfidf å‘é‡ è¶Šæ¥è¿‘ï¼Œä¸¤ç¯‡æ–‡ç« çš„å†…å®¹ä¹Ÿè¶Šç›¸ä¼¼ã€‚åŒæ ·çš„ï¼Œå¯¹äºä¸€ä¸ª QR pairï¼Œå®ƒä»¬è¯­ä¹‰ä¸Šæ¥è¿‘çš„è¯å…±ç°çš„è¶Šå¤šï¼Œä¹Ÿå°†è¶Šå¯èƒ½æ˜¯ä¸€ä¸ªæ­£ç¡®çš„ QR pairï¼ˆè¿™å¥è¯å­˜ç–‘ï¼ŒåŸå› åœ¨äº Q R ä¹‹é—´ä¹Ÿæœ‰å¯èƒ½ä¸å­˜åœ¨è¯­ä¹‰ä¸Šçš„ç›¸ä¼¼ï¼Œä¸€ä¸ªQå¯¹åº”çš„ R æ˜¯å¤šæ ·çš„ã€‚ï¼‰ã€‚tfidf predictor å¯¹åº”çš„ä»£ç å¦‚ä¸‹ï¼ˆåˆ©ç”¨scikit-learnå·¥å…·èƒ½å¤Ÿè½»æ˜“å®ç°ï¼‰ï¼š tfidfè¡¨ç¤ºè¯é¢‘ï¼ˆterm frequencyï¼‰å’Œé€†æ–‡æ¡£è¯é¢‘ï¼ˆinverse document frequencyï¼‰ï¼Œå®ƒè¡¡é‡äº†ä¸€ä¸ªè¯åœ¨ä¸€ç¯‡æ–‡æ¡£ä¸­çš„é‡è¦ç¨‹åº¦ï¼ˆåŸºäºæ•´ä¸ªè¯­æ–™åº“ï¼‰ã€‚ class TFIDFPredictor: def __init__(self): self.vectorizer = TfidfVectorizer() def train(self, data): self.vectorizer.fit(np.append(data.Context.values,data.Utterance.values)) def predict(self, context, utterances): # Convert context and utterances into tfidf vector vector_context = self.vectorizer.transform([context]) vector_doc = self.vectorizer.transform(utterances) # The dot product measures the similarity of the resulting vectors result = np.dot(vector_doc, vector_context.T).todense() result = np.asarray(result).flatten() # Sort by top results and return the indices in descending order return np.argsort(result, axis=0)[::-1]# Evaluate TFIDF predictorpred = TFIDFPredictor()pred.train(train_df)y = [pred.predict(test_df.Context[x], test_df.iloc[x,1:].values) for x in range(len(test_df))]for n in [1, 2, 5, 10]: print(&quot;Recall @ (&#123;&#125;, 10): &#123;:g&#125;&quot;.format(n, evaluate_recall(y, y_test, n))) æ¨¡å‹ç»“æœå¦‚ä¸‹ï¼š Recall @ (1, 10): 0.495032Recall @ (2, 10): 0.596882Recall @ (5, 10): 0.766121Recall @ (10, 10): 1 æ˜¾ç„¶è¿™æ¯” Random çš„æ¨¡å‹è¦å¥½å¾—å¤šï¼Œä½†è¿™è¿˜ä¸å¤Ÿã€‚ä¹‹å‰çš„å‡è®¾å¹¶ä¸å®Œç¾ï¼Œé¦–å…ˆ query å’Œ response ä¹‹é—´å¹¶ä¸ä¸€å®šè¦æ˜¯è¯­ä¹‰ä¸Šçš„ç›¸è¿‘ï¼›å…¶æ¬¡ tfidfæ¨¡å‹ å¿½ç•¥äº†è¯åºè¿™ä¸€é‡è¦çš„ä¿¡æ¯ã€‚ä½¿ç”¨ NNæ¨¡å‹ æˆ‘ä»¬èƒ½åšå¾—æ›´å¥½ä¸€äº›ã€‚ 6. LSTMå»ºç«‹çš„ NNæ¨¡å‹ ä¸ºä¸¤å±‚ Encoder çš„ LSTMæ¨¡å‹ï¼ˆDual Encoder LSTM Networkï¼‰ï¼Œè¿™ç§å½¢å¼çš„ç½‘ç»œè¢«å¹¿æ³›åº”ç”¨ chatbot ä¸­ã€‚ seq2seqæ¨¡å‹ å¸¸ç”¨äºæœºå™¨ç¿»è¯‘é¢†åŸŸï¼Œå¹¶å–å¾—äº†è¾ƒå¤§çš„æ•ˆæœã€‚ä½¿ç”¨ Dual LSTMæ¨¡å‹ çš„åŸå› åœ¨äºè¿™ä¸ªæ¨¡å‹è¢«è¯æ˜åœ¨è¿™ä¸ªæ•°æ®é›†æœ‰è¾ƒå¥½çš„æ•ˆæœï¼ˆè¯¦æƒ…è§è¿™é‡Œï¼‰, è¿™å¯ä»¥ä½œä¸ºæˆ‘ä»¬åç»­æ¨¡å‹æ•ˆæœçš„éªŒè¯ã€‚ ä¸¤å±‚ Encoder çš„ LSTMæ¨¡å‹ çš„ç»“æ„å›¾å¦‚ä¸‹ï¼ˆè®ºæ–‡æ¥æºï¼‰ï¼š å¤§è‡´æµç¨‹ï¼š (1). Query å’Œ Response éƒ½æ˜¯ç»è¿‡åˆ†è¯çš„ï¼Œåˆ†è¯åæ¯ä¸ªè¯ embedding ä¸ºå‘é‡å½¢å¼ã€‚åˆå§‹çš„è¯å‘é‡ä½¿ç”¨ GloVe / Word2vecï¼Œä¹‹åè¯å‘é‡éšç€æ¨¡å‹çš„è®­ç»ƒä¼šè¿›è¡Œ fine-tuned ã€‚ (2). åˆ†è¯ä¸”å‘é‡åŒ–çš„ Query å’Œ Response ç»è¿‡ç›¸åŒçš„ RNNï¼ˆword by wordï¼‰ã€‚RNN æœ€ç»ˆç”Ÿæˆä¸€ä¸ªå‘é‡è¡¨ç¤ºï¼Œæ•æ‰äº† Query å’Œ Response ä¹‹é—´çš„[è¯­ä¹‰è”ç³»]ï¼ˆå›¾ä¸­çš„$c$å’Œ$r$ï¼‰ï¼›è¿™ä¸ªå‘é‡çš„ç»´åº¦æ˜¯å¯ä»¥æŒ‡å®šçš„ï¼Œè¿™é‡ŒæŒ‡å®šä¸º 256ç»´ã€‚ (3). å°† å‘é‡c ä¸ä¸€ä¸ª çŸ©é˜µM ç›¸ä¹˜ï¼Œæ¥é¢„æµ‹ä¸€ä¸ªå¯èƒ½çš„ å›å¤$râ€™$ã€‚å¦‚æœ $c$ ä¸ºä¸€ä¸ª256ç»´çš„å‘é‡ï¼ŒMç»´ 256*256 çš„çŸ©é˜µï¼Œä¸¤è€…ç›¸ä¹˜çš„ç»“æœä¸ºå¦ä¸€ä¸ª256ç»´çš„å‘é‡ï¼Œæˆ‘ä»¬å¯ä»¥å°†å…¶è§£é‡Šä¸º[ä¸€ä¸ªç”Ÿæˆå¼çš„å›å¤å‘é‡]ã€‚çŸ©é˜µM æ˜¯éœ€è¦è®­ç»ƒçš„å‚æ•°ã€‚ (4). é€šè¿‡ç‚¹ä¹˜çš„æ–¹å¼æ¥é¢„æµ‹ç”Ÿæˆçš„ å›å¤$râ€™$ å’Œ å€™é€‰çš„ å›å¤$r$ ä¹‹é—´çš„ç›¸ä¼¼ç¨‹åº¦ï¼Œç‚¹ä¹˜ç»“æœè¶Šå¤§è¡¨ç¤ºå€™é€‰å›å¤ä½œä¸ºå›å¤çš„å¯ä¿¡åº¦è¶Šé«˜ï¼›ä¹‹åé€šè¿‡ sigmoid å‡½æ•°å½’ä¸€åŒ–ï¼Œè½¬æˆæ¦‚ç‡å½¢å¼ã€‚ (sigmoidä½œä¸ºå‹ç¼©å‡½æ•°ç»å¸¸ä½¿ç”¨) å›¾ä¸­æŠŠç¬¬(3)æ­¥å’Œç¬¬(4)æ­¥ç»“åˆåœ¨ä¸€èµ·äº†ã€‚ (5). æŸå¤±å‡½æ•°ï¼ˆloss functionï¼‰ã€‚è¿™é‡Œä½¿ç”¨äºŒå…ƒçš„äº¤å‰ç†µï¼ˆbinary cross-entropyï¼‰ä½œä¸ºæŸå¤±å‡½æ•°ã€‚æˆ‘ä»¬å·²çŸ¥å®ä¾‹çš„çœŸå® label $y$ï¼Œ å€¼ä¸º 0 æˆ– 1ï¼› é€šè¿‡ä¸Šé¢çš„ç¬¬(4)æ­¥å¯ä»¥å¾—åˆ°ä¸€ä¸ªæ¦‚ç‡å€¼ $yâ€™$ï¼›å› æ­¤ï¼Œäº¤å‰ç†µæŸå¤±å€¼ä¸º $L = -y * ln(yâ€™) - (1 - y) * ln(1 - yâ€™)$ã€‚ è¿™ä¸ªå…¬å¼æ„ä¹‰æ˜¯ç›´è§‚çš„ï¼Œå³å½“ $y=1$ æ—¶ï¼Œ$L = -ln(yâ€™)$ï¼ŒæœŸæœ› $yâ€™$ å°½é‡æ¥è¿‘ 1 ä½¿å¾—æŸå¤±å‡½æ•°çš„å€¼è¶Šå°ï¼›åä¹‹äº¦ç„¶ã€‚ å®ç°è¿‡ç¨‹ä¸­ä½¿ç”¨äº† numpyã€pandasã€TensorFlow å’Œ TF Learn ç­‰å·¥å…·ã€‚ 6.1. æ•°æ®é¢„å¤„ç†æ•°æ®é›†çš„åŸå§‹æ ¼å¼ä¸ºcsvæ ¼å¼ï¼Œæˆ‘ä»¬éœ€è¦å…ˆå°†å…¶è½¬ä¸º TensorFlow ä¸“æœ‰çš„æ ¼å¼ï¼Œè¿™ç§æ ¼å¼çš„å¥½å¤„åœ¨äºèƒ½å¤Ÿç›´æ¥ä»è¾“å…¥æ–‡ä»¶ä¸­ load tensorsï¼Œå¹¶è®© TensorFlow æ¥å¤„ç†æ´—ç‰Œ(shuffling)ã€æ‰¹é‡(batching) å’Œ é˜Ÿåˆ—åŒ–(queuing) ç­‰æ“ä½œã€‚é¢„å¤„ç†ä¸­è¿˜åŒ…æ‹¬åˆ›å»ºä¸€ä¸ªå­—å…¸åº“ï¼Œå°†è¯è¿›è¡Œæ ‡å·ï¼ŒTFRecord æ–‡ä»¶å°†ç›´æ¥å­˜å‚¨è¿™äº›è¯çš„æ ‡å·ã€‚ æ¯ä¸ªå®ä¾‹åŒ…æ‹¬å¦‚ä¸‹å‡ ä¸ªå­—æ®µï¼š Queryï¼šè¡¨ç¤ºä¸ºä¸€ä¸²è¯æ ‡å·çš„åºåˆ—ï¼Œå¦‚ [231, 2190, 737, 0, 912]ï¼› Query çš„é•¿åº¦ï¼› Responseï¼šåŒæ ·æ˜¯ä¸€ä¸²è¯æ ‡å·çš„åºåˆ—ï¼› Response çš„é•¿åº¦ï¼› Labelï¼› Distractor_[N]ï¼šè¡¨ç¤ºè´Ÿä¾‹å¹²æ‰°æ•°æ®ï¼Œä»…åœ¨éªŒè¯é›†å’Œæµ‹è¯•é›†ä¸­æœ‰ï¼ŒN çš„å–å€¼ä¸º 0-8ï¼› Distractor_[N]çš„é•¿åº¦ï¼› æ•°æ®é¢„å¤„ç†çš„ Pythonè„šæœ¬ï¼Œç”Ÿæˆäº†3ä¸ªæ–‡ä»¶ï¼štrain.tfrecords, validation.tfrecords å’Œ test.tfrecordsã€‚ä½ å¯ä»¥å°è¯•è‡ªå·±è¿è¡Œç¨‹åºï¼Œæˆ–è€…ç›´æ¥ä¸‹è½½å’Œä½¿ç”¨é¢„å¤„ç†åçš„æ•°æ®ã€‚ 6.2. åˆ›å»ºè¾“å…¥å‡½æ•°ä¸ºäº†ä½¿ç”¨ TensoFlowå†…ç½® çš„è®­ç»ƒå’Œè¯„æµ‹æ¨¡å—ï¼Œæˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ªè¾“å…¥å‡½æ•°ï¼šè¿™ä¸ªå‡½æ•°è¿”å›è¾“å…¥æ•°æ®çš„ batchã€‚ å› ä¸ºè®­ç»ƒæ•°æ®å’Œæµ‹è¯•æ•°æ®çš„æ ¼å¼ä¸åŒï¼Œæˆ‘ä»¬éœ€è¦åˆ›å»ºä¸åŒçš„è¾“å…¥å‡½æ•°ã€‚ è¾“å…¥å‡½æ•°éœ€è¦è¿”å›æ‰¹é‡(batch)çš„ç‰¹å¾å’Œæ ‡ç­¾å€¼(å¦‚æœæœ‰çš„è¯)ã€‚ç±»ä¼¼äºå¦‚ä¸‹ï¼š def input_fn(): # TODO Load and preprocess data here return batched_features, labels å› ä¸ºæˆ‘ä»¬éœ€è¦åœ¨æ¨¡å‹è®­ç»ƒå’Œè¯„æµ‹è¿‡ç¨‹ä¸­ä½¿ç”¨ä¸åŒçš„è¾“å…¥å‡½æ•°ï¼Œä¸ºäº†é˜²æ­¢é‡å¤ä¹¦å†™ä»£ç ï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªåŒ…è£…å™¨(wrapper)ï¼Œåç§°ä¸ºcreate_input_fnï¼Œé’ˆå¯¹ä¸åŒçš„modeä½¿ç”¨ç›¸åº”çš„codeï¼Œå¦‚ä¸‹ï¼š def create_input_fn(mode, input_files, batch_size, num_epochs=None): def input_fn(): # TODO Load and preprocess data here return batched_features, labels return input_fn å®Œæ•´çš„codeè§udc_inputs.pyã€‚æ•´ä½“ä¸Šï¼Œè¿™ä¸ªå‡½æ•°åšäº†å¦‚ä¸‹çš„äº‹æƒ…ï¼š (1) å®šä¹‰äº†ç¤ºä¾‹æ–‡ä»¶ä¸­çš„ featureå­—æ®µï¼›(2) ä½¿ç”¨ tf.TFRecordReader æ¥è¯»å– input_files ä¸­çš„æ•°æ®ï¼›(3) æ ¹æ® featureå­—æ®µ çš„å®šä¹‰å¯¹æ•°æ®è¿›è¡Œè§£æï¼›(4) æå–è®­ç»ƒæ•°æ®çš„æ ‡ç­¾ labelï¼›(5) äº§ç”Ÿæ‰¹é‡åŒ–çš„è®­ç»ƒæ•°æ® batch train_datasetsï¼›(6) è¿”å›æ‰¹é‡çš„ç‰¹å¾æ•°æ®åŠå¯¹åº”æ ‡ç­¾ labelï¼› 6.3. å®šä¹‰è¯„æµ‹æŒ‡æ ‡ä¹‹å‰å·²ç»æåˆ°ç”¨ recall@k è¿™ä¸ªæŒ‡æ ‡æ¥è¯„æµ‹æ¨¡å‹ï¼ŒTensorFlow ä¸­å·²ç»å®ç°äº†è®¸å¤šæ ‡å‡†æŒ‡æ ‡ï¼ˆåŒ…æ‹¬ recall@kï¼‰ã€‚ä¸ºäº†ä½¿ç”¨è¿™äº›æŒ‡æ ‡ï¼Œéœ€è¦åˆ›å»ºä¸€ä¸ªå­—å…¸ï¼Œkey ä¸ºæŒ‡æ ‡åç§°ï¼Œvalue ä¸ºå¯¹åº”çš„è®¡ç®—å‡½æ•°ã€‚å¦‚ä¸‹ def create_evaluation_metrics(): eval_metrics = &#123;&#125; for k in [1, 2, 5, 10]: eval_metrics[&quot;recall_at_%d&quot; % k] = functools.partial( tf.contrib.metrics.streaming_sparse_recall_at_k, k=k ) return eval_metrics å¦‚ä¸Šï¼Œæˆ‘ä»¬ä½¿ç”¨äº† functools.partial å‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°çš„è¾“å…¥å‚æ•°æœ‰ä¸¤ä¸ªã€‚ä¸è¦è¢« streaming_sparse_recall_at_k æ‰€å›°æƒ‘ï¼Œå…¶ä¸­çš„ streaming çš„å«ä¹‰æ˜¯è¡¨ç¤ºæŒ‡æ ‡çš„è®¡ç®—æ˜¯å¢é‡å¼çš„ã€‚ è®­ç»ƒå’Œæµ‹è¯•æ‰€ä½¿ç”¨çš„è¯„æµ‹æ–¹å¼æ˜¯ä¸ä¸€æ ·çš„ï¼Œè®­ç»ƒè¿‡ç¨‹ä¸­æˆ‘ä»¬å¯¹ æ¯ä¸ªcase å¯èƒ½ä½œä¸ºæ­£ç¡®å›å¤çš„æ¦‚ç‡è¿›è¡Œé¢„æµ‹ï¼Œè€Œæµ‹è¯•è¿‡ç¨‹ä¸­æˆ‘ä»¬å¯¹æ¯ç»„æ•°æ®ï¼ˆåŒ…å«10ä¸ªcaseï¼Œå…¶ä¸­1ä¸ªæ˜¯æ­£ç¡®çš„ï¼Œå¦å¤–9ä¸ªæ˜¯ç”Ÿæˆçš„è´Ÿä¾‹/å™ªéŸ³æ•°æ®ï¼‰ä¸­çš„caseè¿›è¡Œé€æ¡æ¦‚ç‡é¢„æµ‹ï¼Œå¾—åˆ°ä¾‹å¦‚ [0.34, 0.11, 0.22, 0.45, 0.01, 0.02, 0.03, 0.08, 0.33, 0.11] è¿™æ ·æ ¼å¼çš„è¾“å‡ºï¼Œè¿™äº›è¾“å‡ºå€¼çš„å’Œå¹¶ä¸è¦æ±‚ä¸º 1ï¼ˆå› ä¸ºæ˜¯é€æ¡é¢„æµ‹çš„ï¼Œæœ‰å•ç‹¬çš„é¢„æµ‹æ¦‚ç‡å€¼ï¼Œåœ¨ 0 åˆ° 1 ä¹‹é—´ï¼‰ï¼› è€Œå¯¹äºè¿™ç»„æ•°æ®è€Œè¨€ï¼Œå› ä¸ºæ•°æ® index=0 å¯¹åº”çš„ä¸ºæ­£ç¡®ç­”æ¡ˆï¼Œè¿™é‡Œ recall@1 ä¸º 0ï¼Œå› ä¸º 0.34 æ˜¯å…¶ä¸­ç¬¬äºŒå¤§çš„å€¼ï¼Œæ‰€ä»¥ recall@2 æ˜¯ 1ï¼ˆè¡¨ç¤ºè¿™ç»„æ•°æ®ä¸­é¢„æµ‹æ¦‚ç‡å€¼åœ¨å‰äºŒçš„ä¸­æœ‰ä¸€ä¸ªæ˜¯æ­£ç¡®çš„ï¼‰ã€‚ 6.4. è®­ç»ƒç¨‹åºæ ·ä¾‹é¦–å…ˆï¼Œç»™ä¸€ä¸ªæ¨¡å‹è®­ç»ƒå’Œæµ‹è¯•çš„ç¨‹åºæ ·ä¾‹ï¼Œè¿™ä¹‹åä½ å¯ä»¥å‚ç…§ç¨‹åºä¸­æ‰€ç”¨åˆ°çš„æ ‡å‡†å‡½æ•°ï¼Œæ¥å¿«é€Ÿåˆ‡æ¢å’Œä½¿ç”¨å…¶ä»–çš„ç½‘ç»œæ¨¡å‹ã€‚å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªå‡½æ•° model_fnï¼Œå‡½æ•°çš„è¾“å…¥å‚æ•°æœ‰ batched featuresï¼Œlabel å’Œ mode(train/evaluation)ï¼Œå‡½æ•°çš„è¾“å‡ºä¸ºé¢„æµ‹å€¼ã€‚ç¨‹åºæ ·ä¾‹å¦‚ä¸‹ï¼š estimator = tf.contrib.learn.Estimator( model_fn=model_fn, model_dir=MODEL_DIR, config=tf.contrib.learn.RunConfig())input_fn_train = udc_inputs.create_input_fn( mode=tf.contrib.learn.ModeKeys.TRAIN, input_files=[TRAIN_FILE], batch_size=hparams.batch_size)input_fn_eval = udc_inputs.create_input_fn( mode=tf.contrib.learn.ModeKeys.EVAL, input_files=[VALIDATION_FILE], batch_size=hparams.eval_batch_size, num_epochs=1)eval_metrics = udc_metrics.create_evaluation_metrics()# We need to subclass theis manually for now. The next TF version will# have support ValidationMonitors with metrics built-in.# It&#x27;s already on the master branch.class EvaluationMonitor(tf.contrib.learn.monitors.EveryN): def every_n_step_end(self, step, outputs): self._estimator.evaluate( input_fn=input_fn_eval, metrics=eval_metrics, steps=None)eval_monitor = EvaluationMonitor(every_n_steps=FLAGS.eval_every)estimator.fit(input_fn=input_fn_train, steps=None, monitors=[eval_monitor]) è¿™é‡Œåˆ›å»ºäº†ä¸€ä¸ª model_fn çš„ estimator(è¯„ä¼°å‡½æ•°)ï¼› ä¸¤ä¸ªè¾“å…¥å‡½æ•°ï¼Œinput_fn_train å’Œ input_fn_evalï¼Œä»¥åŠè®¡ç®—è¯„æµ‹æŒ‡æ ‡çš„å‡½æ•°ï¼› å®Œæ•´çš„codeè§udc_train.pyã€‚ 6.5. åˆ›å»ºæ¨¡å‹åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬åˆ›å»ºäº†æ¨¡å‹çš„ è¾“å…¥ã€è§£æã€è¯„æµ‹å’Œè®­ç»ƒ çš„æ ·ä¾‹ç¨‹åºã€‚ç°åœ¨æˆ‘ä»¬æ¥å†™ LSTM çš„ç¨‹åºï¼Œcreate_model_fnå‡½æ•° ç”¨ä»¥å¤„ç†ä¸åŒæ ¼å¼çš„è®­ç»ƒå’Œæµ‹è¯•æ•°æ®ï¼›å®ƒçš„è¾“å…¥å‚æ•°ä¸º model_implï¼Œè¿™ä¸ªå‡½æ•°è¡¨ç¤ºå®é™…ä½œå‡ºé¢„æµ‹çš„æ¨¡å‹ï¼Œè¿™é‡Œå°±æ˜¯ç”¨çš„LSTMï¼Œå½“ç„¶ä½ å¯ä»¥æ›¿æ¢æˆä»»æ„çš„å…¶ä»–æ¨¡å‹ã€‚ç¨‹åºå¦‚ä¸‹ï¼š def dual_encoder_model( hparams, mode, context, context_len, utterance, utterance_len, targets): # Initialize embedidngs randomly or with pre-trained vectors if available embeddings_W = get_embeddings(hparams) # Embed the context and the utterance context_embedded = tf.nn.embedding_lookup( embeddings_W, context, name=&quot;embed_context&quot;) utterance_embedded = tf.nn.embedding_lookup( embeddings_W, utterance, name=&quot;embed_utterance&quot;) # Build the RNN with tf.variable_scope(&quot;rnn&quot;) as vs: # We use an LSTM Cell cell = tf.nn.rnn_cell.LSTMCell( hparams.rnn_dim, forget_bias=2.0, use_peepholes=True, state_is_tuple=True) # Run the utterance and context through the RNN rnn_outputs, rnn_states = tf.nn.dynamic_rnn( cell, tf.concat(0, [context_embedded, utterance_embedded]), sequence_length=tf.concat(0, [context_len, utterance_len]), dtype=tf.float32) encoding_context, encoding_utterance = tf.split(0, 2, rnn_states.h) with tf.variable_scope(&quot;prediction&quot;) as vs: M = tf.get_variable(&quot;M&quot;, shape=[hparams.rnn_dim, hparams.rnn_dim], initializer=tf.truncated_normal_initializer()) # &quot;Predict&quot; a response: c * M generated_response = tf.matmul(encoding_context, M) generated_response = tf.expand_dims(generated_response, 2) encoding_utterance = tf.expand_dims(encoding_utterance, 2) # Dot product between generated response and actual response # (c * M) * r logits = tf.batch_matmul(generated_response, encoding_utterance, True) logits = tf.squeeze(logits, [2]) # Apply sigmoid to convert logits to probabilities probs = tf.sigmoid(logits) # Calculate the binary cross-entropy loss losses = tf.nn.sigmoid_cross_entropy_with_logits(logits, tf.to_float(targets)) # Mean loss across the batch of examples mean_loss = tf.reduce_mean(losses, name=&quot;mean_loss&quot;) return probs, mean_loss å®Œæ•´çš„ç¨‹åºè§ dual_encoder.pyã€‚åŸºäºè¿™ä¸ªï¼Œæˆ‘ä»¬èƒ½å¤Ÿå®ä¾‹åŒ– modelå‡½æ•° åœ¨æˆ‘ä»¬ä¹‹å‰å®šä¹‰çš„ udc_train.pyï¼Œå¦‚ä¸‹ï¼š model_fn = udc_model.create_model_fn( hparams=hparams, model_impl=dual_encoder_model) è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥ç›´æ¥è¿è¡Œ udc_train.pyæ–‡ä»¶ï¼Œæ¥å¼€å§‹æ¨¡å‹çš„è®­ç»ƒå’Œè¯„æµ‹äº†ï¼Œä½ å¯ä»¥è®¾å®šâ€”eval_everyå‚æ•° æ¥æ§åˆ¶æ¨¡å‹åœ¨éªŒè¯é›†ä¸Šçš„è¯„æµ‹é¢‘ç‡ã€‚æ›´å¤šçš„å‘½ä»¤è¡Œå‚æ•°ä¿¡æ¯å¯è§ tf.flags å’Œ hparamsï¼Œä½ ä¹Ÿå¯ä»¥è¿è¡Œ python udc_train.py â€”help æ¥æŸ¥çœ‹ã€‚ è¿è¡Œç¨‹åºçš„æ•ˆæœå¦‚ä¸‹ï¼š INFO:tensorflow:training step 20200, loss = 0.36895 (0.330 sec/batch).INFO:tensorflow:Step 20201: mean_loss:0 = 0.385877INFO:tensorflow:training step 20300, loss = 0.25251 (0.338 sec/batch).INFO:tensorflow:Step 20301: mean_loss:0 = 0.405653...INFO:tensorflow:Results after 270 steps (0.248 sec/batch): recall_at_1 = 0.507581018519, recall_at_2 = 0.689699074074, recall_at_5 = 0.913020833333, recall_at_10 = 1.0, loss = 0.5383... 6.6. æ¨¡å‹çš„è¯„æµ‹åœ¨è®­ç»ƒå®Œæ¨¡å‹åï¼Œä½ å¯ä»¥å°†å…¶åº”ç”¨åœ¨ æµ‹è¯•é›† ä¸Šï¼Œä½¿ç”¨ï¼š python udc_test.py --model_dir=$MODEL_DIR_FROM_TRAINING ä¾‹å¦‚ï¼š python udc_test.py --model_dir=~/github/chatbot-retrieval/runs/1467389151 è¿™å°†å¾—åˆ°æ¨¡å‹åœ¨ æµ‹è¯•é›† ä¸Šçš„ recall@k çš„ç»“æœï¼Œæ³¨æ„åœ¨ä½¿ç”¨ udc_test.pyæ–‡ä»¶ æ—¶ï¼Œéœ€è¦ä½¿ç”¨ä¸è®­ç»ƒæ—¶ç›¸åŒçš„å‚æ•°ã€‚ åœ¨è®­ç»ƒæ¨¡å‹çš„æ¬¡æ•°å¤§çº¦ 2w æ¬¡æ—¶(åœ¨GPUä¸Šå¤§çº¦èŠ±è´¹1å°æ—¶)ï¼Œæ¨¡å‹åœ¨æµ‹è¯•é›†ä¸Šå¾—åˆ°å¦‚ä¸‹çš„ç»“æœï¼š recall_at_1 = 0.507581018519recall_at_2 = 0.689699074074recall_at_5 = 0.913020833333 å…¶ä¸­ï¼Œrecall@1çš„å€¼ä¸tfidfæ¨¡å‹çš„å·®ä¸å¤šï¼Œä½†æ˜¯recall@2å’Œrecall@5çš„å€¼åˆ™æ¯”tfidfæ¨¡å‹çš„ç»“æœå¥½å¤ªå¤šã€‚åŸè®ºæ–‡ä¸­çš„ç»“æœä¾æ¬¡æ˜¯0.55,0.72å’Œ0.92ï¼Œå¯èƒ½é€šè¿‡æ¨¡å‹è°ƒå‚æˆ–è€…é¢„å¤„ç†èƒ½å¤Ÿè¾¾åˆ°è¿™ä¸ªç»“æœã€‚ 6.7. ä½¿ç”¨æ¨¡å‹è¿›è¡Œé¢„æµ‹å¯¹äºæ–°çš„æ•°æ®ï¼Œä½ å¯ä»¥ä½¿ç”¨ udc_predict.py æ¥è¿›è¡Œé¢„æµ‹ï¼›ä¾‹å¦‚ï¼š python udc_predict.py --model_dir=./runs/1467576365/ ç»“æœå¦‚ä¸‹ï¼š Context: Example contextResponse 1: 0.44806Response 2: 0.481638 ä½ å¯ä»¥ä»å€™é€‰çš„å›å¤ä¸­ï¼Œé€‰æ‹©é¢„æµ‹åˆ†å€¼æœ€é«˜çš„é‚£ä¸ªä½œä¸ºå›å¤ã€‚ 6.8. æ€»ç»“è¿™ç¯‡åšæ–‡ä¸­ï¼Œæˆ‘ä»¬å®ç°äº†ä¸€ä¸ªåŸºäºæ£€ç´¢çš„ NNæ¨¡å‹ï¼Œå®ƒèƒ½å¤Ÿå¯¹å€™é€‰çš„å›å¤è¿›è¡Œé¢„æµ‹å’Œæ‰“åˆ†ï¼Œé€šè¿‡è¾“å‡ºåˆ†å€¼æœ€é«˜ï¼ˆæˆ–è€…æ»¡è¶³ä¸€å®šé˜ˆå€¼ï¼‰çš„å€™é€‰å›å¤å·²å®ŒæˆèŠå¤©çš„è¿‡ç¨‹ã€‚åç»­å¯ä»¥å°è¯•å…¶ä»–æ›´å¥½çš„æ¨¡å‹ï¼Œæˆ–è€…é€šè¿‡è°ƒå‚æ¥å–å¾—æ›´å¥½çš„å®éªŒç»“æœã€‚ Reference About ChatterBot 2016 Google Brain deep-learning-for-chatbots-part-1-introduction, wildml blog 2016 Google Brain deep-learning-for-chatbots-2-retrieval-based-model-tensorflow, wildml blog èŠå¤©æœºå™¨äººä¸­çš„æ·±åº¦å­¦ä¹ æŠ€æœ¯ä¹‹äºŒï¼šåŸºäºæ£€ç´¢æ¨¡å‹çš„å®ç° èŠå¤©æœºå™¨äººä¸­çš„æ·±åº¦å­¦ä¹ æŠ€æœ¯ä¹‹ä¸€ï¼šå¯¼è¯» Tensorflowæä¸€ä¸ªèŠå¤©æœºå™¨äºº Ericï¼ŒåŸºäºå¤šæœç´¢å¼•æ“çš„è‡ªåŠ¨é—®ç­”æœºå™¨äºº æµ‹è¯•äººæœºé—®ç­”ç³»ç»Ÿæ™ºèƒ½æ€§çš„3760ä¸ªé—®é¢˜ ä¸­å›½ç‰ˆçš„èŠå¤©æœºå™¨äººåœ°å›¾ Chatbots Landscape æ¡ä»¶éšæœºåœºç®€ä»‹ çŸ¥è¯†å›¾è°±å­¦ä¹ ç³»åˆ—ä¹‹äºŒï¼šå‘½åå®ä½“è¯†åˆ«1ï¼ˆæŠ€æœ¯åŠä»£ç ï¼‰","categories":[{"name":"chatbot","slug":"chatbot","permalink":"http://iequa.com/categories/chatbot/"}],"tags":[{"name":"Chatbot","slug":"Chatbot","permalink":"http://iequa.com/tags/Chatbot/"}]},{"title":"Chatbot Research 4 - æ·±åº¦å­¦ä¹ çŸ¥è¯†å›é¡¾","slug":"chatbot/chatbot-research4","date":"2018-08-14T06:00:21.000Z","updated":"2020-10-23T02:03:18.013Z","comments":true,"path":"2018/08/14/chatbot/chatbot-research4/","link":"","permalink":"http://iequa.com/2018/08/14/chatbot/chatbot-research4/","excerpt":"è¯¥ç¯‡ä¸»è¦ä»‹ç»ä¸€äº› RNNã€LSTM ç­‰æ·±åº¦å­¦ä¹ çŸ¥è¯†ã€‚ è¯¦æƒ…è¯·æˆ³","text":"è¯¥ç¯‡ä¸»è¦ä»‹ç»ä¸€äº› RNNã€LSTM ç­‰æ·±åº¦å­¦ä¹ çŸ¥è¯†ã€‚ è¯¦æƒ…è¯·æˆ³ Reference 2015 DeepQA","categories":[{"name":"chatbot","slug":"chatbot","permalink":"http://iequa.com/categories/chatbot/"}],"tags":[{"name":"Chatbot","slug":"Chatbot","permalink":"http://iequa.com/tags/Chatbot/"}]},{"title":"Sequence Models (week3) - Attention mechanism","slug":"deeplearning/Sequence-Models-week3","date":"2018-08-14T02:00:21.000Z","updated":"2019-10-20T04:30:35.017Z","comments":true,"path":"2018/08/14/deeplearning/Sequence-Models-week3/","link":"","permalink":"http://iequa.com/2018/08/14/deeplearning/Sequence-Models-week3/","excerpt":"èƒ½å¤Ÿå°†åºåˆ—æ¨¡å‹åº”ç”¨åˆ°è‡ªç„¶è¯­è¨€é—®é¢˜ã€éŸ³é¢‘åº”ç”¨ ç­‰ï¼ŒåŒ…æ‹¬æ–‡å­—åˆæˆã€è¯­éŸ³è¯†åˆ«å’ŒéŸ³ä¹åˆæˆã€‚","text":"èƒ½å¤Ÿå°†åºåˆ—æ¨¡å‹åº”ç”¨åˆ°è‡ªç„¶è¯­è¨€é—®é¢˜ã€éŸ³é¢‘åº”ç”¨ ç­‰ï¼ŒåŒ…æ‹¬æ–‡å­—åˆæˆã€è¯­éŸ³è¯†åˆ«å’ŒéŸ³ä¹åˆæˆã€‚ 1. Basic modelså‡è®¾éœ€è¦ç¿»è¯‘ä¸‹é¢è¿™å¥è¯ â€œç®€å°†è¦åœ¨ 9 æœˆè®¿é—®ä¸­å›½â€ æˆ‘ä»¬å¸Œæœ›å¾—åˆ°çš„ç»“æœæ˜¯ â€œJane is visiting China in Septemberâ€ åœ¨è¿™ä¸ªä¾‹å­ä¸­è¾“å…¥çš„æ•°é‡æ˜¯ 10 ä¸ªä¸­æ–‡æ±‰å­—ï¼Œè¾“å‡ºä¸º 6 ä¸ªå•è¯ï¼Œ $T_x$ ä¸ $T_y$ æ•°é‡ä¸ä¸€è‡´ï¼Œå°±éœ€è¦ç”¨åˆ° Sequence to sequence model RNN ç±»ä¼¼çš„ä¾‹å­è¿˜æœ‰ç”¨æœºå™¨ä¸ºä¸‹é¢è¿™å¼ å›¾ç‰‡ç”Ÿæˆæè¿° åªéœ€è¦å°† encoder éƒ¨åˆ†ç”¨ä¸€ä¸ª CNNæ¨¡å‹ æ›¿æ¢å°±å¯ä»¥äº†ï¼Œæ¯”å¦‚ AlexNetï¼Œå°±å¯ä»¥å¾—åˆ°â€œä¸€åªï¼ˆå¯çˆ±çš„ï¼‰çŒ«èººåœ¨æ¥¼æ¢¯ä¸Šâ€ 2. Picking the most likely sentenceä¸‹é¢å°†ä¹‹å‰å­¦ä¹ çš„è¯­è¨€æ¨¡å‹å’Œæœºå™¨ç¿»è¯‘æ¨¡å‹åšä¸€ä¸ªå¯¹æ¯”, P ä¸ºæ¦‚ç‡ è¯­è¨€æ¨¡å‹: æœºå™¨ç¿»è¯‘æ¨¡å‹: å¯ä»¥çœ‹åˆ°ï¼Œæœºå™¨ç¿»è¯‘æ¨¡å‹çš„ååŠéƒ¨åˆ†å…¶å®å°±æ˜¯è¯­è¨€æ¨¡å‹ï¼ŒAndrew å°†å…¶ç§°ä¹‹ä¸º â€œæ¡ä»¶è¯­è¨€æ¨¡å‹â€ï¼Œåœ¨è¯­è¨€æ¨¡å‹ä¹‹å‰æœ‰ä¸€ ä¸ªæ¡ä»¶ä¹Ÿå°±æ˜¯è¢«ç¿»è¯‘çš„å¥å­: P(y^{},â€¦,y^{}|x^{},â€¦,x^{}) ä½†æ˜¯æˆ‘ä»¬çŸ¥é“ç¿»è¯‘æ˜¯æœ‰å¾ˆå¤šç§æ–¹å¼çš„ï¼ŒåŒä¸€å¥è¯å¯ä»¥ç¿»è¯‘æˆå¾ˆå¤šä¸åŒçš„å¥å­ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¦‚ä½•åˆ¤æ–­å“ªä¸€ä¸ªå¥å­æ˜¯æœ€å¥½çš„å‘¢ï¼Ÿ è¿˜æ˜¯ç¿»è¯‘ä¸Šé¢é‚£å¥è¯ï¼Œæœ‰å¦‚ä¸‹å‡ ç§ç¿»è¯‘ç»“æœï¼š â€œJane is visiting China in September.â€ â€œJane is going to visit China in September.â€ â€œIn September, Jane will visit Chinaâ€ â€œJaneâ€™s Chinese friend welcomed her in September.â€ â€¦. ä¸è¯­è¨€æ¨¡å‹ä¸åŒçš„æ˜¯ï¼Œæœºå™¨æ¨¡å‹åœ¨è¾“å‡ºéƒ¨åˆ†ä¸å†ä½¿ç”¨ softmax éšæœºåˆ†å¸ƒçš„å½¢å¼è¿›è¡Œå–æ ·ï¼Œå› ä¸ºå¾ˆå®¹æ˜“å¾—åˆ°ä¸€ä¸ªä¸å‡†ç¡®çš„ç¿»è¯‘ï¼Œå–è€Œä»£ä¹‹çš„æ˜¯ä½¿ç”¨ Beam Search åšæœ€ä¼˜åŒ–çš„é€‰æ‹©ã€‚è¿™ä¸ªæ–¹æ³•ä¼šåœ¨åä¸‹ä¸€å°èŠ‚ä»‹ç»ï¼Œåœ¨æ­¤ä¹‹å‰å…ˆä»‹ç»ä¸€ä¸‹è´ªå©ªæœç´¢(Greedy Search)åŠå…¶å¼Šç«¯ï¼Œè¿™æ ·æ‰èƒ½æ›´å¥½åœ°äº†è§£ Beam Search çš„ä¼˜ç‚¹ã€‚ 2.1 Greedy Searchå¾—åˆ°æœ€å¥½çš„ç¿»è¯‘ç»“æœï¼Œè½¬æ¢æˆæ•°å­¦å…¬å¼å°±æ˜¯: argmax P(y^{},â€¦,y^{}|x^{},â€¦,x^{})é‚£ä¹ˆ Greedy Search æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ é€šä¿—è§£é‡Šå°±æ˜¯æ¯æ¬¡è¾“å‡ºçš„é‚£ä¸ªéƒ½å¿…é¡»æ˜¯æœ€å¥½çš„ã€‚è¿˜æ˜¯ä»¥ç¿»è¯‘é‚£å¥è¯ä¸ºä¾‹ã€‚ ç°åœ¨å‡è®¾é€šè¿‡è´ªå©ªæœç´¢å·²ç»ç¡®å®šæœ€å¥½çš„ç¿»è¯‘çš„å‰ä¸¤ä¸ªå•è¯æ˜¯ï¼šâ€Jane is â€œ ç„¶åå› ä¸º â€œgoingâ€ è¿™ä¸ªå•è¯å‡ºç°é¢‘ç‡è¾ƒé«˜å’Œå…¶å®ƒåŸå› ï¼Œæ‰€ä»¥æ ¹æ®è´ªå©ªç®—æ³•å¾—å‡ºæ­¤æ—¶ç¬¬ä¸‰ä¸ªå•è¯çš„æœ€å¥½ç»“æœæ˜¯ â€œgoingâ€ã€‚ æ‰€ä»¥æ®è´ªå©ªç®—æ³•æœ€åçš„ç¿»è¯‘ç»“æœå¯èƒ½æ˜¯ä¸‹å›¾ä¸­çš„ç¬¬äºŒä¸ªå¥å­ï¼Œä½†ç¬¬ä¸€å¥å¯èƒ½ä¼šæ›´å¥½(ä¸æœæ°”çš„è¯ï¼Œæˆ‘ä»¬å°±å‡è®¾ç¬¬ä¸€å¥æ›´å¥½). æ‰€ä»¥è´ªå©ªæœç´¢çš„ç¼ºç‚¹æ˜¯å±€éƒ¨æœ€ä¼˜å¹¶ä¸ä»£è¡¨å…¨å±€æœ€ä¼˜ï¼Œå°±å¥½åƒäº”é»‘ï¼Œä¸€é˜Ÿéƒ½æ˜¯å¾ˆç‰›é€¼çš„ï¼Œä½†æ˜¯å„ä¸ªéƒ½å¤ªä¼˜ç§€ï¼Œå°±æ˜¾å¾—æ²¡é‚£ä¹ˆä¼˜ç§€äº†ï¼Œè€Œå¦ä¸€é˜Ÿè™½ç„¶è¯´ä¸æ˜¯æ¯ä¸ªéƒ½æ˜¯æœ€ä¼˜ç§€ï¼Œä½†æ˜¯å‡‘åœ¨ä¸€èµ·å°±æ˜¯èƒ½ carry å…¨åœºã€‚ æ›´å½¢è±¡çš„ç†è§£å¯èƒ½å°±æ˜¯ Greedy Search æ›´åŠ çŸ­è§†ï¼Œçœ‹çš„ä¸é•¿è¿œï¼Œè€Œä¸”ä¹Ÿæ›´åŠ è€—æ—¶ã€‚å‡è®¾å­—å…¸ä¸­å…±æœ‰ 10000 ä¸ªå•è¯ï¼Œå¦‚æœä½¿ç”¨ Greedy Searchï¼Œé‚£ä¹ˆå¯èƒ½çš„ç»„åˆæœ‰ 1000010 ç§ï¼Œæ‰€ä»¥è¿˜æ˜¯æŒºææ€–çš„ 2333~~ 3. Beam SearchBeam Search æ˜¯ greedy search çš„åŠ å¼ºç‰ˆæœ¬ï¼Œé¦–å…ˆè¦é¢„è®¾ä¸€ä¸ªå€¼ beam widthï¼Œè¿™é‡Œç­‰äº 3 (å¦‚æœç­‰äº 1 å°±æ˜¯ greedy search)ã€‚ç„¶ååœ¨æ¯ä¸€æ­¥ä¿å­˜æœ€ä½³çš„ 3 ä¸ªç»“æœè¿›è¡Œä¸‹ä¸€æ­¥çš„é€‰æ‹©ï¼Œä»¥æ­¤ç›´åˆ°é‡åˆ°å¥å­çš„ç»ˆç»“ç¬¦. 3.1 æ­¥éª¤ä¸€å¦‚ä¸‹å›¾ç¤ºï¼Œå› ä¸ºbeam width=3ï¼Œæ‰€ä»¥æ ¹æ®è¾“å…¥çš„éœ€è¦ç¿»è¯‘çš„å¥å­é€‰å‡º 3 ä¸ª $y^{}$æœ€å¯èƒ½çš„è¾“å‡ºå€¼ï¼Œå³é€‰å‡º$P(y^{}|x)$æœ€å¤§çš„å‰3ä¸ªå€¼ã€‚å‡è®¾åˆ†åˆ«æ˜¯â€inâ€,â€janeâ€,â€septemberâ€ 3.2 æ­¥éª¤äºŒä»¥â€inâ€œä¸ºä¾‹è¿›è¡Œè¯´æ˜ï¼Œå…¶ä»–åŒç†. å¦‚ä¸‹å›¾ç¤ºï¼Œåœ¨ç»™å®šè¢«ç¿»è¯‘å¥å­ $x$ å’Œç¡®å®š $y^{}$ = â€œinâ€œ çš„æ¡ä»¶ä¸‹ï¼Œä¸‹ä¸€ä¸ªè¾“å‡ºå€¼çš„æ¡ä»¶æ¦‚ç‡æ˜¯ $P(y^{}|x,â€inâ€)$ã€‚æ­¤æ—¶éœ€è¦ä» 10000 ç§å¯èƒ½ä¸­æ‰¾å‡ºæ¡ä»¶æ¦‚ç‡æœ€é«˜çš„å‰ 3 ä¸ª. åˆç”±å…¬å¼ $P(y^{},y^{}|x)=P(y^{}|x) P(y^{}|x, y^{})$, æˆ‘ä»¬æ­¤æ—¶å·²ç»å¾—åˆ°äº†ç»™å®šè¾“å…¥æ•°æ®ï¼Œå‰ä¸¤ä¸ªè¾“å‡ºå€¼çš„è¾“å‡ºæ¦‚ç‡æ¯”è¾ƒå¤§çš„ç»„åˆäº†. å¦å¤– 2 ä¸ªå•è¯ä¹ŸåšåŒæ ·çš„è®¡ç®— æ­¤æ—¶æˆ‘ä»¬å¾—åˆ°äº† 9 ç»„ $P(y^{},y^{}|x)$, æ­¤æ—¶æˆ‘ä»¬å†ä»è¿™ 9ç»„ ä¸­é€‰å‡ºæ¦‚ç‡å€¼æœ€é«˜çš„å‰ 3 ä¸ªã€‚å¦‚ä¸‹å›¾ç¤ºï¼Œå‡è®¾æ˜¯è¿™3ä¸ªï¼š â€œin septemberâ€ â€œjane isâ€ â€œjane visitsâ€ 3.3 æ­¥éª¤ä¸‰ç»§ç»­æ­¥éª¤2çš„è¿‡ç¨‹ï¼Œæ ¹æ® $P(y^{}|x,y^{},y^{})$ é€‰å‡º $P(y^{},y^{},y^{}|x)$ æœ€å¤§çš„å‰3ä¸ªç»„åˆ. åé¢é‡å¤ä¸Šè¿°æ­¥éª¤å¾—å‡ºç»“æœ. 3.4 æ€»ç»“æ€»ç»“ä¸€ä¸‹ä¸Šé¢çš„æ­¥éª¤å°±æ˜¯ï¼š (1). ç»è¿‡ encoder ä»¥åï¼Œdecoder ç»™å‡ºæœ€æœ‰å¯èƒ½çš„ä¸‰ä¸ªå¼€å¤´è¯ä¾æ¬¡ä¸º â€œinâ€, â€œjaneâ€, â€œseptemberâ€ P(y^{}|x) (2). ç»è¿‡å°†ç¬¬ä¸€æ­¥å¾—åˆ°çš„å€¼è¾“å…¥åˆ°ç¬¬äºŒæ­¥ä¸­ï¼Œæœ€æœ‰å¯èƒ½çš„ä¸‰ä¸ªç¿»è¯‘ä¸º â€œin septemberâ€, â€œjane isâ€, â€œjane visitsâ€ P(y^{}|x,y^{})(è¿™é‡Œï¼Œseptemberå¼€å¤´çš„å¥å­ç”±äºæ¦‚ç‡æ²¡æœ‰å…¶ä»–çš„å¯èƒ½æ€§å¤§ï¼Œå·²ç»å¤±å»äº†ä½œä¸ºå¼€å¤´è¯èµ„æ ¼) (3). ç»§ç»­è¿™ä¸ªè¿‡ç¨‹â€¦ P(y^{}|x,y^{},y^{}) 4. Refinements to beam search P(y^{},â€¦.,P(y^{T\\_y})|x)=P(y^{}|x)P(y^{}|x,y^{})â€¦P(y^{}|x,y^{},â€¦y^{})æ‰€ä»¥è¦æ»¡è¶³ $argmax P(y^{},â€¦.,P(y^{T_y})|x)$, ä¹Ÿå°±ç­‰åŒäºè¦æ»¡è¶³ argmax \\prod\\_{t=1}^{T\\_y}P(y^{}|x,y^{},â€¦y^{})ä½†æ˜¯ä¸Šé¢çš„å…¬å¼å­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼Œå› ä¸ºæ¦‚ç‡éƒ½æ˜¯å°äº1çš„ï¼Œç´¯ä¹˜ä¹‹åä¼šè¶Šæ¥è¶Šå°ï¼Œå¯èƒ½å°åˆ°è®¡ç®—æœºæ— æ³•ç²¾ç¡®å­˜å‚¨ï¼Œæ‰€ä»¥å¯ä»¥å°†å…¶è½¬å˜æˆ log å½¢å¼ï¼ˆå› ä¸º log æ˜¯å•è°ƒé€’å¢çš„ï¼Œæ‰€ä»¥å¯¹æœ€ç»ˆç»“æœä¸ä¼šæœ‰å½±å“ï¼‰ï¼Œå…¶å…¬å¼å¦‚ä¸‹ï¼š argmax \\sum\\_{t=1}^{T\\_y}logP(y^{}|x,y^{},â€¦y^{}) Butï¼ï¼ï¼ä¸Šè¿°å…¬å¼ä»ç„¶å­˜åœ¨bugï¼Œè§‚å¯Ÿå¯ä»¥çŸ¥é“ï¼Œæ¦‚ç‡å€¼éƒ½æ˜¯å°äº1çš„ï¼Œé‚£ä¹ˆlogä¹‹åéƒ½æ˜¯è´Ÿæ•°ï¼Œæ‰€ä»¥ä¸ºäº†ä½¿å¾—æœ€åçš„å€¼æœ€å¤§ï¼Œé‚£ä¹ˆåªè¦ä¿è¯ç¿»è¯‘çš„å¥å­è¶ŠçŸ­ï¼Œé‚£ä¹ˆå€¼å°±è¶Šå¤§ï¼Œæ‰€ä»¥å¦‚æœä½¿ç”¨è¿™ä¸ªå…¬å¼ï¼Œé‚£ä¹ˆæœ€åç¿»è¯‘çš„å¥å­é€šå¸¸éƒ½æ˜¯æ¯”è¾ƒçŸ­çš„å¥å­ï¼Œè¿™æ˜¾ç„¶ä¸è¡Œã€‚ æ‰€ä»¥æˆ‘ä»¬å¯ä»¥é€šè¿‡å½’ä¸€åŒ–çš„æ–¹å¼æ¥çº æ­£ï¼Œå³ä¿è¯å¹³å‡åˆ°æ¯ä¸ªå•è¯éƒ½èƒ½å¾—åˆ°æœ€å¤§å€¼ã€‚å…¶å…¬å¼å¦‚ä¸‹ï¼š argmax \\frac{1}{T\\_y}\\sum\\_{t=1}^{T\\_y}logP(y^{}|x,y^{},â€¦y^{})é€šè¿‡å½’ä¸€åŒ–çš„ç¡®èƒ½å¾ˆå¥½çš„è§£å†³ä¸Šè¿°é—®é¢˜ï¼Œä½†æ˜¯åœ¨å®é™…è¿ç”¨ä¸­ï¼Œä¼šé¢å¤–æ·»åŠ ä¸€ä¸ªå‚æ•° $Î±$, å…¶å¤§å°ä»‹äº 0 å’Œ 1 ä¹‹é—´ï¼Œå…¬å¼å¦‚ä¸‹: argmax \\frac{1}{T\\_y^Î±}\\sum\\_{t=1}^{T\\_y}logP(y^{}|x,y^{},â€¦y^{}) $T_y$ ä¸ºè¾“å‡ºå¥å­ä¸­å•è¯çš„ä¸ªæ•°ï¼Œ$Î±$ æ˜¯ä¸€ä¸ªè¶…å‚æ•° (å¯ä»¥è®¾ç½®ä¸º 0.7) $Î±$ == 1. åˆ™ä»£è¡¨ å®Œå…¨ç”¨å¥å­é•¿åº¦å½’ä¸€åŒ–$Î±$ == 0. åˆ™ä»£è¡¨ æ²¡æœ‰å½’ä¸€åŒ–$Î±$ == 0~1. åˆ™ä»£è¡¨ åœ¨ å¥å­é•¿åº¦å½’ä¸€åŒ– ä¸ æ²¡æœ‰å½’ä¸€åŒ– ä¹‹é—´çš„æŠ˜ä¸­ç¨‹åº¦. beam width = B = 3~10~100 æ˜¯ä¼šæœ‰ä¸€ä¸ªæ˜æ˜¾çš„å¢é•¿ï¼Œä½†æ˜¯ B ä» 1000 ~ 3000 æ˜¯å¹¶æ²¡æœ‰ä¸€ä¸ªæ˜æ˜¾å¢é•¿çš„. 5. Error analysis on beam searchä»”ç»†æƒ³æƒ³ beam searchï¼Œæˆ‘ä»¬ä¼šå‘ç°å…¶å®å®ƒæ˜¯è¿‘ä¼¼æœç´¢ï¼Œä¹Ÿå°±æ˜¯è¯´å¯èƒ½ä½¿ç”¨è¿™ç§æ–¹æ³•æœ€ç»ˆå¾—åˆ°çš„ç»“æœå¹¶ä¸æ˜¯æœ€å¥½çš„ã€‚å½“ç„¶ä¹Ÿæœ‰å¯èƒ½æ˜¯å› ä¸ºä½¿ç”¨çš„ RNN æ¨¡å‹æœ‰ç¼ºé™·å¯¼è‡´ç»“æœä¸æ˜¯æœ€å¥½çš„ã€‚ æ‰€ä»¥æˆ‘ä»¬å¦‚ä½•åˆ¤æ–­è¯¯å·®æ˜¯å‡ºåœ¨å“ªä¸ªåœ°æ–¹å‘¢ï¼Ÿ è¿˜æ˜¯ä»¥ç¿»è¯‘è¿™å¥è¯ä¸ºä¾‹ï¼šâ€œç®€åœ¨9æœˆè®¿é—®ä¸­å›½â€ã€‚ å‡è®¾æŒ‰ç…§äººç±»çš„ä¹ æƒ¯ç¿»è¯‘æˆè‹±æ–‡æ˜¯â€œJane visits China in September.â€,è¯¥ç»“æœç”¨ $y^*$ è¡¨ç¤ºã€‚ å‡è®¾é€šè¿‡ç®—æ³•å¾—å‡ºçš„ç¿»è¯‘ç»“æœæ˜¯ï¼šâ€œJane visited China in September.â€,è¯¥ç»“æœç”¨ $\\hat{y}$ è¡¨ç¤ºã€‚ è¦åˆ¤æ–­è¯¯å·®å‡ºåœ¨å“ªï¼Œåªéœ€è¦æ¯”è¾ƒ $P(y^*|x)$ å’Œ $P(\\hat{y}|x)$ çš„å¤§å°å³å¯. ä¸‹é¢åˆ†ä¸¤ç§æƒ…å†µè®¨è®ºï¼š RNN å®é™…ä¸Šæ˜¯ encode å’Œ decode çš„è¿‡ç¨‹. ä¸¤ç§æƒ…å†µï¼š (1). $P(y^*|x)&gt;P(\\hat{y}|x)$ ä¸Šé¢çš„ä¸ç­‰å¼çš„å«ä¹‰æ˜¯ beam search æœ€åé€‰å‡ºçš„ç»“æœä¸å¦‚äººç±»ï¼Œä¹Ÿå°±æ˜¯ beam search å¹¶æ²¡æœ‰é€‰å‡ºæœ€å¥½çš„ç»“æœï¼Œæ‰€ä»¥é—®é¢˜å‡ºåœ¨ beam search (2). $P(y^*|x)â‰¤P(\\hat{y}|x)$ ä¸Šé¢ä¸ç­‰å¼è¡¨ç¤º beam search æœ€åé€‰å‡ºçš„ç»“æœè¦æ¯”äººç±»çš„æ›´å¥½ï¼Œä¹Ÿå°±æ˜¯è¯´ beam search å·²ç»é€‰å‡ºäº†æœ€å¥½çš„ç»“æœï¼Œä½†æ˜¯æ¨¡å‹å¯¹å„ä¸ªç»„åˆçš„é¢„æµ‹æ¦‚ç‡å€¼å¹¶ä¸ç¬¦åˆäººç±»çš„é¢„æœŸï¼Œæ‰€ä»¥ RNNæ¨¡å‹ at fault. ä¸Šé¢å·²ç»ä»‹ç»äº†è¯¯å·®åˆ†æçš„æ–¹å¼ï¼Œä½†æ—¶ä»…å‡­ä¸€æ¬¡è¯¯å·®åˆ†æå°±åˆ¤å®šè°è¯¥èƒŒé”…è‚¯å®šä¹Ÿä¸è¡Œï¼Œæ‰€ä»¥è¿˜éœ€è¦è¿›è¡Œå¤šæ¬¡è¯¯å·®åˆ†æå¤šæ¬¡ã€‚ å¦‚ä¸‹å›¾ç¤ºå·²ç»è¿›è¡Œäº†å¤šæ¬¡çš„è¯¯å·®åˆ†æï¼Œæ¯æ¬¡åˆ†æä¹‹åéƒ½åˆ¤å®šäº†é”…è¯¥è°èƒŒï¼Œæœ€åè®¡ç®—å‡ºbeam searchå’Œæ¨¡å‹èƒŒé”…çš„æ¯”ä¾‹ï¼Œæ ¹æ®æ¯”ä¾‹ä½œå‡ºç›¸åº”çš„è°ƒæ•´ã€‚ ä¾‹å¦‚: å¦‚æœ beam search æ›´é«˜ï¼Œå¯ä»¥ç›¸åº”è°ƒæ•´ beam width. å¦‚æœæ¨¡å‹èƒŒé”…æ¯”ä¾‹æ›´é«˜ï¼Œé‚£ä¹ˆå¯ä»¥è€ƒè™‘å¢åŠ æ­£åˆ™åŒ–ï¼Œå¢åŠ æ•°æ®ç­‰æ“ä½œ. 6. Bleu score (optional)ä¸»è¦ä»‹ç»äº†å¦‚ä½•ç»™æœºå™¨ç¿»è¯‘ç»“æœæ‰“åˆ†ï¼Œå› ä¸ºæ˜¯é€‰ä¿®å†…å®¹, æ‰€ä»¥ balabalaâ€¦ 7. Attention model intuitionä¹‹å‰ä»‹ç»çš„ RNN ç¿»è¯‘æ¨¡å‹å­˜åœ¨ä¸€ä¸ªå¾ˆæ˜æ˜¾çš„é—®é¢˜å°±æ˜¯: æœºå™¨ç¿»è¯‘çš„ç¿»è¯‘è¿‡ç¨‹æ˜¯é¦–å…ˆå°†æ‰€æœ‰éœ€è¦ç¿»è¯‘çš„å¥å­è¾“å…¥åˆ° Encoder ä¸­ï¼Œä¹‹åå†é€šè¿‡ Decoder è¾“å‡ºç¿»è¯‘è¯­å¥. 7.1 Why Attention modelå¦‚ä¸‹å›¾ç¤ºæœºå™¨ç®—æ³•å°†æ³•è¯­ç¿»è¯‘æˆè‹±è¯­çš„æ¨¡å‹. æœºå™¨ç¿»è¯‘ä¸äººç±»çš„ç¿»è¯‘è¿‡ç¨‹ä¸å¤ªç›¸åŒã€‚å› ä¸ºäººç±»ç¿»è¯‘ä¸€èˆ¬æ˜¯é€å¥ç¿»è¯‘ï¼Œæˆ–è€…æ˜¯è®²ä¸€æ®µå¾ˆé•¿çš„å¥å­åˆ†è§£å¼€æ¥è¿›è¡Œç¿»è¯‘ã€‚ æ‰€ä»¥ä¸Šè¿°æ¨¡å‹çš„ç¿»è¯‘ç»“æœçš„ Bleuè¯„åˆ† ä¸è¢«ç¿»è¯‘å¥å­çš„é•¿çŸ­æœ‰å¾ˆå¤§å…³ç³»ï¼Œå¥å­è¾ƒçŸ­æ—¶ï¼Œæ¨¡å‹å¯èƒ½æ— æ³•æ•æ‰åˆ°å…³é”®ä¿¡æ¯ï¼Œæ‰€ä»¥ç¿»è¯‘ç»“æœä¸æ˜¯å¾ˆé«˜ï¼›ä½†æ˜¯å½“å¥å­è¿‡é•¿æ—¶ï¼Œæ¨¡å‹åˆæŠ“ä¸åˆ°é‡ç‚¹ç­‰åŸå› ä½¿å¾—ç»“æœä¹Ÿä¸æ˜¯å¾ˆé«˜ã€‚ â€‹è§ä¸Šå›¾ï¼Œå¦‚æœæœºå™¨èƒ½åƒäººä¸€æ ·é€å¥æˆ–è€…æ¯æ¬¡å°†æ³¨æ„åŠ›åªé›†ä¸­åœ¨ä¸€å°éƒ¨åˆ†è¿›è¡Œç¿»è¯‘ï¼Œé‚£ä¹ˆç¿»è¯‘ç»“æœå°†ä¸å—å¥å­é•¿åº¦çš„å½±å“ã€‚ä¸‹å›¾ä¸­çš„ç»¿è‰²çº¿å³ä¸ºä½¿ç”¨äº†æ³¨æ„åŠ›æ¨¡å‹åçš„ç¿»è¯‘å¥å­å¾—åˆ†ã€‚ 7.2 Attention model introä¸‹å›¾å±•ç¤ºäº†æ™®é€šçš„ç¿»è¯‘æ¨¡å‹åŒå‘ RNN ç»“æ„ï¼Œè¯¥ç»“æ„å¯æ ¹æ®è¾“å…¥ $x^{&lt;{t}&gt;}$ ç›´æ¥å¾—åˆ°è¾“å‡º $y^{&lt;{t}&gt;}$. Attention model åœ¨æ­¤åŸºç¡€ä¸Šåšè¿›ä¸€æ­¥å¤„ç†ã€‚ ä¸ºé¿å…è¯¯è§£ï¼Œä½¿ç”¨å¦ä¸€ä¸ªç¬¦å· $s$ æ¥è¡¨ç¤ºèŠ‚ç‚¹ã€‚ å¦‚ä¸‹å›¾ç¤ºï¼Œæ ¹æ®ä¸‹é¢ä¸€å±‚çš„ åŒå‘RNN è®¡ç®—ç»“æœå¯å¾—åˆ°èŠ‚ç‚¹ $s^{}$ ä¸å…¶ä»–èŠ‚ç‚¹æƒé‡ $Î±^{},Î±^{},â€¦$ é€šè¿‡è¿™äº›æƒé‡å¯ä»¥çŸ¥é“è¯¥èŠ‚ç‚¹ä¸å…¶ä»–èŠ‚ç‚¹çš„ç›¸å…³è”ç¨‹åº¦ï¼Œä»è€Œå¯ä»¥è¾¾åˆ°å°†æ³¨æ„åŠ›é›†ä¸­åˆ°éƒ¨åˆ†åŒºåŸŸçš„æ•ˆæœã€‚ â€‹å…¶ä»–èŠ‚ç‚¹åŒç†ã€‚æ•´ä¸ªæ³¨æ„åŠ›æ¨¡å‹ç»“æ„å¦‚ä¸‹å›¾ç¤º 8. Attention modelç‰¹åˆ«è¦åŒºåˆ† $a$ (å­—æ¯a) å’Œ $Î±$ (alpha)ã€‚å‰è€…è¡¨ç¤ºç‰¹å¾èŠ‚ç‚¹ï¼Œåè€…è¡¨ç¤ºæ³¨æ„åŠ›æƒé‡ã€‚ 8.1 å‚æ•°ä»‹ç»å¦‚ä¸‹å›¾ç¤ºï¼Œæ³¨æ„åŠ›æ¨¡å‹é‡‡ç”¨åŒå‘ RNN ç»“æ„ï¼Œæ‰€ä»¥æ¯ä¸ªèŠ‚ç‚¹æœ‰ä¸¤ä¸ªå€¼ï¼Œç”¨ $\\overrightarrow{a}^{&lt;{tâ€™}&gt;},\\overleftarrow{a}^{&lt;{tâ€™}&gt;}$ è¡¨ç¤ºï¼Œä¸ºäº†ä½¿å…¬å¼æ›´ç®€åŒ–ï¼Œä»¤ $a^{&lt;{tâ€™}&gt;}=(\\overrightarrow{a}^{&lt;{tâ€™}&gt;},\\overleftarrow{a}^{&lt;{tâ€™}&gt;})$ ã€‚å…¶ä¸­ $tâ€™$ è¡¨ç¤ºè¾“å…¥æ•°æ®çš„ç´¢å¼•ã€‚ ä¸Šä¸€èŠ‚å·²ç»ä»‹ç»äº†æ³¨æ„åŠ›æƒé‡ $Î±^{&lt;{t,tâ€™}&gt;}$ï¼Œä»¥ç¬¬ä¸€ä¸ªèŠ‚ç‚¹ä¸ºä¾‹ï¼Œå®ƒçš„æƒé‡å€¼å¯ä»¥ç”¨ $Î±^{&lt;{1,tâ€™}&gt;}$ è¡¨ç¤ºï¼Œä¸”æ‰€æœ‰æƒé‡å€¼æ»¡è¶³ $\\sum{Î±^{&lt;{1,tâ€™}&gt;}}=1$ æ‰€æœ‰æƒé‡ä¸å¯¹åº”èŠ‚ç‚¹çš„çº¿æ€§ä¹‹å’Œç”¨ $c^{&lt;{tâ€™}&gt;}$ è¡¨ç¤ºï¼ˆä¸ºæ–¹ä¾¿ä¹¦å†™ï¼Œç”¨ $c$ è¡¨ç¤ºï¼‰,$c$ è¡¨ç¤º contextï¼Œå³ä¸Šä¸‹æ–‡å˜é‡. è¿˜æ˜¯ä»¥ç¬¬ä¸€ä¸ªèŠ‚ç‚¹ä¸ºä¾‹ï¼Œc çš„è®¡ç®—å…¬å¼å¦‚ä¸‹ï¼š c^{}=\\sum\\_{t'}Î±^{} 8.2 æ³¨æ„åŠ›æƒå€¼è®¡ç®—å…¬å¼ \\alpha^{})}{\\sum\\_{t''=1}^{T\\_x}{exp(e^{t,t''})}}ä¸Šé¢å…¬å¼ä¸­çš„ $e^{&lt;{t,tâ€™}&gt;}$ è®¡ç®—å›¾å¦‚ä¸‹ï¼š å…¶ä¸­ $s^{&lt;{t-1}&gt;}$ è¡¨ç¤ºä¸Šä¸€ä¸ªçŠ¶æ€çš„å€¼, $a^{&lt;{tâ€™}&gt;}$ è¡¨ç¤ºç¬¬ $tâ€™$ ä¸ªç‰¹å¾èŠ‚ç‚¹. Andrew Ng å¹¶æ²¡æœ‰è¯¦ç»†çš„ä»‹ç»ä¸Šé¢çš„ç½‘ç»œï¼Œåªæ˜¯ä¸€ç¬”å¸¦è¿‡ï¼Œè¯´åå‘ä¼ æ’­å’Œæ¢¯åº¦ä¸‹é™ä¼šè‡ªåŠ¨å­¦ä¹ ï¼Œemmmã€‚ã€‚é‚£å°±è¿™æ ·å§ã€‚ ç»“åˆä¸‹å›¾å¯ä»¥ç‹¬è‡ªå‚è€ƒä¸€ä¸‹ä¸Šé¢çš„å…¬å¼æ˜¯ä»€ä¹ˆæ„æ€. 8.3 å¤§æ•°æ®æ–‡æ‘˜ä¸‹é¢çš„ç¬”è®°æ˜¯ã€Šå¤§æ•°æ®æ–‡æ‘˜ã€‹çš„ç¬”è®°ï¼Œæ„Ÿè§‰ä»–å†™çš„æ¸…æ¥šä¸€äº›: é€šè¿‡ä¹‹å‰çš„å­¦ä¹ å¯ä»¥çœ‹åˆ°æœºå™¨ç¿»è¯‘æ˜¯å°†æ‰€æœ‰è¦ç¿»è¯‘çš„å†…å®¹ç»Ÿä¸€è¾“å…¥ç„¶åå†å¼€å§‹ç”Ÿæˆç»“æœï¼Œä½†è¿™æ ·æœ‰ä¸€ä¸ªå¼Šç«¯å°±æ˜¯åœ¨å¥å­ç‰¹åˆ«é•¿çš„æ—¶å€™åé¢çš„å†…å®¹æœ‰çš„æ—¶å€™æ— æ³•ç¿»è¯‘çš„ç‰¹åˆ«çš„å‡†ç¡®ã€‚é€šè¿‡æ­å»º attention model å¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜: å¦‚å›¾æ‰€ç¤ºï¼Œè¿™æ˜¯ä¸€ä¸ª BRNNï¼Œå¹¶ä¸”åœ¨æ™®é€š RNN çš„åŸºç¡€ä¸Šå¢åŠ  attentionå±‚ï¼Œå°†é˜¶æ®µæ€§çš„è¾“å…¥éƒ¨åˆ†è½¬åŒ–ä¸ºè¾“å‡ºï¼Œè¿™æ ·çš„æ–¹å¼ä¹Ÿæ›´ç¬¦åˆäººç±»çš„ç¿»è¯‘è¿‡ç¨‹ã€‚ è®©æˆ‘ä»¬æ‹¿å‡ºç»†èŠ‚éƒ¨åˆ†ä»”ç»†çš„ç†è§£ä¸€ä¸‹ï¼Œé¦–å…ˆæ˜¯ attention å±‚ï¼Œä¹Ÿå°±æ˜¯ä¸‹å›¾ä¸­ $context^{&lt;{t}&gt;}$ ï¼Œæ¯ä¸€ä¸ª attention å•å…ƒæ¥å— ä¸‰ä¸ªå•è¯çš„è¾“å…¥æ‰€ä»¥ä¹Ÿç§°ä½œè¯­å¢ƒå•å…ƒï¼ˆcontextï¼‰ï¼Œ Î± æ˜¯æ¯å•ä¸ªè¾“å…¥è¯åœ¨è¯­å¢ƒå•å…ƒä¸­å å¾—æƒé‡ã€‚å¯¹æ¯ä¸€ä¸ªè¯­å¢ƒå•å…ƒ t æ¥è¯´ï¼Œå› ä¸º Î± æ˜¯é€šè¿‡ softmax å†³å®šçš„ï¼Œæ‰€ä»¥ $\\sum_{i=1}^{T_x}Î±^{t,i}=1$. è¿™é‡Œå†³å®šç»ˆæ¯ä¸€ä¸ªå•è¯å å¾—è¯­å¢ƒæƒé‡ä»ç„¶æ˜¯é€šè¿‡ä¸€ ä¸ªå°å‹çš„ç¥ç»ç½‘ç»œæ¥è¿›è¡Œè®¡ç®—å¹¶ä¸”åå¾—åˆ°çš„ã€‚ è¾“å‡ºçš„ $context^{&lt;{t}&gt;}$ è¿›å…¥åˆ°ä¸‹ä¸€å±‚ Post LSTM è¿™ä¸€æ­¥å°±å’Œä¹‹å‰å­¦ä¹ è¿‡çš„é‚£æ ·å­ï¼Œå°†å‰ä¸€æ­¥çš„è¾“å‡ºä¸è¿™ä¸€æ­¥ç»è¿‡é‡é‡åˆ†æçš„è¾“å…¥ç»¼åˆåˆ°ä¸€èµ·äº§ç”Ÿè¿™ä¸€æ­¥çš„è¾“å‡ºã€‚ è®©æˆ‘ä»¬è¯„ä¼°ä¸€ä¸‹ attention modelï¼š ç”±äºç»“æ„çš„å¤æ‚ï¼Œè®¡ç®—é‡ä¸æ—¶é—´æ¯”æ™®é€šçš„è¯­è¨€æ¨¡å‹è¦å¤šå’Œæ…¢è®¸å¤šã€‚ä¸è¿‡å¯¹äºæœºå™¨ç¿»è¯‘æ¥è¯´ï¼Œç”±äºæ¯ä¸€å¥è¯å¹¶ä¸ä¼šç‰¹åˆ«ç‰¹æ¯”çš„é•¿ï¼Œæ‰€ä»¥æœ‰çš„æ—¶å€™ç¨å¾®æ…¢ä¸€ç‚¹ä¹Ÿä¸æ˜¯å®Œå…¨æ— æ³•æ¥å—. ä¸€ä¸ªé‡è¦ attention model åº”ç”¨å°±æ˜¯è¯­éŸ³è¯†åˆ«ï¼Œäººé€šè¿‡éº¦å…‹é£è¾“å…¥ä¸€å¥è¯è®©æœºå™¨æ¥ç¿»è¯‘è¾“å…¥çš„å†…å®¹ï¼Œæ¥çœ‹ä¸€ä¸‹æ˜¯å¦‚ä½•å®ç°çš„ 9. Speech recognitionä¸€èˆ¬è¯­éŸ³è¯†åˆ«è¿‡ç¨‹æ˜¯å¦‚ä¸‹å›¾ç¤ºçš„ï¼Œå³é¦–å…ˆå°†åŸéŸ³é¢‘ (é»‘ç™½çš„ï¼Œçºµè½´è¡¨ç¤ºæŒ¯å¹…) è½¬åŒ–æˆçºµè½´ä¸ºé¢‘ç‡çš„éŸ³è°±å›¾ï¼Œå¹¶ä¸”é€šè¿‡äººå·¥é¢„å…ˆè®¾å®šçš„éŸ³ç´ (phonemes)å†æ¥è¯†åˆ«. å½“äººå¯¹ç€éº¦å…‹é£å½•å…¥ä¸€å¥è¯ï¼Œéº¦å…‹é£è®°å½•ä¸‹æ¥çš„æ˜¯ç©ºæ°”ç»†å¾®çš„éœ‡åŠ¨çš„å¼ºåº¦ï¼Œä»¥åŠé¢‘ç‡ã€‚äººè€³åœ¨å¬åˆ°ä¸€å¥è¯çš„æ—¶å€™å…¶ å®åšçš„æ˜¯ç±»ä¼¼çš„å¤„ç†ã€‚åœ¨æ·±åº¦å­¦ä¹ æ²¡æœ‰ç‰¹åˆ«æµè¡Œä¹‹å‰ï¼Œæ¯”è¾ƒæµè¡Œçš„æ˜¯ç”¨éŸ³èŠ‚åšè¯­éŸ³è¯†åˆ«ï¼Œä½†ç°åœ¨å› ä¸ºæœ‰äº†å¼ºå¤§çš„ attention modelï¼Œå¾—åˆ°çš„ç»“æœæ¯”éŸ³èŠ‚çš„æ•ˆæœæ›´å¥½ã€‚ CTC(connectionist temporal classiï¬cation)æ˜¯ä¹‹å‰è¾ƒä¸ºå¸¸ç”¨çš„æ–¹æ³•ã€‚ å…·ä½“åŸç†å¦‚ä¸‹ï¼š å‡è®¾æ¯ç§’éŸ³é¢‘å¯ä»¥æå–å‡º 100 ä¸ªç‰¹å¾å€¼ï¼Œé‚£ä¹ˆå‡è®¾ 10ç§’ çš„éŸ³é¢‘å°±æœ‰ 1000 ä¸ªç‰¹å¾å€¼ï¼Œé‚£ä¹ˆè¾“å‡ºå€¼ä¹Ÿæœ‰ 1000 ä¸ªï¼Œä½†æ˜¯è¯´å‡ºçš„è¯å¹¶æ²¡æœ‰è¿™ä¹ˆå¤šå•Šï¼Œé‚£è¯¥æ€ä¹ˆå¤„ç†å‘¢ï¼Ÿ æ–¹æ³•å¾ˆç®€å•ï¼Œåªéœ€è¦æŠŠâ€œâ€è¿›è¡Œå‹ç¼©å³å¯ï¼Œæ³¨æ„éœ€è¦å°† â€œâ€œå’Œç©ºé¢åŒºåˆ†å¼€æ¥ï¼Œå› ä¸ºç©ºæ ¼ä¹Ÿæ˜¯å ä¸€ä¸ªå­—ç¬¦çš„ã€‚ 10. Trigger word detection å‡è®¾ä¸‹å›¾å¼è®­ç»ƒé›†ä¸­çš„ä¸€æ®µéŸ³é¢‘ï¼Œå…¶ä¸­åŒ…å«äº†ä¸¤æ¬¡å”¤é†’è¯: æ­å»ºä¸€ä¸ª attention modelï¼Œåœ¨å¬åˆ°å”¤é†’è¯ä¹‹å‰ä¸€ç›´è¾“å‡ºçš„æ˜¯ 0ï¼Œåœ¨å¬åˆ°å”¤é†’è¯ä»¥åè¾“å‡º 1ï¼Œä½†å› ä¸ºä¸€ä¸ªå”¤é†’è¯ä¼šæŒç»­åŠç§’å·¦å³æ‰€ä»¥æˆ‘ä»¬ä¹Ÿä¸ä»…ä»…åªè¾“å‡ºä¸€æ¬¡ 1ï¼Œè€Œæ˜¯å°†è¾“å‡ºçš„ 1 æŒç»­ä¸€æ®µæ—¶é—´ï¼Œé€šè¿‡è¿™æ ·çš„æ–¹å¼è®­ç»ƒå‡ºçš„ RNN å°±å¯ä»¥å¾ˆ æœ‰æ•ˆçš„æ£€æµ‹åˆ°å”¤é†’è¯äº†ã€‚ 11. Summary and thank youç»ˆäºå­¦å®Œäº†ã€‚è™½ç„¶å¹¶ä¸èƒ½è¯´æ˜ä»€ä¹ˆ~~~233333 æ„Ÿè°¢å´æ©è¾¾å’Œä»–çš„å›¢é˜Ÿç»™æˆ‘ä»¬å¸¦æ¥è¿™ä¹ˆå¥½çš„æ•™ç¨‹ Reference ç½‘æ˜“äº‘è¯¾å ‚ - deeplearning DeepLearning.aiå­¦ä¹ ç¬”è®°æ±‡æ€» deeplearning.aiæ·±åº¦å­¦ä¹ è¯¾ç¨‹å­—å¹•ç¿»è¯‘é¡¹ç›® seq2seqå­¦ä¹ ç¬”è®°","categories":[{"name":"deeplearning","slug":"deeplearning","permalink":"http://iequa.com/categories/deeplearning/"}],"tags":[{"name":"deeplearning.ai","slug":"deeplearning-ai","permalink":"http://iequa.com/tags/deeplearning-ai/"}]},{"title":"Chatbot Research 3 - æœºå™¨å­¦ä¹ æ„å»º chatbot","slug":"chatbot/chatbot-research3","date":"2018-08-13T06:00:21.000Z","updated":"2020-10-23T02:03:18.012Z","comments":true,"path":"2018/08/13/chatbot/chatbot-research3/","link":"","permalink":"http://iequa.com/2018/08/13/chatbot/chatbot-research3/","excerpt":"Chatterbot èŠå¤©æœºå™¨äººæ¡†æ¶ æ£€ç´¢ä¸åŒ¹é… &amp; åˆ†ç±»ä¸æœ´ç´ è´å¶æ–¯","text":"Chatterbot èŠå¤©æœºå™¨äººæ¡†æ¶ æ£€ç´¢ä¸åŒ¹é… &amp; åˆ†ç±»ä¸æœ´ç´ è´å¶æ–¯ å…³äºèŠå¤©æœºå™¨äººçš„æ€è€ƒ å·¥ç¨‹è€ƒé‡ æœºå™¨å­¦ä¹ è§’åº¦è€ƒè™‘ é¢„å¤‡çŸ¥è¯† æ£€ç´¢ä¸åŒ¹é… åˆ†ç±»ä¸æœ´ç´ è´å¶æ–¯ chatterbot æ¶æ„ä¸ä½¿ç”¨æ–¹æ³• æºç åˆ†æ 1. ä¼ ç»ŸèŠå¤©æœºå™¨äººNLP åŸºç¡€çŸ¥è¯† åŸºæœ¬åˆ†è¯ (jieba) å…³é”®è¯æŠ½å– (tf-idfç­‰) æ­£åˆ™è¡¨è¾¾å¼æ¨¡å¼åŒ¹é… â€¦ Machine Learningç›¸å…³çŸ¥è¯† æ–‡æœ¬è¡¨ç¤ºä¸åŒ¹é… åˆ†ç±» (æ–‡æœ¬åœºæ™¯åˆ†æ) æ•°æ®é©±åŠ¨ (ç‰¹å¾å·¥ç¨‹) â€¦ 2. èŠå¤©æœºå™¨äººçš„ä¸€äº›æ€è€ƒå·¥ç¨‹è€ƒé‡ æ¶æ„è®¾è®¡æ¸…æ™°ã€æ¨¡å—åŒ– åŠŸèƒ½åˆ†æ‹†ï¼Œè§£è€¦ï¼Œéƒ¨ä»¶å¯æ’æ‹”ä¸æ‰©å±• ç®—æ³•ä¸æœºå™¨å­¦ä¹ è§’åº¦è€ƒé‡ ç®—æ³•ç®€å•ï¼Œæ•°æ®(ç‰¹å¾)é©±åŠ¨ åœºæ™¯åŒ–ä¸å‚ç›´é¢†åŸŸ 3. é¢„å¤‡çŸ¥è¯†åŸºäºæ£€ç´¢ä¸åŒ¹é… çŸ¥è¯†åº“ (å­˜å‚¨äº†é—®é¢˜ä¸å›å¤å†…å®¹) æ£€ç´¢: æœå¯»ç›¸å…³é—®é¢˜ åŒ¹é…: å¯¹ç»“æœè¿›è¡Œæ’åº ç¼–è¾‘è·ç¦» ç¼–è¾‘è·ç¦»/Levenshteinè·ç¦»ï¼Œæ˜¯æŒ‡ä¸¤ä¸ªå­—ç¬¦ä¸²ä¹‹é—´ï¼Œç”±ä¸€ä¸ªè½¬æˆå¦ä¸€ä¸ªæ‰€éœ€è¦çš„æœ€å°‘ç¼–è¾‘æ“ä½œæ¬¡æ•°ã€‚ é€’å½’ &amp; åŠ¨æ€è§„åˆ’ DP TFIDF QA pair çš„ TFIDF çš„ç›¸è¿‘åº¦ S1: â€œä½ å–œæ¬¢ä»€ä¹ˆä¹¦â€S2: â€œä½ å–œæ¬¢ä»€ä¹ˆç”µå½±â€ python ç¼–è¾‘è·ç¦» Pythonåœ¨string ç±»å‹ä¸­ï¼Œé»˜è®¤çš„ utf-8 ç¼–ç ä¸‹ï¼Œä¸€ä¸ªä¸­æ–‡å­—ç¬¦æ˜¯ç”¨ä¸‰ä¸ªå­—èŠ‚æ¥è¡¨ç¤ºçš„ã€‚ç”¨unicodeã€‚ # -*- coding:utf-8 -*-import Levenshteintexta = &quot;uå…³é”®æ—¶åˆ»&quot;textb = &quot;uå…³é”®Â·æ—¶åˆ»&quot;print(Levenshtein.distance(texta,textb)) # 1 4. Chatterbot èŠå¤©æœºå™¨äºº æ¯ä¸ªéƒ¨åˆ†éƒ½è®¾è®¡äº†ä¸åŒçš„ â€œé€‚é…å™¨â€(Adapter) æœºå™¨äººåº”ç­”é€»è¾‘ =&gt; Logic Adapters Closest Match Adapter å­—ç¬¦ä¸²æ¨¡ç³ŠåŒ¹é…(ç¼–è¾‘è·ç¦») Closest Meaning Adapter å€ŸåŠ© nltk çš„ WordNetï¼Œè¿‘ä¹‰è¯è¯„ä¼° Time Logic Adapter å¤„ç†æ¶‰åŠæ—¶é—´çš„æé—® Mathematical Evaluation Adapter æ¶‰åŠæ•°å­¦è¿ç®— å­˜å‚¨å™¨åç«¯ =&gt; Storage Adapters Read Only Modeåªè¯»æ¨¡å¼ï¼Œå½“æœ‰è¾“å…¥æ•°æ®åˆ° chatterbot çš„æ—¶å€™ï¼Œæ•°æ®åº“å¹¶ä¸ä¼šå‘ç”Ÿæ”¹å˜ Json Database Adapterç”¨ä»¥å­˜å‚¨å¯¹è¯æ•°æ®çš„æ¥å£ï¼Œå¯¹è¯æ•°æ®ä»¥ Jsonæ ¼å¼ è¿›è¡Œå­˜å‚¨. (è½½å…¥æ•°æ®ç‰¹åˆ«æ…¢ï¼Œå·¥ä¸šç•Œä¸å¯è¡Œ) Mongo Database Adapterä»¥ MongoDB database æ–¹å¼æ¥å­˜å‚¨å¯¹è¯æ•°æ® è¾“å…¥å½¢å¼ =&gt; Input Adapters Variable input type adapter å…è®¸ chatterbot æ¥æ”¶ä¸åŒç±»å‹çš„è¾“å…¥çš„ï¼Œå¦‚ strings, dictionaries å’ŒStatements Terminal adapter ä½¿å¾— ChatterBot å¯ä»¥é€šè¿‡ç»ˆç«¯è¿›è¡Œå¯¹è¯ Speech recognition è¯­éŸ³è¯†åˆ«è¾“å…¥ï¼Œè¯¦è§ chatterbot-voice 5. Bayes åˆ†ç±»é¢„å¤‡çŸ¥è¯†:åœºæ™¯åˆ†ç±»ä¸NB Reference github ChatterBot Docs Â» About ChatterBot ä½¿ç”¨chatterbotæ„å»ºè‡ªå·±çš„ä¸­æ–‡chat(é—²èŠ)æœºå™¨äºº/ è‡ªç„¶è¯­è¨€å¤„ç† ChatterbotèŠå¤©æœºå™¨äºº ç²¾å“: å¼€æºChatterBotå·¥ä½œåŸç†","categories":[{"name":"chatbot","slug":"chatbot","permalink":"http://iequa.com/categories/chatbot/"}],"tags":[{"name":"Chatbot","slug":"Chatbot","permalink":"http://iequa.com/tags/Chatbot/"}]},{"title":"Chatbot Research 2 - NLPåŸºç¡€çŸ¥è¯†å›é¡¾","slug":"chatbot/chatbot-research2","date":"2018-08-12T06:00:21.000Z","updated":"2020-10-23T02:03:18.012Z","comments":true,"path":"2018/08/12/chatbot/chatbot-research2/","link":"","permalink":"http://iequa.com/2018/08/12/chatbot/chatbot-research2/","excerpt":"NLTK Pythonä¸Šè‘—åçš„è‡ªç„¶è¯­è¨€å¤„ç†åº“ã€‚ è‡ªå¸¦è¯­æ–™åº“ï¼Œè¯æ€§åˆ†ç±»åº“ï¼Œ è¿˜æœ‰å¼ºå¤§çš„ç¤¾åŒºæ”¯æŒã€‚","text":"NLTK Pythonä¸Šè‘—åçš„è‡ªç„¶è¯­è¨€å¤„ç†åº“ã€‚ è‡ªå¸¦è¯­æ–™åº“ï¼Œè¯æ€§åˆ†ç±»åº“ï¼Œ è¿˜æœ‰å¼ºå¤§çš„ç¤¾åŒºæ”¯æŒã€‚ æ–‡æœ¬å¤„ç†æµç¨‹ åˆ†è¯ å½’ä¸€åŒ– åœæ­¢è¯ NLPç»å…¸ä¸‰æ¡ˆä¾‹ æƒ…æ„Ÿåˆ†æ æ–‡æœ¬ç›¸ä¼¼åº¦ æ–‡æœ¬åˆ†ç±» æ–¯å¦ä½› CoreNLP (è‹±æ–‡ã€ä¸­æ–‡ã€è¥¿ç­ç‰™è¯­) 1. NLTK Python è‘—åçš„è‡ªç„¶è¯­è¨€å¤„ç†åº“ è‡ªå¸¦è¯­æ–™åº“ã€è¯æ€§åˆ†ç±»åº“ è‡ªå¸¦åˆ†ç±»ã€åˆ†è¯ ç­‰åŠŸèƒ½ å¼ºå¤§çš„ç¤¾åŒºæ”¯æŒ sudo pip install -U nltksudo pip install -U numpy import nltknltk.download() æµ‹è¯•æ˜¯å¦å®‰è£…æˆåŠŸ &gt;&gt;&gt; python&gt;&gt;&gt; import nltk 2. åŠŸèƒ½ä¸€è§ˆè¡¨ NLTK è‡ªå¸¦è¯­æ–™åº“ 3. Tokenizetokenize æŠŠé•¿å¥å­æ‹†æˆæœ‰â€œæ„ä¹‰â€çš„å°éƒ¨ä»¶ &gt;&gt;&gt; import nltk &gt;&gt;&gt; sentence = â€œhello, world&quot; &gt;&gt;&gt; tokens = nltk.word_tokenize(sentence) &gt;&gt;&gt; tokens [&#x27;hello&#x27;, â€˜,&#x27;, &#x27;world&#x27;] ä¸­æ–‡åˆ†è¯ jieba (ç¬¬ä¸‰æ–¹å¼€æºåº“) æœ‰æ—¶å€™tokenizeæ²¡é‚£ä¹ˆç®€å• æ¯”å¦‚ç¤¾äº¤ç½‘ç»œä¸Š,è¿™äº›ä¹±ä¸ƒå…«ç³Ÿçš„ä¸åˆè¯­æ³•ä¸åˆæ­£å¸¸é€»è¾‘çš„è¯­è¨€å¾ˆå¤š:æ‹¯æ•‘ @æŸäºº, è¡¨æƒ…ç¬¦å·, URL, #è¯é¢˜ç¬¦å· ç¤¾äº¤ç½‘ç»œè¯­è¨€çš„tokenize : from nltk.tokenize import word_tokenize tweet = &#x27;RT @angelababy: love you baby! :D http://ah.love #168cm&#x27; print(word_tokenize(tweet)) æ­£åˆ™è¡¨è¾¾å¼å¯¹ç…§è¡¨ 4. è¯å½¢å½’ä¸€åŒ–Inflectionå˜åŒ–: walk =&gt; walking =&gt; walked ä¸å½±å“è¯æ€§ derivation å¼•ç”³: nation (noun) =&gt; national (adjective) =&gt; nationalize (verb) å½±å“è¯æ€§ Stemming è¯å¹²æå–:ä¸€èˆ¬æ¥è¯´ï¼Œå°±æ˜¯æŠŠä¸å½±å“è¯æ€§çš„inflectionçš„å°å°¾å·´ç æ‰ walking ç ing = walkwalked ç ed = walk Lemmatization è¯å½¢å½’ä¸€:æŠŠå„ç§ç±»å‹çš„è¯çš„å˜å½¢ï¼Œéƒ½å½’ä¸ºä¸€ä¸ªå½¢å¼ went å½’ä¸€ = goare å½’ä¸€ = be 4.1 Stemming PorterStemmer SnowballStemmer LancasterStemmer PorterStemmer PorterStemmer &gt;&gt;&gt; from nltk.stem.porter import PorterStemmer &gt;&gt;&gt; porter_stemmer = PorterStemmer() &gt;&gt;&gt; porter_stemmer.stem(â€˜maximumâ€™) uâ€™maximumâ€™ &gt;&gt;&gt; porter_stemmer.stem(â€˜presumablyâ€™) uâ€™presumâ€™ LancasterStemmer &gt;&gt;&gt; from nltk.stem.lancaster import LancasterStemmer&gt;&gt;&gt; lancaster_stemmer = LancasterStemmer()&gt;&gt;&gt; lancaster_stemmer.stem(â€˜maximumâ€™)â€˜maximâ€™&gt;&gt;&gt; lancaster_stemmer.stem(â€˜presumablyâ€™)â€˜presumâ€™ 4.2 Lemmatizationè¯å½¢å½’ä¸€ï¼š æŠŠå„ç§ç±»å‹çš„è¯çš„å˜å½¢,éƒ½å½’ä¸ºä¸€ä¸ªå½¢å¼ went å½’ä¸€ = goare å½’ä¸€ = be &gt;&gt;&gt; from nltk.stem import WordNetLemmatizer &gt;&gt;&gt; wordnet_lemmatizer = WordNetLemmatizer() &gt;&gt;&gt; wordnet_lemmatizer.lemmatize(â€˜dogsâ€™) uâ€™dogâ€™ &gt;&gt;&gt; wordnet_lemmatizer.lemmatize(â€˜churchesâ€™) uâ€™churchâ€™ &gt;&gt;&gt; wordnet_lemmatizer.lemmatize(â€˜aardwolvesâ€™) uâ€™aardwolfâ€™ NLTKæ›´å¥½åœ°å®ç°Lemma # â½Šæœ¨æœ‰POS Tag,é»˜è®¤æ˜¯NN åè¯ &gt;&gt;&gt; wordnet_lemmatizer.lemmatize(â€˜areâ€™) # â€˜areâ€™ &gt;&gt;&gt; wordnet_lemmatizer.lemmatize(â€˜isâ€™) # â€˜isâ€™ # åŠ ä¸ŠPOS Tag &gt;&gt;&gt; wordnet_lemmatizer.lemmatize(â€˜isâ€™, pos=â€™vâ€™) # uâ€™beâ€™ &gt;&gt;&gt; wordnet_lemmatizer.lemmatize(â€˜areâ€™, pos=â€™vâ€™) # uâ€™beâ€™ 4.3 NLTK æ ‡æ³¨ POS Tag&gt;&gt;&gt; import nltk &gt;&gt;&gt; text = nltk.word_tokenize(&#x27;what does the fox say&#x27;) &gt;&gt;&gt; text [&#x27;what&#x27;, &#x27;does&#x27;, &#x27;the&#x27;, &#x27;fox&#x27;, &#x27;say&#x27;] &gt;&gt;&gt; nltk.pos_tag(text) [(&#x27;what&#x27;, &#x27;WDT&#x27;), (&#x27;does&#x27;, &#x27;VBZ&#x27;), (&#x27;the&#x27;, &#x27;DT&#x27;), (&#x27;fox&#x27;, &#x27;NNS&#x27;), (&#x27;say&#x27;, &#x27;VBP&#x27;)] 5. Stopwordsä¸€åƒä¸ª He æœ‰ä¸€åƒç§æŒ‡ä»£ ä¸€åƒä¸ª The æœ‰ä¸€åƒç§æŒ‡äº‹ å¯¹äºæ³¨é‡ç†è§£æ–‡æœ¬ã€æ„æ€ã€çš„åº”ç”¨åœºæ™¯æ¥è¯´ å…¨ä½“stopwordsåˆ—è¡¨ http://www.ranks.nl/stopwords å»é™¤ stopwords é¦–å…ˆè®°å¾—åœ¨consoleé‡Œé¢ä¸‹è½½ä¸€ä¸‹è¯åº“ï¼Œ æˆ–è€… nltk.download(â€˜stopwordsâ€™) import nltkfrom nltk.corpus import stopwords # å…ˆtokenâ¼€ä¸€æŠŠ,å¾—åˆ°â¼€ä¸€ä¸ªword_listword_list = nltk.word_tokenize(&#x27;what does the fox say&#x27;)# ç„¶åfilterâ¼€ä¸€æŠŠfiltered_words = [word for word in word_list if word not in stopwords.words(&#x27;english&#x27;)]filtered_words 6. æ–‡æœ¬é¢„å¤„ç†æµæ°´çº¿ä¸€æ¡typicalçš„æ–‡æœ¬é¢„å¤„ç†æµæ°´çº¿ æ–‡æœ¬é¢„å¤„ç†è®©æˆ‘ä»¬å¾—åˆ°äº†ä»€ä¹ˆ? 7. NLPä¸Šçš„ç»å…¸åº”ç”¨æƒ…æ„Ÿåˆ†æ ã€ æ–‡æœ¬ç›¸ä¼¼åº¦ ã€ æ–‡æœ¬åˆ†ç±» 7.1 æƒ…æ„Ÿåˆ†æ å“ªäº›æ˜¯å¤¸ä½ ï¼Ÿå“ªäº›æ˜¯é»‘ä½ ï¼Ÿ MLçš„æƒ…æ„Ÿåˆ†æ from nltk.classify import NaiveBayesClassifier # éšâ¼¿æ‰‹é€ ç‚¹è®­ç»ƒé›† s1 = &#x27;this is a good book&#x27; s2 = &#x27;this is a awesome book&#x27; s3 = &#x27;this is a bad book&#x27; s4 = &#x27;this is a terrible book&#x27; def preprocess(s): # Func: å¥â¼¦å¤„ç† # è¿™â¾¥ç®€å•çš„â½¤äº†ï¦ºsplit(), æŠŠå¥å­ä¸­æ¯ä¸ªå•è¯åˆ†å¼€ # æ˜¾ç„¶ è¿˜æœ‰æ›´å¤šçš„processing methodå¯ä»¥â½¤ return &#123;word: True for word in s.lower().split()&#125; # returné•¿è¿™æ ·: # &#123;&#x27;this&#x27;: True, &#x27;is&#x27;:True, &#x27;a&#x27;:True, &#x27;good&#x27;:True, &#x27;book&#x27;:True&#125; # å…¶ä¸­, å‰â¼€ä¸€ä¸ªå«fname, å¯¹åº”æ¯ä¸ªå‡ºç°çš„æ–‡æœ¬å•è¯; # åâ¼€ä¸€ä¸ªå«fval, æŒ‡çš„æ˜¯æ¯ä¸ªâ½‚æ–‡æœ¬å•è¯å¯¹åº”çš„å€¼ã€‚ # è¿™â¾¥é‡Œï§©æˆ‘ä»¬â½¤ç”¨æœ€ç®€å•çš„True,æ¥è¡¨ç¤º,è¿™ä¸ªè¯ã€å‡ºç°åœ¨å½“å‰çš„å¥ï¤†â¼¦å­ä¸­ã€çš„æ„ä¹‰ã€‚ # å½“ç„¶å•¦, æˆ‘ä»¬ä»¥åå¯ä»¥å‡çº§è¿™ä¸ªâ½…æ–¹ç¨‹, è®©å®ƒå¸¦æœ‰æ›´ï¤åŠ â½œç‰›é€¼çš„fval, æ¯”å¦‚ word2vec# æŠŠè®­ç»ƒé›†ç»™åšæˆæ ‡å‡†å½¢å¼ training_data = [[preprocess(s1), &#x27;pos&#x27;], [preprocess(s2), &#x27;pos&#x27;], [preprocess(s3), &#x27;neg&#x27;], [preprocess(s4), &#x27;neg&#x27;]] # å–‚ç»™modelåƒ model = NaiveBayesClassifier.train(training_data) # æ‰“å‡ºç»“æœ print(model.classify(preprocess(&#x27;this is a good book&#x27;))) 7.2 æ–‡æœ¬ç›¸ä¼¼åº¦Frequency é¢‘ç‡ç»Ÿè®¡ import nltkfrom nltk import FreqDist# åšä¸ªè¯åº“å…ˆcorpus = &#x27;this is my sentence &#x27; \\ &#x27;this is my life &#x27; \\ &#x27;this is the day&#x27;# éšä¾¿tokenizeä¸€ä¸‹, æ˜¾ç„¶, æ­£å¦‚ä¸Šæ–‡æåˆ°,# è¿™ï§©å¯ä»¥æ ¹æ®éœ€è¦åšä»»ä½•çš„preprocessing: stopwords, lemma, stemming, etc.# å€Ÿâ½¤NLTKçš„FreqDistç»Ÿè®¡â¼€ä¸‹â½‚å­—å‡ºç°çš„é¢‘ç‡ fdist = FreqDist(tokens)# å®ƒå°±ç±»ä¼¼äºâ¼€ä¸ªDic, å¸¦ä¸ŠæŸä¸ªå•è¯, å¯ä»¥çœ‹åˆ°å®ƒåœ¨æ•´ä¸ªæ–‡ç« ä¸­å‡ºç°çš„æ¬¡æ•°tokens = nltk.word_tokenize(corpus) print(tokens)# å¾—åˆ° token å¥½çš„ word list# [&#x27;this&#x27;, &#x27;is&#x27;, &#x27;my&#x27;, &#x27;sentence&#x27;,# &#x27;this&#x27;, &#x27;is&#x27;, &#x27;my&#x27;, &#x27;life&#x27;, &#x27;this&#x27;, # &#x27;is&#x27;, &#x27;the&#x27;, &#x27;day&#x27;]# å€Ÿâ½¤ NLTK çš„ FreqDist ç»Ÿè®¡â¼€ä¸‹æ–‡å­—å‡ºç°çš„é¢‘ç‡fdist = FreqDist(tokens)# å®ƒå°±ç±»ä¼¼äºâ¼€ä¸€ä¸ªDict# å¸¦ä¸ŠæŸä¸ªå•è¯, å¯ä»¥çœ‹åˆ°å®ƒåœ¨æ•´ä¸ªæ–‡ç« ä¸­å‡ºç°çš„æ¬¡æ•°print(fdist[&#x27;is&#x27;]) #3# å¥½, æ­¤åˆ», æˆ‘ä»¬å¯ä»¥æŠŠæœ€å¸¸â½¤çš„50ä¸ªå•è¯æ‹¿å‡ºæ¥ standard_freq_vector = fdist.most_common(50) size = len(standard_freq_vector) print &quot;size: %s&quot; % (size)print(standard_freq_vector)# [(&#x27;is&#x27;, 3), (&#x27;this&#x27;, 3), (&#x27;my&#x27;, 2),# (&#x27;the&#x27;, 1), (&#x27;day&#x27;, 1), (&#x27;sentence&#x27;, 1),# (&#x27;life&#x27;, 1)# Func: æŒ‰ç…§å‡ºç°é¢‘ç‡â¼¤å°, è®°å½•ä¸‹æ¯â¼€ä¸ªå•è¯çš„ä½ç½® def position_lookup(v): res = &#123;&#125; counter = 0 for word in v: res[word[0]] = counter counter += 1 return res# æŠŠæ ‡å‡†çš„å•è¯ä½ç½®è®°å½•ä¸‹æ¥standard_position_dict = position_lookup(standard_freq_vector) print(standard_position_dict)# å¾—åˆ°â¼€ä¸ªä½ç½®å¯¹ç…§è¡¨# &#123;&#x27;is&#x27;: 0, &#x27;the&#x27;: 3, &#x27;day&#x27;: 4, &#x27;this&#x27;: 1, &#x27;sentence&#x27;: 5, &#x27;my&#x27;: 2, &#x27;life&#x27;: 6&#125;# è¿™æ—¶, å¦‚æœæˆ‘ä»¬æœ‰ä¸ªæ–°å¥å­:sentence = &#x27;this is cool&#x27;# å…ˆæ–°å»ºâ¼€ä¸ªè·Ÿæˆ‘ä»¬çš„æ ‡å‡†vectoråŒæ ·â¼¤å°çš„å‘é‡ freq_vector = [0] * size# ç®€å•çš„Preprocessingtokens = nltk.word_tokenize(sentence) # å¯¹äºè¿™ä¸ªæ–°å¥â¼¦â¾¥çš„æ¯ä¸€ä¸ªå•è¯for word in tokens: try: # å¦‚æœåœ¨æˆ‘ä»¬çš„è¯åº“ï§©å‡ºç°è¿‡ # é‚£ä¹ˆå°±åœ¨&quot;æ ‡å‡†ä½ç½®&quot;ä¸Š+1 freq_vector[standard_position_dict[word]] += 1 except KeyError: # å¦‚æœæ˜¯ä¸ªæ–°è¯, å°± passæ‰ continueprint(freq_vector) # [1, 1, 0, 0, 0, 0, 0]# [1, 1, 0, 0, 0, 0, 0]# ç¬¬ä¸€ä¸ªä½ç½®ä»£è¡¨ is, å‡ºç°äº†ä¸€æ¬¡# ç¬¬äºŒä¸ªä½ç½®ä»£è¡¨ this, å‡ºç°äº†ä¸€æ¬¡ # åé¢éƒ½æ²¡æœ‰ 7.3 æ–‡æœ¬åˆ†ç±» tf-idfTF: Term Frequency, è¡¡é‡ä¸€ä¸ªtermåœ¨æ–‡æ¡£ä¸­å‡ºç°å¾—æœ‰å¤šé¢‘ç¹ã€‚ F(t) = (tå‡ºç°åœ¨æ–‡æ¡£ä¸­çš„æ¬¡æ•°) / (æ–‡æ¡£ä¸­çš„termæ€»æ•°)IDF: Inverse Document Frequency, è¡¡é‡ä¸€ä¸ªtermæœ‰å¤šé‡è¦ã€‚ æœ‰äº›è¯å‡ºç°çš„å¾ˆå¤š,ä½†æ˜¯æ˜æ˜¾ä¸æ˜¯å¾ˆæœ‰åµç”¨ã€‚ IDF(t) = log\\_e(æ–‡æ¡£æ€»æ•° / å«æœ‰tçš„æ–‡æ¡£æ€»æ•°) TF-IDF = TF * IDF ä¸¾ä¸ªæ —å­ğŸŒ° : ä¸€ä¸ªæ–‡æ¡£æœ‰100ä¸ªå•è¯,å…¶ä¸­å•è¯babyå‡ºç°äº†3æ¬¡ã€‚ é‚£ä¹ˆ,TF(baby) = (3/100) = 0.03. å¥½,ç°åœ¨æˆ‘ä»¬å¦‚æœæœ‰10Mçš„æ–‡æ¡£, babyå‡ºç°åœ¨å…¶ä¸­çš„1000ä¸ªæ–‡æ¡£ä¸­ã€‚ é‚£ä¹ˆ,IDF(baby) = log(10,000,000 / 1,000) = 4 æ‰€ä»¥, TF-IDF(baby) = TF(baby) * IDF(baby) = 0.03 * 4 = 0.12 nltk implement tf-idf from nltk.text import TextCollection# â¾¸å…ˆ, æŠŠæ‰€æœ‰çš„â½‚æ¡£æ”¾åˆ°TextCollectionç±»ä¸­ã€‚# è¿™ä¸ªç±»ä¼šâ¾ƒåŠ¨å¸®ä½ æ–­ï¤†, åšç»Ÿè®¡, åšè®¡ç®—corpus = TextCollection([&#x27;this is sentence one&#x27;, &#x27;this is sentence two&#x27;, &#x27;sentence three six&#x27;, &#x27;this is sentence three&#x27;])# ç›´æ¥å°±èƒ½ç®—å‡ºtfidf# (term: â¼€ä¸€å¥ï¤†è¯ä¸­çš„æŸä¸ªterm, text: è¿™å¥ï¤†è¯)print(corpus.tf_idf(&#x27;this&#x27;, &#x27;this is sentence four&#x27;))# 0.444342# åŒç†, æ€ä¹ˆå¾—åˆ°â¼€ä¸€ä¸ªæ ‡å‡†â¼¤å°çš„vectoræ¥è¡¨ç¤ºæ‰€æœ‰çš„å¥å­?# å¯¹äºæ¯ä¸ªæ–°å¥å­#new_sentence = &#x27;this is sentence five&#x27; # éå†â¼€ä¸€éæ‰€æœ‰çš„vocabularyä¸­çš„è¯:#for word in standard_vocab:# print(corpus.tf_idf(word, new_sentence)) # æˆ‘ä»¬ä¼šå¾—åˆ°â¼€ä¸ªå·¨é•¿(=æ‰€æœ‰vocabâ»“åº¦)çš„å‘é‡","categories":[{"name":"chatbot","slug":"chatbot","permalink":"http://iequa.com/categories/chatbot/"}],"tags":[{"name":"NLTK","slug":"NLTK","permalink":"http://iequa.com/tags/NLTK/"}]},{"title":"Chatbot Research 1 - èŠå¤©æœºå™¨äººçš„è¡Œä¸šç»¼è¿°","slug":"chatbot/chatbot-research1","date":"2018-08-11T06:00:21.000Z","updated":"2020-10-23T02:03:18.011Z","comments":true,"path":"2018/08/11/chatbot/chatbot-research1/","link":"","permalink":"http://iequa.com/2018/08/11/chatbot/chatbot-research1/","excerpt":"è‹±æ–‡åŸæ–‡ï¼š ã€ŠDeep Learning For Chatbots, Part 1 - Introductionã€‹ ä¸­æ–‡ç¿»è¯‘ï¼š ã€ŠèŠå¤©æœºå™¨äººä¸­çš„æ·±åº¦å­¦ä¹ å¯¼è¯»ã€‹","text":"è‹±æ–‡åŸæ–‡ï¼š ã€ŠDeep Learning For Chatbots, Part 1 - Introductionã€‹ ä¸­æ–‡ç¿»è¯‘ï¼š ã€ŠèŠå¤©æœºå™¨äººä¸­çš„æ·±åº¦å­¦ä¹ å¯¼è¯»ã€‹ è¿™ç¯‡åšæ–‡ä¸»è¦æ¦‚è¿°äº†ç›®å‰èŠå¤©æœºå™¨äººä¸»è¦ç”¨åˆ°çš„æŠ€æœ¯ï¼Œä»å®è§‚ä¸Šè¿›è¡Œä»‹ç»ï¼Œä¸æ¶‰åŠå…·ä½“çš„æŠ€æœ¯ç»†èŠ‚ã€‚ èŠå¤©æœºå™¨äºº (Chatbot)ï¼Œä¹Ÿè¢«ç§°ä¸ºå¯¹è¯å¼•æ“æˆ–è€…å¯¹è¯ç³»ç»Ÿï¼Œæ˜¯ç›®å‰çš„çƒ­ç‚¹ä¹‹ä¸€ã€‚å¾®è½¯å…¬å¸åœ¨èŠå¤©æœºå™¨äººä¸Šçš„æŠ•å…¥å·¨å¤§ï¼ˆé“¾æ¥ï¼‰ï¼Œè‘—åäº§å“æœ‰å°å†° (xiaoice)ã€bot frameworkç­‰ï¼Œå…¶ä»–å…¬å¸ä¹Ÿçº·çº·åœ¨è¿™ä¸ªé¢†åŸŸå‘åŠ›ï¼Œå¦‚Facebookçš„Mï¼Œè‹¹æœå…¬å¸çš„Siriç­‰ç­‰ã€‚æ­¤å¤–ï¼Œä¸€å¤§æ‰¹çš„åˆ›ä¸šå…¬å¸å‘å¸ƒäº†ç±»ä¼¼çš„äº§å“ï¼Œä¾‹å¦‚å®¢æˆ·åº”ç”¨Operatorï¼Œx.aiï¼Œbot framework Chatfuelï¼Œbotå¼€å‘å·¥å…· Howdyâ€™s Botkitã€‚å¾®è½¯ä¹Ÿå‘å¸ƒäº†ä¾›å¼€å‘è€…ä½¿ç”¨çš„ bot developer framework è¿˜æœ‰ä¸€äº›åº”ç”¨æ¡ˆä¾‹ï¼Œåˆ—ä¸¾å¦‚ä¸‹ï¼š æ¡ˆä¾‹:è¯­éŸ³åŠ©æ‰‹ Siri æ¡ˆä¾‹:é¤é¥® Pizza Hut æ¡ˆä¾‹:å¥èº« Fitness Tips æ¡ˆä¾‹:æ—…æ¸¸ expedia æ¡ˆä¾‹:åŒ»ç–— healthtap æ¡ˆä¾‹:æ–°é—» wordpress æ¡ˆä¾‹:è´¢ç» meetcleo è®¸å¤šå…¬å¸å¸Œæœ›èƒ½å¼€å‘å‡ºä¸ç”¨æˆ·è¿›è¡Œè‡ªç„¶è¯­è¨€å¼å¯¹è¯çš„æœºå™¨äººï¼Œå¹¶ä¸”å£°ç§°ä½¿ç”¨äº†NLPå’Œæ·±åº¦å­¦ä¹ ç›¸å…³æŠ€æœ¯ä½¿ä¹‹æˆä¸ºå¯èƒ½ï¼Œç„¶è€Œè¿™å¹¶ä¸å®¹æ˜“å®ç°ã€‚åœ¨è¿™ä¸ªåšæ–‡ç³»åˆ—ä¸­ï¼Œæˆ‘å°†ä¼šé‡æ¸©ä¸€äº›è¢«ç”¨äºèŠå¤©æœºå™¨äººä¸­çš„æ·±åº¦å­¦ä¹ æŠ€æœ¯ï¼ŒæŠ«éœ²å‡ºç›®å‰æŠ€æœ¯èƒ½å¤Ÿè§£å†³æˆ–è€…å¯èƒ½è§£å†³çš„é—®é¢˜ä»¥åŠå‡ ä¹éš¾ä»¥è§£å†³çš„é—®é¢˜ã€‚è¿™ç¯‡æ–‡ç« æ˜¯ä¸ªæ¦‚è¿°ï¼Œåœ¨æ¥ä¸‹æ¥çš„åšæ–‡ä¸­å°†ä»‹ç»å…·ä½“çš„æŠ€æœ¯ç»†èŠ‚ã€‚ 1. æ¨¡å‹åˆ†ç±»1.1 æ£€ç´¢æŠ€æœ¯æ¨¡å‹ VS ç”Ÿæˆå¼æ¨¡å‹åŸºäºæ£€ç´¢æŠ€æœ¯çš„æ¨¡å‹è¾ƒä¸ºç®€å•ï¼Œä¸»è¦æ˜¯æ ¹æ®ç”¨æˆ·çš„è¾“å…¥å’Œä¸Šä¸‹æ–‡å†…å®¹ï¼Œä½¿ç”¨äº†çŸ¥è¯†åº“ï¼ˆå­˜å‚¨äº†äº‹å…ˆå®šä¹‰å¥½çš„å›å¤å†…å®¹ï¼‰å’Œä¸€äº›å¯å‘å¼æ–¹æ³•æ¥å¾—åˆ°ä¸€ä¸ªåˆé€‚çš„å›å¤ã€‚å¯å‘å¼æ–¹æ³•ç®€å•çš„æœ‰åŸºäºè§„åˆ™çš„è¡¨è¾¾å¼åŒ¹é…ï¼Œå¤æ‚çš„æœ‰ä¸€äº›æœºå™¨å­¦ä¹ é‡Œçš„åˆ†ç±»å™¨ã€‚è¿™äº›ç³»ç»Ÿä¸èƒ½å¤Ÿç”Ÿæˆä»»ä½•æ–°çš„å†…å®¹ï¼Œåªæ˜¯ä»ä¸€ä¸ªå›ºå®šçš„æ•°æ®é›†ä¸­æ‰¾åˆ°åˆé€‚çš„å†…å®¹ä½œä¸ºå›å¤ã€‚ ç”Ÿæˆå¼æ¨¡å‹åˆ™æ›´åŠ å¤æ‚ï¼Œå®ƒä¸ä¾èµ–äºé¢„å®šä¹‰å¥½çš„å›å¤å†…å®¹ï¼Œè€Œæ˜¯é€šè¿‡æŠ“å–(Scratch)çš„æ–¹æ³•ç”Ÿæˆæ–°çš„å›å¤å†…å®¹ã€‚ç”Ÿæˆå¼æ¨¡å‹å…¸å‹çš„æœ‰åŸºäºæœºå™¨ç¿»è¯‘æ¨¡å‹çš„ï¼Œä¸ä¼ ç»Ÿæœºå™¨ç¿»è¯‘æ¨¡å‹ä¸åŒçš„æ˜¯ï¼Œç”Ÿæˆå¼æ¨¡å‹çš„ä»»åŠ¡ä¸æ˜¯å°†ä¸€å¥è¯ç¿»è¯‘æˆå…¶ä»–è¯­è¨€çš„ä¸€å¥è¯ï¼Œè€Œæ˜¯å°†ç”¨æˆ·çš„è¾“å…¥[ç¿»è¯‘]ä¸ºä¸€ä¸ªå›ç­”(response) 1.2 æ¨¡å‹åˆ†ç±»æ€»ç»“ä»¥ä¸Šä¸¤ç§æ¨¡å‹å‡æœ‰ä¼˜ç¼ºç‚¹ã€‚å¯¹äºåŸºäºæ£€ç´¢æŠ€æœ¯çš„æ¨¡å‹ï¼Œç”±äºä½¿ç”¨äº†çŸ¥è¯†åº“ä¸”æ•°æ®ä¸ºé¢„å…ˆå®šä¹‰å¥½çš„ï¼Œå› æ­¤è¿›è¡Œå›å¤çš„å†…å®¹è¯­æ³•ä¸Šè¾ƒä¸ºé€šé¡ºï¼Œè¾ƒå°‘å‡ºç°è¯­æ³•é”™è¯¯ï¼›ä½†æ˜¯åŸºäºæ£€ç´¢æŠ€æœ¯çš„æ¨¡å‹ä¸­æ²¡æœ‰ä¼šè¯æ¦‚å¿µï¼Œä¸èƒ½ç»“åˆä¸Šä¸‹æ–‡ç»™å‡ºæ›´åŠ [æ™ºèƒ½]çš„å›å¤ã€‚è€Œç”Ÿæˆå¼æ¨¡å‹åˆ™æ›´åŠ [æ™ºèƒ½]ä¸€äº›ï¼Œå®ƒèƒ½å¤Ÿæ›´åŠ æœ‰æ•ˆåœ°åˆ©ç”¨ä¸Šä¸‹æ–‡ä¿¡æ¯ä»è€ŒçŸ¥é“ä½ åœ¨è®¨è®ºçš„ä¸œè¥¿æ˜¯ä»€ä¹ˆï¼›ç„¶è€Œç”Ÿæˆå¼æ¨¡å‹æ¯”è¾ƒéš¾ä»¥è®­ç»ƒï¼Œå¹¶ä¸”è¾“å‡ºçš„å†…å®¹ç»å¸¸å­˜åœ¨ä¸€äº›è¯­æ³•é”™è¯¯ï¼ˆå°¤å…¶å¯¹äºé•¿å¥å­è€Œè¨€ï¼‰ï¼Œä»¥åŠæ¨¡å‹è®­ç»ƒéœ€è¦å¤§è§„æ¨¡çš„æ•°æ®ã€‚ æ·±åº¦å­¦ä¹ æŠ€æœ¯éƒ½èƒ½å¤Ÿç”¨äºåŸºäºæ£€ç´¢æŠ€æœ¯çš„æ¨¡å‹å’Œç”Ÿæˆå¼æ¨¡å‹ä¸­ï¼Œä½†æ˜¯ç›®å‰çš„ç ”ç©¶çƒ­ç‚¹åœ¨ç”Ÿæˆå¼æ¨¡å‹ä¸Šã€‚æ·±åº¦å­¦ä¹ æ¡†æ¶ä¾‹å¦‚Sequence to Sequenceéå¸¸é€‚åˆç”¨æ¥ç”Ÿæˆæ–‡æœ¬ï¼Œéå¸¸å¤šçš„ç ”ç©¶è€…å¸Œæœ›èƒ½å¤Ÿåœ¨è¿™ä¸ªé¢†åŸŸå–å¾—æˆåŠŸã€‚ç„¶è€Œç›®å‰è¿™ä¸€å—çš„ç ”ç©¶è¿˜åœ¨åˆæœŸé˜¶æ®µï¼Œå·¥ä¸šç•Œçš„äº§å“æ›´å¤šçš„è¿˜æ˜¯ä½¿ç”¨åŸºäºæ£€ç´¢è®¡ç®—çš„æ¨¡å‹ã€‚ 2. é—®é¢˜åˆ†ç±»2.1 çŸ­å¯¹è¯ VS é•¿å¯¹è¯ç›´è§‚ä¸Šå¤„ç†é•¿å¯¹è¯å†…å®¹å°†æ›´åŠ å›°éš¾ï¼Œè¿™æ˜¯å› ä¸ºä½ éœ€è¦åœ¨å½“å‰å¯¹è¯çš„æƒ…å¢ƒä¸‹çŸ¥é“ä¹‹å‰çš„å¯¹è¯è¯´è¿‡ä»€ä¹ˆã€‚å¦‚æœæ˜¯ä¸€é—®ä¸€ç­”çš„å½¢å¼ï¼ŒæŠ€æœ¯ä¸Šè¿™å°†ç®€å•çš„å¤šã€‚é€šå¸¸å¯¹äºå®¢æœå¯¹è¯è€Œè¨€ï¼Œé•¿å¯¹è¯æ›´åŠ å¸¸è§ï¼Œä¸€æ¬¡å¯¹è¯ä¸­å¾€å¾€ä¼šä¼´éšç€å¤šä¸ªå…³è”é—®é¢˜ã€‚ 2.2 å¼€æ”¾åŸŸ VS ç‰¹å®šé¢†åŸŸé¢å‘å¼€æ”¾åŸŸçš„èŠå¤©æœºå™¨äººæŠ€æœ¯é¢ä¸´æ›´å¤šå›°éš¾ï¼Œè¿™æ˜¯å› ä¸ºä¼šè¯å¯èƒ½æ¶‰åŠçš„é¢å¤ªå¹¿ï¼Œæ²¡æœ‰ä¸€ä¸ªæ¸…æ™°çš„ç›®æ ‡å’Œæ„å›¾ã€‚åœ¨ä¸€äº›ç¤¾äº¤ç½‘ç«™ä¾‹å¦‚Twitterå’ŒRedditä¸Šçš„ä¼šè¯æ˜¯å±äºå¼€æ”¾åŸŸçš„ï¼Œä¼šè¯æ¶‰åŠçš„ä¸»é¢˜å¤šç§å¤šæ ·ï¼Œéœ€è¦çš„çŸ¥è¯†é‡ä¹Ÿå°†éå¸¸å·¨å¤§ã€‚ é¢å‘ç‰¹å®šé¢†åŸŸçš„ç›¸å…³æŠ€æœ¯åˆ™ç›¸å¯¹ç®€å•ä¸€äº›ï¼Œè¿™æ˜¯å› ä¸ºç‰¹å®šé¢†åŸŸç»™ä¼šè¯çš„ä¸»é¢˜è¿›è¡Œäº†é™åˆ¶ï¼Œç›®æ ‡å’Œæ„å›¾ä¹Ÿæ›´åŠ æ¸…æ™°ï¼Œå…¸å‹çš„ä¾‹å­æœ‰å®¢æœç³»ç»ŸåŠ©æ‰‹å’Œè´­ç‰©åŠ©æ‰‹ã€‚è¿™äº›ç³»ç»Ÿé€šå¸¸æ˜¯ä¸ºäº†å®ŒæˆæŸäº›ç‰¹å®šä»»åŠ¡ï¼Œå°½ç®¡ç”¨æˆ·åœ¨è¯¥ç³»ç»Ÿä¸­ä¹Ÿèƒ½å¤Ÿé—®äº›å…¶ä»–æ–¹é¢çš„ä¸œè¥¿ï¼Œä½†æ˜¯ç³»ç»Ÿå¹¶ä¸ä¼šç»™å‡ºç›¸åº”çš„å›å¤ã€‚ 3. é¢ä¸´çš„æŒ‘æˆ˜ä¸‹é¢ä»‹ç»ä¸€ä¸‹èŠå¤©æœºå™¨äººæŠ€æœ¯æ‰€é¢ä¸´çš„æŒ‘æˆ˜ã€‚ 3.1 å¦‚ä½•ç»“åˆä¸Šä¸‹æ–‡ä¿¡æ¯ä¸ºäº†äº§ç”Ÿè´¨é‡æ›´é«˜çš„å›å¤ï¼ŒèŠå¤©æœºå™¨äººç³»ç»Ÿé€šå¸¸éœ€è¦åˆ©ç”¨ä¸€äº›ä¸Šä¸‹æ–‡ä¿¡æ¯(Context)ï¼Œè¿™é‡Œçš„ä¸Šä¸‹æ–‡ä¿¡æ¯åŒ…æ‹¬äº†å¯¹è¯è¿‡ç¨‹ä¸­çš„è¯­è¨€ä¸Šä¸‹æ–‡ä¿¡æ¯å’Œç”¨æˆ·çš„èº«ä»½ä¿¡æ¯ç­‰ã€‚åœ¨é•¿å¯¹è¯ä¸­äººä»¬å…³æ³¨çš„æ˜¯ä¹‹å‰è¯´äº†ä»€ä¹ˆå†…å®¹ä»¥åŠäº§ç”Ÿäº†ä»€ä¹ˆå†…å®¹çš„äº¤æ¢ï¼Œè¿™æ˜¯è¯­è¨€ä¸Šä¸‹æ–‡ä¿¡æ¯çš„å…¸å‹ã€‚å¸¸è§çš„æ–¹æ³•æ˜¯å°†ä¸€ä¸ªä¼šè¯è½¬åŒ–ä¸ºå‘é‡å½¢å¼ï¼Œä½†è¿™å¯¹é•¿ä¼šè¯è€Œè¨€æ˜¯å›°éš¾çš„ã€‚è®ºæ–‡Building End-To-End Dialogue Systems Using Generative Hierarchical Neural Network Modelså’ŒAttention with Intention for a Neural Network Conversation Modelä¸­çš„å®éªŒç»“æœè¡¨æ˜äº†è¿™ä¸€ç‚¹ã€‚å¦å¤–ï¼Œå¯ä»¥ç»“åˆçš„ä¸Šä¸‹æ–‡ä¿¡æ¯è¿˜åŒ…æ‹¬ä¼šè¯è¿›è¡Œæ—¶çš„æ—¥æœŸåœ°ç‚¹ä¿¡æ¯ã€ç”¨æˆ·ä¿¡æ¯ç­‰ã€‚ 3.2 è¯­ä¹‰ä¸€è‡´æ€§ç†è®ºä¸Šæ¥è¯´ï¼Œæœºå™¨äººé¢å¯¹ç›¸åŒè¯­ä¹‰è€Œä¸åŒå½¢å¼çš„é—®é¢˜åº”è¯¥ç»™äºˆä¸€è‡´çš„å›å¤ï¼Œä¾‹å¦‚è¿™ä¸¤ä¸ªé—®é¢˜[How old are you?]å’Œ[Whatâ€™s your age?]ã€‚è¿™ç†è§£èµ·æ¥æ˜¯ç®€å•çš„ï¼Œä½†å´æ˜¯å­¦æœ¯ç•Œç›®å‰çš„éš¾é¢˜ä¹‹ä¸€ï¼ˆå¦‚ä¸‹å›¾ï¼‰ã€‚è®¸å¤šç³»ç»Ÿéƒ½è¯•å›¾å¯¹ç›¸åŒè¯­ä¹‰è€Œä¸åŒå½¢å¼çš„é—®é¢˜ç»™äºˆè¯­ä¹‰ä¸Šåˆç†çš„å›å¤ï¼Œä½†å´æ²¡æœ‰è€ƒè™‘ä¸€è‡´æ€§ï¼Œæœ€å¤§çš„åŸå› åœ¨äºè®­ç»ƒæ¨¡å‹çš„æ•°æ®æ¥æºäºå¤§é‡ä¸åŒçš„ç”¨æˆ·ï¼Œè¿™å¯¼è‡´æœºå™¨äººå¤±å»äº†å›ºå®šç»Ÿä¸€çš„äººæ ¼ã€‚è®ºæ–‡A Persona-Based Neural Conversation Modelä¸­æåŠçš„æ¨¡å‹æ—¨åœ¨åˆ›å»ºå…·æœ‰å›ºå®šç»Ÿä¸€äººæ ¼çš„æœºå™¨äººã€‚ 3.3 å¯¹è¯æ¨¡å‹çš„è¯„æµ‹è¯„ä»·ä¸€ä¸ªå¯¹è¯æ¨¡å‹çš„å¥½ååœ¨äºå®ƒæ˜¯å¦å¾ˆå¥½åœ°å®Œæˆäº†æŸé¡¹ä»»åŠ¡ï¼Œä¾‹å¦‚åœ¨å¯¹è¯ä¸­è§£å†³äº†å®¢æˆ·çš„é—®é¢˜ã€‚è¿™æ ·çš„è®­ç»ƒæ•°æ®éœ€è¦äººå·¥æ ‡æ³¨å’Œè¯„æµ‹ï¼Œæ‰€ä»¥è·å–ä¸Šéœ€è¦ä¸€å®šäººåŠ›ä»£ä»·ã€‚æœ‰æ—¶åœ¨å¼€æ”¾åŸŸä¸­çš„å¯¹è¯ç³»ç»Ÿä¹Ÿæ²¡æœ‰ä¸€ä¸ªæ¸…æ™°çš„ä¼˜åŒ–ç›®æ ‡ã€‚ç”¨äºæœºå™¨ç¿»è¯‘çš„è¯„æµ‹æŒ‡æ ‡BLEUä¸èƒ½é€‚ç”¨äºæ­¤ï¼Œæ˜¯å› ä¸ºå®ƒçš„è®¡ç®—åŸºç¡€æ˜¯è¯­è¨€è¡¨é¢ä¸Šçš„åŒ¹é…ç¨‹åº¦ï¼Œè€Œå¯¹è¯ä¸­çš„å›ç­”å¯ä»¥æ˜¯å®Œå…¨ä¸åŒè¯å‹ä½†è¯­ä¹‰é€šé¡ºçš„è¯­å¥ã€‚è®ºæ–‡How NOT To Evaluate Your Dialogue System: An Empirical Study of Unsupervised Evaluation Metrics for Dialogue Response Generationä¸­ç»™å‡ºç»“è®ºï¼Œç›®å‰å¸¸ç”¨çš„è¯„æµ‹æŒ‡æ ‡å‡ä¸äººå·¥è¯„æµ‹æ— å…³ã€‚ 3.4 æ„å›¾å’Œå›å¤å¤šæ ·æ€§ç”Ÿæˆå¼æ¨¡å‹ä¸­çš„ä¸€ä¸ªæ™®éé—®é¢˜æ˜¯ï¼Œå®ƒä»¬éƒ½æƒ³è¦ç”Ÿæˆä¸€äº›é€šç”¨çš„å›ç­”ï¼Œä¾‹å¦‚[Thatâ€™s great!]å’Œ[I donâ€™t know]è¿™æ ·çš„å¯ä»¥åº”ä»˜è®¸å¤šçš„ç”¨æˆ·è¯¢é—®ã€‚æ—©æœŸçš„Googleæ™ºèƒ½å›å¤åŸºæœ¬ä¸Šä»¥[I love you]å›å¤æ‰€æœ‰çš„ä¸œè¥¿é“¾æ¥ï¼Œè¿™æ˜¯ä¸€äº›æ¨¡å‹æœ€ç»ˆè®­ç»ƒå‡ºæ¥çš„ç»“æœï¼ŒåŸå› åœ¨äºè®­ç»ƒæ•°æ®å’Œè®­ç»ƒçš„ä¼˜åŒ–ç›®æ ‡ã€‚å› æ­¤ï¼Œæœ‰äº›ç ”ç©¶å­¦è€…å¼€å§‹å…³æ³¨å¦‚ä½•æå‡æœºå™¨äººçš„å›å¤çš„å¤šæ ·æ€§ï¼Œç„¶è€Œäººä»¬åœ¨å¯¹è¯è¿‡ç¨‹ä¸­çš„å›å¤ä¸è¯¢é—®æœ‰ä¸€å®šç‰¹å®šå…³ç³»ï¼Œæ˜¯æœ‰ä¸€å®šæ„å›¾çš„ï¼Œè€Œè®¸å¤šé¢å‘å¼€æ”¾åŸŸçš„æœºå™¨äººä¸å…·å¤‡ç‰¹å®šçš„æ„å›¾ã€‚ 3.5 å®é™…æ•ˆæœä»¥ç›®å‰çš„ç ”ç©¶æ°´å¹³æ‰€åˆ¶é€ çš„æœºå™¨äººèƒ½å¤Ÿå–å¾—çš„æ•ˆæœå¦‚ä½•ï¼Ÿä½¿ç”¨åŸºäºæ£€ç´¢æŠ€æœ¯çš„æ˜¾ç„¶æ— æ³•åˆ¶ä½œå‡ºé¢å‘å¼€æ”¾åŸŸçš„æœºå™¨äººï¼Œè¿™æ˜¯å› ä¸ºä½ ä¸èƒ½ç¼–å†™è¦†ç›–æ‰€æœ‰é¢†åŸŸçš„è¯­æ–™ï¼›è€Œç”Ÿæˆå¼çš„é¢å‘å¼€æ”¾åŸŸçš„æœºå™¨äººè¿˜å±äºé€šç”¨äººå·¥æ™ºèƒ½(Artifical General Intelligence, AGI)æ°´å¹³ï¼Œè·ç¦»ç†æƒ³çŠ¶æ€è¿˜ç›¸è·ç”šè¿œï¼Œä½†ç›¸å…³ç ”ç©¶å­¦è€…è¿˜åœ¨è‡´åŠ›äºæ­¤ã€‚ å¯¹äºç‰¹å®šé¢†åŸŸçš„æœºå™¨äººï¼ŒåŸºäºæ£€ç´¢çš„æŠ€æœ¯å’Œç”Ÿæˆå¼æ¨¡å‹éƒ½èƒ½å¤Ÿåˆ©ç”¨ã€‚ä½†æ˜¯å¯¹äºé•¿å¯¹è¯çš„æƒ…å¢ƒï¼Œä¹Ÿé¢ä¸´è®¸å¤šå›°éš¾ã€‚ åœ¨æœ€è¿‘å¯¹Andrew NGçš„é‡‡è®¿ä¸­ï¼ŒNGæåˆ°ï¼š ç›®å‰æ·±åº¦å­¦ä¹ çš„ä»·å€¼ä¸»è¦ä½“ç°åœ¨èƒ½å¤Ÿè·å–å¤§é‡æ•°æ®çš„ç‰¹å®šé¢†åŸŸã€‚ ç›®å‰ä¸€ä¸ªæ— æ³•åšçš„äº‹æƒ…æ˜¯äº§ç”Ÿä¸€ä¸ªæœ‰æ„ä¹‰çš„å¯¹è¯ã€‚ è¯¦ç»†ï¼š å½“ä»Šæ·±åº¦å­¦ä¹ çš„ä»·å€¼åœ¨ä½ å¯ä»¥è·å¾—è®¸å¤šæ•°æ®çš„ç‹­çª„é¢†åŸŸå†…ã€‚æœ‰ä¸€ä»¶äº‹å®ƒåšä¸åˆ°ï¼šè¿›è¡Œæœ‰æ„ä¹‰çš„å¯¹è¯ã€‚å­˜åœ¨ä¸€äº›æ¼”ç¤ºï¼Œå¹¶ä¸”å¦‚æœä½ ä»”ç»†æŒ‘é€‰è¿™äº›å¯¹è¯ï¼Œçœ‹èµ·æ¥å°±åƒå®ƒæ­£åœ¨è¿›è¡Œæœ‰æ„ä¹‰çš„å¯¹è¯ï¼Œä½†æ˜¯å¦‚æœä½ äº²è‡ªå°è¯•ï¼Œå®ƒå°±ä¼šå¿«é€Ÿåç¦»è½¨é“ã€‚ è®¸å¤šåˆ›ä¸šå…¬å¸å£°ç§°åªè¦æœ‰è¶³å¤Ÿå¤šçš„æ•°æ®ï¼Œå°±èƒ½å¤Ÿäº§ç”Ÿè‡ªåŠ¨æ™ºèƒ½çš„å¯¹è¯ç³»ç»Ÿã€‚ç„¶è€Œï¼Œç›®å‰çš„æ°´å¹³ç”Ÿäº§å‡ºé¢å‘ä¸€ä¸ªç‰¹å®šçš„å­é¢†åŸŸçš„å¯¹è¯åº”ç”¨ï¼ˆå¦‚åˆ©ç”¨Uberæ‰“è½¦ï¼‰ï¼Œè€Œå¯¹äºä¸€ä¸ªç¨å¾®å¼€æ”¾ç‚¹çš„é¢†åŸŸå°±éš¾ä»¥å®ç°äº†ï¼ˆå¦‚è‡ªåŠ¨é”€å”®ï¼‰ã€‚ä½†æ˜¯ï¼Œå¸®åŠ©ç”¨æˆ·æä¾›è‡ªåŠ¨å›å¤å»ºè®®ä»¥åŠè¯­æ³•çº æ­£è¿˜æ˜¯å¯è¡Œçš„ã€‚ ä½¿ç”¨åŸºäºæ£€ç´¢æŠ€æœ¯çš„å¯¹è¯ç³»ç»Ÿæ›´åŠ å¯æ§å’Œç¨³å®šï¼Œç»™å‡ºçš„å›å¤å‡ºç°è¯­æ³•é”™è¯¯çš„å‡ ç‡æ›´ä½ã€‚è€Œä½¿ç”¨ç”Ÿæˆå¼æ¨¡å‹çš„é£é™©åœ¨äºå›å¤ä¸å¯æ§ï¼Œä¸”å®¹æ˜“å‡ºç°ä¸€äº›é£é™©ï¼Œä¾‹å¦‚å¾®è½¯çš„Tayã€‚ 4. å³å°†åˆ°æ¥çš„äº‹æƒ…å’Œé˜…è¯»åˆ—è¡¨åœ¨ä¹‹åçš„åšæ–‡ä¸­å°†å…·ä½“ä»‹ç»æ·±åº¦å­¦ä¹ æ–¹é¢çš„æŠ€æœ¯ç»†èŠ‚ã€‚æå‰é˜…è¯»ä¸‹é¢çš„æ–‡ç« å°†ä¼šå¯¹åé¢çš„å­¦ä¹ æ›´åŠ æœ‰å¸®åŠ©ã€‚ Neural Responding Machine for Short-Text Conversation (2015-03) A Neural Conversational Model (2015-06) A Neural Network Approach to Context-Sensitive Generation of Conversational Responses (2015-06) The Ubuntu Dialogue Corpus: A Large Dataset for Research in Unstructured Multi-Turn Dialogue Systems (2015-06) Building End-To-End Dialogue Systems Using Generative Hierarchical Neural Network Models (2015-07) A Diversity-Promoting Objective Function for Neural Conversation Models (2015-10) Attention with Intention for a Neural Network Conversation Model (2015-10) Improved Deep Learning Baselines for Ubuntu Corpus Dialogs (2015-10) A Survey of Available Corpora for Building Data-Driven Dialogue Systems (2015-12) Incorporating Copying Mechanism in Sequence-to-Sequence Learning (2016-03) A Persona-Based Neural Conversation Model (2016-03) How NOT To Evaluate Your Dialogue System: An Empirical Study of Unsupervised Evaluation Metrics for Dialogue Response Generation (2016-03) æ•°æ®é©±åŠ¨çš„æ„ä¹‰æ˜¯ï¼š ç®—æ³•è¶Šç®€å•ï¼Œè§£é‡Šæ€§è¶Šå¥½ æ•°æ®é‡è¶³å¤Ÿå¤§ï¼Œè¦†ç›–çš„çœŸå®ä¸–ç•Œçš„å¤§éƒ¨åˆ†åœºæ™¯","categories":[{"name":"chatbot","slug":"chatbot","permalink":"http://iequa.com/categories/chatbot/"}],"tags":[{"name":"Chatbot","slug":"Chatbot","permalink":"http://iequa.com/tags/Chatbot/"}]},{"title":"Spark dev Optimize 10 Items","slug":"spark/spark-aura-6.2-spark-dev-optimization-1-7","date":"2018-08-10T02:07:21.000Z","updated":"2020-12-04T00:59:07.104Z","comments":true,"path":"2018/08/10/spark/spark-aura-6.2-spark-dev-optimization-1-7/","link":"","permalink":"http://iequa.com/2018/08/10/spark/spark-aura-6.2-spark-dev-optimization-1-7/","excerpt":"","text":"è°ƒä¼˜: å¼€å‘è°ƒä¼˜ èµ„æºè°ƒä¼˜ æ•°æ®å€¾æ–œ shuffle æ—§çŸ¥è¯†ç‚¹: æ•°æ®å€¾æ–œ, å¼€å‘è°ƒä¼˜çš„ä¸€éƒ¨åˆ† æ–°çŸ¥è¯†: sparkçš„å†…å­˜æ¨¡å‹, sparkçš„èµ„æºè°ƒä¼˜, sparkçš„shuffle æ•´å¥—æ–¹æ¡ˆä¸»è¦åˆ†ä¸ºå¼€å‘è°ƒä¼˜ã€èµ„æºè°ƒä¼˜ã€æ•°æ®å€¾æ–œè°ƒä¼˜ã€shuffleè°ƒä¼˜å‡ ä¸ªéƒ¨åˆ†ã€‚ å¼€å‘è°ƒä¼˜å’Œèµ„æºè°ƒä¼˜æ˜¯æ‰€æœ‰Sparkä½œä¸šéƒ½éœ€è¦æ³¨æ„å’Œéµå¾ªçš„ä¸€äº›åŸºæœ¬åŸåˆ™ï¼Œæ˜¯é«˜æ€§èƒ½Sparkä½œä¸šçš„åŸºç¡€ï¼› æ•°æ®å€¾æ–œè°ƒä¼˜ï¼Œä¸»è¦è®²è§£äº†ä¸€å¥—å®Œæ•´çš„ç”¨æ¥è§£å†³Sparkä½œä¸šæ•°æ®å€¾æ–œçš„è§£å†³æ–¹æ¡ˆï¼› shuffleè°ƒä¼˜ï¼Œä¸»è¦è®²è§£äº†å¦‚ä½•å¯¹Sparkä½œä¸šçš„shuffleè¿è¡Œè¿‡ç¨‹ä»¥åŠç»†èŠ‚è¿›è¡Œè°ƒä¼˜ã€‚ ä»Šå¤©çš„å†…å®¹: å¼€å‘è°ƒä¼˜ æ•°æ®å€¾æ–œ å¼€å‘è°ƒä¼˜ 10ç‚¹1. é¿å…åˆ›å»ºé‡å¤çš„RDD mapreduce çš„æ‰§è¡Œè¿‡ç¨‹ä¸­, å¦‚æœæœ‰ reducer çš„è¯, é‚£ä¹ˆå°±ä¸€å®šä¼šè¿›è¡Œæ’åº. è€Œä¸”è¿™ä¸ªæ’åº, å¹¶ä¸æ˜¯å¯¹æˆ‘ä»¬æœ€ç»ˆçš„è®¡ç®—ç»“æœæ’åº. è¿™ä¸ªæ’åºå¯¹æˆ‘ä»¬çš„ç»“æœè²Œä¼¼æ²¡ä»€ä¹ˆç”¨å¤„, ä½†æ˜¯å‘¢ï¼Œåˆä¸€å®šè¦æœ‰. åŸå› æ˜¯ä»€ä¹ˆå‘¢? æœ€ç»ˆçš„ç»“è®ºï¼š å¦‚æœæ˜¯éœ€è¦å¯¹ä¸€ä¸ªæ–‡ä»¶è¿›è¡Œå¤šæ¬¡çš„è®¡ç®—, é‚£ä¹ˆæ³¨æ„, æœ€å¥½å°± only read one time. RDD: ä¸å¯å˜, å¯åˆ†åŒºçš„ å¼¹æ€§æ•°æ®é›† 2. å°½å¯èƒ½å¤ç”¨åŒä¸€ä¸ªRDDmap(x =&gt; x+1)map(x =&gt; x*2)map(x =&gt; 2 * (x+1)) 3. å¯¹å¤šæ¬¡ä½¿ç”¨çš„RDDè¿›è¡ŒæŒä¹…åŒ–cachepersist val rdd2 = rdd1.map.reducerdd2.cache rdd2.sort.map()rdd2.groupByKey rdd1.map.reduce.sort.map()rdd1.map.reduce.groupByKey ç¨‹åºè¿è¡Œè¿‡ç¨‹ä¸­çš„ data æ”¾ç½®åœ¨ å†…å­˜, å¦‚ç¨‹åºè¿è¡Œ finish. ä¸­é—´çš„æ•°æ®ä¼šåƒåœ¾å›æ”¶. å¦‚æœåœ¨ç¨‹åºæ‰§è¡Œè¿‡ç¨‹ä¸­, ç”Ÿæˆäº†ä¸€äº›ä¸­é—´ç»“æœæ˜¯å¦å¤–ä¸€ä¸ªç¨‹åºéœ€è¦ä½¿ç”¨çš„æ•°æ® é‚£ä¹ˆå°±å¯ä»¥æŠŠè¯¥ data persist åˆ°å†…å­˜ä¸­ æˆ– ç£ç›˜ä¸­. å¦å¤–ä¸€ä¸ªç¨‹åºå°±å¯ä»¥é¿å…é‡å¤è®¡ç®—, ç›´æ¥ä»ç£ç›˜æˆ–å†…å­˜ä¸­è¿›è¡Œè¯»å–. æ‰€ä»¥ä¸ºäº†å°½å¿«çš„æäº¤ä»»åŠ¡çš„æ‰§è¡Œæ•ˆç‡, å°½é‡æŠŠé‡å¤åˆ©ç”¨çš„æ•°æ®æŒä¹…åŒ–åˆ°å†…å­˜ä¸­. 4. å°½é‡é¿å…ä½¿ç”¨ Shuffle ç±»ç®—å­shuffle åˆ°åº•æœ‰ä»€ä¹ˆåå¤„? åˆ†å¸ƒå¼è®¡ç®— å†³å®šäº† ä¸€å®šä¼šæœ‰ shuffle join: mapjoin, reducejoin shuffle ç±»ç®—å­: reduceByKey groupBy sortBy distinct èšåˆç±»æ“ä½œåŸºæœ¬éƒ½æœ‰ shuffle. (unionã€join[æŒ‰ç…§hashåˆ†åŒº, åˆ†åŒºæ•°è¿˜æˆå€æ•°, å°±æ²¡shuffle]) xxxByKey (groupBy + xxxx) rdd1.join(rdd2) (reducejoin)// å¦‚ä½•é¿å… join ä¸­çš„ shuffle mapjoin åœ¨ mapreduce å½“ä¸­, æˆ‘ä»¬çŸ¥é“å¦‚ä½•å®šä¹‰ mapreduce çš„ join å®ç°ç¨‹åºä½†æ˜¯åœ¨ sparkä¸­ ä½ çŸ¥é“å¦‚ä½•å®ç°ä¹ˆï¼Ÿ job.addCacheFile() // é€šè¿‡åº•å±‚çš„ DistributedCache è¿™ä¸ªç»„ä»¶ã€‚ æ¥ç»™æˆ‘ä»¬ () ä¸­çš„æ–‡ä»¶è¿›è¡Œå…¨å±€åˆ†å‘ // å…¨å±€åˆ†å‘ï¼š å‘é€æ–‡ä»¶åˆ°æ‰€æœ‰çš„è¦æ‰§è¡Œçš„ mapTask èŠ‚ç‚¹ spark å®ç°ä¼ªä»£ç  BroadCast rdd1.join(rdd2) rdd1.foreachPartition(data =&gt; { val data2 = bc.value // å°è¡¨æ•°æ® val data1 = data // å¤§å°æ•°æ®çš„ä¸€ä¸ª Partition data1.join(data2) // è¿™ä¸ªæ— shuffle, å› ä¸ºè¿™ä¸€å¥ä»£ç ,è¿™ä¸ªæ“ä½œæ˜¯åœ¨æ¯ä¸ªé˜¶æ®µç‹¬ç«‹æ‰§è¡Œçš„. }) mapper 3åˆ†é’Ÿ shuffle 2åˆ†é’Ÿ reduce 2åˆ†é’Ÿ 5. ä½¿ç”¨ map-side é¢„èšåˆ(combina)çš„ shuffle æ“ä½œ shuffle ç±»ç®—å­æœ‰ç¬¬3ä¸ªç¼ºç‚¹ï¼š æ•°æ®å€¾æ–œ wordcountï¼š File block1 block1 block2 åœ¨ä½¿ç”¨ shuffle æ“ä½œçš„ç®—å­çš„æ—¶å€™ï¼Œ å¦‚æœå³ map-side é¢„èšåˆæ“ä½œçš„è¯é‚£ä¹ˆ shuffle çš„ä»£ä»·è¿˜æ˜¯ä¼šå°å¾ˆå¤š é™„å¸¦çš„å¥½æ•ˆæœï¼š é™ä½æ•°æ®å€¾æ–œçš„ç¨‹åº¦ (1) æ²¡æœ‰ map-side é¢„èšåˆçš„ç®—å­ï¼š groupByKey æœ‰ shuffle, æ²¡æœ‰èšåˆcoGroup val rdd: RDD[String, Iterable[Int], Iterable[String]] (2) æœ‰é¢„èšåˆçš„ shuffle ç®—å­ï¼š æ‰§è¡Œæµç¨‹ä¸Š, æ‰§è¡Œé˜¶æ®µreduceByKey = groupByKey + reduce æœ€ç»ˆæ•ˆç‡ä¸Šï¼š reduceByKey &gt; groupByKey + reduce reduceByKey, combineByKey, aggregateByKey 6. ä½¿ç”¨é«˜æ€§èƒ½ç®—å­6.1 ä½¿ç”¨reduceByKey/aggregateByKeyæ›¿ä»£groupByKeyè¯¦æƒ…è§â€œåŸåˆ™äº”ï¼šä½¿ç”¨map-sideé¢„èšåˆçš„shuffleæ“ä½œâ€ã€‚ 6.2 ç”¨ foreachPartitions æ›¿ä»£ foreachéœ€æ±‚ï¼š å¦‚æœ rdd æœ‰ 10000 æ¡æ•°æ®ï¼Œ 10ä¸ªåˆ†åŒºï¼š // è·å–äº† 10000 ä¸ªè¿æ¥rdd.map(x =&gt; &#123; val connect = Connect.getConnect() // æ¨¡æ‹Ÿè·å–æ•°æ®åº“è¿æ¥ connect.insert(x)&#125;)// è·å–äº†10æ¬¡è¿æ¥rdd.mapPartitions(data =&gt; &#123; val connect = Connect.getConnect() // æ¨¡æ‹Ÿè·å–æ•°æ®åº“è¿æ¥ for( element &lt;- data) &#123; connect.insert(element) &#125;&#125;) åŸåˆ™ï¼š å¦‚æœä¸€ä¸ªæ“ä½œèƒ½é’ˆå¯¹ partition å®Œæˆï¼Œå°±ä¸è¦é’ˆå¯¹å•ä¸ªå…ƒç´  DStream RDD dstreams.foreachRDD(rdd =&gt; &#123; rdd.foreachPartition(ptn =&gt; &#123; rdd.foreach(element =&gt; &#123; &#125;) &#125;)&#125;) 6.3 ä½¿ç”¨ filter å coalesce æ“ä½œrdd.filter(å¥‡æ•°).coalesce(6).map(å¹³æ–¹) rdd.map(å¹³æ–¹).filter(å¥‡æ•°) 6.4 ä½¿ç”¨repartitionAndSortWithinPartitionsæ›¿ä»£repartitionä¸sortç±»æ“ä½œrepartitionAndSortWithinPartitionsæ˜¯Sparkå®˜ç½‘æ¨èçš„ä¸€ä¸ªç®—å­ï¼Œå®˜æ–¹å»ºè®®ï¼Œå¦‚æœéœ€è¦åœ¨repartitioné‡åˆ†åŒºä¹‹åï¼Œè¿˜è¦è¿›è¡Œæ’åºï¼Œå»ºè®®ç›´æ¥ä½¿ç”¨repartitionAndSortWithinPartitionsç®—å­ã€‚å› ä¸ºè¯¥ç®—å­å¯ä»¥ä¸€è¾¹è¿›è¡Œé‡åˆ†åŒºçš„shuffleæ“ä½œï¼Œä¸€è¾¹è¿›è¡Œæ’åºã€‚shuffleä¸sortä¸¤ä¸ªæ“ä½œåŒæ—¶è¿›è¡Œï¼Œæ¯”å…ˆshuffleå†sortæ¥è¯´ï¼Œæ€§èƒ½å¯èƒ½æ˜¯è¦é«˜çš„ã€‚ rdd.repartition.sort rdd.repartitionAndSortWithinPartitions ç¬¬ä¸€ä¸ªå¼å­æ•ˆç‡å·® rdd.repartition = rdd2 rdd2.sort = rdd3 7. å¹¿æ’­å¤§å˜é‡æœ‰æ—¶åœ¨å¼€å‘è¿‡ç¨‹ä¸­ï¼Œä¼šé‡åˆ°éœ€è¦åœ¨ç®—å­å‡½æ•°ä¸­ä½¿ç”¨å¤–éƒ¨å˜é‡çš„åœºæ™¯ï¼ˆå°¤å…¶æ˜¯å¤§å˜é‡ï¼Œæ¯”å¦‚100Mä»¥ä¸Šçš„å¤§é›†åˆï¼‰ï¼Œé‚£ä¹ˆæ­¤æ—¶å°±åº”è¯¥ä½¿ç”¨Sparkçš„å¹¿æ’­ï¼ˆBroadcastï¼‰åŠŸèƒ½æ¥æå‡æ€§èƒ½ã€‚ ä¸€å¥è¯ï¼š ç›®çš„ï¼š è®©å¤šä¸ª task éƒ½è¦ä½¿ç”¨çš„åœ¨ driver ä¸­å£°æ˜çš„å˜é‡éƒ½è¦ç»´æŒä¸€ä¸ªç‹¬ç«‹å‰¯æœ¬ï¼Œ ç¼–ç¨‹è®©è¿™ä¸ª executor çš„å†…å­˜å ç”¨é‡å°±å‡å°‘äº† æ•ˆæœï¼š executor çš„å†…å­˜å ç”¨é‡å°±å‡å°‘äº†. ç½‘ç»œæ•°æ®ä¼ è¾“é‡ä¹Ÿå‡å°‘äº† åŸåˆ™ï¼š è¦å¹¿æ’­çš„æ•°æ®è¶Šå¤§, è¿›è¡Œå¹¿æ’­è¿™ä¸ªæ“ä½œä¹‹åå¾—åˆ°çš„æ”¶ç›Šè¶Šå¥½çš„. mapreduce: DistributedCachespark: BroadCastManager SparkContext 8. ä½¿ç”¨Kryoä¼˜åŒ–åºåˆ—åŒ–æ€§èƒ½ java: mapreduce ä»–ä»¬çš„åŒºåˆ« javaä¸­åˆ›å»ºå¯¹è±¡çš„æ–¹å¼: æ„é€ å™¨ é™æ€å·¥å‚æ–¹æ³• (ç§æœ‰åŒ–äº†æ„é€ å™¨) åå°„ å…‹éš† ååºåˆ—åŒ– javaï¼š å®ç°åºåˆ—åŒ–: è®©å‚ä¸åºåˆ—åŒ–çš„ç±»å‹ implements Serializable ObjectOutputStream oos = new ... oos.writeObject(student) ç½‘ç»œIOï¼ŒFileIO Redis: String æŠŠä¸€ä¸ªå¯¹è±¡ï¼š toString, åºåˆ—åŒ–, JSON æœ‰ä¸ªç¼ºç‚¹: é™¤äº†æŠŠå½“å‰è¿™ä¸ªå¯¹è±¡çš„å±æ€§çš„å€¼ç»™å­˜å‚¨/æºå¸¦ä¹‹å¤–, è¿˜ä¼šæŠŠå½“å‰è¿™ä¸ªå¯¹è±¡çš„ç±»å‹çš„ä¿¡æ¯éƒ½æºå¸¦. åŠ å…¥è¦ä¼ å…¥ 10000 ä¸ªå¯¹è±¡ï¼š 1 : ç±»å‹ä¿¡æ¯ å¯¹è±¡ä¿¡æ¯2 : ç±»å‹ä¿¡æ¯ å¯¹è±¡ä¿¡æ¯...1000 : ç±»å‹ä¿¡æ¯ å¯¹è±¡ä¿¡æ¯ mapreduce: åºåˆ—åŒ–ï¼Œè‡ªå®šä¹‰è§„åˆ™ å¯¹äºç±»å‹ä¿¡æ¯ï¼Œåªä¼šæºå¸¦ä¸€æ¬¡ 1 : å¯¹è±¡ä¿¡æ¯2 : å¯¹è±¡ä¿¡æ¯...1000 : å¯¹è±¡ä¿¡æ¯ java åŸç”Ÿåºåˆ—ç»„ä»¶çš„åŸå›  å®ç°æ–¹å¼: class Student implements Writable &#123; private int id; private String name; // åºåˆ—åŒ– write(out) &#123; out.writeInt(id); out.writeUTF(name); &#125; // ååºåˆ—åŒ– readFields(in) &#123; this.id = in.readInt(); this.name = in.readUTF(); &#125;&#125; ä»–ä»¬çš„åŒºåˆ«ï¼š mapreduce çš„åºåˆ—åŒ–æœºåˆ¶, åªåºåˆ—åŒ–è¦è¿›è¡Œä¼ è¾“çš„å±æ€§çš„å€¼ï¼Œä¸é‡å¤åºåˆ—åŒ–å¯¹è±¡çš„ç±»å‹ä¿¡æ¯ sparkï¼š é»˜è®¤æƒ…å†µä¸‹, æ˜¯æ”¯æŒ java åŸç”Ÿåºåˆ—åŒ–æœºåˆ¶ ä½¿ç”¨ KryoSerializer ä½¿ç”¨æ–¹å¼:// åˆ›å»ºSparkConfå¯¹è±¡ã€‚val conf = new SparkConf().setMaster(...).setAppName(...)// è®¾ç½®åºåˆ—åŒ–å™¨ä¸ºKryoSerializerã€‚conf.set(&quot;spark.serializer&quot;, &quot;org.apache.spark.serializer.KryoSerializer&quot;)// æ³¨å†Œè¦åºåˆ—åŒ–çš„è‡ªå®šä¹‰ç±»å‹ã€‚conf.registerKryoClasses(Array(classOf[MyClass1], classOf[MyClass2])) 9. ä¼˜åŒ–æ•°æ®ç»“æ„Javaä¸­ï¼Œæœ‰ä¸‰ç§ç±»å‹æ¯”è¾ƒè€—è´¹å†…å­˜ï¼š å¯¹è±¡ï¼Œæ¯ä¸ªJavaå¯¹è±¡éƒ½æœ‰å¯¹è±¡å¤´ã€å¼•ç”¨ç­‰é¢å¤–çš„ä¿¡æ¯ï¼Œå› æ­¤æ¯”è¾ƒå ç”¨å†…å­˜ç©ºé—´ã€‚ å­—ç¬¦ä¸²ï¼Œæ¯ä¸ªå­—ç¬¦ä¸²å†…éƒ¨éƒ½æœ‰ä¸€ä¸ªå­—ç¬¦æ•°ç»„ä»¥åŠé•¿åº¦ç­‰é¢å¤–ä¿¡æ¯ã€‚ é›†åˆç±»å‹ï¼Œæ¯”å¦‚HashMapã€LinkedListç­‰ï¼Œå› ä¸ºé›†åˆç±»å‹å†…éƒ¨é€šå¸¸ä¼šä½¿ç”¨ä¸€äº›å†…éƒ¨ç±»æ¥å°è£…é›†åˆå…ƒç´ ï¼Œæ¯”å¦‚Map.Entryã€‚ å› æ­¤Sparkå»ºè®®ï¼Œåœ¨Sparkç¼–ç å®ç°ä¸­ï¼Œç‰¹åˆ«æ˜¯å¯¹äºç®—å­å‡½æ•°ä¸­çš„ä»£ç ï¼Œå°½é‡ä¸è¦ä½¿ç”¨ä¸Šè¿°ä¸‰ç§æ•°æ®ç»“æ„ï¼Œå°½é‡ä½¿ç”¨ å­—ç¬¦ä¸²æ›¿ä»£å¯¹è±¡ï¼Œä½¿ç”¨åŸå§‹ç±»å‹ï¼ˆæ¯”å¦‚Intã€Longï¼‰æ›¿ä»£å­—ç¬¦ä¸²ï¼Œ æ•°ç»„æ›¿ä»£é›†åˆç±»å‹ï¼Œè¿™æ ·å°½å¯èƒ½åœ°å‡å°‘å†…å­˜å ç”¨ï¼Œä»è€Œé™ä½GCé¢‘ç‡ï¼Œæå‡æ€§èƒ½ã€‚ ä¸è¦åˆ»æ„å»è¿™ä¹ˆåš, ä¹Ÿè¦æ³¨æ„å¯è¯»æ€§. ä½†æ˜¯åœ¨ç¬”è€…çš„ç¼–ç å®è·µä¸­å‘ç°ï¼Œè¦åšåˆ°è¯¥åŸåˆ™å…¶å®å¹¶ä¸å®¹æ˜“ã€‚å› ä¸ºæˆ‘ä»¬åŒæ—¶è¦è€ƒè™‘åˆ°ä»£ç çš„å¯ç»´æŠ¤æ€§ï¼Œå¦‚æœä¸€ä¸ªä»£ç ä¸­ï¼Œå®Œå…¨æ²¡æœ‰ä»»ä½•å¯¹è±¡æŠ½è±¡ï¼Œå…¨éƒ¨æ˜¯å­—ç¬¦ä¸²æ‹¼æ¥çš„æ–¹å¼ï¼Œé‚£ä¹ˆå¯¹äºåç»­çš„ä»£ç ç»´æŠ¤å’Œä¿®æ”¹ï¼Œæ— ç–‘æ˜¯ä¸€åœºå·¨å¤§çš„ç¾éš¾ã€‚åŒç†ï¼Œå¦‚æœæ‰€æœ‰æ“ä½œéƒ½åŸºäºæ•°ç»„å®ç°ï¼Œè€Œä¸ä½¿ç”¨HashMapã€LinkedListç­‰é›†åˆç±»å‹ï¼Œé‚£ä¹ˆå¯¹äºæˆ‘ä»¬çš„ç¼–ç éš¾åº¦ä»¥åŠä»£ç å¯ç»´æŠ¤æ€§ï¼Œä¹Ÿæ˜¯ä¸€ä¸ªæå¤§çš„æŒ‘æˆ˜ã€‚å› æ­¤ç¬”è€…å»ºè®®ï¼Œåœ¨å¯èƒ½ä»¥åŠåˆé€‚çš„æƒ…å†µä¸‹ï¼Œä½¿ç”¨å ç”¨å†…å­˜è¾ƒå°‘çš„æ•°æ®ç»“æ„ï¼Œä½†æ˜¯å‰ææ˜¯è¦ä¿è¯ä»£ç çš„å¯ç»´æŠ¤æ€§ã€‚ 10. èä¼šè´¯é€šReference Sparkæ€§èƒ½ä¼˜åŒ–æŒ‡å—â€”â€”åŸºç¡€ç¯‡ Sparkæ€§èƒ½ä¼˜åŒ–æŒ‡å—â€”â€”é«˜çº§ç¯‡ å¤§æ•°æ®èµ„æ–™ç¬”è®°æ•´ç†","categories":[{"name":"spark","slug":"spark","permalink":"http://iequa.com/categories/spark/"}],"tags":[{"name":"spark","slug":"spark","permalink":"http://iequa.com/tags/spark/"}]},{"title":"Data Warehouse - å·¥å…·ç¯‡","slug":"dataware/dw-wy-3-tools","date":"2018-08-03T02:07:21.000Z","updated":"2020-12-04T01:04:06.662Z","comments":true,"path":"2018/08/03/dataware/dw-wy-3-tools/","link":"","permalink":"http://iequa.com/2018/08/03/dataware/dw-wy-3-tools/","excerpt":"","text":"18. Hadoopæ¡†æ¶ 19. Hiveä»‹ç» 20. Hiveä¹‹DDL 21. Hiveä¹‹DML 22. Hiveä¹‹æŸ¥è¯¢è¯­å¥ 23. Hiveå‡½æ•°å…¨æ”»ç•¥ Reference åœ¨å†™blog/Htmlæ—¶åµŒå…¥Pdfæ˜¾ç¤º bilibili ä¼ä¸šçº§æ•°æ®ä»“åº“å®æˆ˜ ä¼ä¸šçº§æ•°æ®ä»“åº“PPTåˆ†äº« è®²å¸ˆï¼šå—å¤´å±…å£« - æ•°æ®ç§‘å­¦ä¹‹ä¼ä¸šçº§æ•°æ®ä»“åº“ ã€æ•°æ®åˆ†æã€‘- SQLé¢è¯•50é¢˜ - è·Ÿæˆ‘ä¸€èµ·æ‰“æ€ªå‡çº§ ä¸€èµ·æˆä¸ºæ•°æ®ç§‘å­¦å®¶ æ¼«è°ˆæ•°æ®ä»“åº“ä¹‹ç»´åº¦å»ºæ¨¡ Lambdaåœ¨çº¿ &gt; æœ¨ä¸œå±…å£« &gt; å¦‚ä½•æ·±å…¥æµ…å‡ºçš„ç†è§£æ•°æ®ä»“åº“å»ºæ¨¡ï¼Ÿ æœ¨ä¸œå±…å£«è°ˆæ•°ä»“çš„å­¦ä¹ æ–¹æ³•ï¼ ã€ç›´æ’­å›æ”¾ã€‘20200314Bç«™æ•°æ®ä»“åº“åˆ†äº«","categories":[{"name":"data-warehouse","slug":"data-warehouse","permalink":"http://iequa.com/categories/data-warehouse/"}],"tags":[{"name":"data warehouse","slug":"data-warehouse","permalink":"http://iequa.com/tags/data-warehouse/"}]},{"title":"Data Warehouse - ç†è®ºç¯‡ 2","slug":"dataware/dw-wy-2-theory-2","date":"2018-08-03T00:07:21.000Z","updated":"2020-12-04T01:04:25.828Z","comments":true,"path":"2018/08/03/dataware/dw-wy-2-theory-2/","link":"","permalink":"http://iequa.com/2018/08/03/dataware/dw-wy-2-theory-2/","excerpt":"","text":"9. ç»´åº¦è¡¨åŸºæœ¬æ¦‚å¿µ 10. å¸¸è§çš„ç»´åº¦è¡¨ç±»å‹ 11. æ•°æ®åˆ†å±‚çš„æ„ä¹‰ 12. ç»å…¸åˆ†å±‚ç†è®ºè¯¦è§£ 13. åˆ†å±‚çš„è¾¹ç•Œ 14. æ•°æ®çš„æµå‘ 15. æ•°æ®æ¶æ„Lambdaä¸Kappaæ¶æ„ 16. å…¸å‹çš„æ•°æ®æµè®¾è®¡æ€è·¯ 17. æ•°æ®æœåŠ¡ä¸šåŠ¡çš„å‡ ç§æ–¹å¼ Reference åœ¨å†™blog/Htmlæ—¶åµŒå…¥Pdfæ˜¾ç¤º bilibili ä¼ä¸šçº§æ•°æ®ä»“åº“å®æˆ˜ ä¼ä¸šçº§æ•°æ®ä»“åº“PPTåˆ†äº« è®²å¸ˆï¼šå—å¤´å±…å£« - æ•°æ®ç§‘å­¦ä¹‹ä¼ä¸šçº§æ•°æ®ä»“åº“ ã€æ•°æ®åˆ†æã€‘- SQLé¢è¯•50é¢˜ - è·Ÿæˆ‘ä¸€èµ·æ‰“æ€ªå‡çº§ ä¸€èµ·æˆä¸ºæ•°æ®ç§‘å­¦å®¶ æ¼«è°ˆæ•°æ®ä»“åº“ä¹‹ç»´åº¦å»ºæ¨¡ Lambdaåœ¨çº¿ &gt; æœ¨ä¸œå±…å£« &gt; å¦‚ä½•æ·±å…¥æµ…å‡ºçš„ç†è§£æ•°æ®ä»“åº“å»ºæ¨¡ï¼Ÿ æœ¨ä¸œå±…å£«è°ˆæ•°ä»“çš„å­¦ä¹ æ–¹æ³•ï¼ ã€ç›´æ’­å›æ”¾ã€‘20200314Bç«™æ•°æ®ä»“åº“åˆ†äº«","categories":[{"name":"data-warehouse","slug":"data-warehouse","permalink":"http://iequa.com/categories/data-warehouse/"}],"tags":[{"name":"data warehouse","slug":"data-warehouse","permalink":"http://iequa.com/tags/data-warehouse/"}]},{"title":"Sequence Models (week2) - NLP - Word Embeddings","slug":"deeplearning/Sequence-Models-week2","date":"2018-08-02T08:00:21.000Z","updated":"2019-10-20T04:30:35.018Z","comments":true,"path":"2018/08/02/deeplearning/Sequence-Models-week2/","link":"","permalink":"http://iequa.com/2018/08/02/deeplearning/Sequence-Models-week2/","excerpt":"èƒ½å¤Ÿå°†åºåˆ—æ¨¡å‹åº”ç”¨åˆ°è‡ªç„¶è¯­è¨€é—®é¢˜ä¸­ï¼ŒåŒ…æ‹¬æ–‡å­—åˆæˆã€‚","text":"èƒ½å¤Ÿå°†åºåˆ—æ¨¡å‹åº”ç”¨åˆ°è‡ªç„¶è¯­è¨€é—®é¢˜ä¸­ï¼ŒåŒ…æ‹¬æ–‡å­—åˆæˆã€‚ 1. Word Representationä¸Šå‘¨çš„å­¦ä¹ ä¸­ï¼Œå­¦ä¹ äº†å¦‚ä½•ç”¨ç‹¬çƒ­ç¼–ç æ¥ä»£è¡¨ä¸€ä¸ªè¯ï¼Œè¿™ä¸€èŠ‚æˆ‘ä»¬æ¥æ¢ç©¶ä¸€ä¸‹è¯å’Œè¯ä¹‹é—´çš„è”ç³»ã€‚æ¯”å¦‚æœ‰ä¸‹é¢è¿™å¥è¯ï¼š â€œI want a glass of orange ________â€ å‡å¦‚æˆ‘ä»¬çš„ RNN çš„æ¨¡å‹é€šè¿‡è®­ç»ƒå·²ç»å­¦ä¼šäº†çŸ­è¯­ â€œorange juiceâ€ï¼Œå¹¶å‡†ç¡®çš„é¢„æµ‹äº†è¿™å¥è¯çš„ç©ºæ ¼éƒ¨åˆ†ï¼Œé‚£ä¹ˆå¦‚æœé‡åˆ°äº†å¦ä¸€å¥è¯æ—¶ï¼Œæ¯”å¦‚ï¼š â€œI want a glass of apple _________â€ æ˜¯å¦éœ€è¦ä»å¤´å­¦ä¹ çŸ­è¯­ â€œapple juiceâ€ å‘¢ï¼Ÿèƒ½å¦é€šè¿‡æ„å»º â€œappleâ€ ä¸ â€œorangeâ€ çš„è”ç³»è®©å®ƒä¸éœ€è¦é‡å­¦å°±èƒ½è¿›è¡Œåˆ¤æ–­å‘¢ï¼Ÿ èƒ½å¦é€šè¿‡æ„å»º â€œappleâ€ ä¸ â€œorangeâ€ çš„è”ç³»è®©å®ƒä¸éœ€è¦é‡å­¦å°±èƒ½è¿›è¡Œåˆ¤æ–­å‘¢ï¼Ÿæ‰€ä»¥ä¸‹é¢ç»™å‡ºäº†ä¸€ç§æ”¹è¿›çš„è¡¨ç¤ºæ–¹æ³•ï¼Œç§°ä¹‹ä¸ºâ€œè¯åµŒå…¥(Word Embedding)â€ 1.1 è¯æ±‡çš„ç‰¹æ€§å•è¯ä¸å•è¯ä¹‹é—´æ˜¯æœ‰å¾ˆå¤šå…±æ€§çš„ï¼Œæˆ–åœ¨æŸä¸€ç‰¹æ€§ä¸Šç›¸è¿‘ï¼Œæ¯”å¦‚â€œè‹¹æœâ€å’Œâ€œæ©™å­â€éƒ½æ˜¯æ°´æœï¼›æˆ–è€…åœ¨æŸä¸€ç‰¹æ€§ä¸Šç›¸åï¼Œæ¯”å¦‚â€œçˆ¶äº²â€åœ¨æ€§åˆ«ä¸Šæ˜¯ç”·æ€§ï¼Œâ€œæ¯äº²â€åœ¨æ€§åˆ«ä¸Šæ˜¯å¥³æ€§ï¼Œé€šè¿‡æ„å»ºä»–ä»¬å…¶ä¸­çš„è”ç³»å¯ä»¥å°†åœ¨ä¸€ä¸ªå•è¯å­¦ä¹ åˆ°çš„å†…å®¹åº”ç”¨åˆ°å…¶ä»–çš„å•è¯ä¸Šæ¥æé«˜æ¨¡å‹çš„å­¦ä¹ çš„æ•ˆç‡ï¼Œè¿™é‡Œç”¨ä¸€ä¸ªç®€åŒ–çš„è¡¨æ ¼è¯´æ˜: Man (5391) Woman (9853) Apple (456) Orange (6257) æ€§åˆ« -1 1 0 0.1 å¹´é¾„ 0.01 0.02 -0.01 0.00 é£Ÿç‰© 0.04 0.01 0.95 0.97 é¢œè‰² 0.03 0.01 0.70 0.30 åœ¨è¡¨æ ¼ä¸­å¯ä»¥çœ‹åˆ°ä¸åŒçš„è¯è¯­å¯¹åº”ç€ä¸åŒçš„ç‰¹æ€§æœ‰ä¸åŒçš„ç³»æ•°å€¼ï¼Œä»£è¡¨ç€è¿™ä¸ªè¯è¯­ä¸å½“å‰ç‰¹æ€§çš„å…³ç³»ã€‚æ‹¬å·é‡Œçš„æ•°å­—ä»£è¡¨è¿™ä¸ªå•è¯åœ¨ç‹¬çƒ­ç¼–ç ä¸­çš„ä½ç½®ï¼Œå¯ä»¥ç”¨è¿™ä¸ªæ•°å­—ä»£è¡¨è¿™ä¸ªå•è¯æ¯”å¦‚ Man = ï¼ŒMan çš„ç‰¹æ€§ç”¨ ï¼Œä¹Ÿå°±æ˜¯é‚£ä¸€çºµåˆ—ã€‚ åœ¨å®é™…çš„åº”ç”¨ä¸­ï¼Œç‰¹æ€§çš„æ•°é‡è¿œä¸æ­¢ 4 ç§ï¼Œå¯èƒ½æœ‰å‡ ç™¾ç§ï¼Œç”šè‡³æ›´å¤šã€‚å¯¹äºå•è¯ â€œorangeâ€ å’Œ â€œappleâ€ æ¥è¯´ä»–ä»¬ä¼šå…±äº«å¾ˆå¤šçš„ç‰¹æ€§ï¼Œæ¯”å¦‚éƒ½æ˜¯æ°´æœï¼Œéƒ½æ˜¯åœ†å½¢ï¼Œéƒ½å¯ä»¥åƒï¼Œä¹Ÿæœ‰äº›ä¸åŒçš„ç‰¹æ€§æ¯”å¦‚é¢œè‰²ä¸åŒï¼Œå‘³é“ä¸åŒï¼Œä½†å› ä¸ºè¿™äº›ç‰¹æ€§è®© RNN æ¨¡å‹ç†è§£äº†ä»–ä»¬çš„å…³ç³»ï¼Œä¹Ÿå°±å¢åŠ äº†é€šè¿‡å­¦ä¹ ä¸€ä¸ªå•è¯å»é¢„æµ‹å¦ä¸€ä¸ªçš„å¯èƒ½æ€§ã€‚ è¿™é‡Œè¿˜ä»‹ç»äº†ä¸€ä¸ª t-SNE ç®—æ³•ï¼Œå› ä¸ºè¯æ€§è¡¨æœ¬èº«æ˜¯ä¸€ä¸ªå¾ˆé«˜ç»´åº¦çš„ç©ºé—´ï¼Œé€šè¿‡è¿™ä¸ªç®—æ³•å‹ç¼©åˆ°äºŒç»´çš„å¯è§†åŒ–å¹³é¢ä¸Šï¼Œæ¯ä¸€ä¸ªå•è¯ åµŒå…¥ å±äºè‡ªå·±çš„ä¸€ä¸ªä½ç½®ï¼Œç›¸ä¼¼çš„å•è¯ç¦»çš„è¿‘ï¼Œæ²¡æœ‰å…±æ€§çš„å•è¯ç¦»å¾—è¿œï¼Œè¿™ä¸ªå°±æ˜¯ â€œWord Embeddingsâ€ çš„æ¦‚å¿µ. ä¸Šå›¾é€šè¿‡èšç±»å°†è¯æ€§ç›¸ç±»ä¼¼çš„å•è¯åœ¨äºŒç»´ç©ºé—´èšä¸ºä¸€ç±». 2. Using Word Embeddingså…ˆä¸‹ä¸€ä¸ªéæ­£è§„å®šä¹‰ â€œè¯åµŒ - æè¿°äº†è¯æ€§ç‰¹å¾çš„æ€»é‡ï¼Œä¹Ÿæ˜¯åœ¨é«˜ç»´è¯æ€§ç©ºé—´ä¸­åµŒå…¥çš„ä½ç½®ï¼Œæ‹¥æœ‰è¶Šå¤šå…±æ€§çš„è¯ï¼Œè¯åµŒç¦»å¾—è¶Šè¿‘ï¼Œåä¹‹åˆ™è¶Šè¿œâ€ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œè¡¨è¾¾è¿™ä¸ªâ€œä½ç½®â€ï¼Œéœ€è¦ä½¿ç”¨æ‰€æœ‰è®¾å®šçš„è¯æ€§ç‰¹å¾ï¼Œå‡å¦‚æœ‰ 300 ä¸ªç‰¹å¾ï¼ˆæ€§åˆ«ï¼Œé¢œè‰²ï¼Œâ€¦ï¼‰ï¼Œé‚£ä¹ˆè¯åµŒçš„ç©ºé—´ç»´åº¦å°±æ˜¯ 300. 2.1 ä½¿ç”¨è¯åµŒä¸‰æ­¥ è·å¾—è¯åµŒï¼šè·å¾—çš„æ–¹å¼å¯ä»¥é€šè¿‡è®­ç»ƒå¤§çš„æ–‡æœ¬é›†æˆ–è€…ä¸‹è½½å¾ˆå¤šå¼€æºçš„è¯åµŒåº“ åº”ç”¨è¯åµŒï¼šå°†è·å¾—çš„è¯åµŒåº”ç”¨åœ¨æˆ‘ä»¬çš„è®­ç»ƒä»»åŠ¡ä¸­ å¯é€‰ï¼šé€šè¿‡æˆ‘ä»¬çš„è®­ç»ƒä»»åŠ¡æ›´æ–°è¯åµŒåº“ï¼ˆå¦‚æœè®­ç»ƒé‡å¾ˆå°å°±ä¸è¦æ›´æ–°äº†ï¼‰ 2.2 è¯åµŒå®ç”¨åœºæ™¯ No. sencentce replace word target 1 Sally Johnson is an orange farmer. orange Sally Johnson 2 Robert Lin is an apple farmer. apple Robert Lin 3 Robert Lin is a durian cultivator. durian cultivator Robert Lin æˆ‘ä»¬ç»§ç»­æ›¿æ¢ï¼Œæˆ‘ä»¬å°† apple farmer æ›¿æ¢æˆä¸å¤ªå¸¸è§çš„ durian cultivator (æ¦´è²ç¹æ®–å‘˜)ã€‚æ­¤æ—¶è¯åµŒå…¥ä¸­å¯èƒ½å¹¶æ²¡æœ‰ durian è¿™ä¸ªè¯ï¼Œcultivator ä¹Ÿæ˜¯ä¸å¸¸ç”¨çš„è¯æ±‡ã€‚è¿™ä¸ªæ—¶å€™æ€ä¹ˆåŠå‘¢ï¼Ÿæˆ‘ä»¬å¯ä»¥ç”¨åˆ°è¿ç§»å­¦ä¹ ã€‚ è¯åµŒå…¥è¿ç§»å­¦ä¹ æ­¥éª¤å¦‚ä¸‹ï¼š å­¦ä¹ å«æœ‰å¤§é‡æ–‡æœ¬è¯­æ–™åº“çš„è¯åµŒå…¥ (ä¸€èˆ¬å«æœ‰ 10äº¿ åˆ° 1000äº¿ å•è¯)ï¼Œæˆ–è€…ä¸‹è½½é¢„è®­ç»ƒå¥½çš„è¯åµŒå…¥ å°†å­¦åˆ°çš„è¯åµŒå…¥è¿ç§»åˆ°ç›¸å¯¹è¾ƒå°è§„æ¨¡çš„è®­ç»ƒé›† (ä¾‹å¦‚ 10ä¸‡ è¯æ±‡). (å¯é€‰) è¿™ä¸€æ­¥éª¤å°±æ˜¯å¯¹æ–°çš„æ•°æ®è¿›è¡Œ fine-tuneã€‚ 3. Properties of Word Embeddingså‡è®¾æœ‰å¦‚ä¸‹çš„é—®é¢˜ï¼š &quot;Man&quot; -&gt; &quot;Woman&quot; é‚£ä¹ˆ &quot;King&quot; -&gt; ï¼Ÿ è¿™ä¸ªé—®é¢˜è¢«ç§°ä½œè¯æ±‡çš„ç±»æ¯”é—®é¢˜ï¼Œé€šè¿‡ç ”ç©¶è¯åµŒçš„ç‰¹å¾å¯ä»¥è§£å†³è¿™æ ·çš„é—®é¢˜. æ•°å­¦çš„è¡¨è¾¾å¼ä¸ºï¼š e\\_{man} - e\\_{woman} \\, \\approx \\, e\\_{king}-e\\_w$e_w$ æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ åœ¨é«˜çº¬åº¦ç©ºé—´ä¸­ï¼ˆ300Dï¼‰ argmax\\_w \\;\\, Similarity(e\\_w, e\\_{king}-e\\_{man}+e\\_{woman})è¿™ä¸ªå…¬å¼ç›¸å½“äºåœ¨ç®—ä¸¤ä¸ªå‘é‡(vector)çš„cosç›¸ä¼¼åº¦ Similarity(u,v) = \\frac {u^Tv} {||u||\\_2||v||\\_2} å½“ç„¶ä¹Ÿå¯ä»¥ç”¨å…¶ä»–è·ç¦»å…¬å¼, ä½†æ˜¯å¤šæ•°æ˜¯ç”¨è¿™ä¸ªä½™å¼¦ç›¸ä¼¼åº¦. å¦‚ä¸‹å›¾ç”¨å‡ ä½•æ–¹å¼èƒ½å¤Ÿæ›´å®¹æ˜“ç†è§£ï¼Œå³åªè¦æ‰¾åˆ°ä¸å‘é‡ $\\vec{AB}$ æœ€æ¥è¿‘å¹³è¡Œçš„å‘é‡ $\\vec{CD}$ å³å¯. 4. Embedding Matrixè¿™ä¸€èŠ‚ä¸­ä¸»è¦è®²äº†è¯åµŒçŸ©é˜µçš„shapeï¼Œå¦‚æœè¯åµŒï¼ˆè¯æ€§ç‰¹å¾çš„æ€»é‡ï¼‰æ˜¯300ï¼Œç‹¬çƒ­ç¼–ç çš„é•¿åº¦æ˜¯10000ï¼Œé‚£ä¹ˆè¯åµŒçŸ©é˜µçš„çš„shapeå°±æ˜¯ 300 * 10000 ã€‚æ‰€ä»¥å°±æœ‰äº†ä¸‹é¢çš„å¼å­ï¼š è¯åµŒçŸ©é˜µ * å•è¯çš„ç‹¬çƒ­ç¼–ç  = å•è¯çš„è¯åµŒ (300, 10000) * (10000, 1) = (300, 1) 5. Learning Word Embeddingså¯ä»¥é€šè¿‡è®­ç»ƒç¥ç»ç½‘ç»œçš„æ–¹å¼æ„å»ºè¯åµŒè¡¨ E . ä¸‹å›¾å±•ç¤ºäº†é¢„æµ‹å•è¯çš„æ–¹æ³•ï¼Œå³ç»™å‡ºç¼ºå°‘ä¸€ä¸ªå•è¯çš„å¥å­ï¼š â€œI want a glass of orange _â€ è®¡ç®—æ–¹æ³•æ˜¯å°†å·²çŸ¥å•è¯çš„ç‰¹å¾å‘é‡éƒ½ä½œä¸ºè¾“å…¥æ•°æ®é€åˆ°ç¥ç»ç½‘ç»œä¸­å»ï¼Œç„¶åç»è¿‡ä¸€ç³»åˆ—è®¡ç®—åˆ°è¾¾ Softmaxåˆ†ç±»å±‚ï¼Œåœ¨è¯¥ä¾‹ä¸­è¾“å‡ºèŠ‚ç‚¹æ•°ä¸º10000ä¸ªã€‚ç»è¿‡è®¡ç®—juiceæ¦‚ç‡æœ€é«˜ï¼Œæ‰€ä»¥é¢„æµ‹ä¸º â€œI want a glass of orange juiceâ€ åœ¨è¿™ä¸ªè®­ç»ƒæ¨¡å¼ä¸­ï¼Œæ˜¯é€šè¿‡å…¨éƒ¨çš„å•è¯å»é¢„æµ‹æœ€åä¸€ä¸ªå•è¯ç„¶ååå‘ä¼ æ’­æ›´æ–°è¯åµŒè¡¨ $E$ å‡è®¾è¦é¢„æµ‹çš„å•è¯ä¸º $W$ï¼Œè¯åµŒè¡¨ä»ç„¶ä¸º $E$ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯è®­ç»ƒè¯åµŒè¡¨å’Œé¢„æµ‹ $W$ æ˜¯ä¸¤ä¸ªä¸åŒçš„ä»»åŠ¡ã€‚ å¦‚æœä»»åŠ¡æ˜¯é¢„æµ‹ $W$ï¼Œæœ€ä½³æ–¹æ¡ˆæ˜¯ä½¿ç”¨ $W$ å‰é¢ $n$ ä¸ªå•è¯æ„å»ºè¯­å¢ƒã€‚ å¦‚æœä»»åŠ¡æ˜¯è®­ç»ƒ $E$ï¼Œé™¤äº†ä½¿ç”¨ $W$ å‰å…¨éƒ¨å•è¯è¿˜å¯ä»¥é€šè¿‡ï¼šå‰åå„4ä¸ªå•è¯ã€å‰é¢å•ç‹¬çš„ä¸€ä¸ªè¯ã€å‰é¢è¯­å¢ƒä¸­éšæœºçš„ä¸€ä¸ªè¯ï¼ˆè¿™ä¸ªæ–¹å¼ä¹Ÿå«åš Skip Gram ç®—æ³•ï¼‰ï¼Œè¿™äº›æ–¹æ³•éƒ½èƒ½æä¾›å¾ˆå¥½çš„ç»“æœã€‚ 6. Word2Vecè§†é¢‘ä¸­ä¸€ç›´æ²¡æœ‰ç»™ Word2Vec ä¸‹ä¸€ä¸ªæ˜ç¡®çš„å®šä¹‰ï¼Œæˆ‘ä»¬å†æ¬¡ä¸‹ä¸€ä¸ªéæ­£å¼å®šä¹‰ä¾¿äºç†è§£: â€œword2vecâ€ æ˜¯æŒ‡å°†è¯è¯­ word å˜æˆå‘é‡vector çš„è¿‡ç¨‹ï¼Œè¿™ä¸€è¿‡ç¨‹é€šå¸¸é€šè¿‡æµ…å±‚çš„ç¥ç»ç½‘ç»œå®Œæˆï¼Œä¾‹å¦‚ CBOW æˆ–è€…skip gramï¼Œè¿™ä¸€è¿‡ç¨‹åŒæ ·å¯ä»¥è§†ä¸ºæ„å»ºè¯åµŒè¡¨ $E$ çš„è¿‡ç¨‹â€ã€‚ 6.1 Skip-gramsè¿™é‡Œç€é‡ä»‹ç»äº†skip gram modelï¼Œè¿™æ˜¯ä¸€ä¸ªç”¨ä¸€ä¸ªéšæœºè¯é¢„æµ‹å…¶ä»–è¯çš„æ–¹æ³•ã€‚æ¯”å¦‚ä¸‹é¢è¿™å¥è¯ä¸­ â€œI want a glass of orange juice.â€ æˆ‘ä»¬å¯ä»¥é€‰ orangeä½œä¸ºéšæœºè¯ c(Context)ï¼Œé€šè¿‡è®¾ç½®çª—å£å€¼ä¾‹å¦‚å‰å 5 ä¸ªå•è¯ä»¥ç›‘ç£å­¦ä¹ çš„æ–¹å¼å»é¢„æµ‹å…¶ä¸­çš„è¯t(Target) ä¾‹å¦‚ â€œjuice, glass, a, ofâ€ ä½†éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™ä¸ªè¿‡ç¨‹ä»ç„¶æ˜¯ä¸ºäº†æ­å»ºï¼ˆæ›´æ–°ï¼‰è¯åµŒè¡¨ $E$ è€Œä¸æ˜¯ä¸ºäº†çœŸæ­£çš„å»é¢„æµ‹ï¼Œæ‰€ä»¥å¦‚æœé¢„æµ‹æ•ˆæœä¸å¥½å¹¶ä¸ç”¨æ‹…å¿ƒï¼Œè¡¨è¾¾å¼ï¼š O\\_{c}\\rightarrow E \\rightarrow e\\_{c} \\rightarrow \\underset{Softmax}{Output} \\rightarrow \\hat{y}Softmaxå…¬å¼ä¸º(å‡è®¾è¾“å‡ºèŠ‚ç‚¹æ•°ä¸º10000)ï¼š p(t|c)=\\frac{e^{Î¸\\_t^Te\\_c}}{\\sum\\_{j=1}^{10000}e^{Î¸\\_j^Te\\_c}} $Î¸_t$ è¡¨ç¤ºä¸$t$æœ‰å…³çš„å‚æ•° æŸå¤±å‡½æ•°ï¼š l(\\hat{y},y)=\\sum\\_{i=1}^{10000}y\\_ilog\\hat{y\\_i} åœ¨skip gramä¸­æœ‰ä¸€ä¸ªä¸è¶³æ˜¯ softmax ä½œä¸ºæ¿€æ´»å‡½æ•°éœ€è¦çš„è¿ç®—é‡å¤ªå¤§ï¼Œåœ¨ä¸Šé™ä¸º10000ä¸ªå•è¯çš„è¯åº“ä¸­å°±å·²ç»æ¯”è¾ƒæ…¢äº†ã€‚ä¸€ç§è¡¥æ•‘çš„åŠæ³•æ˜¯ç”¨ä¸€ä¸ªå®ƒçš„å˜ç§ â€œHierachical Softmax (åˆ†å±‚çš„Softmax)â€ï¼Œé€šè¿‡ç±»ä¼¼äºŒå‰æ ‘çš„æ–¹æ³•æé«˜è®­ç»ƒçš„æ•ˆç‡ ä¾‹å¦‚ä¸€äº›å¸¸è§çš„å•è¯ï¼Œå¦‚theã€ofç­‰å°±å¯ä»¥åœ¨å¾ˆæµ…çš„å±‚æ¬¡å¾—åˆ°ï¼Œè€Œåƒdurianè¿™ç§å°‘ç”¨çš„å•è¯åˆ™åœ¨è¾ƒæ·±çš„å±‚æ¬¡å¾—åˆ° 7. Negative Sampling è´Ÿé‡‡æ ·å¯¹äºskip gram modelè€Œè¨€ï¼Œè¿˜è¦è§£å†³çš„ä¸€ä¸ªé—®é¢˜æ˜¯å¦‚ä½•å–æ ·ï¼ˆé€‰æ‹©ï¼‰æœ‰æ•ˆçš„éšæœºè¯ $c$ å’Œç›®æ ‡è¯ $t$ å‘¢ï¼Ÿå¦‚æœçœŸçš„æŒ‰ç…§è‡ªç„¶éšæœºåˆ†å¸ƒçš„æ–¹å¼å»é€‰æ‹©ï¼Œå¯èƒ½ä¼šå¤§é‡é‡å¤çš„é€‰æ‹©åˆ°å‡ºç°æ¬¡æ•°é¢‘ç‡å¾ˆé«˜çš„å•è¯æ¯”å¦‚è¯´ â€œthe, of, a, it, I, â€¦â€ é‡å¤çš„è®­ç»ƒè¿™æ ·çš„å•è¯æ²¡æœ‰ç‰¹åˆ«å¤§çš„æ„ä¹‰. å¦‚ä½•æœ‰æ•ˆçš„å»è®­ç»ƒé€‰å®šçš„è¯å¦‚ orange å‘¢ï¼Ÿåœ¨è®¾ç½®è®­ç»ƒé›†æ—¶å¯ä»¥é€šè¿‡â€œè´Ÿå–æ ·â€çš„æ–¹æ³•, ä¸‹è¡¨ä¸­ç¬¬ä¸€è¡Œæ˜¯é€šè¿‡å’Œä¸Šé¢ä¸€æ ·çš„çª—å£æ³•å¾—åˆ°çš„â€œæ­£â€ï¼ˆ1ï¼‰ç»“æœï¼Œå…¶ä»–ä¸‰è¡Œæ˜¯ä»å­—å…¸ä¸­éšæœºå¾—åˆ°çš„è¯è¯­ï¼Œç»“æœä¸ºâ€œè´Ÿâ€ï¼ˆ0ï¼‰ã€‚é€šè¿‡è¿™æ ·çš„è´Ÿå–æ ·æ³•å¯ä»¥æ›´æœ‰æ•ˆåœ°å»è®­ç»ƒ skip gram model. context word target? orange juice 1 orange king 0 orange book 0 orange the 0 è´Ÿå–æ ·çš„ä¸ªæ•° k ç”±æ•°æ®é‡çš„å¤§å°è€Œå®šï¼Œä¸Šè¿°ä¾‹å­ä¸­ä¸º3. å®é™…ä¸­æ•°æ®é‡å¤§åˆ™ k = 2 ~ 5ï¼Œæ•°æ®é‡å°åˆ™å¯ä»¥ç›¸å¯¹å¤§ä¸€äº› k = 5 ~ 20 é€šè¿‡è´Ÿå–æ ·ï¼Œæˆ‘ä»¬çš„ç¥ç»ç½‘ç»œè®­ç»ƒä» softmax é¢„æµ‹æ¯ä¸ªè¯å‡ºç°çš„é¢‘ç‡å˜æˆäº†ç»å…¸ binary logistic regression é—®é¢˜ï¼Œæ¦‚ç‡å…¬å¼ç”¨ sigmoid ä»£æ›¿ softmax ä»è€Œå¤§å¤§æé«˜äº†é€Ÿåº¦. x\\_1=(orange, juice) \\rightarrow y\\_1=1 \\\\\\\\ x\\_2=(orange, king) \\rightarrow y\\_2=0 \\\\\\\\ ... \\\\\\\\ P(y=1|c,t)=\\sigma(\\theta\\_t^Te\\_c)æœ€åæˆ‘ä»¬é€šè¿‡ä¸€ä¸ªå¹¶æ²¡æœ‰è¢«ç†è®ºéªŒè¯ä½†æ˜¯å®é™…æ•ˆæœå¾ˆå¥½çš„æ–¹å¼æ¥ç¡®å®šæ¯ä¸ªè¢«è´Ÿé€‰æ ·é€‰ä¸­çš„æ¦‚ç‡ä¸ºï¼š P(w\\_i)=\\frac{f(w\\_i^{\\frac{3}{4}})} {\\sum\\_{j=1}^{10000}f(w\\_j^{\\frac{3}{4}})} 8. GloVe Word VectorsGloVe(Global vectors for word representation)è™½ä¸åƒWord2Vecæ¨¡å‹é‚£æ ·æµè¡Œï¼Œä½†æ˜¯å®ƒä¹Ÿæœ‰è‡ªèº«çš„ä¼˜ç‚¹. 9. Sentiment Classificationå¹³æ—¶ä¸Šæ·˜å®æˆ‘ä»¬éƒ½ä¼šå¯¹ä¹°çš„ä¸œè¥¿ç»™å‡ºæ–‡å­—è¯„ä»·å’Œå¯¹åº”çš„æ˜Ÿçº§è¯„ä»·ï¼Œå¦‚ä¸‹å›¾ç¤ºã€‚ å•†å®¶å¯ä»¥é€šè¿‡å¯¹è¿™äº›æ•°æ®æ¥æ„å»ºä¸€ä¸ªæƒ…ç»ªåˆ†ç±»å™¨ï¼Œä»è€Œå¯ä»¥åœ¨ä¸€äº›ç¤¾äº¤å¹³å°ä¸Šå¦‚å¾®åšã€QQç­‰å¤§å®¶çš„æ–‡å­—è¯„è®ºç„¶åå¯¹åº”è¾“å‡ºç›¸åº”çš„æ˜Ÿçº§ç­‰çº§ï¼Œè¿™æ ·å°±å¯ä»¥æ›´å®¹æ˜“çŸ¥é“è‡ªå®¶åº—æ˜¯è’¸è’¸æ—¥ä¸Šè¿˜æ˜¯æ—¥è½è¥¿å±±äº†,heheheã€‚ å¯ä»¥çœ‹åˆ°ä¸‹å›¾ä¸­çš„æ¨¡å‹å…ˆå°†è¯„è¯­ä¸­å„ä¸ªå•è¯é€šè¿‡ è¯åµŒè¡¨(æ•°æ®é‡ä¸€èˆ¬æ¯”è¾ƒå¤§ï¼Œä¾‹å¦‚æœ‰100Billionçš„å•è¯æ•°) è½¬åŒ–æˆå¯¹åº”çš„ç‰¹å¾å‘é‡ï¼Œç„¶åå¯¹æ‰€æœ‰çš„å•è¯å‘é‡åšæ±‚å’Œæˆ–è€…åšå¹³å‡ï¼Œç„¶åæ„å»ºSoftmaxåˆ†ç±»å™¨ï¼Œæœ€åè¾“å‡ºæ˜Ÿçº§è¯„çº§ã€‚ ä½†æ˜¯ä¸Šé¢çš„æ¨¡å‹å­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼Œä¸€èˆ¬è€Œè¨€å¦‚æœè¯„è¯­ä¸­æœ‰åƒâ€goodã€excellentâ€è¿™æ ·çš„å•è¯ï¼Œä¸€èˆ¬éƒ½æ˜¯æ˜Ÿçº§è¯„åˆ†è¾ƒé«˜çš„è¯„è¯­ï¼Œä½†æ˜¯è¯¥æ¨¡å‹å¯¹ä¸‹é¢è¿™å¥è¯„è¯­å°±æ˜¾å¾—æ— èƒ½ä¸ºåŠ›äº†ï¼š â€œCompletely lacking in good taste, good service, and good ambience.â€ è¯¥è¯„è¯­ä¸­å‡ºç°å¤§é‡çš„goodï¼Œå¦‚æœç›´æ¥åšæ±‚å’Œæˆ–è€…å¹³å‡è¿ç®—ï¼Œç»è¿‡åˆ†ç±»å™¨å¾—åˆ°çš„è¾“å‡ºå¾ˆå¤§æ¦‚ç‡ä¸Šæ˜¯é«˜æ˜Ÿçº§è¯„åˆ†çš„ï¼Œä½†è¿™æ˜¾ç„¶ä¸è¯¥è¯„è¯­çš„æœ¬æ„ä¸ç¬¦. ä¹‹æ‰€ä»¥ä¸Šé¢çš„æ¨¡å‹å­˜åœ¨é‚£æ ·çš„ç¼ºç‚¹ï¼Œå°±æ˜¯å› ä¸ºå®ƒæ²¡æœ‰æŠŠå•è¯çš„æ—¶åºè€ƒè™‘è¿›å»ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä½¿ç”¨RNNæ„å»ºæ¨¡å‹æ¥è§£å†³è¿™ç§é—®é¢˜ã€‚RNNæ¨¡å‹å¦‚ä¸‹å›¾ç¤ºï¼š å¦å¤–ä½¿ç”¨RNNæ¨¡å‹è¿˜æœ‰å¦ä¸€ä¸ªå¥½å¤„ï¼Œå‡è®¾æµ‹è¯•é›†ä¸­çš„è¯„è¯­æ˜¯è¿™æ ·çš„ â€œCompletely absent of good taste, good service, and good ambience.â€ è¯¥è¯„è¯­åªæ˜¯å°†lacking inæ›¿æ¢æˆäº†absent ofï¼Œè€Œä¸”æˆ‘ä»¬å³ä½¿å‡è®¾absentå¹¶æ²¡æœ‰å‡ºç°åœ¨è®­ç»ƒé›†ä¸­ï¼Œä½†æ˜¯å› ä¸ºè¯åµŒè¡¨å¾ˆåºå¤§ï¼Œæ‰€ä»¥è¯åµŒè¡¨ä¸­åŒ…å«absentï¼Œæ‰€ä»¥ç®—æ³•ä¾æ—§å¯ä»¥çŸ¥é“absentå’Œlackingæœ‰ç›¸ä¼¼ä¹‹å¤„ï¼Œæœ€åè¾“å‡ºçš„ç»“æœä¹Ÿä¾ç„¶å¯ä»¥ä¿æŒæ­£ç¡®ã€‚ 10. Debiasing Word Embeddingsç°å¦‚ä»Šæœºå™¨å­¦ä¹ å·²ç»è¢«ç”¨åˆ°äº†å¾ˆå¤šé¢†åŸŸï¼Œä¾‹å¦‚é“¶è¡Œè´·æ¬¾å†³ç­–ï¼Œç®€å†ç­›é€‰ã€‚ä½†æ˜¯å› ä¸ºæœºå™¨æ˜¯å‘äººä»¬å­¦ä¹ ï¼Œæ‰€ä»¥å¥½çš„åçš„éƒ½ä¼šå­¦åˆ°. å› ä¸º RNN é€šå¸¸æ˜¯é€šè¿‡å¤§é‡çš„ç½‘ç»œæ•°æ®æ–‡æœ¬é›†è¿›è¡Œè®­ç»ƒå¾—åˆ°çš„ï¼Œæ‰€ä»¥å¾ˆå¤šæ—¶å€™æ–‡æœ¬é›†ä¸­çš„åè§ä¼šåæ˜ åœ¨è¯åµŒä»¥åŠæœ€ç»ˆ çš„ç»“æœä¸­ï¼Œä¾‹å¦‚ å½“è¯´åˆ°Manï¼šç¨‹åºå‘˜çš„æ—¶å€™ï¼Œç®—æ³•å¾—å‡ºWomanï¼šå®¶åº­ä¸»å¦‡ï¼Œè¿™æ˜¾ç„¶å­˜åœ¨åè§ã€‚ åˆå¦‚Manï¼šDoctorï¼Œç®—æ³•è®¤ä¸ºWomanï¼šNurseã€‚è¿™æ˜¾ç„¶ä¹Ÿå­˜åœ¨å…¶å®å’Œåè§ã€‚ è¿™ç§å¸¦æœ‰åè§çš„ç»“æœæ˜¯åº”è¯¥å°½åŠ›é¿å…çš„ï¼Œè¿™ç±»åè§å¤§é‡å­˜åœ¨äºç½‘ç»œæ•°æ®æ–‡æœ¬ä¸­ï¼ŒåŒ…æ‹¬ æ€§åˆ«åè§ï¼Œç§æ—åè§ï¼Œå¹´é¾„åè§ï¼Œç­‰ç­‰â€¦ äººç±»åœ¨è¿™æ–¹é¢å·²ç»åšçš„ä¸å¯¹äº†ï¼Œæ‰€ä»¥æœºå™¨åº”å½“åšå‡ºç›¸åº”çš„è°ƒæ•´æ¥å‡å°‘æ­§è§†. ç»™è¯åµŒå»åè§ä¸»è¦åˆ†ä¸‰æ­¥(åœ¨è¯åµŒçš„é«˜ç»´ç©ºé—´ä¸­å®Œæˆ): æ‰¾åˆ°åè§çš„æ–¹å‘(ç¡®å®šåè§çš„xï¼Œyè½´) å°†éå®šä¹‰åŒ–çš„è¯å¹³ç§»åˆ°x=0(çˆ¶äº²ï¼Œæ¯äº²è¿™ç±»è¯å°±æ˜¯å®šä¹‰åŒ–çš„è¯ï¼Œæœ¬èº«å°±å¸¦æœ‰äº†æ€§åˆ«çš„æš—ç¤º) ä½¿å®šä¹‰åŒ–çš„è¯æ®ç¦»ç§»åŠ¨çš„è¯è·ç¦»ç›¸ç­‰ So word embeddings can reflect the gender, ethnicity, age, sexual, orientation, and other biases of the text used to train the model. One that Iâ€™m especially passionate about is bias relating to socioeconomic status. I think that every person, whether you come from a wealthy family, or a low income family, or anywhere in between, I think everyone should have a great opportunities. ä¸‹é¢å°†ä¸»è¦ä»æ€§åˆ«æ­§è§†ä¸Šæ¥ä¸¾ä¾‹è¯´æ˜å¦‚ä½•è®©æœºå™¨å­¦ä¹ æ¶ˆé™¤åè§ã€‚ ä¸‹å›¾å±•ç¤ºäº†ä¸€äº›å•è¯ï¼Œä½ å¯ä»¥åœ¨å¿ƒé‡Œå…ˆæƒ³æƒ³ä½ çœ‹åˆ°è¿™äº›å•è¯çš„ç¬¬ä¸€æ—¶é—´è®¤ä¸ºä»–ä»¬æ‰€å¯¹åº”çš„æ€§åˆ«æ˜¯ä»€ä¹ˆå§~~~ 1. è¯†åˆ«åè§æ–¹å‘å› ä¸ºè¯¥ä¾‹å­æ˜¯ä»¥æ¶ˆé™¤æ€§åˆ«æ­§è§†ä¸ºç›®çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦è®¡ç®—å‡ºå›¾ä¸­è¿™äº›å•è¯ä¹‹é—´çš„è·ç¦»çš„å¹³å‡å€¼ï¼Œè¿›è€Œä½œä¸ºåè§æ–¹å‘(bias direction) e\\_{he}-e\\_{she} \\\\\\\\ e\\_{boy}-e\\_{girl} \\\\\\\\ e\\_{grandmother}-e\\_{grandfather}å°†ä¸Šé¢æ‰€æ±‚åšå¹³å‡è¿ç®—ï¼Œå¾—åˆ°çš„å‘é‡æ–¹å‘å³ä¸ºåè§æ–¹å‘ ä¸ºæ–¹ä¾¿ç†è§£ï¼Œå·²åœ¨å›¾ä¸­ç”»å‡ºåè§æ–¹å‘ï¼Œå…¶ä½™299D(é™¤genderä»¥å¤–çš„å…¶ä»–å•è¯ç‰¹å¾)å‘é‡ä¸åè§æ–¹å‘æ­£äº¤ï¼Œä¹Ÿåœ¨ä¸‹å›¾ä¸­ç”»å‡º. 2. è¯æ€§ä¸­å’Œåƒâ€œ boy, girl â€è¿™ç±»è¯åœ¨æ€§åˆ«è¯æ€§ä¸Šæ˜¯å¾ˆæ˜ç¡®çš„ï¼Œè€Œä¸”ä¸å­˜åœ¨æ­§è§†ï¼Œæ‰€ä»¥æ— éœ€ä¸­å’Œ(Neutralize). è€Œå›¾ä¸­çš„ babysisterã€doctor åˆ™éœ€è¦ä¸­å’Œï¼Œå…·ä½“æ–¹æ³•å°±æ˜¯å°†è¯¥è¯åƒéåè§æ–¹å‘æŠ•å½±å¾—åˆ°ä¸€ä¸ªæ–°çš„åæ ‡. 3. å•è¯å¯¹ç­‰è·ç¦»åŒ–å¦‚ä¸‹å›¾ç¤ºï¼Œè™½ç„¶ babysister ä¸­å’ŒåŒ–ï¼Œä½†æ˜¯å®ƒè¿˜æ˜¯ç¦» grandmother æ›´è¿‘ï¼Œæ‰€ä»¥ä¾æ—§å¸¦æœ‰åè§ æ‰€ä»¥æˆ‘ä»¬è¿˜éœ€è¦å°†grandmotherã€grandfatherè¿™ç±»ä¸æ€§åˆ«æœ‰å…³çš„å¯¹åº”è¯ç­‰è·åˆ†å¸ƒåœ¨éåè§æ–¹å‘çš„ä¸¤ä¾§(çº¢è‰²å‰ªå¤´è¡¨ç¤ºç§»åŠ¨æ–¹å‘ï¼Œçº¢è‰²ç‚¹è¡¨ç¤ºç§»åŠ¨åçš„æ–°åæ ‡)ï¼Œå¦‚ä¸‹å›¾ç¤ºã€‚ 11. Reference ç½‘æ˜“äº‘è¯¾å ‚ - deeplearning DeepLearning.aiå­¦ä¹ ç¬”è®°æ±‡æ€» deeplearning.aiæ·±åº¦å­¦ä¹ è¯¾ç¨‹å­—å¹•ç¿»è¯‘é¡¹ç›® seq2seqå­¦ä¹ ç¬”è®°","categories":[{"name":"deeplearning","slug":"deeplearning","permalink":"http://iequa.com/categories/deeplearning/"}],"tags":[{"name":"deeplearning.ai","slug":"deeplearning-ai","permalink":"http://iequa.com/tags/deeplearning-ai/"}]},{"title":"Data Warehouse - ç†è®ºç¯‡ 1","slug":"dataware/dw-wy-2-theory-1","date":"2018-08-01T04:07:21.000Z","updated":"2020-12-04T01:03:54.453Z","comments":true,"path":"2018/08/01/dataware/dw-wy-2-theory-1/","link":"","permalink":"http://iequa.com/2018/08/01/dataware/dw-wy-2-theory-1/","excerpt":"","text":"1. èŒƒå¼å»ºæ¨¡1.1 èŒƒå¼å»ºæ¨¡ 1.2 èŒƒå¼å»ºæ¨¡ ä¼˜ç¼ºç‚¹ä¼˜ç‚¹: èŠ‚çº¦å­˜å‚¨ ç»“æ„æ¸…æ™°, æ˜“äºç†è§£ é€‚åˆå…³ç³»å‹æ•°æ®åº“ ç¼ºç‚¹ï¼š æ„å»ºæ¯”è¾ƒç¹ç æŸ¥è¯¢å¤æ‚ ä¸åˆé€‚æ„å»ºåœ¨å¤§æ•°æ®åˆ†å¸ƒå¼ç¯å¢ƒä¸‹ 1.3 èŒƒå¼å»ºæ¨¡ä¼˜ç¼ºç‚¹è™½ç„¶æœ‰è¿™äº›ç¼ºç‚¹, ä½†æ˜¯èŒƒå¼å»ºæ¨¡çš„ç†è®º, ä»ç„¶æ˜¯éœ€è¦æˆ‘ä»¬å»ç†Ÿç»ƒæŒæ¡. åŸå› æœ‰å¦‚ä¸‹å‡ ç‚¹: æ•°æ®ä»“åº“ çš„ä¸Šæ¸¸æœ‰ç›¸å½“ä¸€éƒ¨åˆ†æ•°æ®æºæ˜¯ä¸šåŠ¡æ•°æ®åº“, è€Œè¿™äº›ä¸šåŠ¡æ•°æ®åº“åŸºäºèŒƒå¼ç†è®º æ•°æ®æºçš„è§„èŒƒå®šä¹‰éœ€è¦æˆ‘ä»¬äº†è§£èŒƒå¼ç†è®º æ•°æ®ä»“åº“ä¸‹æ¸¸ç³»ç»Ÿæ¯”å¦‚ æŠ¥è¡¨ ç³»ç»Ÿè®¾è®¡æ—¶, å¯èƒ½ä¼šç”¨åˆ°èŒƒå¼ç†è®º. 2. ç»´åº¦å»ºæ¨¡ 2.1 ç»´åº¦å»ºæ¨¡ä¼˜ç¼ºç‚¹ä¼˜ç‚¹: æ–¹ä¾¿ä½¿ç”¨ é€‚åˆå¤§æ•°æ®ä¸‹çš„æ•°æ®å¤„ç† é€‚åˆè¿›è¡Œ OLAP æ“ä½œ ç¼ºç‚¹: ç»´åº¦è¡¥å…¨é€ æˆçš„æ•°æ®å­˜å‚¨çš„æµªè´¹ ç»´åº¦å˜åŒ–é€ æˆçš„æ•°æ®æ›´æ–°é‡å¤§ ä¸èŒƒå¼ç†è®ºå·®å¼‚å¾ˆå¤§, æ˜¯å…¸å‹çš„åä¸‰èŒƒå¼ æ€è€ƒæ‘˜è¦: èŒƒå¼å»ºæ¨¡é‡Œçš„èŒƒå¼, å…·ä½“æŒ‡çš„æ˜¯ä»€ä¹ˆ, å“ªäº›å¸¸è§ä¼šä½¿ç”¨åˆ°èŒƒå¼ ç»´åº¦å»ºæ¨¡ç†è®ºä¸­çš„åèŒƒå¼æ˜¯æŒ‡ä»€ä¹ˆ, ä¸ºä»€ä¹ˆä¼šè¿™æ ·æ“ä½œ è¯·å™è¿°ç»´åº¦å»ºæ¨¡çš„ 4 ä¸ªæ­¥éª¤ 2. ç»´åº¦å»ºæ¨¡çš„4ä¸ªæ­¥éª¤ è®¢å•è¡¨ï¼š å»ºæ¨¡è¿‡ç¨‹: 3. äº‹å®è¡¨çš„åŸºæœ¬æ¦‚å¿µ3.1 åº¦é‡ 3.2 ä¸€è‡´æ€§ 4. ç»´åº¦å»ºæ¨¡ - å¸¸è§äº‹å®è¡¨ äº‹åŠ¡äº‹å®è¡¨ å‘¨æœŸå¿«ç…§äº‹å®è¡¨ ç´¯è®¡å¿«ç…§äº‹å®è¡¨ æ— äº‹å®çš„äº‹å®è¡¨ èšé›†äº‹å®è¡¨ Reference bilibili ä¼ä¸šçº§æ•°æ®ä»“åº“å®æˆ˜ ä¼ä¸šçº§æ•°æ®ä»“åº“PPTåˆ†äº« è®²å¸ˆï¼šå—å¤´å±…å£« - æ•°æ®ç§‘å­¦ä¹‹ä¼ä¸šçº§æ•°æ®ä»“åº“ ã€æ•°æ®åˆ†æã€‘- SQLé¢è¯•50é¢˜ - è·Ÿæˆ‘ä¸€èµ·æ‰“æ€ªå‡çº§ ä¸€èµ·æˆä¸ºæ•°æ®ç§‘å­¦å®¶ æ¼«è°ˆæ•°æ®ä»“åº“ä¹‹ç»´åº¦å»ºæ¨¡ Lambdaåœ¨çº¿ &gt; æœ¨ä¸œå±…å£« &gt; å¦‚ä½•æ·±å…¥æµ…å‡ºçš„ç†è§£æ•°æ®ä»“åº“å»ºæ¨¡ï¼Ÿ æœ¨ä¸œå±…å£«è°ˆæ•°ä»“çš„å­¦ä¹ æ–¹æ³•ï¼ ã€ç›´æ’­å›æ”¾ã€‘20200314Bç«™æ•°æ®ä»“åº“åˆ†äº«","categories":[{"name":"data-warehouse","slug":"data-warehouse","permalink":"http://iequa.com/categories/data-warehouse/"}],"tags":[{"name":"data warehouse","slug":"data-warehouse","permalink":"http://iequa.com/tags/data-warehouse/"}]},{"title":"Data Warehouse - åŸºç¡€ç¯‡","slug":"dataware/dw-wy-1-basic","date":"2018-08-01T02:07:21.000Z","updated":"2020-12-04T01:07:21.764Z","comments":true,"path":"2018/08/01/dataware/dw-wy-1-basic/","link":"","permalink":"http://iequa.com/2018/08/01/dataware/dw-wy-1-basic/","excerpt":"","text":"1. whatâ€™s data warehouse? 2. why build data warehouse? 3. ä»€ä¹ˆæƒ…å†µåº”å»º data warehouse ? å½“ä½ éœ€è¦é›†ä¸­åŒ–ç®¡ç†ä½ çš„æ•°æ® å½“ä½ å¸Œæœ›ä»¥æ›´é«˜æ•ˆçš„æ–¹å¼ä½¿ç”¨æ•°æ® å½“ä½ çš„æ•°æ®é‡å’Œå¤æ‚åº¦åˆ°äº†éœ€è¦ä¸€ä¸ªå›¢é˜Ÿæ¥ç»´æŠ¤æ—¶ å½“ä½ å¸Œæœ›æƒ³è¦æ•°æ®é©±åŠ¨ä¸šåŠ¡æ—¶ å½“ä½ æƒ³è¦å€ŸåŠ©å¤§æ•°æ®çš„åŠ›é‡æ¥æå‡äº§å“ç«äº‰åŠ› å½“ä½ æƒ³æ—¶åˆ»çŸ¥é“ä¸šåŠ¡å‘å±•æƒ…å†µæ—¶ 4. Warehouse vs Middle platform 5. OLTP vs OLAP 6. åº”ç”¨å…³ç³» 7. æ¨¡å¼è®¾è®¡çš„3ä¸ªé˜¶æ®µ7.1 æ¦‚å¿µæ¨¡å‹ 7.2 é€»è¾‘æ¨¡å‹ 7.3 ç‰©ç†æ¨¡å‹ èŠèŠä½ ç†è§£çš„ OLAP å’Œ OLTP (ä½¿ç”¨åœºæ™¯ã€æŠ€æœ¯æ ˆç­‰)èŠèŠä½ å¯¹ç»´åº¦å»ºæ¨¡çš„ç†è§£ 8. æŠ€æœ¯ç»„ä»¶ Reference bilibili ä¼ä¸šçº§æ•°æ®ä»“åº“å®æˆ˜ ä¼ä¸šçº§æ•°æ®ä»“åº“PPTåˆ†äº« è®²å¸ˆï¼šå—å¤´å±…å£« - æ•°æ®ç§‘å­¦ä¹‹ä¼ä¸šçº§æ•°æ®ä»“åº“ ã€æ•°æ®åˆ†æã€‘- SQLé¢è¯•50é¢˜ - è·Ÿæˆ‘ä¸€èµ·æ‰“æ€ªå‡çº§ ä¸€èµ·æˆä¸ºæ•°æ®ç§‘å­¦å®¶","categories":[{"name":"data-warehouse","slug":"data-warehouse","permalink":"http://iequa.com/categories/data-warehouse/"}],"tags":[{"name":"data warehouse","slug":"data-warehouse","permalink":"http://iequa.com/tags/data-warehouse/"}]},{"title":"å‘¨å¿—æ¹– Spark ç³»åˆ—","slug":"spark/spark-aura-zhouzhihu","date":"2018-07-31T07:07:21.000Z","updated":"2020-12-04T01:05:41.702Z","comments":true,"path":"2018/07/31/spark/spark-aura-zhouzhihu/","link":"","permalink":"http://iequa.com/2018/07/31/spark/spark-aura-zhouzhihu/","excerpt":"æœ¬äººæœ¬ç€ååˆ†å°Šé‡çš„æ€åº¦æ¥å­¦ä¹ å‘¨è€å¸ˆçš„åšæ–‡ï¼Œç‰¹æ­¤ä¸ºæ–¹ä¾¿å¥½æ‰¾ï¼Œåœ¨æ­¤åšä¸€ä¸ªç›®å½•ã€‚æ–¹ä¾¿å­¦ä¹ ã€‚ å‘¨å¿—æ¹–Sparkç³»åˆ—","text":"æœ¬äººæœ¬ç€ååˆ†å°Šé‡çš„æ€åº¦æ¥å­¦ä¹ å‘¨è€å¸ˆçš„åšæ–‡ï¼Œç‰¹æ­¤ä¸ºæ–¹ä¾¿å¥½æ‰¾ï¼Œåœ¨æ­¤åšä¸€ä¸ªç›®å½•ã€‚æ–¹ä¾¿å­¦ä¹ ã€‚ å‘¨å¿—æ¹–Sparkç³»åˆ— Reference Sparkä»»åŠ¡çš„æäº¤æµç¨‹ ä¸æ€¥åƒå£è¯: sparkä»»åŠ¡æäº¤æµç¨‹å›¾ (é©¬ä¸­åç±») å¤§æ•°æ®èµ„æ–™ç¬”è®°æ•´ç†","categories":[{"name":"spark","slug":"spark","permalink":"http://iequa.com/categories/spark/"}],"tags":[{"name":"spark","slug":"spark","permalink":"http://iequa.com/tags/spark/"}]},{"title":"SparkCore ä¸­çš„å·¥ä½œåŸç† - ä»»åŠ¡æ‰§è¡Œæµç¨‹ 5.1","slug":"spark/spark-aura-5.1-sparkCore","date":"2018-07-31T02:07:21.000Z","updated":"2020-12-04T01:04:53.697Z","comments":true,"path":"2018/07/31/spark/spark-aura-5.1-sparkCore/","link":"","permalink":"http://iequa.com/2018/07/31/spark/spark-aura-5.1-sparkCore/","excerpt":"","text":"â€” â€” â€” â€” application job stage task master worker executor driver æ•´ä¸ª Spark åº”ç”¨ç¨‹åºçš„è¿è¡Œåˆ†æˆä¸‰ä¸ªé˜¶æ®µï¼š 1). ç¼–å†™ä»£ç ï¼Œä½¿ç”¨ spark-submit å»äº¤ä»»åŠ¡åˆ°é›†ç¾¤è¿è¡Œ,ä¸€ç›´åˆ°æˆ‘ä»¬è‡ªå·±ç¼–å†™çš„mainæ–¹æ³•è¿è¡Œä¸ºæ­¢ 1.1) ç¼–å†™ä»£ç 1.2) æ‰“æˆ Jar1.3) ç¼–å†™ spark-submit è„šæœ¬æäº¤ä»»åŠ¡1.4) è„šæœ¬è§£æ å’Œ æ‰§è¡Œ æœ€ç»ˆè½¬åˆ° main æ–¹æ³•æ‰§è¡Œ SparkSubmit 2). sparkContext çš„åˆå§‹åŒ– new SparkContext(sparkConf) ä¸¤æ¡çº¿: (1) åœ¨ driver ç«¯æ‰§è¡Œçš„ä»£ç  init TaskScheduler â€”â€”&gt; TaskSchedulerImpl init SchedulerBackend â€”â€”&gt; StandAloneSchedulerBackend init DAGScheduler â€”â€”&gt; DAGScheduler (2) åœ¨ worker å’Œ master ç«¯æ‰§è¡Œçš„å„ç§ä»£ç  ä¸šåŠ¡åŠŸèƒ½å®ç°: 1ã€ master æ³¨å†Œ 2ã€ worker è´Ÿè´£å¯åŠ¨ executor 3). action ç®—å­ 1. SparkSubmit No. Spark ä»»åŠ¡çš„æäº¤æµç¨‹ (1) é¦–å…ˆå°†ç¨‹åºæ‰“æˆ jar åŒ… (2) ä½¿ç”¨ spark-submit è„šæœ¬æäº¤ä»»åŠ¡åˆ°é›†ç¾¤ä¸Šè¿è¡Œ (3) è¿è¡Œ sparkSubmit çš„ main æ–¹æ³•ï¼Œåœ¨è¿™ä¸ªæ–¹æ³•ä¸­é€šè¿‡åå°„çš„æ–¹å¼åˆ›å»ºæˆ‘ä»¬ç¼–å†™çš„ä¸»ç±»çš„å®ä¾‹å¯¹è±¡ï¼Œç„¶åè°ƒç”¨ main æ–¹æ³•ï¼Œå¼€å§‹æ‰§è¡Œæˆ‘ä»¬çš„ä»£ç ï¼ˆæ³¨æ„ï¼Œæˆ‘ä»¬çš„ spark ç¨‹åºä¸­çš„ driverå°±è¿è¡Œåœ¨ sparkSubmit è¿›ç¨‹ä¸­ï¼‰ 2. SparkContext åˆå§‹åŒ– No. SparkContext åˆå§‹åŒ– (4) å½“ä»£ç è¿è¡Œåˆ°åˆ›å»º SparkContext å¯¹è±¡æ—¶ï¼Œé‚£å°±å¼€å§‹åˆå§‹åŒ– SparkContext å¯¹è±¡äº† (5) åœ¨åˆå§‹åŒ– SparkContext å¯¹è±¡çš„æ—¶å€™ï¼Œä¼šåˆ›å»ºä¸¤ä¸ªç‰¹åˆ«é‡è¦çš„å¯¹è±¡ï¼Œåˆ†åˆ«æ˜¯ï¼š 1. DAGScheduler ï¼ˆRDD-&gt;Stage,â€”-&gt; taskSetï¼‰ 2. TaskScheduler (SchedulerBackEnd-&gt;Actor) ã€DAGScheduler çš„ä½œç”¨ã€‘å°† RDD çš„ä¾èµ–åˆ‡åˆ†æˆä¸€ä¸ªä¸€ä¸ªçš„ stageï¼Œç„¶åå°† stage ä½œä¸º taskSet æäº¤ç»™ DriverActor 6 åœ¨æ„å»º TaskScheduler çš„åŒæ—¶ï¼Œä¼šåˆ›å»ºä¸¤ä¸ªéå¸¸é‡è¦çš„å¯¹è±¡ï¼Œåˆ†åˆ«æ˜¯: 1. ClientActorï¼š å‘ master æ³¨å†Œç”¨æˆ·æäº¤çš„ä»»åŠ¡ â€”â€”â€”â€”â€”â€”â€”â€”â€” 2. DriverActorï¼š æ¥å— executor åå‘æ³¨å†Œ, å°†ä»»åŠ¡æäº¤ç»™ executor (7) å½“ ClientActor å¯åŠ¨åï¼Œä¼šå°†ç”¨æˆ·æäº¤çš„ä»»åŠ¡å’Œç›¸å…³çš„å‚æ•°å°è£…åˆ° ApplicationDescriptionå¯¹è±¡ä¸­ï¼Œç„¶åæäº¤ç»™ master è¿›è¡Œä»»åŠ¡çš„æ³¨å†Œ (8) å½“ master æ¥å—åˆ° clientActor æäº¤çš„ä»»åŠ¡è¯·æ±‚æ—¶ï¼Œä¼šå°†è¯·æ±‚å‚æ•°è¿›è¡Œè§£æï¼Œå¹¶å°è£…æˆ Applicationï¼Œç„¶åå°†å…¶æŒä¹…åŒ–ï¼Œç„¶åå°†å…¶åŠ å…¥åˆ°ä»»åŠ¡é˜Ÿåˆ— waitingApps ä¸­ (9) å½“è½®åˆ°æˆ‘ä»¬æäº¤çš„ä»»åŠ¡è¿è¡Œæ—¶ï¼Œå°±å¼€å§‹è°ƒç”¨ schedule()ï¼Œè¿›è¡Œä»»åŠ¡èµ„æºçš„è°ƒåº¦ (10) master å°†è°ƒåº¦å¥½çš„èµ„æºå°è£…åˆ° launchExecutor ä¸­å‘é€ç»™æŒ‡å®šçš„ worker (11) worker æ¥å—åˆ° Master å‘é€æ¥çš„ launchExecutor æ—¶ï¼Œä¼šå°†å…¶è§£å‹å¹¶å°è£…åˆ° ExecutorRunnerä¸­ï¼Œç„¶åè°ƒç”¨è¿™ä¸ªå¯¹è±¡çš„ start(), å¯åŠ¨ Executor (12) Executor å¯åŠ¨åä¼šå‘ DriverActor è¿›è¡Œåå‘æ³¨å†Œ (13) driverActor ä¼šå‘é€æ³¨å†ŒæˆåŠŸçš„æ¶ˆæ¯ç»™ Executor (14) Executor æ¥å—åˆ° DriverActor æ³¨å†ŒæˆåŠŸçš„æ¶ˆæ¯åä¼šåˆ›å»ºä¸€ä¸ªçº¿ç¨‹æ± ï¼Œç”¨äºæ‰§è¡Œ DriverActorå‘é€è¿‡æ¥çš„ task ä»»åŠ¡ (15) å½“å±äºè¿™ä¸ªä»»åŠ¡çš„æ‰€æœ‰çš„ Executor å¯åŠ¨å¹¶åå‘æ³¨å†ŒæˆåŠŸåï¼Œå°±æ„å‘³ç€è¿è¡Œè¿™ä¸ªä»»åŠ¡çš„ç¯å¢ƒå·²ç»å‡†å¤‡å¥½äº†ï¼Œdriver ä¼šç»“æŸ SparkContext å¯¹è±¡çš„åˆå§‹åŒ–ï¼Œä¹Ÿå°±æ„å‘³ç€ new SparkContextè¿™å¥ä»£ç è¿è¡Œå®Œæˆ 3. action-job-stage-taskSet-DriverActor-launchTask-Executor-Rdd partition No. Spark ä»»åŠ¡çš„æäº¤æµç¨‹ &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; (16) å½“åˆå§‹åŒ– sc æˆåŠŸåï¼Œdriver ç«¯å°±ä¼šç»§ç»­è¿è¡Œæˆ‘ä»¬ç¼–å†™çš„ä»£ç ï¼Œç„¶åå¼€å§‹åˆ›å»ºåˆå§‹çš„ RDDï¼Œç„¶åè¿›è¡Œä¸€ç³»åˆ—è½¬æ¢æ“ä½œï¼Œå½“é‡åˆ°ä¸€ä¸ª action ç®—å­æ—¶ï¼Œä¹Ÿå°±æ„å‘³ç€è§¦å‘äº†ä¸€ä¸ª job (17) driver ä¼šå°†è¿™ä¸ª job æäº¤ç»™ DAGScheduler (18) DAGScheduler å°†æ¥å—åˆ°çš„ jobï¼Œä»æœ€åä¸€ä¸ªç®—å­å‘å‰æ¨å¯¼ï¼Œå°† DAG ä¾æ®å®½ä¾èµ–åˆ’åˆ†æˆä¸€ä¸ªä¸€ä¸ªçš„ stageï¼Œç„¶åå°† stage å°è£…æˆ taskSetï¼Œå¹¶å°† taskSet ä¸­çš„ task æäº¤ç»™ DriverActor (19) DriverActor æ¥å—åˆ° DAGScheduler å‘é€è¿‡æ¥çš„ taskï¼Œä¼šæ‹¿åˆ°ä¸€ä¸ªåºåˆ—åŒ–å™¨ï¼Œå¯¹ task è¿›è¡Œåºåˆ—åŒ–ï¼Œç„¶åå°†åºåˆ—åŒ–å¥½çš„ task å°è£…åˆ° launchTask ä¸­ï¼Œç„¶åå°† launchTask å‘é€ç»™æŒ‡å®šçš„Executor (20) Executor æ¥å—åˆ°äº† DriverActor å‘é€è¿‡æ¥çš„ launchTask æ—¶ï¼Œä¼šæ‹¿åˆ°ä¸€ä¸ªååºåˆ—åŒ–å™¨ï¼Œå¯¹launchTask è¿›è¡Œååºåˆ—åŒ–ï¼Œå°è£…åˆ° TaskRunner ä¸­ï¼Œç„¶åä» Executor è¿™ä¸ªçº¿ç¨‹æ± ä¸­è·å–ä¸€ä¸ªçº¿ç¨‹ï¼Œå°†ååºåˆ—åŒ–å¥½çš„ task ä¸­çš„ç®—å­ä½œç”¨åœ¨ RDD å¯¹åº”çš„åˆ†åŒºä¸Š spark1.x RPC AKKAspark2.x RPC netty Sparkçš„ä»»åŠ¡æäº¤å’Œæ‰§è¡Œæµç¨‹è¯¦è§£ï¼šé©¬ä¸­åï¼šSparkçš„ä»»åŠ¡æäº¤å’Œæ‰§è¡Œæµç¨‹è¯¦è§£ Reference Sparkä»»åŠ¡çš„æäº¤æµç¨‹ ä¸æ€¥åƒå£è¯: sparkä»»åŠ¡æäº¤æµç¨‹å›¾ (é©¬ä¸­åç±») å¤§æ•°æ®èµ„æ–™ç¬”è®°æ•´ç†","categories":[{"name":"spark","slug":"spark","permalink":"http://iequa.com/categories/spark/"}],"tags":[{"name":"spark","slug":"spark","permalink":"http://iequa.com/tags/spark/"}]},{"title":"Spark Task-Commit æµç¨‹è§£æ 4.2","slug":"spark/spark-aura-4.2-task-commit","date":"2018-07-29T00:07:21.000Z","updated":"2020-12-04T01:06:01.069Z","comments":true,"path":"2018/07/29/spark/spark-aura-4.2-task-commit/","link":"","permalink":"http://iequa.com/2018/07/29/spark/spark-aura-4.2-task-commit/","excerpt":"","text":"sparkcore çš„ä»»åŠ¡æ‰§è¡Œæµç¨‹åˆ†æï¼š æ„å»ºDAG DAGScheduler â€”-&gt; DAG â€”-&gt; TaskSet (Task set) è¡¥å……: executor ExecutorBacked actor driver SchedulerBackend actor Spark æ ¸å¿ƒæ¦‚å¿µå¤ä¹ 2ä¸ªé‡è¦çš„çŸ¥è¯†: new SparkContext (sparkConf) collect(). actionç®—å­çš„æäº¤ä»»åŠ¡æœºåˆ¶ï¼Œå‡ºå‘ä»»åŠ¡æ‰§è¡Œæ ¸å¿ƒ HDFS - File - block - mapreduce lineHDFS - RDD - partition - Spark: Application Driver Program ClusterManager SparkContext æ•´ä¸ªåº”ç”¨ä¸Šä¸‹æ–‡ RDD DAGScheduler TaskScheduler Worker Executor Stage Job Task SparkEnv : çº¿ç¨‹çº§åˆ«ä¸Šä¸‹æ–‡, å­˜å‚¨è¿è¡Œæ—¶é‡è¦ç»„ä»¶çš„å¼•ç”¨ SparkEnv: MapOutPutTracker..SparkConf è¯¾ç¨‹ç»“æŸ: å¤§æ•°æ®å­˜å‚¨ å¤§æ•°æ®è®¡ç®— å¤§æ•°æ®å®æ—¶å¢åˆ æ”¹æŸ¥ MapReduce åˆ†å¸ƒå¼è®¡ç®—çš„é¼»ç¥– æ¨¡å‹ è§£å†³å¤§æ•°æ®é›†è®¡ç®—çš„é€šç”¨æ€æƒ³ åˆ†è€Œæ²»ä¹‹: 1ä¸ªApplication â€”-&gt; å¤šä¸ªtask ä¸´æ—¶ç»“æœæ±‡æ€»: å¤šä¸ªTaskçš„æ•°æ®è¿›è¡Œæœ€ç»ˆçš„æ±‡æ€»å¤„ç† zookeeper è®®ä¼šåˆ¶ , æŠ•ç¥¨ , å°‘æ•°æœä»å¤šæ•° è‰ºæœ¯æ¥æºäºç”Ÿæ´» kylin, spark, flink â€”â€”&gt; mapreduce Spark ä»»åŠ¡æ‰§è¡Œæµç¨‹è¯¦è§£ç°åœ¨å¼€å§‹ä»‹ç»SparkContextï¼ŒSparkContextçš„åˆå§‹åŒ–æ­¥éª¤å¦‚ä¸‹ï¼š æœ€é‡è¦çš„ä¸‰ä¸ªå±æ€§: _dagScheduler ----&gt; a _taskScheduler ----&gt; TaskSchedulerImpl _schedulerBackend ----&gt; StandaloneSchedulerBackend Spark ä»»åŠ¡æäº¤æµç¨‹ï¼š å›¾2ï¼š Reference hustcat/spark_internal.md Sparkå†…æ ¸åˆ†æä¹‹SparkContextåˆå§‹åŒ–æºç åˆ†æ sparkæ ¸å¿ƒæ¦‚å¿µ","categories":[{"name":"spark","slug":"spark","permalink":"http://iequa.com/categories/spark/"}],"tags":[{"name":"spark","slug":"spark","permalink":"http://iequa.com/tags/spark/"}]},{"title":"spark åŸºç¡€æ¦‚å¿µå¤ä¹  3.2","slug":"spark/spark-aura-3.2-spark-basic-summary","date":"2018-07-27T00:07:21.000Z","updated":"2021-01-06T00:51:12.028Z","comments":true,"path":"2018/07/27/spark/spark-aura-3.2-spark-basic-summary/","link":"","permalink":"http://iequa.com/2018/07/27/spark/spark-aura-3.2-spark-basic-summary/","excerpt":"","text":"1. ç¬¬1éƒ¨åˆ†ä»»åŠ¡çš„æäº¤ï¼š (1). run-example SparkPi 100(2). spark-shell(3). spark-submit --master: local local[2] local[*]spark://hadoop02:7077, hadoop04:7077yarn HDFS å¤„ç† myha01 è¿™ä¸ª nameservice çš„æ–¹å¼éå¸¸çš„æš´åŠ›: æ‰€æœ‰çš„è¯·æ±‚ï¼Œå…¶å®éƒ½ä¼šç»™æ¯ä¸ª namenode éƒ½å‘é€, ä½†æ˜¯åªæœ‰ active çš„ namenodeæ‰ä¼šè¿›è¡Œå¤„ç†ï¼Œè¿›è¡Œå›å¤if (namenode.getServiceStage() == â€œstandbyâ€) {} else : â€¦ 2. ç¬¬2éƒ¨åˆ† æ ¸å¿ƒåŠŸèƒ½: SparkContext, å­˜å‚¨ä½“ç³», æ‰§è¡Œå¼•æ“ DAGScheduler, éƒ¨ç½²æ¨¡å¼ æ‰©å±•åŠŸèƒ½: SQL, Streaming, GraphX, MLlib, SparkR, Pyspark æ ¸å¿ƒæ¦‚å¿µ: Application Job åˆ‡åˆ†æ ‡å‡†: ä»å‰å¾€åæ‰¾actionçš„ç®—å­ Stage åˆ‡åˆ†æ ‡å‡†: ä»åå¾€å‰æ‰¾å®½ä¾èµ–çš„ç®—å­ Task åœ¨sparkä¸­ï¼ŒTaskçš„ç±»å‹åˆ†ä¸º2ç§ï¼šShuffleMapTask å’Œ ResultTaskï¼›ç®€å•æ¥è¯´ï¼ŒDAGçš„æœ€åä¸€ä¸ªé˜¶æ®µä¼šä¸ºæ¯ä¸ªç»“æœçš„ partition ç”Ÿæˆä¸€ä¸ª ResultTask, å³æ¯ä¸ªStageé‡Œé¢çš„Taskçš„æ•°é‡æ˜¯ç”±è¯¥Stageä¸­æœ€åä¸€ä¸ªRDDçš„Partitionçš„æ•°é‡æ‰€å†³å®šçš„ï¼ è€Œå…¶ä½™æ‰€æœ‰é˜¶æ®µéƒ½ä¼šç”ŸæˆShuffleMapTaskï¼›ä¹‹æ‰€ä»¥ç§°ä¹‹ä¸ºShuffleMapTaskæ˜¯å› ä¸ºå®ƒéœ€è¦å°†è‡ªå·±çš„è®¡ç®—ç»“æœé€šè¿‡shuffleåˆ°ä¸‹ä¸€ä¸ªstageä¸­ã€‚ Driver Application: å®¢æˆ·ç«¯é©±åŠ¨ç¨‹åº, ä¹Ÿå¯ä»¥ç†è§£ä¸ºå®¢æˆ·ç«¯åº”ç”¨ç¨‹åºï¼Œç”¨äºå°†ä»»ä½•ç¨‹åºè½¬æ¢ä¸º RDD å’Œ DAG, å¹¶ä¸ Cluster Manager è¿›è¡Œé€šä¿¡ä¸è°ƒåº¦. ClusterManager Driver Executor Master, Worker, Client deploy-mode ä¸»è¦é’ˆå¯¹ yarn: client cluster åŸºæœ¬æ¶æ„: ç¼–ç¨‹æ¨¡å‹: 1). è·å–ç¼–ç¨‹å…¥å£ ---&gt; SparkContext 2). é€šè¿‡ç¼–ç¨‹å…¥å£ä½¿ç”¨ä¸åŒçš„æ–¹å¼åŠ è½½æ•°æ®å¾—åˆ°ä¸€ä¸ªæ•°æ®æŠ½è±¡ ---&gt; RDD 3). é’ˆå¯¹åŠ è½½å¾—åˆ°çš„æ•°æ®æŠ½è±¡è°ƒç”¨ä¸åŒçš„ç®—å­è¿›è¡Œå¤„ç† ---&gt; Transformation + Action 4). é’ˆå¯¹ç»“æœæ•°æ®è¿›è¡Œå¤„ç† RDD/Scala å¯¹è±¡ æˆ– é›†åˆ ---&gt; print / save å­˜å‚¨ 5). å…³é—­ç¼–ç¨‹å…¥å£ ---&gt; sparkContext.stop() sparkSQLsparkStreaming&amp;sparkCore ä¸€æ¨¡ä¸€æ ·å”¯ä¸€ä¸ç›¸åŒçš„åœ°æ–¹å°±æ˜¯: ç¼–ç¨‹å…¥å£, æ•°æ®æŠ½è±¡, ç®—å­ RDD æ‘˜è¦1ï¼š (1) æ¦‚å¿µï¼š å¼¹æ€§åˆ†å¸ƒå¼æ•°æ®é›†ï¼Œ ä¸å¯å˜çš„ï¼Œ å¯åˆ†åŒºçš„åˆ†å¸ƒå¼é›†åˆ(2) å±æ€§ï¼š A list of partitions A function for computing on other RDDs A list of dependencies on other RDDs Optionally, a Partition for key-value RDDs (e.g. to say that the RDD is hash-partitioned) Optionally, a list of preferred locations to compute each split on (e.g. block locations for an HDFS file) RDD æ‘˜è¦2ï¼š (1). æ¦‚å¿µ å¼¹æ€§åˆ†å¸ƒå¼æ•°æ®é›†ä¸å¯å˜çš„ï¼Œå¯åˆ†åŒºçš„åˆ†å¸ƒå¼é›†åˆ (2). äº”å¤§å±æ€§ åˆ†åŒº (A list of partitions)ä½œç”¨åœ¨æ¯ä¸ªåˆ†åŒºä¹‹ä¸Šçš„ä¸€ä¸ªå‡½æ•°ä¾èµ–ï¼š å®½ä¾èµ– &amp; çª„ä¾èµ–KeyValueRDD åˆ†åŒºå™¨RDD ä¼˜å…ˆä½ç½®åˆ—è¡¨ (3). å®˜æ–¹ï¼Œ åˆ›å»º RDD çš„2ç§æ–¹å¼ parallelize() makeRDD()parallelizing an existing collextion in your driver program textFile() å¼•ç”¨ä¸€ä¸ªå¤–éƒ¨å­˜å‚¨ç³»ç»Ÿ referencing a dataset in an external storage systemHDFS ä½œç”¨åœ¨æ¯ä¸ªRDDä¹‹ä¸Šçš„ç®—å­: Transformation. RDD â€”-&gt; RDD Action. RDD â€”-&gt; Scala å¯¹è±¡ or é›†åˆ WordCount å„ç§æµç¨‹çš„åˆ’åˆ†ï¼š WordCount DAG æœ‰å‘æ— ç¯å›¾ï¼š Reference Sparkå¹¿æ’­å˜é‡å’Œç´¯åŠ å™¨è¯¦è§£ é©¬è€å¸ˆ-Sparkçš„WordCountåˆ°åº•äº§ç”Ÿäº†å¤šå°‘ä¸ªRDD å¤§æ•°æ®æŠ€æœ¯ä¹‹_19_Sparkå­¦ä¹ _02_Spark Core åº”ç”¨è§£æ å®ä¾‹ç»ƒä¹  ç¨‹åºå‘˜è™¾è¯´:Spark Transformationç®—å­è¯¦è§£ linsay Offerå¸® è‹±è¯­å­¦ä¹ åŒ…","categories":[{"name":"spark","slug":"spark","permalink":"http://iequa.com/categories/spark/"}],"tags":[{"name":"spark","slug":"spark","permalink":"http://iequa.com/tags/spark/"}]},{"title":"Sequence Models (week1) - Recurrent Neural Networks","slug":"deeplearning/Sequence-Models-week1","date":"2018-07-26T11:00:21.000Z","updated":"2019-10-20T04:30:35.019Z","comments":true,"path":"2018/07/26/deeplearning/Sequence-Models-week1/","link":"","permalink":"http://iequa.com/2018/07/26/deeplearning/Sequence-Models-week1/","excerpt":"è¿™æ¬¡æˆ‘ä»¬è¦å­¦ä¹ ä¸“é¡¹è¯¾ç¨‹ä¸­ç¬¬äº”é—¨è¯¾ Sequence Models. ç¬¬ä¸€å‘¨: Recurrent Neural Networks å·²è¢«è¯æ˜åœ¨æ—¶é—´æ•°æ®ä¸Šè¡¨ç°å¥½ï¼Œå®ƒæœ‰å‡ ä¸ªå˜ä½“ï¼ŒåŒ…æ‹¬ LSTMã€GRU å’ŒåŒå‘ç¥ç»ç½‘ç»œ.","text":"è¿™æ¬¡æˆ‘ä»¬è¦å­¦ä¹ ä¸“é¡¹è¯¾ç¨‹ä¸­ç¬¬äº”é—¨è¯¾ Sequence Models. ç¬¬ä¸€å‘¨: Recurrent Neural Networks å·²è¢«è¯æ˜åœ¨æ—¶é—´æ•°æ®ä¸Šè¡¨ç°å¥½ï¼Œå®ƒæœ‰å‡ ä¸ªå˜ä½“ï¼ŒåŒ…æ‹¬ LSTMã€GRU å’ŒåŒå‘ç¥ç»ç½‘ç»œ. 1. Why sequence models?ä¸ºä»€ä¹ˆè¦å­¦ä¹ åºåˆ—æ¨¡å‹å‘¢? åºåˆ—æ¨¡å‹, æ™®éç§°ä¸º RNN (é€’å½’ç¥ç»ç½‘ç»œ - Recurrent Neural Network), åšä¸ºæ·±åº¦å­¦ä¹ ä¸­éå¸¸é‡è¦çš„ä¸€ç¯ï¼Œæœ‰ç€æ¯”æ™®é€šç¥ç»ç½‘ç»œæ›´å¹¿çš„å®½åº¦ä¸æ›´å¤šçš„å¯èƒ½æ€§ï¼Œå…¶åº”ç”¨é¢†åŸŸåŒ…æ‹¬ä½†ä¸é™äºâ€œè¯­éŸ³è¯†åˆ«â€ï¼Œ â€œNLPâ€ï¼Œ â€œDNAåºåˆ—åˆ†æâ€ï¼Œâ€œMachine Translationâ€ï¼Œ â€œè§†é¢‘åŠ¨ä½œåˆ†æâ€ï¼Œç­‰ç­‰â€¦ æœ‰è¿™æ ·ä¸€ç§è¯´æ³•ï¼Œä¹Ÿè®¸å¹¶ä¸ä¸¥è°¨ï¼Œä½†æœ‰åŠ©äºæˆ‘ä»¬ç†è§£RNNï¼Œå¤§æ„æ˜¯è¿™æ ·çš„: æ™®é€šç¥ç»ç½‘ç»œå¤„ç†çš„æ˜¯ä¸€ç»´çš„æ•°æ®ï¼ŒCNN å¤„ç†çš„æ˜¯äºŒç»´çš„æ•°æ®ï¼ŒRNN å¤„ç†çš„æ˜¯ä¸‰ç»´çš„æ•°æ® æœ€ç›´è§‚çš„ç†è§£æ˜¯åœ¨ CNN å¯¹å›¾ç‰‡çš„åˆ†æåŸºç¡€ä¸Šï¼ŒRNN å¯ä»¥å¯¹è§†é¢‘è¿›è¡Œåˆ†æï¼Œè¿™é‡Œä¹Ÿå°±å¼•å…¥äº†ç¬¬ä¸‰ç»´â€œæ—¶é—´â€çš„æ¦‚å¿µ è¿™ä¸€å°èŠ‚é€šè¿‡ä¸€ä¸ªå°ä¾‹å­ä¸ºæˆ‘ä»¬æ‰“å¼€åºåˆ—æ¨¡å‹çš„å¤§é—¨ï¼Œä¾‹å­å¦‚ä¸‹: ç»™å‡ºè¿™æ ·ä¸€ä¸ªå¥å­ â€œHarry Potter and Herminone Granger invented a new spell.â€(å“ˆåˆ©æ³¢ç‰¹ä¸èµ«æ•æ ¼å…°æ°å‘æ˜äº† ä¸€ä¸ªæ–°çš„å’’è¯­ã€‚)ï¼Œ æˆ‘ä»¬çš„ä»»åŠ¡æ˜¯åœ¨è¿™ä¸ªå¥å­ä¸­å‡†ç¡®çš„å®šä½åˆ°äººå Harry Potter å’Œ Herminone Granger. ç”¨æ·±åº¦å­¦ä¹ çš„è¯­è¨€æ¥æè¿°å¦‚ä¸‹å›¾ - æ¯ä¸€ä¸ªå•è¯å¯¹åº”ä¸€ä¸ªè¾“å‡º 0 æˆ–è€… 1ï¼Œ1 ä»£è¡¨ç€æ˜¯äººåï¼Œ0 ä»£è¡¨ä¸æ˜¯ã€‚ æ¥ä¸‹æ¥æˆ‘ä»¬è¦è§£å†³çš„ä¸€ä¸ªé—®é¢˜æ˜¯å¦‚ä½•æ‰èƒ½ä»£è¡¨ä¸€ä¸ªå•è¯?ï¼Œæ¯”å¦‚æˆ‘ä»¬ä¾‹å­ä¸­çš„ â€œHarryâ€ï¼Œè¿™é‡Œæˆ‘ä»¬ä»‹ç»ä¸€ç§æ–°çš„ç¼–ç æ–¹å¼ï¼Œ å°±æ˜¯ç”¨å¦ä¸€ç§æ–¹å¼æ¥ä»£è¡¨æ¯ä¸€ä¸ªå•è¯ - ç‹¬çƒ­ç¼–ç ï¼ˆOne-Hot Encodingï¼‰ã€‚ å…·ä½“æµç¨‹æ˜¯è¿™æ ·ï¼Œå‡è®¾æˆ‘ä»¬æœ‰ 10000 ä¸ªå¸¸ç”¨è¯ï¼Œä¸ºå…¶æ„å»ºä¸€ä¸ª10000*1 çš„çŸ©é˜µ(column matrix)ï¼Œå‡å¦‚ç¬¬ä¸€ä¸ªè¯æ˜¯è‹¹æœ(apple), é‚£ä¹ˆå¯¹åº”çš„ç¬¬ä¸€ä¸ªä½ç½®ä¸º 1ï¼Œå…¶ä»–éƒ½ä¸º 0ï¼Œæ‰€ä»¥ç§°ä¹‹ä¸ºç‹¬çƒ­ã€‚è¿™æ ·æ¯ä¸ªå•è¯éƒ½æœ‰å¯¹åº”çš„çŸ©é˜µè¿›è¡Œè¡¨ç¤ºï¼Œå¦‚æœè¿™ä¸ªè¯æ²¡æœ‰å‡ºç°åœ¨æˆ‘ä»¬çš„å­—å…¸ä¸­ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ç»™ä¸€ä¸ªç‰¹æ®Šçš„ç¬¦å·ä»£æ›¿ï¼Œå¸¸ç”¨çš„æ˜¯ (unknown) 2. Notationä¸ºäº†åé¢æ–¹ä¾¿è¯´æ˜ï¼Œå…ˆå°†ä¼šç”¨åˆ°çš„æ•°å­¦ç¬¦å·è¿›è¡Œä»‹ç». ä»¥ä¸‹å›¾ä¸ºä¾‹ï¼Œå‡å¦‚æˆ‘ä»¬éœ€è¦å®šä½ä¸€å¥è¯ä¸­äººåå‡ºç°çš„ä½ç½®. çº¢è‰²æ¡†ä¸­çš„ä¸ºè¾“å…¥ã€è¾“å‡ºå€¼ã€‚å¯ä»¥çœ‹åˆ°äººåè¾“å‡ºç”¨ 1 è¡¨ç¤ºï¼Œåä¹‹ç”¨ 0 è¡¨ç¤ºï¼› ç»¿è‰²æ¡†ä¸­çš„ $x^{&lt; t >}$,$y^{&lt; t >}$ è¡¨ç¤ºå¯¹åº”çº¢è‰²æ¡†ä¸­çš„è¾“å…¥è¾“å‡ºå€¼çš„æ•°å­¦è¡¨ç¤ºï¼Œæ³¨æ„ä» 1 å¼€å§‹. ç°è‰²æ¡†ä¸­çš„ $T_x,T_y$ åˆ†åˆ«è¡¨ç¤ºè¾“å…¥è¾“å‡ºåºåˆ—çš„é•¿åº¦ï¼Œåœ¨è¯¥ä¾‹ä¸­ï¼Œ$T_x=9,T_y=9$ é»„è‰²æ¡†ä¸­ $X^{(i)&lt; t >}$ ä¸Šçš„è¡¨ç¤ºç¬¬ $i$ ä¸ªè¾“å…¥æ ·æœ¬çš„ç¬¬ $t$ ä¸ªè¾“å…¥å€¼ï¼Œ$T_x^{ (i) }$ åˆ™è¡¨ç¤ºç¬¬ $i$ ä¸ªè¾“å…¥æ ·æœ¬çš„é•¿åº¦ã€‚è¾“å‡º $y$ ä¹ŸåŒç†. è¾“å…¥å€¼ä¸­æ¯ä¸ªå•è¯ä½¿ç”¨ One-Hot æ¥è¡¨ç¤ºã€‚å³é¦–å…ˆä¼šæ„å»ºä¸€ä¸ªå­—å…¸(Dictionary), å‡è®¾è¯¥ä¾‹ä¸­çš„å­—å…¸ç»´åº¦æ˜¯ 10000*1 (å¦‚å›¾ç¤º)ã€‚ç¬¬ä¸€ä¸ªå•è¯ â€œHarryâ€ çš„æ•°å­¦è¡¨ç¤ºå½¢å¼å³ä¸º [0,0,0,â€¦â€¦,1 (åœ¨ç¬¬4075ä½) ,0,â€¦â€¦,0]ï¼Œå…¶ä»–å•è¯åŒç†ã€‚ ä½†æ˜¯å¦‚æœæŸä¸€ä¸ªå•è¯å¹¶æ²¡æœ‰è¢«åŒ…å«åœ¨å­—å…¸ä¸­æ€ä¹ˆåŠå‘¢ï¼Ÿæ­¤æ—¶æˆ‘ä»¬å¯ä»¥æ·»åŠ ä¸€ä¸ªæ–°çš„æ ‡è®°ï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ªå«åš Unknown Word çš„ä¼ªé€ å•è¯ï¼Œç”¨ &lt;UNK&gt; è¡¨ç¤ºã€‚å…·ä½“çš„ç»†èŠ‚ä¼šåœ¨åé¢ä»‹ç»ã€‚ 3. Recurrent Neural Network Modelåœ¨ä»‹ç» RNN ä¹‹å‰ï¼Œé¦–å…ˆè§£é‡Šä¸€ä¸‹ä¸ºä»€ä¹ˆä¹‹å‰çš„æ ‡å‡†ç½‘ç»œä¸å†é€‚ç”¨äº†ã€‚å› ä¸ºå®ƒæœ‰ä¸¤ä¸ªç¼ºç‚¹ï¼š è¾“å…¥å’Œè¾“å‡ºçš„é•¿åº¦ä¸å°½ç›¸åŒ æ— æ³•å…±äº«ä»å…¶ä»–ä½ç½®å­¦æ¥çš„ç‰¹å¾ ä¾‹å¦‚ä¸Šä¸€èŠ‚ä¸­çš„ Harry è¿™ä¸ªè¯æ˜¯ç”¨ $x^{}$ è¡¨ç¤ºçš„ï¼Œç½‘ç»œä»è¯¥ä½ç½®å­¦ä¹ äº†å®ƒæ˜¯ä¸€ä¸ªäººåã€‚ä½†æˆ‘ä»¬å¸Œæœ›æ— è®º Harry åœ¨å“ªä¸ªä½ç½®å‡ºç°ç½‘ç»œéƒ½èƒ½è¯†åˆ«å‡ºè¿™æ˜¯ä¸€ä¸ªäººåçš„ä¸€éƒ¨åˆ†ï¼Œè€Œæ ‡å‡†ç½‘ç»œæ— æ³•åšåˆ°è¿™ä¸€ç‚¹. è¾“å…¥å±‚ï¼Œæ¯”å¦‚æ¯ä¸ª $x^{}$ éƒ½æ˜¯ä¸€ä¸ª 1000 ç»´çš„å‘é‡ï¼Œè¿™æ ·è¾“å…¥å±‚å¾ˆåºå¤§, é‚£ä¹ˆç¬¬ä¸€å±‚çš„æƒé‡çŸ©é˜µå°±æœ‰ç€å·¨å¤§çš„å‚æ•°. 3.1 RNN ç»“æ„ è¿˜æ˜¯ä»¥è¯†åˆ«äººåä¸ºä¾‹,ç¬¬ä¸€ä¸ªå•è¯ $x^{}$ è¾“å…¥ç¥ç»ç½‘ç»œå¾—åˆ°è¾“å‡º $y^{}$ åŒç†, ç”± $x^{}$ å°†å¾—åˆ° $y^{}$,ä»¥æ­¤ç±»æ¨ã€‚ä½†æ˜¯è¿™å°±æ˜¯ä¼ ç»Ÿç½‘ç»œå­˜åœ¨çš„é—®é¢˜ï¼Œå³å•è¯ä¹‹é—´æ²¡æœ‰è”ç³» ä¸ºäº†å°†å•è¯ä¹‹é—´å…³è”èµ·æ¥ï¼Œæ‰€ä»¥å°†å‰ä¸€å±‚çš„ç»“æœä¹Ÿä½œä¸ºä¸‹ä¸€å±‚çš„è¾“å…¥æ•°æ®ã€‚å¦‚ä¸‹å›¾ç¤º æ•´ä½“çš„ RNN ç»“æ„æœ‰ä¸¤ç§è¡¨ç¤ºå½¢å¼ï¼Œå¦‚ä¸‹å›¾ç¤º, å·¦è¾¹æ˜¯å®Œæ•´çš„è¡¨è¾¾å½¢å¼ï¼Œæ³¨æ„ç¬¬ä¸€å±‚çš„ $a^{}$ ä¸€èˆ¬è®¾ç½®ä¸º 0å‘é‡. è¦å¼€å§‹æ•´ä¸ªæµç¨‹, éœ€è¦ç¼–é€ ä¸€ä¸ªæ¿€æ´»å€¼, è¿™é€šå¸¸æ˜¯ 0å‘é‡, æœ‰äº›ç ”ç©¶äººå‘˜ä¼šç”¨å…¶ä»–æ–¹æ³•éšæœºåˆå§‹åŒ– $a^{}=\\vec{0}$. ä¸è¿‡ä½¿ç”¨ 0å‘é‡ï¼Œä½œä¸º 0æ—¶åˆ» çš„ä¼ªæ¿€æ´»å€¼ æ˜¯æœ€å¸¸è§çš„é€‰æ‹©. å› æ­¤æˆ‘ä»¬æŠŠå®ƒè¾“å…¥ç¥ç»ç½‘ç»œ. (å³è¾¹çš„ç¤ºæ„å›¾æ˜¯ RNN çš„ç®€å†™ç¤ºæ„å›¾) ä»‹ç»å®Œç»“æ„ä¹‹åï¼Œæˆ‘ä»¬è¿˜éœ€è¦çŸ¥é“ç½‘ç»œä¸­å‚æ•°çš„è¡¨è¾¾æ–¹å¼åŠå…¶å«ä¹‰ã€‚å¦‚ä¸‹å›¾ç¤ºï¼Œ$x^{&lt;{i}&gt;}$ åˆ°ç½‘ç»œçš„å‚æ•°ç”¨ $W_{ax}$ è¡¨ç¤ºï¼Œ$a^{&lt;{i}&gt;}$ åˆ°ç½‘ç»œçš„å‚æ•°ç”¨ $W_{aa}$ è¡¨ç¤ºï¼Œ$y^{&lt;{i}&gt;}$ åˆ°ç½‘ç»œçš„å‚æ•°ç”¨ $W_{ya}$ è¡¨ç¤ºï¼Œå…·ä½“å«ä¹‰å°†åœ¨ä¸‹é¢è¿›è¡Œè¯´æ˜. $x^{}$ é€šè¿‡ç½‘ç»œå¯ä»¥ä¼ é€’åˆ° $y^{}$ ä½†æ˜¯è¿™å­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼Œå³æ¯ä¸ªè¾“å‡ºåªä¸å‰é¢çš„è¾“å…¥æœ‰å…³ï¼Œè€Œä¸åé¢çš„æ— å…³ã€‚è¿™ä¸ªé—®é¢˜ä¼šåœ¨åç»­å†…å®¹ä¸­è¿›è¡Œæ”¹è¿›. ä¸¾ä¸ªğŸŒ°: He said, â€œTeddy Roosevelt was a great President.â€ å¯¹äºè¿™å¥è¯ï¼ŒåªçŸ¥é“ He said å‰é¢ä¸¤ä¸ªè¯ï¼Œæ¥åˆ¤æ–­ Teddy æ˜¯å¦æ˜¯äººåæ˜¯ä¸å¤Ÿçš„ï¼Œè¿˜éœ€åé¢çš„ä¿¡æ¯.ï¼ˆBRNN å¯å¤„ç†è¿™é—®é¢˜ï¼‰ 3.2 RNN Forward Propagationçœ‹ RNN Forward Propagation ä¹‹å‰ï¼Œå…ˆçœ‹ä¸‹åŸºæœ¬çš„æ ‡å‡†ç½‘ç»œ RNN åœ¨æ­£å‘ä¼ æ’­çš„è¿‡ç¨‹ä¸­å¯ä»¥çœ‹åˆ° a çš„å€¼éšç€æ—¶é—´çš„æ¨ç§»è¢«ä¼ æ’­äº†å‡ºå»ï¼Œä¹Ÿå°±ä¸€å®šç¨‹åº¦ä¸Šä¿å­˜äº†å•è¯ä¹‹é—´çš„ç‰¹æ€§: $a^{}=\\vec{0}$ $a^{}=g_1(W_{aa}a^{}+W_{ax}x^{}+b_a)$ $y^{}=g_2(W_{ya}a^{}+b_y)$ $a^{&lt;{t}&gt;}=g_1(W_{aa}a^{&lt;{t-1}&gt;}+W_{ax}x^{&lt;{t}&gt;}+b_a)$ $y^{&lt;{t}&gt;}=g_2(W_{ya}a^{&lt;{t}&gt;}+b_y)$ æ¿€æ´»å‡½æ•°ï¼š$g_1$ ä¸€èˆ¬ä¸º tanhå‡½æ•° (æˆ–è€…æ˜¯ Reluå‡½æ•°)ï¼Œ$g_2$ ä¸€èˆ¬æ˜¯ Sigmodå‡½æ•°. æ³¨æ„: å‚æ•°çš„ä¸‹æ ‡æ˜¯æœ‰é¡ºåºå«ä¹‰çš„ï¼Œå¦‚ $W_{ax}$ ä¸‹æ ‡çš„ç¬¬ä¸€ä¸ªå‚æ•°è¡¨ç¤ºè¦è®¡ç®—çš„é‡çš„ç±»å‹ï¼Œå³è¦è®¡ç®— $a$ çŸ¢é‡ï¼Œç¬¬äºŒä¸ªå‚æ•°è¡¨ç¤ºè¦è¿›è¡Œä¹˜æ³•è¿ç®—çš„æ•°æ®ç±»å‹ï¼Œå³éœ€è¦ä¸ $x$ çŸ¢é‡åšè¿ç®—ã€‚å¦‚ $W_{ax} x^{t}\\rightarrow{a}$ Tx ï¼Œ Ty æ˜¯æ—¶é—´å•ä½, è¿™é‡Œç»Ÿç§°ä¸ºâ€œæ—¶åˆ»â€ï¼Œåœ¨è¿™ä¾‹å­ä¸­å¯¹åº”ä¸åŒæ—¶åˆ»æ˜¯è¾“å…¥çš„ç¬¬å‡ ä¸ªå•è¯ï¼Œ x æ˜¯â€œè¾“å…¥å€¼â€ï¼Œä¾‹å­ä¸­æ˜¯å½“å‰æ—¶åˆ»çš„å•è¯ï¼ˆä»¥ç‹¬çƒ­ç¼–ç çš„å½¢å¼ï¼‰ï¼Œ y æ˜¯â€œè¾“å‡ºå€¼â€ 0 æˆ–è€… 1ï¼Œ a ç§°ä¸ºæ¿€æ´»å€¼ç”¨äºå°†å‰ä¸€ä¸ªå•å…ƒçš„è¾“å‡ºç»“æœä¼ é€’åˆ°ä¸‹ä¸€ä¸ªå•å…ƒï¼Œ Wax Way Waa æ˜¯ä¸åŒçš„â€œæƒé‡çŸ©é˜µâ€ä¹Ÿå°±æ˜¯æˆ‘ä»¬ç¥ç»ç½‘ç»œ update çš„å€¼ã€‚æ¯ä¸€ä¸ªå•å…ƒæœ‰ä¸¤ä¸ªè¾“å…¥ï¼Œ$a^{&lt;{T_x-1}&gt;}$ å’Œ x ï¼Œæœ‰ä¸¤ä¸ªè¾“å‡º $a^{&lt;{T_x}&gt;}$ å’Œ y . å›¾ä¸­æ²¡æœ‰å‡ºç°çš„ g æ˜¯â€œæ¿€æ´»å‡½æ•°â€ã€‚ ç¬¦å· åå­— $x$ è¾“å…¥å€¼ $a$ æ¿€æ´»å€¼ $T_x$, $T_y$ $x$,$y$ æ—¶åˆ» Wax, Way, Waa æƒé‡çŸ©é˜µ 3.3 Simplified RNN notationä¸‹é¢å°†å¯¹å¦‚ä¸‹å…¬å¼è¿›è¡ŒåŒ–ç®€ï¼š 1. ç®€åŒ– $a^{&lt;{t}&gt;}$ \\begin{align} a^{}&= g(W\\_{aa}a^{}+W\\_{ax}x^{}+b\\_a) \\notag \\\\\\\\ &= g(W\\_a [a^{},x^{}]^{T}+b\\_a) \\notag \\end{align} æ³¨æ„ï¼Œå…¬å¼ä¸­ä½¿ç”¨äº†ä¸¤ä¸ªçŸ©é˜µè¿›è¡ŒåŒ–ç®€ï¼Œåˆ†åˆ«æ˜¯ $W_a$ å’Œ $[a^{&lt;{t-1}&gt;},x^{&lt;{t}&gt;}]^T$ (ä½¿ç”¨è½¬ç½®ç¬¦å·æ›´æ˜“ç†è§£),ä¸‹é¢åˆ†åˆ«è¿›è¡Œè¯´æ˜ï¼š $W_a = [ W_{aa}, W_{ax} ]$, å‡è®¾ $W_{aa}$ æ˜¯ (100,100) çš„çŸ©é˜µï¼Œ$W_{ax}$ æ˜¯ (100,10000) çš„çŸ©é˜µ,é‚£ä¹ˆ $W$ åˆ™æ˜¯ (100,10100) çš„çŸ©é˜µ. $[a^{&lt;{t-1}&gt;},x^{&lt;{t}&gt;}]^T$ æ˜¯ä¸‹å›¾ç¤ºæ„: æ•… $W_a [a^{&lt;{t-1}&gt;},x^{&lt;{t}&gt;}]^{T}$ çŸ©é˜µè®¡ç®—å¦‚ä¸‹å›¾ç¤º: 2. ç®€åŒ– $y^{&lt;{t}&gt;}$ è¯¥èŠ‚PPTå†…å®¹ï¼š å†å›é¡¾ä¸‹å¹²å‡€çš„å‰å‘ä¼ æ’­æ¦‚è§ˆå›¾: 4. Backpropagation through timeRNN çš„åå‘ä¼ æ’­é€šå¸¸éƒ½ç”±ç±»ä¼¼ Tensorflowã€Torch ä¹‹ç±»çš„åº“æˆ–è€…æ¡†æ¶å¸®ä½ å®Œæˆï¼Œä¸è¿‡æ„Ÿå®˜ä¸Šå’Œæ™®é€šç¥ç»ç½‘ç»œç±»ä¼¼ï¼Œç®—æ¢¯åº¦å€¼ç„¶åæ›´æ–°æƒé‡çŸ©é˜µ. ä½†æ˜¯ä¸‹é¢è¿™é‡Œä¾ç„¶ä¼šå¯¹åå‘ä¼ æ’­è¿›è¡Œè¯¦ç»†çš„ä»‹ç»ï¼Œè·Ÿç€ä¸‹é¢ä¸€å¼ ä¸€å¼ çš„å›¾ç‰‡èµ°èµ·æ¥ ğŸ˜„ğŸ˜„: 4.1 æ•´ä½“æ„Ÿå—é¦–å…ˆå†å›é¡¾ä¸€ä¸‹ RNN çš„æ•´ä½“ç»“æ„: è¦è¿›è¡Œåå‘ä¼ æ’­ï¼Œé¦–å…ˆéœ€è¦å‰å‘ä¼ æ’­ï¼Œä¼ æ’­æ–¹å‘å¦‚è“è‰²ç®­å¤´æ‰€ç¤ºï¼Œå…¶æ¬¡å†æŒ‰ç…§çº¢è‰²ç®­å¤´è¿›è¡Œåå‘ä¼ æ’­ 4.2 å‰å‘ä¼ æ’­é¦–å…ˆç»™å‡ºæ‰€æœ‰è¾“å…¥æ•°æ®ï¼Œå³ä» $x^{}$ åˆ° $x^{&lt;{T_x}&gt;}$, $T_x$ è¡¨ç¤ºè¾“å…¥æ•°æ®çš„æ•°é‡. åˆå§‹åŒ–å‚æ•° $W_a$, $b_a$ï¼Œå°†è¾“å…¥æ•°æ®è¾“å…¥ç½‘ç»œå¾—åˆ°å¯¹åº”çš„ $a^{&lt;{t}&gt;}$ å†é€šè¿‡ä¸åˆå§‹åŒ–å‚æ•° $W_y$, $b_y$ å¾—åˆ° $y^{&lt;{t}&gt;}$ 4.3 æŸå¤±å‡½æ•°å®šä¹‰è¦è¿›è¡Œåå‘ä¼ æ’­ï¼Œå¿…é¡»å¾—æœ‰æŸå¤±å‡½æ•°å˜›ï¼Œæ‰€ä»¥æˆ‘ä»¬å°†æŸå¤±å‡½æ•°å®šä¹‰å¦‚ä¸‹ï¼š æ¯ä¸ªèŠ‚ç‚¹çš„æŸå¤±å‡½æ•°: L^{}(\\hat{y}^{},y^{})=y^{}log(y^{})-(1-y^{})log(1-\\hat{y}^{})æ•´ä¸ªç½‘ç»œçš„æŸå¤±å‡½æ•°: L(\\hat{y}^{},y^{)}) = \\sum\\_{t=1}^{T\\_y}L^{}(\\hat{y}^{},y^{}) 4.4 åå‘ä¼ æ’­ 4.5 æ•´ä¸ªæµç¨‹å›¾ 5. Different types of RNNsRNN çš„ä¸åŒåº”ç”¨é¢†åŸŸ: åºåˆ—æ¨¡å‹å¯¹è¾“å…¥ä¸è¾“å‡ºçš„é•¿åº¦æ²¡æœ‰è¦æ±‚ï¼Œåœ¨å¸¸è§çš„ä¾‹å­ä¸­ï¼Œæœºå™¨ç¿»è¯‘å°±æ˜¯å¤šä¸ªè¾“å…¥ä¸å¤šä¸ªè¾“å‡ºï¼Œç®€ç§°â€œå¤šå¯¹å¤šâ€ï¼Œ è¯­éŸ³è¯†åˆ«å¯è§†ä¸ºâ€œå•å¯¹å¤šâ€ï¼Œ å®ƒçš„åä¾‹æ˜¯éŸ³ä¹ç”Ÿæˆ-â€œå¤šå¯¹å•â€ã€‚è¯¾ç¨‹ä¸­ä»‹ç»äº†å¤šç§å¯èƒ½çš„ RNN æ¨¡å¼ï¼Œæˆ‘ä»¬ç”¨ä¸‹é¢ä¸€å¼ å›¾æ¦‚æ‹¬ï¼š RNN ä¸åŒçš„ç»“æ„ç»™äº†æˆ‘ä»¬æ›´å¤šçš„å¯èƒ½æ€§. 6. Language model and sequence generationè¯­è¨€æ¨¡å‹å’Œåºåˆ—ç”Ÿæˆ 6.1 ä»€ä¹ˆæ˜¯è¯­è¨€æ¨¡å‹å‡¡äº‹å¼€å¤´ä¸¾ä¸ªğŸŒ°ï¼Œä¸€åˆ‡éƒ½å¥½è¯´ï¼š å‡è®¾ä¸€ä¸ªè¯­éŸ³è¯†åˆ«ç³»ç»Ÿå¬ä¸€å¥è¯å¾—åˆ°äº†å¦‚ä¸‹ä¸¤ç§é€‰æ‹©ï¼Œä½œä¸ºæ­£å¸¸äººè‚¯å®šä¼šé€‰æ‹©ç¬¬äºŒç§ã€‚ä½†æ˜¯æœºå™¨æ‰å¦‚ä½•åšåˆ¤æ–­å‘¢ï¼Ÿ æ­¤æ—¶å°±éœ€è¦é€šè¿‡è¯­è¨€æ¨¡å‹æ¥é¢„æµ‹æ¯å¥è¯çš„æ¦‚ç‡ï¼š 6.2 å¦‚ä½•ä½¿ç”¨ RNN æ„å»ºè¯­è¨€æ¨¡å‹ é¦–å…ˆæˆ‘ä»¬éœ€è¦ä¸€ä¸ªå¾ˆå¤§çš„è¯­æ–™åº“ (Corpus) å°†æ¯ä¸ªå•è¯å­—ç¬¦åŒ– (Tokenizeï¼Œå³ä½¿ç”¨One-shotç¼–ç ) å¾—åˆ°è¯å…¸,ï¼Œå‡è®¾æœ‰ 10000 ä¸ªå•è¯ è¿˜éœ€è¦æ·»åŠ ä¸¤ä¸ªç‰¹æ®Šçš„å•è¯ end of sentence. ç»ˆæ­¢ç¬¦ï¼Œè¡¨ç¤ºå¥å­ç»“æŸ. UNknown, ä¹‹å‰çš„ç¬”è®°å·²ä»‹ç»è¿‡ 6.3 æ„å»ºè¯­è¨€æ¨¡å‹ç¤ºä¾‹å‡è®¾è¦å¯¹è¿™å¥è¯è¿›è¡Œå»ºæ¨¡ï¼šCats average 15 hours of sleep a day. 1. åˆå§‹åŒ– è¿™ä¸€æ­¥æ¯”è¾ƒç‰¹æ®Šï¼Œå³ $x^{}$ å’Œ $a^{}$ éƒ½éœ€è¦åˆå§‹åŒ–ä¸º $\\vec{0}$ .æ­¤æ—¶ $\\hat{y}^{}$ å°†ä¼šå¯¹ç¬¬ä¸€ä¸ªå­—å¯èƒ½å‡ºç°çš„æ¯ä¸€ä¸ªå¯èƒ½è¿›è¡Œæ¦‚ç‡çš„åˆ¤æ–­,å³ $\\hat{y}^{}=[p(a),â€¦,p(cats),â€¦]$. å½“ç„¶åœ¨æœ€å¼€å§‹çš„æ—¶å€™æ²¡æœ‰ä»»ä½•çš„ä¾æ®ï¼Œå¯èƒ½å¾—åˆ°çš„æ˜¯å®Œå…¨ä¸ç›¸å¹²çš„å­—ï¼Œå› ä¸ºåªæ˜¯æ ¹æ®åˆå§‹çš„å€¼å’Œæ¿€æ´»å‡½æ•°åšå‡ºçš„å–æ ·ã€‚ 2. å°†çœŸå®å€¼ä½œä¸ºè¾“å…¥å€¼: ä¹‹æ‰€ä»¥å°†çœŸå®å€¼ä½œä¸ºè¾“å…¥å€¼å¾ˆå¥½ç†è§£ï¼Œå¦‚æœæˆ‘ä»¬ä¸€ç›´ä¼ é”™è¯¯çš„å€¼ï¼Œå°†æ°¸è¿œä¹Ÿæ— æ³•å¾—åˆ°å­—ä¸å­—ä¹‹é—´çš„å…³ç³» å¦‚ä¸‹å›¾ç¤ºï¼Œå°† $y^{}$ æ‰€è¡¨ç¤ºçš„çœŸå®å€¼ Cats ä½œä¸ºè¾“å…¥ï¼Œå³ $x^{}=y^{}$ å¾—åˆ° $\\hat{y}^{}$ æ­¤æ—¶çš„ $\\hat{y}^{}=[p(a|cats),â€¦,p(average|cats),â€¦]$ åŒç†æœ‰ $\\hat{y}^{}=[p(a|cats\\, average),â€¦,p(average|cats\\,average),â€¦]$ å¦å¤–è¾“å…¥å€¼æ»¡è¶³ï¼š $x^{&lt;{t}&gt;}=y^{&lt;{t-1}&gt;}$ 3. è®¡ç®—å‡ºæŸå¤±å€¼: ä¸‹å›¾ç»™å‡ºäº†æ„å»ºæ¨¡å‹çš„è¿‡ç¨‹ä»¥åŠæŸå¤±å€¼è®¡ç®—å…¬å¼: éšç€è®­ç»ƒçš„æ¬¡æ•°çš„å¢å¤šï¼Œæˆ–è€…å¸¸ç”¨è¯å‡ºç°çš„é¢‘ç‡çš„å¢å¤šï¼Œè¯­è¨€æ¨¡å‹ä¾¿æ…¢æ…¢çš„ä¼šå¼€å§‹æŒæ¡ç®€å•çš„è¯è¯­æ¯”å¦‚â€œå¹³å‡â€ï¼Œâ€œæ¯å¤©â€ï¼Œâ€œå°æ—¶â€ã€‚ä¸€ä¸ªå®Œå–„çš„è¯­è¨€æ¨¡å‹çœ‹åˆ°ç±»ä¼¼â€œ 10 ä¸ªå°â€çš„æ—¶å€™ï¼Œåº”è¯¥å°±èƒ½å‡†ç¡®çš„åˆ¤å®šä¸‹ä¸€ä¸ªå­—æ˜¯â€œæ—¶â€ã€‚ ï¼ˆå½“ç„¶ä¹Ÿè®¸å®é™…æƒ…å†µæ˜¯â€œ 10 ä¸ªå°æœ‹å‹â€ï¼Œæ‰€ä»¥é€šå¸¸ä¼šæœ‰æ›´å¤šçš„åˆ¤æ–­å› ç´ ï¼Œè¿™é‡Œåªæ˜¯ä¸€ä¸ªä¾‹å­ï¼‰ 7. Sampling novel sequenceså½“è®­ç»ƒå¾—åˆ°äº†ä¸€ä¸ªæ¨¡å‹ä¹‹åï¼Œå¦‚æƒ³çŸ¥é“è¿™ä¸ªæ¨¡å‹å­¦åˆ°äº†äº›ä»€ä¹ˆï¼Œä¸€ä¸ªéæ­£å¼çš„æ–¹æ³•å°±æ˜¯å¯¹æ–°åºåˆ—è¿›è¡Œé‡‡æ ·ã€‚å…·ä½“æ–¹æ³•å¦‚ä¸‹ï¼š åœ¨æ¯ä¸€æ­¥è¾“å‡º $\\hat{y}$ æ—¶ï¼Œé€šå¸¸ä½¿ç”¨ softmax ä½œä¸ºæ¿€æ´»å‡½æ•°ï¼Œç„¶åæ ¹æ®è¾“å‡ºçš„åˆ†å¸ƒï¼Œéšæœºé€‰æ‹©ä¸€ä¸ªå€¼ï¼Œä¹Ÿå°±æ˜¯å¯¹åº”çš„ä¸€ä¸ªå­— æˆ– è‹±æ–‡å•è¯ã€‚ ç„¶åå°†è¿™ä¸ªå€¼ä½œä¸ºä¸‹ä¸€ä¸ªå•å…ƒçš„ $x$ è¾“å…¥è¿›å» (å³ $x^{&lt;{t}&gt;}=\\hat{y}^{&lt;{t-1}&gt;}$, ç›´åˆ°æˆ‘ä»¬è¾“å‡ºäº†ç»ˆç»“ç¬¦ï¼Œæˆ–è€…è¾“å‡ºé•¿åº¦è¶…è¿‡äº†æå‰çš„é¢„è®¾å€¼ n æ‰åœæ­¢é‡‡æ ·. ä¸Šè¿°æ­¥éª¤å…·ä½“å¦‚å›¾ç¤ºï¼š ä¸‹å›¾ç»™å‡ºäº†é‡‡æ ·ä¹‹åå¾—åˆ°çš„æ•ˆæœï¼š å·¦è¾¹æ˜¯å¯¹è®­ç»ƒå¾—åˆ°æ–°é—»ä¿¡æ¯æ¨¡å‹è¿›è¡Œé‡‡æ ·å¾—åˆ°çš„å†…å®¹ï¼› å³è¾¹æ˜¯èå£«æ¯”äºšæ¨¡å‹é‡‡æ ·å¾—åˆ°çš„å†…å®¹. 8. Vanishing gradients with RNNs ç°åœ¨ä½ å·²ç»å­¦ä¼šäº† åŸºæœ¬çš„ RNN å¦‚ä½•åº”ç”¨åœ¨ æ¯”å¦‚ è¯­è¨€æ¨¡å‹ è¿˜æœ‰ å¦‚ä½•ç”¨åå‘ä¼ æ’­æ¥è®­ç»ƒä½ çš„ RNN æ¨¡å‹, ä½†æ˜¯è¿˜æœ‰ä¸€ä¸ªé—®é¢˜å°±æ˜¯ æ¢¯åº¦æ¶ˆå¤± ä¸ æ¢¯åº¦çˆ†ç‚¸ é—®é¢˜. ç›®å‰è¿™ç§åŸºæœ¬çš„ RNN ä¹Ÿä¸æ“…é•¿æ•è·è¿™ç§é•¿æœŸä¾èµ–æ•ˆåº”. æ¢¯åº¦çˆ†ç‚¸å¯ä»¥ç”¨æ¢¯åº¦æ¶ˆå‡è§£å†³ã€æ¢¯åº¦æ¶ˆå¤±å°±æœ‰ç‚¹éº»çƒ¦äº†ï¼Œéœ€è¦ç”¨ GRU æ¥è§£å†³. RNN çš„æ¢¯åº¦æ¶ˆå¤±ã€çˆ†ç‚¸é—®é¢˜: æ¢¯åº¦å€¼åœ¨ RNN ä¸­ä¹Ÿå¯èƒ½å› ä¸ºåå‘ä¼ æ’­çš„å±‚æ¬¡å¤ªå¤šå¯¼è‡´è¿‡å° æˆ– è¿‡å¤§ å½“æ¢¯åº¦å€¼è¿‡å°çš„æ—¶å€™ï¼Œç¥ç»ç½‘ç»œå°†æ— æ³•æœ‰æ•ˆåœ°è°ƒæ•´è‡ªå·±çš„æƒé‡çŸ©é˜µå¯¼è‡´è®­ç»ƒæ•ˆæœä¸ä½³ï¼Œç§°ä¹‹ä¸ºâ€œæ¢¯åº¦æ¶ˆå¤±é—®é¢˜â€(gradient vanishing problem)ï¼› è¿‡å¤§æ—¶å¯èƒ½ç›´æ¥å½±å“åˆ°ç¨‹åºçš„è¿ä½œå› ä¸ºç¨‹åºå·²ç»æ— æ³•å­˜å‚¨é‚£ä¹ˆå¤§çš„å€¼ï¼Œç›´æ¥è¿”å› NaN ï¼Œç§°ä¹‹ä¸ºâ€œæ¢¯åº¦çˆ†ç‚¸é—®é¢˜â€(gradient exploding problem) å½“æ¢¯åº¦å€¼è¿‡å¤§çš„æ—¶å€™æœ‰ä¸€ä¸ªæ¯”è¾ƒç®€ä¾¿çš„è§£å†³æ–¹æ³•ï¼Œæ¯æ¬¡å°†è¿”å›çš„æ¢¯åº¦å€¼è¿›è¡Œæ£€æŸ¥ï¼Œå¦‚æœè¶…å‡ºäº†é¢„å®šçš„èŒƒå›´ï¼Œåˆ™æ‰‹åŠ¨è®¾ç½®ä¸ºèŒƒå›´çš„è¾¹ç•Œå€¼. if (gradient &gt; max) &#123; gradient = max&#125; ä½†æ¢¯åº¦å€¼è¿‡å°çš„è§£å†³æ–¹æ¡ˆè¦ç¨å¾®å¤æ‚ä¸€ç‚¹ï¼Œæ¯”å¦‚ä¸‹é¢ä¸¤å¥è¯ï¼š â€œThe catï¼Œwhich already ate appleï¼Œyogurtï¼Œbananaï¼Œâ€¦, was full.â€â€œThe catsï¼Œwhich already ate appleï¼Œyogurtï¼Œbananaï¼Œâ€¦, were full.â€ é‡ç‚¹æ ‡å‡ºçš„ cat(s) å’Œ be åŠ¨è¯ï¼ˆwas, wereï¼‰ æ˜¯æœ‰å¾ˆé‡è¦çš„å…³è”çš„ï¼Œä½†æ˜¯ä¸­é—´éš”äº†ä¸€ä¸ª which å¼•å¯¼çš„å®šè¯­ä»å¥ï¼Œå¯¹äºå‰é¢æ‰€ä»‹ç»çš„åŸºç¡€çš„ RNNç½‘ç»œ å¾ˆéš¾å­¦ä¹ åˆ°è¿™ä¸ªä¿¡æ¯ï¼Œå°¤å…¶æ˜¯å½“å‡ºç°æ¢¯åº¦æ¶ˆå¤±æ—¶ï¼Œè€Œä¸”è¿™ç§æƒ…å†µå¾ˆå®¹æ˜“å‘ç”Ÿ. æˆ‘ä»¬çŸ¥é“ä¸€æ—¦ç¥ç»ç½‘ç»œå±‚æ¬¡å¾ˆå¤šæ—¶ï¼Œåå‘ä¼ æ’­å¾ˆéš¾å½±å“å‰é¢å±‚æ¬¡çš„å‚æ•°ã€‚æ‰€ä»¥ä¸ºäº† è§£å†³æ¢¯åº¦æ¶ˆå¤± é—®é¢˜ï¼Œæå‡ºäº† GRUå•å…ƒï¼Œä¸‹é¢ä¸€èŠ‚å…·ä½“ä»‹ç». å°†åœ¨æ¥ä¸‹æ¥çš„ä¸¤ä¸ªç« èŠ‚ä»‹ç»ä¸¤ç§æ–¹æ³•æ¥è§£å†³ æ¢¯åº¦è¿‡å° é—®é¢˜ï¼Œç›®æ ‡æ˜¯å½“ä¸€äº›é‡è¦çš„å•è¯ç¦»å¾—å¾ˆè¿œçš„æ—¶å€™ï¼Œæ¯”å¦‚ä¾‹å­ä¸­çš„ â€œcatâ€ å’Œ â€œwasâ€ï¼Œèƒ½è®©è¯­è¨€æ¨¡å‹å‡†ç¡®çš„è¾“å‡ºå•æ•°äººç§°è¿‡å»æ—¶çš„ â€œwasâ€ï¼Œè€Œä¸æ˜¯ â€œisâ€ æˆ–è€… â€œwereâ€. ä¸¤ä¸ªæ–¹æ³•éƒ½å°†å¼•å…¥â€œè®°å¿†â€çš„æ¦‚å¿µï¼Œä¹Ÿå°±æ˜¯ä¸º RNN èµ‹äºˆä¸€ä¸ªè®°å¿†çš„åŠŸèƒ½. 9. GRU - Gated Recurrent UnitGRUï¼ˆGated Recurrent Unitï¼‰æ˜¯ä¸€ç§ç”¨æ¥è§£å†³æ¢¯åº¦å€¼è¿‡å°çš„æ–¹æ³•ï¼Œé¦–å…ˆæ¥çœ‹ä¸‹åœ¨ä¸€ä¸ªæ—¶åˆ»ä¸‹çš„ RNNå•å…ƒï¼Œæ¿€æ´»å‡½æ•°ä¸º tanh 9.1 å›é¡¾æ™®é€š RNNå•å…ƒ çš„ç»“æ„å¦‚å›¾ç¤ºï¼Œè¾“å…¥æ•°æ®ä¸º $a^{&lt;{t-1}&gt;}$ å’Œ $x^{&lt;{t}&gt;}$, ä¸å‚æ•° $W_a$ è¿›è¡Œçº¿æ€§è¿ç®—åå†ä½¿ç”¨ $tanh$ å‡½æ•° è½¬åŒ–å¾—åˆ° $a^{&lt;{t}&gt;}$. å½“ç„¶å†ä½¿ç”¨ softmax å‡½æ•°å¤„ç†å¯ä»¥å¾—åˆ°é¢„æµ‹å€¼. 9.2 GRUç»“æ„è®°å¿†ç»†èƒ: åœ¨ GRUä¸­ ä¼šç”¨åˆ° â€œè®°å¿†ç»†èƒ(Memory cell)â€ è¿™ä¸ªæ¦‚å¿µ, æˆ‘ä»¬ç”¨å˜é‡Cè¡¨ç¤ºã€‚è¿™ä¸ªè®°å¿†ç»†èƒæä¾›äº†è®°å¿†åŠŸèƒ½ï¼Œä¾‹å¦‚å®ƒèƒ½å¤Ÿå¸®åŠ©è®°ä½ cat å¯¹åº” was, cats å¯¹åº” were. è€Œåœ¨ $t$ æ—¶åˆ»ï¼Œè®°å¿†ç»†èƒæ‰€åŒ…å«çš„å€¼å…¶å®å°±æ˜¯ Activation function å€¼ï¼Œå³ $c^{&lt;{t}&gt;}=a^{&lt;{t}&gt;}$ æ³¨æ„ï¼šåœ¨è¿™é‡Œä¸¤ä¸ªå˜é‡çš„å€¼è™½ç„¶ä¸€æ ·ï¼Œä½†æ˜¯å«ä¹‰ä¸åŒã€‚ å¦å¤–åœ¨ä¸‹èŠ‚å°†ä»‹ç»çš„ LSTM ä¸­ï¼ŒäºŒè€…å€¼çš„å¤§å°æœ‰å¯èƒ½æ˜¯ä¸ä¸€æ ·çš„ï¼Œæ‰€ä»¥æœ‰å¿…è¦ä½¿ç”¨è¿™ä¸¤ç§å˜é‡è¿›è¡ŒåŒºåˆ† ä¸ºäº†æ›´æ–°è®°å¿†ç»†èƒçš„å€¼ï¼Œæˆ‘ä»¬å¼•å…¥ $\\tilde{c}$ æ¥ä½œä¸ºå€™é€‰å€¼ä»è€Œæ¥æ›´æ–° $c^{&lt;{t}&gt;}$ï¼Œå…¶å…¬å¼ä¸ºï¼š \\tilde{c}=tanh(W\\_c [c^{}, x^{}]+b\\_c)æ›´æ–°é—¨ (update gate): æ›´æ–°é—¨æ˜¯ GRU çš„æ ¸å¿ƒæ¦‚å¿µï¼Œå®ƒçš„ä½œç”¨æ˜¯ç”¨äºåˆ¤æ–­æ˜¯å¦éœ€è¦è¿›è¡Œæ›´æ–°. æ›´æ–°é—¨ç”¨ $\\Gamma_u$ è¡¨ç¤ºï¼Œå…¶å…¬å¼ä¸ºï¼š \\Gamma\\_u=Ïƒ(W\\_u [c^{}, x^{}]+b\\_u) å¦‚ä¸Šå›¾ç¤ºï¼Œ$\\Gamma_u$ å€¼çš„å¤§å°å¤§å¤šåˆ†å¸ƒåœ¨ 0 æˆ–è€… 1ï¼Œæ‰€ä»¥å¯ä»¥å°†å…¶å€¼çš„å¤§å°ç²—ç•¥çš„è§†ä¸º 0 æˆ–è€… 1ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬å°±å¯ä»¥å°†å…¶ç†è§£ä¸ºä¸€æ‰‡é—¨ï¼Œå¦‚æœ $\\Gamma_u=1$ , å°±è¡¨ç¤ºæ­¤æ—¶éœ€è¦æ›´æ–°å€¼ï¼Œåä¹‹ä¸ç”¨. $t$ æ—¶åˆ»è®°å¿†ç»†èƒ: æœ‰äº†æ›´æ–°é—¨å…¬å¼åï¼Œæˆ‘ä»¬åˆ™å¯ä»¥ç»™å‡º $t$ æ—¶åˆ» Memory cell çš„å€¼çš„è®¡ç®—å…¬å¼äº†: c^{} = \\Gamma\\_u \\* \\tilde{c} + (1-\\Gamma\\_u) \\* c^{} æ³¨æ„ï¼šä¸Šé¢å…¬å¼ä¸­çš„ * è¡¨ç¤ºå…ƒç´ ä¹‹é—´è¿›è¡Œä¹˜æ³•è¿ç®—ï¼Œè€Œå…¶ä»–å…¬å¼æ˜¯ çŸ©é˜µè¿ç®— å…¬å¼å¾ˆå¥½ç†è§£ï¼Œå¦‚æœ $\\Gamma_u=1$ï¼Œé‚£ä¹ˆ $t$ æ—¶åˆ» è®°å¿†ç»†èƒçš„å€¼å°±ç­‰äºå€™é€‰å€¼ $\\tilde{c}$, åä¹‹ç­‰äºå‰ä¸€æ—¶åˆ»è®°å¿†ç»†èƒçš„å€¼. ä¸‹å›¾ç»™å‡ºäº†è¯¥å…¬å¼å¾ˆç›´è§‚çš„è§£é‡Šï¼š åœ¨è¯»åˆ° â€œcatâ€ çš„æ—¶å€™ ï¼Œå…¶ä»–æ—¶å€™ä¸€ç›´ä¸º 0ï¼ŒçŸ¥é“è¦ è¾“å‡º â€œwasâ€ çš„æ—¶åˆ»æˆ‘ä»¬ä»ç„¶çŸ¥é“ â€œcatâ€ çš„å­˜åœ¨ï¼Œä¹Ÿå°±çŸ¥é“å®ƒä¸ºå•æ•°äº† GRU ç»“æ„ç¤ºæ„å›¾ 9.3 å®Œæ•´ç‰ˆ GRUä¸Šç®€åŒ–äº†çš„ GRUï¼Œåœ¨å®Œæ•´ç‰ˆä¸­è¿˜å­˜åœ¨å¦ä¸€ä¸ªç¬¦å· ï¼Œè¿™ç¬¦å·çš„æ„ä¹‰æ˜¯æ§åˆ¶ $\\tilde{c}$ å’Œ $c^{&lt;{t-1}&gt;}$ ä¹‹é—´çš„è”ç³»å¼ºå¼±ï¼Œå®Œæ•´ç‰ˆå…¬å¼å¦‚ä¸‹ï¼š æ³¨æ„ï¼Œå®Œæ•´å…¬å¼ä¸­å¤šå‡ºäº†ä¸€ä¸ª $\\Gamma_r$, è¿™ä¸ªç¬¦å·çš„ä½œç”¨æ˜¯æ§åˆ¶ $\\tilde{c}^{&lt;{t}&gt;}$ å’Œ $c^{&lt;{t}&gt;}$ ä¹‹é—´è”ç³»çš„å¼ºå¼±. 10. LSTMï¼ˆlong short term memoryï¼‰unitä»‹ç»å®Œ GRU åï¼Œå†ä»‹ç» LSTM ä¼šæ›´åŠ å®¹æ˜“ç†è§£ã€‚ä¸‹å›¾æ˜¯äºŒè€…å…¬å¼å¯¹æ¯”ï¼š GRU åªæœ‰ä¸¤ä¸ªé—¨ï¼Œè€Œ LSTM æœ‰ä¸‰ä¸ªé—¨ï¼Œåˆ†åˆ«æ˜¯æ›´æ–°é—¨ $\\Gamma_u$ (æ˜¯å¦éœ€è¦æ›´æ–°ä¸º $\\tilde{c}^{&lt;{t}&gt;}$ï¼Œé—å¿˜é—¨ $\\Gamma_f$ (æ˜¯å¦éœ€è¦ä¸¢å¼ƒä¸Šä¸€ä¸ªæ—¶åˆ»çš„å€¼)ï¼Œè¾“å‡ºé—¨ $\\Gamma_o$ (æ˜¯å¦éœ€è¦è¾“å‡ºæœ¬æ—¶åˆ»çš„å€¼) è™½ç„¶ LSTM æ¯” GRU æ›´å¤æ‚ï¼Œä½†æ˜¯å®ƒæ¯” GRU æ›´æ—©æå‡ºå“‡ğŸ˜„ã€‚å¦å¤–ä¸€èˆ¬è€Œè¨€ LSTM çš„è¡¨ç°è¦æ›´å¥½ï¼Œä½†æ˜¯è®¡ç®—é‡æ›´å¤§ï¼Œæ¯•ç«Ÿå¤šäº†ä¸€ä¸ªé—¨å˜›ã€‚è€Œ GRU å®é™…ä¸Šæ˜¯å¯¹ LSTM çš„ç®€åŒ–ï¼Œå®ƒçš„è¡¨ç°ä¹Ÿä¸é”™ï¼Œèƒ½å¤Ÿæ›´å¥½åœ°æ‰©å±•åˆ°æ·±å±‚ç½‘ç»œã€‚æ‰€ä»¥äºŒè€…å„æœ‰ä¼˜åŠ¿ã€‚ ä¸‹å›¾æ˜¯ LSTM çš„ç»“æ„ç¤ºæ„å›¾ï¼š 11. Bidirectional RNNå‰é¢ä»‹ç»çš„éƒ½æ˜¯å•å‘çš„ RNN ç»“æ„ï¼Œåœ¨å¤„ç†æŸäº›é—®é¢˜ä¸Šå¾—åˆ°çš„æ•ˆæœä¸å°½äººæ„ å¦‚ä¸‹é¢ä¸¤å¥è¯ï¼Œæˆ‘ä»¬è¦ä»ä¸­æ ‡å‡ºäººåï¼š He said, â€œTeddy Roosevelt was a great Presidentâ€.He said, â€œTeddy bears are on saleâ€. ç¬¬ä¸€å¥ä¸­çš„ Teddy Roosevelt æ˜¯äººå ç¬¬äºŒå¥ä¸­çš„ Teddy bears æ˜¯æ³°è¿ªç†Šï¼ŒåŒæ ·éƒ½æ˜¯å•è¯ Teddy å¯¹åº”çš„è¾“å‡ºåœ¨ç¬¬ä¸€å¥ä¸­åº”è¯¥æ˜¯ 1ï¼Œç¬¬äºŒå¥ä¸­åº”è¯¥æ˜¯ 0 åƒè¿™æ ·çš„ä¾‹å­å¦‚æœæƒ³è®©æˆ‘ä»¬çš„åºåˆ—æ¨¡å‹æ˜ç™½å°±éœ€è¦å€ŸåŠ©ä¸åŒçš„ç»“æ„æ¯”å¦‚ - åŒå‘é€’å½’ç¥ç»ç½‘ç»œ(Bidirectional RNN).è¯¥ç¥ç»ç½‘ç»œé¦–å…ˆä»æ­£é¢ç†è§£ä¸€éè¿™å¥è¯ï¼Œå†ä»åæ–¹å‘ç†è§£ä¸€é. åŒå‘é€’å½’ç¥ç»ç½‘ç»œç»“æ„å¦‚ä¸‹ï¼š ä¸‹å›¾æ‘˜è‡ªå¤§æ•°æ®æ–‡æ‘˜æ•´ç† 12. Deep RNNsæ·±å±‚ï¼Œé¡¾åæ€ä¹‰å°±æ˜¯å±‚æ¬¡å¢åŠ ã€‚å¦‚ä¸‹å›¾æ˜¯æ·±å±‚å¾ªç¯ç¥ç»ç½‘ç»œçš„ç¤ºæ„å›¾ æ¨ªå‘è¡¨ç¤ºæ—¶é—´å±•å¼€ï¼Œçºµå‘åˆ™æ˜¯å±‚æ¬¡å±•å¼€ã€‚ æ³¨æ„æ¿€æ´»å€¼çš„è¡¨è¾¾å½¢å¼æœ‰æ‰€æ”¹å˜ï¼Œä»¥ $a^{[1]}$ ä¸ºä¾‹è¿›è¡Œè§£é‡Šï¼š 1 è¡¨ç¤ºç¬¬ä¸€å±‚ è¡¨ç¤ºç¬¬ä¸€ä¸ªæ¿€æ´»å€¼ å¦å¤–å„ä¸ªæ¿€æ´»å€¼çš„è®¡ç®—å…¬å¼ä¹Ÿç•¥æœ‰ä¸åŒï¼Œä»¥ $a^{[2]}$ ä¸ºä¾‹ï¼Œå…¶è®¡ç®—å…¬å¼å¦‚ä¸‹ï¼š 13. Reference ç½‘æ˜“äº‘è¯¾å ‚ - deeplearning DeepLearning.ai å­¦ä¹ ç¬”è®°æ±‡æ€» å¤§æ•°æ®æ–‡æ‘˜ DeepLearning.ai å­¦ä¹ ç¬”è®° Sequence Models è‹±æ–‡ç‰ˆç¬”è®°","categories":[{"name":"deeplearning","slug":"deeplearning","permalink":"http://iequa.com/categories/deeplearning/"}],"tags":[{"name":"deeplearning.ai","slug":"deeplearning-ai","permalink":"http://iequa.com/tags/deeplearning-ai/"}]},{"title":"Structured Machine Learning Projects (week2) - ML Strategy 2","slug":"deeplearning/Structured-Machine-Learning-Projects-week2","date":"2018-07-25T11:00:21.000Z","updated":"2019-10-20T04:30:35.021Z","comments":true,"path":"2018/07/25/deeplearning/Structured-Machine-Learning-Projects-week2/","link":"","permalink":"http://iequa.com/2018/07/25/deeplearning/Structured-Machine-Learning-Projects-week2/","excerpt":"å¦‚ä½•è¿›è¡Œ è¯¯å·®åˆ†æã€æ ‡æ³¨é”™è¯¯æ•°æ®ã€å®šä½æ•°æ®ä¸åŒ¹é…åå·®ä¸æ–¹å·® çŸ¥é“å¦‚ä½•åº”ç”¨ç«¯åˆ°ç«¯å­¦ä¹ ã€è¿ç§»å­¦ä¹ ä»¥åŠå¤šä»»åŠ¡å­¦ä¹ ","text":"å¦‚ä½•è¿›è¡Œ è¯¯å·®åˆ†æã€æ ‡æ³¨é”™è¯¯æ•°æ®ã€å®šä½æ•°æ®ä¸åŒ¹é…åå·®ä¸æ–¹å·® çŸ¥é“å¦‚ä½•åº”ç”¨ç«¯åˆ°ç«¯å­¦ä¹ ã€è¿ç§»å­¦ä¹ ä»¥åŠå¤šä»»åŠ¡å­¦ä¹  1. Carrying out error analysis å¾ˆå¤šæ—¶å€™æˆ‘ä»¬å‘ç°è®­ç»ƒå‡ºæ¥çš„æ¨¡å‹æœ‰è¯¯å·®åï¼Œå°±ä¼šä¸€è‚¡è„‘çš„æƒ³ç€æ³•å­å»å‡å°‘è¯¯å·®ã€‚æƒ³æ³•å›ºç„¶å¥½ï¼Œä½†æ˜¯æœ‰ç‚¹ headlong ã€‚ã€‚ è¿™èŠ‚è§†é¢‘ä¸­ Andrew Ng ä»‹ç»äº†ä¸€ä¸ªæ¯”è¾ƒç§‘å­¦çš„æ–¹æ³•ï¼Œå…·ä½“çš„çœ‹ä¸‹é¢çš„ä¾‹å­ è¿˜æ˜¯ä»¥çŒ«åˆ†ç±»å™¨ä¸ºä¾‹ï¼Œå‡è®¾æˆ‘ä»¬çš„æ¨¡å‹è¡¨ç°çš„è¿˜ä¸é”™ï¼Œä½†æ˜¯ä¾æ—§å­˜åœ¨è¯¯å·®ï¼Œé¢„æµ‹åé”™è¯¯æ ‡è®°çš„æ•°æ®ä¸­æœ‰ä¸€éƒ¨åˆ†ç‹—å›¾ç‰‡è¢«é”™è¯¯çš„æ ‡è®°æˆäº†çŒ«ã€‚è¿™ä¸ªæ—¶å€™æŒ‰ç…§ä¸€èˆ¬çš„æ€è·¯å¯èƒ½æ˜¯æƒ³é€šè¿‡è®­ç»ƒå‡ºç‹—åˆ†ç±»å™¨æ¨¡å‹æ¥æé«˜çŒ«åˆ†ç±»å™¨ï¼Œæˆ–è€…å…¶ä»–çš„åŠæ³•ï¼Œåæ­£å°±æ˜¯è¦è®©åˆ†ç±»å™¨æ›´å¥½åœ°åŒºåˆ†ç‹—å’ŒçŒ«ã€‚ ä½†æ˜¯ç°åœ¨çš„é—®é¢˜æ˜¯ï¼Œå‡å¦‚é”™è¯¯åˆ†ç±»çš„100ä¸ªæ ·æœ¬ä¸­ï¼Œåªæœ‰5ä¸ªç‹—æ ·æœ¬è¢«é”™è¯¯çš„æ ‡è®°æˆäº†çŒ«ï¼Œé‚£ä¹ˆä½ è´¹å°½åƒè¾›ä¸‡è‹¦ä¹Ÿæœ€å¤šåªèƒ½æé«˜ä¸€ä¸¢ä¸¢çš„å‡†ç¡®åº¦ã€‚æ‰€ä»¥å¯¹è¯¯å·®è¿›è¡Œåˆ†æå°±æ˜¾å¾—æ¯”è¾ƒé‡è¦ï¼Œè€Œä¸”å¯ä»¥å¸®åŠ©æˆ‘ä»¬åœ¨æœªæ¥çš„å·¥ä½œä¸­æŒ‡æ˜ä¼˜åŒ–æ–¹å‘ï¼ŒèŠ‚çœæ—¶é—´ã€‚å…·ä½“çš„æ–¹æ³•æŒ‰å´å¤§å¤§çš„è¯´æ³•æ˜¯å¯ä»¥äººå·¥çš„å¯¹é”™è¯¯æ ‡è®°çš„æ ·æœ¬è¿›è¡Œå†å¤„ç†ã€åˆ†æã€‚ ä¸‹é¢ä»¥ä¸€ä¸ªä¾‹å­æ¥ä»‹ç»ä¸€ä¸‹æ“ä½œæ­¥éª¤ 1. äººå·¥æ ‡è®° å°†é”™è¯¯æ ‡è®°æ ·æœ¬ä»¥è¡¨æ ¼çš„å½¢å¼åˆ—ä¸¾å‡ºæ¥ï¼Œç„¶åäººå·¥çš„æ ‡è®°å¤„æ ·æœ¬çš„åˆ†ç±»ï¼Œç»Ÿè®¡å„åˆ†ç±»(æˆ–è€…è¯´é”™è¯¯æ ‡è®°çš„åŸå› )æ‰€å æ¯”ä¾‹. Image Dog Great cats(å¤§å‹çŒ«ç§‘åŠ¨ç‰©ï¼Œå¦‚ç‹®å­) Blurry(å›¾ç‰‡æ¨¡ç³Š) Comments 1 âˆš 2 âˆš çœ¯ç€çœ¼ 3 âˆš âˆš åœ¨åŠ¨ç‰©å›­ï¼Œä¸”ä¸‹ç€é›¨ â€¦â€¦ % of total 8% 43% 61% - æ³¨æ„:ä¸Šé¢çš„åˆ†ç±»å¹¶ä¸æ˜¯äº’ç›¸ç‹¬ç«‹çš„ï¼Œåªæ˜¯ä¸¾ä¸ªä¾‹å­ã€‚ã€‚ã€‚æŠ„ä¸‹ Andrew Ng çš„PPT 2. åˆ†æè¯¯å·® ä¸Šé¢çš„ç»“æœå¯ä»¥çŸ¥é“ï¼Œè¯¯å·®æ ·æœ¬ä¸­åªæœ‰8%æ˜¯ç‹—ç‹—çš„å›¾ç‰‡ï¼Œè€Œ43%æ˜¯å¤§å‹çŒ«ç§‘åŠ¨ç‰©ï¼Œ61%æ˜¯å› ä¸ºå›¾ç‰‡æ¨¡ç³Šã€‚å¾ˆæ˜¾ç„¶æ­¤æ—¶ä½ å³ä½¿ç”¨æ¯•ç”Ÿæ‰€å­¦å»ä¼˜åŒ–åŒºåˆ«ç‹—å’ŒçŒ«çš„ç®—æ³•ï¼Œæ•´ä¸ªæ¨¡å‹çš„å‡†ç¡®ç‡æå‡çš„ç©ºé—´ä¹Ÿè¿œä¸å¦‚åä¸¤ä¸ªç‰¹å¾é«˜ã€‚æ‰€ä»¥å¦‚æœäººæ‰‹å¤Ÿçš„è¯ï¼Œä¹Ÿæ˜¯å¯ä»¥é€‰æ‹©å‡ ä¸ªç‰¹å¾è¿›è¡Œä¼˜åŒ–çš„ã€‚ 2. Cleaning up Incorrectly labeled dataæœºå™¨é¢„æµ‹å¯èƒ½ä¼šå‡ºé”™ï¼Œé‚£ä¹ˆäººå½“ç„¶ä¹Ÿæœ‰å¯èƒ½ä¼šå‡ºé”™ã€‚æ‰€ä»¥å¦‚æœè®­ç»ƒé›†å’ŒéªŒè¯é›†ä¸­è®¤ä¸ºæ·»åŠ çš„æ ‡ç­¾Yå‡ºç°è¯¯å·®è¯¥æ€ä¹ˆå¤„ç†å‘¢ï¼Ÿ è¿™é‡Œåˆ†ä¸¤ç§æƒ…å†µï¼š 1.éšæœºè¯¯å·® è¿™ç§æƒ…å†µæ¯”è¾ƒå¥½ï¼Œå› ä¸ºå¦‚æœäººä¸ºè¯¯å·®æ¯”è¾ƒæ¥è¿‘éšæœºè¯¯å·®ï¼Œé‚£ä¹ˆå¯ä»¥çä¸€åªçœ¼é—­ä¸€åªçœ¼ï¼Œå› ä¸ºæ·±åº¦å­¦ä¹ ç®—æ³•å¯¹äºéšæœºè¯¯å·®è¿˜æ˜¯æœ‰ä¸€å®šçš„å¥å£®æ€§çš„ 2.ééšæœºè¯¯å·® PS:ä¸çŸ¥é“æœ‰æ²¡æœ‰ééšæœºè¯¯å·®è¿™ä¸ªè¯ã€‚ã€‚æˆ‘åªæ˜¯ä¸ºäº†è¡Œæ–‡æ–¹ä¾¿å–çš„ä¸€ä¸ªåå­—ã€‚ å¯¹äºéšæœºè¯¯å·®æ­£å¸¸äººå¯èƒ½éƒ½ä¼šé—®â€œwhatï¼Ÿæˆ‘æ€ä¹ˆçŸ¥é“æ˜¯ä¸æ˜¯æ¥è¿‘éšæœºè¯¯å·®â€ï¼Œæ‰€ä»¥è§†é¢‘é‡Œ Andrew Ng ä¹Ÿç»™å’±ä»¬æä¾›äº†ä¸€ä¸ªæ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•å’Œä¸Šä¸€èŠ‚ä¸­çš„è¡¨æ ¼æ³•ä¸€æ ·ä¸€æ ·çš„ï¼š Image Dog Great cats(å¤§å‹çŒ«ç§‘åŠ¨ç‰©ï¼Œå¦‚ç‹®å­) Blurry(å›¾ç‰‡æ¨¡ç³Š) Incorrectly labeled Comments 1 âˆš 2 âˆš âˆš åªæ˜¯ä¸€åªæ‰‹ç”»çš„çš„çŒ«ï¼Œä¸æ˜¯çœŸçš„çŒ« 3 âˆš èƒŒæ™¯çš„è§’è½é‡Œæœ‰ä¸€åªçŒ« â€¦â€¦ % of total 8% 43% 61% 6% æœ‰äº†ä¸Šé¢è¿™ä¸ªè¡¨æ ¼ï¼Œé‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œæ­¤æ—¶æˆ‘è¿˜éœ€è¦ä¿®æ­£è¿™6%æ ‡è®°é”™è¯¯çš„æ ·æœ¬å—ï¼Ÿè¿˜æ˜¯ä¸¾ä¸ªä¾‹å­ï¼š å‡è®¾æˆ‘ä»¬æœ‰å¦‚ä¸‹æ•°æ®ï¼š æ€»ä½“éªŒè¯é›†è¯¯å·®ï¼š10% ç”±äººå·¥é”™è¯¯æ ‡è®°å¼•èµ·çš„é”™è¯¯æ ·æœ¬æ¯”ä¾‹ï¼š 0.6% ç”±å…¶ä»–åŸå› å¼•èµ·çš„é”™è¯¯æ ·æœ¬æ¯”ä¾‹ï¼š10%-0.6%=9.4% æ‰€ä»¥è¿™ç§æƒ…å†µä¸‹æˆ‘ä»¬åº”è¯¥é›†ä¸­ç²¾åŠ›æ‰¾å‡ºå¼•èµ·9.4%è¯¯å·®çš„åŸå› ï¼Œå¹¶è¿›è¡Œä¿®æ­£ï¼Œå½“ç„¶å¦‚æœæœ‰ä½™åŠ›ä¹Ÿè¿˜æ˜¯å¯ä»¥ä¼‘æ•´ä¸€ä¸‹äººå·¥é”™è¯¯æ ‡è®°çš„æ•°æ®çš„ã€‚ å‡å¦‚ä½ é€šè¿‡ä¼˜åŒ–ç®—æ³•ï¼Œå‡å°‘äº†å› å…¶ä»–åŸå› å¼•èµ·çš„è¯¯å·®ï¼Œå¹¶ä¸”ä½¿å¾—æ€»ä½“éªŒè¯é›†è¯¯å·®é™åˆ°äº†2%ï¼Œæ­¤æ—¶æˆ‘ä»¬å†åˆ†æä¸€ä¸‹ï¼š å¾ˆæ˜¾ç„¶ï¼Œå› ä¸ºå¹¶æ²¡æœ‰å¯¹äººå·¥è¯¯å·®è¿›è¡Œä¼˜åŒ–ï¼Œæ‰€ä»¥ç”±äººå·¥é”™è¯¯æ ‡è®°å¼•èµ·çš„é”™è¯¯æ ·æœ¬æ¯”ä¾‹ä¾æ—§æ˜¯0.6%(è¿™ä¸ªæ•°æ®å¯èƒ½æœ‰ç‚¹ä¸èƒ½ç†è§£ï¼Œè¦æ³¨æ„è¿™ä¸ª0.6%æ˜¯ç›¸å¯¹äºæ•´ä½“éªŒè¯é›†è€Œè¨€çš„ï¼Œæ‰€ä»¥ä¸ä¼šå˜), é‚£ä¹ˆäººå·¥è¯¯å·®åœ¨æ€»è¯¯å·®ä¸­æ‰€å çš„æ¯”ä¾‹åˆ™è¾¾åˆ°äº†0.6%/2%=30%,ç›¸æ¯”äºä¹‹å‰çš„6%å½±å“åŠ›æ‰“äº†ä¸å°å“¦ï¼Œæ‰€ä»¥æ­¤æ—¶åˆ™åº”è¯¥è€ƒè™‘å¯¹äººå·¥è¯¯å·®åŠ¨æ‰‹äº†. 3. Build your first system quickly, then iterateè¿˜æ˜¯æœ‰ä¸€ä¸ªæ­¥éª¤æµç¨‹çš„ï¼š å»ºç«‹è®­ç»ƒé›†ï¼ŒéªŒè¯é›†ï¼Œæµ‹è¯•é›† è¿…é€Ÿæ­å»ºåˆå§‹åŒ–ç³»ç»Ÿ ä½¿ç”¨å‰é¢æåˆ°çš„Bias/Varianceåˆ†æå’Œè¯¯å·®åˆ†ææ¥ç¡®å®šæ¥ä¸‹æ¥çš„ä¼˜åŒ–æ–¹å‘ 4. Training and testing on different distributions 5. Bias and Variance with mismatched data distributions å¯¹ä¸Šé¢çš„PPTæˆªå›¾è¿›è¡Œè§£é‡Šï¼š å·¦è¾¹: é¦–å…ˆè¿˜æ˜¯ä»¥å–µå’ªåˆ†ç±»å™¨ä½œä¸ºä¾‹å­ï¼Œå‡è®¾äººç±»çš„è¯¯å·®æ¥è¿‘è´å¶æ–¯è¯¯å·®0%ã€‚è€Œè®­ç»ƒé›†è¯¯å·®å’Œå¼€å‘é›†è¯¯å·®åˆ†åˆ«ä¸º1%å’Œ10%ï¼ŒäºŒè€…ç›¸å·®9%ï¼Œè€Œä¸”å¦‚æœä¸¤ä¸ªæ•°æ®é›†æ¥è‡ªåŒä¸€ä¸ªåˆ†å¸ƒï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥è¯´æ¨¡å‹è®­ç»ƒç»“æœæ–¹å·®è¾ƒå¤§ã€‚ä½†æ˜¯å½“ä¸¤ä¸ªæ•°æ®é›†æ¥è‡ªä¸åŒçš„åˆ†å¸ƒæ—¶ï¼Œæˆ‘ä»¬å°±ä¸èƒ½å¾—å‡ºä¸Šé¢çš„ç»“è®ºäº†ã€‚å¦å¤–ï¼Œè¿™9%çš„æ–¹å·®å¯èƒ½æœ‰ä¸¤ä¸ªåŸå› å¯¼è‡´çš„. æ˜¯æˆ‘ä»¬è‡ªå·±å®ç°çš„ä»£ç æœ‰é—®é¢˜ æ˜¯æ•°æ®åˆ†å¸ƒä¸åŒï¼Œæ‰€ä»¥ä½ å¾ˆéš¾ç¡®å®šå“ªä¸ªæ˜¯æ›´ä¸»è¦çš„åŸå› . å› æ­¤ä¸ºäº†æ‰¾å‡ºæ˜¯å“ªä¸ªåŸå› æˆ‘ä»¬åšå¦‚ä¸‹çš„äº‹æƒ…ï¼š åˆ›å»ºTraining-dev set(è®­ç»ƒ-å¼€å‘é›†)ï¼Œå…¶å®å°±æ˜¯ä»åŸæ¥çš„è®­ç»ƒé›†ä¸­æŠ½å–ä¸€éƒ¨åˆ†æ•°æ®å‡ºæ¥ï¼Œä½†æ˜¯ä¸å–‚ç»™æ¨¡å‹ã€‚ï¼ˆå¦‚ä¸Šå›¾æ‰€ç¤ºï¼‰ å³è¾¹: é‚£æ€ä¹ˆæ“ä½œå‘¢ï¼Ÿå¾ˆç®€å•ï¼Œä¸‹é¢ä»¥å‡ ä¸ªä¾‹å­æ¥è¯´æ˜ï¼š 1.å› ä¸ºTraining-dev set(è®­ç»ƒ-å¼€å‘é›†)å’ŒTraining setåŒåˆ†å¸ƒï¼Œæ‰€ä»¥å‡è®¾è®­ç»ƒå‡ºæ¥çš„ç»“æœå¦‚ä¸‹ï¼š training error: 1% training-dev error: 9% dev error: 10% æ­¤æ—¶å¯ä»¥çœ‹åˆ°æ¥è‡ªåŒåˆ†å¸ƒæ•°æ®çš„è®­ç»ƒè¯¯å·®å’Œè®­ç»ƒ-å¼€å‘è¯¯å·®å­˜åœ¨è¾ƒå¤§çš„æ–¹å·®ï¼Œæ‰€ä»¥æˆ‘ä»¬å°±å¯ä»¥ç¡®å®šè‚¯å®šæ˜¯æˆ‘ä»¬æ»´ä»£ç è¿˜éœ€è¦å®Œå–„. 2.å‡è®¾è®­ç»ƒå‡ºæ¥çš„ç»“æœå¦‚ä¸‹ï¼š training error: 1% training-dev error: 1.5% dev error: 10% æ­¤æ—¶å°±å¯ä»¥è¯´ä¸æ˜¯æˆ‘ç¨‹åºå‘˜çš„é—®é¢˜äº†ï¼Œè€Œæ˜¯å‘ç”Ÿäº†data mismatch(æ•°æ®ä¸åŒ¹é…é—®é¢˜) ä¸Šå›¾å³ä¸‹è§’ï¼š 1.å‡è®¾äººç±»çš„è¯¯å·®æ¥è¿‘è´å¶æ–¯è¯¯å·®0ï¼Œä¸”è®­ç»ƒè¯¯å·®å¦‚ä¸‹ï¼š training error: 10% training-dev error: 11% dev error: 12% æ­¤æ—¶æˆ‘ä»¬ä¼šè®¤ä¸ºæ¨¡å‹ä¸äººç±»è¯¯å·®ç›¸æ¯”å­˜åœ¨è¾ƒå¤§çš„åå·®ã€‚æ‰€ä»¥å°±æœç€ å‡å°åå·®çš„æ–¹å‘åŠªåŠ› å§å°‘å¹´. 2.åŒæ ·å‡è®¾äººç±»çš„è¯¯å·®æ¥è¿‘è´å¶æ–¯è¯¯å·®0ï¼Œä¸”è®­ç»ƒè¯¯å·®å¦‚ä¸‹ï¼š training error: 10%training-dev error: 11%dev error: 20% æ­¤æ—¶æˆ‘ä»¬ä¼šè®¤ä¸ºå­˜åœ¨ä¸¤ä¸ªé—®é¢˜ï¼š é«˜åå·® æ•°æ®ä¸åŒ¹é…é—®é¢˜ ç¥ç¦ä½ ï¼Œç»§ç»­ä¿®æ”¹ä»£ç å§.. 6. Addressing data mismatch è™½ç„¶æˆ‘ä»¬ä½¿ç”¨æ•°æ®åˆæˆå·²ç»åœ¨è¯­éŸ³è¯†åˆ«æ–¹é¢å–å¾—äº†ä¸é”™çš„æ•ˆæœæå‡ å¯ä»¥ä½¿ç”¨æ•°æ®åˆæˆï¼Œä½†æ˜¯è¦æ³¨æ„ä½ çš„ç¥ç»ç½‘ç»œå¯èƒ½è¿‡æ‹Ÿåˆï¼Œè¿‡åˆ†å­¦ä¹ äº†ä½ è¿™å°éƒ¨åˆ†æ•°æ®é›†äº†ã€‚ 7. Transfer learningç®€å•çš„è§£é‡Šå°±æ˜¯å‡å¦‚æˆ‘ä»¬ä¹‹å‰è®­ç»ƒå¥½äº†ä¸€ä¸ªå–µå’ªåˆ†ç±»å™¨ï¼Œåæ¥æˆ‘ä»¬æœ‰äº†æ–°ä»»åŠ¡ â€” åšä¸€ä¸ªæµ·è±šåˆ†ç±»å™¨ï¼Œé‚£ä¹ˆå°±å¯ä»¥å°†ä¹‹å‰åˆ›å»ºçš„å–µå’ªåˆ†ç±»å™¨æ¨¡å‹è¿ç”¨åˆ°æ–°ä»»åŠ¡ä¸­å» ä¸¾ä¸ªæ —å­ï¼Œå‡è®¾æˆ‘ä»¬å¯¹ä¿¡å·ç¯çš„çº¢ã€ç»¿ç¯è¿›è¡Œäº†å¤§é‡æ•°æ®çš„å­¦ä¹ ï¼Œç°åœ¨æœ‰äº†æ–°ä»»åŠ¡ï¼Œå³éœ€è¦è¯†åˆ«é»„ç¯,æ­¤æ—¶æˆ‘ä»¬å°±ä¸éœ€è¦ä»å¤´æ­å»ºæ¨¡å‹ï¼Œæˆ‘ä»¬å¯ä»¥ç»§ç»­ä½¿ç”¨çº¢ç»¿ç¯ç½‘ç»œæ¡†æ¶ï¼Œåªéœ€ä¿®æ”¹ç¥ç»ç½‘ç»œæœ€åä¸€å±‚ï¼Œå³è¾“å‡ºå±‚ï¼Œç„¶åç”¨å·²ç»è®­ç»ƒå¥½çš„æƒé‡å‚æ•°åˆå§‹åŒ–è¿™ä¸ªæ¨¡å‹ï¼Œå¯¹é»„ç¯æ•°æ®è¿›è¡Œè®­ç»ƒå­¦ä¹ ã€‚ ä¸ºä»€ä¹ˆå¯ä»¥è¿™ä¹ˆåšå‘¢ï¼Ÿå› ä¸ºå°½ç®¡æœ€åçš„æ ‡ç­¾ä¸ä¸€è‡´ï¼Œä½†æ˜¯ä¹‹å‰å­¦ä¹ çš„çº¢ç»¿ç¯æ¨¡å‹å·²ç»æ•æ‰å’Œå­¦ä¹ äº†å¾ˆå¤šæœ‰ç”¨çš„ç‰¹å¾å’Œç»†èŠ‚ï¼Œè¿™å¯¹äºé»„ç¯çš„å­¦ä¹ ååˆ†æœ‰å¸®åŠ©ï¼Œè€Œä¸”è¿™ä¹ˆåšä¹Ÿå¯ä»¥å¤§å¤§çš„åŠ å¿«æ¨¡å‹çš„æ„å»ºé€Ÿåº¦ã€‚ æƒ³å°†Aæ¨¡å‹è¿ç”¨åˆ°Bæ¨¡å‹, ä¸€èˆ¬æ¥è¯´æ˜¯æœ‰æ¡ä»¶é™åˆ¶çš„ï¼Œå¦‚ä¸‹ï¼š A å’Œ B éœ€è¦æœ‰ç›¸ç±»ä¼¼çš„è¾“å…¥æ•°æ®é›†ï¼Œä¾‹å¦‚è¦ä¹ˆéƒ½æ˜¯å›¾åƒè¯†åˆ«ï¼Œè¦ä¹ˆæ˜¯è¯­éŸ³è¯†åˆ« A çš„æ•°æ®é›†è¦è¶³å¤Ÿå¤šï¼Œå³è¿œå¤šäºB A ä¸­å­¦åˆ°ä¸€äº› low level features è¦å¯¹ B æœ‰æ‰€å¸®åŠ© 8. Multi-task learningåœ¨ Transfer learning ä¸­ï¼Œæ•´ä¸ªè¿‡ç¨‹æ˜¯ä¸²è¡Œçš„ï¼Œå³å’±ä»¬é¦–å…ˆå¾—å®ç°Aæ¨¡å‹ï¼Œç„¶ååœ¨è¿ç”¨åˆ°Bæ¨¡å‹ã€‚ åœ¨ Multi-task learning ä¸­ï¼Œå¯ä»¥æ˜¯åŒæ—¶å¼€å§‹å­¦ä¹ . ä¸¾ä¸ªğŸŒ°ï¼š ç°åœ¨å¾ˆç«çš„æ— äººé©¾é©¶æ±½è½¦ï¼Œåœ¨è¡Œé©¶è·¯ä¸Šéœ€è¦è¯†åˆ«å¾ˆå¤šç±»å‹çš„ç‰©ä½“ï¼Œå¦‚è¡Œäººã€çº¢ç»¿ç¯ã€æŒ‡è·¯æ ‡å¿—ç­‰ç­‰ï¼Œæ‰€ä»¥æ­¤æ—¶å¯ä»¥ä½¿ç”¨ Multi-task learning æ¥å®ç°ã€‚ç¥ç»ç½‘ç»œç¤ºæ„å›¾å¦‚ä¸‹ï¼š å¦‚å›¾ç¤ºï¼Œæœ€åçš„ $\\hat{y}$ æ˜¯ä¸€ä¸ªæœ‰4å…ƒç´ çš„å‘é‡ï¼Œå‡è®¾åˆ†åˆ«æ˜¯è¡Œäººã€æ±½è½¦ã€åœè½¦æ ‡å¿—ã€ä¿¡å·ç¯ã€‚å¦‚æœè¯†åˆ«å‡ºå›¾ç‰‡ä¸­æœ‰å“ªä¸€ä¸ªå…ƒç´ ï¼Œå¯¹åº”ä½ç½®åˆ™è¾“å‡º1ã€‚ æ³¨æ„ï¼šè¿™è¦ä¸softmaxè¿›è¡ŒåŒºåˆ†ï¼Œsoftmax åªæ˜¯ä¸€æ¬¡è¯†åˆ«ä¸€ç§ç‰©ä½“ï¼Œæ¯”å¦‚è¯´è¯†åˆ«å‡ºæ˜¯è¡Œäººï¼Œåˆ™è¾“å‡º[1,0,0,0],è€Œä¸ä¼šè¯´åŒæ—¶è¯†åˆ«å‡ºè¡Œäººå’Œä¿¡å·ç¯. é€‚ç”¨æƒ…å†µï¼š æœ€åï¼ŒAndrew Ng è¯´åœ¨å®é™…ä¸­è¿ç§»å­¦ä¹ ä½¿ç”¨é¢‘ç‡è¦è¿œé«˜äºå¤šä»»åŠ¡å­¦ä¹ ï¼Œæœ‰ä¸ªä¾‹å¤–å°±æ˜¯è§†è§‰æ£€æµ‹é¡¹ç›®ä¸­å¤šä»»åŠ¡å­¦ä¹ æ¯”è¾ƒå¤š. 9. End-to-end deep learningé¦–å…ˆä»¥ç°åœ¨å¹¿æ³›ä½¿ç”¨çš„äººè„¸è¯†åˆ«æŠ€æœ¯è§£é‡Šä¸€ä¸‹ä»€ä¹ˆæ˜¯ç«¯åˆ°ç«¯çš„æ·±åº¦å­¦ä¹ . What is end-to-end learning? å‡å¦‚å’±ä»¬èµ°è¿›ä¸€ä¸ªæ‘„åƒå¤´ï¼Œæœ€å¼€å§‹ç¦»å¾—è¾ƒè¿œçš„æ—¶å€™æ‘„åƒå¤´æ•æ‰åˆ°çš„æ˜¯æˆ‘ä»¬çš„å…¨èº«ï¼Œæ­¤æ—¶ç³»ç»Ÿä¸ä¼šå°†è¿™ç§ç…§ç‰‡å–‚ç»™æ¨¡å‹ï¼Œè€Œæ˜¯é€šè¿‡ç®—æ³•æ‰¾åˆ°äººè„¸çš„ä½ç½®ï¼Œç„¶ååˆ‡å‰²æ”¾å¤§ï¼Œæœ€åå–‚ç»™æ¨¡å‹è¿›è¡Œè¯†åˆ«. æ€»ç»“èµ·æ¥å°±æ˜¯ï¼š æ‰¾äººè„¸ä½ç½® å°†äººè„¸å›¾åƒåˆ‡å‰²æ”¾å¤§ï¼Œå¹¶å–‚ç»™æ¨¡å‹ Notes: ç«¯åˆ°ç«¯çš„æ·±åº¦å­¦ä¹ å…¶å®å°±ä¸æ˜¯åƒå°†é—®é¢˜ç»†åˆ†åŒ–ï¼Œæµæ°´çº¿åŒ–ï¼Œæ¯ä¸ªæ­¥éª¤å„å¸å…¶èŒï¼Œä¸‹ä¸€å±‚ä¾èµ–ä¸Šä¸€å±‚ And you need a large data set before the end-to-end approach really shines. ï¼ˆä½ éœ€è¦å¤§é‡çš„æ•°æ®ï¼Œç«¯åˆ°ç«¯çš„æ·±åº¦å­¦ä¹ ï¼Œæ‰èƒ½å‘æŒ¥è€€çœ¼çš„å…‰èŠ’.ï¼‰ 10. Reference ç½‘æ˜“äº‘è¯¾å ‚ - deeplearning DeepLearning.aiå­¦ä¹ ç¬”è®°æ±‡æ€»","categories":[{"name":"deeplearning","slug":"deeplearning","permalink":"http://iequa.com/categories/deeplearning/"}],"tags":[{"name":"deeplearning.ai","slug":"deeplearning-ai","permalink":"http://iequa.com/tags/deeplearning-ai/"}]},{"title":"Structured Machine Learning Projects (week1) - ML Strategy 1","slug":"deeplearning/Structured-Machine-Learning-Projects-week1","date":"2018-07-24T11:00:21.000Z","updated":"2019-10-20T04:30:35.018Z","comments":true,"path":"2018/07/24/deeplearning/Structured-Machine-Learning-Projects-week1/","link":"","permalink":"http://iequa.com/2018/07/24/deeplearning/Structured-Machine-Learning-Projects-week1/","excerpt":"è¿™æ¬¡æˆ‘ä»¬è¦å­¦ä¹ ä¸“é¡¹è¯¾ç¨‹ä¸­ç¬¬ä¸‰é—¨è¯¾ Structured Machine Learning Projects å­¦å®Œè¿™é—¨è¯¾ä¹‹åï¼Œä½ å°†ä¼š: ç†è§£å¦‚ä½•è¯Šæ–­æœºå™¨å­¦ä¹ ç³»ç»Ÿä¸­çš„é”™è¯¯ èƒ½å¤Ÿä¼˜å…ˆå‡å°è¯¯å·®æœ€æœ‰æ•ˆçš„æ–¹å‘ ç†è§£å¤æ‚MLè®¾å®šï¼Œä¾‹å¦‚è®­ç»ƒ/æµ‹è¯•é›†ä¸åŒ¹é…ï¼Œæ¯”è¾ƒå¹¶/æˆ–è¶…è¿‡äººçš„è¡¨ç° çŸ¥é“å¦‚ä½•åº”ç”¨ç«¯åˆ°ç«¯å­¦ä¹ ã€è¿ç§»å­¦ä¹ ä»¥åŠå¤šä»»åŠ¡å­¦ä¹  å¾ˆå¤šå›¢é˜Ÿæµªè´¹æ•°æœˆç”šè‡³æ•°å¹´æ¥ç†è§£è¿™é—¨è¯¾æ‰€æ•™æˆçš„å‡†åˆ™ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œè¿™é—¨ä¸¤å‘¨çš„è¯¾å¯ä»¥ä¸ºä½ èŠ‚çº¦æ•°æœˆçš„æ—¶é—´","text":"è¿™æ¬¡æˆ‘ä»¬è¦å­¦ä¹ ä¸“é¡¹è¯¾ç¨‹ä¸­ç¬¬ä¸‰é—¨è¯¾ Structured Machine Learning Projects å­¦å®Œè¿™é—¨è¯¾ä¹‹åï¼Œä½ å°†ä¼š: ç†è§£å¦‚ä½•è¯Šæ–­æœºå™¨å­¦ä¹ ç³»ç»Ÿä¸­çš„é”™è¯¯ èƒ½å¤Ÿä¼˜å…ˆå‡å°è¯¯å·®æœ€æœ‰æ•ˆçš„æ–¹å‘ ç†è§£å¤æ‚MLè®¾å®šï¼Œä¾‹å¦‚è®­ç»ƒ/æµ‹è¯•é›†ä¸åŒ¹é…ï¼Œæ¯”è¾ƒå¹¶/æˆ–è¶…è¿‡äººçš„è¡¨ç° çŸ¥é“å¦‚ä½•åº”ç”¨ç«¯åˆ°ç«¯å­¦ä¹ ã€è¿ç§»å­¦ä¹ ä»¥åŠå¤šä»»åŠ¡å­¦ä¹  å¾ˆå¤šå›¢é˜Ÿæµªè´¹æ•°æœˆç”šè‡³æ•°å¹´æ¥ç†è§£è¿™é—¨è¯¾æ‰€æ•™æˆçš„å‡†åˆ™ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œè¿™é—¨ä¸¤å‘¨çš„è¯¾å¯ä»¥ä¸ºä½ èŠ‚çº¦æ•°æœˆçš„æ—¶é—´ 1. Why ML Strategy? å¦‚ä¸Šå›¾ç¤ºï¼Œå‡å¦‚æˆ‘ä»¬åœ¨æ„å»ºä¸€ä¸ªå–µå’ªåˆ†ç±»å™¨ï¼Œæ•°æ®é›†å°±æ˜¯ä¸Šé¢å‡ ä¸ªå›¾ï¼Œè®­ç»ƒä¹‹åå‡†ç¡®ç‡è¾¾åˆ°90%ã€‚è™½ç„¶çœ‹èµ·æ¥æŒºé«˜çš„ï¼Œä½†æ˜¯è¿™æ˜¾ç„¶å¹¶ä¸å…·ä¸€èˆ¬æ€§ï¼Œå› ä¸ºæ•°æ®é›†å¤ªå°‘äº†ã€‚é‚£ä¹ˆæ­¤æ—¶å¯ä»¥æƒ³åˆ°çš„MLç­–ç•¥æœ‰å“ªäº›å‘¢ï¼Ÿæ€»ç»“å¦‚ä¸Šå›¾ä¸­ Ideas. 2. Orthogonalization Orthogonalization [É”:Î¸É’É¡É™nÉ™laÉªâ€™zeÉªÊƒn] æ­£äº¤åŒ– And when I train a neural networkï¼ŒI tend not to use early shopping. å› ä¸º Early Stroppingï¼Œè¿™ä¸ªæŒ‰é’®èƒ½åŒæ—¶å½±å“ä¸¤ä»¶äº‹æƒ…. å°±åƒä¸€ä¸ªæŒ‰é’®åŒæ—¶å½±å“ç”µè§†æœºçš„å®½åº¦å’Œé«˜åº¦. å¦‚æœä½ æœ‰æ›´å¤šçš„æ­£äº¤åŒ–(Orthogonalization)çš„æ‰‹æ®µï¼Œç”¨è¿™äº›æ‰‹æ®µè°ƒç½‘ç»œä¼šç®€å•ä¸å°‘.When a supervised learning system is design, these are the 4 assumptions that needs to be true and orthogonal. No. strategy solutions 1. Fit training set well in cost function If it doesnâ€™t fit well, the use of a bigger neural network or switching to a better optimization algorithm might help. 2. Fit development set well on cost function If it doesnâ€™t fit well, regularization or using bigger training set might help. 3. Fit test set well on cost function If it doesnâ€™t fit well, the use of a bigger development set might help 4. Performs well in real world If it doesnâ€™t perform well, the development test set is not set correctly or the cost function is not evaluating the right thing 3. Single number evaluation metric å¤§è‡´çš„æ€æƒ³å°±æ˜¯é¦–å…ˆæŒ‰ç…§å•ä¸€æ•°å­—è¯„ä¼°æŒ‡æ ‡å¯¹æ¨¡å‹è¿›è¡Œè¯„ä»·å’Œä¼˜åŒ–ã€‚ä»¥ç²¾ç¡®ç‡å’Œå¬å›ç‡ä¸ºä¾‹ï¼Œè¿™äºŒè€…ä¸€èˆ¬æ¥è¯´æ˜¯ä¸€ä¸ªä¸å¯å…¼å¾—çš„æŒ‡æ ‡ï¼Œæ‰€ä»¥ä¸ºäº†æ›´å¥½çš„è¡¡é‡æ¨¡å‹çš„å¥½åï¼Œå¼•å…¥F1ç®—æ³•æ¥ç»¼åˆç²¾ç¡®ç‡å’Œå¬å›ç‡å¯¹æ¨¡å‹è¿›è¡Œè¯„ä¼°. Ref: sklearnä¸­ F1-micro ä¸ F1-macroåŒºåˆ«å’Œè®¡ç®—åŸç† 4. Satisficing and optimizing metricsItâ€™s not always easy into a single real number evaluation metric So more generally, if you have N metrics that you care about, itâ€™s sometimes reasonable to pick one of them to be optimizing. So you want to do as well as is possible on that one. And then N minus 1 to be satisficing. æ»¡è¶³å’Œä¼˜åŒ–æŒ‡æ ‡æ˜¯å¾ˆé‡è¦çš„ 5. Train/dev/test distributions Training, development and test distributions Setting up the training, development and test sets have a huge impact on productivity. It is important tochoose the development and test sets from the same distribution and it must be taken randomly from allthe data. Guideline Choose a development set and test set to reflect data you expect to get in the future and consider important to do well. æ‰€ä»¥ä¸ºäº†å®ç°æœä»åŒä¸€åˆ†å¸ƒï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·åš: é¦–å…ˆå°†æ‰€æœ‰å›½å®¶å’Œåœ°åŒºçš„æ•°æ®æ‰“æ•£ï¼Œæ··åˆ, æŒ‰ç…§ä¸€å®šçš„æ¯”ä¾‹å°†ä¸Šé¢æ··åˆæ‰“æ•£åçš„æ•°æ®åˆ’åˆ†ä¸º development and test sets 6. Size of dev and test sets 7. When to change dev/test sets and metricsä¸¾ä¸ªğŸŒ°: å‡è®¾ç°åœ¨ä¸€ä¸ªå…¬å¸åœ¨åšä¸€ä¸ªå–µå’ªå›¾ç‰‡æ¨é€æœåŠ¡ï¼ˆå³ç»™ç”¨æˆ·æ¨é€å–µå’ªçš„ç…§ç‰‡ï¼‰ï¼Œéƒ¨ç½²çš„æœ‰ä¸¤ä¸ªç®—æ³•: ç®—æ³•A: å–µå’ªå›¾ç‰‡è¯†åˆ«è¯¯å·®æ˜¯3%ï¼Œä½†æ˜¯å¯èƒ½ä¼šä¸€ä¸å°å¿ƒå°±ç»™ç”¨æˆ·å‘äº†ä¸€äº›å°‘å„¿ä¸å®œçš„å›¾ç‰‡ ç®—æ³•Bï¼šè¯¯å·®æ˜¯5%ï¼Œä½†æ˜¯ä¸ä¼šç»™ç”¨æˆ·æ¨é€ä¸å¥åº·çš„å›¾ç‰‡ æ‰€ä»¥å¯¹äºæŠ€æœ¯äººå‘˜æ¥è¯´å¯èƒ½å¸Œæœ›å‡†ç¡®æ€§é«˜ä¸€äº›çš„ç®—æ³•Aï¼Œè€Œç”¨æˆ·å¯èƒ½ä¼šéå¸¸åœ¨æ„ä½ ç»™ä»–æ¨é€äº†æŸäº›ä¸æƒ³çœ‹çš„ä¸œè¥¿, ä¹Ÿè®¸æ›´å–œæ¬¢ç®—æ³•Bã€‚æ‰€ä»¥æ€»çš„æ¥è¯´å°±æ˜¯æ ¹æ®å®é™…éœ€è¦æ¥ æ”¹å˜å¼€å‘/æµ‹è¯•é›†åˆæŒ‡æ ‡. 8. Why human-level performance? å¦‚å›¾ç¤ºï¼š è“è‰²è™šçº¿ï¼šè¡¨ç¤ºäººç±»è¯†åˆ«çš„å‡†ç¡®ç‡ ç´«è‰²æ›²çº¿ï¼šè¡¨ç¤ºæœºå™¨å­¦ä¹ ä¸æ–­è®­ç»ƒè¿‡ç¨‹ä¸­å‡†ç¡®ç‡çš„å˜åŒ– ç»¿è‰²è™šçº¿ï¼šè¡¨ç¤ºæœ€é«˜çš„å‡†ç¡®ç‡ï¼Œå³100% å…¶ä¸­ç´«è‰²æ›²çº¿åœ¨æœ«å°¾æ”¶æ•›åä¸ç»¿è‰²è™šçº¿ä¹‹é—´çš„å·®è·ç§°ä¸ºè´å¶æ–¯ä¼˜åŒ–è¯¯å·®(Bayse Optima Error) å› æ­¤åœ¨å®é™…æ“ä½œè¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä»¥äººç±»å‡†ç¡®ç‡ä¸ºæŒ‡æ ‡æ¥è¯„åˆ¤æˆ‘ä»¬è®­ç»ƒçš„æ¨¡å‹å¥½åç¨‹åº¦ 9. Avoidable bias Humans error ä¸ Training Error ä¹‹é—´çš„å·®è·æˆ‘ä»¬æˆä¸º Avoidable biasTraining Error ä¸ Dev Error ä¹‹é—´çš„å·®è·æˆ‘ä»¬æˆä¸º Variance 10. Understanding human-level performance è§£é‡Šè¯´æ˜ Example 1: å‡å¦‚ä¸€ä¸ªåŒ»é™¢éœ€è¦å¯¹ä¸€ä¸ªåŒ»å­¦å½±åƒè¿›è¡Œåˆ†ç±»è¯†åˆ«ï¼Œæ™®é€šäººï¼Œæ™®é€šåŒ»ç”Ÿï¼Œæœ‰ç»éªŒçš„åŒ»ç”Ÿå’Œä¸€ç¾¤æœ‰ç»éªŒçš„åŒ»ç”Ÿè¯†åˆ«é”™è¯¯ç‡åˆ†åˆ«ä¸º3%ï¼Œ1%ï¼Œ0.7%ï¼Œ0.5%ã€‚ä¸Šä¸€èŠ‚ä¸­æåˆ°è¿‡Human Errorï¼Œé‚£æ­¤æ—¶çš„è¯¥å¦‚ä½•ç¡®å®šHuman Errorå‘¢ï¼Ÿä½ å¯èƒ½ä¼šè¯´å–å¹³å‡å€¼ï¼Œåªèƒ½è¯´Too Naiveï¼å½“ç„¶æ˜¯å–æœ€å¥½çš„ç»“æœå•¦ï¼Œä¹Ÿå°±æ˜¯ç”±ä¸€ç¾¤ç»éªŒä¸°å¯Œçš„åŒ»ç”Ÿç»„æˆçš„å›¢ä½“å¾—åˆ°çš„ç»“æœä½œä¸ºHuman Errorã€‚å¦å¤–è´å¶æ–¯è¯¯å·®ä¸€å®šå°äº0.5%ã€‚ è§£é‡Šè¯´æ˜ Example 2: è¿˜æ˜¯ä»¥åŒ»å­¦å½±åƒåˆ†ç±»è¯†åˆ«ä¸ºä¾‹ï¼Œå‡å¦‚ç°åœ¨åˆ†æˆäº†ä¸‰ç§æƒ…å†µï¼š Scenario Aè®©ä¸‰ç±»äººç¾¤æ¥åˆ’åˆ†åå¾—åˆ°çš„è¯¯å·®åˆ†åˆ«ä¸º1%ï¼Œ0.7%ï¼Œ0.5%ï¼Œè€Œè®­ç»ƒé›†å’Œæµ‹è¯•é›†è¯¯å·®åˆ†åˆ«ä¸º5%ï¼Œ6%ã€‚å¾ˆæ˜¾ç„¶æ­¤æ—¶çš„Avoidable Bias=4%~4.5%ï¼ŒVariance=1%ï¼Œbiasæ˜æ˜¾å¤§äºvarianceï¼Œæ‰€ä»¥æ­¤æ—¶åº”è¯¥å°†é‡å¿ƒæ”¾åˆ°å‡å°biasä¸Šå»ã€‚ Scenario BayseåŒç†æ­¤æƒ…å†µä¸‹çš„Avoidable Bias=0%~0.5%ï¼ŒVariance=4%ï¼Œæ‰€ä»¥éœ€è¦å‡å°varianceã€‚ Scenario CAvoidable Bias=0.2%ï¼ŒVariance=0.1%ï¼ŒäºŒè€…ç›¸å·®æ— å‡ ï¼Œä½†æ˜¯æ­¤æ—¶è®­ç»ƒçš„æ¨¡å‹å‡†ç¡®ç‡è¿˜æ˜¯ä¸åŠäººç±»ï¼Œæ‰€ä»¥æ²¡åŠæ³•å’±ä»¬è¿˜å¾—ç»§ç»­ä¼˜åŒ–ï¼Œéƒ½è¯´æªæ‰“å‡ºå¤´é¸Ÿï¼Œæ‰€ä»¥ç»§ç»­ä¼˜åŒ–bias~ 11. Surpassing human-level performance Scenario A Avoidable Bias=0.1%ï¼ŒVariance=0.2%ï¼Œæ‰€ä»¥æ­¤æ—¶åº”è¯¥å°†é‡å¿ƒæ”¾åˆ°å‡å°Varianceä¸Šå» Scenario B Avoidable Bias=-0.2%ï¼ŒVariance=0.1%.ä¹ä¸€çœ‹å¯èƒ½ä¼šæœ‰ç‚¹ä¸çŸ¥æ‰€æªï¼Œè€Œä¸”è®­ç»ƒé›†å‡†ç¡®åº¦ä¹Ÿè¶…è¿‡äº†äººçš„æœ€å¥½æˆç»©ï¼Œä¸çŸ¥é“åº”è¯¥é€‰æ‹©ä¼˜åŒ–å“ªä¸€é¡¹äº†ï¼Œæˆ–è€…è¯´è¿™æ˜¯ä¸æ˜¯å°±è¯´æ˜å¯ä»¥ä¸ç”¨å†ä¼˜åŒ–äº†å‘¢ï¼Ÿ ï¼ˆè¿˜æ˜¯å¯ä»¥ç»§ç»­ä¼˜åŒ–çš„ã€‚ä¸å¯å¦è®¤åœ¨å›¾åƒè¯†åˆ«æ–¹é¢äººç±»çš„ç¡®å…¶ä¼˜äºæœºå™¨çš„æ–¹é¢ï¼Œä½†æ˜¯åœ¨å…¶ä»–æ–¹é¢ï¼Œå¦‚åœ¨çº¿å¹¿å‘Šæ¨é€ï¼Œè´·æ¬¾ç”³è¯·è¯„æµ‹ç­‰æ–¹é¢æœºå™¨äººè¦è¿œè¿œæ¯”äººç±»ä¼˜ç§€ï¼Œæ‰€ä»¥å¦‚æœæ˜¯åœ¨ä¸Šé¢è¯¾ä»¶ä¸­æåˆ°çš„ä¸€äº›é¢†åŸŸï¼Œå³ä½¿æœºå™¨å‡†ç¡®åº¦è¶…è¿‡äº†äººç±»ï¼Œä¹Ÿè¿˜æœ‰å¾ˆå¤§çš„ä¼˜åŒ–ç©ºé—´ã€‚å…·ä½“æ€ä¹ˆä¼˜åŒ–ã€‚ã€‚ã€‚ä»¥åå†æ¢ç´¢ã€‚ã€‚ã€‚ï¼‰ 12. Improving your model performance 13. Reference ç½‘æ˜“äº‘è¯¾å ‚ - deeplearning DeepLearning.aiå­¦ä¹ ç¬”è®°æ±‡æ€» DeepLearning.aiå­¦ä¹ ç¬”è®°ï¼ˆä¸‰ï¼‰ç»“æ„åŒ–æœºå™¨å­¦ä¹ é¡¹ç›®â€”week1 æœºå™¨å­¦ä¹ ç­–ç•¥","categories":[{"name":"deeplearning","slug":"deeplearning","permalink":"http://iequa.com/categories/deeplearning/"}],"tags":[{"name":"deeplearning.ai","slug":"deeplearning-ai","permalink":"http://iequa.com/tags/deeplearning-ai/"}]},{"title":"Improving DNN (week3) - Hyperparameterã€Batch Regularization","slug":"deeplearning/Improving-Deep-Neural-Networks-week3","date":"2018-07-23T12:00:21.000Z","updated":"2019-10-20T04:30:35.020Z","comments":true,"path":"2018/07/23/deeplearning/Improving-Deep-Neural-Networks-week3/","link":"","permalink":"http://iequa.com/2018/07/23/deeplearning/Improving-Deep-Neural-Networks-week3/","excerpt":"Hyperparameter Tuning processã€Normalizing Activations in a network Fitting Batch Norm into a neural networkã€Why does Batch Norm work?ã€Batch Norm at test time Softmax regressionã€TensorFlow","text":"Hyperparameter Tuning processã€Normalizing Activations in a network Fitting Batch Norm into a neural networkã€Why does Batch Norm work?ã€Batch Norm at test time Softmax regressionã€TensorFlow 1. Hyperparameter Tuning processæ­£å¸¸æƒ…å†µæœ‰å¦‚ä¸‹è¶…å‚æ•°: Hyperparameter Desc Importance level Î± æœ€é‡è¦ 1 hidden units 2 mini-batch size 2 Î² 2 layers 3 learning rate decay 3 $Î²_1,Î²_2,Îµ$ æœ€ä¸é‡è¦ 4 é¢œè‰²è¡¨ç¤ºé‡è¦æ€§ï¼Œä»¥åŠè°ƒè¯•è¿‡ç¨‹ä¸­å¯èƒ½ä¼šéœ€è¦ä¿®æ”¹çš„ç¨‹åº¦. é‚£ä¹ˆå¦‚ä½•é€‰æ‹©è¶…å‚æ•°çš„å€¼å‘¢ï¼Ÿ: é¦–å…ˆæ˜¯ç²—ç•¥åœ°éšæœºåœ°å¯»æ‰¾æœ€ä¼˜å‚æ•° å»ºè®®ä½¿ç”¨å›¾å³çš„æ–¹å¼ï¼ŒåŸå› å¦‚ä¸‹ï¼š å¯¹äºå›¾å·¦çš„è¶…å‚æ•°åˆ†å¸ƒè€Œè¨€ï¼Œå¯èƒ½ä¼šä½¿å¾—å‚è€ƒæ€§é™ä½ï¼Œæˆ‘ä»¬å‡è®¾è¶…å‚1æ˜¯å­¦ä¹ ç‡Î±ï¼Œè¶…å‚2æ˜¯Îµï¼Œæ ¹æ®week2ä¸­Adamç®—æ³•çš„ä»‹ç»ï¼Œæˆ‘ä»¬çŸ¥é“Îµçš„ä½œç”¨å‡ ä¹å¯ä»¥å¿½ç•¥ï¼Œæ‰€ä»¥å¯¹äºå›¾å·¦25ä¸­å‚æ•°åˆ†å¸ƒæ¥è¯´ï¼Œå…¶æœ¬è´¨åªæœ‰5ç§å‚æ•°åˆ†å¸ƒã€‚è€Œå³è¾¹åˆ™æ˜¯25ç§éšæœºåˆ†å¸ƒï¼Œæ›´èƒ½å¸®åŠ©æˆ‘ä»¬é€‰æ‹©åˆé€‚çš„è¶…å‚æ•°. å…¶æ¬¡åœ¨ä¸Šé¢æ‰¾åˆ°çš„æœ€ä¼˜å‚æ•°åˆ†å¸ƒå‘¨å›´å†éšæœºåœ°å¯»æ‰¾æœ€æœ‰å‚æ•° 2. Using an appropriate scale to pick hyperparametersä¸Šä¸€èŠ‚æåˆ°çš„çš„éšæœºé‡‡æ ·è™½ç„¶èƒ½å¸®åŠ©æˆ‘ä»¬å¯»æ‰¾æœ€ä¼˜å‚æ•°åˆ†å¸ƒï¼Œä½†æ˜¯è¿™æœ‰ç‚¹åƒå¤§æµ·æé’ˆï¼Œå¦‚æœèƒ½å¤ŸæŒ‡å‡ºå‚æ•°å–å€¼çš„èŒƒå›´ï¼Œç„¶åå†å»å¯»æ‰¾æœ€ä¼˜çš„å‚æ•°åˆ†å¸ƒå²‚ä¸æ˜¯æ›´åŠ çš„ç¾æ»‹æ»‹ï¼Ÿé‚£å¦‚ä½•ä¸ºè¶…å‚æ•°é€‰æ‹©åˆé€‚çš„èŒƒå›´å‘¢ï¼Ÿ $n^{[l]}=50,â€¦â€¦,100$ $layers=2~4$ $Î±=0.0001ï¼Œâ€¦â€¦,1$ æ­¤æ—¶æ³¨æ„: å¦‚æŒ‰ç…§çº¿æ€§åˆ’åˆ†çš„è¯(å¦‚ä¸‹å›¾)ï¼Œé‚£ä¹ˆéšæœºé‡‡æ ·çš„å€¼ 90% çš„æ•°æ®æ¥è‡ª [0.1,1] è¿™ä¸ªåŒºé—´, è¿™æ˜¾ç„¶ä¸ä¸å¤ªç¬¦åˆéšæœºæ€§. æ‰€ä»¥ä¸ºäº†æ”¹è¿›è¿™ä¸€é—®é¢˜ï¼Œæˆ‘ä»¬éœ€è¦å°†åŒºé—´å¯¹æ•°åŒ–æ¥é‡‡æ ·. ä¸¾ä¸ªğŸŒ°ï¼š æˆ‘ä»¬å°† [0.0001,1] è½¬åŒ–æˆå››ä¸ªåŒºé—´ [0.0001,0.001], [0.001,0.01], [0.01,0.1], [0.1,1], å†è½¬åŒ–æˆå¯¹æ•°å°±æ˜¯ [-4,-3], [-3,-2], [-2,-1], [-1,0]. ($10^{âˆ’4}=0.0001$ï¼Œå…¶ä»–åŒç†å–æŒ‡æ•°). ç„¶åæˆ‘ä»¬å¯ä»¥ç”¨ Python ä¸­æä¾›çš„æ–¹æ³•æ¥å®ç°éšæœºé‡‡æ ·ï¼š r = -4*np.random.rand() # rand()è¡¨ç¤ºåœ¨[0,1]ä¸Šå‡åŒ€é‡‡æ ·, æœ€åçš„é‡‡æ ·åŒºé—´æ˜¯[-4, 0]a = pow(10, r) $Î²=0.9,â€¦â€¦,0.999$ åŒç†è¿™é‡Œä¹Ÿä¸èƒ½ä½¿ç”¨çº¿æ€§è½´æ¥é‡‡æ ·æ•°æ®ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å¯¹ 1-Î²=0.1,â€¦â€¦,0.001 æ¥é—´æ¥é‡‡æ ·ã€‚è½¬åŒ–æˆ [0.1, 0.01], [0.01,0.001], è½¬åŒ–æˆå¯¹æ•°æŒ‡æ•° [-1,-2],[-2,-3]ã€‚ å³: $râˆˆ[-3,-1], 1-Î²=10^r, Î²=1-10^r$ å½“ Î² æ¥è¿‘ 1 æ—¶, Î² å°±ä¼šå¯¹ç»†å¾®çš„å˜åŒ–å˜å¾—å¾ˆæ•æ„Ÿ. for example : 0.999, 0.9995 =&gt; 1000 -&gt; 2000 æ‰€ä»¥ä½ éœ€è¦æ›´åŠ å¯†é›†çš„å–å€¼ï¼Œåœ¨ Î² æ¥è¿‘ 1 çš„æ—¶å€™. 3. Hyperparameters tuning in practice: Pandas vs Caviar Babysitting one model: è¿™ç§æ–¹æ³•é€‚ç”¨äºæœ‰è¶³å¤Ÿçš„æ•°æ®é›†ï¼Œä½†æ˜¯ GPUï¼ŒCPU èµ„æºæœ‰é™çš„æƒ…å†µï¼Œæ‰€ä»¥å¯èƒ½åªèƒ½è®­ç»ƒä¸€ä¸ªæ¨¡å‹ï¼Œç„¶åæ¯å¤©å¯¹æ¨¡å‹åšæŸä¸€é¡¹è¶…å‚æ•°çš„ä¿®æ”¹ï¼ŒæŸ¥çœ‹æ•ˆæœæ˜¯å¦å˜å¾—æ›´å¥½. ä¾‹å¦‚ç¬¬ä¸€å¤©ä»¤æ‰€æœ‰è¶…å‚æ•°éšæœºåˆå§‹åŒ–ã€‚åˆ°äº†ç¬¬äºŒå¤©å‘ç°æ•ˆæœè¿˜ä¸é”™ï¼Œæ­¤æ—¶å¯ä»¥å»å¢åŠ å­¦ä¹ ç‡(ä¹Ÿå¯ä»¥ä¿®æ”¹å…¶ä»–å‚æ•°)ã€‚â€¦â€¦ï¼Œåˆ°äº†æŸä¸€å¤©åŠ å…¥ä¿®æ”¹äº†mini-batch sizeï¼Œç»“æœæ•ˆæœæ˜æ˜¾å‡å¼±ï¼Œè¿™æ—¶åˆ™éœ€è¦é‡æ–°æ¢å¤åˆ°å‰ä¸€å¤©çš„çŠ¶æ€ã€‚ æ€»çš„æ¥è¯´è¿™ä¸€è¿‡ç¨‹å°±åƒç†ŠçŒ«ä¸€æ ·ï¼Œåªç…§é¡¾ä¸€ä¸ªå®å®ï¼Œå¤šçš„ç…§é¡¾ä¸è¿‡æ¥. Train many models in parallel: è¿™ç§æ–¹æ³•é€‚ç”¨äºè´¢å¤§æ°”ç²—çš„æƒ…å†µï¼Œå³å¹¶è¡Œè®­ç»ƒå¤šä¸ªæ¨¡å‹ï¼Œæœ€åé€‰å‡ºæ•ˆæœæœ€å¥½çš„ä¸€ä¸ªå³å¯ã€‚è¿™å°±åƒé±¼å­é…±ä¸€æ ·ï¼Œä¸€ä¸‹ç”Ÿå¤šå¤§ä¸€äº¿çš„å­©å­. 4. Normalizing Activations in a networkä¸ä»…è¦å½’ä¸€åŒ–è¾“å…¥æ•°æ® $X$,éšè—å±‚çš„æ•°æ®ä¹Ÿæ˜¯è¦å½’ä¸€åŒ–çš„. ä¸€èˆ¬æ¥è¯´éšè—å±‚æ•°æ®æœ‰ $Z$ å’Œ $a$ ä¸¤ç§ï¼ŒAndrew Ng æ¨èå½’ä¸€åŒ– $z$. Batch å½’ä¸€åŒ– ç”± Sergey loffe å’Œ Christian Szegedy ä¸¤ä½ç ”ç©¶è€…åˆ›é€ . Batch å½’ä¸€åŒ–ï¼Œä¼šä½¿ä½ çš„å‚æ•°æœç´¢å˜å¾—å®¹æ˜“, ä½¿ç¥ç»ç½‘ç»œå¯¹è¶…å‚æ•°çš„æœç´¢æ›´åŠ ç¨³å®š. è¿™æ ·ä¹Ÿä¼šä½¿å¾—ä½ å®¹æ˜“è®­ç»ƒæ·±å±‚ç¥ç»ç½‘ç»œã€‚ è¾“å…¥æ•°æ® $X$ å½’ä¸€åŒ–æ–¹æ³•: Î¼=\\frac{1}{m}\\sum\\_{i}{x^{(i)}} Ïƒ^2=\\frac{1}{m}\\sum\\_{i}x^{(i)^2} x=\\frac{x-Î¼}{Ïƒ^2} m ä¸º mini-batch ä¸­çš„ mï¼Œ è€Œä¸æ˜¯æ•´ä¸ªè®­ç»ƒé›† éšè—å±‚æ•°æ®å½’ä¸€åŒ–æ–¹æ³•: Î¼=\\frac{1}{m}\\sum\\_{i}{z^{(i)}-Î¼} Ïƒ^2=\\frac{1}{m}\\sum\\_{i}(z^{(i)^2}-Î¼)^2 z^{(i)}\\_{norm}=\\frac{z^{(i)}-Î¼}{\\sqrt{Ïƒ^2+Îµ}}ä¸Šé¢çš„å½’ä¸€åŒ–åçš„æ•°æ® $z$ éƒ½æ˜¯æœä»å‡å€¼ä¸º 0ï¼Œæ–¹å·®ä¸º 1 çš„ï¼Œæ˜¾ç„¶è¿™æ ·ä¸èƒ½æ»¡è¶³å’±ä»¬çš„éœ€æ±‚ï¼Œæ‰€ä»¥è¿˜éœ€è¦åšè¿›ä¸€æ­¥å¤„ç†ï¼Œå¦‚ä¸‹ï¼š \\tilde{z}^{(i)}=Î³z^{(i)} + Î²ä¸Šå¼ä¸­çš„ $Î³$ å¯ä»¥è®¾ç½®æ–¹å·®ï¼Œ$Î²$ å¯ä»¥è®¾ç½®å‡å€¼. ä½ ä¹Ÿè®¸ä¸æƒ³éšå±‚å•å…ƒå€¼å¿…é¡»æ˜¯å¹³å‡å€¼0 å’Œ æ–¹å·®1, æ¯”å¦‚ä½ æœ‰ä¸€ä¸ª sigmoid å‡½æ•°ï¼Œä½ ä¸æƒ³è®©å®ƒçš„å€¼å®Œå…¨é›†ä¸­åœ¨è¿™é‡Œ, ä½ ä¸æƒ³ä½¿ä»–ä»¬å¹³å‡å€¼å’Œæ–¹å·®ä¸€ç›´æ˜¯0å’Œ1ï¼Œ è¿™æ ·å¯ä»¥æ›´å¥½çš„åˆ©ç”¨éçº¿æ€§çš„ Sigmoid å‡½æ•°ï¼Œ è€Œä¸æ˜¯æ‰€æœ‰å€¼éƒ½é›†ä¸­åœ¨çº¿æ€§çš„åŒºåŸŸ, $Î³$ å’Œ $Î²$ å¯ä»¥ç¡®ä¿æ‰€æœ‰çš„ $Z^{(i)}$ å€¼ï¼Œå¯ä»¥æ˜¯ä½ æƒ³èµ‹äºˆçš„ä»»æ„å€¼. æˆ–è€… å®ƒçš„ä½œç”¨æ˜¯ä¿è¯éšè—çš„å•å…ƒå·²ä½¿å‡å€¼å’Œæ–¹å·®æ ‡å‡†åŒ–. é‚£é‡Œå‡å€¼å’Œæ–¹å·®ç”±ä¸¤å‚æ•°æ§åˆ¶. $Î³$ å’Œ $Î²$ å­¦ä¹ ç®—æ³•å¯ä»¥è®¾ç½®ä¸ºä»»ä½•å€¼. æ‰€ä»¥å®ƒçš„çœŸæ­£ä½œç”¨æ˜¯ä½¿å‡å€¼å’Œæ–¹å·®æ ‡å‡†åŒ–. $Z^{(i)}$ æœ‰å›ºå®šçš„å‡å€¼å’Œæ–¹å·®ï¼Œå‡å€¼å’Œæ–¹å·®å¯ä»¥æ˜¯0å’Œ1ï¼Œä¹Ÿå¯ä»¥æ˜¯å…¶ä»–å€¼ï¼Œç”± $Î³$ å’Œ $Î²$ ç¡®å®š. In practiceï¼Œ normlizing $Z^{[2]}$ is done much more often. 5. Fitting Batch Norm into a neural networkadding batch Norm to a network working with mini-batches ä¸€èˆ¬çš„æ–¹æ³•ä¸­ z^{[l]}=w^{[l]}a^{[l-1]}+b^{[l]}åœ¨ä¸Šé¢å½’ä¸€åŒ–æ•°æ®è¿‡ç¨‹ä¸­éœ€è¦å‡å»å‡å€¼ï¼Œæ‰€ä»¥ $b^{[l]}$ è¿™ä¸€é¡¹å¯ä»¥çœç•¥æ‰,æ‰€ä»¥å½’ä¸€åŒ–åæ˜¯ z\\_{norm}^{[l]}=w^{[l]}a^{[l-1]}ä¸ºäº†èƒ½å¤Ÿä½¿æ•°æ®åˆ†å¸ƒæ›´åŠ æ»¡è¶³æˆ‘ä»¬çš„è¦æ±‚ï¼Œå¯ä»¥ç”¨å¦‚ä¸‹å…¬å¼ \\tilde{z}^{[l]}=Î³^{[l]}z\\_{norm}^{[l]}+Î²^{[l]}Implementing gradient descent for t= 1,â€¦â€¦,numMinBatches è®¡ç®—åŸºäºç¬¬ $t$ æ‰¹æ•°æ®çš„å‰å‘ä¼ æ’­ åœ¨è®¡ç®—åå‘ä¼ æ’­æ—¶ä½¿ç”¨ $\\tilde{z}^{[l]}$, å¾—åˆ° $dw^{[l]},dÎ²^{[l]},dÎ³^{[l]}$ æ›´æ–°å‚æ•° w^{[l]}=w^{[l]}-Î±dw^{[l]} \\\\\\\\ Î²^{[l]}=Î²^{[l]}-Î±dÎ²^{[l]} \\\\\\\\ Î³^{[l]}=Î³^{[l]}-Î±dÎ³^{[l]}6. Why does Batch Norm work?åŸå› ä¸€: batch norm å¯ä»¥ä½¿å¾—æƒé‡æ¯”ä½ çš„ç½‘ç»œæ›´æ»åæˆ–æ›´æ·±å±‚ï¼Œä¸ºäº†æ›´å¥½åœ°ç†è§£å¯ä»¥çœ‹ä¸‹é¢çš„ä¾‹å­: å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œå‡è®¾æˆ‘ä»¬ç°åœ¨è¦è®¡ç®—ç¬¬ä¸‰å±‚éšè—å±‚çš„å€¼ï¼Œå¾ˆæ˜¾ç„¶è¯¥å±‚çš„è®¡ç®—ç»“æœä¾èµ–ç¬¬äºŒå±‚çš„æ•°æ®ï¼Œä½†æ˜¯ç¬¬äºŒå±‚çš„æ•°æ®å¦‚æœæœªå½’ä¸€åŒ–ä¹‹å‰æ˜¯ä¸å¯çŸ¥çš„ï¼Œåˆ†å¸ƒæ˜¯éšæœºçš„ã€‚è€Œå¦‚æœè¿›è¡Œå½’ä¸€åŒ–åï¼Œå³ $\\tilde{z}^{[2]}=Î³^{[2]}z_{norm}^{[2]}+Î²^{[2]}$ å¯ä»¥å°†ç¬¬äºŒå±‚æ•°æ®é™åˆ¶ä¸ºå‡å€¼ä¸º $Î²^{[2]}$, æ–¹å·®ä¸º $Î³^{[2]}$ çš„åˆ†å¸ƒ,æ³¨æ„è¿™ä¸¤ä¸ªå‚æ•°å¹¶ä¸éœ€è¦äººä¸ºè®¾ç½®ï¼Œå®ƒä¼šè‡ªåŠ¨å­¦ä¹ çš„ã€‚æ‰€ä»¥å³ä½¿è¾“å…¥æ•°æ®åƒå˜ä¸‡åŒ–ï¼Œä½†æ˜¯ç»è¿‡å½’ä¸€åŒ–ååˆ†å¸ƒéƒ½æ˜¯å¯ä»¥æ»¡è¶³æˆ‘ä»¬çš„éœ€æ±‚çš„ï¼Œæ›´ç®€å•åœ°è¯´å°±æ˜¯å½’ä¸€åŒ–æ•°æ®å¯ä»¥å‡å¼±å‰å±‚å‚æ•°çš„ä½œç”¨ä¸åå±‚å‚æ•°çš„ä½œç”¨ä¹‹é—´çš„è”ç³»ï¼Œå®ƒä½¿å¾—ç½‘ç»œæ¯å±‚éƒ½å¯ä»¥è‡ªå·±å­¦ä¹ ã€‚ åŸå› äºŒ: batch norm å¥æ•ˆçš„å¦ä¸€ä¸ªåŸå› åˆ™æ˜¯å®ƒå…·æœ‰æ­£åˆ™åŒ–çš„æ•ˆæœã€‚å…¶ä¸dropoutæœ‰å¼‚æ›²åŒå·¥ä¹‹å¦™ï¼Œæˆ‘ä»¬çŸ¥é“dropoutä¼šéšæœºçš„ä¸¢æ‰ä¸€äº›èŠ‚ç‚¹ï¼Œå³æ•°æ®ï¼Œè¿™æ ·ä½¿å¾—æ¨¡å‹è®­ç»ƒä¸ä¼šè¿‡åˆ†ä¾èµ–æŸä¸€ä¸ªèŠ‚ç‚¹æˆ–æŸä¸€å±‚æ•°æ®ã€‚batch normä¹Ÿæ˜¯å¦‚æ­¤ï¼Œé€šè¿‡å½’ä¸€åŒ–ä½¿å¾—å„å±‚ä¹‹é—´çš„ä¾èµ–æ€§é™ä½ï¼Œå¹¶ä¸”ä¼šç»™æ¯å±‚éƒ½åŠ å…¥ä¸€äº›å™ªå£°ï¼Œä»è€Œè¾¾åˆ°æ­£åˆ™åŒ–çš„ç›®çš„ Batch å®ƒé™åˆ¶äº†åœ¨å‰å±‚çš„å‚æ•°æ›´æ–°ï¼Œä¼šå½±å“æ•°å€¼åˆ†å¸ƒçš„ç¨‹åº¦ï¼Œç¬¬ä¸‰å±‚çœ‹åˆ°çš„è¿™ç§æƒ…å†µï¼Œå› æ­¤å¾—å­¦ä¹ . batch å½’ä¸€åŒ–å‡å°‘äº†è¾“å…¥å€¼æ”¹å˜çš„é—®é¢˜, å®ƒçš„ç¡®æ˜¯è¿™äº›å€¼å˜å¾—æ›´ç¨³å®š. ç¥ç»ç½‘ç»œçš„ä¹‹åå±‚å°±ä¼šæœ‰æ›´åšå®çš„åŸºç¡€. å³ä½¿è¾“å…¥åˆ†å¸ƒæ”¹å˜äº†ä¸€äº›ï¼Œå®ƒä¼šæ”¹å˜å¾—æ›´å°‘ï¼Œå®ƒåšçš„æ˜¯ å½“å‰å±‚ä¿æŒå­¦ä¹ ï¼Œå½“å±‚æ”¹å˜æ—¶ï¼Œè¿«ä½¿åå±‚, é€‚åº”çš„ç¨‹åº¦å‡å°‘äº†ï¼Œä½ å¯ä»¥è¿™æ ·æƒ³ï¼Œå®ƒå‡å¼±äº†å‰å±‚å‚æ•°çš„ä½œç”¨ï¼Œä¸åå±‚å‚æ•°çš„ä½œç”¨ä¹‹é—´çš„è”ç³»ï¼Œå®ƒä½¿å¾—ç½‘ç»œæ¯å±‚éƒ½å¯ä»¥è‡ªå·±å­¦ä¹ . ç¨ç¨ç‹¬ç«‹äºå…¶å®ƒå±‚ï¼Œè¿™æœ‰åŠ©äºåŠ é€Ÿæ•´ä¸ªç½‘ç»œçš„å­¦ä¹ . batch norm ä¸­æœ‰ä¸€ä¸ªä½œç”¨ï¼Œå¯ä»¥èµ·åˆ°è½»å¾® æ­£åˆ™åŒ– çš„ä½œç”¨. (å› ä¸ºæ·»åŠ çš„å™ªéŸ³å¾ˆå¾®å°ï¼Œæ‰€ä»¥å¹¶ä¸æ˜¯å·¨å¤§çš„æ­£åˆ™åŒ–)ï¼Œ ä½ å¯ä»¥å°† batch norm å’Œ dropout ä¸€èµ·ä½¿ç”¨. dropout, ä½ åº”ç”¨è¾ƒå¤§çš„ mini-batch æ¯”å¦‚ 512ï¼Œé‚£ä¹ˆå¯ä»¥å‡å°‘å™ªéŸ³ä¹Ÿ, å› æ­¤å‡å°‘äº†æ­£åˆ™åŒ–çš„æ•ˆæœ. è¿™æ˜¯ dropout çš„ä¸€ä¸ªå¥‡æ€ªçš„æ€§è´¨. batch norm æ˜¯ä¸€ä¸ªæ­£åˆ™åŒ–çš„è§„åˆ™ï¼Œè€Œä¸è¦æŠŠå®ƒå½“åšç›®çš„. ä½†æ˜¯æœ‰æ—¶å€™ï¼Œå®ƒä¼šå¯¹ä½ çš„ç®—æ³•æœ‰é¢å¤–çš„æœŸæœ›å’ŒéæœŸæœ›æ•ˆæœ. batch norm ä¸€æ¬¡åªèƒ½å¤„ç† ä¸€ä¸ª mini-batch çš„æ•°æ®. å®ƒåœ¨ mini-batch ä¸Šè®¡ç®—æœŸæœ›ä¸æ–¹å·®. 7. Batch Norm at test timeå‰é¢æåˆ°çš„ batch norm éƒ½æ˜¯åŸºäºè®­ç»ƒé›†çš„ï¼Œä½†æ˜¯åœ¨æµ‹è¯•é›†ä¸Šï¼Œæœ‰æ—¶å€™å¯èƒ½æˆ‘ä»¬çš„æµ‹è¯•æ•°æ®å¾ˆå°‘ï¼Œä¾‹å¦‚åªæœ‰1ä¸ªï¼Œåœ¨è¿™ä¸ªæ—¶å€™è¿›è¡Œå½’ä¸€åŒ–åˆ™æ˜¾å¾—æ²¡å¤šå¤§æ„ä¹‰äº†ã€‚é‚£ä¹ˆè¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿå‡å€¼$Î¼$ å’Œ æ–¹å·®$Ïƒ^2$è¯¥å¦‚ä½•ç¡®å®šå‘¢ï¼Ÿ æ–¹æ³•è¿˜æ˜¯æœ‰çš„ï¼Œè€Œä¸”å·²ç»åœ¨ä¸Šé¢æåˆ°è¿‡äº†, å°±æ˜¯ç¬¬ä¸‰èŠ‚æ‰€ä»‹ç»çš„æŒ‡æ•°åŠ æƒå¹³å‡å•¦ï¼ŒåŸç†æ˜¯ç±»ä¼¼çš„ å‡è®¾ä¸€å…±æœ‰å¦‚ä¸‹ $x^1,x^2,â€¦â€¦,x^5000$ çš„æ‰¹é‡æ•°æ®ï¼Œæ¯ç»„mini-batch éƒ½å¾—åˆ°äº†å¯¹åº”çš„å‡å€¼$Î¼$, (æ–¹å·®åŒç†ï¼Œä¸è¯¦ç»†è¯´æ˜äº†)ï¼Œå³ $Î¼^1,Î¼^2,â€¦â€¦,Î¼^5000$, å¦‚æœæµ‹è¯•é›†æ•°æ®å¾ˆå°‘ï¼Œé‚£ä¹ˆå°±å¯ä»¥ä½¿ç”¨æŒ‡æ•°åŠ æƒå¹³å‡çš„æ–¹æ³•æ¥å¾—åˆ°æµ‹è¯•é›†çš„å‡å€¼å’Œæ–¹å·®ã€‚ ä¹‹åå°±æ ¹æ®æŒ‡æ•°åŠ æƒå¹³å‡è®¡ç®—å¾—åˆ°çš„å€¼æ¥è®¡ç®—å½’ä¸€åŒ–åçš„è¾“å…¥å€¼å³å¯. Andrew Ng è¯­å½•: å¦‚æœå°†ä½ çš„ç¥ç»ç½‘ç»œç”¨äºæµ‹è¯•ï¼Œä½ éœ€è¦å•ç‹¬ä¼°ç®— $Î¼$ å’Œ $Ïƒ^2$, åœ¨å…¸å‹çš„ Batch å½’ä¸€åŒ–è¿ç”¨ä¸­ï¼Œä½ éœ€è¦ç”¨ä¸€ä¸ªæŒ‡æ•°åŠ æƒå¹³å‡æ¥ä¼°ç®—ï¼Œæ•´ä¸ªå¹³å‡æ•°è¦†ç›–äº†æ‰€æœ‰çš„ mini-batch . z^{(i)}\\_{norm}=\\frac{z^{(i)}-Î¼}{\\sqrt{Ïƒ^2+Îµ}}ä¸Šä¸ªå¼å­ $z^{(i)}_{norm}$ ä¸­çš„ï¼Œ$Î¼$, $Ïƒ^2$ æ˜¯ç±»ä¼¼åŠ æƒå¹³å‡å‡ºæ¥çš„å€¼. æ³¨æ„ï¼šæµ‹è¯•é›†çš„å‡å€¼å’Œæ–¹å·®ç”Ÿæˆçš„æ–¹å¼ä¸ä¸€å®šéå¾—æ˜¯ä¸Šé¢æåˆ°çš„æŒ‡æ•°åŠ æƒå¹³å‡ï¼Œä¹Ÿå¯ä»¥æ˜¯ç®€å•ç²—æš´çš„è®¡ç®—æ‰€æœ‰è®­ç»ƒé›†çš„å‡å€¼å’Œæ–¹å·®ï¼Œè§†é¢‘ä¸­ Andrew Ng è¯´è¿™ä¹Ÿæ˜¯å¯è¡Œçš„. 8. Softmax regression å‡è®¾ç¬¬ $l$ å±‚æœ‰ $z^{[l]}=w^{[l]}a^{[l-1]}+b^{[l]}$, æ¿€æ´»å‡½æ•°ä¸º $a^{[l]}=\\frac{e^{z^{[l]}}}{\\sum_{j=1}^{n_l}e^{z^{[l]}_j}}$ è¯¥èŠ‚è§†é¢‘ä¸­ Andrew Ng å¹¶æ²¡æœ‰å¾ˆè¯¦ç»†çš„ä»‹ç» softmax çš„åŸç†å’Œå…¬å¼æ¨å¯¼ï¼Œæ„Ÿå…´è¶£çš„å¯ä»¥æˆ³å¦‚ä¸‹é“¾æ¥è¿›è¡Œè¿›ä¸€æ­¥äº†è§£ï¼š ufldl: Softmax å›å½’ softmax å…¬å¼æ¨å¯¼&amp;ç®—æ³•å®ç° 9. Trying a softmax classifier è½¬è½½: å…·ä½“å®è·µé¡¹ç›®å¯å‚è§softmaxåˆ†ç±»ç®—æ³•åŸç†(ç”¨pythonå®ç°) ä¸Šé¢çš„è½¬è½½å®ç° softmax éœ€è¦å†ä»”ç»†ç ”ç©¶. 10. Deep learning frameworks 11. TensorFlow ExampleAndrew Ng æ¼”ç¤ºäº† TensorFlow ä½¿ç”¨æ–¹æ³•. æˆ‘æ¨èä¸€ä¸ªæ¯”è¾ƒå¥½çš„ TensorFlow çš„ç»ƒæ‰‹é¡¹ç›®ï¼šTensorFlow Example 12. Reference ç½‘æ˜“äº‘è¯¾å ‚ - deeplearning deeplearning.ai ä¸“é¡¹è¯¾ç¨‹äºŒç¬¬ä¸€å‘¨ Coursera - Deep Learning Specialization DeepLearning.aiå­¦ä¹ ç¬”è®°æ±‡æ€» TensorFlow-Examples å´æ©è¾¾è€å¸ˆçš„æ·±åº¦å­¦ä¹ è¯¾ç¨‹ç¬”è®°åŠèµ„æº","categories":[{"name":"deeplearning","slug":"deeplearning","permalink":"http://iequa.com/categories/deeplearning/"}],"tags":[{"name":"deeplearning.ai","slug":"deeplearning-ai","permalink":"http://iequa.com/tags/deeplearning-ai/"}]},{"title":"Spark Core ä¸­çš„ RDD è¯¦è§£ 3.1","slug":"spark/spark-aura-3.1-RDD-detail","date":"2018-07-23T00:07:21.000Z","updated":"2020-12-04T01:06:22.908Z","comments":true,"path":"2018/07/23/spark/spark-aura-3.1-RDD-detail/","link":"","permalink":"http://iequa.com/2018/07/23/spark/spark-aura-3.1-RDD-detail/","excerpt":"","text":"1. å¹¿æ’­å˜é‡ çº¿ç¨‹å¯ä»¥å…±äº«å˜é‡çš„æ€è·¯ å¹¿æ’­å˜é‡ï¼š (1) åœ¨é»˜è®¤æƒ…å†µä¸‹ï¼Œæ¯ä¸€ä¸ªtaskéƒ½ä¼šç»´æŒä¸€ä¸ªå…¨å±€å˜é‡çš„å‰¯æœ¬ æœ‰ä¸€ä¸ªé›†åˆï¼š100M åœ¨ driver ä¸­ç”Ÿæˆï¼Œ ä½†æ˜¯åœ¨æ‰€æœ‰çš„taskä¸­éƒ½éœ€è¦ä½¿ç”¨ é‚£ä¹ˆï¼Œæ¯ä¸€ä¸ª task éƒ½ä¼šç»´æŒä¸€ä¸ªå½“å‰è¿™ 100M æ•°æ®çš„å‰¯æœ¬ å¦‚æœä¸€ä¸ª executor ä¸­å¯åŠ¨äº† 6 ä¸ª taskï¼Œæœ€ç»ˆæ¶ˆè€— 600M å†…å­˜ (2). å¦‚æœä½¿ç”¨å¹¿æ’­å˜é‡çš„è¯ é‚£ä¹ˆå¯ä»¥æŠŠå½“å‰è¿™ä¸ª100Mçš„æ•°æ®ï¼Œå°±ç¼–ç¨‹ä¸€ä¸ªå¹¿æ’­å˜é‡çš„å€¼ ç”¨ driver ä¸­çš„ sparkcontext è¿›è¡Œ å…¨å±€æ‰€æœ‰ executor å¹¿æ’­ æœ€åçš„æ•ˆæœï¼šæ¯ä¸ª executor ä¸­åªå­˜åœ¨ä¸€ä»½è¿™ä¸ªå¹¿æ’­å˜é‡çš„å‰¯æœ¬ è€Œä¸æ˜¯åŸå…ˆçš„æ¯ä¸€ä¸ªtaskéƒ½ä¿æŒä¸€ä¸ªå‰¯æœ¬ æ‰€ä»¥æœ€ç»ˆçš„å†…å­˜æ¶ˆè€—é‡ï¼š 100m (3) æœ€åçš„æ•ˆæœï¼š å‡å°‘äº†ç½‘ç»œæ•°æ®ä¼ è¾“çš„é‡ å‡å°‘äº†executorçš„å†…å­˜ä½¿ç”¨ å¦‚æœä¸€ä¸ªå€¼å¾ˆå°ï¼Œé‚£ä¹ˆå‡ ä¹æ²¡æœ‰å¹¿æ’­çš„å¿…è¦ã€‚ å¹¿æ’­çš„å€¼çš„å¤§å°è¶Šå¤§ï¼Œæ•ˆæœè¶Šæ˜æ˜¾ 2. ç´¯åŠ å™¨val a = sc.accumulator(0) è¿˜åŸä¸€ä¸ªç´¯åŠ å™¨ val b = a.value spark çš„ç´¯åŠ å™¨ å’Œ mapreduceç¼–ç¨‹æ¨¡å‹çš„å…¨å±€è®¡æ•°å™¨æ˜¯ä¸€ä¸ªé“ç†ã€‚ 3. DAGè§„åˆ’å’ŒåŸºç¡€ç†è®ºåˆ‡åˆ† Stage æ˜¯ ä»åå¾€å‰æ‰¾ shufferç±»å‹/å®½ä¾èµ–çš„ç®—å­ï¼Œé‡åˆ°ä¸€ä¸ªå°±æ–­å¼€ï¼Œå½¢æˆä¸€ä¸ª stage æœ€åä¸€ä¸ª stageï¼š ResultStage é™¤æ­¤ä¹‹å¤–çš„stage sparkä¸­å¦‚ä½•åˆ’åˆ†stage å› æ­¤sparkåˆ’åˆ†stageçš„æ•´ä½“æ€è·¯æ˜¯ï¼šä»åå¾€å‰æ¨ï¼Œé‡åˆ°å®½ä¾èµ–å°±æ–­å¼€ï¼Œåˆ’åˆ†ä¸ºä¸€ä¸ªstageï¼›é‡åˆ°çª„èµ–å°±å°†è¿™ä¸ªRDDåŠ å…¥è¯¥stageä¸­ã€‚ åœ¨sparkä¸­ï¼ŒTaskçš„ç±»å‹åˆ†ä¸º2ç§ï¼šShuffleMapTaskå’ŒResultTaskï¼›ç®€å•æ¥è¯´ï¼ŒDAGçš„æœ€åä¸€ä¸ªé˜¶æ®µä¼šä¸ºæ¯ä¸ªç»“æœçš„partitionç”Ÿæˆä¸€ä¸ªResultTaskï¼Œå³æ¯ä¸ªStageé‡Œé¢çš„Taskçš„æ•°é‡æ˜¯ç”±è¯¥Stageä¸­æœ€åä¸€ä¸ªRDDçš„Partitionçš„æ•°é‡æ‰€å†³å®šçš„ï¼ è€Œå…¶ä½™æ‰€æœ‰é˜¶æ®µéƒ½ä¼šç”ŸæˆShuffleMapTaskï¼›ä¹‹æ‰€ä»¥ç§°ä¹‹ä¸ºShuffleMapTaskæ˜¯å› ä¸ºå®ƒéœ€è¦å°†è‡ªå·±çš„è®¡ç®—ç»“æœé€šè¿‡shuffleåˆ°ä¸‹ä¸€ä¸ªstageä¸­ã€‚ åˆ‡åˆ†stageï¼š ä»åå¾€å‰æ‰¾ shuffleç±»å‹/å®½ä¾èµ– çš„ç®—å­, é‡åˆ°ä¸€ä¸ªå°±æ–­å¼€, å½¢æˆä¸€ä¸ª stage æœ€åä¸€ä¸ªstage: ResultStage â€”â€”â€”&gt; ResultTaské™¤æ­¤ä¹‹å¤–çš„stageï¼šShffleMapStage â€”â€”â€”&gt; ShffleTask æ¯ä¸€ä¸ª stage éƒ½ä¼šåˆ‡æˆå¤šä¸ªåŒç§ç±»å‹çš„ Task æ¯ä¸€ä¸ª Stage ä¸­çš„æœ‰å¯èƒ½åŒ…å«å¤šä¸ªä¸åŒçš„ RDDé‚£ä¹ˆä¸€ä¸ª Stage åˆæœ‰å¯èƒ½ä¼šåˆ’åˆ†å¤šä¸ª task æ‰§è¡Œæ¯ä¸ª RDD åˆå¯ä»¥æŒ‡å®šä¸åŒçš„åˆ†åŒºæ•°é»˜è®¤æƒ…å†µä¸‹ï¼šæ¯ä¸€ä¸ªåˆ†åŒºï¼Œå°±ä¼šæ˜¯ä¸€ä¸ª Task é‚£ä¹ˆç°åœ¨ï¼Œå¦‚æœé‡åˆ°äº†ä¸€ä¸ª stage ä¸­æœ‰å¤šä¸ªä¸åŒåˆ†åŒºæ•°çš„RDDï¼Œé‚£ä¹ˆè¯·é—®ï¼šåˆ°åº•è¿™ä¸ªstageä¸­æœ‰å¤šå°‘ä¸ªTaskæ‰§è¡Œå‘¢ï¼Ÿ 5 4 3 â€”â€”-&gt; 3ä¸ªtask ä»¥æœ€åä¸€ä¸ªRDDçš„åˆ†åŒºæ•°æ¥å†³å®š åˆ‡åˆ†jobï¼š ä»å‰å¾€åæ‰¾actionç®—å­, æ‰¾åˆ°ä¸€ä¸ªå°±å½¢æˆä¸€ä¸ª job. 3 + 2 = 5 tasks DAG çš„ç”Ÿæˆ checkpoint linage æ£€æŸ¥ç‚¹ è¡€è„‰ è¡€ç»Ÿ å®¹é”™ å¯¹äºSparkä»»åŠ¡ä¸­çš„å®½çª„ä¾èµ–ï¼Œæˆ‘ä»¬åªå–œæ¬¢çª„ä¾èµ– DAGSchedulerï¼š spark-submit æäº¤ä»»åŠ¡ åˆå§‹åŒ– DAGScheduler å’Œ TaskScheduler æ¥æ”¶åˆ° application ä¹‹åï¼ŒDAGScheduler ä¼šé¦–å…ˆæŠŠ application æŠ½è±¡æˆä¸€ä¸ª DAG DAGScheduler å¯¹è¿™ä¸ª DAG (DAGä¸­çš„ä¸€ä¸ªJob) è¿›è¡Œ stage çš„åˆ‡åˆ† æŠŠæ¯ä¸€ä¸ª stage æäº¤ç»™ TaskScheduler rdd1.collect client æäº¤ä»»åŠ¡çš„ä»»åŠ¡èŠ‚ç‚¹ å¦‚æœæ˜¯clientæ¨¡å¼ï¼Œé‚£ä¹ˆ driverç¨‹åºå°±åœ¨ client èŠ‚ç‚¹å¦‚æœæ¨¡å¼æ˜¯ cluster, driver ç¨‹åºåœ¨ worker ä¸­.rdd20.countByKey() countByKey æ˜¯ä½œç”¨åœ¨ key-value ç±»å‹ä¸Šçš„ä¸€ä¸ª action ç®—æ³•countByValue ä¸€èˆ¬æ˜¯ç”¨æ¥ç»Ÿè®¡æ™®é€šç±»å‹çš„RDDmap reduce recudeByKey filter, json éš¾ç‚¹ï¼š aggregate aggregate count sum max min distinct avg 100G â€”â€”&gt; 1G20G â€”â€”-&gt; 30G map mapPartitionsjoin mapjoin reducejoincogroup coalescerepartitionrepartitionAndSortWithinPartitions é‡æ–°åˆ†åŒº, å¹¶ä¸”åˆ†åŒºå†…æ•°æ®è¿›è¡Œæ’åº Spark Transformations 6. RDD æŒä¹…åŒ–æ“ä½œ cache, persistcache: æ­£å¸¸æƒ…å†µä¸‹ï¼š ä¸€ä¸ªRDDä¸­æ˜¯ä¸åŒ…å«çœŸå®æ•°æ®çš„ï¼ŒåªåŒ…å«æè¿°è¿™ä¸ªRDDçš„æºæ•°æ®ä¿¡æ¯ å¦‚æœå¯¹è¿™ä¸ªRDDè°ƒç”¨ cache æ–¹æ³• é‚£ä¹ˆè¿™ä¸ªrddä¸­çš„æ•°æ®ï¼Œç°åœ¨ä¾ç„¶è¿˜æ˜¯æ²¡æœ‰çœŸå®æ•°æ® ç›´åˆ°ç¬¬ä¸€æ¬¡è°ƒç”¨ä¸€ä¸ªactionçš„ç®—å­å‡ºå‘äº†è¿™ä¸ªRDDçš„æ•°æ®ç”Ÿæˆï¼Œé‚£ä¹ˆcache æ“ä½œ cache()persist() == persist(StorageLevel.MEMORY_ONLY)persist(StorageLevel.XXXX) def cache(): this.type = persist()def persist(): this.type = persist(StorageLevel.MEMORY_ONLY)persist() ==== persist(StorageLevel.MEMORY_ONLY) ä¸€ä¸ªæ™®é€šçš„æ–‡ä»¶ file ===ã€‹ å†…å­˜ è¯¥ file è¢«åºåˆ—åŒ–äº† ===ã€‹ å†…å­˜ JVM æœ€å¤§çš„åŒºåŸŸæ˜¯ Head å†…å­˜ï¼Œ OffHeap å †å¤–å†…å­˜ 7. union, join, subtract, cartesian8. å„ç§ byKey æ“ä½œ (é‡è¦)â€”â€”union, join, coGroup, subtract, cartesianâ€”â€” groupByKey reduceByKey aggregateByKey sortByKey combineByKey 8.1 groupByKeyval data = List((&quot;math&quot;, 89), (&quot;hadoop&quot;, 100), (&quot;math&quot;, 10), (&quot;english&quot;, 89), (&quot;math&quot;, 1000)) groupByKeyæŠŠç›¸åŒçš„keyçš„æ•°æ®åˆ†ç»„åˆ°ä¸€ä¸ªé›†åˆåºåˆ—å½“ä¸­ï¼š [ (&quot;spark&quot;,1), (&quot;hive&quot;,1), (&quot;spark&quot;,1), (&quot;hadoop&quot;,1), (&quot;hive&quot;,1)] --&gt; [ (&quot;spark&quot;,(1,1)), (&quot;hive&quot;,(1,1)), (&quot;hadoop&quot;,(1))] Sparkå‡½æ•°è®²è§£ï¼šaggregateByKey è¿‡å¾€è®°å¿† Sparkçš„groupByKeyã€reduceByKeyã€sortByKeyç®—å­æ¡ˆä¾‹ 9. RDD mapPartitions, mapPartitionsWithIndexmapPartitions æ¯æ¬¡éå†ä¸€ä¸ªåˆ†åŒº (æœ€å°å•ä½æ˜¯åˆ†åŒº) 10. map, flatMap, filter11. spark åŸºç¡€æ¦‚å¿µå¤ä¹ 11.1 ç¬¬1éƒ¨åˆ† ç¬¬ä¸€å¤©sparkå†…å®¹çš„éƒ¨åˆ†æ®‹ç•™ WordCountJava7 WordCountJava8 ä»»åŠ¡çš„æäº¤ï¼š (1). run-example SparkPi 100 (2). spark-shell (3). spark-submit â€”master: local local[2] local\\[\\*\\] spark://hadoop02:7077, hadoop04:7077 yarn HDFS å¤„ç† myha01 è¿™ä¸ª nameservice çš„æ–¹å¼éå¸¸çš„æš´åŠ›: æ‰€æœ‰çš„è¯·æ±‚ï¼Œå…¶å®éƒ½ä¼šç»™æ¯ä¸ª namenode éƒ½å‘é€, ä½†æ˜¯åªæœ‰ active çš„ namenodeæ‰ä¼šè¿›è¡Œå¤„ç†ï¼Œè¿›è¡Œå›å¤ if (namenode.getServiceStage() == &quot;standby&quot;) &#123;&#125; else : ... 11.1 ç¬¬2éƒ¨åˆ† æ ¸å¿ƒåŠŸèƒ½: SparkContext, å­˜å‚¨ä½“ç³»ï¼Œ æ‰§è¡Œå¼•æ“ DAGScheduler, éƒ¨ç½²é­”æœ¯ æ‰©å±•åŠŸèƒ½: SQL, Streaming, GraphX, MLlib, SparkR, Pyspark æ ¸å¿ƒæ¦‚å¿µ: Application Job åˆ‡åˆ†æ ‡å‡†: ä»å‰å¾€åæ‰¾actionçš„ç®—å­ Stage åˆ‡åˆ†æ ‡å‡†: ä»åå¾€å‰æ‰¾å®½ä¾èµ–çš„ç®—å­ Task Driver Application: å®¢æˆ·ç«¯é©±åŠ¨ç¨‹åº, ä¹Ÿå¯ä»¥ç†è§£ä¸ºå®¢æˆ·ç«¯åº”ç”¨ç¨‹åºï¼Œç”¨äºå°†ä»»ä½•ç¨‹åºè½¬æ¢ä¸º RDD å’Œ DAG, å¹¶ä¸ Cluster Manager è¿›è¡Œé€šä¿¡ä¸è°ƒåº¦. ClusterManager Driver Executor Master, Worker, Client deploy-mode ä¸»è¦é’ˆå¯¹ yarn: client cluster åŸºæœ¬æ¶æ„: ç¼–ç¨‹æ¨¡å‹: 1). è·å–ç¼–ç¨‹å…¥å£ ---&gt; SparkContext 2). é€šè¿‡ç¼–ç¨‹å…¥å£ä½¿ç”¨ä¸åŒçš„æ–¹å¼åŠ è½½æ•°æ®å¾—åˆ°ä¸€ä¸ªæ•°æ®æŠ½è±¡ ---&gt; RDD 3). é’ˆå¯¹åŠ è½½å¾—åˆ°çš„æ•°æ®æŠ½è±¡è°ƒç”¨ä¸åŒçš„ç®—å­è¿›è¡Œå¤„ç† ---&gt; Transformation + Action 4). é’ˆå¯¹ç»“æœæ•°æ®è¿›è¡Œå¤„ç† RDD/Scala å¯¹è±¡ æˆ– é›†åˆ ---&gt; print / save å­˜å‚¨ 5). å…³é—­ç¼–ç¨‹å…¥å£ ---&gt; sparkContext.stop() sparkSQLsparkStreaming&amp;sparkCore ä¸€æ¨¡ä¸€æ ·å”¯ä¸€ä¸ç›¸åŒçš„åœ°æ–¹å°±æ˜¯: ç¼–ç¨‹å…¥å£, æ•°æ®æŠ½è±¡, ç®—å­ RDDï¼š (1) æ¦‚å¿µï¼š å¼¹æ€§åˆ†å¸ƒå¼æ•°æ®é›†ï¼Œ ä¸å¯å˜çš„ï¼Œ å¯åˆ†åŒºçš„åˆ†å¸ƒå¼é›†åˆ(2) å±æ€§ï¼š A list of partitions A function for computing on other RDDs A list of dependencies on other RDDs Optionally, a Partition for key-value RDDs (e.g. to say that the RDD is hash-partitioned) Optionally, a list of preferred locations to compute each split on (e.g. block locations for an HDFS file) 12. RDD ç®—å­ sample, takeSampleReference Sparkå¹¿æ’­å˜é‡å’Œç´¯åŠ å™¨è¯¦è§£ é©¬è€å¸ˆ-Sparkçš„WordCountåˆ°åº•äº§ç”Ÿäº†å¤šå°‘ä¸ªRDD å¤§æ•°æ®æŠ€æœ¯ä¹‹_19_Sparkå­¦ä¹ _02_Spark Core åº”ç”¨è§£æ+ RDD æ¦‚å¿µ + RDD ç¼–ç¨‹ + é”®å€¼å¯¹ RDD + æ•°æ®è¯»å–ä¸ä¿å­˜ä¸»è¦æ–¹å¼ + RDD ç¼–ç¨‹è¿›é˜¶ + Spark Core å®ä¾‹ç»ƒä¹  Offerå¸® è‹±è¯­å­¦ä¹ åŒ…","categories":[{"name":"spark","slug":"spark","permalink":"http://iequa.com/categories/spark/"}],"tags":[{"name":"spark","slug":"spark","permalink":"http://iequa.com/tags/spark/"}]},{"title":"Improving Deep Neural Networks (week2) - Optimization Algorithm","slug":"deeplearning/Improving-Deep-Neural-Networks-week2","date":"2018-07-21T02:00:21.000Z","updated":"2019-10-20T04:30:35.021Z","comments":true,"path":"2018/07/21/deeplearning/Improving-Deep-Neural-Networks-week2/","link":"","permalink":"http://iequa.com/2018/07/21/deeplearning/Improving-Deep-Neural-Networks-week2/","excerpt":"Mini-batchã€æŒ‡æ•°åŠ æƒå¹³å‡-åå·®ä¿®æ­£ã€Momentumã€RMSpropã€Adamã€å­¦ä¹ ç‡è¡°å‡ã€å±€éƒ¨æœ€ä¼˜ è¿™èŠ‚è¯¾æ¯ä¸€èŠ‚çš„çŸ¥è¯†ç‚¹éƒ½å¾ˆé‡è¦ï¼Œæ‰€ä»¥æœ¬æ¬¡ç¬”è®°å‡ ä¹æ¶µç›–äº†å…¨éƒ¨å°è§†é¢‘è¯¾ç¨‹çš„è®°å½•","text":"Mini-batchã€æŒ‡æ•°åŠ æƒå¹³å‡-åå·®ä¿®æ­£ã€Momentumã€RMSpropã€Adamã€å­¦ä¹ ç‡è¡°å‡ã€å±€éƒ¨æœ€ä¼˜ è¿™èŠ‚è¯¾æ¯ä¸€èŠ‚çš„çŸ¥è¯†ç‚¹éƒ½å¾ˆé‡è¦ï¼Œæ‰€ä»¥æœ¬æ¬¡ç¬”è®°å‡ ä¹æ¶µç›–äº†å…¨éƒ¨å°è§†é¢‘è¯¾ç¨‹çš„è®°å½• 1. Mini-batch éšæœºæ¢¯åº¦ä¸‹é™æ³•çš„ä¸€å¤§ç¼ºç‚¹æ˜¯, ä½ ä¼šå¤±å»æ‰€æœ‰å‘é‡åŒ–å¸¦ç»™ä½ çš„åŠ é€Ÿï¼Œå› ä¸ºä¸€æ¬¡æ€§åªå¤„ç†äº†ä¸€ä¸ªæ ·æœ¬ï¼Œè¿™æ ·æ•ˆç‡è¿‡äºä½ä¸‹, æ‰€ä»¥å®è·µä¸­æœ€å¥½ é€‰æ‹©ä¸å¤§ä¸å° çš„ Mini-batch å°ºå¯¸. å®é™…ä¸Šå­¦ä¹ ç‡è¾¾åˆ°æœ€å¿«ï¼Œä½ ä¼šå‘ç°2ä¸ªå¥½å¤„ï¼Œä½ å¾—åˆ°äº†å¤§é‡å‘é‡åŒ–ï¼Œå¦ä¸€æ–¹é¢ ä½ ä¸éœ€è¦ç­‰å¾…æ•´ä¸ªè®­ç»ƒé›†è¢«å¤„ç†å®Œï¼Œä½ å°±å¯ä»¥å¼€å§‹è¿›è¡Œåç»­å·¥ä½œ. å®ƒä¸ä¼šæ€»æœç€æœ€å°å€¼é è¿‘ï¼Œä½†å®ƒæ¯”éšæœºæ¢¯åº¦ä¸‹é™è¦æ›´æŒç»­åœ°é è¿‘æœ€å°å€¼çš„æ–¹å‘. å®ƒä¹Ÿä¸ä¸€å®šåœ¨å¾ˆå°çš„èŒƒå›´å†…æ”¶æ•›ï¼Œå¦‚å‡ºç°è¿™ä¸ªé—®é¢˜ï¼Œä½ å¯ä»¥å‡å° å­¦ä¹ ç‡. æ ·æœ¬é›†æ¯”è¾ƒå°ï¼Œå°±æ²¡å¿…è¦ä½¿ç”¨ mini-batch. ç»éªŒå€¼ ï¼š å¦‚æœ m &lt;= 2000, å¯ä»¥ä½¿ç”¨ batchï¼Œ ä¸ç„¶æ ·æœ¬æ•°ç›® m è¾ƒå¤§ï¼Œä¸€èˆ¬ mini-batch å¤§å°è®¾ç½®ä¸º 64 or 128 or.. or 512.. ç®—æ³•åˆæ­¥ å¯¹æ•´ä¸ªè®­ç»ƒé›†è¿›è¡Œæ¢¯åº¦ä¸‹é™æ³•çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¿…é¡»å¤„ç†æ•´ä¸ªè®­ç»ƒæ•°æ®é›†ï¼Œç„¶åæ‰èƒ½è¿›è¡Œä¸€æ­¥æ¢¯åº¦ä¸‹é™ï¼Œå³æ¯ä¸€æ­¥æ¢¯åº¦ä¸‹é™æ³•éœ€è¦å¯¹æ•´ä¸ªè®­ç»ƒé›†è¿›è¡Œä¸€æ¬¡å¤„ç†ï¼Œå¦‚æœè®­ç»ƒæ•°æ®é›†å¾ˆå¤§çš„æ—¶å€™ï¼Œå¦‚æœ‰ 500ä¸‡ æˆ– 5000ä¸‡ çš„è®­ç»ƒæ•°æ®ï¼Œå¤„ç†é€Ÿåº¦å°±ä¼šæ¯”è¾ƒæ…¢ã€‚ ä½†æ˜¯å¦‚æœæ¯æ¬¡å¤„ç†è®­ç»ƒæ•°æ®çš„ä¸€éƒ¨åˆ†å³è¿›è¡Œæ¢¯åº¦ä¸‹é™æ³•ï¼Œåˆ™æˆ‘ä»¬çš„ç®—æ³•é€Ÿåº¦ä¼šæ‰§è¡Œçš„æ›´å¿«ã€‚è€Œå¤„ç†çš„è¿™äº›ä¸€å°éƒ¨åˆ†è®­ç»ƒå­é›†å³ç§°ä¸º Mini-batchã€‚ å¦‚å›¾ï¼Œä»¥ 1000 ä¸ºå•ä½ï¼Œå°†æ•°æ®åˆ’åˆ†ï¼Œä»¤ $x^{\\{1\\}}=\\{x^{(1)},x^{(2)}â€¦â€¦x^{(1000)}\\}$, ä¸€èˆ¬ç”¨ $x^{ \\{ t \\} }$, $y^{ \\{t\\} }$ è¡¨ç¤ºåˆ’åˆ†åçš„ mini-batch. æ³¨æ„åŒºåˆ†è¯¥ç³»åˆ—æ•™å­¦è§†é¢‘çš„ç¬¦å·æ ‡è®°ï¼š å°æ‹¬å·() è¡¨ç¤ºå…·ä½“çš„æŸä¸€ä¸ªå…ƒç´ ï¼ŒæŒ‡ä¸€ä¸ªå…·ä½“çš„å€¼ï¼Œä¾‹å¦‚ $x^{(i)}$ ä¸­æ‹¬å·[] è¡¨ç¤ºç¥ç»ç½‘ç»œä¸­çš„æŸä¸€å±‚, ä¾‹å¦‚ $Z^{[l]}$ å¤§æ‹¬å·{} è¡¨ç¤ºå°†æ•°æ®ç»†åˆ†åçš„ä¸€ä¸ªé›†åˆ, ä¾‹å¦‚ $x^{\\{1\\}} = \\{x^{(1)},x^{(2)}â€¦â€¦x^{(1000)}\\}$ ç®—æ³•æ ¸å¿ƒ å‡è®¾æˆ‘ä»¬æœ‰ 5,000,000 ä¸ªæ•°æ®ï¼Œæ¯ 1000 ä½œä¸ºä¸€ä¸ªé›†åˆï¼Œè®¡å…¥ä¸Šé¢æ‰€æåˆ°çš„ $x^{\\{1\\}}=\\{x^{(1)},x^{(2)}â€¦â€¦x^{(5000)}\\},â€¦â€¦$ éœ€è¦è¿­ä»£è¿è¡Œ 5000æ¬¡ ç¥ç»ç½‘ç»œè¿ç®—. æ¯ä¸€æ¬¡è¿­ä»£å…¶å®ä¸ä¹‹å‰ç¬”è®°ä¸­æ‰€æåˆ°çš„è®¡ç®—è¿‡ç¨‹ä¸€æ ·ï¼Œé¦–å…ˆæ˜¯å‰å‘ä¼ æ’­ï¼Œä½†æ˜¯æ¯æ¬¡è®¡ç®—çš„æ•°é‡æ˜¯ 1000. è®¡ç®—æŸå¤±å‡½æ•°ï¼Œå¦‚æœæœ‰ Regularization ï¼Œåˆ™è®°å¾—åŠ ä¸Š Regularization Item Backward propagation æ³¨æ„ï¼Œmini-batch ç›¸æ¯”äºä¹‹å‰ä¸€æ¬¡æ€§è®¡ç®—æ‰€æœ‰æ•°æ®ä¸ä»…é€Ÿåº¦å¿«ï¼Œè€Œä¸”åå‘ä¼ æ’­éœ€è¦è®¡ç®— 5000æ¬¡ï¼Œæ‰€ä»¥æ•ˆæœä¹Ÿæ›´å¥½. epoch å¯¹äºæ™®é€šçš„æ¢¯åº¦ä¸‹é™æ³•ï¼Œä¸€ä¸ª epoch åªèƒ½è¿›è¡Œä¸€æ¬¡æ¢¯åº¦ä¸‹é™ï¼› å¯¹äº Mini-batch æ¢¯åº¦ä¸‹é™æ³•ï¼Œä¸€ä¸ª epoch å¯ä»¥è¿›è¡Œ Mini-batch çš„ä¸ªæ•°æ¬¡æ¢¯åº¦ä¸‹é™; epoch : å½“ä¸€ä¸ªå®Œæ•´çš„æ•°æ®é›†é€šè¿‡äº†ç¥ç»ç½‘ç»œä¸€æ¬¡å¹¶ä¸”è¿”å›äº†ä¸€æ¬¡ï¼Œè¿™ä¸ªè¿‡ç¨‹ç§°ä¸ºä¸€ä¸ª epochã€‚ æ¯”å¦‚å¯¹äºä¸€ä¸ªæœ‰ 2000 ä¸ªè®­ç»ƒæ ·æœ¬çš„æ•°æ®é›†ã€‚å°† 2000 ä¸ªæ ·æœ¬åˆ†æˆå¤§å°ä¸º 500 çš„ batchï¼Œé‚£ä¹ˆå®Œæˆä¸€ä¸ª epoch éœ€è¦ 4 ä¸ª iterationã€‚ ä¸åŒ size å¤§å°çš„æ¯”è¾ƒæ™®é€šçš„ batch æ¢¯åº¦ä¸‹é™æ³• å’Œ Mini-batchæ¢¯åº¦ä¸‹é™æ³• ä»£ä»·å‡½æ•°çš„å˜åŒ–è¶‹åŠ¿ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š Batchæ¢¯åº¦ä¸‹é™ ï¼ˆå¦‚ä¸‹å›¾ä¸­è“è‰²ï¼‰: å¯¹æ‰€æœ‰ m ä¸ªè®­ç»ƒæ ·æœ¬æ‰§è¡Œä¸€æ¬¡æ¢¯åº¦ä¸‹é™ï¼Œæ¯ä¸€æ¬¡è¿­ä»£æ—¶é—´è¾ƒé•¿ï¼› Cost function æ€»æ˜¯å‘å‡å°çš„æ–¹å‘ä¸‹é™ã€‚ è¯´æ˜: mini-batch size = mï¼Œæ­¤æ—¶å³ä¸º Batch gradient descent $(x^,y^)=(X,Y)$ éšæœºæ¢¯åº¦ä¸‹é™ ï¼ˆå¦‚ä¸‹å›¾ä¸­ç´«è‰²ï¼‰: -å¯¹æ¯ä¸€ä¸ªè®­ç»ƒæ ·æœ¬æ‰§è¡Œä¸€æ¬¡æ¢¯åº¦ä¸‹é™ï¼Œä½†æ˜¯ä¸¢å¤±äº†å‘é‡åŒ–å¸¦æ¥çš„è®¡ç®—åŠ é€Ÿï¼› Cost function æ€»ä½“çš„è¶‹åŠ¿å‘æœ€å°å€¼çš„æ–¹å‘ä¸‹é™ï¼Œä½†æ˜¯æ— æ³•åˆ°è¾¾å…¨å±€æœ€å°å€¼ç‚¹ï¼Œå‘ˆç°æ³¢åŠ¨çš„å½¢å¼. è¯´æ˜: mini-batch size = 1ï¼Œæ­¤æ—¶å³ä¸º Stochastic gradient descent $(x^{\\{t\\}},y^{\\{t\\}})=(x^{(i)},y^{(i)})$ Mini-batchæ¢¯åº¦ä¸‹é™ ï¼ˆå¦‚ä¸‹å›¾ä¸­ç»¿è‰²ï¼‰: é€‰ä¸€ä¸ª $1&lt;size&lt;m$ çš„åˆé€‚çš„ size è¿›è¡Œ Mini-batch æ¢¯åº¦ä¸‹é™ï¼Œå¯å®ç°å¿«é€Ÿå­¦ä¹ ï¼Œä¹Ÿåº”ç”¨äº†å‘é‡åŒ–å¸¦æ¥çš„å¥½å¤„ Cost function çš„ä¸‹é™å¤„äºå‰ä¸¤è€…ä¹‹é—´ Mini-batch å¤§å°çš„é€‰æ‹© å¦‚æœè®­ç»ƒæ ·æœ¬çš„å¤§å°æ¯”è¾ƒå°æ—¶ï¼Œå¦‚ $mâ©½2000$ æ—¶ â€” é€‰æ‹© batch æ¢¯åº¦ä¸‹é™æ³•ï¼› å¦‚æœè®­ç»ƒæ ·æœ¬çš„å¤§å°æ¯”è¾ƒå¤§æ—¶ï¼Œå…¸å‹çš„å¤§å°ä¸ºï¼š$2^{6}ã€2^{7}ã€\\cdotsã€2^{10}$ Mini-batch çš„å¤§å°è¦ç¬¦åˆ CPU/GPU å†…å­˜ï¼Œ è¿ç®—èµ·æ¥ä¼šæ›´å¿«ä¸€äº›. 2. Exponentially weighted averagesä¸ºäº†ç†è§£åé¢ä¼šæåˆ°çš„å„ç§ä¼˜åŒ–ç®—æ³•ï¼Œæˆ‘ä»¬éœ€è¦ç”¨åˆ°æŒ‡æ•°åŠ æƒå¹³å‡ï¼Œåœ¨ç»Ÿè®¡å­¦ä¸­ä¹Ÿå«åšæŒ‡æ•°åŠ æƒç§»åŠ¨å¹³å‡. æŒ‡æ•°åŠ æƒå¹³å‡çš„å…³é”®å‡½æ•°ï¼š v\\_{t} = \\beta v\\_{t-1}+(1-\\beta)\\theta\\_{t}é¦–å…ˆæˆ‘ä»¬å‡è®¾æœ‰ä¸€å¹´çš„æ¸©åº¦æ•°æ®ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤º æˆ‘ä»¬ç°åœ¨éœ€è¦è®¡ç®—å‡ºä¸€ä¸ªæ¸©åº¦è¶‹åŠ¿æ›²çº¿ï¼Œè®¡ç®—æ–¹æ³•(æŒ‡æ•°åŠ æƒå¹³å‡å®ç°)å¦‚ä¸‹ï¼š v\\_{0} =0 \\\\\\\\ v\\_{1}= \\beta v\\_{0}+(1-\\beta)\\theta\\_{1} \\\\\\\\ v\\_{2}= \\beta v\\_{1}+(1-\\beta)\\theta\\_{2} \\\\\\\\ v\\_{3}= \\beta v\\_{2}+(1-\\beta)\\theta\\_{3} \\\\\\\\ \\ldots ä¸Šé¢çš„ $Î¸_t$ è¡¨ç¤ºç¬¬ $t$ å¤©çš„æ¸©åº¦ï¼ŒÎ² æ˜¯å¯è°ƒèŠ‚çš„å‚æ•°ï¼Œ$V_t$ è¡¨ç¤º $\\frac{1}{1-Î²}$ å¤©çš„æ¯æ—¥æ¸©åº¦ å½“ Î²=0.9ã€0.98ã€0.5 çš„æƒ…å†µå½“ Î²=0.9 æ—¶ï¼ŒæŒ‡æ•°åŠ æƒå¹³å‡æœ€åçš„ç»“æœå¦‚ä¸‹å›¾ä¸­çº¢è‰²çº¿æ‰€ç¤ºï¼› å½“ Î²=0.98 æ—¶ï¼ŒæŒ‡æ•°åŠ æƒå¹³å‡æœ€åçš„ç»“æœå¦‚ä¸‹å›¾ä¸­ç»¿è‰²çº¿æ‰€ç¤º, ç»¿çº¿ç›¸æ¯”è¾ƒçº¢çº¿è¦å¹³æ»‘ä¸€äº›ï¼Œæ˜¯å› ä¸ºå¯¹è¿‡å»æ¸©åº¦çš„æƒé‡æ›´å¤§ï¼Œæ‰€ä»¥å½“å¤©å¤©æ°”æ¸©åº¦çš„å½±å“é™ä½ï¼Œåœ¨æ¸©åº¦å˜åŒ–æ—¶ï¼Œé€‚åº”å¾—æ›´ç¼“æ…¢ä¸€äº›ï¼› å½“ Î²=0.5 æ—¶ï¼ŒæŒ‡æ•°åŠ æƒå¹³å‡æœ€åçš„ç»“æœå¦‚ä¸‹å›¾ä¸­é»„è‰²çº¿æ‰€ç¤ºï¼› Notes: The most common value for $\\beta$ is 0.9. ç†è§£æŒ‡æ•°åŠ æƒå¹³å‡ä¾‹å­ï¼Œå½“ Î²=0.9 æ—¶ï¼š v\\_{100} = 0.9v\\_{99}+0.1\\theta\\_{100} \\\\\\\\ v\\_{99} = 0.9v\\_{98}+0.1\\theta\\_{99} \\\\\\\\ v\\_{98} = 0.9v\\_{97}+0.1\\theta\\_{98} \\\\\\\\ \\ldotså±•å¼€ï¼š v\\_{100}=0.1\\theta\\_{100}+0.9(0.1\\theta\\_{99}+0.9(0.1\\theta\\_{98}+0.9v\\_{97})) \\\\\\\\ v\\_{100}=0.1\\theta\\_{100}+0.1\\times0.9\\theta\\_{99}+0.1\\times(0.9)^{2}\\theta\\_{98}+0.1\\times(0.9)^{3}\\theta\\_{97}+\\cdotsä¸Šå¼ä¸­æ‰€æœ‰ $Î¸$ å‰é¢çš„ç³»æ•°ç›¸åŠ èµ·æ¥ä¸º 1 æˆ–è€… æ¥è¿‘äº 1ï¼Œç§°ä¹‹ä¸ºåå·®ä¿®æ­£. æ€»ä½“æ¥è¯´å­˜åœ¨ï¼Œ$(1-\\varepsilon)^{1/\\varepsilon}=\\dfrac{1}{e}$, åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œ$1-\\varepsilon=\\beta=0.9$, å³ $0.9^{10}\\approx 0.35\\approx\\dfrac{1}{e}$ . ç›¸å½“äºå¤§çº¦10å¤©åï¼Œç³»æ•°çš„å³°å€¼ï¼ˆè¿™é‡Œæ˜¯0.1ï¼‰ä¸‹é™åˆ°åŸæ¥çš„ $\\dfrac{1}{e}$ï¼Œåªå…³æ³¨äº†è¿‡å»10å¤©çš„å¤©æ°”. æŒ‡æ•°åŠ æƒå¹³å‡çš„åå·®ä¿®æ­£ Bias correctionåœ¨æˆ‘ä»¬æ‰§è¡ŒæŒ‡æ•°åŠ æƒå¹³å‡çš„å…¬å¼æ—¶ï¼Œå½“ Î²=0.98 æ—¶ï¼Œå¾—åˆ°çš„å¹¶ä¸æ˜¯å›¾ä¸­çš„ç»¿è‰²æ›²çº¿ï¼Œè€Œæ˜¯ä¸‹å›¾ä¸­çš„ç´«è‰²æ›²çº¿ï¼Œå…¶èµ·ç‚¹æ¯”è¾ƒä½ã€‚ åŸå› ï¼š v\\_{0}=0\\\\\\\\v\\_{1}=0.98v\\_{0}+0.02\\theta\\_{1}=0.02\\theta\\_{1}\\\\\\\\v\\_{2}=0.98v\\_{1}+0.02\\theta\\_{2}=0.98\\times0.02\\theta\\_{1}+0.02\\theta\\_{2}=0.0196\\theta\\_{1}+0.02\\theta\\_{2}å¦‚æœç¬¬ä¸€å¤©çš„å€¼ä¸ºå¦‚40ï¼Œåˆ™å¾—åˆ°çš„ v1=0.02Ã—40=0.8ï¼Œåˆ™å¾—åˆ°çš„å€¼è¦è¿œå°äºå®é™…å€¼ï¼Œåé¢å‡ å¤©çš„æƒ…å†µä¹Ÿä¼šç”±äºåˆå€¼å¼•èµ·çš„å½±å“ï¼Œå‡ä½äºå®é™…å‡å€¼. åå·®ä¿®æ­£ï¼š ä½¿ç”¨ $\\dfrac{v_{t}}{1-\\beta^{t}}$ å½“ t=2 æ—¶ï¼š 1-\\beta^{t}=1-(0.98)^{2}=0.0396 \\dfrac{v\\_{2}}{0.0396}=\\dfrac{0.0196\\theta\\_{1}+0.02\\theta\\_{2}}{0.0396}åå·®ä¿®æ­£å¾—åˆ°äº†ç»¿è‰²çš„æ›²çº¿ï¼Œåœ¨å¼€å§‹çš„æ—¶å€™ï¼Œèƒ½å¤Ÿå¾—åˆ°æ¯”ç´«è‰²æ›²çº¿æ›´å¥½çš„è®¡ç®—å¹³å‡çš„æ•ˆæœã€‚éšç€ t é€æ¸å¢å¤§ï¼Œ$\\beta^{t}$ æ¥è¿‘äº 0ï¼Œæ‰€ä»¥åé¢ç»¿è‰²çš„æ›²çº¿å’Œç´«è‰²çš„æ›²çº¿é€æ¸é‡åˆäº†. è™½ç„¶å­˜åœ¨è¿™ç§é—®é¢˜ï¼Œä½†æ˜¯åœ¨å®é™…è¿‡ç¨‹ä¸­ï¼Œä¸€èˆ¬ä¼šå¿½ç•¥å‰æœŸå‡å€¼åå·®çš„å½±å“ åå·®ä¿®æ­£ ä¸¾ä¸ªğŸŒ°, ä»¥ä¾¿äºå¤§å®¶ç†è§£: é¦–å…ˆæˆ‘ä»¬å‡è®¾çš„æ˜¯ $Î²=0.98, V_0=0$, ç„¶åç”± $V_t=Î²V_{t-1}+(1-Î²)Î¸_t$ å¯çŸ¥ $V_1=0.98V_0+0.02Î¸_1=0.02Î¸_1$ $V_2=0.98V_1+0.02Î¸_2=0.0196Î¸_1+0.02Î¸_2$ å½“è¿›è¡ŒæŒ‡æ•°åŠ æƒå¹³å‡è®¡ç®—æ—¶ï¼Œç¬¬ä¸€ä¸ªå€¼ $v_0$ è¢«åˆå§‹åŒ–ä¸º 0ï¼Œè¿™æ ·å°†åœ¨å‰æœŸçš„è¿ç®—ç”¨äº§ç”Ÿä¸€å®šçš„åå·®ã€‚ä¸ºäº†çŸ«æ­£åå·®ï¼Œéœ€è¦åœ¨æ¯ä¸€æ¬¡è¿­ä»£åè¿›è¡Œåå·®ä¿®æ­£ï¼ˆBias Correctionï¼‰ å‡è®¾ $Î¸_1=40â„ƒ$,é‚£ä¹ˆ $V_1=0.02*40=0.8â„ƒ$ï¼Œè¿™æ˜¾ç„¶ç›¸å·®å¤ªå¤§ï¼ŒåŒç†å¯¹äºåé¢çš„æ¸©åº¦çš„è®¡ç®—ä¹Ÿåªä¼šæ˜¯å˜å·®è¶Šæ¥è¶Šå¤§. æ‰€ä»¥æˆ‘ä»¬éœ€è¦è¿›è¡Œåå·®ä¿®æ­£ï¼Œå…·ä½“æ–¹æ³•å¦‚ä¸‹ï¼š V\\_t=\\frac{Î²V\\_{t-1}+(1-Î²)Î¸\\_t}{1-Î²^t}æ³¨æ„ ï¼šï¼ï¼ï¼ä¸Šé¢å…¬å¼ä¸­çš„ $V_{t-1}$ æ˜¯æœªä¿®æ­£çš„å€¼. ä¸ºæ–¹ä¾¿è¯´æ˜ï¼Œä»¤ $Î²=0.98,Î¸_1=40â„ƒ,Î¸_2=39â„ƒ$, åˆ™ å½“ $t=1,Î¸_1=40â„ƒ$ æ—¶ï¼Œ$V_1=\\frac{0.02*40}{1-0.98}=40$ ,å“‡å“¦, æœ‰æ²¡æœ‰å¾ˆå·§çš„æ„Ÿè§‰ï¼Œå†çœ‹ å½“ $t=2,Î¸_2=39â„ƒ$ æ—¶ï¼Œ$V_2 = \\frac{0.98*V_{t-1} + 0.02*Î¸_2}{1-0.98^2}$ $=\\frac{0.98*(0 + 0.02*Î¸_1)+0.02*39}{1-0.98^2}=39.49$ æ³¨æ„ç‚¹ : æ‰€ä»¥ï¼Œè®°ä½ä½ å¦‚æœç›´æ¥ç”¨ä¿®æ­£åçš„ $V_{tâˆ’1}$ å€¼ä»£å…¥è®¡ç®—å°±å¤§é”™ç‰¹é”™äº†. 3. MomentumåŠ¨é‡æ¢¯åº¦ä¸‹é™çš„åŸºæœ¬æ€æƒ³å°±æ˜¯è®¡ç®—æ¢¯åº¦çš„æŒ‡æ•°åŠ æƒå¹³å‡æ•°ï¼Œå¹¶åˆ©ç”¨è¯¥æ¢¯åº¦æ¥æ›´æ–°æƒé‡ Momentum è§£é‡Šç‰ˆé€šå¸¸æƒ…å†µæˆ‘ä»¬åœ¨è®­ç»ƒæ·±åº¦ç¥ç»ç½‘ç»œçš„æ—¶å€™æŠŠæ•°æ®æ‹†è§£æˆä¸€å°æ‰¹ä¸€å°æ‰¹åœ°è¿›è¡Œè®­ç»ƒï¼Œè¿™å°±æ˜¯æˆ‘ä»¬å¸¸ç”¨çš„ mini-batch SGD è®­ç»ƒç®—æ³•ï¼Œç„¶è€Œè™½ç„¶è¿™ç§ç®—æ³•èƒ½å¤Ÿå¸¦æ¥å¾ˆå¥½çš„è®­ç»ƒé€Ÿåº¦ï¼Œä½†æ˜¯åœ¨åˆ°è¾¾æœ€ä¼˜ç‚¹çš„æ—¶å€™å¹¶ä¸èƒ½å¤Ÿæ€»æ˜¯çœŸæ­£åˆ°è¾¾æœ€ä¼˜ç‚¹ï¼Œè€Œæ˜¯åœ¨æœ€ä¼˜ç‚¹é™„è¿‘å¾˜å¾Šã€‚å¦ä¸€ä¸ªç¼ºç‚¹å°±æ˜¯è¿™ç§ç®—æ³•éœ€è¦æˆ‘ä»¬æŒ‘é€‰ä¸€ä¸ªåˆé€‚çš„å­¦ä¹ ç‡ï¼Œå½“æˆ‘ä»¬é‡‡ç”¨å°çš„å­¦ä¹ ç‡çš„æ—¶å€™ï¼Œä¼šå¯¼è‡´ç½‘ç»œåœ¨è®­ç»ƒçš„æ—¶å€™æ”¶æ•›å¤ªæ…¢ï¼›å½“æˆ‘ä»¬é‡‡ç”¨å¤§çš„å­¦ä¹ ç‡çš„æ—¶å€™ï¼Œä¼šå¯¼è‡´åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ä¼˜åŒ–çš„å¹…åº¦è·³è¿‡å‡½æ•°çš„èŒƒå›´ï¼Œä¹Ÿå°±æ˜¯å¯èƒ½è·³è¿‡æœ€ä¼˜ç‚¹ã€‚æˆ‘ä»¬æ‰€å¸Œæœ›çš„ä»…ä»…æ˜¯ç½‘ç»œåœ¨ä¼˜åŒ–çš„æ—¶å€™ç½‘ç»œçš„æŸå¤±å‡½æ•°æœ‰ä¸€ä¸ªå¾ˆå¥½çš„æ”¶æ•›é€Ÿåº¦åŒæ—¶åˆä¸è‡³äºæ‘†åŠ¨å¹…åº¦å¤ªå¤§ã€‚ æ‰€ä»¥ Momentum ä¼˜åŒ–å™¨ åˆšå¥½å¯ä»¥è§£å†³æˆ‘ä»¬æ‰€é¢ä¸´çš„é—®é¢˜ï¼Œå®ƒä¸»è¦æ˜¯åŸºäºæ¢¯åº¦çš„ç§»åŠ¨æŒ‡æ•°åŠ æƒå¹³å‡ã€‚å‡è®¾åœ¨å½“å‰çš„è¿­ä»£æ­¥éª¤ç¬¬ t æ­¥ä¸­ï¼Œé‚£ä¹ˆåŸºäº Momentum ä¼˜åŒ–ç®—æ³• å¯ä»¥å†™æˆä¸‹é¢çš„å…¬å¼ï¼š {v\\_\\{dw\\}} = \\beta {v\\_\\{dw\\}} + (1 - \\beta )dW \\\\\\\\ {v\\_{db}} = \\beta {v\\_{db}} + (1 - \\beta )db \\\\\\\\ W = W - \\alpha {v\\_{dw}} \\\\\\\\ b = b - \\alpha {v\\_{db}} å¼•ç”¨çŸ¥ä¹æœºå™¨å­¦ä¹ å°èœé¸Ÿçš„æµæ°´è´¦ ï¼š åŠ¨é‡æ¢¯åº¦ä¸‹é™ä¸æ¢¯åº¦ä¸‹é™ç›¸æ¯”ï¼Œå°±æ˜¯å¯¹æ¢¯åº¦ä½¿ç”¨æŒ‡æ•°åŠ æƒå¹³å‡ï¼Œå…¶ä»–çš„éƒ½ä¿å­˜ä¸€è‡´ã€‚ dw ä¸ db è¡¨ç¤ºæœ¬æ¬¡è¿­ä»£çš„æ¢¯åº¦ï¼ŒVdw å’Œ Vdb è¡¨ç¤ºæŒ‡æ•°åŠ æƒå¹³å‡çš„æ¢¯åº¦ã€‚ å¦‚æœä¸ç”¨æŒ‡æ•°åŠ æƒå¹³å‡çš„è¯ï¼Œæ¯æ¬¡è¿­ä»£æ›´æ–°ä½¿ç”¨çš„æ¢¯åº¦éƒ½åªä¸æœ¬æ¬¡è¿­ä»£çš„æ ·æœ¬æœ‰å…³ï¼Œæ¯æ¬¡è¿­ä»£çš„æ ·æœ¬æœ‰å¥½æœ‰åï¼Œä¼šä½¿è¿­ä»£æ¥è¿‘æœ€å°å€¼çš„ä¸æ–­æ³¢åŠ¨ï¼Œå¯¼è‡´ä¸‹é™é€Ÿåº¦æ…¢ã€‚åŠ å…¥æŒ‡æ•°åŠ æƒå¹³å‡åï¼Œæœ¬æ¬¡æ¢¯åº¦å½±å“å‡å°‘ï¼Œæ³¢åŠ¨æƒ…å†µä¹Ÿå°±ä¼šå‡å°ï¼Œç›´è§‚ä¸Šé¢ç†è§£å°±æ˜¯å·¦å³æ³¢åŠ¨æŠµæ¶ˆï¼Œé‚£ä¹ˆä¸‹é™é€Ÿåº¦ä¹Ÿå°±è‡ªç„¶æ›´å¿«ã€‚åŠ¨é‡æ¢¯åº¦ä¸‹é™æ¯”æ¢¯åº¦ä¸‹é™æ”¶æ•›é€Ÿåº¦è¦å¿«ã€‚ ç‰©ç†æ„ä¹‰ç†è§£ï¼šåœ¨ä¸‹é™çš„è¿‡ç¨‹ä¸­ï¼Œ $(1 - \\beta )dW$ ç›¸å½“äºåŠ é€Ÿåº¦ï¼Œ $\\beta {v_{dw}}$ ç›¸å½“äºæ‘©æ“¦ï¼ŒåŠ é€Ÿåº¦å¯ä»¥æ˜¯ä¸‹é™åŠ å¿«ï¼Œè€Œæ‘©æ“¦ä¸ä¼šè®©åŠ é€Ÿä¸€ç›´è¿›è¡Œä¸‹å»ã€‚ï¼ˆä¸æ˜¯å¾ˆç†è§£ï¼‰ åœ¨ä¸Šé¢çš„å…¬å¼ä¸­ ${v_{dw}}$ å’Œ ${v_{db}}$ åˆ†åˆ«æ˜¯æŸå¤±å‡½æ•°åœ¨å‰ $tâˆ’1$ è½®è¿­ä»£è¿‡ç¨‹ä¸­ç´¯ç§¯çš„æ¢¯åº¦æ¢¯åº¦åŠ¨é‡ï¼Œ$\\beta$ æ˜¯æ¢¯åº¦ç´¯ç§¯çš„ä¸€ä¸ªæŒ‡æ•°ï¼Œè¿™é‡Œæˆ‘ä»¬ä¸€èˆ¬è®¾ç½®å€¼ä¸º 0.9ã€‚æ‰€ä»¥ Momentum ä¼˜åŒ–å™¨ çš„ä¸»è¦æ€æƒ³å°±æ˜¯åˆ©ç”¨äº†ç±»ä¼¼ä¸ç§»åŠ¨æŒ‡æ•°åŠ æƒå¹³å‡çš„æ–¹æ³•æ¥å¯¹ç½‘ç»œçš„å‚æ•°è¿›è¡Œå¹³æ»‘å¤„ç†çš„ï¼Œè®©æ¢¯åº¦çš„æ‘†åŠ¨å¹…åº¦å˜å¾—æ›´å°ã€‚ dW å’Œ db åˆ†åˆ«æ˜¯æŸå¤±å‡½æ•°åå‘ä¼ æ’­æ—¶å€™æ‰€æ±‚å¾—çš„æ¢¯åº¦ï¼Œä¸‹é¢ä¸¤ä¸ªå…¬å¼æ˜¯ç½‘ç»œæƒé‡å‘é‡å’Œåç½®å‘é‡çš„æ›´æ–°å…¬å¼ï¼ŒÎ± æ˜¯ç½‘ç»œçš„å­¦ä¹ ç‡ã€‚å½“æˆ‘ä»¬ä½¿ç”¨ Momentumä¼˜åŒ–ç®—æ³•çš„æ—¶å€™ï¼Œå¯ä»¥è§£å†³ mini-batch SGD ä¼˜åŒ–ç®—æ³•æ›´æ–°å¹…åº¦æ‘†åŠ¨å¤§çš„é—®é¢˜ï¼ŒåŒæ—¶å¯ä»¥ä½¿å¾—ç½‘ç»œçš„æ”¶æ•›é€Ÿåº¦æ›´å¿«ã€‚ Momentum è¯¦ç»†ç‰ˆåœ¨æˆ‘ä»¬ä¼˜åŒ– Cost function çš„æ—¶å€™ï¼Œä»¥ä¸‹å›¾æ‰€ç¤ºçš„å‡½æ•°å›¾ä¸ºä¾‹ï¼š é¦–å…ˆä»‹ç»ä¸€ä¸‹ä¸€èˆ¬çš„æ¢¯åº¦ç®—æ³•æ”¶æ•›æƒ…å†µæ˜¯è¿™æ ·çš„ å¯ä»¥çœ‹åˆ°ï¼Œåœ¨å‰è¿›çš„é“è·¯ä¸Šååˆ†æ›²æŠ˜ï¼Œèµ°äº†ä¸å°‘å¼¯è·¯ï¼Œåœ¨çºµå‘æˆ‘ä»¬å¸Œæœ›èµ°å¾—æ…¢ä¸€ç‚¹ï¼Œæ¨ªå‘åˆ™å¸Œæœ›èµ°å¾—å¿«ä¸€ç‚¹ï¼Œæ‰€ä»¥æ‰æœ‰äº†åŠ¨é‡æ¢¯åº¦ä¸‹é™ç®—æ³•. Momentumç®—æ³•çš„ç¬¬ t æ¬¡è¿­ä»£ï¼š è®¡ç®—å‡º dw, db è¿™ä¸ªè®¡ç®—å¼å­ä¸ä¸Šä¸€å±Šæåˆ°çš„æŒ‡æ•°åŠ æƒå¹³å‡æœ‰ç‚¹ç±»ä¼¼ï¼Œå³$ V_{dw}=Î²V_{dw}+(1-Î²)dw \\\\ V_{db}=Î²V_{db}+(1-Î²)db $ $W=W-Î±V_{dw},b=b-Î±V_{db}$ æœ€ç»ˆå¾—åˆ°æ”¶æ•›çš„æ•ˆæœå¦‚ä¸‹å›¾çš„çº¢è‰²æ›²çº¿æ‰€ç¤º. åœ¨åˆ©ç”¨æ¢¯åº¦ä¸‹é™æ³•æ¥æœ€å°åŒ–è¯¥å‡½æ•°çš„æ—¶å€™ï¼Œæ¯ä¸€æ¬¡è¿­ä»£æ‰€æ›´æ–°çš„ä»£ä»·å‡½æ•°å€¼å¦‚å›¾ä¸­è“è‰²çº¿æ‰€ç¤ºåœ¨ä¸Šä¸‹æ³¢åŠ¨ï¼Œè€Œè¿™ç§å¹…åº¦æ¯”è¾ƒå¤§æ³¢åŠ¨ï¼Œå‡ç¼“äº†æ¢¯åº¦ä¸‹é™çš„é€Ÿåº¦ï¼Œè€Œä¸”æˆ‘ä»¬åªèƒ½ä½¿ç”¨ä¸€ä¸ªè¾ƒå°çš„å­¦ä¹ ç‡æ¥è¿›è¡Œè¿­ä»£. å¦‚æœç”¨è¾ƒå¤§çš„å­¦ä¹ ç‡ï¼Œç»“æœå¯èƒ½ä¼šå¦‚ç´«è‰²çº¿ä¸€æ ·åç¦»å‡½æ•°çš„èŒƒå›´ï¼Œæ‰€ä»¥ä¸ºäº†é¿å…è¿™ç§æƒ…å†µï¼Œåªèƒ½ç”¨è¾ƒå°çš„å­¦ä¹ ç‡. è¯¥ç®—æ³•ä¸­æ¶‰åŠåˆ°çš„è¶…å‚æ•°æœ‰ä¸¤ä¸ªï¼Œåˆ†åˆ«æ˜¯ Î±ï¼ŒÎ²ï¼Œå…¶ä¸­ä¸€èˆ¬ Î²=0.9 æ˜¯æ¯”è¾ƒå¸¸å–çš„å€¼ ä¸€èˆ¬å°†å‚æ•°è®¾ä¸º 0.5, 0.9ï¼Œæˆ–è€… 0.99ï¼Œåˆ†åˆ«è¡¨ç¤ºæœ€å¤§é€Ÿåº¦ 2å€ï¼Œ10å€ï¼Œ100å€ äº SGD çš„ç®—æ³•; é€šè¿‡é€Ÿåº¦vï¼Œæ¥ç§¯ç´¯äº†ä¹‹é—´æ¢¯åº¦æŒ‡æ•°çº§è¡°å‡çš„å¹³å‡ï¼Œå¹¶ä¸”ç»§ç»­å»¶è¯¥æ–¹å‘ç§»åŠ¨; å†çœ‹çœ‹ç®—æ³•ï¼š 4. RMSprop (Root Mean Square Prop)RMSProp ç®—æ³•çš„å…¨ç§°å« Root Mean Square Propï¼Œæ˜¯ Geoffrey E. Hinton åœ¨ Coursera è¯¾ç¨‹ä¸­æå‡ºçš„ä¸€ç§ä¼˜åŒ–ç®—æ³•ï¼Œåœ¨ä¸Šé¢çš„ Momentum ä¼˜åŒ–ç®—æ³•ä¸­ï¼Œè™½ç„¶åˆæ­¥è§£å†³äº†ä¼˜åŒ–ä¸­æ‘†åŠ¨å¹…åº¦å¤§çš„é—®é¢˜ã€‚æ‰€è°“çš„æ‘†åŠ¨å¹…åº¦å°±æ˜¯åœ¨ä¼˜åŒ–ä¸­ç»è¿‡æ›´æ–°ä¹‹åå‚æ•°çš„å˜åŒ–èŒƒå›´ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œè“è‰²çš„ä¸º Momentum ä¼˜åŒ–ç®—æ³•æ‰€èµ°çš„è·¯çº¿ï¼Œç»¿è‰²çš„ä¸º RMSProp ä¼˜åŒ–ç®—æ³•æ‰€èµ°çš„è·¯çº¿ã€‚ ä¸ºäº†è¿›ä¸€æ­¥ä¼˜åŒ–æŸå¤±å‡½æ•°åœ¨æ›´æ–°ä¸­å­˜åœ¨æ‘†åŠ¨å¹…åº¦è¿‡å¤§çš„é—®é¢˜ï¼Œå¹¶ä¸”è¿›ä¸€æ­¥åŠ å¿«å‡½æ•°çš„æ”¶æ•›é€Ÿåº¦ï¼ŒRMSProp ç®—æ³•å¯¹æƒé‡ W å’Œåç½® b çš„æ¢¯åº¦ä½¿ç”¨äº†å¾®åˆ†å¹³æ–¹åŠ æƒå¹³å‡æ•°ã€‚ å…¶ä¸­ï¼Œå‡è®¾åœ¨ç¬¬ t è½®è¿­ä»£è¿‡ç¨‹ä¸­ï¼Œå„ä¸ªå…¬å¼å¦‚ä¸‹æ‰€ç¤ºï¼š {s\\_{dw}} = \\beta {s\\_{dw}} + (1 - \\beta )d{W^2} \\\\\\\\ {s\\_{db}} = \\beta {s\\_{db}} + (1 - \\beta )d{b^2} W = W - \\alpha \\frac {dW} { \\sqrt {s\\_{dw}} + \\varepsilon } \\\\\\\\ b = b - \\alpha \\frac {db} { \\sqrt{s\\_{db}} + \\varepsilon } è¿™æ ·åšï¼Œèƒ½ç»™ä¿ç•™å¾®åˆ†å¹³æ–¹çš„åŠ æƒå¹³å‡æ•° ç®—æ³•çš„ä¸»è¦æ€æƒ³å°±ç”¨ä¸Šé¢çš„å…¬å¼è¡¨è¾¾å®Œæ¯•äº†ã€‚åœ¨ä¸Šé¢çš„å…¬å¼ä¸­ ${s_{dw}}$ å’Œ ${s_{db}}$ åˆ†åˆ«æ˜¯æŸå¤±å‡½æ•°åœ¨å‰ tâˆ’1 è½®è¿­ä»£è¿‡ç¨‹ä¸­ç´¯ç§¯çš„æ¢¯åº¦æ¢¯åº¦åŠ¨é‡ï¼ŒÎ² æ˜¯æ¢¯åº¦ç´¯ç§¯çš„ä¸€ä¸ªæŒ‡æ•°ã€‚æ‰€ä¸åŒçš„æ˜¯ï¼ŒRMSProp ç®—æ³•å¯¹æ¢¯åº¦è®¡ç®—äº†å¾®åˆ†å¹³æ–¹åŠ æƒå¹³å‡æ•°ã€‚è¿™ç§åšæ³•æœ‰åˆ©äºæ¶ˆé™¤äº†æ‘†åŠ¨å¹…åº¦å¤§çš„æ–¹å‘ï¼Œç”¨æ¥ä¿®æ­£æ‘†åŠ¨å¹…åº¦ï¼Œä½¿å¾—å„ä¸ªç»´åº¦çš„æ‘†åŠ¨å¹…åº¦éƒ½è¾ƒå°ã€‚å¦ä¸€æ–¹é¢ä¹Ÿä½¿å¾—ç½‘ç»œå‡½æ•°æ”¶æ•›æ›´å¿«ã€‚ï¼ˆæ¯”å¦‚å½“ dW æˆ–è€… db ä¸­æœ‰ä¸€ä¸ªå€¼æ¯”è¾ƒå¤§çš„æ—¶å€™ï¼Œé‚£ä¹ˆæˆ‘ä»¬åœ¨æ›´æ–°æƒé‡æˆ–è€…åç½®çš„æ—¶å€™é™¤ä»¥å®ƒä¹‹å‰ç´¯ç§¯çš„æ¢¯åº¦çš„å¹³æ–¹æ ¹ï¼Œè¿™æ ·å°±å¯ä»¥ä½¿å¾—æ›´æ–°å¹…åº¦å˜å°ï¼‰ã€‚ä¸ºäº†é˜²æ­¢åˆ†æ¯ä¸ºé›¶ï¼Œä½¿ç”¨äº†ä¸€ä¸ªå¾ˆå°çš„æ•°å€¼ $\\epsilon$ æ¥è¿›è¡Œå¹³æ»‘ï¼Œä¸€èˆ¬å–å€¼ä¸º $10^{-8}$ã€‚ 5. Adam (Adaptive Moment Estimation)æœ‰äº†ä¸Šé¢ä¸¤ç§ä¼˜åŒ–ç®—æ³•ï¼Œä¸€ç§å¯ä»¥ä½¿ç”¨ç±»ä¼¼äºç‰©ç†ä¸­çš„åŠ¨é‡æ¥ç´¯ç§¯æ¢¯åº¦ï¼Œå¦ä¸€ç§å¯ä»¥ä½¿å¾—æ”¶æ•›é€Ÿåº¦æ›´å¿«åŒæ—¶ä½¿å¾—æ³¢åŠ¨çš„å¹…åº¦æ›´å°ã€‚é‚£ä¹ˆè®²ä¸¤ç§ç®—æ³•ç»“åˆèµ·æ¥æ‰€å–å¾—çš„è¡¨ç°ä¸€å®šä¼šæ›´å¥½ã€‚Adamï¼ˆAdaptive Moment Estimationï¼‰ç®—æ³•æ˜¯å°† Momentumç®—æ³• å’Œ RMSPropç®—æ³• ç»“åˆèµ·æ¥ä½¿ç”¨çš„ä¸€ç§ç®—æ³•ï¼Œæˆ‘ä»¬æ‰€ä½¿ç”¨çš„å‚æ•°åŸºæœ¬å’Œä¸Šé¢è®²çš„ä¸€è‡´ï¼Œåœ¨è®­ç»ƒçš„æœ€å¼€å§‹æˆ‘ä»¬éœ€è¦åˆå§‹åŒ–æ¢¯åº¦çš„ç´¯ç§¯é‡å’Œå¹³æ–¹ç´¯ç§¯é‡ã€‚ {v\\_{dw}} = 0,{v\\_{db}} = 0;{s\\_{dw}} = 0,{s\\_{db}} = 0å‡è®¾åœ¨è®­ç»ƒçš„ç¬¬ $t$ è½®è®­ç»ƒä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆå¯ä»¥è®¡ç®—å¾—åˆ° Momentum å’Œ RMSProp çš„å‚æ•°æ›´æ–°ï¼š {v\\_{dw}} = {\\beta \\_1}{v\\_{dw}} + (1 - {\\beta \\_1})dW \\\\\\\\ {v\\_{db}} = {\\beta \\_1}{v\\_{db}} + (1 - {\\beta \\_1})db \\\\\\\\ {s\\_{dw}} = {\\beta \\_2}{s\\_{dw}} + (1 - {\\beta \\_2})d{W^2} \\\\\\\\ {s\\_{db}} = {\\beta \\_2}{s\\_{db}} + (1 - {\\beta \\_2})d{b^2} \\\\\\\\ç”±äºç§»åŠ¨æŒ‡æ•°å¹³å‡åœ¨è¿­ä»£å¼€å§‹çš„åˆæœŸä¼šå¯¼è‡´å’Œå¼€å§‹çš„å€¼æœ‰è¾ƒå¤§çš„å·®å¼‚ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å¯¹ä¸Šé¢æ±‚å¾—çš„å‡ ä¸ªå€¼åšåå·®ä¿®æ­£ v\\_{dw}^c = \\frac {v\\_{dw}} {1 - \\beta \\_1^t} \\\\\\\\ v\\_{db}^c = \\frac {v\\_{db}} {1 - \\beta \\_1^t} \\\\\\\\ s\\_{dw}^c = \\frac {s\\_{dw}} {1 - \\beta \\_2^t} \\\\\\\\ s\\_{db}^c = \\frac {s\\_{db}} {1 - \\beta \\_2^t}é€šè¿‡ä¸Šé¢çš„å…¬å¼ï¼Œæˆ‘ä»¬å°±å¯ä»¥æ±‚å¾—åœ¨ç¬¬ $t$ è½®è¿­ä»£è¿‡ç¨‹ä¸­ï¼Œå‚æ•°æ¢¯åº¦ç´¯ç§¯é‡çš„ä¿®æ­£å€¼ï¼Œä»è€Œæ¥ä¸‹æ¥å°±å¯ä»¥æ ¹æ® Momentum å’Œ RMSProp ç®—æ³•çš„ç»“åˆæ¥å¯¹æƒé‡å’Œåç½®è¿›è¡Œæ›´æ–°. W = W - \\alpha \\frac {v\\_{dw}^c} {\\sqrt {s\\_{dw}^c} + \\varepsilon } \\\\\\\\ b = b - \\alpha \\frac {v\\_{db}^c} {\\sqrt {s\\_{db}^c} + \\varepsilon }ä¸Šé¢çš„æ‰€æœ‰æ­¥éª¤å°±æ˜¯Momentumç®—æ³•å’ŒRMSPropç®—æ³•ç»“åˆèµ·æ¥ä»è€Œå½¢æˆAdamç®—æ³•ã€‚åœ¨Adamç®—æ³•ä¸­ï¼Œå‚æ•° ${\\beta_1}$ æ‰€å¯¹åº”çš„å°±æ˜¯Momentumç®—æ³•ä¸­çš„ ${\\beta}$ å€¼ï¼Œä¸€èˆ¬å–0.9ï¼Œå‚æ•° ${\\beta_2}$ æ‰€å¯¹åº”çš„å°±æ˜¯RMSPropç®—æ³•ä¸­çš„ ${\\beta}$ å€¼ï¼Œä¸€èˆ¬æˆ‘ä»¬å–0.999ï¼Œè€Œ $\\epsilon$ æ˜¯ä¸€ä¸ªå¹³æ»‘é¡¹ï¼Œæˆ‘ä»¬ä¸€èˆ¬å–å€¼ä¸º ${10^{ - 8}}$ï¼Œè€Œå­¦ä¹ ç‡ $\\alpha$ åˆ™éœ€è¦æˆ‘ä»¬åœ¨è®­ç»ƒçš„æ—¶å€™è¿›è¡Œå¾®è°ƒã€‚ é€šè¿‡ä¸Šé¢çš„ä¸‰ä¸ªç®—æ³•åŸºæœ¬è®²è¿°äº†ç¥ç»ç½‘ç»œä¸­çš„ä¼˜åŒ–å™¨ï¼Œç†è§£äº†è¿™ä¸‰ä¸ªç®—æ³•å…¶ä»–çš„ç®—æ³•ä¹Ÿå°±å¼•åˆƒè€Œè§£äº†. Adam ä¼˜åŒ–ç®—æ³• æˆ‘ä¼šæ¯«ä¸çŠ¹è±«çš„æ¨èç»™ä½ ï¼Œ å®ƒæ˜¯ Momentum å’Œ RMSprop çš„ç»“åˆ. äº‹å®è¯æ˜ï¼Œå®ƒå…¶å®è§£å†³äº†å¾ˆå¤šé—®é¢˜. Adam ä¸­çš„è¶…å‚æ•° ${\\beta_1}$ ã€${\\beta_2}$ ä¸€èˆ¬ä¸éœ€è¦è°ƒæ•´ï¼Œä¸šå†…ç»å¸¸å¾ˆå°‘æœ‰äººä¼šè°ƒæ•´ä»–ä»¬. $\\epsilon$ æ˜¯ä¸€ä¸ªå¹³æ»‘é¡¹ï¼Œä¸€èˆ¬å–å€¼ä¸º ${10^{ - 8}}$, åŸºæœ¬æ›´ä¸éœ€è¦è°ƒæ•´. Adaptive Moment Estimation ${\\beta_1}$ ç”¨äºè®¡ç®—è¿™ä¸ªå¾®åˆ† (computing the mean of the derivatives, this is called the first moment). ${\\beta_2}$ ç”¨äºè®¡ç®—å¹³æ–¹æ•°çš„æŒ‡æ•°åŠ æƒå¹³å‡æ•° (compute exponentially weighted average of the squares. this is called the second moment) So that gives rise to the name Adaptive Moment Estimation. 6. Learning rate decayä¹‹å‰ç®—æ³•ä¸­æåˆ°çš„å­¦ä¹ ç‡Î±éƒ½æ˜¯ä¸€ä¸ªå¸¸æ•°ï¼Œè¿™æ ·æœ‰å¯èƒ½ä¼šä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯åˆšå¼€å§‹æ”¶æ•›é€Ÿåº¦åˆšåˆšå¥½ï¼Œå¯æ˜¯åœ¨åé¢æ”¶æ•›è¿‡ç¨‹ä¸­å­¦ä¹ ç‡åå¤§ï¼Œå¯¼è‡´ä¸èƒ½å®Œå…¨æ”¶æ•›ï¼Œè€Œæ˜¯åœ¨æœ€ä½ç‚¹æ¥å›æ³¢åŠ¨ã€‚æ‰€ä»¥ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œéœ€è¦è®©å­¦ä¹ ç‡èƒ½å¤Ÿéšç€è¿­ä»£æ¬¡æ•°çš„å¢åŠ è¿›è¡Œè¡°å‡ï¼Œå¸¸è§çš„è®¡ç®—å…¬å¼æœ‰å¦‚ä¸‹å‡ ç§: Î± = \\frac {1} {1+decay\\_rate*epoch\\_num} Î±_0 å¯¹æˆ‘è€Œè¨€ï¼Œå­¦ä¹ ç‡è¡°å‡å¹¶ä¸æ˜¯æˆ‘å°è¯•çš„è¦ç‚¹, è®¾ç½®ä¸€ä¸ªå›ºå®šçš„ Î±ï¼Œ ç„¶åå¥½å¥½è°ƒæ•´ï¼Œä¼šæœ‰å¾ˆå¤§å½±å“ï¼Œ å­¦ä¹ ç‡è¡°å‡çš„ç¡®å¤§æœ‰è£¨ç›Š, æœ‰æ—¶å€™å®ƒå¯ä»¥åŠ å¿«è®­ç»ƒ, ä½†è¿™å¹¶ä¸æ˜¯æˆ‘ä¼šç‡å…ˆå°è¯•çš„å†…å®¹. ä¸‹å‘¨æˆ‘ä»¬ä¼šé‡ç‚¹ä»‹ç» å¦‚ä½•ç®¡ç†å’Œé«˜æ•ˆæœç´¢ è¶…å‚æ•°. For meï¼ŒI would say that learning rate decay usually lower down on the list of things I try. learning rate decay does help. Sometimes it can really help speed up training. it is a little bit lower down my list in terms of the thingsI would try. Reference ç½‘æ˜“äº‘è¯¾å ‚ - deeplearning æ·±åº¦å­¦ä¹ ç¬”è®°ï¼šä¼˜åŒ–æ–¹æ³•æ€»ç»“(BGD,SGD,Momentum,AdaGrad,RMSProp,Adam) Deep Learning ä¹‹ æœ€ä¼˜åŒ–æ–¹æ³• æ·±åº¦å­¦ä¹ ä¼˜åŒ–ç®—æ³•è§£æ(Momentum, RMSProp, Adam) æœºå™¨ä¹‹å¿ƒ - ç¥ç»ç½‘ç»œè®­ç»ƒä¸­ï¼Œå‚»å‚»åˆ†ä¸æ¸…Epochã€Batch Sizeå’Œè¿­ä»£","categories":[{"name":"deeplearning","slug":"deeplearning","permalink":"http://iequa.com/categories/deeplearning/"}],"tags":[{"name":"deeplearning.ai","slug":"deeplearning-ai","permalink":"http://iequa.com/tags/deeplearning-ai/"}]},{"title":"Spark æ ¸å¿ƒæ¦‚å¿µè¯¦è¿° 2.2","slug":"spark/spark-aura-2.2-core-introduce","date":"2018-07-21T00:07:21.000Z","updated":"2020-12-04T01:06:17.235Z","comments":true,"path":"2018/07/21/spark/spark-aura-2.2-core-introduce/","link":"","permalink":"http://iequa.com/2018/07/21/spark/spark-aura-2.2-core-introduce/","excerpt":"","text":"1. Word Count data source -&gt; LineRDD -&gt; WordRDD -&gt; WordAndOneRDD -&gt; WordCountRDD -&gt; ç›®çš„åœ° æ•´ä¸ª SPark ç¨‹åºä¸­çš„ 1ä¸ªApplication â€”&gt; 1ä¸ªJob â€”&gt; storm â€”- ç»†ç²’åº¦ â€” ä¸€æ¡æ•°æ®å¤„ç†ä¸€æ¬¡ sparkStreaming â€” ç²—ç²’åº¦ â€” ä¸€å°æ®µæ—¶é—´å†…çš„æ‰€æœ‰æ•°æ®å¤„ç†ä¸€æ¬¡ åŠ å…¥ 1s ä¸­ å°±ä¸€æ¡æ•°æ®åŠ å…¥ 1s ä¸­ å°±ä¸€ä¸‡æ¡æ•°æ®. Spark Core + MapReduce spark: master(resourcemanager) worker(nodemanager) YARN: â€” master yarnâ€”deploy-mode client/cluster ä¸Šä¼ å’Œä¸‹è½½æ•°æ®çš„æµç¨‹ï¼š 7 SparkSubmitï¼š 10æ­¥SparkCore ä»»åŠ¡è¿è¡Œæµç¨‹ï¼š 20æ­¥ RDD ä¸‰å¥è¯ linage è¡€è„‰å…³ç³» ä¸€ä¸ªçº¿ç¨‹ä¸€ä¸ªä»»åŠ¡ ä¸€ä¸ª Executor ä¼šæ‰§è¡Œå¤šä¸ª Task Reference","categories":[{"name":"spark","slug":"spark","permalink":"http://iequa.com/categories/spark/"}],"tags":[{"name":"spark","slug":"spark","permalink":"http://iequa.com/tags/spark/"}]},{"title":"Improving Deep Neural Networks (week1) - æ·±åº¦å­¦ä¹ çš„å®ç”¨å±‚é¢","slug":"deeplearning/Improving-Deep-Neural-Networks-week1","date":"2018-07-19T12:00:21.000Z","updated":"2020-11-25T06:43:19.415Z","comments":true,"path":"2018/07/19/deeplearning/Improving-Deep-Neural-Networks-week1/","link":"","permalink":"http://iequa.com/2018/07/19/deeplearning/Improving-Deep-Neural-Networks-week1/","excerpt":"è¿™æ¬¡æˆ‘ä»¬è¦å­¦ä¹ ä¸“é¡¹è¯¾ç¨‹ä¸­ç¬¬äºŒé—¨è¯¾ Improving Deep Neural Networks å­¦å®Œè¿™é—¨è¯¾ä¹‹åï¼Œä½ å°†ä¼š: èƒ½å¤Ÿé«˜æ•ˆåœ°ä½¿ç”¨ç¥ç»ç½‘ç»œé€šç”¨çš„æŠ€å·§ï¼ŒåŒ…æ‹¬ åˆå§‹åŒ–ã€L2å’Œdropoutæ­£åˆ™åŒ–ã€Batchå½’ä¸€åŒ–ã€æ¢¯åº¦æ£€éªŒã€‚ èƒ½å¤Ÿå®ç°å¹¶åº”ç”¨å„ç§ä¼˜åŒ–ç®—æ³•ï¼Œä¾‹å¦‚ Mini-batchã€Momentumã€RMSpropã€Adamï¼Œå¹¶æ£€æŸ¥å®ƒä»¬çš„æ”¶æ•›ç¨‹åº¦ã€‚ ç†è§£æ·±åº¦å­¦ä¹ æ—¶ä»£å…³äºå¦‚ä½• æ„å»ºè®­ç»ƒ/å¼€å‘/æµ‹è¯•é›† ä»¥åŠ åå·®/æ–¹å·®åˆ†æ æœ€æ–°æœ€æœ‰æ•ˆçš„æ–¹æ³•. èƒ½å¤Ÿç”¨TensorFlowå®ç°ä¸€ä¸ªç¥ç»ç½‘ç»œ è¿™é—¨è¯¾å°†ä¼šè¯¦å°½åœ°ä»‹ç»æ·±åº¦å­¦ä¹ çš„åŸºæœ¬åŸç†ï¼Œè€Œä¸ä»…ä»…åªè¿›è¡Œç†è®ºæ¦‚è¿°.","text":"è¿™æ¬¡æˆ‘ä»¬è¦å­¦ä¹ ä¸“é¡¹è¯¾ç¨‹ä¸­ç¬¬äºŒé—¨è¯¾ Improving Deep Neural Networks å­¦å®Œè¿™é—¨è¯¾ä¹‹åï¼Œä½ å°†ä¼š: èƒ½å¤Ÿé«˜æ•ˆåœ°ä½¿ç”¨ç¥ç»ç½‘ç»œé€šç”¨çš„æŠ€å·§ï¼ŒåŒ…æ‹¬ åˆå§‹åŒ–ã€L2å’Œdropoutæ­£åˆ™åŒ–ã€Batchå½’ä¸€åŒ–ã€æ¢¯åº¦æ£€éªŒã€‚ èƒ½å¤Ÿå®ç°å¹¶åº”ç”¨å„ç§ä¼˜åŒ–ç®—æ³•ï¼Œä¾‹å¦‚ Mini-batchã€Momentumã€RMSpropã€Adamï¼Œå¹¶æ£€æŸ¥å®ƒä»¬çš„æ”¶æ•›ç¨‹åº¦ã€‚ ç†è§£æ·±åº¦å­¦ä¹ æ—¶ä»£å…³äºå¦‚ä½• æ„å»ºè®­ç»ƒ/å¼€å‘/æµ‹è¯•é›† ä»¥åŠ åå·®/æ–¹å·®åˆ†æ æœ€æ–°æœ€æœ‰æ•ˆçš„æ–¹æ³•. èƒ½å¤Ÿç”¨TensorFlowå®ç°ä¸€ä¸ªç¥ç»ç½‘ç»œ è¿™é—¨è¯¾å°†ä¼šè¯¦å°½åœ°ä»‹ç»æ·±åº¦å­¦ä¹ çš„åŸºæœ¬åŸç†ï¼Œè€Œä¸ä»…ä»…åªè¿›è¡Œç†è®ºæ¦‚è¿°. æœ¬å‘¨ä¸»è¦å†…å®¹åŒ…æ‹¬: Data set partition Bias / Variance Regularization Normalization Gradient Checking 1. Train/dev/teståœ¨ä¸Šä¸€å‘¨çš„å†…å®¹ä¸­, ä»‹ç»äº†ç¥ç»ç½‘ç»œä¸­çš„å¸¸ç”¨ç¬¦å·ä»¥åŠå„ç§å˜é‡çš„ç»´åº¦. ä¸æ¸…æ¥šçš„å¯ä»¥å›é¡¾ä¸Šå‘¨çš„ç¬”è®°å†…å®¹. 1.1 Data set partitionåœ¨è®­ç»ƒå®Œä¸€ä¸ªæ¨¡å‹æ—¶, æˆ‘ä»¬éœ€è¦çŸ¥é“è¿™ä¸ªæ¨¡å‹é¢„æµ‹çš„æ•ˆæœ. æ­¤æ—¶å°±éœ€è¦ä¸€ä¸ªé¢å¤–çš„æ•°æ®é›†, æˆ‘ä»¬ç§°ä¸º dev/hold out/validation set, è¿™é‡Œæˆ‘ä»¬å°±ç»Ÿä¸€ç§°ä¹‹ä¸ºéªŒè¯é›†. å¦‚æœæˆ‘ä»¬éœ€è¦çŸ¥é“æ¨¡å‹æœ€ç»ˆæ•ˆæœçš„æ— åä¼°è®¡, é‚£ä¹ˆæˆ‘ä»¬è¿˜éœ€è¦ä¸€ä¸ªæµ‹è¯•é›†. åœ¨ä»¥å¾€ä¼ ç»Ÿçš„æœºå™¨å­¦ä¹ ä¸­, æˆ‘ä»¬é€šå¸¸æŒ‰ç…§ 70/30 æ¥æ•°æ®é›†åˆ†ä¸º Train set/Validation set, æˆ–è€…æŒ‰ç…§ 60/20/20 çš„æ¯”ä¾‹åˆ†ä¸º Train/Validation/Test. ä½†åœ¨ä»Šå¤©æœºå™¨å­¦ä¹ é—®é¢˜ä¸­, æˆ‘ä»¬å¯ç”¨çš„æ•°æ®é›†çš„é‡çº§éå¸¸å¤§ (ä¾‹å¦‚æœ‰ 100W ä¸ªæ ·æœ¬). è¿™æ—¶æˆ‘ä»¬å°±ä¸éœ€è¦ç»™éªŒè¯é›†å’Œæµ‹è¯•é›†å¤ªå¤§çš„æ¯”ä¾‹, ä¾‹å¦‚ 98/1/1. 1.2 Data src distributionåœ¨åˆ’åˆ†æ•°æ®é›†ä¸­, æœ‰ä¸€ä¸ªæ¯”è¾ƒå¸¸è§çš„é”™è¯¯å°±æ˜¯ä¸å°å¿ƒä½¿å¾—åœ¨è®­ç»ƒé›†ä¸­çš„æ•°æ®å’ŒéªŒè¯æˆ–æµ‹è¯•é›†ä¸­çš„æ•°æ®æ¥è‡ªäºä¸åŒçš„åˆ†å¸ƒ. ä¾‹å¦‚æˆ‘ä»¬æƒ³è¦åšä¸€ä¸ªçŒ«çš„åˆ†ç±»å™¨, åœ¨åˆ’åˆ†æ•°æ®çš„æ—¶å€™å‘ç°è®­ç»ƒé›†ä¸­çš„å›¾ç‰‡å…¨éƒ½æ˜¯æ¥è‡ªäºç½‘é¡µ, è€ŒéªŒè¯é›†å’Œæµ‹è¯•é›†ä¸­çš„æ•°æ®å…¨éƒ½æ¥è‡ªäºç”¨æˆ·. è¿™æ˜¯ä¸€ç§å®Œå…¨é”™è¯¯çš„åšæ³•, åœ¨å®é™…ä¸­ä¸€å®šè¦æœç». 2. Bias / Varianceå…³äº Bias / Variance ç›¸æ¯”å¤§å®¶éƒ½å¾ˆç†Ÿæ‚‰äº†, åœ¨æœºå™¨å­¦ä¹ çš„è¯¾ç¨‹ä¸­ä¹Ÿå·²ç»å­¦ä¹ åˆ°. ä¸‹é¢ç¥­å‡º Andrew Ng ç»å…¸çš„å›¾ä¾‹è§£é‡Š: æˆ‘ä»¬è¯¥å¦‚ä½•å®šä½æ¨¡å‹æ‰€å¤„çš„é—®é¢˜? å¦‚ä¸‹å›¾æ‰€ç¤º, è¿™é‡Œä¸¾äº†å››ä¸­æƒ…å†µä¸‹çš„è®­ç»ƒé›†å’ŒéªŒè¯é›†è¯¯å·®. å½“ è®­ç»ƒè¯¯å·®å¾ˆå°, éªŒè¯è¯¯å·®å¾ˆå¤§æ—¶ ä¸º High Variance å½“ è®­ç»ƒè¯¯å·® å’Œ éªŒè¯è¯¯å·® æ¥è¿‘ ä¸” éƒ½å¾ˆå¤§ æ—¶ä¸º High Bias å½“ è®­ç»ƒè¯¯å·®å¾ˆå¤§, éªŒè¯è¯¯å·®æ›´å¤§æ—¶ä¸º High Variance &amp;&amp; High Bias å½“ è®­ç»ƒè¯¯å·® å’Œ éªŒè¯è¯¯å·®æ¥è¿‘ä¸”éƒ½å¾ˆå°æ—¶ä¸º Low Variance &amp;&amp; Low Bias å…³äºé«˜æ–¹å·®é«˜åå·®å¯èƒ½æ˜¯ç¬¬ä¸€æ¬¡å¬è¿‡, å¦‚ä¸‹å›¾æ‰€ç¤º, æ•´ä½“ä¸Šæ¨¡å‹å¤„äºé«˜åå·®, ä½†æ˜¯å¯¹äºä¸€äº›å™ªå£°åˆæ‹Ÿåˆåœ°å¾ˆå¥½. æ­¤æ—¶å°±å¤„äºé«˜åå·®é«˜æ–¹å·®çš„çŠ¶æ€. å½“æˆ‘ä»¬å­¦ä¼šå®šä½æ¨¡å‹çš„é—®é¢˜å, é‚£ä¹ˆè¯¥æ€æ ·è§£å†³å¯¹åº”çš„é—®é¢˜å‘¢? è§ä¸‹å›¾: è‹¥ High bias, æˆ‘ä»¬å¯ä»¥å¢åŠ æ¨¡å‹çš„å¤æ‚åº¦ä¾‹å¦‚ä½¿ç”¨ä¸€ä¸ªâ€æ›´å¤§â€çš„ç½‘ç»œç»“æ„æˆ–è€…è®­ç»ƒæ›´ä¹…ä¸€ç‚¹.å¦‚ High variance, æˆ‘ä»¬å¯ä»¥æƒ³åŠæ³• get more data, æˆ–è€…ä½¿ç”¨æ¥ä¸‹æ¥æˆ‘ä»¬è¦è®²çš„ Regularization. 3. Regularizationä¸ºä»€ä¹ˆæ­£åˆ™åŒ–æ²¡æœ‰åŠ  $\\frac{\\lambda}{2m} b^2$: å› ä¸º $w$ é€šå¸¸æ˜¯ä¸€ä¸ªé«˜ç»´å‚æ•°çŸ¢é‡, å·²ç»å¯ä»¥è¡¨è¾¾ High bias çš„é—®é¢˜, $w$ å¯èƒ½å«æœ‰å¾ˆå¤šå‚æ•°ï¼Œæˆ‘ä»¬ä¸å¯èƒ½æ‹Ÿåˆæ‰€æœ‰å‚æ•°, è€Œ $b$ åªæ˜¯å•ä¸ªæ•°å­—, æ‰€ä»¥ $w$ å‡ ä¹è¦†ç›–äº†æ‰€æœ‰å‚æ•°ï¼Œè€Œä¸æ˜¯ $b$, å¦‚æœåŠ äº† $b$ ä¹Ÿæ²¡æœ‰å½±å“ï¼Œå› ä¸º $b$ åªæ˜¯ä¼—å¤šå‚æ•°ä¸­çš„ä¸€ä¸ª. å…³äº L1 regularization : å¦‚æœç”¨çš„æ˜¯ L1 regularization, then $w$ will end up being sprase ç¨€ç–çš„, ä¹Ÿå°±æ˜¯è¯´ $w$ å‘é‡ä¸­æœ‰å¾ˆå¤š 0. æœ‰äººè¯´è¿™æ ·æœ‰åˆ©äºå‹ç¼©æ¨¡å‹ï¼Œä½†æ˜¯æˆ‘è§‰å¾—ä¸æ˜¯å¾ˆåˆé€‚. è¶Šæ¥è¶Šå¤šçš„äººä½¿ç”¨ L2. Notes: ä¸ç§°ä¸º:çŸ©é˜µ L2 èŒƒæ•°ï¼Œ æŒ‰ç…§æƒ¯ä¾‹æˆ‘ä»¬ç§°ä¸º: Frobenius norm of a matrix, å…¶å®å°±æ˜¯ : çŸ©é˜µ L2 èŒƒæ•°ã€‚ 3.1 L2 regularization L2 regularization ä¸‹çš„ Cost Function å¦‚ä¸‹æ‰€ç¤º, åªéœ€è¦æ·»åŠ æ­£åˆ™é¡¹ $\\frac{\\lambda}{2m}\\sum_{l=1}^L||w^{[l]}||^2_F$, å…¶ä¸­ F ä»£è¡¨ Frobenius Norm. åœ¨æ·»åŠ äº†æ­£åˆ™é¡¹ä¹‹å, ç›¸åº”çš„æ¢¯åº¦ä¹Ÿè¦å˜åŒ–, æ‰€ä»¥åœ¨æ›´æ–°å‚æ•°çš„æ—¶å€™éœ€è¦åŠ ä¸Šå¯¹åº”çš„é¡¹. è¿™é‡Œæ³¨æ„ä¸€ç‚¹, æˆ‘ä»¬åªå¯¹å‚æ•° $w$ æ­£åˆ™, è€Œä¸å¯¹ $b$. å› ä¸ºå¯¹äºæ¯ä¸€å±‚æ¥è¯´, $w$ æœ‰å¾ˆé«˜çš„ç»´åº¦, è€Œ $b$ åªæ˜¯ä¸€ä¸ªæ ‡é‡. $w$ å¯¹æ•´ä¸ªæ¨¡å‹çš„å½±å“è¿œå¤§äº $b$. ä¸‹é¢ç»™å‡ºæ·»åŠ  regularization ä¸ºä»€ä¹ˆèƒ½é˜²æ­¢è¿‡æ‹Ÿåˆç»™å‡ºç›´è§‚çš„è§£é‡Š. å¦‚ä¸‹å›¾æ‰€ç¤º: å½“æˆ‘ä»¬çš„ Î» æ¯”è¾ƒå¤§çš„æ—¶å€™, æ¨¡å‹å°±ä¼šåŠ å¤§å¯¹ w çš„æƒ©ç½š, è¿™æ ·æœ‰äº› w å°±ä¼šå˜å¾—å¾ˆå° (L2 Regularization ä¹Ÿå«æƒé‡è¡°å‡, weights decay). ä»ä¸‹å›¾å·¦è¾¹çš„ç¥ç»ç½‘ç»œæ¥çœ‹, æ•ˆæœå°±æ˜¯æ•´ä¸ªç¥ç»ç½‘ç»œå˜å¾—ç®€å•äº†(ä¸€äº›éšè—å±‚ç”šè‡³ $w$ è¶‹å‘äº 0), ä»è€Œé™ä½äº†è¿‡æ‹Ÿåˆçš„é£é™©. é‚£äº› éšè—å±‚ å¹¶æ²¡æœ‰è¢«æ¶ˆé™¤ï¼Œåªæ˜¯å½±å“å˜å¾—æ›´å°äº†ï¼Œç¥ç»ç½‘ç»œå˜å¾—ç®€å•äº†. ä»å¦ä¸€ä¸ªè§’åº¦æ¥çœ‹. ä»¥ tanhæ¿€æ´»å‡½æ•° ä¸ºä¾‹, å½“ $Î»$ å¢åŠ æ—¶, $w$ ä¼šåå°, è¿™æ · $z = wa +b$ ä¹Ÿä¼šåå°, æ­¤æ—¶çš„æ¿€æ´»å‡½æ•°å¤§è‡´æ˜¯çº¿æ€§çš„. è¿™æ ·æ¨¡å‹çš„å¤æ‚åº¦ä¹Ÿå°±é™ä½äº†, å³é™ä½äº†è¿‡æ‹Ÿåˆçš„é£é™©. å¦‚æœç¥ç»ç½‘ç»œæ¯å±‚éƒ½æ˜¯çº¿æ€§çš„ï¼Œå…¶å®æ•´ä¸ªè¿˜æ˜¯ä¸€ä¸ªçº¿æ€§çš„, å³ä½¿æ˜¯ä¸€ä¸ªå¾ˆæ·±çš„ç½‘ç»œï¼Œå› ä¸ºçº¿æ€§æ¿€æ´»å‡½æ•°çš„ç‰¹å¾ï¼Œæœ€ç»ˆæˆ‘ä»¬åªèƒ½è®¡ç®—çº¿æ€§å‡½æ•°. 3.2 Dropoutdropout ä¹Ÿæ˜¯ä¸€ç§æ­£åˆ™åŒ–çš„æ‰‹æ®µ, åœ¨è®­ç»ƒæ—¶ä»¥ 1-keep_prob éšæœºåœ°â€ä¸¢å¼ƒâ€ä¸€äº›èŠ‚ç‚¹. å¦‚ä¸‹å›¾æ‰€ç¤º. å…·ä½“å¯å‚è€ƒå¦‚ä¸‹å®ç°æ–¹å¼, åœ¨å‰å‘ä¼ æ’­æ—¶å°† $a$ ä¸­çš„æŸäº›å€¼ç½®ä¸º0, ä¸ºäº†ä¿è¯å¤§æ¦‚çš„å¤§å°ä¸å—æ·»åŠ  dropout å½±å“, å†å°†å¤„ç†åçš„ $a$ é™¤ä»¥ keep_prob. dropout å°†äº§ç”Ÿæ”¶ç¼©æƒé‡çš„å¹³æ–¹èŒƒæ•°çš„æ•ˆæœ, å’Œ L2 ç±»ä¼¼ï¼Œå®æ–½ dropout çš„ç»“æœæ˜¯å®ƒä¼šå‹ç¼©æƒé‡ï¼Œå¹¶å®Œæˆä¸€äº›é¢„é˜²è¿‡æ‹Ÿåˆçš„å¤–å±‚æ­£åˆ™åŒ–ï¼Œäº‹å®è¯æ˜ dropout è¢«æ­£å¼åœ°ä½œä¸ºä¸€ç§æ­£åˆ™åŒ–çš„æ›¿ä»£å½¢å¼ L2 å¯¹ä¸åŒæƒé‡çš„è¡°å‡æ˜¯ä¸åŒçš„ï¼Œå®ƒå–å†³äºå€å¢çš„æ¿€æ´»å‡½æ•°çš„å¤§å°. dropout çš„åŠŸèƒ½ç±»ä¼¼äº L2 æ­£åˆ™åŒ–. ç”šè‡³ dropout æ›´é€‚ç”¨äºä¸åŒçš„è¾“å…¥èŒƒå›´. Notes: æ¯ä¸€å±‚çš„ keep_prob å¯èƒ½æ˜¯ä¸åŒçš„, keep_prob å– 1ï¼Œ åˆ™æ˜¯è¯¥å±‚ä¿ç•™æ‰€æœ‰å•å…ƒ. è¾“å‡ºå±‚çš„ keep_prob ç»å¸¸è®¾ç½®ä¸º 1ï¼Œæœ‰æ—¶å€™ä¹Ÿå¯ä»¥è®¾ç½®ä¸º 1.9 (&gt;1). &lt; 1 é€šå¸¸åœ¨è¾“å‡ºå±‚æ˜¯ä¸å¤ªå¯èƒ½çš„. è¾“å…¥å±‚çš„ keep_prob ç»å¸¸è®¾ç½®ä¸º 1ï¼Œæœ‰æ—¶å€™ä¹Ÿå¯ä»¥è®¾ç½®ä¸º 0.9ï¼Œ å¦‚æœæ˜¯ 0.5 æ¶ˆå‡ä¸€åŠï¼Œé€šå¸¸æ˜¯ä¸å¯èƒ½çš„. å…¶ä»– : è®¡ç®—æœºè§†è§‰çš„äººå‘˜éå¸¸é’Ÿæƒ… dropout å‡½æ•°. Notes: dropout çš„ä¸€å¤§ç¼ºç‚¹å°±æ˜¯ J ä¸ä¼šè¢«æ˜ç¡®å®šä¹‰. æ¯æ¬¡è¿­ä»£éƒ½ä¼šè¢«éšæœºåˆ é™¤ä¸€äº›èŠ‚ç‚¹. å¦‚æœå†ä¸‰æ£€æŸ¥æ¢¯åº¦ä¸‹é™çš„æ€§èƒ½ï¼Œå®é™…ä¸Šæ˜¯å¾ˆéš¾å¤æŸ¥çš„. å®šä¹‰æ˜ç¡®çš„ä»£ä»·å‡½æ•°ï¼Œæ¯æ¬¡è¿­ä»£éƒ½ä¼šä¸‹é™. å› ä¸º dropout ä½¿å¾— J æ²¡æœ‰è¢«æ˜ç¡®å®šä¹‰ï¼Œæˆ–è€…åœ¨æŸç§ç¨‹åº¦ä¸Šå¾ˆéš¾è®¡ç®—. æ‰€ä»¥æˆ‘ä»¬å¤±å»äº†è°ƒè¯•å·¥å…·ï¼Œæˆ‘é€šå¸¸ä¼šå…³é—­ dropout. keep_prob è®¾ç½®ä¸º 1ï¼Œ è¿è¡Œä»£ç ï¼Œç¡®ä¿ J å‡½æ•°å•è°ƒé€’å‡, ç„¶ååœ¨æ‰“å¼€ dropout, åœ¨ dropout çš„è¿‡ç¨‹ä¸­ï¼Œä»£ç å¹¶æœªå¼•å…¥bug. å®ç°ä»£ç (æœªå®Œæˆ) 3.3 Other Regularization Data augmentation Early stopping W å¼€å§‹æ˜¯å˜å°çš„ï¼Œä¹‹åä¼šéšç€è¿­ä»£è¶Šæ¥è¶Šå¤§. early stopping å°±æ˜¯åœ¨ä¸­é—´ç‚¹åœæ­¢è¿­ä»£è¿‡ç¨‹. Notes: early stopping ç¼ºç‚¹æ˜¯ ææ—©åœæ­¢ï¼Œw æ˜¯é˜²æ­¢äº†è¿‡æ‹Ÿåˆï¼Œä½†æ˜¯ J æ²¡æœ‰è¢«ç»§ç»­ä¸‹é™. L2 æ­£åˆ™åŒ– çš„ç¼ºç‚¹æ˜¯ï¼Œè¦ç”¨å¤§é‡ç²¾åŠ›æœç´¢åˆé€‚çš„ Î» . æˆ‘ä¸ªäººä¹Ÿæ˜¯æ›´å€¾å‘äºä½¿ç”¨ L2ï¼Œå¦‚æœä½ å¯ä»¥è´Ÿæ‹…å¤§é‡çš„è®¡ç®—ä»£ä»·. 4. Normalization 0 å‡å€¼åŒ– å½’ä¸€åŒ– æ–¹å·® ä¸Šå›¾2ï¼Œ ç‰¹å¾ x1 çš„æ–¹å·® æ¯” ç‰¹å¾ x2 çš„æ–¹å·® å¤§å¾ˆå¤šä¸Šå›¾3ï¼Œ ç‰¹å¾ x1 å’Œ ç‰¹å¾ x2 çš„ æ–¹å·® éƒ½æ˜¯ 1 æ³¨æ„: ä¸è®º è®­ç»ƒé›† å’Œ æµ‹è¯•é›†ï¼Œéƒ½æ˜¯é€šè¿‡ç›¸åŒçš„ $\\mu$ å’Œ ${\\sigma}^2$ å®šä¹‰çš„ç›¸åŒæ•°æ®è½¬æ¢, å…¶ä¸­ $\\mu$ å’Œ ${\\sigma}^2$ æ˜¯ç”±è®­ç»ƒæ•°æ®è®¡ç®—è€Œæ¥. 5. Vanishing/Exploding gradientsVanishing/Exploding gradients æŒ‡çš„æ˜¯éšç€å‰å‘ä¼ æ’­ä¸æ–­åœ°è¿›è¡Œ, æ¿€æ´»å•å…ƒçš„å€¼ä¼šé€å±‚æŒ‡æ•°çº§åœ°å¢åŠ æˆ–å‡å°, ä»è€Œå¯¼è‡´æ¢¯åº¦æ— é™å¢å¤§æˆ–è€…è¶‹è¿‘äºé›¶, è¿™æ ·ä¼šä¸¥é‡å½±å“ç¥ç»ç½‘ç»œçš„è®­ç»ƒ. å¦‚ä¸‹å›¾. ä¸ºäº†ç›´è§‚ç†è§£æ¢¯åº¦æ¶ˆå¤±å’Œæ¢¯åº¦çˆ†ç‚¸ï¼Œæˆ‘ä»¬å‡è®¾æ‰€æœ‰æ¿€æ´»å‡½æ•°ä¸ºçº¿æ€§æ¿€æ´»å‡½æ•°ï¼Œå³ $g(z)=z$ã€‚ å¹¶å‡è®¾å‰ Lâˆ’1 ä¸ªæƒé‡çŸ©é˜µéƒ½ç›¸ç­‰, å³ä¸º $W_{linear}$ï¼Œæ‰€ä»¥å¯ä»¥å¾—åˆ° $y_{hat}=W_{linear}^{L-1}W_{L}X$ å‡è®¾ $W_{linear}$ éƒ½ç­‰äºè¿™ä¸ª: é‚£ä¹ˆåˆ™æœ‰ $y_{hat}=1.5^{L-1}W_LX$ï¼Œå¾ˆæ˜¾ç„¶å½“ L å¾ˆå¤§æ—¶åˆ™ä¼šå‡ºç°æ¢¯åº¦çˆ†ç‚¸ã€‚ åŒç†è‹¥å°†æƒé‡çš„å€¼è®¾ç½®ä¸ºå°äº1ï¼Œé‚£ä¹ˆåˆ™ä¼šå‡ºç°æ¢¯åº¦æ¶ˆå¤±ã€‚ ä¸€ä¸ªå¯ä»¥å‡å°è¿™ç§æƒ…å†µå‘ç”Ÿçš„æ–¹æ³•, å°±æ˜¯ç”¨æœ‰æ•ˆçš„å‚æ•°åˆå§‹åŒ– (è¯¥æ–¹æ³•å¹¶ä¸èƒ½å®Œå…¨è§£å†³è¿™ä¸ªé—®é¢˜). ä½†æ˜¯ä¹Ÿæ˜¯æœ‰æ„ä¹‰çš„ è®¾ç½®åˆç†çš„æƒé‡ï¼Œå¸Œæœ›ä½ è®¾ç½®çš„æƒé‡çŸ©é˜µï¼Œæ—¢ä¸ä¼šå¢é•¿è¿‡å¿«ï¼Œä¹Ÿä¸ä¼šä¸‹é™è¿‡å¿«åˆ° 0. æƒ³æ›´åŠ äº†è§£å¦‚ä½•åˆå§‹åŒ–æƒé‡å¯ä»¥çœ‹ä¸‹è¿™ç¯‡æ–‡ç«  ç¥ç»ç½‘ç»œæƒé‡åˆå§‹åŒ–é—®é¢˜ï¼Œå…¶ä¸­å¾ˆè¯¦ç»†çš„ä»‹ç»äº†æƒé‡åˆå§‹åŒ–é—®é¢˜ã€‚ 6. Gradient checking implementation å¾ˆéš¾ç”¨æ¢¯åº¦æ£€éªŒæ¥åŒé‡æ£€éªŒ dropout çš„è®¡ç®—ï¼Œ æ‰€ä»¥æˆ‘ä¸åŒæ—¶ä½¿ç”¨æ¢¯åº¦æ£€éªŒå’Œ dropoutï¼Œé™¤é dropout keep.prob è®¾ç½®ä¸º 1. æˆ‘å»ºè®®å…³é—­ dropout ç”¨æ¢¯åº¦æ£€éªŒè¿›è¡ŒåŒé‡æ£€æŸ¥. åœ¨æ²¡æœ‰ dropout çš„æƒ…å†µä¸‹ï¼Œç¡®ä¿ä½ çš„ç®—æ³•æ˜¯æ­£ç¡®çš„ï¼Œç„¶åå†æ‰“å¼€ dropout. ç°å®ä¸­ å‡ ä¹ä¸ä¼šå‡ºç°, å½“ w å’Œ b æ¥è¿‘ 0 æ—¶ï¼Œæ¢¯åº¦ä¸‹é™çš„å®æ–½æ˜¯æ­£ç¡®çš„. 8. Reference ç½‘æ˜“äº‘è¯¾å ‚ - deeplearning deeplearning.ai ä¸“é¡¹è¯¾ç¨‹äºŒç¬¬ä¸€å‘¨ Coursera - Deep Learning Specialization DeepLearning.aiå­¦ä¹ ç¬”è®°æ±‡æ€»","categories":[{"name":"deeplearning","slug":"deeplearning","permalink":"http://iequa.com/categories/deeplearning/"}],"tags":[{"name":"deeplearning.ai","slug":"deeplearning-ai","permalink":"http://iequa.com/tags/deeplearning-ai/"}]},{"title":"Hadoop Tutorial 3 - Hive","slug":"hadoop/hadoop-hive-1","date":"2018-07-15T23:07:21.000Z","updated":"2020-12-06T06:25:07.270Z","comments":true,"path":"2018/07/16/hadoop/hadoop-hive-1/","link":"","permalink":"http://iequa.com/2018/07/16/hadoop/hadoop-hive-1/","excerpt":"","text":"åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»ŸHDFS: æ ¸å¿ƒåŸç†ä¸æ“ä½œ Reference å¤§æ•°æ®å¼€å‘ç³»åˆ—ç›´æ’­è¯¾ â‘¢","categories":[{"name":"hadoop","slug":"hadoop","permalink":"http://iequa.com/categories/hadoop/"}],"tags":[{"name":"Hive","slug":"Hive","permalink":"http://iequa.com/tags/Hive/"}]},{"title":"Hadoop Review 2 - MapReduce","slug":"hadoop/hadoop-mr-1","date":"2018-07-15T15:07:21.000Z","updated":"2020-12-06T06:28:30.023Z","comments":true,"path":"2018/07/15/hadoop/hadoop-mr-1/","link":"","permalink":"http://iequa.com/2018/07/15/hadoop/hadoop-mr-1/","excerpt":"","text":"1. ä»€ä¹ˆæ˜¯å¤§æ•°æ®ï¼Ÿ æ ¸å¿ƒé—®é¢˜æ˜¯ä»€ä¹ˆï¼Ÿä¸¾ä¸ªğŸŒ°: å•†å“çš„æ¨è (é—®é¢˜1) å¤§é‡çš„è®¢å•æ•°æ®å¦‚ä½•å­˜å‚¨ï¼Ÿ(é—®é¢˜1) å¤§é‡çš„è®¢å•æ•°æ®å¦‚ä½•è®¡ç®—ï¼Ÿ å¤§æ•°æ®çš„æ ¸å¿ƒé—®é¢˜ (æŠ€æœ¯ä¸Š)ï¼š å­˜å‚¨ (HDFS) è®¡ç®— (ç¦»çº¿ + å®æ—¶) ç¦»çº¿è®¡ç®— ä¸ å®æ—¶è®¡ç®— 2.1 ç¦»çº¿è®¡ç®— - æ‰¹å¤„ç† (MapReduce, Spark Core, Flink DataSet API) 2.2 å®æ—¶è®¡ç®— (Spark Streamingã€Flink DataStream API) MapReduce æ ¸å¿ƒæ€æƒ³ï¼š å…ˆæ‹†åˆ†ï¼Œåœ¨åˆå¹¶ 2. MapReduce ç¼–ç¨‹æ¨¡å¼Hadoop MapReduce æ•°æ®çš„å¤„ç†æµç¨‹ï¼š WordCountç¨‹åºä¸ºä¾‹ Hadoop MapReduce 3. MapReduce ç¼–ç¨‹å®æˆ˜ WordCountMapper WordCountReducer WordCountMain Hadoop MapReduce Hadoop MapReduce WordCountMain 4. åˆ†å¸ƒå¼è®¡ç®—æ¨¡å‹MapReduce è®¡ç®—æ¨¡å‹çš„æ¥æºï¼š PageRank é—®é¢˜ å¯åŠ¨ Hadoop &amp; Yarnï¼š æ‰§è¡Œ MapReduceï¼š Hadoop MapReduce æ‰§è¡Œç»“æœï¼š Hadoop MapReduce 5. å…¶ä»–çš„ä¸€äº›çŸ¥è¯†: Hadoop MapReduce 6. MapReduce åœ¨ Hadoop ä¸­çš„ä½ç½®Hadoop MapReduce Reference å¤§æ•°æ®å¼€å‘ç³»åˆ—ç›´æ’­è¯¾ â‘¢","categories":[{"name":"hadoop","slug":"hadoop","permalink":"http://iequa.com/categories/hadoop/"}],"tags":[{"name":"MapReduce","slug":"MapReduce","permalink":"http://iequa.com/tags/MapReduce/"}]},{"title":"Hadoop Tutorial - HDFS","slug":"hadoop/HDFS-Introduce","date":"2018-07-15T12:07:21.000Z","updated":"2020-12-04T01:09:07.915Z","comments":true,"path":"2018/07/15/hadoop/HDFS-Introduce/","link":"","permalink":"http://iequa.com/2018/07/15/hadoop/HDFS-Introduce/","excerpt":"","text":"åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»ŸHDFS: æ ¸å¿ƒåŸç†ä¸æ“ä½œ å¦‚ä½•å­¦ä¹ å¤§æ•°æ®? æ€æƒ³ã€æ¶æ„ã€åŸç† (éå¸¸é‡è¦) æ­å»ºç¯å¢ƒ (å»ºè®®: Apacheç‰ˆæœ¬) 1. ä»€ä¹ˆæ˜¯å¤§æ•°æ® Volume, Velocity, Variety, Value, Veracity å•†å“æ¨èï¼š Q1ï¼š å¤§é‡çš„è®¢å•å¦‚ä½•å­˜å‚¨ ?Q2ï¼š å¤§é‡çš„è®¢å•å¦‚ä½•è®¡ç®— ? å¤§æ•°æ®çš„æ ¸å¿ƒé—®é¢˜æ˜¯? æ•°æ®çš„å­˜å‚¨ æ•°æ®çš„è®¡ç®— 2. åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿåˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿçš„æ ¸å¿ƒåŸç† Q1ï¼š ç¡¬ç›˜ä¸å¤Ÿå¤§ å¤šå‡ ä¸ªç¡¬ç›˜ Q2ï¼š ç¡¬ç›˜ä¸å¤Ÿå®‰å…¨ å¤šå­˜å‡ ä»½ HDFSçš„é»˜è®¤çš„ æ•°æ®åº“å†—ä½™åº¦ï¼š 3 ä¸»ä»æ¶æ„ HDFSã€Yarnã€Hbaseã€Stormã€Sparkã€Flink éƒ½æ˜¯ä¸»ä»æ¶æ„ å­˜åœ¨çš„é—®é¢˜ï¼š å•ç‚¹æ•…éšœ Zookeeper: HA (Hadoopçš„HAå®ç°æ¶æ„) .. âœ hdfs dfsadmin -reportâœ jps43501 DataNode43502 NameNode43503 SecondaryNameNode 3. æ“ä½œ HDFS å‘½ä»¤è¡Œ Web Consoleï¼š ç«¯å£ 9870 Javaç¨‹åº 4. HDFS è¿›é˜¶ å›æ”¶ç«™ å®‰å…¨æ¨¡å¼ é…é¢ æƒé™ç®¡ç† å¿«ç…§ Reference å¤§æ•°æ®å¼€å‘ç³»åˆ—ç›´æ’­è¯¾ â‘¢","categories":[{"name":"hadoop","slug":"hadoop","permalink":"http://iequa.com/categories/hadoop/"}],"tags":[{"name":"hdfs","slug":"hdfs","permalink":"http://iequa.com/tags/hdfs/"}]},{"title":"Neural Networks and Deep Learning (week4) - Deep Neural Networks","slug":"deeplearning/Neural-Networks-and-Deep-Learning-week4","date":"2018-07-15T12:00:21.000Z","updated":"2019-10-20T04:30:35.015Z","comments":true,"path":"2018/07/15/deeplearning/Neural-Networks-and-Deep-Learning-week4/","link":"","permalink":"http://iequa.com/2018/07/15/deeplearning/Neural-Networks-and-Deep-Learning-week4/","excerpt":"æœ¬å‘¨é‡ç‚¹ä»»åŠ¡æ˜¯ä½¿ç”¨Pythonè¦å®ç°ä¸€ä¸ªä»»æ„å±‚çš„ç¥ç»ç½‘ç»œ, å¹¶åœ¨catæ•°æ®ä¸Šæµ‹è¯•.","text":"æœ¬å‘¨é‡ç‚¹ä»»åŠ¡æ˜¯ä½¿ç”¨Pythonè¦å®ç°ä¸€ä¸ªä»»æ„å±‚çš„ç¥ç»ç½‘ç»œ, å¹¶åœ¨catæ•°æ®ä¸Šæµ‹è¯•. 1. æ·±åº¦ç¥ç»ç½‘ç»œä¸­çš„å¸¸ç”¨ç¬¦å·å›é¡¾åœ¨ä¸Šä¸€å‘¨çš„å†…å®¹ä¸­, ä»‹ç»äº†ç¥ç»ç½‘ç»œä¸­çš„å¸¸ç”¨ç¬¦å·ä»¥åŠå„ç§å˜é‡çš„ç»´åº¦. ä¸æ¸…æ¥šçš„å¯ä»¥å›é¡¾ä¸Šå‘¨çš„ç¬”è®°å†…å®¹. 2. Intuition about deep representationå…³äºæ·±åº¦ç¥ç»ç½‘ç»œç›´è§‚åœ°è§£é‡Šè¿™éƒ¨åˆ†ç¬”è®°æš‚ç•¥, è¯·ç›´æ¥è§‚çœ‹è¯¾ç¨‹è§†é¢‘å†…å®¹: Why deep representation?. 3. æ·±åº¦ç¥ç»ç½‘ç»œä¸­çš„å‰å‘/åå‘ä¼ æ’­åœ¨ç¬¬ä¸‰å‘¨çš„ç¬”è®°ä¸­è¯¦ç»†ä»‹ç»äº†ç¥ç»ç½‘ç»œçš„å‰å‘/åå‘ä¼ æ’­, è¿™é‡Œå®Œå…¨å¥—ç”¨, åªæ˜¯å¤šäº†å±‚æ•°è€Œå·². éœ€è¦å†è¯¦ç»†äº†è§£æ‰‹æ¨çš„åŒå­¦å¯ä»¥ä»”ç»†ç ”ç©¶ä¸Šå‘¨çš„ç¬”è®°å†…å®¹ 4. å‚æ•°ä¸è¶…å‚æ•°åœ¨ç¥ç»ç½‘ç»œä¸­å‚æ•°æŒ‡çš„æ˜¯ $W$, $b$, è¿™ä¸¤ä¸ªå‚æ•°æ˜¯é€šè¿‡æ¢¯åº¦ä¸‹é™ç®—æ³•ä¸æ–­ä¼˜åŒ–çš„. è€Œè¶…å‚æ•°æŒ‡çš„æ˜¯å­¦ä¹ ç‡, è¿­ä»£æ¬¡æ•°, å†³å®šç¥ç»ç½‘ç»œç»“æ„çš„å‚æ•°ä»¥åŠæ¿€æ´»å‡½æ•°çš„é€‰æ‹©ç­‰ç­‰, åœ¨åé¢æˆ‘ä»¬è¿˜ä¼šæåˆ° momentum, minibatch size, regularizationç­‰ç­‰. è¿™äº›éƒ½å±äºè¶…å‚æ•°, éœ€è¦æˆ‘ä»¬æ‰‹åŠ¨è®¾å®š. è¿™äº›è¶…å‚æ•°ä¹Ÿå†³å®šäº†æœ€ç»ˆçš„å‚æ•° $W$, $b$. ä¸åŒçš„è¶…å‚æ•°çš„é€‰æ‹©ä¼šå¯¼è‡´æ¨¡å‹å¾ˆå¤§çš„å·®åˆ«. æ‰€ä»¥è¶…å‚æ•°çš„é€‰æ‹©ä¹Ÿéå¸¸é‡è¦ (åé¢çš„è¯¾ç¨‹ä¼šè®²è§£å¦‚ä½•é€‰æ‹©è¶…å‚æ•°). 5. ä½¿ç”¨Pythonå®ç°æ·±åº¦ç¥ç»ç½‘ç»œDeepNeuralNetwork.py def sigmoid(z): return 1. / (1.+np.exp(-z))def relu(Z): A = np.maximum(0,Z) return Adef leaky_relu(Z): A = np.maximum(0,Z) A[Z &lt; 0] = 0.01 * Z return Aclass DeepNeuralNetwork(): def __init__(self, layers_dim, activations): # assert (layers_dim[-1] == 1) # assert (activations[-1] == &#x27;sigmoid&#x27;) # assert (len(activations) == len(layers_dims)-1) np.random.seed(1) self.layers_dim = layers_dim self.__num_layers = len(layers_dim) self.activations = activations self.input_size = layers_dim[0] self.parameters = self.__parameters_initializer(layers_dim) self.output_size = layers_dim[-1] def __parameters_initializer(self, layers_dim): # special initialzer with np.sqrt(layers_dims[l-1]) L = len(layers_dim) parameters = &#123;&#125; for l in range(1, L): parameters[&#x27;W&#x27;+str(l)] = np.random.randn(layers_dim[l], layers_dim[l-1]) / np.sqrt(layers_dims[l-1]) parameters[&#x27;b&#x27;+str(l)] = np.zeros((layers_dim[l], 1)) return parameters def __one_layer_forward(self, A_prev, W, b, activation): Z = np.dot(W, A_prev) + b if activation == &#x27;sigmoid&#x27;: A = sigmoid(Z) if activation == &#x27;relu&#x27;: A = relu(Z) if activation == &#x27;leaky_relu&#x27;: A = leaky_relu(Z) if activation == &#x27;tanh&#x27;: A = np.tanh(Z) cache = &#123;&#x27;Z&#x27;: Z, &#x27;A&#x27;: A&#125; return A, cache def __forward_propagation(self, X): caches = [] A_prev = X caches.append(&#123;&#x27;A&#x27;: A_prev&#125;) # forward propagation by laryer for l in range(1, len(self.layers_dim)): W, b = self.parameters[&#x27;W&#x27;+str(l)], self.parameters[&#x27;b&#x27;+str(l)] A_prev, cache = self.__one_layer_forward(A_prev, W, b, self.activations[l-1]) caches.append(cache) AL = caches[-1][&#x27;A&#x27;] return AL, caches def __compute_cost(self, AL, Y): m = Y.shape[1] cost = -np.sum(Y*np.log(AL) + (1-Y)*np.log(1-AL)) / m return cost def cost_function(self, X, Y): # use the result from forward propagation and the label Y to compute cost assert (self.input_size == X.shape[0]) AL, _ = self.__forward_propagation(X) return self.__compute_cost(AL, Y) def sigmoid_backward(self, dA, Z): s = sigmoid(Z) dZ = dA * s*(1-s) return dZ def relu_backward(self, dA, Z): dZ = np.array(dA, copy=True) dZ[Z &lt;= 0] = 0 return dZ def leaky_relu_backward(self, dA, Z): dZ = np.array(dA, copy=True) dZ[Z &lt;= 0] = 0.01 return dZ def tanh_backward(self, dA, Z): s = np.tanh(Z) dZ = 1 - s*s return dZ def __linear_backward(self, dZ, A_prev, W): # assert(dZ.shape[0] == W.shape[0]) # assert(W.shape[1] == A_prev.shape[0]) m = A_prev.shape[1] dW = np.dot(dZ, A_prev.T) / m db = np.sum(dZ, axis=1, keepdims=True) / m dA_prev = np.dot(W.T, dZ) return dA_prev, dW, db def __activation_backward(self, dA, Z, activation): assert (dA.shape == Z.shape) if activation == &#x27;sigmoid&#x27;: dZ = self.sigmoid_backward(dA, Z) if activation == &#x27;relu&#x27;: dZ = self.relu_backward(dA, Z) if activation == &#x27;leaky_relu&#x27;: dZ = self.leaky_relu_backward(dA, Z) if activation == &#x27;tanh&#x27;: dZ = self.tanh_backward(dA, Z) return dZ def __backward_propagation(self, caches, Y): m = Y.shape[1] L = self.__num_layers grads = &#123;&#125; # backward propagate last layer AL, A_prev = caches[L-1][&#x27;A&#x27;], caches[L-2][&#x27;A&#x27;] dAL = - (Y/AL - (1-Y)/(1-AL)) grads[&#x27;dZ&#x27;+str(L-1)] = self.__activation_backward(dAL, caches[L-1][&#x27;Z&#x27;], self.activations[-1]) grads[&#x27;dA&#x27;+str(L-2)], \\ grads[&#x27;dW&#x27;+str(L-1)], \\ grads[&#x27;db&#x27;+str(L-1)] = self.__linear_backward(grads[&#x27;dZ&#x27;+str(L-1)], A_prev, self.parameters[&#x27;W&#x27;+str(L-1)]) # backward propagate by layer for l in reversed(range(1, L-1)): grads[&#x27;dZ&#x27;+str(l)] = self.__activation_backward(grads[&#x27;dA&#x27;+str(l)], caches[l][&#x27;Z&#x27;], self.activations[l-1]) A_prev = caches[l-1][&#x27;A&#x27;] grads[&#x27;dA&#x27;+str(l-1)], \\ grads[&#x27;dW&#x27;+str(l)], \\ grads[&#x27;db&#x27;+str(l)] = self.__linear_backward(grads[&#x27;dZ&#x27;+str(l)], A_prev, self.parameters[&#x27;W&#x27;+str(l)]) return grads def __update_parameters(self, grads, learning_rate): for l in range(1, self.__num_layers): # assert (self.parameters[&#x27;W&#x27;+str(l)].shape == grads[&#x27;dW&#x27;+str(l)].shape) # assert (self.parameters[&#x27;b&#x27;+str(l)].shape == grads[&#x27;db&#x27;+str(l)].shape) self.parameters[&#x27;W&#x27;+str(l)] -= learning_rate * grads[&#x27;dW&#x27;+str(l)] self.parameters[&#x27;b&#x27;+str(l)] -= learning_rate * grads[&#x27;db&#x27;+str(l)] def fit(self, X, Y, num_iterations, learning_rate, print_cost=False, print_num=100): for i in range(num_iterations): # forward propagation AL, caches = self.__forward_propagation(X) # compute cost cost = self.__compute_cost(AL, Y) # backward propagation grads = self.__backward_propagation(caches, Y) # update parameters self.__update_parameters(grads, learning_rate) # print cost if i % print_num == 0 and print_cost: print (&quot;Cost after iteration %i: %f&quot; %(i, cost)) return self def predict_prob(self, X): A, _ = self.__forward_propagation(X) return A def predict(self, X, threshold=0.5): pred_prob = self.predict_prob(X) threshold_func = np.vectorize(lambda x: 1 if x &gt; threshold else 0) Y_prediction = threshold_func(pred_prob) return Y_prediction def accuracy_score(self, X, Y): pred = self.predict(X) return len(Y[pred == Y]) / Y.shape[1] main.py import timeimport numpy as npimport h5pyimport matplotlib.pyplot as pltimport scipyfrom PIL import Imagefrom scipy import ndimagefrom dnn_app_utils_v2 import *%matplotlib inlineplt.rcParams[&#x27;figure.figsize&#x27;] = (5.0, 4.0) # set default size of plotsplt.rcParams[&#x27;image.interpolation&#x27;] = &#x27;nearest&#x27;plt.rcParams[&#x27;image.cmap&#x27;] = &#x27;gray&#x27;%load_ext autoreload%autoreload 2np.random.seed(1)train_x_orig, train_y, test_x_orig, test_y, classes = load_data()# Explore your datasetm_train = train_x_orig.shape[0]num_px = train_x_orig.shape[1]m_test = test_x_orig.shape[0]print (&quot;Number of training examples: &quot; + str(m_train))print (&quot;Number of testing examples: &quot; + str(m_test))print (&quot;Each image is of size: (&quot; + str(num_px) + &quot;, &quot; + str(num_px) + &quot;, 3)&quot;)print (&quot;train_x_orig shape: &quot; + str(train_x_orig.shape))print (&quot;train_y shape: &quot; + str(train_y.shape))print (&quot;test_x_orig shape: &quot; + str(test_x_orig.shape))print (&quot;test_y shape: &quot; + str(test_y.shape))# Reshape the training and test examplestrain_x_flatten = train_x_orig.reshape(train_x_orig.shape[0], -1).T # The &quot;-1&quot; makes reshape flatten the remaining dimensionstest_x_flatten = test_x_orig.reshape(test_x_orig.shape[0], -1).T# Standardize data to have feature values between 0 and 1.train_x = train_x_flatten/255.test_x = test_x_flatten/255.print (&quot;train_x&#x27;s shape: &quot; + str(train_x.shape))print (&quot;test_x&#x27;s shape: &quot; + str(test_x.shape))# Please note that the above code is from the programming assignmentimport DeepNeuralNetworklayers_dims = (12288, 20, 7, 5, 1)# layers_dims = (12288, 10, 1)# layers_dims = [12288, 20, 7, 5, 1] # 5-layer modelactivations = [&#x27;relu&#x27;, &#x27;relu&#x27;, &#x27;relu&#x27;,&#x27;sigmoid&#x27;]num_iter = 2500learning_rate = 0.0075clf = DeepNeuralNetwork(layers_dims, activations)\\ .fit(train_x, train_y, num_iter, learning_rate, True, 100)print(&#x27;train accuracy: &#123;:.2f&#125;%&#x27;.format(clf.accuracy_score(train_x, train_y)*100))print(&#x27;test accuracy: &#123;:.2f&#125;%&#x27;.format(clf.accuracy_score(test_x, test_y)*100))# output# Cost after iteration 0: 0.771749# Cost after iteration 100: 0.672053# Cost after iteration 200: 0.648263# Cost after iteration 300: 0.611507# Cost after iteration 400: 0.567047# Cost after iteration 500: 0.540138# Cost after iteration 600: 0.527930# Cost after iteration 700: 0.465477# Cost after iteration 800: 0.369126# Cost after iteration 900: 0.391747# Cost after iteration 1000: 0.315187# Cost after iteration 1100: 0.272700# Cost after iteration 1200: 0.237419# Cost after iteration 1300: 0.199601# Cost after iteration 1400: 0.189263# Cost after iteration 1500: 0.161189# Cost after iteration 1600: 0.148214# Cost after iteration 1700: 0.137775# Cost after iteration 1800: 0.129740# Cost after iteration 1900: 0.121225# Cost after iteration 2000: 0.113821# Cost after iteration 2100: 0.107839# Cost after iteration 2200: 0.102855# Cost after iteration 2300: 0.100897# Cost after iteration 2400: 0.092878# train accuracy: 98.56%# test accuracy: 80.00% 6. æœ¬å‘¨å†…å®¹å›é¡¾ æ·±åº¦ç¥ç»ç½‘ç»œä¸­çš„å‰å‘/åå‘ä¼ æ’­ å‚æ•°ä¸è¶…å‚æ•° ä½¿ç”¨Pythonå®ç°æ·±åº¦ç¥ç»ç½‘ç»œ 7. Reference ç½‘æ˜“äº‘è¯¾å ‚ - deeplearning deeplearning.ai ä¸“é¡¹è¯¾ç¨‹ä¸€ç¬¬å››å‘¨ Coursera - Deep Learning Specialization","categories":[{"name":"deeplearning","slug":"deeplearning","permalink":"http://iequa.com/categories/deeplearning/"}],"tags":[{"name":"deeplearning.ai","slug":"deeplearning-ai","permalink":"http://iequa.com/tags/deeplearning-ai/"}]},{"title":"Neural Networks and Deep Learning (week3) - Shallow Neural Networks","slug":"deeplearning/Neural-Networks-and-Deep-Learning-week3","date":"2018-07-14T06:55:21.000Z","updated":"2019-10-20T04:30:35.022Z","comments":true,"path":"2018/07/14/deeplearning/Neural-Networks-and-Deep-Learning-week3/","link":"","permalink":"http://iequa.com/2018/07/14/deeplearning/Neural-Networks-and-Deep-Learning-week3/","excerpt":"æ­£å¼è¿›å…¥ç¥ç»ç½‘ç»œçš„å­¦ä¹ . å½“ç„¶, æˆ‘ä»¬å…ˆä»ç®€å•çš„åªæœ‰ä¸€ä¸ªéšè—å±‚çš„ç¥ç»ç½‘ç»œå¼€å§‹ã€‚ åœ¨å­¦ä¹ å®Œæœ¬å‘¨å†…å®¹ä¹‹å, æˆ‘ä»¬å°†ä¼šä½¿ç”¨ Python å®ç°ä¸€ä¸ªå•ä¸ªéšè—å±‚çš„ç¥ç»ç½‘ç»œã€‚","text":"æ­£å¼è¿›å…¥ç¥ç»ç½‘ç»œçš„å­¦ä¹ . å½“ç„¶, æˆ‘ä»¬å…ˆä»ç®€å•çš„åªæœ‰ä¸€ä¸ªéšè—å±‚çš„ç¥ç»ç½‘ç»œå¼€å§‹ã€‚ åœ¨å­¦ä¹ å®Œæœ¬å‘¨å†…å®¹ä¹‹å, æˆ‘ä»¬å°†ä¼šä½¿ç”¨ Python å®ç°ä¸€ä¸ªå•ä¸ªéšè—å±‚çš„ç¥ç»ç½‘ç»œã€‚ 1. å¸¸ç”¨ç¬¦å·ä¸åŸºæœ¬æ¦‚å¿µ è¯¥ç¥ç»ç½‘ç»œå®Œå…¨å¯ä»¥ä½¿ç”¨ä¸Šä¸€å‘¨æ‰€è®²çš„è®¡ç®—å›¾æ¥è¡¨ç¤º, å’Œ $LR$ è®¡ç®—å›¾çš„åŒºåˆ«ä»…ä»…åœ¨äºå¤šäº†ä¸€ä¸ª $z$ å’Œ $a$ çš„è®¡ç®—è€Œå·². å¦‚æœä½ å·²ç»å®Œå…¨æŒæ¡äº†ä¸Šä¸€å‘¨çš„å†…å®¹, é‚£ä¹ˆå…¶å®ä½ å·²ç»çŸ¥é“äº†ç¥ç»ç½‘ç»œçš„å‰å‘ä¼ æ’­, åå‘ä¼ æ’­(æ¢¯åº¦è®¡ç®—)ç­‰ç­‰. è¦æ³¨æ„çš„æ˜¯å„ç§å‚æ•°, ä¸­é—´å˜é‡ $(a, z)$ çš„ç»´åº¦é—®é¢˜. å…³äºç¥ç»ç½‘ç»œçš„åŸºæœ¬æ¦‚å¿µ, è¿™é‡Œå°±ä¸èµ˜è¿°äº†. è§ä¸‹å›¾å›é¡¾ä¸€ä¸‹: 2. ç¥ç»ç½‘ç»œä¸­çš„å‰å‘ä¼ æ’­ æˆ‘ä»¬å…ˆä»¥ä¸€ä¸ªè®­ç»ƒæ ·æœ¬æ¥çœ‹ç¥ç»ç½‘ç»œä¸­çš„å‰å‘ä¼ æ’­.æˆ‘ä»¬åªçœ‹è¿™ä¸ªç¥ç»ç½‘ç»œä¸­çš„è¾“å…¥å±‚å’Œéšè—å±‚çš„ç¬¬ä¸€ä¸ªæ¿€æ´»å•å…ƒ(å¦‚ä¸‹å›¾å³è¾¹æ‰€ç¤º). å…¶å®è¿™å°±æ˜¯ä¸€ä¸ªLogistic Regression. ç¥ç»ç½‘ç»œä¸­è¾“å…¥å±‚å’Œéšè—å±‚ (ä¸çœ‹è¾“å‡ºå±‚), è¿™å°±ä¸å°±æ˜¯å››ä¸ªLRæ”¾åœ¨ä¸€èµ·å—? åœ¨ LR ä¸­ $z$ å’Œ $a$ çš„è®¡ç®—æˆ‘ä»¬å·²ç»æŒæ¡äº†, é‚£ä¹ˆåœ¨ç¥ç»ç½‘ç»œä¸­ $z$ å’Œ $a$ åˆæ˜¯ä»€ä¹ˆå‘¢? æˆ‘ä»¬è®°éšè—å±‚ç¬¬ä¸€ä¸ª $z$ ä¸º $z_1$, ç¬¬äºŒä¸ª $z$ è®°ä¸º $z_2$ ä»¥æ­¤ç±»æ¨.åªè¦å°†è¿™å››ä¸ª $z$ çºµå‘å åŠ åœ¨ä¸€èµ·ç§°ä¸ºä¸€ä¸ªåˆ—å‘é‡ å³å¯å¾—åˆ°ç¥ç»ç½‘ç»œä¸­è¿™ä¸€å±‚çš„ $z$ ($a$åŒç†). é‚£ä¹ˆè¿™ä¸€å±‚çš„ $w, b$ åˆæ˜¯å¦‚ä½•å¾—åˆ°çš„? åˆ«å¿˜äº†, å¯¹äºå‚æ•° $w$ æ¥è¯´, å®ƒæœ¬èº«å°±æ˜¯ä¸€ä¸ªåˆ—é¡¹é‡, é‚£ä¹ˆå®ƒæ˜¯å¦‚ä½•åšçºµå‘å åŠ çš„å‘¢? æˆ‘ä»¬åªéœ€è¦å°†å…¶è½¬ç½®å˜æˆä¸€ä¸ªæ¨ªå‘é‡, å†çºµå‘å åŠ å³å¯. å¾—åˆ°éšè—å±‚çš„ $a$ ä¹‹å, æˆ‘ä»¬å¯ä»¥å°†å…¶è§†ä¸ºè¾“å…¥, ç°åªçœ‹ç¥ç»ç½‘ç»œçš„éšè—å±‚å’Œè¾“å‡ºå±‚, æˆ‘ä»¬å‘ç°è¿™ä¸å°±æ˜¯ä¸ª $LR$ å˜›. è¿™é‡Œæ€»ç»“ä¸€ä¸‹å„ç§å˜é‡çš„ç»´åº¦ (æ³¨æ„: è¿™é‡Œæ˜¯é’ˆå¯¹ä¸€ä¸ªè®­ç»ƒæ ·æœ¬æ¥è¯´çš„, $n_L$ ä»£è¡¨çš„ $L$ å±‚çš„èŠ‚ç‚¹ä¸ªæ•°): $w.shape : (n_L, n_{(L-1)})$ $b.shape : (n_L, 1)$ $z.shape : (n_L, 1)$ $a.shape : (n_L, 1)$ é‚£ä¹ˆå¦‚æœæœ‰ $m$ ä¸ªè®­ç»ƒæ ·æœ¬è¿™äº›å˜é‡çš„ç»´åº¦åˆæ˜¯æ€æ ·çš„å‘¢. æˆ‘ä»¬æ€è€ƒå“ªäº›å˜é‡çš„ç»´åº¦ä¼šéšç€æ ·æœ¬æ•°çš„å˜åŒ–è€Œå˜åŒ–. $w$ æ˜¯å‚æ•°æ˜¾ç„¶å®ƒçš„ç»´åº¦æ˜¯ä¸ä¼šå˜çš„. è€Œè¾“å…¥æ¯ä¸€ä¸ªæ ·æœ¬éƒ½ä¼šæœ‰ä¸€ä¸ª $z$ å’Œ $a$, è¿˜è®°å¾— $X$ çš„å½¢å¼å—? åŒæ ·åœ°, $Z$ å°±æ˜¯å°†æ¯ä¸ªæ ·æœ¬ç®—å‡ºæ¥çš„ $z$ æ¨ªå‘å åŠ (AåŒç†). å…·ä½“è®¡ç®—è¿‡ç¨‹å¦‚ä¸‹å›¾: 3. ç¥ç»ç½‘ç»œä¸­çš„æ¿€æ´»å‡½æ•°å››ç§å¸¸ç”¨çš„æ¿€æ´»å‡½æ•°: Sigmoid, Tanh, ReLU, Leaky ReLU. å…¶ä¸­ sigmoid æˆ‘ä»¬å·²ç»è§è¿‡äº†, å®ƒçš„è¾“å‡ºå¯ä»¥çœ‹æˆä¸€ä¸ªæ¦‚ç‡å€¼, å¾€å¾€ç”¨åœ¨è¾“å‡ºå±‚. å¯¹äºä¸­é—´å±‚æ¥è¯´, å¾€å¾€æ˜¯ReLUçš„æ•ˆæœæœ€å¥½. Tanh æ•°æ®å¹³å‡å€¼ä¸º 0ï¼Œå…·æœ‰æ•°æ®ä¸­å¿ƒåŒ–çš„æ•ˆæœï¼Œå‡ ä¹åœ¨ä»»ä½•åœºåˆéƒ½ä¼˜äº Sigmoid ä»¥ä¸Šæ¿€æ´»å‡½æ•°çš„å¯¼æ•°è¯·è‡ªè¡Œåœ¨è‰ç¨¿çº¸ä¸Šæ¨å¯¼. derivative of sigmoid activation function derivative of tanh activation function derivative of ReLU and Leaky ReLU activation function ä¸ºä»€ä¹ˆéœ€è¦æ¿€æ´»å‡½æ•°? å¦‚æœæ²¡æœ‰æ¿€æ´»å‡½æ•°, é‚£ä¹ˆä¸è®ºå¤šå°‘å±‚çš„ç¥ç»ç½‘ç»œéƒ½åªç›¸å½“äºä¸€ä¸ªLR. è¯æ˜å¦‚ä¸‹: it turns out that if you use a linear activation function or alternatively if you donâ€™t have an activation function, then no matter how many layers your neural network has, always doing just computing a linear activation function, so you might as well not have any hidden layers. so unless you throw a non-linearity in there, then youâ€™re not computing more interesting functions. ä½ å¯ä»¥åœ¨éšè—å±‚ç”¨ tanhï¼Œè¾“å‡ºå±‚ç”¨ sigmoidï¼Œè¯´æ˜ä¸åŒå±‚çš„æ¿€æ´»å‡½æ•°å¯ä»¥ä¸ä¸€æ ·ã€‚ ç°å®æƒ…å†µæ˜¯ : the tanh is pretty much stricly superior. never use sigmoid ReLU (rectified linear unit çŸ«æ­£çº¿æ€§å•å…ƒ) tanh å’Œ sigmoid éƒ½æœ‰ä¸€ä¸ªç¼ºç‚¹ï¼Œå°±æ˜¯ z éå¸¸å¤§æˆ–è€…éå¸¸å°ï¼Œå‡½æ•°çš„æ–œç‡(å¯¼æ•°æ¢¯åº¦)å°±ä¼šéå¸¸å°, æ¢¯åº¦ä¸‹é™å¾ˆæ…¢. the slope of the function you know ends up being close to zero, and so this can slow down gradient descent ReLU (rectified linear unit) is well, z = 0 çš„æ—¶å€™ï¼Œä½ å¯ä»¥ç»™å¯¼æ•°èµ‹å€¼ä¸º 0 or 1ï¼Œè™½ç„¶è¿™ä¸ªç‚¹æ˜¯ä¸å¯å¾®çš„. ä½†å®ç°æ²¡æœ‰å½±å“. è™½ç„¶ z &lt; 0, çš„æ—¶å€™ï¼Œæ–œç‡ä¸º0ï¼Œ ä½†åœ¨å®è·µä¸­ï¼Œæœ‰è¶³å¤Ÿå¤šçš„éšè—å•å…ƒ ä»¤ z &gt; 0, å¯¹å¤§å¤šæ•°è®­ç»ƒæ ·æœ¬æ¥è¯´æ˜¯å¾ˆå¿«çš„. Notes: so the one place you might use as linear activation function, others usually in the output layer. 4. ç¥ç»ç½‘ç»œä¸­çš„åå‘ä¼ æ’­ back propagation åå‘ä¼ æ’­æœ€ä¸»è¦çš„å°±æ˜¯è®¡ç®—æ¢¯åº¦, åœ¨ä¸Šä¸€å‘¨çš„å†…å®¹ä¸­, æˆ‘ä»¬å·²ç»çŸ¥é“äº†LRæ¢¯åº¦çš„è®¡ç®—. åŒæ ·çš„æ–¹å¼, æˆ‘ä»¬ä½¿ç”¨è®¡ç®—å›¾æ¥è®¡ç®—ç¥ç»ç½‘ç»œä¸­çš„å„ç§æ¢¯åº¦. dz^{\\[2\\]} = \\frac{dL}{dz}= \\frac{dL}{da^{\\[2\\]}}\\frac{da^{\\[2\\]}}{dz^{\\[2\\]}}=a^{\\[2\\]}-y dW^{\\[2\\]}=\\frac{dL}{dW^{\\[2\\]}}=\\frac{dL}{dz^{\\[2\\]}}\\frac{dz^{\\[2\\]}}{dW^{\\[2\\]}}=dz^{\\[2\\]}a^{\\[1\\]} db^{\\[2\\]}=\\frac{dL}{db^{\\[2\\]}}=\\frac{dL}{dz^{\\[2\\]}}\\frac{dz^{\\[2\\]}}{db^{\\[2\\]}}=dz^{\\[2\\]} backward propagation : dz^{\\[1\\]} = \\frac{dL}{dz^{\\[2\\]}}\\frac{dz^{\\[2\\]}}{da^{\\[1\\]}}\\frac{da^{\\[1\\]}}{dz^{\\[1\\]}}=W^{\\[2\\]T}dz^{\\[2\\]}*g^{\\[1\\]â€™}(z^{\\[1\\]}) dW^{\\[1\\]}=\\frac{dL}{dW^{\\[1\\]}}=\\frac{dL}{dz^{\\[1\\]}}\\frac{dz^{\\[1\\]}}{dW^{\\[1\\]}}=dz^{\\[1\\]}x^T db^{\\[1\\]}=\\frac{dL}{db^{\\[1\\]}}=\\frac{dL}{dz^{\\[1\\]}}\\frac{dz^{\\[1\\]}}{db^{\\[1\\]}}=dz^{\\[1\\]} Notes: $\\frac{dL}{dz^{[2]}} = dz^{[2]}$ ï¼Œ $\\frac{dz^{[2]}}{da^{[1]}} = W^{[2]}$ ï¼Œ $\\frac{da^{[1]}}{dz^{[1]}}=g^{[1]â€™}(z^{[1]})$ ä¸‹å›¾å³è¾¹ä¸ºåœ¨$m$ä¸ªè®­ç»ƒæ ·æœ¬ä¸Šçš„å‘é‡åŒ–è¡¨è¾¾: Notes: $n^[0]$ = input features $n^[1]$ = hidden units $n^[2]$ = output units 5. ç¥ç»ç½‘ç»œä¸­çš„å‚æ•°åˆå§‹åŒ–åœ¨ LR ä¸­æˆ‘ä»¬çš„å‚æ•° $w$ åˆå§‹åŒ–ä¸º 0, å¦‚æœåœ¨ç¥ç»ç½‘ç»œä¸­ä¹Ÿæ˜¯ç”¨ç›¸åŒçš„åˆå§‹åŒ–, é‚£ä¹ˆä¸€ä¸ªéšè—å±‚çš„æ¯ä¸ªèŠ‚ç‚¹éƒ½æ˜¯ç›¸åŒçš„, ä¸è®ºè¿­ä»£å¤šå°‘æ¬¡. è¿™æ˜¾ç„¶æ˜¯ä¸åˆç†çš„, æ‰€ä»¥æˆ‘ä»¬åº”è¯¥ éšæœºåœ°åˆå§‹åŒ– $w$ ä»è€Œè§£å†³è¿™ä¸ª sysmmetry breaking problem. ç ´åå¯¹ç§°é—®é¢˜ å…·ä½“åˆå§‹åŒ–ä»£ç å¯å‚è§ä¸‹å›¾, å…¶ä¸­ ä¹˜ä»¥ 0.01 æ˜¯ä¸ºäº†è®©å‚æ•° $w$ è¾ƒå°, åŠ é€Ÿæ¢¯åº¦ä¸‹é™ å¦‚æ¿€æ´»å‡½æ•°ä¸º tanh æ—¶, è‹¥å‚æ•°è¾ƒå¤§åˆ™ $z$ ä¹Ÿè¾ƒå¤§, æ­¤æ—¶çš„æ¢¯åº¦æ¥è¿‘äº 0, æ›´æ–°ç¼“æ…¢. å¦‚ä¸æ˜¯ tanh or sigmoid åˆ™é—®é¢˜ä¸å¤§. this is a relatively shallow neural network without too many hidden layers, so 0.01 maybe work ok. finally it turns out that sometimes there can be better constants than 0.01. $b$ å¹¶æ²¡æœ‰è¿™ä¸ª sysmmetry breaking problem, æ‰€ä»¥å¯ä»¥ $np.zeros((2, 1))$ 6. ç”¨Pythonæ­å»ºç®€å•ç¥ç»ç½‘ç»œä½¿ç”¨Python+Numpyå®ç°ä¸€ä¸ªç®€å•çš„ç¥ç»ç½‘ç»œ. ä»¥ä¸‹ä¸ºå‚è€ƒä»£ç  SimpleNeuralNetwork.py def sigmoid(z): return 1. / (1.+np.exp(-z))class SimpleNeuralNetwork(): # simple neural network with one hidden layer def __init__(self, input_size, hidden_layer_size): self.paramters = self.__parameter_initailizer(input_size, hidden_layer_size) def __parameter_initailizer(self, n_x, n_h): # W cannot be initialized with zeros W1 = np.random.randn(n_h, n_x) * 0.01 b1 = np.zeros((n_h, 1)) W2 = np.random.randn(1, n_h) * 0.01 b2 = np.zeros((1, 1)) return &#123;&#x27;W1&#x27;: W1,&#x27;b1&#x27;: b1,&#x27;W2&#x27;: W2,&#x27;b2&#x27;: b2&#125; def __forward_propagation(self, X): W1 = self.paramters[&#x27;W1&#x27;] b1 = self.paramters[&#x27;b1&#x27;] W2 = self.paramters[&#x27;W2&#x27;] b2 = self.paramters[&#x27;b2&#x27;] # forward propagation Z1 = np.dot(W1, X) + b1 A1 = np.tanh(Z1) Z2 = np.dot(W2, A1) + b2 A2 = sigmoid(Z2) cache = &#123;&#x27;Z1&#x27;: Z1,&#x27;A1&#x27;: A1,&#x27;Z2&#x27;: Z2,&#x27;A2&#x27;: A2&#125; return A2, cache def __compute_cost(self, A2, Y): m = A2.shape[1] cost = -np.sum(Y*np.log(A2) + (1-Y)*np.log(1-A2)) / m return cost def cost_function(self, X, Y): # use the result from forward propagation and the label Y to compute cost A2, cache = self.__forward_propagation(X) cost = self.__compute_cost(A2, Y) return cost def __backward_propagation(self, cache, Y): A1, A2 = cache[&#x27;A1&#x27;], cache[&#x27;A2&#x27;] W2 = self.paramters[&#x27;W2&#x27;] m = X.shape[1] # backward propagation computes gradients dZ2 = A2 - Y dW2 = np.dot(dZ2, A1.T) / m db2 = np.sum(dZ2, axis=1, keepdims=True) / m dZ1 = np.dot(W2.T, dZ2) * (1 - np.power(A1, 2)) dW1 = np.dot(dZ1, X.T) / m db1 = np.sum(dZ1, axis=1, keepdims=True) / m grads = &#123;&#x27;dW1&#x27;: dW1,&#x27;db1&#x27;: db1,&#x27;dW2&#x27;: dW2,&#x27;db2&#x27;: db2&#125; return grads def __update_parameters(self, grads, learning_rate): self.paramters[&#x27;W1&#x27;] -= learning_rate * grads[&#x27;dW1&#x27;] self.paramters[&#x27;b1&#x27;] -= learning_rate * grads[&#x27;db1&#x27;] self.paramters[&#x27;W2&#x27;] -= learning_rate * grads[&#x27;dW2&#x27;] self.paramters[&#x27;b2&#x27;] -= learning_rate * grads[&#x27;db2&#x27;] def fit(self, X, Y, num_iterations, learning_rate, print_cost=False, print_num=100): for i in range(num_iterations): # forward propagation A2, cache = self.__forward_propagation(X) # compute cost cost = self.cost_function(X, Y) # backward propagation grads = self.__backward_propagation(cache, Y) # update parameters self.__update_parameters(grads, learning_rate) # print cost if i % print_num == 0 and print_cost: print (&quot;Cost after iteration %i: %f&quot; %(i, cost)) return self def predict_prob(self, X): # result of forward_propagation is the probability A2, _ = self.__forward_propagation(X) return A2 def predict(self, X, threshold=0.5): pred_prob = self.predict_prob(X) threshold_func = np.vectorize(lambda x: 1 if x &gt; threshold else 0) Y_prediction = threshold_func(pred_prob) return Y_prediction def accuracy_score(self, X, Y): pred = self.predict(X) return len(Y[pred == Y]) / Y.shape[1] main.py # Package importsimport numpy as npimport matplotlib.pyplot as pltfrom testCases import *import sklearnimport sklearn.datasetsimport sklearn.linear_modelfrom planar_utils import plot_decision_boundary, sigmoid, load_planar_dataset, load_extra_datasets%matplotlib inlinenp.random.seed(1) # set a seed so that the results are consistentX, Y = load_planar_dataset()# Please note that the above code is from the programming assignmentimport SimpleNeuralNetworknp.random.seed(3)num_iter = 10001learning_rate = 1.2input_size = X.shape[0]hidden_layer_size = 4clf = SimpleNeuralNetwork(input_size=input_size, hidden_layer_size=hidden_layer_size)\\ .fit(X, Y, num_iter, learning_rate, True, 1000)train_acc = clf.accuracy_score(X, Y)print(&#x27;training accuracy: &#123;&#125;%&#x27;.format(train_acc*100))# output# Cost after iteration 0: 0.693162# Cost after iteration 1000: 0.258625# Cost after iteration 2000: 0.239334# Cost after iteration 3000: 0.230802# Cost after iteration 4000: 0.225528# Cost after iteration 5000: 0.221845# Cost after iteration 6000: 0.219094# Cost after iteration 7000: 0.220628# Cost after iteration 8000: 0.219400# Cost after iteration 9000: 0.218482# Cost after iteration 10000: 0.217738# training accuracy: 90.5%for hidden_layer_size in [1, 2, 3, 4, 5, 20, 50]: clf = SimpleNeuralNetwork(input_size=input_size, hidden_layer_size=hidden_layer_size)\\ .fit(X, Y, num_iter, learning_rate, False) print(&#x27;&#123;&#125; hidden units, cost: &#123;&#125;, accuracy: &#123;&#125;%&#x27; .format(hidden_layer_size, clf.cost_function(X, Y), clf.accuracy_score(X, Y)))# output# 1 hidden units, cost: 0.6315593779798304, accuracy: 67.5%# 2 hidden units, cost: 0.5727606525435293, accuracy: 67.25%# 3 hidden units, cost: 0.2521014374551156, accuracy: 91.0%# 4 hidden units, cost: 0.24703039056643344, accuracy: 91.25%# 5 hidden units, cost: 0.17206481441467936, accuracy: 91.5%# 20 hidden units, cost: 0.16003869681611513, accuracy: 92.25%# 50 hidden units, cost: 0.16000569403994763, accuracy: 92.5% 7. æœ¬å‘¨å†…å®¹å›é¡¾ å­¦ä¹ äº†ç¥ç»ç½‘ç»œçš„åŸºæœ¬æ¦‚å¿µ æŒæ¡äº†ç¥ç»ç½‘ç»œä¸­å„ç§å˜é‡çš„ç»´åº¦ æŒæ¡äº†ç¥ç»ç½‘ç»œä¸­çš„å‰å‘ä¼ æ’­ä¸åå‘ä¼ æ’­ äº†è§£äº†ç¥ç»ç½‘ç»œä¸­çš„æ¿€æ´»å‡½æ•° å­¦ä¹ äº†ç¥ç»ç½‘ç»œä¸­å‚æ•°åˆå§‹åŒ–çš„é‡è¦æ€§ æŒæ¡äº†ä½¿ç”¨Pythonå®ç°ç®€å•çš„ç¥ç»ç½‘ç»œ Reference ç½‘æ˜“äº‘è¯¾å ‚ - deeplearning deeplearning.ai ä¸“é¡¹è¯¾ç¨‹ä¸€ç¬¬ä¸‰å‘¨ Coursera - Deep Learning Specialization","categories":[{"name":"deeplearning","slug":"deeplearning","permalink":"http://iequa.com/categories/deeplearning/"}],"tags":[{"name":"deeplearning.ai","slug":"deeplearning-ai","permalink":"http://iequa.com/tags/deeplearning-ai/"}]},{"title":"Spark Intrduce 2 - RDD","slug":"spark/spark-review-2","date":"2018-07-07T12:07:21.000Z","updated":"2020-12-04T01:11:01.843Z","comments":true,"path":"2018/07/07/spark/spark-review-2/","link":"","permalink":"http://iequa.com/2018/07/07/spark/spark-review-2/","excerpt":"","text":"1. Spark æ˜¯ä»€ä¹ˆ? SQL, Oracle, Spark Oracle == æ±½è½¦ hadoop == é£æœº SQL == é©¾ç…§ Spark è®©SQLå¹¶è¡Œè¿è¡Œ == SQLåŠ é€Ÿå™¨ Spark æ˜¯è®¡ç®—å¼•æ“ 2. Spark æ‰§è¡Œè¿‡ç¨‹ HiveOnSpark vs SparkSQL Store MR HiveOnSpark, Hive SQL å¯ä»¥ç”¨ Spark æ‰§è¡Œå¼•æ“, ä½†æ˜¯è¿™æ ·è°ƒä¼˜èµ·æ¥å¾ˆéº»çƒ¦ SparkSQL æ¯” Hive on Spark å¥½ä¸€ç‚¹. 3. Spark çš„èµ·æº 4. Spark çš„æ¶æ„å›¾ Spark 2.x python &amp; Java æ€§èƒ½ 1:1 Spark DataFrame ä¸ pandas Dataframe æ²¡å…³ç³»ï¼Œä½†æ˜¯å¯ä»¥äº’ç›¸è½¬æ¢ to_pandas to_spark DataSets : for Java Dataframe : for Python SQL : SQL æ¡æ¡å¤§è·¯é€šç½—é©¬ Spark é€‚åˆå¤§è§„æ¨¡æœºå™¨å­¦ä¹ ï¼Œä¸é€‚åˆæ·±åº¦å­¦ä¹ (tensorflowé€‚åˆæ·±åº¦å­¦ä¹ )ï¼Œè¿™æ ·ç†è§£å¯¹ä¹ˆï¼Ÿ 5. RDD çš„äº”ä¸ªç‰¹æ€§ 6. Spark Api å¦‚ä½•ä½¿ç”¨1. PYSPARK_PYTHON2. JAVA_HOME3. SPARK_HOME4. PYLIB (os.environ[&quot;PYLIB&quot;]=os.environ[&quot;SPARK_HOME&quot;] + &quot;/python/lib&quot;) PYLIB maybe not setting export PYSPARK_PYTHON=/Users/blair/.pyenv/versions/anaconda3/envs/spark/bin/python3export PYSPARK_DRIVER_PYTHON=â€jupyterâ€export PYSPARK_DRIVER_PYTHON_OPTS=â€notebookâ€ ä»¥ä¸‹æ˜¯ Mars çš„è®¾ç½® ï¼ˆæˆ‘ä»¬ç›´æ¥ç”¨pyspark, åˆ™ä¸ç”¨ç›´æ¥è¿™æ ·æ˜¾ç¤ºåœ¨ç¨‹åºä¸­æŒ‡å®šï¼‰ï¼šos.environ[&quot;PYSPARK_PYTHON&quot;]=&quot;C:/Users/netease/Anaconda3/python.exe&quot;os.environ[&quot;JAVA_HOME&quot;]=&quot;C:/Program Files/Java/jdk1.8.0_144&quot;os.environ[&quot;SPARK_HOME&quot;]=&quot;c:/spark&quot;os.environ[&quot;PYLIB&quot;]=os.environ[&quot;SPARK_HOME&quot;] + &quot;/python/lib&quot;sys.path.insert(0,os.environ[&quot;PYLIB&quot;] + &quot;/py4j-0.10.7-src.zip&quot; )sys.path.insert(0,os.environ[&quot;PYLIB&quot;] + &quot;/pyspark.zip&quot; ) 7. åˆ©ç”¨ Pyspark å®Œæˆ WordCountfrom pyspark import SparkConf , SparkContextprint(sc.version)lines = sc.textFile(&quot;/Users/blair/ghome/github/spark3.0/pyspark/spark-src/word_count.text&quot;, 2)lines.take(3)words= lines.flatMap(lambda x : x.split(&quot; &quot;))words.take(3)wordCounts = words.countByValue()for word,count in wordCounts.items(): print(&quot;&#123;&#125; : &#123;&#125;&quot;.format(word,count)) å¦‚æœæœ‰3ä¸ªèŠ‚ç‚¹, åˆ™ä¸‹åˆ—æ–¹æ³•å¯ä»¥æŸ¥çœ‹ï¼Œæ•°æ®åˆ†å¸ƒåœ¨ä¸åŒçš„ partition def indexedFunc(parindex,pariter): return [&quot;partition : &#123;&#125; =&gt; &#123;&#125;&quot;.format(parindex,x) for x in pariter] words.mapPartitionsWithIndex(indexedFunc).collect() [â€˜partition : 0 =&gt; Theâ€™,â€˜partition : 0 =&gt; historyâ€™,â€˜partition : 0 =&gt; ofâ€™,â€˜partition : 0 =&gt; Newâ€™,â€˜partition : 0 =&gt; Yorkâ€™,â€˜partition : 0 =&gt; beginsâ€™,â€˜partition : 0 =&gt; aroundâ€™,â€˜partition : 0 =&gt; 10,000â€™, æŸ¥çœ‹ spark è¿è¡ŒçŠ¶æ€ï¼š http://localhost:8080/ æŸ¥çœ‹ spark Jobs çŠ¶æ€ï¼šhttp://localhost:4040/jobs/ çŸ¥è¯†æ‘˜è¦: å¦‚æœç”¨ Hadoop Mapreduce æ¥å®Œæˆ, åˆ™ä»£ç å†™èµ·æ¥éº»çƒ¦å¹¶ç¹å¤š. Spark æ˜¯ å†…å­˜ç‰ˆçš„ Mapreduce, Mapreduce å¯ä»¥è¯´æ˜¯æ‰€æœ‰åˆ†å¸ƒå¼è®¡ç®—çš„é¼»ç¥–. Spark éœ€è¦åšæ€§èƒ½è°ƒä¼˜çš„æ—¶å€™ï¼Œè¿˜å¾—å†çœ‹ Mapreduce çš„çŸ¥è¯†æ¥ä¿®å¤. 8. Spark æ‰§è¡Œå›¾ Reference å¤§æ•°æ®å…¥é—¨ä¸å®æˆ˜-PySparkçš„ä½¿ç”¨æ•™ç¨‹ Python - lru_cacheå’Œsingledispatchè£…é¥°å™¨ å¤§æ•°æ®å¼€å‘ç³»åˆ—ç›´æ’­è¯¾ â‘¢ PySpark-æ•°æ®æ“ä½œ-DataFrame æ ªå¼ä¼šç¤¾XG JAPAN æ—¥æœ¬æŠ•èµ„ | è¿‡æ¥äººå‘Šè¯‰ä½ ï¼šæ—¥æœ¬åˆ›ä¸šç§»æ°‘çš„è´¹ç”¨å’Œå‘","categories":[{"name":"spark","slug":"spark","permalink":"http://iequa.com/categories/spark/"}],"tags":[{"name":"spark","slug":"spark","permalink":"http://iequa.com/tags/spark/"}]},{"title":"Neural Networks and Deep Learning (week2) - Neural Networks Basics","slug":"deeplearning/Neural-Networks-and-Deep-Learning-week2","date":"2018-07-07T01:55:21.000Z","updated":"2019-10-20T04:30:35.022Z","comments":true,"path":"2018/07/07/deeplearning/Neural-Networks-and-Deep-Learning-week2/","link":"","permalink":"http://iequa.com/2018/07/07/deeplearning/Neural-Networks-and-Deep-Learning-week2/","excerpt":"æœ¬å‘¨æˆ‘ä»¬å°†è¦å­¦ä¹  Logistic Regression, å®ƒæ˜¯ç¥ç»ç½‘ç»œçš„åŸºç¡€. Logistic Regression å¯ä»¥çœ‹æˆæ˜¯ä¸€ç§åªæœ‰è¾“å…¥å±‚å’Œè¾“å‡ºå±‚(æ²¡æœ‰éšè—å±‚)çš„ç¥ç»ç½‘ç»œ.","text":"æœ¬å‘¨æˆ‘ä»¬å°†è¦å­¦ä¹  Logistic Regression, å®ƒæ˜¯ç¥ç»ç½‘ç»œçš„åŸºç¡€. Logistic Regression å¯ä»¥çœ‹æˆæ˜¯ä¸€ç§åªæœ‰è¾“å…¥å±‚å’Œè¾“å‡ºå±‚(æ²¡æœ‰éšè—å±‚)çš„ç¥ç»ç½‘ç»œ. ä¸€. åŸºæœ¬æ¦‚å¿µå›é¡¾è¿™æ¬¡ Andrew ç³»åˆ—è¯¾ç¨‹åœ¨ç¬¦å·ä¸Šæœ‰æ‰€æ”¹åŠ¨ (å’Œæœºå™¨å­¦ä¹ è¯¾ç¨‹ä¸­æœ‰æ‰€åŒºåˆ«, ä¸»è¦æ˜¯ä¸ºäº†åé¢ä»£ç å®ç°æ–¹ä¾¿), å¦‚ä¸‹å›¾æ‰€ç¤º: 1. Notationæ›´å¤šå…³äºæœ¬ç³»åˆ—è¯¾ç¨‹çš„ç¬¦å·ç‚¹è¿™é‡ŒåŒæ ·åœ°, å‚æ•°ä¹Ÿæœ‰æ‰€å˜åŒ– ($bias$ å•ç‹¬æ‹¿å‡ºæ¥ä½œä¸º$b$, è€Œä¸æ˜¯æ·»åŠ  $\\theta_0$) 2. Logistic Regression ä¸€ä¸ªæ˜¯ Loss function, å³æŸå¤±å‡½æ•°, å®ƒä»£è¡¨äº†å¯¹äºä¸€ä¸ªæ ·æœ¬ä¼°è®¡å€¼ä¸çœŸå®å€¼ä¹‹é—´çš„è¯¯å·®; ä¸€ä¸ªæ˜¯ Cost function, å®ƒä»£è¡¨äº†æ‰€æœ‰æ ·æœ¬lossçš„å¹³å‡å€¼. 3. Logistic Regression Cost Function 4. Gradient Descent 5. Derivatives 7. Computation Graphç¥ç»ç½‘ç»œä¸­, forward propagation ç”¨æ¥è®¡ç®—è¾“å‡º, backward propagation ç”¨æ¥è®¡ç®—æ¢¯åº¦, å¾—åˆ°æ¢¯åº¦åå°±å¯æ›´æ–°å¯¹åº”çš„å‚æ•°äº†. å¦‚ä¸Šå›¾æ‰€ç¤ºé€šè¿‡å‰å‘ä¼ æ’­, æˆ‘ä»¬å¾—åˆ° $J = 33$. è¿™é‡Œè¯´æ˜ä¸€ä¸‹, åœ¨åé¢ä»£ç å®ç°ä¸­, è¿™äº›å¯¼æ•°éƒ½å¯ä»¥ç”¨ $dvar$ æ¥è¡¨ç¤º, ä¾‹å¦‚ dw1, db1 ç­‰ç­‰. 8. Computation Graph Derivativesåå‘ä¼ æ’­æœ¬è´¨ä¸Šå°±æ˜¯é€šè¿‡é“¾å¼æ³•åˆ™ä¸æ–­æ±‚å‡ºå‰é¢å„ä¸ªå˜é‡çš„å¯¼æ•°çš„è¿‡ç¨‹. 9. Logistic regression recapæœ‰äº†è®¡ç®—å›¾çš„æ¦‚å¿µä¹‹å, æˆ‘ä»¬å°†å…¶è¿ç”¨åˆ° Logistic Regression ä¸Š. ä¸Šé¢çš„å¼å­å¯ä»¥ç”¨ä¸‹é¢çš„è®¡ç®—å›¾æ¥è¡¨è¾¾: æœ‰äº†ä¸Šé¢çš„å›¾ä¹‹å, æˆ‘ä»¬ç°åœ¨æ¥è®¡ç®—åå‘ä¼ æ’­. é¦–å…ˆæˆ‘ä»¬æ¥è®¡ç®— $\\frac{dL}{da}$: \\begin{align} \\frac{dL}{da} & = - (\\frac{y}{a} - \\frac{(1-y)}{(1-a)}) \\end{align}é€šè¿‡é“¾å¼æ³•åˆ™, è®¡ç®— $\\frac{dL}{dz}$: \\begin{align} \\frac{dL}{dz} & = \\frac{dL}{da}\\frac{da}{dz} \\\\\\\\ \\\\\\\\ & = - (\\frac{y}{a} - \\frac{(1-y)}{(1-a)})\\sigma(z)(1-\\sigma(z)) \\\\\\\\ \\\\\\\\ & = - (\\frac{y}{a} - \\frac{(1-y)}{(1-a)})a(1-a)) \\\\\\\\ \\\\\\\\ & = -y(1-a) + (1-y)a \\\\\\\\ \\\\\\\\ & = a - y \\end{align}æœ€åè®¡ç®— $\\frac{dL}{dw1}, \\frac{dL}{dw2}, \\frac{dL}{db}$: \\frac{dL}{dw\\_1} = \\frac{dL}{dz}\\frac{dz}{dw\\_1} = (a - y)x\\_1 \\frac{dL}{dw\\_2} = \\frac{dL}{dz}\\frac{dz}{dw\\_2} = (a - y)x\\_2 \\frac{dL}{db} = \\frac{dL}{dz}\\frac{dz}{db} = a - yæ€ä¹ˆæ ·? æ˜¯ä¸æ˜¯å¾ˆç®€å•å‘¢? è¿™é‡Œæˆ‘ä»¬æ‰€æœ‰çš„è®¡ç®—éƒ½æ˜¯é’ˆå¯¹ä¸€ä¸ªè®­ç»ƒæ ·æœ¬çš„. å½“ç„¶æˆ‘ä»¬ä¸å¯èƒ½åªæœ‰ä¸€ä¸ªæ ·æœ¬, é‚£ä¹ˆå¯¹äºæ•´ä¸ªè®­ç»ƒé›†, æˆ‘ä»¬åº”è¯¥æ€ä¹ˆåšå‘¢? å…¶å®å¾ˆç®€å•, æˆ‘ä»¬åªéœ€è¦å°† $J(w, b)$ æ‹†å¼€æ¥å†™å°±å¾ˆæ¸…æ™°. J(w, b) = \\frac{1}{m}(L(a^{(1)}, y^{(1)}) + L(a^{(2)}, y^{(2)}) + â€¦ + L(a^{(m)}, y^{m)})) å¯¹äºæ¯ä¸€ä¸ªæ ·æœ¬éƒ½æœ‰ä¸€ä¸ªå¯¹åº”çš„ $dz^{(i)}$, è€Œå¯¹äº $dw, db$ æ¥è¯´æ˜¯å¯¹äºæ‰€æœ‰æ±‚å¹³å‡. å¦‚æœç”¨ä»¥ä¸ŠèŠ‚çš„ä¼ªä»£ç æ¥å®ç°æ¢¯åº¦è®¡ç®—çš„è¯, æ•ˆç‡ä¼šéå¸¸ä½. éœ€è¦ä¸¤ä¸ªæ˜¾å¼çš„ for å¾ªç¯.ä¸‹ä¸€èŠ‚ä»‹ç» å‘é‡åŒ–. å‘é‡åŒ–å°±æ˜¯ç”¨æ¥è§£å†³è®¡ç®—æ•ˆç‡é—®é¢˜. 11. Vectorizationè¿™æ¬¡çš„æ·±åº¦å­¦ä¹ ç³»åˆ—è¯¾ç¨‹ä½œä¸š, ä¸€å¾‹è¦æ±‚ä½¿ç”¨å‘é‡åŒ–æ¥å®ç°ä»£ç . é…åˆå¼ºå¤§çš„Numpy, å‘é‡åŒ–å…¶å®å¾ˆç®€å•. æ¥çœ‹ä¸€ä¸ªä¾‹å­: import numpy as npimport timex = 1000000#x = 10a = np.random.rand(x)b = np.random.rand(x)tic = time.time() # Python time time() è¿”å›å½“å‰æ—¶é—´çš„æ—¶é—´æˆ³ï¼ˆ1970çºªå…ƒåç»è¿‡çš„æµ®ç‚¹ç§’æ•°ï¼‰c = np.dot(a, b)toc = time.time()print(&#x27;Vectorized version:&#123;&#125;ms&#x27;.format(1000*(toc-tic)))c = 0tic = time.time()for i in range(x): c += a[i] * b[i]toc = time.time()print(&#x27;For loop:&#123;&#125;ms&#x27;.format(1000*(toc-tic))) è¾“å‡º: Vectorized version:0.881195068359375msFor loop:363.94405364990234ms ä¸¤ä¸ªç‰ˆæœ¬æ•ˆç‡ä¸Šå·®äº†400å¤šå€. ç¥ç»ç½‘ç»œæœ¬èº«è®¡ç®—å°±æ¯”è¾ƒå¤æ‚, åŠ ä¹‹æ·±åº¦å­¦ä¹ è®­ç»ƒæ ·æœ¬å¾€å¾€éƒ½å¾ˆå¤§, æ•ˆç‡å°¤ä¸ºé‡è¦. ä»»ä½•æ—¶å€™éƒ½è¦å°½å¯èƒ½é¿å…ä½¿ç”¨forå¾ªç¯. é¦–å…ˆæˆ‘ä»¬è¿›è¡Œç¬¬ä¸€æ­¥ä¼˜åŒ–, å°† $w$ å†™æˆå‘é‡çš„å½¢å¼ $dw=np.zeros((n_x, 1))$, è¿™æ ·å°±çœå»äº†å†…å±‚å…³äº $w$ çš„å¾ªç¯. æ¥ä¸‹æ¥æˆ‘ä»¬æ¥çœ‹çœ‹å¦‚ä½•ä¼˜åŒ–å…³äº$m$ä¸ªè®­ç»ƒæ ·æœ¬çš„å¾ªç¯. å›é¡¾ä¸‹ç¬¬ä¸€èŠ‚ä¸­æ‰€è¯´çš„$X$: å°†$X$ç”¨å¦‚ä¸Šçš„çŸ©é˜µè¡¨è¾¾å, é€šè¿‡ $W^T+b$ ä¹Ÿå°±å¾—åˆ°äº† $z$ çš„å‘é‡åŒ–è¡¨è¾¾. $a$ çš„å‘é‡åŒ–è¡¨è¾¾ä¹Ÿå°±æ˜¯ $z$ æ¯ä¸ªå…ƒç´ è¿›è¡Œ $\\sigma$æ“ä½œäº†.ç®€å•å§. æƒ³è¦æŠŠæ¡ä½å‘é‡åŒ–ä¸€å®šè¦æ¸…æ¥šæ¯ä¸ªå˜é‡çš„ç»´åº¦(å³pythonä»£ç é‡Œndarrayçš„shape), é‚£äº›æ˜¯çŸ©é˜µæ“ä½œ, é‚£äº›æ˜¯element-wiseæ“ä½œç­‰ç­‰. æŠŠæ¡ä½ä¸Šé¢çš„ä¹‹å, åœ¨ä»£ç å®ç°é‡Œè¿˜è¦æ³¨æ„å“ªé‡Œä¼šäº§ç”Ÿ broadcasting. ä¾‹å¦‚è¿™é‡Œçš„ $b$ å®é™…ä¸Šæ˜¯ä¸€ä¸ªscalar, ä½†åœ¨è¿›è¡Œ $W^T+b$ æ“ä½œçš„æ—¶å€™, $b$ è¢«numpyè‡ªåŠ¨broadcasting æˆå’Œ $W^T$ ç»´åº¦ä¸€æ ·çš„æ¨ªå‘é‡. æ¥ä¸‹æ¥æˆ‘ä»¬çœ‹ä¸€ä¸‹æ¢¯åº¦çš„å‘é‡åŒ–. å‰é¢æˆ‘ä»¬çŸ¥é“ $dz^{(1)}, dz^{(2)}, â€¦, dz^{(m)}$, è¿™æ ·å¾—åˆ° $dZ$ . $A$ã€$Y$ çš„å‘é‡åŒ–å‰é¢å·²çŸ¥äº†ï¼Œè¿™æ ·å…³äº $z$ çš„æ¢¯åº¦å¦‚ä¸‹æ‰€ç¤º. æœ‰äº† $dZ$ä¹‹å $db$ å°±å¾ˆç®€å•äº†, å®ƒæ˜¯æ‰€æœ‰ $dZ$ ä¸­å…ƒç´ çš„å‡å€¼. åœ¨pythonä¸­çš„ä»£ç è¡¨ç¤ºä¸º np.mean(dZ) æˆ–è€… 1/m * np.sum(a). $dW$ é€šè¿‡è§‚å¯Ÿå‘é‡çš„ç»´åº¦å¾—åˆ°. $X$ ä¸º $(n, m)$, $dZ$ ä¸º $(1, m)$, è€Œ $dW$ çš„ç»´åº¦å’Œ $W$ çš„ç»´åº¦ä¸€æ ·ä¸º $(n,1)$, è¿™æ ·å°±å¾—åˆ°äº† $dW=\\frac{1}{m}XdZ^T$. db æ˜¯ä¸€ä¸ªå‡å€¼ï¼Ÿ é€šè¿‡ä¸Šé¢çš„åŠªåŠ›, æˆ‘ä»¬å°†ä¹‹å‰forå¾ªç¯çš„ç‰ˆæœ¬æ”¹æˆäº†å®Œå…¨å‘é‡åŒ–çš„è¡¨ç¤º, è¿™æ ·å‘é‡åŒ–å®ç°çš„ä»£ç æ•ˆç‡ä¼šå¤§å¤§æé«˜. (æ³¨æ„: ppté‡Œçš„for iter in range(1000) æ˜¯è¿­ä»£æ¬¡æ•°, è¿™ä¸ªå¾ªç¯æ˜¯ä¸å¯é¿å…çš„) ä½¿ç”¨Pythonå®ç°Logistic Regressionè¿›è¡ŒçŒ«å’ªè¯†åˆ«LogisticRegression.py: def sigmoid(z): return 1. / (1.+np.exp(-z))class LogisticRegression(): def __init__(self): pass def __parameters_initializer(self, input_size): # initial parameters with zeros w = np.zeros((input_size, 1), dtype=float) b = 0.0 return w, b def __forward_propagation(self, X): m = X.shape[1] A = sigmoid(np.dot(self.w.T, X) + self.b) return A def __compute_cost(self, A, Y): m = A.shape[1] cost = -np.sum(Y*np.log(A) + (1-Y)*(np.log(1-A))) / m return cost def cost_function(self, X, Y): # use the result from forward propagation and the label Y to compute cost A = self.__forward_propagation(X) cost = self.__compute_cost(A, Y) return cost def __backward_propagation(self, A, X, Y): m = X.shape[1] # backward propagation computes gradients dw = np.dot(X, (A-Y).T) / m db = np.sum(A-Y) / m grads = &#123;&quot;dw&quot;: dw, &quot;db&quot;: db&#125; return grads def __update_parameters(self, grads, learning_rate): self.w -= learning_rate * grads[&#x27;dw&#x27;] self.b -= learning_rate * grads[&#x27;db&#x27;] def fit(self, X, Y, num_iterations, learning_rate, print_cost=False, print_num=100): self.w, self.b = self.__parameters_initializer(X.shape[0]) for i in range(num_iterations): # forward_propagation A = self.__forward_propagation(X) # compute cost cost = self.__compute_cost(A, Y) # backward_propagation grads = self.__backward_propagation(A, X, Y) dw = grads[&quot;dw&quot;] db = grads[&quot;db&quot;] # update parameters self.__update_parameters(grads, learning_rate) # print cost if i % print_num == 0 and print_cost: print (&quot;Cost after iteration &#123;&#125;: &#123;:.6f&#125;&quot;.format(i, cost)) return self def predict_prob(self, X): # result of forward_propagation is the probability A = self.__forward_propagation(X) return A def predict(self, X, threshold=0.5): pred_prob = self.predict_prob(X) threshold_func = np.vectorize(lambda x: 1 if x &gt; threshold else 0) Y_prediction = threshold_func(pred_prob) return Y_prediction // åˆ†ç±»å‡†ç¡®ç‡åˆ†æ•°æ˜¯æŒ‡æ‰€æœ‰åˆ†ç±»æ­£ç¡®çš„ç™¾åˆ†æ¯”, åˆ†ç±»å‡†ç¡®ç‡è¿™ä¸€è¡¡é‡åˆ†ç±»å™¨çš„æ ‡å‡†æ¯”è¾ƒå®¹æ˜“ç†è§£ def accuracy_score(self, X, Y): pred = self.predict(X) return len(Y[pred == Y]) / Y.shape[1] æœ¬å‘¨è¯¾ç¨‹å‰©ä¸‹éƒ¨åˆ†å››ä¸ªè§†é¢‘åˆ†åˆ«è®²è§£Broadcasting, Numpy Vector, Jupyter Notebookä»¥åŠLogistic Regressionçš„æ¦‚ç‡è§£é‡Š. å¦‚æœå¯¹äºNumpyä»¥åŠJupyter Notebookä¸ç†Ÿæ‚‰çš„åŒå­¦éœ€è¦å¥½å¥½çœ‹çœ‹è¿™ä¸‰ä¸ªè§†é¢‘ Python Broadcasting example: Notes: å¤šä½¿ç”¨ reshape æ¥ä¿è¯ä½ ç”¨çš„å‘é‡æˆ–çŸ©é˜µæ˜¯æ­£ç¡®çš„ï¼Œä¸è¦å®³æ€•ä½¿ç”¨ reshape. Notes: å¤šä½¿ç”¨ assert(a.shape == (5,1)) æœ¬å‘¨å†…å®¹å›é¡¾ äº†è§£äº†æ·±åº¦å­¦ä¹ ç³»åˆ—è¯¾ç¨‹ä¸­ä½¿ç”¨åˆ°çš„å„ç§ç¬¦å·. å›é¡¾äº†Logistic Regression. æŒæ¡äº†losså’Œcostçš„åŒºåˆ«ä¸è”ç³». é‡æ–°è®¤è¯†äº†å‰å‘åå‘ä¼ æ’­, å³è®¡ç®—å›¾. å­¦ä¹ äº†æ·±åº¦å­¦ä¹ ä¸­å¿…è¦çš„æ±‚å¯¼çŸ¥è¯†. ç†Ÿæ‚‰äº†Numpy, Jupyter Notebookçš„ä½¿ç”¨ æŒæ¡äº†ä½¿ç”¨Pythonä»¥ç¥ç»ç½‘ç»œçš„æ–¹å¼å®ç°Logistic Regressionæ¨¡å‹, å¹¶ä½¿ç”¨å¼ºå¤§çš„Numpyæ¥å‘é‡åŒ–. Reference ç½‘æ˜“äº‘è¯¾å ‚ - deeplearning deeplearning.ai ä¸“é¡¹è¯¾ç¨‹ä¸€ç¬¬äºŒå‘¨ å‘é‡ç‚¹ä¹˜ï¼ˆå†…ç§¯ï¼‰å’Œå‰ä¹˜ï¼ˆå¤–ç§¯ã€å‘é‡ç§¯ï¼‰æ¦‚å¿µåŠå‡ ä½•æ„ä¹‰è§£è¯» CPUä¼šè¢«GPUæ›¿ä»£å—ï¼ŸSIMDå’ŒSIMTè°æ›´å¥½ï¼Ÿ åˆ˜å»ºå¹³Pinard - æ¢¯åº¦ä¸‹é™ï¼ˆGradient Descentï¼‰å°ç»“ Github 01-Neural-Networks-and-Deep-Learning/week2","categories":[{"name":"deeplearning","slug":"deeplearning","permalink":"http://iequa.com/categories/deeplearning/"}],"tags":[{"name":"deeplearning.ai","slug":"deeplearning-ai","permalink":"http://iequa.com/tags/deeplearning-ai/"}]},{"title":"Ensumble é›†æˆå­¦ä¹ å°è®°","slug":"ml/ensumble-part1","date":"2018-07-03T09:43:21.000Z","updated":"2019-10-20T04:30:35.038Z","comments":true,"path":"2018/07/03/ml/ensumble-part1/","link":"","permalink":"http://iequa.com/2018/07/03/ml/ensumble-part1/","excerpt":"æœ¬æ–‡ä¸»è¦åŸºäºå‘¨å¿—åã€Šæœºå™¨å­¦ä¹ ã€‹ä¸€ä¹¦ç¬¬å…«ç«  é›†æˆå­¦ä¹ å†…å®¹åšçš„æ•´ç†ç¬”è®°ï¼Œæ­¤å¤–æŸ¥é˜…äº†ç½‘ä¸Šçš„ä¸€äº›åšå®¢å’Œé—®ç­”ç½‘ç«™","text":"æœ¬æ–‡ä¸»è¦åŸºäºå‘¨å¿—åã€Šæœºå™¨å­¦ä¹ ã€‹ä¸€ä¹¦ç¬¬å…«ç«  é›†æˆå­¦ä¹ å†…å®¹åšçš„æ•´ç†ç¬”è®°ï¼Œæ­¤å¤–æŸ¥é˜…äº†ç½‘ä¸Šçš„ä¸€äº›åšå®¢å’Œé—®ç­”ç½‘ç«™ 1. Ensumble æ¦‚å¿µEnsumble æ˜¯é€šè¿‡æ„å»ºå¹¶ç»“åˆå¤šä¸ªå­¦ä¹ å™¨æ¥å®Œæˆå­¦ä¹ ä»»åŠ¡ã€‚ æ›¾ç»å¬è¿‡ä¸€å¥è¯ï¼Œâ€Featureä¸ºä¸»ï¼ŒEnsembleä¸ºåâ€ã€‚ Feature å†³å®šäº†æ¨¡å‹æ•ˆæœçš„ä¸Šé™ï¼Œè€Œ Ensemble å°±æ˜¯è®©ä½ æ›´æ¥è¿‘è¿™ä¸ªä¸Šé™ã€‚ Ensemble è®²ç©¶â€œå¥½è€Œä¸åŒâ€ï¼Œä¸åŒæ˜¯æŒ‡æ¨¡å‹çš„å­¦ä¹ åˆ°çš„ä¾§é‡é¢ä¸ä¸€æ ·ã€‚ ä¸¾ä¸ªç›´è§‚çš„ä¾‹å­ï¼Œæ¯”å¦‚æ•°å­¦è€ƒè¯•ï¼ŒAçš„å‡½æ•°é¢˜åšçš„æ¯”Bå¥½ï¼ŒBçš„å‡ ä½•é¢˜åšçš„æ¯”Aå¥½ï¼Œé‚£ä¹ˆä»–ä»¬åˆä½œå®Œæˆçš„åˆ†æ•°é€šå¸¸æ¯”ä»–ä»¬å„è‡ªå•ç‹¬å®Œæˆçš„è¦é«˜ã€‚ å¸¸è§çš„Ensembleæ–¹æ³•æœ‰Baggingã€Boostingã€Stackingã€Blending. Notes: Stacking ä¸ Blending ç±»ä¼¼ï¼ŒåŒºåˆ«å¯å‚è§ ensumble ä¸­çš„ å¥½è€Œä¸åŒ å¦‚ä½•ä½¿å¾—é›†æˆå­¦ä¹ æ€§èƒ½æ¯”æœ€å¥½çš„å•ä¸€å­¦ä¹ å™¨æ›´å¥½ï¼Ÿ å‡†ç¡®æ€§ å¤šæ ·æ€§ å¥½è€Œä¸åŒ å¦‚ä½•äº§ç”Ÿå¹¶ç»“åˆ â€œå¥½è€Œä¸åŒâ€ çš„ä¸ªä½“å­¦ä¹ å™¨ ? é›†æˆå­¦ä¹ ç ”ç©¶çš„æ ¸å¿ƒ, å½“å‰æŒ‰ç…§ä¸ªä½“å­¦ä¹ å™¨çš„ç”Ÿæˆæ–¹å¼åˆ’åˆ†: baggingï¼ˆåŠå…¶å˜ä½“éšæœºæ£®æ—ï¼‰â€” ä¸ªä½“å­¦ä¹ å™¨é—´ä¸å­˜åœ¨å¼ºä¾èµ–å…³ç³»ï¼Œå¯åŒæ—¶ç”Ÿæˆçš„å¹¶è¡ŒåŒ–æ–¹æ³•boosting - ä¸ªä½“å­¦ä¹ å™¨é—´å­˜åœ¨å¼ºä¾èµ–å…³ç³»ï¼Œå¿…é¡»ä¸²è¡Œç”Ÿæˆçš„åºåˆ—åŒ–æ–¹æ³• ä»åå·®-æ–¹å·®åˆ†è§£çš„è§’åº¦: bagging å…³æ³¨é™ä½æ–¹å·®boosting å…³æ³¨é™ä½åå·® ä¹Ÿå¯ä»¥æŒ‰ç…§æœºå™¨å­¦ä¹ æŠ€æ³•çš„ä¸¤å¼ å›¾æ¥ç†è§£ ç¬¬ä¸€å¹…å›¾(å¯¹åº”boosting)å¯çœ‹ä½œè¿›è¡Œäº†ä¸€ä¸ªç‰¹å¾è½¬æ¢æ¥é˜²æ­¢æ¬ æ‹Ÿåˆï¼Œç¬¬äºŒå¹…å›¾(å¯¹åº”bagging)åˆ™è¿›è¡Œäº†ä¸€ä¸ªæ­£åˆ™åŒ–æ¥é˜²æ­¢è¿‡æ‹Ÿåˆ 2. Boosting é¦–å…ˆä»åˆå§‹è®­ç»ƒé›†è®­ç»ƒå‡ºä¸€ä¸ªåŸºå­¦ä¹ å™¨ï¼Œå†æ ¹æ®åŸºå­¦ä¹ å™¨çš„è¡¨ç°å¯¹è®­ç»ƒæ ·æœ¬åˆ†å¸ƒè¿›è¡Œè°ƒæ•´ï¼Œä½¿å¾—å…ˆå‰åŸºå­¦ä¹ å™¨åšé”™çš„è®­ç»ƒæ ·æœ¬åœ¨åç»­å—åˆ°æ›´å¤šçš„å…³æ³¨ï¼Œç„¶ååŸºäºè°ƒæ•´åçš„æ ·æœ¬åˆ†å¸ƒæ¥è®­ç»ƒä¸‹ä¸€ä¸ªåŸºå­¦ä¹ å™¨ï¼›å¦‚æ­¤é‡å¤è¿›è¡Œï¼Œç›´è‡³åŸºå­¦ä¹ å™¨æ•°ç›®è¾¾åˆ°äº‹å…ˆæŒ‡å®šçš„å€¼T,æœ€ç»ˆå°†è¿™Tä¸ªåŸºå­¦ä¹ å™¨è¿›è¡ŒåŠ æƒç»„åˆ. 2.1 adaboost æ¨å¯¼æ–¹å¼ï¼ŒåŸºäºâ€œåŠ æ€§æ¨¡å‹â€ï¼Œå³åŸºäºåŸºå­¦ä¹ å™¨çš„çº¿æ€§ç»„åˆå¦‚ä½•åœ¨æ¯ä¸€è½®ä¿®æ”¹æ ·æœ¬åˆ†å¸ƒ é‡èµ‹æƒæ³•ï¼šåœ¨æ¯ä¸€è½®è®­ç»ƒä¸­ï¼Œæ ¹æ®æ ·æœ¬åˆ†å¸ƒä¸ºæ¯ä¸€ä¸ªè®­ç»ƒæ ·æœ¬é‡æ–°èµ‹äºˆä¸€ä¸ªæƒé‡ï¼ˆæ¯”å¦‚ã€Šæœºå™¨å­¦ä¹ å®æˆ˜ã€‹ä¸€ä¹¦ä¸­å°±æ˜¯åˆ©ç”¨è¿™ç§æ–¹æ³•æ„å»ºæå‡æ ‘ç®—æ³•ï¼Œé€šè¿‡ä¿®æ”¹æƒé‡æ¥è®¡ç®—æ¯ä¸€è½®çš„æŸå¤±ï¼‰ é‡é‡‡æ ·æ³•ï¼šåˆ©ç”¨é‡é‡‡æ ·çš„è®­ç»ƒé›†æ¥å¯¹åŸºå­¦ä¹ å™¨è¿›è¡Œè®­ç»ƒâ€“&gt;é‡å¯åŠ¨ï¼šé¿å…è®­ç»ƒè¿‡ç¨‹è¿‡æ—©åœæ­¢ Notes: è¥¿ç“œä¹¦ä¸Šçš„ç®—æ³•è¿˜æåˆ°è®­ç»ƒçš„æ¯ä¸€è½®å¼€å§‹éƒ½è¦æ£€æŸ¥å½“å‰å­¦ä¹ å™¨æ˜¯å¦æ¯”éšæœºçŒœæµ‹å¥½ï¼Œè‹¥æ¡ä»¶ä¸æ»¡è¶³åˆ™æŠ›å¼ƒå½“å‰å­¦ä¹ å™¨ï¼Œè¿™ç§æƒ…å½¢å¯èƒ½ä¼šå¯¼è‡´å­¦ä¹ è¿‡ç¨‹æœªè¾¾åˆ°Tè½®å³åœæ­¢ï¼Œæ‰€ä»¥æœ‰é‡é‡‡æ ·çš„æ–¹æ³•æ¥è¿›è¡Œé‡å¯åŠ¨é¿å…å‡ºç°æ­¤ç§æƒ…å†µï¼›ä½†æ˜¯å¦ä¸€æ–¹é¢ã€Šç»Ÿè®¡å­¦ä¹ æ–¹æ³•ã€‹ä»¥åŠã€Šæœºå™¨å­¦ä¹ å®æˆ˜ã€‹ä¸­çš„ç®—æ³•å¹¶æœªæœ‰è¿™æ¡åˆ¤æ–­è¯­å¥ï¼› ã€Šæœºå™¨å­¦ä¹ ã€‹ä¸€ä¹¦ä¸­æåˆ°ï¼Œä»ç»Ÿè®¡å­¦çš„å‡ºå‘è®¤ä¸ºAdaBoostå®è´¨ä¸Šæ˜¯åŸºäºåŠ æ€§æ¨¡å‹ï¼ˆåç»­æŒ‡å‡ºè¿™ä¸€è§†è§’é˜é‡Šçš„æ˜¯ä¸€ä¸ªä¸AdaBoostå¾ˆç›¸ä¼¼çš„è¿‡ç¨‹è€Œéå…¶æœ¬èº«ï¼‰ï¼Œä»¥ç±»ä¼¼ç‰›é¡¿è¿­ä»£æ³•æ¥ä¼˜åŒ–æŒ‡æ•°æŸå¤±å‡½æ•°ï¼Œé€šè¿‡å°†è¿­ä»£ä¼˜åŒ–è¿‡ç¨‹æ›¿æ¢ä¸ºå…¶ä»–ä¼˜åŒ–æ–¹æ³•äº§ç”Ÿäº†GradientBoostingã€LPBoostç­‰ï¼›è€Œè¿™é‡Œä¹Ÿæåˆ°æ¯ä¸€ç§å˜ä½“é’ˆå¯¹ä¸åŒçš„é—®é¢˜ï¼ˆå™ªå£°ã€æ•°æ®ä¸å¹³è¡¡ç­‰ï¼‰è€Œæ‹¥æœ‰ä¸åŒçš„æƒé‡æ›´æ–°è§„åˆ™. 2.2 ç‰¹ç‚¹ ä»bias-varianceåˆ†è§£çš„è§’åº¦æ¥çœ‹ï¼ŒBoostingä¸»è¦å…³æ³¨é™ä½ biasï¼Œå› æ­¤Boostingèƒ½åŸºäºæ³›åŒ–æ€§èƒ½ç›¸å½“å¼±çš„å­¦ä¹ å™¨æ„å»ºå‡ºå¾ˆå¼ºçš„é›†æˆï¼ˆä¸baggingä¸åŒï¼‰ Notes: boosting å¯¹äºå™ªéŸ³æ•°æ®è¾ƒä¸ºæ•æ„Ÿ 3. Bagging (Bootstrap aggregating )å‡ºå‘ç‚¹ä¾ç„¶æ˜¯â€œå¥½è€Œä¸åŒâ€ â€œä¸åŒâ€ â€” ä¸åŒåŸºå­¦ä¹ å™¨åŸºäºä¸åŒçš„æ ·æœ¬å­é›† â€œå¥½â€ â€” ä½¿ç”¨ç›¸äº’æœ‰äº¤å çš„é‡‡æ ·å­é›† 3.1 å·¥ä½œæœºåˆ¶åŸºäºè‡ªåŠ©é‡‡æ ·æ³•ï¼ˆbootstrap samplingï¼‰â€” â€œæœ‰æ”¾å›åœ°å…¨æŠ½â€ ä»è®­ç»ƒé›†ä»è¿›è¡Œå­æŠ½æ ·ç»„æˆæ¯ä¸ªåŸºæ¨¡å‹æ‰€éœ€è¦çš„å­è®­ç»ƒé›†ï¼Œå¯¹æ‰€æœ‰åŸºæ¨¡å‹é¢„æµ‹çš„ç»“æœè¿›è¡Œç»¼åˆäº§ç”Ÿæœ€ç»ˆçš„é¢„æµ‹ç»“æœ,è‡³äºä¸ºä»€ä¹ˆå«bootstrap aggregationï¼Œå› ä¸ºå®ƒæŠ½å–è®­ç»ƒæ ·æœ¬çš„æ—¶å€™é‡‡ç”¨çš„å°±æ˜¯bootstrapçš„æ–¹æ³•ï¼ 3.2 ä¼˜ç‚¹ï¼ˆç›¸å¯¹äºboostingï¼‰ é«˜æ•ˆ - è®­ç»ƒä¸€ä¸ªbaggingé›†æˆä¸ç›´æ¥ä½¿ç”¨åŸºå­¦ä¹ å™¨ç®—æ³•è®­ç»ƒä¸€ä¸ªå­¦ä¹ å™¨çš„å¤æ‚åº¦åŒé˜¶ baggignèƒ½ä¸ç»ä¿®æ”¹åœ°ç”¨äºå¤šåˆ†ç±»ã€å›å½’ä»»åŠ¡ï¼ˆæ ‡å‡†AdaBoostingåªèƒ½é€‚ç”¨äºäºŒåˆ†ç±»ä»»åŠ¡ï¼‰ åŒ…å¤–ä¼°è®¡â€”â€”è‡ªåŠ©é‡‡æ ·è¿‡ç¨‹ä¸­å‰©ä½™çš„æ ·æœ¬å¯ä»¥ä½œä¸ºéªŒè¯é›†æ¥å¯¹æ³›åŒ–æ€§èƒ½è¿›è¡Œâ€œåŒ…å¤–ä¼°è®¡â€ 3.3 ç‰¹ç‚¹ ä»åå·®-æ–¹å·®è§’åº¦çœ‹ï¼ŒBaggingä¸»è¦å…³æ³¨é™ä½æ–¹å·®ï¼Œå› æ­¤å®ƒåœ¨ä¸å‰ªæå†³ç­–æ ‘ã€ç¥ç»ç½‘ç»œç­‰æ˜“å—æ ·æœ¬æ‰°åŠ¨çš„å­¦ä¹ å™¨ä¸Šæ•ˆç”¨æ˜æ˜¾. 4. Random Forest éšæœºæ£®æ—Bagging çš„ä¸€ä¸ªæ‰©å±•å˜ä½“ 4.1 æ¦‚è¿° ä»¥å†³ç­–æ ‘ä¸ºåŸºå­¦ä¹ å™¨æ„å»ºBaggingé›†æˆ åœ¨å†³ç­–æ ‘çš„è®­ç»ƒè¿‡ç¨‹ä¸­å¼•å…¥äº†éšæœºå±æ€§é€‰æ‹© ä¼ ç»Ÿå†³ç­–æ ‘åœ¨é€‰æ‹©åˆ’åˆ†å±æ€§æ—¶æ˜¯åœ¨å½“å‰ç»“ç‚¹çš„å±æ€§é›†åˆä¸­é€‰æ‹©ä¸€ä¸ªæœ€ä¼˜å±æ€§ï¼›è€Œåœ¨éšæœºæ£®æ—ä¸­ï¼Œå¯¹åŸºå†³ç­–æ ‘çš„æ¯ä¸ªèŠ‚ç‚¹ï¼Œå…ˆä»è¯¥èŠ‚ç‚¹å±æ€§é›†åˆä¸­éšæœºé€‰æ‹©ä¸€ä¸ªåŒ…å«kä¸ªå±æ€§çš„å­é›†ï¼Œç„¶åå†ä»è¿™ä¸ªå­é›†ä¸­é€‰æ‹©ä¸€ä¸ªæœ€ä¼˜å±æ€§ç”¨äºåˆ’åˆ†ï¼Œå…¶ä¸­kæ§åˆ¶äº†éšæœºæ€§çš„å¼•å…¥ç¨‹åº¦ 4.2 ç‰¹ç‚¹ ç®€å•ã€æ˜“äºå®ç°ã€è®¡ç®—å¼€é”€å° æ ·æœ¬æ‰°åŠ¨+å±æ€§æ‰°åŠ¨ 4.3 bagging vs. éšæœºæ£®æ— ä¸¤è€…æ”¶æ•›æ€§ç›¸ä¼¼ï¼Œéšæœºæ£®æ—çš„èµ·å§‹æ€§èƒ½å¾€å¾€ç›¸å¯¹è¾ƒå·®ï¼Œä½†ä¼šæ”¶æ•›åˆ°æ›´ä½çš„æ³›åŒ–è¯¯å·® éšæœºæ£®æ—çš„è®­ç»ƒæ•ˆç‡å¸¸ä¼˜äºBaggingï¼Œä¸»è¦æ˜¯å†³ç­–æ ‘åˆ’åˆ†å±æ€§æ—¶ï¼ŒåŸå§‹bagginéœ€è¦å¯¹å±æ€§å…¨é›†è¿›è¡Œè€ƒè™‘ï¼Œè€Œ RF æ˜¯é’ˆå¯¹ä¸€ä¸ªå­é›† 5. ç»“åˆç­–ç•¥5.1 å­¦ä¹ å™¨ç»“åˆçš„å¥½å¤„ ç»Ÿè®¡çš„è§’åº¦ï¼šå‡è®¾ç©ºé—´å¾ˆå¤§æ—¶ï¼Œå¯èƒ½å­˜åœ¨å¤šä¸ªå‡è®¾åœ¨è®­ç»ƒé›†ä¸Šè¾¾åˆ°åŒç­‰æ€§èƒ½ï¼Œä½†å­¦ä¹ å…¶å¯èƒ½è¯¯é€‰å¯¼è‡´æ³›åŒ–æ€§èƒ½ä¸ä½³ï¼Œç»“åˆå¤šä¸ªå­¦ä¹ å™¨å¯ä»¥å‡å°è¯¥é£é™© è®¡ç®—çš„è§’åº¦ï¼šé™ä½é™·å…¥ç³Ÿç³•å±€éƒ¨æå°ç‚¹çš„é£é™© è¡¨ç¤ºçš„è§’åº¦ï¼šç»“åˆå¤šä¸ªå­¦ä¹ å™¨å¯æ‰©å¤§å‡è®¾ç©ºé—´ï¼Œå¯¹äºçœŸå®å‡è®¾åœ¨å‡è®¾ç©ºé—´ä¹‹å¤–çš„æƒ…å½¢å¯èƒ½å­¦å¾—æ›´å¥½çš„è¿‘ä¼¼ 5.2 ç­–ç•¥å¹³å‡æ³•(Averaging) ç®€å•å¹³å‡æ³• åŠ æƒå¹³å‡æ³• æŠ•ç¥¨æ³•(Voting) å¤šæ•°æŠ•ç¥¨æ³• åŠ æƒæŠ•ç¥¨æ³• è‹¥æŒ‰ä¸ªä½“å­¦ä¹ å™¨è¾“å‡ºå€¼ç±»å‹åˆ’åˆ† (ç¡¬æŠ•ç¥¨ï¼šé¢„æµ‹ä¸º0/1 | è½¯æŠ•ç¥¨ï¼šç›¸å½“äºå¯¹åéªŒæ¦‚ç‡çš„ä¸€ä¸ªä¼°è®¡) å­¦ä¹ æ³• Stacking:å…ˆä»åˆå§‹æ•°æ®é›†è®­ç»ƒå‡ºåˆçº§å­¦ä¹ å™¨ï¼Œç„¶åç”Ÿæˆä¸€ä¸ªæ–°çš„æ•°æ®é›†ç”¨äºè®­ç»ƒå…ƒå­¦ä¹ å™¨ï¼Œåœ¨è¿™ä¸ªæ–°æ•°æ®é›†ä¸­ï¼Œåˆçº§å­¦ä¹ å™¨çš„è¾“å‡ºè¢«å½“ä½œæ ·ä¾‹è¾“å…¥ç‰¹å¾ï¼Œè€Œåˆå§‹æ ·æœ¬çš„æ ‡è®°ä»è¢«å½“ä½œæ ·ä¾‹æ ‡è®°ï¼›ä¸€èˆ¬ä½¿ç”¨äº¤å‰éªŒè¯æ³•æˆ–ç•™ä¸€æ³•æ¥ç”¨è®­ç»ƒåˆçº§å­¦ä¹ å™¨æœªä½¿ç”¨çš„æ ·æœ¬æ¥äº§ç”Ÿå…ƒå­¦ä¹ å™¨çš„è®­ç»ƒæ ·æœ¬ Notes: å…³äºStacking -ã€Šæœºå™¨å­¦ä¹ ã€‹ä½œè€…ä¹ŸæŒ‡å‡ºStackingæœ¬èº«æ˜¯ä¸€ç§è‘—åçš„é›†æˆæ–¹æ³•ï¼Œä¸”æœ‰ä¸å°‘å˜ä½“å’Œç‰¹ä¾‹ï¼Œä½†ä»–è¿™é‡Œæ˜¯ä½œä¸ºä¸€ç§ç‰¹æ®Šçš„ç»“åˆç­–ç•¥çœ‹å¾… å…³äºStackingçš„ç»†èŠ‚è¯¦è¿°ï¼Œå¦‚ä½•åœ¨ Kaggle é¦–æˆ˜ä¸­è¿›å…¥å‰ 10% ä»¥ä¸€å¹…å›¾æ¥è¯´è¯´æ˜5æŠ˜Stackingçš„è¿‡ç¨‹ æ¨èä¸€ä¸ªPythonçš„å®ç°äº†Stackingé›†æˆçš„åº“mlxtend åŸä½œè€…ä¸¾äº†ä¸€ä¸ª5æŠ˜stackingçš„ä¾‹å­ï¼ŒåŸºæœ¬æ–¹æ³•æ˜¯ï¼Œ æ¯ä¸€æŠ˜å–è®­ç»ƒé›†80%çš„æ•°æ®è®­ç»ƒä¸€ä¸ªåŸºæ¨¡å‹å¹¶å¯¹å‰©ä¸‹çš„20%çš„æ•°æ®è¿›è¡Œé¢„æµ‹ï¼ŒåŒæ—¶å°†è¯¥æ¨¡å‹å¯¹æµ‹è¯•é›†åšå‡ºé¢„æµ‹ï¼Œä¿ç•™è®­ç»ƒå­é›†çš„é¢„æµ‹ç»“æœå’Œæµ‹è¯•é›†çš„é¢„æµ‹ç»“æœ å°†5æŠ˜çš„è®­ç»ƒå­é›†é¢„æµ‹ç»“æœç»“åˆèµ·æ¥æ„æˆç¬¬äºŒå±‚å…ƒæ¨¡å‹çš„è¾“å…¥ç‰¹å¾è¿›è¡Œè®­ç»ƒå¾—åˆ°å…ƒåˆ†ç±»å™¨ å°†å‰é¢æ¯ä¸€æŠ˜åœ¨æµ‹è¯•é›†é¢„æµ‹å¾—åˆ°çš„ç»“æœå–å‡å€¼ä½œä¸ºæœ€ç»ˆå…ƒåˆ†ç±»å™¨çš„é¢„æµ‹è¾“å…¥(æœ€ç»ˆçš„æµ‹è¯•æ•°æ®)ï¼Œå¹¶ä½¿ç”¨è®­ç»ƒå¥½çš„å…ƒåˆ†ç±»å™¨åœ¨è¯¥æ•°æ®ä¸Šä½œå‡ºæœ€ç»ˆé¢„æµ‹ æ­¤å¤–çŸ¥ä¹ä¸Šçš„ä¸€ç¯‡æ–‡ç« è¿˜æåˆ° å¯ä»¥å°†Kä¸ªæ¨¡å‹å¯¹Test Dataçš„é¢„æµ‹ç»“æœæ±‚å¹³å‡ï¼Œä¹Ÿå¯ä»¥ç”¨æ‰€æœ‰çš„Train Dataé‡æ–°è®­ç»ƒä¸€ä¸ªæ–°æ¨¡å‹æ¥é¢„æµ‹Test Data 6. å¤šæ ·æ€§6.1 è¯¯å·®-åˆ†æ­§åˆ†è§£ é›†æˆå­¦ä¹ â€œå¥½è€Œä¸åŒâ€çš„ç†è®ºåˆ†æï¼Œè§ã€Šæœºå™¨å­¦ä¹ ã€‹P185~186 å¯»æ‰¾ é›†æˆæ³›åŒ–è¯¯å·®ã€ä¸ªä½“å­¦ä¹ å™¨æ³›åŒ–è¯¯å·®ã€ä¸ªä½“å­¦ä¹ å™¨é—´ çš„åˆ†æ­§ä¸‰è€…ä¹‹é—´çš„å…³ç³» 6.2 å¤šæ ·æ€§åº¦é‡ å¤šæ ·æ€§åº¦é‡æ˜¯ç”¨äºåº¦é‡é›†æˆä¸­ä¸ªä½“åˆ†ç±»å™¨çš„å¤šæ ·æ€§ï¼Œå³ä¼°ç®—ä¸ªä½“å­¦ä¹ å™¨çš„å¤šæ ·åŒ–ç¨‹åº¦ï¼Œå…¸å‹åšæ³•æ˜¯è€ƒè™‘ä¸ªä½“åˆ†ç±»å™¨çš„ä¸¤ä¸¤ç›¸ä¼¼/ä¸ç›¸ä¼¼æ€§ åº¦é‡æ–¹æ³• {ä¸åˆåº¦é‡ã€ç›¸å…³ç³»æ•°ã€Q-ç»Ÿè®¡é‡ã€k-ç»Ÿè®¡é‡} Notes: ç›®å‰æˆ‘è¿˜æ²¡æœ‰åšè¿‡è¿™ç§ç±»ä¼¼æµ‹è¯• ğŸ˜¢ 6.3 å¤šæ ·æ€§å¢å¼ºå¦‚ä½•å¢å¼ºå¤šæ ·æ€§ï¼Ÿâ€” åœ¨å­¦ä¹ è¿‡ç¨‹ä¸­å¼•å…¥éšæœºæ€§ æ•°æ®æ ·æœ¬æ‰°åŠ¨ è¾“å…¥å±æ€§æ‰°åŠ¨ è¾“å‡ºè¡¨ç¤ºæ‰°åŠ¨ ç®—æ³•å‚æ•°æ‰°åŠ¨ æ•°æ®æ ·æœ¬æ‰°åŠ¨ ç»™å®šåˆå§‹æ•°æ®é›†ï¼Œå¯ä»ä¸­äº§ç”Ÿä¸åŒçš„æ•°æ®å­é›†ï¼Œå†åˆ©ç”¨ä¸åŒçš„æ•°æ®å­é›†è®­ç»ƒå‡ºä¸åŒçš„ä¸ªä½“å­¦ä¹ å™¨ï¼Œé€šå¸¸åŸºäºé‡‡æ ·æ³• è¾“å…¥å±æ€§æ‰°åŠ¨ ä»åˆå§‹å±æ€§é›†ä¸­æŠ½å–è‹¥å¹²ä¸ªå±æ€§å­é›†ã€åŸºäºæ¯ä¸ªå±æ€§å­é›†è®­ç»ƒä¸€ä¸ªåŸºå­¦ä¹ å™¨ï¼ˆå¦‚éšæœºå­ç©ºé—´ç®—æ³•ï¼‰ï¼Œæœ€åç»“åˆ ç®—æ³•å‚æ•°æ‰°åŠ¨ é€šå¸¸å¯ä»¥é€šè¿‡éšæœºè®¾ç½®ä¸åŒçš„å‚æ•°ï¼Œä»è€Œäº§ç”Ÿå·®åˆ«è¾ƒå¤§çš„ä¸ªä½“å­¦ä¹ å™¨ã€‚ Notes: æ•°æ®æ ·æœ¬æ‰°åŠ¨ä¸­ç›¸å¯¹çš„ç¨³å®šåŸºå­¦ä¹ å™¨åŒ…æ‹¬ï¼šçº¿æ€§å­¦ä¹ å™¨ã€æ”¯æŒå‘é‡æœºã€æœ´ç´ è´å¶æ–¯ã€kè¿‘é‚»å­¦ä¹ å™¨ç­‰ è¾“å…¥å±æ€§æ‰°åŠ¨ : æ„Ÿè§‰å…¸å‹çš„æ˜¯ Random Forest å°±åšäº†è¿™ä»¶äº‹. å¯¹äºç®—æ³•å‚æ•°æ‰°åŠ¨ï¼Œä¸äº¤å‰éªŒè¯åšæ¯”è¾ƒï¼Œäº¤å‰éªŒè¯å¸¸å¸¸æ˜¯åœ¨ä¸åŒå‚æ•°ç»„åˆæ¨¡å‹é‡Œé€‰æ‹©æœ€ä¼˜å‚æ•°ç»„åˆæ¨¡å‹ï¼Œè€Œé›†æˆåˆ™æ˜¯å°†è¿™äº›ä¸åŒå‚æ•°ç»„åˆçš„æ¨¡å‹ç»“åˆèµ·æ¥ï¼Œæ‰€ä»¥é›†æˆå­¦ä¹ æŠ€æœ¯çš„å®é™…è®¡ç®—å¼€é”€å¹¶ä¸æ¯”ä½¿ç”¨å•ä¸€å­¦ä¹ å™¨å¤§å¾ˆå¤š Reference article å‘¨å¿—åã€Šæœºå™¨å­¦ä¹ ã€‹ kaggle-ensembling-guide Bagging, Boosting &amp; Stacking stackexchangeåŠè¯„è®ºåŒº å¦‚ä½•åœ¨ Kaggle é¦–æˆ˜ä¸­è¿›å…¥å‰ 10% åˆ†åˆ†é’Ÿå¸¦ä½ æ€å…¥Kaggle Top 1% æ‡’æ­»éª†é©¼ æœºå™¨å­¦ä¹ æŠ€æ³•","categories":[{"name":"machine-learning","slug":"machine-learning","permalink":"http://iequa.com/categories/machine-learning/"}],"tags":[{"name":"Ensumble","slug":"Ensumble","permalink":"http://iequa.com/tags/Ensumble/"}]},{"title":"Spark Introduce 1","slug":"spark/spark-review-1-introduce","date":"2018-06-29T02:07:21.000Z","updated":"2020-12-04T01:10:55.712Z","comments":true,"path":"2018/06/29/spark/spark-review-1-introduce/","link":"","permalink":"http://iequa.com/2018/06/29/spark/spark-review-1-introduce/","excerpt":"","text":"Spark å‘æºäºUniversity of California, Berkeley, AMPLap å¤§æ•°æ®åˆ†æå¹³å°Spark ç«‹è¶³äºå†…å­˜è®¡ç®—ã€ä»å¤šè¿­ä»£æ‰¹é‡å¤„ç†å‡ºå‘Spark å…¼é¡¾æ•°æ®ä»“åº“ã€æµå¤„ç†ã€å›¾è®¡ç®— ç­‰å¤šç§è®¡ç®—èŒƒå¼ï¼Œå¤§æ•°æ®ç³»ç»Ÿé¢†åŸŸå…¨æ ˆè®¡ç®—å¹³å° spark.apache.org 1. Spark çš„å†å²ä¸å‘å±• 2009 : Spark è¯ç”Ÿäº AMPLab 2014 : Spark 1.0 å‘å¸ƒ 2019 : Spark 3.0 å‘å¸ƒ 2. Spark ä¹‹äº Hadoop Spark æ˜¯ MapReduce çš„æ›¿ä»£æ–¹æ¡ˆ, ä¸”å…¼å®¹ HDFSã€Hive ç­‰åˆ†å¸ƒå¼å­˜å‚¨å±‚ã€‚ Spark ç›¸æ¯” Hadoop MapReduce çš„ä¼˜åŠ¿å¦‚ä¸‹ : ä¸­é—´ç»“æœè¾“å‡º æ•°æ®æ ¼å¼å’Œå†…å­˜å¸ƒå±€ æ‰§è¡Œç­–ç•¥ ä»»åŠ¡è°ƒåº¦çš„å¼€é”€ Sparkç”¨äº‹ä»¶é©±åŠ¨ç±»åº“AKKAæ¥å¯åŠ¨ä»»åŠ¡, é€šè¿‡çº¿ç¨‹æ± å¤ç”¨çº¿ç¨‹é¿å…è¿›çº¿ç¨‹å¯åŠ¨åˆ‡æ¢å¼€é”€ 3. Spark èƒ½å¸¦æ¥ä»€ä¹ˆ ? æ‰“é€ å…¨æ ˆå¤šè®¡ç®—èŒƒå¼çš„é«˜æ•ˆæ•°æ®æµæ°´çº¿ è½»é‡çº§å¿«é€Ÿå¤„ç†, å¹¶æ”¯æŒ Scalaã€Pythonã€Java ä¸ HDFS ç­‰ å­˜å‚¨å±‚ å…¼å®¹ 4. Spark å®‰è£…ä¸éƒ¨ç½²Spark ä¸»è¦ä½¿ç”¨ HDFS å……å½“æŒä¹…åŒ–å±‚ï¼Œæ‰€ä»¥å®Œæ•´çš„å®‰è£… Spark éœ€è¦å…ˆå®‰è£… Hadoop.Spark æ˜¯è®¡ç®—æ¡†æ¶, å®ƒä¸»è¦ä½¿ç”¨ HDFS å……å½“æŒä¹…åŒ–å±‚ã€‚ Linux é›†ç¾¤å®‰è£… Spark å®‰è£… JDK &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;(green download install) é…ç½® SSH å…å¯†ç ç™»é™† (å¯é€‰) å®‰è£… Hadoop &nbsp;&nbsp;&nbsp;&nbsp; (brew install hadoop) å®‰è£… Scala &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(brew install scala) å®‰è£… Spark &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(green download install) å¯åŠ¨ Spark é›†ç¾¤ MS=/usr/local/xsoft### JAVA ###JAVA_HOME=$MS/jdk/Contents/HomeJAVA_BIN=$JAVA_HOME/binPATH=$JAVA_HOME/bin:$PATHCLASSPATH=.:$JAVA_HOME/jre/lib/rt.jar:$JAVA_HOME/jre/lib/dt.jar:$JAVA_HOME/jre/lib/tools.jarexport JAVA_HOME JAVA_BIN PATH CLASSPATHexport HADOOP_HOME=/usr/local/Cellar/hadoop/3.2.1_1export PATH=$PATH:$HADOOP_HOME/sbin:$HADOOP_HOME/binexport SCALA_HOME=/usr/local/Cellar/scala/2.13.3export PATH=$PATH:$SCALA_HOME/binexport SPARK_HOME=$MS/sparkexport PATH=$PATH:$SPARK_HOME/bin Sparkå®˜ç½‘ä¸‹è½½ 4.1 å®‰è£… Spark(1). tar -xzvf spark-3.0.0-bin-hadoop2.7.tgz(2). cd /usr/local/xsoft/spark-3.0.0-bin-hadoop3.2/(3). é…ç½® conf/spark-env.sh 1) è¯¦ç»†å¤æ‚å‚æ•°é…ç½®å‚è§ å®˜ç½‘ Configuration 2) vim conf/spark-env.sh #!/usr/bin/env bash export SCALA_HOME=/usr/local/Cellar/scala/2.13.3 export SPARK_HOME=/usr/local/xsoft/spark export SPARK_MASTER_IP=localhost export MASTER=spark://localhost:7077 #export IPYTHON=1 export PYSPARK_PYTHON=/Users/blair/.pyenv/versions/anaconda3/envs/spark/bin/python3 export PYSPARK_DRIVER_PYTHON=&quot;jupyter&quot; export PYSPARK_DRIVER_PYTHON_OPTS=&quot;notebook&quot; #export SPARK_WORKER_MEMORY=2g #export SPARK_EXECUTOR_INSTANCES=2 #export SPARK_EXECUTOR_CORES=1 #export SPARK_WORKER_MEMORY=2000m #export SPARK_EXECUTOR_MEMORY=500m #export SPARK_LIBRARY_PATH=$&#123;SPARK_HOME&#125;/lib(4). é…ç½® conf/slaves (æµ‹è¯•å¯é€‰)(5). ä¸€èˆ¬éœ€è¦ startup ssh server. 4.2 å¯åŠ¨ Spark é›†ç¾¤åœ¨ Spark æ ¹ç›®å½•å¯åŠ¨ Spark ./sbin/start-all.sh./sbin/stop-all.sh å¯åŠ¨å jps æŸ¥çœ‹ ä¼šæœ‰ Master è¿›ç¨‹å­˜åœ¨ âœ spark jps11262 Jps11101 Master11221 Worker 4.3 Spark é›†ç¾¤åˆè¯•å¯ä»¥é€šè¿‡ä¸¤ç§æ–¹å¼è¿è¡Œ Spark æ ·ä¾‹ : ä»¥ ./run-example çš„æ–¹å¼æ‰§è¡Œ âœ cd /usr/local/xsoft/sparkâœ spark ./sbin/start-all.shâœ spark ./bin/run-example org.apache.spark.examples.SparkPi ä»¥ ./Spark Shell æ–¹å¼æ‰§è¡Œ scala&gt; import org.apache.spark._import org.apache.spark._scala&gt; object SparkPi &#123; | | def main(args: Array[String]) &#123; | | val slices = 2 | val n = 100000 * slices | | val count = sc.parallelize(1 to n, slices).map &#123; i =&gt; | | val x = math.random * 2 - 1 | val y = math.random * 2 - 1 | | if (x * x + y * y &lt; 1) 1 else 0 | | &#125;.reduce(_ + _) | | println(&quot;Pi is rounghly &quot; + 4.0 * count / n) | | &#125; | &#125;defined module SparkPiscala&gt;// Spark Shell å·²é»˜è®¤å°† SparkContext ç±»åˆå§‹åŒ–ä¸ºå¯¹è±¡ sc, ç”¨æˆ·ä»£ç å¯ç›´æ¥ä½¿ç”¨ã€‚// Spark è‡ªå¸¦çš„äº¤äº’å¼çš„ Shell ç¨‹åºï¼Œæ–¹ä¾¿è¿›è¡Œäº¤äº’å¼ç¼–ç¨‹ã€‚ é€šè¿‡ Web UI æŸ¥çœ‹é›†ç¾¤çŠ¶æ€ httpï¼š//masterIp:8080 4.4 Spark quick startquick-start : https://spark.apache.org/docs/latest/quick-start.html ./bin/spark-shell scala&gt; val textFile = sc.textFile(&quot;README.md&quot;)# val textFile = sc.textFile(&quot;file:///usr/local/xsoft/spark/README.md&quot;)textFile: spark.RDD[String] = spark.MappedRDD@2ee9b6e3RDDs have actions, which return values, and transformations, which return pointers to new RDDs. Letâ€™s start with a few actions:scala&gt; textFile.count() // Number of items in this RDDres0: Long = 126scala&gt; textFile.first() // First item in this RDDres1: String = # Apache Spark 5. Spark ç”Ÿæ€ BDAS Spark æ¡†æ¶ã€æ¶æ„ã€è®¡ç®—æ¨¡å‹ã€æ•°æ®ç®¡ç†ç­–ç•¥ Spark BDAS é¡¹ç›®åŠå…¶å­é¡¹ç›®è¿›è¡Œäº†ç®€è¦ä»‹ç» Spark ç”Ÿæ€ç³»ç»ŸåŒ…å«çš„å¤šä¸ªå­é¡¹ç›® : SparkSqlã€Spark Streamingã€GraphXã€MLlib Spark æ˜¯ BDAS æ ¸å¿ƒ, æ˜¯ä¸€ å¤§æ•°æ®åˆ†å¸ƒå¼ç¼–ç¨‹æ¡†æ¶ 6. Spark æ¶æ„ Spark çš„ä»£ç ç»“æ„ Spark çš„æ¶æ„ Spark è¿è¡Œé€»è¾‘ 6.1 Spark çš„ä»£ç ç»“æ„ schedulerï¼šæ–‡ä»¶å¤¹ä¸­å«æœ‰è´Ÿè´£æ•´ä½“çš„Sparkåº”ç”¨ã€ä»»åŠ¡è°ƒåº¦çš„ä»£ç ã€‚broadcastï¼šå«æœ‰Broadcastï¼ˆå¹¿æ’­å˜é‡ï¼‰çš„å®ç°ä»£ç ï¼ŒAPIä¸­æ˜¯Javaå’ŒPython APIçš„å®ç°ã€‚deployï¼šå«æœ‰Sparkéƒ¨ç½²ä¸å¯åŠ¨è¿è¡Œçš„ä»£ç ã€‚commonï¼šä¸æ˜¯ä¸€ä¸ªæ–‡ä»¶å¤¹ï¼Œè€Œæ˜¯ä»£è¡¨Sparké€šç”¨çš„ç±»å’Œé€»è¾‘å®ç°ï¼Œæœ‰5000è¡Œä»£ç ã€‚metricsï¼šæ˜¯è¿è¡Œæ—¶çŠ¶æ€ç›‘æ§é€»è¾‘ä»£ç ï¼ŒExecutorä¸­å«æœ‰WorkerèŠ‚ç‚¹è´Ÿè´£è®¡ç®—çš„é€»è¾‘ä»£ç ã€‚partialï¼šå«æœ‰è¿‘ä¼¼è¯„ä¼°ä»£ç ã€‚ 6.2 Spark çš„æ¶æ„Sparkæ¶æ„é‡‡ç”¨äº†åˆ†å¸ƒå¼è®¡ç®—ä¸­çš„Master-Slaveæ¨¡å‹ã€‚ Role description Master å¯¹åº”é›†ç¾¤ä¸­çš„å«æœ‰Masterè¿›ç¨‹çš„èŠ‚ç‚¹, é›†ç¾¤çš„æ§åˆ¶å™¨ Slave é›†ç¾¤ä¸­å«æœ‰Workerè¿›ç¨‹çš„èŠ‚ç‚¹ Client ä½œä¸ºç”¨æˆ·çš„å®¢æˆ·ç«¯è´Ÿè´£æäº¤åº”ç”¨ Driver è¿è¡ŒApplicationçš„main()å‡½æ•°å¹¶åˆ›å»ºSparkContextã€‚è´Ÿè´£ä½œä¸šçš„è°ƒåº¦ï¼Œå³Taskä»»åŠ¡çš„åˆ†å‘ Worker ç®¡ç†è®¡ç®—èŠ‚ç‚¹å’Œåˆ›å»ºExecutorï¼Œå¯åŠ¨Executor æˆ– Driver. æ¥æ”¶ä¸»èŠ‚ç‚¹å‘½ä»¤ä¸è¿›è¡ŒçŠ¶æ€æ±‡æŠ¥ Executor Worker nodeæ‰§è¡Œä»»åŠ¡çš„ç»„ä»¶,è´Ÿè´£ Task çš„æ‰§è¡Œ,ç”¨äºå¯åŠ¨çº¿ç¨‹æ± è¿è¡Œä»»åŠ¡ ClusterManager Standalone æ¨¡å¼ä¸­ä¸º Master, æ§åˆ¶æ•´ä¸ªé›†ç¾¤, ç›‘æ§Worker SparkContext æ•´ä¸ªåº”ç”¨çš„ä¸Šä¸‹æ–‡, æ§åˆ¶Appçš„ç”Ÿå‘½å‘¨æœŸ RDD Sparkçš„åŸºæœ¬è®¡ç®—å•å…ƒï¼Œä¸€ç»„RDDå¯å½¢æˆæ‰§è¡Œçš„ DAG Num Spark App æµç¨‹ 1. Client æäº¤åº”ç”¨ 2. Master æ‰¾åˆ°ä¸€ä¸ª Worker å¯åŠ¨ Driver 3. Driver å‘ Master æˆ–è€… èµ„æºç®¡ç†å™¨ç”³è¯·èµ„æºï¼Œä¹‹åå°†åº”ç”¨è½¬åŒ–ä¸º RDD Graph 4. DAGScheduler å°† RDD Graph è½¬åŒ–ä¸º Stageçš„æœ‰å‘æ— ç¯å›¾ æäº¤ç»™ TaskScheduler 5. TaskScheduler æäº¤ task ç»™Executoræ‰§è¡Œ 6. åœ¨ä»»åŠ¡æ‰§è¡Œçš„è¿‡ç¨‹ä¸­ï¼Œå…¶ä»–ç»„ä»¶ååŒå·¥ä½œï¼Œç¡®ä¿æ•´ä¸ªåº”ç”¨é¡ºåˆ©æ‰§è¡Œ åœ¨æ‰§è¡Œé˜¶æ®µï¼ŒDriver ä¼šå°† Task å’Œ Taskæ‰€ä¾èµ–çš„file å’Œ jar åºåˆ—åŒ–åä¼ é€’ç»™å¯¹åº”çš„ Workeræœºå™¨ï¼ŒåŒæ—¶ Executorå¯¹ç›¸åº”æ•°æ®åˆ†åŒºçš„ä»»åŠ¡è¿›è¡Œå¤„ç†ã€‚ 7. å°ç»“ç”±äº Spark ä¸»è¦ä½¿ç”¨ HDFS å……å½“æŒä¹…åŒ–å±‚ï¼Œæ‰€ä»¥å®Œæ•´çš„ä½¿ç”¨ Spark éœ€è¦é¢„å…ˆå®‰è£… Hadoop. Spark å°†åˆ†å¸ƒå¼çš„å†…å­˜æ•°æ®æŠ½è±¡ä¸ºå¼¹æ€§åˆ†å¸ƒå¼æ•°æ®é›† (RDD), å¹¶åœ¨å…¶ä¸Šå®ç°äº†ä¸°å¯Œçš„ç®—å­ï¼Œä»è€Œå¯¹ RDD è¿›è¡Œè®¡ç®—ï¼Œæœ€åå°† ç®—å­åºåˆ— è½¬åŒ–ä¸º DAG è¿›è¡Œæ‰§è¡Œå’Œè°ƒåº¦ã€‚ Sparkçš„Python APIå‡ ä¹è¦†ç›–äº†æ‰€æœ‰Scala APIæ‰€èƒ½æä¾›çš„åŠŸèƒ½. ä½†çš„ç¡®æœ‰äº›ç‰¹æ€§ï¼Œæ¯”å¦‚Spark Streamingå’Œä¸ªåˆ«çš„APIæ–¹æ³•ï¼Œæš‚ä¸æ”¯æŒã€‚å…·ä½“å‚è§ã€ŠSparkç¼–ç¨‹æŒ‡å—ã€‹çš„Pythonéƒ¨åˆ† ä½“ä¼šäº† å‡½æ•°å¼ ç¼–ç¨‹. ä¸ªäººè®¤ä¸º scalaã€python æ¯”è¾ƒé€‚åˆå†™ spark ç¨‹åº. Reference Macä¸Šå®‰è£…Spark3.0.0ä»¥åŠHadoop å¤§æ•°æ®å…¥é—¨ä¸å®æˆ˜-PySparkçš„ä½¿ç”¨æ•™ç¨‹","categories":[{"name":"spark","slug":"spark","permalink":"http://iequa.com/categories/spark/"}],"tags":[{"name":"spark","slug":"spark","permalink":"http://iequa.com/tags/spark/"}]},{"title":"Decision Tree part2","slug":"ml/decisionTree-part2","date":"2018-06-27T08:43:21.000Z","updated":"2019-10-20T04:30:35.036Z","comments":true,"path":"2018/06/27/ml/decisionTree-part2/","link":"","permalink":"http://iequa.com/2018/06/27/ml/decisionTree-part2/","excerpt":"","text":"1. å†³ç­–æ ‘æ¨¡å‹å†³ç­–æ ‘ï¼ˆdecision treeï¼‰æ˜¯ä¸€ä¸ªæ ‘ç»“æ„ï¼ˆå¯ä»¥æ˜¯äºŒå‰æ ‘æˆ–éäºŒå‰æ ‘ï¼‰ å…³äº ID3 ä¸ C4.5 çš„å…·ä½“è®¡ç®—æµç¨‹ç¤ºä¾‹ï¼Œè¯·å‚è§ desicion tree (part1) 1.1. å®šä¹‰åˆ†ç±»å†³ç­–æ ‘æ¨¡å‹æ˜¯ä¸€ç§æè¿°å¯¹å®ä¾‹è¿›è¡Œåˆ†ç±»çš„æ ‘å½¢ç»“æ„ï¼Œå…¶ä¸­åŒ…å«ä¸¤ç§ç±»å‹çš„èŠ‚ç‚¹ å†…éƒ¨èŠ‚ç‚¹: è¡¨ç¤ºä¸€ä¸ª featureï¼ˆå±æ€§ï¼‰ å¶èŠ‚ç‚¹: è¡¨ç¤ºä¸€ä¸ª class ä¸€èˆ¬å†³ç­–æ ‘å¯ä»¥æ ¹æ®ä»¥ä¸‹å››ä¸ªæ–¹é¢åˆ’åˆ†å½’ç±» : åˆ†æ”¯æ•° åˆ’åˆ†ç­–ç•¥ ç»ˆæ­¢ç­–ç•¥ åŸºåˆ†ç±»å™¨ 1.2. if-thenè§„åˆ™é›†åˆ ä¸€æ¡ç”±æ ¹èŠ‚ç‚¹åˆ°å¶èŠ‚ç‚¹çš„è·¯å¾„ â€“&gt; ä¸€æ¡è§„åˆ™ è·¯å¾„ä¸Šå†…éƒ¨èŠ‚ç‚¹çš„ç‰¹å¾ â€“&gt; è§„åˆ™çš„æ¡ä»¶ å¶èŠ‚ç‚¹çš„ç±» â€“&gt; è§„åˆ™çš„ç»“è®º class æ€§è´¨ï¼šäº’æ–¥ä¸”å®Œå¤‡ 1.3. æ¡ä»¶æ¦‚ç‡åˆ†å¸ƒ ç»™å®š feature æ¡ä»¶ä¸‹ class çš„æ¡ä»¶æ¦‚ç‡åˆ†å¸ƒ 2. å†³ç­–æ ‘çš„å­¦ä¹ å†³ç­–æ ‘å­¦ä¹ æœ¬è´¨æ˜¯ä» train datasets ä¸­å½’çº³å‡ºä¸€ç»„åˆ†ç±»è§„åˆ™ï¼Œå¦ä¸€ä¸ªè§’åº¦ï¼Œå­¦ä¹ æ˜¯ç”± train datasets ä¼°è®¡æ¡ä»¶æ¦‚ç‡æ¨¡å‹ 2.1 ç›®çš„ å¾—åˆ°ä¸€ä¸ªä¸è®­ç»ƒæ•°æ®çŸ›ç›¾è¾ƒå°çš„å†³ç­–æ ‘ï¼ŒåŒæ—¶å…·æœ‰å¾ˆå¥½çš„æ³›åŒ–èƒ½åŠ› 2.2 ç­–ç•¥ ä»¥æŸå¤±å‡½æ•°ï¼ˆé€šå¸¸ä¸ºæ­£åˆ™åŒ–çš„æå¤§ä¼¼ç„¶å‡½æ•°ï¼‰ä¸ºç›®æ ‡å‡½æ•°çš„æœ€å°åŒ–ï¼Œå¹¶åœ¨æŸå¤±å‡½æ•°ç¡®å®šåï¼Œé€‰æ‹©æœ€ä¼˜å†³ç­–æ ‘ 2.3 å­¦ä¹ ç®—æ³• ç†è®ºä¸Šï¼šä»æ‰€æœ‰å¯èƒ½çš„å†³ç­–æ ‘ä¸­é€‰å–æœ€ä¼˜å†³ç­–æ ‘ï¼ŒNPå®Œå…¨é—®é¢˜ å®é™…ä¸­ï¼šé‡‡ç”¨å¯å‘å¼æ–¹æ³•ï¼Œè¿‘ä¼¼æ±‚è§£ï¼ˆå¾—åˆ°æ¬¡æœ€ä¼˜å†³ç­–æ ‘ï¼‰â€“&gt; é€’å½’çš„é€‰æ‹©æœ€ä¼˜ç‰¹å¾ï¼Œå¹¶æ ¹æ®è¯¥æœ€ä¼˜ç‰¹å¾å¯¹è®­ç»ƒæ•°æ®è¿›è¡Œåˆ†å‰²ï¼Œä½¿å¾—å¯¹å„ä¸ªå­æ•°æ®é›†æœ‰ä¸€ä¸ªæœ€å¥½çš„åˆ†ç±»çš„è¿‡ç¨‹ã€‚ ä¸»è¦æ­¥éª¤ï¼š (1). ç‰¹å¾é€‰æ‹© (2). å†³ç­–æ ‘çš„ç”Ÿæˆ (3). å†³ç­–æ ‘çš„å‰ªæ Notes: å†³ç­–æ ‘çš„ç”Ÿæˆå¯¹åº”äºæ¨¡å‹çš„å±€éƒ¨é€‰æ‹©ï¼Œå†³ç­–æ ‘çš„å‰ªæå¯¹åº”äºæ¨¡å‹çš„å…¨å±€é€‰æ‹©ã€‚ 3. ç‰¹å¾é€‰æ‹© å®è´¨ ï¼š é€‰å–å¯¹äºè®­ç»ƒæ•°æ®å…·æœ‰åˆ†ç±»èƒ½åŠ›çš„ç‰¹å¾ï¼ˆå†³å®šç”¨å“ªä¸ª feature æ¥åˆ’åˆ† feature spaceï¼‰ å¸¸ç”¨å‡†åˆ™ Algorithm Feature é€‰æ‹©æ–¹æ³• Author ID3 Information gain Quinlan. 1986 C4.5 Gain ratio Quinlan. 1993. CART å›å½’æ ‘ï¼š æœ€å°äºŒä¹˜åˆ†ç±»æ ‘ï¼š åŸºå°¼æŒ‡æ•° Gini index Breiman. 1984(Classification and Regression Tree åˆ†ç±»ä¸å›å½’æ ‘) 3.1 ä¿¡æ¯å¢ç›Š Information gain g(D, A)=H(D)-H(D|A) $g(D, A)$å³ä¿¡æ¯å¢ç›Šï¼Œè¡¨ç¤ºå¾—çŸ¥ç‰¹å¾$A$çš„ä¿¡æ¯è€Œä½¿å¾—ç±»$D$çš„ä¿¡æ¯çš„ä¸ç¡®å®šæ€§å‡å°‘çš„ç¨‹åº¦ $H(D)$ ä¸ºé›†åˆ $D$ çš„ä¿¡æ¯ç†µ å…¶ä¸­å‡è®¾ $D$ æ˜¯ä¸€ä¸ªå–æœ‰é™ä¸ªå€¼çš„ç¦»æ•£éšæœºå˜é‡ï¼Œæ¦‚ç‡åˆ†å¸ƒä¸º $P(X=x_i)=p_i, i=1, 2,â€¦,n$ ç†µæ˜¯è¡¨ç¤ºéšæœºå˜é‡ä¸ç¡®å®šæ€§çš„åº¦é‡ï¼Œå®šä¹‰ $H(D)=- \\sum_{i=1}^n p_ilogp_i$ï¼Œç†µè¶Šå¤§ï¼Œéšæœºå˜é‡çš„ä¸ç¡®å®šæ€§å°±è¶Šå¤§ï¼Œ$0 \\leq H(D) \\leq logn$ $H(D|A)$ ç»éªŒæ¡ä»¶ç†µåœ¨å·²çŸ¥éšæœºå˜é‡$A$ï¼ˆç‰¹å¾ï¼‰çš„æ¡ä»¶ä¸‹éšæœºå˜é‡ $D$ çš„ä¸ç¡®å®šæ€§$H(D|A)= \\sum_{i=1}^{n}p_iH(D|A=a_i)$ ä¸€èˆ¬å°†ç†µ $H(D)$ ä¸æ¡ä»¶ç†µ $H(D|A)$ ä¹‹å·®ç§°ä¸ºäº’ä¿¡æ¯ï¼Œå†³ç­–æ ‘å­¦ä¹ ä¸­çš„ä¿¡æ¯å¢ç›Šç­‰ä»·äºç±»ä¸ç‰¹å¾çš„äº’ä¿¡æ¯ å°ç»“: ç»™å®šè®­ç»ƒæ•°æ®é›† $D$ å’Œç‰¹å¾ $A$ï¼Œç»éªŒç†µ $H(D)$ è¡¨ç¤ºå¯¹æ•°æ®é›† $D$ è¿›è¡Œåˆ†ç±»çš„ä¸ç¡®å®šæ€§ï¼Œè€Œç»éªŒæ¡ä»¶ç†µ $H(D|A)$ è¡¨ç¤ºåœ¨ç‰¹å¾ $A$ ç»™å®šçš„æ¡ä»¶ä¸‹å¯¹æ•°æ®é›†è¿›è¡Œåˆ†ç±»çš„ä¸ç¡®å®šæ€§ï¼Œå› æ­¤ä¸¤è€…ä¹‹å·®å³ä¿¡æ¯å¢ç›Šè¡¨ç¤ºç”±äºç‰¹å¾ $A$ è€Œä½¿å¾—æ•°æ®é›† $D$ çš„åˆ†ç±»çš„ä¸ç¡®å®šæ€§å‡å°‘çš„ç¨‹åº¦. å¯¹äºæ•°æ®é›† $D$ è€Œè¨€ï¼Œä¿¡æ¯å¢ç›Šä¾èµ–äºç‰¹å¾ï¼Œä¸åŒç‰¹å¾å…·æœ‰ä¸åŒçš„ä¿¡æ¯å¢ç›Šï¼Œä¿¡æ¯å¢ç›Šå¤§çš„ç‰¹å¾å…·æœ‰æ›´å¼ºçš„åˆ†ç±»èƒ½åŠ›ï¼ˆä¹Ÿå°±æ˜¯æˆ‘ä»¬éœ€è¦æŒ‘é€‰çš„ç›®æ ‡ï¼‰ 3.2 ä¿¡æ¯å¢ç›Šæ¯” Gain ratio ä»¥ä¿¡æ¯å¢ç›Šä½œä¸ºåˆ’åˆ†è®­ç»ƒæ•°æ®é›†çš„ç‰¹å¾ï¼Œå­˜åœ¨åå‘äºé€‰æ‹©å–å€¼è¾ƒå¤šçš„ç‰¹å¾çš„é—®é¢˜ï¼Œä½¿ç”¨ä¿¡æ¯å¢ç›Šæ¯”å¯ä»¥å¯¹è¿™é—®é¢˜è¿›è¡Œæ ¡æ­£. ç‰¹å¾$A$å¯¹è®­ç»ƒæ•°æ®é›†$D$çš„ä¿¡æ¯å¢ç›Šæ¯”$g_R(D,A)$å®šä¹‰ä¸ºå…¶ä¿¡æ¯å¢ç›Š$g(D,A)$ä¸è®­ç»ƒæ•°æ®é›†$D$å…³äºç‰¹å¾$A$çš„å€¼çš„ç†µ$H_A(D)$ä¹‹æ¯”ï¼š g_R(D,A)= \\frac{g(D,A)}{H_A(D)}å…¶ä¸­ H\\_A(D)=- \\sum\\_{i=1}^{n} \\frac{|D\\_{i}|}{|D|}log\\_2 \\frac{|D\\_{i}|}{|D|} $n$ ä¸ºç‰¹å¾ $A$ çš„å–å€¼ä¸ªæ•°ï¼Œ$D_i$ è¡¨ç¤ºæ®ç‰¹å¾ $A$ çš„å–å€¼å°† $D$ åˆ†æˆçš„å­é›† 4. å†³ç­–æ ‘çš„ç”Ÿæˆ4.1 ID3æ ¸å¿ƒæ€æƒ³: åœ¨å†³ç­–æ ‘çš„å„ä¸ªç»“ç‚¹ä¸Šåº”ç”¨ä¿¡æ¯å¢ç›Šå‡†åˆ™é€‰æ‹©ç‰¹å¾ï¼Œé€’å½’åœ°æ„å»ºå†³ç­–æ ‘ã€‚ é€’å½’ç»ˆæ­¢æ¡ä»¶ï¼šæ‰€æœ‰ç‰¹å¾çš„ä¿¡æ¯å¢ç›Šï¼ˆè®¾ç½®ä¿¡æ¯å¢ç›Šçš„é˜ˆå€¼æ¥åˆ¤æ–­æ˜¯å¦è¿›ä¸€æ­¥åˆ’åˆ†ï¼‰å‡å¾ˆå°æˆ–æ²¡ç‰¹å¾å¯é€‰ä¸ºæ­¢. ï¼ˆæ¯é€‰ä¸€ä¸ªç‰¹å¾åˆ™åæœŸåˆ’åˆ†å­æ ‘ä¸å†ä½¿ç”¨å‰é¢ç”¨è¿‡çš„ç‰¹å¾ï¼Œå› ä¸ºå­æ ‘å·²ç»æ˜¯åœ¨è¯¥ç‰¹å¾ä¸‹å±äºåŒä¸€å–å€¼çš„å®ä¾‹é›†åˆï¼‰ å†³ç­–æ ‘çš„ç”Ÿæˆ: è¾“å…¥ï¼šè®­ç»ƒæ•°æ®é›† $D$ å’Œç‰¹å¾é›† $A$ï¼Œé˜ˆå€¼ $Îµ$ï¼›è¾“å‡ºï¼šå†³ç­–æ ‘ $T$ (1) ï¼ˆå¶å­ç»“ç‚¹ï¼‰è‹¥ $D$ ä¸­æ‰€æœ‰å®ä¾‹å±äºåŒä¸€ç±» $C_k$, åˆ™ $T$ ä¸ºå•èŠ‚ç‚¹æ ‘ï¼Œå¹¶å°†ç±»$C_k$ ä½œä¸ºè¯¥ç»“ç‚¹çš„ç±»æ ‡è®°ï¼Œè¿”å› $T$ (2) ï¼ˆç»ˆæ­¢æ¡ä»¶ä¹‹æ²¡æœ‰ç‰¹å¾å¯ä¾›é€‰æ‹©ï¼‰ è‹¥ $A=âˆ…$, åˆ™ $T$ä¸ºå•èŠ‚ç‚¹æ ‘ï¼Œå¹¶å°† $D$ ä¸­å®ä¾‹æ•°æœ€å¤§çš„ç±» $C_k$ ä½œä¸ºè¯¥ç»“ç‚¹çš„ class æ ‡è®°ï¼ˆå¤šæ•°è¡¨å†³è§„åˆ™ï¼‰ï¼Œè¿”å› $T$ (3) ï¼ˆè®¡ç®— $A$ ä¸­å„ç‰¹å¾å¯¹ $D$ çš„ä¿¡æ¯å¢ç›Šï¼Œé€‰æ‹©ä¿¡æ¯å¢ç›Šæœ€å¤§çš„ç‰¹å¾ $A_g$ (4) ï¼ˆç»ˆæ­¢æ¡ä»¶ä¹‹é˜ˆå€¼) è‹¥ $A_g$ çš„ä¿¡æ¯å¢ç›Šå°äºé˜ˆå€¼ $Îµ$ï¼Œåˆ™ç½® $T$ ä¸ºå•èŠ‚ç‚¹æ ‘ï¼Œå¹¶å°† $D$ ä¸­å®ä¾‹æ•°æœ€å¤§çš„ç±» $C_k$ ä½œä¸ºè¯¥ç»“ç‚¹çš„ç±»æ ‡è®°ï¼Œè¿”å› $T$ (5) å¦åˆ™ï¼Œå¯¹ $A_g$ çš„æ¯ä¸€å¯èƒ½å€¼ $a_i$ï¼Œä¾ $A_g=a_i$ å°† $D$ åˆ’åˆ†ä¸ºè‹¥å¹²éç©ºå­é›† $D_i$ï¼Œå¹¶å°† $D_i$ ä¸­å®ä¾‹æ•°æœ€å¤§çš„ç±»ä½œä¸ºæ ‡è®°æ„å»ºå­èŠ‚ç‚¹ï¼Œè¿”å› $T_i$(6) å¯¹ç¬¬ $i$ ä¸ªå­èŠ‚ç‚¹ï¼Œä»¥ $D_i$ ä¸ºè®­ç»ƒé›†ï¼Œ$A âˆ’ {A_g}$ ä¸ºç‰¹å¾é›†ï¼Œé€’å½’åœ°è°ƒç”¨(1)~(5)å¾—åˆ°å­æ ‘ $T_i$ å¹¶è¿”å›. 4.2 C4.5C4.5ç®—æ³•ä¸ID3ç®—æ³•ç±»ä¼¼ï¼Œä¸åŒä¹‹å¤„åœ¨äºï¼ŒC4.5åœ¨ç”Ÿæˆçš„è¿‡ç¨‹ä¸­ï¼Œç”¨Gain ratioæ¥é€‰æ‹©ç‰¹å¾ã€‚ Notes: ä¸Šè¿°å†³ç­–æ ‘çš„ç”Ÿæˆç®—æ³•åªæœ‰æ ‘çš„ç”Ÿæˆï¼Œè€Œä¸”æ˜¯é’ˆå¯¹è®­ç»ƒé›†æ„é€ çš„æ ‘ï¼Œå®¹æ˜“äº§ç”Ÿè¿‡æ‹Ÿåˆã€‚ 5. CART(classification and regression tree) CART å‡è®¾å†³ç­–æ ‘æ˜¯äºŒå‰æ ‘ï¼Œè€Œ ID3,C4.5 ç”Ÿæˆçš„è¿‡ç¨‹ä¸­å¹¶æ— æ­¤å‡è®¾ï¼Œè¿™ä¹Ÿå¯¼è‡´äº†ä¸¤è€…çš„æ ¹æœ¬ä¸åŒï¼ŒID3,C4.5 æ¯æ¬¡é€‰æ‹©å‡ºæœ€ä½³ç‰¹å¾ä¹‹åï¼Œæ˜¯æŒ‰ç…§è¯¥ç‰¹å¾çš„æ¯ä¸€ä¸ªå–å€¼åˆ’åˆ†å­æ ‘ï¼› CART åˆ™æ˜¯å¯¹æ¯ä¸€ä¸ªç‰¹å¾ã€æ¯ä¸€ä¸ªç‰¹å¾çš„æ¯ä¸€ä¸ªå–å€¼è®¡ç®—åŸºå°¼æŒ‡æ•°ï¼ˆåˆ†ç±»æ ‘ï¼‰ç„¶åä»æ‰€æœ‰ç‰¹å¾å¯¹åº”çš„å–å€¼è®¡ç®—æ‰€å¾—çš„åŸºå°¼æŒ‡æ•°ä¸­æœ€å°çš„ç‰¹å¾åŠç‰¹å¾å€¼ä½œä¸ºåˆ‡åˆ†ç‚¹æ¥åˆ’åˆ†å­æ ‘ï¼Œå¹¶åœ¨è¿™äº›å­ç©ºé—´ä¸Šç¡®å®šé¢„æµ‹çš„æ¦‚ç‡åˆ†å¸ƒï¼Œä¹Ÿå°±æ˜¯åœ¨è¾“å…¥ç»™å®šçš„æ¡ä»¶ä¸‹è¾“å‡ºå¯¹åº”çš„æ¡ä»¶æ¦‚ç‡åˆ†å¸ƒ. 5.1 CART çº¯åº¦åº¦é‡CART ä¸­ç”¨äºé€‰æ‹©å˜é‡çš„ä¸çº¯æ€§åº¦é‡æ˜¯ Gini indexï¼›å¦‚æœç›®æ ‡å˜é‡æ˜¯æ ‡ç§°çš„ï¼Œå¹¶ä¸”æ˜¯å…·æœ‰ä¸¤ä¸ªä»¥ä¸Šçš„ç±»åˆ«ï¼Œåˆ™ CART å¯èƒ½è€ƒè™‘å°†ç›®æ ‡ç±»åˆ«åˆå¹¶æˆä¸¤ä¸ªè¶…ç±»åˆ«ï¼ˆåŒåŒ–ï¼‰ï¼›å¦‚æœç›®æ ‡å˜é‡æ˜¯è¿ç»­çš„ï¼Œåˆ™ CART æ‰¾å‡ºä¸€ç»„åŸºäºæ ‘çš„å›å½’æ–¹ç¨‹æ¥é¢„æµ‹ç›®æ ‡å˜é‡ã€‚ Algorithm Feature Selection Author CART å›å½’æ ‘ï¼š æœ€å°äºŒä¹˜åˆ†ç±»æ ‘ï¼š åŸºå°¼æŒ‡æ•° Gini index Breiman. 1984(Classification and Regression Tree åˆ†ç±»ä¸å›å½’æ ‘) 5.2 CART æ­¥éª¤build decision treeæ—¶é€šå¸¸é‡‡ç”¨è‡ªä¸Šè€Œä¸‹çš„æ–¹æ³•ï¼Œåœ¨æ¯ä¸€æ­¥é€‰æ‹©ä¸€ä¸ªæœ€å¥½çš„å±æ€§æ¥åˆ†è£‚ã€‚ â€œæœ€å¥½â€ çš„å®šä¹‰æ˜¯ä½¿å¾—å­èŠ‚ç‚¹ä¸­çš„è®­ç»ƒé›†å°½é‡çš„çº¯ã€‚ä¸åŒçš„ç®—æ³•ä½¿ç”¨ä¸åŒçš„æŒ‡æ ‡æ¥å®šä¹‰â€æœ€å¥½â€ã€‚ CART æ˜¯åœ¨ç»™å®šè¾“å…¥éšæœºå˜é‡ $X$ æ¡ä»¶ä¸‹æ±‚å¾—è¾“å‡ºéšæœºå˜é‡ $Y$ çš„æ¡ä»¶æ¦‚ç‡åˆ†å¸ƒçš„å­¦ä¹ æ–¹æ³•ã€‚ å¯ä»¥çœ‹å‡ºCARTç®—æ³•åœ¨å¶èŠ‚ç‚¹è¡¨ç¤ºä¸Šä¸åŒäºID3ã€C4.5æ–¹æ³•ï¼ŒåäºŒè€…å¶èŠ‚ç‚¹å¯¹åº”æ•°æ®å­é›†é€šè¿‡â€œå¤šæ•°è¡¨å†³â€çš„æ–¹å¼æ¥ç¡®å®šä¸€ä¸ªç±»åˆ«ï¼ˆå›ºå®šä¸€ä¸ªå€¼ï¼‰ï¼›è€ŒCARTç®—æ³•çš„å¶èŠ‚ç‚¹å¯¹åº”ç±»åˆ«çš„æ¦‚ç‡åˆ†å¸ƒã€‚å¦‚æ­¤çœ‹æ¥ï¼Œæˆ‘ä»¬å¯ä»¥å¾ˆå®¹æ˜“åœ°ç”¨ CART æ¥å­¦ä¹ ä¸€ä¸ª multi-label çš„åˆ†ç±»ä»»åŠ¡ã€‚ CART ç®—æ³•ä¹Ÿä¸»è¦ç”±ä¸¤æ­¥ç»„æˆ: å†³ç­–æ ‘çš„ç”Ÿæˆï¼šåŸºäºè®­ç»ƒæ•°æ®é›†ç”Ÿæˆä¸€æ£µäºŒåˆ†å†³ç­–æ ‘ï¼› å†³ç­–æ ‘çš„å‰ªæï¼šç”¨éªŒè¯é›†å¯¹å·²ç”Ÿæˆçš„äºŒå‰å†³ç­–æ ‘è¿›è¡Œå‰ªæï¼Œå‰ªæçš„æ ‡å‡†ä¸ºæŸå¤±å‡½æ•°æœ€å°åŒ–ã€‚ ç”±äºåˆ†ç±»æ ‘ä¸å›å½’æ ‘åœ¨é€’å½’åœ°æ„å»ºäºŒå‰å†³ç­–æ ‘çš„è¿‡ç¨‹ä¸­ï¼Œé€‰æ‹©ç‰¹å¾åˆ’åˆ†çš„å‡†åˆ™ä¸åŒã€‚ äºŒå‰åˆ†ç±»æ ‘æ„å»ºè¿‡ç¨‹ä¸­é‡‡ç”¨åŸºå°¼æŒ‡æ•°ï¼ˆGini Indexï¼‰ä¸ºç‰¹å¾é€‰æ‹©æ ‡å‡†ï¼› äºŒå‰å›å½’æ ‘é‡‡ç”¨å¹³æ–¹è¯¯å·®æœ€å°åŒ–ä½œä¸ºç‰¹å¾é€‰æ‹©æ ‡å‡†ã€‚ 5.3 æ ‘çš„æ„å»º5.3.1 äºŒå‰å›å½’æ ‘è®¾ $X$, $Y$ åˆ†åˆ«ä¸ºè¾“å…¥å’Œè¾“å‡ºå˜é‡ï¼Œå…¶ä¸­ $Y$ ä¸ºè¿ç»­å˜é‡ï¼Œç»™å®šè®­ç»ƒæ•°æ®é›† $D= \\lbrace (x_1, y_1), (x_2, y_2),â€¦,(x_N, y_N) \\rbrace$ å†³ç­–æ ‘çš„ç”Ÿæˆå°±æ˜¯é€’å½’åœ°æ„å»ºäºŒå‰å†³ç­–æ ‘çš„è¿‡ç¨‹ï¼Œå¯¹å›å½’æ ‘ç”¨å¹³æ–¹è¯¯å·®æœ€å°åŒ–å‡†åˆ™ï¼Œå¯¹åˆ†ç±»æ ‘ç”¨åŸºå°¼æŒ‡æ•°æœ€å°åŒ–å‡†åˆ™ï¼Œè¿›è¡Œç‰¹å¾é€‰æ‹©ï¼Œç”ŸæˆäºŒå‰æ ‘ ä¸€ä¸ªå›å½’æ ‘å¯¹åº”ç€è¾“å…¥ç©ºé—´ï¼ˆå³ç‰¹å¾ç©ºé—´ï¼‰çš„ä¸€ä¸ªåˆ’åˆ†ä»¥åŠåœ¨åˆ’åˆ†çš„å•å…ƒä¸Šçš„è¾“å‡ºå€¼ï¼Œæ‰€ä»¥æˆ‘ä»¬çš„ä¸»è¦ç›®çš„æ˜¯è¦æ„å»ºå›å½’æ ‘ï¼Œä¹Ÿå°±æ˜¯å¦‚ä½•åˆ’åˆ†è¾“å…¥ç©ºé—´ï¼Œå› ä¸ºä¸€æ—¦åˆ’åˆ†å¥½è¾“å…¥ç©ºé—´ï¼Œå¦‚å°†è¾“å…¥ç©ºé—´åˆ’åˆ†ä¸º $M$ ä¸ªå•å…ƒ, $R_1, R_2, â€¦ , R_M$ , å¹¶ä¸”åœ¨æ¯ä¸ªå•å…ƒ $R_m$ ä¸Šæœ‰ä¸€ä¸ªå›ºå®šçš„è¾“å‡ºå€¼ $c_m$ï¼Œé‚£ä¹ˆå›å½’æ ‘çš„æ¨¡å‹å°±å¯ä»¥è¡¨ç¤ºä¸º f(x)=\\sum\\_{m=1}^Mc\\_mI(x \\in R\\_m)æ¦‚å¿µå¼ºè°ƒ é¦–å…ˆè¦å¼ºè°ƒçš„æ˜¯ CARTå‡è®¾å†³ç­–æ ‘æ˜¯äºŒå‰æ ‘ï¼Œå†…éƒ¨ç»“ç‚¹ç‰¹å¾çš„å–å€¼åªæœ‰â€œæ˜¯â€å’Œâ€œå¦â€ï¼Œå·¦åˆ†æ”¯æ˜¯å–å€¼ä¸ºâ€œæ˜¯â€çš„åˆ†æ”¯ï¼Œæœ‰åˆ†æ”¯åˆ™ç›¸åã€‚è¿™æ ·çš„å†³ç­–æ ‘ç­‰ä»·äºé€’å½’åœ°äºŒåˆ†æ¯ä¸ªç‰¹å¾. æœ€å°äºŒå‰å›å½’æ ‘ç”Ÿæˆç®—æ³• è¾“å…¥ï¼šè®­ç»ƒæ•°æ®é›†$D$ï¼›è¾“å‡ºï¼šå›å½’æ ‘ $f(x)$ ç®—æ³•ï¼šåœ¨è®­ç»ƒé›†æ‰€åœ¨çš„è¾“å…¥ç©ºé—´ä¸­ï¼Œé€’å½’åœ°å°†æ¯ä¸ªåŒºåŸŸåˆ’åˆ†ä¸ºä¸¤ä¸ªå­åŒºåŸŸå¹¶å†³å®šæ¯ä¸ªå­åŒºåŸŸä¸Šè¾“å‡ºå€¼ï¼Œæ„å»ºäºŒå‰å†³ç­–æ ‘ (1). æ‹©æœ€ä¼˜åˆ‡åˆ†å˜é‡$j$ä¸åˆ‡åˆ†ç‚¹$s$ï¼Œæ±‚è§£ \\min\\_{j,s}[\\min\\_{c\\_1} \\sum\\_{x\\_i\\in R\\_1(j,s)}(y\\_i-c\\_1)^2 + \\min\\_{c\\_2} \\sum\\_{x\\_i\\in R\\_2(j,s)}(y\\_i-c\\_2)^2] éå†å˜é‡$j$ï¼Œå¯¹å›ºå®šçš„åˆ‡åˆ†å˜é‡$j$æ‰«æåˆ‡åˆ†ç‚¹$s$ï¼Œé€‰æ‹©ä½¿ä¸Šå¼æœ€å°å€¼çš„å¯¹$(j,s)$ã€‚å…¶ä¸­$R_m$æ˜¯è¢«åˆ’åˆ†çš„è¾“å…¥ç©ºé—´ï¼Œ$c_m$æ˜¯ç©ºé—´$R_m$å¯¹åº”çš„å›ºå®šè¾“å‡ºå€¼ã€‚ (2). ç”¨é€‰å®šçš„å¯¹$(j,s)$åˆ’åˆ†åŒºåŸŸå¹¶å†³å®šç›¸åº”çš„è¾“å‡ºå€¼ï¼š R_1(j,s)=\\lbrace x\\mid x^{(j)} \\le s \\rbrace , \\quad R_2(j,s)=\\lbrace x \\mid x^{(j)} \\gt s \\rbrace \\hat c\\_m = {1\\over N\\_m}\\sum\\_{x\\_i\\in R\\_m(j,s)}y\\_i , \\quad x\\in R\\_m , m=1,2(3). ç»§ç»­å¯¹ä¸¤ä¸ªå­åŒºåŸŸè°ƒç”¨æ­¥éª¤ï¼ˆ1ï¼‰ï¼Œï¼ˆ2ï¼‰ï¼Œç›´è‡³æ»¡è¶³åœæ­¢æ¡ä»¶ã€‚ (4). å°†è¾“å…¥ç©ºé—´åˆ’åˆ†ä¸º$M$ä¸ªåŒºåŸŸ$R_1$,$R_2$ , â€¦ , $R_M$ï¼Œç”Ÿæˆå†³ç­–æ ‘ï¼š f(x) = \\sum\\_{m=1}^M\\hat c\\_m I(x\\in R)ä¸¾ä¸ªğŸŒ°ğŸŒ°ğŸŒ°: è®­ç»ƒæ•°æ®è§ä¸‹è¡¨ï¼Œ$x$ çš„å–å€¼èŒƒå›´ä¸ºåŒºé—´ $[0.5,10.5]$, $y$ çš„å–å€¼èŒƒå›´ä¸ºåŒºé—´$[5.0,10.0]$ ,å­¦ä¹ è¿™ä¸ªå›å½’é—®é¢˜çš„æœ€å°äºŒå‰å›å½’æ ‘ã€‚ $x_i$ 1 2 3 4 5 6 7 8 9 10 $y_i$ 5.56 5.70 5.91 6.40 6.80 7.05 8.90 8.70 9.00 9.05 é¦–å…ˆæ¥çœ‹è¿™ä¸ªä¼˜åŒ–é—®é¢˜ \\min\\_{j,s}[\\min\\_{c\\_1} \\sum\\_{x\\_i\\in R\\_1(j,s)}(y\\_i-c\\_1)^2 + \\min\\_{c\\_2} \\sum\\_{x\\_i\\in R\\_2(j,s)}(y\\_i-c\\_2)^2]æ±‚è§£è®­ç»ƒæ•°æ®çš„åˆ‡åˆ†ç‚¹s: R_1(j,s)=\\lbrace x\\mid x^{(j)} \\le s \\rbrace , \\quad R_2(j,s)=\\lbrace x \\mid x^{(j)} \\gt s \\rbraceå®¹æ˜“æ±‚å¾—åœ¨ $R_1$,$R_2$ å†…éƒ¨ä½¿å¾—å¹³æ–¹æŸå¤±è¯¯å·®è¾¾åˆ°æœ€å°å€¼çš„ $c_1$,$c_2$ ä¸ºï¼š c\\_1={1\\over N\\_1}\\sum\\_{x\\_i \\in R\\_1}y\\_i , \\quad c\\_2={1\\over N\\_2}\\sum\\_{x\\_i \\in R\\_2}y\\_iè¿™é‡Œ $N_1$,$N_2$ æ˜¯ $R_1$,$R_2$çš„æ ·æœ¬ç‚¹æ•°ã€‚ æ±‚è®­ç»ƒæ•°æ®çš„åˆ‡åˆ†ç‚¹ï¼Œæ ¹æ®æ‰€ç»™æ•°æ®ï¼Œè€ƒè™‘å¦‚ä¸‹åˆ‡åˆ†ç‚¹ï¼š 1.5,2.5,3.5,4.5,5.5,6.5,7.5,8.5,9.5å¯¹å„åˆ‡åˆ†ç‚¹ï¼Œä¸éš¾æ±‚å‡ºç›¸åº”çš„ $R_1$ , $R_2$ , $c_1$ , $c_2$ åŠ m(s)=\\min\\_{j,s}[\\min\\_{c\\_1} \\sum\\_{x\\_i\\in R\\_1(j,s)}(y\\_i-c\\_1)^2 + \\min\\_{c\\_2} \\sum\\_{x\\_i\\in R\\_2(j,s)}(y\\_i-c\\_2)^2]ä¾‹å¦‚ï¼Œå½“ $s=1.5$ æ—¶ï¼Œ$R_1 = \\lbrace 1\\rbrace$, $R_2 = \\lbrace 2, 3 , \\ldots , 10\\rbrace$, $c_1 = 5.56$, $c_2 = 7.50$, m(s)=\\min\\_{j,s}[\\min\\_{c\\_1} \\sum\\_{x\\_i\\in R\\_1(j,s)}(y\\_i-c\\_1)^2 + \\min\\_{c\\_2} \\sum\\_{x\\_i\\in R\\_2(j,s)}(y\\_i-c\\_2)^2] = 0+15.72 = 15.72ç°å°†$s$åŠ$m(s)$çš„è®¡ç®—ç»“æœåˆ—è¡¨å¦‚ä¸‹ï¼š s 1.5 2.5 3.5 4.5 5.5 6.5 7.5 8.5 9.5 m(s) 15.72 12.07 8.36 5.78 3.91 1.93 8.01 11.73 15.74 ç”±ä¸Šè¡¨å¯çŸ¥ï¼Œå½“$x=6.5$çš„æ—¶å€™è¾¾åˆ°æœ€å°å€¼ï¼Œæ­¤æ—¶ $R_1 = \\lbrace 1 ,2 , \\ldots , 6\\rbrace$, $R_2 ={7 ,8 ,9 , 10}$, $c_1 = 6.24$, $c_2 = 8.9$ æ‰€ä»¥å›å½’æ ‘ $T_1(x)$ ä¸ºï¼š T\\_1(x) = \\begin{cases} 6.24, & x\\lt 6.5 \\\\\\\\ 8.91, & x \\ge 6.5 \\\\\\\\ \\end{cases} f\\_1(x) = T\\_1(x)ç”¨ $f_1(x)$ æ‹Ÿåˆè®­ç»ƒæ•°æ®çš„æ®‹å·®è§ä¸‹è¡¨ï¼Œè¡¨ä¸­ $r_{2i} = y_i - f_1(x_i),i=1,2,\\ldots , 10$ $x_i$ 1 2 3 4 5 6 7 8 9 10 $y_i$ -0.68 -0.54 -0.33 0.16 0.56 0.81 -0.01 -0.21 0.09 0.14 ç”¨$f_1(x)$æ‹Ÿåˆè®­ç»ƒæ•°æ®çš„å¹³æ–¹è¯¯å·®ï¼š L(y,f\\_1(x)) = \\sum\\_{i=1}^{10}(y\\_i-f\\_1(x\\_i))^2 = 1.93ç¬¬2æ­¥æ±‚ $T_2(x)$.æ–¹æ³•ä¸æ±‚ $T_1(x)$ ä¸€æ ·ï¼Œåªæ˜¯æ‹Ÿåˆçš„æ•°æ®æ˜¯ä¸Šè¡¨çš„æ®‹å·®ï¼Œå¯ä»¥å¾—åˆ°ï¼š T\\_2(x) = \\begin{cases} -0.52, & x\\lt 3.5 \\\\\\\\ 0.22, & x \\ge 3.5 \\\\\\\\ \\end{cases} f\\_2(x) = f\\_1(x) + T\\_2(x)= \\begin{cases} 5.72, & x\\lt 3.5 \\\\\\\\ 6.46, & 3.5\\le x \\lt 6.5 \\\\\\\\ 9.13, & x\\ge 6.5 \\\\\\\\ \\end{cases}ç”¨$f_2(x)$æ‹Ÿåˆè®­ç»ƒæ•°æ®çš„å¹³æ–¹è¯¯å·®æ˜¯ï¼š L(y,f\\_2(x)) = \\sum\\_{i=1}^{10}(y\\_i-f\\_2(x\\_i))^2 = 0.79ç»§ç»­æ±‚å¾— T\\_3(x) = \\begin{cases} 0.15, & x\\lt 6.5 \\\\\\\\ -0.22, & x \\ge 6.5 \\\\\\\\ \\end{cases} \\quad L(y,f\\_3(x)) = 0.47 , T\\_4(x) = \\begin{cases} -0.16, & x\\lt 4.5 \\\\\\\\ 0.11, & x \\ge 4.5 \\\\\\\\ \\end{cases} \\quad L(y,f\\_3(x)) = 0.30 , T\\_5(x) = \\begin{cases} 0.07, & x\\lt 6.5 \\\\\\\\ -0.11, & x \\ge 6.5 \\\\\\\\ \\end{cases} \\quad L(y,f\\_3(x)) = 0.23 , T\\_6(x) = \\begin{cases} -0.15, & x\\lt 2.5 \\\\ 0.04, & x \\ge 2.5 \\\\ \\end{cases} f\\_6(x) = f\\_5(x)+T\\_6(x) =T\\_1(x)+ \\ldots + T\\_5(x) + T\\_6(x)= \\begin{cases} 5.63, & x\\lt 2.5 \\\\\\\\ 5.82, & 2.5 \\le x\\lt 3.5 \\\\\\\\ 6.56, & 3.5 \\le x\\lt 4.5 \\\\\\\\ 6.83, & 4.5 \\le x\\lt 6.5 \\\\\\\\ 8.95, & x\\ge 6.5 \\\\\\\\ \\end{cases}ç”¨$f_6(x)$æ‹Ÿåˆè®­ç»ƒæ•°æ®çš„å¹³æ–¹æŸå¤±è¯¯å·®æ˜¯ L(y,f\\_6(x)) = \\sum\\_{i=1}^{10}(y\\_i-f\\_6(x\\_i))^2 = 0.71å‡è®¾æ­¤æ—¶å·²ç»æ»¡è¶³è¯¯å·®è¦æ±‚ï¼Œé‚£ä¹ˆ $f(x) = f_6(x)$ å³ä¸ºæ‰€æ±‚çš„å›å½’æ ‘ã€‚ 5.3.2 äºŒå‰åˆ†ç±»æ ‘äºŒå‰åˆ†ç±»æ ‘ä¸­ç”¨åŸºå°¼æŒ‡æ•°ï¼ˆGini Indexï¼‰ä½œä¸ºæœ€ä¼˜ç‰¹å¾é€‰æ‹©çš„åº¦é‡æ ‡å‡†ã€‚åŸºå°¼æŒ‡æ•°å®šä¹‰å¦‚ä¸‹ï¼š Gini Index : æ˜¯ä¸€ç§ä¸ç­‰æ€§åº¦é‡ï¼› é€šå¸¸ç”¨æ¥åº¦é‡æ”¶å…¥ä¸å¹³è¡¡ï¼Œå¯ä»¥ç”¨æ¥åº¦é‡ä»»ä½•ä¸å‡åŒ€åˆ†å¸ƒï¼› æ˜¯ä»‹äº0~1ä¹‹é—´çš„æ•°ï¼Œ0-å®Œå…¨ç›¸ç­‰ï¼Œ1-å®Œå…¨ä¸ç›¸ç­‰ï¼› æ€»ä½“å†…åŒ…å«çš„ç±»åˆ«è¶Šæ‚ä¹±ï¼ŒGINIæŒ‡æ•°å°±è¶Šå¤§ï¼ˆè·Ÿç†µçš„æ¦‚å¿µå¾ˆç›¸ä¼¼ï¼‰ Gini Index : åŒæ ·ä»¥åˆ†ç±»ç³»ç»Ÿä¸ºä¾‹ï¼Œæ•°æ®é›† $D$ ä¸­ç±»åˆ« $C$ å¯èƒ½çš„å–å€¼ä¸º$c_1, c_2, \\cdots, c_k$ ï¼ˆ$k$æ˜¯ç±»åˆ«æ•°ï¼‰ï¼Œä¸€ä¸ªæ ·æœ¬å±äºç±»åˆ« $c_i$ çš„æ¦‚ç‡ä¸º$p(i)$ã€‚é‚£ä¹ˆæ¦‚ç‡åˆ†å¸ƒçš„ Gini index å…¬å¼è¡¨ç¤ºä¸ºï¼š Gini(D) = 1 - \\sum_{i=1}^{k} {p\\_i}^2 \\qquad(fmt.2.1.1) å…¶ä¸­$p_i = \\frac{ç±»åˆ«å±äºc_içš„æ ·æœ¬æ•°}{æ€»æ ·æœ¬æ•°}$ã€‚å¦‚æœæ‰€æœ‰çš„æ ·æœ¬ Category ç›¸åŒï¼Œåˆ™ $p_1 = 1, p_2 = p_3 = \\cdots = p_k = 0$ï¼Œåˆ™æœ‰$p_1 = 1, p_2 = p_3 = \\cdots = p_k = 0$ï¼Œæ­¤æ—¶æ•°æ®ä¸çº¯åº¦æœ€ä½ã€‚$Gini(D)$ çš„ç‰©ç†å«ä¹‰æ˜¯è¡¨ç¤ºæ•°æ®é›† $D$ çš„ä¸ç¡®å®šæ€§ã€‚æ•°å€¼è¶Šå¤§ï¼Œè¡¨æ˜å…¶ä¸ç¡®å®šæ€§è¶Šå¤§ï¼ˆè¿™ä¸€ç‚¹ä¸ Info Entropy ç›¸ä¼¼ï¼‰ã€‚å¦‚æœ $k=2$ï¼ˆäºŒåˆ†ç±»é—®é¢˜ï¼Œç±»åˆ«å‘½åä¸ºæ­£ç±»å’Œè´Ÿç±»ï¼‰ï¼Œè‹¥æ ·æœ¬å±äºæ­£ç±»çš„æ¦‚ç‡æ˜¯ $p$ï¼Œé‚£ä¹ˆå¯¹åº”åŸºå°¼æŒ‡æ•°ä¸ºï¼š \\begin{align} Gini(D) & = 1 - [p^2 + {(1-p)}^2] \\\\\\ & = \\underline {2p (1-p)} \\qquad\\qquad (fmt.2.1.2) \\end{align} å¦‚æœæ•°æ®é›† $D$ æ ¹æ®ç‰¹å¾ $f$ æ˜¯å¦å–æŸä¸€å¯èƒ½å€¼ $f_âˆ—$ï¼Œå°† $D$ åˆ’åˆ†ä¸º $D_1={(x, y) \\in D | f(x) = f_{\\ast}}, D_2=D-D_1$ã€‚é‚£ä¹ˆç‰¹å¾ $f$ åœ¨æ•°æ®é›† $D$ ä¸Šçš„ Gini index å®šä¹‰ä¸ºï¼š Gini(D, f=f\\_{\\ast}) = \\frac{\\vert D_1 \\vert}{\\vert D \\vert} Gini(D\\_1) + \\frac{\\vert D\\_2 \\vert}{\\vert D \\vert} Gini(D_2) \\qquad\\qquad (fmt.2.1.3)ä»£è¡¨æ€§çš„ä¾‹å­è¯´æ˜ : ID é˜´æ™´(F) æ¸©åº¦(F) æ¹¿åº¦(F) åˆ®é£(F) æ˜¯å¦ç©ï¼ˆCï¼‰ 1 sunny hot high false å¦ 2 sunny hot high true å¦ 3 overcast hot high false æ˜¯ 4 rainy mild high false æ˜¯ 5 rainy cool normal false æ˜¯ 6 rainy cool normal true å¦ 7 overcast cool normal true æ˜¯ 8 sunny mild high false å¦ 9 sunny cool normal false æ˜¯ 10 rainy mild normal false æ˜¯ 11 sunny mild normal true æ˜¯ 12 overcast mild high true æ˜¯ 13 overcast hot normal false æ˜¯ 14 rainy mild high true å¦ ä¸‹å›¾æ˜¯ IG çš„å†³ç­–æ ‘ï¼Œå¹¶ä¸æ˜¯ äºŒåˆ†åˆ†ç±»æ ‘ ${Gini}$ ${index}$ å†³ç­–æ ‘, æ”¾è¿™é‡Œä»…ä»…æ˜¯ä¸ºäº†æ„ŸçŸ¥ä¸€ä¸‹ åœ¨å®é™…æ“ä½œä¸­ï¼Œé€šè¿‡éå†æ‰€æœ‰ç‰¹å¾ï¼ˆå¦‚æœæ˜¯è¿ç»­å€¼ï¼Œéœ€åšç¦»æ•£åŒ–ï¼‰åŠå…¶å–å€¼ï¼Œé€‰æ‹© $Min_{gini-index}$ æ‰€å¯¹åº”çš„ç‰¹å¾å’Œç‰¹å¾å€¼ã€‚ è¿™é‡Œä»ç„¶ä»¥å¤©æ°”æ•°æ®ä¸ºä¾‹ï¼Œç»™å‡ºç‰¹å¾é˜´æ™´çš„ Gini index è®¡ç®—è¿‡ç¨‹ã€‚ (1). å½“ç‰¹å¾â€œé˜´æ™´â€å–å€¼ä¸ºâ€sunnyâ€æ—¶ï¼Œ$D_1 = {1,2,8,9,11}, |D_1|=5$ï¼›$D_2={3,4,5,6,7,10,12,13,14}, |D_2|=9$. æ•°æ®è‡ªå·±å¯¹åº”çš„ç±»åˆ«æ•°åˆ†åˆ«ä¸º $(+2,-3)ã€(+7,-2)$ã€‚å› æ­¤ $Gini(D_1) = 2 \\cdot \\frac{3}{5} \\cdot \\frac{2}{5} = \\frac{12}{25}$ï¼›$Gini(D_2) = 2 \\cdot \\frac{7}{9} \\cdot \\frac{2}{9} = \\frac{28}{81}$. å¯¹åº”çš„åŸºå°¼æŒ‡æ•°ä¸ºï¼š Gini(C, â€œé˜´æ™´â€=â€sunnyâ€) = \\frac{5}{14} Gini(D_1) + \\frac{9}{14} Gini(D_2) = \\frac{5}{14} \\frac{12}{25} + \\frac{9}{14} \\frac{28}{81} = 0.394 \\quad(exp.2.2.1)(2). å½“ç‰¹å¾â€œé˜´æ™´â€å–å€¼ä¸ºâ€overcastâ€æ—¶ï¼Œ$D_1 = {2,7,12,13}, |D_1|=4$ï¼›$D_2={1,2,4,5,6,8,9,10,11,14}, |D_2|=10$ã€‚$D_1$ã€$D_2$ æ•°æ®è‡ªå·±å¯¹åº”çš„ç±»åˆ«æ•°åˆ†åˆ«ä¸º $(+4,-0)ã€(+5,-5)$ã€‚å› æ­¤ $Gini(D_1) = 2 \\cdot 1 \\cdot 0 = 0ï¼›Gini(D_2) = 2 \\cdot \\frac{5}{10} \\cdot \\frac{5}{10} = \\frac{1}{2}$ å¯¹åº”çš„åŸºå°¼æŒ‡æ•°ä¸ºï¼š Gini(C, â€œé˜´æ™´â€=â€overcastâ€) = \\frac{4}{14} Gini(D_1) + \\frac{10}{14} Gini(D_2) = 0 + \\frac{10}{14} \\cdot \\frac{1}{2} = \\frac{5}{14} = 0.357 \\quad(exp.2.2.2)(3). å½“ç‰¹å¾â€œé˜´æ™´â€å–å€¼ä¸ºâ€rainyâ€æ—¶ï¼Œ$D_1 = {4,5,6,10,14}, |D_1|=5$; $D_2={1,2,3,7,8,9,11,12,13}, |D_2|=9$ã€‚ $D_1$ã€$D_2$ æ•°æ®è‡ªå·±å¯¹åº”çš„ç±»åˆ«æ•°åˆ†åˆ«ä¸º $(+3,âˆ’2)ã€(+6,âˆ’3)$ã€‚å› æ­¤ $Gini(D_1) = 2 \\cdot \\frac{3}{5} \\cdot \\frac{2}{5} = \\frac{12}{25}$ï¼›$Gini(D_2) = 2 \\cdot \\frac{6}{9} \\cdot \\frac{3}{9} = \\frac{4}{9}$ã€‚ å¯¹åº”çš„åŸºå°¼æŒ‡æ•°ä¸ºï¼š Gini(C, â€œé˜´æ™´â€=â€rainyâ€) = \\frac{5}{14} Gini(D_1) + \\frac{9}{14} Gini(D_2) = \\frac{5}{14} \\frac{12}{25} + \\frac{9}{14} \\frac{4}{9} = \\frac{4}{7} = 0.457 \\quad(exp.2.2.3) å¦‚æœç‰¹å¾â€é˜´æ™´â€æ˜¯æœ€ä¼˜ç‰¹å¾çš„è¯ï¼Œé‚£ä¹ˆç‰¹å¾å–å€¼ä¸ºâ€overcastâ€åº”ä½œä¸ºåˆ’åˆ†èŠ‚ç‚¹ã€‚ 6. å†³ç­–æ ‘æ¨¡å‹çš„ä¼˜ç¼ºç‚¹6.1 ä¼˜ç‚¹ å¯è§£é‡Šæ€§â€“æ¨¡æ‹Ÿäººç±»å†³ç­–è¿‡ç¨‹ è®­ç»ƒã€é¢„æµ‹æ•ˆç‡è¾ƒé«˜â€“å…³äºå…¶åˆ‡åˆ†æ–¹å¼ï¼Œæ¯æ¬¡æ˜¯åœ¨ä¸€ä¸ªæ¡ä»¶ä¸‹çš„å±€éƒ¨ç©ºé—´åˆ’åˆ†æ ·æœ¬ï¼Œè€Œç±»ä¼¼Adabooståˆ™æ˜¯æ¯æ¬¡åœ¨æ•´ä¸ªç©ºé—´åˆ’åˆ†æ ·æœ¬ï¼Œæ‰€ä»¥å°±å†³ç­–æ ‘è€Œè¨€ç›¸å¯¹é«˜æ•ˆ é€‚ç”¨äºç±»åˆ«ç±»å‹æ•°æ®â€“decision set(ç©·ä¸¾ç±»åˆ«ç‰¹å¾å€¼ç„¶åæŒ‰ç…§ç‰¹å¾å€¼çš„å­é›†é›†åˆæ¥åˆ’åˆ†æ ·æœ¬) èƒ½å¤Ÿå¾ˆæ–¹ä¾¿çš„ç”±äºŒåˆ†ç±»æ¨¡å‹è½¬æ¢ä¸ºå¤šåˆ†ç±»æ¨¡å‹â€“ä¸»è¦ä¿®æ”¹ä¸çº¯åº¦è®¡ç®—ä»¥åŠè¿”å›å€¼çš„è®¾ç½® èƒ½å¤Ÿå¤„ç†ç¼ºå¤±ç‰¹å¾å€¼â€“ç”¨å…¶ä»–çš„ç‰¹å¾å€¼æ¥æ›¿ä»£è¿›è¡Œåˆ’åˆ†(ä¸€èˆ¬è¦æ±‚æ›¿ä»£ç‰¹å¾åˆ’åˆ†ç»“æœæ¥è¿‘ç¼ºå¤±ç‰¹å¾å€¼) æ˜“äºå®ç° 6.2 ç¼ºç‚¹ ç»éªŒå¤šäºç†è®ºï¼Œå¤§å¤šæ•°å†³ç­–æ ‘æ¨¡å‹æ˜¯æ ¹æ®ç»éªŒæ¥åˆ¤æ–­çš„ï¼Œæ•ˆæœå¥½åå°šæ— è¾ƒå¥½çš„ç†è®ºæ”¯æ’‘ Reference article é€—æ¯”ç®—æ³•å·¥ç¨‹å¸ˆã€ç®—æ³•æ‚è´§é“º 52camlã€æ‡’æ­»éª†é©¼ å†³ç­–æ ‘ID3ã€C4.5ã€CARTç®—æ³•ï¼šä¿¡æ¯ç†µï¼ŒåŒºåˆ«ï¼Œå‰ªæç†è®ºæ€»ç»“ Markdown å­¦ä¹ å¥½æ•™æã€CARTä¹‹å›å½’æ ‘æ„å»º ã€Šæœºå™¨å­¦ä¹ å¯¼è®ºã€‹ã€Šç»Ÿè®¡å­¦ä¹ æ–¹æ³•ã€‹","categories":[{"name":"machine-learning","slug":"machine-learning","permalink":"http://iequa.com/categories/machine-learning/"}],"tags":[{"name":"decision-tree","slug":"decision-tree","permalink":"http://iequa.com/tags/decision-tree/"}]},{"title":"Support Vecor Machine (å…­éƒ¨æ›²)","slug":"ml/svm-hanxiaoyang","date":"2018-06-20T08:08:21.000Z","updated":"2019-10-20T04:30:35.043Z","comments":true,"path":"2018/06/20/ml/svm-hanxiaoyang/","link":"","permalink":"http://iequa.com/2018/06/20/ml/svm-hanxiaoyang/","excerpt":"Support Vecor Machine, è‡ªä¸€è¯ç”Ÿä¾¿ç”±äºå®ƒè‰¯å¥½çš„åˆ†ç±»æ€§èƒ½å¸­å·äº†æœºå™¨å­¦ä¹ é¢†åŸŸï¼Œå¹¶ç‰¢ç‰¢å‹åˆ¶äº†ç¥ç»ç½‘ç»œé¢†åŸŸå¥½å¤šå¹´ã€‚ å¦‚æœä¸è€ƒè™‘é›†æˆå­¦ä¹ çš„ç®—æ³•ï¼Œä¸è€ƒè™‘ç‰¹å®šçš„è®­ç»ƒæ•°æ®é›†ï¼Œåœ¨åˆ†ç±»ç®—æ³•ä¸­çš„è¡¨ç°SVMè¯´æ˜¯æ’ç¬¬ä¸€ä¼°è®¡æ˜¯æ²¡æœ‰ä»€ä¹ˆå¼‚è®®çš„.","text":"Support Vecor Machine, è‡ªä¸€è¯ç”Ÿä¾¿ç”±äºå®ƒè‰¯å¥½çš„åˆ†ç±»æ€§èƒ½å¸­å·äº†æœºå™¨å­¦ä¹ é¢†åŸŸï¼Œå¹¶ç‰¢ç‰¢å‹åˆ¶äº†ç¥ç»ç½‘ç»œé¢†åŸŸå¥½å¤šå¹´ã€‚ å¦‚æœä¸è€ƒè™‘é›†æˆå­¦ä¹ çš„ç®—æ³•ï¼Œä¸è€ƒè™‘ç‰¹å®šçš„è®­ç»ƒæ•°æ®é›†ï¼Œåœ¨åˆ†ç±»ç®—æ³•ä¸­çš„è¡¨ç°SVMè¯´æ˜¯æ’ç¬¬ä¸€ä¼°è®¡æ˜¯æ²¡æœ‰ä»€ä¹ˆå¼‚è®®çš„. 1. SVM é—´éš” Margin æ”¯æŒå‘é‡æœºï¼ˆSVMï¼‰çš„ç›®æ ‡æ˜¯ä»€ä¹ˆï¼Ÿ ä»€ä¹ˆæ˜¯åˆ†ç¦»è¶…å¹³é¢ï¼Œ Margin è¯¦æƒ…å¯å‚ : æœºå™¨å­¦ä¹ ç³»åˆ—(13)_SVMç¢ç¢å¿µpart1ï¼šé—´éš” è®¤è¯†ä¸€ä¸‹SVMä¸­å¾ˆé‡è¦çš„ä¸€ä¸ªæ¦‚å¿µï¼šMarginï¼Œä¹Ÿå°±æ˜¯é—´éš”ã€‚ 2. SVM å‘é‡ä¸ç©ºé—´è·ç¦» ä»å‘é‡åˆ°è·ç¦»è®¡ç®— (å‘é‡å®šä¹‰ã€è®¡ç®—æ–¹å‘å‘é‡ã€å‘é‡çš„å’Œä¸å·®ã€å‘é‡å†…ç§¯ã€å‘é‡æ­£äº¤æŠ•å½±) SVMçš„è¶…å¹³é¢ (1 è®¡ç®—ç‚¹åˆ°è¶…å¹³é¢è·ç¦»ã€2 è®¡ç®—è¶…å¹³é¢çš„é—´éš”) è¯¦æƒ…å¯å‚ : æœºå™¨å­¦ä¹ ç³»åˆ—(14)_SVMç¢ç¢å¿µpart2ï¼šSVMä¸­çš„å‘é‡ä¸ç©ºé—´è·ç¦» å›é¡¾äº†ä¸€ä¸‹å‘é‡ä¸­çš„ä¸€äº›æ¦‚å¿µï¼Œä¾ç”¨å‘é‡çš„çŸ¥è¯†ï¼Œæ€ä¹ˆå¸®åŠ©æˆ‘ä»¬å»è®¡ç®—è¶…å¹³é¢é—´éš”ï¼Œæœ‰å…´è¶£çš„åŒå­¦è¯·æ¥ç€çœ‹part3 $ w^{T}X = 0 $ï¼Œ w 3. SVM å¦‚ä½•æ‰¾åˆ°æœ€ä¼˜åˆ†ç¦»è¶…å¹³é¢ å¦‚ä½•æ‰¾åˆ°æœ€ä¼˜è¶…å¹³é¢ å¦‚ä½•è®¡ç®—ä¸¤è¶…å¹³é¢é—´çš„è·ç¦» SVMçš„æœ€ä¼˜åŒ–é—®é¢˜æ˜¯ä»€ä¹ˆ æ‰¾åˆ°ä¸¤ä¸ªå¹³è¡Œè¶…å¹³é¢ï¼Œå¯ä»¥åˆ’åˆ†æ•°æ®å¹¶ä¸”ä¸¤å¹³é¢ä¹‹é—´æ²¡æœ‰æ•°æ®ç‚¹ä¸¤ä¸ªè¶…å¹³é¢ä¹‹é—´çš„è·ç¦»æœ€å¤§åŒ– è¯¦æƒ…å¯å‚ : æœºå™¨å­¦ä¹ ç³»åˆ—(15)_SVMç¢ç¢å¿µpart3ï¼šå¦‚ä½•æ‰¾åˆ°æœ€ä¼˜åˆ†ç¦»è¶…å¹³é¢ 4. SVM æ— çº¦æŸæœ€å°åŒ–é—®é¢˜è¯¦æƒ…å¯å‚ : æœºå™¨å­¦ä¹ ç³»åˆ—(21)_SVMç¢ç¢å¿µpart4ï¼šæ— çº¦æŸæœ€å°åŒ–é—®é¢˜ 5. SVM å‡¸å‡½æ•°ä¸ä¼˜åŒ–è¯¦æƒ…å¯å‚ : æœºå™¨å­¦ä¹ ç³»åˆ—(22)_SVMç¢ç¢å¿µpart5ï¼šå‡¸å‡½æ•°ä¸ä¼˜åŒ– 6. SVM å¯¹å¶å’Œæ‹‰æ ¼æœ—æ—¥ä¹˜å­è¯¦æƒ…å¯å‚ : æœºå™¨å­¦ä¹ ç³»åˆ—(23)_SVMç¢ç¢å¿µpart6ï¼šå¯¹å¶å’Œæ‹‰æ ¼æœ—æ—¥ä¹˜å­ Reference article","categories":[{"name":"machine-learning","slug":"machine-learning","permalink":"http://iequa.com/categories/machine-learning/"}],"tags":[{"name":"machine-learning","slug":"machine-learning","permalink":"http://iequa.com/tags/machine-learning/"}]},{"title":"Data WareHouse Questions","slug":"dataware/interview-questions","date":"2018-06-09T23:11:21.000Z","updated":"2021-06-14T05:23:06.586Z","comments":true,"path":"2018/06/10/dataware/interview-questions/","link":"","permalink":"http://iequa.com/2018/06/10/dataware/interview-questions/","excerpt":"","text":"1. ä»€ä¹ˆå«æ•°æ®ä»“åº“ï¼Ÿ æ•°æ®ä»“åº“æ˜¯ä¸€ä¸ªé¢å‘ä¸»é¢˜çš„ï¼ˆSubject Orientedï¼‰ã€é›†æˆçš„ï¼ˆIntegrateï¼‰ã€ç›¸å¯¹ç¨³å®šçš„ï¼ˆNon-Volatileï¼‰ã€åæ˜ å†å²å˜åŒ–ï¼ˆTime Variantï¼‰çš„æ•°æ®é›†åˆï¼Œå®ƒç”¨äºæ”¯æŒä¼ä¸šæˆ–ç»„ç»‡çš„å†³ç­–åˆ†æå¤„ç†ã€‚ æ•°æ®ä»“åº“æ˜¯ä¸ºäº†ä¾¿äºå¤šç»´åˆ†æå’Œå¤šè§’åº¦å±•ç°è€Œå°†æ•°æ®æŒ‰ç‰¹å®šçš„æ¨¡å¼è¿›è¡Œå­˜å‚¨æ‰€å»ºç«‹èµ·æ¥çš„å…³ç³»å‹æ•°æ®åº“ï¼Œå®ƒçš„æ•°æ®åŸºäºOLTPæºç³»ç»Ÿã€‚ é¦–å…ˆï¼Œç”¨äºæ”¯æŒå†³ç­–ï¼Œé¢å‘åˆ†æå‹æ•°æ®å¤„ç†ï¼Œå®ƒä¸åŒäºä¼ä¸šç°æœ‰çš„æ“ä½œå‹æ•°æ®åº“ï¼› å…¶æ¬¡ï¼Œå¯¹å¤šä¸ªå¼‚æ„çš„æ•°æ®æºæœ‰æ•ˆé›†æˆï¼Œé›†æˆåæŒ‰ç…§ä¸»é¢˜è¿›è¡Œäº†é‡ç»„ï¼Œå¹¶åŒ…å«å†å²æ•°æ®ï¼Œè€Œä¸”å­˜æ”¾åœ¨æ•°æ®ä»“åº“ä¸­çš„æ•°æ®ä¸€èˆ¬ä¸å†ä¿®æ”¹ 1.1 ç»´åº¦çš„åŸºæœ¬æ¦‚å¿µä»£ç†é”®, è‡ªç„¶é”® 1.2 ç»´åº¦çš„åŸºæœ¬è®¾è®¡æ–¹æ³•æ•°æ®ä»“åº“çš„èƒ½åŠ›ç›´æ¥ä¸ç»´åº¦å±æ€§ çš„è´¨é‡å’Œæ·±åº¦æˆæ­£æ¯”ã€‚ æ·˜å®çš„å•†å“ç»´åº¦: é€‰æ‹©ç»´åº¦æˆ–æ–°å»ºç»´åº¦ã€‚DataWare å¿…é¡»ä¿è¯ç»´åº¦çš„å”¯ä¸€æ€§ã€‚ ç¬¬äºŒæ­¥:ç¡®å®šä¸»ç»´è¡¨ã€‚æ­¤å¤„çš„ä¸»ç»´è¡¨ä¸€èˆ¬æ˜¯ ODS è¡¨ï¼Œç›´æ¥ä¸ä¸šåŠ¡ ç³»ç»ŸåŒæ­¥ã€‚ ç¡®å®šç›¸å…³ç»´è¡¨ã€‚æ•°æ®ä»“åº“æ˜¯ä¸šåŠ¡æºç³»ç»Ÿçš„æ•°æ®æ•´åˆï¼Œä¸åŒ ç¡®å®šç»´åº¦å±æ€§ ä¸šåŠ¡ç³»ç»Ÿæˆ–è€…åŒ ä¸€ä¸šåŠ¡ç³»ç»Ÿä¸­çš„è¡¨ä¹‹é—´å­˜åœ¨ å…³è”æ€§ã€‚ ä»¥æ·˜å®å•†å“ç»´åº¦ä¸ºä¾‹ï¼Œæ ¹æ®å¯¹ä¸šåŠ¡é€»è¾‘çš„æ¢³ç†ï¼Œå¯ä»¥å¾—åˆ°å•†å“ä¸ç±»ç›®ã€ SPUã€ å–å®¶ã€åº—é“ºç­‰ç»´åº¦å­˜åœ¨å…³è”å…³ç³»ã€‚ 1.3 ç»´åº¦çš„å±‚æ¬¡ç»“æ„1.4 è§„èŒƒåŒ–å’Œåè§„èŒƒåŒ–1.5 ä¸€è‡´æ€§ç»´åº¦å’Œäº¤å‰æ¢æŸ¥æ•°æ®ä»“åº“æ€»çº¿æ¶æ„çš„é‡è¦åŸºçŸ³ä¹‹ä¸€å°±æ˜¯ä¸€è‡´æ€§ç»´åº¦ã€‚ åœ¨é’ˆå¯¹ä¸åŒæ•° æ®åŸŸè¿›è¡Œè¿­ä»£æ„å»ºæˆ–å¹¶è¡Œæ„å»ºæ—¶ï¼Œå­˜åœ¨å¾ˆå¤šéœ€æ±‚æ˜¯å¯¹äºä¸åŒæ•°æ®åŸŸçš„ä¸š åŠ¡è¿‡ç¨‹æˆ–è€…åŒ ä¸€æ•°æ®åŸŸçš„ä¸åŒä¸šåŠ¡è¿‡ç¨‹åˆå¹¶åœ¨ ä¸€èµ·è§‚å¯Ÿã€‚ æ—¥å¿—æ•°æ®åŸŸï¼Œç»Ÿè®¡äº†å•†å“ç»´åº¦çš„æœ€è¿‘ä¸€å¤©çš„ PV å’Œ UV; äº¤æ˜“æ•°æ®åŸŸï¼Œ ç»Ÿè®¡äº† å•†å“ç»´åº¦çš„æœ€è¿‘ä¸€å¤© çš„ä¸‹å• GMVã€‚ æ€»ç»“ç»´åº¦ä¸€è‡´æ€§çš„å‡ ç§ è¡¨ç°å½¢å¼: å…±äº«ç»´è¡¨ (å…¬å…±ç»´åº¦) ä¸€è‡´æ€§ä¸Šå· (1 dim æ˜¯å¦ä¸€dim å­é›†) äº¤å‰å±æ€§ ï¼ˆéƒ¨åˆ†ç›¸åŒç»´åº¦ï¼‰ 2. ç»´åº¦è®¾è®¡é«˜çº§ä¸»é¢˜2.1 ç»´åº¦æ•´åˆæˆ‘ä»¬å…ˆæ¥çœ‹æ•°æ®ä»“åº“çš„å®šä¹‰: æ•°æ®ä»“åº“æ˜¯ä¸€ä¸ªé¢å‘ä¸»é¢˜çš„ã€é›†æˆçš„ã€ éæ˜“å¤±çš„ä¸”éšæ—¶é—´å˜åŒ–çš„æ•°æ®é›†åˆï¼Œç”¨æ¥æ”¯æŒç®¡ç†äººå‘˜çš„å†³ç­–ã€‚ æ•°æ®ä»“åº“çš„é‡è¦æ•°æ®æ¥æºæ˜¯ å¤§é‡çš„ã€åˆ†æ•£çš„ é¢å‘åº”ç”¨çš„æ“ä½œå‹ç¯å¢ƒã€‚ åº”ç”¨ -&gt; ä¸»é¢˜ ï¼ˆæ•°æ®é›†æˆï¼‰ æ‰€ä»¥æ•°æ®ç”±é¢å‘åº”ç”¨çš„æ“ä½œå‹ç¯å¢ƒè¿›äººæ•°æ®ä»“åº“åï¼Œéœ€è¦è¿›è¡Œæ•°æ®é›†æˆã€‚ å°†é¢å‘åº”ç”¨çš„æ•°æ®è½¬æ¢ä¸ºé¢å‘ä¸»é¢˜çš„æ•°æ®ä»“åº“æ•°æ®ï¼Œæœ¬èº«å°±æ˜¯ä¸€ç§é›†æˆã€‚ Reference å¤§æ•°æ® | å¤§ç¥æ•™å­¦ï¼Œ10åˆ†é’Ÿå­¦ä¼šæ•°æ®ä»“åº“å»ºè®¾ï¼ æ•°æ®ä»“åº“èµ„æ–™","categories":[{"name":"data-warehouse","slug":"data-warehouse","permalink":"http://iequa.com/categories/data-warehouse/"}],"tags":[{"name":"DWH","slug":"DWH","permalink":"http://iequa.com/tags/DWH/"}]},{"title":"DataWare ç»´åº¦è®¾è®¡","slug":"dataware/dataware-dim-design","date":"2018-06-09T09:11:21.000Z","updated":"2021-06-14T05:20:39.761Z","comments":true,"path":"2018/06/09/dataware/dataware-dim-design/","link":"","permalink":"http://iequa.com/2018/06/09/dataware/dataware-dim-design/","excerpt":"","text":"1. ç»´åº¦è®¾è®¡åŸºç¡€ç»´åº¦å»ºæ¨¡ç”¨åˆ°çš„11å¤§ä¸“ä¸šæœ¯è¯­ï¼š æ•°æ®åŸŸã€ä¸šåŠ¡è¿‡ç¨‹ã€æ—¶é—´å‘¨æœŸã€ä¿®é¥°ç±»å‹ã€ä¿®é¥°è¯ã€åº¦é‡/åŸå­æŒ‡æ ‡ã€ç»´åº¦ã€ç»´åº¦å±æ€§ã€ äº‹å®ã€æ´¾ç”ŸæŒ‡æ ‡ã€é’»å–ã€‚ 1.1 ç»´åº¦çš„åŸºæœ¬æ¦‚å¿µä»£ç†é”®, è‡ªç„¶é”® 1.2 ç»´åº¦çš„åŸºæœ¬è®¾è®¡æ–¹æ³•æ•°æ®ä»“åº“çš„èƒ½åŠ›ç›´æ¥ä¸ç»´åº¦å±æ€§ çš„è´¨é‡å’Œæ·±åº¦æˆæ­£æ¯”ã€‚ æ·˜å®çš„å•†å“ç»´åº¦: é€‰æ‹©ç»´åº¦æˆ–æ–°å»ºç»´åº¦ã€‚DataWare å¿…é¡»ä¿è¯ç»´åº¦çš„å”¯ä¸€æ€§ã€‚ ç¬¬äºŒæ­¥:ç¡®å®šä¸»ç»´è¡¨ã€‚æ­¤å¤„çš„ä¸»ç»´è¡¨ä¸€èˆ¬æ˜¯ ODS è¡¨ï¼Œç›´æ¥ä¸ä¸šåŠ¡ ç³»ç»ŸåŒæ­¥ã€‚ ç¡®å®šç›¸å…³ç»´è¡¨ã€‚æ•°æ®ä»“åº“æ˜¯ä¸šåŠ¡æºç³»ç»Ÿçš„æ•°æ®æ•´åˆï¼Œä¸åŒ ç¡®å®šç»´åº¦å±æ€§ ä¸šåŠ¡ç³»ç»Ÿæˆ–è€…åŒ ä¸€ä¸šåŠ¡ç³»ç»Ÿä¸­çš„è¡¨ä¹‹é—´å­˜åœ¨ å…³è”æ€§ã€‚ ä»¥æ·˜å®å•†å“ç»´åº¦ä¸ºä¾‹ï¼Œæ ¹æ®å¯¹ä¸šåŠ¡é€»è¾‘çš„æ¢³ç†ï¼Œå¯ä»¥å¾—åˆ°å•†å“ä¸ç±»ç›®ã€ SPUã€ å–å®¶ã€åº—é“ºç­‰ç»´åº¦å­˜åœ¨å…³è”å…³ç³»ã€‚ 1.3 ç»´åº¦çš„å±‚æ¬¡ç»“æ„1.4 è§„èŒƒåŒ–å’Œåè§„èŒƒåŒ–1.5 ä¸€è‡´æ€§ç»´åº¦å’Œäº¤å‰æ¢æŸ¥æ•°æ®ä»“åº“æ€»çº¿æ¶æ„çš„é‡è¦åŸºçŸ³ä¹‹ä¸€å°±æ˜¯ä¸€è‡´æ€§ç»´åº¦ã€‚ åœ¨é’ˆå¯¹ä¸åŒæ•° æ®åŸŸè¿›è¡Œè¿­ä»£æ„å»ºæˆ–å¹¶è¡Œæ„å»ºæ—¶ï¼Œå­˜åœ¨å¾ˆå¤šéœ€æ±‚æ˜¯å¯¹äºä¸åŒæ•°æ®åŸŸçš„ä¸š åŠ¡è¿‡ç¨‹æˆ–è€…åŒ ä¸€æ•°æ®åŸŸçš„ä¸åŒä¸šåŠ¡è¿‡ç¨‹åˆå¹¶åœ¨ ä¸€èµ·è§‚å¯Ÿã€‚ æ—¥å¿—æ•°æ®åŸŸï¼Œç»Ÿè®¡äº†å•†å“ç»´åº¦çš„æœ€è¿‘ä¸€å¤©çš„ PV å’Œ UV; äº¤æ˜“æ•°æ®åŸŸï¼Œ ç»Ÿè®¡äº† å•†å“ç»´åº¦çš„æœ€è¿‘ä¸€å¤© çš„ä¸‹å• GMVã€‚ æ€»ç»“ç»´åº¦ä¸€è‡´æ€§çš„å‡ ç§ è¡¨ç°å½¢å¼: å…±äº«ç»´è¡¨ (å…¬å…±ç»´åº¦) ä¸€è‡´æ€§ä¸Šå· (1 dim æ˜¯å¦ä¸€dim å­é›†) äº¤å‰å±æ€§ ï¼ˆéƒ¨åˆ†ç›¸åŒç»´åº¦ï¼‰ 2. ç»´åº¦è®¾è®¡é«˜çº§ä¸»é¢˜2.1 ç»´åº¦æ•´åˆæˆ‘ä»¬å…ˆæ¥çœ‹æ•°æ®ä»“åº“çš„å®šä¹‰: æ•°æ®ä»“åº“æ˜¯ä¸€ä¸ªé¢å‘ä¸»é¢˜çš„ã€é›†æˆçš„ã€ éæ˜“å¤±çš„ä¸”éšæ—¶é—´å˜åŒ–çš„æ•°æ®é›†åˆï¼Œç”¨æ¥æ”¯æŒç®¡ç†äººå‘˜çš„å†³ç­–ã€‚ æ•°æ®ä»“åº“çš„é‡è¦æ•°æ®æ¥æºæ˜¯ å¤§é‡çš„ã€åˆ†æ•£çš„ é¢å‘åº”ç”¨çš„æ“ä½œå‹ç¯å¢ƒã€‚ åº”ç”¨ -&gt; ä¸»é¢˜ ï¼ˆæ•°æ®é›†æˆï¼‰ æ‰€ä»¥æ•°æ®ç”±é¢å‘åº”ç”¨çš„æ“ä½œå‹ç¯å¢ƒè¿›äººæ•°æ®ä»“åº“åï¼Œéœ€è¦è¿›è¡Œæ•°æ®é›†æˆã€‚ å°†é¢å‘åº”ç”¨çš„æ•°æ®è½¬æ¢ä¸ºé¢å‘ä¸»é¢˜çš„æ•°æ®ä»“åº“æ•°æ®ï¼Œæœ¬èº«å°±æ˜¯ä¸€ç§é›†æˆã€‚ Reference å¤§æ•°æ® | å¤§ç¥æ•™å­¦ï¼Œ10åˆ†é’Ÿå­¦ä¼šæ•°æ®ä»“åº“å»ºè®¾ï¼ æ•°æ®ä»“åº“èµ„æ–™","categories":[{"name":"data-warehouse","slug":"data-warehouse","permalink":"http://iequa.com/categories/data-warehouse/"}],"tags":[{"name":"DataWare","slug":"DataWare","permalink":"http://iequa.com/tags/DataWare/"}]},{"title":"é˜¿æ»´è‹±æ–‡ï½œæœƒè®“ä½ å¢œå…¥æ„›æ²³çš„é›»å½±! æµªæ¼«æ„›æƒ…é›»å½±å°è©åˆ†äº«!","slug":"English/english-RD-moives-1","date":"2018-05-06T02:59:21.000Z","updated":"2019-10-20T04:30:35.031Z","comments":true,"path":"2018/05/06/English/english-RD-moives-1/","link":"","permalink":"http://iequa.com/2018/05/06/English/english-RD-moives-1/","excerpt":"","text":"1. The Lucky One classical lines 2. Safe Haven classical lines 3. The Choice classical lines 4. The Notebook leading actor and actress classical lines the wedding Reference Nicholas Sparks","categories":[{"name":"English","slug":"English","permalink":"http://iequa.com/categories/English/"}],"tags":[{"name":"RD","slug":"RD","permalink":"http://iequa.com/tags/RD/"}]},{"title":"äº’è”ç½‘é‡‘èé£æ§ä¸­çš„æ•°æ®ç§‘å­¦ (part3) ï¼š Lending Club çš„æ•°æ®è¯•éªŒ","slug":"datascience/internet-finance-3","date":"2018-04-23T05:28:21.000Z","updated":"2021-06-14T05:16:52.510Z","comments":true,"path":"2018/04/23/datascience/internet-finance-3/","link":"","permalink":"http://iequa.com/2018/04/23/datascience/internet-finance-3/","excerpt":"ç”¨æˆ·å…¨æµç¨‹æ¬ºè¯ˆâ»›é™©è¯„åˆ†ä½“ç³»","text":"ç”¨æˆ·å…¨æµç¨‹æ¬ºè¯ˆâ»›é™©è¯„åˆ†ä½“ç³» åæ¬ºè¯ˆæ˜¯ä¸€ç§æœºå™¨å­¦ä¹ è¿‡ç¨‹ å¯¹äºåšäº’è”ç½‘é‡‘èä¸€èˆ¬æƒ…å†µæ˜¯ æ­£è´Ÿæ ·æœ¬ æ˜¯æåº¦ä¸å¹³è¡¡çš„(æœ€é«˜å¯ä»¥è¾¾åˆ° 100 : 1), è¿™æ ·çš„æƒ…å†µå¯¹äº SVM è¿™ç§åˆ†ç±»å™¨æ˜¯ä¸åˆé€‚çš„ï¼Œæ‰€ä»¥åœ¨åšé‡‘èçš„è¯„åˆ†å¡æ¨¡å‹ æˆ– æ¬ºè¯ˆæ¨¡å‹ ä¹Ÿå¥½ï¼Œè¿™æ ·å¯¹ç‰¹å¾çš„å¤„ç† å’Œ æ ·æœ¬çš„éå¹³è¡¡å¤„ç†æ˜¯æ¯”è¾ƒé«˜çš„. å¥½åç”¨æˆ·çš„å®šä¹‰ï¼Œä¸€èˆ¬æ˜¯æ ¹æ®ç”¨æˆ·çš„è´·åè¡¨ç°ï¼Œæ¥å®šä¹‰å¥½åç”¨æˆ·çš„. ä¸¾ä¸ªæ —å­ğŸŒ° : ç”¨æˆ·å€Ÿæ¬¾ 5W å…ƒï¼Œå¯èƒ½æ˜¯åˆ†æœŸè¿˜æ¬¾ 12ä¸ªæœˆï¼Œè¿™æ ·æ¯ä¸ªæœˆéƒ½ä¼šè¿˜ä¸€ç¬”å›ºå®šçš„é¢åº¦. ä¿¡ç”¨é£é™© : åœ¨æŒºé•¿çš„æ—¶é—´å¯ä»¥æŒ‰æ—¶è¿˜æ¬¾. æ¬ºè¯ˆé£é™© : ç”¨æˆ·å¯èƒ½ ç¬¬ 1ã€2 æœŸ æ˜¯è¿˜çš„ï¼Œä¹‹åæ˜¯ä¸è¿˜çš„. (å› ä¸ºä¸­ä»‹ä¹Ÿè¶Šæ¥è¶Šèªæ˜ï¼Œç»™ä»–è‡ªå·±ç•™å‡ºæ—¶é—´ï¼Œèº²é¿å‚¬æ”¶çš„æ‰‹æ®µï¼Œä¹Ÿèº²é¿è¿½è¸ªç­‰ç­‰) è´·å‰å®¡æ ¸ ï¼ˆè§¦ç¢°åˆ°æ‹’è´·è§„åˆ™ï¼‰ é€ å‡è¡Œä¸º ï¼ˆä¿¡æ¯èµ„æ–™é€ å‡ï¼‰ è°ƒæŸ¥å‘˜ è°ƒæŸ¥å‡ºæ¥æ˜¯ ä¸­ä»‹ æˆ–è€… æœ‰æ¬ºè¯ˆé£å‘çš„ï¼Œè¿›å…¥é»‘åå•çš„. â€¦ æ‰€ä»¥æˆ‘ä»¬åœ¨å®šä¹‰æ¨¡å‹è´Ÿæ ·æœ¬çš„è¯ï¼Œæˆ‘ä»¬å¯èƒ½å®šä¹‰ä¸º m1+ ä¿¡ç”¨é£é™©ã€m3+ (90å¤©ä»¥ä¸Šä¸è¿˜æ¬¾çš„è¯)ï¼Œæˆ‘ä»¬å¯ä»¥å®šä¹‰ä¸ºæ¬ºè¯ˆé£é™© åç”¨æˆ· ï¼š æ¬ºè¯ˆé£é™©ç”¨æˆ·å¥½ç”¨æˆ· ï¼š ä¸€å¤©éƒ½ä¸é€¾æœŸè¿˜æ¬¾ç°ç”¨æˆ· ï¼š m1+ æœªè¿˜æ¬¾ï¼Œä½†æ˜¯90å¤©ä¹‹å†…å¯ä»¥è¿˜æ¬¾çš„ (ä¸æ”¾åœ¨è®­ç»ƒä¸­ï¼Œå¦åˆ™ä¼šç»™æ¨¡å‹å¸¦æ¥å¾ˆå¤šé¢å¤–çš„ä¿¡æ¯ï¼Œå½±å“æ•ˆæœ) ç°ç”¨æˆ·ä¸æ”¾åœ¨æ¨¡å‹ä¸­ï¼Œè¿™æ ·è®­ç»ƒå‡ºçš„æ¨¡å‹å¯¹å¥½åç”¨æˆ·çš„åŒºåˆ†ç¨‹åº¦ä¹Ÿè¶Šé«˜. é‡‘èæ¨¡å‹ å’Œ CTRé¢„ä¼° ç›¸æ¯”æ˜¯ æœ‰ä¸€ä¸ªå‘¨æœŸæ€§è´¨çš„ å¹¿å‘Šç‚¹å‡»çš„è¯ï¼Œç”¨æˆ·ç‚¹å‡»ï¼Œç«‹é©¬æœ‰ä¸€ä¸ªæ ·æœ¬å‡ºç° åšé•¿æœŸç°é‡‘è´·ï¼Œé€‰æ‹©æ ·æœ¬æ˜¯é€‰æ‹©åŠå¹´ä¹‹å‰çš„ç”¨æˆ·ï¼Œä½œä¸ºæ ·æœ¬ æ­£è´Ÿæ ·æœ¬çœŸå®åœºæ™¯æ­£è´Ÿæ ·æœ¬æ¯”ä¾‹ (10~30) ï¼š1 ï¼ˆæˆç†Ÿå¹³å°çš„é£é™©æ˜¯è¶Šæ¥è¶Šå°çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬æ‹¿åˆ°çš„ æ­£è´Ÿæ ·æœ¬æ¯”ä¾‹æ˜¯é€æ­¥å¢åŠ çš„ï¼‰. æ•°æ®çš„ä¸å¹³è¡¡å¤„ç† ï¼š é™é‡‡æ ·ã€è¿‡é‡‡æ ·ã€SMOTE é™é‡‡æ · ï¼š æ­£è´Ÿæ ·æœ¬æˆ 3:1ï¼Œ 5:1 æ¥åšä¸€ä¸ªæ¨¡å‹, åæ ·æœ¬æ˜¯å…¨éƒ¨å–çš„, (ä¸€èˆ¬è¿™ç§æƒ…å†µ åšè¯„åˆ†å¡çš„æ—¶å€™æ˜¯éœ€è¦åšçš„) è¿‡é‡‡æ · ï¼š å®é™…ç”¨çš„ä¸å¤šï¼Œå¦‚æœè´Ÿæ ·æœ¬å®åœ¨æ˜¯è¿‡å°‘ éƒ½ &lt;100 ä¸ªï¼Œ é‚£ä¹ˆå¯ä»¥è€ƒè™‘ å‡ä½æˆ‘ä»¬çš„è§‚å¯Ÿå‘¨æœŸï¼Œ æˆ–è€… æ¬ºè¯ˆå®šä¹‰çš„å¹¶ä¸æ˜¯ä¸€ä¸ªå¾ˆä¸¥æ ¼ æ¥æ”¾è¿›æ¥å¤šä¸€äº›çš„ è´Ÿæ ·æœ¬è¿‡æ¥æ¥åšè®­ç»ƒï¼Œæˆ–è€…åœ¨æ‹’è´·é‡Œé¢æ‰¾ä¸€äº›äººè¿‡æ¥. SMOTE ï¼š åœ¨åˆ†å¸ƒä¸Šæ¨¡æ‹Ÿä¸€äº›æ•°æ®ï¼Œæ¨¡æ‹Ÿå®Œçš„æ•°æ®å¯åšè®­ç»ƒï¼Œæ¯”è¾ƒç»å…¸æ‹¿çœŸå®çš„æ•°æ®åšè®­ç»ƒæ˜¯æ›´è´´è¿‘çœŸå®çš„æƒ…å†µ. åšæ¨¡å‹ å¦‚ GBRTã€RF ç­‰ï¼Œä»–ä»¬å¯¹ä¸å¹³è¡¡çš„æ•°æ®æ˜¯æœ‰å®¹å¿çš„ï¼Œè¿™ç§ç›´æ¥ç”¨çœŸå®æ•°æ®è¿›è¡Œè®­ç»ƒï¼Œä¹Ÿèƒ½å¾—åˆ°å¾ˆå¥½çš„æ•ˆæœ. æ¨¡å‹é€‰å‹å¯¹äºåšè¯„åˆ†å¡çš„æ¨¡å‹ æˆ–è€… LR çš„è¯ï¼Œæ ·æœ¬çš„å¹³è¡¡è¦åœ¨ 10:1 èŒƒå›´å†…ï¼Œ LR å¯¹å˜é‡ç›¸å…³æ€§çš„ç­›é€‰ å’Œ æ•°æ®å¹³è¡¡ æœ‰è¦æ±‚ åšæ¨¡å‹ï¼Œè‡³å°‘è¦ç”¨ RF æ¥åšæ¨¡å‹ï¼Œ æˆ–è€… GBDTã€GBRTï¼Œè¿™ç§ Boosting çš„æ¨¡å‹ï¼Œå¯¹äºæ ·æœ¬çš„ä¸å¹³è¡¡å®¹å¿åº¦æ›´é«˜ä¸€äº›ï¼Œä»–ä»¬å¯¹äºå­¦ä¹  æ›´å°è€Œç»†å¾® çš„ç‰¹å¾å’Œå˜é‡ å¯ä»¥å­¦ä¹ çš„æ›´æ·±ä¸€äº›. Lending ClubLending Club åˆ›ç«‹äº 2016å¹´ï¼Œ ä¸»è¦åšä¸€ä¸ªæä¾› P2P è´·æ¬¾çš„å¹³å°ä¸­ä»‹æœåŠ¡ï¼Œ2016å¹´åº•åœ¨ çº½äº¤æ‰€ä¸Šå¸‚ï¼Œåæ¥çˆ†å‡ºæ¥å¾ˆå¤šä¸‘é—»ï¼Œåˆ›å§‹äººç¦»èŒï¼Œè‚¡ä»·ä¸‹è·Œ. ä½†æ˜¯ä¸ç®¡æ€ä¹ˆæ ·ï¼Œå®ƒçš„æ•°æ®åœ¨æˆ‘ä»¬åšåæ¬ºè¯ˆç­‰æ˜¯éå¸¸æœ‰é‡è¦çš„. Lending Club 2016 çš„å€Ÿè´·æ•°æ®ï¼ŒQ3ï¼ŒQ4 å¯ä»¥ä¸€èµ·åšä¸€ä¸‹ï¼ŒåŠå¹´çš„æ•°æ®åšè®­ç»ƒæ˜¯æ›´å¥½çš„. 1. DataLending Club 2016å¹´Q3æ•°æ®ï¼šhttps://www.lendingclub.com/info/download-data.action å‚è€ƒï¼šhttp://kldavenport.com/lending-club-data-analysis-revisted-with-python/ çœ‹ä¸‹æ•°æ®ï¼Œå…¶å®æˆ‘ä¹Ÿä¸èƒ½å®Œå…¨äº†è§£è¿™äº›æ‰€æœ‰å­—æ®µçš„å«ä¹‰ int_rate åˆ©ç‡ term å¾…å¤šå°‘æœŸ grade ç­‰çº§ Cã€Bã€Dï¼Œ7ä¸ªç­‰çº§å§ sub_grade ä¼šåˆ†ä¸ºæ›´ç»†çš„ç­‰çº§. åé¢è¿™äº›æ˜¯ä» FICO è·å–çš„æ•°æ®å§â€¦ æˆ‘ä»¬çš„ç›®çš„æ˜¯åˆ¤æ–­ï¼Œæ¥äº†ä¸€ä¸ªç”¨æˆ·ï¼Œä¹‹åè¾“å…¥è¯¥ç”¨æˆ·çš„è¿™äº›ç‰¹å¾ï¼Œæˆ‘ä»¬åˆ¤æ–­ä»–æ˜¯ä¸æ˜¯ä¸€ä¸ªæ¬ºè¯ˆç”¨æˆ· å¦‚æœç”¨æˆ·å¡«å†™å‡èµ„æ–™ ç”¨æˆ·è´·æ¬¾ä¹‹åçš„è¡¨ç°ï¼Œå¦‚æœå¡«çš„çœŸå‡æˆ‘ä»¬ä¸äº†è§£ï¼Œå¡«å†™çš„æ˜¯å‡èµ„æ–™ï¼Œä½†æ˜¯ä¹‹åè¿˜æ¬¾è¡¨ç°å¥½é‚£ä¹ˆå®ƒè¿˜æ˜¯ä¸€ä¸ªå¥½ç”¨æˆ·. æ•°æ®ä¸Š æˆ‘åªå–äº†2016å¹´Q3æ•°æ®ï¼Œ9W+ çš„æ•°æ®ï¼Œåˆ—æ•° 122 åˆ—ã€‚æ•°æ®æœ‰ 99124è¡Œï¼Œ å»æ‰è¡¨å¤´ï¼Œæœ‰ 99123 è¡Œ 2. Keep what we need æˆ‘ä»¬åˆæ­¥åšç‰¹å¾ç­›é€‰â€¦, æˆ‘ä»¬åœ¨çœ‹çš„æ—¶å€™ï¼Œå¯ä»¥åˆ†ç‰‡åˆ†ç‰‡çš„çœ‹è¿™ 122 ä¸ªåˆ—â€¦ 2.1 ç‰¹å¾åˆ†æ part1 id å’Œ member_id ä¸ä½œä¸ºç‰¹å¾ï¼Œå¯ä»¥ç›´æ¥å»æ‰, int_rate å¸¦ % çš„å¯ä»¥ç›´æ¥å»æ‰ %ï¼Œ å˜ä¸º float çš„ Loan Amount Requested Verus the Funded Amount 2.2 ç‰¹å¾åˆ†æ part2df.ix[:5,8:15]print(df.emp_title.value_counts().head())print(df.emp_title.value_counts().tail())df.emp_title.unique().shape # 37421 emp_titleï¼Œ å¤ªå¤šäº†ï¼Œå¯ä¿¡åº¦ä¸é«˜ï¼Œæˆ‘ä»¬ä¹Ÿæ— æ³•åš emp_title éæ•°å€¼å‹å˜é‡çš„ one-hot enconding df.drop([&#x27;emp_title&#x27;],1, inplace=True) employment title LC code 3. æ€»ç»“åˆ ä¸åˆ é™¤å˜é‡ï¼Œéœ€è¦çœ‹æ¨¡å‹ï¼ŒLR éœ€è¦åˆ é™¤ï¼ŒGBRT ä¸ç”¨åˆ é™¤ä¹Ÿå¯ä»¥. LR åšè¯„åˆ†å¡æ¨¡å‹ï¼Œå˜é‡ ä¸€å®šæ˜¯å¼ºå˜é‡ï¼Œ20ä¸ªå·¦å³ï¼Œä¸ä¼šå‡ ç™¾ä¸ªï¼Œæœ‰ä¸ªå˜é‡å¯ä»¥è®­ç»ƒå¤„ç³»æ•° å‡ºæ¥ 0 ~ 1 æ¦‚ç‡ï¼Œæ‹‰ä¸€ä¸‹æ©¡çš®ç­‹ï¼Œ åˆ†æ•°æ˜ å°„ï¼Œæ‹‰åˆ° 300 ~ 900 åˆ†ï¼Œå¯ä»¥åšä¸€ä¸ªè¯„åˆ†å¡ï¼Œ600åˆ† å¯èƒ½æ˜¯å¥½ç”¨æˆ·:åç”¨æˆ·ï¼Œå¯èƒ½æ˜¯ 50:1 è¯„åˆ†å¡çš„é˜¶æ¢¯å¯èƒ½æ˜¯å¢åŠ ã€‚ æ¨¡å‹ä¸åŒ 0 ~ 1 çš„æ¦‚ç‡å¯èƒ½æ˜¯ä¸åŒçš„ï¼Œé‚£ä¹ˆæˆ‘å¢åŠ 50åˆ†ï¼Œé£é™©æ°´å¹³ä¼šé™ä½ä¸€åŠ 550 25:1 è¯„åˆ†å¡åˆ†çš„æ˜ å°„å’Œæ¨¡å‹æ˜¯æ²¡æœ‰å…³ç³»çš„ï¼Œæ˜¯æ ·æœ¬é‡Œäººç¾¤çš„å¥½åæ˜¯æœ‰å…³ç³»çš„ï¼Œæ‰€ä»¥æ¨¡å‹çš„å‚æ•°åšæ˜ å°„ï¼Œæ˜¯ä¸éœ€è¦é‡æ–°è®­ç»ƒçš„ã€‚ lending club è¦æ±‚ FICO æ˜¯ä¸ªç‰¹å®šçš„è¯„åˆ†æ–¹æ³•ï¼Œæ˜¯ä¸€ä¸ªå›ºå®šçš„è¯„åˆ†æ–¹æ³•ã€‚ æ¯”å¦‚ èŠéº»ä¿¡ç”¨éƒ½æ˜¯ç”¨è‡ªå·±çš„æ¨¡å‹ï¼Œè‡ªå·±ç®—å‡ºæ¥çš„ å¦‚æœäººç¾¤å˜äº† æ¨¡å‹çš„ç¨³å®šæ€§éå¸¸é‡è¦ï¼Œå½“å‰è¦è¯„ä¼°çš„äººç¾¤å·²ç»å’Œå»å¹´ä¸‹åŠå¹´çš„ç”¨æˆ·å·²ç»ä¸ä¸€æ ·çš„ï¼Œæ‰€ä»¥è®­ç»ƒçš„æ—¶å€™è¦å°½å¯èƒ½æå‡æ¨¡å‹çš„ç¨³å®šæ€§ï¼Œå¦‚æœè®­ç»ƒæ—¶æ¨¡å‹ç¨³å®šæ€§éå¸¸å·®ï¼Œé‚£ä¹ˆä¸€ä¸Šçº¿å°±å´©æºƒäº†ã€‚ å¦‚ä½•æé«˜æ¨¡å‹ç¨³å®šæ€§ï¼Œ2ç§æ–¹æ³• ç‰¹å¾ç­›é€‰çš„æ—¶å€™ï¼Œæˆ‘ä¼šå»æŠŠç‰¹å¾ä»æ ·æœ¬çš„æ—¶é—´å¼€å§‹ï¼Œ2016.06 å¼€å§‹æ¯ä¸ªæœˆæˆ‘ä¸€ç›´åœ¨çœ‹å®ƒçš„å‡å€¼å’Œæ–¹å·®çš„å˜åŒ–æ˜¯å¦åœ¨å®¹å¿çš„èŒƒå›´å†…ï¼Œæ¯”å¦‚æˆ‘å»å¹´è¿™ä¸ªæœˆè¿™ä¸ªç‰¹å¾æ˜¯30ï¼Œå½“å‰ 2017.06 è¿™ä¸ªç‰¹å¾å˜ä¸ºäº† 100ï¼Œé‚£ä¹ˆè¿™ä¸ªç‰¹å¾å˜åŒ–å¤ªå¤§ï¼Œæ˜¯ä¸èƒ½ç”¨çš„ï¼Œè¶…è¿‡50%ï¼Œ å¤ªä¸ç¨³å®šäº†ï¼Œå…¶å®è¿™ä¸ªå˜é‡ï¼Œæˆ–è€…åšè¯„åˆ†å¡ï¼Œåæ¬ºè¯ˆç­‰æ˜¯ä¸åˆé€‚çš„ï¼Œç›´æ¥æ‰”æ‰ã€‚ å°½é‡åšæ¨¡å‹èåˆï¼Œå•æ¨¡å‹çš„æ¨¡å‹ç¨³å®šæ€§æ˜¯ä¸å¥½çš„ï¼Œéšç€æœˆä»½çš„å˜åŒ–ï¼Œä½ çš„é¢„æµ‹æ˜¯æœ‰å˜åŒ–çš„ï¼Œæ³¢åŠ¨çš„èŒƒå›´æ˜¯æœ‰ç‚¹ä½ï¼Œensemble é›†æˆå­¦ä¹ ï¼Œ ä¸‰ç§æ–¹æ³• (baggingã€boostingï¼ŒStackingï¼‰ 2.1 Bagging æ¯”å¦‚ RFï¼Œæ¯ä¸ªæ¨¡å‹å–ä¸€æ ·çš„æƒé‡ï¼Œè¿›è¡Œè¯„ä¼°2.2 Boosting æ ¹æ®æ¨¡å‹è®­ç»ƒå‡ºä¸åŒæƒé‡ï¼Œç»™äºˆä¸åŒçš„æƒé‡2.3 Stacking æˆ‘åœ¨ç”¨ä¸€ä¸ªåˆ†ç±»å™¨ï¼Œå»å¤„ç†æˆ‘è¦é›†æˆçš„è¿™3ï¼Œ4ç§æ¨¡å‹ï¼Œè®­ç»ƒå‡ºä¸€ä¸ªå‚æ•° è¿™ä¸‰ç§æ–¹æ³•ï¼Œéƒ½èƒ½æé«˜æ¨¡å‹çš„ç¨³å®šæ€§ è®©ä½ åœ¨çº¿ä¸Šè¿è¡Œ 3~6 ä¸ªæœˆï¼Œä¿¡è´·äº§å“æ¯”è¾ƒé•¿çš„è¯ï¼Œ2ä¸ªæœˆæ›´æ–°ä¸€æ¬¡æ¯”è¾ƒå¥½ï¼Œè´·æ¬¾å‘¨æœŸçŸ­çš„è¯ï¼Œå‘¨æ›´æ–°éƒ½å¯ä»¥ æœ‰åš KS æ¯”è¾ƒé«˜çš„è¯ï¼Œä¼šé€å¤§å®¶å°ç¤¼å“ï¼Œ æˆ‘ä»¬çº¿ä¸Šæœ‰ç”¨ spark streaming ä¹Ÿæœ‰å¤„ç†å®æ—¶ç‰¹å¾ï¼Œä½†æ˜¯ç›®å‰ä½“é‡ï¼Œä¸€èˆ¬å•æœºå’Œç¦»çº¿å¤„ç†å°±å¤Ÿäº†ã€‚ 9W ä¸ªç”¨æˆ·ï¼Œ100å¤šä¸ªå˜é‡ï¼Œé‚£æ ¹æœ¬ä¸éœ€è¦ç”¨åˆ†å¸ƒå¼æ¥è®¡ç®—äº†ã€‚ åŠå¹´çš„æ ·æœ¬æ•°æ®ï¼ŒæŠŠæ•°æ®å–å‡ºæ¥ä¹‹åï¼Œä½ è¦å®šä¹‰ä½ çš„å¥½åæ ·æœ¬,ä¼šæŠŠä¸€äº›ç°è‰²åœ°æ®µçš„ç”¨æˆ·ç»™ä»–æ‘˜é™¤æ‰ï¼Œåªç•™ä¸‹æœ€å¥½æˆ–è€…æœ€åçš„ç”¨æˆ·ï¼Œè¿™äº›ç”¨æˆ·æç‰¹å¾ä¹‹åï¼Œåœ¨åšè®­ç»ƒï¼Œæ ·æœ¬å†…çš„éªŒè¯å’Œè·¨æ—¶é—´çš„éªŒè¯ ï¼Œå°±æ˜¯è¯´æˆ‘çš„æ—¶é—´æ®µæ˜¯å®Œå…¨ä¸ä¸€æ ·çš„ï¼Œé‚£ä¹ˆèƒ½å¤ŸéªŒè¯æ¨¡å‹çš„ç¨³å®šæ€§ï¼Œé‚£ä¹ˆæœ€å¥½å°±è¦æ‹¿ 2017å¹´ï¼Œ1å’Œ2æœˆçš„æ•°æ®ï¼Œåœ¨åšä¸€ä¸ªè·¨æ—¶é—´çš„éªŒè¯ï¼Œè·¨æ—¶é—´çš„éªŒè¯æ‰æ˜¯ä½ çœŸæ­£ä¸Šçº¿ä¹‹åçš„æ•ˆæœï¼Œå› ä¸ºä½ åœ¨æ—¶é—´çª—å£å†…è®­ç»ƒæˆ–è€…testçš„è¯ï¼Œå®ƒçš„ ks å¯èƒ½ 30 å¤šï¼Œå¦‚æœè·¨æ—¶é—´éªŒè¯çš„è¯ï¼Œä½ çš„äººç¾¤å¯èƒ½ä¼šåç§»ï¼Œé‚£ä¹ˆkså¯èƒ½ä¼šä¸‹é™ï¼Œkså°±å˜ä¸º20ï¼Œå¦‚æœå·®åˆ«æ§åˆ¶åœ¨ 15%ï¼Œå·®åˆ«å¤§ç¨³å®šæ€§å°±å¾ˆä¸å¥½ï¼Œæ˜¯ä¸èƒ½ä¸Šçº¿çš„ã€‚ æ¨¡å‹çš„è¯ï¼Œä½ ç°åœ¨å¼€å§‹åšæ¨¡å‹ï¼Œä½ ä¸€å®šå–çš„æ˜¯ å»å¹´ ä¸‹åŠå¹´çš„æ˜¯æ•°æ®ï¼ŒåšéªŒè¯çš„è¯æ˜¯æ‹¿å»å¹´1æœˆä»½çš„æ•°æ®ï¼Œä¸€ä¸ªæœˆçš„æ•°æ®è¿˜æœ‰5ï¼Œ6ï¼Œ7ä¸ªè¿˜æ¬¾è¡¨ç°ï¼ŒåŸºæœ¬ä¸Šç­‰ä½ åšå®Œæ¨¡å‹ï¼Œä½ åšè·¨æ—¶é—´éªŒè¯çš„è¯ï¼Œåˆšåˆšå¥½ï¼Œä½ èŠ±2ä¸ªç¤¼æ‹œåšä¸€ä¸ªæ¨¡å‹ï¼Œä¸Šçº¿çš„æ—¶å€™ï¼Œä½ å°±ä¸éœ€è¦é‡æ–°è®­ç»ƒäº†ã€‚é™¤éä½ åˆ°9æœˆä»½ä¸Šçº¿ï¼Œé‚£ä¹ˆæ—¶é—´ä¹…äº†ï¼Œå°±éœ€è¦é‡æ–°è®­ç»ƒï¼Œä¸€èˆ¬æ˜¯ä¸éœ€è¦é‡æ–°è®­ç»ƒçš„ã€‚ æ¬ºè¯ˆæ¨¡å‹çš„ç¨³å®šæ€§è¯„ä»·æŒ‡æ ‡ï¼š 1. å¯¹æ¯”è®­ç»ƒé›† ä¸ è·¨æ—¶é—´éªŒè¯é›† çš„ KS åå·®ï¼Œä¸€èˆ¬åå·®å¤§ä¸å¤§çš„è¯ï¼Œè§‰å¾—è¿™ä¸ªæ¨¡å‹æ˜¯å¯ä»¥åœ¨æ—¶é—´ç»´åº¦ä¸Šholdä½çš„ï¼Œé‚£ä¹ˆå¯ä»¥æ¨¡å‹ä¸Šçº¿ã€‚å¦å¤–æŒ‡æ ‡é‡‘èä¸Šæ¯”è¾ƒå¸¸ç”¨çš„æŒ‡æ ‡æ˜¯ psiï¼Œè¿™ä¸ªæ˜¯éªŒè¯ä¸åŒäººç¾¤çš„åç§»ç¨‹åº¦ï¼Œä»¥åå¯ä»¥è‡ªå·±æŸ¥æŸ¥èµ„æ–™ã€‚ Reference é‡‘èåæ¬ºè¯ˆåœºæ™¯ä¸‹çš„Sparkå®è·µ","categories":[{"name":"data-science","slug":"data-science","permalink":"http://iequa.com/categories/data-science/"}],"tags":[{"name":"ITFIN","slug":"ITFIN","permalink":"http://iequa.com/tags/ITFIN/"}]},{"title":"äº’è”ç½‘é‡‘èé£æ§ä¸­çš„æ•°æ®ç§‘å­¦ (part2)  ï¼š æ¨¡å‹ç­–ç•¥","slug":"datascience/internet-finance-2","date":"2018-04-21T10:28:21.000Z","updated":"2021-06-14T05:16:52.506Z","comments":true,"path":"2018/04/21/datascience/internet-finance-2/","link":"","permalink":"http://iequa.com/2018/04/21/datascience/internet-finance-2/","excerpt":"åæ¬ºè¯ˆä¹Ÿæ˜¯ä¸€ç§æœºå™¨å­¦ä¹ è¿‡ç¨‹ï¼Œ åæ¬ºè¯ˆå»ºæ¨¡ä¸­çš„æ•°æ®ç§‘å­¦","text":"åæ¬ºè¯ˆä¹Ÿæ˜¯ä¸€ç§æœºå™¨å­¦ä¹ è¿‡ç¨‹ï¼Œ åæ¬ºè¯ˆå»ºæ¨¡ä¸­çš„æ•°æ®ç§‘å­¦ åæ¬ºè¯ˆä¹Ÿæ˜¯ä¸€ç§æœºå™¨å­¦ä¹ è¿‡ç¨‹ å¯¹äºåšäº’è”ç½‘é‡‘èä¸€èˆ¬æƒ…å†µæ˜¯ æ­£è´Ÿæ ·æœ¬ æ˜¯æåº¦ä¸å¹³è¡¡çš„(æœ€é«˜å¯ä»¥è¾¾åˆ° 100 : 1), è¿™æ ·çš„æƒ…å†µå¯¹äº SVM è¿™ç§åˆ†ç±»å™¨æ˜¯ä¸åˆé€‚çš„ï¼Œæ‰€ä»¥åœ¨åšé‡‘èçš„è¯„åˆ†å¡æ¨¡å‹ æˆ– æ¬ºè¯ˆæ¨¡å‹ ä¹Ÿå¥½ï¼Œè¿™æ ·å¯¹ç‰¹å¾çš„å¤„ç† å’Œ æ ·æœ¬çš„éå¹³è¡¡å¤„ç†æ˜¯æ¯”è¾ƒé«˜çš„. å¥½åç”¨æˆ·çš„å®šä¹‰ï¼Œä¸€èˆ¬æ˜¯æ ¹æ®ç”¨æˆ·çš„è´·åè¡¨ç°ï¼Œæ¥å®šä¹‰å¥½åç”¨æˆ·çš„. ä¸¾ä¸ªæ —å­ğŸŒ° : ç”¨æˆ·å€Ÿæ¬¾ 5W å…ƒï¼Œå¯èƒ½æ˜¯åˆ†æœŸè¿˜æ¬¾ 12ä¸ªæœˆï¼Œè¿™æ ·æ¯ä¸ªæœˆéƒ½ä¼šè¿˜ä¸€ç¬”å›ºå®šçš„é¢åº¦. ä¿¡ç”¨é£é™© : åœ¨æŒºé•¿çš„æ—¶é—´å¯ä»¥æŒ‰æ—¶è¿˜æ¬¾. æ¬ºè¯ˆé£é™© : ç”¨æˆ·å¯èƒ½ ç¬¬ 1ã€2 æœŸ æ˜¯è¿˜çš„ï¼Œä¹‹åæ˜¯ä¸è¿˜çš„. (å› ä¸ºä¸­ä»‹ä¹Ÿè¶Šæ¥è¶Šèªæ˜ï¼Œç»™ä»–è‡ªå·±ç•™å‡ºæ—¶é—´ï¼Œèº²é¿å‚¬æ”¶çš„æ‰‹æ®µï¼Œä¹Ÿèº²é¿è¿½è¸ªç­‰ç­‰) è´·å‰å®¡æ ¸ ï¼ˆè§¦ç¢°åˆ°æ‹’è´·è§„åˆ™ï¼‰ é€ å‡è¡Œä¸º ï¼ˆä¿¡æ¯èµ„æ–™é€ å‡ï¼‰ è°ƒæŸ¥å‘˜ è°ƒæŸ¥å‡ºæ¥æ˜¯ ä¸­ä»‹ æˆ–è€… æœ‰æ¬ºè¯ˆé£å‘çš„ï¼Œè¿›å…¥é»‘åå•çš„. â€¦ æ‰€ä»¥æˆ‘ä»¬åœ¨å®šä¹‰æ¨¡å‹è´Ÿæ ·æœ¬çš„è¯ï¼Œæˆ‘ä»¬å¯èƒ½å®šä¹‰ä¸º m1+ ä¿¡ç”¨é£é™©ã€m3+ (90å¤©ä»¥ä¸Šä¸è¿˜æ¬¾çš„è¯)ï¼Œæˆ‘ä»¬å¯ä»¥å®šä¹‰ä¸ºæ¬ºè¯ˆé£é™© åç”¨æˆ· ï¼š æ¬ºè¯ˆé£é™©ç”¨æˆ·å¥½ç”¨æˆ· ï¼š ä¸€å¤©éƒ½ä¸é€¾æœŸè¿˜æ¬¾ç°ç”¨æˆ· ï¼š m1+ æœªè¿˜æ¬¾ï¼Œä½†æ˜¯90å¤©ä¹‹å†…å¯ä»¥è¿˜æ¬¾çš„ (ä¸æ”¾åœ¨è®­ç»ƒä¸­ï¼Œå¦åˆ™ä¼šç»™æ¨¡å‹å¸¦æ¥å¾ˆå¤šé¢å¤–çš„ä¿¡æ¯ï¼Œå½±å“æ•ˆæœ) é‡‘èæ¨¡å‹ å’Œ CTR é¢„ä¼°çš„ç›¸æ¯”æ˜¯ æœ‰ä¸€ä¸ªå‘¨æœŸæ€§è´¨çš„ å¹¿å‘Šç‚¹å‡»çš„è¯ï¼Œç”¨æˆ·ç‚¹å‡»ï¼Œç«‹é©¬æœ‰ä¸€ä¸ªæ ·æœ¬å‡ºç° åšé•¿æœŸç°é‡‘è´·ï¼Œé€‰æ‹©æ ·æœ¬æ˜¯é€‰æ‹©åŠå¹´ä¹‹å‰çš„ç”¨æˆ·ï¼Œä½œä¸ºæ ·æœ¬ æ¨¡å‹ç­–ç•¥ 1. Linear Regression 2 Logistic Regression 3. Decision Tree 4. Random Forest 5. Gradient Boosting RT ç»“æœè¯„ä¼°-æ··æ·†çŸ©é˜µ Precision: è¯„ä¼°è®¤å®šåç”¨æˆ·çš„ç²¾ç¡®åº¦ Recall: è¯„ä¼°åç”¨æˆ·çš„å¬å›ç‡ F-Measure: ç»„åˆåˆ¤æ–­ Reference é‡‘èåæ¬ºè¯ˆåœºæ™¯ä¸‹çš„Sparkå®è·µ å¤§å’–è¯´ ç‹å©·","categories":[{"name":"data-science","slug":"data-science","permalink":"http://iequa.com/categories/data-science/"}],"tags":[{"name":"ITFIN","slug":"ITFIN","permalink":"http://iequa.com/tags/ITFIN/"}]},{"title":"äº’è”ç½‘é‡‘èé£æ§ä¸­çš„æ•°æ®ç§‘å­¦ (part1) ï¼š é‡‘èç§‘æŠ€ä¼ä¸šé¢ä¸´çš„æ¬ºè¯ˆâ»›é™©","slug":"datascience/internet-finance-1","date":"2018-04-20T05:28:21.000Z","updated":"2021-06-14T05:16:52.502Z","comments":true,"path":"2018/04/20/datascience/internet-finance-1/","link":"","permalink":"http://iequa.com/2018/04/20/datascience/internet-finance-1/","excerpt":"é‡‘èç§‘æŠ€ä¼ä¸šé¢ä¸´çš„æ¬ºè¯ˆâ»›é™©ä»‹ç» , äº’è”ç½‘é‡‘è ä¸»è¦æ˜¯é€šè¿‡äº’è”ç½‘å¹³å°ï¼Œè¿æ¥ å‡ºå€Ÿæ–¹ å’Œ å€Ÿæ¬¾æ–¹","text":"é‡‘èç§‘æŠ€ä¼ä¸šé¢ä¸´çš„æ¬ºè¯ˆâ»›é™©ä»‹ç» , äº’è”ç½‘é‡‘è ä¸»è¦æ˜¯é€šè¿‡äº’è”ç½‘å¹³å°ï¼Œè¿æ¥ å‡ºå€Ÿæ–¹ å’Œ å€Ÿæ¬¾æ–¹ 1. é‡‘èä¸ç§‘æŠ€çš„ç»“æ™¶ é‡‘èçš„æœ¬è´¨ : èµ„æºçš„æœ€åˆç†åŒ–åº”ç”¨ äº’è”ç½‘æŠ€æœ¯ : äº¤æ˜“çš„è¾¹ç•Œæˆæœ¬è¶‹å‘â€œé›¶â€ é‡‘èç§‘æŠ€ : ç”¨å¤§æ•°æ®ã€äº‘è®¡ç®—ç­‰æŠ€æœ¯å®ç°çš„èµ„é‡‘èé€šã€æ”¯ä»˜ã€æŠ•èµ„å’Œä¿¡æ¯ä¸­ä»‹æœåŠ¡ æˆ‘ä»¬å›½å®¶æ²¡æœ‰è¦†ç›–åº¦å¾ˆå…¨çš„æ‰€æœ‰äººçš„å¾ä¿¡ï¼Œè™½ç„¶æœ‰å¤®è¡Œï¼Œä½†æ˜¯è¿˜è¿œè¿œä¸å¤Ÿâ€¦ æˆæƒæŠ“å–çš„ç”¨æˆ·çš„æ•°æ®ï¼Œ(ç™¾èã€åŒç›¾ã€èŠéº»ä¿¡ç”¨ ç­‰ï¼Œå·¥ä½œä¸­å¯èƒ½éƒ½ä¼šå¯¹æ¥åˆ°è¿™äº›å¹³å°)ï¼Œè¿™äº›å¹³å°ä¼šé€šè¿‡å¾ˆå¤šæ¸ é“æ”¶é›†ç”¨æˆ·ï¼Œç„¶åç»™ç”¨æˆ·æ‰“ä¸€äº›é£é™©æ ‡ç­¾å’Œæ¬ºè¯ˆçš„è¯„åˆ†. 2. ä¸­å›½ä¿¡ç”¨è´·æ¬¾è¡Œä¸š&nbsp;&nbsp;&nbsp; ç½‘è´·ä¹‹å®¶ æ”¶é›†P2Pç½‘è´·å¹³å°çš„è¿è¥æ•°æ®ï¼Œå¹¶ä¸ºè¡Œä¸šæ’è¡Œ, ä»¥ä¸‹ä¸º 2018å¹´3æœˆæ•°æ®åšçš„è¡Œä¸šæ’è¡Œ : ç½‘è´·ä¹‹å®¶ : http://www.wdzj.com/pingji.html ç°åœ¨æ¶ˆäº¡çš„ P2P å…¬å¸é€æ¸æ¶ˆäº¡çš„ä¹Ÿå¾ˆå¤šï¼Œä¹‹å‰ 3000 å¤šå®¶ï¼Œè¡Œä¸šå¤§æ´—ç‰Œä¹‹åï¼Œç°åœ¨ 2000 å¤šå®¶â€¦ åœ¨æ•´ä¸ªè¡Œä¸šçš„ä½“é‡ä¸Šï¼Œé™†é‡‘æ‰€ ä¸€å®šæ˜¯ä½“é‡éå¸¸å¤§çš„ï¼Œæ•´ä¸ªç½‘è´·çš„å¸‚åœºå¤§æ¦‚æœ‰ä¸‡äº¿çº§åˆ«. 3. ä¸­å›½ä¿¡ç”¨è´·æ¬¾è¡Œä¸šåˆ†å±‚ APR (Annual Percentage Rate) å¹´åˆ©ç‡, å¯¹é“¶è¡Œä¿¡ç”¨å¡æ¥è¯´ï¼Œä¸€èˆ¬ APR åœ¨ 16% ~ 18%, é‚£ä¹ˆæ—¥åˆ©ç‡ä¸º 0.04%~0.05% ä¹‹é—´ ä¸¾ä¸ªæ —å­ğŸŒ° : é“¶è¡Œæ˜¯æŒ‰æ—¥æ”¶åˆ©æ¯çš„ã€‚ç®€å•ä»‹ç»ä¸€ä¸‹åˆ©æ¯æ˜¯å¦‚ä½•è®¡ç®—çš„ : å‡è®¾ç”¨ä¿¡ç”¨å¡æç°1000åˆ€ï¼Œ20å¤©åè¿˜æ¸…ï¼Œè¿™å¼ å¡çš„Cash Advance APRæ˜¯25.49%.ä¸€å¹´æœ‰365å¤©ï¼ˆéƒ¨åˆ†é“¶è¡ŒæŒ‰360å¤©ç®—ï¼ˆä¸è¦é—®æˆ‘é—°å¹´æ€ä¹ˆç®—Orzï¼‰ï¼‰æ—¥åˆ©ç‡åº”è¯¥æ˜¯25.49%/365=0.07%.20å¤©åäº§ç”Ÿçš„åˆ©æ¯ä¸º1000 * 20 * 0.07% = 14åˆ€ APR å¯ä»¥åˆ’åˆ†äººç¾¤ï¼ŒAPR ä¸åŒçº§åˆ«ï¼Œè´·å‰è´·åçš„å®¡æ ¸ï¼Œå‚¬æ”¶çš„åˆ¶åº¦ ä¹Ÿæ˜¯ä¸åŒçš„ APRè¶Šä½ï¼Œäººç¾¤æ˜¯è¶Šå¥½çš„. åœ¨ APR ä½çš„äººç¾¤ï¼Œæ˜¯åŸºæœ¬ä¸éœ€è¦å‚¬æ”¶çš„ï¼Œåœ¨ APR é«˜çš„äººç¾¤ï¼Œæ˜¯è¦å‚¬æ”¶çš„. é«˜ APR äººç¾¤: å¯¹äº APR åœ¨ 40% ~ 80% çš„ï¼Œæ¯”å¦‚ æ‹æ‹è´·ï¼Œè¿™ç§å°é¢çš„ç°é‡‘è´·ï¼Œ5000 ä»¥ä¸‹ï¼Œ7å¤©~1ä¸ªæœˆï¼Œè´·æ¬¾çš„æ—¶é—´ä¹ŸçŸ­ï¼Œå¤šè¿˜çš„åˆ©æ¯ç”¨æˆ·æ˜¯ä¸æ„ŸçŸ¥çš„ï¼Œä½†æ˜¯å¦‚æœå˜æˆå¹´åŒ–ï¼ŒAPR å°±ä¼šéå¸¸é«˜ åœ¨ APR &gt; 80%, æ˜¯ ç°é‡‘å·´å£«ï¼Œç”¨é’±å®ï¼Œè¿™äº›å­˜åœ¨ä¹Ÿæ˜¯æœ‰äººä»¬çš„éœ€æ±‚å­˜åœ¨çš„APR ä½çš„ç”¨æˆ·ï¼Œå°±æ˜¯ä¿¡ç”¨å¥½ï¼ŒAPRé«˜çš„è¯ï¼Œå°±æ˜¯ä¿¡ç”¨æ²¡æœ‰é‚£ä¹ˆå¥½ï¼Œæˆ–è€…è¿˜æ¬¾èƒ½åŠ›æ²¡æœ‰é‚£ä¹ˆå¥½ åšé‡‘èæœ€å¤§çš„æœ¬è´¨å°±æ˜¯åœ¨æ§åˆ¶é£é™©ï¼Œåœ¨é£é™©å¯æ§çš„æƒ…å†µä¸‹è·å¾—æœ€å¤§çš„åˆ©æ¶¦. 4. ä¸ªäººå¯¹ä¸ªäººçš„ä¿¡ç”¨è´·æ¬¾ 5. æ€¥é€Ÿä¿¡ä»»-è‡ªåŠ¨åŒ–ä¿¡ç”¨è¯„ä¼° å›½å†…å¤– P2P ç½‘è´·çš„æ¯”è¾ƒ : å›½å®¶é‡‘èç¯å¢ƒå­˜åœ¨è¾ƒå¤§åŒºåˆ«,åœ¨ä¿¡ç”¨ä½“ç³»å»ºè®¾ç­‰æ–¹é¢ä¹Ÿéƒ½å­˜åœ¨å¾ˆå¤§çš„å·®å¼‚ï¼Œå›½å¤–æ‹¥æœ‰è¾ƒä¸ºå®Œå–„çš„ä¿¡ç”¨è¯„ä¼°ä½“åˆ¶,ä¸­å›½åœ¨è¿™æ–¹é¢å´éå¸¸ç¼ºå¤±ï¼Œæ‰€ä»¥å›½å†…çš„å€Ÿè´·å¹³å°åœ¨ç”¨æˆ·ä¿¡ç”¨è¯„ä¼°æ–¹é¢éƒ½åšå‡ºè‡ªå·±çš„åŠªåŠ›ï¼Œæ„å»ºäº†ä¸åŒå½¢å¼çš„è¯„ä»·æ–¹æ³•. å›½å¤–æœ‰å®Œå–„çš„ä¿¡ç”¨è¯„ä¼°ä½“è´¨ï¼Œæœ‰ FICOå®˜æ–¹çš„è¯„åˆ†. å›½å¤–80%éƒ½æ˜¯ä¿¡ç”¨é£é™©ï¼Œ20%æ˜¯æ¬ºè¯ˆé£é™©. ä¸­å›½æ›´å¤šçš„æ˜¯æ¬ºè¯ˆé£é™©. FICO æˆç«‹äº1956å¹´ï¼Œä¸ºçº½äº¤æ‰€ä¸Šå¸‚å…¬å¸ï¼Œå¸‚å€¼52äº¿ç¾é‡‘ï¼Œæä¾›è·¨å¤šä¸ªè¡Œä¸šçš„åˆ†æè½¯ä»¶å’Œå·¥å…·. å›½å†…é»‘äº§ä¸šé“¾ : å›½å†…ä¸è¿˜é’±çš„è¯æƒ©ç½šçš„æªæ–½è·Ÿä¸ä¸Šï¼Œå›½å†…æœ‰äº›ä¸­ä»‹æˆ‘ä¸è¿˜é’±çš„è¯ï¼Œä½ æ‰¾ä¸åˆ°æˆ‘çš„è¯ï¼Œè¿™ä¸ªé’±å°±æ˜¯æˆ‘ç©ºæ‰‹å¥—ç™½ç‹¼çš„åˆ©æ¶¦ï¼Œè¿™æ ·å‚¬ç”Ÿäº†è¶Šæ¥è¶Šå¤šè´·æ¬¾çš„æ¬ºè¯ˆçš„æƒ…å†µï¼Œä»–ä»¬æœ‰ä¸€ä¸ªé»‘äº§ä¸šé“¾ï¼Œä»è´¦å·çš„è·å–åˆ°æ¶æ„çš„æ³¨å†Œï¼Œå†åˆ°äº’è”ç½‘é‡‘èå…¬å¸çš„å¹³å°ç”³è¯·è´·æ¬¾ï¼Œæœ‰çš„ä¸­ä»‹ä¼šæœ‰ä¸€äº›ç°è±¡. ä¸¾ä¸ªæ —å­ğŸŒ°: ä»–ä»¬ä¼šåˆ°ç‡•éƒŠæ‰¾ä¸€æ‰¹è€äººå¦‡å¥³ï¼Œç„¶åè¯´æˆ‘ç»™ä½ 3000å…ƒé’±ï¼Œä½ è·Ÿç€æˆ‘èµ°ä¸€è¶Ÿã€‚è¿˜æœ‰ä¸€äº›å®¢æˆ·å¯¹è‡ªå·±çš„èµ„è´¨æ²¡æœ‰ä¿¡å¿ƒï¼Œç„¶åæ‰¾ä¸­ä»‹åŒ…è£…ä¸€äº›ææ–™ã€‚æœ‰å¥½ä¸­ä»‹ï¼Œæœ‰åä¸­ä»‹ï¼Œå¦‚æœåä¸­ä»‹å¸¦ä½ è´·äº†5Wå…ƒé’±ï¼Œç„¶åç»™ä½ 2.5Wå‘Šè¯‰ä½ çˆ±è¿˜ä¸è¿˜ï¼Œç„¶åè¿˜å¯ä»¥å¸¦ä½ çš„ä¿¡æ¯å†å»å…¶ä»–å®¶å¹³å°å†è´·æ¬¾ï¼Œè¿™æ ·ç”¨æˆ·åœ¨ä¸çŸ¥æƒ…çš„æƒ…å†µä¸‹ä¼šèƒŒè´Ÿå¾ˆå¤šå€ºåŠ¡ä¿¡æ¯. ä¸­ä»‹åšçš„äº‹ï¼Œå°±æ˜¯ä¸åœçš„å»è¯•å„ä¸ªP2På¹³å°äº§å“ï¼Œå‘ç°å…¶ä¸­æ¼æ´ï¼Œè¿™äº›ä¸­ä»‹æ¯”äº§å“ç»ç†è¿˜è¦äº†è§£è¿™ä¸ªäº§å“ï¼Œç„¶åä»–å¸®åŠ©ä»–çš„å®¢æˆ·å»åšåŒ…è£…ï¼Œè¿™æ ·æ¯”å¦‚ä¸€ä¸‹å­å¯èƒ½è¿›æ¥ 100 ä¸ªæ¬ºè¯ˆç”¨æˆ·ï¼Œæ¯ä¸ªç”¨æˆ·5Wï¼Œè¿™æ ·ä¸€ä¸‹å­å°±æ˜¯500Wï¼Œå¯¹ä¼ä¸šæ¥è¯´æŸå¤±å¾ˆå¤§ï¼Œç„¶ååœ¨è¿™ç§é«˜é¢æ”¶å…¥çš„è¯±æƒ‘ä¸‹ï¼Œè¿™äº›ä¸­ä»‹ä¼šå‡çº§ä¸æ–­è‡ªå·±çš„ä¼ªé€ æŠ€æœ¯. 6. é‡‘èç§‘æŠ€ä¼ä¸šé¢ä¸´çš„æ¬ºè¯ˆé£é™© å¯¹äºçº¿ä¸Šåæ¬ºè¯ˆæ¥è¯´ï¼Œä½ çœ‹ä¸è§ç”¨æˆ·ï¼Œåªé¢å¯¹æ•°æ®ï¼Œè¦å‘ç°æ•°æ®ä¹‹é—´çš„å¼‚å¸¸ã€ç”¨æˆ·ä¸ç”¨æˆ·ä¹‹é—´æœ‰æ²¡æœ‰å¼‚å¸¸ç›¸ä¼¼åº¦è”ç³»ç­‰. 7. Reference å®œäººè´·æ•°æ®ç§‘å­¦å®¶ç‹å©·: é‡‘èåæ¬ºè¯ˆåœºæ™¯ä¸‹çš„Sparkå®è·µ å¤§å’–è¯´ ç‹å©·","categories":[{"name":"data-science","slug":"data-science","permalink":"http://iequa.com/categories/data-science/"}],"tags":[{"name":"ITFIN","slug":"ITFIN","permalink":"http://iequa.com/tags/ITFIN/"}]},{"title":"Ensemble Learning (part2)","slug":"ml/ensumble-boosting-2","date":"2018-04-11T08:08:21.000Z","updated":"2019-10-20T04:30:35.041Z","comments":true,"path":"2018/04/11/ml/ensumble-boosting-2/","link":"","permalink":"http://iequa.com/2018/04/11/ml/ensumble-boosting-2/","excerpt":"æå‡ï¼ˆboostingï¼‰æ–¹æ³•æ˜¯ä¸€ç±»åº”ç”¨å¹¿æ³›ä¸”éå¸¸æœ‰æ•ˆçš„ç»Ÿè®¡å­¦ä¹ æ–¹æ³•ã€‚ Boosting æ¦‚å¿µ ä»£è¡¨æ€§ Boosting ç®—æ³• AbaBoost ä»‹ç»","text":"æå‡ï¼ˆboostingï¼‰æ–¹æ³•æ˜¯ä¸€ç±»åº”ç”¨å¹¿æ³›ä¸”éå¸¸æœ‰æ•ˆçš„ç»Ÿè®¡å­¦ä¹ æ–¹æ³•ã€‚ Boosting æ¦‚å¿µ ä»£è¡¨æ€§ Boosting ç®—æ³• AbaBoost ä»‹ç» ã€ŠAn Empirical Comparison of Supervised Learning Algorithmsã€‹ICML2006. Adaboost åœ¨å¤„ç†äºŒç±»åˆ†ç±»é—®é¢˜æ—¶ï¼Œéšç€å¼±åˆ†ç±»å™¨çš„ä¸ªæ•°å¢åŠ ï¼Œè®­ç»ƒè¯¯å·®ä¸æµ‹è¯•è¯¯å·®çš„æ›²çº¿å›¾ã€‚ ä»å›¾ä¸­å¯ä»¥çœ‹å‡ºï¼ŒAdaboostç®—æ³•éšç€æ¨¡å‹å¤æ‚åº¦çš„å¢åŠ ï¼Œæµ‹è¯•è¯¯å·®ï¼ˆçº¢è‰²ç‚¹çº¿ï¼‰åŸºæœ¬ä¿æŒç¨³å®šï¼Œå¹¶æ²¡æœ‰å‡ºç°è¿‡æ‹Ÿåˆçš„ç°è±¡ã€‚ å…¶å®ä¸ä»…æ˜¯Adaboostç®—æ³•æœ‰è¿™ç§è¡¨ç°ï¼ŒBoostingæ–¹æ³•çš„å­¦ä¹ æ€æƒ³å’Œæ¨¡å‹ç»“æ„ä¸Šå¯ä»¥ä¿è¯å…¶ä¸å®¹æ˜“äº§ç”Ÿè¿‡æ‹Ÿåˆï¼ˆé™¤éWeak Learneræœ¬èº«å‡ºç°è¿‡æ‹Ÿåˆï¼‰ã€‚ ä¸‹é¢æˆ‘ä»¬ä¸»è¦æ˜¯ä»æŸå¤±å‡½æ•°çš„å·®å¼‚ï¼Œæ¥ä»‹ç»Boostingçš„å®¶æ—æˆå‘˜ï¼›ç„¶åæˆ‘ä»¬é’ˆå¯¹æ¯ä¸ªå…·ä½“çš„å®¶æ—æˆå‘˜ï¼Œè¯¦ç»†ä»‹ç»å…¶å­¦ä¹ è¿‡ç¨‹å’Œæ ¸å¿ƒå…¬å¼ï¼›æœ€åä»ç®—æ³•åº”ç”¨åœºæ™¯å’Œå·¥å…·æ–¹æ³•ç»™å‡ºç®€å•çš„ä»‹ç»ã€‚ Boosting Boostingæ–¹æ³•åŸºäºè¿™æ ·ä¸€ç§æ€æƒ³ï¼š å¯¹äºä¸€ä¸ªå¤æ‚ä»»åŠ¡æ¥è¯´ï¼Œå°†å¤šä¸ªä¸“å®¶çš„åˆ¤å®šè¿›è¡Œé€‚å½“çš„ç»¼åˆå¾—å‡ºçš„åˆ¤æ–­ï¼Œè¦æ¯”å…¶ä¸­ä»»ä½•ä¸€ä¸ªä¸“å®¶å•ç‹¬çš„åˆ¤æ–­å¥½ã€‚ å°±æ˜¯ â€œä¸‰ä¸ªè‡­çš®åŒ é¡¶ä¸ªè¯¸è‘›äº®â€ â€¦ğŸ˜„ğŸ˜„ğŸ˜„ 1. æ¦‚ç‡å¯å­¦ä¹ æ€§ (PAC)PACç†è®ºæ˜¯ç”±2010å¹´å›¾çµå¥–çš„å¾—ä¸»Valiantå’ŒKearnsæå‡ºçš„ä¸€å¥—ç†è®ºä½“ç³»ï¼Œä¸»è¦è®¨è®ºä»€ä¹ˆæ—¶å€™ï¼Œä¸€ä¸ªé—®é¢˜æ˜¯å¯ä»¥è¢«å­¦ä¹ çš„ã€‚ PACä½“ç³»å®šä¹‰äº†å­¦ä¹ ç®—æ³•çš„å¼ºå¼±ï¼š (1) å¼±å­¦ä¹ ç®—æ³• : å¦‚æœå­˜åœ¨ä¸€ä¸ªå¤šé¡¹å¼çš„å­¦ä¹ ç®—æ³•èƒ½å¤Ÿå­¦ä¹ å®ƒï¼Œå­¦ä¹ çš„æ­£ç¡®ç‡ä»…æ¯”éšæœºçŒœæµ‹ç•¥å¥½ï¼Œ(2) å¼ºå­¦ä¹ ç®—æ³• : å­˜åœ¨ä¸€ä¸ªå¤šé¡¹å¼çš„å­¦ä¹ ç®—æ³•èƒ½å¤Ÿå­¦ä¹ å®ƒï¼Œå¹¶ä¸”æ­£ç¡®ç‡å¾ˆé«˜ åœ¨æ¦‚ç‡è¿‘ä¼¼æ­£ç¡®ï¼ˆprobably approximately correctï¼ŒPACï¼‰å­¦ä¹ æ¡†æ¶ä¸­ï¼š â‘ . ä¸€ä¸ªæ¦‚å¿µï¼ˆä¸€ä¸ªç±»ï¼Œlabelï¼‰ï¼Œå¦‚æœå­˜åœ¨ä¸€ä¸ªå¤šé¡¹å¼çš„å­¦ä¹ ç®—æ³•èƒ½å¤Ÿå­¦ä¹ å®ƒï¼Œå¹¶ä¸”æ­£ç¡®ç‡å¾ˆé«˜ï¼Œé‚£ä¹ˆå°±ç§°è¿™ä¸ªæ¦‚å¿µæ˜¯å¼ºå¯å­¦ä¹ çš„ï¼› â‘¡. ä¸€ä¸ªæ¦‚å¿µï¼ˆä¸€ä¸ªç±»ï¼Œlabelï¼‰ï¼Œå¦‚æœå­˜åœ¨ä¸€ä¸ªå¤šé¡¹å¼çš„å­¦ä¹ ç®—æ³•èƒ½å¤Ÿå­¦ä¹ å®ƒï¼Œå­¦ä¹ çš„æ­£ç¡®ç‡ä»…æ¯”éšæœºçŒœæµ‹ç•¥å¥½ï¼Œé‚£ä¹ˆå°±ç§°è¿™ä¸ªæ¦‚å¿µæ˜¯å¼±å¯å­¦ä¹ çš„ã€‚ Valiantå’Œ Kearnsæå‡ºPACå­¦ä¹ æ¨¡å‹ä¸­å¼±å­¦ä¹ ç®—æ³•å’Œå¼ºå­¦ä¹ ç®—æ³•çš„ç­‰ä»·æ€§çŒœæƒ³ï¼š è¯¥çŒœæƒ³æœ€é‡è¦çš„å«ä¹‰æ˜¯ï¼Œå¦‚æœäºŒè€…ç­‰ä»· ,é‚£ä¹ˆåªéœ€æ‰¾åˆ°ä¸€ä¸ªæ¯”éšæœºçŒœæµ‹ç•¥å¥½çš„å¼±å­¦ä¹ ç®—æ³•å°±å¯ä»¥å°†å…¶æå‡ä¸ºå¼ºå­¦ä¹ ç®—æ³•ï¼Œè€Œä¸å¿…å¯»æ‰¾å¾ˆéš¾è·å¾—çš„å¼ºå­¦ä¹ ç®—æ³•ã€‚ è¯¥é—®é¢˜çš„é‡è¦æ€§éšå³å¼•èµ·æ–¹æ³•è®ºå¤§å¸ˆçš„è¿½æ§ï¼Œå¤§å®¶éƒ½åœ¨è¯•å›¾è®¾è®¡ç®—æ³•æ¥éªŒè¯PACç†è®ºçš„æ­£ç¡®æ€§ã€‚ 1996ï¼ŒSchapireæå‡ºä¸€ç§æ–°çš„åå«AdaBoostçš„ç®—æ³•è¯æ˜äº†ä¸Šè¿°çŒœæƒ³ã€‚AdaBoostæŠŠå¤šä¸ªä¸åŒçš„å†³ç­–æ ‘ç”¨ä¸€ç§ééšæœºçš„æ–¹å¼ç»„åˆèµ·æ¥ï¼Œè¡¨ç°å‡ºæƒŠäººçš„æ€§èƒ½ã€‚åŒæ—¶ï¼ŒSchapireè¯æ˜å¼ºå¯å­¦ä¹ ä¸å¼±å¯å­¦ä¹ æ˜¯ç­‰ä»·çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨PACå­¦ä¹ çš„æ¡†æ¶ä¸‹ï¼Œä¸€ä¸ªæ¦‚å¿µæ˜¯å¼ºå¯å­¦ä¹ çš„å……åˆ†å¿…è¦æ¡ä»¶æ˜¯è¿™ä¸ªæ¦‚å¿µæ˜¯å¼±å¯å­¦ä¹ çš„ã€‚ Summary : å¼ºå¯å­¦ä¹ â‡”å¼±å¯å­¦ä¹  Boostingå¯¹äºä¸€ä¸ªå­¦ä¹ é—®é¢˜æ¥è¯´ï¼ˆä»¥åˆ†ç±»é—®é¢˜ä¸ºä¾‹ï¼‰ï¼Œç»™å®šè®­ç»ƒæ•°æ®é›†ï¼Œæ±‚ä¸€ä¸ªå¼±å­¦ä¹ ç®—æ³•è¦æ¯”æ±‚ä¸€ä¸ªå¼ºå­¦ä¹ ç®—æ³•è¦å®¹æ˜“çš„å¤šã€‚Boostingæ–¹æ³•å°±æ˜¯ä»å¼±å­¦ä¹ ç®—æ³•å‡ºå‘ï¼Œåå¤å­¦ä¹ ï¼Œå¾—åˆ°ä¸€ç³»åˆ—å¼±åˆ†ç±»å™¨ï¼Œç„¶åç»„åˆå¼±åˆ†ç±»å™¨ï¼Œå¾—åˆ°ä¸€ä¸ªå¼ºåˆ†ç±»å™¨ã€‚Boostingæ–¹æ³•åœ¨å­¦ä¹ è¿‡ç¨‹ä¸­é€šè¿‡æ”¹å˜è®­ç»ƒæ•°æ®çš„æƒå€¼åˆ†å¸ƒï¼Œé’ˆå¯¹ä¸åŒçš„æ•°æ®åˆ†å¸ƒè°ƒç”¨å¼±å­¦ä¹ ç®—æ³•å¾—åˆ°ä¸€ç³»åˆ—å¼±åˆ†ç±»å™¨ã€‚ è¿˜æœ‰å°±æ˜¯ï¼ŒBoostingç®—æ³•æ›´åŠ å…³æ³¨é”™åˆ†çš„æ ·æœ¬ï¼Œè¿™ç‚¹å’ŒActive Learningçš„å¯»æ‰¾æœ€æœ‰ä»·å€¼çš„è®­ç»ƒæ ·æœ¬æœ‰ç‚¹é¥ç›¸å‘¼åº”çš„æ„Ÿè§‰ å¾ˆæŠ½è±¡å¯¹ä¸å¯¹ï¼Œä½†æ˜¯è¿‡ä¸€ä¼šå„¿æˆ‘ä»¬é€šè¿‡Adaboostæ¥ç†è§£è¿™ä¸ªæ ¸å¿ƒæ€æƒ³ å›ç­”ä¸¤ä¸ªé—®é¢˜ ï¼š åœ¨æ¯ä¸€è½®å­¦ä¹ ä¹‹å‰ï¼Œå¦‚ä½•æ”¹å˜è®­ç»ƒæ•°æ®çš„æƒå€¼åˆ†å¸ƒï¼Ÿ å¦‚ä½•å°†ä¸€ç»„å¼±åˆ†ç±»å™¨ç»„åˆæˆä¸€ä¸ªå¼ºåˆ†ç±»å™¨ï¼Ÿ å…·ä½“ä¸åŒçš„boostingå®ç°ï¼Œä¸»è¦åŒºåˆ«åœ¨å¼±å­¦ä¹ ç®—æ³•æœ¬èº«å’Œä¸Šé¢ä¸¤ä¸ªé—®é¢˜çš„å›ç­”ä¸Šã€‚ é—®é¢˜1ï¼ŒAdaboostç®—æ³•çš„åšæ³•æ˜¯ ï¼š æé«˜é‚£äº›è¢«å‰ä¸€è½®å¼±åˆ†ç±»å™¨é”™è¯¯åˆ†ç±»æ ·æœ¬çš„æƒå€¼ï¼Œè€Œé™ä½é‚£äº›è¢«æ­£ç¡®åˆ†ç±»æ ·æœ¬çš„æƒå€¼ã€‚ å¦‚æ­¤ï¼Œé‚£äº›æ²¡æœ‰å¾—åˆ°æ­£ç¡®åˆ†ç±»çš„æ ·æœ¬ï¼Œç”±äºå…¶æƒå€¼åŠ å¤§è€Œå—åˆ°åä¸€è½®çš„å¼±åˆ†ç±»å™¨çš„æ›´å¤§å…³æ³¨ã€‚ é—®é¢˜2ï¼ŒAdaBoosté‡‡å–åŠ æƒå¤šæ•°è¡¨å†³çš„æ–¹æ³• ï¼š (1). åŠ å¤§ åˆ†ç±»è¯¯å·®ç‡å° çš„å¼±åˆ†ç±»å™¨çš„æƒå€¼ï¼Œä½¿å…¶åœ¨è¡¨å†³ä¸­èµ·è¾ƒå¤§çš„ä½œç”¨ï¼›(2). å‡å°åˆ†ç±»è¯¯å·®ç‡å¤§çš„å¼±åˆ†ç±»å™¨çš„æƒå€¼ï¼Œä½¿å…¶åœ¨è¡¨å†³ä¸­èµ·è¾ƒå°çš„ä½œç”¨ã€‚ AdaBoostç®—æ³•çš„å·§å¦™ä¹‹å¤„å°±åœ¨äºå®ƒå°†è¿™äº›å­¦ä¹ æ€è·¯è‡ªç„¶å¹¶ä¸”æœ‰æ•ˆåœ°åœ¨ä¸€ä¸ªç®—æ³•é‡Œé¢å®ç°ã€‚ Boostingç®—æ³•ä»£è¡¨ ï¼šAdaboost(Adaptive Boosting) æ ¸å¿ƒæ€æƒ³ï¼šä¸€ç§è¿­ä»£ç®—æ³•ï¼Œé’ˆå¯¹åŒä¸€ä¸ªè®­ç»ƒé›†è®­ç»ƒä¸åŒçš„åˆ†ç±»å™¨(å¼±åˆ†ç±»å™¨)ï¼Œç„¶åè¿›è¡Œåˆ†ç±»ï¼Œå¯¹äºåˆ†ç±»æ­£ç¡®çš„æ ·æœ¬æƒå€¼ä½ï¼Œåˆ†ç±»é”™è¯¯çš„æ ·æœ¬æƒå€¼é«˜ï¼ˆé€šå¸¸æ˜¯è¾¹ç•Œé™„è¿‘çš„æ ·æœ¬ï¼‰ï¼Œæœ€åçš„åˆ†ç±»å™¨æ˜¯å¾ˆå¤šå¼±åˆ†ç±»å™¨çš„çº¿æ€§å åŠ ï¼ˆåŠ æƒç»„åˆï¼‰ï¼Œåˆ†ç±»å™¨ç›¸å½“ç®€å•ã€‚å®é™…ä¸Šå°±æ˜¯ä¸€ä¸ªç®€å•çš„å¼±åˆ†ç±»ç®—æ³•æå‡(boost)çš„è¿‡ç¨‹ã€‚ çœ‹å›¾å½¢æ¥è¿‡ä¸€éAdaboostç®—æ³• ç®—æ³•å¼€å§‹å‰ï¼Œéœ€è¦å°†æ¯ä¸ªæ ·æœ¬çš„æƒé‡åˆå§‹åŒ–ä¸º 1/m, è¿™æ ·ä¸€å¼€å§‹æ¯ä¸ªæ ·æœ¬éƒ½æ˜¯ç­‰æ¦‚ç‡çš„åˆ†å¸ƒï¼Œæ¯ä¸ªåˆ†ç±»å™¨éƒ½ä¼šå…¬æ­£å¯¹å¾…. Round1ï¼Œå› ä¸ºæ ·æœ¬æƒé‡éƒ½ä¸€æ ·ï¼Œæ‰€ä»¥åˆ†ç±»å™¨å¼€å§‹åˆ’åˆ†ï¼Œæ ¹æ®è‡ªå·±åˆ†ç±»å™¨çš„æƒ…å†µï¼Œåªå’Œåˆ†ç±»å™¨æœ‰å…³ã€‚åˆ’åˆ†ä¹‹åå‘ç°åˆ†é”™äº†ä¸‰ä¸ªâ€+â€å·ï¼Œé‚£ä¹ˆè¿™äº›åˆ†é”™çš„æ ·æœ¬ï¼Œåœ¨ç»™ä¸‹ä¸€ä¸ªåˆ†ç±»å™¨çš„æ—¶å€™æƒé‡å°±å¾—åˆ°æé«˜,ä¹Ÿå°±æ˜¯ä¼šå½±å“åˆ°ä¸‹æ¬¡å–è®­ç»ƒæ ·æœ¬çš„åˆ†å¸ƒï¼Œå°±æ˜¯æé†’ä¸‹ä¸€ä¸ªåˆ†ç±»å™¨ï¼Œâ€œè¯¶ï¼ä½ æ³¨æ„ç‚¹è¿™å‡ ä¸ªå°å­ï¼Œæˆ‘ä¸Šæ¬¡æ ½åœ¨ä»–ä»¬æ‰‹é‡Œäº†ï¼â€ Round2,ç¬¬äºŒä»£åˆ†ç±»å™¨ä¿¡èª“æ—¦æ—¦çš„å¯¹ä¸Šä¸€ä»£åˆ†ç±»å™¨è¯´â€æˆ‘çŸ¥é“äº†ï¼Œå¤§å“¥ï¼æˆ‘ä¸€å®šçå¤§çœ¼ç›å¥½å¥½åˆ†ç€ä¸‰ä¸ªç©æ„ï¼â€okï¼Œè¿™æ¬¡ä¸‰ä¸ªä¸Šæ¬¡åˆ†é”™çš„éƒ½è¢«åˆ†å‡ºæ¥äº†ï¼Œä½†æ˜¯å¹¶ä¸æ˜¯å…¨éƒ¨æ­£ç¡®ï¼Œè¿™æ¬¡åˆæ ½å€’åœ¨å·¦ä¸‹è§’ä¸‰ä¸ªâ€-â€œä¸Šäº†ï¼Œç„¶åä¸´æ­»å‰ï¼Œç¬¬äºŒä»£åˆ†ç±»å™¨å¯¹ä¸‹ä¸€ä»£åˆ†ç±»å™¨è¯´â€è¿™æ¬¡æˆ‘å’Œä¸Šä¸€ä»£åˆ†ç±»å™¨å·²ç»æŠŠä»–ä»¬æ‘¸å¾—å·®ä¸å¤šäº†ï¼Œä½ å†ç¨å¾®æ³¨æ„ä¸‹å·¦ä¸‹è§’é‚£ä¸‰ä¸ªå°å­ï¼Œä¹Ÿåˆ«å¿˜äº†ä¸Šé¢é‚£ä¸‰ä¸ª(ä¸€ä»£é”™åˆ†çš„é‚£ä¸‰ä¸ªâ€+â€)ï¼â€ Round3:æœ‰äº†ä¸Šé¢ä¸¤ä½å¤§å“¥çš„æé†’ï¼Œç¬¬ä¸‰ä»£åˆ†ç±»å™¨è¡¨ç¤ºï¼Œæˆ‘å·®ä¸å¤šéƒ½çŸ¥é“ä¸Šæ¬¡å¤§å“¥ä»¬éƒ½é”™å“ªäº†ï¼Œæˆ‘åªè¦å°å¿ƒè¿™å‡ ä¸ªï¼Œåº”è¯¥æ²¡ä»€ä¹ˆé—®é¢˜ï¼åªè¦æŠŠä»–ä»¬å¼„é”™çš„æˆ‘ç»™æ•´å¯¹äº†ï¼Œç„¶åæŠŠæˆ‘ä»¬æ”¶é›†çš„ä¿¡æ¯ä¸€å¯¹ï¼Œè¿™ä¸å°±è¡Œäº†ä¹ˆï¼okï¼Œç¬¬ä¸‰ä»£åˆ†ç±»å™¨ä¸è´Ÿä¼—æœ›ï¼ŒæˆåŠŸåˆ†å¯¹ä¸Šé¢ä¸¤ä»£åˆ†ç±»å™¨é‡ç‚¹å…³æ³¨çš„å¯¹è±¡ï¼Œè‡³äºåˆ†é”™çš„é‚£å‡ ä¸ªå°çš„ï¼Œä»¥å‰å¤§å“¥ä»¬éƒ½åˆ†å¯¹äº†ï¼Œæˆ‘ä»¬åä¸‹æ¥æ ¸å¯¹ä¸€ä¸‹å°±è¡Œäº†ï¼ æœ€åï¼Œä¸‰ä¸ªåˆ†ç±»å™¨åä¸‹æ¥ï¼Œå„è‡ªè°ˆäº†è°ˆå¿ƒå¾—ï¼Œåˆ†é…äº†ä¸‹æƒé‡ï¼Œç„¶åä¸€ä¸ªè¯¸è‘›äº®å°±è¯ç”Ÿå•¦ï¼è¿™ä¹Ÿå°±æ˜¯ â€œä¸‰ä¸ªè‡­çš®åŒ é¡¶ä¸ªè¯¸è‘›äº®çš„æ•…äº‹â€ â€¦ğŸ˜„ğŸ˜„ğŸ˜„, æ˜¯ä¸æ˜¯é“ç†å¾ˆç®€å•ï¼è‡³äºæƒé‡å¦‚ä½•è®¡ç®—ï¼Œæš‚ä¸åœ¨æœ¬æ–‡è®¨è®º. Adaboost ä¼˜ç‚¹ å¯ä»¥ä½¿ç”¨å„ç§æ–¹æ³•æ„é€ å­åˆ†ç±»å™¨ï¼ŒAdaboostç®—æ³•æä¾›çš„æ˜¯æ¡†æ¶ ç®€å•ï¼Œä¸ç”¨åšç‰¹å¾ç­›é€‰ ç›¸æ¯”è¾ƒäºRFï¼Œæ›´ä¸ç”¨æ‹…å¿ƒè¿‡æ‹Ÿåˆé—®é¢˜ Adaboost ç¼ºç‚¹ Adaboostå¯¹äºå™ªå£°æ˜¯ååˆ†æ•æ„Ÿçš„ã€‚Boostingæ–¹æ³•æœ¬èº«å¯¹å™ªå£°ç‚¹å¼‚å¸¸ç‚¹å¾ˆæ•æ„Ÿï¼Œå› æ­¤åœ¨æ¯æ¬¡è¿­ä»£æ—¶å€™ä¼šç»™å™ªå£°ç‚¹è¾ƒå¤§çš„æƒé‡ï¼Œè¿™ä¸æ˜¯æˆ‘ä»¬ç³»ç»Ÿæ‰€æœŸæœ›çš„ã€‚ è¿è¡Œé€Ÿåº¦æ…¢ï¼Œå‡¡æ˜¯æ¶‰åŠè¿­ä»£çš„åŸºæœ¬ä¸Šéƒ½æ— æ³•é‡‡ç”¨å¹¶è¡Œè®¡ç®—ï¼ŒAdaboostæ˜¯ä¸€ç§â€ä¸²è¡Œâ€ç®—æ³•.æ‰€ä»¥GBDT(Gradient Boosting Decision Tree)ä¹Ÿéå¸¸æ…¢ã€‚ Pay Attention Bagging æ ‘â€å¹¶è¡Œâ€ç”Ÿæˆ,å¦‚ Random Forest ; Boostingï¼šæ ‘â€ä¸²è¡Œâ€ç”Ÿæˆ,å¦‚Adaboost Boosting ä¸­åŸºæ¨¡å‹ä¸ºå¼±æ¨¡å‹ï¼Œè€Œ Random Forest ä¸­çš„åŸºæ ‘æ˜¯å¼ºæ¨¡å‹(å¤§å¤šæ•°æƒ…å†µ) Boosting é‡é‡‡æ ·çš„ä¸æ˜¯æ ·æœ¬ï¼Œè€Œæ˜¯æ ·æœ¬çš„åˆ†å¸ƒï¼Œæ¯æ¬¡è¿­ä»£ä¹‹åï¼Œæ ·æœ¬çš„åˆ†å¸ƒä¼šå‘ç”Ÿå˜åŒ–ï¼Œä¹Ÿå°±æ˜¯è¢«åˆ†é”™çš„æ ·æœ¬ä¼šæ›´å¤šçš„å‡ºç°åœ¨ä¸‹ä¸€æ¬¡è®­ç»ƒé›†ä¸­ æ˜ç¡®ä¸€ç‚¹ï¼Œæˆ‘ä»¬è¿­ä»£ä¹Ÿå¥½(Adaboost), å¹¶è¡Œ(RF)ä¹Ÿå¥½ï¼Œåªå’Œè®­ç»ƒé›†æœ‰å…³ï¼Œå’Œæµ‹è¯•é›†çœŸçš„ä¸€æ¯›é’±å…³ç³»éƒ½æ²¡æœ‰å¥½ä¹ˆï¼æˆ‘ä»¬å…ˆæŠŠåŸå§‹æ•°æ®åˆ†ç±»æµ‹è¯•é›†å’Œè®­ç»ƒé›†ï¼Œç„¶åæµ‹è¯•é›†æ”¾ä¸€è¾¹ï¼Œè®­ç»ƒé›†é‡Œé¢å†æŒ‘å­é›†ä½œä¸ºè¿­ä»£ç®—æ³•ç”¨çš„è®­ç»ƒé›†ï¼è¿™ä¸ªå’ŒK-Fold Cross-Validationæ€æƒ³ç±»ä¼¼. Reference article æ€»ç»“ï¼šBootstrap(è‡ªåŠ©æ³•)ï¼ŒBaggingï¼ŒBoosting(æå‡) Baggingï¼ˆBootstrap aggregatingï¼‰ã€éšæœºæ£®æ—ï¼ˆrandom forestsï¼‰ã€AdaBoost æœºå™¨å­¦ä¹ é€‰è®²ï¼šAdaBoostæ–¹æ³•è¯¦è§£ 52caml ç»Ÿè®¡å­¦ä¹ æ–¹æ³• Scikit-Learn ä¸­æ–‡æ–‡æ¡£ æ¦‚ç‡æ ¡å‡† - ç›‘ç£å­¦ä¹ ","categories":[{"name":"machine-learning","slug":"machine-learning","permalink":"http://iequa.com/categories/machine-learning/"}],"tags":[{"name":"machine-learning","slug":"machine-learning","permalink":"http://iequa.com/tags/machine-learning/"}]},{"title":"Ensemble Learning (part1)","slug":"ml/ensumble-boosting-1","date":"2018-04-07T08:08:21.000Z","updated":"2019-10-20T04:30:35.044Z","comments":true,"path":"2018/04/07/ml/ensumble-boosting-1/","link":"","permalink":"http://iequa.com/2018/04/07/ml/ensumble-boosting-1/","excerpt":"Ensemble learningï¼ˆé›†æˆå­¦ä¹ ï¼‰ï¼šæ˜¯ç›®å‰æœºå™¨å­¦ä¹ çš„ä¸€å¤§çƒ­é—¨æ–¹å‘ï¼Œæ‰€è°“é›†æˆå­¦ä¹ ç®€å•ç†è§£å°±æ˜¯æŒ‡é‡‡ç”¨å¤šä¸ªåˆ†ç±»å™¨å¯¹æ•°æ®é›†è¿›è¡Œé¢„æµ‹ï¼Œä»è€Œæé«˜æ•´ä½“åˆ†ç±»å™¨çš„æ³›åŒ–èƒ½åŠ›ã€‚","text":"Ensemble learningï¼ˆé›†æˆå­¦ä¹ ï¼‰ï¼šæ˜¯ç›®å‰æœºå™¨å­¦ä¹ çš„ä¸€å¤§çƒ­é—¨æ–¹å‘ï¼Œæ‰€è°“é›†æˆå­¦ä¹ ç®€å•ç†è§£å°±æ˜¯æŒ‡é‡‡ç”¨å¤šä¸ªåˆ†ç±»å™¨å¯¹æ•°æ®é›†è¿›è¡Œé¢„æµ‹ï¼Œä»è€Œæé«˜æ•´ä½“åˆ†ç±»å™¨çš„æ³›åŒ–èƒ½åŠ›ã€‚ Bootstraping Baggingã€Boostingã€Stacking BootstrapingBootstrapingçš„åç§°æ¥è‡ªæˆè¯­ â€œpull up by your own bootstrapsâ€ï¼Œæ„æ€æ˜¯ä¾é ä½ è‡ªå·±çš„èµ„æºï¼Œå®ƒæ˜¯ä¸€ç§æœ‰æ”¾å›çš„æŠ½æ ·æ–¹æ³•. æ³¨:Bootstrapæœ¬ä¹‰æ˜¯æŒ‡é«˜é´å­å£åé¢çš„æ‚¬æŒ‚ç‰©ã€å°ç¯ã€å¸¦å­ï¼Œæ˜¯ç©¿é´å­æ—¶ç”¨æ‰‹å‘ä¸Šæ‹‰çš„å·¥å…·ã€‚â€œpull up by your own bootstrapsâ€å³â€œé€šè¿‡æ‹‰é´å­è®©è‡ªå·±ä¸Š å‡â€ï¼Œæ„æ€æ˜¯â€œä¸å¯èƒ½å‘ç”Ÿçš„äº‹æƒ…â€ã€‚åæ¥æ„æ€å‘ ç”Ÿäº†è½¬å˜ï¼Œéšå–»â€œä¸éœ€è¦å¤–ç•Œå¸®åŠ©ï¼Œä»…ä¾é è‡ªèº«åŠ› é‡è®©è‡ªå·±å˜å¾—æ›´å¥½â€ bootstraping çš„æ€æƒ³å’Œæ­¥éª¤å¦‚ä¸‹ï¼š ä¸¾ä¸ªğŸŒ°ï¼šæˆ‘è¦ç»Ÿè®¡é±¼å¡˜é‡Œé¢çš„é±¼çš„æ¡æ•°ï¼Œæ€ä¹ˆç»Ÿè®¡å‘¢ï¼Ÿå‡è®¾é±¼å¡˜æ€»å…±æœ‰é±¼1000æ¡ï¼Œæˆ‘æ˜¯å¼€äº†ä¸Šå¸è§†è§’çš„ï¼Œä½†æ˜¯ä½ æ˜¯ä¸çŸ¥é“é‡Œé¢æœ‰å¤šå°‘ã€‚ æ­¥éª¤ï¼š æ‰¿åŒ…é±¼å¡˜ï¼Œä¸è®©åˆ«äººæé±¼(è§„å®šæ€»ä½“åˆ†å¸ƒä¸å˜)ã€‚ è‡ªå·±æé±¼ï¼Œæ100æ¡ï¼Œéƒ½æ‰“ä¸Šæ ‡ç­¾(æ„é€ æ ·æœ¬) æŠŠé±¼æ”¾å›é±¼å¡˜ï¼Œä¼‘æ¯ä¸€æ™š(ä½¿ä¹‹æ··å…¥æ•´ä¸ªé±¼ç¾¤ï¼Œç¡®ä¿ä¹‹åæŠ½æ ·éšæœº) å¼€å§‹æé±¼ï¼Œæ¯æ¬¡æ100æ¡ï¼Œæ•°ä¸€ä¸‹ï¼Œè‡ªå·±æ˜¨å¤©æ ‡è®°çš„é±¼æœ‰å¤šå°‘æ¡ï¼Œå æ¯”å¤šå°‘(ä¸€æ¬¡é‡é‡‡æ ·å–åˆ†å¸ƒ)ã€‚ é‡å¤3ï¼Œ4æ­¥éª¤næ¬¡ã€‚å»ºç«‹åˆ†å¸ƒã€‚ å‡è®¾ä¸€ä¸‹ï¼Œç¬¬ä¸€æ¬¡é‡æ–°æ•é±¼100æ¡ï¼Œå‘ç°é‡Œé¢æœ‰æ ‡è®°çš„é±¼12æ¡ï¼Œè®°ä¸‹ä¸º12%ï¼Œæ”¾å›å»ï¼Œå†æ•é±¼100æ¡ï¼Œå‘ç°æ ‡è®°çš„ä¸º9æ¡ï¼Œè®°ä¸‹9%ï¼Œé‡å¤é‡å¤å¥½å¤šæ¬¡ä¹‹åï¼Œå‡è®¾å–ç½®ä¿¡åŒºé—´95%ï¼Œä½ ä¼šå‘ç°ï¼Œæ¯æ¬¡æ•é±¼å¹³å‡åœ¨10æ¡å·¦å³æœ‰æ ‡è®°ï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬å¯ä»¥å¤§è‡´æ¨æµ‹å‡ºé±¼å¡˜æœ‰1000æ¡å·¦å³ã€‚å…¶å®æ˜¯ä¸€ä¸ªå¾ˆç®€å•çš„ç±»ä¼¼äºä¸€ä¸ªæ¯”ä¾‹é—®é¢˜ã€‚è¿™ä¹Ÿæ˜¯å› ä¸ºæå‡ºè€…Efronç»™ç»Ÿè®¡å­¦é¡¶çº§æœŸåˆŠæŠ•ç¨¿çš„æ—¶å€™è¢«æ‹’ç»çš„ç†ç”±â€”â€œå¤ªç®€å•â€ã€‚è¿™ä¹Ÿå°±è§£é‡Šäº†ï¼Œä¸ºä»€ä¹ˆåœ¨å°æ ·æœ¬çš„æ—¶å€™ï¼Œbootstrapæ•ˆæœè¾ƒå¥½ï¼Œä½ è¿™æ ·æƒ³ï¼Œå¦‚æœæˆ‘æƒ³ç»Ÿè®¡å¤§æµ·é‡Œæœ‰å¤šå°‘é±¼ï¼Œä½ æ ‡è®°100000æ¡ä¹Ÿæ²¡ç”¨å•Šï¼Œå› ä¸ºå®é™…æ•°é‡å¤ªè¿‡åºå¤§ï¼Œä½ å–çš„æ ·æœ¬ç›¸æ¯”äºå¤ªè¿‡æ¸ºå°ï¼Œæœ€å®é™…çš„å°±æ˜¯ï¼Œä½ ä¸‹æ¬¡å†æ•100000çš„æ—¶å€™ï¼Œå‘ç°ä¸€æ¡éƒ½æ²¡æœ‰æ ‡è®°ï¼Œï¼Œï¼Œè¿™TMå°±å°´å°¬äº†ã€‚ã€‚ Bootstrap ç»å…¸è¯­å½• Bootstrapæ˜¯ç°ä»£ç»Ÿè®¡å­¦è¾ƒä¸ºæµè¡Œçš„ä¸€ç§ç»Ÿè®¡æ–¹æ³•ï¼Œåœ¨å°æ ·æœ¬æ—¶æ•ˆæœå¾ˆå¥½ã€‚é€šè¿‡æ–¹å·®çš„ä¼°è®¡å¯ä»¥æ„é€ ç½®ä¿¡åŒºé—´ç­‰ï¼Œå…¶è¿ç”¨èŒƒå›´å¾—åˆ°è¿›ä¸€æ­¥å»¶ä¼¸ã€‚å°±æ˜¯ä¸€ä¸ªåœ¨è‡ªèº«æ ·æœ¬é‡é‡‡æ ·çš„æ–¹æ³•æ¥ä¼°è®¡çœŸå®åˆ†å¸ƒçš„é—®é¢˜ å½“æˆ‘ä»¬ä¸çŸ¥é“æ ·æœ¬åˆ†å¸ƒçš„æ—¶å€™ï¼Œbootstrapæ–¹æ³•æœ€æœ‰ç”¨ã€‚ Ensemble learningäº†è§£ boosting å’Œ bagging ä¹‹å‰ï¼Œå…ˆäº†è§£ä¸€ä¸‹ä»€ä¹ˆæ˜¯ ensembleï¼Œä¸€å¥è¯ï¼Œä¸‰ä¸ªè‡­çš®åŒ é¡¶ä¸ªè¯¸è‘›äº®ï¼Œä¸€ç®­æ˜“æŠ˜åç®­éš¾æŠ˜ï¼Œåƒé‡Œä¹‹å ¤æºƒäºèšç©´ â€¦ğŸ˜„ğŸ˜„ğŸ˜„ ï¼Œåœ¨åˆ†ç±»çš„è¡¨ç°ä¸Šå°±æ˜¯ï¼Œå¤šä¸ªå¼±åˆ†ç±»å™¨ç»„åˆå˜æˆå¼ºåˆ†ç±»å™¨ã€‚ å‡è®¾å„å¼±åˆ†ç±»å™¨é—´å…·æœ‰ä¸€å®šå·®å¼‚æ€§ï¼ˆå¦‚ä¸åŒçš„ç®—æ³•ï¼Œæˆ–ç›¸åŒç®—æ³•ä¸åŒå‚æ•°é…ç½®ï¼‰ï¼Œè¿™ä¼šå¯¼è‡´ç”Ÿæˆçš„åˆ†ç±»å†³ç­–è¾¹ç•Œä¸åŒï¼Œä¹Ÿå°±æ˜¯è¯´å®ƒä»¬åœ¨å†³ç­–æ—¶ä¼šçŠ¯ä¸åŒçš„é”™è¯¯ã€‚å°†å®ƒä»¬ç»“åˆåèƒ½å¾—åˆ°æ›´åˆç†çš„è¾¹ç•Œï¼Œå‡å°‘æ•´ä½“é”™è¯¯ï¼Œå®ç°æ›´å¥½çš„åˆ†ç±»æ•ˆæœã€‚ Bagging (bootstrap aggregation) baggingï¼šä»è®­ç»ƒé›†ä»è¿›è¡Œå­æŠ½æ ·ç»„æˆæ¯ä¸ªåŸºæ¨¡å‹æ‰€éœ€è¦çš„å­è®­ç»ƒé›†ï¼Œå¯¹æ‰€æœ‰åŸºæ¨¡å‹é¢„æµ‹çš„ç»“æœè¿›è¡Œç»¼åˆäº§ç”Ÿæœ€ç»ˆçš„é¢„æµ‹ç»“æœ,è‡³äºä¸ºä»€ä¹ˆå«bootstrap aggregationï¼Œå› ä¸ºå®ƒæŠ½å–è®­ç»ƒæ ·æœ¬çš„æ—¶å€™é‡‡ç”¨çš„å°±æ˜¯bootstrapçš„æ–¹æ³•ï¼ Bagging ç­–ç•¥è¿‡ç¨‹ ğŸ˜„ : ä»æ ·æœ¬é›†ä¸­é‡é‡‡æ ·(æœ‰é‡å¤çš„)é€‰å‡ºnä¸ªæ ·æœ¬ åœ¨æ‰€æœ‰å±æ€§ä¸Šï¼Œå¯¹è¿™nä¸ªæ ·æœ¬å»ºç«‹åˆ†ç±»å™¨ (ID3ã€C4.5ã€CARTã€SVMã€Logisticå›å½’ç­‰) é‡å¤ä»¥ä¸Šä¸¤æ­¥mæ¬¡ï¼Œå³è·å¾—äº†mä¸ªåˆ†ç±»å™¨ å°†æ•°æ®æ”¾åœ¨è¿™mä¸ªåˆ†ç±»å™¨ä¸Šï¼Œæœ€åæ ¹æ®è¿™mä¸ªåˆ†ç±»å™¨çš„æŠ•ç¥¨ç»“æœï¼Œå†³å®šæ•°æ®å±äºå“ªä¸€ç±». æŠ•ç¥¨æœºåˆ¶ (å¤šæ•°æœä»å°‘æ•°, æ°‘ä¸»æ”¿æ²») çœ‹åˆ°åº•åˆ†åˆ°å“ªä¸€ç±»(åˆ†ç±»é—®é¢˜) Bagging ä»£è¡¨ç®—æ³• - Random Forest éšæœºæ£®æ—ï¼Œå®ƒä¸ä»…å¯ä»¥ç”¨æ¥åšåˆ†ç±»ï¼Œä¹Ÿå¯ç”¨æ¥åšå›å½’å³é¢„æµ‹ï¼Œä¸€èˆ¬éšæœºæ£®æ—æœºç”±å¤šä¸ªå†³ç­–æ ‘æ„æˆï¼Œç›¸æ¯”äºå•ä¸ªå†³ç­–æ ‘ç®—æ³•ï¼Œå®ƒåˆ†ç±»ã€é¢„æµ‹æ•ˆæœæ›´å¥½ï¼Œä¸å®¹æ˜“å‡ºç°è¿‡åº¦æ‹Ÿåˆçš„æƒ…å†µã€‚ 1.è®­ç»ƒæ ·æœ¬é€‰æ‹©æ–¹é¢çš„Randomï¼š Bootstrapæ–¹æ³•éšæœºé€‰æ‹©å­æ ·æœ¬ 2.ç‰¹å¾é€‰æ‹©æ–¹é¢çš„Randomï¼š å±æ€§é›†ä¸­éšæœºé€‰æ‹©kä¸ªå±æ€§ï¼Œæ¯ä¸ªæ ‘èŠ‚ç‚¹åˆ†è£‚æ—¶ï¼Œä»è¿™éšæœºçš„kä¸ªå±æ€§ï¼Œé€‰æ‹©æœ€ä¼˜çš„(å¦‚ä½•é€‰æ‹©æœ€ä¼˜åˆæœ‰å„ç§æœ€å¤§å¢ç›Šçš„æ–¹æ³•ï¼Œä¸åœ¨æœ¬æ–‡è®¨è®ºèŒƒå›´å†…)ã€‚ å†³ç­–æ ‘ å†³ç­–æ ‘å¯¹è®­ç»ƒæ ·æœ¬æœ‰è‰¯å¥½çš„åˆ†ç±»èƒ½åŠ›ï¼Œåªè¦æˆ‘ä»¬çš„å±‚æ•°ä¸åŠ é™åˆ¶ï¼Œæˆ‘ä»¬ç”šè‡³å¯ä»¥æŠŠå®ƒåˆ†çš„æ²¡æœ‰ä»»ä½•è¯¯å·®ï¼Œè¿™æ ·å¯èƒ½å¯¼è‡´ä½ çš„æ³›åŒ–èƒ½åŠ›å¾ˆå¼±ã€‚ ç¼“è§£çš„æ–¹æ³•å°±æ˜¯ 1. å‰ªæ 2. éšæœºæ£®æ— å‰ªæ æˆ‘è¿˜æ²¡ç”¨è¿‡ï¼Œæ‰€ä»¥æˆ‘ä»¬çœ‹å¸¸ç”¨çš„ éšæœºæ£®æ— Romdom Forest å†³ç­–æ ‘ ï¼š ç‰¹å¾é€‰æ‹© ID3 ä»…å…·æœ‰æ•™å­¦ä»·å€¼ gini ç³»æ•°ï¼Œä½œä¸ºæŒ‡æ ‡æ¯”è¾ƒå¤šï¼Œåœ¨å®è·µå½“ä¸­ Random Forest æ„é€ æµç¨‹ ç”¨ Random(è®­ç»ƒæ ·æœ¬ç”¨Bootstrapæ–¹æ³•ï¼Œé€‰æ‹©åˆ†ç¦»å¶å­èŠ‚ç‚¹ç”¨ä¸Šé¢çš„2)çš„æ–¹å¼æ„é€ ä¸€æ£µå†³ç­–æ ‘(CART) ç”¨1çš„æ–¹æ³•æ„é€ å¾ˆå¤šå†³ç­–æ ‘, ä¸å‰ªæ, è®¸å¤šå†³ç­–æ ‘æ„æˆä¸€ç‰‡æ£®æ—ï¼Œå†³ç­–æ ‘ä¹‹é—´æ²¡æœ‰è”ç³» æµ‹è¯•æ•°æ®è¿›å…¥æ¯ä¸€æ£µå†³ç­–æ ‘ï¼Œæ¯æ£µæ ‘åšå‡ºè‡ªå·±çš„åˆ¤æ–­ï¼Œç„¶åæŠ•ç¥¨é€‰å‡ºæœ€ç»ˆæ‰€å±ç±»åˆ«(é»˜è®¤æ¯æ£µæ ‘æƒé‡ä¸€è‡´) Random Forest ä¼˜ç‚¹ ä¸å®¹æ˜“å‡ºç°è¿‡æ‹Ÿåˆï¼Œå› ä¸ºé€‰æ‹©è®­ç»ƒæ ·æœ¬çš„æ—¶å€™å°±ä¸æ˜¯å…¨éƒ¨æ ·æœ¬ã€‚ æ—¢å¯å¤„ç†å±æ€§ä¸ºç¦»æ•£å€¼çš„é‡ï¼Œæ¯”å¦‚ID3ç®—æ³•æ¥æ„é€ æ ‘ï¼Œä¹Ÿå¯ä»¥å¤„ç†å±æ€§ä¸ºè¿ç»­å€¼çš„é‡ï¼Œæ¯”å¦‚C4.5ç®—æ³•æ¥æ„é€ æ ‘ å¯¹äºé«˜ç»´æ•°æ®é›†çš„å¤„ç†èƒ½åŠ›ä»¤äººå…´å¥‹ï¼Œå®ƒå¯ä»¥å¤„ç†æˆåƒä¸Šä¸‡çš„è¾“å…¥å˜é‡ï¼Œå¹¶ç¡®å®šæœ€é‡è¦çš„å˜é‡ï¼Œå› æ­¤è¢«è®¤ä¸ºæ˜¯ä¸€ä¸ªä¸é”™çš„é™ç»´æ–¹æ³•ã€‚è¯¥æ¨¡å‹èƒ½å¤Ÿè¾“å‡ºå˜é‡çš„é‡è¦æ€§ç¨‹åº¦ï¼Œè¿™æ˜¯ä¸€ä¸ªéå¸¸ä¾¿åˆ©çš„åŠŸèƒ½ã€‚ åˆ†ç±»ä¸å¹³è¡¡çš„æƒ…å†µæ—¶ï¼Œéšæœºæ£®æ—èƒ½å¤Ÿæä¾›å¹³è¡¡æ•°æ®é›†è¯¯å·®çš„æœ‰æ•ˆæ–¹æ³• Random Forest ç¼ºç‚¹ éšæœºæ£®æ—åœ¨è§£å†³å›å½’é—®é¢˜æ—¶å¹¶æ²¡æœ‰åƒå®ƒåœ¨åˆ†ç±»ä¸­è¡¨ç°çš„é‚£ä¹ˆå¥½ï¼Œè¿™æ˜¯å› ä¸ºå®ƒå¹¶ä¸èƒ½ç»™å‡ºä¸€ä¸ªè¿ç»­å‹çš„è¾“å‡ºã€‚å½“è¿›è¡Œå›å½’æ—¶ï¼Œéšæœºæ£®æ—ä¸èƒ½å¤Ÿä½œå‡ºè¶…è¶Šè®­ç»ƒé›†æ•°æ®èŒƒå›´çš„é¢„æµ‹ï¼Œè¿™å¯èƒ½å¯¼è‡´åœ¨å¯¹æŸäº›è¿˜æœ‰ç‰¹å®šå™ªå£°çš„æ•°æ®è¿›è¡Œå»ºæ¨¡æ—¶å‡ºç°è¿‡åº¦æ‹Ÿåˆã€‚ å¯¹äºè®¸å¤šç»Ÿè®¡å»ºæ¨¡è€…æ¥è¯´ï¼Œéšæœºæ£®æ—ç»™äººçš„æ„Ÿè§‰åƒæ˜¯ä¸€ä¸ªé»‘ç›’å­â€”â€”ä½ å‡ ä¹æ— æ³•æ§åˆ¶æ¨¡å‹å†…éƒ¨çš„è¿è¡Œï¼Œåªèƒ½åœ¨ä¸åŒçš„å‚æ•°å’Œéšæœºç§å­ä¹‹é—´è¿›è¡Œå°è¯•ã€‚ ä¼˜ç¼ºç‚¹ï¼Œéœ€è¦ä¸æ°ç¥å•†è®¨å†? Reference article Baggingï¼ˆBootstrap aggregatingï¼‰ã€éšæœºæ£®æ—ï¼ˆrandom forestsï¼‰ã€AdaBoost Bootstrap(è‡ªåŠ©æ³•)ï¼ŒBaggingï¼ŒBoosting(æå‡)","categories":[{"name":"machine-learning","slug":"machine-learning","permalink":"http://iequa.com/categories/machine-learning/"}],"tags":[{"name":"Ensemble","slug":"Ensemble","permalink":"http://iequa.com/tags/Ensemble/"}]},{"title":"ä¸€èˆ¬è‹±æ–‡è½åŠ›ç·´ç¿’æ–¹æ³•","slug":"English/english-cindy-listening-duoyi","date":"2018-01-28T14:47:16.000Z","updated":"2019-10-20T04:30:35.033Z","comments":true,"path":"2018/01/28/English/english-cindy-listening-duoyi/","link":"","permalink":"http://iequa.com/2018/01/28/English/english-cindy-listening-duoyi/","excerpt":"å¤šç›Š ä»¥åŠ ä¸€èˆ¬è‹±æ–‡è½åŠ›åŠ å¼· | å’ŒCindyå­¸è‹±æ–‡ ç¬”è®°","text":"å¤šç›Š ä»¥åŠ ä¸€èˆ¬è‹±æ–‡è½åŠ›åŠ å¼· | å’ŒCindyå­¸è‹±æ–‡ ç¬”è®° ç·´ç¿’è½åŠ›Useful Websites News In Levels Umano Lyrics Training Listen to Music Lyrics Training Taylor Swiftã€Miley Cyrusã€Blake Sheltonâ€¦ Sitcom and Movies Friends How I met your Mother Titanic Hobbit Reference å¤šç›Š è‹±æ–‡è½åŠ›åŠ å¼· å’ŒCindyå­¸è‹±æ–‡","categories":[{"name":"English","slug":"English","permalink":"http://iequa.com/categories/English/"}],"tags":[{"name":"english","slug":"english","permalink":"http://iequa.com/tags/english/"}]},{"title":"Python copy & deepcopy","slug":"python/language/py-language-13-copy","date":"2018-01-24T07:00:21.000Z","updated":"2019-10-20T04:30:35.007Z","comments":true,"path":"2018/01/24/python/language/py-language-13-copy/","link":"","permalink":"http://iequa.com/2018/01/24/python/language/py-language-13-copy/","excerpt":"å¯¹è±¡çš„èµ‹å€¼ï¼Œæ‹·è´ï¼ˆæ·±/æµ…æ‹·è´ï¼‰ä¹‹é—´æ˜¯æœ‰å·®å¼‚çš„ï¼Œå¦‚æœä½¿ç”¨ä¸å½“ï¼Œå¯èƒ½äº§ç”Ÿæ„å¤–çš„ç»“æœ.","text":"å¯¹è±¡çš„èµ‹å€¼ï¼Œæ‹·è´ï¼ˆæ·±/æµ…æ‹·è´ï¼‰ä¹‹é—´æ˜¯æœ‰å·®å¼‚çš„ï¼Œå¦‚æœä½¿ç”¨ä¸å½“ï¼Œå¯èƒ½äº§ç”Ÿæ„å¤–çš„ç»“æœ. idä»€ä¹ˆæ˜¯idï¼Ÿä¸€ä¸ªå¯¹è±¡çš„idå€¼åœ¨CPythonè§£é‡Šå™¨é‡Œå°±ä»£è¡¨å®ƒåœ¨å†…å­˜ä¸­çš„`åœ°å€ import copya=[1,2,3]b=aprint(id(a))print(id(b))print(id(a)==id(b)) #é™„å€¼åï¼Œä¸¤è€…çš„idç›¸åŒï¼Œä¸ºtrueã€‚b[0]=222222 # æ­¤æ—¶ï¼Œæ”¹å˜bçš„ç¬¬ä¸€ä¸ªå€¼ï¼Œä¹Ÿä¼šå¯¼è‡´aå€¼æ”¹å˜ã€‚print(a,b) 4449594888 4449594888 True [222222, 2, 3] [222222, 2, 3] æµ…æ‹·è´å½“ä½¿ç”¨æµ…æ‹·è´æ—¶ï¼Œpython åªæ˜¯æ‹·è´äº†æœ€å¤–å›´çš„å¯¹è±¡æœ¬èº«ï¼Œå†…éƒ¨çš„å…ƒç´ éƒ½åªæ˜¯æ‹·è´äº†ä¸€ä¸ªå¼•ç”¨è€Œå·² import copya=[1,2,3]c=copy.copy(a) #æ‹·è´äº†açš„å¤–å›´å¯¹è±¡æœ¬èº«,print(id(c))print(id(a)==id(c)) #id æ”¹å˜ ä¸ºfalsec[1]=22222 #æ­¤æ—¶ï¼Œæˆ‘å»æ”¹å˜cçš„ç¬¬äºŒä¸ªå€¼æ—¶ï¼Œaä¸ä¼šè¢«æ”¹å˜ã€‚print(a,c)# [1, 2, 3] [1, 22222, 3] #aå€¼ä¸å˜,cçš„ç¬¬äºŒä¸ªå€¼å˜äº†ï¼Œè¿™å°±æ˜¯copyå’Œâ€˜==â€™çš„ä¸åŒ 4449594440 False [1, 2, 3] [1, 22222, 3] æ·±æ‹·è´deepcopy å¯¹å¤–å›´å’Œå†…éƒ¨å…ƒç´ éƒ½è¿›è¡Œäº†æ‹·è´å¯¹è±¡æœ¬èº«ï¼Œè€Œä¸æ˜¯å¯¹è±¡çš„å¼•ç”¨ #copy.copy()a=[1,2,[3,4]] #ç¬¬ä¸‰ä¸ªå€¼ä¸ºåˆ—è¡¨[3,4],å³å†…éƒ¨å…ƒç´ d=copy.copy(a) #æµ…æ‹·è´aä¸­çš„[3ï¼Œ4]å†…éƒ¨å…ƒç´ çš„å¼•ç”¨ï¼Œéå†…éƒ¨å…ƒç´ å¯¹è±¡çš„æœ¬èº«&gt;&gt;&gt; id(a)==id(d)False&gt;&gt;&gt; id(a[2])==id(d[2])True&gt;&gt;&gt; a[2][0]=3333 #æ”¹å˜aä¸­å†…éƒ¨åŸå±åˆ—è¡¨ä¸­çš„ç¬¬ä¸€ä¸ªå€¼&gt;&gt;&gt; d #è¿™æ—¶dä¸­çš„åˆ—è¡¨å…ƒç´ ä¹Ÿä¼šè¢«æ”¹å˜[1, 2, [3333, 4]]#copy.deepcopy()&gt;&gt;&gt; e=copy.deepcopy(a) #eä¸ºæ·±æ‹·è´äº†a&gt;&gt;&gt; a[2][0]=333 #æ”¹å˜aä¸­å†…éƒ¨å…ƒç´ åˆ—è¡¨ç¬¬ä¸€ä¸ªçš„å€¼&gt;&gt;&gt; e[1, 2, [3333, 4]] #å› ä¸ºæ—¶æ·±æ‹·è´ï¼Œè¿™æ—¶eä¸­å†…éƒ¨å…ƒç´ []åˆ—è¡¨çš„å€¼ä¸ä¼šå› ä¸ºaä¸­çš„å€¼æ”¹å˜è€Œæ”¹å˜&gt;&gt;&gt; Reference docs.python.org python morvanzhou python liaoxuefeng","categories":[{"name":"python","slug":"python","permalink":"http://iequa.com/categories/python/"}],"tags":[{"name":"python","slug":"python","permalink":"http://iequa.com/tags/python/"}]},{"title":"Python try â€¦ except â€¦ as â€¦","slug":"python/language/py-language-12-try-exception","date":"2018-01-24T06:02:21.000Z","updated":"2019-10-20T04:30:35.007Z","comments":true,"path":"2018/01/24/python/language/py-language-12-try-exception/","link":"","permalink":"http://iequa.com/2018/01/24/python/language/py-language-12-try-exception/","excerpt":"try:, except â€¦ as â€¦:","text":"try:, except â€¦ as â€¦: é”™è¯¯å¤„ç†è¾“å‡ºé”™è¯¯ï¼štry:, except ... as ...: çœ‹å¦‚ä¸‹ä»£ç  try: file=open(&#x27;eeee.txt&#x27;,&#x27;r&#x27;) #ä¼šæŠ¥é”™çš„ä»£ç except Exception as e: # å°†æŠ¥é”™å­˜å‚¨åœ¨ e ä¸­ print(e) [Errno 2] No such file or directory: &#39;eeee.txt&#39; try: file=open(&#x27;eeee.txt&#x27;,&#x27;r+&#x27;)except Exception as e: print(e) response = input(&#x27;do you want to create a new file:&#x27;) if response==&#x27;y&#x27;: file=open(&#x27;eeee.txt&#x27;,&#x27;w&#x27;) else: passelse: file.write(&#x27;ssss&#x27;) file.close() [Errno 2] No such file or directory: &#39;eeee.txt&#39; do you want to create a new file:y Reference docs.python.org python morvanzhou python liaoxuefeng","categories":[{"name":"python","slug":"python","permalink":"http://iequa.com/categories/python/"}],"tags":[{"name":"python","slug":"python","permalink":"http://iequa.com/tags/python/"}]},{"title":"Python å‡½æ•°å¼ç¼–ç¨‹ zipã€lambdaã€map...","slug":"python/language/py-language-11-zip-lambda-map","date":"2018-01-24T06:00:21.000Z","updated":"2019-10-20T04:30:35.005Z","comments":true,"path":"2018/01/24/python/language/py-language-11-zip-lambda-map/","link":"","permalink":"http://iequa.com/2018/01/24/python/language/py-language-11-zip-lambda-map/","excerpt":"zipã€lambdaã€mapâ€¦","text":"zipã€lambdaã€mapâ€¦ zipzip å‡½æ•°æ¥å—ä»»æ„å¤šä¸ªï¼ˆåŒ…æ‹¬0ä¸ªå’Œ1ä¸ªï¼‰åºåˆ—ä½œä¸ºå‚æ•°ï¼Œåˆå¹¶åè¿”å›ä¸€ä¸ªtupleåˆ—è¡¨ a=[1,2,3]b=[4,5,6]ab=zip(a,b)print(list(ab)) #éœ€è¦åŠ listæ¥å¯è§†åŒ–è¿™ä¸ªåŠŸèƒ½ [(1, 4), (2, 5), (3, 6)] a=[1,2,3]b=[4,5,6]ab=zip(a,b)print(list(ab))for i,j in zip(a,b): print(i/2,j*2) [(1, 4), (2, 5), (3, 6)] 0.5 8 1.0 10 1.5 12 lambdalambda å®šä¹‰ä¸€ä¸ªç®€å•çš„å‡½æ•°ï¼Œå®ç°ç®€åŒ–ä»£ç çš„åŠŸèƒ½ï¼Œçœ‹ä»£ç ä¼šæ›´å¥½ç†è§£ã€‚ fun = lambda x,y : x+y, å†’å·å‰çš„x,yä¸ºè‡ªå˜é‡ï¼Œå†’å·åx+yä¸ºå…·ä½“è¿ç®— fun= lambda x,y:x+yx=int(input(&#x27;x=&#x27;)) #è¿™é‡Œè¦å®šä¹‰intæ•´æ•°ï¼Œå¦åˆ™ä¼šé»˜è®¤ä¸ºå­—ç¬¦ä¸²y=int(input(&#x27;y=&#x27;))print(fun(x,y)) x=4 y=6 10 mapmap æ˜¯æŠŠ å‡½æ•° å’Œ å‚æ•° ç»‘å®šåœ¨ä¸€èµ·. def fun(x,y): return (x+y)print(list(map(fun,[1],[2])))list(map(fun,[1,2],[3,4])) [3] [4, 6] Reference docs.python.org python morvanzhou python liaoxuefeng","categories":[{"name":"python","slug":"python","permalink":"http://iequa.com/categories/python/"}],"tags":[{"name":"python","slug":"python","permalink":"http://iequa.com/tags/python/"}]},{"title":"Matplotlib Bar","slug":"python/matplotlib/py-matplotlib-9-bar","date":"2018-01-24T05:20:21.000Z","updated":"2019-10-20T04:30:35.011Z","comments":true,"path":"2018/01/24/python/matplotlib/py-matplotlib-9-bar/","link":"","permalink":"http://iequa.com/2018/01/24/python/matplotlib/py-matplotlib-9-bar/","excerpt":"ä¸Šç¯‡å­¦ä¹ äº†å¦‚ä½• plot Scatterï¼Œä»Šå¤©æˆ‘ä»¬è®²è¿°å¦‚ä½• plot Bar","text":"ä¸Šç¯‡å­¦ä¹ äº†å¦‚ä½• plot Scatterï¼Œä»Šå¤©æˆ‘ä»¬è®²è¿°å¦‚ä½• plot Bar ä»Šæ—¥ç›®æ ‡ : æŸ±çŠ¶å›¾åˆ†æˆä¸Šä¸‹ä¸¤éƒ¨åˆ†ï¼Œæ¯ä¸€ä¸ªæŸ±ä½“ä¸Šéƒ½æœ‰ç›¸åº”çš„æ•°å€¼æ ‡æ³¨ï¼Œå¹¶ä¸”å–æ¶ˆåæ ‡è½´çš„æ˜¾ç¤º. ç”ŸæˆåŸºæœ¬å›¾å½¢å‘ä¸Šå‘ä¸‹ç”Ÿæˆ12ä¸ªæ•°æ®ï¼ŒX ä¸º [0,11] çš„æ•´æ•° ï¼ŒYæ˜¯å‡åŒ€åˆ†å¸ƒçš„éšæœºæ•°æ®ã€‚ ä½¿ç”¨çš„å‡½æ•°æ˜¯plt.barï¼Œå‚æ•°ä¸ºXå’ŒYï¼š import matplotlib.pyplot as pltimport numpy as npn = 12X = np.arange(n)Y1 = (1 - X / float(n)) * np.random.uniform(0.5, 1.0, n)Y2 = (1 - X / float(n)) * np.random.uniform(0.5, 1.0, n)plt.bar(X, +Y1)plt.bar(X, -Y2)plt.xlim(-.5, n)plt.xticks(())plt.ylim(-1.25, 1.25)plt.yticks(())plt.show() åŠ é¢œè‰²å’Œæ•°æ®ç”¨facecolorè®¾ç½®ä¸»ä½“é¢œè‰²ï¼Œedgecolorè®¾ç½®è¾¹æ¡†é¢œè‰²ä¸ºç™½è‰²ï¼Œ plt.bar(X, +Y1, facecolor=&#x27;#9999ff&#x27;, edgecolor=&#x27;white&#x27;)plt.bar(X, -Y2, facecolor=&#x27;#ff9999&#x27;, edgecolor=&#x27;white&#x27;)plt.show() æ¥ä¸‹æ¥æˆ‘ä»¬ç”¨å‡½æ•°plt.textåˆ†åˆ«åœ¨æŸ±ä½“ä¸Šæ–¹ï¼ˆä¸‹æ–¹ï¼‰åŠ ä¸Šæ•°å€¼ï¼Œç”¨%.2fä¿ç•™ä¸¤ä½å°æ•°ï¼Œæ¨ªå‘å±…ä¸­å¯¹é½ha=&#39;center&#39;ï¼Œçºµå‘åº•éƒ¨ï¼ˆé¡¶éƒ¨ï¼‰å¯¹é½va=&#39;bottom&#39;ï¼š plt.bar(X, +Y1, facecolor=&#x27;#9999ff&#x27;, edgecolor=&#x27;white&#x27;)plt.bar(X, -Y2, facecolor=&#x27;#ff9999&#x27;, edgecolor=&#x27;white&#x27;)for x, y in zip(X, Y1): # ha: horizontal alignment # va: vertical alignment plt.text(x + 0.4, y + 0.05, &#x27;%.2f&#x27; % y, ha=&#x27;center&#x27;, va=&#x27;bottom&#x27;)for x, y in zip(X, Y2): # ha: horizontal alignment # va: vertical alignment plt.text(x + 0.4, -y - 0.05, &#x27;%.2f&#x27; % y, ha=&#x27;center&#x27;, va=&#x27;top&#x27;) plt.show() Reference matplotlib.org matplotlib docs morvanzhou","categories":[{"name":"python","slug":"python","permalink":"http://iequa.com/categories/python/"}],"tags":[{"name":"Matplotlib","slug":"Matplotlib","permalink":"http://iequa.com/tags/Matplotlib/"}]},{"title":"Matplotlib Scatter","slug":"python/matplotlib/py-matplotlib-8-scatter","date":"2018-01-24T03:08:21.000Z","updated":"2019-10-20T04:30:35.012Z","comments":true,"path":"2018/01/24/python/matplotlib/py-matplotlib-8-scatter/","link":"","permalink":"http://iequa.com/2018/01/24/python/matplotlib/py-matplotlib-8-scatter/","excerpt":"ä¸Šç¯‡å­¦ä¹ äº†å¦‚ä½• plot çº¿ï¼Œä»Šå¤©å­¦ä¹ å¦‚ä½• plot Scatter æ•£ç‚¹å›¾","text":"ä¸Šç¯‡å­¦ä¹ äº†å¦‚ä½• plot çº¿ï¼Œä»Šå¤©å­¦ä¹ å¦‚ä½• plot Scatter æ•£ç‚¹å›¾ å¼•å…¥æ¨¡å—numpyç”¨æ¥äº§ç”Ÿä¸€äº›éšæœºæ•°æ®ã€‚ç”Ÿæˆ1024ä¸ªå‘ˆæ ‡å‡†æ­£æ€åˆ†å¸ƒçš„äºŒç»´æ•°æ®ç»„ (å¹³å‡æ•°æ˜¯0ï¼Œæ–¹å·®ä¸º1) ä½œä¸ºä¸€ä¸ªæ•°æ®é›†ï¼Œå¹¶å›¾åƒåŒ–è¿™ä¸ªæ•°æ®é›†ã€‚æ¯ä¸€ä¸ªç‚¹çš„é¢œè‰²å€¼ç”¨Tæ¥è¡¨ç¤ºï¼š import matplotlib.pyplot as pltimport numpy as npn = 1024 # data sizeX = np.random.normal(0, 1, n) # æ¯ä¸€ä¸ªç‚¹çš„Xå€¼Y = np.random.normal(0, 1, n) # æ¯ä¸€ä¸ªç‚¹çš„Yå€¼T = np.arctan2(Y,X) # for color value æ•°æ®é›†ç”Ÿæˆå®Œæ¯•ï¼Œç°åœ¨æ¥ç”¨ scatter plot è¿™ä¸ªç‚¹é›† è¾“å…¥Xå’ŒYä½œä¸ºlocationï¼Œsize=75ï¼Œé¢œè‰²ä¸ºTï¼Œcolor map ç”¨é»˜è®¤å€¼ï¼Œé€æ˜åº¦alpha ä¸º 50%ã€‚ xè½´æ˜¾ç¤ºèŒƒå›´å®šä½(-1.5ï¼Œ1.5)ï¼Œå¹¶ç”¨xtick() å‡½æ•°æ¥éšè—xåæ ‡è½´ï¼Œyè½´åŒç†ï¼š plt.scatter(X, Y, s=75, c=T, alpha=.5)plt.xlim(-1.5, 1.5)plt.xticks(()) # ignore xticksplt.ylim(-1.5, 1.5)plt.yticks(()) # ignore yticksplt.show() Reference matplotlib.org matplotlib docs morvanzhou","categories":[{"name":"python","slug":"python","permalink":"http://iequa.com/categories/python/"}],"tags":[{"name":"Matplotlib","slug":"Matplotlib","permalink":"http://iequa.com/tags/Matplotlib/"}]},{"title":"Matplotlib Tick bbox","slug":"python/matplotlib/py-matplotlib-7-tick","date":"2018-01-23T09:08:21.000Z","updated":"2019-10-20T04:30:35.011Z","comments":true,"path":"2018/01/23/python/matplotlib/py-matplotlib-7-tick/","link":"","permalink":"http://iequa.com/2018/01/23/python/matplotlib/py-matplotlib-7-tick/","excerpt":"å›¾ä¸­çš„å†…å®¹è¾ƒå¤šï¼Œå¯é€šè¿‡è®¾ç½®ç›¸å…³å†…å®¹çš„é€æ˜åº¦æ¥ä½¿å›¾ç‰‡æ›´æ˜“äºè§‚å¯Ÿï¼Œä¹Ÿå³æ˜¯æœ¬èŠ‚ä¸­çš„bboxå‚æ•°è®¾ç½®æ¥è°ƒèŠ‚å›¾åƒä¿¡æ¯.","text":"å›¾ä¸­çš„å†…å®¹è¾ƒå¤šï¼Œå¯é€šè¿‡è®¾ç½®ç›¸å…³å†…å®¹çš„é€æ˜åº¦æ¥ä½¿å›¾ç‰‡æ›´æ˜“äºè§‚å¯Ÿï¼Œä¹Ÿå³æ˜¯æœ¬èŠ‚ä¸­çš„bboxå‚æ•°è®¾ç½®æ¥è°ƒèŠ‚å›¾åƒä¿¡æ¯. ç”Ÿæˆå›¾å½¢import matplotlib.pyplot as pltimport numpy as npx = np.linspace(-3, 3, 50)y = 0.1*xplt.figure()# åœ¨ plt 2.0.2 æˆ–æ›´é«˜çš„ç‰ˆæœ¬ä¸­, è®¾ç½® zorder ç»™ plot åœ¨ z è½´æ–¹å‘æ’åºplt.plot(x, y, linewidth=10, zorder=1)plt.ylim(-2, 2)ax = plt.gca()ax.spines[&#x27;right&#x27;].set_color(&#x27;none&#x27;)ax.spines[&#x27;top&#x27;].set_color(&#x27;none&#x27;)ax.xaxis.set_ticks_position(&#x27;bottom&#x27;)ax.spines[&#x27;bottom&#x27;].set_position((&#x27;data&#x27;, 0))ax.yaxis.set_ticks_position(&#x27;left&#x27;)ax.spines[&#x27;left&#x27;].set_position((&#x27;data&#x27;, 0))plt.show() è°ƒæ•´åæ ‡ bboxç„¶åå¯¹è¢«é®æŒ¡çš„å›¾åƒè°ƒèŠ‚ç›¸å…³é€æ˜åº¦ï¼Œæœ¬ä¾‹ä¸­è®¾ç½® xè½´ å’Œ yè½´ çš„åˆ»åº¦æ•°å­—è¿›è¡Œé€æ˜åº¦è®¾ç½® å…¶ä¸­label.set_fontsize(12)é‡æ–°è°ƒèŠ‚å­—ä½“å¤§å°ï¼Œbboxè®¾ç½®ç›®çš„å†…å®¹çš„é€æ˜åº¦ç›¸å…³å‚æ•°ï¼Œfacecolorè°ƒèŠ‚ box å‰æ™¯è‰²ï¼Œedgecolor è®¾ç½®è¾¹æ¡†ï¼Œ æœ¬å¤„è®¾ç½®è¾¹æ¡†ä¸ºæ— ï¼Œalphaè®¾ç½®é€æ˜åº¦. for label in ax.get_xticklabels() + ax.get_yticklabels(): label.set_fontsize(12) # åœ¨ plt 2.0.2 æˆ–æ›´é«˜çš„ç‰ˆæœ¬ä¸­, è®¾ç½® zorder ç»™ plot åœ¨ z è½´æ–¹å‘æ’åº label.set_bbox(dict(facecolor=&#x27;white&#x27;, edgecolor=&#x27;None&#x27;, alpha=0.7, zorder=2))plt.show() Reference matplotlib.org matplotlib docs morvanzhou","categories":[{"name":"python","slug":"python","permalink":"http://iequa.com/categories/python/"}],"tags":[{"name":"Matplotlib","slug":"Matplotlib","permalink":"http://iequa.com/tags/Matplotlib/"}]},{"title":"Matplotlib Annotation","slug":"python/matplotlib/py-matplotlib-6-Annotation","date":"2018-01-23T08:38:21.000Z","updated":"2019-10-20T04:30:35.012Z","comments":true,"path":"2018/01/23/python/matplotlib/py-matplotlib-6-Annotation/","link":"","permalink":"http://iequa.com/2018/01/23/python/matplotlib/py-matplotlib-6-Annotation/","excerpt":"å½“å›¾çº¿ä¸­æŸäº›ç‰¹æ®Šåœ°æ–¹éœ€è¦æ ‡æ³¨æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ annotation. matplotlib ä¸­çš„ annotation æœ‰ä¸¤ç§æ–¹æ³•ï¼Œ ä¸€ç§æ˜¯ç”¨ plt é‡Œé¢çš„ annotateï¼Œä¸€ç§æ˜¯ç›´æ¥ç”¨ plt é‡Œé¢çš„ text æ¥å†™æ ‡æ³¨.","text":"å½“å›¾çº¿ä¸­æŸäº›ç‰¹æ®Šåœ°æ–¹éœ€è¦æ ‡æ³¨æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ annotation. matplotlib ä¸­çš„ annotation æœ‰ä¸¤ç§æ–¹æ³•ï¼Œ ä¸€ç§æ˜¯ç”¨ plt é‡Œé¢çš„ annotateï¼Œä¸€ç§æ˜¯ç›´æ¥ç”¨ plt é‡Œé¢çš„ text æ¥å†™æ ‡æ³¨. ç”»å‡ºåŸºæœ¬å›¾é¦–å…ˆï¼Œæˆ‘ä»¬åœ¨åæ ‡è½´ä¸­ç»˜åˆ¶ä¸€æ¡ç›´çº¿. import matplotlib.pyplot as pltimport numpy as npx = np.linspace(-3, 3, 50)y = 2*x + 1plt.figure(num=1, figsize=(8, 5),)plt.plot(x, y,)plt.show() ç§»åŠ¨åæ ‡import matplotlib.pyplot as pltimport numpy as npx = np.linspace(-3, 3, 50)y = 2*x + 1plt.figure(num=1, figsize=(8, 5),)plt.plot(x, y,)# ç§»åŠ¨åæ ‡ax = plt.gca()ax.spines[&#x27;right&#x27;].set_color(&#x27;none&#x27;)ax.spines[&#x27;top&#x27;].set_color(&#x27;none&#x27;)ax.xaxis.set_ticks_position(&#x27;bottom&#x27;)ax.spines[&#x27;bottom&#x27;].set_position((&#x27;data&#x27;, 0))ax.yaxis.set_ticks_position(&#x27;left&#x27;)ax.spines[&#x27;left&#x27;].set_position((&#x27;data&#x27;, 0))plt.show() ç„¶åæ ‡æ³¨å‡ºç‚¹(x0, y0)çš„ä½ç½®ä¿¡æ¯. ç”¨ plt.plot([x0, x0,], [0, y0,], &#39;k--&#39;, linewidth=2.5) ç”»å‡ºä¸€æ¡å‚ç›´äºxè½´çš„è™šçº¿. import matplotlib.pyplot as pltimport numpy as npx = np.linspace(-3, 3, 50)y = 2*x + 1plt.figure(num=1, figsize=(8, 5),)plt.plot(x, y,)# ç§»åŠ¨åæ ‡ax = plt.gca()ax.spines[&#x27;right&#x27;].set_color(&#x27;none&#x27;)ax.spines[&#x27;top&#x27;].set_color(&#x27;none&#x27;)ax.xaxis.set_ticks_position(&#x27;bottom&#x27;)ax.spines[&#x27;bottom&#x27;].set_position((&#x27;data&#x27;, 0))ax.yaxis.set_ticks_position(&#x27;left&#x27;)ax.spines[&#x27;left&#x27;].set_position((&#x27;data&#x27;, 0))x0 = 1y0 = 2*x0 + 1### plt.plot([x0, x0,], [0, y0,], &#x27;k--&#x27;, linewidth=2.5) ç”»å‡ºä¸€æ¡å‚ç›´äºxè½´çš„è™šçº¿. ###plt.plot([x0, x0,], [0, y0,], &#x27;k--&#x27;, linewidth=2.5)# set dot stylesplt.scatter([x0, ], [y0, ], s=50, color=&#x27;b&#x27;)plt.show() åŠ æ³¨é‡Š annotateæ¥ä¸‹æ¥æˆ‘ä»¬å°±å¯¹(x0, y0)è¿™ä¸ªç‚¹è¿›è¡Œæ ‡æ³¨. import matplotlib.pyplot as pltimport numpy as npx = np.linspace(-4, 4, 50)y = 2*x + 1plt.figure(num=1, figsize=(10, 6),)plt.plot(x, y,)# ç§»åŠ¨åæ ‡ax = plt.gca()ax.spines[&#x27;right&#x27;].set_color(&#x27;none&#x27;)ax.spines[&#x27;top&#x27;].set_color(&#x27;none&#x27;)ax.xaxis.set_ticks_position(&#x27;bottom&#x27;)ax.spines[&#x27;bottom&#x27;].set_position((&#x27;data&#x27;, 0))ax.yaxis.set_ticks_position(&#x27;left&#x27;)ax.spines[&#x27;left&#x27;].set_position((&#x27;data&#x27;, 0))x0 = 1y0 = 2*x0 + 1plt.plot([x0, x0,], [0, y0,], &#x27;k--&#x27;, linewidth=2.5)# set dot stylesplt.scatter([x0, ], [y0, ], s=50, color=&#x27;b&#x27;)############## æ·»åŠ æ³¨é‡Š annotate ###############plt.annotate(r&#x27;$2x+1=%s$&#x27; % y0, xy=(x0, y0), xycoords=&#x27;data&#x27;, xytext=(+30, -30), textcoords=&#x27;offset points&#x27;, fontsize=16, arrowprops=dict(arrowstyle=&#x27;-&gt;&#x27;, connectionstyle=&quot;arc3,rad=.2&quot;))plt.show() å…¶ä¸­å‚æ•° xycoords=&#39;data&#39; æ˜¯è¯´åŸºäºæ•°æ®çš„å€¼æ¥é€‰ä½ç½®, xytext=(+30, -30) å’Œ textcoords=&#39;offset points&#39; å¯¹äºæ ‡æ³¨ä½ç½®çš„æè¿° å’Œ xy åå·®å€¼, arrowpropsæ˜¯å¯¹å›¾ä¸­ç®­å¤´ç±»å‹çš„ä¸€äº›è®¾ç½®. åŠ æ³¨é‡Š textplt.text(-3.7, 3, r&#x27;$This\\ is\\ the\\ some\\ text. \\mu\\ \\sigma_i\\ \\alpha_t$&#x27;, fontdict=&#123;&#x27;size&#x27;: 16, &#x27;color&#x27;: &#x27;r&#x27;&#125;) Text(-3.7,3,&#39;$This\\\\ is\\\\ the\\\\ some\\\\ text. \\\\mu\\\\ \\\\sigma_i\\\\ \\\\alpha_t$&#39;) å…¶ä¸­-3.7, 3,æ˜¯é€‰å–textçš„ä½ç½®, ç©ºæ ¼éœ€è¦ç”¨åˆ°è½¬å­—ç¬¦\\ ,fontdictè®¾ç½®æ–‡æœ¬å­—ä½“. import matplotlib.pyplot as pltimport numpy as npx = np.linspace(-4, 4, 50)y = 2*x + 1plt.figure(num=1, figsize=(10, 6),)plt.plot(x, y,)# ç§»åŠ¨åæ ‡ax = plt.gca()ax.spines[&#x27;right&#x27;].set_color(&#x27;none&#x27;)ax.spines[&#x27;top&#x27;].set_color(&#x27;none&#x27;)ax.xaxis.set_ticks_position(&#x27;bottom&#x27;)ax.spines[&#x27;bottom&#x27;].set_position((&#x27;data&#x27;, 0))ax.yaxis.set_ticks_position(&#x27;left&#x27;)ax.spines[&#x27;left&#x27;].set_position((&#x27;data&#x27;, 0))x0 = 1y0 = 2*x0 + 1plt.plot([x0, x0,], [0, y0,], &#x27;k--&#x27;, linewidth=2.5)# set dot stylesplt.scatter([x0, ], [y0, ], s=50, color=&#x27;b&#x27;)############## æ·»åŠ æ³¨é‡Š annotate ###############plt.annotate(r&#x27;$2x+1=%s$&#x27; % y0, xy=(x0, y0), xycoords=&#x27;data&#x27;, xytext=(+30, -30), textcoords=&#x27;offset points&#x27;, fontsize=16, arrowprops=dict(arrowstyle=&#x27;-&gt;&#x27;, connectionstyle=&quot;arc3,rad=.2&quot;))############# æ·»åŠ æ³¨é‡Š text #################plt.text(-3.7, 3, r&#x27;$This\\ is\\ the\\ some\\ text. \\mu\\ \\sigma_i\\ \\alpha_t$&#x27;, fontdict=&#123;&#x27;size&#x27;: 16, &#x27;color&#x27;: &#x27;r&#x27;&#125;)plt.show() Reference matplotlib.org matplotlib docs morvanzhou","categories":[{"name":"python","slug":"python","permalink":"http://iequa.com/categories/python/"}],"tags":[{"name":"Matplotlib","slug":"Matplotlib","permalink":"http://iequa.com/tags/Matplotlib/"}]},{"title":"Matplotlib Legend","slug":"python/matplotlib/py-matplotlib-5-legend","date":"2018-01-23T07:30:21.000Z","updated":"2019-10-20T04:30:35.011Z","comments":true,"path":"2018/01/23/python/matplotlib/py-matplotlib-5-legend/","link":"","permalink":"http://iequa.com/2018/01/23/python/matplotlib/py-matplotlib-5-legend/","excerpt":"matplotlib ä¸­çš„ legend å›¾ä¾‹å°±æ˜¯ä¸ºäº†å±•ç¤ºå‡ºæ¯ä¸ªæ•°æ®å¯¹åº”çš„å›¾åƒåç§°,å¯è¯»æ€§æ›´å¥½.","text":"matplotlib ä¸­çš„ legend å›¾ä¾‹å°±æ˜¯ä¸ºäº†å±•ç¤ºå‡ºæ¯ä¸ªæ•°æ®å¯¹åº”çš„å›¾åƒåç§°,å¯è¯»æ€§æ›´å¥½. æ·»åŠ å›¾ä¾‹ legendimport matplotlib.pyplot as pltimport numpy as npx = np.linspace(-3, 3, 50)y1 = 2*x + 1y2 = x**2plt.figure()#set x limitsplt.xlim((-1, 2))plt.ylim((-2, 3))# set new sticksnew_sticks = np.linspace(-1, 2, 5)plt.xticks(new_sticks)# set tick labelsplt.yticks([-2, -1.8, -1, 1.22, 3], [r&#x27;$really\\ bad$&#x27;, r&#x27;$bad$&#x27;, r&#x27;$normal$&#x27;, r&#x27;$good$&#x27;, r&#x27;$really\\ good$&#x27;]) ([&lt;matplotlib.axis.YTick at 0x1195c3358&gt;, &lt;matplotlib.axis.YTick at 0x112681080&gt;, &lt;matplotlib.axis.YTick at 0x1195ce710&gt;, &lt;matplotlib.axis.YTick at 0x1195f5240&gt;, &lt;matplotlib.axis.YTick at 0x1195fc550&gt;], &lt;a list of 5 Text yticklabel objects&gt;) å¯¹å›¾ä¸­çš„ä¸¤æ¡çº¿ç»˜åˆ¶å›¾ä¾‹ï¼Œé¦–å…ˆæˆ‘ä»¬è®¾ç½®ä¸¤æ¡çº¿çš„ç±»å‹ç­‰ä¿¡æ¯ï¼ˆè“è‰²å®çº¿ä¸çº¢è‰²è™šçº¿). # set line sylesl1, = plt.plot(x, y1, label=&#x27;linear line&#x27;)l2, = plt.plot(x, y2, color=&#x27;red&#x27;, linewidth=1.0, linestyle=&#x27;--&#x27;, label=&#x27;square line&#x27;) éœ€è¦æ³¨æ„çš„æ˜¯ l1, l2, è¦ä»¥é€—å·ç»“å°¾, å› ä¸º plt.plot() è¿”å›çš„æ˜¯ä¸€ä¸ªlist. legend å°†è¦æ˜¾ç¤ºçš„ä¿¡æ¯æ¥è‡ªäºä¸Šé¢ä»£ç ä¸­çš„ label. æ‰€ä»¥æˆ‘ä»¬åªéœ€è¦ç®€å•å†™ä¸€ä¸‹ä»£ç , plt å°±èƒ½è‡ªåŠ¨çš„ä¸ºæˆ‘ä»¬æ·»åŠ å›¾ä¾‹. plt.legend(loc=&#x27;upper right&#x27;)plt.show() å‚æ•° loc=&#39;upper right&#39; è¡¨ç¤ºå›¾ä¾‹å°†æ·»åŠ åœ¨å›¾ä¸­çš„å³ä¸Šè§’. è°ƒæ•´ä½ç½®å’Œåç§°å¦‚æœæˆ‘ä»¬æƒ³å•ç‹¬ä¿®æ”¹ä¹‹å‰çš„ label ä¿¡æ¯, ç»™ä¸åŒç±»å‹çš„çº¿æ¡è®¾ç½®å›¾ä¾‹ä¿¡æ¯. æˆ‘ä»¬å¯ä»¥åœ¨ plt.legend è¾“å…¥æ›´å¤šå‚æ•°. å¦‚æœä»¥ä¸‹é¢è¿™ç§å½¢å¼æ·»åŠ  legend, æˆ‘ä»¬éœ€è¦ç¡®ä¿, åœ¨ä¸Šé¢çš„ä»£ç  plt.plot(x, y2, label=&#39;linear line&#39;) å’Œ plt.plot(x, y1, label=&#39;square line&#39;) ä¸­æœ‰ç”¨å˜é‡ l1 å’Œ l2 åˆ†åˆ«å­˜å‚¨èµ·æ¥. plt.legend(handles=[l1, l2], labels=[&#x27;up&#x27;, &#x27;down&#x27;], loc=&#x27;best&#x27;)plt.show() è¿™æ ·æˆ‘ä»¬å°±èƒ½åˆ†åˆ«é‡æ–°è®¾ç½®çº¿æ¡å¯¹åº”çš„ label äº†. å…¶ä¸­â€™locâ€™å‚æ•°æœ‰å¤šç§ï¼Œâ€™bestâ€™è¡¨ç¤ºè‡ªåŠ¨åˆ†é…æœ€ä½³ä½ç½®ï¼Œå…¶ä½™çš„å¦‚ä¸‹ï¼š &#x27;best&#x27; : 0, &#x27;upper right&#x27; : 1,&#x27;upper left&#x27; : 2,&#x27;lower left&#x27; : 3,&#x27;lower right&#x27; : 4,&#x27;right&#x27; : 5,&#x27;center left&#x27; : 6,&#x27;center right&#x27; : 7,&#x27;lower center&#x27; : 8,&#x27;upper center&#x27; : 9,&#x27;center&#x27; : 10, Reference matplotlib.org matplotlib docs morvanzhou","categories":[{"name":"python","slug":"python","permalink":"http://iequa.com/categories/python/"}],"tags":[{"name":"Matplotlib","slug":"Matplotlib","permalink":"http://iequa.com/tags/Matplotlib/"}]},{"title":"Matplotlib Coordinate axis","slug":"python/matplotlib/py-matplotlib-4-coordinate_axis","date":"2018-01-23T06:08:21.000Z","updated":"2019-10-20T04:30:35.012Z","comments":true,"path":"2018/01/23/python/matplotlib/py-matplotlib-4-coordinate_axis/","link":"","permalink":"http://iequa.com/2018/01/23/python/matplotlib/py-matplotlib-4-coordinate_axis/","excerpt":"å¦‚ä½•ç§»åŠ¨ matplotlib ä¸­ axis åæ ‡è½´çš„ä½ç½®.","text":"å¦‚ä½•ç§»åŠ¨ matplotlib ä¸­ axis åæ ‡è½´çš„ä½ç½®. è®¾ç½®åå­—å’Œä½ç½®import matplotlib.pyplot as pltimport numpy as np ä½¿ç”¨ np.linspace å®šä¹‰ x ï¼šèŒƒå›´æ˜¯(-3,3);ä¸ªæ•°æ˜¯50.ä»¿çœŸä¸€ç»´æ•°æ®ç»„(x ,y1)è¡¨ç¤ºæ›²çº¿1. ä»¿çœŸä¸€ç»´æ•°æ®ç»„(x ,y2)è¡¨ç¤ºæ›²çº¿2. x = np.linspace(-3, 3, 50)y1 = 2*x + 1y2 = x**2 ä½¿ç”¨plt.figureå®šä¹‰ä¸€ä¸ªå›¾åƒçª—å£. ä½¿ç”¨plt.plotç”»(x ,y2)æ›²çº¿. ä½¿ç”¨plt.plotç”»(x ,y1)æ›²çº¿ï¼Œæ›²çº¿çš„é¢œè‰²å±æ€§(color)ä¸ºçº¢è‰²; æ›²çº¿çš„å®½åº¦(linewidth) ä¸º 1.0; æ›²çº¿çš„ç±»å‹(linestyle)ä¸ºè™šçº¿. ä½¿ç”¨plt.xlimè®¾ç½®xåæ ‡è½´èŒƒå›´: (-1, 2); ä½¿ç”¨plt.ylimè®¾ç½®yåæ ‡è½´èŒƒå›´: (-2, 3); plt.figure()plt.plot(x, y2)plt.plot(x, y1, color=&#x27;red&#x27;, linewidth=1.0, linestyle=&#x27;--&#x27;)plt.xlim((-1, 2))plt.ylim((-2, 3)) (-2, 3) ä½¿ç”¨np.linspaceå®šä¹‰èŒƒå›´ä»¥åŠä¸ªæ•°ï¼šèŒƒå›´æ˜¯(-1,2);ä¸ªæ•°æ˜¯5. ä½¿ç”¨plt.xticksè®¾ç½®xè½´åˆ»åº¦ï¼šèŒƒå›´æ˜¯(-1,2);ä¸ªæ•°æ˜¯5.ä½¿ç”¨plt.yticksè®¾ç½®yè½´åˆ»åº¦ä»¥åŠåç§°: åˆ»åº¦ä¸º[-2, -1.8, -1, 1.22, 3]; å¯¹åº”åˆ»åº¦çš„åç§°ä¸º[â€˜really badâ€™,â€™badâ€™,â€™normalâ€™,â€™goodâ€™, â€˜really goodâ€™]. new_ticks = np.linspace(-1, 2, 5)plt.xticks(new_ticks)plt.yticks([-2, -1.8, -1, 1.22, 3],[&#x27;$really\\ bad$&#x27;, &#x27;$bad$&#x27;, &#x27;$normal$&#x27;, &#x27;$good$&#x27;, &#x27;$really\\ good$&#x27;]) function desc è®¾ç½®æ•ˆæœ plt.gca è·å–å½“å‰åæ ‡è½´ä¿¡æ¯ - .spines è®¾ç½®è¾¹æ¡† å³ä¾§è¾¹æ¡† &amp; ä¸Šè¾¹æ¡† .set_color è®¾ç½®è¾¹æ¡†é¢œè‰² é»˜è®¤ç™½è‰² ax = plt.gca()ax.spines[&#x27;right&#x27;].set_color(&#x27;none&#x27;)ax.spines[&#x27;top&#x27;].set_color(&#x27;none&#x27;)plt.show() è°ƒæ•´åæ ‡è½´ä½¿ç”¨ .xaxis.set_ticks_positionè®¾ç½®xåæ ‡åˆ»åº¦æ•°å­—æˆ–åç§°çš„ä½ç½®ï¼šbottom.ï¼ˆæ‰€æœ‰ä½ç½®ï¼štopï¼Œbottomï¼Œbothï¼Œdefaultï¼Œnoneï¼‰ä½¿ç”¨ .spines è®¾ç½®è¾¹æ¡†ï¼šxè½´ï¼›ä½¿ç”¨ .set_position è®¾ç½®è¾¹æ¡†ä½ç½®ï¼šy=0 çš„ä½ç½®ï¼›ï¼ˆä½ç½®æ‰€æœ‰å±æ€§ï¼šoutwardï¼Œaxesï¼Œdataï¼‰ ax.xaxis.set_ticks_position(&#x27;bottom&#x27;)ax.spines[&#x27;bottom&#x27;].set_position((&#x27;data&#x27;, 0))plt.show() ä½¿ç”¨.yaxis.set_ticks_positionè®¾ç½®yåæ ‡åˆ»åº¦æ•°å­—æˆ–åç§°çš„ä½ç½®ï¼šleft.ï¼ˆæ‰€æœ‰ä½ç½®ï¼šleftï¼Œrightï¼Œbothï¼Œdefaultï¼Œnoneï¼‰ ax.yaxis.set_ticks_position(&#x27;left&#x27;) ä½¿ç”¨.spinesè®¾ç½®è¾¹æ¡†ï¼šyè½´;ä½¿ç”¨.set_positionè®¾ç½®è¾¹æ¡†ä½ç½®ï¼šx=0çš„ä½ç½®ï¼›ï¼ˆä½ç½®æ‰€æœ‰å±æ€§ï¼šoutwardï¼Œaxesï¼Œdataï¼‰ä½¿ç”¨plt.showæ˜¾ç¤ºå›¾åƒ. ax.spines[&#x27;left&#x27;].set_position((&#x27;data&#x27;,0))plt.show() Reference matplotlib.org matplotlib docs morvanzhou","categories":[{"name":"python","slug":"python","permalink":"http://iequa.com/categories/python/"}],"tags":[{"name":"Matplotlib","slug":"Matplotlib","permalink":"http://iequa.com/tags/Matplotlib/"}]},{"title":"pickle","slug":"python/language/py-language-14-pickle","date":"2018-01-19T05:00:21.000Z","updated":"2019-10-20T04:30:35.005Z","comments":true,"path":"2018/01/19/python/language/py-language-14-pickle/","link":"","permalink":"http://iequa.com/2018/01/19/python/language/py-language-14-pickle/","excerpt":"Python è¯­è¨€ç‰¹å®šçš„åºåˆ—åŒ–æ¨¡å—æ˜¯pickleï¼Œä½†å¦‚æœè¦æŠŠåºåˆ—åŒ–æå¾—æ›´é€šç”¨ã€æ›´ç¬¦åˆWebæ ‡å‡†ï¼Œå¯ä»¥ä½¿ç”¨jsonæ¨¡å—","text":"Python è¯­è¨€ç‰¹å®šçš„åºåˆ—åŒ–æ¨¡å—æ˜¯pickleï¼Œä½†å¦‚æœè¦æŠŠåºåˆ—åŒ–æå¾—æ›´é€šç”¨ã€æ›´ç¬¦åˆWebæ ‡å‡†ï¼Œå¯ä»¥ä½¿ç”¨jsonæ¨¡å— pickle æ˜¯ä¸€ä¸ª python ä¸­, å‹ç¼©/ä¿å­˜/æå– æ–‡ä»¶çš„æ¨¡å—. æœ€ä¸€èˆ¬çš„ä½¿ç”¨æ–¹å¼éå¸¸ç®€å•. pickle ä¿å­˜å­—å…¸å’Œåˆ—è¡¨éƒ½æ˜¯èƒ½è¢«ä¿å­˜çš„. import picklea_dict = &#123;&#x27;da&#x27;: 111, 2: [23,1,4], &#x27;23&#x27;: &#123;1:2,&#x27;d&#x27;:&#x27;sad&#x27;&#125;&#125;# pickle a variable to a filefile = open(&#x27;pickle_example.pickle&#x27;, &#x27;wb&#x27;)pickle.dump(a_dict, file)file.close() pickle.dump ä½ è¦ä¿å­˜çš„ä¸œè¥¿å»è¿™ä¸ªæ‰“å¼€çš„ file. æœ€åå…³é—­ file ä½ å°±ä¼šå‘ç°ä½ çš„æ–‡ä»¶ç›®å½•é‡Œå¤šäº†ä¸€ä¸ª pickle_example.pickle æ–‡ä»¶, è¿™å°±æ˜¯é‚£ä¸ªå­—å…¸äº†. pickle æå–# reload a file to a variablewith open(&#x27;pickle_example.pickle&#x27;, &#x27;rb&#x27;) as file: a_dict1 =pickle.load(file)print(a_dict1) &#123;&#39;da&#39;: 111, 2: [23, 1, 4], &#39;23&#39;: &#123;1: 2, &#39;d&#39;: &#39;sad&#39;&#125;&#125; Reference docs.python.org python morvanzhou python liaoxuefeng","categories":[{"name":"python","slug":"python","permalink":"http://iequa.com/categories/python/"}],"tags":[{"name":"python","slug":"python","permalink":"http://iequa.com/tags/python/"}]},{"title":"Sklearn Save Model","slug":"python/sklearn/py-sklearn-7-save-model","date":"2018-01-10T05:17:21.000Z","updated":"2019-10-20T04:30:35.010Z","comments":true,"path":"2018/01/10/python/sklearn/py-sklearn-7-save-model/","link":"","permalink":"http://iequa.com/2018/01/10/python/sklearn/py-sklearn-7-save-model/","excerpt":"æˆ‘ä»¬è®­ç»ƒå¥½äº†ä¸€ä¸ª Model ä»¥åæ€»éœ€è¦ä¿å­˜å’Œå†æ¬¡é¢„æµ‹, æ‰€ä»¥ä¿å­˜å’Œè¯»å–æˆ‘ä»¬çš„sklearn modelä¹Ÿæ˜¯åŒæ ·é‡è¦çš„ä¸€æ­¥ã€‚è¿™æ¬¡ä¸»è¦ä»‹ç»ä¸¤ç§ä¿å­˜Modelçš„æ¨¡å— pickle ä¸ joblib","text":"æˆ‘ä»¬è®­ç»ƒå¥½äº†ä¸€ä¸ª Model ä»¥åæ€»éœ€è¦ä¿å­˜å’Œå†æ¬¡é¢„æµ‹, æ‰€ä»¥ä¿å­˜å’Œè¯»å–æˆ‘ä»¬çš„sklearn modelä¹Ÿæ˜¯åŒæ ·é‡è¦çš„ä¸€æ­¥ã€‚è¿™æ¬¡ä¸»è¦ä»‹ç»ä¸¤ç§ä¿å­˜Modelçš„æ¨¡å— pickle ä¸ joblib pickle ä¿å­˜é¦–å…ˆç®€å•å»ºç«‹ä¸è®­ç»ƒä¸€ä¸ª SVC Model from sklearn import svmfrom sklearn import datasetsclf = svm.SVC()iris = datasets.load_iris()X, y = iris.data, iris.targetclf.fit(X,y) SVC(C=1.0, cache_size=200, class_weight=None, coef0=0.0, decision_function_shape=&#39;ovr&#39;, degree=3, gamma=&#39;auto&#39;, kernel=&#39;rbf&#39;, max_iter=-1, probability=False, random_state=None, shrinking=True, tol=0.001, verbose=False) ä½¿ç”¨ pickle æ¥ä¿å­˜ä¸è¯»å–è®­ç»ƒå¥½çš„ Model import pickle #pickleæ¨¡å—#ä¿å­˜Model(æ³¨:saveæ–‡ä»¶å¤¹è¦é¢„å…ˆå»ºç«‹ï¼Œå¦åˆ™ä¼šæŠ¥é”™)with open(&#x27;save/clf.pickle&#x27;, &#x27;wb&#x27;) as f: pickle.dump(clf, f)#è¯»å–Modelwith open(&#x27;save/clf.pickle&#x27;, &#x27;rb&#x27;) as f: clf2 = pickle.load(f) #æµ‹è¯•è¯»å–åçš„Model print(clf2.predict(X[0:1]))# [0] [0] joblib ä¿å­˜joblib æ˜¯ sklearnçš„å¤–éƒ¨æ¨¡å— from sklearn.externals import joblib #jbolibæ¨¡å—#ä¿å­˜Model(æ³¨:saveæ–‡ä»¶å¤¹è¦é¢„å…ˆå»ºç«‹ï¼Œå¦åˆ™ä¼šæŠ¥é”™)joblib.dump(clf, &#x27;save/clf.pkl&#x27;)#è¯»å–Modelclf3 = joblib.load(&#x27;save/clf.pkl&#x27;)#æµ‹è¯•è¯»å–åçš„Modelprint(clf3.predict(X[0:1]))# [0] [0] joblib åœ¨ä½¿ç”¨ä¸Šæ¯”è¾ƒå®¹æ˜“ï¼Œè¯»å–é€Ÿåº¦ä¹Ÿç›¸å¯¹pickleå¿« Reference scikit-learn.org scikit-learn docs scikit-learn morvanzhou","categories":[{"name":"python","slug":"python","permalink":"http://iequa.com/categories/python/"}],"tags":[{"name":"Sklearn","slug":"Sklearn","permalink":"http://iequa.com/tags/Sklearn/"}]},{"title":"Sklearn Cross-validation 3","slug":"python/sklearn/py-sklearn-6-cross-validation-3","date":"2018-01-09T07:17:21.000Z","updated":"2019-10-20T04:30:35.008Z","comments":true,"path":"2018/01/09/python/sklearn/py-sklearn-6-cross-validation-3/","link":"","permalink":"http://iequa.com/2018/01/09/python/sklearn/py-sklearn-6-cross-validation-3/","excerpt":"äº¤å‰éªŒè¯(cross validation)è®©æˆ‘ä»¬çŸ¥é“åœ¨æœºå™¨å­¦ä¹ ä¸­éªŒè¯æ˜¯æœ‰å¤šä¹ˆçš„é‡è¦, è¿™ä¸€æ¬¡çš„ sklearn ä¸­æˆ‘ä»¬ç”¨åˆ°äº†sklearn.learning_curveå½“ä¸­çš„å¦å¤–ä¸€ç§, å«åšvalidation_curve,ç”¨è¿™ä¸€ç§æ›²çº¿æˆ‘ä»¬å°±èƒ½æ›´åŠ ç›´è§‚çœ‹å‡ºæ”¹å˜æ¨¡å‹ä¸­çš„å‚æ•°çš„æ—¶å€™æœ‰æ²¡æœ‰è¿‡æ‹Ÿåˆ(overfitting)çš„é—®é¢˜äº†. è¿™ä¹Ÿæ˜¯å¯ä»¥è®©æˆ‘ä»¬æ›´å¥½çš„é€‰æ‹©å‚æ•°çš„æ–¹æ³•.","text":"äº¤å‰éªŒè¯(cross validation)è®©æˆ‘ä»¬çŸ¥é“åœ¨æœºå™¨å­¦ä¹ ä¸­éªŒè¯æ˜¯æœ‰å¤šä¹ˆçš„é‡è¦, è¿™ä¸€æ¬¡çš„ sklearn ä¸­æˆ‘ä»¬ç”¨åˆ°äº†sklearn.learning_curveå½“ä¸­çš„å¦å¤–ä¸€ç§, å«åšvalidation_curve,ç”¨è¿™ä¸€ç§æ›²çº¿æˆ‘ä»¬å°±èƒ½æ›´åŠ ç›´è§‚çœ‹å‡ºæ”¹å˜æ¨¡å‹ä¸­çš„å‚æ•°çš„æ—¶å€™æœ‰æ²¡æœ‰è¿‡æ‹Ÿåˆ(overfitting)çš„é—®é¢˜äº†. è¿™ä¹Ÿæ˜¯å¯ä»¥è®©æˆ‘ä»¬æ›´å¥½çš„é€‰æ‹©å‚æ•°çš„æ–¹æ³•. validation_curve æ£€è§†è¿‡æ‹ŸåˆéªŒè¯SVCä¸­çš„ä¸€ä¸ªå‚æ•° gamma åœ¨ä»€ä¹ˆèŒƒå›´å†…èƒ½ä½¿ model äº§ç”Ÿå¥½çš„ç»“æœ. ä»¥åŠè¿‡æ‹Ÿåˆå’Œ gamma å–å€¼çš„å…³ç³». from sklearn.learning_curve import validation_curve #validation_curveæ¨¡å—from sklearn.datasets import load_digits from sklearn.svm import SVC import matplotlib.pyplot as plt import numpy as np#digitsæ•°æ®é›†digits = load_digits()X = digits.datay = digits.target#å»ºç«‹å‚æ•°æµ‹è¯•é›†param_range = np.logspace(-6, -2.3, 5)#ä½¿ç”¨validation_curveå¿«é€Ÿæ‰¾å‡ºå‚æ•°å¯¹æ¨¡å‹çš„å½±å“train_loss, test_loss = validation_curve( SVC(), X, y, param_name=&#x27;gamma&#x27;, param_range=param_range, cv=10, scoring=&#x27;mean_squared_error&#x27;)#å¹³å‡æ¯ä¸€è½®çš„å¹³å‡æ–¹å·®train_loss_mean = -np.mean(train_loss, axis=1)test_loss_mean = -np.mean(test_loss, axis=1)#å¯è§†åŒ–å›¾å½¢plt.plot(param_range, train_loss_mean, &#x27;o-&#x27;, color=&quot;r&quot;, label=&quot;Training&quot;)plt.plot(param_range, test_loss_mean, &#x27;o-&#x27;, color=&quot;g&quot;, label=&quot;Cross-validation&quot;)plt.xlabel(&quot;gamma&quot;)plt.ylabel(&quot;Loss&quot;)plt.legend(loc=&quot;best&quot;)plt.show() ç”±å›¾ä¸­å¯ä»¥æ˜æ˜¾çœ‹åˆ° gamma å€¼å¤§äº 0.001ï¼Œæ¨¡å‹å°±ä¼šæœ‰è¿‡æ‹Ÿåˆ(Overfitting)çš„é—®é¢˜ã€‚ Reference scikit-learn.org scikit-learn docs scikit-learn morvanzhou","categories":[{"name":"python","slug":"python","permalink":"http://iequa.com/categories/python/"}],"tags":[{"name":"Sklearn","slug":"Sklearn","permalink":"http://iequa.com/tags/Sklearn/"}]},{"title":"Sklearn Cross-validation 2","slug":"python/sklearn/py-sklearn-6-cross-validation-2","date":"2018-01-09T02:17:21.000Z","updated":"2019-10-20T04:30:35.008Z","comments":true,"path":"2018/01/09/python/sklearn/py-sklearn-6-cross-validation-2/","link":"","permalink":"http://iequa.com/2018/01/09/python/sklearn/py-sklearn-6-cross-validation-2/","excerpt":"Sklearn ä¸­çš„ learning curve å¯ä»¥å¾ˆç›´è§‚çš„çœ‹å‡ºæˆ‘ä»¬çš„ model å­¦ä¹ çš„è¿›åº¦, å¯¹æ¯”å‘ç°æœ‰æ²¡æœ‰ overfitting çš„é—®é¢˜. ç„¶åæˆ‘ä»¬å¯ä»¥å¯¹æˆ‘ä»¬çš„ model è¿›è¡Œè°ƒæ•´, å…‹æœ overfitting çš„é—®é¢˜.","text":"Sklearn ä¸­çš„ learning curve å¯ä»¥å¾ˆç›´è§‚çš„çœ‹å‡ºæˆ‘ä»¬çš„ model å­¦ä¹ çš„è¿›åº¦, å¯¹æ¯”å‘ç°æœ‰æ²¡æœ‰ overfitting çš„é—®é¢˜. ç„¶åæˆ‘ä»¬å¯ä»¥å¯¹æˆ‘ä»¬çš„ model è¿›è¡Œè°ƒæ•´, å…‹æœ overfitting çš„é—®é¢˜. Learning curve æ£€è§†è¿‡æ‹ŸåˆåŠ è½½å¯¹åº”æ¨¡å—: from sklearn.learning_curve import learning_curve #å­¦ä¹ æ›²çº¿æ¨¡å—from sklearn.datasets import load_digits #digitsæ•°æ®é›†from sklearn.svm import SVC #Support Vector Classifierimport matplotlib.pyplot as plt #å¯è§†åŒ–æ¨¡å—import numpy as np åŠ è½½digitsæ•°æ®é›†ï¼Œå…¶åŒ…å«çš„æ˜¯æ‰‹å†™ä½“çš„æ•°å­—ï¼Œä»0åˆ°9ã€‚æ•°æ®é›†æ€»å…±æœ‰1797ä¸ªæ ·æœ¬ï¼Œæ¯ä¸ªæ ·æœ¬ç”±64ä¸ªç‰¹å¾ç»„æˆï¼Œ åˆ†åˆ«ä¸ºå…¶æ‰‹å†™ä½“å¯¹åº”çš„8Ã—8åƒç´ è¡¨ç¤ºï¼Œæ¯ä¸ªç‰¹å¾å–å€¼0~16ã€‚ digits = load_digits()X = digits.datay = digits.target#print(len(X[0])) è§‚å¯Ÿæ ·æœ¬ç”±å°åˆ°å¤§çš„å­¦ä¹ æ›²çº¿å˜åŒ–, é‡‡ç”¨KæŠ˜äº¤å‰éªŒè¯ cv=10, é€‰æ‹©å¹³å‡æ–¹å·®æ£€è§†æ¨¡å‹æ•ˆèƒ½ scoring=&#39;mean_squared_error&#39;, æ ·æœ¬ç”±å°åˆ°å¤§åˆ†æˆ5è½®æ£€è§†å­¦ä¹ æ›²çº¿(10%, 25%, 50%, 75%, 100%): train_sizes, train_loss, test_loss = learning_curve( SVC(gamma=0.001), X, y, cv=10, scoring=&#x27;mean_squared_error&#x27;, train_sizes=[0.1, 0.25, 0.5, 0.75, 1])#å¹³å‡æ¯ä¸€è½®æ‰€å¾—åˆ°çš„å¹³å‡æ–¹å·®(å…±5è½®ï¼Œåˆ†åˆ«ä¸ºæ ·æœ¬10%ã€25%ã€50%ã€75%ã€100%)train_loss_mean = -np.mean(train_loss, axis=1)test_loss_mean = -np.mean(test_loss, axis=1) å¯è§†åŒ–å›¾å½¢: plt.plot(train_sizes, train_loss_mean, &#x27;o-&#x27;, color=&quot;r&quot;, label=&quot;Training&quot;)plt.plot(train_sizes, test_loss_mean, &#x27;o-&#x27;, color=&quot;g&quot;, label=&quot;Cross-validation&quot;)plt.xlabel(&quot;Training examples&quot;)plt.ylabel(&quot;Loss&quot;)plt.legend(loc=&quot;best&quot;)plt.show() Reference scikit-learn.org scikit-learn docs scikit-learn morvanzhou","categories":[{"name":"python","slug":"python","permalink":"http://iequa.com/categories/python/"}],"tags":[{"name":"Sklearn","slug":"Sklearn","permalink":"http://iequa.com/tags/Sklearn/"}]},{"title":"Sklearn Cross-validation 1","slug":"python/sklearn/py-sklearn-6-cross-validation-1","date":"2018-01-08T10:17:21.000Z","updated":"2019-10-20T04:30:35.010Z","comments":true,"path":"2018/01/08/python/sklearn/py-sklearn-6-cross-validation-1/","link":"","permalink":"http://iequa.com/2018/01/08/python/sklearn/py-sklearn-6-cross-validation-1/","excerpt":"Sklearn ä¸­çš„ Cross-validation å¯¹äºæˆ‘ä»¬é€‰æ‹©æ­£ç¡®çš„ Model å’Œ Model çš„å‚æ•°æ˜¯éå¸¸æœ‰ç”¨ï¼Œ æœ‰äº†å®ƒæˆ‘ä»¬èƒ½ç›´è§‚çš„çœ‹å‡ºä¸åŒ Model æˆ–è€…å‚æ•°å¯¹ç»“æ„å‡†ç¡®åº¦çš„å½±å“ã€‚","text":"Sklearn ä¸­çš„ Cross-validation å¯¹äºæˆ‘ä»¬é€‰æ‹©æ­£ç¡®çš„ Model å’Œ Model çš„å‚æ•°æ˜¯éå¸¸æœ‰ç”¨ï¼Œ æœ‰äº†å®ƒæˆ‘ä»¬èƒ½ç›´è§‚çš„çœ‹å‡ºä¸åŒ Model æˆ–è€…å‚æ•°å¯¹ç»“æ„å‡†ç¡®åº¦çš„å½±å“ã€‚ Model åŸºç¡€éªŒè¯æ³•from sklearn.datasets import load_iris # irisæ•°æ®é›†from sklearn.model_selection import train_test_split # åˆ†å‰²æ•°æ®æ¨¡å—from sklearn.neighbors import KNeighborsClassifier # Kæœ€è¿‘é‚»(kNNï¼Œk-NearestNeighbor)åˆ†ç±»ç®—æ³•#åŠ è½½irisæ•°æ®é›†iris = load_iris()X = iris.datay = iris.target#åˆ†å‰²æ•°æ®å¹¶X_train, X_test, y_train, y_test = train_test_split(X, y, random_state=4)#å»ºç«‹æ¨¡å‹knn = KNeighborsClassifier()#è®­ç»ƒæ¨¡å‹knn.fit(X_train, y_train)#å°†å‡†ç¡®ç‡æ‰“å°å‡ºprint(knn.score(X_test, y_test)) 0.973684210526 å¯ä»¥çœ‹åˆ°åŸºç¡€éªŒè¯çš„å‡†ç¡®ç‡ä¸º 0.973684210526 Model Cross Validationfrom sklearn.cross_validation import cross_val_score # KæŠ˜äº¤å‰éªŒè¯æ¨¡å—#ä½¿ç”¨KæŠ˜äº¤å‰éªŒè¯æ¨¡å—scores = cross_val_score(knn, X, y, cv=5, scoring=&#x27;accuracy&#x27;)#å°†5æ¬¡çš„é¢„æµ‹å‡†ç¡®ç‡æ‰“å°å‡ºprint(scores)#å°†5æ¬¡çš„é¢„æµ‹å‡†ç¡®å¹³å‡ç‡æ‰“å°å‡ºprint(scores.mean()) [ 0.96666667 1. 0.93333333 0.96666667 1. ] 0.973333333333 å¯ä»¥çœ‹åˆ°äº¤å‰éªŒè¯çš„å‡†ç¡®å¹³å‡ç‡ä¸º 0.973333333333 Aaccuracy å‡†ç¡®ç‡åˆ¤æ–­ä¸€èˆ¬æ¥è¯´ å‡†ç¡®ç‡(accuracy) ä¼šç”¨äºåˆ¤æ–­åˆ†ç±»(Classification)æ¨¡å‹çš„å¥½å import matplotlib.pyplot as plt #å¯è§†åŒ–æ¨¡å—#å»ºç«‹æµ‹è¯•å‚æ•°é›†k_range = range(1, 31)k_scores = []#è—‰ç”±è¿­ä»£çš„æ–¹å¼æ¥è®¡ç®—ä¸åŒå‚æ•°å¯¹æ¨¡å‹çš„å½±å“ï¼Œå¹¶è¿”å›äº¤å‰éªŒè¯åçš„å¹³å‡å‡†ç¡®ç‡for k in k_range: knn = KNeighborsClassifier(n_neighbors=k) scores = cross_val_score(knn, X, y, cv=10, scoring=&#x27;accuracy&#x27;) k_scores.append(scores.mean())#å¯è§†åŒ–æ•°æ®plt.plot(k_range, k_scores)plt.xlabel(&#x27;Value of K for KNN&#x27;)plt.ylabel(&#x27;Cross-Validated Accuracy&#x27;)plt.show() ä»å›¾ä¸­å¾—çŸ¥ï¼Œé€‰æ‹© 12~18 çš„ k å€¼æœ€å¥½ã€‚é«˜è¿‡ 18 ä¹‹åï¼Œå‡†ç¡®ç‡å¼€å§‹ä¸‹é™åˆ™æ˜¯å› ä¸ºè¿‡æ‹Ÿåˆ(Over fitting)çš„é—®é¢˜ã€‚ Mean squared errorä¸€èˆ¬æ¥è¯´å¹³å‡æ–¹å·®(Mean squared error)ä¼šç”¨äºåˆ¤æ–­å›å½’(Regression)æ¨¡å‹çš„å¥½å import matplotlib.pyplot as pltk_range = range(1, 31)k_scores = []for k in k_range: knn = KNeighborsClassifier(n_neighbors=k) loss = -cross_val_score(knn, X, y, cv=10, scoring=&#x27;mean_squared_error&#x27;) k_scores.append(loss.mean())plt.plot(k_range, k_scores)plt.xlabel(&#x27;Value of K for KNN&#x27;)plt.ylabel(&#x27;Cross-Validated MSE&#x27;)plt.show() ç”±å›¾å¯ä»¥å¾—çŸ¥ï¼Œå¹³å‡æ–¹å·®è¶Šä½è¶Šå¥½ï¼Œå› æ­¤é€‰æ‹©13~18å·¦å³çš„Kå€¼ä¼šæœ€å¥½ Reference scikit-learn.org scikit-learn docs scikit-learn morvanzhou","categories":[{"name":"python","slug":"python","permalink":"http://iequa.com/categories/python/"}],"tags":[{"name":"Sklearn","slug":"Sklearn","permalink":"http://iequa.com/tags/Sklearn/"}]},{"title":"Sklearn Normalization","slug":"python/sklearn/py-sklearn-5-normalization","date":"2018-01-06T11:52:21.000Z","updated":"2019-10-20T04:30:35.009Z","comments":true,"path":"2018/01/06/python/sklearn/py-sklearn-5-normalization/","link":"","permalink":"http://iequa.com/2018/01/06/python/sklearn/py-sklearn-5-normalization/","excerpt":"Data Normalization å¯ä»¥æå‡æœºå™¨å­¦ä¹ çš„æˆæ•ˆ","text":"Data Normalization å¯ä»¥æå‡æœºå™¨å­¦ä¹ çš„æˆæ•ˆ Normalizationfrom sklearn import preprocessing #æ ‡å‡†åŒ–æ•°æ®æ¨¡å—import numpy as np# å»ºç«‹Arraya = np.array([[10, 2.7, 3.6], [-100, 5, -2], [120, 20, 40]], dtype=np.float64)# å°†normalizedåçš„aæ‰“å°å‡ºprint(preprocessing.scale(a)) [[ 0. -0.85170713 -0.55138018] [-1.22474487 -0.55187146 -0.852133 ] [ 1.22474487 1.40357859 1.40351318]] Normalization å¯¹ç»“æœçš„å½±å“# æ ‡å‡†åŒ–æ•°æ®æ¨¡å—from sklearn import preprocessing import numpy as np# å°†èµ„æ–™åˆ†å‰²æˆtrainä¸testçš„æ¨¡å—from sklearn.model_selection import train_test_split# ç”Ÿæˆé€‚åˆåšclassificationèµ„æ–™çš„æ¨¡å—from sklearn.datasets.samples_generator import make_classification # Support Vector Machineä¸­çš„Support Vector Classifierfrom sklearn.svm import SVC # å¯è§†åŒ–æ•°æ®çš„æ¨¡å—import matplotlib.pyplot as plt ç”Ÿæˆé€‚åˆåš Classification æ•°æ®# ç”Ÿæˆå…·æœ‰2ç§å±æ€§çš„300ç¬”æ•°æ®X, y = make_classification( n_samples=300, n_features=2, n_redundant=0, n_informative=2, random_state=22, n_clusters_per_class=1, scale=100)# n_features ç‰¹å¾ä¸ªæ•° = n_informativeï¼ˆï¼‰ + n_redundant + n_repeated# n_informative å¤šä¿¡æ¯ç‰¹å¾çš„ä¸ªæ•°# n_redundant å†—ä½™ä¿¡æ¯ï¼Œinformative ç‰¹å¾çš„éšæœºçº¿æ€§ç»„åˆ# n_classes åˆ†ç±»ç±»åˆ«# n_clusters_per_class æŸä¸€ä¸ªç±»åˆ«æ˜¯ç”±å‡ ä¸ª cluster æ„æˆçš„#å¯è§†åŒ–æ•°æ®plt.scatter(X[:, 0], X[:, 1], c=y)plt.show() data normalization beforeX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.3)clf = SVC()clf.fit(X_train, y_train)print(clf.score(X_test, y_test)) 0.477777777778 data normalization afteræ•°æ®çš„å•ä½å‘ç”Ÿäº†å˜åŒ–, X æ•°æ®ä¹Ÿè¢«å‹ç¼©åˆ°å·®ä¸å¤šå¤§å°èŒƒå›´. X = preprocessing.scale(X)X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.3)clf = SVC()clf.fit(X_train, y_train)print(clf.score(X_test, y_test))# 0.9 0.933333333333 Reference scikit-learn.org scikit-learn docs scikit-learn morvanzhou","categories":[{"name":"python","slug":"python","permalink":"http://iequa.com/categories/python/"}],"tags":[{"name":"Sklearn","slug":"Sklearn","permalink":"http://iequa.com/tags/Sklearn/"}]},{"title":"Sklearn General Learning Model","slug":"python/sklearn/py-sklearn-2-general-learning-model","date":"2018-01-05T07:05:21.000Z","updated":"2019-10-20T04:30:35.009Z","comments":true,"path":"2018/01/05/python/sklearn/py-sklearn-2-general-learning-model/","link":"","permalink":"http://iequa.com/2018/01/05/python/sklearn/py-sklearn-2-general-learning-model/","excerpt":"Sklearn æŠŠæ‰€æœ‰æœºå™¨å­¦ä¹ çš„æ¨¡å¼æ•´åˆç»Ÿä¸€èµ·æ¥äº†ï¼Œå­¦ä¼šäº†ä¸€ä¸ªæ¨¡å¼å°±å¯ä»¥é€šåƒå…¶ä»–ä¸åŒç±»å‹çš„å­¦ä¹ æ¨¡å¼","text":"Sklearn æŠŠæ‰€æœ‰æœºå™¨å­¦ä¹ çš„æ¨¡å¼æ•´åˆç»Ÿä¸€èµ·æ¥äº†ï¼Œå­¦ä¼šäº†ä¸€ä¸ªæ¨¡å¼å°±å¯ä»¥é€šåƒå…¶ä»–ä¸åŒç±»å‹çš„å­¦ä¹ æ¨¡å¼ ä½¿ç”¨åˆ†ç±»å™¨Sklearn æœ¬èº«å°±æœ‰å¾ˆå¤šæ•°æ®åº“ï¼Œå¯ä»¥ç”¨æ¥ç»ƒä¹ ã€‚ ä»¥ Iris çš„æ•°æ®ä¸ºä¾‹ï¼Œè¿™ç§èŠ±æœ‰å››ä¸ªå±æ€§ï¼ŒèŠ±ç“£çš„é•¿å®½ï¼ŒèŒçš„é•¿å®½ï¼Œæ ¹æ®è¿™äº›å±æ€§æŠŠèŠ±åˆ†ä¸ºä¸‰ç±»ã€‚ æˆ‘ä»¬è¦ç”¨ åˆ†ç±»å™¨ å»æŠŠå››ç§ç±»å‹çš„èŠ±åˆ†å¼€ã€‚ ä»Šå¤©ç”¨ KNN classifierï¼Œå°±æ˜¯é€‰æ‹©å‡ ä¸ªä¸´è¿‘ç‚¹ï¼Œç»¼åˆå®ƒä»¬åšä¸ªå¹³å‡æ¥ä½œä¸ºé¢„æµ‹å€¼ å¯¼å…¥æ¨¡å—from sklearn import datasetsfrom sklearn.model_selection import train_test_splitfrom sklearn.neighbors import KNeighborsClassifier åˆ›å»ºæ•°æ®åŠ è½½ iris çš„æ•°æ®ï¼ŒæŠŠå±æ€§å­˜åœ¨ Xï¼Œç±»åˆ«æ ‡ç­¾å­˜åœ¨ yï¼š iris = datasets.load_iris()iris_X = iris.datairis_y = iris.target è§‚å¯Ÿä¸€ä¸‹æ•°æ®é›†ï¼ŒX æœ‰å››ä¸ªå±æ€§ï¼Œy æœ‰ 0ï¼Œ1ï¼Œ2 ä¸‰ç±»ï¼š print(iris_X[:2, :])print(iris_y) [[ 5.1 3.5 1.4 0.2] [ 4.9 3. 1.4 0.2]] [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2] æŠŠæ•°æ®é›†åˆ†ä¸ºè®­ç»ƒé›†å’Œæµ‹è¯•é›†ï¼Œå…¶ä¸­ test_size=0.3ï¼Œå³æµ‹è¯•é›†å æ€»æ•°æ®çš„ 30%ï¼š X_train, X_test, y_train, y_test = train_test_split(iris_X, iris_y, test_size=0.3) å¯ä»¥çœ‹åˆ°åˆ†å¼€åçš„æ•°æ®é›†ï¼Œé¡ºåºä¹Ÿè¢«æ‰“ä¹±ï¼Œè¿™æ ·æ›´æœ‰åˆ©äºå­¦ä¹ æ¨¡å‹ï¼š print(y_train) [0 0 2 2 1 0 2 0 1 1 0 2 1 2 2 0 0 1 0 1 0 2 1 1 1 2 2 1 0 0 2 2 2 2 2 1 0 0 0 0 1 2 1 2 1 0 2 1 2 2 2 1 0 1 2 1 0 0 2 1 1 0 2 2 0 2 1 0 0 2 0 0 0 1 2 0 1 1 2 2 0 1 0 2 2 0 1 0 0 1 2 1 1 2 2 1 1 0 0 2 0 0 1 1 0] å»ºç«‹æ¨¡å‹ï¼è®­ç»ƒï¼é¢„æµ‹å®šä¹‰æ¨¡å—æ–¹å¼ KNeighborsClassifier()ï¼Œ ç”¨ fit æ¥è®­ç»ƒ training dataï¼Œè¿™ä¸€æ­¥å°±å®Œæˆäº†è®­ç»ƒçš„æ‰€æœ‰æ­¥éª¤ï¼Œ åé¢çš„ knn å°±å·²ç»æ˜¯è®­ç»ƒå¥½çš„æ¨¡å‹ï¼Œå¯ä»¥ç›´æ¥ç”¨æ¥ predict æµ‹è¯•é›†çš„æ•°æ®ï¼Œ å¯¹æ¯”ç”¨æ¨¡å‹é¢„æµ‹çš„å€¼ä¸çœŸå®çš„å€¼ï¼Œå¯ä»¥çœ‹åˆ°å¤§æ¦‚æ¨¡æ‹Ÿå‡ºäº†æ•°æ®ï¼Œä½†æ˜¯æœ‰è¯¯å·®ï¼Œæ˜¯ä¸ä¼šå®Œå®Œå…¨å…¨é¢„æµ‹æ­£ç¡®çš„ knn = KNeighborsClassifier()knn.fit(X_train, y_train)print(knn.predict(X_test))print(y_test) [1 0 1 0 1 2 0 1 0 1 2 1 1 1 2 2 1 2 0 1 2 0 0 2 1 2 1 1 0 1 1 0 2 2 2 0 1 0 2 0 2 0 1 2 1] [1 0 1 0 1 2 0 1 0 1 2 1 1 1 2 2 1 2 0 1 2 0 0 2 1 2 1 1 0 1 1 0 2 2 2 0 1 0 2 0 2 0 2 2 1] Reference scikit-learn.org scikit-learn docs scikit-learn morvanzhou","categories":[{"name":"python","slug":"python","permalink":"http://iequa.com/categories/python/"}],"tags":[{"name":"Sklearn","slug":"Sklearn","permalink":"http://iequa.com/tags/Sklearn/"}]},{"title":"Sklearn Common Attributes and Functions","slug":"python/sklearn/py-sklearn-4-common-attributes","date":"2018-01-05T06:15:21.000Z","updated":"2019-10-20T04:30:35.008Z","comments":true,"path":"2018/01/05/python/sklearn/py-sklearn-4-common-attributes/","link":"","permalink":"http://iequa.com/2018/01/05/python/sklearn/py-sklearn-4-common-attributes/","excerpt":"ä»Šå¤©æ¥çœ‹ Model çš„å±æ€§å’ŒåŠŸèƒ½, è¿™é‡Œä»¥ LinearRegressor ä¸ºä¾‹ï¼Œæ‰€ä»¥å…ˆå¯¼å…¥åŒ…ï¼Œæ•°æ®ï¼Œè¿˜æœ‰æ¨¡å‹","text":"ä»Šå¤©æ¥çœ‹ Model çš„å±æ€§å’ŒåŠŸèƒ½, è¿™é‡Œä»¥ LinearRegressor ä¸ºä¾‹ï¼Œæ‰€ä»¥å…ˆå¯¼å…¥åŒ…ï¼Œæ•°æ®ï¼Œè¿˜æœ‰æ¨¡å‹ from sklearn import datasetsfrom sklearn.linear_model import LinearRegressionloaded_data = datasets.load_boston()data_X = loaded_data.datadata_y = loaded_data.targetmodel = LinearRegression() è®­ç»ƒå’Œé¢„æµ‹æ¥ä¸‹æ¥ model.fit å’Œ model.predict å°±å±äº Model çš„åŠŸèƒ½ï¼Œç”¨æ¥è®­ç»ƒæ¨¡å‹ï¼Œç”¨è®­ç»ƒå¥½çš„æ¨¡å‹é¢„æµ‹ model.fit(data_X, data_y)print(model.predict(data_X[:4, :])) [ 30.00821269 25.0298606 30.5702317 28.60814055] å‚æ•°å’Œåˆ†æ•°model.coef_ å’Œ model.intercept_ å±äº Model çš„å±æ€§ï¼Œ ä¾‹å¦‚å¯¹äº LinearRegressor è¿™ä¸ªæ¨¡å‹ï¼Œè¿™ä¸¤ä¸ªå±æ€§åˆ†åˆ«è¾“å‡ºæ¨¡å‹çš„æ–œç‡å’Œæˆªè·ï¼ˆä¸yè½´çš„äº¤ç‚¹ï¼‰ print(model.coef_)print(model.intercept_) [ -1.07170557e-01 4.63952195e-02 2.08602395e-02 2.68856140e+00 -1.77957587e+01 3.80475246e+00 7.51061703e-04 -1.47575880e+00 3.05655038e-01 -1.23293463e-02 -9.53463555e-01 9.39251272e-03 -5.25466633e-01] 36.4911032804 model.get_params() ä¹Ÿæ˜¯åŠŸèƒ½ï¼Œå®ƒå¯ä»¥å–å‡ºä¹‹å‰å®šä¹‰çš„å‚æ•° print(model.get_params()) &#123;&#39;copy_X&#39;: True, &#39;fit_intercept&#39;: True, &#39;n_jobs&#39;: 1, &#39;normalize&#39;: False&#125; model.score(data_X, data_y) å®ƒå¯ä»¥å¯¹ Model ç”¨ R^2 çš„æ–¹å¼è¿›è¡Œæ‰“åˆ†ï¼Œè¾“å‡ºç²¾ç¡®åº¦ã€‚å…³äº R^2 coefficient of determination å¯ä»¥æŸ¥çœ‹ Coefficient_of_determination print(model.score(data_X, data_y)) # R^2 coefficient of determination 0.740607742865 æŒ‰æ ‡å‡†çš„æ¥è¯´, æ˜¯è¦å°†æ•°æ®åˆ†æˆè®­ç»ƒæ•°æ®å’Œæµ‹è¯•æ•°æ®, è¿™é‡Œä¸æ˜¯ä¸€ä¸ªå®Œæ•´çš„æµ‹è¯•, åªæ˜¯å±•ç¤º model é‡Œé¢çš„ä¸€äº›å±æ€§. æ­£ç¡®ç‡å¾ˆå°‘èƒ½çœŸæ­£100%, å–å†³äºæ‹Ÿåˆåº¦æ€ä¹ˆæ ·. æ‹Ÿåˆåº¦å¥½, æ­£ç¡®ç‡é«˜ Reference scikit-learn.org scikit-learn docs scikit-learn morvanzhou","categories":[{"name":"python","slug":"python","permalink":"http://iequa.com/categories/python/"}],"tags":[{"name":"Sklearn","slug":"Sklearn","permalink":"http://iequa.com/tags/Sklearn/"}]},{"title":"Sklearn DataSets","slug":"python/sklearn/py-sklearn-3-database","date":"2018-01-03T10:05:21.000Z","updated":"2019-10-20T04:30:35.009Z","comments":true,"path":"2018/01/03/python/sklearn/py-sklearn-3-database/","link":"","permalink":"http://iequa.com/2018/01/03/python/sklearn/py-sklearn-3-database/","excerpt":"Sklearn ä¸­çš„ data setsï¼Œå¾ˆå¤šè€Œä¸”æœ‰ç”¨ï¼Œå¯ä»¥ç”¨æ¥å­¦ä¹ ç®—æ³•æ¨¡å‹","text":"Sklearn ä¸­çš„ data setsï¼Œå¾ˆå¤šè€Œä¸”æœ‰ç”¨ï¼Œå¯ä»¥ç”¨æ¥å­¦ä¹ ç®—æ³•æ¨¡å‹ è¦ç‚¹eg: boston æˆ¿ä»·, ç³–å°¿ç—…, æ•°å­—, Iris èŠ±ã€‚ ä¹Ÿå¯ä»¥ç”Ÿæˆè™šæ‹Ÿçš„æ•°æ®ï¼Œä¾‹å¦‚ç”¨æ¥è®­ç»ƒçº¿æ€§å›å½’æ¨¡å‹çš„æ•°æ®ï¼Œå¯ä»¥ç”¨å‡½æ•°æ¥ç”Ÿæˆ ä¾‹å¦‚ï¼Œç‚¹å‡»è¿›å…¥ boston æˆ¿ä»·çš„æ•°æ®ï¼Œå¯ä»¥çœ‹åˆ° `sample` çš„æ€»æ•°ï¼Œå±æ€§ï¼Œä»¥åŠ `label` ç­‰ä¿¡æ¯ å¦‚æœæ˜¯è‡ªå·±ç”Ÿæˆæ•°æ®ï¼ŒæŒ‰ç…§å‡½æ•°çš„å½¢å¼ï¼Œè¾“å…¥ sampleï¼Œfeatureï¼Œtarget çš„ä¸ªæ•°ç­‰ç­‰ã€‚ sklearn.datasets.make_regression(n_samples=100, n_features=100, n_informative=10, n_targets=1, bias=0.0, effective_rank=None, tail_strength=0.5, noise=0.0, shuffle=True, coef=False, random_state=None)[source] æ¥ä¸‹æ¥ç”¨ä»£ç ç»ƒä¹ â€¦ å¯¼å…¥æ¨¡å—å¯¼å…¥ datasets åŒ…ï¼Œä»¥ Linear Regression ä¸ºä¾‹ from __future__ import print_functionfrom sklearn import datasetsfrom sklearn.linear_model import LinearRegressionimport matplotlib.pyplot as plt å¯¼å…¥æ•°æ®ï¼è®­ç»ƒæ¨¡å‹ç”¨ datasets.load_boston() çš„å½¢å¼åŠ è½½æ•°æ®ï¼Œå¹¶ç»™ X å’Œ y èµ‹å€¼ï¼Œè¿™ç§å½¢å¼åœ¨ Sklearn ä¸­éƒ½æ˜¯é«˜åº¦ç»Ÿä¸€çš„ loaded_data = datasets.load_boston()data_X = loaded_data.datadata_y = loaded_data.targetprint(data_X[:4, 0]) # == print(data_X[:4][0])print(data_y[:4]) [ 0.00632 0.02731 0.02729 0.03237] [ 24. 21.6 34.7 33.4] å®šä¹‰æ¨¡å‹ å¯ä»¥ç›´æ¥ç”¨é»˜è®¤å€¼å»å»ºç«‹ modelï¼Œé»˜è®¤å€¼ä¹Ÿä¸é”™ï¼Œä¹Ÿå¯ä»¥è‡ªå·±æ”¹å˜å‚æ•°ä½¿æ¨¡å‹æ›´å¥½ã€‚ ç„¶åç”¨ training data è®­ç»ƒæ¨¡å‹ model = LinearRegression()model.fit(data_X, data_y) LinearRegression(copy_X=True, fit_intercept=True, n_jobs=1, normalize=False) å†æ‰“å°å‡ºé¢„æµ‹å€¼ï¼Œè¿™é‡Œç”¨ X çš„å‰ 4 ä¸ªæ¥é¢„æµ‹ï¼ŒåŒæ—¶æ‰“å°çœŸå®å€¼ï¼Œä½œä¸ºå¯¹æ¯”ï¼Œå¯ä»¥çœ‹åˆ°æ˜¯æœ‰äº›è¯¯å·®çš„ print(model.predict(data_X[:4, :]))print(data_y[:4]) [ 30.00821269 25.0298606 30.5702317 28.60814055] [ 24. 21.6 34.7 33.4] ä¸ºäº†æé«˜å‡†ç¡®åº¦ï¼Œå¯ä»¥é€šè¿‡å°è¯•ä¸åŒçš„ modelï¼Œä¸åŒçš„å‚æ•°ï¼Œä¸åŒçš„é¢„å¤„ç†ç­‰æ–¹æ³•ï¼Œå…¥é—¨çš„è¯å¯ä»¥ç›´æ¥ç”¨é»˜è®¤å€¼ åˆ›å»ºè™šæ‹Ÿæ•°æ®ï¼å¯è§†åŒ–ä¸‹é¢æ˜¯åˆ›é€ æ•°æ®çš„ä¾‹å­ã€‚ ç”¨å‡½æ•°æ¥å»ºç«‹ 100 ä¸ª sampleï¼Œæœ‰ä¸€ä¸ª featureï¼Œå’Œä¸€ä¸ª targetï¼Œè¿™æ ·æ¯”è¾ƒæ–¹ä¾¿å¯è§†åŒ–ã€‚ X, y = datasets.make_regression(n_samples=100, n_features=1, n_targets=1, noise=3) ç”¨ scatter çš„å½¢å¼æ¥è¾“å‡ºç»“æœ plt.scatter(X, y)plt.show() å¯ä»¥çœ‹åˆ°ç”¨å‡½æ•°ç”Ÿæˆçš„ Linear Regression ç”¨çš„æ•°æ®ã€‚ noise è¶Šå¤§çš„è¯ï¼Œç‚¹å°±ä¼šè¶Šæ¥è¶Šç¦»æ•£ï¼Œä¾‹å¦‚ noise ç”± 10 å˜ä¸º 50. X, y = datasets.make_regression(n_samples=100, n_features=1, n_targets=1, noise=50)plt.scatter(X, y)plt.show() Reference scikit-learn.org scikit-learn docs scikit-learn machine_learning_map","categories":[{"name":"python","slug":"python","permalink":"http://iequa.com/categories/python/"}],"tags":[{"name":"Sklearn","slug":"Sklearn","permalink":"http://iequa.com/tags/Sklearn/"}]},{"title":"Sklearn Choosing The Right Estimator","slug":"python/sklearn/py-sklearn-1-choosing-estimator","date":"2018-01-03T05:22:21.000Z","updated":"2019-10-20T04:30:35.009Z","comments":true,"path":"2018/01/03/python/sklearn/py-sklearn-1-choosing-estimator/","link":"","permalink":"http://iequa.com/2018/01/03/python/sklearn/py-sklearn-1-choosing-estimator/","excerpt":"Sciki-learn é€‰æ‹©å­¦ä¹ æ–¹æ³•ï¼Œé€‰æ‹©æ¨¡å‹ æµç¨‹å›¾","text":"Sciki-learn é€‰æ‹©å­¦ä¹ æ–¹æ³•ï¼Œé€‰æ‹©æ¨¡å‹ æµç¨‹å›¾ Sklearn å®˜ç½‘æä¾›äº†ä¸€ä¸ªæµç¨‹å›¾ï¼Œè“è‰²åœ†åœˆå†…æ˜¯åˆ¤æ–­æ¡ä»¶ï¼Œç»¿è‰²æ–¹æ¡†å†…æ˜¯å¯ä»¥é€‰æ‹©çš„ç®—æ³•ï¼šè¯¦æƒ… ä» START å¼€å§‹ï¼Œé¦–å…ˆçœ‹æ•°æ®çš„æ ·æœ¬æ˜¯å¦ &gt;50ï¼Œå°äºåˆ™éœ€è¦æ”¶é›†æ›´å¤šçš„æ•°æ®ã€‚ ç”±å›¾ä¸­ï¼Œå¯ä»¥çœ‹åˆ°ç®—æ³•æœ‰å››ç±»ï¼Œåˆ†ç±»ï¼Œå›å½’ï¼Œèšç±»ï¼Œé™ç»´ã€‚ algorithm desc åˆ†ç±» ç›‘ç£å¼å­¦ä¹ ï¼Œå³æ¯ä¸ªæ•°æ®å¯¹åº”ä¸€ä¸ª label å›å½’ ç›‘ç£å¼å­¦ä¹ ï¼Œå³æ¯ä¸ªæ•°æ®å¯¹åº”ä¸€ä¸ª label èšç±» éç›‘ç£å¼å­¦ä¹ ï¼Œå³æ²¡æœ‰ labelã€‚ é™ç»´ å½“æ•°æ®é›†æœ‰å¾ˆå¤šå¾ˆå¤šå±æ€§çš„æ—¶å€™ï¼Œå¯ä»¥é€šè¿‡ é™ç»´ ç®—æ³•æŠŠå±æ€§å½’çº³èµ·æ¥ã€‚ ä¾‹å¦‚ 20 ä¸ªå±æ€§åªå˜æˆ 2 ä¸ªï¼Œæ³¨æ„ï¼Œè¿™ä¸æ˜¯æŒ‘å‡º 2 ä¸ªï¼Œè€Œæ˜¯å‹ç¼©æˆä¸º 2 ä¸ªï¼Œå®ƒä»¬é›†åˆäº† 20 ä¸ªå±æ€§çš„æ‰€æœ‰ç‰¹å¾ï¼Œç›¸å½“äºæŠŠé‡è¦çš„ä¿¡æ¯æå–çš„æ›´å¥½ï¼Œä¸é‡è¦çš„ä¿¡æ¯å°±ä¸è¦äº† ç„¶åçœ‹é—®é¢˜å±äºå“ªä¸€ç±»é—®é¢˜ï¼Œæ˜¯åˆ†ç±»è¿˜æ˜¯å›å½’ï¼Œè¿˜æ˜¯èšç±»ï¼Œå°±é€‰æ‹©ç›¸åº”çš„ç®—æ³•ã€‚ å½“ç„¶è¿˜è¦è€ƒè™‘æ•°æ®çš„å¤§å°ï¼Œä¾‹å¦‚ 100K æ˜¯ä¸€ä¸ªé˜ˆå€¼ã€‚ å¯ä»¥å‘ç°æœ‰äº›æ–¹æ³•æ˜¯æ—¢å¯ä»¥ä½œä¸ºåˆ†ç±»ï¼Œä¹Ÿå¯ä»¥ä½œä¸ºå›å½’ï¼Œä¾‹å¦‚ SGDã€‚ Reference scikit-learn.org scikit-learn docs scikit-learn machine_learning_map","categories":[{"name":"python","slug":"python","permalink":"http://iequa.com/categories/python/"}],"tags":[{"name":"Sklearn","slug":"Sklearn","permalink":"http://iequa.com/tags/Sklearn/"}]},{"title":"Sklearn Why ?","slug":"python/sklearn/py-sklearn-0-why","date":"2018-01-03T05:16:21.000Z","updated":"2019-10-20T04:30:35.010Z","comments":true,"path":"2018/01/03/python/sklearn/py-sklearn-0-why/","link":"","permalink":"http://iequa.com/2018/01/03/python/sklearn/py-sklearn-0-why/","excerpt":"Scikit learn ä¹Ÿç®€ç§° sklearn, æ˜¯æœºå™¨å­¦ä¹ é¢†åŸŸå½“ä¸­æœ€çŸ¥åçš„ python æ¨¡å—ä¹‹ä¸€.","text":"Scikit learn ä¹Ÿç®€ç§° sklearn, æ˜¯æœºå™¨å­¦ä¹ é¢†åŸŸå½“ä¸­æœ€çŸ¥åçš„ python æ¨¡å—ä¹‹ä¸€. Sklearn åŒ…å«äº†å¾ˆå¤šç§æœºå™¨å­¦ä¹ çš„æ–¹å¼: Classification åˆ†ç±» Regression å›å½’ Clustering éç›‘ç£åˆ†ç±» Dimensionality reduction æ•°æ®é™ç»´ Model Selection æ¨¡å‹é€‰æ‹© Preprocessing æ•°æ®é¢„å¤„ç† æˆ‘ä»¬æ€»èƒ½å¤Ÿä»è¿™äº›æ–¹æ³•ä¸­æŒ‘é€‰å‡ºä¸€ä¸ªé€‚åˆäºè‡ªå·±é—®é¢˜çš„, ç„¶åè§£å†³è‡ªå·±çš„é—®é¢˜. Reference scikit-learn.org scikit-learn docs morvanzhou","categories":[{"name":"python","slug":"python","permalink":"http://iequa.com/categories/python/"}],"tags":[{"name":"Matplotlib","slug":"Matplotlib","permalink":"http://iequa.com/tags/Matplotlib/"}]},{"title":"Lucyåœ°é“ç¾è¯­ è‹±è¯­å›½é™…éŸ³æ ‡","slug":"English/english-ielts-lucy-speaking","date":"2018-01-03T02:59:21.000Z","updated":"2019-10-20T04:30:35.031Z","comments":true,"path":"2018/01/03/English/english-ielts-lucy-speaking/","link":"","permalink":"http://iequa.com/2018/01/03/English/english-ielts-lucy-speaking/","excerpt":"ä¸€å®šè¦ä¸æ–­é‡å¤ï¼Œä¸è¦ç›¸ä¿¡è‡ªå·±çš„è€³æœµï¼Œè¦ç›¸ä¿¡éŸ³æ ‡ æœ€å¼€å§‹ç»ƒä¹ ï¼Œä¸€å®šè¦è¶…çº§å¤¸å¼ ï¼Œä¸€ä¸ªéŸ³ä¸€ä¸ªéŸ³è¯»","text":"ä¸€å®šè¦ä¸æ–­é‡å¤ï¼Œä¸è¦ç›¸ä¿¡è‡ªå·±çš„è€³æœµï¼Œè¦ç›¸ä¿¡éŸ³æ ‡ æœ€å¼€å§‹ç»ƒä¹ ï¼Œä¸€å®šè¦è¶…çº§å¤¸å¼ ï¼Œä¸€ä¸ªéŸ³ä¸€ä¸ªéŸ³è¯» 1. åˆ†ç»„å…ƒéŸ³ å…ƒéŸ³ 1 desc sample å…ƒéŸ³ 2 desc sample i: å¾®ç¬‘éŸ³ï¼Œå˜´å·´æ‹‰é•¿ pleaseã€sleep i å†›è®­éŸ³ bigã€pig e ä¸€ä¸ªæ‰‹æŒ‡éŸ³ eggã€bed Ã¦ å¤§å˜´å·´éŸ³ /É›/+/a:/ badã€dad a: å°¾éƒ¨å„¿è¯~ car, star É’ å˜´å¼ å¼€ã€æ— å˜åŒ– notã€lostã€job É”: æœ‰ç‚¹åƒ â€˜æ²ƒâ€™,å¤šå„¿è¯ horseã€short ÊŠ å‘éŸ³é åï¼Œè„–å­ä¸‹ goodã€shouldã€wouldã€could u: æ‚Ÿç©ºçš„â€˜æ‚Ÿâ€™æ‹‰é•¿ schoolã€room ÊŒ çŸ­å…ƒéŸ³ loveã€come Éœ: - birdã€first É™ - aboutã€asleepã€China eÉª - babyã€face aÉª - hi aÊŠ - cowã€how ÉªÉ™(r) - earã€dear eÉ™ - airã€hair É™ÊŠ - boatã€coat É”Éª - boyã€joy ÊŠÉ™ - sure /[ÊƒÊŠÉ™(r)]/ China É™ è¯å°¾å˜éŸ³ 2. æ¸…æµŠè¾…éŸ³ æ¸…è¾…éŸ³ desc sample æµŠè¾…éŸ³ desc sample p penã€map b bigã€job k bookã€week g eggã€dog f wifeã€knife v loveã€give s èˆŒå¤´æ”¾å˜´é‡Œ sinkã€sickã€monthã€niceã€rice z hisã€size Êƒ wishã€dish Ê’ usuallyã€vision Î¸ ç”¨åŠ›åèˆŒå¤´ thinkã€thickã€mouthã€monthã€bath Ã° withã€smooth r sorryã€story h handã€home tÊƒ teachã€lunch dÊ’ pageã€large tr treeã€trip dr dressã€dry ts catsã€hats dz bedsã€cards m momã€some n penã€sonã€sun Å‹ drink l letã€ball w whyã€water j yearã€yellow clothes [klÉ™ÊŠÃ°z] 3. Part of Speech","categories":[{"name":"English","slug":"English","permalink":"http://iequa.com/categories/English/"}],"tags":[{"name":"IELTS","slug":"IELTS","permalink":"http://iequa.com/tags/IELTS/"}]},{"title":"Matplotlib Figure","slug":"python/matplotlib/py-matplotlib-3-figure-image","date":"2018-01-01T05:08:21.000Z","updated":"2019-10-20T04:30:35.012Z","comments":true,"path":"2018/01/01/python/matplotlib/py-matplotlib-3-figure-image/","link":"","permalink":"http://iequa.com/2018/01/01/python/matplotlib/py-matplotlib-3-figure-image/","excerpt":"matplotlib çš„ figure å°±æ˜¯ä¸€ä¸ª å•ç‹¬çš„ figure å°çª—å£, å°çª—å£é‡Œé¢è¿˜å¯ä»¥æœ‰æ›´å¤šçš„å°å›¾ç‰‡","text":"matplotlib çš„ figure å°±æ˜¯ä¸€ä¸ª å•ç‹¬çš„ figure å°çª—å£, å°çª—å£é‡Œé¢è¿˜å¯ä»¥æœ‰æ›´å¤šçš„å°å›¾ç‰‡ import matplotlib.pyplot as pltimport numpy as np ä½¿ç”¨np.linspaceå®šä¹‰xï¼šèŒƒå›´æ˜¯(-3,3);ä¸ªæ•°æ˜¯50. ä»¿çœŸä¸€ç»´æ•°æ®ç»„(x ,y1)è¡¨ç¤ºæ›²çº¿1. ä»¿çœŸä¸€ç»´æ•°æ®ç»„(x ,y2)è¡¨ç¤ºæ›²çº¿2. x = np.linspace(-3, 3, 50)y1 = 2*x + 1y2 = x**2 ä½¿ç”¨plt.figureå®šä¹‰ä¸€ä¸ªå›¾åƒçª—å£. ä½¿ç”¨plt.plotç”»(x ,y1)æ›²çº¿. plt.figure()plt.plot(x, y1)plt.show() ä½¿ç”¨plt.figureå®šä¹‰ä¸€ä¸ªå›¾åƒçª—å£ï¼šç¼–å·ä¸º3ï¼›å¤§å°ä¸º(8, 5). ä½¿ç”¨plt.plotç”»(x ,y2)æ›²çº¿.ä½¿ç”¨plt.plotç”»(x ,y1)æ›²çº¿ï¼Œæ›²çº¿çš„é¢œè‰²å±æ€§(color)ä¸ºçº¢è‰²;æ›²çº¿çš„å®½åº¦(linewidth)ä¸º1.0ï¼›æ›²çº¿çš„ç±»å‹(linestyle)ä¸ºè™šçº¿. ä½¿ç”¨plt.showæ˜¾ç¤ºå›¾åƒ. plt.figure(num=3, figsize=(8, 5),)plt.plot(x, y2)plt.plot(x, y1, color=&#x27;red&#x27;, linewidth=1.0, linestyle=&#x27;--&#x27;)plt.show() Set Coordinate axisä½¿ç”¨plt.xlimè®¾ç½®xåæ ‡è½´èŒƒå›´ï¼š(-1, 2)ï¼› ä½¿ç”¨plt.ylimè®¾ç½®yåæ ‡è½´èŒƒå›´ï¼š(-2, 3)ï¼›ä½¿ç”¨plt.xlabelè®¾ç½®xåæ ‡è½´åç§°ï¼šâ€™I am xâ€™ï¼› ä½¿ç”¨plt.ylabelè®¾ç½®yåæ ‡è½´åç§°ï¼šâ€™I am yâ€™ï¼› plt.figure(num=3, figsize=(8, 5),)plt.plot(x, y2)plt.plot(x, y1, color=&#x27;red&#x27;, linewidth=1.0, linestyle=&#x27;--&#x27;)plt.xlim((-1, 2))plt.ylim((-2, 3))plt.xlabel(&#x27;I am x&#x27;)plt.ylabel(&#x27;I am y&#x27;)plt.show() ä½¿ç”¨ np.linspace å®šä¹‰èŒƒå›´ä»¥åŠä¸ªæ•°ï¼šèŒƒå›´æ˜¯(-1,2);ä¸ªæ•°æ˜¯5.ä½¿ç”¨ print æ‰“å°å‡ºæ–°å®šä¹‰çš„èŒƒå›´.ä½¿ç”¨ plt.xticks è®¾ç½®xè½´åˆ»åº¦ï¼šèŒƒå›´æ˜¯(-1,2);ä¸ªæ•°æ˜¯5. plt.figure(num=3, figsize=(8, 5),)plt.plot(x, y2)plt.plot(x, y1, color=&#x27;red&#x27;, linewidth=1.0, linestyle=&#x27;--&#x27;)plt.xlim((-1, 2))plt.ylim((-2, 3))plt.xlabel(&#x27;I am x&#x27;)plt.ylabel(&#x27;I am y&#x27;)new_ticks = np.linspace(-1, 2, 5)print(new_ticks)plt.xticks(new_ticks) [-1. -0.25 0.5 1.25 2. ] ([&lt;matplotlib.axis.XTick at 0x11dd68ba8&gt;, &lt;matplotlib.axis.XTick at 0x11dd68a58&gt;, &lt;matplotlib.axis.XTick at 0x11dd7d5c0&gt;, &lt;matplotlib.axis.XTick at 0x11e04af28&gt;, &lt;matplotlib.axis.XTick at 0x11e0515c0&gt;], &lt;a list of 5 Text xticklabel objects&gt;) ä½¿ç”¨plt.yticksè®¾ç½®yè½´åˆ»åº¦ä»¥åŠåç§°ï¼šåˆ»åº¦ä¸º[-2, -1.8, -1, 1.22, 3]ï¼›å¯¹åº”åˆ»åº¦çš„åç§°ä¸º[â€˜really badâ€™,â€™badâ€™,â€™normalâ€™,â€™goodâ€™, â€˜really goodâ€™]. ä½¿ç”¨plt.showæ˜¾ç¤ºå›¾åƒ. plt.yticks([-2, -1.8, -1, 1.22, 3],[r&#x27;$really\\ bad$&#x27;, r&#x27;$bad$&#x27;, r&#x27;$normal$&#x27;, r&#x27;$good$&#x27;, r&#x27;$really\\ good$&#x27;])plt.show() Reference matplotlib.org matplotlib docs morvanzhou","categories":[{"name":"python","slug":"python","permalink":"http://iequa.com/categories/python/"}],"tags":[{"name":"Matplotlib","slug":"Matplotlib","permalink":"http://iequa.com/tags/Matplotlib/"}]},{"title":"Matplotlib Basic Use","slug":"python/matplotlib/py-matplotlib-2-basic-use","date":"2018-01-01T04:46:21.000Z","updated":"2019-10-20T04:30:35.011Z","comments":true,"path":"2018/01/01/python/matplotlib/py-matplotlib-2-basic-use/","link":"","permalink":"http://iequa.com/2018/01/01/python/matplotlib/py-matplotlib-2-basic-use/","excerpt":"Matplotlib æœ€åŸºæœ¬çš„ä½¿ç”¨ä»‹ç»","text":"Matplotlib æœ€åŸºæœ¬çš„ä½¿ç”¨ä»‹ç» åŸºç¡€åº”ç”¨ä½¿ç”¨importå¯¼å…¥æ¨¡å—matplotlib.pyplotï¼Œå¹¶ç®€å†™æˆplt ä½¿ç”¨importå¯¼å…¥æ¨¡å—numpyï¼Œå¹¶ç®€å†™æˆnp import matplotlib.pyplot as pltimport numpy as np np.linspace(-1, 1, 50) array([-1. , -0.95918367, -0.91836735, -0.87755102, -0.83673469, -0.79591837, -0.75510204, -0.71428571, -0.67346939, -0.63265306, -0.59183673, -0.55102041, -0.51020408, -0.46938776, -0.42857143, -0.3877551 , -0.34693878, -0.30612245, -0.26530612, -0.2244898 , -0.18367347, -0.14285714, -0.10204082, -0.06122449, -0.02040816, 0.02040816, 0.06122449, 0.10204082, 0.14285714, 0.18367347, 0.2244898 , 0.26530612, 0.30612245, 0.34693878, 0.3877551 , 0.42857143, 0.46938776, 0.51020408, 0.55102041, 0.59183673, 0.63265306, 0.67346939, 0.71428571, 0.75510204, 0.79591837, 0.83673469, 0.87755102, 0.91836735, 0.95918367, 1. ]) ä½¿ç”¨ np.linspace å®šä¹‰xï¼šèŒƒå›´æ˜¯(-1,1); ä¸ªæ•°æ˜¯50. ä»¿çœŸä¸€ç»´æ•°æ®ç»„(x ,y)è¡¨ç¤ºæ›²çº¿1. x = np.linspace(-1, 1, 50)y = 2*x + 1 ä½¿ç”¨plt.figureå®šä¹‰ä¸€ä¸ªå›¾åƒçª—å£. ä½¿ç”¨plt.plotç”»(x ,y)æ›²çº¿. ä½¿ç”¨plt.showæ˜¾ç¤ºå›¾åƒ. plt.figure()plt.plot(x, y)plt.show() Reference matplotlib.org matplotlib docs morvanzhou","categories":[{"name":"python","slug":"python","permalink":"http://iequa.com/categories/python/"}],"tags":[{"name":"Matplotlib","slug":"Matplotlib","permalink":"http://iequa.com/tags/Matplotlib/"}]},{"title":"Matplotlib Why ?","slug":"python/matplotlib/py-matplotlib-1-why","date":"2018-01-01T04:12:21.000Z","updated":"2019-10-20T04:30:35.012Z","comments":true,"path":"2018/01/01/python/matplotlib/py-matplotlib-1-why/","link":"","permalink":"http://iequa.com/2018/01/01/python/matplotlib/py-matplotlib-1-why/","excerpt":"Matplotlib æ˜¯ä¸€ä¸ªéå¸¸å¼ºå¤§çš„ Python ç”»å›¾å·¥å…·","text":"Matplotlib æ˜¯ä¸€ä¸ªéå¸¸å¼ºå¤§çš„ Python ç”»å›¾å·¥å…· Matplotlib å®ƒèƒ½å¸®ä½ ç”»å‡ºç¾ä¸½çš„: çº¿å›¾; æ•£ç‚¹å›¾; ç­‰é«˜çº¿å›¾; æ¡å½¢å›¾; æŸ±çŠ¶å›¾; 3D å›¾å½¢, ç”šè‡³æ˜¯å›¾å½¢åŠ¨ç”»ç­‰ç­‰. ä¸‹é¢æ˜¯ä¸€äº›ä¾‹å›¾: Reference matplotlib.org matplotlib docs morvanzhou","categories":[{"name":"python","slug":"python","permalink":"http://iequa.com/categories/python/"}],"tags":[{"name":"Matplotlib","slug":"Matplotlib","permalink":"http://iequa.com/tags/Matplotlib/"}]},{"title":"Pandas Matplotlib Intro","slug":"python/numpy-pandas/py-pandas-8-matplotlib","date":"2017-12-31T03:12:21.000Z","updated":"2019-10-20T04:30:35.003Z","comments":true,"path":"2017/12/31/python/numpy-pandas/py-pandas-8-matplotlib/","link":"","permalink":"http://iequa.com/2017/12/31/python/numpy-pandas/py-pandas-8-matplotlib/","excerpt":"matplotlib å°†æ•°æ®å¯è§†åŒ–. ä»…ä»…æ˜¯ç”¨æ¥ show å›¾ç‰‡çš„, å³ plt.show()","text":"matplotlib å°†æ•°æ®å¯è§†åŒ–. ä»…ä»…æ˜¯ç”¨æ¥ show å›¾ç‰‡çš„, å³ plt.show() import pandas as pdimport numpy as npimport matplotlib.pyplot as plt åˆ›å»ºä¸€ä¸ªSeriesè¿™æ˜¯ä¸€ä¸ªçº¿æ€§çš„æ•°æ®ï¼Œæˆ‘ä»¬éšæœºç”Ÿæˆ1000ä¸ªæ•°æ®ï¼ŒSeries é»˜è®¤çš„ index å°±æ˜¯ä»0å¼€å§‹çš„æ•´æ•° # éšæœºç”Ÿæˆ1000ä¸ªæ•°æ®data = pd.Series(np.random.randn(1000),index=np.arange(1000)) # pandas æ•°æ®å¯ä»¥ç›´æ¥è§‚çœ‹å…¶å¯è§†åŒ–å½¢å¼data.plot()plt.show() å¯ä»¥ä½¿ç”¨ plt.plot(x=, y=)ï¼ŒæŠŠx,yçš„æ•°æ®ä½œä¸ºå‚æ•°å­˜è¿›å»ï¼Œä½†æ˜¯dataæœ¬æ¥å°±æ˜¯ä¸€ä¸ªæ•°æ®ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç›´æ¥plot Dataframe å¯è§†åŒ–æˆ‘ä»¬ç”Ÿæˆä¸€ä¸ª 1000*4 çš„ DataFrameï¼Œå¹¶å¯¹ä»–ä»¬ç´¯åŠ  data = pd.DataFrame( np.random.randn(1000,4), index=np.arange(1000), columns=list(&quot;ABCD&quot;) )#data.cumsum()print(data)data.plot()plt.show() A B C D 0 1.163604 -0.689103 1.958018 0.241444 1 0.595765 0.816026 1.573164 -0.443003 2 -0.101446 0.768321 -0.203069 -0.638841 3 -0.439233 -0.161273 0.398774 1.309622 4 -0.524647 -0.180073 -1.499978 0.628436 5 -0.305683 0.668840 0.243668 -1.386839 .. ... ... ... ... 998 -0.243955 -0.190122 -0.299633 3.350200 999 -0.055184 0.936187 0.146156 0.604271 [1000 rows x 4 columns] è¿™ä¸ªå°±æ˜¯æˆ‘ä»¬åˆšåˆšç”Ÿæˆçš„4ä¸ªcolumnçš„æ•°æ®ï¼Œå› ä¸ºæœ‰4ç»„æ•°æ®ï¼Œæ‰€ä»¥4ç»„æ•°æ®ä¼šåˆ†åˆ«plotå‡ºæ¥ã€‚ plot å¯ä»¥æŒ‡å®šå¾ˆå¤šå‚æ•°ï¼Œå…·ä½“å‚è§å®˜æ–¹æ–‡æ¡£ é™¤äº†plotï¼Œæˆ‘ç»å¸¸ä¼šç”¨åˆ°è¿˜æœ‰scatterï¼Œè¿™ä¸ªä¼šæ˜¾ç¤ºæ•£ç‚¹å›¾ï¼Œé¦–å…ˆè¯´ä¸€ä¸‹åœ¨ pandas ä¸­æœ‰å¤šå°‘ç§æ–¹æ³• bar hist box kde area scatter hexbin ä¸»è¦è¯´ä¸€ä¸‹ plot å’Œ scatter. å› ä¸º scatter åªæœ‰ xï¼Œy ä¸¤ä¸ªå±æ€§ï¼Œå¯ä»¥åˆ†åˆ«ç»™ x, y æŒ‡å®šæ•°æ® ax = data.plot.scatter(x=&#x27;A&#x27;,y=&#x27;B&#x27;,color=&#x27;DarkBlue&#x27;,label=&#x27;Class1&#x27;) ç„¶åæˆ‘ä»¬åœ¨å¯ä»¥å†ç”»ä¸€ä¸ªåœ¨åŒä¸€ä¸ªaxä¸Šé¢ï¼Œé€‰æ‹©ä¸ä¸€æ ·çš„æ•°æ®åˆ—ï¼Œä¸åŒçš„ color å’Œ label # å°†ä¹‹ä¸‹è¿™ä¸ª data ç”»åœ¨ä¸Šä¸€ä¸ª ax ä¸Šé¢data.plot.scatter(x=&#x27;A&#x27;,y=&#x27;C&#x27;,color=&#x27;LightGreen&#x27;,label=&#x27;Class2&#x27;,ax=ax)plt.show() ä¸¤ç§å‘ˆç°æ–¹å¼ï¼Œä¸€ç§æ˜¯çº¿æ€§çš„æ–¹å¼ï¼Œä¸€ç§æ˜¯æ•£ç‚¹å›¾ Reference pandas.pydata.org pandas docs morvanzhou","categories":[{"name":"python","slug":"python","permalink":"http://iequa.com/categories/python/"}],"tags":[{"name":"Pandas","slug":"Pandas","permalink":"http://iequa.com/tags/Pandas/"}]},{"title":"Pandas Merge","slug":"python/numpy-pandas/py-pandas-7-merge","date":"2017-12-31T02:12:21.000Z","updated":"2019-10-20T04:30:35.000Z","comments":true,"path":"2017/12/31/python/numpy-pandas/py-pandas-7-merge/","link":"","permalink":"http://iequa.com/2017/12/31/python/numpy-pandas/py-pandas-7-merge/","excerpt":"pandasä¸­çš„mergeå’Œconcatç±»ä¼¼,ä½†ä¸»è¦æ˜¯ç”¨äºä¸¤ç»„æœ‰key columnçš„æ•°æ®,ç»Ÿä¸€ç´¢å¼•çš„æ•°æ®.","text":"pandasä¸­çš„mergeå’Œconcatç±»ä¼¼,ä½†ä¸»è¦æ˜¯ç”¨äºä¸¤ç»„æœ‰key columnçš„æ•°æ®,ç»Ÿä¸€ç´¢å¼•çš„æ•°æ®. ä¾æ®ä¸€ç»„keyåˆå¹¶import pandas as pd#å®šä¹‰èµ„æ–™é›†å¹¶æ‰“å°å‡ºleft = pd.DataFrame(&#123;&#x27;key&#x27;: [&#x27;K0&#x27;, &#x27;K1&#x27;, &#x27;K2&#x27;, &#x27;K3&#x27;], &#x27;A&#x27;: [&#x27;A0&#x27;, &#x27;A1&#x27;, &#x27;A2&#x27;, &#x27;A3&#x27;], &#x27;B&#x27;: [&#x27;B0&#x27;, &#x27;B1&#x27;, &#x27;B2&#x27;, &#x27;B3&#x27;]&#125;)right = pd.DataFrame(&#123;&#x27;key&#x27;: [&#x27;K0&#x27;, &#x27;K1&#x27;, &#x27;K2&#x27;, &#x27;K3&#x27;], &#x27;C&#x27;: [&#x27;C0&#x27;, &#x27;C1&#x27;, &#x27;C2&#x27;, &#x27;C3&#x27;], &#x27;D&#x27;: [&#x27;D0&#x27;, &#x27;D1&#x27;, &#x27;D2&#x27;, &#x27;D3&#x27;]&#125;)# print(left)# A B key# 0 A0 B0 K0# 1 A1 B1 K1# 2 A2 B2 K2# 3 A3 B3 K3# print(right)# C D key# 0 C0 D0 K0# 1 C1 D1 K1# 2 C2 D2 K2# 3 C3 D3 K3#ä¾æ®key columnåˆå¹¶ï¼Œå¹¶æ‰“å°å‡ºres = pd.merge(left, right, on=&#x27;key&#x27;)print(res) A B key C D 0 A0 B0 K0 C0 D0 1 A1 B1 K1 C1 D1 2 A2 B2 K2 C2 D2 3 A3 B3 K3 C3 D3 ä¾æ®ä¸¤ç»„keyåˆå¹¶åˆå¹¶æ—¶æœ‰4ç§æ–¹æ³•how = [&#39;left&#39;, &#39;right&#39;, &#39;outer&#39;, &#39;inner&#39;]ï¼Œé¢„è®¾å€¼how=&#39;inner&#39; import pandas as pd#å®šä¹‰èµ„æ–™é›†å¹¶æ‰“å°å‡ºleft = pd.DataFrame(&#123;&#x27;key1&#x27;: [&#x27;K0&#x27;, &#x27;K0&#x27;, &#x27;K1&#x27;, &#x27;K2&#x27;], &#x27;key2&#x27;: [&#x27;K0&#x27;, &#x27;K1&#x27;, &#x27;K0&#x27;, &#x27;K1&#x27;], &#x27;A&#x27;: [&#x27;A0&#x27;, &#x27;A1&#x27;, &#x27;A2&#x27;, &#x27;A3&#x27;], &#x27;B&#x27;: [&#x27;B0&#x27;, &#x27;B1&#x27;, &#x27;B2&#x27;, &#x27;B3&#x27;]&#125;)right = pd.DataFrame(&#123;&#x27;key1&#x27;: [&#x27;K0&#x27;, &#x27;K1&#x27;, &#x27;K1&#x27;, &#x27;K2&#x27;], &#x27;key2&#x27;: [&#x27;K0&#x27;, &#x27;K0&#x27;, &#x27;K0&#x27;, &#x27;K0&#x27;], &#x27;C&#x27;: [&#x27;C0&#x27;, &#x27;C1&#x27;, &#x27;C2&#x27;, &#x27;C3&#x27;], &#x27;D&#x27;: [&#x27;D0&#x27;, &#x27;D1&#x27;, &#x27;D2&#x27;, &#x27;D3&#x27;]&#125;)print(left)# A B key1 key2# 0 A0 B0 K0 K0# 1 A1 B1 K0 K1# 2 A2 B2 K1 K0# 3 A3 B3 K2 K1print(right)# C D key1 key2# 0 C0 D0 K0 K0# 1 C1 D1 K1 K0# 2 C2 D2 K1 K0# 3 C3 D3 K2 K0#ä¾æ®key1ä¸key2 columnsè¿›è¡Œåˆå¹¶ï¼Œå¹¶æ‰“å°å‡ºå››ç§ç»“æœ[&#x27;left&#x27;, &#x27;right&#x27;, &#x27;outer&#x27;, &#x27;inner&#x27;]res = pd.merge(left, right, on=[&#x27;key1&#x27;, &#x27;key2&#x27;], how=&#x27;inner&#x27;)print(res)# A B key1 key2 C D# 0 A0 B0 K0 K0 C0 D0# 1 A2 B2 K1 K0 C1 D1# 2 A2 B2 K1 K0 C2 D2res = pd.merge(left, right, on=[&#x27;key1&#x27;, &#x27;key2&#x27;], how=&#x27;outer&#x27;)print(res)# A B key1 key2 C D# 0 A0 B0 K0 K0 C0 D0# 1 A1 B1 K0 K1 NaN NaN# 2 A2 B2 K1 K0 C1 D1# 3 A2 B2 K1 K0 C2 D2# 4 A3 B3 K2 K1 NaN NaN# 5 NaN NaN K2 K0 C3 D3res = pd.merge(left, right, on=[&#x27;key1&#x27;, &#x27;key2&#x27;], how=&#x27;left&#x27;)print(res)# A B key1 key2 C D# 0 A0 B0 K0 K0 C0 D0# 1 A1 B1 K0 K1 NaN NaN# 2 A2 B2 K1 K0 C1 D1# 3 A2 B2 K1 K0 C2 D2# 4 A3 B3 K2 K1 NaN NaNres = pd.merge(left, right, on=[&#x27;key1&#x27;, &#x27;key2&#x27;], how=&#x27;right&#x27;)print(res)# A B key1 key2 C D# 0 A0 B0 K0 K0 C0 D0# 1 A2 B2 K1 K0 C1 D1# 2 A2 B2 K1 K0 C2 D2# 3 NaN NaN K2 K0 C3 D3 Indicatorindicator=Trueä¼šå°†åˆå¹¶çš„è®°å½•æ”¾åœ¨æ–°çš„ä¸€åˆ— import pandas as pd#å®šä¹‰èµ„æ–™é›†å¹¶æ‰“å°å‡ºdf1 = pd.DataFrame(&#123;&#x27;col1&#x27;:[0,1], &#x27;col_left&#x27;:[&#x27;a&#x27;,&#x27;b&#x27;]&#125;)df2 = pd.DataFrame(&#123;&#x27;col1&#x27;:[1,2,2],&#x27;col_right&#x27;:[2,2,2]&#125;)print(df1)# col1 col_left# 0 0 a# 1 1 bprint(df2)# col1 col_right# 0 1 2# 1 2 2# 2 2 2# ä¾æ®col1è¿›è¡Œåˆå¹¶ï¼Œå¹¶å¯ç”¨indicator=Trueï¼Œæœ€åæ‰“å°å‡ºres = pd.merge(df1, df2, on=&#x27;col1&#x27;, how=&#x27;outer&#x27;, indicator=True)print(res)# col1 col_left col_right _merge# 0 0.0 a NaN left_only# 1 1.0 b 2.0 both# 2 2.0 NaN 2.0 right_only# 3 2.0 NaN 2.0 right_only# è‡ªå®šindicator columnçš„åç§°ï¼Œå¹¶æ‰“å°å‡ºres = pd.merge(df1, df2, on=&#x27;col1&#x27;, how=&#x27;outer&#x27;, indicator=&#x27;indicator_column&#x27;)print(res)# col1 col_left col_right indicator_column# 0 0.0 a NaN left_only# 1 1.0 b 2.0 both# 2 2.0 NaN 2.0 right_only# 3 2.0 NaN 2.0 right_only col1 col_left 0 0 a 1 1 b col1 col_right 0 1 2 1 2 2 2 2 2 col1 col_left col_right _merge 0 0 a NaN left_only 1 1 b 2.0 both 2 2 NaN 2.0 right_only 3 2 NaN 2.0 right_only col1 col_left col_right indicator_column 0 0 a NaN left_only 1 1 b 2.0 both 2 2 NaN 2.0 right_only 3 2 NaN 2.0 right_only ä¾æ®indexåˆå¹¶import pandas as pd#å®šä¹‰èµ„æ–™é›†å¹¶æ‰“å°å‡ºleft = pd.DataFrame(&#123;&#x27;A&#x27;: [&#x27;A0&#x27;, &#x27;A1&#x27;, &#x27;A2&#x27;], &#x27;B&#x27;: [&#x27;B0&#x27;, &#x27;B1&#x27;, &#x27;B2&#x27;]&#125;, index=[&#x27;K0&#x27;, &#x27;K1&#x27;, &#x27;K2&#x27;])right = pd.DataFrame(&#123;&#x27;C&#x27;: [&#x27;C0&#x27;, &#x27;C2&#x27;, &#x27;C3&#x27;], &#x27;D&#x27;: [&#x27;D0&#x27;, &#x27;D2&#x27;, &#x27;D3&#x27;]&#125;, index=[&#x27;K0&#x27;, &#x27;K2&#x27;, &#x27;K3&#x27;])print(left)# A B# K0 A0 B0# K1 A1 B1# K2 A2 B2print(right)# C D# K0 C0 D0# K2 C2 D2# K3 C3 D3#ä¾æ®å·¦å³èµ„æ–™é›†çš„indexè¿›è¡Œåˆå¹¶ï¼Œhow=&#x27;outer&#x27;,å¹¶æ‰“å°å‡ºres = pd.merge(left, right, left_index=True, right_index=True, how=&#x27;outer&#x27;)print(res)# A B C D# K0 A0 B0 C0 D0# K1 A1 B1 NaN NaN# K2 A2 B2 C2 D2# K3 NaN NaN C3 D3#ä¾æ®å·¦å³èµ„æ–™é›†çš„indexè¿›è¡Œåˆå¹¶ï¼Œhow=&#x27;inner&#x27;,å¹¶æ‰“å°å‡ºres = pd.merge(left, right, left_index=True, right_index=True, how=&#x27;inner&#x27;)print(res)# A B C D# K0 A0 B0 C0 D0# K2 A2 B2 C2 D2 A B K0 A0 B0 K1 A1 B1 K2 A2 B2 C D K0 C0 D0 K2 C2 D2 K3 C3 D3 A B C D K0 A0 B0 C0 D0 K1 A1 B1 NaN NaN K2 A2 B2 C2 D2 K3 NaN NaN C3 D3 A B C D K0 A0 B0 C0 D0 K2 A2 B2 C2 D2 è§£å†³overlappingçš„é—®é¢˜import pandas as pd#å®šä¹‰èµ„æ–™é›†boys = pd.DataFrame(&#123;&#x27;k&#x27;: [&#x27;K0&#x27;, &#x27;K1&#x27;, &#x27;K2&#x27;], &#x27;age&#x27;: [1, 2, 3]&#125;)girls = pd.DataFrame(&#123;&#x27;k&#x27;: [&#x27;K0&#x27;, &#x27;K0&#x27;, &#x27;K3&#x27;], &#x27;age&#x27;: [4, 5, 6]&#125;)print(boys)print(girls)#ä½¿ç”¨suffixesè§£å†³overlappingçš„é—®é¢˜res = pd.merge(boys, girls, on=&#x27;k&#x27;, suffixes=[&#x27;_boy&#x27;, &#x27;_girl&#x27;], how=&#x27;inner&#x27;)print(res) age k 0 1 K0 1 2 K1 2 3 K2 age k 0 4 K0 1 5 K0 2 6 K3 age_boy k age_girl 0 1 K0 4 1 1 K0 5 pandas ä¹Ÿæœ‰ join å’Œ merge æ˜¯ç±»ä¼¼çš„ï¼Œå¦‚éœ€è¦ä½¿ç”¨ï¼Œè¯·å‚è€ƒå®˜æ–¹æ–‡æ¡£ Reference pandas.pydata.org pandas docs morvanzhou","categories":[{"name":"python","slug":"python","permalink":"http://iequa.com/categories/python/"}],"tags":[{"name":"Pandas","slug":"Pandas","permalink":"http://iequa.com/tags/Pandas/"}]},{"title":"Pandas Concatã€Joinã€join_axesã€append","slug":"python/numpy-pandas/py-pandas-6-concat-join-append","date":"2017-12-31T01:22:21.000Z","updated":"2019-10-20T04:30:35.002Z","comments":true,"path":"2017/12/31/python/numpy-pandas/py-pandas-6-concat-join-append/","link":"","permalink":"http://iequa.com/2017/12/31/python/numpy-pandas/py-pandas-6-concat-join-append/","excerpt":"pandas å¤„ç†å¤šç»„æ•°æ®çš„æ—¶å€™å¾€å¾€ä¼šè¦ç”¨åˆ°æ•°æ®çš„åˆå¹¶å¤„ç†,ä½¿ç”¨ concat æ˜¯ä¸€ç§åŸºæœ¬çš„åˆå¹¶æ–¹å¼.è€Œä¸” concat ä¸­æœ‰å¾ˆå¤šå‚æ•°å¯ä»¥è°ƒæ•´,åˆå¹¶æˆä½ æƒ³è¦çš„æ•°æ®å½¢å¼.","text":"pandas å¤„ç†å¤šç»„æ•°æ®çš„æ—¶å€™å¾€å¾€ä¼šè¦ç”¨åˆ°æ•°æ®çš„åˆå¹¶å¤„ç†,ä½¿ç”¨ concat æ˜¯ä¸€ç§åŸºæœ¬çš„åˆå¹¶æ–¹å¼.è€Œä¸” concat ä¸­æœ‰å¾ˆå¤šå‚æ•°å¯ä»¥è°ƒæ•´,åˆå¹¶æˆä½ æƒ³è¦çš„æ•°æ®å½¢å¼. axis (åˆå¹¶æ–¹å‘)axis=0 æ˜¯é¢„è®¾å€¼ï¼Œå› æ­¤æœªè®¾å®šä»»ä½•å‚æ•°æ—¶ï¼Œé»˜è®¤axis=0 import pandas as pdimport numpy as np#å®šä¹‰èµ„æ–™é›†df1 = pd.DataFrame(np.ones((3,4))*0, columns=[&#x27;a&#x27;,&#x27;b&#x27;,&#x27;c&#x27;,&#x27;d&#x27;])df2 = pd.DataFrame(np.ones((3,4))*1, columns=[&#x27;a&#x27;,&#x27;b&#x27;,&#x27;c&#x27;,&#x27;d&#x27;])df3 = pd.DataFrame(np.ones((3,4))*2, columns=[&#x27;a&#x27;,&#x27;b&#x27;,&#x27;c&#x27;,&#x27;d&#x27;])#concatçºµå‘åˆå¹¶res = pd.concat([df1, df2, df3], axis=0)#æ‰“å°ç»“æœprint(res) a b c d 0 0.0 0.0 0.0 0.0 1 0.0 0.0 0.0 0.0 2 0.0 0.0 0.0 0.0 0 1.0 1.0 1.0 1.0 1 1.0 1.0 1.0 1.0 2 1.0 1.0 1.0 1.0 0 2.0 2.0 2.0 2.0 1 2.0 2.0 2.0 2.0 2 2.0 2.0 2.0 2.0 ä»”ç»†è§‚å¯Ÿä¼šå‘ç°ç»“æœçš„indexæ˜¯0, 1, 2, 0, 1, 2, 0, 1, 2ï¼Œè‹¥è¦å°†indexé‡ç½®ï¼Œè¯·çœ‹ä¾‹å­äºŒã€‚ ignore_index (é‡ç½® index)#æ‰¿ä¸Šä¸€ä¸ªä¾‹å­ï¼Œå¹¶å°†index_ignoreè®¾å®šä¸ºTrueres = pd.concat([df1, df2, df3], axis=0, ignore_index=True)#æ‰“å°ç»“æœprint(res) a b c d 0 0.0 0.0 0.0 0.0 1 0.0 0.0 0.0 0.0 2 0.0 0.0 0.0 0.0 3 1.0 1.0 1.0 1.0 4 1.0 1.0 1.0 1.0 5 1.0 1.0 1.0 1.0 6 2.0 2.0 2.0 2.0 7 2.0 2.0 2.0 2.0 8 2.0 2.0 2.0 2.0 ç»“æœçš„indexå˜ 0, 1, 2, 3, 4, 5, 6, 7, 8 join (åˆå¹¶æ–¹å¼)join=&#39;outer&#39; ä¸ºé¢„è®¾å€¼ï¼Œæœªè®¾å®šä»»ä½•å‚æ•°æ—¶ï¼Œå‡½æ•°é»˜è®¤ join=&#39;outer&#39;ã€‚æ­¤æ–¹å¼æ˜¯ä¾ç…§columnæ¥åšçºµå‘åˆå¹¶ï¼Œæœ‰ç›¸åŒçš„columnä¸Šä¸‹åˆå¹¶åœ¨ä¸€èµ·ï¼Œå…¶ä»–ç‹¬è‡ªçš„columnä¸ªè‡ªæˆåˆ—ï¼ŒåŸæœ¬æ²¡æœ‰å€¼çš„ä½ç½®çš†ä»¥NaNå¡«å……ã€‚ import pandas as pdimport numpy as np#å®šä¹‰èµ„æ–™é›†df1 = pd.DataFrame(np.ones((3,4))*0, columns=[&#x27;a&#x27;,&#x27;b&#x27;,&#x27;c&#x27;,&#x27;d&#x27;], index=[1,2,3])df2 = pd.DataFrame(np.ones((3,4))*1, columns=[&#x27;b&#x27;,&#x27;c&#x27;,&#x27;d&#x27;,&#x27;e&#x27;], index=[2,3,4])#çºµå‘&quot;å¤–&quot;åˆå¹¶df1ä¸df2res = pd.concat([df1, df2], axis=0, join=&#x27;outer&#x27;)print(res) a b c d e 1 0.0 0.0 0.0 0.0 NaN 2 0.0 0.0 0.0 0.0 NaN 3 0.0 0.0 0.0 0.0 NaN 2 NaN 1.0 1.0 1.0 1.0 3 NaN 1.0 1.0 1.0 1.0 4 NaN 1.0 1.0 1.0 1.0 åªæœ‰ç›¸åŒçš„columnåˆå¹¶åœ¨ä¸€èµ·ï¼Œå…¶ä»–çš„ä¼šè¢«æŠ›å¼ƒ #æ‰¿ä¸Šä¸€ä¸ªä¾‹å­#çºµå‘&quot;å†…&quot;åˆå¹¶df1ä¸df2res = pd.concat([df1, df2], axis=0, join=&#x27;inner&#x27;)#é‡ç½®indexå¹¶æ‰“å°ç»“æœres = pd.concat([df1, df2], axis=0, join=&#x27;inner&#x27;, ignore_index=True)print(res) b c d 0 0.0 0.0 0.0 1 0.0 0.0 0.0 2 0.0 0.0 0.0 3 1.0 1.0 1.0 4 1.0 1.0 1.0 5 1.0 1.0 1.0 join_axes (ä¾ç…§ axes åˆå¹¶)import pandas as pdimport numpy as np#å®šä¹‰èµ„æ–™é›†df1 = pd.DataFrame(np.ones((3,4))*0, columns=[&#x27;a&#x27;,&#x27;b&#x27;,&#x27;c&#x27;,&#x27;d&#x27;], index=[1,2,3])df2 = pd.DataFrame(np.ones((3,4))*1, columns=[&#x27;b&#x27;,&#x27;c&#x27;,&#x27;d&#x27;,&#x27;e&#x27;], index=[2,3,4])#ä¾ç…§`df1.index`è¿›è¡Œæ¨ªå‘åˆå¹¶res = pd.concat([df1, df2], axis=1, join_axes=[df1.index])#æ‰“å°ç»“æœprint(res)# a b c d b c d e# 1 0.0 0.0 0.0 0.0 NaN NaN NaN NaN# 2 0.0 0.0 0.0 0.0 1.0 1.0 1.0 1.0# 3 0.0 0.0 0.0 0.0 1.0 1.0 1.0 1.0#ç§»é™¤join_axesï¼Œå¹¶æ‰“å°ç»“æœres = pd.concat([df1, df2], axis=1)print(res) a b c d b c d e 1 0.0 0.0 0.0 0.0 NaN NaN NaN NaN 2 0.0 0.0 0.0 0.0 1.0 1.0 1.0 1.0 3 0.0 0.0 0.0 0.0 1.0 1.0 1.0 1.0 a b c d b c d e 1 0.0 0.0 0.0 0.0 NaN NaN NaN NaN 2 0.0 0.0 0.0 0.0 1.0 1.0 1.0 1.0 3 0.0 0.0 0.0 0.0 1.0 1.0 1.0 1.0 4 NaN NaN NaN NaN 1.0 1.0 1.0 1.0 append (æ·»åŠ æ•°æ®)appendåªæœ‰çºµå‘åˆå¹¶ï¼Œæ²¡æœ‰æ¨ªå‘åˆå¹¶ import pandas as pdimport numpy as np#å®šä¹‰èµ„æ–™é›†df1 = pd.DataFrame(np.ones((3,4))*0, columns=[&#x27;a&#x27;,&#x27;b&#x27;,&#x27;c&#x27;,&#x27;d&#x27;])df2 = pd.DataFrame(np.ones((3,4))*1, columns=[&#x27;a&#x27;,&#x27;b&#x27;,&#x27;c&#x27;,&#x27;d&#x27;])df3 = pd.DataFrame(np.ones((3,4))*1, columns=[&#x27;a&#x27;,&#x27;b&#x27;,&#x27;c&#x27;,&#x27;d&#x27;])s1 = pd.Series([1,2,3,4], index=[&#x27;a&#x27;,&#x27;b&#x27;,&#x27;c&#x27;,&#x27;d&#x27;])#å°†df2åˆå¹¶åˆ°df1çš„ä¸‹é¢ï¼Œä»¥åŠé‡ç½®indexï¼Œå¹¶æ‰“å°å‡ºç»“æœres = df1.append(df2, ignore_index=True)print(res)# a b c d# 0 0.0 0.0 0.0 0.0# 1 0.0 0.0 0.0 0.0# 2 0.0 0.0 0.0 0.0# 3 1.0 1.0 1.0 1.0# 4 1.0 1.0 1.0 1.0# 5 1.0 1.0 1.0 1.0#åˆå¹¶å¤šä¸ªdfï¼Œå°†df2ä¸df3åˆå¹¶è‡³df1çš„ä¸‹é¢ï¼Œä»¥åŠé‡ç½®indexï¼Œå¹¶æ‰“å°å‡ºç»“æœres = df1.append([df2, df3], ignore_index=True)print(res)# a b c d# 0 0.0 0.0 0.0 0.0# 1 0.0 0.0 0.0 0.0# 2 0.0 0.0 0.0 0.0# 3 1.0 1.0 1.0 1.0# 4 1.0 1.0 1.0 1.0# 5 1.0 1.0 1.0 1.0# 6 1.0 1.0 1.0 1.0# 7 1.0 1.0 1.0 1.0# 8 1.0 1.0 1.0 1.0#åˆå¹¶seriesï¼Œå°†s1åˆå¹¶è‡³df1ï¼Œä»¥åŠé‡ç½®indexï¼Œå¹¶æ‰“å°å‡ºç»“æœres = df1.append(s1, ignore_index=True)print(res)# a b c d# 0 0.0 0.0 0.0 0.0# 1 0.0 0.0 0.0 0.0# 2 0.0 0.0 0.0 0.0# 3 1.0 2.0 3.0 4.0 a b c d 0 0.0 0.0 0.0 0.0 1 0.0 0.0 0.0 0.0 2 0.0 0.0 0.0 0.0 3 1.0 1.0 1.0 1.0 4 1.0 1.0 1.0 1.0 5 1.0 1.0 1.0 1.0 a b c d 0 0.0 0.0 0.0 0.0 1 0.0 0.0 0.0 0.0 2 0.0 0.0 0.0 0.0 3 1.0 1.0 1.0 1.0 4 1.0 1.0 1.0 1.0 5 1.0 1.0 1.0 1.0 6 1.0 1.0 1.0 1.0 7 1.0 1.0 1.0 1.0 8 1.0 1.0 1.0 1.0 a b c d 0 0.0 0.0 0.0 0.0 1 0.0 0.0 0.0 0.0 2 0.0 0.0 0.0 0.0 3 1.0 2.0 3.0 4.0 Reference pandas.pydata.org pandas docs morvanzhou","categories":[{"name":"python","slug":"python","permalink":"http://iequa.com/categories/python/"}],"tags":[{"name":"Pandas","slug":"Pandas","permalink":"http://iequa.com/tags/Pandas/"}]},{"title":"Pandas IO","slug":"python/numpy-pandas/py-pandas-5-import-output","date":"2017-12-30T13:15:21.000Z","updated":"2019-10-20T04:30:34.999Z","comments":true,"path":"2017/12/30/python/numpy-pandas/py-pandas-5-import-output/","link":"","permalink":"http://iequa.com/2017/12/30/python/numpy-pandas/py-pandas-5-import-output/","excerpt":"pandas å¯ä»¥è¯»å–ä¸å­˜å–çš„èµ„æ–™æ ¼å¼æœ‰å¾ˆå¤šç§ï¼Œåƒ csvã€excelã€jsonã€html ä¸ pickle ç­‰â€¦ è¯¦ç»†è¯·çœ‹å®˜æ–¹æ–‡æ¡£","text":"pandas å¯ä»¥è¯»å–ä¸å­˜å–çš„èµ„æ–™æ ¼å¼æœ‰å¾ˆå¤šç§ï¼Œåƒ csvã€excelã€jsonã€html ä¸ pickle ç­‰â€¦ è¯¦ç»†è¯·çœ‹å®˜æ–¹æ–‡æ¡£ è¯»å–csvç¤ºèŒƒæ¡£æ¡ˆä¸‹è½½ - student.csv import pandas as pd #åŠ è½½æ¨¡å—#è¯»å–csvdata = pd.read_csv(&#x27;students.csv&#x27;)#æ‰“å°å‡ºdataprint(data) Student ID name age gender 0 1100 Kelly 22 Female 1 1101 Clo 21 Female 2 1102 Tilly 22 Female 3 1103 Tony 24 Male 4 1104 David 20 Male 5 1105 Catty 22 Female 6 1106 M 3 Female 7 1107 N 43 Male 8 1108 A 13 Male 9 1109 S 12 Male 10 1110 David 33 Male 11 1111 Dw 3 Female 12 1112 Q 23 Male 13 1113 W 21 Female å°†èµ„æ–™å­˜å–æˆpickledata.to_pickle(&#x27;student.pickle&#x27;) Reference pandas.pydata.org pandas docs morvanzhou pandas IO Tools","categories":[{"name":"python","slug":"python","permalink":"http://iequa.com/categories/python/"}],"tags":[{"name":"Pandas","slug":"Pandas","permalink":"http://iequa.com/tags/Pandas/"}]},{"title":"Pandas Deal NaN Value","slug":"python/numpy-pandas/py-pandas-4-deal-NaN-value","date":"2017-12-30T12:56:21.000Z","updated":"2019-10-20T04:30:35.001Z","comments":true,"path":"2017/12/30/python/numpy-pandas/py-pandas-4-deal-NaN-value/","link":"","permalink":"http://iequa.com/2017/12/30/python/numpy-pandas/py-pandas-4-deal-NaN-value/","excerpt":"å¤„ç† NaN æ•°æ®, ä¸€äº› ç©º æˆ–è€… NaN æ•°æ®, å¦‚ä½•åˆ é™¤æˆ–è€…å¡«è¡¥è¿™äº› NaN æ•°æ®.","text":"å¤„ç† NaN æ•°æ®, ä¸€äº› ç©º æˆ–è€… NaN æ•°æ®, å¦‚ä½•åˆ é™¤æˆ–è€…å¡«è¡¥è¿™äº› NaN æ•°æ®. åˆ›å»ºå« NaN çš„çŸ©é˜µå»ºç«‹äº†ä¸€ä¸ª6X4çš„çŸ©é˜µæ•°æ®å¹¶ä¸”æŠŠä¸¤ä¸ªä½ç½®ç½®ä¸ºç©º. import pandas as pdimport numpy as npdates = pd.date_range(&#x27;20130101&#x27;, periods=6)df = pd.DataFrame(np.arange(24).reshape((6,4)),index=dates, columns=[&#x27;A&#x27;,&#x27;B&#x27;,&#x27;C&#x27;,&#x27;D&#x27;])df.iloc[0,1] = np.nandf.iloc[1,2] = np.nanprint(df) A B C D 2013-01-01 0 NaN 2.0 3 2013-01-02 4 5.0 NaN 7 2013-01-03 8 9.0 10.0 11 2013-01-04 12 13.0 14.0 15 2013-01-05 16 17.0 18.0 19 2013-01-06 20 21.0 22.0 23 pd.dropna()å¦‚æœæƒ³ç›´æ¥å»æ‰æœ‰ NaN çš„è¡Œæˆ–åˆ—, å¯ä»¥ä½¿ç”¨ dropna df1 = df.dropna( axis=0, # 0: å¯¹è¡Œè¿›è¡Œæ“ä½œ; 1: å¯¹åˆ—è¿›è¡Œæ“ä½œ how=&#x27;any&#x27; # &#x27;any&#x27;: åªè¦å­˜åœ¨ NaN å°± drop æ‰; &#x27;all&#x27;: å¿…é¡»å…¨éƒ¨æ˜¯ NaN æ‰ drop ) print(df1) A B C D 2013-01-03 8 9.0 10.0 11 2013-01-04 12 13.0 14.0 15 2013-01-05 16 17.0 18.0 19 2013-01-06 20 21.0 22.0 23 pd.fillna()å¦‚æœæ˜¯å°† NaN çš„å€¼ç”¨å…¶ä»–å€¼ä»£æ›¿, æ¯”å¦‚ä»£æ›¿æˆ 0: df2 = df.fillna(value=0)print(df2) A B C D 2013-01-01 0 0.0 2.0 3 2013-01-02 4 5.0 0.0 7 2013-01-03 8 9.0 10.0 11 2013-01-04 12 13.0 14.0 15 2013-01-05 16 17.0 18.0 19 2013-01-06 20 21.0 22.0 23 pd.isnull()åˆ¤æ–­æ˜¯å¦æœ‰ç¼ºå¤±æ•°æ® NaN, ä¸º True è¡¨ç¤ºç¼ºå¤±æ•°æ®: print(df.isnull()) A B C D 2013-01-01 False True False False 2013-01-02 False False True False 2013-01-03 False False False False 2013-01-04 False False False False 2013-01-05 False False False False 2013-01-06 False False False False æ£€æµ‹åœ¨æ•°æ®ä¸­æ˜¯å¦å­˜åœ¨ NaN, å¦‚æœå­˜åœ¨å°±è¿”å› True: np.any(df.isnull()) == True # True True Reference pandas.pydata.org pandas docs morvanzhou","categories":[{"name":"python","slug":"python","permalink":"http://iequa.com/categories/python/"}],"tags":[{"name":"Pandas","slug":"Pandas","permalink":"http://iequa.com/tags/Pandas/"}]},{"title":"Pandas Set Value","slug":"python/numpy-pandas/py-pandas-3-set-value","date":"2017-12-30T12:11:21.000Z","updated":"2019-10-20T04:30:35.002Z","comments":true,"path":"2017/12/30/python/numpy-pandas/py-pandas-3-set-value/","link":"","permalink":"http://iequa.com/2017/12/30/python/numpy-pandas/py-pandas-3-set-value/","excerpt":"æˆ‘ä»¬å¯ä»¥æ ¹æ®è‡ªå·±çš„éœ€æ±‚, ç”¨ pandas è¿›è¡Œæ›´æ”¹æ•°æ®é‡Œé¢çš„å€¼, æˆ–è€…åŠ ä¸Šä¸€äº›ç©ºçš„,æˆ–è€…æœ‰æ•°å€¼çš„åˆ—.","text":"æˆ‘ä»¬å¯ä»¥æ ¹æ®è‡ªå·±çš„éœ€æ±‚, ç”¨ pandas è¿›è¡Œæ›´æ”¹æ•°æ®é‡Œé¢çš„å€¼, æˆ–è€…åŠ ä¸Šä¸€äº›ç©ºçš„,æˆ–è€…æœ‰æ•°å€¼çš„åˆ—. åˆ›å»ºæ•°æ®é¦–å…ˆå»ºç«‹äº†ä¸€ä¸ª 6X4 çš„çŸ©é˜µæ•°æ® import pandas as pdimport numpy as npdates = pd.date_range(&#x27;20130101&#x27;, periods=6) # 2013-01-01 ç»“æœä¸€æ ·df = pd.DataFrame(np.arange(24).reshape((6,4)),index=dates, columns=[&#x27;A&#x27;,&#x27;B&#x27;,&#x27;C&#x27;,&#x27;D&#x27;])print(df) A B C D 2013-01-01 0 1 2 3 2013-01-02 4 5 6 7 2013-01-03 8 9 10 11 2013-01-04 12 13 14 15 2013-01-05 16 17 18 19 2013-01-06 20 21 22 23 è®¾ç½® loc å’Œ ilocæˆ‘ä»¬å¯ä»¥åˆ©ç”¨ç´¢å¼•æˆ–è€…æ ‡ç­¾ç¡®å®šéœ€è¦ä¿®æ”¹å€¼çš„ä½ç½® df.iloc[2,2] = 1111df.loc[&#x27;2013-01-01&#x27;,&#x27;B&#x27;] = 2222print(df) A B C D 2013-01-01 0 2222 2 3 2013-01-02 4 5 6 7 2013-01-03 8 0 1111 11 2013-01-04 12 0 14 15 2013-01-05 16 0 18 19 2013-01-06 20 0 22 23 æ ¹æ®æ¡ä»¶è®¾ç½®å¦‚æœç°åœ¨çš„åˆ¤æ–­æ¡ä»¶æ˜¯è¿™æ ·, æˆ‘ä»¬æƒ³è¦æ›´æ”¹Bä¸­çš„æ•°, è€Œæ›´æ”¹çš„ä½ç½®æ˜¯å–å†³äº A çš„. å¯¹äºAå¤§äº4çš„ä½ç½®. æ›´æ”¹Båœ¨ç›¸åº”ä½ç½®ä¸Šçš„æ•°ä¸º0 df.B[df.A&gt;4] = 0print(df) A B C D 2013-01-01 0 2222 2 3 2013-01-02 4 5 6 7 2013-01-03 8 0 1111 11 2013-01-04 12 0 14 15 2013-01-05 16 0 18 19 2013-01-06 20 0 22 23 æŒ‰è¡Œæˆ–åˆ—è®¾ç½®å¦‚æœå¯¹æ•´åˆ—åšæ‰¹å¤„ç†, åŠ ä¸Šä¸€åˆ— â€˜Fâ€™, å¹¶å°† F åˆ—å…¨æ”¹ä¸º NaN, å¦‚ä¸‹: df[&#x27;F&#x27;] = np.nanprint(df) A B C D F 2013-01-01 0 2222 2 3 NaN 2013-01-02 4 5 6 7 NaN 2013-01-03 8 0 1111 11 NaN 2013-01-04 12 0 14 15 NaN 2013-01-05 16 0 18 19 NaN 2013-01-06 20 0 22 23 NaN æ·»åŠ æ•°æ®ç”¨ä¸Šé¢çš„æ–¹æ³•ä¹Ÿå¯ä»¥åŠ ä¸Š Series åºåˆ—ï¼ˆä½†æ˜¯é•¿åº¦å¿…é¡»å¯¹é½ï¼‰ df[&#x27;E&#x27;] = pd.Series([1,2,3,4,5,6], index=pd.date_range(&#x27;20130101&#x27;,periods=6)) print(df) A B C D F E 2013-01-01 0 2222 2 3 NaN 1 2013-01-02 4 5 6 7 NaN 2 2013-01-03 8 0 1111 11 NaN 3 2013-01-04 12 0 14 15 NaN 4 2013-01-05 16 0 18 19 NaN 5 2013-01-06 20 0 22 23 NaN 6 è¿™æ ·æˆ‘ä»¬å¤§æ¦‚å­¦ä¼šäº†å¦‚ä½•å¯¹ DataFrame ä¸­åœ¨è‡ªå·±æƒ³è¦çš„åœ°æ–¹èµ‹å€¼æˆ–è€…å¢åŠ æ•°æ®ã€‚ Reference pandas.pydata.org pandas docs morvanzhou","categories":[{"name":"python","slug":"python","permalink":"http://iequa.com/categories/python/"}],"tags":[{"name":"Pandas","slug":"Pandas","permalink":"http://iequa.com/tags/Pandas/"}]},{"title":"Pandas Select Data","slug":"python/numpy-pandas/py-pandas-2-select-data","date":"2017-12-28T15:28:21.000Z","updated":"2019-10-20T04:30:34.999Z","comments":true,"path":"2017/12/28/python/numpy-pandas/py-pandas-2-select-data/","link":"","permalink":"http://iequa.com/2017/12/28/python/numpy-pandas/py-pandas-2-select-data/","excerpt":"pandas é€‰æ‹©æ•°æ®, é¦–å…ˆæˆ‘ä»¬å»ºç«‹äº†ä¸€ä¸ª 6X4 çš„çŸ©é˜µæ•°æ®","text":"pandas é€‰æ‹©æ•°æ®, é¦–å…ˆæˆ‘ä»¬å»ºç«‹äº†ä¸€ä¸ª 6X4 çš„çŸ©é˜µæ•°æ® import pandas as pdimport numpy as npdates = pd.date_range(&#x27;20130101&#x27;, periods=6)df = pd.DataFrame(np.arange(24).reshape((6,4)),index=dates, columns=[&#x27;A&#x27;,&#x27;B&#x27;,&#x27;C&#x27;,&#x27;D&#x27;])print(df) A B C D 2013-01-01 0 1 2 3 2013-01-02 4 5 6 7 2013-01-03 8 9 10 11 2013-01-04 12 13 14 15 2013-01-05 16 17 18 19 2013-01-06 20 21 22 23 ç®€å•çš„ç­›é€‰å¦‚æœæˆ‘ä»¬æƒ³é€‰å– DataFrame ä¸­çš„æ•°æ®ï¼Œä¸‹é¢æè¿°äº†ä¸¤ç§é€”å¾„, ä»–ä»¬éƒ½èƒ½è¾¾åˆ°åŒä¸€ä¸ªç›®çš„ï¼š print(df[&#x27;A&#x27;])print(df.A) 2013-01-01 0 2013-01-02 4 2013-01-03 8 2013-01-04 12 2013-01-05 16 2013-01-06 20 Freq: D, Name: A, dtype: int64 2013-01-01 0 2013-01-02 4 2013-01-03 8 2013-01-04 12 2013-01-05 16 2013-01-06 20 Freq: D, Name: A, dtype: int64 è®©é€‰æ‹©è·¨è¶Šå¤šè¡Œæˆ–å¤šåˆ—: print(df[0:3]) A B C D 2013-01-01 0 1 2 3 2013-01-02 4 5 6 7 2013-01-03 8 9 10 11 print(df[3:3]) Empty DataFrame Columns: [A, B, C, D] Index: [] print(df[&#x27;20130102&#x27;:&#x27;20130104&#x27;]) A B C D 2013-01-02 4 5 6 7 2013-01-03 8 9 10 11 2013-01-04 12 13 14 15 å¦‚æœ df[3:3] å°†ä¼šæ˜¯ä¸€ä¸ªç©ºå¯¹è±¡ã€‚åè€…é€‰æ‹© 20130102 åˆ° 20130104 æ ‡ç­¾ä¹‹é—´çš„æ•°æ®ï¼Œå¹¶ä¸”åŒ…æ‹¬è¿™ä¸¤ä¸ªæ ‡ç­¾ æ ¹æ®æ ‡ç­¾ locå¯ä»¥ä½¿ç”¨æ ‡ç­¾æ¥é€‰æ‹©æ•°æ® loc, æœ¬ä¾‹å­ä¸»è¦é€šè¿‡æ ‡ç­¾åå­—é€‰æ‹©æŸä¸€è¡Œæ•°æ®ï¼Œ æˆ–è€…é€šè¿‡é€‰æ‹©æŸè¡Œæˆ–è€…æ‰€æœ‰è¡Œï¼ˆ:ä»£è¡¨æ‰€æœ‰è¡Œï¼‰ç„¶åé€‰å…¶ä¸­æŸä¸€åˆ—æˆ–å‡ åˆ—æ•°æ® : print(df.loc[&#x27;20130102&#x27;]) A 4 B 5 C 6 D 7 Name: 2013-01-02 00:00:00, dtype: int64 print(df.loc[:,[&#x27;A&#x27;,&#x27;B&#x27;]]) A B 2013-01-01 0 1 2013-01-02 4 5 2013-01-03 8 9 2013-01-04 12 13 2013-01-05 16 17 2013-01-06 20 21 print(df.loc[&#x27;20130102&#x27;,[&#x27;A&#x27;,&#x27;B&#x27;]]) A 4 B 5 Name: 2013-01-02 00:00:00, dtype: int64 æ ¹æ®åºåˆ— ilocå¯ä»¥é‡‡ç”¨ä½ç½®è¿›è¡Œé€‰æ‹© iloc, åœ¨è¿™é‡Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä½ç½®é€‰æ‹©åœ¨ä¸åŒæƒ…å†µä¸‹æ‰€éœ€è¦çš„æ•°æ®ä¾‹å¦‚é€‰æŸä¸€ä¸ªï¼Œè¿ç»­é€‰æˆ–è€…è·¨è¡Œé€‰ç­‰æ“ä½œã€‚ print(df.iloc[3,1]) 13 print(df.iloc[3:5,1:3]) B C 2013-01-04 13 14 2013-01-05 17 18 print(df.iloc[[1,3,5],1:3]) B C 2013-01-02 5 6 2013-01-04 13 14 2013-01-06 21 22 åœ¨è¿™é‡Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä½ç½®é€‰æ‹©åœ¨ä¸åŒæƒ…å†µä¸‹æ‰€éœ€è¦çš„æ•°æ®, ä¾‹å¦‚é€‰æŸä¸€ä¸ªï¼Œè¿ç»­é€‰æˆ–è€…è·¨è¡Œé€‰ç­‰æ“ä½œã€‚ æ ¹æ®æ··åˆä¸¤ç§ ixå½“ç„¶æˆ‘ä»¬å¯ä»¥é‡‡ç”¨æ··åˆé€‰æ‹© ix, å…¶ä¸­é€‰æ‹©â€™Aâ€™å’Œâ€™Câ€™çš„ä¸¤åˆ—ï¼Œå¹¶é€‰æ‹©å‰ä¸‰è¡Œçš„æ•°æ®ã€‚ print(df.ix[:3,[&#x27;A&#x27;,&#x27;C&#x27;]]) A C 2013-01-01 0 2 2013-01-02 4 6 2013-01-03 8 10 /Users/blair/.pyenv/versions/anaconda3/lib/python3.6/site-packages/ipykernel_launcher.py:1: DeprecationWarning: .ix is deprecated. Please use .loc for label based indexing or .iloc for positional indexing See the documentation here: http://pandas.pydata.org/pandas-docs/stable/indexing.html#ix-indexer-is-deprecated &quot;&quot;&quot;Entry point for launching an IPython kernel. é€šè¿‡åˆ¤æ–­çš„ç­›é€‰æœ€åæˆ‘ä»¬å¯ä»¥é‡‡ç”¨åˆ¤æ–­æŒ‡ä»¤ (Boolean indexing) è¿›è¡Œé€‰æ‹©. æˆ‘ä»¬å¯ä»¥çº¦æŸæŸé¡¹æ¡ä»¶ç„¶åé€‰æ‹©å‡ºå½“å‰æ‰€æœ‰æ•°æ®. print(df[df.A&gt;8])df.A&gt;8 A B C D 2013-01-04 12 13 14 15 2013-01-05 16 17 18 19 2013-01-06 20 21 22 23 2013-01-01 False 2013-01-02 False 2013-01-03 False 2013-01-04 True 2013-01-05 True 2013-01-06 True Freq: D, Name: A, dtype: bool ä¸‹èŠ‚æˆ‘ä»¬å°†ä¼šè®²åˆ°Pandasä¸­å¦‚ä½•è®¾ç½®å€¼ã€‚ Reference pandas.pydata.org pandas docs morvanzhou","categories":[{"name":"python","slug":"python","permalink":"http://iequa.com/categories/python/"}],"tags":[{"name":"Pandas","slug":"Pandas","permalink":"http://iequa.com/tags/Pandas/"}]},{"title":"Pandas Basic Intro","slug":"python/numpy-pandas/py-pandas-1-intro","date":"2017-12-27T08:28:21.000Z","updated":"2019-10-20T04:30:34.999Z","comments":true,"path":"2017/12/27/python/numpy-pandas/py-pandas-1-intro/","link":"","permalink":"http://iequa.com/2017/12/27/python/numpy-pandas/py-pandas-1-intro/","excerpt":"å¦‚æœç”¨åˆ—è¡¨å’Œå­—å…¸æ¥ä½œæ¯”è¾ƒ, é‚£ä¹ˆå¯ä»¥è¯´ Numpy æ˜¯åˆ—è¡¨å½¢å¼çš„ï¼Œæ²¡æœ‰æ•°å€¼æ ‡ç­¾ï¼Œè€Œ Pandas å°±æ˜¯å­—å…¸å½¢å¼","text":"å¦‚æœç”¨åˆ—è¡¨å’Œå­—å…¸æ¥ä½œæ¯”è¾ƒ, é‚£ä¹ˆå¯ä»¥è¯´ Numpy æ˜¯åˆ—è¡¨å½¢å¼çš„ï¼Œæ²¡æœ‰æ•°å€¼æ ‡ç­¾ï¼Œè€Œ Pandas å°±æ˜¯å­—å…¸å½¢å¼ Pandasæ˜¯åŸºäºNumpyæ„å»ºçš„ï¼Œè®©Numpyä¸ºä¸­å¿ƒçš„åº”ç”¨å˜å¾—æ›´åŠ ç®€å•ã€‚ è¦ä½¿ç”¨pandasï¼Œé¦–å…ˆéœ€è¦äº†è§£ä»–ä¸»è¦ä¸¤ä¸ªæ•°æ®ç»“æ„ï¼šSeries å’Œ DataFrameã€‚ Seriesimport pandas as pdimport numpy as nps = pd.Series([1,3,6,np.nan,44,1])print(s) 0 1.0 1 3.0 2 6.0 3 NaN 4 44.0 5 1.0 dtype: float64 Series çš„å­—ç¬¦ä¸²è¡¨ç°å½¢å¼ä¸ºï¼šç´¢å¼•åœ¨å·¦è¾¹ï¼Œå€¼åœ¨å³è¾¹ã€‚ç”±äºæˆ‘ä»¬æ²¡æœ‰ä¸ºæ•°æ®æŒ‡å®šç´¢å¼•ã€‚äºæ˜¯ä¼šè‡ªåŠ¨åˆ›å»ºä¸€ä¸ª0åˆ°N-1ï¼ˆNä¸ºé•¿åº¦ï¼‰çš„æ•´æ•°å‹ç´¢å¼•ã€‚ DataFrame çŸ©é˜µåˆ›å»ºdates = pd.date_range(&#x27;20160101&#x27;,periods=6)df = pd.DataFrame(np.random.randn(6,4),index=dates,columns=[&#x27;a&#x27;,&#x27;b&#x27;,&#x27;c&#x27;,&#x27;d&#x27;])print(df) a b c d 2016-01-01 -0.186992 0.228857 0.572464 -0.842974 2016-01-02 -0.689623 -1.491299 0.647805 0.819846 2016-01-03 -1.294425 0.138935 1.729793 -1.270880 2016-01-04 0.088744 0.745256 0.380425 0.048070 2016-01-05 0.003135 -2.240388 0.188038 -0.069044 2016-01-06 -1.358217 -0.820133 1.606467 -1.622589 DataFrame æ˜¯ä¸€ä¸ªè¡¨æ ¼å‹çš„æ•°æ®ç»“æ„ï¼Œå®ƒåŒ…å«æœ‰ä¸€ç»„æœ‰åºçš„åˆ—ï¼Œæ¯åˆ—å¯ä»¥æ˜¯ä¸åŒçš„å€¼ç±»å‹ï¼ˆæ•°å€¼ï¼Œå­—ç¬¦ä¸²ï¼Œå¸ƒå°”å€¼ç­‰ï¼‰ã€‚DataFrame æ—¢æœ‰è¡Œç´¢å¼•ä¹Ÿæœ‰åˆ—ç´¢å¼•ï¼Œ å®ƒå¯ä»¥è¢«çœ‹åšç”± Series ç»„æˆçš„å¤§å­—å…¸ã€‚ æˆ‘ä»¬å¯ä»¥æ ¹æ®æ¯ä¸€ä¸ªä¸åŒçš„ç´¢å¼•æ¥æŒ‘é€‰æ•°æ®, æ¯”å¦‚æŒ‘é€‰ b çš„å…ƒç´ : print(df[&#x27;b&#x27;]) 2016-01-01 0.228857 2016-01-02 -1.491299 2016-01-03 0.138935 2016-01-04 0.745256 2016-01-05 -2.240388 2016-01-06 -0.820133 Freq: D, Name: b, dtype: float64 æˆ‘ä»¬åœ¨åˆ›å»ºä¸€ç»„æ²¡æœ‰ç»™å®šè¡Œæ ‡ç­¾å’Œåˆ—æ ‡ç­¾çš„æ•°æ® df1: df1 = pd.DataFrame(np.arange(12).reshape((3,4)))print(df1) 0 1 2 3 0 0 1 2 3 1 4 5 6 7 2 8 9 10 11 è¿™æ ·,ä»–å°±ä¼šé‡‡å–é»˜è®¤çš„ä»0å¼€å§‹ index. DataFrame å­—å…¸åˆ›å»ºè¿˜æœ‰ä¸€ç§ç”Ÿæˆ df çš„æ–¹æ³•, å¦‚ä¸‹ df2: df2 = pd.DataFrame(&#123;&#x27;A&#x27; : [1, 3, 7, 5], &#x27;B&#x27; : pd.Timestamp(&#x27;20130102&#x27;), &#x27;C&#x27; : pd.Series(1,index=list(range(4)),dtype=&#x27;float32&#x27;), &#x27;D&#x27; : np.array([3] * 4,dtype=&#x27;int32&#x27;), &#x27;E&#x27; : pd.Categorical([&quot;test&quot;,&quot;train&quot;,&quot;test&quot;,&quot;train&quot;]), &#x27;F&#x27; : &#x27;foo&#x27;&#125;) print(df2) A B C D E F 0 1 2013-01-02 1.0 3 test foo 1 3 2013-01-02 1.0 3 train foo 2 7 2013-01-02 1.0 3 test foo 3 5 2013-01-02 1.0 3 train foo è¿™ç§æ–¹æ³•èƒ½å¯¹æ¯ä¸€åˆ—çš„æ•°æ®è¿›è¡Œç‰¹æ®Šå¯¹å¾…. å¦‚æœæƒ³è¦æŸ¥çœ‹æ•°æ®ä¸­çš„ç±»å‹, æˆ‘ä»¬å¯ä»¥ç”¨ dtype è¿™ä¸ªå±æ€§: print(df2.dtypes) A int64 B datetime64[ns] C float32 D int32 E category F object dtype: object å¦‚æœæƒ³çœ‹å¯¹åˆ—çš„åºå·: print(df2.index) Int64Index([0, 1, 2, 3], dtype=&#39;int64&#39;) åŒæ ·, æ¯ç§æ•°æ®çš„åç§°ä¹Ÿèƒ½çœ‹åˆ°: print(df2.columns) Index([&#39;A&#39;, &#39;B&#39;, &#39;C&#39;, &#39;D&#39;, &#39;E&#39;, &#39;F&#39;], dtype=&#39;object&#39;) å¦‚æœåªæƒ³çœ‹æ‰€æœ‰ df2 çš„å€¼: print(df2.values) [[1 Timestamp(&#39;2013-01-02 00:00:00&#39;) 1.0 3 &#39;test&#39; &#39;foo&#39;] [3 Timestamp(&#39;2013-01-02 00:00:00&#39;) 1.0 3 &#39;train&#39; &#39;foo&#39;] [7 Timestamp(&#39;2013-01-02 00:00:00&#39;) 1.0 3 &#39;test&#39; &#39;foo&#39;] [5 Timestamp(&#39;2013-01-02 00:00:00&#39;) 1.0 3 &#39;train&#39; &#39;foo&#39;]] æƒ³çŸ¥é“æ•°æ®çš„æ€»ç»“, å¯ä»¥ç”¨ describe(): df2.describe() A C D count 4.000000 4.0 4.0 mean 4.000000 1.0 3.0 std 2.581989 0.0 0.0 min 1.000000 1.0 3.0 25% 2.500000 1.0 3.0 50% 4.000000 1.0 3.0 75% 5.500000 1.0 3.0 max 7.000000 1.0 3.0 å¦‚æœæƒ³ç¿»è½¬æ•°æ®, transpose: print(df2.T) 0 1 2 \\ A 1 3 7 B 2013-01-02 00:00:00 2013-01-02 00:00:00 2013-01-02 00:00:00 C 1 1 1 D 3 3 3 E test train test F foo foo foo 3 A 5 B 2013-01-02 00:00:00 C 1 D 3 E train F foo å¦‚æœæƒ³å¯¹æ•°æ®çš„ index è¿›è¡Œæ’åºå¹¶è¾“å‡º: print(df2.sort_index(axis=1, ascending=False)) # å¯¹åˆ—åç§°è¿›è¡Œæ’åºï¼Œç´¢å¼•åï¼Œå€’æ’åºprint(df2.sort_index(axis=0, ascending=False)) # å¯¹åˆ—åç§°è¿›è¡Œæ’åºï¼Œç´¢å¼•åï¼Œå€’æ’åº F E D C B A 0 foo test 3 1.0 2013-01-02 1 1 foo train 3 1.0 2013-01-02 3 2 foo test 3 1.0 2013-01-02 7 3 foo train 3 1.0 2013-01-02 5 A B C D E F 3 5 2013-01-02 1.0 3 train foo 2 7 2013-01-02 1.0 3 test foo 1 3 2013-01-02 1.0 3 train foo 0 1 2013-01-02 1.0 3 test foo å¦‚æœæ˜¯å¯¹æ•°æ® å€¼ æ’åºè¾“å‡º: print(df2.sort_values(by=&#x27;E&#x27;)) A B C D E F 0 1 2013-01-02 1.0 3 test foo 2 7 2013-01-02 1.0 3 test foo 1 3 2013-01-02 1.0 3 train foo 3 5 2013-01-02 1.0 3 train foo Reference pandas.pydata.org pandas docs morvanzhou","categories":[{"name":"python","slug":"python","permalink":"http://iequa.com/categories/python/"}],"tags":[{"name":"Pandas","slug":"Pandas","permalink":"http://iequa.com/tags/Pandas/"}]},{"title":"Numpy copy & deep copy","slug":"python/numpy-pandas/py-numpy-8-copy-deep-copy","date":"2017-12-27T06:28:21.000Z","updated":"2019-10-20T04:30:35.003Z","comments":true,"path":"2017/12/27/python/numpy-pandas/py-numpy-8-copy-deep-copy/","link":"","permalink":"http://iequa.com/2017/12/27/python/numpy-pandas/py-numpy-8-copy-deep-copy/","excerpt":"numpy copy &amp; deep copy","text":"numpy copy &amp; deep copy = çš„èµ‹å€¼æ–¹å¼ä¼šå¸¦æœ‰å…³è”æ€§import numpy as npa = np.arange(4)# array([0, 1, 2, 3])b = ac = ad = b æ”¹å˜açš„ç¬¬ä¸€ä¸ªå€¼ï¼Œbã€cã€dçš„ç¬¬ä¸€ä¸ªå€¼ä¹Ÿä¼šåŒæ—¶æ”¹å˜ã€‚ a[0] = 11print(a)# array([11, 1, 2, 3]) [11 1 2 3] ç¡®è®¤bã€cã€dæ˜¯å¦ä¸aç›¸åŒ b is a # Truec is a # Trued is a # True copy() çš„èµ‹å€¼æ–¹å¼æ²¡æœ‰å…³è”æ€§b = a.copy() # deep copyprint(b) # array([11, 22, 33, 3])a[3] = 44print(a) # array([11, 22, 33, 44])print(b) # array([11, 22, 33, 3]) [11 1 2 3] [11 1 2 44] [11 1 2 3] Reference numpy.org numpy docs morvanzhou","categories":[{"name":"python","slug":"python","permalink":"http://iequa.com/categories/python/"}],"tags":[{"name":"Numpy","slug":"Numpy","permalink":"http://iequa.com/tags/Numpy/"}]},{"title":"Numpy Array Split","slug":"python/numpy-pandas/py-numpy-7-Split","date":"2017-12-27T05:28:21.000Z","updated":"2019-10-20T04:30:34.998Z","comments":true,"path":"2017/12/27/python/numpy-pandas/py-numpy-7-Split/","link":"","permalink":"http://iequa.com/2017/12/27/python/numpy-pandas/py-numpy-7-Split/","excerpt":"Numpy array æ¨ªå‘åˆ†å‰²ã€çºµå‘åˆ†å‰²ã€ç­‰é‡åˆ†å‰²ã€éç­‰é‡åˆ†å‰²","text":"Numpy array æ¨ªå‘åˆ†å‰²ã€çºµå‘åˆ†å‰²ã€ç­‰é‡åˆ†å‰²ã€éç­‰é‡åˆ†å‰² åˆ›å»ºæ•°æ®import numpy as npA = np.arange(12).reshape((3, 4))&quot;&quot;&quot;array([[ 0, 1, 2, 3], [ 4, 5, 6, 7], [ 8, 9, 10, 11]])&quot;&quot;&quot;print(A) [[ 0 1 2 3] [ 4 5 6 7] [ 8 9 10 11]] çºµå‘åˆ†å‰²print(np.split(A, 2, axis=1))&quot;&quot;&quot;[array([[0, 1], [4, 5], [8, 9]]), array([[ 2, 3], [ 6, 7], [10, 11]])]&quot;&quot;&quot; æ¨ªå‘åˆ†å‰²print(np.split(A, 3, axis=0))# [array([[0, 1, 2, 3]]), array([[4, 5, 6, 7]]), array([[ 8, 9, 10, 11]])] ä¸ç­‰é‡çš„åˆ†å‰²åœ¨æœºå™¨å­¦ä¹ æ—¶ç»å¸¸ä¼šéœ€è¦å°†æ•°æ®åšä¸ç­‰é‡çš„åˆ†å‰²ï¼Œå› æ­¤è§£å†³åŠæ³•ä¸ºnp.array_split() print(np.array_split(A, 3, axis=1))&quot;&quot;&quot;[array([[0, 1], [4, 5], [8, 9]]), array([[ 2], [ 6], [10]]), array([[ 3], [ 7], [11]])]&quot;&quot;&quot; æˆåŠŸå°†Arrayä¸ç­‰é‡åˆ†å‰²! å…¶ä»–çš„åˆ†å‰²æ–¹å¼åœ¨Numpyé‡Œè¿˜æœ‰np.vsplit()ä¸æ¨ªnp.hsplit()æ–¹å¼å¯ç”¨ã€‚ print(np.vsplit(A, 3)) #ç­‰äº print(np.split(A, 3, axis=0))# [array([[0, 1, 2, 3]]), array([[4, 5, 6, 7]]), array([[ 8, 9, 10, 11]])]print(np.hsplit(A, 2)) #ç­‰äº print(np.split(A, 2, axis=1))&quot;&quot;&quot;[array([[0, 1], [4, 5], [8, 9]]), array([[ 2, 3], [ 6, 7], [10, 11]])]&quot;&quot;&quot; Reference numpy.org numpy docs morvanzhou","categories":[{"name":"python","slug":"python","permalink":"http://iequa.com/categories/python/"}],"tags":[{"name":"Numpy","slug":"Numpy","permalink":"http://iequa.com/tags/Numpy/"}]},{"title":"Numpy Array Merge","slug":"python/numpy-pandas/py-numpy-6-Array-Merge","date":"2017-12-26T09:28:21.000Z","updated":"2019-10-20T04:30:35.001Z","comments":true,"path":"2017/12/26/python/numpy-pandas/py-numpy-6-Array-Merge/","link":"","permalink":"http://iequa.com/2017/12/26/python/numpy-pandas/py-numpy-6-Array-Merge/","excerpt":"å¯¹äºä¸€ä¸ªarrayçš„åˆå¹¶ï¼Œæˆ‘ä»¬å¯ä»¥æƒ³åˆ°æŒ‰è¡Œã€æŒ‰åˆ—ç­‰å¤šç§æ–¹å¼è¿›è¡Œåˆå¹¶","text":"å¯¹äºä¸€ä¸ªarrayçš„åˆå¹¶ï¼Œæˆ‘ä»¬å¯ä»¥æƒ³åˆ°æŒ‰è¡Œã€æŒ‰åˆ—ç­‰å¤šç§æ–¹å¼è¿›è¡Œåˆå¹¶ np.vstack()import numpy as npA = np.array([1,1,1])B = np.array([2,2,2]) print(np.vstack((A,B))) # vertical stack&quot;&quot;&quot;[[1,1,1] [2,2,2]]&quot;&quot;&quot;np.vstack((A,B)) [[1 1 1] [2 2 2]] array([[1, 1, 1], [2, 2, 2]]) vertical stack æœ¬èº«å±äºä¸€ç§ä¸Šä¸‹åˆå¹¶ï¼Œå³å¯¹æ‹¬å·ä¸­çš„ä¸¤ä¸ªæ•´ä½“è¿›è¡Œå¯¹åº”æ“ä½œã€‚æ­¤æ—¶æˆ‘ä»¬å¯¹ç»„åˆè€Œæˆçš„çŸ©é˜µè¿›è¡Œå±æ€§æ¢ç©¶ï¼š C = np.vstack((A,B)) print(A.shape,C.shape)# (3,) (2,3) # A æ˜¯åºåˆ—, åºåˆ—åˆå¹¶å C ä¸ºçŸ©é˜µ (3,) (2, 3) åˆ©ç”¨shapeå‡½æ•°å¯ä»¥è®©æˆ‘ä»¬å¾ˆå®¹æ˜“åœ°çŸ¥é“Aå’ŒCçš„å±æ€§ï¼Œä»æ‰“å°å‡ºçš„ç»“æœæ¥çœ‹ï¼ŒAä»…ä»…æ˜¯ä¸€ä¸ªæ‹¥æœ‰3é¡¹å…ƒç´ çš„æ•°ç»„ï¼ˆæ•°åˆ—ï¼‰ï¼Œè€Œåˆå¹¶åå¾—åˆ°çš„Cæ˜¯ä¸€ä¸ª2è¡Œ3åˆ—çš„çŸ©é˜µã€‚ np.hstack() å·¦å³åˆå¹¶ï¼šD = np.hstack((A,B)) # horizontal stackprint(D)# [1,1,1,2,2,2]print(A.shape,D.shape)# (3,) (6,) [1 1 1 2 2 2] (3,) (6,) ä¸èƒ½ç”¨ A.T è¿™æ ·çš„æ–¹æ³•ï¼Œå°†ä¸€ä¸ªåºåˆ—å˜ä¸ºçŸ©é˜µ print(A.T)print(A.T.shape) [1 1 1] (3,) é€šè¿‡æ‰“å°å‡ºçš„ç»“æœå¯ä»¥çœ‹å‡ºï¼šDæœ¬èº«æ¥æºäºAï¼ŒBä¸¤ä¸ªæ•°åˆ—çš„å·¦å³åˆå¹¶ï¼Œè€Œä¸”æ–°ç”Ÿæˆçš„Dæœ¬èº«ä¹Ÿæ˜¯ä¸€ä¸ªå«æœ‰6é¡¹å…ƒç´ çš„åºåˆ—ã€‚ np.newaxis()å¦‚æœé¢å¯¹å¦‚åŒå‰æ–‡æ‰€è¿°çš„Aåºåˆ—ï¼Œ è½¬ç½®æ“ä½œä¾¿å¾ˆæœ‰å¯èƒ½æ— æ³•å¯¹å…¶è¿›è¡Œè½¬ç½®ï¼ˆå› ä¸ºAå¹¶ä¸æ˜¯çŸ©é˜µçš„å±æ€§ï¼‰ï¼Œæ­¤æ—¶å°±éœ€è¦æˆ‘ä»¬å€ŸåŠ©å…¶ä»–çš„å‡½æ•°æ“ä½œè¿›è¡Œè½¬ç½®ï¼š print(A[np.newaxis,:])# [[1 1 1]]print(A[np.newaxis,:].shape)# (1,3)print(A[:,np.newaxis])&quot;&quot;&quot;[[1][1][1]]&quot;&quot;&quot;print(A[:,np.newaxis].shape)# (3,1) [[1 1 1]] (1, 3) [[1] [1] [1]] (3, 1) æ­¤æ—¶æˆ‘ä»¬ä¾¿å°†å…·æœ‰3ä¸ªå…ƒç´ çš„arrayè½¬æ¢ä¸ºäº†1è¡Œ3åˆ—ä»¥åŠ3è¡Œ1åˆ—çš„çŸ©é˜µäº†ã€‚ ç»¼åˆæ€»ç»“import numpy as npA = np.array([1,1,1])[:,np.newaxis]B = np.array([2,2,2])[:,np.newaxis] C = np.vstack((A,B)) # vertical stackD = np.hstack((A,B)) # horizontal stackprint(D)&quot;&quot;&quot;[[1 2][1 2][1 2]]&quot;&quot;&quot;print(A.shape,D.shape)# (3,1) (3,2) [[1 2] [1 2] [1 2]] (3, 1) (3, 2) np.concatenate()å½“ä½ çš„åˆå¹¶æ“ä½œéœ€è¦é’ˆå¯¹å¤šä¸ªçŸ©é˜µæˆ–åºåˆ—æ—¶ï¼Œå€ŸåŠ©concatenateå‡½æ•°å¯èƒ½ä¼šè®©ä½ ä½¿ç”¨èµ·æ¥æ¯”å‰è¿°çš„å‡½æ•°æ›´åŠ æ–¹ä¾¿ï¼š C = np.concatenate((A,B,B,A),axis=0)print(C)&quot;&quot;&quot;array([[1], [1], [1], [2], [2], [2], [2], [2], [2], [1], [1], [1]])&quot;&quot;&quot;D = np.concatenate((A,B,B,A),axis=1)print(D)&quot;&quot;&quot;array([[1, 2, 2, 1], [1, 2, 2, 1], [1, 2, 2, 1]])&quot;&quot;&quot; [[1 2 2 1] [1 2 2 1] [1 2 2 1]] axis å‚æ•°å¾ˆå¥½çš„æ§åˆ¶äº†çŸ©é˜µçš„çºµå‘æˆ–æ˜¯æ¨ªå‘æ‰“å°ï¼Œç›¸æ¯”è¾ƒ vstack å’Œ hstack å‡½æ•°æ˜¾å¾—æ›´åŠ æ–¹ä¾¿ã€‚ Reference numpy.org numpy docs morvanzhou","categories":[{"name":"python","slug":"python","permalink":"http://iequa.com/categories/python/"}],"tags":[{"name":"Numpy","slug":"Numpy","permalink":"http://iequa.com/tags/Numpy/"}]},{"title":"Numpy Index","slug":"python/numpy-pandas/py-numpy-5-Index","date":"2017-12-26T06:28:21.000Z","updated":"2019-10-20T04:30:34.999Z","comments":true,"path":"2017/12/26/python/numpy-pandas/py-numpy-5-Index/","link":"","permalink":"http://iequa.com/2017/12/26/python/numpy-pandas/py-numpy-5-Index/","excerpt":"åœ¨å…ƒç´ åˆ—è¡¨æˆ–è€…æ•°ç»„ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨å¦‚åŒ a[2] ä¸€æ ·çš„è¡¨ç¤ºæ–¹æ³•ï¼ŒåŒæ ·çš„ï¼ŒNumpyä¸­ä¹Ÿæœ‰ç›¸åº”çš„è¡¨ç¤ºæ–¹æ³•","text":"åœ¨å…ƒç´ åˆ—è¡¨æˆ–è€…æ•°ç»„ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨å¦‚åŒ a[2] ä¸€æ ·çš„è¡¨ç¤ºæ–¹æ³•ï¼ŒåŒæ ·çš„ï¼ŒNumpyä¸­ä¹Ÿæœ‰ç›¸åº”çš„è¡¨ç¤ºæ–¹æ³• ä¸€ç»´ç´¢å¼•import numpy as npA = np.arange(3,15)# array([3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]) print(A[3]) # 6 6 è®©æˆ‘ä»¬å°†çŸ©é˜µè½¬æ¢ä¸ºäºŒç»´çš„ï¼Œæ­¤æ—¶è¿›è¡ŒåŒæ ·çš„æ“ä½œï¼š A = np.arange(3,15).reshape((3,4))&quot;&quot;&quot;array([[ 3, 4, 5, 6] [ 7, 8, 9, 10] [11, 12, 13, 14]])&quot;&quot;&quot; print(A[2]) # [11 12 13 14] [11 12 13 14] å®é™…ä¸Šè¿™æ—¶çš„ A[2] å¯¹åº”çš„å°±æ˜¯ çŸ©é˜µA ä¸­ç¬¬ä¸‰è¡Œ(ä»0å¼€å§‹ç®—ç¬¬ä¸€è¡Œ)çš„æ‰€æœ‰å…ƒç´ ã€‚ äºŒç»´ç´¢å¼•print(A[1][1]) # 8print(A[1, 1]) # 8 8 8 åœ¨Pythonçš„ list ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨:å¯¹ä¸€å®šèŒƒå›´å†…çš„å…ƒç´ è¿›è¡Œåˆ‡ç‰‡æ“ä½œï¼Œåœ¨Numpyä¸­æˆ‘ä»¬ä¾ç„¶å¯ä»¥ç»™å‡ºç›¸åº”çš„æ–¹æ³•ï¼š print(A[1, 1:3]) # [8 9] [8 9] è¿™ä¸€è¡¨ç¤ºå½¢å¼å³é’ˆå¯¹ç¬¬äºŒè¡Œä¸­ç¬¬2åˆ°ç¬¬4åˆ—å…ƒç´ è¿›è¡Œåˆ‡ç‰‡è¾“å‡ºï¼ˆä¸åŒ…å«ç¬¬4åˆ—ï¼‰ã€‚ æ­¤æ—¶æˆ‘ä»¬é€‚å½“çš„åˆ©ç”¨forå‡½æ•°è¿›è¡Œæ‰“å°ï¼š for row in A: print(row)&quot;&quot;&quot; [ 3, 4, 5, 6][ 7, 8, 9, 10][11, 12, 13, 14]&quot;&quot;&quot; æ­¤æ—¶å®ƒä¼šé€è¡Œè¿›è¡Œæ‰“å°æ“ä½œã€‚å¦‚æœæƒ³è¿›è¡Œé€åˆ—æ‰“å°ï¼Œå°±éœ€è¦ç¨ç¨å˜åŒ–ä¸€ä¸‹ï¼š for column in A.T: print(column)&quot;&quot;&quot; [ 3, 7, 11][ 4, 8, 12][ 5, 9, 13][ 6, 10, 14]&quot;&quot;&quot; è¯´ä¸€äº›å…³äºè¿­ä»£è¾“å‡ºçš„é—®é¢˜ï¼š import numpy as npA = np.arange(3,15).reshape((3,4)) print(A.flatten()) # array([3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14])for item in A.flat: print(item) # 3# 4# â€¦â€¦# 14 [ 3 4 5 6 7 8 9 10 11 12 13 14] 3 4 5 6 7 8 9 10 11 12 13 14 è¿™ä¸€è„šæœ¬ä¸­çš„flattenæ˜¯ä¸€ä¸ªå±•å¼€æ€§è´¨çš„å‡½æ•°ï¼Œå°†å¤šç»´çš„çŸ©é˜µè¿›è¡Œå±•å¼€æˆ1è¡Œçš„æ•°åˆ—ã€‚è€Œflatæ˜¯ä¸€ä¸ªè¿­ä»£å™¨ï¼Œæœ¬èº«æ˜¯ä¸€ä¸ªobjectå±æ€§ã€‚ Reference numpy.org numpy docs morvanzhou","categories":[{"name":"python","slug":"python","permalink":"http://iequa.com/categories/python/"}],"tags":[{"name":"Numpy","slug":"Numpy","permalink":"http://iequa.com/tags/Numpy/"}]},{"title":"Numpy Basic Operation 2","slug":"python/numpy-pandas/py-numpy-4-basic-operation-2","date":"2017-12-25T06:43:21.000Z","updated":"2019-10-20T04:30:35.000Z","comments":true,"path":"2017/12/25/python/numpy-pandas/py-numpy-4-basic-operation-2/","link":"","permalink":"http://iequa.com/2017/12/25/python/numpy-pandas/py-numpy-4-basic-operation-2/","excerpt":"numpy çŸ©é˜µçš„åŸºæœ¬æ“ä½œï¼Œargmin/argmaxã€mean/averageã€cumsumã€sortã€transpose/A.Tã€clip","text":"numpy çŸ©é˜µçš„åŸºæœ¬æ“ä½œï¼Œargmin/argmaxã€mean/averageã€cumsumã€sortã€transpose/A.Tã€clip argmin &amp; argmaxçŸ©é˜µå¯¹åº”å…ƒç´ çš„ç´¢å¼•ä¹Ÿæ˜¯éå¸¸é‡è¦çš„ å…¶ä¸­çš„ argmin() å’Œ argmax() ä¸¤ä¸ªå‡½æ•°åˆ†åˆ«å¯¹åº”ç€æ±‚çŸ©é˜µä¸­æœ€å°å…ƒç´ å’Œæœ€å¤§å…ƒç´ çš„ç´¢å¼•ã€‚ç›¸åº”çš„ï¼Œåœ¨çŸ©é˜µçš„12ä¸ªå…ƒç´ ä¸­ï¼Œæœ€å°å€¼å³2ï¼Œå¯¹åº”ç´¢å¼•0ï¼Œæœ€å¤§å€¼ä¸º13ï¼Œå¯¹åº”ç´¢å¼•ä¸º11ã€‚ import numpy as npA = np.arange(2,14).reshape((3,4)) # array([[ 2, 3, 4, 5]# [ 6, 7, 8, 9]# [10,11,12,13]]) print(np.argmin(A)) # 0print(np.argmax(A)) # 11 0 11 mean &amp; averageç»Ÿè®¡ä¸­çš„å‡å€¼ï¼Œå¯ä»¥åˆ©ç”¨ä¸‹é¢çš„æ–¹å¼ï¼Œå°†æ•´ä¸ªçŸ©é˜µçš„å‡å€¼æ±‚å‡ºæ¥ï¼š print(np.mean(A)) # 7.5print(np.average(A)) # 7.5 7.5 7.5 ä»¿ç…§ç€å‰ä¸€èŠ‚ä¸­dot() çš„ä½¿ç”¨æ³•åˆ™ï¼Œmean()å‡½æ•°è¿˜æœ‰å¦å¤–ä¸€ç§å†™æ³•ï¼š print(A.mean()) # 7.5 7.5 cumsumå’Œmatlabä¸­çš„cumsum()ç´¯åŠ å‡½æ•°ç±»ä¼¼ï¼ŒNumpyä¸­ä¹Ÿå…·æœ‰cumsum()å‡½æ•°ï¼Œå…¶ç”¨æ³•å¦‚ä¸‹ï¼š print(np.cumsum(A)) # [2 5 9 14 20 27 35 44 54 65 77 90] [ 2 5 9 14 20 27 35 44 54 65 77 90] åœ¨cumsum()å‡½æ•°ä¸­ï¼šç”Ÿæˆçš„æ¯ä¸€é¡¹çŸ©é˜µå…ƒç´ å‡æ˜¯ä»åŸçŸ©é˜µé¦–é¡¹ç´¯åŠ åˆ°å¯¹åº”é¡¹çš„å…ƒç´ ä¹‹å’Œã€‚æ¯”å¦‚å…ƒç´ 9ï¼Œåœ¨cumsum()ç”Ÿæˆçš„çŸ©é˜µä¸­åºå·ä¸º3ï¼Œå³åŸçŸ©é˜µä¸­2ï¼Œ3ï¼Œ4ä¸‰ä¸ªå…ƒç´ çš„å’Œã€‚ diffç›¸åº”çš„æœ‰ç´¯å·®è¿ç®—å‡½æ•°ï¼š print(np.diff(A)) # [[1 1 1]# [1 1 1]# [1 1 1]] [[1 1 1] [1 1 1] [1 1 1]] è¯¥å‡½æ•°è®¡ç®—çš„ä¾¿æ˜¯æ¯ä¸€è¡Œä¸­åä¸€é¡¹ä¸å‰ä¸€é¡¹ä¹‹å·®ã€‚æ•…ä¸€ä¸ª3è¡Œ4åˆ—çŸ©é˜µé€šè¿‡å‡½æ•°è®¡ç®—å¾—åˆ°çš„çŸ©é˜µä¾¿æ˜¯3è¡Œ3åˆ—çš„çŸ©é˜µã€‚ nonzero() å‡½æ•°, è§‰å¾—ç”¨å¤„ä¸å¤§æœªå­¦ã€‚ sortimport numpy as npA = np.arange(14,2, -1).reshape((3,4)) # array([[14, 13, 12, 11],# [10, 9, 8, 7],# [ 6, 5, 4, 3]])print(np.sort(A)) # array([[11,12,13,14]# [ 7, 8, 9,10]# [ 3, 4, 5, 6]]) [[11 12 13 14] [ 7 8 9 10] [ 3 4 5 6]] transpose &amp; A.TçŸ©é˜µçš„è½¬ç½®æœ‰ä¸¤ç§è¡¨ç¤ºæ–¹æ³•ï¼š print(np.transpose(A)) print(A.T)# array([[14,10, 6]# [13, 9, 5]# [12, 8, 4]# [11, 7, 3]])# array([[14,10, 6]# [13, 9, 5]# [12, 8, 4]# [11, 7, 3]]) [[14 10 6] [13 9 5] [12 8 4] [11 7 3]] [[14 10 6] [13 9 5] [12 8 4] [11 7 3]] clipç‰¹åˆ«çš„ï¼Œåœ¨Numpyä¸­å…·æœ‰clip()å‡½æ•°ï¼Œä¾‹å­å¦‚ä¸‹ï¼š print(A)# array([[14,13,12,11]# [10, 9, 8, 7]# [ 6, 5, 4, 3]])print(np.clip(A,5,9)) # array([[ 9, 9, 9, 9]# [ 9, 9, 8, 7]# [ 6, 5, 5, 5]]) [[14 13 12 11] [10 9 8 7] [ 6 5 4 3]] [[9 9 9 9] [9 9 8 7] [6 5 5 5]] è¿™ä¸ªå‡½æ•°çš„æ ¼å¼æ˜¯clip(Array,Array_min,Array_max)ï¼Œé¡¾åæ€ä¹‰ï¼ŒArrayæŒ‡çš„æ˜¯å°†è¦è¢«æ‰§è¡Œç”¨çš„çŸ©é˜µï¼Œè€Œåé¢çš„æœ€å°å€¼æœ€å¤§å€¼åˆ™ç”¨äºè®©å‡½æ•°åˆ¤æ–­çŸ©é˜µä¸­å…ƒç´ æ˜¯å¦æœ‰æ¯”æœ€å°å€¼å°çš„æˆ–è€…æ¯”æœ€å¤§å€¼å¤§çš„å…ƒç´ ï¼Œå¹¶å°†è¿™äº›æŒ‡å®šçš„å…ƒç´ è½¬æ¢ä¸ºæœ€å°å€¼æˆ–è€…æœ€å¤§å€¼ã€‚ å®é™…ä¸Šæ¯ä¸€ä¸ªNumpyä¸­å¤§å¤šæ•°å‡½æ•°å‡å…·æœ‰å¾ˆå¤šå˜é‡å¯ä»¥æ“ä½œï¼Œä½ å¯ä»¥æŒ‡å®šè¡Œã€åˆ—ç”šè‡³æŸä¸€èŒƒå›´ä¸­çš„å…ƒç´ ã€‚æ›´å¤šå…·ä½“çš„ä½¿ç”¨ç»†èŠ‚è¯·è®°å¾—æŸ¥é˜…Numpyå®˜æ–¹æ–‡æ¡£ã€‚ Reference numpy.org numpy docs morvanzhou","categories":[{"name":"python","slug":"python","permalink":"http://iequa.com/categories/python/"}],"tags":[{"name":"Numpy","slug":"Numpy","permalink":"http://iequa.com/tags/Numpy/"}]},{"title":"Numpy Basic Operation 1","slug":"python/numpy-pandas/py-numpy-3-basic-operation-1","date":"2017-12-25T03:43:21.000Z","updated":"2019-10-20T04:30:35.003Z","comments":true,"path":"2017/12/25/python/numpy-pandas/py-numpy-3-basic-operation-1/","link":"","permalink":"http://iequa.com/2017/12/25/python/numpy-pandas/py-numpy-3-basic-operation-1/","excerpt":"numpy çŸ©é˜µçš„åŸºæœ¬è¿ç®—ï¼ŒåŠ å‡ä¹˜é™¤ã€æ•°å­¦å‡½æ•°ã€æœ€å¤§æœ€å°å€¼ã€axis æŸ¥æ‰¾ ç­‰","text":"numpy çŸ©é˜µçš„åŸºæœ¬è¿ç®—ï¼ŒåŠ å‡ä¹˜é™¤ã€æ•°å­¦å‡½æ•°ã€æœ€å¤§æœ€å°å€¼ã€axis æŸ¥æ‰¾ ç­‰ numpy ç”ŸæˆçŸ©é˜µimport numpy as npa=np.array([10,20,30,40]) # array([10, 20, 30, 40])b=np.arange(4) # array([0, 1, 2, 3])b array([0, 1, 2, 3]) numpy åŠ å‡ä¹˜é™¤ä¸Šè¿°ä»£ç ä¸­çš„ a å’Œ b æ˜¯ä¸¤ä¸ªå±æ€§ä¸º array ä¹Ÿå°±æ˜¯çŸ©é˜µçš„å˜é‡ï¼Œè€Œä¸”äºŒè€…éƒ½æ˜¯1è¡Œ4åˆ—çš„çŸ©é˜µï¼Œ å…¶ä¸­bçŸ©é˜µä¸­çš„å…ƒç´ åˆ†åˆ«æ˜¯ä»0åˆ°3ã€‚ c=a-b # array([10, 19, 28, 37])print(c)c=a+b # array([10, 21, 32, 43])print(c)c=a*b # array([ 0, 20, 60, 120])print(c)c=b**2 # array([0, 1, 4, 9])print(c) [10 19 28 37] [10 21 32 43] [ 0 20 60 120] [0 1 4 9] numpy æ•°å­¦å‡½æ•°numpy ä¸‰è§’å‡½æ•°ç­‰ï¼Œå½“æˆ‘ä»¬éœ€è¦å¯¹çŸ©é˜µä¸­æ¯ä¸€é¡¹å…ƒç´ è¿›è¡Œå‡½æ•°è¿ç®—æ—¶ï¼Œå¯ä»¥å¾ˆç®€ä¾¿çš„è°ƒç”¨å®ƒä»¬ï¼ˆä»¥sinå‡½æ•°ä¸ºä¾‹ï¼‰ï¼š c=10*np.sin(a) # array([-5.44021111, 9.12945251, -9.88031624, 7.4511316 ])print(c) [-5.44021111 9.12945251 -9.88031624 7.4511316 ] print å‡½æ•°è¿›è¡Œé€»è¾‘åˆ¤æ–­print(b&lt;3) # array([ True, True, True, False], dtype=bool) [ True True True False] ä¸Šè¿°è¿ç®—å‡æ˜¯å»ºç«‹åœ¨ä¸€ç»´çŸ©é˜µï¼Œå³åªæœ‰ä¸€è¡Œçš„çŸ©é˜µä¸Šé¢çš„è®¡ç®—ï¼Œå¦‚æœæˆ‘ä»¬æƒ³è¦å¯¹å¤šè¡Œå¤šç»´åº¦çš„çŸ©é˜µè¿›è¡Œæ“ä½œï¼Œéœ€è¦å¯¹å¼€å§‹çš„è„šæœ¬è¿›è¡Œä¸€äº›ä¿®æ”¹ï¼š a=np.array([[1,1],[0,1]])b=np.arange(4).reshape((2,2))print(a)# array([[1, 1],# [0, 1]])print(b)# array([[0, 1],# [2, 3]])print(b &gt; 2) [[1 1] [0 1]] [[0 1] [2 3]] [[False False] [False True]] numpy ä¸¤ç§çŸ©é˜µä¹˜æ³•æ­¤æ—¶æ„é€ å‡ºæ¥çš„çŸ©é˜µaå’Œbä¾¿æ˜¯2è¡Œ2åˆ—çš„ï¼Œå…¶ä¸­ reshape æ“ä½œæ˜¯å¯¹çŸ©é˜µçš„å½¢çŠ¶è¿›è¡Œé‡æ„ï¼Œ å…¶é‡æ„çš„å½¢çŠ¶ä¾¿æ˜¯æ‹¬å·ä¸­ç»™å‡ºçš„æ•°å­—ã€‚ ç¨æ˜¾ä¸åŒçš„æ˜¯ï¼ŒNumpy ä¸­çš„çŸ©é˜µä¹˜æ³•åˆ†ä¸ºä¸¤ç§ï¼Œ å…¶ä¸€æ˜¯å‰æ–‡ä¸­çš„å¯¹åº”å…ƒç´ ç›¸ä¹˜ï¼Œå…¶äºŒæ˜¯æ ‡å‡†çš„çŸ©é˜µä¹˜æ³•è¿ç®—ï¼Œå³å¯¹åº”è¡Œä¹˜å¯¹åº”åˆ—å¾—åˆ°ç›¸åº”å…ƒç´ ï¼š print(a)print(b)c_dot = np.dot(a,b)# array([[2, 4],# [2, 3]])print(&quot;========&quot;)print(c_dot) [[1 1] [0 1]] [[0 1] [2 3]] ======== [[2 4] [2 3]] é™¤æ­¤ä¹‹å¤–è¿˜æœ‰å¦å¤–çš„ä¸€ç§å…³äºdotçš„è¡¨ç¤ºæ–¹æ³•ï¼Œå³ï¼š c_dot_2 = a.dot(b)# array([[2, 4],# [2, 3]]) sum(), min(), max()ä¸‹é¢æˆ‘ä»¬å°†é‡æ–°å®šä¹‰ä¸€ä¸ªè„šæœ¬, æ¥çœ‹çœ‹å…³äº sum(), min(), max() çš„ä½¿ç”¨ï¼š import numpy as npa=np.random.random((2,4))print(a)# array([[ 0.94692159, 0.20821798, 0.35339414, 0.2805278 ],# [ 0.04836775, 0.04023552, 0.44091941, 0.21665268]]) [[ 0.38281924 0.40654978 0.69744113 0.90707595] [ 0.40572074 0.652105 0.24226191 0.95931459]] å› ä¸ºæ˜¯éšæœºç”Ÿæˆæ•°å­—, æ‰€ä»¥ä½ çš„ç»“æœå¯èƒ½ä¼šä¸ä¸€æ ·. åœ¨ç¬¬äºŒè¡Œä¸­å¯¹açš„æ“ä½œæ˜¯ä»¤aä¸­ç”Ÿæˆä¸€ä¸ª2è¡Œ4åˆ—çš„çŸ©é˜µï¼Œä¸”æ¯ä¸€å…ƒç´ å‡æ˜¯æ¥è‡ªä»0åˆ°1çš„éšæœºæ•°ã€‚ åœ¨è¿™ä¸ªéšæœºç”Ÿæˆçš„çŸ©é˜µä¸­ï¼Œæˆ‘ä»¬å¯ä»¥å¯¹å…ƒç´ è¿›è¡Œæ±‚å’Œä»¥åŠå¯»æ‰¾æå€¼çš„æ“ä½œï¼Œå…·ä½“å¦‚ä¸‹ï¼š np.sum(a) # 4.6532883360785817np.min(a) # 0.24226191007863129np.max(a) # 0.95931458707579575 0.95931458707579575 axis è¿›è¡Œèµ‹å€¼å¯¹åº”çš„ä¾¿æ˜¯å¯¹çŸ©é˜µä¸­æ‰€æœ‰å…ƒç´ è¿›è¡Œæ±‚å’Œï¼Œå¯»æ‰¾æœ€å°å€¼ï¼Œå¯»æ‰¾æœ€å¤§å€¼çš„æ“ä½œã€‚ å¯ä»¥é€šè¿‡print()å‡½æ•°å¯¹ç›¸åº”å€¼è¿›è¡Œæ‰“å°æ£€éªŒã€‚ å¦‚æœä½ éœ€è¦å¯¹è¡Œæˆ–è€…åˆ—è¿›è¡ŒæŸ¥æ‰¾è¿ç®—ï¼Œå°±éœ€è¦åœ¨ä¸Šè¿°ä»£ç ä¸­ä¸º axis è¿›è¡Œèµ‹å€¼ã€‚ å½“axisçš„å€¼ä¸º0çš„æ—¶å€™ï¼Œå°†ä¼šä»¥åˆ—ä½œä¸ºæŸ¥æ‰¾å•å…ƒï¼Œ å½“axisçš„å€¼ä¸º1çš„æ—¶å€™ï¼Œå°†ä¼šä»¥è¡Œä½œä¸ºæŸ¥æ‰¾å•å…ƒã€‚ ä¸ºäº†æ›´åŠ æ¸…æ™°ï¼Œåœ¨åˆšæ‰çš„ä¾‹å­ä¸­æˆ‘ä»¬ç»§ç»­è¿›è¡ŒæŸ¥æ‰¾ï¼š print(&quot;a =&quot;,a)# a = [[ 0.23651224 0.41900661 0.84869417 0.46456022]# [ 0.60771087 0.9043845 0.36603285 0.55746074]]print(&quot;sum =&quot;,np.sum(a,axis=1))# sum = [ 1.96877324 2.43558896]print(&quot;min =&quot;,np.min(a,axis=0))# min = [ 0.23651224 0.41900661 0.36603285 0.46456022]print(&quot;max =&quot;,np.max(a,axis=1))# max = [ 0.84869417 0.9043845 ] a = [[ 0.38281924 0.40654978 0.69744113 0.90707595] [ 0.40572074 0.652105 0.24226191 0.95931459]] sum = [ 2.3938861 2.25940224] min = [ 0.38281924 0.40654978 0.24226191 0.90707595] max = [ 0.90707595 0.95931459] Reference numpy.org numpy docs morvanzhou","categories":[{"name":"python","slug":"python","permalink":"http://iequa.com/categories/python/"}],"tags":[{"name":"Numpy","slug":"Numpy","permalink":"http://iequa.com/tags/Numpy/"}]},{"title":"Numpy Array","slug":"python/numpy-pandas/py-numpy-2-array","date":"2017-12-22T08:43:21.000Z","updated":"2019-10-20T04:30:35.000Z","comments":true,"path":"2017/12/22/python/numpy-pandas/py-numpy-2-array/","link":"","permalink":"http://iequa.com/2017/12/22/python/numpy-pandas/py-numpy-2-array/","excerpt":"åˆ›å»º array æœ‰å¾ˆå¤š å½¢å¼","text":"åˆ›å»º array æœ‰å¾ˆå¤š å½¢å¼ å…³é”®å­— arrayï¼šåˆ›å»ºæ•°ç»„ dtypeï¼šæŒ‡å®šæ•°æ®ç±»å‹ zerosï¼šæ•°æ®å…¨ä¸º0 onesï¼šæ•°æ®å…¨ä¸º1 arrangeï¼šæŒ‰æŒ‡å®šèŒƒå›´åˆ›å»ºæ•°æ® linspaceï¼šåˆ›å»ºçº¿æ®µ ä¸ List åŒºåˆ«ä¹‹ä¸€ : æ²¡æœ‰é€—å·åˆ†éš” a = np.array([2,23,4])print(a)# [ 2 23 4] [ 2 23 4] int64 æŒ‡å®šæ•°æ®a = np.array([2,23,4], dtype=np.int) # é»˜è®¤ int ä¸º int64print(a.dtype) #int64a = np.array([2,23,4],dtype=np.int32)print(a.dtype)# int32a = np.array([2,23.1,4.0], dtype=np.float) # é»˜è®¤ float ä¸º float64print(a)print(a.dtype)# float64a = np.array([2,23,4],dtype=np.float32)print(a.dtype)# float32 int64 int32 [ 2. 23.1 4. ] float64 float32 åˆ›å»ºç‰¹å®šæ•°æ®a = np.array( [ [2,23,4], [2,23,4] ]) # 2d çŸ©é˜µ 2è¡Œ3åˆ—print(a)&quot;&quot;&quot;[[ 2 23 4] [ 2 32 4]]&quot;&quot;&quot; å…¨é›¶æ•°ç»„# åˆ›å»ºå…¨é›¶æ•°ç»„a = np.zeros((3,4)) # æ•°æ®å…¨ä¸º0ï¼Œ3è¡Œ4åˆ—&quot;&quot;&quot;array([[ 0., 0., 0., 0.], [ 0., 0., 0., 0.], [ 0., 0., 0., 0.]])&quot;&quot;&quot;print(a) å…¨ä¸€æ•°ç»„ åŒæ—¶ä¹Ÿèƒ½æŒ‡å®šè¿™äº›ç‰¹å®šæ•°æ®çš„ dtype: a = np.ones((3,4),dtype = np.int) # æ•°æ®ä¸º1ï¼Œ3è¡Œ4åˆ—&quot;&quot;&quot;array([[1, 1, 1, 1], [1, 1, 1, 1], [1, 1, 1, 1]])&quot;&quot;&quot;print(a) å…¨ç©ºæ•°ç»„np.empty( (2,3) ) # è¿™ä¸ªæ–¹æ³•æœ€å¤§çš„å¥½å¤„å°±æ˜¯é€Ÿåº¦å¿«ï¼Œå› ä¸ºå°‘äº†åˆå§‹åŒ–ç©ºé—´çš„æ“ä½œ array([[ 9.88131292e-324, 1.13635099e-322, 1.97626258e-323], [ 9.88131292e-324, 1.13635099e-322, 1.97626258e-323]]) è¿ç»­æ•°ç»„arangea = np.arange(10,20,2) # 10-19 çš„æ•°æ®ï¼Œ2æ­¥é•¿&quot;&quot;&quot;array([10, 12, 14, 16, 18])&quot;&quot;&quot;print(a)b = np.arange(12)b [10 12 14 16 18] array([ 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]) æ”¹å˜æ•°æ®çš„å½¢çŠ¶reshapea = np.arange(12).reshape((3,4)) # 3è¡Œ4åˆ—ï¼Œ0åˆ°11&quot;&quot;&quot;array([[ 0, 1, 2, 3], [ 4, 5, 6, 7], [ 8, 9, 10, 11]])&quot;&quot;&quot;a çº¿æ®µå‹æ•°æ®linspacea = np.linspace(1,10,20) # å¼€å§‹ç«¯1ï¼Œç»“æŸç«¯10ï¼Œä¸”åˆ†å‰²æˆ20ä¸ªæ•°æ®ï¼Œç”Ÿæˆçº¿æ®µ&quot;&quot;&quot;array([ 1. , 1.47368421, 1.94736842, 2.42105263, 2.89473684, 3.36842105, 3.84210526, 4.31578947, 4.78947368, 5.26315789, 5.73684211, 6.21052632, 6.68421053, 7.15789474, 7.63157895, 8.10526316, 8.57894737, 9.05263158, 9.52631579, 10. ])&quot;&quot;&quot;a ä¹Ÿèƒ½è¿›è¡Œ reshape å·¥ä½œ: a = np.linspace(1,10,20).reshape((5,4)) # æ›´æ”¹shape&quot;&quot;&quot;array([[ 1. , 1.47368421, 1.94736842, 2.42105263], [ 2.89473684, 3.36842105, 3.84210526, 4.31578947], [ 4.78947368, 5.26315789, 5.73684211, 6.21052632], [ 6.68421053, 7.15789474, 7.63157895, 8.10526316], [ 8.57894737, 9.05263158, 9.52631579, 10. ]])&quot;&quot;&quot; Reference numpy.org numpy docs morvanzhou","categories":[{"name":"python","slug":"python","permalink":"http://iequa.com/categories/python/"}],"tags":[{"name":"Numpy","slug":"Numpy","permalink":"http://iequa.com/tags/Numpy/"}]},{"title":"Numpy Attribute","slug":"python/numpy-pandas/py-numpy-1-attribute","date":"2017-12-21T08:43:21.000Z","updated":"2019-10-20T04:30:35.000Z","comments":true,"path":"2017/12/21/python/numpy-pandas/py-numpy-1-attribute/","link":"","permalink":"http://iequa.com/2017/12/21/python/numpy-pandas/py-numpy-1-attribute/","excerpt":"numpy çš„å‡ ç§å±æ€§ ç»´åº¦ã€è¡Œåˆ—ä¸ªæ•°ã€å…ƒç´ ä¸ªæ•°","text":"numpy çš„å‡ ç§å±æ€§ ç»´åº¦ã€è¡Œåˆ—ä¸ªæ•°ã€å…ƒç´ ä¸ªæ•° ndimï¼šç»´åº¦ shapeï¼šè¡Œæ•°å’Œåˆ—æ•° sizeï¼šå…ƒç´ ä¸ªæ•° åˆ—è¡¨è½¬åŒ–ä¸ºçŸ©é˜µï¼š import numpy as nparray1 = np.array( [ [1,2,3], [2,3,4] ])print(array1)print(&#x27;number of dim:&#x27;, array1.ndim)print(&#x27;shape:&#x27;, array1.shape)print(&#x27;size:&#x27;, array1.size)&quot;&quot;&quot; [[1 2 3] [2 3 4]] number of dim: 2 shape: (2, 3) size: 6&quot;&quot;&quot; Reference numpy.org numpy docs","categories":[{"name":"python","slug":"python","permalink":"http://iequa.com/categories/python/"}],"tags":[{"name":"Numpy","slug":"Numpy","permalink":"http://iequa.com/tags/Numpy/"}]},{"title":"æ¨å¸…å®Œç¾å‘éŸ³ç­(2)","slug":"English/english-ielts-speaking-yangshuai-2","date":"2017-12-10T00:18:21.000Z","updated":"2019-10-20T04:30:35.031Z","comments":true,"path":"2017/12/10/English/english-ielts-speaking-yangshuai-2/","link":"","permalink":"http://iequa.com/2017/12/10/English/english-ielts-speaking-yangshuai-2/","excerpt":"ä¸€å®šè¦ä¸æ–­é‡å¤ï¼Œä¸è¦ç›¸ä¿¡è‡ªå·±çš„è€³æœµï¼Œè¦ç›¸ä¿¡éŸ³æ ‡ æœ€å¼€å§‹ç»ƒä¹ ï¼Œä¸€å®šè¦è¶…çº§å¤¸å¼ ï¼Œä¸€ä¸ªéŸ³ä¸€ä¸ªéŸ³è¯»","text":"ä¸€å®šè¦ä¸æ–­é‡å¤ï¼Œä¸è¦ç›¸ä¿¡è‡ªå·±çš„è€³æœµï¼Œè¦ç›¸ä¿¡éŸ³æ ‡ æœ€å¼€å§‹ç»ƒä¹ ï¼Œä¸€å®šè¦è¶…çº§å¤¸å¼ ï¼Œä¸€ä¸ªéŸ³ä¸€ä¸ªéŸ³è¯» éŸ³æ ‡ è¯»æ³• å¸¸è§ç»„åˆ /i:/ é•¿å…ƒç´§å¼ éŸ³ ee, ea, e, ie, ei /i/ çŸ­å…ƒæ”¾æ¾éŸ³ i, y, e /É›/ /i/ å˜´å‹ç¨å¾®å¤§äº› eã€eaã€aã€ai /Ã¦/ /É›/+/a:/ a /É’/ å˜´å¼ å¼€ã€æ— å˜åŒ– oã€a /É”:/ æœ‰ç‚¹åƒ â€˜æ²ƒâ€™ orã€ourã€arã€alã€auã€ou /aÊŠ/ /Ã¦/+/u/ ouã€ow &emsp;&emsp;&emsp; i:ã€iã€u:ã€uã€É›ã€Ã¦ã€É’ã€É”:ã€aÊŠ i: seatã€deedã€leastã€feetã€colleague [ËˆkÉ’li:g]ã€eatã€beatã€leaveã€steelã€steal i sitã€didã€listã€fitã€collegeã€itã€bitã€liveã€still u: foodã€poolã€foolã€moodã€moonã€roomã€schoolã€loseã€trueã€blueã€glue ÊŠ lookã€goodã€footã€bookã€cookã€fullã€pullã€pushã€putã€shouldã€wouldã€could É› bedã€betterã€getã€internetã€lessonã€deskã€sellã€sleptã€thenã€helpã€veryã€neverã€headã€breadã€pleasureã€treasureã€healthã€breathã€saidã€thereã€theirã€whereã€everywhereã€anyã€manyã€guess Ã¦ flagã€catã€backã€thatã€haveã€activityã€naturalã€travelã€relaxã€attractiveã€casualã€magazineã€fancy É’ notã€lostã€lossã€boxã€mopã€collarã€shopã€jobã€topã€soccerã€biographyã€psychologyã€novelã€want É”: horseã€moreã€shortã€storeã€courtã€courseã€mournã€warmã€quarterã€smallã€wallã€ballã€talkã€walkã€autumnã€caughtã€taughtã€boughtã€thoughtã€brought aÊŠ houseã€outã€aboutã€loudã€downã€townã€cowã€howeverã€nowã€howã€mouseã€mouthã€aroundã€groundã€foundã€accountingã€sound","categories":[{"name":"English","slug":"English","permalink":"http://iequa.com/categories/English/"}],"tags":[{"name":"IELTS","slug":"IELTS","permalink":"http://iequa.com/tags/IELTS/"}]},{"title":"Pyenv Install Anaconda3","slug":"devops/ops-pyenv-Anaconda3-note","date":"2017-12-07T02:16:21.000Z","updated":"2019-10-20T04:30:34.993Z","comments":true,"path":"2017/12/07/devops/ops-pyenv-Anaconda3-note/","link":"","permalink":"http://iequa.com/2017/12/07/devops/ops-pyenv-Anaconda3-note/","excerpt":"pyenv install anaconda3-5.0.0 æ— æ³•ä¸‹è½½åŒ…çš„æƒ…å†µä¸‹ä½¿ç”¨çš„ï¼Œå› ä¸ºç½‘é€Ÿå®åœ¨å¤ªæ…¢äº†T T","text":"pyenv install anaconda3-5.0.0 æ— æ³•ä¸‹è½½åŒ…çš„æƒ…å†µä¸‹ä½¿ç”¨çš„ï¼Œå› ä¸ºç½‘é€Ÿå®åœ¨å¤ªæ…¢äº†T T Anaconda3å®˜ç½‘ ä¸‹è½½äº†.shæ–‡ä»¶ï¼Œåœ¨è¯¥.shæ–‡ä»¶ç›®å½•ä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤å®‰è£…è¯¥æ–‡ä»¶ Anaconda3-5.0.1-MacOSX-x86_64.sh âœ mv Anaconda3-5.0.1-MacOSX-x86_64.sh ~/.pyenv/cache/âœ cache git:(master) sh Anaconda3-5.0.1-MacOSX-x86_64.sh å®‰è£…è¿‡ç¨‹éœ€è¦æ“ä½œçš„åœ°æ–¹ï¼š Please, press ENTER to continue&gt;&gt;&gt;...Do you accept the license terms? [yes|no][no] &gt;&gt;&gt; yes Anaconda3 will now be installed into this location:/Users/blair/anaconda3 - Press ENTER to confirm the location- Press CTRL-C to abort the installation- Or specify a different location below [/Users/blair/anaconda3] æ”¹ä¸º /Users/blair/.pyenv/versions/anaconda3 è¾“å…¥éœ€è¦å®‰è£…çš„ç›®å½•ï¼Œå› ä¸ºè¦æ·»åŠ åˆ°pyenvç®¡ç†å™¨ä¸­ï¼Œæ‰€ä»¥ä¸å…¶ä»–ä»¥å®‰è£…çš„Pythonç‰ˆæœ¬æ”¾åœ¨åŒä¸€ç›®å½•ä¸‹ã€‚ å¼€å§‹è¾“å‡ºå®‰è£…ä¿¡æ¯ï¼Œä¼šå®‰è£…è®¸å¤šåŒ…ï¼š [/Users/blair/anaconda3] &gt;&gt;&gt; /Users/blair/.pyenv/versions/anaconda3PREFIX=/Users/blair/.pyenv/versions/anaconda3installing: python-3.6.3-h6804ab2_0 ...Python 3.6.3 :: Anaconda, Inc.installing: bzip2-1.0.6-h92991f9_1 ...installing: ca-certificates-2017.08.26-ha1e5d58_0 ...installing: conda-env-2.6.0-h36134e3_0 ...â€¦â€¦ ç„¶åå‡ºç°æç¤ºï¼Œè¾“å…¥yeså³å¯ installation finished.Do you wish the installer to prepend the Anaconda3 install locationto PATH in your /Users/blair/.bash_profile ? [yes|no][yes] &gt;&gt;&gt; yes å®‰è£…æˆåŠŸï¼ âœ pyenv versions system 2.7.14 2.7.14/envs/vpy2 3.5.4 3.5.4/envs/vpy3.5* anaconda3 (set by /Users/blair/.pyenv/version) anaconda3/envs/vconda3 vconda3 vpy2 vpy3.5(anaconda3)# ~/ghome [10:34:54] ä¸ºanaconda3åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ âœ cache git:(master) pyenv virtualenv vconda3 å¯èƒ½ä¼šè£…ä¸€äº›æ›´æ–°åŒ…ï¼Œä¼šæœ‰æç¤ºï¼š ## To activate this environment, use:# &gt; source activate vconda3## To deactivate an active environment, use:# &gt; source deactivate æ ¹æ®æç¤ºæ¿€æ´»ï¼š âœ cache git:(master) source activate vconda3","categories":[{"name":"devops","slug":"devops","permalink":"http://iequa.com/categories/devops/"}],"tags":[{"name":"Anaconda3","slug":"Anaconda3","permalink":"http://iequa.com/tags/Anaconda3/"}]},{"title":"æ¨å¸…å®Œç¾å‘éŸ³ç­(1)","slug":"English/english-ielts-speaking-yangshuai-1","date":"2017-12-03T13:55:21.000Z","updated":"2019-10-20T04:30:35.032Z","comments":true,"path":"2017/12/03/English/english-ielts-speaking-yangshuai-1/","link":"","permalink":"http://iequa.com/2017/12/03/English/english-ielts-speaking-yangshuai-1/","excerpt":"æŠŠå‘éŸ³ç»ƒå¥½çš„æ–¹æ³•å°±æ˜¯é‡å¤, è¯­è¨€å­¦ä¹ çš„æœ¬è´¨å°±æ˜¯æ¨¡ä»¿ but youâ€™re oldâ€¦ 0 ~ 6 years å¯ä»¥é€šè¿‡è€³æœµè¯†åˆ« 140 ä¸ªä¸åŒçš„éŸ³, ä¹Ÿå¯ä»¥é©¬ä¸Šæ¨¡ä»¿ 6 å²ä¹‹åï¼Œè¿™ç§èƒ½åŠ›é€æ¸ä¸‹é™â€¦ï¼Œ æ‰€ä»¥ä½ å¤©å¤©å¬å‰‘æ¡¥è‹±è¯­ï¼Œæˆ–è€…ä½ å»å¤–å›½10å‡ å¹´ï¼Œè¿˜æ˜¯ä¸­å¼å‘éŸ³","text":"æŠŠå‘éŸ³ç»ƒå¥½çš„æ–¹æ³•å°±æ˜¯é‡å¤, è¯­è¨€å­¦ä¹ çš„æœ¬è´¨å°±æ˜¯æ¨¡ä»¿ but youâ€™re oldâ€¦ 0 ~ 6 years å¯ä»¥é€šè¿‡è€³æœµè¯†åˆ« 140 ä¸ªä¸åŒçš„éŸ³, ä¹Ÿå¯ä»¥é©¬ä¸Šæ¨¡ä»¿ 6 å²ä¹‹åï¼Œè¿™ç§èƒ½åŠ›é€æ¸ä¸‹é™â€¦ï¼Œ æ‰€ä»¥ä½ å¤©å¤©å¬å‰‘æ¡¥è‹±è¯­ï¼Œæˆ–è€…ä½ å»å¤–å›½10å‡ å¹´ï¼Œè¿˜æ˜¯ä¸­å¼å‘éŸ³ 1. ç†è®º + æ¨¡ä»¿Less is more. Practice makes progress å°‘è€Œç²¾ï¼Œèå…¥è¡€æ¶²ï¼Œèå…¥éª¨é«“ ç†è®º - ä¸ç”¨å¤©å¤© (è®©æ¨¡ä»¿æ›´åŠ æœ‰æ•ˆæœ)æ¨¡ä»¿ - æ˜¯å¤©å¤©éœ€è¦çš„ 2. å‘éŸ³å­¦ä¹ çš„å‡ å¤§æ³¨æ„: æ‡‚éŸ³æ ‡ (è‡ªå­¦) ä¸€å®šè¦ä¸æ–­é‡å¤ ä¸è¦ç›¸ä¿¡è‡ªå·±çš„è€³æœµï¼Œè¦ç›¸ä¿¡éŸ³æ ‡ æœ€å¼€å§‹ç»ƒä¹ ï¼Œä¸€å®šè¦è¶…çº§å¤¸å¼  ä¸€ä¸ªéŸ³ä¸€ä¸ªéŸ³è¯» experience [ÉªkËˆspÉªriÉ™ns]serious [ËˆsÉªriÉ™s]series [ËˆsÉªri:z]down [daÊŠn] æ¨èå­—å…¸Oxford (è‹±éŸ³)Merriam Webster (ç¾éŸ³) æœ€æ˜“é”™å…ƒéŸ³ â€” ä¿6 è¾…éŸ³ + è¯­è°ƒ (é‡è¯»ã€è¿è¯») â€” äº‰7 ç•¥è¯» + è‹±ç¾éŸ³ä¸»è¦åŒºåˆ« â€” å¸¦ä½ è£…å¸¦ä½ é£ ä»è‹±åˆ°ç¾flat [flÃ¦t]ã€cat [kÃ¦t]kite [kaÉªt]ã€ dog [dÉ’g] [dÉ”:g] bed [bed]ã€[bÉ›d]bought [bÉ”:t]ã€[bÉ”t]usually [Ëˆju:Ê’uÉ™li]ã€ [ËˆjuËÊ’uÉ™li] garage [ËˆgÃ¦rÉ‘:Ê’]ã€[gÉ™ËˆrÉ‘:Ê’] ...... ä¸­å›½äººé—®é¢˜æœ€å¤§çš„ä¸‰ä¸ªå…ƒéŸ³/ai/ /Ã¦/ /É›/ /ai/ = /a:/-/i/ å­—æ¯ç»„åˆ: ä¸»è¦ iï¼Œieï¼Œyï¼Œighï¼Œuy timeï¼Œwhiteï¼Œdieï¼Œtieddryï¼Œwhyï¼ŒJulyhightï¼Œnightã€rightbuyï¼Œguykindï¼Œmindï¼Œwindall kinds ofï¼Œspring to mindï¼Œwind downï¼Œunwind word phonetic symbol sentence die [dai] I donâ€™t want to die. died [daid] My dog died yesterday. dying [ËˆdaÉªÉªÅ‹] The man is dying. dead [ded]ï¼Œ[dÉ›d] Her cat is dead. é•¿çŸ­éŸ³çš„åŒºåˆ† é•¿éŸ³: tense(ç´§å¼ éŸ³) â€” é•¿å…ƒç´§å¼ éŸ³ - beach çŸ­éŸ³: lax (æ”¾æ¾éŸ³) â€” çŸ­å…ƒæ”¾æ¾éŸ³ - bitch /i:/ ä¸æ”¾æ¾éŸ³ , å­—æ¯ç»„åˆ: ä¸»è¦ eeï¼Œeaï¼Œeï¼Œieï¼Œei weekï¼Œweakï¼Œtreeï¼Œmeetï¼Œthreeï¼Œseeï¼Œseekï¼Œmeatï¼Œleaveï¼Œeatï¼Œbeatleadï¼Œeachï¼Œcolleagueï¼Œteamï¼Œreadï¼Œspeakï¼Œpleaseï¼Œpieceï¼Œreceiveextremelyï¼Œmedia /ei/ ä¸€å®šè¦é¥±æ»¡ , å­—æ¯ç»„åˆ: ä¸»è¦ ayï¼Œa tree. tray [trei]see. say [sei]week. wake [weik]piece. pace [peis] /i/ æ˜¯ /i:/ çš„æ”¾æ¾ä¸ç”¨åŠ›éŸ³ , å­—æ¯ç»„åˆ: ä¸»è¦ iï¼Œy sitï¼Œitï¼Œisï¼Œliveï¼Œdidï¼Œthisï¼Œkidï¼Œlistï¼Œsixfixï¼Œfitï¼Œclickï¼Œifï¼Œbigï¼Œgiveï¼Œgiftï¼Œtripstillï¼Œmissï¼Œfinishï¼Œhabitï¼Œmystery [ËˆmÉªstÉ™ri]ï¼Œcollege [ËˆkÉ‘:lÉªdÊ’]","categories":[{"name":"English","slug":"English","permalink":"http://iequa.com/categories/English/"}],"tags":[{"name":"IELTS","slug":"IELTS","permalink":"http://iequa.com/tags/IELTS/"}]},{"title":"mac å®‰è£… mysql ä¸ å¸¸ç”¨å‘½ä»¤","slug":"devops/ops-mac-mysql","date":"2017-12-03T01:16:21.000Z","updated":"2019-10-20T04:30:34.990Z","comments":true,"path":"2017/12/03/devops/ops-mac-mysql/","link":"","permalink":"http://iequa.com/2017/12/03/devops/ops-mac-mysql/","excerpt":"ä»‹ç» Mac å®‰è£… Mysql ä¸ mysql åœ¨ mac åœ¨çš„å‘½ä»¤","text":"ä»‹ç» Mac å®‰è£… Mysql ä¸ mysql åœ¨ mac åœ¨çš„å‘½ä»¤ 1. brew installbrew install mysql åœ¨macä¸‹ä½¿ç”¨ brew å®‰è£… mysqlï¼Œä¹‹å‰æ²¡æœ‰ä½¿ç”¨è¿‡ï¼Œä»Šå¤©å¯åŠ¨çš„æ—¶å€™å‘ç°å¯åŠ¨ä¸äº† # /usr/local/bin [9:31:54]âœ mysqlERROR 2002 (HY000): Can&#x27;t connect to local MySQL server through socket &#x27;/tmp/mysql.sock&#x27; (2) âœ brew info mysqlmysql: stable 8.0.12 (bottled) 2. å¯åŠ¨mysqlâœ mysql.server start 3. è®¾ç½®å¯†ç mysql_secure_installation 4. è¿›å…¥mysqlmysql -u root -p mysql&gt; show databases;+--------------------+| Database |+--------------------+| information_schema || mysql || performance_schema || sys |+--------------------+4 rows in set (0.01 sec)mysql&gt; 5. å¸¸ç”¨å‘½ä»¤$ mysql.server start$ mysql.server restart$ mysql.server stop$ mysql.server status$ mysql -u root -p Reference macç”¨brewå®‰è£…mysql,è®¾ç½®åˆå§‹å¯†ç ","categories":[{"name":"devops","slug":"devops","permalink":"http://iequa.com/categories/devops/"}],"tags":[{"name":"mysql","slug":"mysql","permalink":"http://iequa.com/tags/mysql/"}]},{"title":"Neural Networks and Deep Learning (week1) - Introduction to Deep Learning","slug":"deeplearning/Neural-Networks-and-Deep-Learning-week1","date":"2017-12-01T11:55:21.000Z","updated":"2019-10-20T04:30:35.016Z","comments":true,"path":"2017/12/01/deeplearning/Neural-Networks-and-Deep-Learning-week1/","link":"","permalink":"http://iequa.com/2017/12/01/deeplearning/Neural-Networks-and-Deep-Learning-week1/","excerpt":"Introduction to Deep Learning What is a Neural Network ? Why is Deep Learning taking off ?","text":"Introduction to Deep Learning What is a Neural Network ? Why is Deep Learning taking off ? 1. Introduction to Deep Learning Whatâ€™s youâ€™ll learn 2. What is a Neural Network ?Housing Price Prediction 3. Why is Deep Learning taking off ? Data ã€ Computation ã€ Algorithms Reference Andrew Ng - deeplearning.ai ç½‘æ˜“äº‘è¯¾å ‚ - ç¬¬ä¸€å‘¨æ·±åº¦å­¦ä¹ æ¦‚è®º","categories":[{"name":"deeplearning","slug":"deeplearning","permalink":"http://iequa.com/categories/deeplearning/"}],"tags":[{"name":"deeplearning.ai","slug":"deeplearning-ai","permalink":"http://iequa.com/tags/deeplearning-ai/"}]},{"title":"ç†è®º seq2seq+Attention æœºåˆ¶æ¨¡å‹è¯¦è§£","slug":"nlp/seq2seq+Attention","date":"2017-11-17T12:00:21.000Z","updated":"2020-12-07T00:16:08.573Z","comments":true,"path":"2017/11/17/nlp/seq2seq+Attention/","link":"","permalink":"http://iequa.com/2017/11/17/nlp/seq2seq+Attention/","excerpt":"ä»å…·ä½“çš„æ¨¡å‹ç»†èŠ‚ã€å…¬å¼æ¨å¯¼ã€ç»“æ„å›¾ä»¥åŠå˜å½¢ç­‰å‡ ä¸ªæ–¹å‘è¯¦ç»†ä»‹ç»ä¸€ä¸‹ Seq-to-Seq æ¨¡å‹ã€‚","text":"ä»å…·ä½“çš„æ¨¡å‹ç»†èŠ‚ã€å…¬å¼æ¨å¯¼ã€ç»“æ„å›¾ä»¥åŠå˜å½¢ç­‰å‡ ä¸ªæ–¹å‘è¯¦ç»†ä»‹ç»ä¸€ä¸‹ Seq-to-Seq æ¨¡å‹ã€‚ Seq-to-Seq æ¡†æ¶1 Seq-to-Seq æ¡†æ¶2ï¼ˆteacher forcingï¼‰ Seq-to-Seq with Attentionï¼ˆNMTï¼‰ Seq-to-Seq with Attention å„ç§å˜å½¢ Seq-to-Seq with Beam-Search å½“è¾“å…¥è¾“å‡ºéƒ½æ˜¯ä¸å®šé•¿åºåˆ—æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ç¼–ç å™¨â€”è§£ç å™¨ï¼ˆencoder-decoderï¼‰1 æˆ–è€… seq2seq æ¨¡å‹ 2ã€‚è¿™ä¸¤ä¸ªæ¨¡å‹æœ¬è´¨ä¸Šéƒ½ç”¨åˆ°äº†ä¸¤ä¸ªå¾ªç¯ç¥ç»ç½‘ç»œï¼Œåˆ†åˆ«å«åšç¼–ç å™¨å’Œè§£ç å™¨ã€‚ç¼–ç å™¨ç”¨æ¥åˆ†æè¾“å…¥åºåˆ—ï¼Œè§£ç å™¨ç”¨æ¥ç”Ÿæˆè¾“å‡ºåºåˆ—ã€‚ 1. Seq2Seq æ¡†æ¶1 Learning Phrase Representations using RNN Encoderâ€“Decoder for Statistical Machine Translation 1.1 encode ç¼–ç å™¨ç¼–ç å™¨çš„ä½œç”¨æ˜¯æŠŠä¸€ä¸ªä¸å®šé•¿çš„è¾“å…¥åºåˆ—å˜æ¢æˆä¸€ä¸ªå®šé•¿çš„èƒŒæ™¯å˜é‡ $c$ï¼Œå¹¶åœ¨è¯¥èƒŒæ™¯å˜é‡ä¸­ç¼–ç è¾“å…¥åºåˆ—ä¿¡æ¯ã€‚å¸¸ç”¨çš„ç¼–ç å™¨æ˜¯å¾ªç¯ç¥ç»ç½‘ç»œã€‚ è®©æˆ‘ä»¬è€ƒè™‘æ‰¹é‡å¤§å°ä¸º 1 çš„æ—¶åºæ•°æ®æ ·æœ¬ã€‚å‡è®¾è¾“å…¥åºåˆ—æ˜¯ $x1,\\ldots,x_T$, ä¾‹å¦‚ $x_i$ æ˜¯è¾“å…¥å¥å­ä¸­çš„ç¬¬ $i$ ä¸ªè¯ã€‚åœ¨æ—¶é—´æ­¥ $t$ï¼Œå¾ªç¯ç¥ç»ç½‘ç»œå°†è¾“å…¥ $x_t$ çš„ç‰¹å¾å‘é‡ $x_t$ å’Œä¸Šä¸ªæ—¶é—´æ­¥çš„éšè—çŠ¶æ€ $\\boldsymbol{h}{t-1}$ å˜æ¢ä¸ºå½“å‰æ—¶é—´æ­¥çš„éšè—çŠ¶æ€ $h_t$ã€‚æˆ‘ä»¬å¯ä»¥ç”¨å‡½æ•° $f$ è¡¨è¾¾å¾ªç¯ç¥ç»ç½‘ç»œéšè—å±‚çš„å˜æ¢ï¼š \\boldsymbol{h}_t = f(\\boldsymbol{x}_t, \\boldsymbol{h}_{t-1}).æ¥ä¸‹æ¥ç¼–ç å™¨é€šè¿‡è‡ªå®šä¹‰å‡½æ•° $q$ å°†å„ä¸ªæ—¶é—´æ­¥çš„éšè—çŠ¶æ€å˜æ¢ä¸ºèƒŒæ™¯å˜é‡ \\boldsymbol{c} = q(\\boldsymbol{h}_1, \\ldots, \\boldsymbol{h}_T).ä¾‹å¦‚ï¼Œå½“é€‰æ‹© $q(\\boldsymbol{h}_1, \\ldots, \\boldsymbol{h}_T) = \\boldsymbol{h}_T$ æ—¶ï¼ŒèƒŒæ™¯å˜é‡æ˜¯è¾“å…¥åºåˆ—æœ€ç»ˆæ—¶é—´æ­¥çš„éšè—çŠ¶æ€ $\\boldsymbol{h}_T$ã€‚ ä»¥ä¸Šæè¿°çš„ç¼–ç å™¨æ˜¯ä¸€ä¸ªå•å‘çš„ RNNï¼Œæ¯ä¸ªæ—¶é—´æ­¥çš„éšè—çŠ¶æ€åªå–å†³äºè¯¥æ—¶é—´æ­¥åŠä¹‹å‰çš„è¾“å…¥å­åºåˆ—ã€‚æˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨ Bi-RNN æ„é€ ç¼–ç å™¨ã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œç¼–ç å™¨æ¯ä¸ªæ—¶é—´æ­¥çš„éšè—çŠ¶æ€åŒæ—¶å–å†³äºè¯¥æ—¶é—´æ­¥ä¹‹å‰å’Œä¹‹åçš„å­åºåˆ—ï¼ˆåŒ…æ‹¬å½“å‰æ—¶é—´æ­¥çš„è¾“å…¥ï¼‰ï¼Œå¹¶ç¼–ç äº†æ•´ä¸ªåºåˆ—çš„ä¿¡æ¯ã€‚ 1.2 decode è§£ç å™¨Encode ç¼–ç å™¨è¾“å‡ºçš„èƒŒæ™¯å˜é‡ $c$ ç¼–ç äº†æ•´ä¸ªè¾“å…¥åºåˆ— $x1, \\ldots, x_T$ çš„ä¿¡æ¯ã€‚ç»™å®šè®­ç»ƒæ ·æœ¬ä¸­çš„è¾“å‡ºåºåˆ— $y_1, y_2, \\ldots, y{Tâ€™}$ï¼Œå¯¹æ¯ä¸ªæ—¶é—´æ­¥ $tâ€™$ï¼ˆç¬¦å·ä¸è¾“å…¥åºåˆ—æˆ–ç¼–ç å™¨çš„æ—¶é—´æ­¥ $t$ æœ‰åŒºåˆ«ï¼‰ï¼Œ è§£ç å™¨è¾“å‡º $y{tâ€™}$ çš„æ¡ä»¶æ¦‚ç‡å°†åŸºäºä¹‹å‰çš„è¾“å‡ºåºåˆ— $y_1,\\ldots,y{tâ€™-1}$ å’ŒèƒŒæ™¯å˜é‡ $c$ï¼Œå³ $\\mathbb{P}(y{tâ€™} \\mid y_1, \\ldots, y{tâ€™-1}, \\boldsymbol{c})$ã€‚ ä¸ºæ­¤ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¦ä¸€ä¸ªRNNä½œä¸ºè§£ç å™¨ã€‚ åœ¨è¾“å‡ºåºåˆ—çš„æ—¶é—´æ­¥ $t^\\prime$ï¼Œè§£ç å™¨å°†ä¸Šä¸€æ—¶é—´æ­¥çš„è¾“å‡º $y{t^\\prime-1}$ ä»¥åŠèƒŒæ™¯å˜é‡ $c$ ä½œä¸ºè¾“å…¥ï¼Œå¹¶å°†å®ƒä»¬ä¸ä¸Šä¸€æ—¶é—´æ­¥çš„éšè—çŠ¶æ€ $\\boldsymbol{h}{t^\\prime-1}$ å˜æ¢ä¸ºå½“å‰æ—¶é—´æ­¥çš„éšè—çŠ¶æ€ $\\boldsymbol{h}_{t^\\prime}$ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨å‡½æ•° $g$ è¡¨è¾¾è§£ç å™¨éšè—å±‚çš„å˜æ¢ï¼š \\boldsymbol{h}_{t^\\prime} = g(y_{t^\\prime-1}, \\boldsymbol{c}, \\boldsymbol{h}_{t^\\prime-1}).æœ‰äº†decodeçš„éšè—çŠ¶æ€åï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨è‡ªå®šä¹‰çš„è¾“å‡ºå±‚å’Œ softmax è¿ç®—æ¥è®¡ç®— $\\mathbb{P}(y{t^\\prime} \\mid y_1, \\ldots, y{t^\\prime-1}, \\boldsymbol{c})$ï¼Œä¾‹å¦‚åŸºäºå½“å‰æ—¶é—´æ­¥çš„è§£ç å™¨éšè—çŠ¶æ€ $\\boldsymbol{h}{t^\\prime}$ã€ä¸Šä¸€æ—¶é—´æ­¥çš„è¾“å‡º $y{t^\\prime-1}$ ä»¥åŠèƒŒæ™¯å˜é‡ $c$ æ¥è®¡ç®—å½“å‰æ—¶é—´æ­¥è¾“å‡º $y_{t^\\prime}$ çš„æ¦‚ç‡åˆ†å¸ƒã€‚ 1.3 train æ¨¡å‹è®­ç»ƒæ ¹æ®æœ€å¤§ä¼¼ç„¶ä¼°è®¡ï¼Œæˆ‘ä»¬å¯ä»¥æœ€å¤§åŒ–è¾“å‡ºåºåˆ—åŸºäºè¾“å…¥åºåˆ—çš„æ¡ä»¶æ¦‚ç‡ \\begin{split}\\begin{aligned} \\mathbb{P}(y_1, \\ldots, y_{T'} \\mid x_1, \\ldots, x_T) &= \\prod_{t'=1}^{T'} \\mathbb{P}(y_{t'} \\mid y_1, \\ldots, y_{t'-1}, x_1, \\ldots, x_T)\\\\\\\\ &= \\prod_{t'=1}^{T'} \\mathbb{P}(y_{t'} \\mid y_1, \\ldots, y_{t'-1}, \\boldsymbol{c}), \\end{aligned}\\end{split}å¹¶å¾—åˆ°è¯¥è¾“å‡ºåºåˆ—çš„æŸå¤± - \\log\\mathbb{P}(y_1, \\ldots, y_{T'} \\mid x_1, \\ldots, x_T) = -\\sum_{t'=1}^{T'} \\log \\mathbb{P}(y_{t'} \\mid y_1, \\ldots, y_{t'-1}, \\boldsymbol{c}), åœ¨æ¨¡å‹è®­ç»ƒä¸­ï¼Œæ‰€æœ‰è¾“å‡ºåºåˆ—æŸå¤±çš„å‡å€¼é€šå¸¸ä½œä¸ºéœ€è¦æœ€å°åŒ–çš„æŸå¤±å‡½æ•°ã€‚åœ¨å›¾ä¸­æ‰€æè¿°çš„æ¨¡å‹é¢„æµ‹ä¸­ï¼Œæˆ‘ä»¬éœ€è¦å°†decodeåœ¨ä¸Šä¸€ä¸ªæ—¶é—´æ­¥çš„è¾“å‡ºä½œä¸ºå½“å‰æ—¶é—´æ­¥çš„è¾“å…¥ã€‚ä¸æ­¤ä¸åŒï¼Œåœ¨è®­ç»ƒä¸­æˆ‘ä»¬ä¹Ÿå¯ä»¥å°†æ ‡ç­¾åºåˆ—åœ¨ä¸Šä¸€ä¸ªæ—¶é—´æ­¥çš„æ ‡ç­¾ä½œä¸ºdecodeåœ¨å½“å‰æ—¶é—´æ­¥çš„è¾“å…¥ã€‚è¿™å«åšå¼ºåˆ¶æ•™å­¦ï¼ˆteacher forcingï¼‰ã€‚ 1.4 å°ç»“ ç¼–ç å™¨ - è§£ç å™¨ï¼ˆseq2seqï¼‰å¯ä»¥è¾“å…¥å¹¶è¾“å‡ºä¸å®šé•¿çš„åºåˆ—ã€‚ ç¼–ç å™¨â€”è§£ç å™¨ä½¿ç”¨äº†ä¸¤ä¸ªå¾ªç¯ç¥ç»ç½‘ç»œã€‚ åœ¨ç¼–ç å™¨â€”è§£ç å™¨çš„è®­ç»ƒä¸­ï¼Œæˆ‘ä»¬å¯ä»¥é‡‡ç”¨å¼ºåˆ¶æ•™å­¦ã€‚ ï¼ˆè¿™ä¹Ÿæ˜¯ Seq2Seq 2 çš„å†…å®¹ï¼‰ 2. Seq2Seq æ¡†æ¶2ç¬¬äºŒä¸ªè¦è®²çš„Seq-to-Seqæ¨¡å‹æ¥è‡ªäº â€œSequence to Sequence Learning with Neural Networksâ€ï¼Œå…¶æ¨¡å‹ç»“æ„å›¾å¦‚ä¸‹æ‰€ç¤ºï¼š ä¸ä¸Šé¢æ¨¡å‹æœ€å¤§çš„åŒºåˆ«åœ¨äºå…¶sourceç¼–ç åçš„ å‘é‡$C$ ç›´æ¥ä½œä¸ºDecoderé˜¶æ®µRNNçš„åˆå§‹åŒ–stateï¼Œè€Œä¸æ˜¯åœ¨æ¯æ¬¡decodeæ—¶éƒ½ä½œä¸ºRNN cellçš„è¾“å…¥ã€‚æ­¤å¤–ï¼Œdecodeæ—¶RNNçš„è¾“å…¥æ˜¯ç›®æ ‡å€¼ï¼Œè€Œä¸æ˜¯å‰ä¸€æ—¶åˆ»çš„è¾“å‡ºã€‚é¦–å…ˆçœ‹ä¸€ä¸‹ç¼–ç é˜¶æ®µï¼š å°±æ˜¯ç®€å•çš„RNNæ¨¡å‹ï¼Œæ¯ä¸ªè¯ç»è¿‡RNNä¹‹åéƒ½ä¼šç¼–ç ä¸ºhidden stateï¼ˆe0,e1,e2ï¼‰ï¼Œå¹¶ä¸”sourceåºåˆ—çš„ç¼–ç å‘é‡eå°±æ˜¯æœ€ç»ˆçš„hidden state e2ã€‚æ¥ä¸‹æ¥å†çœ‹ä¸€ä¸‹è§£ç é˜¶æ®µï¼š eå‘é‡ä»…ä½œä¸ºRNNçš„åˆå§‹åŒ–çŠ¶æ€ä¼ å…¥decodeæ¨¡å‹ã€‚æ¥ä¸‹æ¥å°±æ˜¯æ ‡å‡†çš„å¾ªç¯ç¥ç»ç½‘ç»œï¼Œæ¯ä¸€æ—¶åˆ»è¾“å…¥éƒ½æ˜¯å‰ä¸€æ—¶åˆ»çš„æ­£ç¡®labelã€‚ç›´åˆ°æœ€ç»ˆè¾“å…¥ç¬¦å·æˆªæ­¢æ»šåŠ¨ã€‚ 3. Seq2Seq Attentiondecode åœ¨å„ä¸ªæ—¶é—´æ­¥ä¾èµ–ç›¸åŒçš„ èƒŒæ™¯å˜é‡ $c$ æ¥è·å–è¾“å…¥åºåˆ—ä¿¡æ¯ã€‚å½“ encode ä¸º RNN æ—¶ï¼ŒèƒŒæ™¯å˜é‡$c$ æ¥è‡ªå®ƒæœ€ç»ˆæ—¶é—´æ­¥çš„éšè—çŠ¶æ€ã€‚ è‹±è¯­è¾“å…¥ï¼šâ€œTheyâ€ã€â€œareâ€ã€â€œwatchingâ€ã€â€œ.â€æ³•è¯­è¾“å‡ºï¼šâ€œIlsâ€ã€â€œregardentâ€ã€â€œ.â€ ç¿»è¯‘ä¾‹å­ï¼šè¾“å…¥ä¸ºè‹±è¯­åºåˆ—â€œTheyâ€ã€â€œareâ€ã€â€œwatchingâ€ã€â€œ.â€ï¼Œè¾“å‡ºä¸ºæ³•è¯­åºåˆ—â€œIlsâ€ã€â€œregardentâ€ã€â€œ.â€ã€‚ï¼Œdecode åœ¨ç”Ÿæˆè¾“å‡ºåºåˆ—ä¸­çš„æ¯ä¸€ä¸ªè¯æ—¶å¯èƒ½åªéœ€åˆ©ç”¨è¾“å…¥åºåˆ—æŸä¸€éƒ¨åˆ†çš„ä¿¡æ¯ã€‚ä¾‹å¦‚ï¼Œåœ¨è¾“å‡ºåºåˆ—çš„æ—¶é—´æ­¥ 1ï¼Œè§£ç å™¨å¯ä»¥ä¸»è¦ä¾èµ–â€œTheyâ€ã€â€œareâ€çš„ä¿¡æ¯æ¥ç”Ÿæˆâ€œIlsâ€ï¼Œåœ¨æ—¶é—´æ­¥ 2 åˆ™ä¸»è¦ä½¿ç”¨æ¥è‡ªâ€œwatchingâ€çš„ç¼–ç ä¿¡æ¯ç”Ÿæˆâ€œregardentâ€ï¼Œæœ€ååœ¨æ—¶é—´æ­¥ 3 åˆ™ç›´æ¥æ˜ å°„å¥å·â€œ.â€ã€‚è¿™çœ‹ä¸Šå»å°±åƒæ˜¯åœ¨ decode çš„æ¯ä¸€æ—¶é—´æ­¥å¯¹è¾“å…¥åºåˆ—ä¸­ä¸åŒæ—¶é—´æ­¥çš„ç¼–ç ä¿¡æ¯åˆ†é…ä¸åŒçš„æ³¨æ„åŠ›ä¸€æ ·ã€‚è¿™ä¹Ÿæ˜¯æ³¨æ„åŠ›æœºåˆ¶çš„ç”±æ¥ 1ã€‚ ä»ä»¥ RNN ä¸ºä¾‹ï¼ŒAttention é€šè¿‡å¯¹ Encode æ‰€æœ‰æ—¶é—´æ­¥çš„éšè—çŠ¶æ€åšåŠ æƒå¹³å‡æ¥å¾—åˆ°èƒŒæ™¯å˜é‡$c$ã€‚Decode åœ¨æ¯ä¸€æ—¶é—´æ­¥è°ƒæ•´è¿™äº›æƒé‡ï¼Œå³ Attention weightï¼Œä»è€Œèƒ½å¤Ÿåœ¨ä¸åŒæ—¶é—´æ­¥åˆ†åˆ«å…³æ³¨è¾“å…¥åºåˆ—ä¸­çš„ä¸åŒéƒ¨åˆ†å¹¶ç¼–ç è¿›ç›¸åº”æ—¶é—´æ­¥çš„èƒŒæ™¯å˜é‡$c$ã€‚æœ¬èŠ‚æˆ‘ä»¬å°†è®¨è®º Attentionæœºåˆ¶ æ˜¯æ€ä¹ˆå·¥ä½œçš„ã€‚ åœ¨â€œç¼–ç å™¨â€”è§£ç å™¨ï¼ˆseq2seqï¼‰â€, è§£ç å™¨åœ¨æ—¶é—´æ­¥ $tâ€™$ çš„éšè—çŠ¶æ€ \\boldsymbol{s}_{t'} = g(\\boldsymbol{y}_{t'-1}, \\boldsymbol{c}, \\boldsymbol{s}_{t'-1})åœ¨ Attentionæœºåˆ¶ ä¸­, è§£ç å™¨çš„æ¯ä¸€æ—¶é—´æ­¥å°†ä½¿ç”¨å¯å˜çš„èƒŒæ™¯å˜é‡$c$ \\boldsymbol{s}_{t'} = g(\\boldsymbol{y}_{t'-1}, \\boldsymbol{c}_{t'}, \\boldsymbol{s}_{t'-1}).å…³é”®æ˜¯å¦‚ä½•è®¡ç®—èƒŒæ™¯å˜é‡ $\\boldsymbol{c}{tâ€™}$ å’Œå¦‚ä½•åˆ©ç”¨å®ƒæ¥æ›´æ–°éšè—çŠ¶æ€ $\\boldsymbol{s}{tâ€™}$ã€‚ä»¥ä¸‹å°†åˆ†åˆ«æè¿°è¿™ä¸¤ä¸ªå…³é”®ç‚¹ã€‚ 3.1 è®¡ç®—èƒŒæ™¯å˜é‡ c \\boldsymbol{c}_{t'} = \\sum_{t=1}^T \\alpha_{t' t} \\boldsymbol{h}_t,å…¶ä¸­ç»™å®š $tâ€™$ æ—¶ï¼Œæƒé‡ $\\alpha_{tâ€™ t}$ åœ¨ $t=1,\\ldots,T$ çš„å€¼æ˜¯ä¸€ä¸ªæ¦‚ç‡åˆ†å¸ƒã€‚ä¸ºäº†å¾—åˆ°æ¦‚ç‡åˆ†å¸ƒï¼Œå¯ä»¥ä½¿ç”¨ softmax è¿ç®—: \\alpha_{t' t} = \\frac{\\exp(e_{t' t})}{ \\sum_{k=1}^T \\exp(e_{t' k}) },\\quad t=1,\\ldots,T.ç°åœ¨ï¼Œæˆ‘ä»¬éœ€è¦å®šä¹‰å¦‚ä½•è®¡ç®—ä¸Šå¼ä¸­ softmax è¿ç®—çš„è¾“å…¥ $e{tâ€™ t}$ã€‚ç”±äº $e{tâ€™ t}$ åŒæ—¶å–å†³äºdecodeçš„æ—¶é—´æ­¥ $tâ€™$ å’Œencodeçš„æ—¶é—´æ­¥ $t$ï¼Œæˆ‘ä»¬ä¸å¦¨ä»¥è§£ç å™¨åœ¨æ—¶é—´æ­¥ $tâ€™âˆ’1$ çš„éšè—çŠ¶æ€ $\\boldsymbol{s}{tâ€™ - 1}$ ä¸ç¼–ç å™¨åœ¨æ—¶é—´æ­¥ $t$ çš„éšè—çŠ¶æ€ $h_t$ ä¸ºè¾“å…¥ï¼Œå¹¶é€šè¿‡å‡½æ•° $a$ è®¡ç®— $e{tâ€™ t}$ï¼š e_{t' t} = a(\\boldsymbol{s}_{t' - 1}, \\boldsymbol{h}_t).è¿™é‡Œå‡½æ•° a æœ‰å¤šç§é€‰æ‹©ï¼Œå¦‚æœä¸¤ä¸ªè¾“å…¥å‘é‡é•¿åº¦ç›¸åŒï¼Œä¸€ä¸ªç®€å•çš„é€‰æ‹©æ˜¯è®¡ç®—å®ƒä»¬çš„å†…ç§¯ $a(\\boldsymbol{s}, \\boldsymbol{h})=\\boldsymbol{s}^\\top \\boldsymbol{h}$ã€‚è€Œæœ€æ—©æå‡ºAttentionæœºåˆ¶çš„è®ºæ–‡åˆ™å°†è¾“å…¥è¿ç»“åé€šè¿‡å«å•éšè—å±‚çš„å¤šå±‚æ„ŸçŸ¥æœºMLP å˜æ¢ a(\\boldsymbol{s}, \\boldsymbol{h}) = \\boldsymbol{v}^\\top \\tanh(\\boldsymbol{W}_s \\boldsymbol{s} + \\boldsymbol{W}_h \\boldsymbol{h}),å…¶ä¸­ $vã€W_sã€W_h$ éƒ½æ˜¯å¯ä»¥å­¦ä¹ çš„æ¨¡å‹å‚æ•°ã€‚ 3.2 æ›´æ–°éšè—çŠ¶æ€ä»¥é—¨æ§å¾ªç¯å•å…ƒä¸ºä¾‹ï¼Œåœ¨è§£ç å™¨ä¸­æˆ‘ä»¬å¯ä»¥å¯¹é—¨æ§å¾ªç¯å•å…ƒçš„è®¾è®¡ç¨ä½œä¿®æ”¹ã€‚è§£ç å™¨åœ¨æ—¶é—´æ­¥ $tâ€™$ çš„éšè—çŠ¶æ€ä¸º \\boldsymbol{s}_{t'} = \\boldsymbol{z}_{t'} \\odot \\boldsymbol{s}_{t'-1} + (1 - \\boldsymbol{z}_{t'}) \\odot \\tilde{\\boldsymbol{s}}_{t'},å…¶ä¸­çš„é‡ç½®é—¨ã€æ›´æ–°é—¨å’Œå€™é€‰éšå«çŠ¶æ€åˆ†åˆ«ä¸º : \\begin{split}\\begin{aligned} \\boldsymbol{r}_{t'} &= \\sigma(\\boldsymbol{W}_{yr} \\boldsymbol{y}_{t'-1} + \\boldsymbol{W}_{sr} \\boldsymbol{s}_{t' - 1} + \\boldsymbol{W}_{cr} \\boldsymbol{c}_{t'} + \\boldsymbol{b}_r),\\\\\\\\ \\boldsymbol{z}_{t'} &= \\sigma(\\boldsymbol{W}_{yz} \\boldsymbol{y}_{t'-1} + \\boldsymbol{W}_{sz} \\boldsymbol{s}_{t' - 1} + \\boldsymbol{W}_{cz} \\boldsymbol{c}_{t'} + \\boldsymbol{b}_z),\\\\\\\\ \\tilde{\\boldsymbol{s}}_{t'} &= \\text{tanh}(\\boldsymbol{W}_{ys} \\boldsymbol{y}_{t'-1} + \\boldsymbol{W}_{ss} (\\boldsymbol{s}_{t' - 1} \\odot \\boldsymbol{r}_{t'}) + \\boldsymbol{W}_{cs} \\boldsymbol{c}_{t'} + \\boldsymbol{b}_s), \\end{aligned}\\end{split}å…¶ä¸­å«ä¸‹æ ‡çš„ W å’Œ b åˆ†åˆ«ä¸ºé—¨æ§å¾ªç¯å•å…ƒçš„æƒé‡å‚æ•°å’Œåå·®å‚æ•°ã€‚ 3.3 å°ç»“ å¯ä»¥åœ¨decodeçš„æ¯ä¸ªæ—¶é—´æ­¥ä½¿ç”¨ä¸åŒçš„èƒŒæ™¯å˜é‡ï¼Œå¹¶å¯¹è¾“å…¥åºåˆ—ä¸­ä¸åŒæ—¶é—´æ­¥ç¼–ç çš„ä¿¡æ¯åˆ†é…ä¸åŒçš„æ³¨æ„åŠ›ã€‚ Attentionæœºåˆ¶å¯ä»¥é‡‡ç”¨æ›´ä¸ºé«˜æ•ˆçš„çŸ¢é‡åŒ–è®¡ç®—ã€‚ 4. Seq2Seq Attentionå„ç§å˜å½¢ç¬¬å››ä¸ªSeq-to-Seqæ¨¡å‹ï¼Œæ¥è‡ªäºè®ºæ–‡ Effective Approaches to Attention-based Neural Machine Translation è¿™ç¯‡è®ºæ–‡æå‡ºäº†ä¸¤ç§ Seq2Seqæ¨¡å‹ åˆ†åˆ«æ˜¯global Attention å’Œ local Attentionã€‚ 5. Seq2Seq with Beam-Searchä¸Šé¢è®²çš„å‡ ç§Seq2Seqæ¨¡å‹éƒ½æ˜¯ä»æ¨¡å‹ç»“æ„ä¸Šè¿›è¡Œçš„æ”¹è¿›ï¼Œä¹Ÿå°±è¯´ä¸ºäº†ä»è®­ç»ƒçš„å±‚é¢ä¸Šæ”¹å–„æ¨¡å‹çš„æ•ˆæœï¼Œä½†è¿™é‡Œè¦ä»‹ç»çš„beam-searchæ˜¯åœ¨æµ‹è¯•çš„æ—¶å€™æ‰ç”¨åˆ°çš„æŠ€æœ¯ã€‚ Reference åŠ¨æ‰‹å­¦æ·±åº¦å­¦ä¹ ç¬¬åå…«è¯¾ï¼šseq2seqï¼ˆç¼–ç å™¨å’Œè§£ç å™¨ï¼‰å’Œæ³¨æ„åŠ›æœºåˆ¶ é—¨æ§å¾ªç¯å•å…ƒï¼ˆGRUï¼‰ seq2seq+Attentionæœºåˆ¶æ¨¡å‹è¯¦è§£ ä¸‰åˆ†é’Ÿå¸¦ä½ å¯¹ Softmax åˆ’é‡ç‚¹ Softmax å›å½’","categories":[{"name":"nlp","slug":"nlp","permalink":"http://iequa.com/categories/nlp/"}],"tags":[{"name":"seq2seq+Attention","slug":"seq2seq-Attention","permalink":"http://iequa.com/tags/seq2seq-Attention/"}]},{"title":"æ¬ç“¦å·¥VPS é…ç½® SSH ä¸ OpenVpn","slug":"devops/ops-bandwagonhost-ssh-openvpn","date":"2017-11-12T05:16:21.000Z","updated":"2019-10-20T04:30:34.989Z","comments":true,"path":"2017/11/12/devops/ops-bandwagonhost-ssh-openvpn/","link":"","permalink":"http://iequa.com/2017/11/12/devops/ops-bandwagonhost-ssh-openvpn/","excerpt":"æ¬ç“¦å·¥VPS é…ç½® ssh ç™»å½• ä¸ iphone é…ç½®ä½¿ç”¨ openvpn","text":"æ¬ç“¦å·¥VPS é…ç½® ssh ç™»å½• ä¸ iphone é…ç½®ä½¿ç”¨ openvpn SSH é…ç½® ssh ç™»å½•æ¬ç“¦å·¥æœºå™¨ stop server @Main controls Root password modification start Server Root shell - interactive vi /etc/ssh/sshd_config, add PermitRootLogin yesPort 22 /etc/init.d/sshd restart ssh root@ip OpenVpn é…ç½® åœ¨iOSè®¾å¤‡ä¸Šæ‰“å¼€app storeï¼Œæœç´¢openvpnï¼Œinstall æ‰“å¼€ bandwagon my service pandelMy Service Pandel -&gt; KiwiVM Control Pandel -&gt; OpenVPN Server -&gt; install OpenVPN -&gt; Download Key Files æŠŠ ca.crtã€client1.crtã€client1.key è¯ä¹¦æ”¾å…¥ .ovpn é…ç½®æ–‡ä»¶ åœ¨ .ovpn æ–‡ä»¶å°¾éƒ¨ä¸­æ–°å¢ æ ‡ç­¾ &lt;ca&gt;ã€&lt;cert&gt;ã€&lt;key&gt; æ ‡ç­¾ ca.crt æ–‡ä»¶å†…å®¹å¤åˆ¶åˆ° &lt;ca&gt;å’Œ&lt;/ca&gt; çš„ä¸­é—´ï¼Œclient1.crt æ–‡ä»¶å†…å®¹å¤åˆ¶åˆ° &lt;cert&gt;å’Œ&lt;/cert&gt; çš„ä¸­é—´ï¼Œclient1.key æ–‡ä»¶å†…å®¹å¤åˆ¶åˆ° &lt;key&gt;å’Œ&lt;/key&gt; çš„ä¸­é—´ï¼Œä¿®æ”¹å®Œæˆååˆ é™¤ .ovpn é…ç½®æ–‡ä»¶ä¸­ç±»ä¼¼ca ca.crtcert client1.crtkey client1.key .ovpn é€šè¿‡ Airdrop ä¼ åˆ° iphone æ‰‹æœºé‡Œ æ‰“å¼€OpenVPNï¼Œç‚¹é‚£äº›ç»¿è‰²åŠ å·ï¼Œå°†é…ç½®æ–‡ä»¶å¯¼å…¥ å‘å³æ»‘åŠ¨æœ€ä¸‹é¢é‚£ä¸ªç™½è‰²æ»‘å—è‡³è“è‰²ï¼Œè¿æ¥æœåŠ¡å™¨ã€‚ è¿æ¥æˆåŠŸã€‚å¦‚æœæ˜¾ç¤º Connectedï¼Œè¡¨ç¤ºè¿æ¥æˆåŠŸäº†ã€‚ Reference www.yuntionly.com www.wisevpn.net www.banwago.com www.godaddy.com æ¬ç“¦å·¥ä¸­æ–‡ç½‘ æ¬ç“¦å·¥è´­ä¹°é¡µé¢ æ¬ç“¦å·¥VPSç»­è´¹çš„é‚£äº›äº‹ OpenVPNæ”¯æŒiOSå•¦ ç»¿è‰²ä¾¿æºæ±‰åŒ–å¯ä¿å­˜å¯†ç çš„OpenVPNå®¢æˆ·ç«¯","categories":[{"name":"devops","slug":"devops","permalink":"http://iequa.com/categories/devops/"}],"tags":[{"name":"banwagon","slug":"banwagon","permalink":"http://iequa.com/tags/banwagon/"}]},{"title":"æ–‡å­—å’Œè¯­è¨€ vs æ•°å­—å’Œä¿¡æ¯","slug":"nlp/word-language-number-info-history","date":"2017-11-08T02:08:21.000Z","updated":"2019-10-20T04:30:35.066Z","comments":true,"path":"2017/11/08/nlp/word-language-number-info-history/","link":"","permalink":"http://iequa.com/2017/11/08/nlp/word-language-number-info-history/","excerpt":"æ•°å­—ã€æ–‡å­—ã€è‡ªç„¶è¯­è¨€ ä¸€æ ·ï¼Œéƒ½æ˜¯ä¿¡æ¯çš„è½½ä½“ã€‚","text":"æ•°å­—ã€æ–‡å­—ã€è‡ªç„¶è¯­è¨€ ä¸€æ ·ï¼Œéƒ½æ˜¯ä¿¡æ¯çš„è½½ä½“ã€‚è¯­è¨€å’Œæ•°å­—çš„äº§ç”Ÿä¸ºçš„æ˜¯åŒä¸€ä¸ªç›®çš„ ï¼šè®°å½•å’Œä¼ æ’­ä¿¡æ¯ã€‚ 1948å¹´ï¼Œé¦™å†œæå‡ºä¿¡æ¯è®ºï¼Œäººä»¬æ‰æŠŠ æ•°å­¦å’Œè¯­è¨€ è”ç³»èµ·æ¥ã€‚ 1. ä¿¡æ¯ äººç±»æœ€æ—©åˆ©ç”¨ voice è¿›è¡Œ é€šä¿¡ äººç±»æ–‡æ˜çš„è¿›æ­¥ï¼Œéœ€è¦è¡¨è¾¾çš„ä¿¡æ¯é‡è¶Šæ¥è¶Šå¤šï¼Œäººç±»å‘æ˜çš„è‡ªç„¶è¯­è¨€ è¯­è¨€çš„å‡ºç°æ˜¯ä¸ºäº†äººç±»ä¹‹é—´çš„é€šä¿¡ã€‚å­—æ¯ã€æ–‡å­—ã€æ•°å­— æ˜¯ä¿¡æ¯ç¼–ç çš„ä¸åŒå•ä½ã€‚ä»»ä½•ä¸€ç§è¯­è¨€éƒ½æ˜¯ä¸€ç§ç¼–ç æ–¹å¼ï¼Œè¯­è¨€çš„è¯­æ³•è§„åˆ™æ˜¯ç¼–è§£ç çš„ç®—æ³•ã€‚ 2. æ–‡å­—å’Œæ•°å­—å½“è¯­è¨€å’Œè¯æ±‡å¤šåˆ°ä¸€å®šç¨‹åº¦ï¼Œäººç±»å¤§è„‘è®°ä¸ä½æ‰€æœ‰è¯æ±‡ï¼Œé«˜æ•ˆè®°å½•ä¿¡æ¯çš„å½¢å¼å‡ºç°ï¼Œäººç±»ä¾¿å‘æ˜äº† æ–‡å­— æ–‡å­—å¤åŸƒåŠï¼Œè¯»éŸ³ç›¸åŒçš„è¯ç”¨åŒä¸€ä¸ªç¬¦å·æ¥è®°å½•ã€‚ æ–‡å­—æŒ‰ç…§èšç±»ä¼šå¸¦æ¥æ­§ä¹‰æ€§ï¼Œå¼„ä¸æ¸…å¤šä¹‰å­—åœ¨ç‰¹å®šç¯å¢ƒçš„å«ä¹‰ï¼Œå°±è¦ä¾é ä¸Šä¸‹æ–‡ã€‚ ä¸åŒçš„æ–‡æ˜ï¼Œç”±äºåœ°åŸŸåŸå› ï¼Œå†å²ä¸Šäº’ç›¸éš”ç»ï¼Œä¾¿ä¼šæœ‰ä¸åŒçš„æ–‡å­—ã€‚æ–‡æ˜çš„èåˆä¸å†²çªï¼Œä¸åŒæ–‡æ˜ä¸‹çš„äººä»¬è¿›è¡Œäº¤æµ(é€šä¿¡)ï¼Œé‚£ä¹ˆç¿»è¯‘çš„éœ€æ±‚ä¾¿äº§ç”Ÿäº†ã€‚ä¸åŒçš„æ–‡å­—ç³»ç»Ÿåœ¨è®°å½•ä¿¡æ¯ä¸Šçš„èƒ½åŠ›æ˜¯ç­‰ä»·çš„ã€‚ ç½—å¡å¡” Rosetta Stone çŸ³ç¢‘ [å¤åŸƒåŠè±¡å½¢æ–‡å­—ã€åŸƒåŠæ‹¼éŸ³æ–‡å­—ã€å¤å¸Œè…Šæ–‡] çš„ç ´è¯‘å¯¹äº NLP å­¦è€…çš„ä¸¤ç‚¹æŒ‡å¯¼æ„ä¹‰ : ä¿¡æ¯çš„å†—ä½™æ˜¯ä¿¡æ¯å®‰å…¨çš„ä¿éšœ è¯­è¨€çš„æ•°æ®ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸º è¯­æ–™ Rosetta Stone, Googleæ¨å‡ºçš„ç¿»è¯‘è½¯ä»¶ æ•°å­—ç¥–å…ˆéœ€è¦è®°å½•ç‰©ä»¶çš„ä¸ªæ•°è¶Šæ¥è¶Šå¤šï¼Œæ‰€ä»¥å¼€å§‹å‘æ˜äº†è®¡æ•°ç³»ç»Ÿï¼Œä¹Ÿå°±æœ‰äº† æ•°å­—ã€‚å› ä¸º 10 ä¸ªæ‰‹æŒ‡å¤´ï¼Œæ‰€ä»¥å‘æ˜äº† 10 è¿›åˆ¶ã€‚ æè¿°æ•°å­—æœ€æœ‰æ•ˆçš„æ˜¯ å¤å°åº¦äººï¼Œä»–ä»¬å‘æ˜äº† 10ä¸ª é˜¿æ‹‰ä¼¯æ•°å­—ã€‚æ•°å­—çš„é©å‘½æ€§åœ¨äºå®ƒçš„ç®€å•æœ‰æ•ˆï¼Œè€Œä¸” æ ‡å¿—ç€æ•°å­—å’Œæ–‡å­—çš„åˆ†ç¦»ã€‚è¿™åœ¨å®¢è§‚ä¸Šè®© è‡ªç„¶è¯­è¨€çš„ç ”ç©¶ å’Œ æ•°å­¦çš„ç ”ç©¶ åœ¨å‡ åƒå¹´é‡Œæ²¡æœ‰é‡åˆçš„è½¨è¿¹ã€‚ 3. æ–‡å­—å’Œè¯­è¨€èƒŒåçš„æ•°å­¦ä» è±¡å½¢æ–‡å­— åˆ° æ‹¼éŸ³æ–‡å­— æ˜¯ä¸€ä¸ªé£è·ƒï¼Œæè¿°ç‰©ä½“æ–¹å¼ä¸Šï¼Œä»å¤–è¡¨è¿›åŒ–åˆ°äº†æŠ½è±¡çš„æ¦‚å¿µï¼ŒåŒæ—¶ä¸è‡ªè§‰çš„é‡‡ç”¨äº†å¯¹ ä¿¡æ¯çš„ç¼–ç ã€‚åŒæ—¶ç¥–å…ˆå¯¹æ–‡å­—çš„ç¼–ç è¿˜éå¸¸åˆç†ï¼Œå¸¸ç”¨å­—çŸ­ï¼Œç”Ÿåƒ»å­—é•¿ã€‚è¿™å®Œå…¨ç¬¦åˆä¿¡æ¯è®ºä¸­çš„ æœ€çŸ­ç¼–ç ç†è®ºã€‚ è¿™ç§æ–‡å­—è®¾è®¡(å…¶å®æ˜¯ä¸€ç§ç¼–ç æ–¹æ³•)å¸¦æ¥çš„å¥½å¤„æ˜¯å†™èµ·æ¥çœæ—¶é—´ã€çœææ–™ã€‚ å…¬å…ƒå‰26ä¸–çºª,çº¦4700å¹´å‰ï¼Œå‡ºç°äº†æ¥”å½¢æ–‡å­—(ä¸€ç§æ‹¼éŸ³æ–‡å­—) åœ¨å¤ä»£ï¼Œåœ¨é€ çº¸æœ¯å‘æ˜ä¹‹å‰ï¼Œäººä»¬è¯´è¯è¿˜æ˜¯ç±»ä¼¼ç™½è¯æ–‡ï¼Œæ–‡å­—ä¹¦å†™è¦åˆ»åœ¨ é¾Ÿå£³ã€çŸ³ç¢‘ã€ç«¹ç®€ ç­‰ä¸Šï¼Œå¾ˆè´¹æ—¶é—´å’Œææ–™ï¼Œæ‰€ä»¥æƒœå¢¨å¦‚é‡‘ï¼Œä½¿å¾—å¤æ–‡éå¸¸ç®€æ´ã€‚ ç±»æ¯”ä¿¡æ¯ç§‘å­¦ ï¼š é€šä¿¡æ—¶: å¦‚æœä¿¡é“è¾ƒå®½ï¼Œä¿¡æ¯ä¸å¿…å‹ç¼©ï¼Œå¯ç›´æ¥ä¼ é€’; é€šä¿¡æ—¶: å¦‚æœä¿¡é“è¾ƒçª„ï¼Œä¿¡æ¯åœ¨ä¼ é€’å‰éœ€è¦å°½å¯èƒ½å‹ç¼©ï¼Œç„¶ååœ¨æ¥æ”¶ç«¯è¿›è¡Œè§£å‹ç¼©ã€‚ è¯è¯­ ï¼š æ˜¯æœ‰é™å’Œå°é—­çš„é›†åˆ (å…¶å®å¯è®¾ç½®å®Œå¤‡çš„ç¼–ç è§„åˆ™)è¯­è¨€ ï¼š æ˜¯æ— é™å’Œå¼€æ”¾çš„é›†åˆ (ä¸å¯ä»¥è®¾ç½®å®Œå¤‡çš„ç¼–ç è§„åˆ™) ä»»ä½•è¯­è¨€çš„éƒ½æœ‰è¯­æ³•è§„åˆ™è¦†ç›–ä¸åˆ°çš„åœ°æ–¹ï¼Œè¿™äº›ä¸ç²¾ç¡®æ€§ï¼Œä¹Ÿé€ å°±äº†è¯­è¨€çš„ä¸°å¯Œå¤šå½©ã€‚ 4. å°ç»“äº†è§£ æ–‡å­—ã€æ•°å­—ã€è¯­è¨€ çš„å†å² é€šä¿¡çš„åŸç†å’Œä¿¡æ¯ä¼ æ’­çš„æ¨¡å‹ (ä¿¡æº) ç¼–ç  å’Œ æœ€çŸ­ç¼–ç  è§£ç çš„è§„åˆ™ : è¯­æ³• èšç±»çš„æ¦‚å¿µ åŒè¯­å¯¹ç…§æ–‡æœ¬ï¼Œè¯­æ–™åº“ å’Œ æœºå™¨ç¿»è¯‘ å¤šä¹‰æ€§å’Œåˆ©ç”¨ä¸Šä¸‹æ–‡æ¶ˆé™¤æ­§ä¹‰æ€§ Reference ã€Šæ•°å­¦ä¹‹ç¾ã€‹ è¯»ä¹¦ç¬”è®°","categories":[{"name":"nlp","slug":"nlp","permalink":"http://iequa.com/categories/nlp/"}],"tags":[{"name":"word2vec","slug":"word2vec","permalink":"http://iequa.com/tags/word2vec/"}]},{"title":"python ç»“æ„åŒ–æ‚¨çš„å·¥ç¨‹","slug":"python/language/py-language-structure-project","date":"2017-11-04T02:05:21.000Z","updated":"2019-10-20T04:30:35.006Z","comments":true,"path":"2017/11/04/python/language/py-language-structure-project/","link":"","permalink":"http://iequa.com/2017/11/04/python/language/py-language-structure-project/","excerpt":"å¦‚ä½•åˆ©ç”¨Pythonçš„ç‰¹æ€§æ¥åˆ›é€ ç®€æ´ã€é«˜æ•ˆçš„ä»£ç ã€‚ â€œç»“æ„åŒ–â€ æ„å‘³ç€é€šè¿‡ç¼–å†™ç®€æ´çš„ä»£ç ï¼Œä½¿é€»è¾‘å’Œä¾èµ–æ¸…æ™°.","text":"å¦‚ä½•åˆ©ç”¨Pythonçš„ç‰¹æ€§æ¥åˆ›é€ ç®€æ´ã€é«˜æ•ˆçš„ä»£ç ã€‚ â€œç»“æ„åŒ–â€ æ„å‘³ç€é€šè¿‡ç¼–å†™ç®€æ´çš„ä»£ç ï¼Œä½¿é€»è¾‘å’Œä¾èµ–æ¸…æ™°. ä»“åº“çš„ç»“æ„åœ¨ä¸€ä¸ªå¥åº·çš„å¼€å‘å‘¨æœŸä¸­ï¼Œä»£ç é£æ ¼ï¼ŒAPIè®¾è®¡å’Œè‡ªåŠ¨åŒ–æ˜¯éå¸¸å…³é”®çš„ã€‚åŒæ ·çš„ï¼Œå¯¹äºå·¥ç¨‹çš„ æ¶æ„ ,ä»“åº“çš„ç»“æ„ä¹Ÿæ˜¯å…³é”®çš„ä¸€éƒ¨åˆ†ã€‚ å½“ä¸€ä¸ªæ½œåœ¨çš„ç”¨æˆ·å’Œè´¡çŒ®è€…ç™»å½•åˆ°æ‚¨çš„ä»“åº“é¡µé¢æ—¶ï¼Œä»–ä»¬ä¼šçœ‹åˆ°è¿™äº›: å·¥ç¨‹çš„åå­— å·¥ç¨‹çš„æè¿° ä¸€ç³»åˆ—çš„æ–‡ä»¶ æ‹¥æœ‰è‰¯å¥½çš„å¸ƒå±€ï¼Œäº‹åŠåŠŸå€ã€‚ ä»“åº“æ ·ä¾‹README.rstLICENSEsetup.pyrequirements.txtsample/__init__.pysample/core.pysample/helpers.pydocs/conf.pydocs/index.rsttests/test_basic.pytests/test_advanced.py Licenseé™¤äº†æºä»£ç æœ¬èº«ä»¥å¤–ï¼Œè¿™ä¸ªæ¯«æ— ç–‘é—®æ˜¯æ‚¨ä»“åº“æœ€é‡è¦çš„ä¸€éƒ¨åˆ†ã€‚åœ¨è¿™ä¸ªæ–‡ä»¶ä¸­è¦æœ‰å®Œæ•´çš„è®¸å¯è¯´æ˜å’Œæˆæƒã€‚ å¦‚æœæ‚¨ä¸å¤ªæ¸…æ¥šæ‚¨åº”è¯¥ä½¿ç”¨å“ªç§è®¸å¯æ–¹å¼ï¼Œè¯·æŸ¥çœ‹ choosealicense.com. Setup.pyâ€¦ Reference ç»“æ„åŒ–ä½ çš„å·¥ç¨‹","categories":[{"name":"python","slug":"python","permalink":"http://iequa.com/categories/python/"}],"tags":[{"name":"python","slug":"python","permalink":"http://iequa.com/tags/python/"}]},{"title":"Taking care of your pet DOG!","slug":"English/engvid-Taking-care-of-your-pet","date":"2017-11-01T23:30:16.000Z","updated":"2019-10-20T04:30:35.033Z","comments":true,"path":"2017/11/02/English/engvid-Taking-care-of-your-pet/","link":"","permalink":"http://iequa.com/2017/11/02/English/engvid-Taking-care-of-your-pet/","excerpt":"Do you have a dog? Do you want a dog?","text":"Do you have a dog? Do you want a dog? Here in North America, we have specific rules, laws, and cultural customs that every dog owner must know. And if youâ€™re not a dog owner, you need to know this stuff, too, because youâ€™ll be around a lot of dogs here! In this video, Iâ€™ll teach you English vocabulary for the dog-related people youâ€™ll meet: breeders, vets, and groomers; as well as the doggie things you must have, such as a leash, dish, and treats. The best part? Dog owners love to talk about dogs. So you can practice your English by talking to other dog owners. Want more? Check out my friend Emmaâ€™s video about pets and animals here! &amp;t=171s Ruff. Hi. Iâ€™m Ronnie. Iâ€™m not a dog, but I have a dog, and I like dogs. Not: I like dog. I donâ€™t want to eat a dog. No, actually I would eat a dog if you gave it to me. If you barbequed it, Iâ€™d eat it. But, oh, weâ€™re not talking about eating dogs. Weâ€™re going to talk about how to actually not eat your dog, how to care for your dog. In English and in our society we call our dog our best friends, although it really has no choice. Even if your dog doesnâ€™t like you, it has to hang out with you a lot because you have to care for your dog. So, Iâ€™m going to teach you English vocabulary, English verbs for caring for your dog. Hopefully you can learn some stuff. You probably know it in your language, but now youâ€™re going to learn English with me because thatâ€™s what I do. So, the first thing that we should talk about is someone called a â€œbreederâ€. Okay? A breeder is a person who breeds dogs. So, Iâ€™ve written the word â€œbreedsâ€ here as a verb. Now, to breed a dog means that you get the boy dog whoâ€™s called a stud and you get the girl dog whoâ€™s called a bitch, and you make them have sex. I donâ€™t know how they do this, maybe they give them some doggy wine, play some nice doggy music, but anyways, the boy dog and the girl dog have dog sex, doggy style - and they have puppies. Woo-hoo. So the breeder is the person who cares for the dogs and makes more dogs. Theyâ€™re magical. It is a really, really bad idea, almost illegal in Canada to buy a dog from the â€œpet shopâ€. We have really tried to cut down on dogs who are for sale in pet shops. Just the treatment of the dogs, thereâ€™s been a lot of controversy. Also, you can find a dog on the internet, you can go to Kijiji or you can go to many websites where you can buy a dog. Thereâ€™s also dog rescue sites where maybe a dog doesnâ€™t have a house, a dog is homeless, and you can rescue the dog and make him yourâ€¦ Or her your best friend. So thereâ€™s many options. I do not recommend the pet shop option, but make sure that your dog is going to beâ€¦ Youâ€™re going to be able to take care of a dog before you get one. So, the place where the dogs or the puppies live and where they have all their doggy sex is called a â€œkennelâ€. So the kennel is the place, and the breeder is the person. You can use both of these words interchangeably, but a breeder is always a person. Itâ€™s important that you go and look at the kennel when youâ€™re buying a dog to make sure that itâ€™s clean and the dogs are well taken care of. Thereâ€™s some terrible-looking kennels I imagine. The next person that youâ€™re not going to want to go to and your dog is going to hate more than the mailman is the â€œveterinarianâ€. Now, in English we donâ€™t need to bother saying: â€œVeterinarianâ€, which is an animal doctor. What we need to say is: â€œVetâ€. So youâ€™re going to say: â€œUh-oh, I have to take my dog to the vetâ€, because maybe your dog is sick. Vets in Canada and probably around the world, America as well, are very, very expensive. So we donâ€™t want our dogs to be sick because it costs us a lot of money. But there is one thing that people or breeders really encourage you to do if you have gotten a puppy and youâ€™re not going to breed the dog, youâ€™re not going to haveâ€¦ Make more baby dogs with this. Thatâ€™s a whole other business. So, for this youâ€™re going to do what we call â€œget your dog fixedâ€. Your dog is not broken, donâ€™t worry, itâ€™s not a toy. So: â€œGet your dog fixedâ€, youâ€™re going to go to the vet, youâ€™re going to go to the animal doctor and whatâ€™s happenedâ€¦ Whatâ€™s going to happen is youâ€™re going to get your animal neutered. â€œNeuteredâ€ meansâ€¦ We have two different meaningâ€¦ Two different words we use for this. For the boys or for the studs, neutered means â€œcastratedâ€. Oh, gentlemen, gentlemen, this means theyâ€™re going to remove the dogâ€™s testicles so the dog cannot produce sperm to have little puppies. Donâ€™t worry, Iâ€™m sure the dog doesnâ€™t feel anything, and when he wakes up he is very happy because he has less balls to lick. So, â€œcastratedâ€ is only for boys and they remove the testicles. The word that we use for women, or sorry, girls or bitches, mm-hmm, is â€œspayedâ€.","categories":[{"name":"English","slug":"English","permalink":"http://iequa.com/categories/English/"}],"tags":[{"name":"engvid","slug":"engvid","permalink":"http://iequa.com/tags/engvid/"}]},{"title":"Linux Search Cmd","slug":"devops/linux-cmd-file-search","date":"2017-10-24T14:04:21.000Z","updated":"2019-10-20T04:30:34.992Z","comments":true,"path":"2017/10/24/devops/linux-cmd-file-search/","link":"","permalink":"http://iequa.com/2017/10/24/devops/linux-cmd-file-search/","excerpt":"whichï¼Œwhereisï¼Œlocateï¼Œfindï¼Œfind execï¼Œfind xargsï¼Œfindâ€¦","text":"whichï¼Œwhereisï¼Œlocateï¼Œfindï¼Œfind execï¼Œfind xargsï¼Œfindâ€¦ which æŸ¥çœ‹å¯æ‰§è¡Œæ–‡ä»¶çš„ä½ç½®ã€‚whereis æŸ¥çœ‹æ–‡ä»¶çš„ä½ç½®ã€‚locate é…åˆæ•°æ®åº“æŸ¥çœ‹æ–‡ä»¶ä½ç½®ã€‚find å®é™…æœå¯»ç¡¬ç›˜æŸ¥è¯¢æ–‡ä»¶åç§°ã€‚ 1. whichwhichå‘½ä»¤çš„ä½œç”¨æ˜¯ï¼Œåœ¨PATHå˜é‡æŒ‡å®šçš„è·¯å¾„ä¸­ï¼Œæœç´¢æŸä¸ªç³»ç»Ÿå‘½ä»¤çš„ä½ç½®ï¼Œå¹¶ä¸”è¿”å›ç¬¬ä¸€ä¸ªæœç´¢ç»“æœã€‚ [root@localhost ~]# which pwd/bin/pwd[root@localhost ~]# which adduser/usr/sbin/adduser[root@localhost ~]# cd æ˜¯bash å†…å»ºçš„å‘½ä»¤ï¼ âœ which cdcd: shell built-in command which é»˜è®¤æ˜¯æ‰¾ PATH å†…æ‰€è§„èŒƒçš„ç›®å½•ï¼Œæ‰€ä»¥å½“ç„¶ä¸€å®šæ‰¾ä¸åˆ°çš„ï¼ 2. whereiswhereiså‘½ä»¤åªèƒ½ç”¨äºç¨‹åºåçš„æœç´¢ï¼Œè€Œä¸”åªæœç´¢äºŒè¿›åˆ¶æ–‡ä»¶ï¼ˆå‚æ•°-bï¼‰ã€manè¯´æ˜æ–‡ä»¶ï¼ˆå‚æ•°-mï¼‰å’Œæºä»£ç æ–‡ä»¶ï¼ˆå‚æ•°-sï¼‰ã€‚å¦‚æœçœç•¥å‚æ•°ï¼Œåˆ™è¿”å›æ‰€æœ‰ä¿¡æ¯ã€‚ å’Œfindç›¸æ¯”ï¼ŒwhereisæŸ¥æ‰¾çš„é€Ÿåº¦éå¸¸å¿«ï¼Œè¿™æ˜¯å› ä¸ºlinuxç³»ç»Ÿä¼šå°† ç³»ç»Ÿå†…çš„æ‰€æœ‰æ–‡ä»¶éƒ½è®°å½•åœ¨ä¸€ä¸ªæ•°æ®åº“æ–‡ä»¶ä¸­ï¼Œå½“ä½¿ç”¨whereiså’Œä¸‹é¢å³å°†ä»‹ç»çš„locateæ—¶ï¼Œä¼šä»æ•°æ®åº“ä¸­æŸ¥æ‰¾æ•°æ®ï¼Œè€Œä¸æ˜¯åƒfindå‘½ä»¤é‚£æ ·ï¼Œé€š è¿‡éå†ç¡¬ç›˜æ¥æŸ¥æ‰¾ï¼Œæ•ˆç‡è‡ªç„¶ä¼šå¾ˆé«˜ã€‚ ä½†æ˜¯è¯¥æ•°æ®åº“æ–‡ä»¶å¹¶ä¸æ˜¯å®æ—¶æ›´æ–°ï¼Œé»˜è®¤æƒ…å†µä¸‹æ—¶ä¸€æ˜ŸæœŸæ›´æ–°ä¸€æ¬¡ï¼Œå› æ­¤ï¼Œæˆ‘ä»¬åœ¨ç”¨whereiså’Œlocate æŸ¥æ‰¾æ–‡ä»¶æ—¶ï¼Œæœ‰æ—¶ä¼šæ‰¾åˆ°å·²ç»è¢«åˆ é™¤çš„æ•°æ®ï¼Œæˆ–è€…åˆšåˆšå»ºç«‹æ–‡ä»¶ï¼Œå´æ— æ³•æŸ¥æ‰¾åˆ°ï¼ŒåŸå› å°±æ˜¯å› ä¸ºæ•°æ®åº“æ–‡ä»¶æ²¡æœ‰è¢«æ›´æ–°ã€‚ 3. locatelocateå‘½ä»¤å¯ä»¥åœ¨æœå¯»æ•°æ®åº“æ—¶å¿«é€Ÿæ‰¾åˆ°æ¡£æ¡ˆï¼Œæ•°æ®åº“ç”±updatedbç¨‹åºæ¥æ›´æ–°ï¼Œupdatedbæ˜¯ç”±cron daemonå‘¨æœŸæ€§å»ºç«‹çš„ï¼Œlocateå‘½ä»¤åœ¨æœå¯»æ•°æ®åº“æ—¶æ¯”ç”±æ•´ä¸ªç”±ç¡¬ç›˜èµ„æ–™æ¥æœå¯»èµ„æ–™æ¥å¾—å¿«ï¼Œä½†è¾ƒå·®åŠ²çš„æ˜¯locateæ‰€æ‰¾åˆ°çš„æ¡£æ¡ˆè‹¥æ˜¯æœ€è¿‘æ‰å»ºç«‹æˆ– åˆšæ›´åçš„ï¼Œå¯èƒ½ä¼šæ‰¾ä¸åˆ°ï¼Œåœ¨å†…å®šå€¼ä¸­ï¼Œupdatedbæ¯å¤©ä¼šè·‘ä¸€æ¬¡ï¼Œå¯ä»¥ç”±ä¿®æ”¹crontabæ¥æ›´æ–°è®¾å®šå€¼ã€‚(etc/crontab) locateæŒ‡å®šç”¨åœ¨æœå¯»ç¬¦åˆæ¡ä»¶çš„æ¡£æ¡ˆï¼Œå®ƒä¼šå»å‚¨å­˜æ¡£æ¡ˆä¸ç›®å½•åç§°çš„æ•°æ®åº“å†…ï¼Œå¯»æ‰¾åˆä¹èŒƒæœ¬æ ·å¼æ¡ä»¶çš„æ¡£æ¡ˆæˆ–ç›®å½•å½•ï¼Œå¯ä»¥ä½¿ç”¨ç‰¹æ®Šå­—å…ƒï¼ˆå¦‚â€â€ æˆ–â€?â€ç­‰ï¼‰æ¥æŒ‡å®šèŒƒæœ¬æ ·å¼ï¼Œå¦‚æŒ‡å®šèŒƒæœ¬ä¸ºkcpaner, locateä¼šæ‰¾å‡ºæ‰€æœ‰èµ·å§‹å­—ä¸²ä¸ºkcpaä¸”ç»“å°¾ä¸ºnerçš„æ¡£æ¡ˆæˆ–ç›®å½•ï¼Œå¦‚åç§°ä¸ºkcpartnerè‹¥ç›®å½•å½•åç§°ä¸ºkcpa_neråˆ™ä¼šåˆ—å‡ºè¯¥ç›®å½•ä¸‹åŒ…æ‹¬ å­ç›®å½•åœ¨å†…çš„æ‰€æœ‰æ¡£æ¡ˆã€‚ locateæŒ‡ä»¤å’Œfindæ‰¾å¯»æ¡£æ¡ˆçš„åŠŸèƒ½ç±»ä¼¼ï¼Œä½†locateæ˜¯é€è¿‡updateç¨‹åºå°†ç¡¬ç›˜ä¸­çš„æ‰€æœ‰æ¡£æ¡ˆå’Œç›®å½•èµ„æ–™å…ˆå»ºç«‹ä¸€ä¸ªç´¢å¼•æ•°æ®åº“ï¼Œåœ¨ æ‰§è¡Œloacteæ—¶ç›´æ¥æ‰¾è¯¥ç´¢å¼•ï¼ŒæŸ¥è¯¢é€Ÿåº¦ä¼šè¾ƒå¿«ï¼Œç´¢å¼•æ•°æ®åº“ä¸€èˆ¬æ˜¯ç”±æ“ä½œç³»ç»Ÿç®¡ç†ï¼Œä½†ä¹Ÿå¯ä»¥ç›´æ¥ä¸‹è¾¾updateå¼ºè¿«ç³»ç»Ÿç«‹å³ä¿®æ”¹ç´¢å¼•æ•°æ®åº“ã€‚ mac é»˜è®¤æ²¡å¯åŠ¨ locate 4. find4.1 æŸ¥æ‰¾æŒ‡å®šæ—¶é—´å†…ä¿®æ”¹è¿‡çš„æ–‡ä»¶[root@peidachang ~]# find -atime -2../logs/monitor./.bashrc./.bash_profile./.bash_history è¯´æ˜ï¼šè¶…æ‰¾48å°æ—¶å†…ä¿®æ”¹è¿‡çš„æ–‡ä»¶ 4.2 æ ¹æ®å…³é”®å­—æŸ¥æ‰¾find . -name &quot;*.log&quot; 4.3 æŸ¥æ‰¾å½“å‰æ‰€æœ‰ç›®å½•å¹¶æ’åºfind . -type d | sort 4.4 æŒ‰ç±»å‹æŸ¥æ‰¾find . -type f -name &quot;*.log&quot; 4.5 æŸ¥æ‰¾å½“å‰æ‰€æœ‰ç›®å½•å¹¶æ’åºfind . -type d | sort 4.6 æŒ‰å¤§å°æŸ¥æ‰¾æ–‡ä»¶find . -size +1000c -print 5. findå‘½ä»¤ä¹‹execfindæ˜¯æˆ‘ä»¬å¾ˆå¸¸ç”¨çš„ä¸€ä¸ªLinuxå‘½ä»¤ï¼Œä½†æ˜¯æˆ‘ä»¬ä¸€èˆ¬æŸ¥æ‰¾å‡ºæ¥çš„å¹¶ä¸ä»…ä»…æ˜¯çœ‹çœ‹è€Œå·²ï¼Œè¿˜ä¼šæœ‰è¿›ä¸€æ­¥çš„æ“ä½œï¼Œè¿™ä¸ªæ—¶å€™execçš„ä½œç”¨å°±æ˜¾ç°å‡ºæ¥äº†ã€‚ execè§£é‡Šï¼š -exec å‚æ•°åé¢è·Ÿçš„æ˜¯commandå‘½ä»¤ï¼Œå®ƒçš„ç»ˆæ­¢æ˜¯ä»¥;ä¸ºç»“æŸæ ‡å¿—çš„ï¼Œæ‰€ä»¥è¿™å¥å‘½ä»¤åé¢çš„åˆ†å·æ˜¯ä¸å¯ç¼ºå°‘çš„ï¼Œè€ƒè™‘åˆ°å„ä¸ªç³»ç»Ÿä¸­åˆ†å·ä¼šæœ‰ä¸åŒçš„æ„ä¹‰ï¼Œæ‰€ä»¥å‰é¢åŠ åæ–œæ ã€‚ {} èŠ±æ‹¬å·ä»£è¡¨å‰é¢findæŸ¥æ‰¾å‡ºæ¥çš„æ–‡ä»¶åã€‚ ä½¿ç”¨findæ—¶ï¼Œåªè¦æŠŠæƒ³è¦çš„æ“ä½œå†™åœ¨ä¸€ä¸ªæ–‡ä»¶é‡Œï¼Œå°±å¯ä»¥ç”¨execæ¥é…åˆfindæŸ¥æ‰¾ï¼Œå¾ˆæ–¹ä¾¿çš„ã€‚åœ¨æœ‰äº›æ“ä½œç³»ç»Ÿä¸­åªå…è®¸-execé€‰é¡¹æ‰§è¡Œè¯¸å¦‚l sæˆ–ls -lè¿™æ ·çš„å‘½ä»¤ã€‚å¤§å¤šæ•°ç”¨æˆ·ä½¿ç”¨è¿™ä¸€é€‰é¡¹æ˜¯ä¸ºäº†æŸ¥æ‰¾æ—§æ–‡ä»¶å¹¶åˆ é™¤å®ƒä»¬ã€‚å»ºè®®åœ¨çœŸæ­£æ‰§è¡Œrmå‘½ä»¤åˆ é™¤æ–‡ä»¶ä¹‹å‰ï¼Œæœ€å¥½å…ˆç”¨lså‘½ä»¤çœ‹ä¸€ä¸‹ï¼Œç¡®è®¤å®ƒä»¬æ˜¯æ‰€è¦åˆ é™¤çš„æ–‡ä»¶ã€‚ execé€‰é¡¹åé¢è·Ÿéšç€æ‰€è¦æ‰§è¡Œçš„å‘½ä»¤æˆ–è„šæœ¬ï¼Œç„¶åæ˜¯ä¸€å¯¹å„¿{ }ï¼Œä¸€ä¸ªç©ºæ ¼å’Œä¸€ä¸ª\\ï¼Œæœ€åæ˜¯ä¸€ä¸ªåˆ†å·ã€‚ä¸ºäº†ä½¿ç”¨execé€‰é¡¹ï¼Œå¿…é¡»è¦åŒæ—¶ä½¿ç”¨printé€‰é¡¹ã€‚å¦‚æœéªŒè¯ä¸€ä¸‹findå‘½ä»¤ï¼Œä¼šå‘ç°è¯¥å‘½ä»¤åªè¾“å‡ºä»å½“å‰è·¯å¾„èµ·çš„ç›¸å¯¹è·¯å¾„åŠæ–‡ä»¶åã€‚ 5.1 ls -lå‘½ä»¤æ”¾findå‘½ä»¤çš„-exec# ~/ghome/github/test [15:45:03]âœ lltotal 0-rw-r--r-- 1 blair staff 0B Oct 28 15:44 log1-rw-r--r-- 1 blair staff 0B Oct 28 15:45 log2-rw-r--r-- 1 blair staff 0B Oct 28 15:45 log3-rw-r--r-- 1 blair staff 0B Oct 28 15:45 log4(vpy2)# ~/ghome/github/test [15:45:03]âœ find . -type f -exec ls -l &#123;&#125; \\;-rw-r--r-- 1 blair staff 0 Oct 28 15:45 ./log4-rw-r--r-- 1 blair staff 0 Oct 28 15:45 ./log3-rw-r--r-- 1 blair staff 0 Oct 28 15:45 ./log2-rw-r--r-- 1 blair staff 0 Oct 28 15:44 ./log1(vpy2)# ~/ghome/github/test [15:45:04]âœ 5.2 æ›´æ”¹æ—¶é—´åœ¨næ—¥ä»¥å‰çš„æ–‡ä»¶å¹¶åˆ é™¤find . -type f -mtime +14 -exec rm &#123;&#125; \\; 5.3 æ›´æ”¹æ—¶é—´åœ¨næ—¥å‰æ–‡ä»¶å¹¶æç¤ºåˆ é™¤# ~/ghome/github/test [15:47:35]âœ lltotal 0-rw-r--r-- 1 blair staff 0B Oct 28 15:44 log1-rw-r--r-- 1 blair staff 0B Oct 28 15:45 log2-rw-r--r-- 1 blair staff 0B Oct 28 15:45 log3-rw-r--r-- 1 blair staff 0B Oct 28 15:45 log4(vpy2)# ~/ghome/github/test [15:47:38]âœ find . -name &quot;*log*&quot; -mtime -1 -ok rm &#123;&#125; \\;&quot;rm ./log4&quot;? åœ¨ç›®å½•ä¸­æŸ¥æ‰¾æ›´æ”¹æ—¶é—´åœ¨næ—¥ä»¥å‰çš„æ–‡ä»¶å¹¶åˆ é™¤å®ƒä»¬ï¼Œåœ¨åˆ é™¤ä¹‹å‰å…ˆç»™å‡ºæç¤º 5.4 -execä¸­ä½¿ç”¨grepå‘½ä»¤find /etc -name &quot;passwd*&quot; -exec grep &quot;root&quot; &#123;&#125; \\; 5.5 æŸ¥æ‰¾æ–‡ä»¶ç§»åŠ¨åˆ°æŒ‡å®šç›®å½•find . -name &quot;*.log&quot; -exec mv &#123;&#125; .. \\; 5.6 execé€‰é¡¹æ‰§è¡Œcpå‘½ä»¤find . -name &quot;*.log&quot; -exec cp &#123;&#125; test3 \\; 6. findå‘½ä»¤ä¹‹xargsåœ¨ä½¿ç”¨ findå‘½ä»¤çš„-execé€‰é¡¹å¤„ç†åŒ¹é…åˆ°çš„æ–‡ä»¶æ—¶ï¼Œ findå‘½ä»¤å°†æ‰€æœ‰åŒ¹é…åˆ°çš„æ–‡ä»¶ä¸€èµ·ä¼ é€’ç»™execæ‰§è¡Œã€‚ä½†æœ‰äº›ç³»ç»Ÿå¯¹èƒ½å¤Ÿä¼ é€’ç»™execçš„å‘½ä»¤é•¿åº¦æœ‰é™åˆ¶ï¼Œè¿™æ ·åœ¨findå‘½ä»¤è¿è¡Œå‡ åˆ†é’Ÿä¹‹åï¼Œå°±ä¼šå‡ºç°æº¢å‡ºé”™è¯¯ã€‚é”™è¯¯ä¿¡æ¯é€šå¸¸æ˜¯â€œå‚æ•°åˆ—å¤ªé•¿â€æˆ–â€œå‚æ•°åˆ—æº¢å‡ºâ€ã€‚è¿™å°±æ˜¯xargså‘½ä»¤çš„ç”¨å¤„æ‰€åœ¨ï¼Œç‰¹åˆ«æ˜¯ä¸findå‘½ä»¤ä¸€èµ·ä½¿ç”¨ã€‚ findå‘½ä»¤æŠŠåŒ¹é…åˆ°çš„æ–‡ä»¶ä¼ é€’ç»™xargså‘½ä»¤ï¼Œè€Œxargså‘½ä»¤æ¯æ¬¡åªè·å–ä¸€éƒ¨åˆ†æ–‡ä»¶è€Œä¸æ˜¯å…¨éƒ¨ï¼Œä¸åƒ-execé€‰é¡¹é‚£æ ·ã€‚è¿™æ ·å®ƒå¯ä»¥å…ˆå¤„ç†æœ€å…ˆè·å–çš„ä¸€éƒ¨åˆ†æ–‡ä»¶ï¼Œç„¶åæ˜¯ä¸‹ä¸€æ‰¹ï¼Œå¹¶å¦‚æ­¤ç»§ç»­ä¸‹å»ã€‚ åœ¨æœ‰äº›ç³»ç»Ÿä¸­ï¼Œä½¿ç”¨-execé€‰é¡¹ä¼šä¸ºå¤„ç†æ¯ä¸€ä¸ªåŒ¹é…åˆ°çš„æ–‡ä»¶è€Œå‘èµ·ä¸€ä¸ªç›¸åº”çš„è¿›ç¨‹ï¼Œå¹¶éå°†åŒ¹é…åˆ°çš„æ–‡ä»¶å…¨éƒ¨ä½œä¸ºå‚æ•°ä¸€æ¬¡æ‰§è¡Œï¼›è¿™æ ·åœ¨æœ‰äº›æƒ…å†µä¸‹å°±ä¼šå‡ºç°è¿›ç¨‹è¿‡å¤šï¼Œç³»ç»Ÿæ€§èƒ½ä¸‹é™çš„é—®é¢˜ï¼Œå› è€Œæ•ˆç‡ä¸é«˜ï¼› è€Œä½¿ç”¨xargså‘½ä»¤åˆ™åªæœ‰ä¸€ä¸ªè¿›ç¨‹ã€‚å¦å¤–ï¼Œåœ¨ä½¿ç”¨xargså‘½ä»¤æ—¶ï¼Œç©¶ç«Ÿæ˜¯ä¸€æ¬¡è·å–æ‰€æœ‰çš„å‚æ•°ï¼Œè¿˜æ˜¯åˆ†æ‰¹å–å¾—å‚æ•°ï¼Œä»¥åŠæ¯ä¸€æ¬¡è·å–å‚æ•°çš„æ•°ç›®éƒ½ä¼šæ ¹æ®è¯¥å‘½ä»¤çš„é€‰é¡¹åŠç³»ç»Ÿå†…æ ¸ä¸­ç›¸åº”çš„å¯è°ƒå‚æ•°æ¥ç¡®å®šã€‚ 6.1 find . -type f -print | xargs file# ~/ghome/github/test [7:41:40]âœ find . -type f -print | xargs file./log4: empty./log3: empty./log2: empty./log1: ASCII text(vpy2) 6.2 ç”¨æˆ·å…·æœ‰è¯»ã€å†™å’Œæ‰§è¡Œæƒé™çš„æ–‡ä»¶ï¼Œå¹¶æ”¶å›ç›¸åº”çš„å†™æƒé™find . -perm -7 -print | xargs chmod o-w # ~/ghome/github/test [7:44:26]âœ find . -perm -7 -print./log3(vpy2)# ~/ghome/github/test [7:44:27]âœ find . -perm -7 -print | xargs chmod o-w(vpy2)# ~/ghome/github/test [7:44:49]âœ lltotal 8-rw-r--r-- 1 blair staff 32B Oct 28 15:54 log1-rw-r--r-- 1 blair staff 0B Oct 28 15:45 log2-rwxrwxr-x 1 blair staff 0B Oct 28 15:45 log3-rw-r--r-- 1 blair staff 0B Oct 28 15:45 log4(vpy2)# ~/ghome/github/test [7:44:50] 6.3 grepå‘½ä»¤åœ¨æ‰€æœ‰çš„æ™®é€šæ–‡ä»¶ä¸­æœç´¢hostnameè¿™ä¸ªè¯find . -type f -print | xargs grep â€œhostnameâ€ [root@localhost test]# find . -type f -print | xargs grep &quot;hostname&quot;./log2013.log:hostnamebaidu=baidu.com./log2013.log:hostnamesina=sina.com./log2013.log:hostnames=true[root@localhost test]# 6.4 ä½¿ç”¨xargsæ‰§è¡Œmvfind . -name â€œ*.logâ€ | xargs -i mv {} test4 ä½¿ç”¨-iå‚æ•°é»˜è®¤çš„å‰é¢è¾“å‡ºç”¨{}ä»£æ›¿ï¼Œ-Iå‚æ•°å¯ä»¥æŒ‡å®šå…¶ä»–ä»£æ›¿å­—ç¬¦ 6.5 xargsçš„-på‚æ•°çš„ä½¿ç”¨find . -name â€œ*.logâ€ | xargs -p -i mv {} .. -på‚æ•°ä¼šæç¤ºè®©ä½ ç¡®è®¤æ˜¯å¦æ‰§è¡Œåé¢çš„å‘½ä»¤,yæ‰§è¡Œï¼Œnä¸æ‰§è¡Œã€‚ 7. find å‘½ä»¤çš„å‚æ•°è¯¦è§£Reference æ¯å¤©ä¸€ä¸ªlinuxå‘½ä»¤ç›®å½•","categories":[{"name":"devops","slug":"devops","permalink":"http://iequa.com/categories/devops/"}],"tags":[{"name":"linux","slug":"linux","permalink":"http://iequa.com/tags/linux/"}]},{"title":"Linux File Basic Cmd","slug":"devops/linux-cmd-1-file-directory-operation","date":"2017-10-23T14:04:21.000Z","updated":"2019-10-20T04:30:34.994Z","comments":true,"path":"2017/10/23/devops/linux-cmd-1-file-directory-operation/","link":"","permalink":"http://iequa.com/2017/10/23/devops/linux-cmd-1-file-directory-operation/","excerpt":"ls, cd, pwd, mkdir, rm, rmdir, mv, cp, touch, cat, nl, more, less, head, tail","text":"ls, cd, pwd, mkdir, rm, rmdir, mv, cp, touch, cat, nl, more, less, head, tail 1. lsls -l -R /home/blair/ghomels -ctrl s* åˆ—å‡º /opt/soft æ–‡ä»¶ä¸‹é¢çš„å­ç›®å½• ls -F /opt/soft |grep /$ ç›®å½•äºåç§°ååŠ â€/â€œ, å¯æ‰§è¡Œæ¡£äºåç§°ååŠ â€*â€ ls -AFl åˆ—å‡ºå½“å‰ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶ï¼ˆåŒ…æ‹¬éšè—æ–‡ä»¶ï¼‰çš„ç»å¯¹è·¯å¾„ï¼Œ å¯¹ç›®å½•ä¸åšé€’å½’ find $PWD -maxdepth 1 | xargs ls -ld é€’å½’åˆ—å‡ºå½“å‰ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶ï¼ˆåŒ…æ‹¬éšè—æ–‡ä»¶ï¼‰çš„ç»å¯¹è·¯å¾„ find $PWD | xargs ls -ld 2. cd cd - or cd or cd ~ 3. pwdpwd -P æ˜¾ç¤ºå‡ºå®é™…è·¯å¾„ï¼Œè€Œéä½¿ç”¨è¿æ¥ï¼ˆlinkï¼‰è·¯å¾„ # /usr/local/xsoft/software/scala [22:17:59]âœ pwd/usr/local/xsoft/software/scala(vpy3)# /usr/local/xsoft/software/scala [22:17:59]âœ pwd -P/usr/local/xsoft/deploy/scala-2.11.7(vpy3)# /usr/local/xsoft/software/scala [22:18:02]âœ 4. mkdirmkdir test1mkdir -p test2/test22mkdir -m 777 test3mkdir -v test4 ä¸€ä¸ªå‘½ä»¤åˆ›å»ºé¡¹ç›®çš„ç›®å½•ç»“æ„ # ~/ghome/seek/test2 [22:23:06]âœ mkdir -vp scf/&#123;lib/,bin/,doc/&#123;info,product&#125;,logs/&#123;info,product&#125;,service/deploy/&#123;info,product&#125;&#125;(vpy3) # ~/ghome/seek/test2 [22:23:08]âœ tree.â””â”€â”€ scf â”œâ”€â”€ bin â”œâ”€â”€ doc â”‚ â”œâ”€â”€ info â”‚ â””â”€â”€ product â”œâ”€â”€ lib â”œâ”€â”€ logs â”‚ â”œâ”€â”€ info â”‚ â””â”€â”€ product â””â”€â”€ service â””â”€â”€ deploy â”œâ”€â”€ info â””â”€â”€ product13 directories, 0 files(vpy3)# ~/ghome/seek/test2 [22:23:10] 5. rm-f, â€”force å¿½ç•¥ä¸å­˜åœ¨çš„æ–‡ä»¶ï¼Œä»ä¸ç»™å‡ºæç¤ºã€‚-i, â€”interactive è¿›è¡Œäº¤äº’å¼åˆ é™¤-r, -R, â€”recursive æŒ‡ç¤ºrmå°†å‚æ•°ä¸­åˆ—å‡ºçš„å…¨éƒ¨ç›®å½•å’Œå­ç›®å½•å‡é€’å½’åœ°åˆ é™¤ã€‚-v, â€”verbose è¯¦ç»†æ˜¾ç¤ºè¿›è¡Œçš„æ­¥éª¤ # ~/ghome/seek/test2 [22:29:28]âœ rm -i f1remove f1? è‡ªå®šä¹‰å›æ”¶ç«™åŠŸèƒ½ myrm()&#123; D=/tmp/$(date +%Y%m%d%H%M%S); mkdir -p $D; mv &quot;$@&quot; $D &amp;&amp; echo &quot;moved to $D ok&quot;; &#125; for example: [root@localhost test]# myrm()&#123; D=/tmp/$(date +%Y%m%d%H%M%S); mkdir -p $D; mv &quot;$@&quot; $D &amp;&amp; echo &quot;moved to $D ok&quot;; &#125;[root@localhost test]# alias rm=&#x27;myrm&#x27;[root@localhost test]# touch 1.log 2.log 3.log[root@localhost test]# llæ€»è®¡ 16-rw-r--r-- 1 root root 0 10-26 15:08 1.log-rw-r--r-- 1 root root 0 10-26 15:08 2.log-rw-r--r-- 1 root root 0 10-26 15:08 3.logdrwxr-xr-x 7 root root 4096 10-25 18:07 scfdrwxrwxrwx 2 root root 4096 10-25 17:46 test3drwxr-xr-x 2 root root 4096 10-25 17:56 test4drwxr-xr-x 3 root root 4096 10-25 17:56 test5[root@localhost test]# rm [123].logmoved to /tmp/20121026150901 ok[root@localhost test]# llæ€»è®¡ 16drwxr-xr-x 7 root root 4096 10-25 18:07 scfdrwxrwxrwx 2 root root 4096 10-25 17:46 test3drwxr-xr-x 2 root root 4096 10-25 17:56 test4drwxr-xr-x 3 root root 4096 10-25 17:56 test5[root@localhost test]# ls /tmp/20121026150901/1.log 2.log 3.log[root@localhost test]# Reference: æ¯å¤©ä¸€ä¸ªlinuxå‘½ä»¤ï¼ˆ5ï¼‰ï¼šrm å‘½ä»¤ 6. rmdir åˆ é™¤ç©ºç›®å½• rmdir -p å½“å­ç›®å½•è¢«åˆ é™¤åä½¿å®ƒä¹Ÿæˆä¸ºç©ºç›®å½•çš„è¯ï¼Œåˆ™é¡ºä¾¿ä¸€å¹¶åˆ é™¤ [root@localhost scf]# rmdir -p logsrmdir: logs: ç›®å½•éç©º[root@localhost scf]# tree.|-- bin|-- doc|-- lib|-- logs| `-- product`-- service `-- deploy |-- info `-- product 9 directories, 0 files [root@localhost scf]# rmdir -p logs/product [root@localhost scf]# tree.|-- bin|-- doc|-- lib`-- service`-- deploy |-- info `-- product 7. mv-i ï¼šè‹¥ç›®æ ‡æ–‡ä»¶ (destination) å·²ç»å­˜åœ¨æ—¶ï¼Œå°±ä¼šè¯¢é—®æ˜¯å¦è¦†ç›–ï¼-t ï¼š â€”target-directory=DIRECTORY move all SOURCE arguments into DIRECTORYï¼Œå³æŒ‡å®šmvçš„ç›®æ ‡ç›®å½•ï¼Œè¯¥é€‰é¡¹é€‚ç”¨äºç§»åŠ¨å¤šä¸ªæºæ–‡ä»¶åˆ°ä¸€ä¸ªç›®å½•çš„æƒ…å†µï¼Œæ­¤æ—¶ç›®æ ‡ç›®å½•åœ¨å‰ï¼Œæºæ–‡ä»¶åœ¨åã€‚ 8. cpcp -a test3 test4cp -s log.log log_link.log 9. touchè®¾å®šæ–‡ä»¶çš„æ—¶é—´æˆ³ touch -t 201211142234.50 log.log æ›´æ–° log2012.log çš„æ—¶é—´å’Œ log.log æ—¶é—´æˆ³ç›¸åŒ touch -r log.log log2012.log 10. cat ä¸€æ¬¡æ˜¾ç¤ºæ•´ä¸ªæ–‡ä»¶:cat filename ä»é”®ç›˜åˆ›å»ºä¸€ä¸ªæ–‡ä»¶:cat &gt; filename åªèƒ½åˆ›å»ºæ–°æ–‡ä»¶,ä¸èƒ½ç¼–è¾‘å·²æœ‰æ–‡ä»¶. å°†å‡ ä¸ªæ–‡ä»¶åˆå¹¶ä¸ºä¸€ä¸ªæ–‡ä»¶:cat file1 file2 &gt; file âœ cat -n log.log log2012.log 1 asd 2 3 asd 1 k1 2 k2 3 4 k3(vpy3)# ~/ghome/seek/test2 [23:02:19]âœ tac (åå‘åˆ—ç¤º).tac log.txt 11. nlnlå‘½ä»¤åœ¨linuxç³»ç»Ÿä¸­ç”¨æ¥è®¡ç®—æ–‡ä»¶ä¸­è¡Œå·ã€‚nl å¯ä»¥å°†è¾“å‡ºçš„æ–‡ä»¶å†…å®¹è‡ªåŠ¨çš„åŠ ä¸Šè¡Œå·ï¼ å‘½ä»¤å‚æ•°ï¼š -b ï¼šæŒ‡å®šè¡Œå·æŒ‡å®šçš„æ–¹å¼ï¼Œä¸»è¦æœ‰ä¸¤ç§ï¼š-b a ï¼šè¡¨ç¤ºä¸è®ºæ˜¯å¦ä¸ºç©ºè¡Œï¼Œä¹ŸåŒæ ·åˆ—å‡ºè¡Œå·(ç±»ä¼¼ cat -n)ï¼›-b t ï¼šå¦‚æœæœ‰ç©ºè¡Œï¼Œç©ºçš„é‚£ä¸€è¡Œä¸è¦åˆ—å‡ºè¡Œå·(é»˜è®¤å€¼)ï¼›-n ï¼šåˆ—å‡ºè¡Œå·è¡¨ç¤ºçš„æ–¹æ³•ï¼Œä¸»è¦æœ‰ä¸‰ç§ï¼š-n ln ï¼šè¡Œå·åœ¨è¤å¹•çš„æœ€å·¦æ–¹æ˜¾ç¤ºï¼›-n rn ï¼šè¡Œå·åœ¨è‡ªå·±æ ä½çš„æœ€å³æ–¹æ˜¾ç¤ºï¼Œä¸”ä¸åŠ  0 ï¼›-n rz ï¼šè¡Œå·åœ¨è‡ªå·±æ ä½çš„æœ€å³æ–¹æ˜¾ç¤ºï¼Œä¸”åŠ  0 ï¼›-w ï¼šè¡Œå·æ ä½çš„å ç”¨çš„ä½æ•°ã€‚-p åœ¨é€»è¾‘å®šç•Œç¬¦å¤„ä¸é‡æ–°å¼€å§‹è®¡ç®—ã€‚ [root@localhost test]# nl log2012.log 1 2012-01 2 2012-02 3 ======[root@localhost test]# [root@localhost test]# nl -b a log2012.log 1 2012-01 2 2012-02 3 4 5 ======[root@localhost test]# [root@localhost test]# nl -b a -n rz log2014.log 000001 2014-01000002 2014-02000003 2014-03000004 2014-04000005 2014-05000006 2014-06000007 2014-07000008 2014-08000009 2014-09000010 2014-10000011 2014-11000012 2014-12000013 =======[root@localhost test]# nl -b a -n rz -w 3 log2014.log 001 2014-01002 2014-02003 2014-03004 2014-04005 2014-05006 2014-06007 2014-07008 2014-08009 2014-09010 2014-10011 2014-11012 2014-12013 ======= è¯´æ˜ï¼š nl -b a -n rz å‘½ä»¤è¡Œå·é»˜è®¤ä¸ºå…­ä½ï¼Œè¦è°ƒæ•´ä½æ•°å¯ä»¥åŠ ä¸Šå‚æ•° -w 3 è°ƒæ•´ä¸º3ä½ã€‚ 12. moreå‘½ä»¤å‚æ•°ï¼š +n ä»ç¬«nè¡Œå¼€å§‹æ˜¾ç¤º-n å®šä¹‰å±å¹•å¤§å°ä¸ºnè¡Œ [root@localhost test]# cat log2012.log 2012-012012-022012-032012-04-day12012-04-day22012-04-day3======[root@localhost test]# more +3 log2012.log 2012-032012-04-day12012-04-day22012-04-day3======[root@localhost test]# è®¾å®šæ¯å±æ˜¾ç¤ºè¡Œæ•° more -5 log2012.log. [root@localhost test]# more -5 log2012.log 2012-012012-022012-032012-04-day12012-04-day2 åˆ—ä¸€ä¸ªç›®å½•ä¸‹çš„æ–‡ä»¶ï¼Œç”±äºå†…å®¹å¤ªå¤šï¼Œæˆ‘ä»¬åº”è¯¥å­¦ä¼šç”¨moreæ¥åˆ†é¡µæ˜¾ç¤ºã€‚è¿™å¾—å’Œç®¡é“ | ç»“åˆèµ·æ¥ ls -l | more -5 13. lessless å·¥å…·ä¹Ÿæ˜¯å¯¹æ–‡ä»¶æˆ–å…¶å®ƒè¾“å‡ºè¿›è¡Œåˆ†é¡µæ˜¾ç¤ºçš„å·¥å…·ï¼Œåº”è¯¥è¯´æ˜¯linuxæ­£ç»ŸæŸ¥çœ‹æ–‡ä»¶å†…å®¹çš„å·¥å…·ï¼ŒåŠŸèƒ½æå…¶å¼ºå¤§ã€‚ less çš„ç”¨æ³•æ¯”èµ· more æ›´åŠ çš„æœ‰å¼¹æ€§ã€‚åœ¨ more çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¹¶æ²¡æœ‰åŠæ³•å‘å‰é¢ç¿»ï¼Œ åªèƒ½å¾€åé¢çœ‹ï¼Œä½†è‹¥ä½¿ç”¨äº† less æ—¶ï¼Œå°±å¯ä»¥ä½¿ç”¨ [pageup] [pagedown] ç­‰æŒ‰é”®çš„åŠŸèƒ½æ¥å¾€å‰å¾€åç¿»çœ‹æ–‡ä»¶ï¼Œæ›´å®¹æ˜“ç”¨æ¥æŸ¥çœ‹ä¸€ä¸ªæ–‡ä»¶çš„å†…å®¹ï¼ åœ¨ less é‡Œå¤´å¯ä»¥æ‹¥æœ‰æ›´å¤šçš„æœç´¢åŠŸèƒ½ï¼Œä¸æ­¢å¯ä»¥å‘ä¸‹æœï¼Œä¹Ÿå¯ä»¥å‘ä¸Šæœã€‚ less log2013.logps -ef |lesshistory | less è¾“å‡ºæ–‡ä»¶é™¤äº†æœ€ånè¡Œçš„å…¨éƒ¨å†…å®¹ head -n -6 log2014.log 14. head[root@localhost test]# head -n 5 log2014.log 2014-012014-022014-032014-042014-05[root@localhost test]# æ˜¾ç¤ºæ–‡ä»¶å‰nä¸ªå­—èŠ‚ head -c 20 log2014.log [root@localhost test]# head -c 20 log2014.log2014-012014-022014[root@localhost test]# è¾“å‡ºæ–‡ä»¶é™¤äº†æœ€ånè¡Œçš„å…¨éƒ¨å†…å®¹ head -n -6 log2014.log 15. tailæ˜¾ç¤ºæ–‡ä»¶æœ«å°¾å†…å®¹. tail -n 5 log2014.log [root@localhost test]# tail -n 5 log2014.log 2014-092014-102014-112014-12==============================[root@localhost test]# å¾ªç¯æŸ¥çœ‹æ–‡ä»¶å†…å®¹ tail -f test.log Reference æ¯æ—¥ä¸€linuxå‘½ä»¤ æ¯å¤©ä¸€ä¸ªlinuxå‘½ä»¤ç›®å½•","categories":[{"name":"devops","slug":"devops","permalink":"http://iequa.com/categories/devops/"}],"tags":[{"name":"linux","slug":"linux","permalink":"http://iequa.com/tags/linux/"}]},{"title":"Tensorflow å¿«é€Ÿå­¦ä¹  & æ–‡æ¡£","slug":"tensorflow/tf-doc","date":"2017-10-23T13:00:21.000Z","updated":"2019-10-20T04:30:35.062Z","comments":true,"path":"2017/10/23/tensorflow/tf-doc/","link":"","permalink":"http://iequa.com/2017/10/23/tensorflow/tf-doc/","excerpt":"ä»‹ç» Tensorflow çš„å­¦ä¹ æµç¨‹ ä¸ W3C shchool Tensorflow çš„ä¸­æ–‡æ–‡æ¡£ã€‚","text":"ä»‹ç» Tensorflow çš„å­¦ä¹ æµç¨‹ ä¸ W3C shchool Tensorflow çš„ä¸­æ–‡æ–‡æ¡£ã€‚ 1. ç»“æ„ç›®å½•1.1 Tensorflow å…¥é—¨ä»‹ç»1.2 Tensorflow ä½¿ç”¨æŒ‡å—TensorFlow å¼ é‡å˜æ¢ TensorFlow Trainingå‡½æ•° ï¼š tf.train æä¾›äº†ä¸€ç»„å¸®åŠ©è®­ç»ƒæ¨¡å‹çš„ç±»å’Œå‡½æ•°ã€‚ 1.3 Tensorflow å‡½æ•°ä»‹ç»å‡½æ•°æ¨¡å— : tf TensorFlow appæ¨¡å— : å®šä¹‰é€šç”¨å…¥å£ç‚¹è„šæœ¬ TensorFlow contribæ¨¡å— TensorFlow çš„ errorsæ¨¡å— estimator æ¨¡å— ä¼°ç®—å™¨ï¼ˆEstimatorï¼‰ ï¼š ç”¨äºå¤„ç†æ¨¡å‹çš„é«˜çº§å·¥å…·ã€‚ TensorFlowçš„estimatorç±»å‡½æ•°ï¼štf.estimator.Estimator TensorFlow çš„ imageæ¨¡å— TensorFlow ä½¿ç”¨ä¹‹ tf.initializers TensorFlow ä½¿ç”¨ä¹‹ tf.keras TensorFlow ä½¿ç”¨ä¹‹ tf.layers TensorFlow ä½¿ç”¨ä¹‹ tf.losses TensorFlow ä½¿ç”¨ä¹‹ tf.metrics 1.4 TensorFlow åŠŸèƒ½å‡½æ•°tf.get_variable å‡½æ•° TensorFlowèŒƒæ•°ï¼štf.normå‡½æ•° TensorFlowå‡½æ•°ï¼štf.ones tf.one_hotå‡½æ•°ï¼šè¿”å›one-hotå¼ é‡ TensorFlowéšæœºå€¼ï¼štf.random_normalå‡½æ•° tf.random_normal_initializerï¼šTensorFlowåˆå§‹åŒ–å™¨ TensorFlowå‡½æ•°ï¼štf.ones_initializer TensorFlowå ä½ç¬¦ï¼štf.placeholder TensorFlowå‡½æ•°ï¼š tf.reduce_mean TensorFlowå‡½æ•°ï¼štf.reduce_sum axis = 0ï¼Œ ä¸ºçºµå‘axis = 1ï¼Œ ä¸ºæ¨ªå‘ 1.5 TensorFlow æ‰‹å†™æ•°å­—åˆ†ç±»é—®é¢˜Reference tensorflow.org TensorFlow å…¥é—¨åŸºç¡€ W3C school å¤§å­¦ä¹‹é“ï¼Œåœ¨æ˜æ˜å¾· - æˆ‘çš„Tensorflowå­¦ä¹ ä¹‹è·¯","categories":[{"name":"tensorflow","slug":"tensorflow","permalink":"http://iequa.com/categories/tensorflow/"}],"tags":[{"name":"tensorflow","slug":"tensorflow","permalink":"http://iequa.com/tags/tensorflow/"}]},{"title":"My Zsh Config Files","slug":"devops/oh-my-zsh-config","date":"2017-10-21T10:16:21.000Z","updated":"2020-07-06T16:12:44.732Z","comments":true,"path":"2017/10/21/devops/oh-my-zsh-config/","link":"","permalink":"http://iequa.com/2017/10/21/devops/oh-my-zsh-config/","excerpt":"æˆ‘çš„é…ç½®æ–‡ä»¶ ~/.zprofile å’Œ ~/.zshrc","text":"æˆ‘çš„é…ç½®æ–‡ä»¶ ~/.zprofile å’Œ ~/.zshrc zprofile###################################################### blair custom config @2020.07.07 ######################################################alias ipython=&#x27;python -m IPython&#x27;MS=/usr/local/xsoft### JAVA ###JAVA_HOME=$MS/jdk/Contents/HomeJAVA_BIN=$JAVA_HOME/binPATH=$JAVA_HOME/bin:$PATHCLASSPATH=.:$JAVA_HOME/jre/lib/rt.jar:$JAVA_HOME/jre/lib/dt.jar:$JAVA_HOME/jre/lib/tools.jarexport JAVA_HOME JAVA_BIN PATH CLASSPATHexport HADOOP_HOME=/usr/local/Cellar/hadoop/3.2.1_1export HADOOP_COMMON_HOME=$HADOOP_HOMEexport PATH=$PATH:$HADOOP_HOME/sbin:$HADOOP_HOME/binalias start-hp=&#x27;/usr/local/Cellar/hadoop/3.2.1_1/sbin/start-all.sh&#x27;alias stop-hp=&#x27;/usr/local/Cellar/hadoop/3.2.1_1/sbin/stop-all.sh&#x27;export SCALA_HOME=/usr/local/Cellar/scala/2.13.3export PATH=$PATH:$SCALA_HOME/binexport SPARK_HOME=$MS/sparkexport PATH=$PATH:$SPARK_HOME/binalias start-sk=&#x27;/usr/local/xsoft/spark/sbin/start-all.sh&#x27;alias stop-sk=&#x27;/usr/local/xsoft/spark/sbin/stop-all.sh&#x27;### Maven ###M2_HOME=/usr/local/xsoft/software/apache-mavenMAVEN_HOME=$M2_HOMEM3_HOME=$M2_HOMEPATH=$M3_HOME/bin:$PATH#MAVEN_OPTS=&quot;-Xms128m -Xmx512m&quot;export MAVEN_HOME M2_HOME PATH### Tomcat ###CATALINA_HOME=/usr/local/xsoft/software/apache-tomcatPATH=$CATALINA_HOME/bin:$PATHexport CATALINA_HOME PATH### Node.js ###export NVM_DIR=&quot;$HOME/.nvm&quot;#[ -s &quot;$NVM_DIR/nvm.sh&quot; ] &amp;&amp; \\. &quot;$NVM_DIR/nvm.sh&quot; # This loads nvm#[ -s &quot;$NVM_DIR/bash_completion&quot; ] &amp;&amp; \\. &quot;$NVM_DIR/bash_completion&quot; # This loads nvm bash_completion### LANG ###export LC_ALL=en_US.UTF-8export LANG=en_US.UTF-8### Fast Function #### show ipalias ip=&#x27;ipconfig getifaddr en0&#x27;alias ip0=&#x27;ipconfig getifaddr en0&#x27;alias ip1=&#x27;ipconfig getifaddr en1&#x27;# shutdownalias shuth=&#x27;sudo shutdown -h now&#x27;alias shutr=&#x27;sudo shutdown -r now&#x27;# grepalias fgstr=&#x27;find . | xargs grep -ri&#x27;#find .|xargs grep -ri &quot;IBM&quot; # pip listalias pipl=&#x27;pip list --format=columns&#x27;# lsof -i:portalias lsofi=&#x27;lsof -i:&#x27;# hexoalias hs=&#x27;cd ~/ghome/blog &amp;&amp; hexo clean &amp;&amp; hexo s -p 5000 &amp;&#x27;alias hsy=&#x27;cd ~/ghome/blogyih &amp;&amp; hexo clean &amp;&amp; hexo s -p 5001 &amp;&#x27;alias cpost=&#x27;cd ~/ghome/blog/source/_posts&#x27;# deploy blogalias db=&#x27;~/ghome/blog &amp;&amp; sh dp.sh&#x27;alias dby=&#x27;cd ~/ghome/blogyih &amp;&amp; sh dp.sh&#x27;alias gp=&#x27;cd ~/ghome/blog/source &amp;&amp; git pull &amp;&amp; cd ~/ghome/blog/52binge.github.io &amp;&amp; git pull &amp;&amp; cd .. &amp;&amp; clear&#x27;alias gpy=&#x27;cd ~/ghome/blogyih/source &amp;&amp; git pull &amp;&amp; cd ~/ghome/blogyih/52binge.github.io &amp;&amp; git pull &amp;&amp; cd .. &amp;&amp; clear&#x27;# Dockeralias dis=&#x27;docker images&#x27;alias dri=&#x27;docker rmi&#x27;alias dpa=&#x27;docker ps -a&#x27;alias dks=&#x27;docker stop&#x27;alias dck=&#x27;docker container kill&#x27;alias dcr=&#x27;docker container rm&#x27;alias dlog=&#x27;docker logs&#x27;# k8salias kb=&#x27;kubectl&#x27;alias kbg=&#x27;kubectl get&#x27;alias kbd=&#x27;kubectl delete&#x27;alias kbgdps=&#x27;kbg deploy,po,svc&#x27;alias kbdev=&#x27;export KUBECONFIG=~/kube/dev-kubeconfig&#x27;alias kbtest=&#x27;export KUBECONFIG=~/kube/test-kubeconfig&#x27;# work## downloadrqh=&#x27;rsync -v --progress qh:&#x27;# rsync -v --progress qh:/home/clb/Cyberduck-7.1.0.31395.zip .## upload# rsync -z -P demo.zip qh:/data/Libin/work_project/alias cpysk=&quot;/Users/blair/ghome/github/spark3.0/pyspark&quot;alias cwk=&#x27;cd ~/ghome/6E/work_project&#x27;alias csf=&#x27;cd ~/ghome/6E/self_project&#x27;alias cmlsearch=&#x27;cd ~/ghome/6E/work_project/mlsearch&#x27;alias cmlar=&#x27;cd ~/ghome/6E/work_project/mlar&#x27;alias sqh=&#x27;ssh -L 8889:localhost:8888 -CN qh&#x27;alias sqh-mlsearch=&#x27;ssh -L 8001:localhost:8001 -CN qh&#x27;alias sqh-mlar=&#x27;ssh -L 8003:localhost:8003 -CN qh&#x27;alias sqh-mlar-cs=&#x27;ssh -L 8300:localhost:8300 -CN qh&#x27;alias local_to_es=&#x27;ssh -L 9200:192.168.x.xxx:9200 -CN onenorth&#x27;alias kibana=&quot;ssh -D 1080 -CN onenorth&quot;alias catma=&#x27;conda activate mlar&#x27;alias catms=&#x27;conda activate mlsearch&#x27;alias catnn=&#x27;conda activate nn_framework&#x27;alias catsk=&#x27;conda activate spark&#x27;alias cata=&#x27;conda activate anaconda3&#x27;alias doc=&#x27;~/ghome/6E/chenlibin/data-doc/source/weekly&#x27;### Pyenv ####export PATH=&quot;/Users/blair/.pyenv/bin:$PATH&quot;#alias pyenv_init=&#x27;eval &quot;$(pyenv init -)&quot; &amp;&amp; eval &quot;$(pyenv virtualenv-init -)&quot;&#x27;#pyenv_init#export PYENV_VIRTUALENV_DISABLE_PROMPT=1# phalias gitph=&#x27;vim ~/.oh-my-zsh/plugins/git/git.plugin.zsh&#x27;# zshrcalias vzp=&#x27;vim ~/.zprofile&#x27;alias szp=&#x27;source ~/.zprofile&#x27;#docker run --publish=7474:7474 --publish=7687:7687 --volume=$HOME/neo4j/data:/data neo4j#pyenv-virtualenv: prompt changing will be removed from future release. configure `export PYENV_VIRTUALENV_DISABLE_PROMPT=1&#x27; to simulate the behavior. â€”- ä»¥ä¸‹å†…å®¹æ˜¯ä¸Šä¸€ä¸ªç‰ˆæœ¬çš„å†…å®¹ï¼Œè¯·å¿½ç•¥â€¦ â€”- 1. python### IPython ###alias ipython=&#x27;python -m IPython&#x27;### Pyenv ###export PATH=&quot;/Users/blair/.pyenv/bin:$PATH&quot;alias pyenv_init=&#x27;eval &quot;$(pyenv init -)&quot; &amp;&amp; eval &quot;$(pyenv virtualenv-init -)&quot;&#x27;pyenv_init#export PYENV_VIRTUALENV_DISABLE_PROMPT=1# pip listalias pipl=&#x27;pip list --format=columns&#x27;# pyenvalias pyenv_install_python_pre=&#x27;source $MS/custom-machine/pyenv-install.sh&#x27;alias py2=&#x27;pyenv_init &amp;&amp; pyenv activate vpy2 &amp;&amp; clear &amp;&amp; python -V&#x27;alias py3=&#x27;pyenv_init &amp;&amp; pyenv activate vpy3.5 &amp;&amp; clear &amp;&amp; python -V&#x27;alias vca3=&#x27;pyenv activate vconda3 &amp;&amp; clear &amp;&amp; python -V&#x27;alias pyde=&#x27;pyenv deactivate&#x27;alias pys=&#x27;pyenv activate vpy3 &amp;&amp; pyenv global system &amp;&amp; pyde &amp;&amp; python -V&#x27; 2. hexo blog# hexoalias hs=&#x27;cd ~/ghome/blog &amp;&amp; hexo clean &amp;&amp; hexo s -p 5000 &amp;&#x27;alias hsy=&#x27;cd ~/ghome/blogyih &amp;&amp; hexo clean &amp;&amp; hexo s -p 5001 &amp;&#x27;# deploy blogalias db=&#x27;~/ghome/blog &amp;&amp; sh dp.sh&#x27;alias dby=&#x27;~/ghome/blogyih &amp;&amp; sh dp.sh&#x27;alias gp=&#x27;cd ~/ghome/blog/source &amp;&amp; git pull &amp;&amp; cd ~/ghome/blog/52binge.github.io &amp;&amp; git pull &amp;&amp; cd .. &amp;&amp; clear&#x27;alias gpy=&#x27;cd ~/ghome/blogyih/source &amp;&amp; git pull &amp;&amp; cd ~/ghome/blogyih/52binge.github.io &amp;&amp; git pull &amp;&amp; cd .. &amp;&amp; clear&#x27; 3. shortcut approach### Fast Function #### show ipalias ip=&#x27;ipconfig getifaddr en0&#x27;alias ip0=&#x27;ipconfig getifaddr en0&#x27;alias ip1=&#x27;ipconfig getifaddr en1&#x27;# shutdownalias shuth=&#x27;sudo shutdown -h now&#x27;alias shutr=&#x27;sudo shutdown -r now&#x27;# grepalias fgstr=&#x27;find . | xargs grep -ri&#x27;#find .|xargs grep -ri &quot;IBM&quot; # lsof -i:portalias lsofi=&#x27;lsof -i:&#x27;# zshrcalias vzp=&#x27;vim ~/.zprofile&#x27;alias szp=&#x27;source ~/.zprofile&#x27;#pyenv-virtualenv: prompt changing will be removed from future release. configure `export PYENV_VIRTUALENV_DISABLE_PROMPT=1&#x27; to simulate the behavior. 4. docker, k8s# Dockeralias dis=&#x27;docker images&#x27;alias dri=&#x27;docker rmi&#x27;alias dpa=&#x27;docker ps -a&#x27;alias dks=&#x27;docker stop&#x27;alias dck=&#x27;docker container kill&#x27;alias dcr=&#x27;docker container rm&#x27;alias dlog=&#x27;docker logs&#x27;# k8salias kb=&#x27;kubectl&#x27;alias kbg=&#x27;kubectl get&#x27;alias kbd=&#x27;kubectl delete&#x27;alias kbgdps=&#x27;kbg deploy,po,svc&#x27;alias kbdev=&#x27;export KUBECONFIG=~/kube/dev-kubeconfig&#x27;alias kbtest=&#x27;export KUBECONFIG=~/kube/test-kubeconfig&#x27; 5. work# workalias rqh=&#x27;rsync -v --progress qh:&#x27;alias cw=&#x27;cd ~/ghome/6E/work_project&#x27;alias cs=&#x27;cd ~/ghome/6E/self_project&#x27;alias cmlar=&#x27;cd ~/ghome/6E/work_project/mlar&#x27;alias sqh=&#x27;ssh -L 8889:localhost:8888 -CN qh&#x27;alias catm=&#x27;conda activate mlar&#x27;alias catn=&#x27;conda activate nn_framework&#x27;alias cata=&#x27;conda activate anaconda3&#x27;alias doc=&#x27;~/ghome/6E/chenlibin/data-doc&#x27; 6. node.js### Node.js ###export NVM_DIR=&quot;$HOME/.nvm&quot;#[ -s &quot;$NVM_DIR/nvm.sh&quot; ] &amp;&amp; \\. &quot;$NVM_DIR/nvm.sh&quot; # This loads nvm#[ -s &quot;$NVM_DIR/bash_completion&quot; ] &amp;&amp; \\. &quot;$NVM_DIR/bash_completion&quot; # This loads nvm bash_completion 7. mac env### LANG ###export LC_ALL=en_US.UTF-8export LANG=en_US.UTF-8 8. Java### JAVA ###JAVA_HOME=/Library/Java/JavaVirtualMachines/Contents/HomeJAVA_BIN=$JAVA_HOME/binPATH=$JAVA_HOME/bin:$PATHCLASSPATH=.:$JAVA_HOME/jre/lib/rt.jar:$JAVA_HOME/jre/lib/dt.jar:$JAVA_HOME/jre/lib/tools.jarexport JAVA_HOME JAVA_BIN PATH CLASSPATH### Maven ###M2_HOME=/usr/local/xsoft/software/apache-mavenMAVEN_HOME=$M2_HOMEM3_HOME=$M2_HOMEPATH=$M3_HOME/bin:$PATHMAVEN_OPTS=&quot;-Xms128m -Xmx512m&quot;export MAVEN_HOME M2_HOME PATH### Tomcat ###CATALINA_HOME=/usr/local/xsoft/software/apache-tomcatPATH=$CATALINA_HOME/bin:$PATHexport CATALINA_HOME PATH 9. Scala### Scala ###export SCALA_HOME=/usr/local/xsoft/software/scalaexport PATH=$&#123;SCALA_HOME&#125;/bin:$PATH#export SCALA_HOME=/usr/local/Cellar/scala/2.11.5### KafkaKAFKA_HOME=/usr/local/Cellar/kafka/2.1.0PATH=$KAFKA_HOME/bin:$PATHexport KAFKA_HOME PATH### Spark ###export SPARK_HOME=/usr/local/xsoft/software/sparkexport PATH=$SPARK_HOME/bin:$PATH 10. zshrc# If you come from bash you might have to change your $PATH.# export PATH=$HOME/bin:/usr/local/bin:$PATH# Path to your oh-my-zsh installation.export ZSH=/Users/blair/.oh-my-zsh# Set name of the theme to load. Optionally, if you set this to &quot;random&quot;# it&#x27;ll load a random theme each time that oh-my-zsh is loaded.# See https://github.com/robbyrussell/oh-my-zsh/wiki/ThemesZSH_THEME=&quot;robbyrussell&quot;ZSH_THEME=&quot;astro&quot; plugins=(git)plugins=(git autojump) # by blair add @2017-10-10#[[ -s $(brew --prefix)/etc/profile.d/autojump.sh ]] &amp;&amp; . $(brew --prefix)/etc/profile.d/autojump.shsource $ZSH/oh-my-zsh.sh","categories":[{"name":"devops","slug":"devops","permalink":"http://iequa.com/categories/devops/"}],"tags":[{"name":"zshrc","slug":"zshrc","permalink":"http://iequa.com/tags/zshrc/"}]},{"title":"Macos Terminal Set Shadowsocks","slug":"devops/ops-mac-for-shadowsocks","date":"2017-10-19T14:24:21.000Z","updated":"2019-10-20T04:30:34.989Z","comments":true,"path":"2017/10/19/devops/ops-mac-for-shadowsocks/","link":"","permalink":"http://iequa.com/2017/10/19/devops/ops-mac-for-shadowsocks/","excerpt":"first, you need to have vps second, you need to have shadowsocks app","text":"first, you need to have vps second, you need to have shadowsocks app installbrew install polipo configè®¾ç½®æ¯æ¬¡ç™»é™†å¯åŠ¨polipo ln -sfv /usr/local/opt/polipo/*.plist ~/Library/LaunchAgents ä¿®æ”¹æ–‡ä»¶ /usr/local/opt/polipo/homebrew.mxcl.polipo.plist è®¾ç½®parentProxy &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;!DOCTYPE plist PUBLIC &quot;-//Apple//DTD PLIST 1.0//EN&quot; &quot;http://www.apple.com/DTDs/PropertyList-1.0.dtd&quot;&gt;&lt;plist version=&quot;1.0&quot;&gt; &lt;dict&gt; &lt;key&gt;Label&lt;/key&gt; &lt;string&gt;homebrew.mxcl.polipo&lt;/string&gt; &lt;key&gt;RunAtLoad&lt;/key&gt; &lt;true/&gt; &lt;key&gt;KeepAlive&lt;/key&gt; &lt;true/&gt; &lt;key&gt;ProgramArguments&lt;/key&gt; &lt;array&gt; &lt;string&gt;/usr/local/opt/polipo/bin/polipo&lt;/string&gt; &lt;string&gt;socksParentProxy=localhost:1080&lt;/string&gt; &lt;/array&gt; &lt;!-- Set `ulimit -n 20480`. The default OS X limit is 256, that&#x27;s not enough for Polipo (displays &#x27;too many files open&#x27; errors). It seems like you have no reason to lower this limit (and unlikely will want to raise it). --&gt; &lt;key&gt;SoftResourceLimits&lt;/key&gt; &lt;dict&gt; &lt;key&gt;NumberOfFiles&lt;/key&gt; &lt;integer&gt;20480&lt;/integer&gt; &lt;/dict&gt; &lt;/dict&gt;&lt;/plist&gt; ä¿®æ”¹çš„åœ°æ–¹æ˜¯å¢åŠ äº† &lt;string&gt;socksParentProxy=localhost:1080&lt;/string&gt; start / stoplaunchctl unload ~/Library/LaunchAgents/homebrew.mxcl.polipo.plistlaunchctl load ~/Library/LaunchAgents/homebrew.mxcl.polipo.plist setting profilevim ~/.zshrc #export http_proxy=http://localhost:8123alias hp=&quot;http_proxy=http://localhost:8123&quot; source ~/.zshrc testâœ hp curl ip.cnå½“å‰ IPï¼š97.64.**.** æ¥è‡ªï¼šç¾å›½ reference article æŠ€æœ¯å°é»‘å±‹ Mac+shadowsocks+polipoå¿«æ·å®ç°ç»ˆç«¯ç§‘å­¦ä¸Šç½‘ VPS-install-shadowsocks-proxy","categories":[{"name":"devops","slug":"devops","permalink":"http://iequa.com/categories/devops/"}],"tags":[{"name":"Shadowsocks","slug":"Shadowsocks","permalink":"http://iequa.com/tags/Shadowsocks/"}]},{"title":"Macos Sierra Uninstall App & Solve Allow apps Anywhere","slug":"devops/ops-mac-sierra-some-tips","date":"2017-10-19T13:57:21.000Z","updated":"2019-10-20T04:30:34.991Z","comments":true,"path":"2017/10/19/devops/ops-mac-sierra-some-tips/","link":"","permalink":"http://iequa.com/2017/10/19/devops/ops-mac-sierra-some-tips/","excerpt":"Here are some tips to help you fun macos sierra","text":"Here are some tips to help you fun macos sierra MacOS Sierra &amp; High Sierra Complete Uninstall App About This Mac -&gt; Storage -&gt; Manage -&gt; Applications -&gt; Delete How to Allow Apps from Anywhere in Gatekeeper for macOS High Sierra1). Open the Terminal app from the /Applications/Utilities/ folder and then enter the following command syntax: sudo spctl --master-disable Hit return and authenticate with an admin password 2). Relaunch System Preferences and go to â€œSecurity &amp; Privacyâ€ and the â€œGeneralâ€ tab 3). You will now see the â€œAnywhereâ€ option under â€˜Allow apps downloaded from:â€™ Gatekeeper options","categories":[{"name":"devops","slug":"devops","permalink":"http://iequa.com/categories/devops/"}],"tags":[{"name":"mac","slug":"mac","permalink":"http://iequa.com/tags/mac/"}]},{"title":"Pyenv Install For Virtual Multi Python Version Switch","slug":"devops/ops-pyenv-install","date":"2017-10-18T12:16:21.000Z","updated":"2019-10-20T04:30:34.994Z","comments":true,"path":"2017/10/18/devops/ops-pyenv-install/","link":"","permalink":"http://iequa.com/2017/10/18/devops/ops-pyenv-install/","excerpt":"It needs to be used in both python2 and python3 environments, or different packages need to be installed in different projects.","text":"It needs to be used in both python2 and python3 environments, or different packages need to be installed in different projects. we hope that the packages installed between different projects do not interfere with each other, and then you can configure the virtual environment of Python using pyenv. installation pyenvOfficial Pyenv Install export PATH=&quot;~/.pyenv/bin:$PATH&quot;eval &quot;$(pyenv init -)&quot;eval &quot;$(pyenv virtualenv-init -)&quot;#export PYENV_VIRTUALENV_DISABLE_PROMPT=1 æŒ‰ç…§å®˜æ–¹æ–‡æ¡£é…ç½®å³å¯ï¼Œmac zsh ç”¨æˆ·ï¼Œå°† ä»¥ä¸Šä¸‰å¥æ”¾å…¥åˆ° .zshrc å³å¯ã€‚ see available versionspyenv install -l install python in virtual envinstall python 2.7.14 pyenv install 2.7.14 install python 3.6.3 pyenv install 3.6.3 solve macOS High Sierra: ERROR: The Python ssl extension was not compiled. Missing the OpenSSL lib? # about zlibexport CFLAGS=&quot;-I$(xcrun --show-sdk-path)/usr/include&quot;# about readlineexport CFLAGS=&quot;-I$(brew --prefix readline)/include $CFLAGS&quot;export LDFLAGS=&quot;-L$(brew --prefix readline)/lib $LDFLAGS&quot;# about opensslexport CFLAGS=&quot;-I$(brew --prefix openssl)/include $CFLAGS&quot;export LDFLAGS=&quot;-L$(brew --prefix openssl)/lib $LDFLAGS&quot;# about SQLite (maybe not necessary)export CFLAGS=&quot;-I$(brew --prefix sqlite)/include $CFLAGS&quot;export LDFLAGS=&quot;-L$(brew --prefix sqlite)/lib $LDFLAGS&quot; Set or show the global Python version $ pyenv global 3.6.3 or system system stands for this mac show list all Python versions available to pyenv $ pyenv versions create virtual envcreate current 3.6.3 version python virtual env $ pyenv virtualenv vpy3 vpy3 is this virtual env alias pyenv activate &amp; deactivate$ pyenv activate vpy3 è¿™æ˜¯æ—¶å€™å°±å¯ä»¥å¼€å§‹pipå®‰è£…ä¾èµ–åŒ…äº† âœ pyenv activate vpy3pyenv-virtualenv: prompt changing will be removed from future release. configure `export PYENV_VIRTUALENV_DISABLE_PROMPT=1&#x27; to simulate the behavior.(vpy3)# ~ [12:25:44]âœ python -VPython 3.6.3(vpy3)# ~ [12:25:49]âœ pyenv deactivate vpy3# ~ [12:25:57]âœ python -VPython 2.7.10","categories":[{"name":"devops","slug":"devops","permalink":"http://iequa.com/categories/devops/"}],"tags":[{"name":"help","slug":"help","permalink":"http://iequa.com/tags/help/"}]},{"title":"Common Useful Links","slug":"devops/ops-common-links","date":"2017-10-14T12:16:21.000Z","updated":"2019-10-20T04:30:34.990Z","comments":true,"path":"2017/10/14/devops/ops-common-links/","link":"","permalink":"http://iequa.com/2017/10/14/devops/ops-common-links/","excerpt":"Here are some useful links","text":"Here are some useful links Deep Learning Coursera daniellaah.github.io deeplearning.aiæ·±åº¦å­¦ä¹ è¯¾ç¨‹å­—å¹•ç¿»è¯‘é¡¹ç›® äº’é“æ™šå®‰ï¼Œç‹è€…å³¡è°·è§ æœºå™¨å­¦ä¹  &amp; æ·±åº¦å­¦ä¹  NG ç¬”è®° deeplearning.aiï¼ˆå´æ©è¾¾è€å¸ˆçš„æ·±åº¦å­¦ä¹ è¯¾ç¨‹ç¬”è®°åŠèµ„æºï¼‰ å¤§æ•°æ®æ–‡æ‘˜ deeplearning.ai Sequence Models ä¸­æ–‡ç¬”è®° Sequence Models è‹±æ–‡ç‰ˆç¬”è®° å¯’å°é˜³ - æ·±åº¦å­¦ä¹ ä¸è‡ªç„¶è¯­è¨€å¤„ç† å¯’å°é˜³ä¸»é¡µ Bolei Zhou @Assistant Professor CUHK è®¡ç®—æœºè§†è§‰å’Œè‡ªç„¶è¯­è¨€å¤„ç†ï¼Œå“ªä¸ªæ›´å…·æœ‰å‘å±•å‰æ™¯å‘¢ï¼Œè¿˜æ˜¯å„æœ‰åƒç§‹å‘¢ï¼Ÿ Recommend æ¨èç³»ç»Ÿç»å…¸è®ºæ–‡æ–‡çŒ®åŠä¸šç•Œåº”ç”¨ NLP sense2vec zybuluo hanxiaoyang gensim è‡ªç„¶è¯­è¨€ç†è§£-ä»è§„åˆ™åˆ°æ·±åº¦å­¦ä¹  Free Will www.wildml.com Friends fazero ali wuchong Pollçš„ç¬”è®° é˜®ä¸€å³°çš„ç½‘ç»œæ—¥å¿— ICML å­¦éœ¸ David Abel é…·å£³ vps www.yuntionly.com www.wisevpn.net www.banwago.com www.godaddy.com æ¬ç“¦å·¥ä¸­æ–‡ç½‘ æ¬ç“¦å·¥è´­ä¹°é¡µé¢ æ¬ç“¦å·¥VPSç»­è´¹çš„é‚£äº›äº‹ æ¬ç“¦å·¥å–æ¶ˆä¸€é”®SSåŠŸèƒ½åï¼Œæ•™æ‚¨ä¸‰ç§æ–¹æ³•è½»æ¾æ­å»ºSSï¼ ç™»é™†åˆ°æ¬ç“¦å·¥åå°, ä¸€é”®å®‰è£…SSï¼Œç±»ä¼¼æ–¹æ³•ä¸€ï¼ˆå°ç™½é€‚ç”¨ Centos6.8æ­å»ºSS ssh ç™»å½•æ¬ç“¦å·¥æœºå™¨ stop server @Main controls Root password modification start Server Root shell - interactive vi /etc/ssh/sshd_config, add PermitRootLogin yesPort 22 /etc/init.d/sshd restart ssh root@ip python å»–é›ªå³° Python 3 elasticsearch-dsl-py pypi.python.org/pypi install pyenv flask microframework pip install elasticsearch_dsl==0.0.11 shell runoob linux Mac OSX æ²’æœ‰çš„ renameï¼Œç”¨ brew æŠ“å›ä¾†ï½ spark spark.apache.org python spark 1.6.3 github spark åœ¨ pycharm ä¸Šé…ç½® pyspark pycharm ä¸Šé…ç½® pyspark Pycharmå¼€å‘sparkç¨‹åº devops å…ç™»é™†è®¾ç½® ssh-copy-id -i id_rsa.pub hdfs@192.192.0.27 mac macOS (OS X) æœ‰å“ªäº›å¸¸ç”¨çš„å¿«æ·é”®ï¼Ÿ æ¯”ç‰¹å¸ æ¸¯å°æ•°å­—è´§å¸äº¤æ˜“å¹³å°æ’å bitfinex binance å¦‚ä½•æŠŠç«å¸ç½‘çš„æ¯”ç‰¹å¸ç§»åˆ°OKEXï¼Ÿ å¸å®‰(Binance) | æ³¨å†Œå’Œä½¿ç”¨æ•™ç¨‹ å°æ¹¾å¸æ‰˜ OTCBTC - æ”¯æŒåœºå¤–äº¤æ˜“ï¼Œæ”¯ä»˜å® blog é¼“åŠ±å·¥ç¨‹å¸ˆå†™blog æŠ€æœ¯äººå‘˜çš„å‘å±•ä¹‹è·¯","categories":[{"name":"devops","slug":"devops","permalink":"http://iequa.com/categories/devops/"}],"tags":[{"name":"help","slug":"help","permalink":"http://iequa.com/tags/help/"}]},{"title":"Coursera 7 - Support Vector Machines","slug":"ml/coursera-ng-w7-svm","date":"2017-10-13T08:08:21.000Z","updated":"2019-10-20T04:30:35.043Z","comments":true,"path":"2017/10/13/ml/coursera-ng-w7-svm/","link":"","permalink":"http://iequa.com/2017/10/13/ml/coursera-ng-w7-svm/","excerpt":"From Logistic Regression to Support Vector Machines","text":"From Logistic Regression to Support Vector Machines 1. Large Margin ClassificationAlternation view of logistic regression $ \\begin{align} h_\\theta (x) = g({\\theta^T x}) = \\dfrac{1}{1 + e^{-\\theta^T x}} \\end{align} \\; , \\; h_\\theta (x) \\in [0, 1] $ $ y = 1 \\; when \\; h_\\theta(x) = g(\\theta^T x) \\geq 0.5 \\; when \\; \\theta^T x \\geq 0 $. $ y = 0 \\; when \\; h_\\theta(x) = g(\\theta^T x) \\le 0.5 \\; when \\; \\theta^T x \\le 0 $ We can compress our cost functionâ€™s two conditional cases into one case: $ \\mathrm{Cost}(h_\\theta(x),y) = - y \\cdot \\log(h_\\theta(x)) - (1 - y) \\cdot \\log(1 - h_\\theta(x))$ We can fully write out our entire cost function as follows: $J(\\theta) = - \\frac{1}{m} \\displaystyle \\sum_{i=1}^m [y^{(i)}\\log (h_\\theta (x^{(i)})) + (1 - y^{(i)})\\log (1 - h_\\theta(x^{(i)}))]$ $J(\\theta) = \\mathop{min}\\limits_{_\\theta} \\frac{1}{m} \\left[ \\displaystyle \\sum_{i=1}^m y^{(i)}\\ \\left(-\\log h_\\theta (x^{(i)}) \\right) + (1 - y^{(i)}) \\left( - \\log (1 - h_\\theta(x^{(i)})) \\right) \\right]+ \\frac{\\lambda}{2m} \\displaystyle \\sum_{j=1}^n \\theta_j^2$ $cost_1(\\theta^T x^{i}) = -\\log h_\\theta (x^{(i)})$$cost_0(\\theta^T x^{i}) = - \\log (1 - h_\\theta(x^{(i)}))$ $J(\\theta) = \\mathop{min}\\limits_{_\\theta} \\frac{1}{m} \\left[ \\displaystyle \\sum_{i=1}^m y^{(i)}\\ \\left(cost_1(\\theta^T x^{i}) \\right) + (1 - y^{(i)}) \\left( cost_0(\\theta^T x^{i}) \\right) \\right]+ \\frac{\\lambda}{2m} \\displaystyle \\sum_{j=1}^n \\theta_j^2$ 1.1 Optimization Objective$J(\\theta) = \\mathop{min}\\limits_{_\\theta} \\frac{1}{m} \\left[ \\displaystyle \\sum_{i=1}^m y^{(i)}\\ \\left(cost_1(\\theta^T x^{i}) \\right) + (1 - y^{(i)}) \\left( cost_0(\\theta^T x^{i}) \\right) \\right]+ \\frac{\\lambda}{2m} \\displaystyle \\sum_{j=1}^n \\theta_j^2$ ä»¤ $C = \\frac{1}{\\theta}$ $J(\\theta) = \\mathop{min}\\limits_{_\\theta} C \\displaystyle \\sum_{i=1}^m \\left[ y^{(i)}\\ cost_1(\\theta^T x^{i}) + (1 - y^{(i)}) cost_0(\\theta^T x^{i}) \\right]+ \\frac{1}{2m} \\displaystyle \\sum_{j=1}^n \\theta_j^2$ 1.2 Large Margin Intuition 1.3 Mathematics Behind Large Margin Classification 2. Kernels2.1 Kernels I2.2 Kernels II3. SVMs in Practice3.1 Using An SVMReference é›¶åŸºç¡€å­¦SVMâ€”Support Vector Machine(ä¸€)","categories":[{"name":"machine-learning","slug":"machine-learning","permalink":"http://iequa.com/categories/machine-learning/"}],"tags":[{"name":"SVM","slug":"SVM","permalink":"http://iequa.com/tags/SVM/"}]},{"title":"My Blog Config.yml","slug":"devops/ops-hexo-blog_config.yml","date":"2017-10-08T12:16:21.000Z","updated":"2019-10-20T04:30:34.995Z","comments":true,"path":"2017/10/08/devops/ops-hexo-blog_config.yml/","link":"","permalink":"http://iequa.com/2017/10/08/devops/ops-hexo-blog_config.yml/","excerpt":"hexo blog config.yml file","text":"hexo blog config.yml file # Hexo Configuration## Docs: https://hexo.io/docs/configuration.html## Source: https://github.com/hexojs/hexo/# Sitetitle: Homesubtitle: æ˜¥æœ‰ç™¾èŠ±ç§‹æœ‰æœˆï¼Œå¤æœ‰æ¶¼é¢¨å†¬æœ‰é›ª .description: Everyone should not forget his dreamauthor: Blair Chan#avatar: /images/avatar.jpeglanguage: - en- zh-Hans- zh-twtimezone:#leancloud_visitors:# enable: true# app_id: #&lt;AppID&gt;# app_key: #&lt;AppKEY&gt;#commentsdisqus_shortname: blairos-sn# URL## If your site is put in a subdirectory, set url as &#x27;http://yoursite.com/child&#x27; and root as &#x27;/child/&#x27;url: http://iequa.com/root: /permalink: :year/:month/:day/:title/permalink_defaults:# Directorysource_dir: sourcepublic_dir: publictag_dir: tagsarchive_dir: archivescategory_dir: categoriescode_dir: downloads/codei18n_dir: :langskip_render:# Writingnew_post_name: :title.md # File name of new postsdefault_layout: posttitlecase: false # Transform title into titlecaseexternal_link: true # Open external links in new tabfilename_case: 0render_drafts: falsepost_asset_folder: falserelative_link: falsefuture: truehighlight: enable: true line_number: false auto_detect: false tab_replace:# Category &amp; Tagdefault_category: uncategorizedcategory_map:tag_map:# Date / Time format## Hexo uses Moment.js to parse and display date## You can customize the date format as defined in## http://momentjs.com/docs/#/displaying/format/date_format: YYYY-MM-DDtime_format: HH:mm:ss# Pagination## Set per_page to 0 to disable paginationper_page: 10pagination_dir: page# Extensions## Plugins: https://hexo.io/plugins/## Themes: https://hexo.io/themes/## theme: hexo-theme-next## theme: yinwang## theme: minostheme: blairos## theme: jacman## theme: landscape-plus# Deployment## Docs: https://hexo.io/docs/deployment.htmldeploy:type: gitrepository: https://github.com/52binge/52binge.github.io.gitbranch: master","categories":[{"name":"devops","slug":"devops","permalink":"http://iequa.com/categories/devops/"}],"tags":[{"name":"macos","slug":"macos","permalink":"http://iequa.com/tags/macos/"}]},{"title":"My Vim Config File","slug":"devops/ops-vimrc","date":"2017-10-04T12:16:21.000Z","updated":"2019-10-20T04:30:34.990Z","comments":true,"path":"2017/10/04/devops/ops-vimrc/","link":"","permalink":"http://iequa.com/2017/10/04/devops/ops-vimrc/","excerpt":"my vim custom config .vimrc file","text":"my vim custom config .vimrc file set nocompatible &quot; å…³é—­ vi å…¼å®¹æ¨¡å¼ syntax on &quot; è‡ªåŠ¨è¯­æ³•é«˜äº® set number &quot; æ˜¾ç¤ºè¡Œå· &quot; set cursorline çªå‡ºæ˜¾ç¤ºå½“å‰è¡Œ set ruler &quot; æ‰“å¼€çŠ¶æ€æ æ ‡å°º (ä¸é”™) set shiftwidth=4 &quot; è®¾å®š &lt;&lt; å’Œ &gt;&gt; å‘½ä»¤ç§»åŠ¨æ—¶çš„å®½åº¦ä¸º 4 set smartindent set tabstop=4 &quot; tabstop=4 è®¾å®š tab é•¿åº¦ä¸º4 set softtabstop=4 set expandtab set encoding=utf-8 fileencodings=ucs-bom,utf-8,cp936set nobackup &quot; è¦†ç›–æ–‡ä»¶æ—¶ä¸å¤‡ä»½ set ignorecase smartcase &quot; æœç´¢æ—¶å¿½ç•¥å¤§å°å†™ï¼Œä½†åœ¨æœ‰ä¸€ä¸ªæˆ–ä»¥ä¸Šå¤§å†™å­—æ¯æ—¶ä»å¤§å°å†™æ•æ„Ÿ &quot;set nowrapscan &quot; ç¦æ­¢åœ¨æœç´¢åˆ°æ–‡ä»¶ä¸¤ç«¯æ—¶é‡æ–°æœç´¢ set nowrapscan &quot; ç¦æ­¢åœ¨æœç´¢åˆ°æ–‡ä»¶ä¸¤ç«¯æ—¶é‡æ–°æœç´¢ set incsearch &quot; è¾“å…¥æœç´¢å†…å®¹æ—¶å°±æ˜¾ç¤ºæœç´¢ç»“æœ set hlsearch &quot; æœç´¢æ—¶é«˜äº®æ˜¾ç¤ºè¢«æ‰¾åˆ°çš„æ–‡æœ¬ set noerrorbells &quot; å…³é—­é”™è¯¯ä¿¡æ¯å“é“ƒ set novisualbell &quot; å…³é—­ä½¿ç”¨å¯è§†å“é“ƒä»£æ›¿å‘¼å« set t_vb= &quot; ç½®ç©ºé”™è¯¯é“ƒå£°çš„ç»ˆç«¯ä»£ç  set showmatch &quot; æ’å…¥æ‹¬å·æ—¶ï¼ŒçŸ­æš‚åœ°è·³è½¬åˆ°åŒ¹é…çš„å¯¹åº”æ‹¬å· &quot; set matchtime=2 &quot; çŸ­æš‚è·³è½¬åˆ°åŒ¹é…æ‹¬å·çš„æ—¶é—´ set magic &quot; è®¾ç½®é­”æœ¯ set hidden &quot; å…è®¸åœ¨æœ‰æœªä¿å­˜çš„ä¿®æ”¹æ—¶åˆ‡æ¢ç¼“å†²åŒºï¼Œæ­¤æ—¶çš„ä¿®æ”¹ç”± vim è´Ÿè´£ä¿å­˜ &quot;set guioptions-=T &quot; éšè—å·¥å…·æ  &quot;set guioptions-=m &quot; éšè—èœå•æ  set smartindent &quot; å¼€å¯æ–°è¡Œæ—¶ä½¿ç”¨æ™ºèƒ½è‡ªåŠ¨ç¼©è¿› set backspace=indent,eol,start &quot; ä¸è®¾å®šåœ¨æ’å…¥çŠ¶æ€æ— æ³•ç”¨é€€æ ¼é”®å’Œ Delete é”®åˆ é™¤å›è½¦ç¬¦ set cmdheight=1 &quot; è®¾å®šå‘½ä»¤è¡Œçš„è¡Œæ•°ä¸º 1 set laststatus=2 &quot; æ˜¾ç¤ºçŠ¶æ€æ  (é»˜è®¤å€¼ä¸º 1, æ— æ³•æ˜¾ç¤ºçŠ¶æ€æ ) set statusline=\\ %&lt;%F[%1*%M%*%n%R%H]%=\\ %y\\ %0(%&#123;&amp;fileformat&#125;\\ %&#123;&amp;encoding&#125;\\ %c:%l/%L%)\\ &quot; è®¾ç½®åœ¨çŠ¶æ€è¡Œæ˜¾ç¤ºçš„ä¿¡æ¯ &quot;set foldenable &quot; å¼€å§‹æŠ˜å  &quot;set foldmethod=syntax &quot; è®¾ç½®è¯­æ³•æŠ˜å  &quot;set foldcolumn=0 &quot; è®¾ç½®æŠ˜å åŒºåŸŸçš„å®½åº¦ &quot;setlocal foldlevel=1 &quot; è®¾ç½®æŠ˜å å±‚æ•°ä¸º &quot; set foldclose=all &quot; è®¾ç½®ä¸ºè‡ªåŠ¨å…³é—­æŠ˜å  &quot; nnoremap &lt;space&gt; @=((foldclosed(line(&#x27;.&#x27;)) &lt; 0) ? &#x27;zc&#x27; : &#x27;zo&#x27;)&lt;CR&gt; &quot; ç”¨ç©ºæ ¼é”®æ¥å¼€å…³æŠ˜å  set fileencodings=utf-8,ucs-bom,gb18030,gbk,gb2312,cp936set termencoding=utf-8set encoding=utf-8 &quot; return OS type, eg: windows, or linux, mac, et.st.. function! MySys() if has(&quot;win16&quot;) || has(&quot;win32&quot;) || has(&quot;win64&quot;) || has(&quot;win95&quot;) return &quot;windows&quot; elseif has(&quot;unix&quot;) return &quot;linux&quot; endif endfunction &quot; ç”¨æˆ·ç›®å½•å˜é‡$VIMFILES if MySys() == &quot;windows&quot; let $VIMFILES = $VIM.&#x27;/vimfiles&#x27; elseif MySys() == &quot;linux&quot; let $VIMFILES = $HOME.&#x27;/.vim&#x27; endif &quot; è®¾å®šdocæ–‡æ¡£ç›®å½• let helptags=$VIMFILES.&#x27;/doc&#x27; &quot; è®¾ç½®å­—ä½“ ä»¥åŠä¸­æ–‡æ”¯æŒ if has(&quot;win32&quot;) set guifont=Inconsolata:h12:cANSI endif &quot; é…ç½®å¤šè¯­è¨€ç¯å¢ƒ if has(&quot;multi_byte&quot;) &quot; UTF-8 ç¼–ç  set encoding=utf-8 set termencoding=utf-8 set formatoptions+=mM set fencs=utf-8,gbk if v:lang =~? &#x27;^\\(zh\\)\\|\\(ja\\)\\|\\(ko\\)&#x27; set ambiwidth=double endif if has(&quot;win32&quot;) source $VIMRUNTIME/delmenu.vim source $VIMRUNTIME/menu.vim language messages zh_CN.utf-8 endif else echoerr &quot;Sorry, this version of (g)vim was not compiled with +multi_byte&quot; endif &quot; Buffersæ“ä½œå¿«æ·æ–¹å¼! nnoremap &lt;C-RETURN&gt; :bnext&lt;CR&gt; nnoremap &lt;C-S-RETURN&gt; :bprevious&lt;CR&gt; &quot; Tabæ“ä½œå¿«æ·æ–¹å¼! nnoremap &lt;C-TAB&gt; :tabnext&lt;CR&gt; nnoremap &lt;C-S-TAB&gt; :tabprev&lt;CR&gt; &quot;å…³äºtabçš„å¿«æ·é”® &quot; map tn :tabnext&lt;cr&gt; &quot; map tp :tabprevious&lt;cr&gt; &quot; map td :tabnew .&lt;cr&gt; &quot; map te :tabedit &quot; map tc :tabclose&lt;cr&gt; &quot;çª—å£åˆ†å‰²æ—¶,è¿›è¡Œåˆ‡æ¢çš„æŒ‰é”®çƒ­é”®éœ€è¦è¿æ¥ä¸¤æ¬¡,æ¯”å¦‚ä»ä¸‹æ–¹çª—å£ç§»åŠ¨ &quot;å…‰æ ‡åˆ°ä¸Šæ–¹çª—å£,éœ€è¦&lt;c-w&gt;&lt;c-w&gt;k,éå¸¸éº»çƒ¦,ç°åœ¨é‡æ˜ å°„ä¸º&lt;c-k&gt;,åˆ‡æ¢çš„ &quot;æ—¶å€™ä¼šå˜å¾—éå¸¸æ–¹ä¾¿. nnoremap &lt;C-h&gt; &lt;C-w&gt;h nnoremap &lt;C-j&gt; &lt;C-w&gt;j nnoremap &lt;C-k&gt; &lt;C-w&gt;k nnoremap &lt;C-l&gt; &lt;C-w&gt;l &quot;ä¸€äº›ä¸é”™çš„æ˜ å°„è½¬æ¢è¯­æ³•ï¼ˆå¦‚æœåœ¨ä¸€ä¸ªæ–‡ä»¶ä¸­æ··åˆäº†ä¸åŒè¯­è¨€æ—¶æœ‰ç”¨ï¼‰ nnoremap &lt;leader&gt;1 :set filetype=xhtml&lt;CR&gt; nnoremap &lt;leader&gt;2 :set filetype=css&lt;CR&gt; nnoremap &lt;leader&gt;3 :set filetype=javascript&lt;CR&gt; nnoremap &lt;leader&gt;4 :set filetype=php&lt;CR&gt; &quot; set fileformats=unix,dos,mac &quot; nmap &lt;leader&gt;fd :se fileformat=dos&lt;CR&gt; &quot; nmap &lt;leader&gt;fu :se fileformat=unix&lt;CR&gt; &quot; use Ctrl+[l|n|p|cc] to list|next|previous|jump to count the result &quot; map &lt;C-x&gt;l &lt;ESC&gt;:cl&lt;CR&gt; &quot; map &lt;C-x&gt;n &lt;ESC&gt;:cn&lt;CR&gt; &quot; map &lt;C-x&gt;p &lt;ESC&gt;:cp&lt;CR&gt; &quot; map &lt;C-x&gt;c &lt;ESC&gt;:cc&lt;CR&gt; &quot; è®© Tohtml äº§ç”Ÿæœ‰ CSS è¯­æ³•çš„ html &quot; syntax/2html.vimï¼Œå¯ä»¥ç”¨:runtime! syntax/2html.vim let html_use_css=1 &quot; Python æ–‡ä»¶çš„ä¸€èˆ¬è®¾ç½®ï¼Œæ¯”å¦‚ä¸è¦ tab ç­‰ autocmd FileType python set tabstop=4 shiftwidth=4 expandtab autocmd FileType python map &lt;F12&gt; :!python %&lt;CR&gt; &quot; é€‰ä¸­çŠ¶æ€ä¸‹ Ctrl+c å¤åˆ¶ vmap &lt;C-c&gt; &quot;+y &quot; æ‰“å¼€javascriptæŠ˜å  let b:javascript_fold=1 &quot; æ‰“å¼€javascriptå¯¹domã€htmlå’Œcssçš„æ”¯æŒ let javascript_enable_domhtmlcss=1 &quot; è®¾ç½®å­—å…¸ ~/.vim/dict/æ–‡ä»¶çš„è·¯å¾„ autocmd filetype javascript set dictionary=$VIMFILES/dict/javascript.dict autocmd filetype css set dictionary=$VIMFILES/dict/css.dict autocmd filetype php set dictionary=$VIMFILES/dict/php.dict &quot;----------------------------------------------------------------- &quot; plugin - bufexplorer.vim Buffersåˆ‡æ¢ &quot; \\be å…¨å±æ–¹å¼æŸ¥çœ‹å…¨éƒ¨æ‰“å¼€çš„æ–‡ä»¶åˆ—è¡¨ &quot; \\bv å·¦å³æ–¹å¼æŸ¥çœ‹ \\bs ä¸Šä¸‹æ–¹å¼æŸ¥çœ‹ &quot;----------------------------------------------------------------- &quot;----------------------------------------------------------------- &quot; plugin - taglist.vim æŸ¥çœ‹å‡½æ•°åˆ—è¡¨ï¼Œéœ€è¦ctagsç¨‹åº &quot; F4 æ‰“å¼€éšè—taglistçª—å£ &quot;----------------------------------------------------------------- if MySys() == &quot;windows&quot; &quot; è®¾å®šwindowsç³»ç»Ÿä¸­ctagsç¨‹åºçš„ä½ç½® let Tlist_Ctags_Cmd = &#x27;&quot;&#x27;.$VIMRUNTIME.&#x27;/ctags.exe&quot;&#x27; elseif MySys() == &quot;linux&quot; &quot; è®¾å®šwindowsç³»ç»Ÿä¸­ctagsç¨‹åºçš„ä½ç½® let Tlist_Ctags_Cmd = &#x27;/usr/bin/ctags&#x27; endif nnoremap &lt;silent&gt;&lt;F4&gt; :TlistToggle&lt;CR&gt; let Tlist_Show_One_File = 1 &quot; ä¸åŒæ—¶æ˜¾ç¤ºå¤šä¸ªæ–‡ä»¶çš„tagï¼Œåªæ˜¾ç¤ºå½“å‰æ–‡ä»¶çš„ let Tlist_Exit_OnlyWindow = 1 &quot; å¦‚æœtaglistçª—å£æ˜¯æœ€åä¸€ä¸ªçª—å£ï¼Œåˆ™é€€å‡ºvim let Tlist_Use_Right_Window = 1 &quot; åœ¨å³ä¾§çª—å£ä¸­æ˜¾ç¤ºtaglistçª—å£ let Tlist_File_Fold_Auto_Close=1 &quot; è‡ªåŠ¨æŠ˜å å½“å‰éç¼–è¾‘æ–‡ä»¶çš„æ–¹æ³•åˆ—è¡¨ let Tlist_Auto_Open = 0 let Tlist_Auto_Update = 1 let Tlist_Hightlight_Tag_On_BufEnter = 1 let Tlist_Enable_Fold_Column = 0 let Tlist_Process_File_Always = 1 let Tlist_Display_Prototype = 0 let Tlist_Compact_Format = 1 &quot;----------------------------------------------------------------- &quot; plugin - mark.vim ç»™å„ç§tagsæ ‡è®°ä¸åŒçš„é¢œè‰²ï¼Œä¾¿äºè§‚çœ‹è°ƒå¼çš„æ’ä»¶ã€‚ &quot; \\m mark or unmark the word under (or before) the cursor &quot; \\r manually input a regular expression. ç”¨äºæœç´¢. &quot; \\n clear this mark (i.e. the mark under the cursor), or clear all highlighted marks . &quot; \\* å½“å‰MarkWordçš„ä¸‹ä¸€ä¸ª \\# å½“å‰MarkWordçš„ä¸Šä¸€ä¸ª &quot; \\/ æ‰€æœ‰MarkWordsçš„ä¸‹ä¸€ä¸ª \\? æ‰€æœ‰MarkWordsçš„ä¸Šä¸€ä¸ª &quot;----------------------------------------------------------------- &quot;----------------------------------------------------------------- &quot; plugin - NERD_tree.vim ä»¥æ ‘çŠ¶æ–¹å¼æµè§ˆç³»ç»Ÿä¸­çš„æ–‡ä»¶å’Œç›®å½• &quot; :ERDtree æ‰“å¼€NERD_tree :NERDtreeClose å…³é—­NERD_tree &quot; o æ‰“å¼€å…³é—­æ–‡ä»¶æˆ–è€…ç›®å½• t åœ¨æ ‡ç­¾é¡µä¸­æ‰“å¼€ &quot; T åœ¨åå°æ ‡ç­¾é¡µä¸­æ‰“å¼€ ! æ‰§è¡Œæ­¤æ–‡ä»¶ &quot; p åˆ°ä¸Šå±‚ç›®å½• P åˆ°æ ¹ç›®å½• &quot; K åˆ°ç¬¬ä¸€ä¸ªèŠ‚ç‚¹ J åˆ°æœ€åä¸€ä¸ªèŠ‚ç‚¹ &quot; u æ‰“å¼€ä¸Šå±‚ç›®å½• m æ˜¾ç¤ºæ–‡ä»¶ç³»ç»Ÿèœå•ï¼ˆæ·»åŠ ã€åˆ é™¤ã€ç§»åŠ¨æ“ä½œï¼‰ &quot; r é€’å½’åˆ·æ–°å½“å‰ç›®å½• R é€’å½’åˆ·æ–°å½“å‰æ ¹ç›®å½• &quot;----------------------------------------------------------------- &quot; F3 NERDTree åˆ‡æ¢ map &lt;F3&gt; :NERDTreeToggle&lt;CR&gt; imap &lt;F3&gt; &lt;ESC&gt;:NERDTreeToggle&lt;CR&gt; &quot;----------------------------------------------------------------- &quot; plugin - NERD_commenter.vim æ³¨é‡Šä»£ç ç”¨çš„ï¼Œ &quot; [count],cc å…‰æ ‡ä»¥ä¸‹countè¡Œé€è¡Œæ·»åŠ æ³¨é‡Š(7,cc) &quot; [count],cu å…‰æ ‡ä»¥ä¸‹countè¡Œé€è¡Œå–æ¶ˆæ³¨é‡Š(7,cu) &quot; [count],cm å…‰æ ‡ä»¥ä¸‹countè¡Œå°è¯•æ·»åŠ å—æ³¨é‡Š(7,cm) &quot; ,cA åœ¨è¡Œå°¾æ’å…¥ /* */,å¹¶ä¸”è¿›å…¥æ’å…¥æ¨¡å¼ã€‚ è¿™ä¸ªå‘½ä»¤æ–¹ä¾¿å†™æ³¨é‡Šã€‚ &quot; æ³¨ï¼šcountå‚æ•°å¯é€‰ï¼Œæ— åˆ™é»˜è®¤ä¸ºé€‰ä¸­è¡Œæˆ–å½“å‰è¡Œ &quot;----------------------------------------------------------------- &quot;let NERDSpaceDelims=1 &quot; è®©æ³¨é‡Šç¬¦ä¸è¯­å¥ä¹‹é—´ç•™ä¸€ä¸ªç©ºæ ¼ &quot;let NERDCompact***yComs=1 &quot; å¤šè¡Œæ³¨é‡Šæ—¶æ ·å­æ›´å¥½çœ‹ &quot;----------------------------------------------------------------- &quot; plugin - DoxygenToolkit.vim ç”±æ³¨é‡Šç”Ÿæˆæ–‡æ¡£ï¼Œå¹¶ä¸”èƒ½å¤Ÿå¿«é€Ÿç”Ÿæˆå‡½æ•°æ ‡å‡†æ³¨é‡Š &quot;----------------------------------------------------------------- let g:DoxygenToolkit_authorName=&quot;Asins - asinsimple AT gmail DOT com&quot; let g:DoxygenToolkit_briefTag_funcName=&quot;yes&quot; map &lt;leader&gt;da :DoxAuthor&lt;CR&gt; map &lt;leader&gt;df :Dox&lt;CR&gt; map &lt;leader&gt;db :DoxBlock&lt;CR&gt; map &lt;leader&gt;dc a /* */&lt;LEFT&gt;&lt;LEFT&gt;&lt;LEFT&gt; &quot;----------------------------------------------------------------- &quot; plugin â€“ ZenCoding.vim å¾ˆé…·çš„æ’ä»¶ï¼ŒHTMLä»£ç ç”Ÿæˆ &quot; æ’ä»¶æœ€æ–°ç‰ˆï¼šhttp://github.com/mattn/zencoding-vim &quot; å¸¸ç”¨å‘½ä»¤å¯çœ‹ï¼šhttp://nootn.com/blog/Tool/23/ &quot;----------------------------------------------------------------- &quot;----------------------------------------------------------------- &quot; plugin â€“ checksyntax.vim JavaScriptå¸¸è§è¯­æ³•é”™è¯¯æ£€æŸ¥ &quot; é»˜è®¤å¿«æ·æ–¹å¼ä¸º F5 &quot;----------------------------------------------------------------- let g:checksyntax_auto = 0 &quot; ä¸è‡ªåŠ¨æ£€æŸ¥ &quot;----------------------------------------------------------------- &quot; plugin - NeoComplCache.vim è‡ªåŠ¨è¡¥å…¨æ’ä»¶ &quot;----------------------------------------------------------------- let g:AutoComplPop_NotEnableAtStartup = 1 let g:NeoComplCache_EnableAtStartup = 1 let g:NeoComplCache_SmartCase = 1 let g:NeoComplCache_TagsAutoUpdate = 1 let g:NeoComplCache_EnableInfo = 1 let g:NeoComplCache_EnableCamelCaseCompletion = 1 let g:NeoComplCache_MinSyntaxLength = 3 let g:NeoComplCache_EnableSkipCompletion = 1 let g:NeoComplCache_SkipInputTime = &#x27;0.5&#x27; let g:NeoComplCache_SnippetsDir = $VIMFILES.&#x27;/snippets&#x27; &quot; &lt;TAB&gt; completion. inoremap &lt;expr&gt;&lt;TAB&gt; pumvisible() ? &quot;\\&lt;C-n&gt;&quot; : &quot;\\&lt;TAB&gt;&quot; &quot; snippets expand key imap &lt;silent&gt; &lt;C-e&gt; &lt;Plug&gt;(neocomplcache_snippets_expand) smap &lt;silent&gt; &lt;C-e&gt; &lt;Plug&gt;(neocomplcache_snippets_expand) &quot;----------------------------------------------------------------- &quot; plugin - matchit.vim å¯¹%å‘½ä»¤è¿›è¡Œæ‰©å±•ä½¿å¾—èƒ½åœ¨åµŒå¥—æ ‡ç­¾å’Œè¯­å¥ä¹‹é—´è·³è½¬ &quot; % æ­£å‘åŒ¹é… g% åå‘åŒ¹é… &quot; [% å®šä½å—é¦– ]% å®šä½å—å°¾ &quot;----------------------------------------------------------------- &quot;----------------------------------------------------------------- &quot; plugin - vcscommand.vim å¯¹%å‘½ä»¤è¿›è¡Œæ‰©å±•ä½¿å¾—èƒ½åœ¨åµŒå¥—æ ‡ç­¾å’Œè¯­å¥ä¹‹é—´è·³è½¬ &quot; SVN/gitç®¡ç†å·¥å…· &quot;----------------------------------------------------------------- &quot;----------------------------------------------------------------- &quot; plugin â€“ a.vim &quot;----------------------------------------------------------------- &quot;--------------------------------------------- &quot;å®šä¹‰å‡½æ•°SetTitleï¼Œè‡ªåŠ¨æ’å…¥æ–‡ä»¶å¤´ func SetTitle() if &amp;filetype == &#x27;c&#x27; call setline(1, &quot;#include &lt;stdio.h&gt;&quot;) call setline(2, &quot;#include &lt;stdlib.h&gt;&quot;) call setline(3, &quot;&quot;) call setline(4, &quot;int main() &#123;&quot;) elseif &amp;filetype == &#x27;cpp&#x27; call setline(1, &quot;#include &lt;iostream&gt;&quot;) call setline(2, &quot;&quot;) call setline(3, &quot;int main() &#123;&quot;) elseif &amp;filetype == &#x27;sh&#x27; call setline(1, &quot;#!/bin/bash&quot;) call setline(2, &quot;&quot;) elseif &amp;filetype == &#x27;py&#x27; call setline(1, &quot;#!coding:utf-8&quot;) call setline(2, &quot;&quot;) endif endfunc set completeopt=longest,menu &quot;æ–°å»º.c,.h,.sh,.javaæ–‡ä»¶ï¼Œè‡ªåŠ¨æ’å…¥æ–‡ä»¶å¤´ autocmd BufNewFile *.[ch],*.sh,*.cpp,*.java exec &quot;:call SetTitle()&quot; &quot;--------------------------------------------- &quot;å®šä¹‰CompileRunå‡½æ•°ï¼Œç”¨æ¥è°ƒç”¨è¿›è¡Œç¼–è¯‘å’Œè¿è¡Œ func! CompileRun() exec &quot;w&quot; &quot;Cç¨‹åº if &amp;filetype == &#x27;c&#x27; exec &quot;!gcc % -g -o %&lt;.exe&quot; exec &quot;! ./%&lt;.exe&quot; elseif &amp;filetype == &#x27;cpp&#x27; exec &quot;!g++ % -g -o %&lt;&quot; exec &quot;! ./%&lt;&quot; &quot;Javaç¨‹åº elseif &amp;filetype == &#x27;java&#x27; exec &quot;!javac %&quot; exec &quot;!java %&lt;&quot; endif endfunc &quot;ç»“æŸå®šä¹‰CompileRun &quot;------------------------- &quot; ======= ç¼–è¯‘ &amp;&amp; è¿è¡Œ ======= &quot; &quot; ç¼–è¯‘æºæ–‡ä»¶ func! CompileCode() exec &quot;w&quot; if &amp;filetype == &quot;c&quot; exec &quot;!gcc -Wall -std=c99 %&lt;.c -o %&lt;&quot; elseif &amp;filetype == &quot;cpp&quot; exec &quot;!g++ -Wall -std=c++98 %&lt;.cpp -o %&lt;&quot; elseif &amp;filetype == &quot;java&quot; exec &quot;!javac %&lt;.java&quot; endif endfunc &quot; è¿è¡Œå¯æ‰§è¡Œæ–‡ä»¶ func! RunCode() exec &quot;w&quot; if &amp;filetype == &quot;c&quot; || &amp;filetype == &quot;cpp&quot; || &amp;filetype == &quot;haskell&quot; exec &quot;! ./%&lt;&quot; elseif &amp;filetype == &quot;java&quot; exec &quot;!java %&lt;&quot; endif endfunc &quot;--------------------------------------------- &quot; Ctrl + F9 ä¸€é”®ä¿å­˜, ç¼–è¯‘ &quot; Ctrl + F10 ä¸€é”®ä¿å­˜ï¼Œè¿è¡Œ &quot; F9 ç¼–è¯‘ + è¿è¡Œ &quot; F10 Debug map&lt;C-F9&gt;:call CompileCode()&lt;CR&gt; imap&lt;C-F9&gt; &lt;ESC&gt;:call CompileCode()&lt;CR&gt; vmap&lt;C-F9&gt; &lt;ESC&gt;:call CompileCode()&lt;CR&gt; map&lt;C-F10&gt;:call RunCode()&lt;CR&gt; imap&lt;C-F10&gt; &lt;ESC&gt;:call RunCode()&lt;CR&gt; vmap&lt;C-F10&gt; &lt;ESC&gt;:call RunCode()&lt;CR&gt; map&lt;F9&gt;:call CompileRun()&lt;CR&gt; imap&lt;F9&gt; &lt;ESC&gt;:call CompileRun()&lt;CR&gt; vmap &lt;F9&gt; &lt;ESC&gt;:call CompileRun()&lt;CR&gt; &quot; &quot;set mouse=v &quot; é¼ æ ‡æ”¯æŒ","categories":[{"name":"devops","slug":"devops","permalink":"http://iequa.com/categories/devops/"}],"tags":[{"name":"vimrc","slug":"vimrc","permalink":"http://iequa.com/tags/vimrc/"}]},{"title":"Macos High Sierra 10.13 Work Environment Install","slug":"devops/ops-mac10.13-install-env","date":"2017-10-02T23:08:21.000Z","updated":"2019-10-20T04:30:34.989Z","comments":true,"path":"2017/10/03/devops/ops-mac10.13-install-env/","link":"","permalink":"http://iequa.com/2017/10/03/devops/ops-mac10.13-install-env/","excerpt":"Enable Dragging With Three Finger : System Preferences -&gt; Accessibility -&gt; Mouse &amp; Trackpad -&gt; Trackpad Options.","text":"Enable Dragging With Three Finger : System Preferences -&gt; Accessibility -&gt; Mouse &amp; Trackpad -&gt; Trackpad Options. 1. Common Soft Chrome NeteaseMusic Baiduyun &amp; Aira2GUI Microsoft_Office_2016_15.38.17090200_Installer.pkg Google Chrome is up to dateVersion 61.0.3163.100 (Official Build) (64-bit) ç™¾åº¦äº‘ç ´è§£é™é€Ÿ (Aria2GUI + chrome plugin) Evernote å›½é™…ç‰ˆä¸å›½å†…ç‰ˆåˆ†å¼€ç®¡ç†çš„. 2. Dev Tools2.1 general dev tool Macdown Alfred Atom SubLime Text Homebrew Iterm2 Oh-my-zsh PyCharm &amp; IDEA GNU_Octave_3.8.0-6.dmg brew (install è¿‡ç¨‹ä¼šè‡ªåŠ¨éœ€è¦ Xcode è¢«å®‰è£…)brew install wget tree wget https://bootstrap.pypa.io/get-pip.py sudo python get-pip.py 2.2 iterm &amp; zshIterm2 Change Font Iterm2 -&gt; Preference -&gt; Profiles -&gt; Text -&gt; Change Font -&gt; 17pt Courier New Bold Iterm2 Hide scrollbars And title bar Preference -&gt; Appearance å–æ¶ˆ show per-pane title bar with split panes.å‹¾é€‰ Hide scrollbars Iterm2 Color Presets Iterm2 -&gt; Preference -&gt; Profiles -&gt; Color -&gt; Color Presets -&gt; your_theme maybe Atom, Brogrammer, Darkside Zsh astro theme oh-my-zsh è‡ªå¸¦ git æ’ä»¶ï¼Œé‡Œé¢çš„é’ˆå¯¹git çš„åˆ«åè®¾ç½®è§: âœ &gt;vim .oh-my-zsh/plugins/git/git.plugin.zsh oh-my-zsh autojump plugin install brew install autojump vim .zshrc plugins=(git autojump)[[ -s $(brew --prefix)/etc/profile.d/autojump.sh ]] &amp;&amp; . $(brew --prefix)/etc/profile.d/autojump.sh then, source ~/.zshrc Reference Article Iterm2-color-schemesIterm-colorsZsh astro themeä½¿ç”¨ Zsh çš„åå¤§ä¼˜ç‚¹.oh-my-zshé…ç½®ä½ çš„zshæé«˜shellé€¼æ ¼ç»ˆæé€‰æ‹©.æ‰“é€ é«˜æ•ˆä¸ªæ€§Terminalï¼ˆä¸€ï¼‰ä¹‹ iTerm.æ‰“é€ é«˜æ•ˆä¸ªæ€§Terminalï¼ˆäºŒï¼‰ä¹‹ zsh.Macä¸‹çš„æ•ˆç‡å·¥å…·autojump 2.3 ssh config ssh-keygen -t rsa -C â€œyour-company-email-full-addressâ€ ~/.ssh/id_rsa.pub ç²˜è´´åˆ°è¿ç»´å¹³å° mac iterm2 ssh è·³è½¬å¤±è´¥, è§£å†³åŠæ³• : (1) æ–°å»ºå¹¶ç¼–è¾‘ .ssh/config, å¹¶å¤åˆ¶ä»¥ä¸‹å†…å®¹åˆ° configæ–‡ä»¶ä¸­ Host * ForwardAgent yes PasswordAuthentication yes StrictHostKeyChecking no HashKnownHosts yes Compression yes (2) cd ï½/.ssh, å¹¶åœ¨ terminal ä¸­æ‰§è¡Œ ssh-add 2.4 navicat for MySQL Encoding è®¾ç½®ä¸º utf-8 åˆ™ï¼ŒæŸ¥è¯¢æ•°æ®åº“ï¼Œæ±‰å­—ä¹±ç ï¼Œæ”¹ä¸º Auto è§£å†³ã€‚ 3. Java JDK Maven Tomcat Scala Spark âœ software pwd/usr/local/xsoft/softwareâœ software lltotal 0lrwxr-xr-x apache-maven -&gt; /usr/local/xsoft/deploy/apache-maven-3.3.9lrwxr-xr-x apache-tomcat -&gt; /usr/local/xsoft/deploy/apache-tomcat-7.0.59lrwxr-xr-x scala -&gt; /usr/local/xsoft/deploy/scala-2.11.7lrwxr-xr-x spark -&gt; /usr/local/xsoft/deploy/spark-1.6.3-bin-hadoop2.6âœ software 4. Blog hexo Install Node.js $ wget -qO- https://raw.githubusercontent.com/creationix/nvm/v0.33.2/install.sh | bash Once nvm is installed, restart the terminal and run the following command to install Node.js: $ nvm install v4.1.0$ npm install -g hexo-cli v4.1.0 æ›´åˆé€‚ hexo 5. Python5.1 this mac install pipPython pip , sudo python get-pip.py then, terminal input pip list. If exist warning: DEPRECATION: The default format will switch to columns in the future. You can use â€”format=(legacy|columns) (or define a format=(legacy|columns) in your pip.conf under the [list] section) to disable this warning. solve this warning: ~.vim ~/.pip/pip.conf[list]format=columns 5.2 pyenv install packageFirst, you need to install python pyenv environment Python 3.6.3(vpy3)âœpip install numpypip install scipypip install matplotlibpip install pandaspip install xlrdpip install xlwtpip install StatsModelspip install scikit-learnpip install jiebapip install --upgrade gensim pip install elasticsearch==1.9 ipython pip install ipython ç„¶å, å¦‚ terminall input ipython ä¸å­˜åœ¨, åˆ™ pip show ipython, python -m IPython è¯•è¯•. notebook #pip install --ignore-installed six#pip install target-gsheet tap-fixeriopip install notebook pip install notebook, å¦‚ macos High Sierra 10.13 æŠ¥é”™ï¼Œåˆ™pip install â€”ignore-installed sixpip install target-gsheet tap-fixeriothen, pip install notebook 8. Reference Homebrew Get-pip IntelliJã€Pycharmæ¿€æ´» Mac OSX å®‰è£JDK Hexo Doc Mac ä¸Šå®Œæ•´å¸è½½Node.js Mac OSX å®Œæ•´å¸è½½Node.js nodeç‰ˆæœ¬ç®¡ç†å·¥å…·nvm-Macä¸‹å®‰è£…åŠä½¿ç”¨ XClient.info Mac App Stackoverflow python on MacOS 10.10 - command not found Blair python install data mining env Macos NSNavRecentPlaces å†…éƒ¨è‡ªåŠ¨ç”Ÿæˆçš„é…ç½®ï¼Œåˆ«ä¹±æ”¹ã€‚ defaults write -g NSNavRecentPlaces â€˜(â€œ~/Desktopâ€, â€œ/usr/local/xsoft/softwareâ€)â€™;","categories":[{"name":"devops","slug":"devops","permalink":"http://iequa.com/categories/devops/"}],"tags":[{"name":"macos","slug":"macos","permalink":"http://iequa.com/tags/macos/"}]},{"title":"Singapore IT environment","slug":"tools/news-Singapore-for-it","date":"2017-09-25T13:15:21.000Z","updated":"2019-10-20T04:30:34.996Z","comments":true,"path":"2017/09/25/tools/news-Singapore-for-it/","link":"","permalink":"http://iequa.com/2017/09/25/tools/news-Singapore-for-it/","excerpt":"æœ¬æ–‡ç®€çŸ­ä»‹ç»äº†ä¸‹ Singapore çš„ä¸€äº› IT å…¬å¸çš„æƒ…å†µ","text":"æœ¬æ–‡ç®€çŸ­ä»‹ç»äº†ä¸‹ Singapore çš„ä¸€äº› IT å…¬å¸çš„æƒ…å†µ 1. Mozat mozatè‡´åŠ›äºç§»åŠ¨ç«¯ç¤¾äº¤åº”ç”¨å’Œæ¸¸æˆåº”ç”¨ï¼Œä¸æ–­ç ”å‘åˆ›æ–°ã€‚ 2. Garena æ¸¸æˆèµ·å®¶çš„ç»¼åˆäº’è”ç½‘å…¬å¸ï¼Œä¼°å€¼è¾¾37.5äº¿ç¾é‡‘ 3. Carousell é—²é±¼ 4. Grabtaxi (è·å¾—æ»´æ»´ã€è½¯é“¶6äº¿ç¾é‡‘æŠ•èµ„) 5. iCarsClub æ±½è½¦å€Ÿç§ŸiCarClub(7050ä¸‡ç¾å…ƒï¼‰ é‰´äºæ–°åŠ å¡çš„è½¦ä¸»å¤§éƒ½åœ¨è‡ªå®¶è½¦ä¸ŠèŠ±è´¹äº†å¤§æŠŠå¤§æŠŠçš„é’ç¥¨ï¼Œå¯¹ç­‰ç§å®¶è½¦ç§Ÿèµè¿™ä¸ªæƒ³æ³•ä¹Ÿå°±åº”è¿è€Œç”Ÿäº†ã€‚ 6. Reebonz(4000ä¸‡ç¾å…ƒ)å½“æåˆ°æ–°åŠ å¡æœ¬åœ°çš„ç”µå­å•†åŠ¡ç½‘åº—æ—¶ï¼Œé™¤äº†ä¸Šè¿°æåˆ°çš„å—Rocket Internetå…¬å¸ååŠ©çš„ä¸¤å®¶ç”µå­å•†åŠ¡é›¶å”®å•†ä»¥å¤–ï¼Œæœ€å‡ºååº”è¯¥å°±æ˜¯Reebonzã€‚å®ƒå’Œå…¶ä»–çš„ç”µå­å•†åŠ¡ç½‘åº—ä¸åŒçš„æ˜¯å®ƒåªå…³æ³¨å¥¢ä¾ˆå“ç‰Œã€‚Reebonz åœ¨2014å¹´3æœˆæ”¶è´­äº†æ–°åŠ å¡çš„åœ¨çº¿å¥¢ä¾ˆå“å•†åº—Clout Shoppeï¼Œæ‰©å¤§äº†è‡ªå·±çš„è§„æ¨¡ã€‚ 7. MyRepublicï¼ˆ3750ä¸‡ç¾å…ƒï¼‰ MyRepublicä¹Ÿè®¸æ˜¯è¿™åå®¶å…¬å¸ä¸­æœ€æœ‰é‡å¿ƒçš„å…¬å¸ï¼šå®ƒæƒ³æˆä¸ºæ–°åŠ å¡ç¬¬å››å¤§ç”µä¿¡å…¬å¸ã€‚å®ƒä¸æ»¡è¶³åªæ˜¯ä¸€å®¶æœ¬åœ°çš„å¤§å…¬å¸ï¼Œæ‰€ä»¥æœ€è¿‘è¯¥å…¬å¸ä¸ºæ–°è¥¿å…°ç”¨æˆ·æä¾›ä¸‰ä¸ªæœˆå…è´¹çš„100å…†ä½/ç§’çš„è¶…é€Ÿå…‰çº¤å®½å¸¦ã€‚æˆ‘ä»¬è¿˜äº†è§£åˆ°ï¼Œè¿™å®¶ç”µä¿¡åˆåˆ›ä¼ä¸šåœ¨ä¸€ä¸ªæœˆå†…å°±å¸å¼•äº†å¤§çº¦2000åæ–°ç”¨æˆ·;ä¸å°±çš„å°†æ¥ï¼Œå®ƒçš„å¹´æ”¶å…¥ä¼šæ˜¯2014å¹´ä¸‰å€ï¼Œè¾¾åˆ°1500ä¸‡ç¾å…ƒã€‚2015å¹´ï¼ŒMyRepublicå°†ä¼šæ‰“å…¥äºšæ´²çš„å…¶å®ƒå›½å®¶ã€‚ 8. Bubbly(3900ä¸‡ç¾å…ƒ) å¯¹äºBubblyå…¬å¸æ¥è¯´ï¼Œä¹Ÿè®¸å®ƒæœ€æƒ³å¿˜è®°çš„å°±æ˜¯2014å¹´çš„ä¸ŠåŠå¹´ã€‚åœ¨é‚£æ®µæ—¶é—´ï¼Œç¤¾äº¤ç½‘ç»œåª’ä½“åˆåˆ›ä¼ä¸šBubblyæ”¶åˆ°äº†å„å¼å„æ ·çš„æ”¶è´­è¯·æ±‚;å¹¶ä¸”ï¼Œè¯¥å…¬å¸è§£æ•£äº†å…¬å¸çš„ç®¡ç†å›¢é˜Ÿï¼Œè¿˜è¾¾æˆä¸€è‡´åè®®å¯¹å…¬å¸è¿›è¡Œé‡ç»„ã€‚å…¬å¸çš„é¦–å¸­æ‰§è¡Œå®˜Thomas Claytonå¼€å§‹æŠŠå…¬å¸èµ„äº§æ¸…ç®—ï¼Œå‡ å‘¨ä¹‹åï¼ŒBubblyå…¬å¸å°±è¢«Altruist Groupæ”¶è´­ï¼Œè¯¥é›†å›¢åœ¨æ¬§æ´²ã€éæ´²å’Œäºšæ´²æä¾›ç”µä¿¡æœåŠ¡ï¼Œä¸è¿‡è¿™æ¬¡æ”¶è´­çš„æ¡æ¬¾æ²¡æœ‰å¯¹å¤–æŠ«éœ²ã€‚ 9. Ninja vanæˆç«‹äº2014å¹´çš„ã€Œæœ€åä¸€å…¬é‡Œç‰©æµã€å…¬å¸ Ninja Van ä¸¤å¹´å†…å°±æ‹¿åˆ°äº†ä¸¤è½®èèµ„ï¼Œè¿™å®¶æŠ€æœ¯é©±åŠ¨å‹å…¬å¸ä½¿ç”¨ç®—æ³•æ¥æä¾›æœ€å¥½çš„ç‰©æµè·¯çº¿å¹¶å®æ—¶è¿½è¸ªè®¢å•ï¼Œä¸ä»…è§£å†³äº†å½“åœ°ç”µå•†ç½‘ç«™è´§å“å¸¸å¸¸ä¸¢å¤±çš„é—®é¢˜ï¼Œè¿˜é€šè¿‡æŠ€æœ¯æ‰‹æ®µæé«˜äº†ç‰©æµé…é€æ•ˆç‡ã€‚ 10. LazadaLazadaï¼Œä¸œå—äºšåœ°åŒºæœ€å¤§çš„åœ¨çº¿è´­ç‰©ç½‘ç«™ä¹‹ä¸€ã€‚è·å¾—å¾·å›½åˆ›ä¸šå­µåŒ–å™¨RocketInternetæ¡‘å¨å°”å…„å¼Ÿ(SamwerBrothers)æ”¯æŒï¼ŒLazadaçš„ç›®æ ‡ä¸»è¦æ˜¯å°å°¼ã€é©¬æ¥è¥¿äºšã€è²å¾‹å®¾ä»¥åŠæ³°å›½ç”¨æˆ·ã€‚ 11. ZaloraZALORAæ˜¯ä¸€ä¸ªç½‘ä¸Šæ—¶è£…åŠç¾å®¹äº§å“è´­ç‰©å¹³å°,ä¸ºç”·å¥³é¡¾å®¢æä¾›æ—¶è£…ã€é¥°ç‰©ã€é‹å±¥åŠåŒ–å¦†æŠ¤è‚¤å“ã€‚æ€»éƒ¨ä½äºæ–°åŠ å¡çš„ZALORAäºä¸åŒåœ°åŒºè®¾æœ‰åˆ†åŒºç½‘é¡µ,åŒ…æ‹¬é¦™æ¸¯ã€æ–°åŠ å¡ã€å°å°¼ã€è²å¾‹å®¾ã€æ³°å›½ã€è¶Šå—ã€é©¬æ¥è¥¿äºšåŠæ–‡è±ï¼Œåˆ°ç›®å‰ä¸ºæ­¢Zaloraå·²ç»è·å¾—äº†æ‹¥æœ‰å¤§é‡æŠ•èµ„è€…çš„é’çã€‚ Zaloraçš„æ¯å…¬å¸äº2014å¹´ä¸Šå¸‚ï¼Œè¯¥å…¬å¸çš„æœ€æ–°è®¡åˆ’æ˜¯å’Œä¸Šè¿°æåˆ°çš„é¡¹ç›®Rocket Internetæ——ä¸‹å¦å¤–å››å®¶æµè¡Œçš„æ—¶å°šå“ç‰Œå…¬å¸åˆå¹¶ï¼Œè¿™æ ·ä¸€æ¥ä¾¿å¯æˆä¸ºå…¨çƒçš„æ—¶å°šå›¢é˜Ÿã€‚Rocket Intetrnetçš„é¦–æ¬¡å…¬å¼€å‹Ÿè‚¡ä¾¿è·å¾—äº†82äº¿ç¾å…ƒï¼Œè¿™å°±æ„å‘³ç€ä¸ä¹…å°±ä¼šæœ‰è¶Šæ¥è¶Šå¤šçš„èµ„é‡‘æµå…¥Zaloraã€‚ 2.38äº¿ç¾å…ƒ 12. ViSenzeè§†è§‰æœç´¢å’Œå›¾åƒè¯†åˆ«çš„å…¬å¸ (äº§å“ä¸»è¦æœåŠ¡Rakutenï¼ŒZaloraç­‰ç”µå•†çš„æ¨èå¼•æ“å’Œæ‰‹æœºæœç´¢åº”ç”¨) ViSenzeæ˜¯ä¸€å®¶éå¸¸é‡è§†æŠ€æœ¯å‘å±•çš„å…¬å¸ï¼ŒæŠ€æœ¯å›¢é˜Ÿå†…éƒ¨ä¼šä¸å®šæœŸä¸¾è¡ŒæŠ€æœ¯åˆ†äº«ä¼šå’Œæ·±åº¦è®­ç»ƒã€‚ 13. Wegoï¼ˆ3450ä¸‡ç¾å…ƒï¼‰ 2013å¹´ï¼Œæ—…æ¸¸æœç´¢å…¬å¸Wegoå®£ç§°ï¼Œåœ¨å…¶æä¾›æœåŠ¡çš„52ä¸ªå¸‚åœºä¸Šï¼Œæ¯å¤©èµ·ç æœ‰1000ä¸‡ä¸ªæ½œåœ¨é¢„çº¦å®¢æˆ·ã€‚è¯¥å…¬å¸äº2014å¹´ä¸­æ—¬æ¨å‡ºäº†è‡ªå·±çš„iOSåº”ç”¨å’ŒAndroidåº”ç”¨ï¼Œå¾ˆå¿«è¿™æ¬¾åº”ç”¨çš„ä¸‹è½½é‡å°±å±…å°å°¼iOSåº”ç”¨å•†åº—ä¸‹è½½é‡æ’è¡Œæ¦œçš„æ¦œé¦–ã€‚ 14. ViKiï¼ˆ2430ä¸‡ç¾å…ƒï¼‰ è§†é¢‘èšåˆç½‘å¯¹äºæ–°åŠ å¡äººè€Œè¨€ï¼Œè¿™ä¸ªç‰¹åˆ«çš„ä¼—åŒ…è§†é¢‘å­—å¹•ç½‘ç«™ï¼Œæ˜¯ç†Ÿæ‚‰åˆ°ä¸èƒ½å†ç†Ÿæ‚‰çš„æ—¥å¸¸æµè§ˆç½‘ç«™ä¹‹ä¸€ã€‚Vikiæ˜¯2013å¹´å¯¹æ–°åŠ å¡å…¬å¸è¿›è¡Œå¤§å‹æ”¶è´­ä¸­çš„ç’€ç’¨ä¹‹æ˜Ÿï¼Œå› ä¸ºæ—¥æœ¬ç”µå•†å·¨å¤´Rakutenä»¥2äº¿ç¾å…ƒçš„ä»·æ ¼æ”¶è´­äº†Vikiã€‚ä¸€å¹´åï¼Œæœ‰å…³æŠ¥é“ç§°Vikiæ¯ä¸ªæœˆæ´»è·ƒçš„ç”¨æˆ·æœ‰3500ä¸‡ï¼Œå¦å¤–è¿˜æœ‰2500ä¸‡ç§»åŠ¨ç”¨æˆ·;ä¸è¯¥å…¬å¸è¢«æ”¶è´­ä¹‹æ—¶ç›¸æ¯”ï¼Œæ¯æœˆæ´»è·ƒç”¨æˆ·å¢é•¿äº†1300ä¸‡ï¼Œç§»åŠ¨ç”¨æˆ·å¢é•¿äº†1500ä¸‡ã€‚ 15. Neo Innovation16. Migmeï¼ˆ3460ä¸‡ç¾å…ƒï¼‰ åœ¨è¿‡å»çš„2014å¹´é‡Œï¼Œç¤¾äº¤å¨±ä¹å¹³å°Migmeçš„å‘å±•æ˜¯å€¼å¾—ä¸€æçš„ã€‚è‡ªå»å¹´çš„å…«æœˆä»¥æ¥ï¼Œå®ƒå®Œæˆäº†å‡ é¡¹é‡è¦çš„æ”¶è´­.12æœˆï¼ŒMigmeæ‹¥æœ‰è¶…è¿‡900ä¸‡çš„MAUã€‚è¯¥å…¬å¸çš„ç›®æ ‡æ˜¯ä¸ºäº†è®©å®¢æˆ·ä½“éªŒæ›´å¥½ç©çš„ç¤¾äº¤åŒ–ç”µå­å•†åŠ¡ã€‚å…¬å¸çš„é¦–å¸­æ‰§è¡Œå®˜Steven Gohçš„æ„¿æœ›æ˜¯å»ºç«‹ä¸€ä¸ªåƒä¸­å›½æ·˜å®ç½‘é‚£æ ·çš„é¡¾å®¢å¯¹é¡¾å®¢çš„å•†ä¸šæ¨¡å¼ã€‚ 17. PropertyGuruå´æœ‰å¹¸ç‹¬å é³Œå¤´ã€‚æœ€è¿‘ï¼Œhttp://99.coå…¬å¸åŠ å…¥æ–°åŠ å¡æˆ¿åœ°äº§å¸‚åœºï¼Œæˆä¸ºäº†PropertyGuruæœ€æ–°çš„ç«äº‰å¯¹æ‰‹ã€‚ 18. Redmart https://redmart.com/","categories":[{"name":"tools","slug":"tools","permalink":"http://iequa.com/categories/tools/"}],"tags":[{"name":"Singapore","slug":"Singapore","permalink":"http://iequa.com/tags/Singapore/"}]},{"title":"Naive Bayes * æ–‡æœ¬åˆ†ç±»","slug":"ml/naive-bayes-2","date":"2017-08-22T23:08:21.000Z","updated":"2019-10-20T04:30:35.045Z","comments":true,"path":"2017/08/23/ml/naive-bayes-2/","link":"","permalink":"http://iequa.com/2017/08/23/ml/naive-bayes-2/","excerpt":"æœ´ç´ è´å¶æ–¯ï¼Œé€‚ç”¨äºæ–°é—»åˆ†ç±»é—®é¢˜ p(x)p(y|x) = p(y)p(x|y)","text":"æœ´ç´ è´å¶æ–¯ï¼Œé€‚ç”¨äºæ–°é—»åˆ†ç±»é—®é¢˜ p(x)p(y|x) = p(y)p(x|y) 1. è´å¶æ–¯ç†è®ºç®€å•å›é¡¾åœ¨æˆ‘ä»¬æœ‰ä¸€å¤§å †æ ·æœ¬ï¼ˆåŒ…å«ç‰¹å¾å’Œç±»åˆ«ï¼‰çš„æ—¶å€™ï¼Œæˆ‘ä»¬éå¸¸å®¹æ˜“é€šè¿‡ç»Ÿè®¡å¾—åˆ° $p(ç‰¹å¾|ç±»åˆ«)$.å¤§å®¶åˆéƒ½å¾ˆç†Ÿæ‚‰ä¸‹è¿°å…¬å¼ï¼š p(x)p(y|x) = p(y)p(x|y)æ‰€ä»¥åšä¸€ä¸ªå°å°çš„å˜æ¢ p(ç‰¹å¾)p(ç±»åˆ«|ç‰¹å¾) = p(ç±»åˆ«)p(ç‰¹å¾|ç±»åˆ«) p(ç±»åˆ«|ç‰¹å¾) = \\frac{p(ç±»åˆ«)p(ç‰¹å¾|ç±»åˆ«)}{p(ç‰¹å¾)}2. ç‹¬ç«‹å‡è®¾çœ‹èµ·æ¥å¾ˆç®€å•ï¼Œä½†å®é™…ä¸Šï¼Œä½ çš„ç‰¹å¾å¯èƒ½æ˜¯å¾ˆå¤šç»´çš„ p(features|class) = p({f_0, f_1, \\ldots ,f_n}|c)å°±ç®—æ˜¯2ä¸ªç»´åº¦å§ï¼Œå¯ä»¥ç®€å•å†™æˆ p({f_0, f_1}|c) = p(f_1|c, f_0)p(f_0|c)åŠ ä¸€ä¸ªç‰›é€¼çš„å‡è®¾ï¼šç‰¹å¾ä¹‹é—´æ˜¯ç‹¬ç«‹çš„ p({f_0, f_1}|c) = p(f_1|c)p(f_0|c)å…¶å®ä¹Ÿå°±æ˜¯ï¼š p({f_0, f_1, \\ldots, f_n}|c) = \\Pi^n_i p(f_i|c)3. è´å¶æ–¯åˆ†ç±»å™¨å…¶å®æˆ‘ä»¬å°±æ˜¯å¯¹æ¯ä¸ªç±»åˆ«è®¡ç®—ä¸€ä¸ªæ¦‚ç‡ $p(ci)$ ï¼Œç„¶åå†è®¡ç®—æ‰€æœ‰ç‰¹å¾çš„æ¡ä»¶æ¦‚ç‡ $p(f_j|c_i)$ ï¼Œé‚£ä¹ˆåˆ†ç±»çš„æ—¶å€™æˆ‘ä»¬å°±æ˜¯ä¾æ®è´å¶æ–¯æ‰¾ä¸€ä¸ªæœ€å¯èƒ½çš„ç±»åˆ«ï¼š p(class\\_i|{f\\_0, f\\_1, \\ldots, f\\_n})= \\frac{p(class\\_i)}{p({f\\_0, f\\_1, \\ldots, f\\_n})} \\Pi^n\\_j p(f\\_j|c\\_i)4. æ–‡æœ¬åˆ†ç±»é—®é¢˜","categories":[{"name":"machine-learning","slug":"machine-learning","permalink":"http://iequa.com/categories/machine-learning/"}],"tags":[{"name":"Bayes","slug":"Bayes","permalink":"http://iequa.com/tags/Bayes/"}]},{"title":"TensorFlow Why?","slug":"tensorflow/tf-1.1-why","date":"2017-08-22T05:17:21.000Z","updated":"2019-10-20T04:30:35.065Z","comments":true,"path":"2017/08/22/tensorflow/tf-1.1-why/","link":"","permalink":"http://iequa.com/2017/08/22/tensorflow/tf-1.1-why/","excerpt":"2015.10 å¼€æºçš„ TensorFlow æ˜¯ç”± Google brain çš„å·¥ç¨‹å¸ˆå¼€å‘å‡ºæ¥ï¼Œç”¨äºæœºå™¨å­¦ä¹ å’Œç¥ç»ç½‘ç»œæ–¹é¢çš„ç ”ç©¶","text":"2015.10 å¼€æºçš„ TensorFlow æ˜¯ç”± Google brain çš„å·¥ç¨‹å¸ˆå¼€å‘å‡ºæ¥ï¼Œç”¨äºæœºå™¨å­¦ä¹ å’Œç¥ç»ç½‘ç»œæ–¹é¢çš„ç ”ç©¶ TensorFlow æ˜¯ä¸€æ¬¾ç¥ç»ç½‘ç»œçš„ Python å¤–éƒ¨çš„ç»“æ„åŒ…, ä¹Ÿæ˜¯ä¸€ä¸ªé‡‡ç”¨æ•°æ®æµå›¾æ¥è¿›è¡Œæ•°å€¼è®¡ç®—çš„å¼€æºè½¯ä»¶åº“. 1. TensorFlow WhyTensorFlow æ“…é•¿çš„ä»»åŠ¡å°±æ˜¯è®­ç»ƒæ·±åº¦ç¥ç»ç½‘ç»œ. ä½¿ç”¨å®ƒæˆ‘ä»¬å°±å¯ä»¥å¤§å¤§é™ä½æ·±åº¦å­¦ä¹ çš„å¼€å‘æˆæœ¬å’Œå¼€å‘éš¾åº¦; TensorFlow æ¶æ„çµæ´»ï¼Œæ”¯æŒå„ç§å¼‚æ„çš„å¹³å°ï¼Œæ”¯æŒå¤šCPU/GPUï¼Œ èƒ½å¤Ÿæ”¯æŒå„ç§ç½‘ç»œæ¨¡å‹ï¼Œå…·æœ‰è‰¯å¥½çš„é€šç”¨æ€§; TensorFlow ç”¨æˆ·å¯ä»¥æ–¹ä¾¿åœ°ç”¨å®ƒè®¾è®¡ Neural Network ç»“æ„ï¼Œè€Œä¸å¿…äº²è‡ªå†™ C++æˆ– CUDA ä»£ç ã€‚æ”¯æŒè‡ªåŠ¨æ±‚å¯¼ï¼Œç”¨æˆ·ä¸éœ€è¦å†é€šè¿‡åå‘ä¼ æ’­æ±‚è§£æ¢¯åº¦ã€‚ 2. TF.Learn å’Œ TF.Slim ä¸Šå±‚ç»„ä»¶TensorFlow å†…ç½®çš„ TF.Learn å’Œ TF.Slim ç­‰ä¸Šå±‚ç»„ä»¶å¯ä»¥å¸®åŠ©å¿«é€Ÿåœ°è®¾è®¡æ–°ç½‘ç»œï¼Œå¹¶ä¸”å…¼å®¹ Scikit-learn estimator æ¥å£ï¼Œå¯ä»¥æ–¹ä¾¿åœ°å®ç° evaluateã€grid searchã€cross validation ç­‰åŠŸèƒ½ã€‚ åŒæ—¶ TensorFlow ä¸åªå±€é™äºç¥ç»ç½‘ç»œï¼Œå…¶æ•°æ®æµå¼å›¾æ”¯æŒéå¸¸è‡ªç”±çš„ç®—æ³•è¡¨è¾¾ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥è½»æ¾å®ç°æ·±åº¦å­¦ä¹ ä»¥å¤–çš„æœºå™¨å­¦ä¹ ç®—æ³•ã€‚ 3. DeepLearning Framework Reference tensorflow.org tensorflow.org get_started TensorFlow å’Œ Caffeã€MXNetã€Kerasç­‰å…¶ä»–æ·±åº¦å­¦ä¹ æ¡†æ¶çš„å¯¹æ¯”","categories":[{"name":"tensorflow","slug":"tensorflow","permalink":"http://iequa.com/categories/tensorflow/"}],"tags":[{"name":"tensorflow","slug":"tensorflow","permalink":"http://iequa.com/tags/tensorflow/"}]},{"title":"Naive Bayes * åƒåœ¾é‚®ä»¶åˆ†ç±»","slug":"ml/naive-bayes-1","date":"2017-08-09T23:08:21.000Z","updated":"2019-10-20T04:30:35.037Z","comments":true,"path":"2017/08/10/ml/naive-bayes-1/","link":"","permalink":"http://iequa.com/2017/08/10/ml/naive-bayes-1/","excerpt":"è´å¶æ–¯æ–¹æ³•æ˜¯ä¸€ä¸ªå†å²æ‚ ä¹…ï¼Œæœ‰ç€åšå®çš„ç†è®ºåŸºç¡€çš„æ–¹æ³•ï¼ŒåŒæ—¶å¤„ç†å¾ˆå¤šé—®é¢˜æ—¶ç›´æ¥è€Œåˆé«˜æ•ˆ, å¾ˆå¤šé«˜çº§ NLP æ¨¡å‹ä¹Ÿå¯ä»¥ä»å®ƒæ¼”åŒ–è€Œæ¥ã€‚å› æ­¤ï¼Œå­¦ä¹ è´å¶æ–¯æ–¹æ³•ï¼Œæ˜¯ç ”ç©¶ NLP é—®é¢˜çš„ä¸€ä¸ªéå¸¸å¥½çš„åˆ‡å…¥å£ã€‚","text":"è´å¶æ–¯æ–¹æ³•æ˜¯ä¸€ä¸ªå†å²æ‚ ä¹…ï¼Œæœ‰ç€åšå®çš„ç†è®ºåŸºç¡€çš„æ–¹æ³•ï¼ŒåŒæ—¶å¤„ç†å¾ˆå¤šé—®é¢˜æ—¶ç›´æ¥è€Œåˆé«˜æ•ˆ, å¾ˆå¤šé«˜çº§ NLP æ¨¡å‹ä¹Ÿå¯ä»¥ä»å®ƒæ¼”åŒ–è€Œæ¥ã€‚å› æ­¤ï¼Œå­¦ä¹ è´å¶æ–¯æ–¹æ³•ï¼Œæ˜¯ç ”ç©¶ NLP é—®é¢˜çš„ä¸€ä¸ªéå¸¸å¥½çš„åˆ‡å…¥å£ã€‚ 1. è´å¶æ–¯ P(Y|X)=\\frac{P(X|Y)P(Y)}{P(X)}2. è´å¶æ–¯å…¬å¼è´å¶æ–¯å…¬å¼å°±ä¸€è¡Œï¼š P(Y|X)=\\frac{P(X|Y)P(Y)}{P(X)}å®ƒå…¶å®æ˜¯ç”±ä»¥ä¸‹çš„è”åˆæ¦‚ç‡å…¬å¼æ¨å¯¼å‡ºæ¥ï¼š P(Y,X)=P(Y|X)P(X)=P(X|Y)P(Y)å…¶ä¸­ $P(Y)$ å«åšå…ˆéªŒæ¦‚ç‡ï¼Œ $P(Y|X)$ å«åšåéªŒæ¦‚ç‡ï¼Œ $P(Y,X)$ å«åšè”åˆæ¦‚ç‡ã€‚ 3. æœºå™¨å­¦ä¹ è§†è§’ç†è§£è´å¶æ–¯å…¬å¼æŠŠ $X$ ç†è§£æˆ â€œ$æœ‰æŸ feature$â€æŠŠ $Y$ ç†è§£æˆ â€œ$å±äºæŸç±» label$â€ ä¸€èˆ¬æœºå™¨å­¦ä¹ ä¸ºé¢˜ä¸­éƒ½æ˜¯ $X$ =&gt; ç‰¹å¾, $Y$ =&gt; ç»“æœ å¯¹å§ã€‚ åœ¨æœ€ç®€å•çš„äºŒåˆ†ç±»é—®é¢˜(æ˜¯ä¸å¦åˆ¤å®š)ä¸‹ï¼Œæˆ‘ä»¬å°† $Y$ ç†è§£æˆ $â€œå±äºæŸç±»â€$ çš„æ ‡ç­¾ã€‚äºæ˜¯è´å¶æ–¯å…¬å¼å°±å˜å½¢æˆäº†ä¸‹é¢çš„æ ·å­: P(â€œå±äºæŸç±»â€|â€œå…·æœ‰æŸç‰¹å¾â€)=\\frac{P(â€œå…·æœ‰æŸç‰¹å¾â€|â€œå±äºæŸç±»â€)P(â€œå±äºæŸç±»â€)}{P(â€œå…·æœ‰æŸç‰¹å¾â€)}è€Œæˆ‘ä»¬äºŒåˆ†ç±»é—®é¢˜çš„æœ€ç»ˆç›®çš„å°±æ˜¯è¦åˆ¤æ–­ $P(â€œå±äºæŸç±»â€|â€œå…·æœ‰æŸç‰¹å¾â€)$ æ˜¯å¦å¤§äº1/2å°±å¤Ÿäº†ã€‚è´å¶æ–¯æ–¹æ³•æŠŠè®¡ç®— â€œ$å…·æœ‰æŸç‰¹å¾çš„æ¡ä»¶ä¸‹å±äºæŸç±»$â€ çš„æ¦‚ç‡è½¬æ¢æˆéœ€è¦è®¡ç®— â€œ$å±äºæŸç±»çš„æ¡ä»¶ä¸‹å…·æœ‰æŸç‰¹å¾$â€ çš„æ¦‚ç‡ï¼Œè€Œåè€…è·å–æ–¹æ³•å°±ç®€å•å¤šäº†ï¼Œæˆ‘ä»¬åªéœ€è¦æ‰¾åˆ°ä¸€äº›åŒ…å«å·²çŸ¥ç‰¹å¾æ ‡ç­¾çš„æ ·æœ¬ï¼Œå³å¯è¿›è¡Œè®­ç»ƒã€‚è€Œæ ·æœ¬çš„ç±»åˆ«æ ‡ç­¾éƒ½æ˜¯æ˜ç¡®çš„ï¼Œæ‰€ä»¥è´å¶æ–¯æ–¹æ³•åœ¨æœºå™¨å­¦ä¹ é‡Œå±äºæœ‰ç›‘ç£å­¦ä¹ æ–¹æ³•ã€‚ 4. åƒåœ¾é‚®ä»¶è¯†åˆ«ä¸¾ä¸ªæ —å­ ğŸŒ° æˆ‘ä»¬ç°åœ¨è¦å¯¹é‚®ä»¶è¿›è¡Œåˆ†ç±»ï¼Œè¯†åˆ«åƒåœ¾é‚®ä»¶å’Œæ™®é€šé‚®ä»¶ï¼Œå¦‚æœæˆ‘ä»¬é€‰æ‹©ä½¿ç”¨æœ´ç´ è´å¶æ–¯åˆ†ç±»å™¨ï¼Œé‚£ç›®æ ‡å°±æ˜¯åˆ¤æ–­ $P(â€œåƒåœ¾é‚®ä»¶â€|â€œå…·æœ‰æŸç‰¹å¾â€)$ æ˜¯å¦å¤§äº1/2ã€‚ å‡è®¾æˆ‘ä»¬æœ‰åƒåœ¾é‚®ä»¶å’Œæ­£å¸¸é‚®ä»¶å„1ä¸‡å°ä½œä¸ºè®­ç»ƒé›†ã€‚éœ€è¦åˆ¤æ–­ä»¥ä¸‹è¿™ä¸ªé‚®ä»¶æ˜¯å¦å±äºåƒåœ¾é‚®ä»¶ï¼š â€œæˆ‘å¸å¯åŠç†æ­£è§„å‘ç¥¨ï¼ˆä¿çœŸï¼‰17%å¢å€¼ç¨å‘ç¥¨ç‚¹æ•°ä¼˜æƒ ï¼â€ ä¹Ÿå°±æ˜¯åˆ¤æ–­æ¦‚ç‡ $P(â€œåƒåœ¾é‚®ä»¶â€|â€œæˆ‘å¸å¯åŠç†æ­£è§„å‘ç¥¨ï¼ˆä¿çœŸï¼‰17\\%å¢å€¼ç¨å‘ç¥¨ç‚¹æ•°ä¼˜æƒ ï¼â€)$ æ˜¯å¦å¤§äº1/2ã€‚ P = \\frac{åƒåœ¾é‚®ä»¶ä¸­å‡ºç°è¿™å¥è¯çš„æ¬¡æ•°}{åƒåœ¾é‚®ä»¶ä¸­å‡ºç°è¿™å¥è¯çš„æ¬¡æ•°+æ­£å¸¸é‚®ä»¶ä¸­å‡ºç°è¿™å¥è¯çš„æ¬¡æ•°} å’³å’³ï¼Œæœ‰æœ¨æœ‰å‘ç°ï¼Œè½¬æ¢æˆçš„è¿™ä¸ªæ¦‚ç‡ï¼Œè®¡ç®—çš„æ–¹æ³•ï¼šå°±æ˜¯å†™ä¸ªè®¡æ•°å™¨ï¼Œç„¶å+1 +1 +1ç»Ÿè®¡å‡ºæ‰€æœ‰åƒåœ¾é‚®ä»¶å’Œæ­£å¸¸é‚®ä»¶ä¸­å‡ºç°è¿™å¥è¯çš„æ¬¡æ•°å•Šï¼ï¼ï¼ 5. åˆ†è¯ä¸€ä¸ªå¾ˆæ‚²å“€ä½†æ˜¯å¾ˆç°å®çš„ç»“è®ºï¼šè®­ç»ƒé›†æ˜¯æœ‰é™çš„ï¼Œè€Œå¥å­çš„å¯èƒ½æ€§åˆ™æ˜¯æ— é™çš„ã€‚æ‰€ä»¥è¦†ç›–æ‰€æœ‰å¥å­å¯èƒ½æ€§çš„è®­ç»ƒé›†æ˜¯ä¸å­˜åœ¨çš„ã€‚ æ‰€ä»¥è§£å†³æ–¹æ³•æ˜¯ï¼Ÿ $å¥å­çš„å¯èƒ½æ€§æ— é™ï¼Œä½†æ˜¯è¯è¯­å°±é‚£ä¹ˆäº›$ï¼ï¼æ±‰è¯­å¸¸ç”¨å­—2500ä¸ªï¼Œå¸¸ç”¨è¯è¯­ä¹Ÿå°±56000ä¸ª(ä½ ç»ˆäºæ˜ç™½å°å­¦è¯­æ–‡è€å¸ˆçš„ç”¨å¿ƒè‰¯è‹¦äº†)ã€‚æŒ‰äººä»¬çš„ç»éªŒç†è§£ï¼Œä¸¤å¥è¯æ„æ€ç›¸è¿‘å¹¶ä¸å¼ºæ±‚éå¾—æ¯ä¸ªå­—ã€è¯è¯­éƒ½ä¸€æ ·ã€‚æ¯”å¦‚ $â€œæˆ‘å¸å¯åŠç†æ­£è§„å‘ç¥¨ï¼Œ17%å¢å€¼ç¨å‘ç¥¨ç‚¹æ•°ä¼˜æƒ ï¼â€$ï¼Œè¿™å¥è¯å°±æ¯”ä¹‹å‰é‚£å¥è¯å°‘äº†â€œï¼ˆä¿çœŸï¼‰â€è¿™ä¸ªè¯ï¼Œä½†æ˜¯æ„æ€åŸºæœ¬ä¸€æ ·ã€‚å¦‚æœæŠŠè¿™äº›æƒ…å†µä¹Ÿè€ƒè™‘è¿›æ¥ï¼Œé‚£æ ·æœ¬æ•°é‡å°±ä¼šå¢åŠ ï¼Œè¿™å°±ä¸æ–¹ä¾¿æˆ‘ä»¬è®¡ç®—äº†ã€‚ äºæ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥ä¸æ‹¿å¥å­ä½œä¸ºç‰¹å¾ï¼Œè€Œæ˜¯æ‹¿å¥å­é‡Œé¢çš„è¯è¯­ï¼ˆç»„åˆï¼‰ä½œä¸ºç‰¹å¾å»è€ƒè™‘ã€‚æ¯”å¦‚ â€œ$æ­£è§„å‘ç¥¨$â€ å¯ä»¥ä½œä¸ºä¸€ä¸ªå•ç‹¬çš„è¯è¯­ï¼Œâ€œ$å¢å€¼ç¨$â€ ä¹Ÿå¯ä»¥ä½œä¸ºä¸€ä¸ªå•ç‹¬çš„è¯è¯­ç­‰ç­‰ã€‚ å¥å­â€œæˆ‘å¸å¯åŠç†æ­£è§„å‘ç¥¨ï¼Œ17%å¢å€¼ç¨å‘ç¥¨ç‚¹æ•°ä¼˜æƒ ï¼â€å°±å¯ä»¥å˜æˆï¼ˆâ€œæˆ‘â€,â€œå¸â€,â€œå¯â€,â€œåŠç†â€,â€œæ­£è§„å‘ç¥¨â€,â€œä¿çœŸâ€,â€œå¢å€¼ç¨â€,â€œå‘ç¥¨â€,â€œç‚¹æ•°â€,â€œä¼˜æƒ â€)ï¼‰ã€‚ äºæ˜¯ä½ æ¥è§¦åˆ°äº†ä¸­æ–‡NLPä¸­ï¼Œæœ€æœ€æœ€é‡è¦çš„æŠ€æœ¯ä¹‹ä¸€ï¼šåˆ†è¯ï¼ï¼ï¼ä¹Ÿå°±æ˜¯æŠŠä¸€æ•´å¥è¯æ‹†åˆ†æˆæ›´ç»†ç²’åº¦çš„è¯è¯­æ¥è¿›è¡Œè¡¨ç¤ºã€‚å¦å¤–ï¼Œåˆ†è¯ä¹‹åå»é™¤æ ‡ç‚¹ç¬¦å·ã€æ•°å­—ç”šè‡³æ— å…³æˆåˆ†(åœç”¨è¯)æ˜¯ç‰¹å¾é¢„å¤„ç†ä¸­çš„ä¸€é¡¹æŠ€æœ¯ã€‚ ä¸­æ–‡åˆ†è¯æ˜¯ä¸€ä¸ªä¸“é—¨çš„æŠ€æœ¯é¢†åŸŸ(æˆ‘ä¸ä¼šå‘Šè¯‰ä½ æŸæœç´¢å¼•æ“å‚ç ç –å·¥æœ‰ä¸“é—¨åšåˆ†è¯çš„ï¼ï¼ï¼) æˆ‘ä»¬è§‚å¯Ÿ$ï¼ˆâ€œæˆ‘â€,â€œå¸â€,â€œå¯â€,â€œåŠç†â€,â€œæ­£è§„å‘ç¥¨â€,â€œä¿çœŸâ€,â€œå¢å€¼ç¨â€,â€œå‘ç¥¨â€,â€œç‚¹æ•°â€,â€œä¼˜æƒ â€)$ï¼Œè¿™å¯ä»¥ç†è§£æˆä¸€ä¸ªå‘é‡ï¼šå‘é‡çš„æ¯ä¸€ç»´åº¦éƒ½è¡¨ç¤ºç€è¯¥ $ç‰¹å¾è¯$ åœ¨æ–‡æœ¬ä¸­çš„ç‰¹å®šä½ç½®å­˜åœ¨ã€‚è¿™ç§å°†ç‰¹å¾æ‹†åˆ†æˆæ›´å°çš„å•å…ƒï¼Œä¾æ®è¿™äº›æ›´çµæ´»ã€æ›´ç»†ç²’åº¦çš„ç‰¹å¾è¿›è¡Œåˆ¤æ–­çš„æ€ç»´æ–¹å¼ï¼Œåœ¨è‡ªç„¶è¯­è¨€å¤„ç†ä¸æœºå™¨å­¦ä¹ ä¸­éƒ½æ˜¯éå¸¸å¸¸è§åˆæœ‰æ•ˆçš„ã€‚ å› æ­¤è´å¶æ–¯å…¬å¼å°±å˜æˆäº†ï¼š P(â€œåƒåœ¾é‚®ä»¶â€|ï¼ˆâ€œæˆ‘â€,â€œå¸â€,â€œå¯â€,â€œåŠç†â€,â€œæ­£è§„å‘ç¥¨â€,â€œä¿çœŸâ€,â€œå¢å€¼ç¨â€,â€œå‘ç¥¨â€,â€œç‚¹æ•°â€,â€œä¼˜æƒ â€)ï¼‰ =\\frac{P(ï¼ˆâ€œæˆ‘â€,â€œå¸â€,â€œå¯â€,â€œåŠç†â€,â€œæ­£è§„å‘ç¥¨â€,â€œä¿çœŸâ€,â€œå¢å€¼ç¨â€,â€œå‘ç¥¨â€,â€œç‚¹æ•°â€,â€œä¼˜æƒ â€)|â€åƒåœ¾é‚®ä»¶â€ï¼‰P(â€œåƒåœ¾é‚®ä»¶â€)}{P(ï¼ˆâ€œæˆ‘â€,â€œå¸â€,â€œå¯â€,â€œåŠç†â€,â€œæ­£è§„å‘ç¥¨â€,â€œä¿çœŸâ€,â€œå¢å€¼ç¨â€,â€œå‘ç¥¨â€,â€œç‚¹æ•°â€,â€œä¼˜æƒ â€)) } P(â€œæ­£å¸¸é‚®ä»¶â€|ï¼ˆâ€œæˆ‘â€,â€œå¸â€,â€œå¯â€,â€œåŠç†â€,â€œæ­£è§„å‘ç¥¨â€,â€œä¿çœŸâ€,â€œå¢å€¼ç¨â€,â€œå‘ç¥¨â€,â€œç‚¹æ•°â€,â€œä¼˜æƒ â€)ï¼‰ =\\frac{P(ï¼ˆâ€œæˆ‘â€,â€œå¸â€,â€œå¯â€,â€œåŠç†â€,â€œæ­£è§„å‘ç¥¨â€,â€œä¿çœŸâ€,â€œå¢å€¼ç¨â€,â€œå‘ç¥¨â€,â€œç‚¹æ•°â€,â€œä¼˜æƒ â€)|â€æ­£å¸¸é‚®ä»¶â€ï¼‰P(â€œæ­£å¸¸é‚®ä»¶â€)}{P(ï¼ˆâ€œæˆ‘â€,â€œå¸â€,â€œå¯â€,â€œåŠç†â€,â€œæ­£è§„å‘ç¥¨â€,â€œä¿çœŸâ€,â€œå¢å€¼ç¨â€,â€œå‘ç¥¨â€,â€œç‚¹æ•°â€,â€œä¼˜æƒ â€)) }6. æ¡ä»¶ç‹¬ç«‹å‡è®¾ä¸‹é¢æˆ‘ä»¬é©¬ä¸Šä¼šçœ‹åˆ°ä¸€ä¸ªéå¸¸ç®€å•ç²—æš´çš„å‡è®¾ã€‚ $P(ï¼ˆâ€œæˆ‘â€,â€œå¸â€,â€œå¯â€,â€œåŠç†â€,â€œæ­£è§„å‘ç¥¨â€,â€œä¿çœŸâ€,â€œå¢å€¼ç¨â€,â€œå‘ç¥¨â€,â€œç‚¹æ•°â€,â€œä¼˜æƒ â€)|â€åƒåœ¾é‚®ä»¶â€ï¼‰$ ä¾æ—§ä¸å¤Ÿå¥½æ±‚ï¼Œæˆ‘ä»¬å¼•è¿›ä¸€ä¸ªå¾ˆæœ´ç´ çš„è¿‘ä¼¼ã€‚ä¸ºäº†è®©å…¬å¼æ˜¾å¾—æ›´åŠ ç´§å‡‘ï¼Œæˆ‘ä»¬ä»¤å­—æ¯ S è¡¨ç¤ºâ€œåƒåœ¾é‚®ä»¶â€,ä»¤å­—æ¯ H è¡¨ç¤ºâ€œæ­£å¸¸é‚®ä»¶â€ã€‚è¿‘ä¼¼å…¬å¼å¦‚ä¸‹ï¼š P(ï¼ˆâ€œæˆ‘â€,â€œå¸â€,â€œå¯â€,â€œåŠç†â€,â€œæ­£è§„å‘ç¥¨â€,â€œä¿çœŸâ€,â€œå¢å€¼ç¨â€,â€œå‘ç¥¨â€,â€œç‚¹æ•°â€,â€œä¼˜æƒ â€)|Sï¼‰ =P(â€œæˆ‘â€|Sï¼‰Ã—P(â€œå¸â€|Sï¼‰Ã—P(â€œå¯â€|Sï¼‰Ã—P(â€œåŠç†â€|Sï¼‰Ã—P(â€œæ­£è§„å‘ç¥¨â€|Sï¼‰ Ã—P(â€œä¿çœŸâ€|Sï¼‰Ã—P(â€œå¢å€¼ç¨â€|Sï¼‰Ã—P(â€œå‘ç¥¨â€|Sï¼‰Ã—P(â€œç‚¹æ•°â€|Sï¼‰Ã—P(â€œä¼˜æƒ â€|S)è¿™å°±æ˜¯ä¼ è¯´ä¸­çš„æ¡ä»¶ç‹¬ç«‹å‡è®¾ã€‚åŸºäºâ€œæ­£å¸¸é‚®ä»¶â€çš„æ¡ä»¶ç‹¬ç«‹å‡è®¾çš„å¼å­ä¸ä¸Šå¼ç±»ä¼¼ï¼Œæ­¤å¤„çœå»ã€‚æ¥ç€ï¼Œå°†æ¡ä»¶ç‹¬ç«‹å‡è®¾ä»£å…¥ä¸Šé¢ä¸¤ä¸ªç›¸åäº‹ä»¶çš„è´å¶æ–¯å…¬å¼ã€‚ äºæ˜¯æˆ‘ä»¬å°±åªéœ€è¦æ¯”è¾ƒä»¥ä¸‹ä¸¤ä¸ªå¼å­çš„å¤§å°ï¼š C = P(â€œæˆ‘â€|S)P(â€œå¸â€|S)P(â€œå¯â€|S)P(â€œåŠç†â€|S)P(â€œæ­£è§„å‘ç¥¨â€|S) Ã—P(â€œä¿çœŸâ€|S)P(â€œå¢å€¼ç¨â€|S)P(â€œå‘ç¥¨â€|S)P(â€œç‚¹æ•°â€|S)P(â€œä¼˜æƒ â€|S)P(â€œåƒåœ¾é‚®ä»¶â€) \\overline{C}=P(â€œæˆ‘â€|H)P(â€œå¸â€|H)P(â€œå¯â€|H)P(â€œåŠç†â€|H)P(â€œæ­£è§„å‘ç¥¨â€|H) Ã—P(â€œä¿çœŸâ€|H)P(â€œå¢å€¼ç¨â€|H)P(â€œå‘ç¥¨â€|H)P(â€œç‚¹æ•°â€|H)P(â€œä¼˜æƒ â€|H)P(â€œæ­£å¸¸é‚®ä»¶â€)å‰(wo)å®³(cao)ï¼é…±ç´«å¤„ç†åå¼å­ä¸­çš„æ¯ä¸€é¡¹éƒ½ç‰¹åˆ«å¥½æ±‚ï¼åªéœ€è¦åˆ†åˆ«ç»Ÿè®¡å„ç±»é‚®ä»¶ä¸­è¯¥å…³é”®è¯å‡ºç°çš„æ¦‚ç‡å°±å¯ä»¥äº†ï¼ï¼ï¼æ¯”å¦‚ï¼š P(â€œå‘ç¥¨â€|Sï¼‰=\\frac{åƒåœ¾é‚®ä»¶ä¸­æ‰€æœ‰â€œå‘ç¥¨â€çš„æ¬¡æ•°}{åƒåœ¾é‚®ä»¶ä¸­æ‰€æœ‰è¯è¯­çš„æ¬¡æ•°} ç»Ÿè®¡æ¬¡æ•°éå¸¸æ–¹ä¾¿ï¼Œè€Œä¸”æ ·æœ¬æ•°é‡è¶³å¤Ÿå¤§ï¼Œç®—å‡ºæ¥çš„æ¦‚ç‡æ¯”è¾ƒæ¥è¿‘çœŸå®ã€‚äºæ˜¯åƒåœ¾é‚®ä»¶è¯†åˆ«çš„é—®é¢˜å°±å¯è§£äº†ã€‚ 7. Naive Bayesï¼Œâ€œNaiveâ€åœ¨ä½•å¤„ï¼ŸåŠ ä¸Šæ¡ä»¶ç‹¬ç«‹å‡è®¾çš„è´å¶æ–¯æ–¹æ³•å°±æ˜¯æœ´ç´ è´å¶æ–¯æ–¹æ³•ï¼ˆNaive Bayesï¼‰ã€‚ Naiveçš„å‘éŸ³æ˜¯â€œä¹ƒä¸€æ±¡â€ï¼Œæ„æ€æ˜¯â€œæœ´ç´ çš„â€ã€â€œå¹¼ç¨šçš„â€ã€â€œè ¢è ¢çš„â€ã€‚å’³å’³ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå¤§ç¥ä»¬å–åè¯´è¯¥æ–¹æ³•æ˜¯ä¸€ç§æ¯”è¾ƒèŒè ¢çš„æ–¹æ³•ï¼Œä¸ºå•¥ï¼Ÿ å°†å¥å­ï¼ˆâ€œæˆ‘â€,â€œå¸â€,â€œå¯â€,â€œåŠç†â€,â€œæ­£è§„å‘ç¥¨â€) ä¸­çš„ ï¼ˆâ€œæˆ‘â€,â€œå¸â€ï¼‰ä¸ï¼ˆâ€œæ­£è§„å‘ç¥¨â€ï¼‰è°ƒæ¢ä¸€ä¸‹é¡ºåºï¼Œå°±å˜æˆäº†ä¸€ä¸ªæ–°çš„å¥å­ï¼ˆâ€œæ­£è§„å‘ç¥¨â€,â€œå¯â€,â€œåŠç†â€, â€œæˆ‘â€, â€œå¸â€)ã€‚æ–°å¥å­ä¸æ—§å¥å­çš„æ„æ€å®Œå…¨ä¸åŒã€‚ä½†ç”±äºä¹˜æ³•äº¤æ¢å¾‹ï¼Œæœ´ç´ è´å¶æ–¯æ–¹æ³•ä¸­ç®—å‡ºæ¥äºŒè€…çš„æ¡ä»¶æ¦‚ç‡å®Œå…¨ä¸€æ ·ï¼è®¡ç®—è¿‡ç¨‹å¦‚ä¸‹ï¼š P(ï¼ˆâ€œæˆ‘â€,â€œå¸â€,â€œå¯â€,â€œåŠç†â€,â€œæ­£è§„å‘ç¥¨â€)|S) = P(â€œæˆ‘â€|S)P(â€œå¸â€|S)P(â€œå¯â€|S)P(â€œåŠç†â€|S)P(â€œæ­£è§„å‘ç¥¨â€|S) =P(â€œæ­£è§„å‘ç¥¨â€|S)P(â€œå¯â€|S)P(â€œåŠç†â€|S)P(â€œæˆ‘â€|S)P(â€œå¸â€|Sï¼‰ =P(ï¼ˆâ€œæ­£è§„å‘ç¥¨â€,â€œå¯â€,â€œåŠç†â€, â€œæˆ‘â€, â€œå¸â€)|S)ä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨æœ´ç´ è´å¶æ–¯çœ¼é‡Œï¼Œâ€œæˆ‘å¸å¯åŠç†æ­£è§„å‘ç¥¨â€ ä¸ â€œæ­£è§„å‘ç¥¨å¯åŠç†æˆ‘å¸â€ å®Œå…¨ç›¸åŒã€‚æœ´ç´ è´å¶æ–¯å¤±å»äº†è¯è¯­ä¹‹é—´çš„é¡ºåºä¿¡æ¯ã€‚è¿™å°±ç›¸å½“äºæŠŠæ‰€æœ‰çš„è¯æ±‡æ‰”è¿›åˆ°ä¸€ä¸ªè¢‹å­é‡Œéšä¾¿æ…å’Œï¼Œè´å¶æ–¯éƒ½è®¤ä¸ºå®ƒä»¬ä¸€æ ·ã€‚å› æ­¤è¿™ç§æƒ…å†µä¹Ÿç§°ä½œè¯è¢‹å­æ¨¡å‹(bag of words)ã€‚ è¯è¢‹å­æ¨¡å‹ä¸äººä»¬çš„æ—¥å¸¸ç»éªŒå®Œå…¨ä¸åŒã€‚æ¯”å¦‚ï¼Œåœ¨æ¡ä»¶ç‹¬ç«‹å‡è®¾çš„æƒ…å†µä¸‹ï¼Œâ€œæ­¦æ¾æ‰“æ­»äº†è€è™â€ ä¸ â€œè€è™æ‰“æ­»äº†æ­¦æ¾â€ è¢«å®ƒè®¤ä½œä¸€ä¸ªæ„æ€äº†ã€‚æ©ï¼Œæœ´ç´ è´å¶æ–¯å°±æ˜¯è¿™ä¹ˆå•çº¯å’Œç›´æ¥ï¼Œå¯¹æ¯”äºå…¶ä»–åˆ†ç±»å™¨ï¼Œå¥½åƒæ˜¯æ˜¾å¾—æœ‰é‚£ä¹ˆç‚¹èŒè ¢ 8. ç®€å•é«˜æ•ˆï¼ŒåŠä¸é€†è¢­è™½ç„¶è¯´æœ´ç´ è´å¶æ–¯æ–¹æ³•èŒè ¢èŒè ¢çš„ï¼Œä½†å®è·µè¯æ˜åœ¨åƒåœ¾é‚®ä»¶è¯†åˆ«çš„åº”ç”¨è¿˜ä»¤äººè¯§å¼‚åœ°å¥½ã€‚Paul Grahamå…ˆç”Ÿè‡ªå·±ç®€å•åšäº†ä¸€ä¸ªæœ´ç´ è´å¶æ–¯åˆ†ç±»å™¨ï¼Œâ€œ1000å°åƒåœ¾é‚®ä»¶èƒ½å¤Ÿè¢«è¿‡æ»¤æ‰995å°ï¼Œå¹¶ä¸”æ²¡æœ‰ä¸€ä¸ªè¯¯åˆ¤â€ã€‚ï¼ˆPaul Grahamã€Šé»‘å®¢ä¸ç”»å®¶ã€‹ï¼‰ é‚£ä¸ªâ€¦æ•ˆæœä¸ºå•¥å¥½å‘¢ï¼Ÿ â€œæœ‰äººå¯¹æ­¤æå‡ºäº†ä¸€ä¸ªç†è®ºè§£é‡Šï¼Œå¹¶ä¸”å»ºç«‹äº†ä»€ä¹ˆæ—¶å€™æœ´ç´ è´å¶æ–¯çš„æ•ˆæœèƒ½å¤Ÿç­‰ä»·äºéæœ´ç´ è´å¶æ–¯çš„å……è¦æ¡ä»¶ï¼Œè¿™ä¸ªè§£é‡Šçš„æ ¸å¿ƒå°±æ˜¯ï¼šæœ‰äº›ç‹¬ç«‹å‡è®¾åœ¨å„ä¸ªåˆ†ç±»ä¹‹é—´çš„åˆ†å¸ƒéƒ½æ˜¯å‡åŒ€çš„æ‰€ä»¥å¯¹äºä¼¼ç„¶çš„ç›¸å¯¹å¤§å°ä¸äº§ç”Ÿå½±å“ï¼›å³ä¾¿ä¸æ˜¯å¦‚æ­¤ï¼Œä¹Ÿæœ‰å¾ˆå¤§çš„å¯èƒ½æ€§å„ä¸ªç‹¬ç«‹å‡è®¾æ‰€äº§ç”Ÿçš„æ¶ˆæå½±å“æˆ–ç§¯æå½±å“äº’ç›¸æŠµæ¶ˆï¼Œæœ€ç»ˆå¯¼è‡´ç»“æœå—åˆ°çš„å½±å“ä¸å¤§ã€‚å…·ä½“çš„æ•°å­¦å…¬å¼è¯·å‚è€ƒ[è¿™ç¯‡ paper][2]ã€‚â€ï¼ˆåˆ˜æœªé¹ã€Šï¼šå¹³å‡¡è€Œåˆç¥å¥‡çš„è´å¶æ–¯æ–¹æ³•ã€‹ï¼‰ æ©ï¼Œè¿™ä¸ªåˆ†ç±»å™¨ä¸­æœ€ç®€å•ç›´æ¥çœ‹ä¼¼èŒè ¢çš„å°ç›†å‹ã€æœ´ç´ è´å¶æ–¯ã€ï¼Œå®é™…ä¸Šå´æ˜¯ç®€å•ã€å®ç”¨ã€ä¸”å¼ºå¤§çš„ã€‚ 9. å¤„ç†é‡å¤è¯è¯­çš„ä¸‰ç§æ–¹å¼æˆ‘ä»¬ä¹‹å‰çš„ åƒåœ¾é‚®ä»¶å‘é‡ï¼ˆâ€œæˆ‘â€,â€œå¸â€,â€œå¯â€,â€œåŠç†â€,â€œæ­£è§„å‘ç¥¨â€,â€œä¿çœŸâ€,â€œå¢å€¼ç¨â€,â€œå‘ç¥¨â€,â€œç‚¹æ•°â€,â€œä¼˜æƒ â€) ï¼Œå…¶ä¸­æ¯ä¸ªè¯éƒ½ä¸é‡å¤ã€‚è€Œè¿™åœ¨ç°å®ä¸­å…¶å®å¾ˆå°‘è§ã€‚å› ä¸ºå¦‚æœæ–‡æœ¬é•¿åº¦å¢åŠ ï¼Œæˆ–è€…åˆ†è¯æ–¹æ³•æ”¹å˜ï¼Œå¿…ç„¶ä¼šæœ‰è®¸å¤šè¯é‡å¤å‡ºç°ï¼Œå› æ­¤éœ€è¦å¯¹è¿™ç§æƒ…å†µè¿›è¡Œè¿›ä¸€æ­¥æ¢è®¨ã€‚æ¯”å¦‚ä»¥ä¸‹è¿™æ®µé‚®ä»¶ï¼š â€œä»£å¼€å‘ç¥¨ã€‚å¢å€¼ç¨å‘ç¥¨ï¼Œæ­£è§„å‘ç¥¨ã€‚â€ åˆ†è¯åä¸ºå‘é‡ï¼š ï¼ˆâ€œä»£å¼€â€,â€œå‘ç¥¨â€,â€œå¢å€¼ç¨â€,â€œå‘ç¥¨â€,â€œæ­£è§„â€,â€œå‘ç¥¨â€ï¼‰ å…¶ä¸­â€œå‘ç¥¨â€é‡å¤äº†ä¸‰æ¬¡ã€‚ 9.1 å¤šé¡¹å¼æ¨¡å‹å¦‚æœæˆ‘ä»¬è€ƒè™‘é‡å¤è¯è¯­çš„æƒ…å†µï¼Œé‡å¤çš„è¯è¯­æˆ‘ä»¬è§†ä¸ºå…¶å‡ºç°å¤šæ¬¡ï¼Œç›´æ¥æŒ‰æ¡ä»¶ç‹¬ç«‹å‡è®¾çš„æ–¹å¼æ¨å¯¼ï¼Œåˆ™æœ‰ P(ï¼ˆâ€œä»£å¼€â€,â€œå‘ç¥¨â€,â€œå¢å€¼ç¨â€,â€œå‘ç¥¨â€,â€œæ­£è§„â€,â€œå‘ç¥¨â€)|Sï¼‰ =P(â€œä»£å¼€â€â€|S)P(â€œå‘ç¥¨â€|S)P(â€œå¢å€¼ç¨â€|S)P(â€œå‘ç¥¨â€|S)P(â€œæ­£è§„â€|S)P(â€œå‘ç¥¨â€|Sï¼‰ =P(â€œä»£å¼€â€â€|S)P^3(â€œå‘ç¥¨â€|S)P(â€œå¢å€¼ç¨â€|S)P(â€œæ­£è§„â€|S) æ³¨æ„è¿™é¡¹ $P^3(â€œå‘ç¥¨â€|S)$ 9.2 ä¼¯åŠªåˆ©æ¨¡å‹å¦ä¸€ç§æ›´åŠ ç®€åŒ–çš„æ–¹æ³•æ˜¯å°†é‡å¤çš„è¯è¯­éƒ½è§†ä¸ºå…¶åªå‡ºç°1æ¬¡ï¼Œ P(ï¼ˆâ€œä»£å¼€â€,â€œå‘ç¥¨â€,â€œå¢å€¼ç¨â€,â€œå‘ç¥¨â€,â€œæ­£è§„â€,â€œå‘ç¥¨â€)|Sï¼‰ =P(â€œå‘ç¥¨â€|S)P(â€œä»£å¼€â€â€|S)P(â€œå¢å€¼ç¨â€|S)P(â€œæ­£è§„â€|Sï¼‰ç»Ÿè®¡è®¡ç®— $P(â€œè¯è¯­â€|S)$ æ—¶ä¹Ÿæ˜¯å¦‚æ­¤ã€‚ P(â€œå‘ç¥¨â€|Sï¼‰=\\frac{å‡ºç°â€œå‘ç¥¨â€çš„åƒåœ¾é‚®ä»¶çš„å°æ•°}{æ¯å°åƒåœ¾é‚®ä»¶ä¸­æ‰€æœ‰è¯å‡ºç°æ¬¡æ•°ï¼ˆå‡ºç°äº†åªè®¡ç®—ä¸€æ¬¡ï¼‰çš„æ€»å’Œ}è¿™æ ·çš„æ¨¡å‹å«ä½œ ä¼¯åŠªåˆ©æ¨¡å‹ï¼ˆåˆç§°ä¸ºäºŒé¡¹ç‹¬ç«‹æ¨¡å‹ï¼‰ã€‚è¿™ç§æ–¹å¼æ›´åŠ ç®€åŒ–ä¸æ–¹ä¾¿ã€‚å½“ç„¶å®ƒä¸¢å¤±äº†è¯é¢‘çš„ä¿¡æ¯ï¼Œå› æ­¤æ•ˆæœå¯èƒ½ä¼šå·®ä¸€äº›ã€‚ 9.3 æ··åˆæ¨¡å‹ç¬¬ä¸‰ç§æ–¹å¼æ˜¯åœ¨è®¡ç®—å¥å­æ¦‚ç‡æ—¶ï¼Œä¸è€ƒè™‘é‡å¤è¯è¯­å‡ºç°çš„æ¬¡æ•°ï¼Œä½†æ˜¯åœ¨ç»Ÿè®¡è®¡ç®—è¯è¯­çš„æ¦‚ç‡$P(â€œè¯è¯­â€|S)$ æ—¶ï¼Œå´è€ƒè™‘é‡å¤è¯è¯­çš„å‡ºç°æ¬¡æ•°ï¼Œè¿™æ ·çš„æ¨¡å‹å¯ä»¥å«ä½œæ··åˆæ¨¡å‹ã€‚ å…·ä½“å®è·µä¸­é‡‡ç”¨é‚£ç§æ¨¡å‹ï¼Œå…³é”®çœ‹å…·ä½“çš„ä¸šåŠ¡åœºæ™¯ï¼Œä¸€ä¸ªç®€å•ç»éªŒæ˜¯ï¼Œå¯¹äºåƒåœ¾é‚®ä»¶è¯†åˆ«ï¼Œæ··åˆæ¨¡å‹æ›´å¥½äº›ã€‚ 10. å»é™¤åœç”¨è¯ä¸é€‰æ‹©å…³é”®è¯æˆ‘ä»¬ç»§ç»­è§‚å¯Ÿï¼ˆâ€œæˆ‘â€,â€œå¸â€,â€œå¯â€,â€œåŠç†â€,â€œæ­£è§„å‘ç¥¨â€,â€œä¿çœŸâ€,â€œå¢å€¼ç¨â€,â€œå‘ç¥¨â€,â€œç‚¹æ•°â€,â€œä¼˜æƒ â€) è¿™å¥è¯ã€‚å…¶å®ï¼Œåƒâ€œæˆ‘â€ã€â€œå¯â€ä¹‹ç±»è¯å…¶å®éå¸¸ä¸­æ€§ï¼Œæ— è®ºå…¶æ˜¯å¦å‡ºç°åœ¨åƒåœ¾é‚®ä»¶ä¸­éƒ½æ— æ³•å¸®åŠ©åˆ¤æ–­çš„æœ‰ç”¨ä¿¡æ¯ã€‚æ‰€ä»¥å¯ä»¥ç›´æ¥ä¸è€ƒè™‘è¿™äº›å…¸å‹çš„è¯ã€‚è¿™äº›æ— åŠ©äºæˆ‘ä»¬åˆ†ç±»çš„è¯è¯­å«ä½œ â€œåœç”¨è¯â€ï¼ˆStop Wordsï¼‰ã€‚è¿™æ ·å¯ä»¥å‡å°‘æˆ‘ä»¬è®­ç»ƒæ¨¡å‹ã€åˆ¤æ–­åˆ†ç±»çš„æ—¶é—´ã€‚ äºæ˜¯ä¹‹å‰çš„å¥å­å°±å˜æˆäº†ï¼ˆâ€œå¸â€,â€œåŠç†â€,â€œæ­£è§„å‘ç¥¨â€,â€œä¿çœŸâ€,â€œå¢å€¼ç¨â€,â€œå‘ç¥¨â€,â€œç‚¹æ•°â€,â€œä¼˜æƒ â€) ã€‚ æˆ‘ä»¬è¿›ä¸€æ­¥åˆ†æã€‚ä»¥äººç±»çš„ç»éªŒï¼Œå…¶å® â€œæ­£è§„å‘ç¥¨â€ã€â€œå‘ç¥¨â€ è¿™ç±»çš„è¯å¦‚æœå‡ºç°çš„è¯ï¼Œé‚®ä»¶ä½œä¸ºåƒåœ¾é‚®ä»¶çš„æ¦‚ç‡éå¸¸å¤§ï¼Œå¯ä»¥ä½œä¸ºæˆ‘ä»¬åŒºåˆ†åƒåœ¾é‚®ä»¶çš„â€œå…³é”®è¯â€ã€‚è€Œåƒ â€œå¸â€ã€â€œåŠç†â€ã€â€œä¼˜æƒ â€ è¿™ç±»çš„è¯åˆ™æœ‰ç‚¹é¸¡è‚‹ï¼Œå¯èƒ½æœ‰åŠ©äºåˆ†ç±»ï¼Œä½†åˆä¸é‚£ä¹ˆå¼ºçƒˆã€‚å¦‚æœæƒ³çœäº‹åšä¸ªç®€å•çš„åˆ†ç±»å™¨çš„è¯ï¼Œåˆ™å¯ä»¥ç›´æ¥é‡‡ç”¨â€œå…³é”®è¯â€è¿›è¡Œç»Ÿè®¡ä¸åˆ¤æ–­ï¼Œå‰©ä¸‹çš„è¯å°±å¯ä»¥å…ˆä¸ç®¡äº†ã€‚äºæ˜¯ä¹‹å‰çš„åƒåœ¾é‚®ä»¶å¥å­å°±å˜æˆäº†ï¼ˆâ€œæ­£è§„å‘ç¥¨â€,â€œå‘ç¥¨â€) ã€‚è¿™æ ·å°±æ›´åŠ å‡å°‘äº†æˆ‘ä»¬è®­ç»ƒæ¨¡å‹ã€åˆ¤æ–­åˆ†ç±»çš„æ—¶é—´ï¼Œé€Ÿåº¦éå¸¸å¿«ã€‚ â€œåœç”¨è¯â€å’Œâ€œå…³é”®è¯â€ä¸€èˆ¬éƒ½å¯ä»¥æå‰é äººå·¥ç»éªŒæŒ‡å®šã€‚ä¸åŒçš„â€œåœç”¨è¯â€å’Œâ€œå…³é”®è¯â€è®­ç»ƒå‡ºæ¥çš„åˆ†ç±»å™¨çš„æ•ˆæœä¹Ÿä¼šæœ‰äº›å·®å¼‚ã€‚ 11. æµ…è°ˆå¹³æ»‘æŠ€æœ¯æˆ‘ä»¬æ¥è¯´ä¸ªé—®é¢˜(ä¸­æ–‡NLPé‡Œé—®é¢˜è¶…çº§å¤š)ï¼Œæ¯”å¦‚åœ¨è®¡ç®—ä»¥ä¸‹ç‹¬ç«‹æ¡ä»¶å‡è®¾çš„æ¦‚ç‡ï¼š P(ï¼ˆâ€œæˆ‘â€,â€œå¸â€,â€œå¯â€,â€œåŠç†â€,â€œæ­£è§„å‘ç¥¨â€)|S) =P(â€œæˆ‘â€|S)P(â€œå¸â€|S)P(â€œå¯â€|S)P(â€œåŠç†â€|S)P(â€œæ­£è§„å‘ç¥¨â€|Sï¼‰æˆ‘ä»¬æ‰«æä¸€ä¸‹è®­ç»ƒé›†ï¼Œå‘ç° â€œæ­£è§„å‘ç¥¨â€è¿™ä¸ªè¯ä»å‡ºç°è¿‡ï¼ï¼ï¼ï¼Œäºæ˜¯ $P(â€œæ­£è§„å‘ç¥¨â€|Sï¼‰=0$ â€¦é—®é¢˜ä¸¥é‡äº†ï¼Œæ•´ä¸ªæ¦‚ç‡éƒ½å˜æˆ0äº†ï¼ï¼ï¼æœ´ç´ è´å¶æ–¯æ–¹æ³•é¢å¯¹ä¸€å †0ï¼Œå¾ˆå‡„æƒ¨åœ°å¤±æ•ˆäº†â€¦æ›´æ®‹é…·çš„æ˜¯ è¿™ç§æƒ…å†µå…¶å®å¾ˆå¸¸è§ï¼Œå› ä¸ºå“ªæ€•è®­ç»ƒé›†å†å¤§ï¼Œä¹Ÿå¯èƒ½æœ‰è¦†ç›–ä¸åˆ°çš„è¯è¯­ã€‚æœ¬è´¨ä¸Šè¿˜æ˜¯æ ·æœ¬æ•°é‡å¤ªå°‘ï¼Œä¸æ»¡è¶³å¤§æ•°å®šå¾‹ï¼Œè®¡ç®—å‡ºæ¥çš„æ¦‚ç‡å¤±çœŸã€‚ä¸ºäº†è§£å†³è¿™æ ·çš„é—®é¢˜ï¼Œä¸€ç§åˆ†ææ€è·¯å°±æ˜¯ç›´æ¥ä¸è€ƒè™‘è¿™æ ·çš„è¯è¯­ï¼Œä½†è¿™ç§æ–¹æ³•å°±ç›¸å½“äºé»˜è®¤ç»™ $P(â€œæ­£è§„å‘ç¥¨â€|Sï¼‰$ èµ‹å€¼ä¸º1ã€‚å…¶å®æ•ˆæœä¸å¤ªå¥½ï¼Œå¤§é‡çš„ç»Ÿè®¡ä¿¡æ¯ç»™æµªè´¹æ‰äº†ã€‚æˆ‘ä»¬è¿›ä¸€æ­¥åˆ†æï¼Œæ—¢ç„¶å¯ä»¥é»˜è®¤èµ‹å€¼ä¸º1ï¼Œä¸ºä»€ä¹ˆä¸èƒ½é»˜è®¤èµ‹å€¼ä¸ºä¸€ä¸ªå¾ˆå°çš„æ•°ï¼Ÿè¿™å°±æ˜¯å¹³æ»‘æŠ€æœ¯çš„åŸºæœ¬æ€è·¯ï¼Œä¾æ—§ä¿æŒç€ä¸€è´¯çš„ä½œé£ï¼Œæœ´å®/åœŸä½†æ˜¯ç›´æ¥è€Œæœ‰æ•ˆã€‚ å¯¹äºä¼¯åŠªåˆ©æ¨¡å‹ï¼Œ$P(â€œæ­£è§„å‘ç¥¨â€|S)$ çš„ä¸€ç§å¹³æ»‘ç®—æ³•æ˜¯ï¼š P(â€œæ­£è§„å‘ç¥¨â€|Sï¼‰=\\frac{å‡ºç°â€œæ­£è§„å‘ç¥¨â€çš„åƒåœ¾é‚®ä»¶çš„å°æ•°+1}{æ¯å°åƒåœ¾é‚®ä»¶ä¸­æ‰€æœ‰è¯å‡ºç°æ¬¡æ•°ï¼ˆå‡ºç°äº†åªè®¡ç®—ä¸€æ¬¡ï¼‰çš„æ€»å’Œ+2}å¯¹äºå¤šé¡¹å¼æ¨¡å‹ï¼Œ$P(â€œæ­£è§„å‘ç¥¨â€| S)$ çš„ä¸€ç§å¹³æ»‘ç®—æ³•æ˜¯ï¼š P(â€œå‘ç¥¨â€|Sï¼‰=\\frac{æ¯å°åƒåœ¾é‚®ä»¶ä¸­å‡ºç°â€œå‘ç¥¨â€çš„æ¬¡æ•°çš„æ€»å’Œ+1}{æ¯å°åƒåœ¾é‚®ä»¶ä¸­æ‰€æœ‰è¯å‡ºç°æ¬¡æ•°ï¼ˆè®¡ç®—é‡å¤æ¬¡æ•°ï¼‰çš„æ€»å’Œ+è¢«ç»Ÿè®¡çš„è¯è¡¨çš„è¯è¯­æ•°é‡}è¯´èµ·æ¥ï¼Œå¹³æ»‘æŠ€æœ¯çš„ç§ç±»å…¶å®éå¸¸å¤šï¼Œæœ‰å…´è¶£çš„è¯å›å¤´æˆ‘ä»¬ä¸“é—¨æ‹‰ä¸ªä¸“é¢˜è®²è®²å¥½äº†ã€‚è¿™é‡Œåªæä¸€ç‚¹ï¼Œå°±æ˜¯æ‰€æœ‰çš„å¹³æ»‘æŠ€æœ¯éƒ½æ˜¯ç»™æœªå‡ºç°åœ¨è®­ç»ƒé›†ä¸­çš„è¯è¯­ä¸€ä¸ªä¼°è®¡çš„æ¦‚ç‡ï¼Œè€Œç›¸åº”åœ°è°ƒä½å…¶ä»–å·²ç»å‡ºç°çš„è¯è¯­çš„æ¦‚ç‡ã€‚ å¹³æ»‘æŠ€æœ¯æ˜¯å› ä¸ºæ•°æ®é›†å¤ªå°è€Œäº§ç”Ÿçš„ç°å®éœ€æ±‚ã€‚å¦‚æœæ•°æ®é›†è¶³å¤Ÿå¤§ï¼Œå¹³æ»‘æŠ€æœ¯å¯¹ç»“æœçš„å½±å“å°†ä¼šå˜å°ã€‚ 12. å†…å®¹å°ç»“æˆ‘ä»¬æ‰¾äº†ä¸ªæœ€ç®€å•å¸¸è§çš„ä¾‹å­ï¼šåƒåœ¾é‚®ä»¶è¯†åˆ«ï¼Œè¯´æ˜äº†ä¸€ä¸‹æœ´ç´ è´å¶æ–¯è¿›è¡Œæ–‡æœ¬åˆ†ç±»çš„æ€è·¯è¿‡ç¨‹ã€‚åŸºæœ¬æ€è·¯æ˜¯å…ˆåŒºåˆ†å¥½è®­ç»ƒé›†ä¸æµ‹è¯•é›†ï¼Œå¯¹æ–‡æœ¬é›†åˆè¿›è¡Œåˆ†è¯ã€å»é™¤æ ‡ç‚¹ç¬¦å·ç­‰ç‰¹å¾é¢„å¤„ç†çš„æ“ä½œï¼Œç„¶åä½¿ç”¨æ¡ä»¶ç‹¬ç«‹å‡è®¾ï¼Œå°†åŸæ¦‚ç‡è½¬æ¢æˆè¯æ¦‚ç‡ä¹˜ç§¯ï¼Œå†è¿›è¡Œåç»­çš„å¤„ç†ã€‚ è´å¶æ–¯å…¬å¼ + æ¡ä»¶ç‹¬ç«‹å‡è®¾ = æœ´ç´ è´å¶æ–¯æ–¹æ³•åŸºäºå¯¹é‡å¤è¯è¯­åœ¨è®­ç»ƒé˜¶æ®µä¸åˆ¤æ–­ï¼ˆæµ‹è¯•ï¼‰é˜¶æ®µçš„ä¸‰ç§ä¸åŒå¤„ç†æ–¹å¼ï¼Œæˆ‘ä»¬ç›¸åº”çš„æœ‰ä¼¯åŠªåˆ©æ¨¡å‹ã€å¤šé¡¹å¼æ¨¡å‹å’Œæ··åˆæ¨¡å‹ã€‚åœ¨è®­ç»ƒé˜¶æ®µï¼Œå¦‚æœæ ·æœ¬é›†åˆå¤ªå°å¯¼è‡´æŸäº›è¯è¯­å¹¶æœªå‡ºç°ï¼Œæˆ‘ä»¬å¯ä»¥é‡‡ç”¨å¹³æ»‘æŠ€æœ¯å¯¹å…¶æ¦‚ç‡ç»™ä¸€ä¸ªä¼°è®¡å€¼ã€‚è€Œä¸”å¹¶ä¸æ˜¯æ‰€æœ‰çš„è¯è¯­éƒ½éœ€è¦ç»Ÿè®¡ï¼Œæˆ‘ä»¬å¯ä»¥æŒ‰ç›¸åº”çš„â€œåœç”¨è¯â€å’Œâ€œå…³é”®è¯â€å¯¹æ¨¡å‹è¿›è¡Œè¿›ä¸€æ­¥ç®€åŒ–ï¼Œæé«˜è®­ç»ƒå’Œåˆ¤æ–­é€Ÿåº¦ã€‚ 13. åŒ¹é…å…³é”®è¯è¯†åˆ«spamï¼Ÿæœ‰åŒå­¦å¯èƒ½ä¼šé—®ï¼šâ€œä½•å¿…è´¹è¿™ä¹ˆå¤§åŠ²ç®—é‚£ä¹ˆå¤šè¯çš„æ¦‚ç‡ï¼Ÿç›´æ¥çœ‹é‚®ä»¶ä¸­æœ‰æ²¡æœ‰â€˜ä»£å¼€å‘ç¥¨â€™ã€â€˜è½¬å”®å‘ç¥¨â€™ä¹‹ç±»çš„å…³é”®è¯ä¸å°±å¾—äº†ï¼Ÿå¦‚æœå…³é”®è¯æ¯”è¾ƒå¤šå°±è®¤ä¸ºæ˜¯åƒåœ¾é‚®ä»¶å‘—ã€‚â€ å…¶å®å…³é”®è¯åŒ¹é…çš„æ–¹æ³•å¦‚æœæœ‰æ•ˆçš„è¯çœŸä¸å¿…ç”¨æœ´ç´ è´å¶æ–¯ã€‚æ¯•ç«Ÿè¿™ç§æ–¹æ³•ç®€å•å˜›ï¼Œå°±æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²åŒ¹é…ã€‚ä»å†å²æ¥çœ‹ï¼Œä¹‹å‰æ²¡æœ‰è´å¶æ–¯æ–¹æ³•çš„æ—¶å€™ä¸»è¦ä¹Ÿæ˜¯ç”¨å…³é”®è¯åŒ¹é…ã€‚ä½†æ˜¯è¿™ç§æ–¹æ³•å‡†ç¡®ç‡å¤ªä½ã€‚æˆ‘ä»¬åœ¨å·¥ä½œé¡¹ç›®ä¸­ä¹Ÿå°è¯•è¿‡ç”¨å…³é”®è¯åŒ¹é…çš„æ–¹æ³•å»è¿›è¡Œæ–‡æœ¬åˆ†ç±»ï¼Œå‘ç°å¤§é‡è¯¯æŠ¥ã€‚æ„Ÿè§‰å°±åƒæ‰”åˆ°åƒåœ¾ç®±çš„é‚®ä»¶99%éƒ½æ˜¯æ­£å¸¸çš„ï¼è¿™æ ·çš„æ•ˆæœä¸å¿ç›´è§†ã€‚è€ŒåŠ ä¸€ä¸ªæœ´ç´ è´å¶æ–¯æ–¹æ³•å°±å¯èƒ½æŠŠè¯¯æŠ¥ç‡æ‹‰ä½è¿‘ä¸€ä¸ªæ•°é‡çº§ï¼Œä½“éªŒå¥½å¾—ä¸è¦ä¸è¦çš„ã€‚ å¦ä¸€ä¸ªåŸå› æ˜¯è¯è¯­ä¼šéšç€æ—¶é—´ä¸æ–­å˜åŒ–ã€‚å‘åƒåœ¾é‚®ä»¶çš„äººä¹Ÿä¸å‚»ï¼Œå½“ä»–ä»¬å‘ç°è‡ªå·±çš„é‚®ä»¶è¢«å¤§é‡å±è”½ä¹‹åï¼Œä¹Ÿä¼šè€ƒè™‘é‡‡ç”¨æ–°çš„æ–¹å¼ï¼Œå¦‚å˜æ¢æ–‡å­—ã€è¯è¯­ã€å¥å¼ã€é¢œè‰²ç­‰æ–¹å¼æ¥ç»•è¿‡ååƒåœ¾é‚®ä»¶ç³»ç»Ÿã€‚æ¯”å¦‚å¯¹äºåƒåœ¾é‚®ä»¶â€œæˆ‘å¸å¯åŠç†æ­£è§„å‘ç¥¨ï¼Œ17%å¢å€¼ç¨å‘ç¥¨ç‚¹æ•°ä¼˜æƒ â€,ä»–ä»¬é‡‡ç”¨ç«æ˜Ÿæ–‡ï¼šâ€œæ¶å¸å²¢åŠç†ãŠ£è¦é«®ç¥¨ï¼Œ17%å¢å€¤ç¨…é«®ç¥¨åš¸æ•¸å„ªè•™â€ï¼Œé‚£ä¹ˆå­—ç¬¦ä¸²åŒ¹é…çš„æ–¹æ³•åˆè¦é‡æ–°æ‰¾å‡ºè¿™äº›ç«æ˜Ÿæ–‡ï¼Œä¸€ä¸ªä¸€ä¸ªæ‰¾å‡ºå…³é”®è¯ï¼Œé‡æ–°å†™ä¸€äº›åŒ¹é…è§„åˆ™ã€‚æ›´å¯æ€•çš„æ˜¯ï¼Œè¿™äº›è§„åˆ™å¯èƒ½ç›¸äº’ä¹‹é—´çš„è€¦åˆå…³ç³»å¼‚å¸¸å¤æ‚ï¼Œè¦æŠŠå®ƒä»¬æ¢³ç†æ¸…æ¥šåˆæ˜¯å¤§ä¸€ä¸ªæ•°é‡çº§çš„å·¥ä½œé‡ã€‚ç­‰è¿™äº›è§„åˆ™å¤±æ•ˆäº†åˆè¦æ‰‹åŠ¨æ›´æ–°æ–°çš„è§„åˆ™â€¦â€¦æ— ç©·æ— å°½çŒ«é¼ æ¸¸æˆæœ€ç»ˆä¼šæŠŠçŒ«ç»™ç´¯æ­»ã€‚ è€Œæœ´ç´ è´å¶æ–¯æ–¹æ³•å´æ˜¾ç¤ºå‡ºæ— æ¯”çš„ä¼˜åŠ¿ã€‚å› ä¸ºå®ƒæ˜¯åŸºäºç»Ÿè®¡æ–¹æ³•çš„ï¼Œåªè¦è®­ç»ƒæ ·æœ¬ä¸­æœ‰æ›´æ–°çš„åƒåœ¾é‚®ä»¶çš„æ–°è¯è¯­ï¼Œå“ªæ€•å®ƒä»¬æ˜¯ç«æ˜Ÿæ–‡ï¼Œéƒ½èƒ½è‡ªåŠ¨åœ°æŠŠå“ªäº›æ›´æ•æ„Ÿçš„è¯è¯­ï¼ˆå¦‚â€œé«®â€ã€â€œãŠ£â€ç­‰ï¼‰ç»™å‡¸æ˜¾å‡ºæ¥ï¼Œå¹¶æ ¹æ®ç»Ÿè®¡æ„ä¹‰ä¸Šçš„æ•æ„Ÿæ€§ç»™ä»–ä»¬åˆ†é…é€‚å½“çš„æƒé‡ ï¼Œè¿™æ ·å°±ä¸éœ€è¦ä»€ä¹ˆäººå·¥äº†ï¼Œéå¸¸çœäº‹ã€‚ä½ åªéœ€è¦æ—¶ä¸æ—¶åœ°æ‹¿ä¸€äº›æœ€æ–°çš„æ ·æœ¬æ‰”åˆ°è®­ç»ƒé›†ä¸­ï¼Œé‡æ–°è®­ç»ƒä¸€æ¬¡å³å¯ã€‚ å°è¡¥å……ä¸€ä¸‹ï¼Œå¯¹äºç«æ˜Ÿæ–‡ã€åŒéŸ³å­—ç­‰æ›¿ä»£è¯­è¨€ï¼Œä¸€èˆ¬çš„åˆ†è¯æŠ€æœ¯å¯èƒ½ä¼šåˆ†å¾—ä¸å‡†ï¼Œæœ€ç»ˆå¯èƒ½åªæŠŠä¸€ä¸ªä¸€ä¸ªå­—ç»™åˆ†å‡ºæ¥ï¼Œæˆä¸ºâ€œåˆ†å­—â€ã€‚æ•ˆæœå¯èƒ½ä¸ä¼šå¤ªå¥½ã€‚ä¹Ÿå¯ä»¥ç”¨è¿‡n-gramä¹‹ç±»çš„è¯­è¨€æ¨¡å‹ï¼Œæ‹¿åˆ°æœ€å¸¸è§çŸ­è¯­ã€‚å½“ç„¶ï¼Œå¯¹äºè‹±æ–‡ç­‰å¤©ç”Ÿè‡ªå¸¦ç©ºæ ¼æ¥é—´éš”å•è¯çš„è¯­è¨€ï¼Œåˆ†è¯åˆ™ä¸æ˜¯ä»€ä¹ˆé—®é¢˜ï¼Œä½¿ç”¨æœ´ç´ è´å¶æ–¯æ–¹æ³•å°†ä¼šæ›´åŠ é¡ºç•…ã€‚ 14. å®é™…å·¥ç¨‹çš„tricksåº”ç”¨æœ´ç´ è´å¶æ–¯æ–¹æ³•çš„è¿‡ç¨‹ä¸­ï¼Œä¸€äº›tricksèƒ½æ˜¾è‘—å¸®åŠ©å·¥ç¨‹è§£å†³é—®é¢˜ã€‚æˆ‘ä»¬æ¯•ç«Ÿç»éªŒæœ‰é™ï¼Œæ— æ³•å°†å®ƒä»¬å…¨éƒ½ç½—åˆ—å‡ºæ¥ï¼Œåªèƒ½å°±æ‰€çŸ¥çš„ä¸€ç‚¹ç‚¹ç»éªŒä¸å¤§å®¶åˆ†äº«ï¼Œæ¬¢è¿æ‰¹è¯„æŒ‡æ­£ã€‚ 14.1 trick1ï¼šå–å¯¹æ•°æˆ‘ä»¬æåˆ°ç”¨æ¥è¯†åˆ«åƒåœ¾é‚®ä»¶çš„æ–¹æ³•æ˜¯æ¯”è¾ƒä»¥ä¸‹ä¸¤ä¸ªæ¦‚ç‡çš„å¤§å°ï¼ˆå­—æ¯Sè¡¨ç¤ºâ€œåƒåœ¾é‚®ä»¶â€,å­—æ¯Hè¡¨ç¤ºâ€œæ­£å¸¸é‚®ä»¶â€ï¼‰ï¼š C = P(â€œæˆ‘â€|S)P(â€œå¸â€|S)P(â€œå¯â€|S)P(â€œåŠç†â€|S)P(â€œæ­£è§„å‘ç¥¨â€|S) Ã—P(â€œä¿çœŸâ€|S)P(â€œå¢å€¼ç¨â€|S)P(â€œå‘ç¥¨â€|S)P(â€œç‚¹æ•°â€|S)P(â€œä¼˜æƒ â€|S)P(â€œåƒåœ¾é‚®ä»¶â€) \\overline{C}=P(â€œæˆ‘â€|H)P(â€œå¸â€|H)P(â€œå¯â€|H)P(â€œåŠç†â€|H)P(â€œæ­£è§„å‘ç¥¨â€|H) Ã—P(â€œä¿çœŸâ€|H)P(â€œå¢å€¼ç¨â€|H)P(â€œå‘ç¥¨â€|H)P(â€œç‚¹æ•°â€|H)P(â€œä¼˜æƒ â€|H)P(â€œæ­£å¸¸é‚®ä»¶â€)ä½†è¿™é‡Œè¿›è¡Œäº†å¾ˆå¤šä¹˜æ³•è¿ç®—ï¼Œè®¡ç®—çš„æ—¶é—´å¼€é”€æ¯”è¾ƒå¤§ã€‚å°¤å…¶æ˜¯å¯¹äºç¯‡å¹…æ¯”è¾ƒé•¿çš„é‚®ä»¶ï¼Œå‡ ä¸‡ä¸ªæ•°ç›¸ä¹˜èµ·æ¥è¿˜æ˜¯éå¸¸èŠ±æ—¶é—´çš„ã€‚å¦‚æœèƒ½æŠŠè¿™äº›ä¹˜æ³•å˜æˆåŠ æ³•åˆ™æ–¹ä¾¿å¾—å¤šã€‚åˆšå¥½æ•°å­¦ä¸­çš„å¯¹æ•°å‡½æ•°logå°±å¯ä»¥å®ç°è¿™æ ·çš„åŠŸèƒ½ã€‚ä¸¤è¾¹åŒæ—¶å–å¯¹æ•°ï¼ˆæœ¬æ–‡ç»Ÿä¸€å–åº•æ•°ä¸º2ï¼‰ï¼Œåˆ™ä¸Šé¢çš„å…¬å¼å˜ä¸ºï¼š log{C} = log{P(â€œæˆ‘â€|S)}+log{P(â€œå¸â€|S)}+log{P(â€œå¯â€|S)}+log{P(â€œåŠç†â€|S)}+log{P(â€œæ­£è§„å‘ç¥¨â€|S)} +log{P(â€œä¿çœŸâ€|S)}+log{P(â€œå¢å€¼ç¨â€|S)}+log{P(â€œå‘ç¥¨â€|S)}+log{P(â€œç‚¹æ•°â€|S)}+log{P(â€œä¼˜æƒ â€|S)}+log{P(â€œåƒåœ¾é‚®ä»¶â€)} log{\\overline{C}}=log{P(â€œæˆ‘â€|H)}+log{P(â€œå¸â€|H)}+log{P(â€œå¯â€|H)}+log{P(â€œåŠç†â€|H)}+log{P(â€œæ­£è§„å‘ç¥¨â€|H)} +log{P(â€œä¿çœŸâ€|H)}+log{P(â€œå¢å€¼ç¨â€|H)}+log{P(â€œå‘ç¥¨â€|H)}+log{P(â€œç‚¹æ•°â€|H)}+log{P(â€œä¼˜æƒ â€|H)}+log{P(â€œæ­£å¸¸é‚®ä»¶â€)}æœ‰åŒå­¦å¯èƒ½è¦å«äº†ï¼šâ€œåšå¯¹æ•°è¿ç®—å²‚ä¸ä¼šä¹Ÿå¾ˆèŠ±æ—¶é—´ï¼Ÿâ€çš„ç¡®å¦‚æ­¤ï¼Œä½†æ˜¯å¯ä»¥åœ¨è®­ç»ƒé˜¶æ®µç›´æ¥è®¡ç®— $logP$ ï¼Œç„¶åæŠŠä»–ä»¬å­˜åœ¨ä¸€å¼ å¤§çš„hashè¡¨é‡Œã€‚åœ¨åˆ¤æ–­çš„æ—¶å€™ç›´æ¥æå–hashè¡¨ä¸­å·²ç»è®¡ç®—å¥½çš„å¯¹æ•°æ¦‚ç‡ï¼Œç„¶åç›¸åŠ å³å¯ã€‚è¿™æ ·ä½¿å¾—åˆ¤æ–­æ‰€éœ€è¦çš„è®¡ç®—æ—¶é—´è¢«è½¬ç§»åˆ°äº†è®­ç»ƒé˜¶æ®µï¼Œå®æ—¶è¿è¡Œçš„æ—¶å€™é€Ÿåº¦å°±æ¯”ä¹‹å‰å¿«å¾—å¤šï¼Œè¿™å¯ä¸æ­¢å‡ ä¸ªæ•°é‡çº§çš„æå‡ã€‚ 14.2 trick2ï¼šè½¬æ¢ä¸ºæƒé‡å¯¹äºäºŒåˆ†ç±»ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ç»§ç»­æé«˜åˆ¤æ–­çš„é€Ÿåº¦ã€‚æ—¢ç„¶è¦æ¯”è¾ƒ $log$ å’Œ $log{\\overline{C}}$ çš„å¤§å°ï¼Œé‚£å°±å¯ä»¥ç›´æ¥å°†ä¸Šä¸‹ä¸¤å¼ç›¸å‡ï¼Œå¹¶ç»§ç»­åŒ–ç®€ï¼š log{\\frac{C}{\\overline{C}}}=log{\\frac{P(â€œæˆ‘â€|S)}{P(â€œæˆ‘â€|H)}}+log{\\frac{P(â€œå¸â€|S)}{P(â€œå¸â€|H)}}+log{\\frac{P(â€œå¯â€|S)}{P(â€œå¯â€|H)}}+log{\\frac{P(â€œåŠç†â€|S)}{P(â€œåŠç†â€|H)}}+log{\\frac{P(â€œæ­£è§„å‘ç¥¨â€|S)}{P(â€œæ­£è§„å‘ç¥¨â€|H)}} +log{\\frac{P(â€œä¿çœŸâ€|S)}{P(â€œä¿çœŸâ€|H)}}+log{\\frac{P(â€œå¢å€¼ç¨â€|S)}{P(â€œå¢å€¼ç¨â€|H)}}+log{\\frac{P(â€œå‘ç¥¨â€|S)}{P(â€œå‘ç¥¨â€|H)}}+log{\\frac{P(â€œç‚¹æ•°â€|S)}{P(â€œç‚¹æ•°â€|H)}}+log{\\frac{P(â€œä¼˜æƒ â€|S)}{P(â€œä¼˜æƒ â€|H)}}+log{\\frac{P(â€œæ­£å¸¸é‚®ä»¶â€|S)}{P(â€œæ­£å¸¸é‚®ä»¶â€)}}$log{\\frac{C}{\\overline{C}}}$å¦‚æœå¤§äº0åˆ™å±äºåƒåœ¾é‚®ä»¶ã€‚æˆ‘ä»¬å¯ä»¥æŠŠå…¶ä¸­æ¯ä¸€é¡¹ä½œä¸ºå…¶å¯¹åº”è¯è¯­çš„æƒé‡ï¼Œæ¯”å¦‚ $log{\\frac{P(â€œå‘ç¥¨â€|S)}{P(â€œå‘ç¥¨â€|H)}}$ å°±å¯ä»¥ä½œä¸ºè¯è¯­â€œå‘ç¥¨â€çš„æƒé‡ï¼Œæƒé‡è¶Šå¤§å°±è¶Šè¯´æ˜â€œå‘ç¥¨â€æ›´å¯èƒ½æ˜¯ä¸â€œåƒåœ¾é‚®ä»¶â€ç›¸å…³çš„ç‰¹å¾ã€‚è¿™æ ·å¯ä»¥æ ¹æ®æƒé‡çš„å¤§å°æ¥è¯„ä¼°å’Œç­›é€‰æ˜¾è‘—çš„ç‰¹å¾ï¼Œæ¯”å¦‚å…³é”®è¯ã€‚è€Œè¿™äº›æƒé‡å€¼å¯ä»¥ç›´æ¥æå‰è®¡ç®—å¥½è€Œå­˜åœ¨hashè¡¨ä¸­ ã€‚åˆ¤æ–­çš„æ—¶å€™ç›´æ¥å°†æƒé‡æ±‚å’Œå³å¯ã€‚ å…³é”®è¯hashè¡¨çš„æ ·å­å¦‚ä¸‹ï¼Œå·¦åˆ—æ˜¯æƒé‡ï¼Œå³åˆ—æ˜¯å…¶å¯¹åº”çš„è¯è¯­ï¼Œæƒé‡è¶Šé«˜çš„è¯´æ˜è¶Šâ€œå…³é”®â€ï¼š 14.3 trick3ï¼šé€‰å–topkçš„å…³é”®è¯å‰æ–‡è¯´è¿‡å¯ä»¥é€šè¿‡æå‰é€‰å–å…³é”®è¯æ¥æé«˜åˆ¤æ–­çš„é€Ÿåº¦ã€‚æœ‰ä¸€ç§æ–¹æ³•å¯ä»¥çœç•¥æå‰é€‰å–å…³é”®è¯çš„æ­¥éª¤ï¼Œå°±æ˜¯ç›´æ¥é€‰å–ä¸€æ®µæ–‡æœ¬ä¸­æƒé‡æœ€é«˜çš„Kä¸ªè¯è¯­ï¼Œå°†å…¶æƒé‡è¿›è¡ŒåŠ å’Œã€‚æ¯”å¦‚Paul Graham åœ¨ã€Šé»‘å®¢ä¸ç”»å®¶ã€‹ä¸­æ˜¯é€‰å–é‚®ä»¶ä¸­æƒé‡æœ€é«˜çš„15ä¸ªè¯è¯­è®¡ç®—çš„ã€‚ é€šè¿‡æƒé‡hashè¡¨å¯çŸ¥ï¼Œå¦‚æœæ˜¯æ‰€æœ‰è¯è¯­çš„æƒé‡ï¼Œåˆ™æƒé‡æœ‰æ­£æœ‰è´Ÿã€‚å¦‚æœåªé€‰æ‹©æƒé‡æœ€é«˜çš„ $K$ ä¸ªè¯è¯­ï¼Œåˆ™å®ƒä»¬çš„æƒé‡åŸºæœ¬éƒ½æ˜¯æ­£çš„ã€‚æ‰€ä»¥å°±ä¸èƒ½åƒä¹‹å‰é‚£æ ·åˆ¤æ–­ $log{\\frac{C}{\\overline{C}}}$ æ˜¯å¦å¤§äº0æ¥åŒºåˆ†é‚®ä»¶äº†ã€‚è€Œè¿™éœ€è¦ä¾é ç»éªŒé€‰å®šä¸€ä¸ªæ­£æ•°çš„é˜ˆå€¼ï¼ˆé—¨æ§›å€¼ï¼‰ ï¼Œä¾æ® $log{\\frac{C}{\\overline{C}}}$ ä¸è¯¥é—¨æ§›å€¼çš„å¤§å°æ¥è¯†åˆ«åƒåœ¾é‚®ä»¶ã€‚ å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œè“è‰²ç‚¹ä»£è¡¨åƒåœ¾é‚®ä»¶ï¼Œç»¿è‰²ç‚¹ä»£è¡¨æ­£å¸¸é‚®ä»¶ï¼Œæ¨ªåæ ‡ä¸ºè®¡ç®—å‡ºæ¥çš„ $log{\\frac{C}{\\overline{C}}}$ å€¼ï¼Œä¸­é—´çš„çº¢çº¿ä»£è¡¨é˜ˆå€¼ã€‚ k çš„é€‰å–ï¼Œéœ€è¦ä½ è‡ªå·±åˆ¤æ–­ã€‚å¯ä»¥é€šè¿‡äº¤å‰éªŒè¯æ¥åˆ¤æ–­ã€‚ 14.4 trick4ï¼šåˆ†å‰²æ ·æœ¬é€‰å–topkä¸ªè¯è¯­çš„æ–¹æ³•å¯¹äºç¯‡å¹…å˜åŠ¨ä¸å¤§çš„é‚®ä»¶æ ·æœ¬æ¯”è¾ƒæœ‰æ•ˆã€‚ä½†æ˜¯å¯¹ç¯‡å¹…è¿‡å¤§æˆ–è€…è¿‡å°çš„é‚®ä»¶åˆ™ä¼šæœ‰åˆ¤æ–­è¯¯å·®ã€‚ æ¯”å¦‚è¿™ä¸ªåƒåœ¾é‚®ä»¶çš„ä¾‹å­ï¼šï¼ˆâ€œæˆ‘â€,â€œå¸â€,â€œå¯â€,â€œåŠç†â€,â€œæ­£è§„å‘ç¥¨â€,â€œä¿çœŸâ€,â€œå¢å€¼ç¨â€,â€œå‘ç¥¨â€,â€œç‚¹æ•°â€,â€œä¼˜æƒ â€)ã€‚åˆ†è¯å‡ºäº†10ä¸ªè¯è¯­ï¼Œå…¶ä¸­æœ‰â€œæ­£è§„å‘ç¥¨â€ã€â€œå‘ç¥¨â€2ä¸ªå…³é”®è¯ã€‚å…³é”®è¯çš„å¯†åº¦è¿˜æ˜¯è›®å¤§çš„ï¼Œåº”è¯¥ç®—æ˜¯æ•æ„Ÿé‚®ä»¶ã€‚ä½†å› ä¸ºé‡‡ç”¨æœ€é«˜15ä¸ªè¯è¯­çš„æƒé‡æ±‚å’Œï¼Œå¹¶ä¸”ç›¸åº”çš„é˜ˆå€¼æ˜¯åŸºäº15ä¸ªè¯çš„æƒ…å†µæœ‰æ•ˆï¼Œå¯èƒ½ç®—å‡ºæ¥çš„ç»“æœè¿˜å°äºä¹‹å‰çš„é˜ˆå€¼ï¼Œè¿™å°±é€ æˆæ¼åˆ¤äº†ã€‚ ç±»ä¼¼çš„ï¼Œå¦‚æœä¸€å°ç¨åŠ¡ä¸»é¢˜çš„é‚®ä»¶æœ‰1000ä¸ªè¯è¯­ï¼Œå…¶ä¸­åªæœ‰â€œæ­£è§„å‘ç¥¨â€ã€â€œå‘ç¥¨â€ã€â€œé¿ç¨æ–¹æ³•â€3ä¸ªæƒé‡æ¯”è¾ƒå¤§çš„è¯è¯­ï¼Œå®ƒä»¬åªæ˜¯åœ¨æ­£æ–‡è¡¨è¿°ä¸­é¡ºå¸¦æåˆ°çš„å†…å®¹ã€‚å…³é”®è¯çš„å¯†åº¦è¢«è¾ƒé•¿çš„ç¯‡å¹…ç¨€é‡Šäº†ï¼Œåº”è¯¥ç®—æ˜¯æ­£å¸¸é‚®ä»¶ã€‚ä½†æ˜¯å´è¢«é˜ˆå€¼åˆ¤æ–­æˆæ•æ„Ÿé‚®ä»¶ï¼Œé€ æˆè¯¯åˆ¤äº†ã€‚è¿™ä¸¤ç§æƒ…å†µéƒ½è¯´æ˜topkå…³é”®è¯çš„æ–¹æ³•éœ€è¦è€ƒè™‘ç¯‡å¹…çš„å½±å“ã€‚è¿™é‡Œæœ‰è®¸å¤šç§å¤„ç†æ–¹å¼ï¼Œå®ƒä»¬çš„åŸºæœ¬æ€æƒ³éƒ½æ˜¯é€‰å–è¯è¯­çš„ä¸ªæ•°åŠå¯¹åº”çš„é˜ˆå€¼è¦ä¸ç¯‡å¹…çš„å¤§å°æˆæ­£æ¯”ï¼Œæœ¬æ–‡åªä»‹ç»å…¶ä¸­ä¸€ç§æ–¹æ–¹æ³•ï¼š å¯¹äºé•¿ç¯‡å¹…é‚®ä»¶ï¼ŒæŒ‰ä¸€å®šçš„å¤§å°ï¼Œæ¯”å¦‚æ¯500å­—ï¼Œå°†å…¶åˆ†å‰²æˆå°çš„æ–‡æœ¬æ®µè½ï¼Œå†å¯¹å°æ–‡æœ¬æ®µè½é‡‡ç”¨topkå…³é”®è¯çš„æ–¹æ³•ã€‚åªè¦å…¶ä¸­æœ‰ä¸€ä¸ªå°æ–‡æœ¬æ®µè½è¶…è¿‡é˜ˆå€¼å°±åˆ¤æ–­æ•´å°é‚®ä»¶æ˜¯åƒåœ¾é‚®ä»¶ã€‚ å¯¹äºè¶…çŸ­ç¯‡å¹…é‚®ä»¶ï¼Œæ¯”å¦‚50å­—ï¼Œå¯ä»¥æŒ‰ç¯‡å¹…ä¸æ ‡å‡†æ¯”è¾ƒç¯‡å¹…çš„æ¯”ä¾‹æ¥é€‰å–topkï¼Œä»¥ç¡®å®šåº”è¯¥åŒ¹é…å…³é”®è¯è¯­çš„ä¸ªæ•°ã€‚æ¯”å¦‚é€‰å– 50500Ã—15â‰ˆ250500Ã—15â‰ˆ2 ä¸ªè¯è¯­è¿›è¡ŒåŒ¹é…ï¼Œç›¸åº”çš„é˜ˆå€¼å¯ä»¥æ˜¯ä¹‹å‰é˜ˆå€¼çš„ 215215 ã€‚ä»¥æ­¤æ¥åˆ¤æ–­åˆ™æ›´åˆç†ã€‚ 14.5 trick5ï¼šä½ç½®æƒé‡14.6 trick6ï¼šèœœç½æˆ‘ä»¬é€šè¿‡è¾›è¾›è‹¦è‹¦çš„ç»Ÿè®¡ä¸è®¡ç®—ï¼Œå¥½ä¸å®¹æ˜“å¾—åˆ°äº†ä¸åŒè¯è¯­çš„æƒé‡ã€‚ç„¶è€Œè¿™å¹¶ä¸æ˜¯ä¸€åŠ³æ°¸é€¸çš„ã€‚æˆ‘ä»¬æˆ‘ä»¬ä¹‹å‰äº¤ä»£è¿‡ï¼Œè¯è¯­åŠå…¶æƒé‡ä¼šéšç€æ—¶é—´ä¸æ–­å˜åŒ–ï¼Œéœ€è¦æ—¶ä¸æ—¶åœ°ç”¨æœ€æ–°çš„æ ·æœ¬æ¥è®­ç»ƒä»¥æ›´æ–°è¯è¯­åŠå…¶æƒé‡ã€‚ è€Œæœé›†æœ€æ–°åƒåœ¾é‚®ä»¶æœ‰ä¸€ä¸ªæŠ€å·§ï¼Œå°±æ˜¯éšä¾¿æ³¨å†Œä¸€äº›é‚®ç®±ï¼Œç„¶åå°†å®ƒä»¬å…¬å¸ƒåœ¨å„å¤§è®ºå›ä¸Šã€‚æ¥ä¸‹æ¥å°±åç­‰ä¸€ä¸ªæœˆï¼Œåˆ°æ—¶å€™æ”¶åˆ°çš„é‚®ä»¶å°±ç»å¤§éƒ¨åˆ†éƒ½æ˜¯åƒåœ¾é‚®ä»¶äº†ï¼ˆå¥½å¥¸è¯ˆï¼‰ã€‚å†æ‰¾ä¸€äº›æ­£å¸¸çš„é‚®ä»¶ï¼ŒåŸºæœ¬å°±èƒ½å¤Ÿè®­ç»ƒäº†ã€‚è¿™äº›ç”¨äºè‡ªåŠ¨æœé›†åƒåœ¾é‚®ä»¶çš„é‚®ç®±å«åšâ€œèœœç½â€ã€‚â€œèœœç½â€æ˜¯ç½‘ç»œå®‰å…¨é¢†åŸŸå¸¸ç”¨çš„æ‰‹æ®µï¼Œå› å…¶åŸç†ç±»ä¼¼è¯±æ•æ˜†è™«çš„è£…æœ‰èœœçš„ç½å­è€Œå¾—åã€‚æ¯”å¦‚æ€æ¯’è½¯ä»¶å…¬å¸ä¼šåˆ©ç”¨èœœç½æ¥ç›‘è§†æˆ–è·å¾—è®¡ç®—æœºç½‘ç»œä¸­çš„ç—…æ¯’æ ·æœ¬ã€æ”»å‡»è¡Œä¸ºç­‰ã€‚ 15. è´å¶æ–¯æ–¹æ³•çš„æ€ç»´æ–¹å¼15.1 é€†æ¦‚é—®é¢˜ P(Y|X)=\\frac{P(X|Y)P(Y)}{P(X)}å…ˆä¸è€ƒè™‘å…ˆéªŒæ¦‚ç‡ $P(Y)$ ä¸ $P(X)$ ï¼Œè§‚å¯Ÿä¸¤ä¸ªåéªŒæ¦‚ç‡ $P(Y|X)$ ä¸ $P(X|Y)$ï¼Œå¯è§è´å¶æ–¯å…¬å¼èƒ½å¤Ÿæ­ç¤ºä¸¤ä¸ªç›¸åæ–¹å‘çš„æ¡ä»¶æ¦‚ç‡ä¹‹é—´çš„è½¬æ¢å…³ç³»ã€‚ ä»è´å¶æ–¯å†å²æ¥çœ‹, å…¶å°±æ˜¯ä¸ºäº†å¤„ç†æ‰€è°“ â€œé€†æ¦‚â€ é—®é¢˜è€Œè¯ç”Ÿçš„ã€‚æ¯”å¦‚ $P(Y|X)$ ä¸èƒ½é€šè¿‡ç›´æ¥è§‚æµ‹æ¥å¾—åˆ°ç»“æœï¼Œè€Œ $P(X|Y)$ å´å®¹æ˜“é€šè¿‡ç›´æ¥è§‚æµ‹å¾—åˆ°ç»“æœï¼Œå°±å¯ä»¥é€šè¿‡è´å¶æ–¯å…¬å¼ä»é—´æ¥åœ°è§‚æµ‹å¯¹è±¡å»æ¨æ–­ä¸å¯ç›´æ¥è§‚æµ‹çš„å¯¹è±¡çš„æƒ…å†µã€‚ äººè¯ç‰ˆæœ¬: åŸºäºé‚®ä»¶çš„æ–‡æœ¬å†…å®¹åˆ¤æ–­å…¶å±äºåƒåœ¾é‚®ä»¶çš„æ¦‚ç‡ä¸å¥½æ±‚ï¼ˆä¸å¯é€šè¿‡ç›´æ¥è§‚æµ‹ã€ç»Ÿè®¡å¾—åˆ°ï¼‰ï¼Œä½†æ˜¯åŸºäºå·²ç»æœé›†å¥½çš„åƒåœ¾é‚®ä»¶æ ·æœ¬ï¼Œå»ç»Ÿè®¡ï¼ˆç›´æ¥è§‚æµ‹ï¼‰å…¶æ–‡æœ¬å†…éƒ¨å„ä¸ªè¯è¯­çš„æ¦‚ç‡å´éå¸¸æ–¹ä¾¿ã€‚è¿™å°±å¯ä»¥ç”¨è´å¶æ–¯æ–¹æ³•ã€‚ å¼•ç”³ä¸€æ­¥: åŸºäºæ ·æœ¬ç‰¹å¾å»åˆ¤æ–­å…¶æ‰€å±æ ‡ç­¾çš„æ¦‚ç‡ä¸å¥½æ±‚ï¼Œä½†æ˜¯åŸºäºå·²ç»æœé›†å¥½çš„æ‰“ä¸Šæ ‡ç­¾çš„æ ·æœ¬ï¼ˆæœ‰ç›‘ç£ï¼‰ï¼Œå´å¯ä»¥ç›´æ¥ç»Ÿè®¡å±äºåŒä¸€æ ‡ç­¾çš„æ ·æœ¬å†…éƒ¨å„ä¸ªç‰¹å¾çš„æ¦‚ç‡åˆ†å¸ƒã€‚å› æ­¤è´å¶æ–¯æ–¹æ³•çš„ç†è®ºè§†è§’é€‚ç”¨äºä¸€åˆ‡åˆ†ç±»é—®é¢˜çš„æ±‚è§£ã€‚ 15.2 å¤šåˆ†ç±»é—®é¢˜ åƒåœ¾é‚®ä»¶ ç§äººé‚®ä»¶ (æ­£å¸¸) å·¥ä½œé‚®ä»¶ (æ­£å¸¸) ç°åœ¨æœ‰è¿™ 3 ç±»é‚®ä»¶å„ 1 ä¸‡å°ä½œä¸ºæ ·æœ¬ã€‚éœ€è¦è®­ç»ƒå‡ºä¸€ä¸ªè´å¶æ–¯åˆ†ç±»å™¨ã€‚è¿™é‡Œä¾æ¬¡ç”¨ $Y_1,Y_2,Y_3$ è¡¨ç¤ºè¿™ä¸‰ç±»é‚®ä»¶ï¼Œç”¨ $X$ è¡¨ç¤ºè¢«åˆ¤æ–­çš„é‚®ä»¶ã€‚å¥—ç”¨è´å¶æ–¯å…¬å¼æœ‰ï¼š P(Y_1|X)=\\frac{P(X|Y_1)P(Y_1)}{P(X)} P(Y_2|X)=\\frac{P(X|Y_2)P(Y_2)}{P(X)} P(Y_3|X)=\\frac{P(X|Y_3)P(Y_3)}{P(X)}é€šè¿‡æ¯”è¾ƒ 3 ä¸ªæ¦‚ç‡å€¼çš„å¤§å°å³å¯å¾—åˆ° $X$ æ‰€å±çš„åˆ†ç±»ã€‚å‘ç°ä¸‰ä¸ªå¼å­çš„åˆ†æ¯ $P(X)$ ä¸€æ ·ï¼Œæ¯”è¾ƒå¤§å°æ—¶å¯ä»¥å¿½ç•¥ä¸è®¡ï¼Œäºæ˜¯å°±å¯ä»¥ç”¨ä¸‹é¢è¿™ä¸€ä¸ªå¼å­è¡¨è¾¾ä¸Šé¢ 3 å¼ï¼š P(Y_i|X)\\propto P(X|Y_i)P(Y_i) ï¼› i=1,2,3å…¶ä¸­ $\\propto$ è¡¨ç¤ºâ€œæ­£æ¯”äºâ€ã€‚è€Œ $P(X|Y_i)$ åˆ™æœ‰ä¸ªç‰¹åˆ«é«˜é€¼æ ¼çš„åå­—å«åš â€œä¼¼ç„¶å‡½æ•°â€ã€‚å…¶å®æŠŠå®ƒç›´æ¥ç†è§£æˆâ€œ $P(Yi|X)$ çš„é€†åæ¡ä»¶æ¦‚ç‡â€ å°±æ–¹ä¾¿äº†ã€‚ å¯¹äºä»»æ„å¤šåˆ†ç±»çš„é—®é¢˜éƒ½å¯ä»¥ç”¨è¿™æ ·çš„æ€è·¯å»ç†è§£ã€‚æ¯”å¦‚ æ–°é—»åˆ†ç±»ã€æƒ…æ„Ÿå–œæ€’å“€ä¹åˆ†ç±» ç­‰ç­‰ã€‚ 15.3 å…ˆéªŒæ¦‚ç‡çš„é—®é¢˜åœ¨åƒåœ¾é‚®ä»¶çš„ä¾‹å­ä¸­ï¼Œå…ˆéªŒæ¦‚ç‡éƒ½ç›¸ç­‰ï¼Œ $P(Y_1)=P(Y_2)=P(Y_3)=10000/30000=1/3$ï¼Œæ‰€ä»¥ä¸Šé¢æ˜¯å¼å­åˆå¯ä»¥è¿›ä¸€æ­¥åŒ–ç®€ï¼š P(Y\\_i|X)\\propto P(X|Y\\_i) ï¼› i=1,2,3åªéœ€æ¯”è¾ƒå³è¾¹å¼å­ï¼ˆä¹Ÿå°±æ˜¯â€œä¼¼ç„¶å‡½æ•°â€ï¼‰çš„å¤§å°å°±å¯ä»¥äº†ã€‚è¿™ç§æ–¹æ³•å°±æ˜¯ä¼ è¯´ä¸­çš„æœ€å¤§ä¼¼ç„¶æ³•: ä¸è€ƒè™‘å…ˆéªŒæ¦‚ç‡è€Œç›´æ¥æ¯”è¾ƒä¼¼ç„¶å‡½æ•°ã€‚ å…³äºé€‰å‡ºæœ€ä½³åˆ†ç±» $Y_i$ æ˜¯å¦è¦è€ƒè™‘å…ˆéªŒæ¦‚ç‡ $P(Y_i)$ çš„é—®é¢˜ï¼Œæ›¾ç»åœ¨é¢‘ç‡å­¦æ´¾å’Œè´å¶æ–¯å­¦æ´¾ä¹‹é—´äº§ç”Ÿäº†æ¿€çƒˆçš„æ•™æ´¾å†²çªã€‚ç»Ÿè®¡å­¦å®¶ï¼ˆé¢‘ç‡å­¦æ´¾ï¼‰è¯´ï¼šæˆ‘ä»¬è®©æ•°æ®è‡ªå·±è¯´è¯ã€‚è¨€ä¸‹ä¹‹æ„å°±æ˜¯è¦æ‘’å¼ƒå…ˆéªŒæ¦‚ç‡ã€‚è€Œè´å¶æ–¯å­¦æ´¾æ”¯æŒè€…åˆ™è¯´ï¼šæ•°æ®ä¼šæœ‰å„ç§å„æ ·çš„åå·®ï¼Œè€Œä¸€ä¸ªé è°±çš„å…ˆéªŒæ¦‚ç‡åˆ™å¯ä»¥å¯¹è¿™äº›éšæœºå™ªéŸ³åšåˆ°å¥å£®. æ¯”å¦‚æˆ‘ä»¬åœ¨é‡‡é›†åƒåœ¾é‚®ä»¶æ ·æœ¬çš„æ—¶å€™ï¼Œä¸å°å¿ƒdeleteæ‰äº†ä¸€åŠçš„æ•°æ®ï¼Œå°±å‰©ä¸‹5000å°é‚®ä»¶ã€‚åˆ™è®¡ç®—å‡ºæ¥çš„å…ˆéªŒæ¦‚ç‡ä¸º: P(Y_1)=5000/25000=1/5 P(Y\\_2)=P(Y\\_3)=10000/25000=2/5å¦‚æœè¿˜ç”¨è´å¶æ–¯æ–¹æ³•,å°±è¦åœ¨ä¼¼ç„¶å‡½æ•°åé¢ä¹˜ä¸Šå…ˆéªŒæ¦‚ç‡ã€‚æ¯”å¦‚ä¹‹å‰ç”¨æœ€å¤§ä¼¼ç„¶æ³•ç®—å‡º $Y_1$ åƒåœ¾é‚®ä»¶çš„æ¦‚ç‡å¤§ï¼Œä½†æ˜¯å› ä¸º $P(Y_1)$ ç‰¹åˆ«å°ï¼Œç”¨è´å¶æ–¯æ–¹æ³•å¾—å‡ºçš„ç»“æœæ˜¯ $Y_2$ ç§äººé‚®ä»¶çš„æ¦‚ç‡å¤§ã€‚é‚£ç›¸ä¿¡å“ªä¸ªå‘¢ï¼Ÿå…¶å®ï¼Œæˆ‘ä»¬åˆ æ‰äº†éƒ¨åˆ†å¸¦æ ‡ç­¾çš„æ ·æœ¬ï¼Œä»è®¡ç®—ç»“æœçœ‹ $P(Y1)$ï¼Œ$P(Y2)$ï¼Œ$P(Y3)$ çš„æ¦‚ç‡åˆ†å¸ƒå˜åŒ–äº†ï¼Œä½†å®é™…ä¸Šè¿™ä¸‰ä¸ªç±»åˆ«çš„çœŸå®åˆ†å¸ƒåº”è¯¥æ˜¯ä¸€ä¸ªå®¢è§‚çš„çŠ¶æ€ï¼Œä¸åº”è¯¥å› ä¸ºæˆ‘ä»¬çš„è®¡ç®—æ–¹æ³•è€Œå‘ç”Ÿå˜åŒ–ã€‚æ‰€ä»¥æ˜¯æˆ‘ä»¬è®¡ç®—å‡ºæ¥çš„å…ˆéªŒæ¦‚ç‡å¤±çœŸï¼Œåº”è¯¥æ”¾å¼ƒè¿™æ ·è®¡ç®—å‡ºæ¥çš„å…ˆéªŒæ¦‚ç‡ï¼Œè€Œç”¨æœ€å¤§ä¼¼ç„¶æ³•ã€‚ ä½†å³ä¾¿æˆ‘ä»¬ä¸åˆ æ‰ä¸€åŠåƒåœ¾é‚®ä»¶ï¼Œè¿™ä¸‰ç±»é‚®ä»¶çš„åˆ†å¸ƒå°±çœŸçš„æ˜¯ $1:1:1$ é‚£æ ·å¹³å‡å—ï¼Ÿé‚£ä¹Ÿæœªå¿…ã€‚æˆ‘ä»¬åªæ˜¯æŒ‰1:1:1è¿™æ ·çš„æ–¹å¼è¿›è¡Œäº†æŠ½æ ·è€Œå·²ï¼ŒçœŸæ­£åœ¨é‚®ç®±é‡Œæ”¶åˆ°çš„è¿™ä¸‰ç±»é‚®ä»¶çš„åˆ†å¸ƒå¯èƒ½å¹¶ä¸æ˜¯è¿™æ ·ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨æˆ‘ä»¬å¯¹äºå…ˆéªŒæ¦‚ç‡ä¸€æ— æ‰€çŸ¥æ—¶ï¼Œåªèƒ½å‡è®¾æ¯ç§çŒœæµ‹çš„å…ˆéªŒæ¦‚ç‡æ˜¯å‡ç­‰çš„ï¼ˆå…¶å®è¿™ä¹Ÿæ˜¯äººç±»ç»éªŒçš„ç»“æœï¼‰ï¼Œè¿™ä¸ªæ—¶å€™å°±åªæœ‰ç”¨æœ€å¤§ä¼¼ç„¶äº†ã€‚åœ¨ç°å®è¿ç”¨è¿‡ç¨‹ä¸­å¦‚æœå‘ç°æœ€å¤§ä¼¼ç„¶æ³•æœ‰åå·®ï¼Œå¯ä»¥è€ƒè™‘å¯¹ä¸åŒçš„ä¼¼ç„¶å‡½æ•°è®¾å®šä¸€äº›ç³»æ•°æˆ–è€…é˜ˆå€¼ï¼Œä½¿å…¶æ¥è¿‘çœŸå®æƒ…å†µã€‚ ä½†æ˜¯ï¼Œå¦‚æœæˆ‘ä»¬æœ‰è¶³å¤Ÿçš„è‡ªä¿¡ï¼Œè®­ç»ƒé›†ä¸­è¿™ä¸‰ç±»çš„æ ·æœ¬åˆ†å¸ƒçš„ç¡®å¾ˆæ¥è¿‘çœŸå®çš„æƒ…å†µï¼Œè¿™æ—¶å°±åº”è¯¥ç”¨è´å¶æ–¯æ–¹æ³•ã€‚éš¾æ€ªå‰é¢çš„è´å¶æ–¯å­¦æ´¾å¼ºè°ƒçš„æ˜¯â€œé è°±çš„å…ˆéªŒæ¦‚ç‡â€ã€‚æ‰€ä»¥è¯´è´å¶æ–¯å­¦æ´¾çš„é€‚ç”¨èŒƒå›´æ›´å¹¿ï¼Œå…³é”®è¦å…ˆéªŒæ¦‚ç‡é è°±ï¼Œè€Œé¢‘ç‡å­¦æ´¾æœ‰æ•ˆçš„å‰æä¹Ÿæ˜¯ä»–ä»¬çš„å…ˆéªŒæ¦‚ç‡åŒæ ·æ˜¯ç»éªŒç»Ÿè®¡çš„ç»“æœã€‚ 16. (æœ´ç´ )è´å¶æ–¯æ–¹æ³•çš„å¸¸è§åº”ç”¨è¤’è´¬åˆ†æ ä¸€ä¸ªæ¯”è¾ƒå¸¸è§çš„åº”ç”¨åœºæ™¯æ˜¯æƒ…æ„Ÿè¤’è´¬åˆ†æã€‚æ¯”å¦‚ä½ è¦ç»Ÿè®¡å¾®åšä¸Šäººä»¬å¯¹ä¸€ä¸ªæ–°ä¸Šæ˜ ç”µå½±çš„è¤’è´¬ç¨‹åº¦è¯„ä»·ï¼šå¥½ç‰‡è¿˜æ˜¯çƒ‚ç‰‡ã€‚ä½†æ˜¯ä¸€æ¡ä¸€æ¡åœ°çœ‹å¾®åšæ˜¯æ ¹æœ¬çœ‹ä¸è¿‡æ¥ï¼Œåªèƒ½ç”¨è‡ªåŠ¨åŒ–çš„æ–¹æ³•ã€‚æˆ‘ä»¬å¯ä»¥æœ‰ä¸€ä¸ªå¾ˆç²—ç•¥çš„æ€è·¯ï¼š é¦–å…ˆæ˜¯ç”¨çˆ¬è™«å°†å¾®åšä¸Šæåˆ°è¿™ä¸ªç”µå½±åå­—çš„å¾®åšå…¨éƒ½æŠ“å–ä¸‹æ¥ï¼Œæ¯”å¦‚æœ‰10ä¸‡æ¡ã€‚ ç„¶åç”¨è®­ç»ƒå¥½çš„æœ´ç´ è´å¶æ–¯åˆ†ç±»å™¨åˆ†åˆ«åˆ¤æ–­è¿™äº›å¾®åšå¯¹ç”µå½±æ˜¯å¥½è¯„è¿˜æ˜¯å·®è¯„ã€‚ æœ€åç»Ÿè®¡å‡ºè¿™äº›å¥½è¯„çš„å½±è¯„å æ‰€æœ‰æ ·æœ¬ä¸­çš„æ¯”ä¾‹ï¼Œå°±èƒ½å½¢æˆå¾®åšç½‘å‹å¯¹è¿™ä¸ªç”µå½±ç»¼åˆè¯„ä»·çš„å¤§è‡´ä¼°è®¡ã€‚ æ¥ä¸‹æ¥çš„æ ¸å¿ƒé—®é¢˜å°±æ˜¯è®­ç»ƒå‡ºä¸€ä¸ªé è°±çš„åˆ†ç±»å™¨ã€‚é¦–å…ˆéœ€è¦æœ‰æ‰“å¥½æ ‡ç­¾çš„æ–‡æœ¬ã€‚è¿™ä¸ªå¥½æ‰¾ï¼Œè±†ç“£å½±è¯„ä¸Šå°±æœ‰å¤§é‡ç½‘å‹å¯¹ä¹‹å‰ç”µå½±çš„è¯„ä»·ï¼Œå¹¶ä¸”å¯¹ç”µå½±è¿›è¡Œ1æ˜Ÿåˆ°5æ˜Ÿçš„è¯„ä»·ã€‚æˆ‘ä»¬å¯ä»¥è®¤ä¸º3æ˜Ÿä»¥ä¸Šçš„è¯„è®ºéƒ½æ˜¯å¥½è¯„ï¼Œ3æ˜Ÿä»¥ä¸‹çš„è¯„è®ºéƒ½æ˜¯å·®è¯„ã€‚è¿™æ ·å°±åˆ†åˆ«å¾—åˆ°äº†å¥½è¯„å·®è¯„ä¸¤ç±»çš„è¯­æ–™æ ·æœ¬ã€‚å‰©ä¸‹å°±å¯ä»¥ç”¨æœ´ç´ è´å¶æ–¯æ–¹æ³•è¿›è¡Œè®­ç»ƒäº†ã€‚åŸºæœ¬æ€è·¯å¦‚ä¸‹ï¼š è®­ç»ƒä¸æµ‹è¯•æ ·æœ¬ï¼šè±†ç“£å½±è¯„çš„ç½‘å‹è¯„è®ºï¼Œç”¨çˆ¬è™«æŠ“å–ä¸‹100ä¸‡æ¡ã€‚ æ ‡ç­¾ï¼š3æ˜Ÿä»¥ä¸Šçš„æ˜¯å¥½è¯„ï¼Œ3æ˜Ÿä»¥ä¸‹çš„æ˜¯å·®è¯„ã€‚ ç‰¹å¾ï¼šè±†ç“£è¯„è®ºåˆ†è¯åçš„è¯è¯­ã€‚ä¸€ä¸ªç®€å•çš„æ–¹æ³•æ˜¯åªé€‰æ‹©å…¶ä¸­çš„å½¢å®¹è¯ï¼Œç½‘ä¸Šæœ‰å¤§é‡çš„æƒ…ç»ªè¯åº“å¯ä»¥ä¸ºæˆ‘ä»¬æ‰€ç”¨ã€‚ ç„¶åå†ç”¨å¸¸è§„çš„æœ´ç´ è´å¶æ–¯æ–¹æ³•è¿›è¡Œè®­ç»ƒã€‚ ä½†æ˜¯ç”±äºè‡ªç„¶è¯­è¨€çš„ç‰¹ç‚¹ï¼Œåœ¨æå–ç‰¹å¾çš„è¿‡ç¨‹å½“ä¸­ï¼Œæœ‰ä¸€äº›trickséœ€è¦æ³¨æ„ å¯¹å¦å®šå¥è¿›è¡Œç‰¹åˆ«çš„å¤„ç†ã€‚æ¯”å¦‚è¿™å¥è¯â€œæˆ‘ä¸æ˜¯å¾ˆå–œæ¬¢éƒ¨ç”µå½±ï¼Œå› ä¸ºå®ƒè®©æˆ‘å¼€å¿ƒä¸èµ·æ¥ã€‚â€å…¶ä¸­ä¸¤ä¸ªå½¢å®¹è¯â€œå–œæ¬¢â€ã€â€œå¼€å¿ƒâ€éƒ½æ˜¯è¤’ä¹‰è¯ï¼Œä½†æ˜¯å› ä¸ºå¥å­çš„å¦å®šå¥ï¼Œæ‰€ä»¥æ•´ä½“æ˜¯è´¬ä¹‰çš„ã€‚æœ‰ä¸€ç§æ¯”è¾ƒç®€å•ç²—æš´çš„å¤„ç†æ–¹å¼ï¼Œå°±æ˜¯â€œå¯¹å¦å®šè¯ï¼ˆâ€œä¸â€ã€â€œéâ€ã€â€œæ²¡â€ç­‰ï¼‰ä¸å¥å°¾æ ‡ç‚¹ä¹‹é—´çš„æ‰€æœ‰å½¢å®¹è¯éƒ½é‡‡ç”¨å…¶å¦å®šå½¢å¼â€ ã€‚åˆ™è¿™å¥è¯ä¸­æå–å‡ºæ¥çš„å½¢å®¹è¯å°±åº”è¯¥æ˜¯â€œä¸å–œæ¬¢â€å’Œâ€œä¸å¼€å¿ƒâ€ã€‚ ä¸€èˆ¬è¯´æ¥ï¼Œæœ€ç›¸å…³çš„æƒ…æ„Ÿè¯åœ¨ä¸€äº›æ–‡æœ¬ç‰‡æ®µä¸­ä»…ä»…å‡ºç°ä¸€æ¬¡ï¼Œè¯é¢‘æ¨¡å‹èµ·å¾—ä½œç”¨æœ‰é™ï¼Œç”šè‡³æ˜¯è´Ÿä½œç”¨ï¼Œåˆ™ä½¿ç”¨ä¼¯åŠªåˆ©æ¨¡å‹ä»£æ›¿å¤šé¡¹å¼æ¨¡å‹ã€‚è¿™ç§æƒ…å†µåœ¨å¾®åšè¿™æ ·çš„å°ç¯‡å¹…æ–‡æœ¬ä¸­ä¼¼ä¹ä¸å¤ªæ˜æ˜¾ï¼Œä½†æ˜¯åœ¨åšå®¢ã€ç©ºé—´ã€è®ºå›ä¹‹ç±»å…è®¸é•¿ç¯‡å¹…æ–‡æœ¬å‡ºç°çš„å¹³å°ä¸­éœ€è¦æ³¨æ„ã€‚ å…¶å®ï¼Œå‰¯è¯å¯¹æƒ…æ„Ÿçš„è¯„ä»·æœ‰ä¸€å®šå½±å“ã€‚â€œä¸å¾ˆå–œæ¬¢â€ä¸â€œå¾ˆä¸å–œæ¬¢â€çš„ç¨‹åº¦å°±æœ‰å¾ˆå¤§å·®å¼‚ã€‚ä½†å¦‚æœæ˜¯æœ´ç´ è´å¶æ–¯æ–¹æ³•çš„è¯æ¯”è¾ƒéš¾å¤„ç†è¿™æ ·çš„æƒ…å†µã€‚æˆ‘ä»¬å¯ä»¥è€ƒè™‘ç”¨è¯­è¨€æ¨¡å‹æˆ–è€…åŠ å…¥è¯æ€§æ ‡æ³¨çš„ä¿¡æ¯è¿›è¡Œç»¼åˆåˆ¤æ–­ã€‚è¿™äº›å†…å®¹æˆ‘ä»¬å°†åœ¨ä¹‹åè¿›è¡Œæ¢è®¨ã€‚ å½“ç„¶ç»è¿‡ä»¥ä¸Šçš„å¤„ç†ï¼Œæƒ…æ„Ÿåˆ†æè¿˜æ˜¯ä¼šæœ‰ä¸€éƒ¨åˆ†è¯¯åˆ¤ã€‚è¿™é‡Œæ¶‰åŠåˆ°è®¸å¤šé—®é¢˜ï¼Œéƒ½æ˜¯æƒ…æ„Ÿåˆ†æçš„éš¾ç‚¹ï¼š æƒ…ç»ªè¡¨è¾¾çš„å«è“„å¾®å¦™ï¼šâ€œå¯¼æ¼”ä½ å‡ºæ¥ï¼Œæˆ‘ä¿è¯ä¸æ‰“æ­»ä½ ã€‚â€ä½ è®©æœºå™¨æ€ä¹ˆåˆ¤æ–­æ˜¯è¤’è¿˜æ˜¯è´¬ï¼Ÿ è½¬æŠ˜æ€§è¡¨è¾¾ï¼šâ€œæˆ‘éå¸¸å–œæ¬¢è¿™äº›å¤§ç‰Œæ¼”å‘˜ï¼Œéå¸¸å´‡æ‹œè¿™ä¸ªå¯¼æ¼”ï¼Œéå¸¸èµèµè¿™ä¸ªå‰§æœ¬ï¼Œéå¸¸æ¬£èµä»–ä»¬çš„é¢„å‘Šç‰‡ï¼Œæˆ‘ç”šè‡³ä¸ºäº†è¿™éƒ¨å½±ç‰‡æ•´æ•´æœŸå¾…äº†ä¸€å¹´ï¼Œæœ€åè¿›äº†ç”µå½±é™¢å‘ç°è¿™æ˜¯ä¸ªå™©æ¢¦ã€‚â€ äº”ä¸ªè¤’ä¹‰çš„å½¢å®¹è¯ã€å‰¯è¯å¯¹ä¸€ä¸ªä¸é‚£ä¹ˆè´¬ä¹‰çš„è¯ã€‚æœºå™¨è‡ªç„¶åˆ¤æ–­æˆè¤’ä¹‰ï¼Œä½†è¿™å¥è¯æ˜¯å¦¥å¦¥çš„è´¬ä¹‰ã€‚ 17. å†…å®¹å°ç»“ä»å‰é¢å¤§å®¶åŸºæœ¬å¯ä»¥çœ‹å‡ºï¼Œå·¥ç¨‹åº”ç”¨ä¸åŒäºå­¦æœ¯ç†è®ºï¼Œæœ‰è®¸å¤štrickséœ€è¦è€ƒè™‘ï¼Œè€Œç†è®ºæœ¬è´¨å°±æ˜¯ç¿»æ¥å€’å»æŠ˜è…¾è´å¶æ–¯å…¬å¼ï¼Œéƒ½å¿«ç©å‡ºèŠ±æ¥äº†ã€‚","categories":[{"name":"machine-learning","slug":"machine-learning","permalink":"http://iequa.com/categories/machine-learning/"}],"tags":[{"name":"Bayes","slug":"Bayes","permalink":"http://iequa.com/tags/Bayes/"}]},{"title":"Python å­—ç¬¦ä¸²å¤„ç†-æ­£åˆ™è¡¨è¾¾å¼","slug":"nlp/string-operation-re","date":"2017-07-30T10:08:21.000Z","updated":"2019-10-20T04:30:35.071Z","comments":true,"path":"2017/07/30/nlp/string-operation-re/","link":"","permalink":"http://iequa.com/2017/07/30/nlp/string-operation-re/","excerpt":"Python å­—ç¬¦ä¸²å¤„ç† ä¹‹ æ­£åˆ™è¡¨è¾¾å¼ Github-ipynb å­—ç¬¦ä¸²æ“ä½œæˆ‘ä»¬ä¸€èµ·å›å½’ä¸€ä¸‹pythonå­—ç¬¦ä¸²çš„ç›¸å…³æ“ä½œï¼Œè¿™æ˜¯éå¸¸åŸºç¡€çš„çŸ¥è¯†ï¼Œä½†å´æ˜¯ä½¿ç”¨é¢‘åº¦éå¸¸é«˜çš„ä¸€äº›åŠŸèƒ½ã€‚","text":"Python å­—ç¬¦ä¸²å¤„ç† ä¹‹ æ­£åˆ™è¡¨è¾¾å¼ Github-ipynb å­—ç¬¦ä¸²æ“ä½œæˆ‘ä»¬ä¸€èµ·å›å½’ä¸€ä¸‹pythonå­—ç¬¦ä¸²çš„ç›¸å…³æ“ä½œï¼Œè¿™æ˜¯éå¸¸åŸºç¡€çš„çŸ¥è¯†ï¼Œä½†å´æ˜¯ä½¿ç”¨é¢‘åº¦éå¸¸é«˜çš„ä¸€äº›åŠŸèƒ½ã€‚ 1.1 å»ç©ºæ ¼åŠç‰¹æ®Šç¬¦å·s = &#x27; hello, world!&#x27;print s.strip()print s.lstrip(&#x27; hello, &#x27;)print s.rstrip(&#x27;!&#x27;) hello, world! world! hello, world 1.2 è¿æ¥å­—ç¬¦ä¸²sStr1 = &#x27;strcat&#x27;sStr2 = &#x27;append&#x27;sStr1 += sStr2print sStr1 strcatappend 1.3 æŸ¥æ‰¾å­—ç¬¦# &lt; 0 ä¸ºæœªæ‰¾åˆ°sStr1 = &#x27;strchr&#x27;sStr2 = &#x27;r&#x27;nPos = sStr1.index(sStr2)print nPos 2 1.4 è¾ƒå­—ç¬¦ä¸²sStr1 = &#x27;strchr&#x27;sStr2 = &#x27;strch&#x27;print cmp(sStr2,sStr1)print cmp(sStr1,sStr2)print cmp(sStr1,sStr1) -1 1 0 1.5 å¤§å°å†™è½¬æ¢sStr1 = &#x27;JCstrlwr&#x27;sStr1 = sStr1.upper()#sStr1 = sStr1.lower()print sStr1 JCSTRLWR 1.6 ç¿»è½¬å­—ç¬¦ä¸²sStr1 = &#x27;abcdefg&#x27;sStr1 = sStr1[::-1]print sStr1 gfedcba 1.7 æŸ¥æ‰¾å­—ç¬¦ä¸²sStr1 = &#x27;abcdefg&#x27;sStr2 = &#x27;cde&#x27;print sStr1.find(sStr2) 2 1.8 åˆ†å‰²å­—ç¬¦ä¸²sStr1 = &#x27;ab,cde,fgh,ijk&#x27;sStr2 = &#x27;,&#x27;sStr1 = sStr1[sStr1.find(sStr2) + 1:]print sStr1#æˆ–è€…s = &#x27;ab,cde,fgh,ijk&#x27;print(s.split(&#x27;,&#x27;)) cde,fgh,ijk [&#39;ab&#39;, &#39;cde&#39;, &#39;fgh&#39;, &#39;ijk&#39;] 1.9 é¢‘æ¬¡æœ€é«˜çš„å­—æ¯#version 1import refrom collections import Counterdef get_max_value_v1(text): text = text.lower() result = re.findall(&#x27;[a-zA-Z]&#x27;, text) # å»æ‰åˆ—è¡¨ä¸­çš„ç¬¦å·ç¬¦ count = Counter(result) # Counter(&#123;&#x27;l&#x27;: 3, &#x27;o&#x27;: 2, &#x27;d&#x27;: 1, &#x27;h&#x27;: 1, &#x27;r&#x27;: 1, &#x27;e&#x27;: 1, &#x27;w&#x27;: 1&#125;) count_list = list(count.values()) max_value = max(count_list) max_list = [] for k, v in count.items(): if v == max_value: max_list.append(k) max_list = sorted(max_list) return max_list[0] #version 2from collections import Counterdef get_max_value(text): count = Counter([x for x in text.lower() if x.isalpha()]) m = max(count.values()) return sorted([x for (x, y) in count.items() if y == m])[0] #version 3import stringdef get_max_value(text): text = text.lower() return max(string.ascii_lowercase, key=text.count) max(range(6), key = lambda x : x&gt;2)# &gt;&gt;&gt; 3# å¸¦å…¥keyå‡½æ•°ä¸­ï¼Œå„ä¸ªå…ƒç´ è¿”å›å¸ƒå°”å€¼ï¼Œç›¸å½“äº[False, False, False, True, True, True]# keyå‡½æ•°è¦æ±‚è¿”å›å€¼ä¸ºTrueï¼Œæœ‰å¤šä¸ªç¬¦åˆçš„å€¼ï¼Œåˆ™æŒ‘é€‰ç¬¬ä¸€ä¸ªã€‚max([3,5,2,1,4,3,0], key = lambda x : x)# &gt;&gt;&gt; 5# å¸¦å…¥keyå‡½æ•°ä¸­ï¼Œå„ä¸ªå…ƒç´ è¿”å›è‡ªèº«çš„å€¼ï¼Œæœ€å¤§çš„å€¼ä¸º5ï¼Œè¿”å›5.max(&#x27;ah&#x27;, &#x27;bf&#x27;, key=lambda x: x[1])# &gt;&gt;&gt; &#x27;ah&#x27;# å¸¦å…¥keyå‡½æ•°ï¼Œå„ä¸ªå­—ç¬¦ä¸²è¿”å›æœ€åä¸€ä¸ªå­—ç¬¦ï¼Œå…¶ä¸­&#x27;ah&#x27;çš„hè¦å¤§äº&#x27;bf&#x27;ä¸­çš„fï¼Œå› æ­¤è¿”å›&#x27;ah&#x27;max(&#x27;ah&#x27;, &#x27;bf&#x27;, key=lambda x: x[0])# &gt;&gt;&gt; &#x27;bf&#x27;# å¸¦å…¥keyå‡½æ•°ï¼Œå„ä¸ªå­—ç¬¦ä¸²è¿”å›ç¬¬ä¸€ä¸ªå­—ç¬¦ï¼Œå…¶ä¸­&#x27;bf&#x27;çš„bè¦å¤§äº&#x27;ah&#x27;ä¸­çš„aï¼Œå› æ­¤è¿”å›&#x27;bf&#x27;text = &#x27;Hello World&#x27;max(&#x27;abcdefghijklmnopqrstuvwxyz&#x27;, key=text.count)# &gt;&gt;&gt; &#x27;l&#x27;# å¸¦å…¥keyå‡½æ•°ï¼Œè¿”å›å„ä¸ªå­—ç¬¦åœ¨&#x27;Hello World&#x27;ä¸­å‡ºç°çš„æ¬¡æ•°ï¼Œå‡ºç°æ¬¡æ•°æœ€å¤šçš„å­—ç¬¦ä¸º&#x27;l&#x27;,å› æ­¤è¾“å‡º&#x27;l&#x27; &#39;l&#39; Count occurrence of a character in a Python string#T h e M i s s i s s i p p i R i v e r#[1, 1, 2, 2, 1, 5, 4, 4, 5, 4, 4, 5, 2, 2, 5, 2, 1, 5, 1, 2, 1]sentence=&#x27;The Mississippi River&#x27;def count_chars(s): s=s.lower() count=list(map(s.count,s)) return (max(count))print count_chars(sentence) 5","categories":[{"name":"nlp","slug":"nlp","permalink":"http://iequa.com/categories/nlp/"}],"tags":[{"name":"python-re","slug":"python-re","permalink":"http://iequa.com/tags/python-re/"}]},{"title":"Jieba ä¸­æ–‡å¤„ç†","slug":"nlp/jieba","date":"2017-07-29T10:08:21.000Z","updated":"2019-10-20T04:30:35.070Z","comments":true,"path":"2017/07/29/nlp/jieba/","link":"","permalink":"http://iequa.com/2017/07/29/nlp/jieba/","excerpt":"NLP åŸºç¡€æŠ€èƒ½ ï¼š Jieba ä¸­æ–‡åˆ†è¯ä¸å¤„ç† Github-ipynb","text":"NLP åŸºç¡€æŠ€èƒ½ ï¼š Jieba ä¸­æ–‡åˆ†è¯ä¸å¤„ç† Github-ipynb è¯æ±‡æ˜¯æˆ‘ä»¬å¯¹å¥å­å’Œæ–‡ç« ç†è§£çš„åŸºç¡€ï¼Œå› æ­¤éœ€è¦ä¸€ä¸ªå·¥å…·å»æŠŠå®Œæ•´çš„æ–‡æœ¬ä¸­åˆ†è§£æˆç²’åº¦æ›´ç»†çš„è¯ jieba å°±æ˜¯è¿™æ ·ä¸€ä¸ªéå¸¸å¥½ç”¨çš„ä¸­æ–‡å·¥å…·ï¼Œæ˜¯ä»¥åˆ†è¯èµ·å®¶çš„ï¼Œä½†æ˜¯åŠŸèƒ½æ¯”åˆ†è¯è¦å¼ºå¤§å¾ˆå¤šã€‚ 1. åŸºæœ¬åˆ†è¯å‡½æ•°ä¸ç”¨æ³• jieba.cut jieba.cut_for_search è¿”å›çš„ç»“æ„éƒ½æ˜¯ä¸€ä¸ªå¯è¿­ä»£çš„ generatorï¼Œå¯ä»¥ä½¿ç”¨ for å¾ªç¯æ¥è·å¾—åˆ†è¯åå¾—åˆ°çš„æ¯ä¸€ä¸ªè¯è¯­(unicode) jieba.cut æ–¹æ³•æ¥å—ä¸‰ä¸ªè¾“å…¥å‚æ•°: éœ€è¦åˆ†è¯çš„å­—ç¬¦ä¸² cut_all å‚æ•°ç”¨æ¥æ§åˆ¶æ˜¯å¦é‡‡ç”¨å…¨æ¨¡å¼ HMM å‚æ•°ç”¨æ¥æ§åˆ¶æ˜¯å¦ä½¿ç”¨ HMM æ¨¡å‹ jieba.cut_for_search æ–¹æ³•æ¥å—ä¸¤ä¸ªå‚æ•° éœ€è¦åˆ†è¯çš„å­—ç¬¦ä¸² æ˜¯å¦ä½¿ç”¨ HMM æ¨¡å‹ã€‚ è¯¥æ–¹æ³•é€‚åˆç”¨äºæœç´¢å¼•æ“æ„å»ºå€’æ’ç´¢å¼•çš„åˆ†è¯ï¼Œç²’åº¦æ¯”è¾ƒç»† # encoding=utf-8import jiebaseg_list = jieba.cut(&quot;æˆ‘åœ¨å­¦ä¹ è‡ªç„¶è¯­è¨€å¤„ç†&quot;, cut_all=True)print seg_listprint(&quot;Full Mode: &quot; + &quot;/ &quot;.join(seg_list)) # å…¨æ¨¡å¼seg_list = jieba.cut(&quot;æˆ‘åœ¨å­¦ä¹ è‡ªç„¶è¯­è¨€å¤„ç†&quot;, cut_all=False)print(&quot;Default Mode: &quot; + &quot;/ &quot;.join(seg_list)) # ç²¾ç¡®æ¨¡å¼seg_list = jieba.cut(&quot;ä»–æ¯•ä¸šäºä¸Šæµ·äº¤é€šå¤§å­¦ï¼Œåœ¨ç™¾åº¦æ·±åº¦å­¦ä¹ ç ”ç©¶é™¢è¿›è¡Œç ”ç©¶&quot;) # é»˜è®¤æ˜¯ç²¾ç¡®æ¨¡å¼print(&quot;, &quot;.join(seg_list))seg_list = jieba.cut_for_search(&quot;å°æ˜ç¡•å£«æ¯•ä¸šäºä¸­å›½ç§‘å­¦é™¢è®¡ç®—æ‰€ï¼Œååœ¨å“ˆä½›å¤§å­¦æ·±é€ &quot;) # æœç´¢å¼•æ“æ¨¡å¼print(&quot;, &quot;.join(seg_list)) Building prefix dict from the default dictionary ...&lt;generator object cut at 0x110370460&gt;Dumping model to file cache /var/folders/mf/_jgd83rx0rgcmt42cp7fkkd00000gn/T/jieba.cacheLoading model cost 2.184 seconds.Prefix dict has been built succesfully.Full Mode: æˆ‘/ åœ¨/ å­¦ä¹ / è‡ªç„¶/ è‡ªç„¶è¯­è¨€/ è¯­è¨€/ å¤„ç†Default Mode: æˆ‘/ åœ¨/ å­¦ä¹ / è‡ªç„¶è¯­è¨€/ å¤„ç†ä»–, æ¯•ä¸š, äº, ä¸Šæµ·äº¤é€šå¤§å­¦, ï¼Œ, åœ¨, ç™¾åº¦, æ·±åº¦, å­¦ä¹ , ç ”ç©¶é™¢, è¿›è¡Œ, ç ”ç©¶å°æ˜, ç¡•å£«, æ¯•ä¸š, äº, ä¸­å›½, ç§‘å­¦, å­¦é™¢, ç§‘å­¦é™¢, ä¸­å›½ç§‘å­¦é™¢, è®¡ç®—, è®¡ç®—æ‰€, ï¼Œ, å, åœ¨, å“ˆä½›, å¤§å­¦, å“ˆä½›å¤§å­¦, æ·±é€  jieba.lcut ä»¥åŠ jieba.lcut_for_search ç›´æ¥è¿”å› list result_lcut = jieba.lcut(&quot;å°æ˜ç¡•å£«æ¯•ä¸šäºä¸­å›½ç§‘å­¦é™¢è®¡ç®—æ‰€ï¼Œååœ¨å“ˆä½›å¤§å­¦æ·±é€ &quot;)print result_lcutprint &quot; &quot;.join(result_lcut)print &quot; &quot;.join(jieba.lcut_for_search(&quot;å°æ˜ç¡•å£«æ¯•ä¸šäºä¸­å›½ç§‘å­¦é™¢è®¡ç®—æ‰€ï¼Œååœ¨å“ˆä½›å¤§å­¦æ·±é€ &quot;)) [u&#x27;\\u5c0f\\u660e&#x27;, u&#x27;\\u7855\\u58eb&#x27;, u&#x27;\\u6bd5\\u4e1a&#x27;, u&#x27;\\u4e8e&#x27;, u&#x27;\\u4e2d\\u56fd\\u79d1\\u5b66\\u9662&#x27;, u&#x27;\\u8ba1\\u7b97\\u6240&#x27;, u&#x27;\\uff0c&#x27;, u&#x27;\\u540e&#x27;, u&#x27;\\u5728&#x27;, u&#x27;\\u54c8\\u4f5b\\u5927\\u5b66&#x27;, u&#x27;\\u6df1\\u9020&#x27;]å°æ˜ ç¡•å£« æ¯•ä¸š äº ä¸­å›½ç§‘å­¦é™¢ è®¡ç®—æ‰€ ï¼Œ å åœ¨ å“ˆä½›å¤§å­¦ æ·±é€ å°æ˜ ç¡•å£« æ¯•ä¸š äº ä¸­å›½ ç§‘å­¦ å­¦é™¢ ç§‘å­¦é™¢ ä¸­å›½ç§‘å­¦é™¢ è®¡ç®— è®¡ç®—æ‰€ ï¼Œ å åœ¨ å“ˆä½› å¤§å­¦ å“ˆä½›å¤§å­¦ æ·±é€  1.1 æ·»åŠ ç”¨æˆ·è‡ªå®šä¹‰è¯å…¸å¾ˆå¤šæ—¶å€™æˆ‘ä»¬éœ€è¦é’ˆå¯¹è‡ªå·±çš„åœºæ™¯è¿›è¡Œåˆ†è¯ï¼Œä¼šæœ‰ä¸€äº›é¢†åŸŸå†…çš„ä¸“æœ‰è¯æ±‡ã€‚ å¯ä»¥ç”¨ jieba.load_userdict(file_name) åŠ è½½ç”¨æˆ·å­—å…¸ å°‘é‡çš„è¯æ±‡å¯ä»¥è‡ªå·±ç”¨ä¸‹é¢æ–¹æ³•æ‰‹åŠ¨æ·»åŠ ï¼š ç”¨ add_word(word, freq=None, tag=None) å’Œ del_word(word) åœ¨ç¨‹åºä¸­åŠ¨æ€ä¿®æ”¹è¯å…¸ç”¨ suggest_freq(segment, tune=True) å¯è°ƒèŠ‚å•ä¸ªè¯è¯­çš„è¯é¢‘ï¼Œä½¿å…¶èƒ½ï¼ˆæˆ–ä¸èƒ½ï¼‰è¢«åˆ†å‡ºæ¥ã€‚ print(&#x27;/&#x27;.join(jieba.cut(&#x27;å¦‚æœæ”¾åˆ°æ—§å­—å…¸ä¸­å°†å‡ºé”™ã€‚&#x27;, HMM=False)))print jieba.suggest_freq((&#x27;ä¸­&#x27;, &#x27;å°†&#x27;), True)print(&#x27;/&#x27;.join(jieba.cut(&#x27;å¦‚æœæ”¾åˆ°æ—§å­—å…¸ä¸­å°†å‡ºé”™ã€‚&#x27;, HMM=False))) å¦‚æœ/æ”¾åˆ°/æ—§/å­—å…¸/ä¸­å°†/å‡ºé”™/ã€‚494å¦‚æœ/æ”¾åˆ°/æ—§/å­—å…¸/ä¸­/å°†/å‡ºé”™/ã€‚ 2. å…³é”®è¯æå–2.1 TF-IDF ç®—æ³•çš„å…³é”®è¯æŠ½å–import jieba.analysejieba.analyse.extract_tags(sentence, topK=20, withWeight=False, allowPOS=()) sentence ä¸ºå¾…æå–çš„æ–‡æœ¬ topK ä¸ºè¿”å›å‡ ä¸ª TF/IDF æƒé‡æœ€å¤§çš„å…³é”®è¯ï¼Œé»˜è®¤å€¼ä¸º 20 withWeight ä¸ºæ˜¯å¦ä¸€å¹¶è¿”å›å…³é”®è¯æƒé‡å€¼ï¼Œé»˜è®¤å€¼ä¸º False allowPOS ä»…åŒ…æ‹¬æŒ‡å®šè¯æ€§çš„è¯ï¼Œé»˜è®¤å€¼ä¸ºç©ºï¼Œå³ä¸ç­›é€‰ import jieba.analyse as analyselines = open(&#x27;NBA.txt&#x27;).read()print &quot; &quot;.join(analyse.extract_tags(lines, topK=20, withWeight=False, allowPOS=())) éŸ¦å°‘ æœå…°ç‰¹ å…¨æ˜æ˜Ÿ å…¨æ˜æ˜Ÿèµ› MVP å¨å°‘ æ­£èµ› ç§‘å°” æŠ•ç¯® å‹‡å£« çƒå‘˜ æ–¯å¸ƒé²å…‹ æ›´è¡£æŸœ å¼ å«å¹³ ä¸‰è¿åº„ NBA è¥¿éƒ¨ æŒ‡å¯¼ é›·éœ† æ˜æ˜Ÿé˜Ÿ lines = open(u&#x27;è¥¿æ¸¸è®°.txt&#x27;).read()print &quot; &quot;.join(analyse.extract_tags(lines, topK=20, withWeight=False, allowPOS=())) è¡Œè€… å…«æˆ’ å¸ˆçˆ¶ ä¸‰è— å”åƒ§ å¤§åœ£ æ²™åƒ§ å¦–ç²¾ è©è¨ å’Œå°š é‚£æ€ª é‚£é‡Œ é•¿è€ å‘†å­ å¾’å¼Ÿ æ€ä¹ˆ ä¸çŸ¥ è€å­™ å›½ç‹ ä¸€ä¸ª 2.2 TF-IDF å…³é”®è¯æŠ½å–è¡¥å……å…³é”®è¯æå–æ‰€ä½¿ç”¨é€†å‘æ–‡ä»¶é¢‘ç‡ï¼ˆIDFï¼‰æ–‡æœ¬è¯­æ–™åº“å¯ä»¥åˆ‡æ¢æˆè‡ªå®šä¹‰è¯­æ–™åº“çš„è·¯å¾„ ç”¨æ³•ï¼š jieba.analyse.set_idf_path(file_name) # file_nameä¸ºè‡ªå®šä¹‰è¯­æ–™åº“çš„è·¯å¾„ è‡ªå®šä¹‰è¯­æ–™åº“ç¤ºä¾‹è§è¿™é‡Œ ç”¨æ³•ç¤ºä¾‹è§è¿™é‡Œ å…³é”®è¯æå–æ‰€ä½¿ç”¨åœæ­¢è¯ï¼ˆStop Wordsï¼‰æ–‡æœ¬è¯­æ–™åº“å¯ä»¥åˆ‡æ¢æˆè‡ªå®šä¹‰è¯­æ–™åº“çš„è·¯å¾„ ç”¨æ³•ï¼š jieba.analyse.set_stop_words(file_name) # file_nameä¸ºè‡ªå®šä¹‰è¯­æ–™åº“çš„è·¯å¾„ è‡ªå®šä¹‰è¯­æ–™åº“ç¤ºä¾‹è§è¿™é‡Œ ç”¨æ³•ç¤ºä¾‹è§è¿™é‡Œ å…³é”®è¯ä¸€å¹¶è¿”å›å…³é”®è¯æƒé‡å€¼ç¤ºä¾‹ ç”¨æ³•ç¤ºä¾‹è§è¿™é‡Œ 2.3 TextRank çš„å…³é”®è¯æŠ½å– jieba.analyse.textrank(sentence, topK=20, withWeight=False, allowPOS=(â€˜nsâ€™, â€˜nâ€™, â€˜vnâ€™, â€˜vâ€™)) ç›´æ¥ä½¿ç”¨ï¼Œæ¥å£ç›¸åŒï¼Œæ³¨æ„é»˜è®¤è¿‡æ»¤è¯æ€§ã€‚ jieba.analyse.TextRank() æ–°å»ºè‡ªå®šä¹‰ TextRank å®ä¾‹ ç®—æ³•è®ºæ–‡ï¼š TextRank: Bringing Order into Texts åŸºæœ¬æ€æƒ³: å°†å¾…æŠ½å–å…³é”®è¯çš„æ–‡æœ¬è¿›è¡Œåˆ†è¯ ä»¥å›ºå®šçª—å£å¤§å°(é»˜è®¤ä¸º5ï¼Œé€šè¿‡spanå±æ€§è°ƒæ•´)ï¼Œè¯ä¹‹é—´çš„å…±ç°å…³ç³»ï¼Œæ„å»ºå›¾ è®¡ç®—å›¾ä¸­èŠ‚ç‚¹çš„PageRankï¼Œæ³¨æ„æ˜¯æ— å‘å¸¦æƒå›¾ import jieba.analyse as analyselines = open(&#x27;NBA.txt&#x27;).read()print &quot; &quot;.join(analyse.textrank(lines, topK=20, withWeight=False, allowPOS=(&#x27;ns&#x27;, &#x27;n&#x27;, &#x27;vn&#x27;, &#x27;v&#x27;)))print &quot;---------------------æˆ‘æ˜¯åˆ†å‰²çº¿----------------&quot;print &quot; &quot;.join(analyse.textrank(lines, topK=20, withWeight=False, allowPOS=(&#x27;ns&#x27;, &#x27;n&#x27;))) Building prefix dict from the default dictionary ...Loading model from cache /var/folders/mf/_jgd83rx0rgcmt42cp7fkkd00000gn/T/jieba.cacheLoading model cost 0.530 seconds.Prefix dict has been built succesfully.å…¨æ˜æ˜Ÿèµ› å‹‡å£« æ­£èµ› æŒ‡å¯¼ å¯¹æ–¹ æŠ•ç¯® çƒå‘˜ æ²¡æœ‰ å‡ºç° æ—¶é—´ å¨å°‘ è®¤ä¸º çœ‹æ¥ ç»“æœ ç›¸éš” åŠ©æ”» ç°åœº ä¸‰è¿åº„ ä»‹ç» å˜‰å®¾---------------------æˆ‘æ˜¯åˆ†å‰²çº¿----------------å‹‡å£« æ­£èµ› å…¨æ˜æ˜Ÿèµ› æŒ‡å¯¼ æŠ•ç¯® ç©å‘½ æ—¶é—´ å¯¹æ–¹ ç°åœº ç»“æœ çƒå‘˜ å˜‰å®¾ æ—¶å€™ å…¨é˜Ÿ ä¸»æŒäºº ç‰¹ç‚¹ å¤§ä¼™ è‚¥çš‚å‰§ å…¨ç¨‹ å¿«èˆ¹é˜Ÿ lines = open(u&#x27;è¥¿æ¸¸è®°.txt&#x27;).read()print &quot; &quot;.join(analyse.textrank(lines, topK=20, withWeight=False, allowPOS=(&#x27;ns&#x27;, &#x27;n&#x27;, &#x27;vn&#x27;, &#x27;v&#x27;))) è¡Œè€… å¸ˆçˆ¶ å…«æˆ’ ä¸‰è— å¤§åœ£ ä¸çŸ¥ è©è¨ å¦–ç²¾ åªè§ é•¿è€ å›½ç‹ å´è¯´ å‘†å­ å¾’å¼Ÿ å°å¦– å‡ºæ¥ ä¸å¾— ä¸è§ ä¸èƒ½ å¸ˆå¾’ 3. è¯æ€§æ ‡æ³¨ jieba.posseg.POSTokenizer(tokenizer=None) æ–°å»ºè‡ªå®šä¹‰åˆ†è¯å™¨ï¼Œtokenizer å‚æ•°å¯æŒ‡å®šå†…éƒ¨ä½¿ç”¨çš„ jieba.Tokenizer åˆ†è¯å™¨ã€‚ jieba.posseg.dt ä¸ºé»˜è®¤è¯æ€§æ ‡æ³¨åˆ†è¯å™¨ã€‚ æ ‡æ³¨å¥å­åˆ†è¯åæ¯ä¸ªè¯çš„è¯æ€§ï¼Œé‡‡ç”¨å’Œ ictclas å…¼å®¹çš„æ ‡è®°æ³•ã€‚ å…·ä½“çš„è¯æ€§å¯¹ç…§è¡¨å‚è§è®¡ç®—æ‰€æ±‰è¯­è¯æ€§æ ‡è®°é›† è®¡ç®—æ‰€æ±‰è¯­è¯æ€§æ ‡è®°é›† ictclas import jieba.posseg as psegwords = pseg.cut(&quot;æˆ‘çˆ±è‡ªç„¶è¯­è¨€å¤„ç†&quot;)for word, flag in words: print(&#x27;%s %s&#x27; % (word, flag)) æˆ‘ rçˆ± vè‡ªç„¶è¯­è¨€ lå¤„ç† v 4. å¹¶è¡Œåˆ†è¯åŸç†ï¼šå°†ç›®æ ‡æ–‡æœ¬æŒ‰è¡Œåˆ†éš”åï¼ŒæŠŠå„è¡Œæ–‡æœ¬åˆ†é…åˆ°å¤šä¸ª Python è¿›ç¨‹å¹¶è¡Œåˆ†è¯ï¼Œç„¶åå½’å¹¶ç»“æœï¼Œä»è€Œè·å¾—åˆ†è¯é€Ÿåº¦çš„å¯è§‚æå‡ åŸºäº python è‡ªå¸¦çš„ multiprocessing æ¨¡å—ï¼Œç›®å‰æš‚ä¸æ”¯æŒ Windows ç”¨æ³•ï¼š jieba.enable_parallel(4) # å¼€å¯å¹¶è¡Œåˆ†è¯æ¨¡å¼ï¼Œå‚æ•°ä¸ºå¹¶è¡Œè¿›ç¨‹æ•° jieba.disable_parallel() # å…³é—­å¹¶è¡Œåˆ†è¯æ¨¡å¼ å®éªŒç»“æœï¼šåœ¨ 4 æ ¸ 3.4GHz Linux æœºå™¨ä¸Šï¼Œå¯¹é‡‘åº¸å…¨é›†è¿›è¡Œç²¾ç¡®åˆ†è¯ï¼Œè·å¾—äº† 1MB/s çš„é€Ÿåº¦ï¼Œæ˜¯å•è¿›ç¨‹ç‰ˆçš„ 3.3 å€ã€‚ æ³¨æ„ï¼šå¹¶è¡Œåˆ†è¯ä»…æ”¯æŒé»˜è®¤åˆ†è¯å™¨ jieba.dt å’Œ jieba.posseg.dtã€‚ import sysimport timeimport jiebajieba.enable_parallel()content = open(u&#x27;è¥¿æ¸¸è®°.txt&#x27;,&quot;r&quot;).read()t1 = time.time()words = &quot;/ &quot;.join(jieba.cut(content))t2 = time.time()tm_cost = t2-t1print(&#x27;å¹¶è¡Œåˆ†è¯é€Ÿåº¦ä¸º %s bytes/second&#x27; % (len(content)/tm_cost))jieba.disable_parallel()content = open(u&#x27;è¥¿æ¸¸è®°.txt&#x27;,&quot;r&quot;).read()t1 = time.time()words = &quot;/ &quot;.join(jieba.cut(content))t2 = time.time()tm_cost = t2-t1print(&#x27;éå¹¶è¡Œåˆ†è¯é€Ÿåº¦ä¸º %s bytes/second&#x27; % (len(content)/tm_cost)) å¹¶è¡Œåˆ†è¯é€Ÿåº¦ä¸º 415863.760491 bytes/secondéå¹¶è¡Œåˆ†è¯é€Ÿåº¦ä¸º 242471.700496 bytes/second å‘½ä»¤è¡Œåˆ†è¯ä½¿ç”¨ç¤ºä¾‹ï¼špython -m jieba news.txt &gt; cut_result.txtå‘½ä»¤è¡Œé€‰é¡¹ï¼ˆç¿»è¯‘ï¼‰ï¼šä½¿ç”¨: python -m jieba [options] filenameç»“å·´å‘½ä»¤è¡Œç•Œé¢ã€‚å›ºå®šå‚æ•°: filename è¾“å…¥æ–‡ä»¶å¯é€‰å‚æ•°: -h, --help æ˜¾ç¤ºæ­¤å¸®åŠ©ä¿¡æ¯å¹¶é€€å‡º -d [DELIM], --delimiter [DELIM] ä½¿ç”¨ DELIM åˆ†éš”è¯è¯­ï¼Œè€Œä¸æ˜¯ç”¨é»˜è®¤çš„&#x27; / &#x27;ã€‚ è‹¥ä¸æŒ‡å®š DELIMï¼Œåˆ™ä½¿ç”¨ä¸€ä¸ªç©ºæ ¼åˆ†éš”ã€‚ -p [DELIM], --pos [DELIM] å¯ç”¨è¯æ€§æ ‡æ³¨ï¼›å¦‚æœæŒ‡å®š DELIMï¼Œè¯è¯­å’Œè¯æ€§ä¹‹é—´ ç”¨å®ƒåˆ†éš”ï¼Œå¦åˆ™ç”¨ _ åˆ†éš” -D DICT, --dict DICT ä½¿ç”¨ DICT ä»£æ›¿é»˜è®¤è¯å…¸ -u USER_DICT, --user-dict USER_DICT ä½¿ç”¨ USER_DICT ä½œä¸ºé™„åŠ è¯å…¸ï¼Œä¸é»˜è®¤è¯å…¸æˆ–è‡ªå®šä¹‰è¯å…¸é…åˆä½¿ç”¨ -a, --cut-all å…¨æ¨¡å¼åˆ†è¯ï¼ˆä¸æ”¯æŒè¯æ€§æ ‡æ³¨ï¼‰ -n, --no-hmm ä¸ä½¿ç”¨éšå«é©¬å°”å¯å¤«æ¨¡å‹ -q, --quiet ä¸è¾“å‡ºè½½å…¥ä¿¡æ¯åˆ° STDERR -V, --version æ˜¾ç¤ºç‰ˆæœ¬ä¿¡æ¯å¹¶é€€å‡ºå¦‚æœæ²¡æœ‰æŒ‡å®šæ–‡ä»¶åï¼Œåˆ™ä½¿ç”¨æ ‡å‡†è¾“å…¥ã€‚ Tokenizeï¼šè¿”å›è¯è¯­åœ¨åŸæ–‡çš„èµ·æ­¢ä½ç½®æ³¨æ„ï¼Œè¾“å…¥å‚æ•°åªæ¥å— unicode print &quot;è¿™æ˜¯é»˜è®¤æ¨¡å¼çš„tokenize&quot;result = jieba.tokenize(u&#x27;è‡ªç„¶è¯­è¨€å¤„ç†éå¸¸æœ‰ç”¨&#x27;)for tk in result: print(&quot;%s\\t\\t start: %d \\t\\t end:%d&quot; % (tk[0],tk[1],tk[2]))print &quot;\\n-----------æˆ‘æ˜¯ç¥å¥‡çš„åˆ†å‰²çº¿------------\\n&quot;print &quot;è¿™æ˜¯æœç´¢æ¨¡å¼çš„tokenize&quot;result = jieba.tokenize(u&#x27;è‡ªç„¶è¯­è¨€å¤„ç†éå¸¸æœ‰ç”¨&#x27;, mode=&#x27;search&#x27;)for tk in result: print(&quot;%s\\t\\t start: %d \\t\\t end:%d&quot; % (tk[0],tk[1],tk[2])) è¿™æ˜¯é»˜è®¤æ¨¡å¼çš„tokenizeè‡ªç„¶è¯­è¨€ start: 0 end:4å¤„ç† start: 4 end:6éå¸¸ start: 6 end:8æœ‰ç”¨ start: 8 end:10 -----------æˆ‘æ˜¯ç¥å¥‡çš„åˆ†å‰²çº¿------------ è¿™æ˜¯æœç´¢æ¨¡å¼çš„tokenizeè‡ªç„¶ start: 0 end:2è¯­è¨€ start: 2 end:4è‡ªç„¶è¯­è¨€ start: 0 end:4å¤„ç† start: 4 end:6éå¸¸ start: 6 end:8æœ‰ç”¨ start: 8 end:10","categories":[{"name":"nlp","slug":"nlp","permalink":"http://iequa.com/categories/nlp/"}],"tags":[{"name":"jieba","slug":"jieba","permalink":"http://iequa.com/tags/jieba/"}]},{"title":"Word2vec åŸºç¡€","slug":"nlp/word2vector-basic","date":"2017-07-12T13:08:21.000Z","updated":"2019-10-20T04:30:35.069Z","comments":true,"path":"2017/07/12/nlp/word2vector-basic/","link":"","permalink":"http://iequa.com/2017/07/12/nlp/word2vector-basic/","excerpt":"Natural Language Processingï¼Œè®¡ç®—æœºç§‘å­¦ä¸è¯­è¨€å­¦ä¸­å…³æ³¨äºè®¡ç®—æœºä¸äººç±»è¯­è¨€é—´è½¬æ¢çš„é¢†åŸŸ","text":"Natural Language Processingï¼Œè®¡ç®—æœºç§‘å­¦ä¸è¯­è¨€å­¦ä¸­å…³æ³¨äºè®¡ç®—æœºä¸äººç±»è¯­è¨€é—´è½¬æ¢çš„é¢†åŸŸ 1. NLP å¸¸è§ä»»åŠ¡ è‡ªåŠ¨æ‘˜è¦ æŒ‡ä»£æ¶ˆè§£ æœºå™¨ç¿»è¯‘ è¯æ€§æ ‡æ³¨ åˆ†è¯ (ä¸­æ–‡ã€æ—¥æ–‡ç­‰) ä¸»é¢˜è¯†åˆ« æ–‡æœ¬åˆ†ç±».â€¦â€¦ è‡ªåŠ¨æ‘˜è¦ -&gt; æœç´¢è¦ç´¢å¼•ï¼Œå…³é”®è¯ç­‰æŒ‡ä»£æ¶ˆè§£ -&gt; å°æ˜æ”¾å­¦äº†, å¦ˆå¦ˆå»æ¥ä»–æœºå™¨ç¿»è¯‘ -&gt; å°å¿ƒåœ°æ»‘ã€å¹²è´§ =&gt; Slide carefullyè¯æ€§æ ‡æ³¨ -&gt; heat(v.) water(n.) in(p.) a(det.) pot(n.)åˆ†è¯ (ä¸­æ–‡ã€æ—¥æ–‡ç­‰) -&gt; å¤§æ°´æ²Ÿ/å¾ˆ/éš¾/è¿‡ 2. NLP å¤„ç†æ–¹æ³•2.1 ä¼ ç»Ÿ: åŸºäºè§„åˆ™Dictâ€¦ ç®€å•ã€ç²—æš´ã€æœ‰ç”¨ 2.2 ç°ä»£: åŸºäºæœºå™¨å­¦ä¹  HMM, CRF, SVM, LDA, CNNâ€¦â€œè§„åˆ™â€éšå«åœ¨æ¨¡å‹å‚æ•°é‡Œ 3. è¯ç¼–ç å’Œè¯å‘é‡åˆæ­¥ ä½ éœ€è¦ä¸€äº› modelï¼Œä¸ç®¡ä½ æ˜¯åŸºäºè§„åˆ™ç»Ÿè®¡ã€æœºå™¨å­¦ä¹ ã€æ·±åº¦å­¦ä¹  çš„ä¸€äº›æ–¹æ³•ï¼Œç¬¬ä¸€æ­¥è¦åšçš„ï¼Œä¸€å®šæ˜¯å¯¹ä½ çš„æ–‡æœ¬æˆ–è€…æ•°æ®ï¼Œè¿›è¡Œè¡¨è¾¾, è¯ç¼–ç ã€‚ ã€è¯ç¼–ç éœ€è¦ä¿è¯è¯çš„ç›¸ä¼¼æ€§ã€ Glove results Nearest words to frog toad rana â€¦ ã€å‘é‡ç©ºé—´åˆ†å¸ƒçš„ç›¸ä¼¼æ€§ã€ ã€å‘é‡ç©ºé—´å­ç»“æ„ã€ ç¼–ç è¦å°½é‡ä¿è¯ï¼Œç›¸ä¼¼çš„è¯çš„ç©ºé—´è·ç¦»æ˜¯ç›¸è¿‘çš„ $V_{King}$ - $V_{Queen}$ + $V_{Women}$ = $V_{Man}$ $V_{Paris}$ - $V_{France}$ + $V_{German}$ = $V_{Berlin}$ æœ€ç»ˆç›®æ ‡: è¯å‘é‡è¡¨ç¤ºä½œä¸ºæœºå™¨å­¦ä¹ ã€ç‰¹åˆ«æ˜¯æ·±åº¦å­¦ä¹ çš„è¾“å…¥å’Œè¡¨ç¤ºç©ºé—´ ä½ çš„ æ•°æ® å†³å®šäº†ä½ çš„ ç»“æœä¸Šé™ä½ çš„ ç®—æ³• åªæ˜¯ä»¥å¤šå¤§ç¨‹åº¦å» é€¼è¿‘ Linguists 3.1 ç¦»æ•£è¡¨ç¤º One-hot è¯­æ–™åº“ John likes to watch movies. Mary likes too. John also likes to watch football games. è¯å…¸ &#123;&quot;John&quot;: 1, &quot;likes&quot;: 2, &quot;to&quot;: 3, &quot;watch&quot;: 4, &quot;movies&quot;: 5, &quot;also&quot;: 6, &quot;football&quot;: 7, &quot;games&quot;: 8, &quot;Mary&quot;: 9, &quot;too&quot;: 10&#125; One-hotè¡¨ç¤º John: [1, 0, 0, 0, 0, 0, 0, 0, 0, 0] likes: [0, 1, 0, 0, 0, 0, 0, 0, 0, 0]...too : [0, 0, 0, 0, 0, 0, 0, 0, 0, 1] 3.2 ç¦»æ•£è¡¨ç¤º Bag of Words æ–‡æ¡£çš„å‘é‡è¡¨ç¤ºå¯ä»¥ç›´æ¥å°†å„è¯çš„è¯å‘é‡è¡¨ç¤ºåŠ å’Œ John likes to watch movies. Mary likes too. =&gt; [1, 2, 1, 1, 1, 0, 0, 0, 1, 1]John also likes to watch football games. =&gt; [1, 1, 1, 1, 0, 1, 1, 1, 0, 0] è¯æƒé‡ - (è¯åœ¨æ–‡æ¡£ä¸­çš„é¡ºåºæ²¡æœ‰è¢«è€ƒè™‘) tf-idfæ˜¯ä¸€ç§ç»Ÿè®¡æ–¹æ³•ï¼Œç”¨ä»¥è¯„ä¼°ä¸€å­—è¯å¯¹äºä¸€ä¸ªæ–‡ä»¶é›†æˆ–ä¸€ä¸ªè¯­æ–™åº“ä¸­çš„å…¶ä¸­ä¸€ä»½æ–‡ä»¶çš„é‡è¦ç¨‹åº¦ TF-IDF (Term Frequency - Inverse Document Frequency) Term Frequency : F(term) = (è¯¥wordè¯å‡ºç°åœ¨å½“å‰æ–‡æ¡£ä¸­çš„æ¬¡æ•°) / (å½“å‰æ–‡æ¡£æ‰€æœ‰wordçš„æ€»æ•°). ä¿¡æ¯æ£€ç´¢è¯ t çš„ IDF \\log (1 + {\\frac{N}{n^t}}) N: æ–‡æ¡£æ€»æ•°ï¼Œ n: å«æœ‰è¯ t çš„æ–‡æ¡£æ•° [0.693, 1.386, 0.693, 0.693, 1.099, 0, 0, 0, 0.693, 0.693] Binary weighting ä¸åšè®¡æ•°çš„ç‰ˆæœ¬ çŸ­æ–‡æœ¬ç›¸ä¼¼æ€§, Bernoulli Naive Bayes [1, 1, 1, 1, 1, 0, 0, 0, 1, 1] if so, I love you = you love I 3.3 ç¦»æ•£è¡¨ç¤º ô°œô°ô°ô°Ÿô°’Bi-gram / ô°ªN-gramJohn likes to watch movies. Mary likes too.John also likes to watch football games. 3.4 è¯­è¨€æ¨¡å‹ è¯ç»„åˆå‡ºç°çš„æ¦‚ç‡ä¸€å¥è¯(è¯ç»„åˆ)å‡ºç°çš„æ¦‚ç‡ ç®€åŒ–è®¡ç®— : $P(too | Mark, likes) \\approx P(too | likes)$, å¯å‚è§ å´å†› ã€Šæ•°å­¦ä¹‹ç¾ã€‹ è§£é‡Š 3.5 ç¦»æ•£è¡¨ç¤º çš„ç¼ºç‚¹ 3.6 åˆ†å¸ƒå¼è¡¨ç¤º æå‡º Distributed representation : ç”¨ä¸€ä¸ªè¯é™„è¿‘çš„å…¶ä»–è¯æ¥è¡¨ç¤ºè¯¥è¯ - (ä¸çŸ¥é“ä½ çš„ç»æµæƒ…å†µï¼Œå°±è°ƒæŸ¥ä¸‹ä½ çš„ç‹æœ‹ç‹—å‹ä»¬)ô°ô±ô²ô°€ô³ô³ô°¢ô³ô³‘ô°€ô³’ô°You shall know a word by the company it keeps â€”- J.R. Firth 1957ô°ô±ô²ô°€ô³ô³ô°¢ô³ô³‘ô°€ô³’ô°ô°Ÿô³“ô°€ô°‘ô°ô±ô²ô°€ô³ô³ô°¢ô³ô³‘ô°€ô³’ô°ô°Ÿô³“ô°€ô°‘ô°ô±ô²ô°€ô³ô³ô°¢ô³ô³‘ô±•ô³”ô³•ô³–ô³—&gt; ç°ä»£ç»Ÿè®¡è‡ªç„¶è¯­è¨€å¤„ç†ä¸­æœ€æœ‰åˆ›è§çš„æƒ³æ³•ä¹‹ä¸€ 4. å…±ç°çŸ©é˜µ (Cocurrence matrix) å…±ç° : å…±åŒå‡ºç° 4.1 Word - Word å·¦å³çª— length ä¸º 1ï¼Œ å¾—åˆ°çš„çŸ©é˜µå¦‚ä¸Š å­˜åœ¨ç¼ºç‚¹ æ¨¡å‹æ¬ ç¨³å®šï¼Œå¯ä»¥è€ƒè™‘ä¸‹ LR çš„å„ä¸ªå‚æ•°ç­‰ï¼Œå˜åŒ–å¤ªå¤§ï¼Œå¯¹æ¨¡å‹æ±‚è§£æœ‰å½±å“ ç”¨SVDå¯¹å…±ç°çŸ©é˜µå‘é‡åšé™ç»´ import numpy as npla = np.linalgwords = [&quot;I&quot;, &quot;like&quot;, &quot;enjoy&quot;, &quot;deep&quot;, &quot;learning&quot;, &quot;NLP&quot;, &quot;flying&quot;, &quot;.&quot;]X = np.array( [ [0, 2, 1, 0, 0, 0, 0, 0], [2, 0, 0, 1, 0, 1, 0, 0], [1, 0, 0, 0, 0, 0, 1, 0], [0, 1, 0, 0, 1, 0, 0, 0], [0, 0, 0, 1, 0, 0, 0, 1], [0, 1, 0, 0, 0, 0, 0, 1], [0, 0, 1, 0, 0, 0, 0, 1], [0, 0, 0, 0, 1, 1, 1, 0] ])U, s, Vh = la.svd(X, full_matrices=False) SVD é™ç»´å­˜åœ¨çš„é—®é¢˜ è®¡ç®—é‡éšè¯­æ–™åº“å’Œè¯å…¸å¢é•¿è†¨èƒ€å¤ªå¿«ï¼Œå¯¹X(n,n)ç»´ çš„çŸ©é˜µï¼Œè®¡ç®—é‡O(n^3)ã€‚è€Œå¯¹å¤§å‹çš„è¯­æ–™åº“ï¼Œ n~400kï¼Œè¯­æ–™åº“å¤§å°1~60B token éš¾ä»¥ä¸ºè¯å…¸ä¸­æ–°åŠ å…¥çš„è¯åˆ†é…è¯å‘é‡ ä¸å…¶ä»–æ·±åº¦å­¦ä¹ æ¨¡å‹æ¡†æ¶å·®å¼‚å¤§ 4.2 NNLM4.3 Word2Vec: CBOW4.4 Word2Vec: Skip-Gram4.5 Word2Vec ç¼ºç‚¹5. æ€»ç»“5.1 ç¦»æ•£è¡¨ç¤º One-hot representation, Bag Of Words Unigramè¯­è¨€æ¨¡å‹ N-gramè¯å‘é‡è¡¨ç¤ºå’Œè¯­è¨€æ¨¡å‹ Co-currenceçŸ©é˜µçš„è¡Œ(åˆ—)å‘é‡ä½œä¸ºè¯å‘é‡ 5.2 åˆ†å¸ƒå¼è¿ç»­è¡¨ç¤º Co-currenceçŸ©é˜µçš„SVDé™ç»´çš„ä½ç»´è¯å‘é‡è¡¨ç¤º Word2Vec: Continuous Bag of Words Model Word2Vec: Skip-Gram Model gensim ç”¨ python è®­ç»ƒ word2vec æœ€å¥½ç”¨çš„åº“å®ƒçš„åŠŸèƒ½ä¸è‡³äº word2vec","categories":[{"name":"nlp","slug":"nlp","permalink":"http://iequa.com/categories/nlp/"}],"tags":[{"name":"Word2Vec","slug":"Word2Vec","permalink":"http://iequa.com/tags/Word2Vec/"}]},{"title":"Scrambled Egg with Ham","slug":"tools/my-cooking","date":"2017-07-09T12:54:16.000Z","updated":"2019-10-20T04:30:34.996Z","comments":true,"path":"2017/07/09/tools/my-cooking/","link":"","permalink":"http://iequa.com/2017/07/09/tools/my-cooking/","excerpt":"è®°å½•æˆ‘å­¦ Cooking ç«è…¿ç‚’è›‹ çš„åšæ³•","text":"è®°å½•æˆ‘å­¦ Cooking ç«è…¿ç‚’è›‹ çš„åšæ³• 2ä¸ªé¸¡è›‹ï¼Œæ‰“å…¥å°ç¢—ä¸­ï¼Œæ…æ‹Œå‡åŒ€ åˆ‡ä¸€æ ¹ç«è…¿ï¼Œåˆ‡æˆç‰‡çŠ¶ æ‰“å¼€ç‡ƒæ°”é˜€é—¨ä¸èµ·ç«ï¼Œå¼€å°ç«ä¾¿å¯ æ”¾å…¥ä¸€äº›è±†æ²¹ï¼Œå¾…æ²¹çƒ­ä¸€ç‚¹ é¸¡è›‹æ…¢æ…¢å€’å…¥æ²¹é”…ï¼Œé¸¡è›‹æˆé¥¼ç‹€ï¼ŒæœŸé—´å¯ä»¥é¢ å‹º å°†ç«è…¿ç‰‡ï¼Œæ”¾å…¥å…¶ä¸­ï¼Œè¿›è¡Œä¸€èµ·ç‚’ï¼Œå¹¶å¯æ”¾å…¥å°‘é‡ç› ç‚’å¾—å·®ä¸å¤šåï¼Œå…³é—­ç‡ƒæ°”é˜€é—¨ï¼Œå¹¶å…³é—­èµ·ç«å¼€å…³","categories":[{"name":"tools","slug":"tools","permalink":"http://iequa.com/categories/tools/"}],"tags":[{"name":"cooking","slug":"cooking","permalink":"http://iequa.com/tags/cooking/"}]},{"title":"Python Basic Learning III","slug":"python/language/py-language-basic-learning-III","date":"2017-06-05T03:00:21.000Z","updated":"2019-10-20T04:30:35.004Z","comments":true,"path":"2017/06/05/python/language/py-language-basic-learning-III/","link":"","permalink":"http://iequa.com/2017/06/05/python/language/py-language-basic-learning-III/","excerpt":"å»–é›ªå³°çš„ Python æ•™ç¨‹ - Functional Programming","text":"å»–é›ªå³°çš„ Python æ•™ç¨‹ - Functional Programming 1. å‡½æ•°å¼ç¼–ç¨‹å‡½æ•°å°±æ˜¯é¢å‘è¿‡ç¨‹çš„ç¨‹åºè®¾è®¡çš„åŸºæœ¬å•å…ƒã€‚ Functional Programming å…¶æ€æƒ³æ›´æ¥è¿‘æ•°å­¦è®¡ç®—ã€‚ åœ¨è®¡ç®—æœºçš„å±‚æ¬¡ä¸Šï¼ŒCPUæ‰§è¡Œçš„æ˜¯åŠ å‡ä¹˜é™¤çš„æŒ‡ä»¤ä»£ç ï¼Œä»¥åŠå„ç§æ¡ä»¶åˆ¤æ–­å’Œè·³è½¬æŒ‡ä»¤ï¼Œæ‰€ä»¥ï¼Œæ±‡ç¼–è¯­è¨€æ˜¯æœ€è´´è¿‘è®¡ç®—æœºçš„è¯­è¨€ã€‚ è€Œè®¡ç®—åˆ™æŒ‡æ•°å­¦æ„ä¹‰ä¸Šçš„è®¡ç®—ï¼Œè¶Šæ˜¯æŠ½è±¡çš„è®¡ç®—ï¼Œç¦»è®¡ç®—æœºç¡¬ä»¶è¶Šè¿œã€‚ å¯¹åº”åˆ°ç¼–ç¨‹è¯­è¨€ï¼Œå°±æ˜¯è¶Šä½çº§çš„è¯­è¨€ï¼Œè¶Šè´´è¿‘è®¡ç®—æœºï¼ŒæŠ½è±¡ç¨‹åº¦ä½ï¼Œæ‰§è¡Œæ•ˆç‡é«˜ï¼Œæ¯”å¦‚Cè¯­è¨€ï¼›è¶Šé«˜çº§çš„è¯­è¨€ï¼Œè¶Šè´´è¿‘è®¡ç®—ï¼ŒæŠ½è±¡ç¨‹åº¦é«˜ï¼Œæ‰§è¡Œæ•ˆç‡ä½ï¼Œæ¯”å¦‚Lispè¯­è¨€ã€‚ å‡½æ•°å¼ç¼–ç¨‹å°±æ˜¯ä¸€ç§æŠ½è±¡ç¨‹åº¦å¾ˆé«˜çš„ç¼–ç¨‹èŒƒå¼ï¼Œçº¯ç²¹çš„å‡½æ•°å¼ç¼–ç¨‹è¯­è¨€ç¼–å†™çš„å‡½æ•°æ²¡æœ‰å˜é‡ï¼Œå› æ­¤ï¼Œä»»æ„ä¸€ä¸ªå‡½æ•°ï¼Œåªè¦è¾“å…¥æ˜¯ç¡®å®šçš„ï¼Œè¾“å‡ºå°±æ˜¯ç¡®å®šçš„ï¼Œè¿™ç§çº¯å‡½æ•°æˆ‘ä»¬ç§°ä¹‹ä¸ºæ²¡æœ‰å‰¯ä½œç”¨ã€‚è€Œå…è®¸ä½¿ç”¨å˜é‡çš„ç¨‹åºè®¾è®¡è¯­è¨€ï¼Œç”±äºå‡½æ•°å†…éƒ¨çš„å˜é‡çŠ¶æ€ä¸ç¡®å®šï¼ŒåŒæ ·çš„è¾“å…¥ï¼Œå¯èƒ½å¾—åˆ°ä¸åŒçš„è¾“å‡ºï¼Œå› æ­¤ï¼Œè¿™ç§å‡½æ•°æ˜¯æœ‰å‰¯ä½œç”¨çš„ã€‚ å‡½æ•°å¼ç¼–ç¨‹çš„ä¸€ä¸ªç‰¹ç‚¹å°±æ˜¯ï¼Œå…è®¸æŠŠå‡½æ•°æœ¬èº«ä½œä¸ºå‚æ•°ä¼ å…¥å¦ä¸€ä¸ªå‡½æ•°ï¼Œè¿˜å…è®¸è¿”å›ä¸€ä¸ªå‡½æ•°ï¼ Pythonå¯¹å‡½æ•°å¼ç¼–ç¨‹æä¾›éƒ¨åˆ†æ”¯æŒã€‚ç”±äºPythonå…è®¸ä½¿ç”¨å˜é‡ï¼Œå› æ­¤ï¼ŒPythonä¸æ˜¯çº¯å‡½æ•°å¼ç¼–ç¨‹è¯­è¨€ã€‚ 1.1 é«˜é˜¶å‡½æ•°Higher-order function 2. æ¨¡å— Pythonå†…ç½®çš„æ¨¡å— å’Œ æ¥è‡ªç¬¬ä¸‰æ–¹çš„æ¨¡å—ã€‚ æ¯ä¸€ä¸ªåŒ…ç›®å½•ä¸‹é¢éƒ½ä¼šæœ‰ä¸€ä¸ªinit.pyçš„æ–‡ä»¶ï¼Œè¿™ä¸ªæ–‡ä»¶æ˜¯å¿…é¡»å­˜åœ¨çš„ï¼Œå¦åˆ™ï¼ŒPythonå°±æŠŠè¿™ä¸ªç›®å½•å½“æˆæ™®é€šç›®å½•ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªåŒ…ã€‚ Reference å»–é›ªå³°çš„å®˜æ–¹ç½‘ç«™ liaoxuefeng","categories":[{"name":"python","slug":"python","permalink":"http://iequa.com/categories/python/"}],"tags":[{"name":"python","slug":"python","permalink":"http://iequa.com/tags/python/"}]},{"title":"Python Class","slug":"python/language/py-language-8-class","date":"2017-06-05T02:00:21.000Z","updated":"2019-10-20T04:30:35.005Z","comments":true,"path":"2017/06/05/python/language/py-language-8-class/","link":"","permalink":"http://iequa.com/2017/06/05/python/language/py-language-8-class/","excerpt":"OO æœ€é‡è¦çš„æ¦‚å¿µå°±æ˜¯ç±»ï¼ˆClassï¼‰å’Œå®ä¾‹ï¼ˆInstanceï¼‰ï¼Œå¿…é¡»ç‰¢è®°ç±»æ˜¯æŠ½è±¡çš„æ¨¡æ¿ï¼Œæ¯”å¦‚Studentç±»","text":"OO æœ€é‡è¦çš„æ¦‚å¿µå°±æ˜¯ç±»ï¼ˆClassï¼‰å’Œå®ä¾‹ï¼ˆInstanceï¼‰ï¼Œå¿…é¡»ç‰¢è®°ç±»æ˜¯æŠ½è±¡çš„æ¨¡æ¿ï¼Œæ¯”å¦‚Studentç±» Class defclass å®šä¹‰ä¸€ä¸ªç±»,é¦–å­—æ¯å¤§å†™ï¼Œæ¯”å¦‚ Calculator. classå¯ä»¥å…ˆå®šä¹‰è‡ªå·±çš„å±æ€§ï¼Œæ¯”å¦‚ name=â€™Good Calculatorâ€™. class Calculator: #é¦–å­—æ¯è¦å¤§å†™ï¼Œå†’å·ä¸èƒ½ç¼º name=&#x27;Good Calculator&#x27; #è¯¥è¡Œä¸ºclassçš„å±æ€§ price=18 def add(self,x,y): print(self.name) result = x + y print(result) def minus(self,x,y): result=x-y print(result) def times(self,x,y): print(x*y) def divide(self,x,y): print(x/y) cal=Calculator()print(cal.name)print(cal.price) Good Calculator 18 cal.add(10,20)cal.minus(10,20)cal.times(10,20)cal.divide(10,20) Good Calculator 30 -10 200 0.5 Class initè¿è¡Œ c=Calculator(&#39;bad calculator&#39;,18,17,16,15), ç„¶åè°ƒå‡ºæ¯ä¸ªåˆå§‹å€¼çš„å€¼ class Calculator: name=&#x27;good calculator&#x27; price=18 def __init__(self,name,price,height,width,weight): # æ³¨æ„ï¼Œè¿™é‡Œçš„ä¸‹åˆ’çº¿æ˜¯åŒä¸‹åˆ’çº¿ self.name=name self.price=price self.h=height self.wi=width self.we=weight c=Calculator(&#x27;bad calculator&#x27;,18,17,16,15)print(c.name)print(c.price)print(c.h)print(c.wi)print(c.we) bad calculator 18 17 16 15 è®¾ç½®classå±æ€§é»˜è®¤å€¼å¦‚ä½•è®¾ç½®å±æ€§çš„é»˜è®¤å€¼, ç›´æ¥åœ¨defé‡Œè¾“å…¥å³å¯ï¼Œå¦‚ä¸‹: def __init__(self,name,price,height=10,width=14,weight=16): æŸ¥çœ‹è¿è¡Œç»“æœï¼Œ ä¸‰ä¸ªæœ‰é»˜è®¤å€¼çš„å±æ€§ï¼Œå¯ä»¥ç›´æ¥è¾“å‡ºé»˜è®¤å€¼. è¿™äº›é»˜è®¤å€¼å¯ä»¥åœ¨codeä¸­æ›´æ”¹, æ¯”å¦‚c.wi=17å†è¾“å‡ºc.wiå°±ä¼šæŠŠwiå±æ€§å€¼æ›´æ”¹ä¸º17. class Calculator: name=&#x27;good calculator&#x27; price=18 def __init__(self,name,price,hight=10,width=14,weight=16): #åé¢ä¸‰ä¸ªå±æ€§è®¾ç½®é»˜è®¤å€¼,æŸ¥çœ‹è¿è¡Œ self.name=name self.price=price self.h=hight self.wi=width self.we=weight c=Calculator(&#x27;bad calculator&#x27;,18)print(c.h)print(&quot;wi : &quot; + str(c.wi))c.wi = 17print(&quot;wi : &quot; + str(c.wi))print(c.we) 10 wi : 14 wi : 17 16 Reference docs.python.org python morvanzhou python liaoxuefeng","categories":[{"name":"python","slug":"python","permalink":"http://iequa.com/categories/python/"}],"tags":[{"name":"python","slug":"python","permalink":"http://iequa.com/tags/python/"}]},{"title":"Python Read File","slug":"python/language/py-language-6-read-file","date":"2017-06-04T02:00:21.000Z","updated":"2019-10-20T04:30:35.006Z","comments":true,"path":"2017/06/04/python/language/py-language-6-read-file/","link":"","permalink":"http://iequa.com/2017/06/04/python/language/py-language-6-read-file/","excerpt":"open()ã€appendã€file.read()ã€file.readline()ã€file.readlines()ã€file.close()ã€with open .. as f","text":"open()ã€appendã€file.read()ã€file.readline()ã€file.readlines()ã€file.close()ã€with open .. as f è¯»å†™æ–‡ä»¶å‰ï¼Œå¿…é¡»äº†è§£ï¼Œåœ¨ç£ç›˜ä¸Šè¯»å†™æ–‡ä»¶çš„åŠŸèƒ½éƒ½æ˜¯ç”±æ“ä½œç³»ç»Ÿæä¾›çš„ï¼Œç°ä»£æ“ä½œç³»ç»Ÿä¸å…è®¸æ™®é€šçš„ç¨‹åºç›´æ¥æ“ä½œç£ç›˜ï¼Œæ‰€ä»¥ï¼Œè¯»å†™æ–‡ä»¶å°±æ˜¯è¯·æ±‚æ“ä½œç³»ç»Ÿæ‰“å¼€ä¸€ä¸ªæ–‡ä»¶å¯¹è±¡ï¼ˆé€šå¸¸ç§°ä¸ºæ–‡ä»¶æè¿°ç¬¦ï¼‰ï¼Œç„¶åï¼Œé€šè¿‡æ“ä½œç³»ç»Ÿæä¾›çš„æ¥å£ä»è¿™ä¸ªæ–‡ä»¶å¯¹è±¡ä¸­è¯»å–æ•°æ®ï¼ˆè¯»æ–‡ä»¶ï¼‰ï¼Œæˆ–è€…æŠŠæ•°æ®å†™å…¥è¿™ä¸ªæ–‡ä»¶å¯¹è±¡ï¼ˆå†™æ–‡ä»¶ï¼‰ 1. openä½¿ç”¨ open èƒ½å¤Ÿæ‰“å¼€ä¸€ä¸ªæ–‡ä»¶, open çš„ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºæ–‡ä»¶åå’Œè·¯å¾„ â€˜my file.txtâ€™, ç¬¬äºŒä¸ªå‚æ•°ä¸ºå°†è¦ä»¥ä»€ä¹ˆæ–¹å¼æ‰“å¼€å®ƒ, æ¯”å¦‚ w ä¸ºå¯å†™æ–¹å¼. å¦‚æœè®¡ç®—æœºæ²¡æœ‰æ‰¾åˆ° â€˜my file.txtâ€™ è¿™ä¸ªæ–‡ä»¶, w æ–¹å¼èƒ½å¤Ÿåˆ›å»ºä¸€ä¸ªæ–°çš„æ–‡ä»¶, å¹¶å‘½åä¸º my file.txt text = &#x27;This is my first test.&#x27;my_file=open(&#x27;my file.txt&#x27;,&#x27;w&#x27;) #ç”¨æ³•: open(&#x27;æ–‡ä»¶å&#x27;,&#x27;å½¢å¼&#x27;), å…¶ä¸­å½¢å¼æœ‰&#x27;w&#x27;:write;&#x27;r&#x27;:read.my_file.write(text) #è¯¥è¯­å¥ä¼šå†™å…¥å…ˆå‰å®šä¹‰å¥½çš„ textmy_file.close() #å…³é—­æ–‡ä»¶ 2. appendæˆ‘ä»¬å…ˆä¿å­˜ä¸€ä¸ªå·²ç»æœ‰3è¡Œæ–‡å­—çš„ â€œmy file.txtâ€ æ–‡ä»¶, æ–‡ä»¶çš„å†…å®¹å¦‚ä¸‹: This is my first test. This is the second line.This the third ä½¿ç”¨æ·»åŠ æ–‡å­—çš„æ–¹å¼ç»™è¿™ä¸ªæ–‡ä»¶æ·»åŠ ä¸€è¡Œ â€œThis is appended file.â€, å¹¶å°†è¿™è¡Œæ–‡å­—å‚¨å­˜åœ¨ append_file é‡Œï¼Œæ³¨æ„\\nçš„é€‚ç”¨æ€§: append_text=&#x27;\\nThis is appended file.&#x27; # ä¸ºè¿™è¡Œæ–‡å­—æå‰ç©ºè¡Œ &quot;\\n&quot;my_file=open(&#x27;my file.txt&#x27;,&#x27;a&#x27;) # &#x27;a&#x27;=append ä»¥å¢åŠ å†…å®¹çš„å½¢å¼æ‰“å¼€my_file.write(append_text)my_file.close() This is my first test. This is the second line. This the third line. This is appended file. 3. file.read()è°ƒç”¨ read() ä¼šä¸€æ¬¡æ€§è¯»å–æ–‡ä»¶çš„å…¨éƒ¨å†…å®¹ï¼Œå¦‚æœæ–‡ä»¶æœ‰10Gï¼Œå†…å­˜å°±çˆ†äº†ï¼Œæ‰€ä»¥ï¼Œè¦ä¿é™©èµ·è§ï¼Œå¯ä»¥åå¤è°ƒç”¨read(size)æ–¹æ³•ï¼Œæ¯æ¬¡æœ€å¤šè¯»å–sizeä¸ªå­—èŠ‚çš„å†…å®¹ã€‚ file= open(&#x27;my file.txt&#x27;,&#x27;r&#x27;) content=file.read() print(content) This is my first test. This is the second line. This the third line. This is appended file. 4. file.readline()å¦‚æœæƒ³åœ¨æ–‡æœ¬ä¸­ä¸€è¡Œè¡Œçš„è¯»å–æ–‡æœ¬, å¯ä»¥ä½¿ç”¨ file.readline(), file.readline() è¯»å–çš„å†…å®¹å’Œä½ ä½¿ç”¨çš„æ¬¡æ•°æœ‰å…³, ä½¿ç”¨ç¬¬äºŒæ¬¡çš„æ—¶å€™, è¯»å–åˆ°çš„æ˜¯æ–‡æœ¬çš„ç¬¬äºŒè¡Œ, å¹¶å¯ä»¥ä»¥æ­¤ç±»æ¨: file= open(&#x27;my file.txt&#x27;,&#x27;r&#x27;) content=file.readline() # è¯»å–ç¬¬ä¸€è¡Œprint(content) This is my first test. second_read_time=file.readline() # è¯»å–ç¬¬äºŒè¡Œprint(second_read_time) This is the second line. 5. file.readlines()å¦‚æœæƒ³è¦è¯»å–æ‰€æœ‰è¡Œ, å¹¶å¯ä»¥ä½¿ç”¨åƒ for ä¸€æ ·çš„è¿­ä»£å™¨è¿­ä»£è¿™äº›è¡Œç»“æœ, æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ file.readlines(), å°†æ¯ä¸€è¡Œçš„ç»“æœå­˜å‚¨åœ¨ list ä¸­, æ–¹ä¾¿ä»¥åè¿­ä»£. file= open(&#x27;my file.txt&#x27;,&#x27;r&#x27;) content=file.readlines() # python_list å½¢å¼print(content) [&#39;This is my first test.\\n&#39;, &#39;This is the second line.\\n&#39;, &#39;This the third line.\\n&#39;, &#39;This is appended file.&#39;] # ä¹‹åå¦‚æœä½¿ç”¨ for æ¥è¿­ä»£è¾“å‡º:for item in content: print(item)``` This is my first test. This is the second line. This the third line. This is appended file.## 6. file.close()ç”±äºæ–‡ä»¶è¯»å†™æ—¶éƒ½æœ‰å¯èƒ½äº§ç”Ÿ`IOError`ï¼Œä¸€æ—¦å‡ºé”™ï¼Œåé¢çš„`f.close()`å°±ä¸ä¼šè°ƒç”¨ã€‚æ‰€ä»¥ï¼Œä¸ºäº†ä¿è¯æ— è®ºæ˜¯å¦å‡ºé”™éƒ½èƒ½æ­£ç¡®åœ°å…³é—­æ–‡ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨`try ... finally`æ¥å®ç°ï¼š```pythontry: f = open(&#x27;/path/to/file&#x27;, &#x27;r&#x27;) print f.read()finally: if f: f.close() æ¯æ¬¡éƒ½è¿™ä¹ˆå†™å®åœ¨å¤ªç¹çï¼Œæ‰€ä»¥ï¼ŒPythonå¼•å…¥äº†withè¯­å¥æ¥è‡ªåŠ¨å¸®æˆ‘ä»¬è°ƒç”¨close()æ–¹æ³•ï¼š 7. with open .. as fwith open(&#x27;/path/to/file&#x27;, &#x27;r&#x27;) as f: print f.read() è¿™å’Œå‰é¢çš„try â€¦ finallyæ˜¯ä¸€æ ·çš„ï¼Œä½†æ˜¯ä»£ç æ›´ä½³ç®€æ´ï¼Œå¹¶ä¸”ä¸å¿…è°ƒç”¨f.close()æ–¹æ³•ã€‚ Reference docs.python.org python morvanzhou python liaoxuefeng","categories":[{"name":"python","slug":"python","permalink":"http://iequa.com/categories/python/"}],"tags":[{"name":"python","slug":"python","permalink":"http://iequa.com/tags/python/"}]},{"title":"Python Sliceã€Iterationã€List generationã€Generator","slug":"python/language/py-language-10-advanced","date":"2017-06-03T01:00:21.000Z","updated":"2019-10-20T04:30:35.004Z","comments":true,"path":"2017/06/03/python/language/py-language-10-advanced/","link":"","permalink":"http://iequa.com/2017/06/03/python/language/py-language-10-advanced/","excerpt":"Sliceã€Iterationã€List generationã€Generator","text":"Sliceã€Iterationã€List generationã€Generator L = []n = 1while n &lt;= 99: L.append(n) n = n + 2 1. Slice&gt;&gt;&gt; L = [&#x27;Michael&#x27;, &#x27;Sarah&#x27;, &#x27;Tracy&#x27;, &#x27;Bob&#x27;, &#x27;Jack&#x27;]&gt;&gt;&gt; L[1:3][&#x27;Sarah&#x27;, &#x27;Tracy&#x27;]&gt;&gt;&gt; L[-2:][&#x27;Bob&#x27;, &#x27;Jack&#x27;]&gt;&gt;&gt; L = range(100)&gt;&gt;&gt; L[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]&gt;&gt;&gt; L[:10:2][0, 2, 4, 6, 8]&gt;&gt;&gt; L[::5][0, 5, 10, 15, 20, 25, 30, 35, 40, 45, 50, 55, 60, 65, 70, 75, 80, 85, 90, 95]&gt;&gt;&gt; tupleä¹Ÿæ˜¯ä¸€ç§listï¼Œå”¯ä¸€åŒºåˆ«æ˜¯tupleä¸å¯å˜ã€‚å› æ­¤ï¼Œtupleä¹Ÿå¯ä»¥ç”¨åˆ‡ç‰‡æ“ä½œï¼Œåªæ˜¯æ“ä½œçš„ç»“æœä»æ˜¯tuple &gt;&gt;&gt; (0, 1, 2, 3, 4, 5)[:3](0, 1, 2) å­—ç¬¦ä¸²&#39;xxx&#39;æˆ–Unicodeå­—ç¬¦ä¸²u&#39;xxx&#39;ä¹Ÿå¯ä»¥çœ‹æˆæ˜¯ä¸€ç§listï¼Œæ¯ä¸ªå…ƒç´ å°±æ˜¯ä¸€ä¸ªå­—ç¬¦ã€‚å› æ­¤ï¼Œå­—ç¬¦ä¸²ä¹Ÿå¯ä»¥ç”¨åˆ‡ç‰‡æ“ä½œï¼Œåªæ˜¯æ“ä½œç»“æœä»æ˜¯å­—ç¬¦ä¸²ï¼š &gt;&gt;&gt; &#x27;ABCDEFG&#x27;[:3]&#x27;ABC&#x27;&gt;&gt;&gt; &#x27;ABCDEFG&#x27;[::2]&#x27;ACEG&#x27; 2. Iterationåªè¦æ˜¯å¯è¿­ä»£å¯¹è±¡ï¼Œæ— è®ºæœ‰æ— ä¸‹æ ‡ï¼Œéƒ½å¯ä»¥è¿­ä»£ï¼Œæ¯”å¦‚dictå°±å¯ä»¥è¿­ä»£ for (i=0; i&lt;list.length; i++) &#123; n = list[i];&#125; d = &#123;&#x27;a&#x27;: 1, &#x27;b&#x27;: 2, &#x27;c&#x27;: 3&#125;for key in d: print key &gt;&gt;&gt; for ch in &#x27;ABC&#x27;:... print ch...ABC å¦‚ä½•åˆ¤æ–­ä¸€ä¸ªå¯¹è±¡æ˜¯å¯è¿­ä»£å¯¹è±¡å‘¢ï¼Ÿæ–¹æ³•æ˜¯é€šè¿‡collectionsæ¨¡å—çš„Iterableç±»å‹åˆ¤æ–­ï¼š &gt;&gt;&gt; from collections import Iterable&gt;&gt;&gt; isinstance(&#x27;abc&#x27;, Iterable) # stræ˜¯å¦å¯è¿­ä»£True&gt;&gt;&gt; isinstance([1,2,3], Iterable) # listæ˜¯å¦å¯è¿­ä»£True&gt;&gt;&gt; isinstance(123, Iterable) # æ•´æ•°æ˜¯å¦å¯è¿­ä»£False å¦‚æœè¦å¯¹listå®ç°ç±»ä¼¼Javaé‚£æ ·çš„ä¸‹æ ‡å¾ªç¯æ€ä¹ˆåŠï¼ŸPythonå†…ç½®çš„enumerateå‡½æ•°å¯ä»¥æŠŠä¸€ä¸ªlistå˜æˆç´¢å¼•-å…ƒç´ å¯¹ï¼Œè¿™æ ·å°±å¯ä»¥åœ¨forå¾ªç¯ä¸­åŒæ—¶è¿­ä»£ç´¢å¼•å’Œå…ƒç´ æœ¬èº«ï¼š &gt;&gt;&gt; for i, value in enumerate([&#x27;A&#x27;, &#x27;B&#x27;, &#x27;C&#x27;]):... print i, value...0 A1 B2 C forå¾ªç¯é‡Œï¼ŒåŒæ—¶å¼•ç”¨äº†ä¸¤ä¸ªå˜é‡ï¼Œåœ¨Pythoné‡Œæ˜¯å¾ˆå¸¸è§ &gt;&gt;&gt; for x, y in [(1, 1), (2, 4), (3, 9)]:... print x, y...1 12 43 9 3. List Generation&gt;&gt;&gt; [x * x for x in range(1, 11) if x % 2 == 0][4, 16, 36, 64, 100] è¿˜å¯ä»¥ä½¿ç”¨ä¸¤å±‚å¾ªç¯ï¼Œå¯ä»¥ç”Ÿæˆå…¨æ’åˆ—ï¼š &gt;&gt;&gt; [m + n for m in &#x27;ABC&#x27; for n in &#x27;XYZ&#x27;][&#x27;AX&#x27;, &#x27;AY&#x27;, &#x27;AZ&#x27;, &#x27;BX&#x27;, &#x27;BY&#x27;, &#x27;BZ&#x27;, &#x27;CX&#x27;, &#x27;CY&#x27;, &#x27;CZ&#x27;] è¿ç”¨åˆ—è¡¨ç”Ÿæˆå¼ï¼Œå¯ä»¥å†™å‡ºéå¸¸ç®€æ´çš„ä»£ç ã€‚ ä¾‹å¦‚ï¼Œåˆ—å‡ºå½“å‰ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶å’Œç›®å½•å &gt;&gt;&gt; import os # å¯¼å…¥osæ¨¡å—ï¼Œæ¨¡å—çš„æ¦‚å¿µåé¢è®²åˆ°&gt;&gt;&gt; [d for d in os.listdir(&#x27;.&#x27;)] # os.listdirå¯ä»¥åˆ—å‡ºæ–‡ä»¶å’Œç›®å½•[&#x27;.emacs.d&#x27;, &#x27;.ssh&#x27;, &#x27;.Trash&#x27;, &#x27;Adlm&#x27;, &#x27;Applications&#x27;, &#x27;Desktop&#x27;, &#x27;Documents&#x27;, &#x27;Downloads&#x27;, &#x27;Library&#x27;, &#x27;Movies&#x27;, &#x27;Music&#x27;, &#x27;Pictures&#x27;, &#x27;Public&#x27;, &#x27;VirtualBox VMs&#x27;, &#x27;Workspace&#x27;, &#x27;XCode&#x27;] forå¾ªç¯å…¶å®å¯ä»¥åŒæ—¶ä½¿ç”¨ä¸¤ä¸ªç”šè‡³å¤šä¸ªå˜é‡ï¼Œæ¯”å¦‚dictçš„iteritems()å¯ä»¥åŒæ—¶è¿­ä»£keyå’Œvalueï¼š &gt;&gt;&gt; d = &#123;&#x27;x&#x27;: &#x27;A&#x27;, &#x27;y&#x27;: &#x27;B&#x27;, &#x27;z&#x27;: &#x27;C&#x27; &#125;&gt;&gt;&gt; for k, v in d.iteritems():... print k, &#x27;=&#x27;, v... y = Bx = Az = C åˆ—è¡¨ç”Ÿæˆå¼ä¹Ÿå¯ä»¥ä½¿ç”¨ä¸¤ä¸ªå˜é‡æ¥ç”Ÿæˆlistï¼š &gt;&gt;&gt; d = &#123;&#x27;x&#x27;: &#x27;A&#x27;, &#x27;y&#x27;: &#x27;B&#x27;, &#x27;z&#x27;: &#x27;C&#x27; &#125;&gt;&gt;&gt; [k + &#x27;=&#x27; + v for k, v in d.iteritems()][&#x27;y=B&#x27;, &#x27;x=A&#x27;, &#x27;z=C&#x27;] æœ€åæŠŠä¸€ä¸ªlistä¸­æ‰€æœ‰çš„å­—ç¬¦ä¸²å˜æˆå°å†™ï¼š &gt;&gt;&gt; L = [&#x27;Hello&#x27;, &#x27;World&#x27;, &#x27;IBM&#x27;, &#x27;Apple&#x27;]&gt;&gt;&gt; [s.lower() for s in L][&#x27;hello&#x27;, &#x27;world&#x27;, &#x27;ibm&#x27;, &#x27;apple&#x27;] å°ç»“ è¿ç”¨åˆ—è¡¨ç”Ÿæˆå¼ï¼Œå¯ä»¥å¿«é€Ÿç”Ÿæˆlistï¼Œå¯ä»¥é€šè¿‡ä¸€ä¸ªlistæ¨å¯¼å‡ºå¦ä¸€ä¸ªlistï¼Œè€Œä»£ç å´ååˆ†ç®€æ´ã€‚ 4. Generatorå¦‚æœåˆ—è¡¨å…ƒç´ å¯ä»¥æŒ‰ç…§æŸç§ç®—æ³•æ¨ç®—å‡ºæ¥ï¼Œé‚£æˆ‘ä»¬æ˜¯å¦å¯ä»¥åœ¨å¾ªç¯çš„è¿‡ç¨‹ä¸­ä¸æ–­æ¨ç®—å‡ºåç»­çš„å…ƒç´ å‘¢ï¼Ÿè¿™æ ·å°±ä¸å¿…åˆ›å»ºå®Œæ•´çš„listï¼Œä»è€ŒèŠ‚çœå¤§é‡çš„ç©ºé—´ã€‚åœ¨Pythonä¸­ï¼Œè¿™ç§ä¸€è¾¹å¾ªç¯ä¸€è¾¹è®¡ç®—çš„æœºåˆ¶ï¼Œç§°ä¸ºç”Ÿæˆå™¨ï¼ˆGeneratorï¼‰ è¦åˆ›å»ºä¸€ä¸ªgeneratorï¼Œæœ‰å¾ˆå¤šç§æ–¹æ³•ã€‚ç¬¬ä¸€ç§æ–¹æ³•å¾ˆç®€å•ï¼Œåªè¦æŠŠä¸€ä¸ªåˆ—è¡¨ç”Ÿæˆå¼çš„[]æ”¹æˆ()ï¼Œå°±åˆ›å»ºäº†ä¸€ä¸ªgeneratorï¼š &gt;&gt;&gt; L = [x * x for x in range(10)]&gt;&gt;&gt; L[0, 1, 4, 9, 16, 25, 36, 49, 64, 81]&gt;&gt;&gt; g = (x * x for x in range(10))&gt;&gt;&gt; g&lt;generator object &lt;genexpr&gt; at 0x104feab40&gt; generator æ˜¯ä¸€ä¸ªå¯è¿­ä»£çš„å¯¹è±¡ &gt;&gt;&gt; g = (x * x for x in range(10))&gt;&gt;&gt; for n in g:... print n...0149162536496481 æ–æ³¢æ‹‰å¥‘æ•°åˆ— def fib(max): n, a, b = 0, 0, 1 while n &lt; max: print b a, b = b, a + b n = n + 1 fibå‡½æ•°å®é™…ä¸Šæ˜¯å®šä¹‰äº†æ–æ³¢æ‹‰å¥‘æ•°åˆ—çš„æ¨ç®—è§„åˆ™ï¼Œå¯ä»¥ä»ç¬¬ä¸€ä¸ªå…ƒç´ å¼€å§‹ï¼Œæ¨ç®—å‡ºåç»­ä»»æ„çš„å…ƒç´ ï¼Œè¿™ç§é€»è¾‘å…¶å®éå¸¸ç±»ä¼¼generatorã€‚ æŠŠfibå‡½æ•°å˜æˆgeneratorï¼Œåªéœ€è¦æŠŠ print b æ”¹ä¸º yield b å°±å¯ä»¥äº† def fib(max): n, a, b = 0, 0, 1 while n &lt; max: yield b a, b = b, a + b n = n + 1 å¦‚æœä¸€ä¸ªå‡½æ•°å®šä¹‰ä¸­åŒ…å« yieldå…³é”®å­—ï¼Œé‚£ä¹ˆè¿™ä¸ªå‡½æ•°å°±ä¸å†æ˜¯ä¸€ä¸ªæ™®é€šå‡½æ•°ï¼Œè€Œæ˜¯ä¸€ä¸ªgenerator &gt;&gt;&gt; fib(6)&lt;generator object fib at 0x104feaaa0&gt; å‡½æ•°æ˜¯é¡ºåºæ‰§è¡Œï¼Œé‡åˆ°returnè¯­å¥æˆ–è€…æœ€åä¸€è¡Œå‡½æ•°è¯­å¥å°±è¿”å›ã€‚è€Œå˜æˆgeneratorçš„å‡½æ•°ï¼Œåœ¨æ¯æ¬¡è°ƒç”¨next()çš„æ—¶å€™æ‰§è¡Œï¼Œé‡åˆ°yieldè¯­å¥è¿”å›ï¼Œå†æ¬¡æ‰§è¡Œæ—¶ä»ä¸Šæ¬¡è¿”å›çš„yield è¯­å¥å¤„ç»§ç»­æ‰§è¡Œã€‚ &gt;&gt;&gt; def odd():... print &#x27;step 1&#x27;... yield 1... print &#x27;step 2&#x27;... yield 3... print &#x27;step 3&#x27;... yield 5...&gt;&gt;&gt; o = odd()&gt;&gt;&gt; o.next()step 11&gt;&gt;&gt; o.next()step 23&gt;&gt;&gt; o.next()step 35&gt;&gt;&gt; o.next()Traceback (most recent call last): File &quot;&lt;stdin&gt;&quot;, line 1, in &lt;module&gt;StopIteration å°ç»“ generatoræ˜¯éå¸¸å¼ºå¤§çš„å·¥å…·ï¼Œåœ¨Pythonä¸­ï¼Œå¯ä»¥ç®€å•åœ°æŠŠåˆ—è¡¨ç”Ÿæˆå¼æ”¹æˆgeneratorï¼Œä¹Ÿå¯ä»¥é€šè¿‡å‡½æ•°å®ç°å¤æ‚é€»è¾‘çš„generatorã€‚ è¦ç†è§£generatorçš„å·¥ä½œåŸç†ï¼Œå®ƒæ˜¯åœ¨forå¾ªç¯çš„è¿‡ç¨‹ä¸­ä¸æ–­è®¡ç®—å‡ºä¸‹ä¸€ä¸ªå…ƒç´ ï¼Œå¹¶åœ¨é€‚å½“çš„æ¡ä»¶ç»“æŸforå¾ªç¯ã€‚å¯¹äºå‡½æ•°æ”¹æˆçš„generatoræ¥è¯´ï¼Œé‡åˆ°returnè¯­å¥æˆ–è€…æ‰§è¡Œåˆ°å‡½æ•°ä½“æœ€åä¸€è¡Œè¯­å¥ï¼Œå°±æ˜¯ç»“æŸgeneratorçš„æŒ‡ä»¤ï¼Œforå¾ªç¯éšä¹‹ç»“æŸã€‚ Reference å»–é›ªå³°çš„å®˜æ–¹ç½‘ç«™","categories":[{"name":"python","slug":"python","permalink":"http://iequa.com/categories/python/"}],"tags":[{"name":"python","slug":"python","permalink":"http://iequa.com/tags/python/"}]},{"title":"Python defå‡½æ•°ã€å‡½æ•°å‚æ•°ã€å‡½æ•°é»˜è®¤å‚æ•°","slug":"python/language/py-language-5-function","date":"2017-06-02T23:00:21.000Z","updated":"2019-10-20T04:30:35.006Z","comments":true,"path":"2017/06/03/python/language/py-language-5-function/","link":"","permalink":"http://iequa.com/2017/06/03/python/language/py-language-5-function/","excerpt":"å®šä¹‰å‡½æ•°ã€å†…ç½®å‡½æ•°ã€å‡½æ•°å‚æ•°ã€å‡½æ•°é»˜è®¤å‚æ•°","text":"å®šä¹‰å‡½æ•°ã€å†…ç½®å‡½æ•°ã€å‡½æ•°å‚æ•°ã€å‡½æ•°é»˜è®¤å‚æ•° 1. å†…ç½®å‡½æ•°å†…ç½®å‡½æ•° &gt;&gt;&gt; abs(-12.34)12.34 abs api &gt;&gt;&gt; cmp(1, 2)-1&gt;&gt;&gt; cmp(10, 2)1 æ•°æ®ç±»å‹è½¬æ¢ &gt;&gt;&gt; int(&#x27;123&#x27;)123&gt;&gt;&gt; int(12.34)12&gt;&gt;&gt; float(&#x27;12.34&#x27;)12.34&gt;&gt;&gt; str(1.23)&#x27;1.23&#x27;&gt;&gt;&gt; unicode(100)u&#x27;100&#x27;&gt;&gt;&gt; bool(1)True&gt;&gt;&gt; bool(&#x27;&#x27;)False å‡½æ•°åå…¶å®å°±æ˜¯æŒ‡å‘ä¸€ä¸ªå‡½æ•°å¯¹è±¡çš„å¼•ç”¨ï¼Œå®Œå…¨å¯ä»¥æŠŠå‡½æ•°åèµ‹ç»™ä¸€ä¸ªå˜é‡ï¼Œç›¸å½“äºç»™è¿™ä¸ªå‡½æ•°èµ·äº†ä¸€ä¸ªâ€œåˆ«åâ€ï¼š &gt;&gt;&gt; a = abs # å˜é‡aæŒ‡å‘abså‡½æ•°&gt;&gt;&gt; a(-1) # æ‰€ä»¥ä¹Ÿå¯ä»¥é€šè¿‡aè°ƒç”¨abså‡½æ•°1 2. defå‡½æ•°def my_abs(x): if x &gt;= 0: return x else: return -x return None å¯ä»¥ç®€å†™ä¸º returnã€‚ 2.1 ç©ºå‡½æ•°def nop(): pass 2.2 å‡½æ•°å‚æ•°ç±»å‹æ£€æŸ¥def my_abs(x): if not isinstance(x, (int, float)): raise TypeError(&#x27;bad operand type&#x27;) if x &gt;= 0: return x else: return -x 2.3 è¿”å›å¤šä¸ªå€¼ (æ˜¯ä¸€ä¸ªtuple)import mathdef move(x, y, step, angle=0): nx = x + step * math.cos(angle) ny = y - step * math.sin(angle) return nx, ny&gt;&gt;&gt; x, y = move(100, 100, 60, math.pi / 6)&gt;&gt;&gt; print x, y151.961524227 70.0 3. å‡½æ•°å‚æ•°def power(x, n=2): s = 1 while n &gt; 0: n = n - 1 s = s * x return s ä¸€æ˜¯å¿…é€‰å‚æ•°åœ¨å‰ï¼Œé»˜è®¤å‚æ•°åœ¨åï¼Œå¦åˆ™Pythonçš„è§£é‡Šå™¨ä¼šæŠ¥é”™ äºŒæ˜¯å¦‚ä½•è®¾ç½®é»˜è®¤å‚æ•°ã€‚ å½“å‡½æ•°æœ‰å¤šä¸ªå‚æ•°æ—¶ï¼ŒæŠŠå˜åŒ–å¤§çš„å‚æ•°æ”¾å‰é¢ï¼Œå˜åŒ–å°çš„å‚æ•°æ”¾åé¢ã€‚å˜åŒ–å°çš„å‚æ•°å°±å¯ä»¥ä½œä¸ºé»˜è®¤å‚æ•°ã€‚ ä½¿ç”¨é»˜è®¤å‚æ•°æœ‰ä»€ä¹ˆå¥½å¤„ï¼Ÿæœ€å¤§çš„å¥½å¤„æ˜¯èƒ½é™ä½è°ƒç”¨å‡½æ•°çš„éš¾åº¦ã€‚ å®šä¹‰é»˜è®¤å‚æ•°è¦ç‰¢è®°ä¸€ç‚¹ï¼šé»˜è®¤å‚æ•°å¿…é¡»æŒ‡å‘ä¸å˜å¯¹è±¡ï¼ def add_end(L=None): if L is None: L = [] L.append(&#x27;END&#x27;) return L ä¸ºä»€ä¹ˆè¦è®¾è®¡strã€Noneè¿™æ ·çš„ä¸å˜å¯¹è±¡å‘¢ï¼Ÿå› ä¸ºä¸å˜å¯¹è±¡ä¸€æ—¦åˆ›å»ºï¼Œå¯¹è±¡å†…éƒ¨çš„æ•°æ®å°±ä¸èƒ½ä¿®æ”¹ï¼Œè¿™æ ·å°±å‡å°‘äº†ç”±äºä¿®æ”¹æ•°æ®å¯¼è‡´çš„é”™è¯¯ã€‚æ­¤å¤–ï¼Œç”±äºå¯¹è±¡ä¸å˜ï¼Œå¤šä»»åŠ¡ç¯å¢ƒä¸‹åŒæ—¶è¯»å–å¯¹è±¡ä¸éœ€è¦åŠ é”ï¼ŒåŒæ—¶è¯»ä¸€ç‚¹é—®é¢˜éƒ½æ²¡æœ‰ã€‚æˆ‘ä»¬åœ¨ç¼–å†™ç¨‹åºæ—¶ï¼Œå¦‚æœå¯ä»¥è®¾è®¡ä¸€ä¸ªä¸å˜å¯¹è±¡ï¼Œé‚£å°±å°½é‡è®¾è®¡æˆä¸å˜å¯¹è±¡ã€‚ å¯å˜å‚æ•° def calc(numbers): sum = 0 for n in numbers: sum = sum + n * n return sum&gt;&gt;&gt; calc([1, 2, 3])14&gt;&gt;&gt; calc((1, 3, 5, 7))84 å¦‚æœåˆ©ç”¨å¯å˜å‚æ•°ï¼Œè°ƒç”¨å‡½æ•°çš„æ–¹å¼å¯ä»¥ç®€åŒ–æˆè¿™æ ·ï¼š def calc(*numbers): sum = 0 for n in numbers: sum = sum + n * n return sum å®šä¹‰å¯å˜å‚æ•°å’Œå®šä¹‰listæˆ–tupleå‚æ•°ç›¸æ¯”ï¼Œä»…ä»…åœ¨å‚æ•°å‰é¢åŠ äº†ä¸€ä¸ª*å·ã€‚åœ¨å‡½æ•°å†…éƒ¨ï¼Œå‚æ•°numbersæ¥æ”¶åˆ°çš„æ˜¯ä¸€ä¸ªtupleï¼Œå› æ­¤ï¼Œå‡½æ•°ä»£ç å®Œå…¨ä¸å˜ã€‚ä½†æ˜¯ï¼Œè°ƒç”¨è¯¥å‡½æ•°æ—¶ï¼Œå¯ä»¥ä¼ å…¥ä»»æ„ä¸ªå‚æ•°ï¼ŒåŒ…æ‹¬0ä¸ªå‚æ•°ï¼š &gt;&gt;&gt; calc(1, 2)5&gt;&gt;&gt; calc()0 è¿™ç§å†™æ³•ç›¸å½“æœ‰ç”¨ï¼Œè€Œä¸”å¾ˆå¸¸è§ï¼Œè§å¦‚ä¸‹ : &gt;&gt;&gt; nums = [1, 2, 3]&gt;&gt;&gt; calc(*nums)14 å…³é”®å­—å‚æ•° å¯å˜å‚æ•°å…è®¸ä½ ä¼ å…¥0ä¸ªæˆ–ä»»æ„ä¸ªå‚æ•°ï¼Œè¿™äº›å¯å˜å‚æ•°åœ¨å‡½æ•°è°ƒç”¨æ—¶è‡ªåŠ¨ç»„è£…ä¸ºä¸€ä¸ªtupleã€‚ å…³é”®å­—å‚æ•°å…è®¸ä½ ä¼ å…¥0ä¸ªæˆ–ä»»æ„ä¸ªå«å‚æ•°åçš„å‚æ•°ï¼Œè¿™äº›å…³é”®å­—å‚æ•°åœ¨å‡½æ•°å†…éƒ¨è‡ªåŠ¨ç»„è£…ä¸ºä¸€ä¸ªdictã€‚ è¯·çœ‹ç¤ºä¾‹ï¼š def person(name, age, **kw): print &#x27;name:&#x27;, name, &#x27;age:&#x27;, age, &#x27;other:&#x27;, kw å‡½æ•°personé™¤äº†å¿…é€‰å‚æ•°nameå’Œageå¤–ï¼Œè¿˜æ¥å—å…³é”®å­—å‚æ•°kwã€‚åœ¨è°ƒç”¨è¯¥å‡½æ•°æ—¶ï¼Œå¯ä»¥åªä¼ å…¥å¿…é€‰å‚æ•°; ä¹Ÿå¯ä»¥ä¼ å…¥ä»»æ„ä¸ªæ•°çš„å…³é”®å­—å‚æ•°; &gt;&gt;&gt; person(&#x27;Bob&#x27;, 35, city=&#x27;Beijing&#x27;)name: Bob age: 35 other: &#123;&#x27;city&#x27;: &#x27;Beijing&#x27;&#125;&gt;&gt;&gt; person(&#x27;Adam&#x27;, 45, gender=&#x27;M&#x27;, job=&#x27;Engineer&#x27;)name: Adam age: 45 other: &#123;&#x27;gender&#x27;: &#x27;M&#x27;, &#x27;job&#x27;: &#x27;Engineer&#x27;&#125; &gt;&gt;&gt; kw = &#123;&#x27;city&#x27;: &#x27;Beijing&#x27;, &#x27;job&#x27;: &#x27;Engineer&#x27;&#125;&gt;&gt;&gt; person(&#x27;Jack&#x27;, 24, **kw)name: Jack age: 24 other: &#123;&#x27;city&#x27;: &#x27;Beijing&#x27;, &#x27;job&#x27;: &#x27;Engineer&#x27;&#125; å‚æ•°ç»„åˆ åœ¨Pythonä¸­å®šä¹‰å‡½æ•°ï¼Œå¯ä»¥ç”¨å¿…é€‰å‚æ•°ã€é»˜è®¤å‚æ•°ã€å¯å˜å‚æ•°å’Œå…³é”®å­—å‚æ•°ï¼Œè¿™4ç§å‚æ•°éƒ½å¯ä»¥ä¸€èµ·ä½¿ç”¨ï¼Œæˆ–è€…åªç”¨å…¶ä¸­æŸäº›ï¼Œä½†æ˜¯è¯·æ³¨æ„ï¼Œå‚æ•°å®šä¹‰çš„é¡ºåºå¿…é¡»æ˜¯ï¼šå¿…é€‰å‚æ•°ã€é»˜è®¤å‚æ•°ã€å¯å˜å‚æ•°å’Œå…³é”®å­—å‚æ•°ã€‚ def func(a, b, c=0, *args, **kw): print &#x27;a =&#x27;, a, &#x27;b =&#x27;, b, &#x27;c =&#x27;, c, &#x27;args =&#x27;, args, &#x27;kw =&#x27;, kw åœ¨å‡½æ•°è°ƒç”¨çš„æ—¶å€™ï¼ŒPythonè§£é‡Šå™¨è‡ªåŠ¨æŒ‰ç…§å‚æ•°ä½ç½®å’Œå‚æ•°åæŠŠå¯¹åº”çš„å‚æ•°ä¼ è¿›å»ã€‚ &gt;&gt;&gt; func(1, 2)a = 1 b = 2 c = 0 args = () kw = &#123;&#125;&gt;&gt;&gt; func(1, 2, c=3)a = 1 b = 2 c = 3 args = () kw = &#123;&#125;&gt;&gt;&gt; func(1, 2, 3, &#x27;a&#x27;, &#x27;b&#x27;)a = 1 b = 2 c = 3 args = (&#x27;a&#x27;, &#x27;b&#x27;) kw = &#123;&#125;&gt;&gt;&gt; func(1, 2, 3, &#x27;a&#x27;, &#x27;b&#x27;, x=99)a = 1 b = 2 c = 3 args = (&#x27;a&#x27;, &#x27;b&#x27;) kw = &#123;&#x27;x&#x27;: 99&#125; ç¥å¥‡çš„æ˜¯é€šè¿‡ä¸€ä¸ªtupleå’Œdictï¼Œä½ ä¹Ÿå¯ä»¥è°ƒç”¨è¯¥å‡½æ•°ï¼š &gt;&gt;&gt; args = (1, 2, 3, 4)&gt;&gt;&gt; kw = &#123;&#x27;x&#x27;: 99&#125;&gt;&gt;&gt; func(*args, **kw)a = 1 b = 2 c = 3 args = (4,) kw = &#123;&#x27;x&#x27;: 99&#125; æ‰€ä»¥ï¼Œå¯¹äºä»»æ„å‡½æ•°ï¼Œéƒ½å¯ä»¥é€šè¿‡ç±»ä¼¼func(*args, **kw)çš„å½¢å¼è°ƒç”¨å®ƒï¼Œæ— è®ºå®ƒçš„å‚æ•°æ˜¯å¦‚ä½•å®šä¹‰çš„ã€‚ å°ç»“ Pythonçš„å‡½æ•°å…·æœ‰éå¸¸çµæ´»çš„å‚æ•°å½¢æ€ï¼Œæ—¢å¯ä»¥å®ç°ç®€å•çš„è°ƒç”¨ï¼Œåˆå¯ä»¥ä¼ å…¥éå¸¸å¤æ‚çš„å‚æ•°ã€‚ é»˜è®¤å‚æ•°ä¸€å®šè¦ç”¨ä¸å¯å˜å¯¹è±¡ï¼Œå¦‚æœæ˜¯å¯å˜å¯¹è±¡ï¼Œè¿è¡Œä¼šæœ‰é€»è¾‘é”™è¯¯ï¼ è¦æ³¨æ„å®šä¹‰å¯å˜å‚æ•°å’Œå…³é”®å­—å‚æ•°çš„è¯­æ³•ï¼š *argsæ˜¯å¯å˜å‚æ•°ï¼Œargsæ¥æ”¶çš„æ˜¯ä¸€ä¸ªtupleï¼› **kwæ˜¯å…³é”®å­—å‚æ•°ï¼Œkwæ¥æ”¶çš„æ˜¯ä¸€ä¸ªdictã€‚ ä»¥åŠè°ƒç”¨å‡½æ•°æ—¶å¦‚ä½•ä¼ å…¥å¯å˜å‚æ•°å’Œå…³é”®å­—å‚æ•°çš„è¯­æ³•ï¼š å¯å˜å‚æ•°æ—¢å¯ç›´æ¥ä¼ å…¥ï¼šfunc(1, 2, 3)ï¼Œåˆå¯å…ˆç»„è£…listæˆ–tupleï¼Œå†é€šè¿‡*argsä¼ å…¥ï¼šfunc(*(1, 2, 3))ï¼› å…³é”®å­—å‚æ•°æ—¢å¯ç›´æ¥ä¼ å…¥ï¼šfunc(a=1, b=2)ï¼Œåˆå¯å…ˆç»„è£…dictï¼Œå†é€šè¿‡**kwä¼ å…¥ï¼šfunc(**&#123;&#39;a&#39;: 1, &#39;b&#39;: 2&#125;)ã€‚ ä½¿ç”¨*argså’Œ**kwæ˜¯Pythonçš„ä¹ æƒ¯å†™æ³•ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥ç”¨å…¶ä»–å‚æ•°åï¼Œä½†æœ€å¥½ä½¿ç”¨ä¹ æƒ¯ç”¨æ³•ã€‚ é€’å½’å‡½æ•°def fact(n): if n==1: return 1 return n * fact(n - 1) ä½¿ç”¨é€’å½’å‡½æ•°éœ€è¦æ³¨æ„é˜²æ­¢æ ˆæº¢å‡ºã€‚åœ¨è®¡ç®—æœºä¸­ï¼Œå‡½æ•°è°ƒç”¨æ˜¯é€šè¿‡æ ˆï¼ˆstackï¼‰è¿™ç§æ•°æ®ç»“æ„å®ç°çš„ï¼Œæ¯å½“è¿›å…¥ä¸€ä¸ªå‡½æ•°è°ƒç”¨ï¼Œæ ˆå°±ä¼šåŠ ä¸€å±‚æ ˆå¸§ï¼Œæ¯å½“å‡½æ•°è¿”å›ï¼Œæ ˆå°±ä¼šå‡ä¸€å±‚æ ˆå¸§ã€‚ç”±äºæ ˆçš„å¤§å°ä¸æ˜¯æ— é™çš„ï¼Œæ‰€ä»¥ï¼Œé€’å½’è°ƒç”¨çš„æ¬¡æ•°è¿‡å¤šï¼Œä¼šå¯¼è‡´æ ˆæº¢å‡ºã€‚ ä½¿ç”¨é€’å½’å‡½æ•°çš„ä¼˜ç‚¹æ˜¯é€»è¾‘ç®€å•æ¸…æ™°ï¼Œç¼ºç‚¹æ˜¯è¿‡æ·±çš„è°ƒç”¨ä¼šå¯¼è‡´æ ˆæº¢å‡ºã€‚ Reference article å»–é›ªå³°çš„å®˜æ–¹ç½‘ç«™","categories":[{"name":"python","slug":"python","permalink":"http://iequa.com/categories/python/"}],"tags":[{"name":"python","slug":"python","permalink":"http://iequa.com/tags/python/"}]},{"title":"Python é›†åˆ Listã€Tupleã€Dictã€ Set","slug":"python/language/py-language-4-collection-type","date":"2017-05-31T08:00:21.000Z","updated":"2019-10-20T04:30:35.004Z","comments":true,"path":"2017/05/31/python/language/py-language-4-collection-type/","link":"","permalink":"http://iequa.com/2017/05/31/python/language/py-language-4-collection-type/","excerpt":"Python é›†åˆ Listã€Tupleã€Dictã€ Set","text":"Python é›†åˆ Listã€Tupleã€Dictã€ Set List&gt;&gt;&gt; classmates = [&#x27;Michael&#x27;, &#x27;Bob&#x27;, &#x27;Tracy&#x27;]&gt;&gt;&gt; classmates[&#x27;Michael&#x27;, &#x27;Bob&#x27;, &#x27;Tracy&#x27;] append&gt;&gt;&gt; classmates[-1]&#x27;Tracy&#x27;&gt;&gt;&gt; classmates.append(&#x27;Adam&#x27;)&gt;&gt;&gt; classmates[&#x27;Michael&#x27;, &#x27;Bob&#x27;, &#x27;Tracy&#x27;, &#x27;Adam&#x27;] insert&gt;&gt;&gt; classmates.insert(1, &#x27;Jack&#x27;)&gt;&gt;&gt; classmates[&#x27;Michael&#x27;, &#x27;Jack&#x27;, &#x27;Bob&#x27;, &#x27;Tracy&#x27;, &#x27;Adam&#x27;] pop&gt;&gt;&gt; classmates.pop()&#x27;Adam&#x27;&gt;&gt;&gt; classmates[&#x27;Michael&#x27;, &#x27;Jack&#x27;, &#x27;Bob&#x27;, &#x27;Tracy&#x27;] è¦åˆ é™¤listæœ«å°¾çš„å…ƒç´ ï¼Œç”¨pop()æ–¹æ³• pop(i)&gt;&gt;&gt; classmates.pop(1)&#x27;Jack&#x27;&gt;&gt;&gt; classmates[&#x27;Michael&#x27;, &#x27;Bob&#x27;, &#x27;Tracy&#x27;] è¦åˆ é™¤æŒ‡å®šä½ç½®çš„å…ƒç´ ï¼Œç”¨pop(i)æ–¹æ³•ï¼Œå…¶ä¸­iæ˜¯ç´¢å¼•ä½ç½®ï¼š list å…ƒç´ ç±»å‹ä¸åŒ&gt;&gt;&gt; L = [&#x27;Apple&#x27;, 123, True] list é‡Œé¢çš„å…ƒç´ çš„æ•°æ®ç±»å‹ä¹Ÿå¯ä»¥ä¸åŒ &gt;&gt;&gt; s = [&#x27;python&#x27;, &#x27;java&#x27;, [&#x27;asp&#x27;, &#x27;php&#x27;], &#x27;scheme&#x27;]&gt;&gt;&gt; len(s)4 &gt;&gt;&gt; p = [&#x27;asp&#x27;, &#x27;php&#x27;]&gt;&gt;&gt; s = [&#x27;python&#x27;, &#x27;java&#x27;, p, &#x27;scheme&#x27;] listå…ƒç´ ä¹Ÿå¯ä»¥æ˜¯å¦ä¸€ä¸ªlist Tupletupleä¸€æ—¦åˆå§‹åŒ–å°±ä¸èƒ½ä¿®æ”¹,å…ƒç´ æŒ‡å‘ä¸æ”¹å˜ &gt;&gt;&gt; classmates = (&#x27;Michael&#x27;, &#x27;Bob&#x27;, &#x27;Tracy&#x27;) &gt;&gt;&gt; t = (1, 2)&gt;&gt;&gt; t(1, 2) å¦‚æœè¦å®šä¹‰ä¸€ä¸ªç©ºçš„tupleï¼Œå¯ä»¥å†™æˆ() tuple çš„é™·é˜± &gt;&gt;&gt; t = (1)&gt;&gt;&gt; t1 æ­£ç¡®çš„æ–¹å¼å¦‚ä¸‹ : &gt;&gt;&gt; t = (1,)&gt;&gt;&gt; t(1,) æœ€åæ¥çœ‹ä¸€ä¸ªâ€œå¯å˜çš„â€tupleï¼š &gt;&gt;&gt; t = (&#x27;a&#x27;, &#x27;b&#x27;, [&#x27;A&#x27;, &#x27;B&#x27;])&gt;&gt;&gt; t[2][0] = &#x27;X&#x27;&gt;&gt;&gt; t[2][1] = &#x27;Y&#x27;&gt;&gt;&gt; t(&#x27;a&#x27;, &#x27;b&#x27;, [&#x27;X&#x27;, &#x27;Y&#x27;]) å…¶å®å˜çš„ä¸æ˜¯tupleçš„å…ƒç´ ï¼Œè€Œæ˜¯listçš„å…ƒç´ ã€‚tupleä¸€å¼€å§‹æŒ‡å‘çš„listå¹¶æ²¡æœ‰æ”¹æˆåˆ«çš„list Dict&gt;&gt;&gt; d = &#123;&#x27;Michael&#x27;: 95, &#x27;Bob&#x27;: 75, &#x27;Tracy&#x27;: 85&#125;&gt;&gt;&gt; d[&#x27;Michael&#x27;]95&gt;&gt;&gt; d[&#x27;Adam&#x27;] = 67&gt;&gt;&gt; d[&#x27;Adam&#x27;]67 åˆ¤æ–­ key æ˜¯å¦å­˜åœ¨&gt;&gt;&gt; &#x27;Thomas&#x27; in dFalse äºŒæ˜¯é€šè¿‡dictæä¾›çš„getæ–¹æ³•ï¼Œå¦‚æœkeyä¸å­˜åœ¨ï¼Œå¯ä»¥è¿”å›Noneï¼Œæˆ–è€…è‡ªå·±æŒ‡å®šçš„valueï¼š &gt;&gt;&gt; d.get(&#x27;Thomas&#x27;)&gt;&gt;&gt; d.get(&#x27;Thomas&#x27;, -1)-1 æ³¨æ„ï¼šè¿”å›Noneçš„æ—¶å€™Pythonçš„äº¤äº’å¼å‘½ä»¤è¡Œä¸æ˜¾ç¤ºç»“æœã€‚ åˆ é™¤ keyï¼Œpop(key)è¦åˆ é™¤ä¸€ä¸ªkeyï¼Œç”¨pop(key)æ–¹æ³•ï¼Œå¯¹åº”çš„valueä¹Ÿä¼šä»dictä¸­åˆ é™¤ï¼š &gt;&gt;&gt; d.pop(&#x27;Bob&#x27;)75&gt;&gt;&gt; d&#123;&#x27;Michael&#x27;: 95, &#x27;Tracy&#x27;: 85&#125; dict list æŸ¥æ‰¾å’Œæ’å…¥çš„é€Ÿåº¦æå¿«ï¼Œä¸ä¼šéšç€keyçš„å¢åŠ è€Œå¢åŠ  æŸ¥æ‰¾å’Œæ’å…¥çš„æ—¶é—´éšç€å…ƒç´ çš„å¢åŠ è€Œå¢åŠ  éœ€è¦å ç”¨å¤§é‡çš„å†…å­˜ï¼Œå†…å­˜æµªè´¹å¤š å ç”¨ç©ºé—´å°ï¼Œæµªè´¹å†…å­˜å¾ˆå°‘ æ‰€ä»¥ï¼Œdictæ˜¯ç”¨ç©ºé—´æ¥æ¢å–æ—¶é—´çš„ä¸€ç§æ–¹æ³•ã€‚ dictå¯ä»¥ç”¨åœ¨éœ€è¦é«˜é€ŸæŸ¥æ‰¾çš„å¾ˆå¤šåœ°æ–¹ï¼Œåœ¨Pythonä»£ç ä¸­å‡ ä¹æ— å¤„ä¸åœ¨ï¼Œæ­£ç¡®ä½¿ç”¨dictéå¸¸é‡è¦ï¼Œéœ€è¦ç‰¢è®°çš„ç¬¬ä¸€æ¡å°±æ˜¯dictçš„keyå¿…é¡»æ˜¯ä¸å¯å˜å¯¹è±¡ã€‚ æ˜¯å› ä¸ºdictæ ¹æ®keyæ¥è®¡ç®—valueçš„å­˜å‚¨ä½ç½®ï¼Œå¦‚æœæ¯æ¬¡è®¡ç®—ç›¸åŒçš„keyå¾—å‡ºçš„ç»“æœä¸åŒï¼Œé‚£dictå†…éƒ¨å°±å®Œå…¨æ··ä¹±äº†ã€‚è¿™ä¸ªé€šè¿‡keyè®¡ç®—ä½ç½®çš„ç®—æ³•ç§°ä¸ºå“ˆå¸Œç®—æ³•ï¼ˆHashï¼‰ã€‚ ä¿è¯hashçš„æ­£ç¡®æ€§ï¼Œä½œä¸ºkeyçš„å¯¹è±¡å°±ä¸èƒ½å˜ã€‚åœ¨Pythonä¸­ï¼Œå­—ç¬¦ä¸²ã€æ•´æ•°ç­‰éƒ½æ˜¯ä¸å¯å˜çš„ï¼Œå› æ­¤ï¼Œå¯ä»¥æ”¾å¿ƒåœ°ä½œä¸ºkeyã€‚è€Œlistæ˜¯å¯å˜çš„ï¼Œå°±ä¸èƒ½ä½œä¸ºkeyï¼š Setsetå’Œdictç±»ä¼¼ï¼Œä¹Ÿæ˜¯ä¸€ç»„keyçš„é›†åˆï¼Œä½†ä¸å­˜å‚¨valueã€‚ç”±äºkeyä¸èƒ½é‡å¤ï¼Œæ‰€ä»¥ï¼Œåœ¨setä¸­ï¼Œæ²¡æœ‰é‡å¤çš„keyã€‚ set initè¦åˆ›å»ºä¸€ä¸ªsetï¼Œéœ€è¦æä¾›ä¸€ä¸ªlistä½œä¸ºè¾“å…¥é›†åˆï¼š &gt;&gt;&gt; s = set([1, 2, 3])&gt;&gt;&gt; sset([1, 2, 3]) æ³¨æ„ï¼Œä¼ å…¥çš„å‚æ•°[1, 2, 3]æ˜¯ä¸€ä¸ªlistï¼Œè€Œæ˜¾ç¤ºçš„set([1, 2, 3])åªæ˜¯å‘Šè¯‰ä½ è¿™ä¸ªsetå†…éƒ¨æœ‰1ï¼Œ2ï¼Œ3è¿™3ä¸ªå…ƒç´ ï¼Œæ˜¾ç¤ºçš„[]ä¸è¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ªlistã€‚ addã€remove&gt;&gt;&gt; s = set([1, 1, 2, 2, 3, 3])&gt;&gt;&gt; sset([1, 2, 3])&gt;&gt;&gt; s.add(4)&gt;&gt;&gt; sset([1, 2, 3, 4])&gt;&gt;&gt; s.add(4)&gt;&gt;&gt; sset([1, 2, 3, 4])&gt;&gt;&gt; s.remove(4)&gt;&gt;&gt; sset([1, 2, 3]) set &amp; and |setå¯ä»¥çœ‹æˆæ•°å­¦æ„ä¹‰ä¸Šçš„æ— åºå’Œæ— é‡å¤å…ƒç´ çš„é›†åˆï¼Œå› æ­¤ï¼Œä¸¤ä¸ªsetå¯ä»¥åšæ•°å­¦æ„ä¹‰ä¸Šçš„äº¤é›†ã€å¹¶é›†ç­‰æ“ä½œï¼š &gt;&gt;&gt; s1 = set([1, 2, 3])&gt;&gt;&gt; s2 = set([2, 3, 4])&gt;&gt;&gt; s1 &amp; s2set([2, 3])&gt;&gt;&gt; s1 | s2set([1, 2, 3, 4]) setå’Œdictçš„å”¯ä¸€åŒºåˆ«ä»…åœ¨äºæ²¡æœ‰å­˜å‚¨å¯¹åº”çš„valueï¼Œsetçš„åŸç†å’Œdictä¸€æ ·. differenceã€intersectionæˆ‘ä»¬è¿˜èƒ½è¿›è¡Œä¸€äº›ç­›é€‰æ“ä½œ, æ¯”å¦‚å¯¹æ¯”å¦ä¸€ä¸ªä¸œè¥¿, çœ‹çœ‹åŸæ¥çš„ set é‡Œæœ‰æ²¡æœ‰å’Œä»–ä¸åŒçš„ (difference). æˆ–è€…å¯¹æ¯”å¦ä¸€ä¸ªä¸œè¥¿, çœ‹çœ‹ set é‡Œæœ‰æ²¡æœ‰ç›¸åŒçš„ (intersection). print(unique_char)# &#123;&#x27;b&#x27;, &#x27;c&#x27;, &#x27;a&#x27;&#125;unique_char = set(char_list)print(unique_char.difference(&#123;&#x27;a&#x27;, &#x27;e&#x27;, &#x27;i&#x27;&#125;))# &#123;&#x27;b&#x27;, &#x27;d&#x27;, &#x27;c&#x27;&#125;print(unique_char.intersection(&#123;&#x27;a&#x27;, &#x27;e&#x27;, &#x27;i&#x27;&#125;))# &#123;&#x27;a&#x27;&#125; è®®ä¸å¯å˜å¯¹è±¡&gt;&gt;&gt; a = [&#x27;c&#x27;, &#x27;b&#x27;, &#x27;a&#x27;]&gt;&gt;&gt; a.sort()&gt;&gt;&gt; a[&#x27;a&#x27;, &#x27;b&#x27;, &#x27;c&#x27;]&gt;&gt;&gt; a = &#x27;abc&#x27;&gt;&gt;&gt; a.replace(&#x27;a&#x27;, &#x27;A&#x27;)&#x27;Abc&#x27;&gt;&gt;&gt; a&#x27;abc&#x27; å°ç»“ : ä½¿ç”¨key-valueå­˜å‚¨ç»“æ„çš„dictåœ¨Pythonä¸­éå¸¸æœ‰ç”¨ï¼Œé€‰æ‹©ä¸å¯å˜å¯¹è±¡ä½œä¸ºkeyå¾ˆé‡è¦ï¼Œæœ€å¸¸ç”¨çš„keyæ˜¯å­—ç¬¦ä¸²ã€‚ tuple è™½ç„¶æ˜¯ä¸å˜å¯¹è±¡ï¼Œä½†è¯•è¯•æŠŠ (1, 2, 3) å’Œ (1, [2, 3]) æ”¾å…¥dictæˆ–setä¸­ï¼Œå¹¶è§£é‡Šç»“æœã€‚ Reference article å»–é›ªå³°çš„å®˜æ–¹ç½‘ç«™","categories":[{"name":"python","slug":"python","permalink":"http://iequa.com/categories/python/"}],"tags":[{"name":"python","slug":"python","permalink":"http://iequa.com/tags/python/"}]},{"title":"Python å­—ç¬¦ç¼–ç  & å­—ç¬¦ä¸²","slug":"python/language/py-language-3-str-&-character-encoding","date":"2017-05-31T05:05:21.000Z","updated":"2019-10-20T04:30:35.006Z","comments":true,"path":"2017/05/31/python/language/py-language-3-str-&-character-encoding/","link":"","permalink":"http://iequa.com/2017/05/31/python/language/py-language-3-str-&-character-encoding/","excerpt":"Python å­—ç¬¦ç¼–ç  å¤§æ¦‚åŸç† ä¸ å­—ç¬¦ä¸²ç®€å•æ“ä½œ","text":"Python å­—ç¬¦ç¼–ç  å¤§æ¦‚åŸç† ä¸ å­—ç¬¦ä¸²ç®€å•æ“ä½œ å­—ç¬¦ç¼–ç å› ä¸ºè®¡ç®—æœºåªèƒ½å¤„ç†æ•°å­—ï¼Œå¦‚æœè¦å¤„ç†æ–‡æœ¬ï¼Œå°±å¿…é¡»å…ˆæŠŠæ–‡æœ¬è½¬æ¢ä¸ºæ•°å­—æ‰èƒ½å¤„ç†ã€‚æœ€æ—©çš„è®¡ç®—æœºåœ¨è®¾è®¡æ—¶é‡‡ç”¨8ä¸ªæ¯”ç‰¹ï¼ˆbitï¼‰ä½œä¸ºä¸€ä¸ªå­—èŠ‚ï¼ˆbyteï¼‰ï¼Œæ‰€ä»¥ï¼Œä¸€ä¸ªå­—èŠ‚èƒ½è¡¨ç¤ºçš„æœ€å¤§çš„æ•´æ•°å°±æ˜¯255ï¼ˆäºŒè¿›åˆ¶11111111=åè¿›åˆ¶255ï¼‰ï¼Œå¦‚æœè¦è¡¨ç¤ºæ›´å¤§çš„æ•´æ•°ï¼Œå°±å¿…é¡»ç”¨æ›´å¤šçš„å­—èŠ‚ã€‚æ¯”å¦‚ä¸¤ä¸ªå­—èŠ‚å¯ä»¥è¡¨ç¤ºçš„æœ€å¤§æ•´æ•°æ˜¯65535ï¼Œ4ä¸ªå­—èŠ‚å¯ä»¥è¡¨ç¤ºçš„æœ€å¤§æ•´æ•°æ˜¯4294967295ã€‚ ç”±äºè®¡ç®—æœºæ˜¯ç¾å›½äººå‘æ˜çš„ï¼Œå› æ­¤ï¼Œæœ€æ—©åªæœ‰127ä¸ªå­—æ¯è¢«ç¼–ç åˆ°è®¡ç®—æœºé‡Œï¼Œä¹Ÿå°±æ˜¯å¤§å°å†™è‹±æ–‡å­—æ¯ã€æ•°å­—å’Œä¸€äº›ç¬¦å·ï¼Œè¿™ä¸ªç¼–ç è¡¨è¢«ç§°ä¸ºASCIIç¼–ç ï¼Œæ¯”å¦‚å¤§å†™å­—æ¯Açš„ç¼–ç æ˜¯65ï¼Œå°å†™å­—æ¯zçš„ç¼–ç æ˜¯122ã€‚ ä½†æ˜¯è¦å¤„ç†ä¸­æ–‡æ˜¾ç„¶ä¸€ä¸ªå­—èŠ‚æ˜¯ä¸å¤Ÿçš„ï¼Œè‡³å°‘éœ€è¦ä¸¤ä¸ªå­—èŠ‚ï¼Œè€Œä¸”è¿˜ä¸èƒ½å’ŒASCIIç¼–ç å†²çªï¼Œæ‰€ä»¥ï¼Œä¸­å›½åˆ¶å®šäº†GB2312ç¼–ç ï¼Œç”¨æ¥æŠŠä¸­æ–‡ç¼–è¿›å»ã€‚ å› æ­¤ï¼ŒUnicodeåº”è¿è€Œç”Ÿã€‚UnicodeæŠŠæ‰€æœ‰è¯­è¨€éƒ½ç»Ÿä¸€åˆ°ä¸€å¥—ç¼–ç é‡Œï¼Œè¿™æ ·å°±ä¸ä¼šå†æœ‰ä¹±ç é—®é¢˜äº†ã€‚ Unicodeæ ‡å‡†ä¹Ÿåœ¨ä¸æ–­å‘å±•ï¼Œä½†æœ€å¸¸ç”¨çš„æ˜¯ç”¨ä¸¤ä¸ªå­—èŠ‚è¡¨ç¤ºä¸€ä¸ªå­—ç¬¦ï¼ˆå¦‚æœè¦ç”¨åˆ°éå¸¸ååƒ»çš„å­—ç¬¦ï¼Œå°±éœ€è¦4ä¸ªå­—èŠ‚ï¼‰ã€‚ç°ä»£æ“ä½œç³»ç»Ÿå’Œå¤§å¤šæ•°ç¼–ç¨‹è¯­è¨€éƒ½ç›´æ¥æ”¯æŒUnicodeã€‚ å­—æ¯Aç”¨ASCIIç¼–ç æ˜¯åè¿›åˆ¶çš„65ï¼ŒäºŒè¿›åˆ¶çš„01000001ï¼› å­—ç¬¦0ç”¨ASCIIç¼–ç æ˜¯åè¿›åˆ¶çš„48ï¼ŒäºŒè¿›åˆ¶çš„00110000ï¼Œæ³¨æ„å­—ç¬¦â€™0â€™å’Œæ•´æ•°0æ˜¯ä¸åŒçš„ï¼› ä½ å¯ä»¥çŒœæµ‹ï¼Œå¦‚æœæŠŠASCIIç¼–ç çš„Aç”¨Unicodeç¼–ç ï¼Œåªéœ€è¦åœ¨å‰é¢è¡¥0å°±å¯ä»¥ï¼Œå› æ­¤ï¼ŒAçš„Unicodeç¼–ç æ˜¯00000000 01000001ã€‚ æ–°çš„é—®é¢˜åˆå‡ºç°äº†ï¼šå¦‚æœç»Ÿä¸€æˆUnicodeç¼–ç ï¼Œä¹±ç é—®é¢˜ä»æ­¤æ¶ˆå¤±äº†ã€‚ä½†æ˜¯ï¼Œå¦‚æœä½ å†™çš„æ–‡æœ¬åŸºæœ¬ä¸Šå…¨éƒ¨æ˜¯è‹±æ–‡çš„è¯ï¼Œç”¨Unicodeç¼–ç æ¯”ASCIIç¼–ç éœ€è¦å¤šä¸€å€çš„å­˜å‚¨ç©ºé—´ï¼Œåœ¨å­˜å‚¨å’Œä¼ è¾“ä¸Šå°±ååˆ†ä¸åˆ’ç®—ã€‚ æ‰€ä»¥ï¼Œæœ¬ç€èŠ‚çº¦çš„ç²¾ç¥ï¼Œåˆå‡ºç°äº†æŠŠUnicodeç¼–ç è½¬åŒ–ä¸ºâ€œå¯å˜é•¿ç¼–ç â€çš„UTF-8ç¼–ç ã€‚UTF-8ç¼–ç æŠŠä¸€ä¸ªUnicodeå­—ç¬¦æ ¹æ®ä¸åŒçš„æ•°å­—å¤§å°ç¼–ç æˆ1-6ä¸ªå­—èŠ‚ï¼Œå¸¸ç”¨çš„è‹±æ–‡å­—æ¯è¢«ç¼–ç æˆ1ä¸ªå­—èŠ‚ï¼Œæ±‰å­—é€šå¸¸æ˜¯3ä¸ªå­—èŠ‚ï¼Œåªæœ‰å¾ˆç”Ÿåƒ»çš„å­—ç¬¦æ‰ä¼šè¢«ç¼–ç æˆ4-6ä¸ªå­—èŠ‚ã€‚å¦‚æœä½ è¦ä¼ è¾“çš„æ–‡æœ¬åŒ…å«å¤§é‡è‹±æ–‡å­—ç¬¦ï¼Œç”¨UTF-8ç¼–ç å°±èƒ½èŠ‚çœç©ºé—´ï¼š åœ¨è®¡ç®—æœºå†…å­˜ä¸­ï¼Œç»Ÿä¸€ä½¿ç”¨Unicodeç¼–ç ï¼Œå½“éœ€è¦ä¿å­˜åˆ°ç¡¬ç›˜æˆ–è€…éœ€è¦ä¼ è¾“çš„æ—¶å€™ï¼Œå°±è½¬æ¢ä¸ºUTF-8ç¼–ç ã€‚ å­—ç¬¦ä¸²å› ä¸ºPythonçš„è¯ç”Ÿæ¯”Unicodeæ ‡å‡†å‘å¸ƒçš„æ—¶é—´è¿˜è¦æ—©ï¼Œæ‰€ä»¥æœ€æ—©çš„Pythonåªæ”¯æŒASCIIç¼–ç ï¼Œæ™®é€šçš„å­—ç¬¦ä¸²&#39;ABC&#39;åœ¨Pythonå†…éƒ¨éƒ½æ˜¯ASCIIç¼–ç çš„ã€‚ &gt;&gt;&gt; ord(&#x27;A&#x27;)65&gt;&gt;&gt; chr(65)&#x27;A&#x27; Pythonåœ¨åæ¥æ·»åŠ äº†å¯¹Unicodeçš„æ”¯æŒï¼Œä»¥Unicodeè¡¨ç¤ºçš„å­—ç¬¦ä¸²ç”¨u&#39;...&#39;è¡¨ç¤ºï¼Œæ¯”å¦‚ï¼š &gt;&gt;&gt; print u&#x27;ä¸­æ–‡&#x27;ä¸­æ–‡&gt;&gt;&gt; u&#x27;ä¸­&#x27;u&#x27;\\u4e2d&#x27; å†™u&#39;ä¸­&#39;å’Œu&#39;\\u4e2d&#39;æ˜¯ä¸€æ ·çš„ï¼Œ\\uåé¢æ˜¯åå…­è¿›åˆ¶çš„Unicodeç ã€‚å› æ­¤ï¼Œu&#39;A&#39;å’Œu&#39;\\u0041&#39;ä¹Ÿä¸€æ ·çš„ã€‚ ä¸¤ç§å­—ç¬¦ä¸²å¦‚ä½•ç›¸äº’è½¬æ¢ï¼Ÿå­—ç¬¦ä¸²&#39;xxx&#39;è™½ç„¶æ˜¯ASCIIç¼–ç ï¼Œä½†ä¹Ÿå¯ä»¥çœ‹æˆæ˜¯UTF-8ç¼–ç ï¼Œè€Œu&#39;xxx&#39;åˆ™åªèƒ½æ˜¯Unicodeç¼–ç ã€‚ æŠŠu&#39;xxx&#39;è½¬æ¢ä¸ºUTF-8ç¼–ç çš„&#39;xxx&#39;ç”¨encode(&#39;utf-8&#39;)æ–¹æ³•ï¼š &gt;&gt;&gt; u&#x27;ABC&#x27;.encode(&#x27;utf-8&#x27;)&#x27;ABC&#x27;&gt;&gt;&gt; u&#x27;ä¸­æ–‡&#x27;.encode(&#x27;utf-8&#x27;)&#x27;\\xe4\\xb8\\xad\\xe6\\x96\\x87&#x27; è‹±æ–‡å­—ç¬¦è½¬æ¢åè¡¨ç¤ºçš„UTF-8çš„å€¼å’ŒUnicodeå€¼ç›¸ç­‰ï¼ˆä½†å ç”¨çš„å­˜å‚¨ç©ºé—´ä¸åŒï¼‰ï¼Œè€Œä¸­æ–‡å­—ç¬¦è½¬æ¢å1ä¸ªUnicodeå­—ç¬¦å°†å˜ä¸º3ä¸ªUTF-8å­—ç¬¦ï¼Œä½ çœ‹åˆ°çš„\\xe4å°±æ˜¯å…¶ä¸­ä¸€ä¸ªå­—èŠ‚ï¼Œå› ä¸ºå®ƒçš„å€¼æ˜¯228ï¼Œæ²¡æœ‰å¯¹åº”çš„å­—æ¯å¯ä»¥æ˜¾ç¤ºï¼Œæ‰€ä»¥ä»¥åå…­è¿›åˆ¶æ˜¾ç¤ºå­—èŠ‚çš„æ•°å€¼ã€‚len()å‡½æ•°å¯ä»¥è¿”å›å­—ç¬¦ä¸²çš„é•¿åº¦ï¼š &gt;&gt;&gt; len(u&#x27;ABC&#x27;)3&gt;&gt;&gt; len(&#x27;ABC&#x27;)3&gt;&gt;&gt; len(u&#x27;ä¸­æ–‡&#x27;)2&gt;&gt;&gt; len(&#x27;\\xe4\\xb8\\xad\\xe6\\x96\\x87&#x27;)6 åè¿‡æ¥ï¼ŒæŠŠUTF-8ç¼–ç è¡¨ç¤ºçš„å­—ç¬¦ä¸²&#39;xxx&#39;è½¬æ¢ä¸ºUnicodeå­—ç¬¦ä¸²u&#39;xxx&#39;ç”¨decode(&#39;utf-8&#39;)æ–¹æ³•ï¼š &gt;&gt;&gt; &#x27;abc&#x27;.decode(&#x27;utf-8&#x27;)u&#x27;abc&#x27;&gt;&gt;&gt; &#x27;\\xe4\\xb8\\xad\\xe6\\x96\\x87&#x27;.decode(&#x27;utf-8&#x27;)u&#x27;\\u4e2d\\u6587&#x27;&gt;&gt;&gt; print &#x27;\\xe4\\xb8\\xad\\xe6\\x96\\x87&#x27;.decode(&#x27;utf-8&#x27;)ä¸­æ–‡ æ ¼å¼åŒ–&gt;&gt;&gt; &#x27;Hello, %s&#x27; % &#x27;world&#x27;&#x27;Hello, world&#x27;&gt;&gt;&gt; &#x27;Hi, %s, you have $%d.&#x27; % (&#x27;Michael&#x27;, 1000000)&#x27;Hi, Michael, you have $1000000.&#x27; &gt;&gt;&gt; &#x27;%2d-%02d&#x27; % (3, 1)&#x27; 3-01&#x27;&gt;&gt;&gt; &#x27;%.2f&#x27; % 3.1415926&#x27;3.14&#x27; Reference å»–é›ªå³°çš„å®˜æ–¹ç½‘ç«™","categories":[{"name":"python","slug":"python","permalink":"http://iequa.com/categories/python/"}],"tags":[{"name":"python","slug":"python","permalink":"http://iequa.com/tags/python/"}]},{"title":"Python Outputã€Variableã€dataTypeã€Ifã€While/Forã€Py Head","slug":"python/language/py-language-2-Output-Variable-dataType-If-While:For-PyHead","date":"2017-05-31T03:00:21.000Z","updated":"2019-10-20T04:30:35.004Z","comments":true,"path":"2017/05/31/python/language/py-language-2-Output-Variable-dataType-If-While:For-PyHead/","link":"","permalink":"http://iequa.com/2017/05/31/python/language/py-language-2-Output-Variable-dataType-If-While:For-PyHead/","excerpt":"Python çš„ print è¯­å¥ã€Variable å˜é‡å®šä¹‰ã€ æ•°æ®ç±»å‹ã€æ¡ä»¶ä¸å¾ªç¯","text":"Python çš„ print è¯­å¥ã€Variable å˜é‡å®šä¹‰ã€ æ•°æ®ç±»å‹ã€æ¡ä»¶ä¸å¾ªç¯ Outputprintè¯­å¥ä¹Ÿå¯ä»¥è·Ÿä¸Šå¤šä¸ªå­—ç¬¦ä¸²ï¼Œç”¨é€—å·â€œ,â€éš”å¼€ï¼Œå°±å¯ä»¥è¿æˆä¸€ä¸²è¾“å‡ºï¼š print(&#x27;The quick brown fox&#x27;, &#x27;jumps over&#x27;, &#x27;the lazy dog&#x27;) The quick brown fox jumps over the lazy dog printä¼šä¾æ¬¡æ‰“å°æ¯ä¸ªå­—ç¬¦ä¸²ï¼Œé‡åˆ°é€—å·â€œ,â€ä¼šè¾“å‡ºä¸€ä¸ªç©ºæ ¼ print(int(&#x27;2&#x27;)+3) # int å­—ç¬¦ä¸²ä¼šè½¬ä¸ºæ•´æ•°print(int(1.9)) # intä¼šä¿ç•™æ•´æ•°éƒ¨åˆ†print(float(&#x27;1.2&#x27;)+3) #float()æ˜¯æµ®ç‚¹å‹ï¼Œå¯ä»¥æŠŠå­—ç¬¦ä¸²è½¬æ¢æˆå°æ•° 5 1 4.2 Input&gt;&gt;&gt; name = input()Blair&gt;&gt;&gt; print(&#x27;Hello,&#x27;, name)Hello, Blair Variablea,b,c=11,12,13print(a,b,c) 11 12 13 global varé‚£å¦‚ä½•åœ¨å¤–éƒ¨ä¹Ÿèƒ½è°ƒç”¨ä¸€ä¸ªåœ¨å±€éƒ¨é‡Œä¿®æ”¹äº†çš„å…¨å±€å˜é‡å‘¢. é¦–å…ˆæˆ‘ä»¬åœ¨å¤–éƒ¨å®šä¹‰ä¸€ä¸ªå…¨å±€å˜é‡ a=None, ç„¶åå† fun() ä¸­å£°æ˜ è¿™ä¸ª a æ˜¯æ¥è‡ªå¤–éƒ¨çš„ a. å£°æ˜æ–¹å¼å°±æ˜¯ global a. ç„¶åå¯¹è¿™ä¸ªå¤–éƒ¨çš„ a ä¿®æ”¹å, ä¿®æ”¹çš„æ•ˆæœä¼šè¢«æ–½åŠ åˆ°å¤–éƒ¨çš„ a ä¸Š. æ‰€ä»¥æˆ‘ä»¬å°†èƒ½çœ‹åˆ°è¿è¡Œå®Œ fun(), a çš„å€¼ä» None å˜æˆäº† 20. APPLY = 100 # å…¨å±€å˜é‡a = Nonedef fun(): global a # ä½¿ç”¨ä¹‹å‰åœ¨å…¨å±€é‡Œå®šä¹‰çš„ a a = 20 # ç°åœ¨çš„ a æ˜¯å…¨å±€å˜é‡äº† return a+100print(APPLE) # 100print(&#x27;a past:&#x27;, a) # Nonefun()print(&#x27;a now:&#x27;, a) # 20 dataType åºå· data type example value 1 int 3 2 float 1.2 3 str â€˜helloâ€™ or â€œhelloâ€ 4 boolean True/False 5 None None 6 å¸¸é‡ if/elseage = 20if age &gt;= 6: print(&#x27;teenager&#x27;)elif age &gt;= 18: print(&#x27;adult&#x27;)else: print(&#x27;kid&#x27;) teenager if/while é‡ Nonev1 = Noneif v1: print(&#x27;v1&#x27;) å¦‚æœ if / while åé¢æ¥ç€çš„è¯­å¥æ•°æ®ç±»å‹ None, å°†ä¸ False å¤„ç†æ–¹å¼ç›¸åŒ if/while é‡ ç©ºé›†åˆA = []if A: print(&quot;A is empty !&quot;)A = [1, 2, 3]if A: print(&quot;A is not empty !&quot;) A is not empty ! åœ¨ Python ä¸­é›†åˆç±»å‹æœ‰ listã€ tuple ã€dict å’Œ set ç­‰ï¼Œå¦‚æœè¯¥é›†åˆå¯¹è±¡ä½œä¸º if æˆ– while åˆ¤æ–­è¯­å¥, åˆ™ä¸ False å¤„ç†æ–¹å¼ç›¸åŒ While/Fora = range(5)while a: print(a[-1]) a = a[:len(a)-1] 4 3 2 1 0 names = [&#x27;Michael&#x27;, &#x27;Bob&#x27;, &#x27;Tracy&#x27;]for name in names: print(name) Michael Bob Tracy py ç¨‹åºå¤´éƒ¨#!/usr/bin/env python# -*- coding: utf-8 -*- ç¬¬ä¸€è¡Œæ³¨é‡Šæ˜¯ä¸ºäº†å‘Šè¯‰Linux/OS Xç³»ç»Ÿï¼Œè¿™æ˜¯ä¸€ä¸ªPythonå¯æ‰§è¡Œç¨‹åºï¼ŒWindowsç³»ç»Ÿä¼šå¿½ç•¥è¿™ä¸ªæ³¨é‡Šï¼› ç¬¬äºŒè¡Œæ³¨é‡Šæ˜¯ä¸ºäº†å‘Šè¯‰Pythonè§£é‡Šå™¨ï¼ŒæŒ‰ç…§UTF-8ç¼–ç è¯»å–æºä»£ç ï¼Œå¦åˆ™ï¼Œåœ¨æºä»£ç ä¸­å†™çš„ä¸­æ–‡è¾“å‡ºå¯èƒ½ä¼šä¹±ç ã€‚ Reference morvanzhou python å»–é›ªå³°çš„å®˜æ–¹ç½‘ç«™","categories":[{"name":"python","slug":"python","permalink":"http://iequa.com/categories/python/"}],"tags":[{"name":"python","slug":"python","permalink":"http://iequa.com/tags/python/"}]},{"title":"Shuping Yang's University of Maryland speech","slug":"English/english-Shuping-Yang-at-Maryyland","date":"2017-05-27T23:08:21.000Z","updated":"2019-10-20T04:30:35.032Z","comments":true,"path":"2017/05/28/English/english-Shuping-Yang-at-Maryyland/","link":"","permalink":"http://iequa.com/2017/05/28/English/english-Shuping-Yang-at-Maryyland/","excerpt":"Shuping Yang Maryland Graduation Speech About Air and Free","text":"Shuping Yang Maryland Graduation Speech About Air and Free Speech Full Text Good afternoon faculty, students, parents and friends. I am truly honored and grateful to speak at the commencement for the University of Maryland, Class of 2017. People often ask me: Why did you come to the University of Maryland?I always answer: Fresh air. Five years ago, as I step off the plane from China, and left the terminal at Dallas Airport. I was ready to put on one of my five face masks, but when I took my first breath of American air. I put my mask away. The air was so sweet and fresh, and utterly luxurious. I was surprised by this. I grew up in a city in China, where I had to wear a face mask every time I went outside, otherwise, I might get sick. However, the moment Iinhaled and exhaled outside the airportï¼ŒI felt free. No more fog on my glasses, no more difficult breathing, no more suppression. Every breath was a delight. As I stand here today, I cannot help, but recall that feeling of freedom. &nbsp; At the University of Maryland, I will soon feel another kind of fresh air for which I will beforever grateful â€” the fresh air of free speech. Before I came to the UnitedStates, I learned in history class about the Declaration of Independence, butthese words had no meaning to meâ€” Life, Liberty and the Pursuit of happiness. I was merely memorizing the words to get good grades. These words sounded so strange, so abstract and foreign to me, until I came to University of Maryland. I have learned the right to freely express oneself is sacred in American. Each day in Maryland, I was encouraged to express my opinions on controversial issues. I could challenge astatement made by my instructor. I could even rate my professors online. But nothing prepared me forthe culture shock I experienced when I watched a university production of the playâ€” Twilight: Los Angeles. Twilight is a play by AnnaDeavere Smith about the 1992 Los Angeles Riots. The riots followed acquittal of four Los Angeles police officers in the videotaped arrest and beating of Rodney King. For six days, the city was in chaos as citizens took to the streets. In Twilight, the student actors were openly talking about racism, sexism and politics. I was shocked, I never thought such topic could be discussed openly. The play was my first taste of political story telling, one that makes the audience think critically. I have always had a burning desire to tell these kinds of stories, but I was convinced that only authorities on the narrative, only authorities could define the truth. However, the opportunity toimmerse myself in the perse community at the University of Maryland exposed me to various, many different perspectives on truth. I soon realized that here I have the opportunity to speak freely. My voice matters. Your voice matters. Our voices matter. Civil engagement is not at ask just for politicians. I have witnessed this when I saw my fellow student smarching in Washington DC, voting in the presidential election and raising money to support various causes. I have seen that everyone has a right to participate and advocate for change. I used to believe that one inpidual participation could not make a difference, but here we are, United Terps. Together, we can push our society to be more just, open and peaceful. Class of 2017, we are graduating from a university that embraces a liberal arts education that nurtures us to think critically, and also to care and feel for humanity. We are equipped with the knowledge of various disciplines and we are ready to face the challenges of our society. Some of us may go to graduate school, some us may step into professions and some of us may begin ajourney of exploration. But no matter what we do,remember, democracy and free speech should not be taken for granted. Democracy and freedom are the fresh air that is worth fighting for. Freedom is oxygen. Freedomis passion. Freedom is love. And as a French philosopher Jean Paul Sartre once said: freedom is a choice, our future is dependent on the choices we make today and tomorrow. We are all playwrights of the next chapters of our lives. Together, we write the human history. My friends, enjoy the fresh air and never ever let it go. Thank you.","categories":[{"name":"English","slug":"English","permalink":"http://iequa.com/categories/English/"}],"tags":[{"name":"Maryland","slug":"Maryland","permalink":"http://iequa.com/tags/Maryland/"}]},{"title":"Coursera 6 - Advice for Applying Machine Learning *","slug":"ml/coursera-ng-w6-Advice-for-Applying-Machine-Learning","date":"2017-05-24T14:08:21.000Z","updated":"2019-10-20T04:30:35.045Z","comments":true,"path":"2017/05/24/ml/coursera-ng-w6-Advice-for-Applying-Machine-Learning/","link":"","permalink":"http://iequa.com/2017/05/24/ml/coursera-ng-w6-Advice-for-Applying-Machine-Learning/","excerpt":"Evaluating a Hypothesis -&gt; Model Selectionã€Diagnosing Bias vs Variance -&gt; Regularizationã€Learning Curves","text":"Evaluating a Hypothesis -&gt; Model Selectionã€Diagnosing Bias vs Variance -&gt; Regularizationã€Learning Curves 1. Evaluating a HypothesisOnce we have done some trouble shooting for errors in our predictions by: Getting more training examples Trying smaller sets of features Trying additional features Trying polynomial features Increasing or decreasing $Î»$ We can move on to evaluate our new hypothesis. A hypothesis may have a low error for the training examples but still be inaccurate (because of overfitting). Thus, to evaluate a hypothesis, given a dataset of training examples, we can split up the data into two sets: a training set and a test set. Typically, the training set consists of 70% of your data and the test set is the remaining 30%. The new procedure using these two sets is then: Learn $\\Theta$ and minimize $J_{train}(\\Theta)$ using the training set Compute the test set error $J_{test}(\\Theta)$ The test set error For linear regression: $J_{test}(\\Theta) = \\dfrac{1}{2m_{test}} \\sum_{i=1}^{m_{test}}(h_\\Theta(x^{(i)}_{test}) - y^{(i)}_{test})^2$ For classification ~ Misclassification error (aka 0/1 misclassification error): err(h\\_\\Theta(x),y) = \\begin{matrix} 1 & \\mbox{if } h\\_\\Theta(x) \\geq 0.5\\ and\\ y = 0\\ or\\ h\\_\\Theta(x) < 0.5\\ and\\ y = 1\\newline 0 & \\mbox otherwise \\end{matrix}This gives us a binary 0 or 1 error result based on a misclassification. The average test error for the test set is: \\text{Test Error} = \\dfrac{1}{m\\_{test}} \\sum^{m\\_{test}}\\_{i=1} err(h\\_\\Theta(x^{(i)}\\_{test}), y^{(i)}\\_{test})This gives us the proportion of the test data that was misclassified. inaccurate[Éªnâ€™Ã¦kjÉ™rÉ™t]ã€procedure [prÉ™â€™sidÊ’Éš] æ¯”ä¾‹remaining [riâ€™men..]ã€ Misclassification [â€˜mis,klÃ¦sifiâ€™keiÊƒÉ™n]validation [,vÃ¦lÉ™â€™deÊƒÉ™n] ç¡®è®¤ï¼Œæ‰¹å‡† 2. Model SelectionTrain/Validtion/Test Sets Just because a learning algorithm fits a training set well, that does not mean it is a good hypothesis. It could over fit and as a result your predictions on the test set would be poor. The error of your hypothesis as measured on the data set with which you trained the parameters will be lower than the error on any other data set. Given many models with different polynomial degrees, we can use a systematic approach to identify the â€˜bestâ€™ function. In order to choose the model of your hypothesis, you can test each degree of polynomial and look at the error result. One way to break down our dataset into the three sets is: Training set: 60% Cross validation set: 20% Test set: 20% We can now calculate three separate error values for the three different sets using the following method: Optimize the parameters in Î˜ using the training set for each polynomial degree. Find the polynomial degree d with the least error using the cross validation set. Estimate the generalization error using the test set with $J_{test}(\\Theta^{(d)})$, (d = theta from polynomial with lower error); This way, the degree of the polynomial d has not been trained using the test set. 3. Diagnosing Bias vs. VarianceIn this section we examine the relationship between the degree of the polynomial d and the underfitting or overfitting of our hypothesis. We need to distinguish whether bias or variance is the problem contributing to bad predictions. High bias is underfitting and high variance is overfitting. Ideally, we need to find a golden mean between these two. The training error will tend to decrease as we increase the degree d of the polynomial. At the same time, the cross validation error will tend to decrease as we increase d up to a point, and then it will increase as d is increased, forming a convex curve. High bias (underfitting): both $J_{train}(\\Theta)$ and $J_{CV}(\\Theta)$ will be high. Also, $J_{CV}(\\Theta) \\approx J_{train}(\\Theta)$. High variance (overfitting): $J_{train}(\\Theta)$ will be low and $J_{CV}(\\Theta)$ will be much greater than $J_{train}(\\Theta)$. The is summarized in the figure below: 4. Regularization Bias/VarianceNote: [The regularization term below and through out the video should be $\\frac \\lambda {2m} \\sum_{j=1}^n \\theta_j ^2$ and NOT $\\frac \\lambda {2m} \\sum_{j=1}^m \\theta_j ^2$] In the figure above, we see that as Î» increases, our fit becomes more rigid. On the other hand, as Î» approaches 0, we tend to over overfit the data. So how do we choose our parameter Î» to get it â€˜just rightâ€™ ? In order to choose the model and the regularization term Î», we need to: Create a list of lambdas (i.e. Î»âˆˆ{0,0.01,0.02,0.04,0.08,0.16,0.32,0.64,1.28,2.56,5.12,10.24}); Create a set of models with different degrees or any other variants. Iterate through the Î»s and for each Î» go through all the models to learn some Î˜. Compute the cross validation error using the learned Î˜ (computed with Î») on the $J_{CV}(\\Theta)$ without regularization or Î» = 0. ï¼Ÿï¼Ÿ Select the best combo that produces the lowest error on the cross validation set. Using the best combo Î˜ and Î», apply it on $J_{test}(\\Theta)$ to see if it has a good generalization of the problem. 5. Learning CurvesTraining an algorithm on a very few number of data points (such as 1, 2 or 3) will easily have 0 errors because we can always find a quadratic curve that touches exactly those number of points. Hence: As the training set gets larger, the error for a quadratic function increases. The error value will plateau out after a certain m, or training set size. Experiencing high bias: Low training set size: causes $J_{train}(\\Theta)$ to be low and $J_{CV}(\\Theta)$ to be high. Large training set size: causes both $J_{train}(\\Theta)$ and $J_{CV}(\\Theta)$ to be high with $J_{train}(\\Theta)$â‰ˆ$J_{CV}(\\Theta)$. If a learning algorithm is suffering from high bias, getting more training data will not (by itself) help much. me : éšç€train setsçš„å¢åŠ ï¼Œé«˜åå·®ä¼šé™ä½ï¼Œå› ä¸ºæ›´å®¹æ˜“æ‰¾åˆ°åˆé€‚çš„ Hypothesis å»æ‹Ÿåˆæ•°æ®ã€‚æ‰€ä»¥CV errorä¸‹é™ã€‚ Experiencing high variance: Low training set size: $J_{train}(\\Theta)$ will be low and $J_{CV}(\\Theta)$ will be high. Large training set size: $J_{train}(\\Theta)$ increases with training set size and $J_{CV}(\\Theta)$ continues to decrease without leveling off. Also, $J_{train}(\\Theta)$ &lt; $J_{CV}(\\Theta)$ but the difference between them remains significant. If a learning algorithm is suffering from high variance, getting more training data is likely to help. me : éšç€ train sets çš„å¢åŠ ï¼Œoverfiting è¶Šæ¥è¶Šä¸å®¹æ˜“ã€‚é€ æˆ CV error ä¸‹é™ã€‚ plateau out / leveling off è¾¾åˆ°å¹³ç¨³çŠ¶æ€test error will be CV error on picture. 6. What to Do Next Revisited*Our decision process can be broken down as follows: Function Result Getting more training examples Fixes high variance Trying smaller sets of features Fixes high variance Increasing Î» Fixes high variance Adding features Fixes high bias Adding polynomial features Fixes high bias Decreasing Î» Fixes high bias 6.1 Diagnosing NN A neural network with fewer parameters is prone to underfitting. It is also computationally cheaper. A large neural network with more parameters is prone to overfitting. It is also computationally expensive. In this case you can use regularization (increase Î») to address the overfitting. 6.2 Model Complexity Effects Lower-order polynomials (low model complexity) have high bias and low variance. In this case, the model fits poorly consistently. Higher-order polynomials (high model complexity) fit the training data extremely well and the test data extremely poorly. These have low bias on the training data, but very high variance. In reality, we would want to choose a model somewhere in between, that can generalize well but also fits the data reasonably well. Reference article coursera 6 @ng","categories":[{"name":"machine-learning","slug":"machine-learning","permalink":"http://iequa.com/categories/machine-learning/"}],"tags":[{"name":"machine-learning","slug":"machine-learning","permalink":"http://iequa.com/tags/machine-learning/"}]},{"title":"Spark ALS","slug":"spark/spark-ALS","date":"2017-05-07T02:28:21.000Z","updated":"2019-10-20T04:30:35.078Z","comments":true,"path":"2017/05/07/spark/spark-ALS/","link":"","permalink":"http://iequa.com/2017/05/07/spark/spark-ALS/","excerpt":"Spark.apache.orgJava Chen Spark","text":"Spark.apache.orgJava Chen Spark ä»¥ä¸‹ä¸ºæ‰‹åŠ¨è®¡ç®—æµç¨‹ : 4.2 å¯åŠ¨ spark-shellSPARK_CLASSPATH=/opt/cloudera/parcels/CDH/lib/sqoop/mysql-connector-java-5.1.40.jar spark-shell 4.3 è¾“å…¥è¾“å‡º:ç›¸å…³å˜é‡val inputTable = &quot;mds_user_coupon_bhv&quot;val inputUrl = &quot;jdbc:mysql://192.168.xxx.xx:3306/com_profile?user=your_name&amp;password=your_password&quot;val outputTable = &quot;mds_rs_shop_coupon_tmp&quot; 4.4 æ ¸å¿ƒç¨‹åºä»£ç package com.x.rs.serviceimport java.text.SimpleDateFormatimport java.util.Dateimport java.util.Propertiesimport org.apache.spark.sql.Rowimport org.apache.spark.sql.types._import org.apache.spark.&#123;SparkConf, SparkContext&#125;import org.apache.spark.mllib.recommendation.&#123;ALS, Rating&#125;/** * Date : 2017-04-20 * Author : Blair Chan */object RsCouponCalc &#123; def main(args: Array[String]) &#123; println(&quot;start...&quot;) if (args.length &lt; 3) &#123; System.err.println(&quot;Usage: &lt;file&gt;&quot;) System.exit(1) &#125; val inputTable = args(0) // Should be some file on your system // conf = new SparkConf().setAppName(appName).setMaster(&quot;local&quot;); val inputUrl = args(1) val outputTable = args(2) val conf = new SparkConf().setAppName(&quot;SparkRsOne&quot;); val sc = new SparkContext(conf) val sqlContext = new org.apache.spark.sql.SQLContext(sc) // val rawData = sc.textFile(inputFile) // val rawRatings = rawData.map(_.split(&quot;\\t&quot;).take(3)) val url = inputUrl val prop = new Properties() val dfForRawData = sqlContext.read.jdbc(url, inputTable, prop) val ratings_tmp = dfForRawData.map &#123; row =&gt; (row(1).toString().toInt, row(4).toString().toInt, row(6).toString().toDouble) &#125; val ratings = ratings_tmp.map &#123; case (uid, couponId, rating) =&gt; Rating(uid.toInt, couponId.toInt, rating.toDouble) &#125; val model = ALS.train(ratings, 50, 10, 0.01) model.userFeatures.count val K = 10 model.recommendProductsForUsers(K) val originResultRdd1 = model.recommendProductsForUsers(K) val curDate = new Date() val createDateString = new SimpleDateFormat(&quot;yyyy-MM-dd&quot;).format(curDate) val originResultRdd2 = originResultRdd1.map(tuple =&gt; &#123; val uid = tuple._1 val product = tuple._2.map &#123; case Rating(user, product, score) =&gt; (product.toString, score.toString) &#125; (uid, product) &#125;).flatMap &#123; case (uid, product) =&gt; &#123; product.map &#123; case (itemId, score) =&gt; Row.apply(uid.toLong, itemId.toString, score.toDouble, createDateString.toString) &#125; &#125; &#125; // println(originResultRdd2.first()) val schema = StructType( StructField(&quot;uid&quot;, LongType) :: StructField(&quot;coupon_id&quot;, LongType) :: StructField(&quot;score&quot;, DoubleType) :: StructField(&quot;calc_date&quot;, StringType) :: Nil) val df = sqlContext.createDataFrame(originResultRdd2, schema) df.insertIntoJDBC(url, outputTable, false) // è®¾ç½®ä¸º trueï¼Œåˆ™ä¸º åˆ é™¤è¡¨ï¼Œç„¶åè‡ªåŠ¨åˆ›å»ºï¼Œå†æ’å…¥ println(&quot;end !&quot;) &#125;&#125; DF é€šè¿‡æ’å…¥ RMDB. schema å¯ä»¥é€šè¿‡åå°„æ¥ä½¿å¾—ç¨‹åºæ‰©å±•æ€§æé«˜ã€‚ spark sql internet","categories":[{"name":"spark","slug":"spark","permalink":"http://iequa.com/categories/spark/"}],"tags":[{"name":"ALS","slug":"ALS","permalink":"http://iequa.com/tags/ALS/"}]},{"title":"Spark SQLç¼–ç¨‹","slug":"spark/spark-SQL","date":"2017-04-28T07:28:21.000Z","updated":"2019-10-20T04:30:35.078Z","comments":true,"path":"2017/04/28/spark/spark-SQL/","link":"","permalink":"http://iequa.com/2017/04/28/spark/spark-SQL/","excerpt":"Spark SQLï¼Œå¯å¯¹ä¸åŒæ ¼å¼çš„æ•°æ®æ‰§è¡ŒETLæ“ä½œï¼ˆå¦‚JSONï¼ŒParquetï¼Œæ•°æ®åº“ï¼‰ç„¶åå®Œæˆç‰¹å®šçš„æŸ¥è¯¢æ“ä½œã€‚","text":"Spark SQLï¼Œå¯å¯¹ä¸åŒæ ¼å¼çš„æ•°æ®æ‰§è¡ŒETLæ“ä½œï¼ˆå¦‚JSONï¼ŒParquetï¼Œæ•°æ®åº“ï¼‰ç„¶åå®Œæˆç‰¹å®šçš„æŸ¥è¯¢æ“ä½œã€‚ DataFrame Data Sources JDBC Server ä½¿ç”¨Spark SQLæ—¶ï¼Œæœ€ä¸»è¦çš„ä¸¤ä¸ªç»„ä»¶å°±æ˜¯ DataFrame å’Œ SQLContextã€‚ 1. DataFrameDataFrame æ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼çš„ï¼ŒæŒ‰ç…§å‘½ååˆ—çš„å½¢å¼ç»„ç»‡çš„æ•°æ®é›†åˆã€‚DataFrameåŸºäºRè¯­è¨€ä¸­çš„dataframeæ¦‚å¿µï¼Œä¸å…³ç³»å‹æ•°æ®åº“ä¸­çš„æ•°æ®åº“è¡¨ç±»ä¼¼ã€‚ ä¹‹å‰ç‰ˆæœ¬çš„Spark SQL APIä¸­çš„SchemaRDDå·²ç»æ›´åä¸ºDataFrame è°ƒç”¨å°†DataFrameçš„å†…å®¹ä½œä¸ºè¡ŒRDDï¼ˆRDD of Rowsï¼‰è¿”å›çš„rddæ–¹æ³•ï¼Œå¯ä»¥å°†DataFrameè½¬æ¢æˆRDDã€‚ åˆ›å»º DataFrame å¯ä»¥é€šè¿‡å¦‚ä¸‹ æ•°æ®æºåˆ›å»º DataFrame : å·²æœ‰çš„RDD ç»“æ„åŒ–æ•°æ®æ–‡ä»¶ JSONæ•°æ®é›† Hiveè¡¨ å¤–éƒ¨æ•°æ®åº“ DataFrame API Spark SQLå’ŒDataFrame APIå·²ç»åœ¨ä¸‹è¿°å‡ ç§ç¨‹åºè®¾è®¡è¯­è¨€ä¸­å®ç°ï¼š Scala DataFrame API Java DataFrame API Python DataFrame API 2. SQLContextSQLContextå°è£…Sparkä¸­çš„æ‰€æœ‰å…³ç³»å‹åŠŸèƒ½ã€‚å¯ä»¥ç”¨ä¹‹å‰çš„ç¤ºä¾‹ä¸­çš„ç°æœ‰SparkContextåˆ›å»ºSQLContextã€‚ val sqlContext = new org.apache.spark.sql.SQLContext(sc) SQLContextHiveContext 3. JDBCæ•°æ®æºJDBC æ•°æ®æº å¯ç”¨äºé€šè¿‡JDBC APIè¯»å–å…³ç³»å‹æ•°æ®åº“ä¸­çš„æ•°æ®ã€‚ç›¸æ¯”äºä½¿ç”¨JdbcRDDï¼Œåº”è¯¥å°†JDBCæ•°æ®æºçš„æ–¹å¼ä½œä¸ºé¦–é€‰ï¼Œå› ä¸ºJDBCæ•°æ®æºèƒ½å¤Ÿå°†ç»“æœä½œä¸ºDataFrameå¯¹è±¡è¿”å›ï¼Œç›´æ¥ç”¨Spark SQLå¤„ç†æˆ–ä¸å…¶ä»–æ•°æ®æºè¿æ¥ã€‚ ä¸ºç¡®ä¿Spark Shellç¨‹åºæœ‰è¶³å¤Ÿçš„å†…å­˜ï¼Œå¯ä»¥åœ¨è¿è¡Œspark-shellå‘½ä»¤æ—¶ï¼ŒåŠ å…¥driver-memoryå‘½ä»¤è¡Œå‚æ•°ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š spark-shell.cmd --driver-memory 1G Refç”¨Apache Sparkè¿›è¡Œå¤§æ•°æ®å¤„ç†â€”â€”ç¬¬äºŒéƒ¨åˆ†ï¼šSpark SQL","categories":[{"name":"spark","slug":"spark","permalink":"http://iequa.com/categories/spark/"}],"tags":[{"name":"spark","slug":"spark","permalink":"http://iequa.com/tags/spark/"}]},{"title":"Spark Read Mysql çš„å››ç§æ–¹å¼","slug":"spark/spark-read-mysql-four-functions","date":"2017-04-20T07:28:21.000Z","updated":"2019-10-20T04:30:35.076Z","comments":true,"path":"2017/04/20/spark/spark-read-mysql-four-functions/","link":"","permalink":"http://iequa.com/2017/04/20/spark/spark-read-mysql-four-functions/","excerpt":"ç›®å‰ Spark æ”¯æŒå››ç§æ–¹å¼ä»æ•°æ®åº“ä¸­è¯»å–æ•°æ®ï¼Œè¿™é‡Œä»¥ MySQL ä¸ºä¾‹è¿›è¡Œä»‹ç»ã€‚","text":"ç›®å‰ Spark æ”¯æŒå››ç§æ–¹å¼ä»æ•°æ®åº“ä¸­è¯»å–æ•°æ®ï¼Œè¿™é‡Œä»¥ MySQL ä¸ºä¾‹è¿›è¡Œä»‹ç»ã€‚ Startup spark-shellSPARK_CLASSPATH=/opt/cloudera/parcels/CDH/lib/sqoop/mysql-connector-java-5.1.40.jar spark-shell 1. ä¸æŒ‡å®šæŸ¥è¯¢æ¡ä»¶1.1 function definedef jdbc(url: String, table: String, properties: Properties): DataFrame 1.2 detail exampleval url = &quot;jdbc:mysql://192.168.***.**:3306/your_lib_name?user= your_username&amp;password=your_password&quot;import java.util.Propertiesval prop = new Properties()val df = sqlContext.read.jdbc(url, &quot;mds_user_coupon_bhv&quot;, prop )println(df.count())println(df.rdd.partitions.size) æˆ‘ä»¬è¿è¡Œä¸Šé¢çš„ç¨‹åºï¼Œå¯ä»¥çœ‹åˆ°df.rdd.partitions.sizeè¾“å‡ºç»“æœæ˜¯1ï¼Œè¿™ä¸ªç»“æœçš„å«ä¹‰æ˜¯iteblogè¡¨çš„æ‰€æœ‰æ•°æ®éƒ½æ˜¯ç”±RDDçš„ä¸€ä¸ªåˆ†åŒºå¤„ç†çš„ï¼Œæ‰€ä»¥è¯´ï¼Œå¦‚æœä½ è¿™ä¸ªè¡¨å¾ˆå¤§ï¼Œå¾ˆå¯èƒ½ä¼šå‡ºç°OOM Note : è¿™ç§æ–¹å¼åœ¨æ•°æ®é‡å¤§çš„æ—¶å€™ä¸å»ºè®®ä½¿ç”¨ã€‚ 2. æŒ‡å®šæ•°æ®åº“å­—æ®µçš„èŒƒå›´è¿™ç§æ–¹å¼å°±æ˜¯é€šè¿‡æŒ‡å®šæ•°æ®åº“ä¸­æŸä¸ªå­—æ®µçš„èŒƒå›´ï¼Œä½†æ˜¯è¿™ä¸ªå­—æ®µå¿…é¡»æ˜¯æ•°å­—ï¼Œæ¥çœ‹çœ‹è¿™ä¸ªå‡½æ•°çš„å‡½æ•°åŸå‹ï¼š def jdbc( url: String, table: String, columnName: String, lowerBound: Long, upperBound: Long, numPartitions: Int, connectionProperties: Properties): DataFrame â€¦ not finish 3. æ ¹æ®ä»»æ„å­—æ®µè¿›è¡Œåˆ†åŒºâ€¦ 4. é€šè¿‡ load è·å–val df = sqlContext.load(&quot;jdbc&quot;, Map(&quot;url&quot; -&gt; &quot;jdbc:mysql://...&quot;, &quot;dbtable&quot; -&gt; &quot;mds_user_coupon_bhv&quot;) ) æ¢ä¸€ç§æ›´æ­£å¼çš„å†™æ³•å¦‚ä¸‹ : val df = sqlContext.read.format(&quot;jdbc&quot;).options(Map( &quot;url&quot; -&gt; &quot;jdbc:mysql://192.168.***.**:3306/your_lib_name?user= your_username&amp;password=your_password&quot;, &quot;dbtable&quot; -&gt; &quot;mds_user_coupon_bhv&quot;) ).load() optionså‡½æ•°æ”¯æŒurlã€driverã€dbtableã€partitionColumnã€lowerBoundã€upperBoundä»¥åŠnumPartitionsé€‰é¡¹ï¼Œè¿™ä¸ªå’Œæ–¹æ³•äºŒçš„å‚æ•°ä¸€è‡´ã€‚å…¶å†…éƒ¨å®ç°åŸç†éƒ¨åˆ†å’Œæ–¹æ³•äºŒå¤§ä½“ä¸€è‡´ã€‚åŒæ—¶loadæ–¹æ³•è¿˜æ”¯æŒjsonã€orcç­‰æ•°æ®æºçš„è¯»å–ã€‚ Reading notes 5. Reference å°Šé‡åŸåˆ›ï¼Œè½¬è½½è¯·æ³¨æ˜ï¼š è½¬è½½è‡ªè¿‡å¾€è®°å¿†ï¼ˆhttp://www.iteblog.com/ï¼‰ Spark Read Mysql-csdn","categories":[{"name":"spark","slug":"spark","permalink":"http://iequa.com/categories/spark/"}],"tags":[{"name":"spark","slug":"spark","permalink":"http://iequa.com/tags/spark/"}]},{"title":"æ ‡ç­¾ ID å®šä¹‰ç¤ºä¾‹","slug":"datascience/id-label-index","date":"2017-04-20T05:28:21.000Z","updated":"2021-06-14T05:16:52.515Z","comments":true,"path":"2017/04/20/datascience/id-label-index/","link":"","permalink":"http://iequa.com/2017/04/20/datascience/id-label-index/","excerpt":"æ ‡ç­¾ ID å®šä¹‰ç¤ºä¾‹","text":"æ ‡ç­¾ ID å®šä¹‰ç¤ºä¾‹ å¹´é¾„ å«ä¹‰ æ€§åˆ« å«ä¹‰ å…´è¶£ å«ä¹‰ äººç¾¤ å«ä¹‰ åœ°åŸŸ å«ä¹‰ 00601 0-20å² 00501 ç”· 00801 ç§‘æŠ€ 00901 éƒ½å¸‚ç™½é¢† 331001 åŒ—äº¬ 00602 21-25å² 00502 å¥³ 00802 ä¸½äºº 00902 è¿åŠ¨å¥èº« 331002 ä¸Šæµ· 00603 26-30å² .. .. 00803 æˆ¿äº§ 00903 æ—¶å°šè¾¾äºº 332001 æµ™æ±Ÿçœ-æ­å· 00604 31-35å² 00804 æ•™è‚² 00904 é’æ˜¥æ ¡å›­ .. .. .. .. 00806 è‚²å„¿ .. .. å·²ç»æ¥å…¥DMPçš„å®¢æˆ· å®¢æˆ·åç§° å®¢æˆ·ID å…¶ä»– è€è‹å® 1001 åºŸå¼ƒ ç§’é’ˆ 1002 ç§’é’ˆ ç™¾åˆ†ç‚¹ 1003 ç™¾åˆ†ç‚¹ æ™¶èµ 1004 æ™¶èµ åæ‰¬ 1005 åæ‰¬ æ´¾æ‹© 1006 æ´¾æ‹© è‹å® 6809 å’Œä¸šåŠ¡ç«¯ç»Ÿä¸€","categories":[{"name":"data-science","slug":"data-science","permalink":"http://iequa.com/categories/data-science/"}],"tags":[{"name":"sina","slug":"sina","permalink":"http://iequa.com/tags/sina/"}]},{"title":"New Mac Install Brew Iterm Zsh","slug":"devops/ops-new-macosx-install-soft","date":"2017-03-22T08:43:21.000Z","updated":"2019-10-20T04:30:34.991Z","comments":true,"path":"2017/03/22/devops/ops-new-macosx-install-soft/","link":"","permalink":"http://iequa.com/2017/03/22/devops/ops-new-macosx-install-soft/","excerpt":"æ–°æœº mac å®‰è£…ä¸€äº›å¸¸ç”¨è½¯ä»¶","text":"æ–°æœº mac å®‰è£…ä¸€äº›å¸¸ç”¨è½¯ä»¶ 1. install homebrewMac ä¸‹é¢çš„åŒ…ç®¡ç†å·¥å…·ï¼Œé€šè¿‡ Github æ‰˜ç®¡é€‚åˆ Mac çš„ç¼–è¯‘é…ç½®ä»¥åŠ Patchï¼Œå¯ä»¥æ–¹ä¾¿çš„å®‰è£…å¼€å‘å·¥å…·ã€‚ Mac è‡ªå¸¦ruby æ‰€ä»¥å®‰è£…èµ·æ¥å¾ˆæ–¹ä¾¿ï¼ŒåŒæ—¶å®ƒä¹Ÿä¼šè‡ªåŠ¨æŠŠgitä¹Ÿç»™ä½ è£…ä¸Šã€‚ /usr/bin/ruby -e &quot;$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)&quot; å®‰è£…è¿‡ç¨‹å¯èƒ½ä¼šæœ‰ç‚¹æ…¢ï¼Œå®Œæˆä¹‹åï¼Œå»ºè®®æ‰§è¡Œä¸€ä¸‹è‡ªæ£€ï¼Œbrew doctorçœ‹åˆ°Your system is ready to brew.é‚£ä¹ˆæ­å–œä½ çš„ brew å·²ç»å¯ä»¥å¼€å§‹ä½¿ç”¨äº†ã€‚ brew install wget treebrew å¸¸ç”¨å‘½ä»¤ï¼š ï¼ˆæ‰€æœ‰è½¯ä»¶ä»¥PHP5.5ä¸ºä¾‹å­ï¼‰ brew update #æ›´æ–°brewå¯å®‰è£…åŒ…ï¼Œå»ºè®®æ¯æ¬¡æ‰§è¡Œä¸€ä¸‹brew search php55 #æœç´¢php5.5brew tap josegonzalez/php #å®‰è£…æ‰©å±•&lt;gihhub_user/repo&gt; brew tap #æŸ¥çœ‹å®‰è£…çš„æ‰©å±•åˆ—è¡¨brew install php55 #å®‰è£…php5.5brew remove php55 #å¸è½½php5.5brew upgrade php55 #å‡çº§php5.5brew options php55 #æŸ¥çœ‹php5.5å®‰è£…é€‰é¡¹brew info php55 #æŸ¥çœ‹php5.5ç›¸å…³ä¿¡æ¯brew home php55 #è®¿é—®php5.5å®˜æ–¹ç½‘ç«™brew services list #æŸ¥çœ‹ç³»ç»Ÿé€šè¿‡ brew å®‰è£…çš„æœåŠ¡brew services cleanup #æ¸…é™¤å·²å¸è½½æ— ç”¨çš„å¯åŠ¨é…ç½®æ–‡ä»¶brew services restart php55 #é‡å¯php-fpm æ³¨æ„ï¼šbrew services ç›¸å…³å‘½ä»¤æœ€å¥½åˆ«ç»å¸¸ç”¨äº†ï¼Œæç¤ºä¼šè¢«ç§»é™¤ 2. install zshohmyzsh &amp; iTerm2 ä¸¤ä¸ªç¥å™¨ï¼Œåœ¨Mac os xä¸‹æ˜¯ä¸€å®šè¦è£…çš„. 2.1 install onmyzshcurl -L http://install.ohmyz.sh | sh 2.2 install zshåœ¨ Terminal ä¸‹ï¼Œç›´æ¥æ•² zsh. ä¸‹é¢è¯·æš‚æ—¶å¿½ç•¥ è®¾ç½®é»˜è®¤shell cat /etc/shells # List of acceptable shells for chpass(1). # Ftpd will not allow users to connect who are not using # one of these shells. /bin/bash /bin/csh /bin/ksh /bin/sh /bin/tcsh /bin/zsh zsh --version zsh 5.0.2 (x86_64-apple-darwin13.0) chsh -s /bin/zsh è™½ç„¶Macè‡ªå¸¦äº†zshï¼Œå¦‚æœä½ æƒ³è¦æœ€æ–°ç‰ˆçš„zshï¼Œé‚£ä¹ˆä½ ç”¨ brew install zshå®‰è£…ä¸€ä¸ªæœ€æ–°çš„å§ã€‚ /usr/local/bin/zsh --version zsh 5.0.5 (x86_64-apple-darwin13.3.0) åŒºåˆ«ä¹Ÿä¸ä¼šå¾ˆå¤§ï¼Œ é»˜è®¤çš„ç‰ˆæœ¬å·²ç»å¾ˆæ–°äº†ã€‚ å®‰è£…åæœ€å¥½å¤‡ä»½ : cp ~/.zshrc ~/.zshrc.orig 3. homebrew-caskinstall brew cask brew tap phinze/homebrew-cask caskå¸¸ç”¨å‘½ä»¤ï¼š brew cask search #åˆ—å‡ºæ‰€æœ‰å¯ä»¥è¢«å®‰è£…çš„è½¯ä»¶brew cask search php #æŸ¥æ‰¾æ‰€æœ‰å’Œphpç›¸å…³çš„åº”ç”¨brew cask list #åˆ—å‡ºæ‰€æœ‰é€šè¿‡caskå®‰è£…çš„è½¯ä»¶brew cask info phpstorm #æŸ¥çœ‹ phpstorm çš„ä¿¡æ¯brew cask uninstall qq #å¸è½½ QQ brew cask install sublime-text è¿™é‡Œè°ˆè°ˆcaskå¯¹æ¯”Mac App Storeçš„ä¼˜åŠ¿ï¼š å¯¹å¸¸ç”¨è½¯ä»¶æ”¯æŒæ›´å…¨é¢ï¼ˆç‰¹åˆ«æ˜¯å¼€å‘è€…ï¼‰ï¼Œcaské‡Œé¢ä¼šç»™ä½ ä¸€äº›æƒŠå–œï¼› è½¯ä»¶æ›´æ–°é€Ÿåº¦å¿«ï¼Œä¸€èˆ¬éƒ½æ˜¯æœ€æ–°ç‰ˆæœ¬ Storeä¸Šå¾ˆä¹…å¾ˆä¹…æ‰ä¼šæ›´æ–°ç‰ˆæœ¬ï¼› å‘½ä»¤å®‰è£…æ„Ÿè§‰æ¯”æ‰“å¼€Storeæ–¹ä¾¿ï¼Œå¦å¤–Storeåœ¨å›½å†…çš„é€Ÿåº¦ä¹Ÿæ˜¯XXOOã€‚ homebrew-cask ä½ å¯ä»¥å…ˆä¸å®‰è£… 4. iterm2 https://www.iterm2.com/ 5. SimpleHTTPServerA computer python -m http.server B computer wget http://192.168.xx.xx:8000/your-filename nc ç‘å£«å†›åˆ€ï¼Œä¹Ÿå¯ä»¥ä¸¤å°ç”µè„‘ä¼ è¾“æ–‡ä»¶","categories":[{"name":"devops","slug":"devops","permalink":"http://iequa.com/categories/devops/"}],"tags":[{"name":"mac","slug":"mac","permalink":"http://iequa.com/tags/mac/"}]},{"title":"Recommendation System - CF","slug":"ml/recommendation-six-mouth-CF","date":"2017-02-28T02:28:21.000Z","updated":"2019-10-20T04:30:35.037Z","comments":true,"path":"2017/02/28/ml/recommendation-six-mouth-CF/","link":"","permalink":"http://iequa.com/2017/02/28/ml/recommendation-six-mouth-CF/","excerpt":"recommendation system and application","text":"recommendation system and application æ¨èç®—æ³• åŸºäºå†…å®¹çš„æ¨è ååŒè¿‡æ»¤ CF çŸ©é˜µåˆ†è§£ ä¸ éšè¯­ä¹‰æ¨¡å‹ 1. æ¨èç³»ç»Ÿ What?1.1 æ•°å­¦å®šä¹‰ è®¾ C ä¸ºå…¨ä½“ç”¨æˆ·é›†åˆ è®¾ S ä¸ºå…¨éƒ¨å•†å“/æ¨èå†…å®¹é›†åˆ è®¾ u æ˜¯è¯„åˆ¤æŠŠ $s_i$ æ¨è $c_i$ çš„å¥½åè¯„åˆ¤å‡½æ•° æ¨èæ˜¯å¯¹äº $câˆˆC$ ,æ‰¾åˆ° $sâˆˆS$ ,ä½¿å¾— $u$ æœ€å¤§ 1.2 äººè¯ç‰ˆæœ¬æ ¹æ®ç”¨æˆ·çš„ : å†å²è¡Œä¸º ç¤¾äº¤å…³ç³» å…´è¶£ç‚¹ ä¸Šä¸‹æ–‡ç¯å¢ƒ â€¦ å»åˆ¤æ–­ç”¨æˆ·çš„å½“å‰éœ€æ±‚ / æ„Ÿå…´è¶£çš„ Item 2. æ¨èç³»ç»Ÿ Why?Infomation Overloadç”¨æˆ·éœ€æ±‚ä¸æ˜ç¡® 2.1 å¯¹ç”¨æˆ· æ‰¾åˆ°å¥½ç©çš„ä¸œè¥¿ å‘ç°æ–°é²œäº‹ç‰© Surprise 2.2 å¯¹å•†å®¶ ä¸ªæ€§åŒ–æœåŠ¡ã€æé«˜ç²˜æ€§ å¢åŠ è¥æ”¶ 3. è¯„å®šæ ‡å‡† å‡†ç¡®åº¦ è¦†ç›–åº¦ å¤šæ ·æ€§ è¯„ä¼°æ ‡å‡† 3.1 å‡†ç¡®åº¦ Top Nè®¾ $R(u)$ ä¸ºæ ¹æ®è®­ç»ƒå»ºç«‹çš„æ¨¡å‹åœ¨æµ‹è¯•é›†ä¸Šçš„æ¨è, $T(u)$ ä¸ºæµ‹è¯•é›†ä¸Šç”¨æˆ·çš„é€‰æ‹©ã€‚ Precision = \\frac{\\sum\\_{uâˆˆU} | R(u) \\bigcap T(u) | }{\\sum\\_{uâˆˆU} R(u)} Recall = \\frac{\\sum\\_{uâˆˆU} | R(u) \\bigcap T(u) | }{\\sum\\_{uâˆˆU} T(u)} Recall è¯´æ˜ : ç”¨æˆ·çœ‹çš„ 80 ç¯‡æ–°é—»ï¼Œä½ åˆ°åº•ç»™æˆ‘ æ¨ å‡ºæ¥å¤šå°‘ç¯‡ 3.2 è¦†ç›–ç‡è¡¨ç¤ºå¯¹ç‰©å“é•¿å°¾çš„å‘æ˜èƒ½åŠ› (æ¨èç³»ç»Ÿå¸Œæœ›æ¶ˆé™¤é©¬å¤ªæ•ˆåº”) Coverage = \\frac{|U_{uâˆˆU} R(u)|}{|I|} è¦†ç›–ç‡æ˜¯å¯¹å¹³å°æ‰€æœ‰ç‰©å“æ‰€è¨€ï¼Œæ·˜å®æ¨èç­‰ä¼šå…³åˆ‡è¿™ä¸ªæŒ‡æ ‡ã€‚ éå¸¸ç‹¬ç‰¹çš„å•†å“å’Œæ–°é—», è¢«çœ‹åˆ°çš„é‡, æ˜¯ä¸€æ¡ä¸‹æ»‘æ›²çº¿ å¸Œæœ›ä¸ªæ€§åŒ–æ¨èï¼ŒæŠŠå°ä¼—çš„å•†å“ ä¹Ÿæ¨èå±•ç¤ºå‡ºæ¥ 3.3 å¤šæ ·æ€§è¡¨ç¤ºæ¨èåˆ—è¡¨ä¸­ç‰©å“ä¸¤ä¸¤ä¹‹é—´çš„ä¸ç›¸ä¼¼æ€§. Diversity(R(u)) = 1 - \\frac {\\sum\\_{i, j \\in R(u), {i \\neq j}, {s(i, j)} }} {\\frac {1}{2} |R(u)|(|R(u) - 1|)} Diversity = \\frac {1} {|U|} {\\sum\\_{u \\in U} {Diversity(R(u))}} å…¨æ˜¯ç‰›ä»”è£¤çš„è¯ï¼Œç”¨æˆ·å®¡ç¾ç–²åŠ³, tag(çº¯æ£‰ 0ï¼Œåœ†é¢† 1) è¿è¡£è£™, è®¡ç®— vector è·ç¦»ã€‚å“ç±»ä¸åŒï¼Œç›¸ä¼¼åº¦è®¾ä¸º 0. 3.4 è¯„ä¼°æ ‡å‡† æ–°é¢–åº¦ : ç»™ç”¨æˆ· Surprise æƒŠå–œåº¦ : æ¨èå’Œç”¨æˆ·å†å²å…´è¶£ä¸ç›¸ä¼¼ï¼Œå´æ»¡æ„çš„ ä¿¡ä»»åº¦ : æä¾›å¯é çš„æ¨èç†ç”± å®æ—¶æ€§ : å®æ—¶æ›´æ–°ç¨‹åº¦ (context, session â€¦) â€¦ 4. ç›¸ä¼¼åº¦/è·ç¦»å®šä¹‰ æ¬§æ°è·ç¦» Jaccard ç›¸ä¼¼åº¦ ä½™å¼¦ç›¸ä¼¼åº¦ Pearson ç›¸ä¼¼åº¦ 4.1 æ¬§æ°è·ç¦» dist(X, Y) = \\left( \\sum\\_{i=1}^n {| x\\_i - y\\_i|}^p \\right)^{\\frac {1}{p}}4.2 Jaccard ç›¸ä¼¼åº¦ J(A, B) = \\frac {|A \\bigcap B|}{|A \\bigcup B|} é€‚ç”¨äº top N æ¨èï¼Œè¦ä¹ˆ çœ‹ï¼Œè¦ä¹ˆ æ²¡çœ‹ 4.3 ä½™å¼¦ç›¸ä¼¼åº¦ \\cos(\\theta) = \\frac {a^Tb}{|a| \\cdot |b|}4.4 Pearson ç›¸ä¼¼åº¦ \\frac { \\sum\\_{i=1}^n (X\\_i - {\\mu}\\_x) (Y\\_i - {\\mu}\\_y)} {\\sqrt{ \\sum\\_{i=1}^n (X\\_i - {\\mu}\\_x)^2} \\sqrt{ \\sum\\_{i=1}^n (Y\\_i - {\\mu}\\_y)^2}} (5, 6, 9)(1, 2, 6) 5. æ¨èç®—æ³• åŸºäºå†…å®¹çš„æ¨è ååŒè¿‡æ»¤CF éšè¯­ä¹‰æ¨¡å‹ 5.1 åŸºäºå†…å®¹æ¨è åŸºäºç”¨æˆ·å–œæ¬¢çš„ Item çš„å±æ€§ / å†…å®¹è¿›è¡ŒæŒ–æ˜ åŸºäºåˆ†æå†…å®¹ï¼Œæ— éœ€è€ƒè™‘å½“å‰userä¸å…¶ä»–userçš„è¡Œä¸ºçš„äº¤äº’å…³è”ç­‰ é€šå¸¸ä½¿ç”¨åœ¨ æ–‡æœ¬ç›¸å…³ çš„äº§å“ä¸Šè¿›è¡Œæ¨è Item é€šè¿‡å†…å®¹ (æ¯”å¦‚ å…³é”®è¯) å…³è” åœ¨æ¨èç”µå½±ä¸­ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ï¼Œä½†æ˜¯æ•ˆæœä¸è§å¾—å¥½. ä½ éœ€è¦æ‰‹åŠ¨å¯¹ Item è¿›è¡Œç¦»çº¿æŒ–æ˜ï¼Œæ‹¿å‡º tag ç”µå½±é¢˜æ : çˆ±æƒ… / æ¢é™© / åŠ¨ä½œ / å–œå‰§æ ‡å¿—ç‰¹å¾ : é»„æ™“æ˜ / ç‹å®å¼ºå¹´ä»£ : 1995, 2016 â€¦å…³é”®è¯ ä¸¤ä¸ªItemæ ¹æ® tag çš„åˆ†å€¼ï¼Œè¿›è¡Œæ±‚ è·ç¦». ä¸¾ä¾‹æ–‡æœ¬æŒ–æ˜ : One : å¯¹äºæ¯ä¸ªè¦æ¨èçš„å†…å®¹,æˆ‘ä»¬éœ€è¦å»ºç«‹ä¸€ä»½èµ„æ–™ : æ¯”å¦‚è¯ $k_i$ åœ¨æ–‡æ¡£ $d_j$ ä¸­çš„æƒé‡ $w_{ij}$ (å¸¸ç”¨çš„æ–¹æ³•æ¯”å¦‚ TF-IDF) æœ‰ä¸€ä¸ªè¯è¡¨ Item [$w_1$, $w_2$, â€¦ ,$w_{4000}$], å¯¹æ¯ä¸ª document å»ºç«‹ä¸€ä¸ªè¯è¡¨ vectorã€‚ Two : éœ€è¦å¯¹ç”¨æˆ·ä¹Ÿå»ºç«‹ä¸€ä»½èµ„æ–™ : æ¯”å¦‚è¯´å®šä¹‰ä¸€ä¸ªæƒé‡å‘é‡ ($w_{c1},â€¦,w_{ck}$) , å…¶ä¸­ $w_{ci}$ è¡¨ç¤ºç¬¬ $k_i$ ä¸ªè¯å¯¹ç”¨æˆ· $c$ çš„é‡è¦åº¦user ä¹‹å‰æœ‰çœ‹è¿‡çš„ å°è¯´ æˆ– æ–‡æ¡£ã€‚(çœ‹è¿‡çš„æ–‡æ¡£æ”¾åœ¨ä¸€èµ·æä¸€ä¸ªdoc_vectorï¼Œæˆ–è€… å°† doc_vector åŠ æƒå¹³å‡) Three : è®¡ç®—åŒ¹é…åº¦ ä½™å¼¦è·ç¦»å…¬å¼ u(c, s) = \\cos(\\vec{w\\_c}, \\vec{w\\_s}) = \\frac{\\vec{w_c} \\cdot \\vec{w\\_s}}{\\vec{||w\\_c||} \\times \\vec{||w\\_s||}} æ€»ç»“ä¸‰æ­¥ : å¯¹ æ¯ä¸ª document å»ºç«‹ vector å¯¹ æ¯ä¸ª user å»ºç«‹ vector æ¯”å¯¹ user å‘é‡ï¼Œä¸ è¯¥user æ²¡æœ‰çœ‹è¿‡çš„ document å‘é‡ ä¹‹é—´çš„ç›¸ä¼¼åº¦ TF-IDF : è¯„ä¼°ä¸€ä¸ª word å¯¹å½“å‰ document çš„é‡è¦æ€§ã€‚ å½“å‰å‡é«˜è€Œå‡é«˜ï¼Œæ‰€æœ‰docä¸­ï¼Œå‡é«˜è€Œä¸‹é™ã€‚ Sample Example : åŸºäºä¹¦åè¿›è¡Œä¹¦æ¨è ä¸€ä¸ªç”¨æˆ·å¯¹ã€ŠBuilding data mining applications for CRMã€‹æ„Ÿå…´è¶£ï¼Œä»ä»¥ä¸‹ä¹¦ä¸­è¿›è¡Œæ¨è : Building data mining applications for CRM Accelerating Customer Relationships: Using CRM and Relationship Technologies Mastering Data Mining: The Art and Science of Customer Relationship Management Data Mining Your Website Introduction to marketing Consumer behavior marketing research, a handbook Customer knowledge manag TF-IDF Normed Vectors å€¼ (0.187ã€0.316) ä»£è¡¨ Data å¯¹äºå½“å‰ æ ‡é¢˜ çš„é‡è¦ç¨‹åº¦. æ ¹æ® TF-IDFï¼Œå½“å‰ä¹¦å ä¸ å›¾ä¹¦é¦†æ‰€æœ‰ä¹¦å å‡ºç°çš„æ¬¡æ•°, (å»æ‰åœç”¨è¯, å¦‚ and) è®¡ç®—å‡ºæ¥çš„æƒé‡ã€‚ æ‰€ä»¥ ã€ŠBuilding data mining applications for CRMã€‹ å·²ç»æœ‰ä¸€ä¸ªåˆ— vectorï¼Œ ä¸ å…¶ä»–æ‰€æœ‰ ä¹¦ è®¡ç®— ç›¸ä¼¼åº¦ï¼Œç›¸ä¼¼åº¦ é«˜çš„ï¼Œä¸ºæ¨èæœ€å¥½çš„ã€‚ This is only a sample show exampleï¼Œ not the real method of thing. è®¡ç®—è¿™æœ¬ä¹¦å’Œå…¶ä½™7æœ¬ä¹¦çš„ç›¸ä¼¼åº¦ï¼Œæ¨èæœ€è¿‘çš„ï¼Œè¿™é‡Œç»“æœä¸º : rank 1 : Data Mining Your Websiteô°…rank 2 : Accelerating Custom Relationships: Using CRM â€¦rank 3 : Mastering Data Mining: The Art and Scienceâ€¦ ô°¬ô°­ô°®ô°€ô°â€¦ ç»“è®º : åŸºäºå†…å®¹çš„æ¨èï¼Œæ— éœ€ç”¨æˆ·è¡Œä¸ºçš„äº¤äº’å…³è”ã€‚ 5.2 ååŒè¿‡æ»¤ (User-based)æ‰¾åˆ°å’Œ User æœ€è¿‘çš„ å…¶ä»– Userô°¼ô°½ô°Ÿô°²ô°³ô°§ô°¨ô°’ô° ô°¾ô°²ô°³ ô±…ô°²ô°³ô±†ô±€ô±ô±‚ô°•, æ‰¾åˆ°ä»–ä»¬ çœ‹/ä¹°è¿‡ä½†å½“å‰ User æ²¡çœ‹/ä¹°è¿‡çš„ itemï¼Œæ ¹æ®è·ç¦»åŠ æƒæ‰“åˆ†æ‰¾å¾—åˆ†æœ€é«˜çš„æ¨è ä¸éœ€è¦æå‰æŒ–æ˜ Itemï¼Œ æ‰¾å“å‘³æ¥è¿‘çš„ 5 ä¸ª friendsã€‚ è¿‘é‚»æ€ä¹ˆæ‰¾ ? U a b c d e A 5 1 5 3 2 B 4 3 1 1 5.3 ååŒè¿‡æ»¤ (Item-based) æ®ç°æœ‰ User å¯¹ Item çš„è¯„çº§æƒ…å†µï¼Œæ¥è®¡ç®— Item ä¹‹é—´çš„æŸç§ç›¸ä¼¼åº¦ã€‚å·²æœ‰Item ç›¸ä¼¼çš„ Item è¢«ç”¨æ¥ç”Ÿæˆä¸€ä¸ªç»¼åˆå¾—åˆ†ï¼Œè€Œè¯¥å¾—åˆ†ç”¨äºè¯„ä¼°æœªçŸ¥ç‰©å“çš„ç›¸ä¼¼åº¦ã€‚ æ ¹æ® User å¯¹ Item çš„è¡Œä¸ºï¼Œè®¡ç®— item å’Œ item ç›¸ä¼¼åº¦ï¼Œæ‰¾åˆ°å’Œå½“å‰ item æœ€è¿‘çš„è¿›è¡Œæ¨èã€‚ Collaborative filtering åŸºäº è¿‘é‚» çš„æ€æƒ³ CF (Item-based) Summary : ä¸€ä¸ª User List ($u_i$, i = 1, â€¦, n), ä¸€ä¸ª Item List ($p_j$, j = 1, â€¦, m) ä¸€ä¸ª $n * m$ çŸ©é˜µ W, æ¯ä¸ªå…ƒç´  $W_{ij}$, è¡¨ç¤º ${User}_i$ å¯¹ ${Item}_j$ çš„æ‰“åˆ† è®¡ç®— item å’Œ item ä¹‹é—´çš„ç›¸ä¼¼åº¦ S(i, j) = \\cos(\\vec{i}, \\vec{j}) = \\frac{\\vec{i} \\cdot \\vec{j}}{\\vec{||i||} \\times \\vec{||j||}} é€‰å– Top K æ¨è æˆ– åŠ æƒé¢„æµ‹å¾—åˆ† r\\_{xi} = \\frac { {\\sum\\_{j \\in N (i;x)} S\\_{ij} \\times r\\_{xj}}} { {\\sum\\_{j \\in N (i;x)} S\\_{ij}}}Item-based Collaborative Filtering 1 ä¸ 4 ä¹‹é—´çš„ç›¸ä¼¼åº¦-0.10ä¸å¯¹ï¼Œ åº”è¯¥æ˜¯ -0.83 ç­‰ï¼Œæ•°æ®æœ‰è¯¯ã€‚(æŒ‰ç…§ Pearson overlap è®¡ç®—). $r_{1.5}$ = (0.41*2 + 0.59*3) / (0.41 + 0.59) = 2.6 åŸºäº Top N æ¥è®¡ç®—ï¼Œè¿™é‡Œæ˜¯ Top 2. User CF vs Item CF å±æ€§ UserCF ItemCF æ€§èƒ½ Userå¤šï¼Œè®¡ç®—Userç›¸ä¼¼åº¦çŸ©é˜µä»£ä»·å¾ˆå¤§ Itemå¤šï¼Œè®¡ç®—Itemç›¸ä¼¼åº¦çŸ©é˜µä»£ä»·å¾ˆå¤§ é¢†åŸŸ User ä¸ªæ€§åŒ–å…´è¶£ä¸å¤ªæ˜æ˜¾çš„é¢†åŸŸ é•¿å°¾ç‰©å“ä¸°å¯Œï¼Œç”¨æˆ·ä¸ªæ€§åŒ–éœ€æ±‚å¼ºçƒˆçš„é¢†åŸŸ å®æ—¶æ€§ ç”¨æˆ·æœ‰æ–°è¡Œä¸ºï¼Œä¸ä¸€å®šæ¨èç»“æœé©¬ä¸Šå˜åŒ– ç”¨æˆ·æœ‰æ–°è¡Œä¸ºï¼Œä¼šå¯¼è‡´æ¨èç»“æœå®æ—¶å˜åŒ– å†·å¯åŠ¨ æ–°ç”¨æˆ·è¡Œä¸ºï¼Œä¸èƒ½ç«‹å³è¿›è¡Œä¸ªæ€§åŒ–æ¨è(ç”¨æˆ·ç›¸ä¼¼åº¦æ˜¯æ¯éš”ä¸€æ®µæ—¶é—´ç¦»çº¿è®¡ç®—çš„) æ–°ç”¨æˆ·å¯¹ç‰©å“æœ‰è¡Œä¸ºï¼Œå°±å¯ä»¥ç»™ä»–æ¨èå’Œè¯¥ç‰©å“ç›¸å…³ç‰©å“ æ¨èç†ç”± å¾ˆéš¾æä¾›ä»¤ç”¨æˆ·ä¿¡æœçš„æ¨èè§£é‡Š åˆ©ç”¨ç”¨æˆ·çš„å†å²è¡Œä¸ºç»™ç”¨æˆ·åšæ¨èè§£é‡Š CF ä¼˜ç¼ºç‚¹ ä¼˜ç‚¹ ç¼ºç‚¹ åŸºäºç”¨æˆ·è¡Œä¸ºï¼Œå› æ­¤å¯¹æ¨èå†…å®¹æ— éœ€å…ˆéªŒçŸ¥è¯† éœ€è¦å¤§é‡çš„æ˜¾æ€§ / éšæ€§ç”¨æˆ·è¡Œä¸º (å†·å¯åŠ¨) åªéœ€è¦ç”¨æˆ·å’Œå•†å“å…³è”çŸ©é˜µå³å¯ï¼Œç»“æ„ç®€å• éœ€è¦å®Œå…¨ç›¸åŒçš„å•†å“å…³è”ï¼Œç›¸ä¼¼çš„ä¸åŒ åœ¨ç”¨æˆ·è¡Œä¸ºä¸°å¯Œçš„æƒ…å†µä¸‹ï¼Œæ•ˆæœå¥½ (a, c) (b, c) é€šè¿‡ä¼ é€’å…³ç³»ï¼Œå¯ä»¥è¿‘ä¼¼çš„è®¡ç®—å‡ºæ¥ (a, b) ç›¸ä¼¼åº¦ï¼ŒçŸ©é˜µç¨€ç–çš„äºŒåº¦å…³è”ã€‚ 6. å†·å¯åŠ¨é—®é¢˜6.1 New User æ¨è éå¸¸ çƒ­é—¨ çš„å•†å“ï¼Œæ”¶é›†ä¸€äº›ä¿¡æ¯ ç”¨æˆ·æ³¨å†Œçš„æ—¶å€™ï¼Œæ”¶é›†ä¿¡æ¯ï¼Œæˆ–è€…äº’åŠ¨æ¸¸æˆï¼Œç¡®å®šä½ å–œæ¬¢å¦ 6.2 New Item æ ¹æ®æœ¬èº«å±æ€§ï¼Œæ±‚ä¸åŸæ¥ Item ç›¸ä¼¼åº¦ Item-based CF å¯æ¨èå‡ºå»","categories":[{"name":"machine-learning","slug":"machine-learning","permalink":"http://iequa.com/categories/machine-learning/"}],"tags":[{"name":"RS","slug":"RS","permalink":"http://iequa.com/tags/RS/"}]},{"title":"Spark Machine Learning p4 - Build Recommendation System","slug":"spark/spark-machine-learning-p4-rs","date":"2016-11-23T07:28:21.000Z","updated":"2019-10-20T04:30:35.079Z","comments":true,"path":"2016/11/23/spark/spark-machine-learning-p4-rs/","link":"","permalink":"http://iequa.com/2016/11/23/spark/spark-machine-learning-p4-rs/","excerpt":"Spark build Recommendation System, æ¨èå¼•æ“è¯•å›¾å¯¹ç”¨æˆ·ä¸æŸç±»ç‰©å“ä¹‹é—´çš„è”ç³»å»ºæ¨¡","text":"Spark build Recommendation System, æ¨èå¼•æ“è¯•å›¾å¯¹ç”¨æˆ·ä¸æŸç±»ç‰©å“ä¹‹é—´çš„è”ç³»å»ºæ¨¡ æ¨èå¼•æ“çš„ç±»å‹ï¼› ç”¨ç”¨æˆ·åå¥½æ•°æ®æ¥å»ºç«‹ä¸€ä¸ªæ¨èæ¨¡å‹ï¼› ä¸ºç”¨æˆ·è¿›è¡Œæ¨èå’Œæ±‚æŒ‡å®šç‰©å“çš„ç±»ä¼¼ç‰©å“ï¼› è¯„ä¼°è¯¥æ¨¡å‹çš„é¢„æµ‹èƒ½åŠ›ã€‚ 1. æ¨èæ¨¡å‹åˆ†ç±» å†…å®¹è¿‡æ»¤ ååŒè¿‡æ»¤ çŸ©é˜µåˆ†è§£ 1.1 å†…å®¹è¿‡æ»¤ - (ç±»ä¼¼ç‰©å“)åˆ©ç”¨ç‰©å“ç›¸ä¼¼åº¦å®šä¹‰ï¼Œæ¥æ±‚å‡ºä¸è¯¥ç‰©å“ç±»ä¼¼çš„ç‰©å“ã€‚ å¯¹ç”¨æˆ·çš„æ¨èå¯ä»¥æ ¹æ®ç”¨æˆ·çš„å±æ€§æˆ–æè¿°å¾—å‡ºï¼Œä¹‹åå†é€šè¿‡ç›¸åŒçš„ç›¸ä¼¼åº¦å®šä¹‰æ¥ä¸ç‰©å“å±æ€§åšåŒ¹é…ã€‚ 1.2 ååŒè¿‡æ»¤ - (ä¼°è®¡æœªè§¦)ååŒè¿‡æ»¤æ˜¯ä¸€ç§åˆ©ç”¨å¤§é‡å·²æœ‰çš„ç”¨æˆ·åå¥½æ¥ä¼°è®¡ç”¨æˆ·å¯¹å…¶æœªæ¥è§¦è¿‡çš„ç‰©å“çš„å–œå¥½ç¨‹åº¦ã€‚å…¶å†…åœ¨æ€æƒ³æ˜¯ç›¸ä¼¼åº¦çš„å®šä¹‰ã€‚ åŸºäºç”¨æˆ· å¦‚æœä¸¤ä¸ªç”¨æˆ·è¡¨ç°å‡ºç›¸ä¼¼çš„åå¥½ï¼Œè®¤ä¸ºä»–ä»¬çš„å…´è¶£ç±»ä¼¼ã€‚è¦å¯¹ä»–ä»¬ä¸­çš„ä¸€ä¸ªç”¨æˆ·æ¨èä¸€ä¸ªæœªçŸ¥ç‰©å“ï¼Œä¾¿å¯é€‰å–è‹¥å¹²ä¸å…¶ç±»ä¼¼çš„ç”¨æˆ·å¹¶æ ¹æ®ä»–ä»¬çš„å–œå¥½è®¡ç®—å‡ºå¯¹å„ä¸ªç‰©å“çš„ç»¼åˆå¾—åˆ†ã€‚ åŸºäºç‰©å“ æ®ç°æœ‰ç”¨æˆ·å¯¹ç‰©å“çš„åå¥½æˆ–æ˜¯è¯„çº§æƒ…å†µï¼Œæ¥è®¡ç®—ç‰©å“ä¹‹é—´çš„æŸç§ç›¸ä¼¼åº¦ã€‚å·²æœ‰ç‰©å“ç›¸ä¼¼çš„ç‰©å“è¢«ç”¨æ¥ç”Ÿæˆä¸€ä¸ªç»¼åˆå¾—åˆ†ï¼Œè€Œè¯¥å¾—åˆ†ç”¨äºè¯„ä¼°æœªçŸ¥ç‰©å“çš„ç›¸ä¼¼åº¦ã€‚ åŸºäºç”¨æˆ·æˆ–ç‰©å“çš„æ–¹æ³•å¾—åˆ†å–å†³äºè‹¥å¹²ç”¨æˆ·æˆ–æ˜¯ç‰©å“ä¹‹é—´ä¾æ®ç›¸ä¼¼åº¦æ‰€æ„æˆçš„é›†åˆï¼ˆå³é‚»å±…ï¼‰ï¼Œæ•…å®ƒä»¬ä¹Ÿå¸¸è¢«ç§°ä¸ºKNNã€‚ å¯¹â€œç”¨æˆ·-ç‰©å“â€åå¥½å»ºæ¨¡ 1.3 çŸ©é˜µåˆ†è§£Sparkæ¨èæ¨¡å‹åº“ åŒ…å«åŸºäºçŸ©é˜µåˆ†è§£ï¼ˆmatrix factorizationï¼‰çš„å®ç°ï¼Œè¯¥æ¨¡å‹åœ¨ååŒè¿‡æ»¤ä¸­çš„è¡¨ç°ååˆ†å‡ºè‰²ã€‚ 1.3.1 æ˜¾å¼çŸ©é˜µåˆ†è§£æ˜¾å¼è‡ªèº«åå¥½æ•°æ® è¿™ç±»æ•°æ®åŒ…æ‹¬å¦‚ç‰©å“è¯„çº§ã€èµã€å–œæ¬¢ç­‰ç”¨æˆ·å¯¹ç‰©å“çš„è¯„ä»·ã€‚è½¬æ¢ä¸ºä»¥ç”¨æˆ·ä¸ºè¡Œã€ç‰©å“ä¸ºåˆ—çš„äºŒç»´çŸ©é˜µã€‚ å¤§éƒ¨åˆ†æƒ…å†µä¸‹å•ä¸ªç”¨æˆ·åªä¼šå’Œå°‘éƒ¨åˆ†ç‰©å“æ¥è§¦ï¼Œæ‰€ä»¥è¯¥çŸ©é˜µå¾ˆç¨€ç–ã€‚ Tom, Star Wars, 5Jane, Titanic, 4Bill, Batman, 3Jane, Star Wars, 2Bill, Titanic, 3 ç”¨æˆ·-ç‰©å“ çŸ©é˜µçš„ç»´åº¦ä¸º U Ã— I ä¸ºäº†é™ç»´ è¡¨ç¤ºç”¨æˆ·çš„ U Ã— k ç»´çŸ©é˜µ è¡¨å¾ç‰©å“çš„ I Ã— k ç»´çŸ©é˜µ è¿™ä¸¤ä¸ªçŸ©é˜µä¹Ÿç§°ä½œå› å­çŸ©é˜µ, ä¹˜ç§¯æ˜¯åŸå§‹è¯„çº§çŸ©é˜µçš„ä¸€ä¸ªè¿‘ä¼¼. åŸå§‹è¯„çº§çŸ©é˜µé€šå¸¸å¾ˆç¨€ç–ï¼Œä½†å› å­çŸ©é˜µå´æ˜¯ç¨ å¯†çš„ å› å­å¯èƒ½è¡¨ç¤ºäº†æŸäº›å«ä¹‰ï¼Œæ¯”å¦‚å¯¹ç”µå½±çš„æŸä¸ªå¯¼æ¼”ã€ç§ç±»ã€é£æ ¼æˆ–æŸäº›æ¼”å‘˜çš„åå¥½ã€‚ è¦è®¡ç®—ç»™å®šç”¨æˆ·å¯¹æŸä¸ªç‰©å“çš„é¢„è®¡è¯„çº§ = è¡Œï¼ˆç”¨æˆ·å› å­å‘é‡ï¼‰ ä¸ åˆ—ï¼ˆç‰©å“å› å­å‘é‡ï¼‰ï¼Œä¸¤è€…ç‚¹ç§¯ ç‰©å“ä¹‹é—´ç›¸ä¼¼åº¦çš„è®¡ç®—ï¼Œè½¬æ¢ä¸ºå¯¹ä¸¤ç‰©å“å› å­å‘é‡ä¹‹é—´ç›¸ä¼¼åº¦çš„è®¡ç®— ä¼˜ç‚¹ ç¼ºç‚¹ å› å­åˆ†è§£ç±»æ¨¡å‹å»ºç«‹ï¼Œæ±‚è§£å®¹æ˜“ ç‰©å“æˆ–æ˜¯ç”¨æˆ·çš„å› å­å‘é‡å¯èƒ½è¾¾åˆ°æ•°ä»¥ç™¾ä¸‡è®¡ã€‚åœ¨å­˜å‚¨å’Œè®¡ç®—èƒ½åŠ›æœ‰æŒ‘æˆ˜ã€‚ 1.3.2. éšå¼çŸ©é˜µåˆ†è§£éšå«åœ¨ç”¨æˆ·ä¸ç‰©å“çš„äº¤äº’ä¹‹ä¸­ã€‚äºŒå…ƒæ•°æ®ï¼ˆæ¯”å¦‚ç”¨æˆ·æ˜¯å¦è§‚çœ‹äº†æŸä¸ªç”µå½±æˆ–æ˜¯å¦è´­ä¹°äº†æŸä¸ªå•†å“ï¼‰å’Œè®¡æ•°æ•°æ®ï¼ˆæ¯”å¦‚ç”¨æˆ·è§‚çœ‹æŸç”µå½±çš„æ¬¡æ•°ï¼‰ä¾¿æ˜¯è¿™ç±»æ•°æ®ã€‚ MLlib å¤„ç†éšå¼æ•°æ®ï¼š ä¸€ä¸ªäºŒå…ƒåå¥½çŸ©é˜µ P ä¸€ä¸ªä¿¡å¿ƒæƒé‡çŸ©é˜µ C éšå¼æ¨¡å‹ä»ç„¶ä¼šåˆ›å»ºä¸€ä¸ªç”¨æˆ·å› å­çŸ©é˜µå’Œä¸€ä¸ªç‰©å“å› å­çŸ©é˜µã€‚ä½†æ˜¯ï¼Œæ¨¡å‹æ‰€æ±‚è§£çš„æ˜¯åå¥½çŸ©é˜µè€Œéè¯„çº§çŸ©é˜µçš„è¿‘ä¼¼ã€‚ 3. æœ€å°äºŒä¹˜æ³• æœ€å°äºŒä¹˜æ³•ï¼ˆAlternating Least Squaresï¼ŒALSï¼‰æ˜¯ä¸€ç§æ±‚è§£çŸ©é˜µåˆ†è§£é—®é¢˜çš„æœ€ä¼˜åŒ–æ–¹æ³•ã€‚ä¸”ç›¸å¯¹å®¹æ˜“å¹¶è¡ŒåŒ–ã€‚ ALSçš„å®ç°åŸç†æ˜¯è¿­ä»£å¼æ±‚è§£ä¸€ç³»åˆ—æœ€å°äºŒä¹˜å›å½’é—®é¢˜ã€‚åœ¨æ¯ä¸€æ¬¡è¿­ä»£æ—¶ï¼Œå›ºå®šç”¨æˆ·å› å­çŸ©é˜µæˆ–æ˜¯ç‰©å“å› å­çŸ©é˜µä¸­çš„ä¸€ä¸ªï¼Œç„¶åç”¨å›ºå®šçš„è¿™ä¸ªçŸ©é˜µä»¥åŠè¯„çº§æ•°æ®æ¥æ›´æ–°å¦ä¸€ä¸ªçŸ©é˜µã€‚ä¹‹åï¼Œè¢«æ›´æ–°çš„çŸ©é˜µè¢«å›ºå®šä½ï¼Œå†æ›´æ–°å¦å¤–ä¸€ä¸ªçŸ©é˜µã€‚å¦‚æ­¤è¿­ä»£ï¼Œç›´åˆ°æ¨¡å‹æ”¶æ•›ï¼ˆæˆ–æ˜¯è¿­ä»£äº†é¢„è®¾å¥½çš„æ¬¡æ•°ï¼‰ã€‚ 2. æå–æœ‰æ•ˆç‰¹å¾&gt;./bin/spark-shell â€“-driver-memory 2gval rawData = sc.textFile(&quot;/Users/hp/ghome/github/Recommendation/spark-ml/ml-100k/u.data&quot;)rawData.first()val rawRatings = rawData.map(_.split(&quot;\\t&quot;).take(3))import org.apache.spark.mllib.recommendation.ALSALS.asInstanceOf isInstanceOf main toString train trainImplicitALS.train ALSæ¨¡å‹éœ€è¦ä¸€ä¸ªç”±Ratingè®°å½•æ„æˆçš„RDDï¼Œè€ŒRatingç±»åˆ™æ˜¯å¯¹ç”¨æˆ·IDã€å½±ç‰‡IDï¼ˆè¿™é‡Œæ˜¯é€šç§°productï¼‰å’Œå®é™…æ˜Ÿçº§è¿™äº›å‚æ•°çš„å°è£…ã€‚æˆ‘ä»¬å¯ä»¥è°ƒç”¨mapæ–¹æ³•å°†åŸæ¥çš„å„IDå’Œæ˜Ÿçº§çš„æ•°ç»„è½¬æ¢ä¸ºå¯¹åº”çš„Ratingå¯¹è±¡ï¼Œä»è€Œåˆ›å»ºæ‰€éœ€çš„è¯„çº§æ•°æ®é›†ã€‚ scala&gt; import org.apache.spark.mllib.recommendation.Ratingimport org.apache.spark.mllib.recommendation.Ratingscala&gt; val ratings = rawRatings.map &#123; case Array(user, movie, rating) =&gt; | Rating(user.toInt, movie.toInt, rating.toDouble) &#125;ratings: org.apache.spark.rdd.RDD[org.apache.spark.mllib.recommendation.Rating] = MapPartitionsRDD[3] at map at &lt;console&gt;:27scala&gt; ratings.first()res3: org.apache.spark.mllib.recommendation.Rating = Rating(196,242,3.0)scala&gt; ratings.take(10)res4: Array[org.apache.spark.mllib.recommendation.Rating] = Array(Rating(196,242,3.0), Rating(186,302,3.0), Rating(22,377,1.0), Rating(244,51,2.0), Rating(166,346,1.0), Rating(298,474,4.0), Rating(115,265,2.0), Rating(253,465,5.0), Rating(305,451,3.0), Rating(6,86,3.0)) 3. è®­ç»ƒæ¨èæ¨¡å‹ä»åŸå§‹æ•°æ®æå–å‡ºè¿™äº›ç®€å•ç‰¹å¾åï¼Œä¾¿å¯è®­ç»ƒæ¨¡å‹ã€‚MLlibå·²å®ç°æ¨¡å‹è®­ç»ƒçš„ç»†èŠ‚ï¼Œè¿™ä¸éœ€è¦æˆ‘ä»¬æ‹…å¿ƒã€‚æˆ‘ä»¬åªéœ€æä¾›ä¸Šè¿°æŒ‡å®šç±»å‹çš„æ–°RDDä»¥åŠå…¶ä»–æ‰€éœ€å‚æ•°æ¥ä½œä¸ºè®­ç»ƒçš„è¾“å…¥å³å¯ã€‚ 3.1 Movie-100k train modelç°åœ¨å¼€å§‹è®­ç»ƒæ¨¡å‹äº†ï¼Œæ‰€éœ€çš„å…¶ä»–å‚æ•°æœ‰ä»¥ä¸‹å‡ ä¸ª rankï¼šå¯¹åº”ALSæ¨¡å‹ä¸­çš„å› å­ä¸ªæ•°ï¼Œä¹Ÿå°±æ˜¯åœ¨ä½é˜¶è¿‘ä¼¼çŸ©é˜µä¸­çš„éšå«ç‰¹å¾ä¸ªæ•°ã€‚å› å­ä¸ªæ•°ä¸€èˆ¬è¶Šå¤šè¶Šå¥½ã€‚ä½†å®ƒä¹Ÿä¼šç›´æ¥å½±å“æ¨¡å‹è®­ç»ƒå’Œä¿å­˜æ—¶æ‰€éœ€çš„å†…å­˜å¼€é”€ï¼Œå°¤å…¶æ˜¯åœ¨ç”¨æˆ·å’Œç‰©å“å¾ˆå¤šçš„æ—¶å€™ã€‚å› æ­¤å®è·µä¸­è¯¥å‚æ•°å¸¸ä½œä¸ºè®­ç»ƒæ•ˆæœä¸ç³»ç»Ÿå¼€é”€ä¹‹é—´çš„è°ƒèŠ‚å‚æ•°ã€‚é€šå¸¸ï¼Œå…¶åˆç†å–å€¼ä¸º10åˆ°200ã€‚ iterationsï¼šå¯¹åº”è¿è¡Œæ—¶çš„è¿­ä»£æ¬¡æ•°ã€‚ALSèƒ½ç¡®ä¿æ¯æ¬¡è¿­ä»£éƒ½èƒ½é™ä½è¯„çº§çŸ©é˜µçš„é‡å»ºè¯¯å·®ï¼Œä½†ä¸€èˆ¬ç»å°‘æ•°æ¬¡è¿­ä»£åALSæ¨¡å‹ä¾¿å·²èƒ½æ”¶æ•›ä¸ºä¸€ä¸ªæ¯”è¾ƒåˆç†çš„å¥½æ¨¡å‹ã€‚è¿™æ ·ï¼Œå¤§éƒ¨åˆ†æƒ…å†µä¸‹éƒ½æ²¡å¿…è¦è¿­ä»£å¤ªå¤šæ¬¡ï¼ˆ10æ¬¡å·¦å³ä¸€èˆ¬å°±æŒºå¥½ï¼‰ã€‚ lambdaï¼šè¯¥å‚æ•°æ§åˆ¶æ¨¡å‹çš„æ­£åˆ™åŒ–è¿‡ç¨‹ï¼Œä»è€Œæ§åˆ¶æ¨¡å‹çš„è¿‡æ‹Ÿåˆæƒ…å†µã€‚å…¶å€¼è¶Šé«˜ï¼Œæ­£åˆ™åŒ–è¶Šä¸¥å‰ã€‚è¯¥å‚æ•°çš„èµ‹å€¼ä¸å®é™…æ•°æ®çš„å¤§å°ã€ç‰¹å¾å’Œç¨€ç–ç¨‹åº¦æœ‰å…³ã€‚å’Œå…¶ä»–çš„æœºå™¨å­¦ä¹ æ¨¡å‹ä¸€æ ·ï¼Œæ­£åˆ™å‚æ•°åº”è¯¥é€šè¿‡ç”¨éæ ·æœ¬çš„æµ‹è¯•æ•°æ®è¿›è¡Œäº¤å‰éªŒè¯æ¥è°ƒæ•´ã€‚ scala&gt; val model = ALS.train(ratings, 50, 10, 0.01)model: org.apache.spark.mllib.recommendation.MatrixFactorizationModel = org.apache.spark.mllib.recommendation.MatrixFactorizationModel@2e835760scala&gt; model.userFeaturesres5: org.apache.spark.rdd.RDD[(Int, Array[Double])] = users MapPartitionsRDD[209] at mapValues at ALS.scala:255scala&gt; model.userFeatures.countres6: Long = 943 MatrixFactorizationModel å¯¹è±¡å°† ç”¨æˆ·å› å­å’Œç‰©å“å› å­åˆ†åˆ«ä¿å­˜åœ¨ä¸€ä¸ª (id,factor) å¯¹ç±»å‹çš„RDDä¸­ã€‚å®ƒä»¬åˆ†åˆ«ç§°ä½œuserFeatures å’Œ productFeaturesã€‚ 3.2 éšå¼åé¦ˆæ•°æ®è®­ç»ƒæ¨¡å‹MLlibä¸­æ ‡å‡†çš„çŸ©é˜µåˆ†è§£æ¨¡å‹ç”¨äºæ˜¾å¼è¯„çº§æ•°æ®çš„å¤„ç†ã€‚è‹¥è¦å¤„ç†éšå¼æ•°æ®ï¼Œåˆ™å¯ä½¿ç”¨trainImplicitå‡½æ•°ã€‚å…¶è°ƒç”¨æ–¹å¼å’Œæ ‡å‡†çš„trainæ¨¡å¼ç±»ä¼¼ï¼Œä½†å¤šäº†ä¸€ä¸ªå¯è®¾ç½®çš„alphaå‚æ•°ï¼ˆä¹Ÿæ˜¯ä¸€ä¸ªæ­£åˆ™åŒ–å‚æ•°ï¼Œlambdaåº”é€šè¿‡æµ‹è¯•å’Œäº¤å‰éªŒè¯æ³•æ¥è®¾ç½®ï¼‰ã€‚ alphaå‚æ•°æŒ‡å®šäº†ä¿¡å¿ƒæƒé‡æ‰€åº”è¾¾åˆ°çš„åŸºå‡†çº¿ã€‚è¯¥å€¼è¶Šé«˜åˆ™æ‰€è®­ç»ƒå‡ºçš„æ¨¡å‹è¶Šè®¤ä¸ºç”¨æˆ·ä¸ä»–æ‰€æ²¡è¯„çº§è¿‡çš„ç”µå½±ä¹‹é—´æ²¡æœ‰ç›¸å…³æ€§ã€‚ 4. ä½¿ç”¨æ¨èæ¨¡å‹é¢„æµ‹é€šå¸¸æœ‰ä¸¤ç§ï¼šä¸ºæŸä¸ªç”¨æˆ·æ¨èç‰©å“ï¼Œæˆ–æ‰¾å‡ºä¸æŸä¸ªç‰©å“ç›¸å…³æˆ–ç›¸ä¼¼çš„å…¶ä»–ç‰©å“ã€‚ 4.1 ç”¨æˆ·æ¨èé€šè¿‡æ¨¡å‹æ±‚å‡ºç”¨æˆ·å¯èƒ½å–œå¥½ç¨‹åº¦æœ€é«˜çš„å‰Kä¸ªå•†å“ã€‚ åŸºäºç”¨æˆ·çš„æ¨¡å‹ï¼Œåˆ™ä¼šåˆ©ç”¨ç›¸ä¼¼ç”¨æˆ·çš„è¯„çº§æ¥è®¡ç®—å¯¹æŸä¸ªç”¨æˆ·çš„æ¨èã€‚ åŸºäºç‰©å“çš„æ¨¡å‹ï¼Œåˆ™ä¼šä¾é ç”¨æˆ·æ¥è§¦è¿‡çš„ç‰©å“ä¸å€™é€‰ç‰©å“ä¹‹é—´çš„ç›¸ä¼¼åº¦æ¥è·å¾—æ¨èã€‚ åˆ©ç”¨çŸ©é˜µåˆ†è§£æ–¹æ³•æ—¶ï¼Œæ˜¯ç›´æ¥å¯¹è¯„çº§æ•°æ®è¿›è¡Œå»ºæ¨¡ï¼Œæ‰€ä»¥é¢„è®¡å¾—åˆ†å¯è§†ä½œç›¸åº”ç”¨æˆ·å› å­å‘é‡å’Œç‰©å“å› å­å‘é‡çš„ç‚¹ç§¯ã€‚ 1. ä»MovieLens 100kæ•°æ®é›†ç”Ÿæˆç”µå½±æ¨è MLlibçš„æ¨èæ¨¡å‹åŸºäºçŸ©é˜µåˆ†è§£ï¼Œå› æ­¤å¯ç”¨æ¨¡å‹æ‰€æ±‚å¾—çš„å› å­çŸ©é˜µæ¥è®¡ç®—ç”¨æˆ·å¯¹ç‰©å“çš„é¢„è®¡è¯„çº§ã€‚ä¸‹é¢åªé’ˆå¯¹åˆ©ç”¨MovieLensä¸­æ˜¾å¼æ•°æ®åšæ¨èçš„æƒ…å½¢ï¼Œä½¿ç”¨éšå¼æ¨¡å‹æ—¶çš„æ–¹æ³•ä¸ä¹‹ç›¸åŒã€‚ MatrixFactorizationModelç±» æä¾›äº†ä¸€ä¸ªpredictå‡½æ•°ï¼Œä»¥æ–¹ä¾¿åœ°è®¡ç®—ç»™å®šç”¨æˆ·å¯¹ç»™å®šç‰©å“çš„é¢„æœŸå¾—åˆ†ï¼š scala&gt; val predictedRating = model.predict(789, 123)16/05/04 16:13:08 WARN BLAS: Failed to load implementation from: com.github.fommil.netlib.NativeSystemBLAS16/05/04 16:13:08 WARN BLAS: Failed to load implementation from: com.github.fommil.netlib.NativeRefBLASpredictedRating: Double = 1.8390368814083764scala&gt; val predictedRating = model.predict(789, 123)predictedRating: Double = 1.8390368814083764scala&gt; val userId = 789userId: Int = 789scala&gt; val K = 10K: Int = 10scala&gt; val topKRecs = model.recommendProducts(userId, K)topKRecs: Array[org.apache.spark.mllib.recommendation.Rating] = Array(Rating(789,180,5.352418839062572), Rating(789,887,5.289455638310055), Rating(789,484,5.0301818688410025), Rating(789,475,5.011219778604191), Rating(789,150,5.003965038415291), Rating(789,663,4.991126084946501), Rating(789,56,4.974685008959871), Rating(789,48,4.965402351329832), Rating(789,9,4.963265626841469), Rating(789,127,4.963069165947614))scala&gt; println(topKRecs.mkString(&quot;\\n&quot;))Rating(789,180,5.352418839062572)Rating(789,887,5.289455638310055)Rating(789,484,5.0301818688410025)Rating(789,475,5.011219778604191)Rating(789,150,5.003965038415291)Rating(789,663,4.991126084946501)Rating(789,56,4.974685008959871)Rating(789,48,4.965402351329832)Rating(789,9,4.963265626841469)Rating(789,127,4.963069165947614)","categories":[{"name":"spark","slug":"spark","permalink":"http://iequa.com/categories/spark/"}],"tags":[{"name":"spark","slug":"spark","permalink":"http://iequa.com/tags/spark/"},{"name":"recommendation-system","slug":"recommendation-system","permalink":"http://iequa.com/tags/recommendation-system/"}]},{"title":"Travel Note Thai","slug":"tools/health-life-thai","date":"2016-10-27T11:54:16.000Z","updated":"2019-10-20T04:30:34.997Z","comments":true,"path":"2016/10/27/tools/health-life-thai/","link":"","permalink":"http://iequa.com/2016/10/27/tools/health-life-thai/","excerpt":"æèµ·æ³°ç‹å›½ï¼Œç»™æˆ‘æœ€æ·±çš„å°è±¡å°±æ˜¯å¯ä»¥è®©æˆ‘æ„Ÿå—åˆ°ï¼Œåˆ°åº•ä»€ä¹ˆæ˜¯ çœŸå–„ç¾ã€‚","text":"æèµ·æ³°ç‹å›½ï¼Œç»™æˆ‘æœ€æ·±çš„å°è±¡å°±æ˜¯å¯ä»¥è®©æˆ‘æ„Ÿå—åˆ°ï¼Œåˆ°åº•ä»€ä¹ˆæ˜¯ çœŸå–„ç¾ã€‚ çœŸæ˜¯çš„ å¹¸ç¦å›½åº¦ã€å¾®ç¬‘å›½åº¦ï¼Œåä¸è™šä¼ ã€‚åœ¨æˆ‘çœ‹æ¥ï¼Œé‚£é‡Œçš„ç™¾å§“æ˜¯å®‰å±…ä¹ä¸šï¼Œéå¸¸å¹¸ç¦ã€‚è´«å¯Œå·®è·ä¸å¤§ï¼Œèµ„æºåˆ†é…ç›¸å¯¹åˆç†ï¼Œå°åŸå¸‚å’Œå¾å³¥ã€Šæ³°å›§ã€‹æ¸…è¿ˆçš„å¤§åŸå¸‚åŸºç¡€è®¾æ–½ç›¸å·®ä¸å¤§ï¼Œæ„Ÿè§‰çœŸçš„éå¸¸ä¸é”™ã€‚æˆ‘è§‰å¾—å»ä»»ä½•ä¸€ä¸ªåœ°æ–¹äººæ–‡ç¯å¢ƒæ‰æ˜¯æœ€é‡è¦çš„ï¼Œå…¶ä»–çš„æ™¯è‰²ã€æ™¯ç‚¹æ˜¯æ¬¡è¦çš„ï¼Œå› ä¸ºæ™®é€šäººéƒ½éœ€è¦å…¥ä¸–ï¼Œéœ€è¦æ²Ÿé€šä¸äº¤æµã€‚ æˆ‘åˆ†åˆ«åœ¨ 15å¹´10æœˆ å’Œ 16å¹´9æœˆ å»æ³°å›½æ—…è¡Œï¼Œåˆ°è¿‡æ›¼è°·ã€å·´èœ€åºœã€åæ¬£ã€æ™®å‰å²› ç­‰åœ°ã€‚éå¸¸æ„Ÿè°¢åœ¨é‚£æ®µå¼‚å›½ä»–ä¹¡çš„æ—¶å…‰é‡Œæ›¾ç»™äºˆæˆ‘å¸®åŠ©çš„æœ‹å‹ã€‚ æ›¼è°·æ›¼è°·ï¼ˆæ³°æ–‡ï¼šà¸à¸£à¸¸à¸‡à¹€à¸—à¸à¸¡à¸«à¸²à¸™à¸„à¸£ï¼›è‹±æ–‡ï¼šBangkokï¼‰ï¼Œæ˜¯æ³°å›½é¦–éƒ½å’Œæœ€å¤§åŸå¸‚ï¼Œä¸œå—äºšç¬¬äºŒå¤§åŸå¸‚ï¼Œä¸ºæ³°å›½æ”¿æ²»ã€ç»æµã€è´¸æ˜“ã€äº¤é€šã€æ–‡åŒ–ã€ç§‘æŠ€ã€æ•™è‚²ã€å®—æ•™ä¸å„æ–¹é¢ä¸­å¿ƒã€‚ èŠ­å ¤é›…èŠ­æé›…(Pattaya,åˆå¸¸è¢«è¯‘ä¸ºâ€œèŠ­å ¤é›…â€)ï¼Œæ˜¯ä¸­å—åŠå²›å—ç«¯çš„æ³°å›½ä¸€å¤„è‘—åæµ·æ™¯åº¦å‡èƒœåœ°ã€‚è·ç¦»æ›¼è°·ä¸œå—æ–¹154å…¬é‡Œã€‚ èŠ­æé›…è¿‘å¹´æ¥çƒ­åº¦æé«˜çš„æµ·æ»©åº¦å‡ã€æ—…æ¸¸ã€å…»è€åœ£åœ°ï¼Œäº«æœ‰â€œä¸œæ–¹å¤å¨å¤·â€ä¹‹èª‰ï¼ŒèŠ­æé›…å…·æœ‰æœ€è´Ÿç››åçš„äººå¦–è¡¨æ¼”ï¼Œç¼¤çº·æ— ä¼‘çš„å¤œæ–‡åŒ–ï¼Œå¸å¼•ç€å…¨ä¸–ç•Œçš„æ¸¸å®¢ã€‚ æ®è¯´2018å¹´è½»è½¨ä¿®å»ºå®Œæˆï¼Œä»æ›¼è°·åˆ°èŠ­å ¤é›…åªéœ€è¦20å¤šåˆ†é’Ÿã€‚ åæ¬£åæ¬£ï¼ˆè‹±è¯­ï¼šHua Hinï¼Œæ³°è¯­ï¼šà¸«à¸±à¸§à¸«à¸´à¸™ï¼‰ï¼Œæ³°å›½ä¸­éƒ¨æµ·æ»¨å°é•‡ã€‚è·ç¦»æ³°å›½é¦–éƒ½æ›¼è°·200å¤šå…¬é‡Œï¼ˆåŒ—çº¬12Â°34â€²ï¼Œä¸œç»99Â°57â€²ï¼‰ï¼Œéš¶å±äºæ³°å›½å·´èœ€åºœã€‚ä¸èŠ­å ¤é›…éš”å²¸ç›¸æœ›ï¼Œè·ç¦»æ›¼è°·è¥¿å—281å…¬é‡Œï¼Œçº¦3å°æ—¶è¡Œç¨‹ã€‚å®ƒè¢«ç§°ä½œæ˜¯æ³°å›½æœ€ä¼ ç»Ÿçš„æµ·æ»¨èƒœåœ°ï¼Œçš‡å®¤è´µæ—ä»¬æ¯å¹´éƒ½ä¼šåˆ°åæ¬£ä½ä¸€æ®µæ—¶é—´ï¼Œå½“ä»Šæ³°çš‡å°±é•¿æœŸå±…ä½äºæ­¤åœ°çš„è¡Œå®«ã€‚ æ™®å‰å²›æµ·æ»©æ—¥å…‰æµ´ äº«æ…µæ‡’æ…¢æ—¶å…‰æ¸¸æµ·å²› æ½œå…¥å¤§æµ·çš„å¿ƒé‡Œå»æ³›èˆŸæ³°å›½â€œå°æ¡‚æ—â€æ”€ç‰™æ¹¾","categories":[{"name":"tools","slug":"tools","permalink":"http://iequa.com/categories/tools/"}],"tags":[{"name":"MyTrip","slug":"MyTrip","permalink":"http://iequa.com/tags/MyTrip/"}]},{"title":"Coursera Week 3 - Logistic Regression","slug":"ml/coursera-ng-w3-LR","date":"2016-10-24T02:28:21.000Z","updated":"2019-10-20T04:30:35.045Z","comments":true,"path":"2016/10/24/ml/coursera-ng-w3-LR/","link":"","permalink":"http://iequa.com/2016/10/24/ml/coursera-ng-w3-LR/","excerpt":"Logistic Regression","text":"Logistic Regression 1. Classification Email: Spam / Not Spam Online Transactions: Fraudulent (Yes/No)? Tumor: Malignant / Benign ? &emsp;&emsp;&emsp; [â€˜tju:mÉ™(r)] [mÉ™â€™lÉªgnÉ™nt] / [bÉªâ€™naÉªn] $ y \\in {0, 1}$ 2. Binary ClassificationInstead of our output vector y being a continuous range of values, it will only be 0 or 1. yâˆˆ{0,1} Where 0 is usually taken as the â€œnegative classâ€ and 1 as the â€œpositive classâ€, but you are free to assign any representation to it. Hypothesis Representation 0 \\leq h\\_\\theta (x) \\leq 1\\begin{align} & h\\_\\theta (x) = g ( \\theta^T x ) \\newline \\newline& z = \\theta^T x \\newline& g(z) = \\dfrac{1}{1 + e^{-z}} \\end{align}â€œSigmoid Function,â€ also called the â€œLogistic Functionâ€: $h_Î¸$ will give us the probability that our output is 1. For example, $h_Î¸=0.7$ gives us the probability of 70% that our output is 1. $\\begin{align}&amp; h_\\theta(x) = P(y=1 | x ; \\theta) = 1 - P(y=0 | x ; \\theta) \\newline&amp; P(y = 0 | x;\\theta) + P(y = 1 | x ; \\theta) = 1\\end{align}$ Our probability that our prediction is 0 is just the complement of our probability that it is 1 (e.g. if probability that it is 1 is 70%, then the probability that it is 0 is 30%). 3. Decision Boundary \\begin{align} & h\\_\\theta(x) \\geq 0.5 \\rightarrow y = 1 \\newline& h\\_\\theta(x) < 0.5 \\rightarrow y = 0 \\newline\\end{align} Logistic Function $ \\begin{align} &amp; g(z) \\geq 0.5 \\newline&amp; when \\; z \\geq 0 \\end{align} $ $ \\begin{align} z=0, e^{0}=1 \\Rightarrow g(z)=1/2\\newline z \\to \\infty, e^{-\\infty} \\to 0 \\Rightarrow g(z)=1 \\newline z \\to -\\infty, e^{\\infty}\\to \\infty \\Rightarrow g(z)=0 \\end{align} $ g is $\\theta^T X$, then that means: $ h_\\theta(x) = g(\\theta^T x) \\geq 0.5 $ $ when \\; \\theta^T x \\geq 0 $ $ \\begin{align} &amp; \\theta^T x \\geq 0 \\Rightarrow y = 1 \\newline&amp; \\theta^T x &lt; 0 \\Rightarrow y = 0 \\newline \\end{align} $ The decision boundary is the line that separates the area where y = 0 and where y = 1. It is created by our hypothesis function. Example: $\\begin{align}&amp; \\theta = \\begin{bmatrix}5 \\newline -1 \\newline 0\\end{bmatrix} \\newline &amp; y = 1 \\; if \\; 5 + (-1) x_1 + 0 x_2 \\geq 0 \\newline &amp; 5 - x_1 \\geq 0 \\newline &amp; - x_1 \\geq -5 \\newline&amp; x_1 \\leq 5 \\newline \\end{align}$ In this case, our decision boundary is a straight vertical line placed on the graph where $x_1=5$, and everything to the left of that denotes $y = 1$, while everything to the right denotes $y = 0$. linear decision boundaries Non-linear decision boundaries 4. Cost FunctionWe cannot use the same cost function that we use for linear regression because the Logistic Function will cause the output to be wavy, causing many local optima. In other words, it will not be a convex function. Instead, our cost function for logistic regression looks like: $\\begin{align}&amp; J(\\theta) = \\dfrac{1}{m} \\sum_{i=1}^m \\mathrm{Cost}(h_\\theta(x^{(i)}),y^{(i)}) \\newline &amp; \\mathrm{Cost}(h_\\theta(x),y) = -\\log(h_\\theta(x)) \\; &amp; \\text{if y = 1} \\newline &amp; \\mathrm{Cost}(h_\\theta(x),y) = -\\log(1-h_\\theta(x)) \\; &amp; \\text{if y = 0}\\end{align}$ $\\begin{align}&amp; \\mathrm{Cost}(h_\\theta(x),y) = 0 \\text{ if } h_\\theta(x) = y \\newline &amp; \\mathrm{Cost}(h_\\theta(x),y) \\rightarrow \\infty \\text{ if } y = 0 \\; \\mathrm{and} \\; h_\\theta(x) \\rightarrow 1 \\newline &amp; \\mathrm{Cost}(h_\\theta(x),y) \\rightarrow \\infty \\text{ if } y = 1 \\; \\mathrm{and} \\; h_\\theta(x) \\rightarrow 0 \\newline\\end{align}$ If our correct answer â€˜yâ€™ is 0, then the cost function will be 0 if our hypothesis function also outputs 0. If our hypothesis approaches 1, then the cost function will approach infinity. If our correct answer â€˜yâ€™ is 1, then the cost function will be 0 if our hypothesis function outputs 1. If our hypothesis approaches 0, then the cost function will approach infinity. 5. Cost Function &amp; Gradient DescWe can compress our cost function&#39;s two conditional cases into one case: $ \\mathrm{Cost}(h_\\theta(x),y) = - y \\cdot \\log(h_\\theta(x)) - (1 - y) \\cdot \\log(1 - h_\\theta(x))$ We can fully write out our entire cost function as follows: $J(\\theta) = - \\frac{1}{m} \\displaystyle \\sum_{i=1}^m [y^{(i)}\\log (h_\\theta (x^{(i)})) + (1 - y^{(i)})\\log (1 - h_\\theta(x^{(i)}))]$ A vectorized implementation is: $\\begin{align}&amp; h = g(X\\theta)\\newline&amp; J(\\theta) = \\frac{1}{m} \\cdot \\left(-y^{T}\\log(h)-(1-y)^{T}\\log(1-h)\\right)\\end{align}$ 5.1 Gradient DescentRemember that the general form of gradient descent is: $\\begin{align}&amp; Repeat \\; \\lbrace \\newline &amp; \\; \\theta_j := \\theta_j - \\alpha \\dfrac{\\partial}{\\partial \\theta_j}J(\\theta) \\newline &amp; \\rbrace\\end{align}$ We can work out the derivative part using calculus to get: $\\begin{align}&amp; Repeat \\; \\lbrace \\newline&amp; \\; \\theta_j := \\theta_j - \\frac{\\alpha}{m} \\sum_{i=1}^m (h_\\theta(x^{(i)}) - y^{(i)}) x_j^{(i)} \\newline &amp; \\rbrace\\end{align}$ seen 5.2 detailed A vectorized implementation is: $\\theta := \\theta - \\frac{\\alpha}{m} X^{T} (g(X \\theta ) - \\vec{y})$ 5.2 Partial derivative of J(Î¸) partial [â€˜pÉ‘ËÊƒ(É™)l]derivative [dÉªâ€™rÉªvÉ™tÉªv] $\\begin{align}\\sigma(x)â€™&amp;=\\left(\\frac{1}{1+e^{-x}}\\right)â€™=\\frac{-(1+e^{-x})â€™}{(1+e^{-x})^2}=\\frac{-1â€™-(e^{-x})â€™}{(1+e^{-x})^2}=\\frac{0-(-x)â€™(e^{-x})}{(1+e^{-x})^2}=\\frac{-(-1)(e^{-x})}{(1+e^{-x})^2}=\\frac{e^{-x}}{(1+e^{-x})^2} \\newline &amp;=\\left(\\frac{1}{1+e^{-x}}\\right)\\left(\\frac{e^{-x}}{1+e^{-x}}\\right)=\\sigma(x)\\left(\\frac{+1-1 + e^{-x}}{1+e^{-x}}\\right)=\\sigma(x)\\left(\\frac{1 + e^{-x}}{1+e^{-x}} - \\frac{1}{1+e^{-x}}\\right)=\\sigma(x)(1 - \\sigma(x))\\end{align}$ Now we are ready to find out resulting partial derivative: $\\begin{align}\\frac{\\partial}{\\partial \\theta_j} J(\\theta) &amp;= \\frac{\\partial}{\\partial \\theta_j} \\frac{-1}{m}\\sum_{i=1}^m \\left [ y^{(i)} log (h_\\theta(x^{(i)})) + (1-y^{(i)}) log (1 - h_\\theta(x^{(i)})) \\right ] \\newline&amp;= - \\frac{1}{m}\\sum_{i=1}^m \\left [ y^{(i)} \\frac{\\partial}{\\partial \\theta_j} log (h_\\theta(x^{(i)})) + (1-y^{(i)}) \\frac{\\partial}{\\partial \\theta_j} log (1 - h_\\theta(x^{(i)}))\\right ] \\newline&amp;= - \\frac{1}{m}\\sum_{i=1}^m \\left [ \\frac{y^{(i)} \\frac{\\partial}{\\partial \\theta_j} h_\\theta(x^{(i)})}{h_\\theta(x^{(i)})} + \\frac{(1-y^{(i)})\\frac{\\partial}{\\partial \\theta_j} (1 - h_\\theta(x^{(i)}))}{1 - h_\\theta(x^{(i)})}\\right ] \\newline&amp;= - \\frac{1}{m}\\sum_{i=1}^m \\left [ \\frac{y^{(i)} \\frac{\\partial}{\\partial \\theta_j} \\sigma(\\theta^T x^{(i)})}{h_\\theta(x^{(i)})} + \\frac{(1-y^{(i)})\\frac{\\partial}{\\partial \\theta_j} (1 - \\sigma(\\theta^T x^{(i)}))}{1 - h_\\theta(x^{(i)})}\\right ] \\newline&amp;= - \\frac{1}{m}\\sum_{i=1}^m \\left [ \\frac{y^{(i)} \\sigma(\\theta^T x^{(i)}) (1 - \\sigma(\\theta^T x^{(i)})) \\frac{\\partial}{\\partial \\theta_j} \\theta^T x^{(i)}}{h_\\theta(x^{(i)})} + \\frac{- (1-y^{(i)}) \\sigma(\\theta^T x^{(i)}) (1 - \\sigma(\\theta^T x^{(i)})) \\frac{\\partial}{\\partial \\theta_j} \\theta^T x^{(i)}}{1 - h_\\theta(x^{(i)})}\\right ] \\newline&amp;= - \\frac{1}{m}\\sum_{i=1}^m \\left [ \\frac{y^{(i)} h_\\theta(x^{(i)}) (1 - h_\\theta(x^{(i)})) \\frac{\\partial}{\\partial \\theta_j} \\theta^T x^{(i)}}{h_\\theta(x^{(i)})} - \\frac{(1-y^{(i)}) h_\\theta(x^{(i)}) (1 - h_\\theta(x^{(i)})) \\frac{\\partial}{\\partial \\theta_j} \\theta^T x^{(i)}}{1 - h_\\theta(x^{(i)})}\\right ] \\newline&amp;= - \\frac{1}{m}\\sum_{i=1}^m \\left [ y^{(i)} (1 - h_\\theta(x^{(i)})) x^{(i)}_j - (1-y^{(i)}) h_\\theta(x^{(i)}) x^{(i)}_j\\right ] \\newline&amp;= - \\frac{1}{m}\\sum_{i=1}^m \\left [ y^{(i)} (1 - h_\\theta(x^{(i)})) - (1-y^{(i)}) h_\\theta(x^{(i)}) \\right ] x^{(i)}_j \\newline&amp;= - \\frac{1}{m}\\sum_{i=1}^m \\left [ y^{(i)} - y^{(i)} h_\\theta(x^{(i)}) - h_\\theta(x^{(i)}) + y^{(i)} h_\\theta(x^{(i)}) \\right ] x^{(i)}_j \\newline&amp;= - \\frac{1}{m}\\sum_{i=1}^m \\left [ y^{(i)} - h_\\theta(x^{(i)}) \\right ] x^{(i)}_j \\newline&amp;= \\frac{1}{m}\\sum_{i=1}^m \\left [ h_\\theta(x^{(i)}) - y^{(i)} \\right ] x^{(i)}_j\\end{align}$ The vectorized version; $\\nabla J(\\theta) = \\frac{1}{m} \\cdot X^T \\cdot \\left(g\\left(X\\cdot\\theta\\right) - \\vec{y}\\right)$ 6. Advanced Optimization We can apply regularization to both linear regression and logistic regression. We will approach linear regression first. We first need to provide a function that evaluates the following two functions for a given input value Î¸: $\\begin{align}&amp; J(\\theta) \\newline &amp; \\dfrac{\\partial}{\\partial \\theta_j}J(\\theta)\\end{align}$ We can write a single function that returns both of theseâ€¦ 7. Multiclass Classification $\\begin{align}&amp; y \\in \\lbrace0, 1 â€¦ n\\rbrace \\newline&amp; h_\\theta^{(0)}(x) = P(y = 0 | x ; \\theta) \\newline&amp; h_\\theta^{(1)}(x) = P(y = 1 | x ; \\theta) \\newline&amp; \\cdots \\newline&amp; h_\\theta^{(n)}(x) = P(y = n | x ; \\theta) \\newline&amp; \\mathrm{prediction} = \\max_i( h_\\theta ^{(i)}(x) )\\newline\\end{align}$ Train a logistic regression classifier $h_\\theta ^{(i)}(x)$ for each class $i$ to predict the probability that $y = i$ . On a new input $x$, to make a prediction, pick the $i$ class that maximizes $\\max_i( h_\\theta ^{(i)}(x)$ @2017-02-10 review done. 8. RegularizationThe Problem of Overfitting Regularization is designed to address the problem of overfitting. High bias or underfitting is when the form of our hypothesis function h maps poorly to the trend of the data. It is usually caused by a function that is too simple or uses too few features. eg. if we take $h_Î¸(x)=Î¸_0+Î¸_1 \\cdot x_1+Î¸_2 \\cdot x_2$ then we are making an initial assumption that a linear model will fit the training data well and will be able to generalize but that may not be the case. At the other extreme, overfitting or high variance is caused by a hypothesis function that fits the available data but does not generalize well to predict new data. It is usually caused by a complicated function that creates a lot of unnecessary curves and angles unrelated to the data. This terminology is applied to both linear and logistic regression. There are two main options to address the issue of overfitting: 1) Reduce the number of features: a) Manually select which features to keep. b) Use a model selection algorithm . 2) Regularization Keep all the features, but reduce the parameters $Î¸_j$. Regularization works well when we have a lot of slightly useful features. to address æå‡ºï¼Œå»è§£å†³ 9. Regularization Cost FunctionIf we have overfitting from our hypothesis function, we can reduce the weight that some of the terms in our function carry by increasing their cost. Say we wanted to make the following function more quadratic [kwÉ’â€™drÃ¦tÉªk]: $\\theta_0 + \\theta_1x + \\theta_2x^2 + \\theta_3x^3 + \\theta_4x^4$ Weâ€™ll want to eliminate the influence of $\\theta_3x^3$ and $\\theta_4x^4$. Without actually getting rid of these features or changing the form of our hypothesis, we can instead modify our cost function: $min_\\theta\\ \\dfrac{1}{2m}\\sum_{i=1}^m (h_\\theta(x^{(i)}) - y^{(i)})^2 + 1000 \\cdot \\theta_3^2 + 1000\\cdot\\theta_4^2$ Weâ€™ve added two extra terms at the end to inflate the cost of $\\theta_3$ and $\\theta_4$. Now, in order for the cost function to get close to zero, we will have to reduce the values of $\\theta_3$ and $\\theta_4$ to near zero. This will in turn greatly reduce the values of $\\theta_3x^3$ and $\\theta_4x^4$ in our hypothesis function. We could also regularize all of our theta parameters in a single summation: $min_\\theta\\ \\dfrac{1}{2m}\\ \\left[ \\sum_{i=1}^m (h_\\theta(x^{(i)}) - y^{(i)})^2 + \\lambda\\ \\sum_{j=1}^n \\theta_j^2 \\right]$ The Î», or lambda, is the regularization parameter. It determines how much the costs of our theta parameters are inflated. You can visualize the effect of regularization in this interactive plot : https://www.desmos.com/calculator/1hexc8ntqp Using the above cost function with the extra summation, we can smooth the output of our hypothesis function to reduce overfitting. If lambda is chosen to be too large, it may smooth out the function too much and cause underfitting. æˆ‘ä»¬å¯ä»¥å¹³æ»‘æˆ‘ä»¬çš„å‡è®¾å‡½æ•°çš„è¾“å‡ºï¼Œä»¥å‡å°‘è¿‡åº¦æ‹Ÿåˆ 10. Regularized Linear10.1 Gradient Descent$\\begin{align}&amp; \\text{Repeat}\\ \\lbrace \\newline&amp; \\ \\ \\ \\ \\theta_0 := \\theta_0 - \\alpha\\ \\frac{1}{m}\\ \\sum_{i=1}^m (h_\\theta(x^{(i)}) - y^{(i)})x_0^{(i)} \\newline&amp; \\ \\ \\ \\ \\theta_j := \\theta_j - \\alpha\\ \\left[ \\left( \\frac{1}{m}\\ \\sum_{i=1}^m (h_\\theta(x^{(i)}) - y^{(i)})x_j^{(i)} \\right) + \\frac{\\lambda}{m}\\theta_j \\right] &amp;\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ j \\in \\lbrace 1,2â€¦n\\rbrace\\newline&amp; \\rbrace\\end{align}$ The term $\\frac{\\lambda}{m}\\theta_j$ performs our regularization. $\\theta_j := \\theta_j(1 - \\alpha\\frac{\\lambda}{m}) - \\alpha\\frac{1}{m}\\sum_{i=1}^m(h_\\theta(x^{(i)}) - y^{(i)})x_j^{(i)}$ The first term in the above equation, $1 - \\alpha\\frac{\\lambda}{m}$ will always be less than 1. Intuitively you can see it as reducing the value of $\\theta_j$ by some amount on every update. 10.2 Normal EquationUse less, temporarily ignored 11. Regularized LogisticCost Function $J(\\theta) = - \\frac{1}{m} \\sum_{i=1}^m \\large[ y^{(i)}\\ \\log (h_\\theta (x^{(i)})) + (1 - y^{(i)})\\ \\log (1 - h_\\theta(x^{(i)})) \\large]$ We can regularize this equation by adding a term to the end: $J(\\theta) = - \\frac{1}{m} \\sum_{i=1}^m \\large[ y^{(i)}\\ \\log (h_\\theta (x^{(i)})) + (1 - y^{(i)})\\ \\log (1 - h_\\theta(x^{(i)}))\\large] + \\frac{\\lambda}{2m}\\sum_{j=1}^n \\theta_j^2$ Gradient Descent Just like with linear regression, we will want to separately update $\\theta_0$ and the rest of the parameters because we do not want to regularize $\\theta_0$. $\\begin{align}&amp; \\text{Repeat}\\ \\lbrace \\newline&amp; \\ \\ \\ \\ \\theta_0 := \\theta_0 - \\alpha\\ \\frac{1}{m}\\ \\sum_{i=1}^m (h_\\theta(x^{(i)}) - y^{(i)})x_0^{(i)} \\newline&amp; \\ \\ \\ \\ \\theta_j := \\theta_j - \\alpha\\ \\left[ \\left( \\frac{1}{m}\\ \\sum_{i=1}^m (h_\\theta(x^{(i)}) - y^{(i)})x_j^{(i)} \\right) + \\frac{\\lambda}{m}\\theta_j \\right] &amp;\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ j \\in \\lbrace 1,2â€¦n\\rbrace\\newline&amp; \\rbrace\\end{align}$ Reference articleKaggle_Titanic","categories":[{"name":"machine-learning","slug":"machine-learning","permalink":"http://iequa.com/categories/machine-learning/"}],"tags":[{"name":"machine-learning","slug":"machine-learning","permalink":"http://iequa.com/tags/machine-learning/"}]},{"title":"Coursera Week 2 - Octave Tutorial By NG","slug":"ml/coursera-ng-w2-03","date":"2016-10-21T02:28:21.000Z","updated":"2019-10-20T04:30:35.042Z","comments":true,"path":"2016/10/21/ml/coursera-ng-w2-03/","link":"","permalink":"http://iequa.com/2016/10/21/ml/coursera-ng-w2-03/","excerpt":"ML:Octave Tutorial","text":"ML:Octave Tutorial 1. Basic Operations%% Change Octave prompt PS1(&#x27;&gt;&gt; &#x27;);%% Change working directory in windows example:cd &#x27;c:/path/to/desired/directory name&#x27;%% Note that it uses normal slashes and does not use escape characters for the empty spaces.%% elementary operations5+63-25*81/22^61 == 2 % false1 ~= 2 % true. note, not &quot;!=&quot;1 &amp;&amp; 01 || 0xor(1,0)%% variable assignmenta = 3; % semicolon suppresses outputb = &#x27;hi&#x27;;c = 3&gt;=1;% Displaying them:a = pidisp(a)disp(sprintf(&#x27;2 decimals: %0.2f&#x27;, a))disp(sprintf(&#x27;6 decimals: %0.6f&#x27;, a))format longaformat shorta%% vectors and matricesA = [1 2; 3 4; 5 6]v = [1 2 3]v = [1; 2; 3]v = 1:0.1:2 % from 1 to 2, with stepsize of 0.1. Useful for plot axesv = 1:6 % from 1 to 6, assumes stepsize of 1 (row vector)C = 2*ones(2,3) % same as C = [2 2 2; 2 2 2]w = ones(1,3) % 1x3 vector of onesw = zeros(1,3)w = rand(1,3) % drawn from a uniform distribution w = randn(1,3)% drawn from a normal distribution (mean=0, var=1)w = -6 + sqrt(10)*(randn(1,10000)); % (mean = -6, var = 10) - note: add the semicolonhist(w) % plot histogram using 10 bins (default)hist(w,50) % plot histogram using 50 bins% note: if hist() crashes, try &quot;graphics_toolkit(&#x27;gnu_plot&#x27;)&quot; I = eye(4) % 4x4 identity matrix% help functionhelp eyehelp randhelp help 2. Moving Data Around%% dimensionssz = size(A) % 1x2 matrix: [(number of rows) (number of columns)]size(A,1) % number of rowssize(A,2) % number of colslength(v) % size of longest dimension%% loading datapwd % show current directory (current path)cd &#x27;C:\\Users\\ang\\Octave files&#x27; % change directory ls % list files in current directory load q1y.dat % alternatively, load(&#x27;q1y.dat&#x27;)load q1x.datwho % list variables in workspacewhos % list variables in workspace (detailed view) clear q1y % clear command without any args clears all varsv = q1x(1:10); % first 10 elements of q1x (counts down the columns)save hello.mat v; % save variable v into file hello.matsave hello.txt v -ascii; % save as ascii% fopen, fread, fprintf, fscanf also work [[not needed in class]]%% indexingA(3,2) % indexing is (row,col)A(2,:) % get the 2nd row. % &quot;:&quot; means every element along that dimensionA(:,2) % get the 2nd colA([1 3],:) % print all the elements of rows 1 and 3A(:,2) = [10; 11; 12] % change second columnA = [A, [100; 101; 102]]; % append column vecA(:) % Select all elements as a column vector.% Putting data together A = [1 2; 3 4; 5 6]B = [11 12; 13 14; 15 16] % same dims as AC = [A B] % concatenating A and B matrices side by sideC = [A, B] % concatenating A and B matrices side by sideC = [A; B] % Concatenating A and B top and bottom 3. Computing on Data%% initialize variablesA = [1 2;3 4;5 6]B = [11 12;13 14;15 16]C = [1 1;2 2]v = [1;2;3]%% matrix operationsA * C % matrix multiplicationA .* B % element-wise multiplication% A .* C or A * B gives error - wrong dimensionsA .^ 2 % element-wise square of each element in A1./v % element-wise reciprocallog(v) % functions like this operate element-wise on vecs or matrices exp(v)abs(v)-v % -1*vv + ones(length(v), 1) % v + 1 % sameA&#x27; % matrix transpose%% misc useful functions% max (or min)a = [1 15 2 0.5]val = max(a)[val,ind] = max(a) % val - maximum element of the vector a and index - index value where maximum occurval = max(A) % if A is matrix, returns max from each column% compare values in a matrix &amp; finda &lt; 3 % checks which values in a are less than 3find(a &lt; 3) % gives location of elements less than 3A = magic(3) % generates a magic matrix - not much used in ML algorithms[r,c] = find(A&gt;=7) % row, column indices for values matching comparison% sum, prodsum(a)prod(a)floor(a) % or ceil(a)max(rand(3),rand(3))max(A,[],1) - maximum along columns(defaults to columns - max(A,[]))max(A,[],2) - maximum along rowsA = magic(9)sum(A,1)sum(A,2)sum(sum( A .* eye(9) ))sum(sum( A .* flipud(eye(9)) ))% Matrix inverse (pseudo-inverse)pinv(A) % inv(A&#x27;*A)*A&#x27; 4. Plotting Data&gt;&gt; t=[0:0.01:0.98];&gt;&gt; tt = Columns 1 through 10: 0.00000 0.01000 0.02000 0.03000 0.04000 0.05000 0.06000 0.07000 0.08000 0.09000 Columns 11 through 20: 0.10000 0.11000 0.12000 0.13000 0.14000 0.15000 0.16000 0.17000 0.18000 0.19000 Columns 21 through 30: 0.20000 0.21000 0.22000 0.23000 0.24000 0.25000 0.26000 0.27000 0.28000 0.29000 Columns 31 through 40: 0.30000 0.31000 0.32000 0.33000 0.34000 0.35000 0.36000 0.37000 0.38000 0.39000 Columns 41 through 50: 0.40000 0.41000 0.42000 0.43000 0.44000 0.45000 0.46000 0.47000 0.48000 0.49000 Columns 51 through 60: 0.50000 0.51000 0.52000 0.53000 0.54000 0.55000 0.56000 0.57000 0.58000 0.59000 Columns 61 through 70: 0.60000 0.61000 0.62000 0.63000 0.64000 0.65000 0.66000 0.67000 0.68000 0.69000 Columns 71 through 80: 0.70000 0.71000 0.72000 0.73000 0.74000 0.75000 0.76000 0.77000 0.78000 0.79000 Columns 81 through 90: 0.80000 0.81000 0.82000 0.83000 0.84000 0.85000 0.86000 0.87000 0.88000 0.89000 Columns 91 through 99: 0.90000 0.91000 0.92000 0.93000 0.94000 0.95000 0.96000 0.97000 0.98000&gt;&gt; y1=sin(2*pi*4*t);&gt;&gt; plot(t,y1)&gt;&gt; y2=cos(2*pi*4*t);&gt;&gt; plot(t,y2)&gt;&gt; hold on&gt;&gt; plot(t,y1)&gt;&gt; plot(t,y2,&#x27;r&#x27;)&gt;&gt; xlabel(&#x27;time&#x27;)&gt;&gt; ylabel(&#x27;value&#x27;)&gt;&gt; legend(&#x27;sin&#x27;,&#x27;cos&#x27;)&gt;&gt; title(&#x27;my plot&#x27;)&gt;&gt; print -dpng &#x27;myPlot.png&#x27;warning: print.m: fig2dev binary is not available.Some output formats are not available. &gt;&gt; figure(2); plot(t, y2)&gt;&gt; subplot(1,2,1);&gt;&gt; plot(t,y1)&gt;&gt; subplot(1,2,2)&gt;&gt; plot(t,y2)&gt;&gt; axis([0.5 1 -1 1]) &gt;&gt; clf;&gt;&gt; A = magic(5)A = 17 24 1 8 15 23 5 7 14 16 4 6 13 20 22 10 12 19 21 3 11 18 25 2 9&gt;&gt; imagesc(A)&gt;&gt; imagesc(A), colorbar, colormap gray; &gt;&gt; imagesc(magic(15)), colorbar, colormap gray;&gt;&gt; a=1,b=2,c=3a = 1b = 2c = 3 5. Control statements:for,while,ifv = zeros(10,1);for i=1:10, v(i) = 2^i;end;% Can also use &quot;break&quot; and &quot;continue&quot; inside for and while loops to control execution.i = 1;while i &lt;= 5, v(i) = 100; i = i+1;endi = 1;while true, v(i) = 999; i = i+1; if i == 6, break; end;endif v(1)==1, disp(&#x27;The value is one!&#x27;);elseif v(1)==2, disp(&#x27;The value is two!&#x27;);else disp(&#x27;The value is not one or two!&#x27;);end run example : &gt;&gt; i = 1;&gt;&gt; while i &lt;= 5, v(i) = 100; i = i+1; end;&gt;&gt; vv = 100 100 100 100 100 64 128 256 512 1024&gt;&gt; i = 1;&gt;&gt; while true, v(i) = 999; i = i + 1; if i == 6, break; end; end;&gt;&gt; vv = 999 999 999 999 999 64 128 256 512 1024&gt;&gt; v(1)ans = 999&gt;&gt; v(1) = 2;&gt;&gt; if v(1) == 1, disp(&#x27;The value is one&#x27;); elseif v(1) == 2, disp(&#x27;The value is two&#x27;); else disp(&#x27;The value is not 1 or 2&#x27;); end;The value is two 6. FunctionsTo call the function in Octave, do either: 1) Navigate to the directory of the functionName.m file and call the function: % Navigate to directory: cd /path/to/function % Call the function: functionName(args) simple compute line regression &gt;&gt; x = [1 1; 1 2; 1 3;]x = 1 1 1 2 1 3&gt;&gt; y = [1; 2; 3]y = 1 2 3&gt;&gt; theta = [0;1];&gt;&gt; j = costFunctionJ(x,y,theta)j = 0&gt;&gt; theta = [0:0];&gt;&gt; j = costFunctionJ(x, y, theta)warning: operator -: automatic broadcasting operation appliedj = 2.3333 2.3333 2.3333 2.3333 åº”è¯¥ä¸ºä¸€ä¸ª 2.3333ï¼Œ è€Œä¸æ˜¯çŸ©é˜µ 2.3333 &gt;&gt; (1^2 + 2^2 + 3^2) / (2*3)ans = 2.3333&gt;&gt; [-1,-2,-3]*[-1;-2;-3]ans = 14&gt;&gt; 14 / 6ans = 2.3333&gt;&gt; 7. VectorizationVectorization is the process of taking code that relies on loops and converting it into matrix operations. It is more efficient, more elegant, and more concise. As an example, letâ€™s compute our prediction from a hypothesis. Theta is the vector of fields for the hypothesis and x is a vector of variables. With loops: prediction = 0.0;for j = 1:n+1, prediction += theta(j) * x(j);end; With vectorization: prediction = theta&#x27; * x; Reference article coursera week 2 learning notes å­¦ä¹ ä¸€ç‚¹","categories":[{"name":"machine-learning","slug":"machine-learning","permalink":"http://iequa.com/categories/machine-learning/"}],"tags":[{"name":"machine-learning","slug":"machine-learning","permalink":"http://iequa.com/tags/machine-learning/"}]},{"title":"Coursera Week 2 - Octave learning","slug":"ml/coursera-ng-w2-02","date":"2016-10-12T02:28:21.000Z","updated":"2019-10-20T04:30:35.042Z","comments":true,"path":"2016/10/12/ml/coursera-ng-w2-02/","link":"","permalink":"http://iequa.com/2016/10/12/ml/coursera-ng-w2-02/","excerpt":"Octave Tutorial, Octave Learning","text":"Octave Tutorial, Octave Learning 1. var ä¸åƒmatlabæœ‰å›¾å½¢ç•Œé¢ï¼Œoctaveåªæä¾›äº†å‘½ä»¤è¡Œæ¥å£ã€‚ è¦å¯åŠ¨octaveï¼Œåªéœ€è¦åœ¨å‘½ä»¤è¡Œè¾“å…¥octaveå³å¯ã€‚ &gt;&gt; 2 * (3 + 5)ans = 16&gt;&gt; 2 ^ (3 + 5)ans = 256&gt;&gt; x = 2 * 3x = 6&gt;&gt; whoVariables in the current scope:ans x&gt;&gt; disp(x) 6&gt;&gt; 2. constant&gt; pians = 3.1416&gt;&gt; eans = 2.7183&gt;&gt; format long&gt;&gt; pians = 3.14159265358979&gt;&gt; format short&gt;&gt; pians = 3.1416&gt;&gt; octaveç³»ç»Ÿå®šä¹‰äº†åœ†å‘¨ç‡piå’Œè‡ªç„¶æŒ‡æ•°eè¿™ä¸¤ä¸ªå¸¸é‡, octave å¯ä»¥å®šä¹‰æ˜¾ç¤ºç»“æœ &gt;&gt; 3/0warning: division by zeroans = Inf&gt;&gt; 0/0warning: division by zeroans = NaN&gt;&gt; ç³»ç»Ÿå®šä¹‰äº†Infå’ŒNaNï¼ˆæ³¨æ„è¦åŒºåˆ†å¤§å°å†™ï¼‰ã€‚Inf(Infinity)è¡¨ç¤ºè¢«é›¶é™¤çš„ç»“æœï¼ŒNaN(Not a Number)è¡¨ç¤ºé›¶é™¤é›¶çš„ç»“æœã€‚ 3. workspaceä½¿ç”¨saveå‘½ä»¤ä¿å­˜å½“å‰å·¥ä½œåŒºåˆ°æ–‡ä»¶ work1 &gt;&gt; save work1&gt;&gt; load work1&gt;&gt; pians = 3.1416 4. semicolonoctave:32&gt; x = 2 * 3x = 6octave:33&gt; x = 2 * 3;octave:34&gt; disp(x) 6 5. matrixçŸ©é˜µä½¿ç”¨æ–¹æ‹¬å·([])æ‹¬èµ·æ¥ï¼Œç»´åº¦ä½¿ç”¨åˆ†å·(;)åˆ†å‰²ã€‚ åŒä¸€ç»´åº¦ä¹‹é—´çš„åˆ†éš”ç¬¦å¯ä»¥æ˜¯ç©ºæ ¼æˆ–é€—å·(,) octave:35&gt; x = [ 2 3 5 ]x = 2 3 5octave:36&gt; y = [ 2, 3, 5 ]y = 2 3 5octave:37&gt; z = [ 2; 3; 5 ]z = 2 3 5octave:39&gt; a = [ 1 2; 1, 3; 1 5 ]a = 1 2 1 3 1 5 ä½¿ç”¨å†’å·è¡¨è¾¾å¼å¿«é€Ÿæ„é€ è¿ç»­çš„å‘é‡ octave:43&gt; v = 2:5v = 2 3 4 5 octave:44&gt; v = 2:0.3:3v = 2.0000 2.3000 2.6000 2.9000 æ„é€ çŸ©é˜µçš„å‡½æ•° linspace(start, end, N) äº§ç”ŸNä¸ªå‡åŒ€åˆ†å¸ƒäºstartå’Œendä¹‹é—´çš„å‘é‡ã€‚ åœ¨ç»˜å›¾æ—¶ç”¨äºäº§ç”Ÿxåæ ‡ç‰¹åˆ«æœ‰ç”¨ã€‚ logspace(start, end, N) äº§ç”ŸNä¸ªæŒ‡æ•°åˆ†å¸ƒäº10^startå’Œ10^endä¹‹é—´çš„å‘é‡ã€‚ åœ¨ç»˜å›¾æ—¶ç”¨äºäº§ç”Ÿxåæ ‡ç‰¹åˆ«æœ‰ç”¨ã€‚ zeros(M, N) zeros(N) = zeros(N, N)ã€‚ ones(M, N) ones(N) = ones(N, N)ã€‚ rand(M, N) å€¼ä½äº0~1çš„éšæœºæ•°çš„çŸ©é˜µã€‚ rand(N) = rand(N, N)ã€‚ octave:66&gt; x = linspace (3, 4, 5)x = Columns 1 through 4: 3.00000000000000 3.25000000000000 3.50000000000000 3.75000000000000 Column 5: 4.00000000000000octave:67&gt; logspace (1, 2, 6)ans = Columns 1 through 4: 10.0000000000000 15.8489319246111 25.1188643150958 39.8107170553497 Columns 5 and 6: 63.0957344480193 100.0000000000000 6. matrix operationA + BA - BA * BA \\ B è¯´æ˜ï¼šA\\Bä¸ºçŸ©é˜µå·¦é™¤ï¼Œç”¨äºæ±‚è§£çº¿æ€§æ–¹ç¨‹Wx=bï¼Œå…¶ä¸­Wä¸ºä¸€ä¸ªnxnçš„çŸ©é˜µï¼Œbä¸ºä¸€ä¸ªnç»´çš„åˆ—å‘é‡ã€‚ æ±‚è§£çº¿æ€§æ–¹å¼ç¤ºä¾‹ï¼š octave:15&gt; W = [1 1 1 1; 1 2 3 4; 3 4 6 2; 2 7 10 5];octave:16&gt; b = [3; 5; 5; 8];octave:17&gt; x = W\\bx = 1.0000 3.0000 -2.0000 1.0000 6.1 matrix transpose octave:9&gt; x = rand(3)x = 0.0052581 0.4446771 0.3970036 0.7844458 0.3317067 0.9633000 0.0577080 0.9015905 0.0344771octave:10&gt; x&#x27;ans = 0.0052581 0.7844458 0.0577080 0.4446771 0.3317067 0.9015905 0.3970036 0.9633000 0.034477 7. plotting&gt;&gt; t=[0:0.01:0.98];&gt;&gt; tt = Columns 1 through 10: 0.00000 0.01000 0.02000 0.03000 0.04000 0.05000 0.06000 0.07000 0.08000 0.09000 Columns 11 through 20: 0.10000 0.11000 0.12000 0.13000 0.14000 0.15000 0.16000 0.17000 0.18000 0.19000 Columns 21 through 30: 0.20000 0.21000 0.22000 0.23000 0.24000 0.25000 0.26000 0.27000 0.28000 0.29000 Columns 31 through 40: 0.30000 0.31000 0.32000 0.33000 0.34000 0.35000 0.36000 0.37000 0.38000 0.39000 Columns 41 through 50: 0.40000 0.41000 0.42000 0.43000 0.44000 0.45000 0.46000 0.47000 0.48000 0.49000 Columns 51 through 60: 0.50000 0.51000 0.52000 0.53000 0.54000 0.55000 0.56000 0.57000 0.58000 0.59000 Columns 61 through 70: 0.60000 0.61000 0.62000 0.63000 0.64000 0.65000 0.66000 0.67000 0.68000 0.69000 Columns 71 through 80: 0.70000 0.71000 0.72000 0.73000 0.74000 0.75000 0.76000 0.77000 0.78000 0.79000 Columns 81 through 90: 0.80000 0.81000 0.82000 0.83000 0.84000 0.85000 0.86000 0.87000 0.88000 0.89000 Columns 91 through 99: 0.90000 0.91000 0.92000 0.93000 0.94000 0.95000 0.96000 0.97000 0.98000&gt;&gt; y1=sin(2*pi*4*t);&gt;&gt; plot(t,y1)&gt;&gt; y2=cos(2*pi*4*t);&gt;&gt; plot(t,y2)&gt;&gt; hold on&gt;&gt; plot(t,y1)&gt;&gt; plot(t,y2,&#x27;r&#x27;)&gt;&gt; xlabel(&#x27;time&#x27;)&gt;&gt; ylabel(&#x27;value&#x27;)&gt;&gt; legend(&#x27;sin&#x27;,&#x27;cos&#x27;)&gt;&gt; title(&#x27;my plot&#x27;)&gt;&gt; print -dpng &#x27;myPlot.png&#x27;warning: print.m: fig2dev binary is not available.Some output formats are not available. &gt;&gt; figure(2); plot(t, y2)&gt;&gt; subplot(1,2,1);&gt;&gt; plot(t,y1)&gt;&gt; subplot(1,2,2)&gt;&gt; plot(t,y2)&gt;&gt; axis([0.5 1 -1 1]) &gt;&gt; clf;&gt;&gt; A = magic(5)A = 17 24 1 8 15 23 5 7 14 16 4 6 13 20 22 10 12 19 21 3 11 18 25 2 9&gt;&gt; imagesc(A)&gt;&gt; imagesc(A), colorbar, colormap gray; &gt;&gt; imagesc(magic(15)), colorbar, colormap gray;&gt;&gt; a=1,b=2,c=3a = 1b = 2c = 3 8. ng&gt;&gt; A = [1 2; 3 4; 5 6;]A = 1 2 3 4 5 6&gt;&gt; save hello.mat v; (å‹ç¼©æ¯”ä¾‹å¾ˆå¤§)save hello.txt v -ascii % save as text(ASCII)&gt;&gt; whoVariables in the current scope:A&gt;&gt; whosVariables in the current scope: Attr Name Size Bytes Class ==== ==== ==== ===== ===== A 3x2 48 doubleTotal is 6 elements using 48 bytes&gt;&gt; clear&gt;&gt; A(3,2)ans = 6&gt;&gt; A(:,2)ans = 2 4 6&gt;&gt; A(2,:)ans = 3 4&gt;&gt; AA = 1 2 3 4 5 6&gt;&gt; A([1 3], :)ans = 1 2 5 6&gt;&gt; A(:,2)ans = 2 4 6&gt;&gt; A(:,2) = [10; 11; 12]A = 1 10 3 11 5 12&gt;&gt; A = [A, [100; 101; 102]];&gt;&gt; AA = 1 10 100 3 11 101 5 12 102&gt;&gt; [100;101;102]ans = 100 101 102&gt;&gt; size(A)ans = 3 3&gt;&gt; A(:)ans = 1 3 5 10 11 12 100 101 102&gt;&gt; A = [1 2; 3 4; 5 6;]A = 1 2 3 4 5 6&gt;&gt; B = [11 12; 13 14; 15 16]B = 11 12 13 14 15 16&gt;&gt; C = [A B]C = 1 2 11 12 3 4 13 14 5 6 15 16&gt;&gt; D = [A;B]D = 1 2 3 4 5 6 11 12 13 14 15 16&gt;&gt; size(D)ans = 6 2&gt;&gt; [A, B]ans = 1 2 11 12 3 4 13 14 5 6 15 16&gt;&gt; [A B]ans = 1 2 11 12 3 4 13 14 5 6 15 16&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; A .* Bans = 11 24 39 56 75 96&gt;&gt; A .^ 2ans = 1 4 9 16 25 36&gt;&gt; v = [1; 2; 3]v = 1 2 3&gt;&gt; 1 ./ vans = 1.00000 0.50000 0.33333&gt;&gt; 1 ./ Aans = 1.00000 0.50000 0.33333 0.25000 0.20000 0.16667&gt;&gt; log(v)ans = 0.00000 0.69315 1.09861&gt;&gt; exp(v)ans = 2.7183 7.3891 20.0855&gt;&gt; abs(v)ans = 1 2 3&gt;&gt; abs([-1; -2; -3])ans = 1 2 3&gt;&gt; V = vV = 1 2 3&gt;&gt; VV = 1 2 3&gt;&gt; VV = 1 2 3&gt;&gt; -Vans = -1 -2 -3&gt;&gt; V + ones(length(V))warning: operator +: automatic broadcasting operation appliedans = 2 2 2 3 3 3 4 4 4&gt;&gt; length(V)ans = 3&gt;&gt; ones(3,1)ans = 1 1 1&gt;&gt; V + ones(3, 1)ans = 2 3 4&gt;&gt; V + 2ans = 3 4 5&gt;&gt; VV = 1 2 3&gt;&gt; AA = 1 2 3 4 5 6&gt;&gt; A&#x27;ans = 1 3 5 2 4 6&gt;&gt; a = [1 15 2 0.5]a = 1.00000 15.00000 2.00000 0.50000&gt;&gt; val = max(a)val = 15&gt;&gt; [val, ind] = max(a)val = 15ind = 2&gt;&gt; max(A)ans = 5 6&gt;&gt; AA = 1 2 3 4 5 6&gt;&gt; aa = 1.00000 15.00000 2.00000 0.50000&gt;&gt; a &lt; 3ans = 1 0 1 1&gt;&gt; find(a &lt; 3)ans = 1 3 4&gt;&gt; A = magix(3)error: &#x27;magix&#x27; undefined near line 1 column 5&gt;&gt; A = magic(3)A = 8 1 6 3 5 7 4 9 2&gt;&gt; [r, c] = find(A &gt;= 7)r = 1 3 2c = 1 2 3&gt;&gt; A(2,3)ans = 7&gt;&gt; sum(a)ans = 18.500&gt;&gt; prod(a)ans = 15&gt;&gt; floor(a)ans = 1 15 2 0&gt;&gt; ceil(a)ans = 1 15 2 1&gt;&gt; rand(3)ans = 0.708800 0.905101 0.837562 0.264139 0.265985 0.671546 0.411435 0.058028 0.454436&gt;&gt; max(rand(3), rand(3))ans = 0.87641 0.74541 0.92027 0.61292 0.57756 0.95694 0.26555 0.76822 0.63566&gt;&gt; AA = 8 1 6 3 5 7 4 9 2&gt;&gt; max(A, [], 1)ans = 8 9 7&gt;&gt; max(A, [], 2)ans = 8 7 9&gt;&gt; max(A)ans = 8 9 7&gt;&gt; max(max(A))ans = 9&gt;&gt; A(:)ans = 8 3 4 1 5 9 6 7 2&gt;&gt; max(A(:))ans = 9&gt;&gt;&gt;&gt;&gt;&gt; A = magic(9)A = 47 58 69 80 1 12 23 34 45 57 68 79 9 11 22 33 44 46 67 78 8 10 21 32 43 54 56 77 7 18 20 31 42 53 55 66 6 17 19 30 41 52 63 65 76 16 27 29 40 51 62 64 75 5 26 28 39 50 61 72 74 4 15 36 38 49 60 71 73 3 14 25 37 48 59 70 81 2 13 24 35&gt;&gt; sum(A,1)ans = 369 369 369 369 369 369 369 369 369&gt;&gt; sum(A,2)ans = 369 369 369 369 369 369 369 369 369&gt;&gt; eye(9)ans =Diagonal Matrix 1 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 1&gt;&gt; AA = 47 58 69 80 1 12 23 34 45 57 68 79 9 11 22 33 44 46 67 78 8 10 21 32 43 54 56 77 7 18 20 31 42 53 55 66 6 17 19 30 41 52 63 65 76 16 27 29 40 51 62 64 75 5 26 28 39 50 61 72 74 4 15 36 38 49 60 71 73 3 14 25 37 48 59 70 81 2 13 24 35&gt;&gt; A .* eye(9)ans = 47 0 0 0 0 0 0 0 0 0 68 0 0 0 0 0 0 0 0 0 8 0 0 0 0 0 0 0 0 0 20 0 0 0 0 0 0 0 0 0 41 0 0 0 0 0 0 0 0 0 62 0 0 0 0 0 0 0 0 0 74 0 0 0 0 0 0 0 0 0 14 0 0 0 0 0 0 0 0 0 35&gt;&gt; sum(sum(A .* eye(9)))ans = 369&gt;&gt; flipud(eye(9))ans =Permutation Matrix 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0&gt;&gt; sum(sum(A.*flipud(eye(9))))ans = 369&gt;&gt; AA = 47 58 69 80 1 12 23 34 45 57 68 79 9 11 22 33 44 46 67 78 8 10 21 32 43 54 56 77 7 18 20 31 42 53 55 66 6 17 19 30 41 52 63 65 76 16 27 29 40 51 62 64 75 5 26 28 39 50 61 72 74 4 15 36 38 49 60 71 73 3 14 25 37 48 59 70 81 2 13 24 35&gt;&gt; A = magic(3)A = 8 1 6 3 5 7 4 9 2&gt;&gt; temp = pinv(A)temp = 0.147222 -0.144444 0.063889 -0.061111 0.022222 0.105556 -0.019444 0.188889 -0.102778 Reference article coursera week 2 learning notes å­¦ä¹ ä¸€ç‚¹","categories":[{"name":"machine-learning","slug":"machine-learning","permalink":"http://iequa.com/categories/machine-learning/"}],"tags":[{"name":"machine-learning","slug":"machine-learning","permalink":"http://iequa.com/tags/machine-learning/"}]},{"title":"Coursera Week 2 - Linear Regression with Multiple Variables","slug":"ml/coursera-ng-w2-01-Linear-Regression","date":"2016-10-08T04:28:21.000Z","updated":"2019-10-20T04:30:35.046Z","comments":true,"path":"2016/10/08/ml/coursera-ng-w2-01-Linear-Regression/","link":"","permalink":"http://iequa.com/2016/10/08/ml/coursera-ng-w2-01-Linear-Regression/","excerpt":"coursera week 2 - linear regression with multiple variables 1","text":"coursera week 2 - linear regression with multiple variables 1 1. Multiple Features $\\begin{align}x_j^{(i)} &amp;= \\text{value of feature } j \\text{ in the }i^{th}\\text{ training example} \\newlinex^{(i)}&amp; = \\text{the column vector of all the feature inputs of the }i^{th}\\text{ training example} \\newlinem &amp;= \\text{the number of training examples} \\newlinen &amp;= \\left| x^{(i)} \\right| ; \\text{(the number of features)} \\end{align}$ Macdown Version 0.6.4 (786) MathJax the same this web 1.1 hypothesis functionNow define the multivariable form of the hypothesis function as follows, accommodating these multiple features: $h_\\theta (x) = \\theta_0 + \\theta_1 x_1 + \\theta_2 x_2 + \\theta_3 x_3 + \\cdots + \\theta_n x_n$ multivariable hypothesis function Using the definition of matrix multiplication, our multivariable hypothesis function can be concisely represented as: $\\begin{align}h_\\theta(x) =\\begin{bmatrix}\\theta_0 \\hspace{2em} \\theta_1 \\hspace{2em} â€¦ \\hspace{2em} \\theta_n\\end{bmatrix}\\begin{bmatrix}x_0 \\newline x_1 \\newline \\vdots \\newline x_n\\end{bmatrix}= \\theta^T x\\end{align}$ The training examples are stored in X row-wise, like such: $\\begin{align}X =\\begin{bmatrix}x^{(1)}_0 &amp; x^{(1)}_1 \\newline x^{(2)}_0 &amp; x^{(2)}_1 \\newlinex^{(3)}_0 &amp; x^{(3)}_1 \\end{bmatrix}&amp;,\\theta = \\begin{bmatrix}\\theta_0 \\newline\\theta_1 \\newline\\end{bmatrix}\\end{align}$ You can calculate the hypothesis as a column vector of size (m x 1) with: $h_\\theta(X) = X \\theta$ For the rest of these notes, X will represent a matrix of training examples $x_{(i)}$ 2. Cost functionFor the parameter vector Î¸ (of type $\\mathbb{R}^{n+1}$ or in $\\mathbb{R}^{(n+1) \\times 1}$, the cost function is: $J(\\theta) = \\dfrac {1}{2m} \\displaystyle \\sum_{i=1}^m \\left (h_\\theta (x^{(i)}) - y^{(i)} \\right)^2$ The vectorized version is: $J(\\theta) = \\dfrac {1}{2m} (X\\theta - \\vec{y})^{T} (X\\theta - \\vec{y})$ vectorized version is very good! 3. Gradient Desc MultivariableMatrix Notation The Gradient Descent rule can be expressed as: $\\theta := \\theta - \\alpha \\nabla J(\\theta)$ Where $\\nabla J(\\theta)$ is a column vector of the form: $\\nabla J(\\theta) = \\begin{bmatrix}\\frac{\\partial J(\\theta)}{\\partial \\theta_0} \\newline \\frac{\\partial J(\\theta)}{\\partial \\theta_1} \\newline \\vdots \\newline \\frac{\\partial J(\\theta)}{\\partial \\theta_n} \\end{bmatrix}$ The j-th component of the gradient is the summation of the product of two terms: $\\begin{align}\\; &amp;\\frac{\\partial J(\\theta)}{\\partial \\theta_j} &amp;=&amp; \\frac{1}{m} \\sum\\limits_{i=1}^{m} \\left(h_\\theta(x^{(i)}) - y^{(i)} \\right) \\cdot x_j^{(i)} \\newline\\; &amp; &amp;=&amp; \\frac{1}{m} \\sum\\limits_{i=1}^{m} x_j^{(i)} \\cdot \\left(h_\\theta(x^{(i)}) - y^{(i)} \\right)\\end{align}$ åœ¨æ•°å­¦ä¸­ï¼Œä¸€ä¸ªå¤šå˜é‡çš„å‡½æ•°çš„åå¯¼æ•°æ˜¯å®ƒå…³äºå…¶ä¸­ä¸€ä¸ªå˜é‡çš„å¯¼æ•°ï¼Œè€Œä¿æŒå…¶ä»–å˜é‡æ’å®šã€‚ Sometimes, the summation of the product of two terms can be expressed as the product of two vectors. $\\begin{align}\\; &amp;\\frac{\\partial J(\\theta)}{\\partial \\theta_j} = \\frac1m \\vec{x_j}^{T} (X\\theta - \\vec{y}) \\newline&amp;\\nabla J(\\theta) = \\frac 1m X^{T} (X\\theta - \\vec{y}) \\newline\\end{align}$ Finally, the matrix notation (vectorized) of the Gradient Descent rule is: $\\theta := \\theta - \\frac{\\alpha}{m} X^{T} (X\\theta - \\vec{y})$ The gradient descent equation itself is generally the same form; we just have to repeat it for our â€˜nâ€™ features: $\\begin{align}&amp; \\text{repeat until convergence:} \\; \\lbrace \\newline\\; &amp; \\theta_0 := \\theta_0 - \\alpha \\frac{1}{m} \\sum\\limits_{i=1}^{m} (h_\\theta(x^{(i)}) - y^{(i)}) \\cdot x_0^{(i)}\\newline\\; &amp; \\theta_1 := \\theta_1 - \\alpha \\frac{1}{m} \\sum\\limits_{i=1}^{m} (h_\\theta(x^{(i)}) - y^{(i)}) \\cdot x_1^{(i)} \\newline\\; &amp; \\theta_2 := \\theta_2 - \\alpha \\frac{1}{m} \\sum\\limits_{i=1}^{m} (h_\\theta(x^{(i)}) - y^{(i)}) \\cdot x_2^{(i)} \\newline&amp; \\cdots\\newline \\rbrace\\end{align}$ In other words: $\\begin{align}&amp; \\text{repeat until convergence:} \\; \\lbrace \\newline \\;&amp; \\theta_j := \\theta_j - \\alpha \\frac{1}{m} \\sum\\limits_{i=1}^{m} (h_\\theta(x^{(i)}) - y^{(i)}) \\cdot x_j^{(i)} \\; &amp; \\text{for j := 0..n}\\newline \\rbrace\\end{align}$ 3.1 Feature ScalingIdea : Make sure features are on a similar scale ç‰¹å¾ç¼©æ”¾ Get every feature into approximately a $-1 \\leq x_i \\leq 1$ range. Replace $x_i$ with $x_i - u_i$ to make features have approximately zero mean (Do not apply to $x_0$ = 1). å¦‚æœå¤šä¸ªç‰¹å¾å€¼ï¼Œå¤§å¤šå¤„åœ¨ä¸€ä¸ªç›¸è¿‘çš„èŒƒå›´ï¼Œæ¢¯åº¦ä¸‹é™å°±èƒ½æ›´å¿«çš„æ”¶æ•›ã€‚ å› ä¸º 2000/5 æ¯”è¾ƒå¤§ï¼Œæ‰€ä»¥è½®å»“å›¾ï¼Œä½¿å¾—æ¤­åœ†æ›´åŠ çš„ç˜¦é•¿ï¼Œå¥½æ¯” $J(\\theta)$ æ”¶æ•›çš„æ›´æ…¢ã€‚ 3.2 learning rate$\\begin{align}\\theta_j := \\theta_j - \\alpha \\frac{\\partial}{\\partial \\theta_j} J(\\theta)\\end{align}$ Debugging : How to make sure gradient descent is working correctly How to choose learning rate $\\alpha$ Summary if $\\alpha$ is too small: slow convergence [kÉ™nâ€™vÉœËdÊ’É™ns] æ”¶æ•› if $\\alpha$ is too large: $J(\\theta)$ may not decrease on every iteration; may not converge. To choose $\\alpha$, try â€¦, 0.001, 0.01, 0.1, 1, â€¦ 4. Polynomial Regression 4.1 Polynomial Regression Feature normalization is very important 4.2 Choice of features @2017-02-10 review done 5. Normal Equation $\\theta = (X^T X)^{-1}X^T y$ 5.1 num and vector $J(\\theta) = \\dfrac {1}{2m} (X\\theta - \\vec{y})^{T} (X\\theta - \\vec{y})$ $\\begin{align}\\; &amp;\\frac{\\partial J(\\theta)}{\\partial \\theta_j} = \\frac1m \\vec{x_j}^{T} (X\\theta - \\vec{y}) \\newline&amp;\\nabla J(\\theta) = \\frac 1m X^{T} (X\\theta - \\vec{y}) \\newline\\end{align}$ 5.2 house price example $\\begin{align}\\nabla J(\\theta) = \\frac 1m X^{T} (X\\theta - \\vec{y}) \\newline\\end{align}$ ä»¤ $\\nabla J(\\theta) = 0 $ So, $\\theta = (X^T X)^{-1}X^T y $ 5.3 $m$ training, $n$ features Gradient Descent Normal Equation Need to choose $\\alpha$ No need to choose $\\alpha$ Needs many iterations Donâ€™t need to iterate Works well even when $n$ is large Slow if $n$ is very large it is usually around ten thousand that I might start to consider switching over to gradient descents or maybe, some other algorithms that weâ€™ll talk about later in this class 5.4 $X^T X$ is non-invertible $\\theta = (X^T X)^{-1}X^T y $ What $X^T X$ is non-invertible? ï¼ˆsingular / degenerateï¼‰ When $X^T X$ is non-invertible, this is very few. What $X^T X$ is non-invertible?","categories":[{"name":"machine-learning","slug":"machine-learning","permalink":"http://iequa.com/categories/machine-learning/"}],"tags":[{"name":"machine-learning","slug":"machine-learning","permalink":"http://iequa.com/tags/machine-learning/"}]},{"title":"Coursera Week 1 - Linear Algebra Matrices And Vectors","slug":"ml/coursera-ng-w1-03-Linear-Algebra","date":"2016-09-30T06:22:21.000Z","updated":"2019-10-20T04:30:35.044Z","comments":true,"path":"2016/09/30/ml/coursera-ng-w1-03-Linear-Algebra/","link":"","permalink":"http://iequa.com/2016/09/30/ml/coursera-ng-w1-03-Linear-Algebra/","excerpt":"coursera week 1 - matrices and vectors","text":"coursera week 1 - matrices and vectors 1. Matrix Elements A = \\begin{bmatrix} 1 & 2 \\\\\\ 4 & 5 \\\\\\ 7 & 8 \\end{bmatrix} \\tag{fmt.1 R^{32}}$ A_{ij} = $ â€œ$i, j$ entryâ€ in the $i^{th}$ row, $j^{th}$ column $ A_{32} = 8 $ 2. Vector $A_n$ n*1 matrix y = \\begin{bmatrix} 460 \\\\\\ 232 \\\\\\ 315 \\\\\\ 178 \\end{bmatrix} \\tag{fmt.2} $R^4$ 4 dimensional vector$y_i = i^{th} element$ 2.1 math 1-indexed y = \\begin{bmatrix} y1 \\\\\\ y2 \\\\\\ y3 \\\\\\ y4 \\end{bmatrix} \\tag{fmt.3}2.2 machine-learning 0-indexed y = \\begin{bmatrix} y0 \\\\\\ y1 \\\\\\ y2 \\\\\\ y3 \\end{bmatrix} \\tag{fmt.4}3. Matrix Addition\\begin{bmatrix} 1 & 0 \\\\\\ 2 & 5 \\\\\\ 3 & 1 \\end{bmatrix} + \\begin{bmatrix} 4 & 0.5 \\\\\\ 2 & 5 \\\\\\ 0 & 1 \\end{bmatrix} = \\begin{bmatrix} 5 & 0.5 \\\\\\ 4 & 10 \\\\\\ 3 & 2 \\end{bmatrix}4. Scalar Multiplication3 \\times \\begin{bmatrix} 1 & 0 \\\\\\ 2 & 5 \\\\\\ 3 & 1 \\end{bmatrix} = \\begin{bmatrix} 3 & 0 \\\\\\ 6 & 15 \\\\\\ 9 & 3 \\end{bmatrix}5. Combination of Operands3 \\times \\begin{bmatrix} 1 \\\\\\ 4 \\\\\\ 2 \\end{bmatrix} + \\begin{bmatrix} 0 \\\\\\ 0 \\\\\\ 5 \\end{bmatrix} - \\begin{bmatrix} 3 \\\\\\ 0 \\\\\\ 2 \\end{bmatrix} / 3 = \\begin{bmatrix} 2 \\\\\\ 12 \\\\\\ 31/3 \\end{bmatrix}6. Matrix Vector Multiplication \\begin{bmatrix} 1 & 3 \\\\\\ 4 & 0 \\\\\\ 2 & 1 \\end{bmatrix} \\times \\begin{bmatrix} 1 \\\\\\ 5 \\end{bmatrix} = \\begin{bmatrix} 16 \\\\\\ 4 \\\\\\ 7 \\end{bmatrix}Matrix Vector Multiplication Fmt : 6.1 House sizes example h\\_{\\theta} (x) = -40 + 0.25 x House sizes Price 2104 ? 1416 ? 1534 ? 852 ? \\begin{bmatrix} 1 & 2104 \\\\\\ 1 & 1416 \\\\\\ 1 & 1534 \\\\\\ 1 & 852 \\end{bmatrix} \\times \\begin{bmatrix} -40 \\\\\\ 0.25 \\end{bmatrix} = \\begin{bmatrix} -40 \\times 1 + 0.25 \\times 2104 \\\\\\ ... \\\\\\ ... \\\\\\ ... \\end{bmatrix}7. Practice Example\\begin{bmatrix} 1 & 3 & 2 \\\\\\ 4 & 0 & 1 \\end{bmatrix} \\begin{bmatrix} 1 & 3 \\\\\\ 0 & 1 \\\\\\ 5 & 2 \\end{bmatrix} = \\begin{bmatrix} 11 & 10 \\\\\\ 9 & 14 \\end{bmatrix} $ A_{2 \\times 3} \\times A_{3 \\times 2} = A_{2 \\times 2} $ 8. House Example 9. Matrix $A \\times B \\neq B \\times A$But, ç»“åˆå¾‹ï¼Œå¯ä»¥çš„ $ A \\times B \\times C = (A \\times B) \\times C = A \\times (B \\times C) $ 10. Identity MatrixDenoted I (or I_{n*n}). 10.1 $2 \\times 2$ \\begin{bmatrix} 1 & 0 \\\\\\ 0 & 1 \\end{bmatrix} \\tag{fmt.1 R^{32}}10.2 $3 \\times 3$ \\begin{bmatrix} 1 & 0 & 0 \\\\\\ 0 & 1 & 0 \\\\\\ 0 & 0 & 1 \\end{bmatrix} \\tag{fmt.1 R^{32}} $Z \\times I = I \\times Z = Z$ 11. Matrix Inverse$3 \\times 3^{-1} = 1$ Not all numbers have an inverse. if $A$ is an $m \\times m$ matrix, and if it has an inverse $A \\times A^{-1} = A^{-1} \\times A = I$ A = \\begin{bmatrix} 3 & 4 \\\\\\ 2 & 16 \\\\\\ \\end{bmatrix} A^{-1} = \\begin{bmatrix} 0.4 & -0.1 \\\\\\ -0.05 & 0.075 \\\\\\ \\end{bmatrix}$ A \\times A^{-1} = I_{2 \\times 2} $ I\\_{2 \\times 2} = \\begin{bmatrix} 1 & 0 \\\\\\ 0 & 1 \\\\\\ \\end{bmatrix}12. Matrix Transpose A = \\begin{bmatrix} 1 & 2 & 0 \\\\\\ 3 & 5 & 9 \\\\\\ \\end{bmatrix} A^T = \\begin{bmatrix} 1 & 3 \\\\\\ 2 & 5 \\\\\\ 0 & 9 \\end{bmatrix}Let $A$ be an $m \\times n$ matrix, and let $B = A^T$.Then $B$ is an $n \\times m$ matrix, and $B_{ij} = A_{ji}$","categories":[{"name":"machine-learning","slug":"machine-learning","permalink":"http://iequa.com/categories/machine-learning/"}],"tags":[{"name":"machine-learning","slug":"machine-learning","permalink":"http://iequa.com/tags/machine-learning/"}]},{"title":"Coursera Week 1 - Linear Regression Cost Function & Gradient descent","slug":"ml/coursera-ng-w1-02-cost-function-gradient-descent","date":"2016-09-28T09:22:21.000Z","updated":"2021-01-06T10:14:27.703Z","comments":true,"path":"2016/09/28/ml/coursera-ng-w1-02-cost-function-gradient-descent/","link":"","permalink":"http://iequa.com/2016/09/28/ml/coursera-ng-w1-02-cost-function-gradient-descent/","excerpt":"Linear Regression Cost Function &amp; Gradient descent","text":"Linear Regression Cost Function &amp; Gradient descent 1. Linear Regression 2. Cost Function Choose $\\theta0ï¼Œ\\theta_1$ so that $h{\\theta} (x)$ is close to $y$ for our training examples ${(x, y)}$ Title fmt Hypothesis $h_{\\theta} (x) = \\theta_0 + \\theta_1 x$ Parameters $\\theta_0 ã€\\theta_1$ Cost Function $J(\\theta0ï¼Œ\\theta_1) = {\\frac {1} {2m}} \\sum{i=1}^m (h_{\\theta} (x^{i}) - (y^{i}))^2$ Goal $minimize J(\\theta_0ï¼Œ\\theta_1)$ 3. Simplified Fmt $\\theta_0$ = 0 hypothesis function $h_{\\theta} (x)$ cost function $J(\\theta_1)$ 4. Cost function visable æŠŠ x, y æƒ³è±¡æˆå‘é‡ï¼Œç¡®å®šçš„å‘é‡ï¼Œå‘é‡å†æƒ³è±¡ä¸ºä¸€ä¸ªç¡®å®šçš„æ•°ï¼Œæ€»ä¹‹å®ƒæ˜¯ä¸€ä¸ªäºŒæ¬¡å‡½æ•°ï¼ŒæŠ½è±¡çš„æƒ³ä¸€ä¸‹ï¼Œä¼šä¸ä¼šç†è§£ contour plots contour figures 5. Gradient descent target 6. Gradient descent visable Convex function 7. Gradient descent algorithm $ \\alpha $ : learning rate 8. Gradient descent only $ \\theta_{1} $ 9. Linear Regression Model 9.1 Batch Gradient Descent Batch : Each step of gradient descent uses all the training examples Coursera Learning Notes","categories":[{"name":"machine-learning","slug":"machine-learning","permalink":"http://iequa.com/categories/machine-learning/"}],"tags":[{"name":"machine-learning","slug":"machine-learning","permalink":"http://iequa.com/tags/machine-learning/"}]},{"title":"Coursera Week 1 - Machine Learning Introduction","slug":"ml/coursera-ng-w1-01-introduce","date":"2016-09-20T02:22:21.000Z","updated":"2019-10-20T04:30:35.039Z","comments":true,"path":"2016/09/20/ml/coursera-ng-w1-01-introduce/","link":"","permalink":"http://iequa.com/2016/09/20/ml/coursera-ng-w1-01-introduce/","excerpt":"Machine-learning, Grew out of work in Artificial Intelligence, New capability for computers","text":"Machine-learning, Grew out of work in Artificial Intelligence, New capability for computers Machine Learning Grew out of work in Artificial Intelligence New capability for computers search engine, recommendation system, image recognition web click data, medical records , biology, engineering Natural Language Processing (NLP), Computer Vision Machine Learning definition Field of study that gives computers the ability to learn without being explicitly programmed. by ArthurSamuel(1959) 1. Supervised learning 2. Regression &amp; Classification 3. Unsupervised learning Unsupervised Examples What Google News does is everyday it goes and looks at tens of thousands or hundreds of thousands of new stories on the web and it groups them into cohesive news stories. 4. ExperienceXiaoyang è¯­å½• : ã€è§£å†³ä¸€ä¸ªé—®é¢˜çš„æ–¹æ³•å’Œæ€è·¯ä¸æ­¢ä¸€ç§ã€ã€æ²¡æœ‰æ‰€è°“çš„æœºå™¨å­¦ä¹ ç®—æ³•ä¼˜åŠ£ï¼Œä¹Ÿæ²¡æœ‰ç»å¯¹é«˜æ€§èƒ½çš„æœºå™¨å­¦ä¹ ç®—æ³•ï¼Œåªæœ‰åœ¨ç‰¹å®šçš„åœºæ™¯ã€æ•°æ®å’Œç‰¹å¾ä¸‹æ›´åˆé€‚çš„æœºå™¨å­¦ä¹ ç®—æ³•ã€‚ã€ Andrew Ng è¯­å½• åº”ç”¨æœºå™¨å­¦ä¹ ï¼Œä¸è¦ä¸€ä¸Šæ¥å°±è¯•å›¾åšåˆ°å®Œç¾ï¼Œå…ˆluä¸€ä¸ªbaselineçš„modelå‡ºæ¥ï¼Œå†è¿›è¡Œåç»­çš„åˆ†ææ­¥éª¤ï¼Œä¸€æ­¥æ­¥æé«˜ï¼Œæ‰€è°“åç»­æ­¥éª¤å¯èƒ½åŒ…æ‹¬ã€åˆ†æmodelç°åœ¨çš„çŠ¶æ€(æ¬ /è¿‡æ‹Ÿåˆ)ï¼Œåˆ†ææˆ‘ä»¬ä½¿ç”¨çš„featureçš„ä½œç”¨å¤§å°ï¼Œè¿›è¡Œfeature selectionï¼Œä»¥åŠæˆ‘ä»¬æ¨¡å‹ä¸‹çš„bad caseå’Œäº§ç”Ÿçš„åŸå› ã€ç­‰ç­‰ã€‚ Kaggleå¤§ç¥ä»¬ experience æ€»ç»“ ï¼š ã€å¯¹æ•°æ®çš„è®¤è¯†å¤ªé‡è¦äº†ï¼ã€ ã€æ•°æ®ä¸­çš„ç‰¹æ®Šç‚¹/ç¦»ç¾¤ç‚¹çš„åˆ†æå’Œå¤„ç†å¤ªé‡è¦äº†ï¼ã€ ã€ç‰¹å¾å·¥ç¨‹(feature engineering)å¤ªé‡è¦äº†ï¼åœ¨å¾ˆå¤šKaggleçš„åœºæ™¯ä¸‹ï¼Œç”šè‡³æ¯”modelæœ¬èº«è¿˜è¦é‡è¦ã€ ã€è¦åšæ¨¡å‹èåˆ(model ensemble)å•Šå•Šå•Šï¼ã€","categories":[{"name":"machine-learning","slug":"machine-learning","permalink":"http://iequa.com/categories/machine-learning/"}],"tags":[{"name":"machine-learning","slug":"machine-learning","permalink":"http://iequa.com/tags/machine-learning/"}]},{"title":"Javaç¨‹åºå‘˜éœ€è¦çŸ¥é“çš„è®¡ç®—æœºåŸç† (not finish)","slug":"java/java-special-arms-p2-computer-principle","date":"2016-09-13T08:54:16.000Z","updated":"2019-10-20T04:30:35.029Z","comments":true,"path":"2016/09/13/java/java-special-arms-p2-computer-principle/","link":"","permalink":"http://iequa.com/2016/09/13/java/java-special-arms-p2-computer-principle/","excerpt":"Javaç‰¹ç§å…µ - Javaç¨‹åºå‘˜éœ€è¦çŸ¥é“çš„è®¡ç®—æœºåŸç†ï¼ŒReading Notes","text":"Javaç‰¹ç§å…µ - Javaç¨‹åºå‘˜éœ€è¦çŸ¥é“çš„è®¡ç®—æœºåŸç†ï¼ŒReading Notes 1. è®¡ç®—æœºåŸç†è®¡ç®—æœºæ€»ä½“ä½“ç³»ç»“æ„çš„å˜åŒ–ï¼Œä¸€ç›´ä¸æ˜¯ç‰¹åˆ«å¤§ï¼ŒåŸºç¡€åŸç†å°†å¼•å¯¼æˆ‘ä»¬ä»æ•´ä½“ä¸Šè®¤è¯†è®¡ç®—æœºæœ¬èº«ã€‚ 2. CPUæ¯ä¸ªè¿›ç¨‹ or çº¿ç¨‹ å‘å‡ºè¯·æ±‚, æœ€åä¼šç”± CPU æ¥åˆ†é…æ—¶é—´ç‰‡å¤„ç†ï¼Œå¤„ç†æ—¶ æ“ä½œæ•° ä¼ é€’ç»™ CPU, CPU è®¡ç®—å°†å…¶å›å†™åˆ°æœ¬åœ°å˜é‡ã€‚è¿™ä¸ªæœ¬åœ°å˜é‡é€šå¸¸ä¼šå­˜åœ¨ç¨‹åºæ‰€è°“çš„ æ ˆ ä¸­ï¼Œå¤šæ¬¡å¯¹å…¶æ“ä½œï¼Œå®ƒå¯èƒ½ä¼šè¢« Cache åˆ° CPU çš„ç¼“å­˜ä¹‹ä¸­ã€‚CPU æœ‰ å¯„å­˜å™¨ï¼Œä¸€çº§ç¼“å­˜ï¼ŒäºŒçº§ç¼“å­˜ â€¦ , å…¶å®è®¾è®¡è¿™äº›ç»„ä»¶å°±æ˜¯ä¸ºäº†é‚£å››ä¸ªå­— å°±è¿‘åŸåˆ™ã€‚ 2.1 Cpu è”ç³» Java åœ¨ ç¼–è¯‘é˜¶æ®µï¼ŒJava å°±å¯ä»¥å†³å®šæ–¹æ³•çš„ LocalVariable çš„ä¸ªæ•°ï¼Œåœ¨æ–¹æ³•è°ƒç”¨çš„æ—¶å€™ï¼Œå°±å¯ç›´æ¥åˆ†é…ä¸€ä¸ª LocalVariable åŒºåŸŸï¼Œè¿™ä¸ªç©ºé—´æ˜¯åŸºäº slot æ¥åˆ†é…çš„ï¼Œæ¯ä¸ª slot å ç”¨ 32 bitï¼Œboolean å ç”¨ 1 slotï¼Œlong and double å  2 ä¸ª slotã€‚ LocalVariableTable : Start Length Slot Name Signature 0 9 0 args Ljava/lang/String; 2 7 1 a I .. .. .. .. .. Start : ä»£è¡¨LocalVariableåœ¨è™šæŒ‡ä»¤ä½œç”¨åŸŸçš„èµ·å§‹ä½ç½® Length : ä»£è¡¨LocalVariableåœ¨è™šæŒ‡ä»¤ä½œç”¨åŸŸçš„é•¿åº¦(å¦‚ç¬¬1ä¸ªæœ¬åœ°å˜é‡argsæ˜¯9æ¡æŒ‡ä»¤çš„ä½œç”¨åŸŸ) 2.2 å¤šæ ¸ä¸ºäº†å¤šä¸ªè®¡ç®—ä¸­å¿ƒåŒæ—¶åšäº‹æƒ…ï¼Œå¢åŠ æ•ˆç‡ã€‚ è€ƒè™‘éœ€è¦å’Œè§£å†³çš„é—®é¢˜ ä¸€ä¸ªæŒ‡ä»¤æ¥äº†ï¼Œå“ªä¸ªCpuæ¥å¤„ç†ï¼Ÿ åŒä¸€ä»½æ•°æ®è¢«å¤šä¸ª Cpu å¤„ç†ï¼Œå¦‚ä½•åè°ƒå¹¶è®©å…¶ä»–Cpuéƒ½çŸ¥é“ã€‚ å½“å‘èµ·ä¸€ä¸ªè®¡ç®—è¯·æ±‚ï¼Œä¾‹å¦‚ä¸€ä¸ªä¸­æ–­ï¼Œè¿™ä¹ˆå¤š Cpu ä¼šå¹²ä»€ä¹ˆï¼Ÿ ä¸­æ–­ : æŒ‡å½“å‡ºç°éœ€è¦æ—¶ï¼ŒCPUæš‚æ—¶åœæ­¢å½“å‰ç¨‹åºçš„æ‰§è¡Œè½¬è€Œæ‰§è¡Œå¤„ç†æ–°æƒ…å†µçš„ç¨‹åºå’Œæ‰§è¡Œè¿‡ç¨‹ã€‚ Cpu çš„è®¡ç®—é€Ÿåº¦éå¸¸å¿«ï¼ŒOSä¸å¸Œæœ›å®ƒç­‰å¾…æˆ–è€…åœæ­¢ï¼Œæ‰€ä»¥åœ¨å‡ºç° I/O ç­‰å¾… (ç½‘ç»œI/O å’Œ ç£ç›˜I/O), å®ƒä¸­é€”åŸºæœ¬ä¸å‚ä¸ï¼Œè€Œä»¥äº‹ä»¶æ³¨å†Œçš„æ–¹å¼æ¥å®ç°å›è°ƒï¼Œå¯¹äºæŸäº›æ‰§è¡Œæ—¶é—´é•¿çš„taskï¼ŒCpuä¼šåˆ†é…ä¸€äº›æ—¶é—´ç‰‡æ‰§è¡Œå…¶ä»–çš„task. å½“ Cpu ä¸æ–­å»åˆ‡æ¢ task å¤„ç†æ—¶ï¼Œè¿™å°±ä¼šæ¶‰åŠåˆ° ä¸Šä¸‹æ–‡åˆ‡æ¢. 2.3 Cache lineåŠäº‹å°±è¿‘åŸåˆ™ï¼Œå¯ä»¥ä¸€æ¬¡åŠå¤šä»¶äº‹æƒ… æˆ– ä¸€ä»¶äº‹æƒ…çš„å¤šä¸ªæ­¥éª¤å¯ä»¥ä¸€æ¬¡åŠå®Œã€‚ Cache line å°±æ˜¯ å°† è¿ç»­çš„ä¸€æ®µå†…å­˜åŒºåŸŸ è¿›è¡Œ Cacheï¼Œä¸æ˜¯æ¯æ¬¡å°± Cache ä¸€ä¸ªå†…å­˜å•å…ƒï¼Œè€Œæ˜¯ä¸€ç³»åˆ—å†…å­˜å•å…ƒã€‚è®¡ç®—æœºä¸­ï¼Œé€šå¸¸ä»¥è¿ç»­ 64bit è¿›è¡ŒCacheã€‚ æ„Ÿæ‚Ÿ : Cache Line å°±æ˜¯ ä¸€æ¬¡æ‹¿ä¸€æ‰¹ä¿¡æ¯å»å¤„ç†ã€‚ Cache line çš„ç›®çš„æ˜¯ä¸ºäº† å¿«é€Ÿè®¿é—®ã€‚ 2.4 ç¼“å­˜ä¸€è‡´æ€§åè®®å½“æœ‰ æ¥è‡ªäº å†…å­˜ ä¸­çš„åŒä¸€ä»½æ•°æ® Cache åœ¨å¤šä¸ª CPU ä¸­ï¼Œä¸”è¦æ±‚è¿™äº›æ•°æ®çš„è¯»å†™ä¸€è‡´æ—¶ï¼Œå¤šä¸ª CPU ä¹‹é—´å°±éœ€è¦éµå¾ªç¼“å­˜å…±äº«çš„ä¸€è‡´æ€§åŸåˆ™ã€‚ ç›¸å½“äºå¤§å®¶éƒ½æ¥ä¿®æ”¹ä¸€ä»½è®¾è®¡æŠ¥å‘Šï¼Œå¤§å®¶éƒ½æ‹·è´äº†ä¸€ä»½ï¼Œå›å®¶ä¿®æ”¹ï¼Œæ¯ä¸ªäººä¿®æ”¹è¦åŠæ—¶è®©å…¶ä»–äººéƒ½çŸ¥é“ã€‚æœ‰ç‚¹åƒç‰ˆæœ¬æ§åˆ¶ å†…å­˜å•å…ƒçš„çŠ¶æ€ Modified ä¿®æ”¹ Exclusive ç‹¬å  Shared å…±äº« Invalid å¤±æ•ˆ å¤šä¸ª CPU é€šè¿‡æ€»çº¿ç›¸äº’è¿æ¥ï¼Œæ¯ä¸ª CPU çš„cacheå¤„ç†å™¨ è¦å“åº”æœ¬èº«æ‰€å¯¹åº”çš„CPUè¯»å†™æ“ä½œå¤–ï¼Œè¿˜éœ€è¦ç›‘å¬æ€»çº¿ä¸Šå…¶ä»–CPUæ“ä½œï¼Œé€šè¿‡ç›‘å¬å¯¹è‡ªå·±çš„Cacheåšå¤„ç†ï¼Œå½¢æˆè™šå…±äº«ï¼Œè¿™ä¸ªåè®®å«åš MESI åè®®ã€‚ ä¸€ä¸ªæ•°æ®ä¿®æ”¹äº†ï¼Œå®ƒéœ€è¦å‘Šè¯‰å…¶ä»– CPU è¿™ä»½æ•°æ®è¢«ä¿®æ”¹äº†ï¼Œç°åœ¨Intelé€šè¿‡ QPI æ¥å®Œæˆã€‚ä¸åŒCPUä¹‹é—´äº¤äº’éœ€è¦æ—¶é—´ 20~40 ns çº§åˆ«ã€‚ class VolatileInteger &#123; volatile int number;&#125;VolatileInteger[] values = new VolatileInteger[10];for (int i = 0; i &lt; 10; i++) &#123; values[i] = new VolatileInteger();&#125; è¿™æ®µä»£ç çš„ä¾‹å­ï¼Œå¾ˆå¯èƒ½ä½¿çš„æ¯ä¸ªCPUå¯èƒ½åªä¿®æ”¹åˆ°æŸä¸ªå…ƒç´ ï¼Œä½†ä¼šæœ‰å¤§é‡ QPI å­˜åœ¨ã€‚ QPI : Quick Path Interconnect 2.5 Context switchçº¿ç¨‹å·²ç»æ‰§è¡Œäº†ä¸€éƒ¨åˆ†å†…å®¹ï¼Œéœ€è¦è®°å½•ä¸‹å®ƒçš„å†…å®¹å’ŒçŠ¶æ€ï¼Œä¸­é€”ç”±äºè°ƒåº¦ç®—æ³•ã€‚ CPU è°ƒåº¦ çš„æœ€åŸºæœ¬å•ä½æ˜¯çº¿ç¨‹ï¼ŒJavaä¹Ÿæ˜¯åŸºäºå¤šçº¿ç¨‹æ¨¡å¼ã€‚ç”±äºå¤šçº¿ç¨‹æ¨¡å‹ä¸­å¤šä¸ªçº¿ç¨‹å…±äº«è¿›ç¨‹çš„èµ„æºï¼Œæ‰€ä»¥Javaç¨‹åºï¼Œå¦‚æŸä¸€ä¸ªçº¿ç¨‹å ç”¨èµ„æºè¿‡å¤§æ—¶ï¼Œå°±å¯èƒ½å¯¼è‡´æ•´ä¸ªJVMè¿›ç¨‹æŒ‚æ‰ã€‚(å½±å“éƒ½æ˜¯ç›¸å¯¹çš„) åœ¨å®é™…è¿è¡Œä¸­ä¼šæœ‰ä»£ç æ®µå’Œæ•°æ®æ®µï¼Œå†…å®¹åˆ‡æ¢æ—¶è¦ä¿å­˜è¿™äº›è¿è¡Œä¸­çš„ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼Œå†ä½¿ç”¨çš„æ—¶å€™ï¼Œå†åŠ è½½å›æ¥ã€‚ æ—¥å¿—å†™æ“ä½œ (å¦‚ : log4j) éƒ½é‡‡ç”¨ å¼‚æ­¥ æ¨¡å¼ å®ç°ï¼Œè€Œç¨‹åºé€šå¸¸ä¸ç›´æ¥å‚ä¸è¿™ä¸ªè¿‡ç¨‹ã€‚ å®ç°æ–¹å¼ (æ—¥å¿—å†™æ“ä½œåªæ˜¯å°†æ—¥å¿—å†™å…¥ä¸€ä¸ªæ¶ˆæ¯é˜Ÿåˆ—ä¸­ï¼Œç”±å•ç‹¬çš„çº¿ç¨‹æ¥å®Œæˆå†™æ“ä½œ) 2.6 å¹¶å‘ä¸äº‰ç”¨åªè¦æ˜¯æœåŠ¡å™¨ç«¯ç¨‹åºï¼Œè¿Ÿæ—©ä¼šé‡åˆ°å¹¶å‘ã€‚å½“ å¹¶å‘ æ—¶ï¼Œå°±ä¼šå­˜åœ¨å¯¹å„ç§èµ„æºçš„äº‰ç”¨ï¼ŒåŒ…æ‹¬å¯¹å„ä¸ªéƒ¨ä»¶(å¦‚CPU)çš„äº‰ç”¨ã€‚ Web ç¨‹åºä¹Ÿä¼šç»å¸¸é‡åˆ°å¹¶å‘é—®é¢˜çš„ï¼Œç¼–å†™è€…ï¼Œæ²¡æœ‰é‡åˆ°æ˜¯å› ä¸º Web å®¹å™¨å¸®åŠ©å¤„ç†å¥½äº†çº¿ç¨‹çš„æœ¬åœ°å˜é‡åˆ†é…ï¼Œæˆ‘ä»¬å‡ ä¹ä¸ç”¨å…³æ³¨å¹¶å‘ã€‚ 2.6.1 ä¸´ç•ŒåŒº å½“ç¨‹åºå‡ºç° â€œåŠ é”â€ æ—¶ (å¦‚ Javaçš„ synchronized) è¯´æ˜è¿™ä¸€å—æ˜¯ä¸´ç•ŒåŒºï¼Œåªå…è®¸ä¸€ä¸ªçº¿ç¨‹è®¿é—®ï¼Œå…¶ä»–çº¿ç¨‹æ¥å›è¿›è¡Œç­‰å¾…é˜Ÿåˆ—ã€‚äº‰ç”¨å¸¦æ¥çš„æ˜¯åŒæ­¥çš„å¼€é”€ï¼Œå®ƒä¼šå‘å‡ºè®¸å¤šæŒ‡ä»¤è¦æ±‚æ‰€æœ‰CPUå¤„ç†ä¸­ä¸å…è®¸å…¶ä»–çº¿ç¨‹è¿›å…¥ä¸´ç•ŒåŒºï¼Œä¸”éœ€è¦å°†ç­‰å¾…çº¿ç¨‹æ”¾å…¥é˜Ÿåˆ—é˜»å¡ã€‚äº‰ç”¨ CPU çš„è®¿é—®ä¹Ÿä¸ä»…ä»…ä½“ç°åœ¨é”ä¸Šé¢ï¼ŒCPUæœ¬èº«æ•°é‡ä¹Ÿæœ‰é™ã€‚ å•ä¸ªCPUä¼šå¯¹ä»»åŠ¡è¿›è¡Œ åŸºäº æ—¶é—´ç‰‡ã€ä¼˜å…ˆçº§ã€ä»»åŠ¡å¤§å°åˆ†åˆ«è°ƒåº¦ã€‚ 2.6.2 çº¿ç¨‹æ± æ•°åœ¨ç†æƒ³çš„ CPU å¯†é›†å‹ç³»ç»Ÿï¼Œçº¿ç¨‹æ•°æ˜¯ CPUæ•°+1 / CPU-1 ç³»ç»ŸCPUå¯†é›†åº¦ ä¸€èˆ¬ç³»ç»Ÿåˆ†ä¸º è®¡ç®—å¯†é›†å‹ å’Œ I/O å¯†é›†å‹ã€‚ ç³»ç»Ÿä¸­å…³é”®ç¨‹åºè®¿é—®æ€»å…±èŠ±è´¹ 120ms, I/Oæ“ä½œ å ç”¨ 100msï¼Œ100msæ—¶é—´å†… CPUæ˜¯å¯ä»¥è¢«å…¶ä»–çº¿ç¨‹è®¿é—®çš„ã€‚æ­¤æ—¶ï¼Œè¿™ä¸ªç¨‹åºåœ¨å•æ ¸ç³»ç»Ÿä¸­çš„çº¿ç¨‹æ•°ç†è®ºä¸Šå¯ä»¥è®¾ç½®ä¸º 6ï¼Œ åœ¨å¤šæ ¸ç³»ç»Ÿå°±æ˜¯ä¹˜ä»¥CPUä¸ªæ•° å·¦å³è¿™ä¸ªæ•°å­—ã€‚ ä¸€èˆ¬è¿™ä¸ªçº¿ç¨‹æ•°çš„å†³å®šæ˜¯é€šè¿‡æµ‹è¯•çš„ã€‚ 2.6.3 é”é” å°±æ˜¯ä¸´ç•ŒåŒºçš„èŒƒå›´ï¼Œæœ‰ç²’åº¦ã€‚å¦‚æœåœ¨ é” å†…éƒ¨å‘é€ I/O, å¤§å¾ªç¯ã€é€’å½’ç­‰ï¼Œé‚£ä¹ˆå°±å¿…é¡»ç­‰å¾…è¿™äº›æ“ä½œå¤„ç†å®Œæˆåæ‰èƒ½æœ‰ä¸‹ä¸€ä¸ªçº¿ç¨‹è¿›å…¥å¤„ç†ã€‚å¦‚æœè¿™æ®µç¨‹åºæ˜¯ å…³é”®ç¨‹åº, å½“ç³»ç»ŸçœŸæ­£å¹¶å‘çš„æ—¶å€™ï¼Œå¾ˆå¤šçº¿ç¨‹éƒ½ä¼šé˜»å¡åœ¨è¿™é‡Œã€‚è¿™æ—¶è¦è®¡ç®—çº¿ç¨‹æ•°ï¼Œè¦çœ‹é”å¯¹è±¡ æ˜¯ä¸æ˜¯é™æ€å¯¹è±¡æˆ–Class, (å¦‚æœæ˜¯ï¼Œåˆ™æ˜¯ä¸€ä¸ªJVMå…¨å±€é”)ï¼Œæ— è®ºé…ç½®å¤šå°‘çº¿ç¨‹æ•ˆæœéƒ½ä¸€æ ·ã€‚é”æ˜¯å…¨å±€çš„ï¼Œæ— è®ºå¤šå°‘ä¸ªCPUä¹Ÿæ˜¯æ— æµäºäº‹çš„ã€‚ ç»“è®º : é”å°½é‡ä¸è¦è®¾ç½®ä¸º å…¨å±€é”ï¼Œèƒ½ç”¨ç²’åº¦æ§åˆ¶ï¼Œå°½é‡ç²’åº¦æ§åˆ¶ 2.6.4 JVMè‡ªèº«è°ƒèŠ‚ä¸è®º CPU è·‘å¤šå¿«ï¼Œå¦‚ JVM holdä¸ä½èŠ‚å¥ï¼Œä¸æ–­åšGCï¼Œé‚£ä¹ˆå¦‚ä½•é…ç½®çº¿ç¨‹æ± ï¼Œç³»ç»Ÿæ€§èƒ½è¿˜æ˜¯ä¸Šä¸æ¥ã€‚ å¯ä»¥æ ¹æ® JVM è¿è¡Œæ—¥å¿—ä¸­ï¼Œå¹³å‡åš Young GC çš„æ—¶é—´é—´éš” (é€šè¿‡ Young GC ä¸ è¿è¡Œæ—¶é•¿å¯¹æ¯”)ï¼Œä»¥åŠç³»ç»Ÿçš„QPSï¼Œæ¥ä¼°ç®—æ¯ä¸ªè¯·æ±‚å¤§è‡´å ç”¨çš„å†…å­˜å¤§å°ï¼Œæœ‰æ—¶ä¸å‡†ï¼Œä½†å…·æœ‰å‚è€ƒä»·å€¼ã€‚ å¦‚ä½•è®¡ç®— Eden ç©ºé—´çš„å¤§å°æˆ‘ä»¬æ˜¯çŸ¥é“çš„ã€‚é€šå¸¸ä¸€ä¸ªè¯·æ±‚åˆ†é…ç©ºé—´éƒ½åœ¨ Eden åŒºåŸŸï¼ŒEdenåŒºåŸŸæ»¡å‘ç”ŸYoung GCã€‚Young GC æ—¶é—´é—´éš”å°±æ˜¯Edenæ»¡çš„æ—¶é—´é—´éš”ï¼Œä¾‹å¦‚ 3sï¼Œ è¿›ä¸€æ­¥é€šè¿‡ QPS*3 å¾—åˆ°å¤šå°‘ä¸ªè¯·æ±‚å¯ä»¥å¡«å……æ»¡ Eden åŒºåŸŸã€‚è¿™å¯åˆæ­¥ä¼°ç®—æ¯ä¸ªè¯·æ±‚å ç”¨çš„å†…å­˜ç©ºé—´ã€‚ 3. å†…å­˜åŸºæœ¬æ‰€æœ‰çš„ç¨‹åºçŒ¿ä¸ç¨‹åºåª›éƒ½çŸ¥é“ï¼Œå®ƒæ˜¯è·‘ç¨‹åºçš„åœ°æ–¹ã€‚ ç£ç›˜å­˜å‚¨ ä¸ CPU ä¹‹é—´çš„æ¡¥æ¢ã€‚æ‹¥æœ‰æ¯” CPUç¼“å­˜ å¤§å‡ ç™¾å€ã€ä¸Šåƒå€çš„ç©ºé—´ã€‚CPUä¸‰çº§ç¼“å­˜ä¹Ÿå°± å‡ åMã€‚ ç£ç›˜ åˆ°è¾¾ CPUéœ€è¦ç»è¿‡ (ä¸»æ¿-å—æ¡¥ã€åŒ—æ¡¥) æ‰èƒ½åˆ°è¾¾CPUã€‚å¾ˆæ…¢ã€‚ å†…å­˜çš„å®¹é‡éƒ½æ˜¯ GB å•ä½ï¼Œå¤§é‡ç¨‹åºè¿è¡Œéƒ½ä¾èµ–å†…å­˜ï¼Œåˆ OS æ¥ç®¡ç†å’Œè°ƒåº¦ã€‚ åœ°å€ä½æ•°ã€é€»è¾‘åœ°å€ã€è™šæ‹Ÿåœ°å€ã€ç‰©ç†åœ°å€ã€çº¿æ€§åœ°å€ã€å†…æ ¸åŒºåŸŸç­‰ï¼Œå¾ˆå¤šäººçœ‹åˆ°è¿™ï¼Œç›´æ¥ç–¯äº†ï¼Œä½†æ˜¯ä½ éœ€è¦æ·¡å®šã€‚ 3.1 è™šæ‹Ÿåœ°å€æ‰€æœ‰çš„ç¨‹åºä¸­ä½¿ç”¨çš„åœ°å€éƒ½æ˜¯è™šæ‹Ÿåœ°å€ (åœ¨æ®µå¼ç®¡ç†ä¸­ä¹Ÿå«é€»è¾‘åœ°å€)ï¼Œè¿™äº›åœ°å€åœ¨ä¸åŒçš„è¿›ç¨‹ä¹‹é—´æ˜¯å¯ä»¥é‡å¤çš„ã€‚ ç¨‹åºä¸ºä»€ä¹ˆè¦ä½¿ç”¨ è™šæ‹Ÿåœ°å€? Cè¯­è¨€æ¥è¯´ï¼Œç¼–è¯‘åçš„æŒ‡ä»¤ä¸­ï¼Œè®¸å¤šè°ƒç”¨çš„åœ°å€åœ¨ç¼–è¯‘é˜¶æ®µå°±å¾—ç¡®å®šä¸‹æ¥ï¼Œè®¸å¤šæ–¹æ³•å…¥å£å’Œå˜é‡ä½ç½®åœ¨ç¼–è¯‘æ—¶ç¡®å®šäº†è™šæ‹Ÿåœ°å€ï¼ŒçœŸæ­£è¿è¡Œæ—¶è¦ç”±OSæ¥åˆ†é…å®é™…çš„åœ°å€ç»™ç¨‹åºã€‚ä½¿ç”¨è™šæ‹Ÿåœ°å€åï¼Œåœ°å€æ˜¯å¯ä»¥è¢«å¤ç”¨çš„ï¼Œç¨‹åºä¸å…³å¿ƒä¸å…¶ä»–è¿›ç¨‹æ˜¯å¦ä¼šä½¿ç”¨åŒä¸€åœ°å€ï¼ŒOSä¼šåˆ†é…ç¡®ä¿ã€‚ 3.2 åˆ†æ®µæœºåˆ¶ä¹Ÿå°±æ˜¯ä¸ºè¿›ç¨‹åˆ†é…çš„ä¸€æ®µå†…å­˜åŒº (è¿ç»­çš„åŒºåŸŸ)ï¼Œå®ƒçš„ èµ·å§‹ä½ç½® + é€»è¾‘åœ°å€ = çº¿æ€§åœ°å€ (å°±æ˜¯ç‰©ç†åœ°å€) æœ¬è¿›ç¨‹è®¿é—®å…¶ä»–è¿›ç¨‹å†…å­˜ï¼Œå†…å­˜ä¸èƒ½read é”™è¯¯ã€‚ 3.3 åˆ†é¡µæœºåˆ¶åˆ†é¡µæœºåˆ¶ å¯æ”¯æ’‘è¾ƒå¤§çš„å†…å­˜ï¼Œç‰©ç†ä¸Šå¤§å¤šå°†å…¶åˆ’åˆ†ä¸º 4KB/é¡µ 3.4 Java HeapJavaè¯­è¨€ï¼Œä¸»è¦çœ‹ Heap åŒºåŸŸï¼Œç³»ç»Ÿå‚æ•°è®¾ç½®ä¸º -Xms, -Xmx æ—¶ï¼ŒJVM é€šå¸¸æ˜¯ç”³è¯·ä¸€ä¸ªè¿ç»­çš„è™šæ‹Ÿåœ°å€ã€‚OSé¢„å…ˆåˆ†é…çš„ç‰©ç†å†…å­˜ç©ºé—´æ˜¯ -Xms çš„å¤§å°ï¼Œ -Xmx è®¸å¤šç©ºé—´çœŸæ­£ä½¿ç”¨çš„æ—¶å€™æ‰ä¼šåˆ†é…ã€‚ 32 bit ç³»ç»Ÿä¸­ï¼Œ1.5GB çš„ Heap åŒºåŸŸæ˜¯æ¯”è¾ƒåˆé€‚çš„ã€‚64bit ç©ºé—´ä¸ä¼šå—åˆ°é™åˆ¶ (JVMä¹Ÿå¿…é¡»æ¢æˆ64bitæ¨¡å¼) 4. Diskdisk ä¸€ç›´åœ¨æ‹–ç€è®¡ç®—æœºçš„åè…¿, SSDå¥½ä¸€äº›. 5. CacheCPU æœ‰ cacheï¼Œç³»ç»Ÿæ¶æ„æœ‰ cacheï¼Œå­˜å‚¨ä¸Šæœ‰cacheï¼Œåˆ†å¸ƒå¼ä¸Šæœ‰ cacheï¼Œæ•°æ®åº“ä¸Šæœ‰cacheï¼ŒORMæ¡†æ¶ä¸Šæœ‰cache â€¦ Cache å°±æ˜¯ é è¿‘åŸåˆ™ 6. ç½‘ç»œä¸æ•°æ®åº“6.1 Java åŸºæœ¬ IOåªè¦æ˜¯å†…å­˜ç¨‹åºçš„é€šä¿¡ï¼Œéƒ½å¯ä»¥ç†è§£ä¸º Input / Output","categories":[{"name":"java","slug":"java","permalink":"http://iequa.com/categories/java/"}],"tags":[{"name":"java","slug":"java","permalink":"http://iequa.com/tags/java/"}]},{"title":"SpringMVC Demo","slug":"java/java-springMVC-mybatis-demo","date":"2016-09-10T23:54:16.000Z","updated":"2019-10-20T04:30:35.030Z","comments":true,"path":"2016/09/11/java/java-springMVC-mybatis-demo/","link":"","permalink":"http://iequa.com/2016/09/11/java/java-springMVC-mybatis-demo/","excerpt":"å†™ä¸€ä¸ªå…¥é—¨æ•´æ´çš„ç¼–å†™ java åç«¯ç¨‹åºçš„ä»£ç æ¶, ä¸»è¦ä½¿ç”¨äº† java + springMvc + mybatis + logback + spring task ç­‰æŠ€æœ¯. blairâ€™s github springMvc_demo","text":"å†™ä¸€ä¸ªå…¥é—¨æ•´æ´çš„ç¼–å†™ java åç«¯ç¨‹åºçš„ä»£ç æ¶, ä¸»è¦ä½¿ç”¨äº† java + springMvc + mybatis + logback + spring task ç­‰æŠ€æœ¯. blairâ€™s github springMvc_demo Starting Pointä¸ºä¸€äº›æ–°æ‰‹å’Œæˆ‘ä¸ªäººå¤‡ä»½ï¼Œå†™ä¸€ä¸ªå…¥é—¨æ•´æ´çš„ç¼–å†™ java åç«¯ç¨‹åºçš„ä»£ç æ¶. å†™è¿™æ ·çš„ç¨‹åºï¼Œæœ€é‡è¦çš„æ˜¯ æ•´æ´ä¸çº¦å®šè§„èŒƒ è€Œä¸æ˜¯å¤šä¹ˆé«˜æ·±çš„æŠ€æœ¯ï¼Œè®©æ¥æ‰‹ä½ ä»£ç çš„äººä¸ç—›è‹¦ï¼Œè¿™æ‰æ˜¯æˆåŠŸ Involved Tech Java Restful SpringMVC Mybatis logback Spring-task logback : ä¸€ä¸ªâ€œå¯é ã€é€šç”¨ã€å¿«é€Ÿè€Œåˆçµæ´»çš„Javaæ—¥å¿—æ¡†æ¶â€ã€‚Spring-task ç¼–å†™éwebç¨‹åºï¼Œä»…ä»…æ˜¯åå°éœ€è¦å®šæ—¶è·‘çš„ä»»åŠ¡ï¼Œç»å¸¸è¢«ç”¨åˆ°ã€‚ How to Run1. ä¿®æ”¹æ•°æ®åº“è¿æ¥ä¿¡æ¯ç¼–è¾‘ ~/resources/props/db.properties å°†å…¶ä¸­çš„ # main mysql lib dataSourcemain.jdbc.driverClassName=com.mysql.jdbc.Drivermain.jdbc.url=jdbc:mysql://192.168.***.**:3306/testdb01main.jdbc.username=your_usernamemain.jdbc.password=your_password æ”¹ä¸ºä½ è‡ªå·±çš„ dataSource è¿æ¥ä¿¡æ¯ 2. æ•°æ®åº“ä¸­å»ºç«‹ä½ ç”¨åˆ°çš„è¡¨å‚è§è¯­å¥ ~/resources/sql/projects.sql åœ¨ä½ çš„ æ•°æ®åº“ ä¸­æ‰§è¡Œå…¶ä¸­è¯­å¥ï¼Œå»ºç«‹ table user. 3. ç¡®è®¤éœ€è¦çš„ç¯å¢ƒå·²å‡†å¤‡å¥½ ç¡®è®¤ ~/resources/logback.xml ä¸­ï¼Œæ—¥å¿—çš„æ‰“å°è·¯å¾„ï¼Œæ˜¯å¦é€‚åˆä½ çš„ç¯å¢ƒæˆ‘è¿™é‡Œæ˜¯ /data0/www/logs/ ï¼Œ å¦‚æœ‰éœ€è¦æ”¹å˜ï¼Œè¯·è‡ªè¡Œæ›´æ”¹ã€‚ï¼ˆå¦‚æœä¸º windows ç¯å¢ƒï¼Œè¯·æ³¨æ„è·¯å¾„æ˜¯å¦æ­£ç¡®ï¼‰ 4. ç¼–è¯‘-æ‰“åŒ…-å¯åŠ¨jettyâœ github lltotal 0drwxr-xr-x 13 hp staff 442 Sep 10 14:03 language/âœ github cd language/java/springMVC_demoâœ springMVC_demo git:(master) âœ— lltotal 24-rw-r--r-- 1 hp staff 665 Sep 11 15:52 README.md-rw-r--r-- 1 hp staff 10712 Sep 11 15:10 pom.xmldrwxr-xr-x 4 hp staff 136 Sep 10 13:30 src/âœ springMVC_demo git:(master) âœ— mvn cleanâœ springMVC_demo git:(master) âœ— mvn compileâœ springMVC_demo git:(master) âœ— mvn clean packageâœ springMVC_demo git:(master) âœ— mvn jetty:run[INFO] Scanning for projects...[INFO][INFO] ------------------------------------------------------------------------[INFO] Building x_demo Maven Webapp 1.0-SNAPSHOT[INFO] ------------------------------------------------------------------------[INFO] FrameworkServlet &#x27;mvc-dispatcher&#x27;: initialization completed in 572 ms[INFO] Started SelectChannelConnector@0.0.0.0:8080[INFO] Started Jetty Server[INFO] Starting scanner at interval of 5 seconds. å½“ç„¶ä½ ä¹Ÿå¯ä»¥é€šè¿‡ IDEA -&gt; Maven Projects -&gt; Plugins -&gt; jetty:run å¯åŠ¨ (æˆ–è€… Tomcat å¯åŠ¨) å¯åŠ¨æˆåŠŸåï¼Œè¿™æ—¶ä½ å¯ä»¥åœ¨ä½ çš„æµè§ˆå™¨åˆ†åˆ«è®¿é—®ä»¥ä¸‹æ¥å£ï¼ŒæŸ¥çœ‹æ•ˆæœäº† http://localhost:8080/http://localhost:8080/user/getusershttp://localhost:8080/user/addusershttp://localhost:8080/user/getusershttp://localhost:8080/user/getuser/2------http://localhost:8080/user/getuser/2&#123; &quot;status&quot;: 0, &quot;errmsg&quot;: &quot;success&quot;, &quot;data&quot;: &#123; &quot;id&quot;: 2, &quot;firstName&quot;: &quot;Andy&quot;, &quot;lastName&quot;: &quot;Wong&quot;, &quot;age&quot;: 31 &#125;&#125; åœ¨ä½ æµ‹è¯•çš„æ—¶å€™ï¼Œå¦‚æœä½ æƒ³åœ¨æµè§ˆå™¨ä¸­çœ‹åˆ°æ ¼å¼åŒ–åçš„jsonï¼Œè¯·è‡ªè¡Œå®‰è£… chrome ç›¸å…³çš„jsonæ’ä»¶ç­‰ã€‚ Desc å±•ç¤ºäº†å‰åç«¯å¼€å‘å¦‚ä½•ç”¨jsonè¿›è¡Œäº¤äº’çš„ä¸»æµæ–¹æ³•ï¼Œæ ‡å¿—çŠ¶æ€ä½ä¸é”™è¯¯ä¿¡æ¯ï¼Œè¿”å›ç»“æœå‘ˆç°ç»™å‰ç«¯ï¼Œç”¨ä¸€ä¸ª JsonResult ç±»æ¥å°è£…ï¼ŒåŒæ—¶åœ¨ web å±‚ï¼Œç”¨MappingJackson2HttpMessageConverter é…ç½®ï¼Œå¯è‡ªåŠ¨å°† Map\\ è½¬æ¢ä¸º json å‘ˆç°ç»™å‰ç«¯ç­‰ã€‚ ä»£ç ç¼–å†™æ¯”è¾ƒè§„èŒƒï¼Œç”¨äº†ä¸»æµæ—¥å¿—æ¡†æ¶ï¼Œå°† info ä¸ error æ—¥å¿—åˆ†å¼€æ‰“å°ï¼Œä¸åå¼‚å¸¸ã€‚åˆ†å±‚è§„èŒƒï¼Œè¿˜ç‰¹æ„å†™äº†ä¸¤ä¸ªæ•°æ®æºå¦‚ä½•é…ç½®çš„æ ·ä¾‹ç­‰ã€‚ DAO å±‚ä¸å†™å®ç°ï¼Œåªå†™æ¥å£ï¼Œç”¨ Mybatis æ¥æ‰¿æ¥ï¼Œç±»å¯¹è±¡ä¸æ•°æ®åº“è¡¨ ç›´æ¥è‡ªåŠ¨è½¬æ¢è¯†åˆ«ï¼ŒåŒ…å«äº† æ•°æ®åº“è¡¨å­—æ®µä¸‹åˆ’çº¿ä¸javaç±»å­—æ®µé©¼å³°æ ‡è¯† å¦‚ä½•åŒ¹é…ç­‰ã€‚ Attentions æ³¨æ„ï¼š ç‰ˆæœ¬æ§åˆ¶ä¸­ï¼Œæ¶‰åŠçš„æ•æ„Ÿ åº“åœ°å€ï¼Œç”¨æˆ·åï¼Œå¯†ç  ç­‰ ä¸ä¸Šä¼ . Reference blairâ€™s github springMVC_demo","categories":[{"name":"java","slug":"java","permalink":"http://iequa.com/categories/java/"}],"tags":[{"name":"spring","slug":"spring","permalink":"http://iequa.com/tags/spring/"}]},{"title":"Spark Machine Learning p3 - æ•°æ®çš„è·å–ã€å¤„ç†ä¸å‡†å¤‡","slug":"spark/spark-machine-learning-p3","date":"2016-09-09T08:07:21.000Z","updated":"2019-10-20T04:30:35.078Z","comments":true,"path":"2016/09/09/spark/spark-machine-learning-p3/","link":"","permalink":"http://iequa.com/2016/09/09/spark/spark-machine-learning-p3/","excerpt":"ã€ŠSpark Machine Learingã€‹ Reading Notes ï¼š Sparkä¸Šæ•°æ®çš„è·å–ã€å¤„ç†ä¸å‡†å¤‡","text":"ã€ŠSpark Machine Learingã€‹ Reading Notes ï¼š Sparkä¸Šæ•°æ®çš„è·å–ã€å¤„ç†ä¸å‡†å¤‡ MovieStream åŒ…æ‹¬ç½‘ç«™æä¾›çš„ç”µå½±æ•°æ®ã€ç”¨æˆ·çš„æœåŠ¡ä¿¡æ¯æ•°æ®ä»¥åŠè¡Œä¸ºæ•°æ®ã€‚ è¿™äº›æ•°æ®æ¶‰åŠç”µå½±å’Œç›¸å…³å†…å®¹ï¼ˆæ¯”å¦‚æ ‡é¢˜ã€åˆ†ç±»ã€å›¾ç‰‡ã€æ¼”å‘˜å’Œå¯¼æ¼”ï¼‰ã€ç”¨æˆ·ä¿¡æ¯ï¼ˆæ¯”å¦‚ç”¨æˆ·å±æ€§ã€ä½ç½®å’Œå…¶ä»–ä¿¡æ¯ï¼‰ä»¥åŠç”¨æˆ·æ´»åŠ¨æ•°æ®ï¼ˆæ¯”å¦‚æµè§ˆæ•°ã€é¢„è§ˆçš„æ ‡é¢˜å’Œæ¬¡æ•°ã€è¯„çº§ã€è¯„è®ºï¼Œä»¥åŠå¦‚èµã€åˆ†äº«ä¹‹ç±»çš„ç¤¾äº¤æ•°æ®ï¼Œè¿˜æœ‰åŒ…æ‹¬åƒFacebookå’ŒTwitterä¹‹ç±»çš„ç¤¾äº¤ç½‘ç»œå±æ€§ï¼‰ã€‚ å…¶å¤–éƒ¨æ•°æ®æ¥æºåˆ™å¯èƒ½åŒ…æ‹¬å¤©æ°”å’Œåœ°ç†å®šä½ä¿¡æ¯ï¼Œä»¥åŠå¦‚IMDBå’ŒRotten Tomatorsä¹‹ç±»çš„ç¬¬ä¸‰æ–¹ç”µå½±è¯„çº§ä¸è¯„è®ºä¿¡æ¯ç­‰ã€‚ ä¸€ä¸ªé¢„æµ‹ç²¾å‡†çš„å¥½æ¨¡å‹æœ‰ç€æé«˜çš„å•†ä¸šä»·å€¼ï¼ˆNetflix Prize å’Œ Kaggle ä¸Šæœºå™¨å­¦ä¹ æ¯”èµ›çš„æˆåŠŸå°±æ˜¯å¾ˆå¥½çš„è§è¯ï¼‰ focus on æ•°æ®çš„å¤„ç†ã€æ¸…ç†ã€æ¢ç´¢å’Œå¯è§†åŒ–æ–¹æ³•ï¼› åŸå§‹æ•°æ®è½¬æ¢ä¸ºå¯ç”¨äºæœºå™¨å­¦ä¹ ç®—æ³•ç‰¹å¾çš„å„ç§æŠ€æœ¯ï¼› å­¦ä¹ å¦‚ä½•ä½¿ç”¨å¤–éƒ¨åº“æˆ–Sparkå†…ç½®å‡½æ•°æ¥æ­£åˆ™åŒ–è¾“å…¥ç‰¹å¾. 1. è·å–å…¬å¼€æ•°æ®é›†UCLæœºå™¨å­¦ä¹ çŸ¥è¯†åº“ åŒ…æ‹¬è¿‘300ä¸ªä¸åŒå¤§å°å’Œç±»å‹çš„æ•°æ®é›†ï¼Œå¯ç”¨äºåˆ†ç±»ã€å›å½’ã€èšç±»å’Œæ¨èç³»ç»Ÿä»»åŠ¡ã€‚æ•°æ®é›†åˆ—è¡¨ä½äºï¼šhttp://archive.ics.uci.edu/ml/ã€‚ Amazon AWSå…¬å¼€æ•°æ®é›† åŒ…å«çš„é€šå¸¸æ˜¯å¤§å‹æ•°æ®é›†ï¼Œå¯é€šè¿‡Amazon S3è®¿é—®ã€‚è¿™äº›æ•°æ®é›†åŒ…æ‹¬äººç±»åŸºå› ç»„é¡¹ç›®ã€Common Crawlç½‘é¡µè¯­æ–™åº“ã€ç»´åŸºç™¾ç§‘æ•°æ®å’ŒGoogle Books Ngramsã€‚ç›¸å…³ä¿¡æ¯å¯å‚è§ï¼šhttp://aws.amazon.com/publicdatasets/ã€‚ Kaggle è¿™é‡Œé›†åˆäº†Kaggleä¸¾è¡Œçš„å„ç§æœºå™¨å­¦ä¹ ç«èµ›æ‰€ç”¨çš„æ•°æ®é›†ã€‚å®ƒä»¬è¦†ç›–åˆ†ç±»ã€å›å½’ã€æ’åã€æ¨èç³»ç»Ÿä»¥åŠå›¾åƒåˆ†æé¢†åŸŸï¼Œå¯ä»CompetitionsåŒºåŸŸä¸‹è½½ï¼šhttp://www.kaggle.com/competitionsã€‚ KDnuggets è¿™é‡ŒåŒ…å«ä¸€ä¸ªè¯¦ç»†çš„å…¬å¼€æ•°æ®é›†åˆ—è¡¨ï¼Œå…¶ä¸­ä¸€äº›ä¸Šé¢æåˆ°è¿‡çš„ã€‚è¯¥åˆ—è¡¨ä½äºï¼šhttp://www.kdnuggets.com/datasets/index.htmlã€‚ MovieLens 100kæ•°æ®é›† MovieLens 100kæ•°æ®é›†åŒ…å«è¡¨ç¤ºå¤šä¸ªç”¨æˆ·å¯¹å¤šéƒ¨ç”µå½±çš„10ä¸‡æ¬¡è¯„çº§æ•°æ®ï¼Œä¹ŸåŒ…å«ç”µå½±å…ƒæ•°æ®å’Œç”¨æˆ·å±æ€§ä¿¡æ¯ http://files.grouplens.org/datasets/movielens/ml-100k.zip ml-100k/ u.userï¼ˆç”¨æˆ·å±æ€§æ–‡ä»¶ï¼‰ã€u.itemï¼ˆç”µå½±å…ƒæ•°æ®ï¼‰å’Œu.dataï¼ˆç”¨æˆ·å¯¹ç”µå½±çš„è¯„çº§ï¼‰ &gt;unzip ml-100k.zip inflating: ml-100k/allbut.pl inflating: ml-100k/mku.sh inflating: ml-100k/README ... inflating: ml-100k/ub.base inflating: ml-100k/ub.test u.user user.idã€ageã€genderã€occupationã€ZIP code &gt;head -5 u.user 1|24|M|technician|85711 2|53|F|other|94043 3|23|M|writer|32067 4|24|M|technician|43537 5|33|F|other|15213 u.item movie idã€titleã€release dateä»¥åŠè‹¥å¹²ä¸IMDB linkå’Œç”µå½±åˆ†ç±»ç›¸å…³çš„å±æ€§ &gt;head -5 u.item 1|Toy Story (1995)|01-Jan-1995||http://us.imdb.com/M/title-exact?Toy%20 Story%20(1995)|0|0|0|1|1|1|0|0|0|0|0|0|0|0|0|0|0|0|0 2|GoldenEye (1995)|01-Jan-1995||http://us.imdb.com/M/title- exact?GoldenEye%20(1995)|0|1|1|0|0|0|0|0|0|0|0|0|0|0|0|0|1|0|0 3|Four Rooms (1995)|01-Jan-1995||http://us.imdb.com/M/title- exact?Four%20Rooms%20(1995)|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|1|0|0 4|Get Shorty (1995)|01-Jan-1995||http://us.imdb.com/M/title- exact?Get%20Shorty%20(1995)|0|1|0|0|0|1|0|0|1|0|0|0|0|0|0|0|0|0|0 5|Copycat (1995)|01-Jan-1995||http://us.imdb.com/M/title- exact?Copycat%20(1995)|0|0|0|0|0|0|1|0|1|0|0|0|0|0|0|0|1|0|0 u.data user idã€movie idã€ratingï¼ˆä»1åˆ°5ï¼‰å’Œtimestampå±æ€§ï¼Œå„å±æ€§é—´ç”¨åˆ¶è¡¨ç¬¦ï¼ˆ\\tï¼‰åˆ†éš” &gt;head -5 u.data196 242 3 881250949186 302 3 89171774222 377 1 878887116244 51 2 880606923166 346 1 886397596 2. æ¢ç´¢ä¸å¯è§†åŒ–æ•°æ®IPythonçš„å®‰è£…æ–¹æ³•å¯å‚è€ƒå¦‚ä¸‹æŒ‡å¼•ï¼šhttp://ipython.org/install.htmlã€‚ å¦‚æœè¿™æ˜¯ä½ ç¬¬ä¸€æ¬¡ä½¿ç”¨IPythonï¼Œè¿™é‡Œæœ‰ä¸€ä¸ªæ•™ç¨‹ï¼šhttp://ipython.org/ipython-doc/stable/interactive/tutorial.htmlã€‚ &gt;IPYTHON=1 IPYTHON_OPTS=&quot;--pylab&quot; ./bin/pyspark ç»ˆç«¯é‡Œçš„IPython 2.3.1 â€” An enhanced Interactive Pythonå’ŒUsing matplotlib backend: MacOSXè¾“å‡ºè¡Œè¡¨ç¤ºIPythonå’Œpylabå‡å·²è¢«PySparkå¯ç”¨ã€‚ Welcome to ____ __ / __/__ ___ _____/ /__ _\\ \\/ _ \\/ _ `/ __/ &#x27;_/ /__ / .__/\\_,_/_/ /_/\\_\\ version 1.5.2 /_/Using Python version 2.7.10 (default, Jul 14 2015 19:46:27)SparkContext available as sc, HiveContext available as sqlContext.In [1]: å¯ä»¥å°†æ ·æœ¬ä»£ç è¾“å…¥åˆ°IPythonç»ˆç«¯ï¼Œä¹Ÿå¯é€šè¿‡IPythonæä¾›çš„Notebook åº”ç”¨æ¥å®Œæˆã€‚Notebookæ”¯æŒHTMLæ˜¾ç¤ºï¼Œä¸”åœ¨IPythonç»ˆç«¯çš„åŸºç¡€ä¸Šæä¾›äº†ä¸€äº›å¢å¼ºåŠŸèƒ½ï¼Œå¦‚å³æ—¶ç»˜å›¾ã€HTMLæ ‡è®°ï¼Œä»¥åŠç‹¬ç«‹è¿è¡Œä»£ç ç‰‡æ®µçš„åŠŸèƒ½ã€‚ IPython Notebook ä½¿ç”¨æŒ‡å—ï¼šhttp://ipython.org/ipython-doc/stable/interactive/notebook.html 2.1 æ¢ç´¢ç”¨æˆ·æ•°æ®pythonuser_data = sc.textFile(&quot;/Users/hp/ghome/ml/ml-100k/u.user&quot;)user_data.first()user_data.take(5) pythonuser_fields = user_data.map(lambda line: line.split(&quot;|&quot;))num_users = user_fields.map(lambda fields: fields[0]).count()num_genders = user_fields.map(lambda fields: fields[2]).distinct().count()num_occupations = user_fields.map(lambda fields: fields[3]).distinct().count()num_zipcodes = user_fields.map(lambda fields: fields[4]).distinct().count()print &quot;Users: %d, genders: %d, occupations: %d, ZIP codes: %d&quot; % (num_users, num_genders, num_occupations, num_zipcodes) Output Users: 943, genders: 2, occupations: 21, ZIP codes: 795 matplotlibçš„histä¸ªç›´æ–¹å›¾ï¼Œä»¥åˆ†æç”¨æˆ·å¹´é¾„çš„åˆ†å¸ƒæƒ…å†µï¼š age distribution ages = user_fields.map(lambda x: int(x[1])).collect()hist(ages, bins=20, color=&#x27;lightblue&#x27;, normed=True)fig = matplotlib.pyplot.gcf()fig.set_size_inches(16, 10) occupation distribution count_by_occupation = user_fields.map(lambda fields: (fields[3], 1)).reduceByKey(lambda x, y: x + y).collect()x_axis1 = np.array([c[0] for c in count_by_occupation])y_axis1 = np.array([c[1] for c in count_by_occupation])print x_axis1[u&#x27;administrator&#x27; u&#x27;retired&#x27; u&#x27;lawyer&#x27; u&#x27;none&#x27; u&#x27;student&#x27; u&#x27;technician&#x27; u&#x27;programmer&#x27; u&#x27;salesman&#x27; u&#x27;homemaker&#x27; u&#x27;writer&#x27; u&#x27;doctor&#x27; u&#x27;entertainment&#x27; u&#x27;marketing&#x27; u&#x27;executive&#x27; u&#x27;scientist&#x27; u&#x27;educator&#x27; u&#x27;healthcare&#x27; u&#x27;librarian&#x27; u&#x27;artist&#x27; u&#x27;other&#x27; u&#x27;engineer&#x27;]print y_axis1[ 79 14 12 9 196 27 66 12 7 45 7 18 26 32 31 95 16 51 28 105 67] plt.xticks(rotation=30)ä¹‹ç±»çš„ä»£ç  æ˜¯ ç¾åŒ–æ¡å½¢å›¾ pos = np.arange(len(x_axis))width = 1.0ax = plt.axes()ax.set_xticks(pos + (width / 2))ax.set_xticklabels(x_axis)plt.bar(pos, y_axis, width, color=&#x27;lightblue&#x27;)plt.xticks(rotation=30)fig = matplotlib.pyplot.gcf()fig.set_size_inches(16, 10) Sparkå¯¹RDDæä¾›äº†ä¸€ä¸ªåä¸ºcountByValueçš„ä¾¿æ·å‡½æ•° pythoncount_by_occupation2 = user_fields.map(lambda fields: fields[3]).countByValue()print &quot;Map-reduce approach:&quot;print dict(count_by_occupation2)print &quot;&quot;print &quot;countByValue approach:&quot;print dict(count_by_occupation) 2.2 æ¢ç´¢ç”µå½±æ•°æ®movie_data = sc.textFile(&quot;/PATH/ml-100k/u.item&quot;)print movie_data.first()num_movies = movie_data.count()print &quot;Movies: %d&quot; % num_movies 1|Toy Story (1995)|01-Jan-1995||http://us.imdb.com/M/title-exact?Toy%20Story%20(1995)|0|0|0|1|1|1|0|0|0|0|0|0|0|0|0|0|0|0|0Movies: 1682 def convert_year(x): try: return int(x[-4:]) except: return 1900 movie_fields = movie_data.map(lambda lines: lines.split(&quot;|&quot;))years = movie_fields.map(lambda fields: fields[2]).map(lambda x: convert_year(x))years_filtered = years.filter(lambda x: x != 1900)movie_ages = years_filtered.map(lambda yr: 1998-yr).countByValue()values = movie_ages.values()bins = movie_ages.keys()hist(values, bins=bins, color=&#x27;lightblue&#x27;, normed=True)fig = matplotlib.pyplot.gcf()fig.set_size_inches(16,10) 2.3 æ¢ç´¢è¯„çº§æ•°æ®rating_data = sc.textFile(&quot;/Users/hp/ghome/ml/ml-100k/u.data&quot;)print rating_data.first()num_ratings = rating_data.count()print &quot;Ratings: %d&quot; % num_ratings rating_data = rating_data.map(lambda line: line.split(&quot;\\t&quot;))ratings = rating_data.map(lambda fields: int(fields[2]))max_rating = ratings.reduce(lambda x, y: max(x, y))min_rating = ratings.reduce(lambda x, y: min(x, y))mean_rating = ratings.reduce(lambda x, y: x + y) / num_ratingsmedian_rating = np.median(ratings.collect())ratings_per_user = num_ratings / num_usersratings_per_movie = num_ratings / num_moviesprint &quot;Min rating: %d&quot; % min_ratingprint &quot;Max rating: %d&quot; % max_ratingprint &quot;Average rating: %2.2f&quot; % mean_ratingprint &quot;Median rating: %d&quot; % median_ratingprint &quot;Average # of ratings per user: %2.2f&quot; % ratings_per_userprint &quot;Average # of ratings per movie: %2.2f&quot; % ratings_per_movie Max rating: 5Average rating: 3.00Median rating: 4Average # of ratings per user: 106.00Average # of ratings per movie: 59.00 Sparkå¯¹RDDä¹Ÿæä¾›ä¸€ä¸ªåä¸ºstatesçš„å‡½æ•°ã€‚è¯¥å‡½æ•°åŒ…å«ä¸€ä¸ªæ•°å€¼å˜é‡ç”¨äºåšç±»ä¼¼çš„ç»Ÿè®¡ï¼š ratings.stats()å…¶è¾“å‡ºä¸ºï¼š(count: 100000, mean: 3.52986, stdev: 1.12566797076, max: 5.0, min: 1.0) count_by_rating = ratings.countByValue()x_axis = np.array(count_by_rating.keys())y_axis = np.array([float(c) for c in count_by_rating.values()])# è¿™é‡Œå¯¹yè½´æ­£åˆ™åŒ–ï¼Œä½¿å®ƒè¡¨ç¤ºç™¾åˆ†æ¯”y_axis_normed = y_axis / y_axis.sum()pos = np.arange(len(x_axis))width = 1.0ax = plt.axes()ax.set_xticks(pos + (width / 2))ax.set_xticklabels(x_axis)plt.bar(pos, y_axis_normed, width, color=&#x27;lightblue&#x27;)plt.xticks(rotation=30)fig = matplotlib.pyplot.gcf()fig.set_size_inches(16, 10) å„ä¸ªç”¨æˆ·è¯„çº§æ¬¡æ•°çš„åˆ†å¸ƒæƒ…å†µ user_ratings_grouped = rating_data.map(lambda fields: (int(fields[0]), int(fields[2]))).groupByKey()user_ratings_byuser = user_ratings_grouped.map(lambda (k, v): (k, len(v)))user_ratings_byuser.take(10)Out[91]:[(2, 62), (4, 24), (6, 211), (8, 59), (10, 184), (12, 51), (14, 98), (16, 140), (18, 277), (20, 48)] user_ratings_byuser_local = user_ratings_byuser.map(lambda (k, v): v).collect()hist(user_ratings_byuser_local, bins=200, color=&#x27;lightblue&#x27;, normed=True)fig = matplotlib.pyplot.gcf()fig.set_size_inches(16,10) 3. å¤„ç†ä¸è½¬æ¢æ•°æ®éè§„æ•´æ•°æ®å’Œç¼ºå¤±æ•°æ®çš„å¡«å…… 4. ä»æ•°æ®ä¸­æå–æœ‰ç”¨ç‰¹å¾åœ¨å®Œæˆå¯¹æ•°æ®çš„åˆæ­¥æ¢ç´¢ã€å¤„ç†å’Œæ¸…ç†åï¼Œä¾¿å¯ä»ä¸­æå–å¯ä¾›æœºå™¨å­¦ä¹ æ¨¡å‹è®­ç»ƒç”¨çš„ç‰¹å¾ã€‚ ç‰¹å¾ï¼ˆfeatureï¼‰æŒ‡é‚£äº›ç”¨äºæ¨¡å‹è®­ç»ƒçš„å˜é‡ã€‚æ¯ä¸€è¡Œæ•°æ®åŒ…å«å¯ä¾›æå–åˆ°è®­ç»ƒæ ·æœ¬ä¸­çš„å„ç§ä¿¡æ¯ã€‚ å‡ ä¹æ‰€æœ‰æœºå™¨å­¦ä¹ æ¨¡å‹éƒ½æ˜¯ä¸ç”¨å‘é‡è¡¨ç¤ºçš„æ•°å€¼ç‰¹å¾æ‰“äº¤é“ï¼›éœ€å°†åŸå§‹æ•°æ®è½¬æ¢ä¸ºæ•°å€¼ã€‚ ç‰¹å¾å¯ä»¥æ¦‚æ‹¬åœ°åˆ†ä¸ºå¦‚ä¸‹å‡ ç§ã€‚ æ•°å€¼ç‰¹å¾ï¼ˆnumerical featureï¼‰ï¼šè¿™äº›ç‰¹å¾é€šå¸¸ä¸ºå®æ•°æˆ–æ•´æ•°ï¼Œæ¯”å¦‚ä¹‹å‰ä¾‹å­ä¸­æåˆ°çš„å¹´é¾„ã€‚ ç±»åˆ«ç‰¹å¾ï¼ˆcategorical featureï¼‰ï¼šæˆ‘ä»¬æ•°æ®é›†ä¸­çš„ç”¨æˆ·æ€§åˆ«ã€èŒä¸šæˆ–ç”µå½±ç±»åˆ«ä¾¿æ˜¯è¿™ç±»ã€‚ æ–‡æœ¬ç‰¹å¾ï¼ˆtext featureï¼‰ï¼šå®ƒä»¬æ´¾ç”Ÿè‡ªæ•°æ®ä¸­çš„æ–‡æœ¬å†…å®¹ï¼Œæ¯”å¦‚ç”µå½±åã€æè¿°æˆ–æ˜¯è¯„è®ºã€‚ å…¶ä»–ç‰¹å¾ï¼šâ€¦ åœ°ç†ä½ç½®åˆ™å¯ç”±ç»çº¬åº¦æˆ–åœ°ç†æ•£åˆ—ï¼ˆgeohashï¼‰è¡¨ç¤ºã€‚ 4.1 æ•°å€¼ç‰¹å¾åŸå§‹çš„æ•°å€¼å’Œä¸€ä¸ªæ•°å€¼ç‰¹å¾ä¹‹é—´çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ æœºå™¨å­¦ä¹ æ¨¡å‹ä¸­æ‰€å­¦ä¹ çš„æ˜¯å„ä¸ªç‰¹å¾æ‰€å¯¹åº”çš„å‘é‡çš„æƒå€¼ã€‚è¿™äº›æƒå€¼åœ¨ç‰¹å¾å€¼åˆ°è¾“å‡ºæˆ–æ˜¯ç›®æ ‡å˜é‡ï¼ˆæŒ‡åœ¨ç›‘ç£å­¦ä¹ æ¨¡å‹ä¸­ï¼‰is very importantã€‚ å½“æ•°å€¼ç‰¹å¾ä»å¤„äºåŸå§‹å½¢å¼æ—¶ï¼Œå…¶å¯ç”¨æ€§ç›¸å¯¹è¾ƒä½ï¼Œä½†å¯ä»¥è½¬åŒ–ä¸ºæ›´æœ‰ç”¨çš„è¡¨ç¤ºå½¢å¼ã€‚ å¦‚ (ä½ç½®ä¿¡æ¯ : åŸå§‹ä½ç½®ä¿¡æ¯ï¼ˆæ¯”å¦‚ç”¨ç»çº¬åº¦è¡¨ç¤ºçš„ï¼‰ï¼Œä¿¡æ¯å¯ç”¨æ€§å¾ˆä½ã€‚ ç„¶è‹¥å¯¹ä½ç½®è¿›è¡Œèšåˆï¼ˆæ¯”å¦‚èšç„¦ä¸ºä¸€ä¸ªcity or countryï¼‰ï¼Œå’Œç‰¹å®šè¾“å‡º ä¹‹é—´å­˜åœ¨æŸç§å…³è”ã€‚ 4.2 ç±»åˆ«ç‰¹å¾å°†ç±»åˆ«ç‰¹å¾è¡¨ç¤ºä¸ºæ•°å­—å½¢å¼ï¼Œå¸¸å¯å€ŸåŠ© k ä¹‹1ï¼ˆ1-of-kï¼‰æ–¹æ³•è¿›è¡Œ æ¯”å¦‚ï¼Œå¯å–occupation æ‰€æœ‰å¯èƒ½å–å€¼ï¼š all_occupations = user_fields.map(lambda fields: fields[3]). distinct().collect()all_occupations.sort() ç„¶å¯ä¾æ¬¡å¯¹å„å¯èƒ½çš„èŒä¸šåˆ†é…åºå·ï¼ˆæ³¨æ„ ä»0å¼€å§‹ç¼–å·ï¼‰ï¼š idx = 0all_occupations_dict = &#123;&#125;for o in all_occupations: all_occupations_dict[o] = idx idx +=1# çœ‹ä¸€ä¸‹â€œkä¹‹1â€ç¼–ç ä¼šå¯¹æ–°çš„ä¾‹å­åˆ†é…ä»€ä¹ˆå€¼print &quot;Encoding of &#x27;doctor&#x27;: %d&quot; % all_occupations_dict[&#x27;doctor&#x27;]print &quot;Encoding of &#x27;programmer&#x27;: %d&quot; % all_occupations_dict[&#x27;programmer&#x27;] å…¶è¾“å‡ºå¦‚ä¸‹ï¼š Encoding of &#x27;doctor&#x27;: 2Encoding of &#x27;programmer&#x27;: 14 4.3 æ´¾ç”Ÿç‰¹å¾ä»åŸå§‹æ•°æ®æ´¾ç”Ÿç‰¹å¾çš„ä¾‹å­åŒ…æ‹¬è®¡ç®—å¹³å‡å€¼ã€ä¸­ä½å€¼ã€æ–¹å·®ã€å’Œã€å·®ã€æœ€å¤§å€¼æˆ–æœ€å°å€¼ä»¥åŠè®¡æ•°ã€‚ä»ç”µå½±çš„å‘è¡Œå¹´ä»½å’Œå½“å‰å¹´ä»½æ´¾ç”Ÿäº†æ–°çš„movie ageç‰¹å¾çš„ã€‚è¿™ç±»è½¬æ¢èƒŒåçš„æƒ³æ³•å¸¸å¸¸æ˜¯å¯¹æ•°å€¼æ•°æ®è¿›è¡ŒæŸç§æ¦‚æ‹¬ï¼Œå¹¶æœŸæœ›å®ƒèƒ½è®©æ¨¡å‹å­¦ä¹ æ›´å®¹æ˜“ã€‚ æ•°å€¼ç‰¹å¾åˆ°ç±»åˆ«ç‰¹å¾çš„è½¬æ¢ä¹Ÿå¾ˆå¸¸è§ï¼Œæ¯”å¦‚åˆ’åˆ†ä¸ºåŒºé—´ç‰¹å¾ã€‚è¿›è¡Œè¿™ç±»è½¬æ¢çš„å˜é‡å¸¸è§çš„æœ‰å¹´é¾„ã€åœ°ç†ä½ç½®å’Œæ—¶é—´ã€‚ å¦‚ ï¼š å°†æ—¶é—´æˆ³è½¬ä¸ºç±»åˆ«ç‰¹ ç”µå½±è¯„çº§å‘ç”Ÿçš„æ—¶é—´ [â€˜afternoonâ€™, â€˜eveningâ€™, â€˜morningâ€™, â€˜morningâ€™, â€˜morningâ€™] 4.4 æ–‡æœ¬ç‰¹å¾æ–‡æœ¬ç‰¹å¾ä¹Ÿæ˜¯ä¸€ç§ç±»åˆ«ç‰¹å¾æˆ–æ´¾ç”Ÿç‰¹å¾ NLP ä¾¿æ˜¯ä¸“æ³¨äºæ–‡æœ¬å†…å®¹çš„å¤„ç†ã€è¡¨ç¤ºå’Œå»ºæ¨¡çš„ä¸€ä¸ªé¢†åŸŸã€‚ ä»‹ç»ä¸€ç§ç®€å•ä¸”æ ‡å‡†åŒ–çš„æ–‡æœ¬ç‰¹å¾æå–æ–¹æ³•ã€‚è¯¥æ–¹æ³•è¢«ç§°ä¸ºè¯è¢‹ï¼ˆbag-of-wordï¼‰è¡¨ç¤ºæ³•ã€‚ è¯è¢‹æ³•å°†ä¸€æ®µæ–‡æœ¬è§†ä¸ºç”±å…¶ä¸­çš„æ–‡æœ¬æˆ–æ•°å­—ç»„æˆçš„é›†åˆï¼Œå…¶å¤„ç†è¿‡ç¨‹å¦‚ä¸‹ã€‚ bag-of-word (1) åˆ†è¯ï¼ˆtokenizationï¼‰ é¦–å…ˆä¼šåº”ç”¨æŸäº›åˆ†è¯æ–¹æ³•æ¥å°†æ–‡æœ¬åˆ†éš”ä¸ºä¸€ä¸ªç”±è¯ï¼ˆä¸€èˆ¬å¦‚å•è¯ã€æ•°å­—ç­‰ï¼‰ç»„æˆçš„é›†åˆã€‚ (2) åˆ é™¤åœç”¨è¯ï¼ˆstop words removal) åˆ é™¤å¸¸è§çš„å•è¯ï¼Œæ¯”å¦‚theã€andå’Œbutï¼ˆè¿™äº›è¯è¢«ç§°ä½œåœç”¨è¯ï¼‰ã€‚ (3) æå–è¯å¹²ï¼ˆstemmingï¼‰ï¼š æ˜¯æŒ‡å°†å„ä¸ªè¯ç®€åŒ–ä¸ºå…¶åŸºæœ¬çš„å½¢å¼æˆ–è€…å¹²è¯ã€‚å¸¸è§çš„ä¾‹å­å¦‚å¤æ•°å˜ä¸ºå•æ•°ï¼ˆæ¯”å¦‚dogså˜ä¸ºdogç­‰ï¼‰ã€‚æå–çš„æ–¹æ³•æœ‰å¾ˆå¤šç§ï¼Œæ–‡æœ¬å¤„ç†ç®—æ³•åº“ä¸­å¸¸å¸¸ä¼šåŒ…æ‹¬å¤šç§è¯å¹²æå–æ–¹æ³•ã€‚ (4) å‘é‡åŒ–ï¼ˆvectorizationï¼‰ ï¼š å‘é‡æ¥è¡¨ç¤ºå¤„ç†å¥½çš„è¯ã€‚äºŒå…ƒå‘é‡å¯èƒ½æ˜¯æœ€ä¸ºç®€å•çš„è¡¨ç¤ºæ–¹å¼ã€‚å®ƒç”¨1å’Œ0æ¥åˆ†åˆ«è¡¨ç¤ºæ˜¯å¦å­˜åœ¨æŸä¸ªè¯ã€‚ä»æ ¹æœ¬ä¸Šè¯´ï¼Œè¿™ä¸ä¹‹å‰æåˆ°çš„ k ä¹‹1ç¼–ç ç›¸åŒã€‚ä¸ k ä¹‹1ç›¸åŒï¼Œå®ƒéœ€è¦ä¸€ä¸ªè¯çš„å­—å…¸æ¥å®ç°è¯åˆ°ç´¢å¼•åºå·çš„æ˜ å°„ã€‚éšç€é‡åˆ°çš„è¯å¢å¤šï¼Œå„ç§è¯å¯èƒ½è¾¾æ•°ç™¾ä¸‡ã€‚ç”±æ­¤ï¼Œä½¿ç”¨ç¨€ç–çŸ©é˜µæ¥è¡¨ç¤ºå°±å¾ˆå…³é”®ã€‚è¿™ç§è¡¨ç¤ºåªè®°å½•æŸä¸ªè¯æ˜¯å¦å‡ºç°è¿‡ï¼Œä»è€ŒèŠ‚çœå†…å­˜å’Œç£ç›˜ç©ºé—´ï¼Œä»¥åŠè®¡ç®—æ—¶é—´ã€‚ æå–ç®€å•çš„æ–‡æœ¬ç‰¹å¾ å‚è§ : http://www.ituring.com.cn/tupubarticle/5567 ç°åœ¨æ¯ä¸€ä¸ªç”µå½±æ ‡é¢˜éƒ½è¢«è½¬æ¢ä¸ºä¸€ä¸ªç¨€ç–å‘é‡ã€‚ 4.5 æ­£åˆ™åŒ–ç‰¹å¾åœ¨å°†ç‰¹å¾æå–ä¸ºå‘é‡å½¢å¼åï¼Œä¸€ç§å¸¸è§çš„é¢„å¤„ç†æ–¹å¼æ˜¯å°†æ•°å€¼æ•°æ®æ­£åˆ™åŒ–ï¼ˆnormalizationï¼‰ã€‚å…¶èƒŒåçš„æ€æƒ³æ˜¯å°†å„ä¸ªæ•°å€¼ç‰¹å¾è¿›è¡Œè½¬æ¢ï¼Œä»¥å°†å®ƒä»¬çš„å€¼åŸŸè§„èŒƒåˆ°ä¸€ä¸ªæ ‡å‡†åŒºé—´å†…ã€‚æ­£åˆ™åŒ–çš„æ–¹æ³•æœ‰å¦‚ä¸‹å‡ ç§ã€‚ æ­£åˆ™åŒ–ç‰¹å¾ï¼šè¿™å®é™…ä¸Šæ˜¯å¯¹æ•°æ®é›†ä¸­çš„å•ä¸ªç‰¹å¾è¿›è¡Œè½¬æ¢ã€‚æ¯”å¦‚å‡å»å¹³å‡å€¼ï¼ˆç‰¹å¾å¯¹é½ï¼‰æˆ–æ˜¯è¿›è¡Œæ ‡å‡†çš„æ­£åˆ™è½¬æ¢ï¼ˆä»¥ä½¿å¾—è¯¥ç‰¹å¾çš„å¹³å‡å€¼å’Œæ ‡å‡†å·®åˆ†åˆ«ä¸º0å’Œ1ï¼‰ã€‚ æ­£åˆ™åŒ–ç‰¹å¾å‘é‡ï¼šè¿™é€šå¸¸æ˜¯å¯¹æ•°æ®ä¸­çš„æŸä¸€è¡Œçš„æ‰€æœ‰ç‰¹å¾è¿›è¡Œè½¬æ¢ï¼Œä»¥è®©è½¬æ¢åçš„ç‰¹å¾å‘é‡çš„é•¿åº¦æ ‡å‡†åŒ–ã€‚ä¹Ÿå°±æ˜¯ç¼©æ”¾å‘é‡ä¸­çš„å„ä¸ªç‰¹å¾ä»¥ä½¿å¾—å‘é‡çš„èŒƒæ•°ä¸º1ï¼ˆå¸¸æŒ‡ä¸€é˜¶æˆ–äºŒé˜¶èŒƒæ•°ï¼‰ã€‚ å‘é‡æ­£åˆ™åŒ–å¯é€šè¿‡numpyçš„normå‡½æ•°æ¥å®ç°ã€‚å…·ä½“æ¥è¯´ï¼Œå…ˆè®¡ç®—ä¸€ä¸ªéšæœºå‘é‡çš„äºŒé˜¶èŒƒæ•°ï¼Œç„¶åè®©å‘é‡ä¸­çš„æ¯ä¸€ä¸ªå…ƒç´ éƒ½é™¤è¯¥èŒƒæ•°ï¼Œä»è€Œå¾—åˆ°æ­£åˆ™åŒ–åçš„å‘é‡ï¼š np.random.seed(42)x = np.random.randn(10)norm_x_2 = np.linalg.norm(x)normalized_x = x / norm_x_2print &quot;x:\\n%s&quot; % xprint &quot;2-Norm of x: %2.4f&quot; % norm_x_2print &quot;Normalized x:\\n%s&quot; % normalized_xprint &quot;2-Norm of normalized_x: %2.4f&quot; % np.linalg.norm(normalized_x) å…¶è¾“å‡ºåº”è¯¥å¦‚ä¸‹ï¼ˆä¸Šé¢å°†éšæœºç§å­çš„å€¼è®¾ä¸º42ï¼Œä¿è¯æ¯æ¬¡è¿è¡Œçš„ç»“æœç›¸åŒï¼‰ï¼š x: [ 0.49671415 -0.1382643 0.64768854 1.52302986 -0.23415337 -0.234136961.57921282 0.76743473 -0.46947439 0.54256004]2-Norm of x: 2.5908Normalized x: [ 0.19172213 -0.05336737 0.24999534 0.58786029 -0.09037871 -0.09037237 0.60954584 0.29621508 -0.1812081 0.20941776]2-Norm of normalized_x: 1.0000 ç”¨ MLlib æ­£åˆ™åŒ–ç‰¹å¾ Sparkåœ¨å…¶MLlibæœºå™¨å­¦ä¹ åº“ä¸­å†…ç½®äº†ä¸€äº›å‡½æ•°ç”¨äºç‰¹å¾çš„ç¼©æ”¾å’Œæ ‡å‡†åŒ–ã€‚å®ƒä»¬åŒ…æ‹¬ä¾›æ ‡å‡†æ­£æ€å˜æ¢çš„StandardScalerï¼Œä»¥åŠæä¾›ä¸ä¸Šè¿°ç›¸åŒçš„ç‰¹å¾å‘é‡æ­£åˆ™åŒ–çš„ Normalizerã€‚ æ¯”è¾ƒä¸€ä¸‹MLlibçš„Normalizerä¸æˆ‘ä»¬è‡ªå·±å‡½æ•°çš„ç»“æœï¼š from pyspark.mllib.feature import Normalizernormalizer = Normalizer()vector =sc.parallelize([x]) åœ¨å¯¼å…¥æ‰€éœ€çš„ç±»åï¼Œä¼šè¦åˆå§‹åŒ–Normalizerï¼ˆå…¶é»˜è®¤ä½¿ç”¨ä¸ä¹‹å‰ç›¸åŒçš„äºŒé˜¶èŒƒæ•°ï¼‰ã€‚æ³¨æ„ç”¨Sparkæ—¶ï¼Œå¤§éƒ¨åˆ†æƒ…å†µä¸‹Normalizeræ‰€éœ€çš„è¾“å…¥ä¸ºä¸€ä¸ªRDDï¼ˆå®ƒåŒ…å«numpyæ•°å€¼æˆ–MLlibå‘é‡ï¼‰ã€‚ä½œä¸ºä¸¾ä¾‹ï¼Œæˆ‘ä»¬ä¼šä»xå‘é‡åˆ›å»ºä¸€ä¸ªå•å…ƒç´ çš„RDDã€‚ ä¹‹åå°†ä¼šå¯¹æˆ‘ä»¬çš„RDDè°ƒç”¨Normalizerçš„transformå‡½æ•°ã€‚ç”±äºè¯¥RDDåªå«æœ‰ä¸€ä¸ªå‘é‡ï¼Œå¯é€šè¿‡firstå‡½æ•°æ¥è¿”å›å‘é‡åˆ°é©±åŠ¨ç¨‹åºã€‚æ¥ç€è°ƒç”¨toArrayå‡½æ•°æ¥å°†è¯¥å‘é‡è½¬æ¢ä¸ºnumpyæ•°ç»„ï¼š normalized_x_mllib = normalizer.transform(vector).first().toArray()#æœ€åæ¥çœ‹ä¸€ä¸‹ä¹‹å‰æ‰“å°è¿‡çš„é‚£äº›å€¼ï¼Œå¹¶åšä¸ªæ¯”è¾ƒï¼šprint &quot;x:\\n%s&quot; % xprint &quot;2-Norm of x: %2.4f&quot; % norm_x_2print &quot;Normalized x MLlib:\\n%s&quot; % normalized_x_mllibprint &quot;2-Norm of normalized_x_mllib: %2.4f&quot; % np.linalg.norm(normalized_x_mllib) ç›¸æ¯”è‡ªå·±ç¼–å†™çš„å‡½æ•°ï¼Œä½¿ç”¨ MLlibå†…ç½®çš„å‡½æ•° æ›´æ–¹ä¾¿ 4.6 ç”¨è½¯ä»¶åŒ…æå–ç‰¹å¾ç‰¹å¾æå–å¯å€ŸåŠ©çš„è½¯ä»¶åŒ…æœ‰scikit-learnã€gensimã€scikit-imageã€matplotlibã€Pythonçš„NLTKã€Javaç¼–å†™çš„OpenNLPä»¥åŠç”¨Scalaç¼–å†™çš„Breezeå’ŒChalkã€‚Breezeè‡ªSpark 1.0å¼€å§‹å°±æˆä¸ºSparkçš„ä¸€éƒ¨åˆ†äº†ã€‚Breezeæœ‰çº¿æ€§ä»£æ•°åŠŸèƒ½ã€‚ 5. å°ç»“äº†è§£ å¦‚ä½•å¯¼å…¥ã€å¤„ç†å’Œæ¸…ç†æ•°æ®ï¼Œå¦‚ä½•å°†åŸå§‹æ•°æ®è½¬ä¸ºç‰¹å¾å‘é‡ä»¥ä¾›æ¨¡å‹è®­ç»ƒçš„å¸¸è§æ–¹æ³•","categories":[{"name":"spark","slug":"spark","permalink":"http://iequa.com/categories/spark/"}],"tags":[{"name":"spark","slug":"spark","permalink":"http://iequa.com/tags/spark/"}]},{"title":"Spark Machine Learning p2 - è®¾è®¡æœºå™¨å­¦ä¹ ç³»ç»Ÿ","slug":"spark/spark-machine-learning-p2-design-ml-sys","date":"2016-09-08T02:07:21.000Z","updated":"2019-10-20T04:30:35.076Z","comments":true,"path":"2016/09/08/spark/spark-machine-learning-p2-design-ml-sys/","link":"","permalink":"http://iequa.com/2016/09/08/spark/spark-machine-learning-p2-design-ml-sys/","excerpt":"ã€ŠSpark Machine Learingã€‹ Reading Notes ï¼š å¦‚ä½•è®¾è®¡æœºå™¨å­¦ä¹ ç³»ç»Ÿ moiveStream","text":"ã€ŠSpark Machine Learingã€‹ Reading Notes ï¼š å¦‚ä½•è®¾è®¡æœºå™¨å­¦ä¹ ç³»ç»Ÿ moiveStream img { display: block !important; height: 400px; width: 500px; margin-left: 180px !important; } 1. åŸå§‹ MovieStream ä»‹ç» 1.1 ä¸ªæ€§åŒ–ä¸ªæ€§åŒ– æ˜¯æ ¹æ®å„å› ç´ æ¥æ”¹å˜ç”¨æˆ·ä½“éªŒå’Œå‘ˆç°ç»™ç”¨æˆ·å†…å®¹ã€‚è¿™äº›å› ç´ å¯èƒ½åŒ…æ‹¬ç”¨æˆ·çš„è¡Œä¸ºæ•°æ®å’Œå¤–éƒ¨å› ç´ ã€‚ æ¨èï¼ˆrecommendationï¼‰, å¸¸æŒ‡å‘ç”¨æˆ·å‘ˆç°ä¸€ä¸ªä»–ä»¬å¯èƒ½æ„Ÿå…´è¶£çš„ç‰©å“åˆ—è¡¨ã€‚ ä¸ªæ€§åŒ–å’Œæ¨èååˆ†ç›¸ä¼¼, æ ¹æ®å› ç´ æ”¹å˜æœç´¢çš„å‘ˆç°ä¸åŒç”¨æˆ·ä¸åŒå†…å®¹ï¼Œè¿™æ˜¯éšå¼ä¸ªæ€§åŒ– 1.2 å®¢æˆ·ç»†åˆ†ç›®æ ‡è¥é”€ç”¨ä¸æ¨èç±»ä¼¼çš„æ–¹æ³•ä»ç”¨æˆ·ç¾¤ä¸­æ‰¾å‡ºè¦è¥é”€çš„å¯¹è±¡ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œæ¨èå’Œä¸ªæ€§åŒ–çš„åº”ç”¨åœºæ™¯éƒ½æ˜¯ä¸€å¯¹ä¸€ï¼Œæ ¹æ®ç”¨æˆ·çš„ç‰¹å¾è¿›è¡Œåˆ†ç»„ï¼Œå¹¶å¯èƒ½å‚è€ƒè¡Œä¸ºæ•°æ®ã€‚ä¹Ÿå¯èƒ½ä½¿ç”¨äº†æŸç§æœºå™¨å­¦ä¹ æ¨¡å‹ï¼Œæ¯”å¦‚ èšç±»ã€‚ 1.3 é¢„æµ‹å»ºæ¨¡é¢„æµ‹æ€§åˆ†æ ä»æŸç§æ„ä¹‰ä¸Šè¯´è¿˜è¦†ç›–æ¨èã€ä¸ªæ€§åŒ–å’Œç›®æ ‡è¥é”€ã€‚ç”¨é¢„æµ‹å»ºæ¨¡ï¼ˆpredictive modelingï¼‰æ¥è¡¨ç¤ºå…¶ä»–åšé¢„æµ‹çš„æ¨¡å‹ã€‚å€ŸåŠ©æ´»åŠ¨è®°å½•ã€æ”¶å…¥æ•°æ®ä»¥åŠå†…å®¹å±æ€§ï¼ŒMovieStream å¯ä»¥åˆ›å»ºä¸€ä¸ªå›å½’æ¨¡å‹ï¼ˆregression modelï¼‰æ¥é¢„æµ‹æ–°ç”µå½±çš„å¸‚åœºè¡¨ç°ã€‚ å¦å¤–ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä½¿ç”¨åˆ†ç±»æ¨¡å‹ï¼ˆclassificaiton modelï¼‰æ¥å¯¹åªæœ‰éƒ¨åˆ†æ•°æ®çš„æ–°ç”µå½±è‡ªåŠ¨åˆ†é…æ ‡ç­¾ã€å…³é”®å­—æˆ–åˆ†ç±»ã€‚ 2. æœºå™¨å­¦ä¹ æ¨¡å‹çš„ç§ç±»supervised learningï¼šè¿™ç§æ–¹æ³•ä½¿ç”¨å·²æ ‡è®°æ•°æ®æ¥å­¦ä¹ ã€‚æ¨èå¼•æ“ã€å›å½’å’Œåˆ†ç±»ä¾¿æ˜¯ä¾‹å­ã€‚å®ƒä»¬æ‰€ä½¿ç”¨çš„æ ‡è®°æ•°æ®å¯ä»¥æ˜¯ç”¨æˆ·å¯¹ç”µå½±çš„è¯„çº§ï¼ˆå¯¹æ¨èæ¥è¯´ï¼‰ã€ç”µå½±æ ‡ç­¾ï¼ˆå¯¹ä¸Šè¿°åˆ†ç±»ä¾‹å­æ¥è¯´ï¼‰æˆ–æ˜¯æ”¶å…¥æ•°å­—ï¼ˆå¯¹å›å½’é¢„æµ‹æ¥è¯´ï¼‰. unsupervised learningï¼šä¸€äº›æ¨¡å‹çš„å­¦ä¹ è¿‡ç¨‹ä¸éœ€è¦æ ‡è®°æ•°æ®ï¼Œæˆ‘ä»¬ç§°å…¶ä¸ºæ— ç›‘ç£å­¦ä¹ ã€‚è¿™ç±»æ¨¡å‹è¯•å›¾å­¦ä¹ æˆ–æ˜¯æå–æ•°æ®èƒŒåçš„ç»“æ„æˆ–ä»ä¸­æŠ½å–æœ€ä¸ºé‡è¦çš„ç‰¹å¾ã€‚èšç±»ã€é™ç»´å’Œæ–‡æœ¬å¤„ç†çš„æŸäº›ç‰¹å¾æå–éƒ½æ˜¯æ— ç›‘ç£å­¦ä¹ . 3. æ•°æ®é©±åŠ¨MLç³»ç»Ÿçš„ç»„æˆ 3.1 æ•°æ®è·å–ä¸å­˜å‚¨MovieStream çš„æ•°æ®é€šå¸¸æ¥è‡ªç”¨æˆ·æ´»åŠ¨. è¦å­˜å‚¨çš„æ•°æ®åŒ…æ‹¬ï¼šåŸå§‹æ•°æ®ã€å³æ—¶å¤„ç†åçš„æ•°æ®ï¼Œä»¥åŠå¯ç”¨äºç”Ÿäº§ç³»ç»Ÿçš„æœ€ç»ˆå»ºæ¨¡ç»“æœã€‚ æ•°æ®å­˜å‚¨ æ–‡ä»¶ç³»ç»Ÿ : å¦‚ HDFSã€Amazon S3 ç­‰ï¼› SQLæ•°æ®åº“ : å¦‚ MySQLã€PostgreSQLï¼› NoSQL : -å¦‚ HBaseã€Cassandraã€Mongodbï¼› æœç´¢å¼•æ“ : å¦‚ Solr ã€Elasticsearchï¼› æµæ•°æ® : â€” å¦‚ Kafkaã€Flumeã€Amazon Kinesis 3.2 æ•°æ®æ¸…ç†ä¸è½¬æ¢å¤§éƒ¨åˆ†æœºå™¨å­¦ä¹ æ¨¡å‹æ‰€å¤„ç†çš„éƒ½æ˜¯ featureã€‚ç‰¹å¾ é€šå¸¸æ˜¯è¾“å…¥å˜é‡æ‰€å¯¹åº”çš„å¯ç”¨äºæ¨¡å‹çš„æ•°å€¼è¡¨ç¤ºã€‚ åŸå§‹æ•°æ® é¢„å¤„ç† å‡ ç§ æƒ…å†µ æ•°æ®è¿‡æ»¤ åˆå¹¶å¤šä¸ªæ•°æ®æº æ•°æ®æ±‡æ€» å¯¹è®¸å¤šæ¨¡å‹ç±»å‹æ¥è¯´ï¼Œè¿™ç§è¡¨ç¤ºå°±æ˜¯åŒ…å« æ•°å€¼æ•°æ®çš„ å‘é‡ or çŸ©é˜µã€‚ å°†ç±»åˆ«æ•°æ®ï¼ˆæ¯”å¦‚åœ°ç†ä½ç½®æ‰€åœ¨çš„å›½å®¶æˆ–æ˜¯ç”µå½±çš„ç±»åˆ«ï¼‰ç¼–ç ä¸ºå¯¹åº”çš„æ•°å€¼è¡¨ç¤ºã€‚ æ–‡æœ¬æ•°æ®æå–æœ‰ç”¨ä¿¡æ¯ã€‚ å¤„ç†å›¾åƒæˆ–æ˜¯éŸ³é¢‘æ•°æ®ã€‚ æ•°å€¼æ•°æ®å¸¸è¢«è½¬æ¢ä¸ºç±»åˆ«æ•°æ®ä»¥å‡å°‘æŸä¸ªå˜é‡çš„å¯èƒ½å€¼çš„æ•°ç›®ã€‚ä¾‹å¦‚å°†å¹´é¾„åˆ†ä¸º 601, 602â€¦ å¯¹ç‰¹å¾è¿›è¡Œæ­£åˆ™åŒ–ã€æ ‡å‡†åŒ–ï¼Œä»¥ä¿è¯åŒä¸€æ¨¡å‹çš„ä¸åŒè¾“å…¥å˜é‡çš„å€¼åŸŸç›¸åŒã€‚ è¿™äº›æ•°æ®æ¸…ç†ã€æ¢ç´¢ã€èšåˆå’Œè½¬æ¢æ­¥éª¤ï¼Œéƒ½èƒ½é€šè¿‡Sparkæ ¸å¿ƒAPIã€SparkSQLå¼•æ“å’Œå…¶ä»–å¤–éƒ¨Scalaã€Javaæˆ–PythonåŒ…åšåˆ°ã€‚å€ŸåŠ© Spark çš„ HadoopåŠŸèƒ½ è¿˜èƒ½å®ç°ä¸Šè¿°å¤šç§å­˜å‚¨ç³»ç»Ÿä¸Šçš„è¯»å†™ã€‚ 3.3 æ¨¡å‹è®­ç»ƒä¸æµ‹è¯•å›è·¯å½“æ•°æ®å·²è½¬æ¢ä¸ºå¯ç”¨äºæ¨¡å‹çš„å½¢å¼ï¼Œä¾¿å¯å¼€å§‹æ¨¡å‹çš„è®­ç»ƒå’Œæµ‹è¯•ã€‚ åœ¨è®­ç»ƒæ•°æ®é›†ä¸Šè¿è¡Œæ¨¡å‹å¹¶åœ¨æµ‹è¯•æ•°æ®é›†ï¼ˆå³ä¸ºè¯„ä¼°æ¨¡å‹è€Œé¢„ç•™çš„æ•°æ®ï¼Œåœ¨è®­ç»ƒé˜¶æ®µæ¨¡å‹æ²¡æ¥è§¦è¿‡è¯¥æ•°æ®ï¼‰ä¸Šæµ‹è¯•å…¶æ•ˆæœï¼Œè¿™ä¸ªè¿‡ç¨‹ä¸€èˆ¬ç›¸å¯¹ç›´æ¥ï¼Œè¢«ç§°ä½œäº¤å‰éªŒè¯ï¼ˆcross-validationï¼‰ã€‚ Spark MLlib æ¥å®ç°å¯¹å„ç§æœºå™¨å­¦ä¹ æ–¹æ³•çš„æ¨¡å‹è®­ç»ƒã€è¯„ä¼°ä»¥åŠäº¤å‰éªŒè¯ã€‚ 3.4 æ¨¡å‹éƒ¨ç½²ä¸æ•´åˆé€šè¿‡è®­ç»ƒæµ‹è¯•å¾ªç¯æ‰¾å‡ºæœ€ä½³æ¨¡å‹åï¼Œè¦è®©å®ƒèƒ½å¾—å‡ºå¯ä»˜è¯¸å®è·µçš„é¢„æµ‹ï¼Œè¿˜éœ€å°†å…¶éƒ¨ç½²åˆ°ç”Ÿäº§ç³»ç»Ÿä¸­ã€‚ è¿™ä¸ªè¿‡ç¨‹ä¸€èˆ¬è¦å°†å·²è®­ç»ƒçš„æ¨¡å‹å¯¼å…¥ç‰¹å®šçš„æ•°æ®å­˜å‚¨ä¸­ã€‚ 3.5 æ¨¡å‹ç›‘æ§ä¸åé¦ˆç›‘æ§æœºå™¨å­¦ä¹ ç³»ç»Ÿåœ¨ç”Ÿäº§ç¯å¢ƒä¸‹çš„è¡¨ç°ååˆ†é‡è¦ã€‚ åŒæ ·å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œæ¨¡å‹å‡†ç¡®åº¦å’Œé¢„æµ‹æ•ˆæœåªæ˜¯ç°å®ä¸­ç³»ç»Ÿè¡¨ç°çš„ä¸€éƒ¨åˆ†ã€‚ æˆ‘ä»¬å¯ä»¥å°½å¯èƒ½åœ¨ç”Ÿäº§ç³»ç»Ÿä¸­éƒ¨ç½²ä¸åŒçš„æ¨¡å‹ï¼Œé€šè¿‡è°ƒæ•´å®ƒä»¬è€Œä¼˜åŒ–ä¸šåŠ¡æŒ‡æ ‡ã€‚å®è·µä¸­ï¼Œè¿™é€šå¸¸é€šè¿‡åœ¨çº¿åˆ†å‰²æµ‹è¯•ï¼ˆlive split testï¼‰è¿›è¡Œã€‚ æ¨¡å‹åé¦ˆï¼ˆmodel feedbackï¼‰ï¼ŒæŒ‡é€šè¿‡ç”¨æˆ·çš„è¡Œä¸ºæ¥å¯¹æ¨¡å‹çš„é¢„æµ‹è¿›è¡Œåé¦ˆçš„è¿‡ç¨‹ã€‚åœ¨ç°å®ç³»ç»Ÿä¸­ï¼Œæ¨¡å‹çš„åº”ç”¨å°†å½±å“ç”¨æˆ·çš„å†³ç­–å’Œæ½œåœ¨è¡Œä¸ºï¼Œä»è€Œåè¿‡æ¥å°†ä»æ ¹æœ¬ä¸Šæ”¹å˜æ¨¡å‹è‡ªå·±å°†æ¥çš„è®­ç»ƒæ•°æ®ã€‚ 3.6 æ‰¹å¤„ç†/å®æ—¶æ–¹æ¡ˆé€‰æ‹©å¸¸è§çš„æ‰¹å¤„ç†æ–¹æ³•ã€‚æ¨¡å‹ç”¨æ‰€æœ‰æ•°æ®æˆ–ä¸€éƒ¨åˆ†æ•°æ®è¿›è¡Œå‘¨æœŸæ€§çš„é‡æ–°è®­ç»ƒã€‚ç”±äºä¸Šè¿°æµç¨‹ä¼šèŠ±è´¹ä¸€å®šçš„æ—¶é—´ï¼Œè¿™å°±ä½¿å¾—æ‰¹å¤„ç†æ–¹æ³•éš¾ä»¥åœ¨æ–°æ•°æ®åˆ°è¾¾æ—¶ç«‹å³å®Œæˆæ¨¡å‹çš„æ›´æ–°ã€‚ å­˜åœ¨ä¸€ç±»åä¸ºåœ¨çº¿å­¦ä¹ ï¼ˆonline learningï¼‰çš„æœºå™¨å­¦ä¹ æ–¹æ³•ã€‚å®ƒä»¬åœ¨æ–°æ•°æ®åˆ°è¾¾æ—¶ä¾¿èƒ½ç«‹å³æ›´æ–°æ¨¡å‹ï¼Œä»è€Œä½¿å®æ—¶ç³»ç»Ÿæˆä¸ºå¯èƒ½ã€‚å¸¸è§çš„ä¾‹å­æœ‰å¯¹çº¿æ€§æ¨¡å‹çš„åœ¨çº¿ä¼˜åŒ–ç®—æ³•ï¼Œå¦‚éšæœºæ¢¯åº¦ä¸‹é™æ³•ã€‚ 4. æœºå™¨å­¦ä¹ ç³»ç»Ÿæ¶æ„ æœºå™¨å­¦ä¹ æµç¨‹ç¤ºæ„å›¾çš„å†…å®¹ï¼š æ”¶é›†ä¸ç”¨æˆ·ã€ç”¨æˆ·è¡Œä¸ºå’Œç”µå½±æ ‡é¢˜æœ‰å…³çš„æ•°æ®ï¼› å°†è¿™äº›æ•°æ®è½¬ä¸ºç‰¹å¾ï¼› æ¨¡å‹è®­ç»ƒï¼ŒåŒ…æ‹¬è®­ç»ƒ-æµ‹è¯•å’Œæ¨¡å‹é€‰æ‹©ç¯èŠ‚ï¼› å°†å·²è®­ç»ƒæ¨¡å‹éƒ¨ç½²åˆ°åœ¨çº¿æœåŠ¡ç³»ç»Ÿï¼Œå¹¶ç”¨äºç¦»çº¿å¤„ç†ï¼› é€šè¿‡æ¨èå’Œç›®æ ‡é¡µé¢å°†æ¨¡å‹ç»“æœåé¦ˆåˆ°MovieStreamç«™ç‚¹ï¼› å°†æ¨¡å‹ç»“æœè¿”å›åˆ°MovieStreamçš„ä¸ªæ€§åŒ–è¥é”€æ¸ é“ï¼› ä½¿ç”¨ç¦»çº¿æ¨¡å‹æ¥ä¸ºMovieSteamçš„å„ä¸ªå›¢é˜Ÿæä¾›å·¥å…·ï¼Œä»¥å¸®åŠ©å…¶ç†è§£ç”¨æˆ·çš„è¡Œä¸ºã€å†…å®¹ç›®å½•çš„ç‰¹ç‚¹å’Œä¸šåŠ¡æ”¶å…¥çš„é©±åŠ¨å› ç´ ã€‚","categories":[{"name":"spark","slug":"spark","permalink":"http://iequa.com/categories/spark/"}],"tags":[{"name":"spark","slug":"spark","permalink":"http://iequa.com/tags/spark/"},{"name":"machine-learning","slug":"machine-learning","permalink":"http://iequa.com/tags/machine-learning/"}]},{"title":"JVM è·¨å¹³å°ä¸å­—èŠ‚ç åŸç†åˆæ­¥","slug":"java/java-special-arms-p3-jvm","date":"2016-08-16T08:54:16.000Z","updated":"2019-10-20T04:30:35.030Z","comments":true,"path":"2016/08/16/java/java-special-arms-p3-jvm/","link":"","permalink":"http://iequa.com/2016/08/16/java/java-special-arms-p3-jvm/","excerpt":"Javaç‰¹ç§å…µ - JVM è·¨å¹³å°ä¸å­—èŠ‚ç åŸç†ï¼ŒReading Notes","text":"Javaç‰¹ç§å…µ - JVM è·¨å¹³å°ä¸å­—èŠ‚ç åŸç†ï¼ŒReading Notes ç”¨åˆ° JVM çš„åœºæ™¯ Out of memory æ—¶ï¼Œå›¢é˜Ÿé«˜æ‰‹ä¸åœ¨ ç³»ç»ŸæœåŠ¡å™¨æ¶æ„ï¼Œè€å¤§é—®ä½  æŠ•å…¥å¤šå°‘æœåŠ¡å™¨æˆæœ¬ï¼ŒVM åˆ†é…å¤šå¤§ï¼Œ å¦‚ä½•åˆ†é…? 1. javap å‘½ä»¤ é€šè¿‡è¿™ç§æ–¹å¼è®¤çŸ¥æ¯” Java æ›´ä½ä¸€ä¸ªæŠ½è±¡å±‚æ¬¡çš„é€»è¾‘ï¼Œè™šæŒ‡ä»¤æœ‰æ—¶å€™æ›´å¥½è§£é‡Šé—®é¢˜ã€‚ public class StringTest &#123; public static void test1() &#123; String a = &quot;a&quot; + &quot;b&quot; + 1; String b = &quot;ab1&quot;; System.out.println(a == b); // true ç¼–è¯‘æ—¶ä¼˜åŒ– &#125;&#125; âœ p3jvm git:(master) âœ— pwd/Users/hp/ghome/github/language/java/jsarms/p3jvmâœ p3jvm git:(master) âœ— javacUsage: javac &lt;options&gt; &lt;source files&gt;where possible options include: -g Generate all debugging info -g:none Generate no debugging info -g:&#123;lines,vars,source&#125; Generate only some debugging info -nowarn Generate no warnings -verbose Output messages about what the compiler is doing âœ p3jvm git:(master) âœ— javac -g:vars,lines StringTest.javaâœ p3jvm git:(master) âœ— javap -verbose StringTestClassfile /Users/hp/ghome/github/language/java/jsarms/p3jvm/StringTest.class Last modified Aug 16, 2016; size 559 bytes MD5 checksum 772d18512cb982c953e7db8c72522918public class StringTest minor version: 0 major version: 51 flags: ACC_PUBLIC, ACC_SUPERConstant pool: #1 = Methodref #6.#21 // java/lang/Object.&quot;&lt;init&gt;&quot;:()V #2 = String #22 // ab1 #3 = Fieldref #23.#24 // java/lang/System.out:Ljava/io/PrintStream; #4 = Methodref #25.#26 // java/io/PrintStream.println:(Z)V #5 = Class #27 // StringTest #6 = Class #28 // java/lang/Object #7 = Utf8 &lt;init&gt; #8 = Utf8 ()V #9 = Utf8 Code #10 = Utf8 LineNumberTable #11 = Utf8 LocalVariableTable #12 = Utf8 this #13 = Utf8 LStringTest; #14 = Utf8 test1 #15 = Utf8 a #16 = Utf8 Ljava/lang/String; #17 = Utf8 b #18 = Utf8 StackMapTable #19 = Class #29 // java/lang/String #20 = Class #30 // java/io/PrintStream #21 = NameAndType #7:#8 // &quot;&lt;init&gt;&quot;:()V #22 = Utf8 ab1 #23 = Class #31 // java/lang/System #24 = NameAndType #32:#33 // out:Ljava/io/PrintStream; #25 = Class #30 // java/io/PrintStream #26 = NameAndType #34:#35 // println:(Z)V #27 = Utf8 StringTest #28 = Utf8 java/lang/Object #29 = Utf8 java/lang/String #30 = Utf8 java/io/PrintStream #31 = Utf8 java/lang/System #32 = Utf8 out #33 = Utf8 Ljava/io/PrintStream; #34 = Utf8 println #35 = Utf8 (Z)V// ä»¥ä¸Šæ˜¯ Constant poolï¼Œ ä»…ä»…æ˜¯é™ˆåˆ—æ“ä½œï¼Œå¹¶æ²¡æœ‰å¼€å§‹æ‰§è¡Œä»»åŠ¡ï¼Œçœ‹ä¸‹é¢å¼€å§‹&#123; public StringTest(); flags: ACC_PUBLIC Code: stack=1, locals=1, args_size=1 // æ‰€æœ‰æ–¹æ³•éƒ½ä¼šæœ‰ã€‚ // stack ä¸ºæ ˆé¡¶çš„å•ä½å¤§å° (æ¯ä¸ªå¤§å°ä¸º 1 slotï¼Œ4 byte) // locals=1ï¼Œéé™æ€æ–¹æ³•ï¼Œæœ¬åœ°å˜é‡å¢åŠ  this 0: aload_0 1: invokespecial #1 // Method java/lang/Object.&quot;&lt;init&gt;&quot;:()V 4: return LineNumberTable: line 1: 0 LocalVariableTable: Start Length Slot Name Signature 0 5 0 this LStringTest; public static void test1(); flags: ACC_PUBLIC, ACC_STATIC Code: stack=3, locals=2, args_size=0 // stack=3ï¼Œæœ¬åœ°æ ˆslotä¸ªæ•°ä¸º3ï¼ŒStringéœ€è¦loadï¼ŒString.out å ç”¨ä¸€ä¸ªå†ã€‚å½“å¯¹æ¯”å‘ç”Ÿ boolean æ—¶ï¼Œä¸¤ä¸ªStringå¼•ç”¨æ ˆé¡¶pop // locals=2ï¼Œ å› ä¸ºåªæœ‰ä¸¤ä¸ª String // args_size=0ï¼Œæ–¹æ³•æ²¡æœ‰å…¥å£å‚æ•° 0: ldc #2 // String ab1 // å¼•ç”¨å¸¸é‡æ± å†…å®¹ 2: astore_0 // å°†æ ˆé¡¶å¼•ç”¨å€¼ï¼Œå†™å…¥ç¬¬ 1 ä¸ª slot æ‰€åœ¨çš„æœ¬åœ°å˜é‡ 3: ldc #2 // String ab1 5: astore_1 6: getstatic #3 // Field java/lang/System.out:Ljava/io/PrintStream; // è·å–é™æ€åŸŸï¼Œæ”¾å…¥æ ˆé¡¶ï¼Œæ­¤æ—¶é™æ€åŸŸæ˜¯ System.out å¯¹è±¡ 9: aload_0 10: aload_1 11: if_acmpne 18 14: iconst_1 15: goto 19 18: iconst_0 19: invokevirtual #4 // Method java/io/PrintStream.println:(Z)V 22: return LineNumberTable: line 4: 0 line 5: 3 line 6: 6 line 7: 22 LocalVariableTable: Start Length Slot Name Signature 3 20 0 a Ljava/lang/String; 6 17 1 b Ljava/lang/String; // æœ¬åœ°å˜é‡åˆ—è¡¨ LocalVariableTable. from javac -g:vars StackMapTable: number_of_entries = 2 frame_type = 255 /* full_frame */ offset_delta = 18 locals = [ class java/lang/String, class java/lang/String ] stack = [ class java/io/PrintStream ] frame_type = 255 /* full_frame */ offset_delta = 0 locals = [ class java/lang/String, class java/lang/String ] stack = [ class java/io/PrintStream, int ]&#125;âœ p3jvm git:(master) âœ— 2. Java å­—èŠ‚ç ç»“æ„javac å‘½ä»¤æœ¬èº«åªæ˜¯ä¸€ä¸ªå¼•å¯¼å™¨ï¼Œå®ƒå¼•å¯¼ç¼–è¯‘å™¨ç¨‹åºçš„è¿è¡Œã€‚ç¼–è¯‘å™¨æœ¬èº«æ˜¯ä¸€ä¸ªjavaç¨‹åº com.sun.tools.javac.main.JavaCompiler, è¯¥ç±»å®Œæˆ java æºæ–‡ä»¶ çš„ Parserã€Annotation processã€æ£€æŸ¥ã€æ³›å‹å¤„ç†ã€è¯­æ³•è½¬æ¢ç­‰ï¼Œæœ€ç»ˆèƒœå‡º Class æ–‡ä»¶ã€‚ Java å­—èŠ‚ç æ–‡ä»¶ä¸»ä½“ç»“æ„: Class æ–‡ä»¶å¤´éƒ¨ Constant pool å½“å‰Clasçš„æè¿°ä¿¡æ¯ å±æ€§åˆ—è¡¨ æ–¹æ³•åˆ—è¡¨ â€¦","categories":[{"name":"java","slug":"java","permalink":"http://iequa.com/categories/java/"}],"tags":[{"name":"java","slug":"java","permalink":"http://iequa.com/tags/java/"},{"name":"jvm","slug":"jvm","permalink":"http://iequa.com/tags/jvm/"}]},{"title":"Decision Tree part1","slug":"ml/decisionTree-part1","date":"2016-08-16T08:43:21.000Z","updated":"2019-10-20T04:30:35.046Z","comments":true,"path":"2016/08/16/ml/decisionTree-part1/","link":"","permalink":"http://iequa.com/2016/08/16/ml/decisionTree-part1/","excerpt":"å†³ç­–æ ‘ï¼ˆdecision treeï¼‰æ˜¯ä¸€ä¸ªæ ‘ç»“æ„ï¼ˆå¯ä»¥æ˜¯äºŒå‰æ ‘æˆ–éäºŒå‰æ ‘ï¼‰ã€‚å…¶æ¯ä¸ªéå¶èŠ‚ç‚¹è¡¨ç¤ºä¸€ä¸ªç‰¹å¾å±æ€§ä¸Šçš„æµ‹è¯•ï¼Œæ¯ä¸ªåˆ†æ”¯ä»£è¡¨è¿™ä¸ªç‰¹å¾å±æ€§åœ¨æŸä¸ªå€¼ã€‚","text":"å†³ç­–æ ‘ï¼ˆdecision treeï¼‰æ˜¯ä¸€ä¸ªæ ‘ç»“æ„ï¼ˆå¯ä»¥æ˜¯äºŒå‰æ ‘æˆ–éäºŒå‰æ ‘ï¼‰ã€‚å…¶æ¯ä¸ªéå¶èŠ‚ç‚¹è¡¨ç¤ºä¸€ä¸ªç‰¹å¾å±æ€§ä¸Šçš„æµ‹è¯•ï¼Œæ¯ä¸ªåˆ†æ”¯ä»£è¡¨è¿™ä¸ªç‰¹å¾å±æ€§åœ¨æŸä¸ªå€¼ã€‚ 1. Classification Introduce åˆ†ç±»æœ‰ç€å¹¿æ³›çš„åº”ç”¨ï¼Œå¦‚åŒ»å­¦ç–¾ç—…åˆ¤åˆ«ã€åƒåœ¾é‚®ä»¶è¿‡æ»¤ã€åƒåœ¾çŸ­ä¿¡æ‹¦æˆªã€å®¢æˆ·åˆ†æç­‰ç­‰ã€‚åˆ†ç±»é—®é¢˜å¯ä»¥åˆ†ä¸ºä¸¤ç±» 1.1 å½’ç±» : ç¦»æ•£å½’ç±» æ˜¯æŒ‡å¯¹ç¦»æ•£æ•°æ®çš„åˆ†ç±»ï¼Œæ¯”å¦‚å¯¹æ ¹æ®ä¸€ä¸ªäººçš„ç¬”è¿¹åˆ¤åˆ«è¿™ä¸ªæ˜¯ç”·è¿˜æ˜¯å¥³ï¼Œè¿™é‡Œçš„ Category åªæœ‰ä¸¤ä¸ªï¼Œç±»åˆ«æ˜¯ç¦»æ•£çš„é›†åˆç©ºé—´{ç”·ï¼Œå¥³}çš„ã€‚ 1.2 é¢„æµ‹ : è¿ç»­é¢„æµ‹ æ˜¯æŒ‡å¯¹è¿ç»­æ•°æ®çš„åˆ†ç±»ï¼Œæ¯”å¦‚é¢„æµ‹æ˜å¤©8ç‚¹å¤©æ°”çš„æ¹¿åº¦æƒ…å†µï¼Œå¤©æ°”çš„æ¹¿åº¦åœ¨éšæ—¶å˜åŒ–ï¼Œ8ç‚¹æ—¶çš„å¤©æ°”æ˜¯ä¸€ä¸ªå…·ä½“å€¼ï¼Œå®ƒä¸å±äºæŸä¸ªæœ‰é™é›†åˆç©ºé—´ã€‚é¢„æµ‹ä¹Ÿå«å›å½’åˆ†æï¼Œåœ¨é‡‘èé¢†åŸŸæœ‰ç€å¹¿æ³›åº”ç”¨ã€‚ è™½ç„¶å¯¹ç¦»æ•£æ•°æ®å’Œè¿ç»­æ•°æ®çš„å¤„ç†æ–¹å¼æœ‰æ‰€ä¸åŒï¼Œä½†å…¶å®ä»–ä»¬ä¹‹é—´ç›¸äº’è½¬åŒ–ï¼Œæ¯”å¦‚æˆ‘ä»¬å¯ä»¥æ ¹æ®æ¯”è¾ƒçš„æŸä¸ªç‰¹å¾å€¼åˆ¤æ–­ï¼Œå¦‚æœå€¼å¤§äº0.5å°±è®¤å®šä¸ºç”·æ€§ï¼Œå°äºç­‰äº0.5å°±è®¤ä¸ºæ˜¯å¥³æ€§ï¼Œè¿™æ ·å°±è½¬åŒ–ä¸ºè¿ç»­å¤„ç†æ–¹å¼ï¼›å°†å¤©æ°”æ¹¿åº¦å€¼åˆ†æ®µå¤„ç†ä¹Ÿå°±è½¬åŒ–ä¸ºç¦»æ•£æ•°æ®ã€‚ æ•°æ®åˆ†ç±» åˆ†ä¸¤ä¸ªæ­¥éª¤ï¼š æ„é€ æ¨¡å‹ï¼Œåˆ©ç”¨è®­ç»ƒæ•°æ®é›† è®­ç»ƒ åˆ†ç±»å™¨ï¼› åˆ©ç”¨å»ºå¥½çš„åˆ†ç±»å™¨æ¨¡å‹å¯¹æµ‹è¯•æ•°æ®è¿›è¡Œåˆ†ç±»ã€‚ å¥½çš„åˆ†ç±»å™¨å…·æœ‰å¾ˆå¥½çš„æ³›åŒ–èƒ½åŠ›ï¼Œå³å®ƒä¸ä»…åœ¨è®­ç»ƒæ•°æ®é›†ä¸Šèƒ½è¾¾åˆ°å¾ˆé«˜çš„æ­£ç¡®ç‡ï¼Œè€Œä¸”èƒ½åœ¨æœªè§è¿‡å¾—æµ‹è¯•æ•°æ®é›†ä¹Ÿèƒ½è¾¾åˆ°è¾ƒé«˜çš„æ­£ç¡®ç‡ã€‚å¦‚æœä¸€ä¸ªåˆ†ç±»å™¨åªæ˜¯åœ¨è®­ç»ƒæ•°æ®ä¸Šè¡¨ç°ä¼˜ç§€ï¼Œä½†åœ¨æµ‹è¯•æ•°æ®ä¸Šè¡¨ç°ç¨€çƒ‚ï¼Œè¿™ä¸ªåˆ†ç±»å™¨å°±å·²ç»è¿‡æ‹Ÿåˆäº†ï¼Œå®ƒåªæ˜¯æŠŠè®­ç»ƒæ•°æ®è®°ä¸‹æ¥äº†ï¼Œå¹¶æ²¡æœ‰æŠ“åˆ°æ•´ä¸ªæ•°æ®ç©ºé—´çš„ç‰¹å¾ã€‚ 2. Decision Treeâ€™ Classificationä»£è¡¨æ€§çš„ä¾‹å­è¯´æ˜ : ID é˜´æ™´(F) æ¸©åº¦(F) æ¹¿åº¦(F) åˆ®é£(F) æ˜¯å¦ç©ï¼ˆCï¼‰ 1 sunny hot high false å¦ 2 sunny hot high true å¦ 3 overcast hot high false æ˜¯ 4 rainy mild high false æ˜¯ 5 rainy cool normal false æ˜¯ 6 rainy cool normal true å¦ 7 overcast cool normal true æ˜¯ 8 sunny mild high false å¦ 9 sunny cool normal false æ˜¯ 10 rainy mild normal false æ˜¯ 11 sunny mild normal true æ˜¯ 12 overcast mild high true æ˜¯ 13 overcast hot normal false æ˜¯ 14 rainy mild high true å¦ åˆ©ç”¨ID3ç®—æ³•ä¸­çš„ Info Gain Feature Selectionï¼Œé€’å½’çš„å­¦ä¹ ä¸€æ£µå†³ç­–æ ‘ï¼Œå¾—åˆ°æ ‘ç»“æ„å¦‚ä¸‹ å†³ç­–æ ‘ï¼ˆdecision treeï¼‰æ˜¯ä¸€ä¸ªæ ‘ç»“æ„ï¼ˆå¯ä»¥æ˜¯äºŒå‰æ ‘æˆ–éäºŒå‰æ ‘ï¼‰ã€‚å…¶æ¯ä¸ªéå¶èŠ‚ç‚¹è¡¨ç¤ºä¸€ä¸ªFeatureå±æ€§ä¸Šçš„æµ‹è¯•ï¼Œæ¯ä¸ªåˆ†æ”¯ä»£è¡¨è¿™ä¸ªFeatureå±æ€§åœ¨æŸä¸ªå€¼åŸŸä¸Šçš„è¾“å‡ºï¼Œè€Œæ¯ä¸ªå¶èŠ‚ç‚¹å­˜æ”¾ä¸€ä¸ª Category ã€‚ä½¿ç”¨ DT è¿›è¡Œå†³ç­–çš„è¿‡ç¨‹å°±æ˜¯ä» root å¼€å§‹ï¼Œæµ‹è¯•å¾…åˆ†ç±»é¡¹ä¸­ç›¸åº”çš„ Feature å±æ€§ï¼Œå¹¶æŒ‰ç…§å…¶å€¼é€‰æ‹©è¾“å‡ºåˆ†æ”¯ï¼Œç›´åˆ°åˆ°è¾¾å¶å­èŠ‚ç‚¹ï¼Œå°†å¶å­èŠ‚ç‚¹å­˜æ”¾çš„ Category ä½œä¸ºå†³ç­–ç»“æœã€‚ Feature Selectionï¼Œå¦‚ä½•é‡åŒ–æœ€ä¼˜Feature? -&gt; å¯¼è‡´ DT Algorithm å‡ºç°äº† ID3ã€C4.5ã€C5.0ã€CART ç­‰ã€‚ 3. Decision Treeâ€™ Buildæ„é€  Decision Tree çš„å…³é”®æ­¥éª¤æ˜¯åˆ†è£‚å±æ€§ã€‚æ‰€è°“åˆ†è£‚å±æ€§å°±æ˜¯åœ¨æŸä¸ªèŠ‚ç‚¹å¤„æŒ‰ç…§æŸä¸€ç‰¹å¾å±æ€§çš„ä¸åŒåˆ’åˆ†æ„é€ ä¸åŒçš„åˆ†æ”¯ï¼Œå…¶ç›®æ ‡æ˜¯è®©å„ä¸ªåˆ†è£‚å­é›†å°½å¯èƒ½åœ°â€œçº¯â€ã€‚å°½å¯èƒ½â€œçº¯â€å°±æ˜¯å°½é‡è®©ä¸€ä¸ªåˆ†è£‚å­é›†ä¸­å¾…åˆ†ç±»é¡¹å±äºåŒä¸€ç±»åˆ«ã€‚ æ„é€ å†³ç­–æ ‘çš„è¿‡ç¨‹æœ¬è´¨ä¸Šå°±æ˜¯æ ¹æ® data-feature å°† æ•°æ®é›†(D) åˆ†ç±»çš„é€’å½’è¿‡ç¨‹ï¼Œæˆ‘ä»¬éœ€è¦è§£å†³çš„ç¬¬ä¸€ä¸ªé—®é¢˜å°±æ˜¯ï¼Œå½“å‰ æ•°æ®é›†(D) ä¸Šå“ªä¸ª Feature åœ¨åˆ’åˆ†æ•°æ®åˆ†ç±»æ—¶èµ·å†³å®šæ€§ä½œç”¨ 3.1 æ„é€  DT æµç¨‹è®­ç»ƒæ•°æ®é›† $D = \\{ (x^{(1)}ï¼Œy^{(1)}) ï¼Œ (x^{(2)}ï¼Œy^{(2)})ï¼Œ â‹¯ ï¼Œ (x^{(m)}ï¼Œy^{(m)}) \\}$ (Featureç”¨ç¦»æ•£å€¼è¡¨ç¤º)å€™é€‰ç‰¹å¾é›† $F = \\{f^1ï¼Œf^2ï¼Œ â‹¯ï¼Œf^n \\}$ å¼€å§‹å»ºç«‹ RootèŠ‚ç‚¹ï¼Œå°†æ‰€æœ‰è®­ç»ƒæ•°æ®éƒ½ç½®äºæ ¹èŠ‚ç‚¹ï¼ˆ$m$æ¡æ ·æœ¬ï¼‰ã€‚ä» featureé›†åˆ $F$ ä¸­é€‰æ‹©ä¸€ä¸ªæœ€ä¼˜ç‰¹å¾ $f^âˆ—$ï¼ŒæŒ‰ç…§ $f^âˆ—$ å–å€¼å°† è®­ç»ƒæ•°æ®é›†(D) åˆ‡åˆ†æˆè‹¥å¹²å­é›†ï¼Œä½¿å¾—å„ä¸ªè‡ªå·±æœ‰ä¸€ä¸ªåœ¨å½“å‰æ¡ä»¶ä¸‹æœ€å¥½çš„åˆ†ç±»ã€‚ å¦‚æœå­é›†ä¸­æ ·æœ¬ç±»åˆ«åŸºæœ¬ç›¸åŒï¼Œé‚£ä¹ˆæ„å»ºå¶èŠ‚ç‚¹ï¼Œå¹¶å°†æ•°æ®å­é›†åˆ’åˆ†ç»™å¯¹åº”çš„å¶èŠ‚ç‚¹ï¼›å¦‚æœå­é›†ä¸­æ ·æœ¬ç±»åˆ«å·®å¼‚è¾ƒå¤§ï¼Œä¸èƒ½è¢«åŸºæœ¬æ­£ç¡®åˆ†ç±»ï¼Œéœ€è¦åœ¨å‰©ä¸‹çš„ç‰¹å¾é›†åˆ $ï¼ˆFâˆ’{f^âˆ—}ï¼‰$ ä¸­é€‰æ‹©æ–°çš„æœ€ä¼˜ç‰¹å¾ï¼Œç»§ç»­å¯¹æ•°æ®å­é›†è¿›è¡Œåˆ‡åˆ†ã€‚å¦‚æ­¤é€’å½’åœ°è¿›è¡Œä¸‹å»ï¼Œç›´è‡³æ‰€æœ‰æ•°æ®è‡ªå·±éƒ½èƒ½è¢«åŸºæœ¬æ­£ç¡® Categoryï¼Œæˆ–è€…æ²¡æœ‰åˆé€‚çš„æœ€ä¼˜ç‰¹å¾ä¸ºæ­¢ã€‚ è¿™æ ·æœ€ç»ˆç»“æœæ˜¯æ¯ä¸ªå­é›†éƒ½è¢«åˆ†åˆ°å¶èŠ‚ç‚¹ä¸Šï¼Œå¯¹åº”ç€ä¸€ä¸ªæ˜ç¡®çš„ç±»åˆ«ã€‚é‚£ä¹ˆï¼Œé€’å½’ç”Ÿæˆçš„å±‚çº§ç»“æ„å³ä¸ºä¸€æ£µ DTã€‚ 3.2 ä¼ªä»£ç æ„é€  DT è¾“å…¥ : è®­ç»ƒæ•°æ®é›† $D = \\{ (x^{(1)}ï¼Œy^{(1)}) ï¼Œ (x^{(2)}ï¼Œy^{(2)})ï¼Œ â‹¯ ï¼Œ (x^{(m)}ï¼Œy^{(m)}) \\}$(Featureç”¨ç¦»æ•£å€¼è¡¨ç¤º)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;å€™é€‰ç‰¹å¾é›† $F = \\{f^1ï¼Œf^2ï¼Œ â‹¯ï¼Œf^n \\}$ è¾“å‡º : T(D, F) å†³ç­–æ ‘å­¦ä¹ è¿‡ç¨‹ä¸­é€’å½’çš„æ¯ä¸€æ­¥ï¼Œåœ¨é€‰æ‹©æœ€ä¼˜ç‰¹å¾åï¼Œæ ¹æ®ç‰¹å¾å–å€¼åˆ‡å‰²å½“å‰èŠ‚ç‚¹çš„æ•°æ®é›†ï¼Œå¾—åˆ°è‹¥å¹²æ•°æ®å­é›†ã€‚ç®—æ³•çš„æ—¶é—´å¤æ‚åº¦æ˜¯O(k|D|log(|D|))ï¼Œkä¸ºå±æ€§ä¸ªæ•°ï¼Œ|D|ä¸ºè®°å½•é›†Dçš„è®°å½•æ•°ã€‚ 4. Feature Selectioné€’å½’åœ°é€‰æ‹©æœ€ä¼˜featureï¼Œæ ¹æ®featureå–å€¼åˆ‡å‰²æ•°æ®é›†ï¼Œä½¿å¾—å¯¹åº”çš„æ•°æ®å­é›†æœ‰ä¸€ä¸ªè¾ƒå¥½çš„åˆ†ç±»ã€‚ä»ä¼ªä»£ç ä¸­ä¹Ÿå¯ä»¥çœ‹å‡ºï¼Œåœ¨å†³ç­–æ ‘å­¦ä¹ è¿‡ç¨‹ä¸­ï¼Œæœ€é‡è¦çš„æ˜¯ç¬¬07è¡Œï¼Œå³å¦‚ä½•é€‰æ‹©æœ€ä¼˜featureï¼Ÿä¹Ÿå°±æ˜¯æˆ‘ä»¬å¸¸è¯´çš„featureé€‰æ‹©é—®é¢˜ã€‚ åœ¨è¿™é‡Œï¼Œå¸Œæœ›éšç€featureé€‰æ‹©è¿‡ç¨‹åœ°ä¸æ–­è¿›è¡Œï¼Œå†³ç­–æ ‘çš„åˆ†æ”¯èŠ‚ç‚¹æ‰€åŒ…å«çš„æ ·æœ¬å°½å¯èƒ½å±äºåŒä¸€ç±»åˆ«ï¼Œå³å¸Œæœ›èŠ‚ç‚¹çš„â€çº¯åº¦ï¼ˆpurityï¼‰â€è¶Šæ¥è¶Šé«˜ã€‚ å¦‚å­é›†ä¸­çš„æ ·æœ¬éƒ½å±äºåŒä¸€ä¸ªç±»åˆ«ï¼Œæ˜¯æœ€å¥½çš„ç»“æœï¼›å¦‚æœè¯´å¤§å¤šæ•°çš„æ ·æœ¬ç±»å‹ç›¸åŒï¼Œåªæœ‰å°‘éƒ¨åˆ†æ ·æœ¬ä¸åŒï¼Œä¹Ÿå¯ä»¥æ¥å—ã€‚ é‚£ä¹ˆå¦‚ä½•æ‰èƒ½åšåˆ°é€‰æ‹©çš„ç‰¹å¾å¯¹åº”çš„æ ·æœ¬å­é›†çº¯åº¦æœ€é«˜å‘¢ï¼Ÿ Algorithm Feature é€‰æ‹©æ–¹æ³• Author ID3 Information gain Quinlan. 1986 C4.5 Gain ratio Quinlan. 1993. CART å›å½’æ ‘ï¼š æœ€å°äºŒä¹˜åˆ†ç±»æ ‘ï¼š åŸºå°¼æŒ‡æ•° Gini index Breiman. 1984(Classification and Regression Tree åˆ†ç±»ä¸å›å½’æ ‘) ID3 (Iterative Dichotomiser) 4.1 Information Gainä¿¡æ¯å¢ç›Šï¼ˆInformation Gainï¼‰è¡¡é‡ Feature çš„é‡è¦æ€§æ˜¯æ ¹æ®å½“å‰ Feature ä¸ºåˆ’åˆ†å¸¦æ¥å¤šå°‘ä¿¡æ¯é‡ï¼Œå¸¦æ¥çš„ä¿¡æ¯è¶Šå¤šï¼Œè¯¥ Feature å°±è¶Šé‡è¦ï¼Œæ­¤æ—¶èŠ‚ç‚¹çš„â€çº¯åº¦â€ä¹Ÿå°±è¶Šé«˜ã€‚ Infomation Entropy å¯¹ä¸€ä¸ªåˆ†ç±»ç³»ç»Ÿæ¥è¯´ï¼Œå‡è®¾ç±»åˆ« $C$ å¯èƒ½çš„å–å€¼ä¸º $c_1ï¼Œc_2ï¼Œâ‹¯ï¼Œc_k$ï¼ˆ$k$æ˜¯ç±»åˆ«æ€»æ•°ï¼‰ï¼Œæ¯ä¸€ä¸ªç±»åˆ«å‡ºç°çš„æ¦‚ç‡åˆ†åˆ«æ˜¯ $p(c_1)ï¼Œp(c_2)ï¼Œâ‹¯ï¼Œp(c_k)$ã€‚æ­¤æ—¶ï¼Œåˆ†ç±»ç³»ç»Ÿçš„ Entropy å¯ä»¥è¡¨ç¤ºä¸º: info(C) = - \\sum_{i=1}^k p(c\\_i) \\cdot log\\_2 p(c\\_i) \\qquad (fml.4.1.1)åˆ†ç±»ç³»ç»Ÿçš„ä½œç”¨å°±æ˜¯è¾“å‡ºä¸€ä¸ªç‰¹å¾å‘é‡ï¼ˆæ–‡æœ¬ç‰¹å¾ã€IDç‰¹å¾ ç­‰ï¼‰å±äºå“ªä¸ª Category çš„å€¼ï¼Œè€Œè¿™ä¸ªå€¼å¯èƒ½æ˜¯ $c_1ï¼Œc_2ï¼Œâ‹¯ï¼Œc_k$ ï¼Œå› æ­¤è¿™ä¸ªå€¼æ‰€æºå¸¦çš„ä¿¡æ¯é‡å°±æ˜¯ (fml.4.1.1) å…¬å¼è¿™ä¹ˆå¤š Condition Entropy å‡è®¾ ç¦»æ•£ç‰¹å¾ $f$ çš„å–å€¼æœ‰ $I$ ä¸ªï¼Œ$info(C|f=f_i)$ è¡¨ç¤ºç‰¹å¾ $f$ è¢«å–å€¼ä¸º $f_i$ æ—¶çš„Condition Entropyï¼› $info(C|f)$ æ˜¯æŒ‡ç‰¹å¾ $f$ è¢«å›ºå®šæ—¶çš„ Condition Entropyã€‚äºŒè€…ä¹‹é—´çš„å…³ç³»æ˜¯ï¼š \\begin{align} info(C|f) & = p\\_1 \\cdot info(C|f=f\\_1) + p\\_2 \\cdot info(C|f=f\\_2) + ... + p\\_k \\cdot info(C|f=f\\_{k}) \\\\\\ & = \\sum_{i=1}^{I} p\\_i \\cdot info(C|f=f\\_i) \\end{align} \\quad (fml.4.1.2)å‡è®¾æ€»æ ·æœ¬æ•°æœ‰ $m$ æ¡ï¼Œç‰¹å¾ $f=f_i$ æ—¶çš„æ ·æœ¬æ•° $m_iï¼Œp_i=\\frac{m_i}{m}$. å¦‚ä½•æ±‚ $P(C|f=f_i)$ ? äºŒåˆ†ç±»æƒ…å†µ : ä»¥äºŒåˆ†ç±»ä¸ºä¾‹ï¼ˆæ­£ä¾‹ä¸º1ï¼Œè´Ÿä¾‹ä¸º0ï¼‰ï¼Œæ€»æ ·æœ¬æ•°ä¸º $m$ æ¡ï¼Œç‰¹å¾ $f$ çš„å–å€¼ä¸º $I$ ä¸ªï¼Œå…¶ä¸­ç‰¹å¾ $f=f_i$ å¯¹åº”çš„æ ·æœ¬æ•°ä¸º $m_i$ æ¡ï¼Œå…¶ä¸­æ­£ä¾‹ $m_{i1}$ æ¡ï¼Œè´Ÿä¾‹ $m_{i0}$ æ¡ $m_i = m_{i0} + m_{i1}$ ã€‚é‚£ä¹ˆæœ‰ï¼š \\begin{align} info(C|f=f\\_i) & = - \\frac{m\\_{i1}}{m\\_i} \\cdot log\\_{2} \\frac{m\\_{i1}}{m\\_i} - \\frac{m\\_{i0}}{m\\_i} \\cdot log\\_{2} \\frac{m\\_{i0}}{m\\_i} \\end{align} \\qquad (fml.4.1.3)å¤šåˆ†ç±»æƒ…å†µ: \\begin{align} info(C|f=f\\_i) = -\\sum\\_{j=0}^{k-1} \\frac{m\\_{ij}}{m\\_i} \\cdot log\\_{2} \\frac{m\\_{ij}}{m\\_i} \\end{align} \\qquad (fml.4.1.4)å…¬å¼$\\frac{m_{ij}}{m_i}$ç‰©ç†å«ä¹‰æ˜¯å½“ $f=f_i$ ä¸” $C=c_j$ çš„æ¦‚ç‡ï¼Œå³æ¡ä»¶æ¦‚ç‡ $p(c_j|f_i)$ å› æ­¤ï¼ŒCondition Entropy è®¡ç®—å…¬å¼ä¸ºï¼š \\begin{align} info(C|f) & = \\sum\\_{i=1}^{I} p(f\\_i) \\cdot info(C|f=f\\_i) \\\\\\ & = - \\sum\\_{i=1}^{I} p(f\\_i) \\cdot \\underline { \\sum\\_{j=0}^{k-1} p(c\\_j|f\\_i) \\cdot log\\_2 p(c\\_j|f\\_i) } \\qquad (fml.4.1.5) \\end{align} ç‰¹å¾ $f$ ç»™ç³»ç»Ÿå¸¦æ¥çš„ info gain ç­‰äºç³»ç»ŸåŸæœ‰çš„ Entropy ä¸å›ºå®šç‰¹å¾ $f$ çš„ Condition Entropy ä¹‹å·®ï¼Œå…¬å¼è¡¨ç¤ºå¦‚ä¸‹: \\begin{align} IG(F) & = E(C) - E(C|F) \\\\\\ & = -\\sum\\_{i=1}^{k} p(c\\_i) \\cdot \\log\\_{2} p(c\\_i) + \\sum\\_{i=1}^{I} p(f\\_i) \\cdot \\underline { \\sum\\_{j=0}^{k-1} p(c\\_j|f\\_i) \\cdot log\\_2 p(c\\_j|f\\_i) } \\end{align} \\qquad (fml.4.1.6)$n$ è¡¨ç¤ºç‰¹å¾ $f$ å–å€¼ä¸ªæ•°ï¼Œ$k$ è¡¨ç¤ºç±»åˆ« $C$ ä¸ªæ•°ï¼Œ$\\sum_{j=0}^{n-1} \\frac{m_{ij}}{m_i} \\cdot log_{2} \\frac{m_{ij}}{m_i}$ è¡¨ç¤ºæ¯ä¸€ä¸ªç±»åˆ«å¯¹åº”çš„ Entropy ã€‚ ä¸‹é¢ä»¥å¤©æ°”æ•°æ®ä¸ºä¾‹,é€šè¿‡ Info gain é€‰æ‹©æœ€ä¼˜ feature çš„è¿‡ç¨‹ : æ ¹æ® é˜´æ™´ã€æ¸©åº¦ã€æ¹¿åº¦ å’Œ åˆ®é£ æ¥å†³å®šæ˜¯å¦å‡ºå»ç©ã€‚æ ·æœ¬ä¸­æ€»å…±æœ‰ 14 æ¡è®°å½•ï¼Œå–å€¼ä¸º æ˜¯(9ä¸ªæ­£æ ·æœ¬)ã€å¦(5ä¸ªè´Ÿæ ·æœ¬)ï¼Œç”¨ $S(9+,5âˆ’)$ è¡¨ç¤º. (1). åˆ†ç±»ç³»ç»Ÿçš„ Entropy : Entropy(S) = info(9,5) = (-\\frac{9}{14} _ llog\\_2 (\\frac{9}{14})) + (- \\frac{5}{14} _ llog\\_2 (\\frac{5}{14})) = 0.940ä½ \\quad (exp.4.1.1)(2). å¦‚æœä»¥ç‰¹å¾â€é˜´æ™´â€ä½œä¸ºæ ¹èŠ‚ç‚¹ã€‚â€œé˜´æ™´â€å–å€¼ä¸º{sunny, overcast, rainy}, åˆ†åˆ«å¯¹åº”çš„æ­£è´Ÿæ ·æœ¬æ•°åˆ†åˆ«ä¸º(2+,3-), (4+,0-), (3+,2-)ï¼Œé‚£ä¹ˆåœ¨è¿™ä¸‰ä¸ªèŠ‚ç‚¹ä¸Šçš„ info Entropy åˆ†åˆ«ä¸ºï¼š \\begin{align} & Entropy(S| â€œé˜´æ™´â€=sunny) = info(2,3) = 0.971ä½ \\quad(exp.4.1.1) \\\\\\ & Entropy(S| â€œé˜´æ™´â€=overcast) = info(4,0) = 0ä½ \\;\\;\\quad(exp.4.1.2) \\\\\\ & Entropy(S| â€œé˜´æ™´â€=rainy) = info(3,2) = 0.971ä½ \\;\\quad(exp.4.1.3) \\end{align}ä»¥ Feature â€œé˜´æ™´â€ ä¸ºæ ¹èŠ‚ç‚¹ï¼Œå¹³å‡ä¿¡æ¯å€¼ï¼ˆå³ Condition Entropyï¼‰ä¸ºï¼š Entropy(S|â€œé˜´æ™´â€) = \\frac{5}{14} \\* 0.971 + \\frac{4}{14} \\* 0 + \\frac{5}{14} \\* 0.971 = 0.693ä½ \\quad (exp.4.1.4)ä»¥ Feature â€œé˜´æ™´â€ ä¸ºæ¡ä»¶ï¼Œè®¡ç®—å¾—åˆ°çš„ Condition Entropy ä»£è¡¨äº†æœŸæœ›çš„ä¿¡æ¯æ€»é‡ï¼Œå³å¯¹äºä¸€ä¸ªæ–°æ ·æœ¬åˆ¤å®šå…¶å±äºå“ªä¸ªç±»åˆ«æ‰€å¿…éœ€çš„ä¿¡æ¯é‡ã€‚ (3). è®¡ç®—ç‰¹å¾â€œé˜´æ™´â€â€œé˜´æ™´â€å¯¹åº”çš„ä¿¡æ¯å¢ç›Š: IG( â€œé˜´æ™´â€) = Entropy(S) - Entropy(S| â€œé˜´æ™´â€) = 0.247ä½ \\quad\\quad(exp.4.1.5)åŒæ ·çš„è®¡ç®—æ–¹æ³•ï¼Œå¯å¾—æ¯ä¸ªç‰¹å¾å¯¹åº”çš„ä¿¡æ¯å¢ç›Šï¼Œå³ IG(â€œåˆ®é£â€) = Entropy(S) - Entropy(S|â€œåˆ®é£â€) = 0.048ä½ \\qquad\\qquad(exp.4.1.6) \\\\\\ IG(â€œæ¹¿åº¦â€) = Entropy(S) - Entropy(S|â€œæ¹¿åº¦â€) = 0.152ä½ \\qquad\\qquad(exp.4.1.7) \\\\\\ IG(â€œæ¸©åº¦â€) = Entropy(S) - Entropy(S|â€œæ¸©åº¦â€) = 0.029ä½ \\qquad\\qquad(exp.4.1.8)æ˜¾ç„¶ï¼ŒFeature â€œé˜´æ™´â€ çš„ info gain æœ€å¤§ï¼Œäºæ˜¯æŠŠå®ƒä½œä¸ºåˆ’åˆ†ç‰¹å¾ã€‚åŸºäºâ€œé˜´æ™´â€å¯¹æ ¹èŠ‚ç‚¹è¿›è¡Œåˆ’åˆ†çš„ç»“æœï¼Œå¦‚å›¾4.5æ‰€ç¤ºï¼ˆå†³ç­–æ ‘å­¦ä¹ è¿‡ç¨‹éƒ¨åˆ†ï¼‰ã€‚å†³ç­–æ ‘å­¦ä¹ ç®—æ³•å¯¹å­èŠ‚ç‚¹è¿›ä¸€æ­¥åˆ’åˆ†ï¼Œé‡å¤ä¸Šé¢çš„è®¡ç®—æ­¥éª¤ã€‚ 4.2 Gain ratioä¸ Info Gain ä¸åŒï¼ŒGain ratio çš„è®¡ç®—è€ƒè™‘äº† F åˆ†è£‚æ•°æ®é›†åæ‰€äº§ç”Ÿçš„å­èŠ‚ç‚¹çš„æ•°é‡å’Œè§„æ¨¡ï¼Œè€Œå¿½ç•¥ä»»ä½•æœ‰å…³ç±»åˆ«çš„ä¿¡æ¯ã€‚ ä»¥ info gain ç¤ºä¾‹ä¸ºä¾‹ï¼ŒæŒ‰ç…§ ç‰¹å¾â€œé˜´æ™´â€ å°†æ•°æ®é›†åˆ†è£‚æˆ3ä¸ªå­é›†ï¼Œè§„æ¨¡åˆ†åˆ«ä¸º5ã€4å’Œ5ï¼Œå› æ­¤ä¸è€ƒè™‘å­é›†ä¸­æ‰€åŒ…å«çš„ç±»åˆ«ï¼Œäº§ç”Ÿä¸€ä¸ªåˆ†è£‚ä¿¡æ¯ä¸ºï¼š SplitInfo(â€œé˜´æ™´â€) = info(5,4,5) = 1.577ä½ \\qquad (exp.4.2.1)Split Information Entropy å¯ç®€å•åœ°ç†è§£ä¸ºè¡¨ç¤ºä¿¡æ¯åˆ†æ”¯æ‰€éœ€è¦çš„ä¿¡æ¯é‡ã€‚ é‚£ä¹ˆ Info Gain ratio ï¼š IG\\_{ratio}(F) = \\frac {IG(F)} {SplitInfo(F)} \\qquad (exp.4.2.2)åœ¨è¿™é‡Œï¼Œç‰¹å¾ â€œé˜´æ™´â€çš„ Gain ratio ä¸º $IG_{ratio}( â€œé˜´æ™´â€)=\\frac{0.247}{1.577} = 0.157$ã€‚å‡å°‘ä¿¡æ¯å¢ç›Šæ–¹æ³•å¯¹å–å€¼æ•°è¾ƒå¤šçš„ç‰¹å¾çš„å½±å“ã€‚(å¯ä»¥å‡å°‘è¿‡æ‹Ÿåˆï¼Œè¿™ç­‰äºæ˜¯å¯¹ æŸç‰¹å¾å–å€¼è¿‡å¤šçš„ä¸€ä¸ªæƒ©ç½š) &gt;&gt;&gt; -(math.log((5.0/14.0), 2) * (5.0/14.0) * 2 + (4.0/14.0) * (math.log((4.0/14.0), 2)))1.577406282852345&gt;&gt;&gt; Reference é€—æ¯”ç®—æ³•å·¥ç¨‹å¸ˆã€ç®—æ³•æ‚è´§é“ºã€52caml å†³ç­–æ ‘ID3ã€C4.5ã€CARTç®—æ³•ï¼šä¿¡æ¯ç†µï¼ŒåŒºåˆ«ï¼Œå‰ªæç†è®ºæ€»ç»“ ã€Šæœºå™¨å­¦ä¹ å¯¼è®ºã€‹ã€Šç»Ÿè®¡å­¦ä¹ æ–¹æ³•ã€‹","categories":[{"name":"machine-learning","slug":"machine-learning","permalink":"http://iequa.com/categories/machine-learning/"}],"tags":[{"name":"decision-tree","slug":"decision-tree","permalink":"http://iequa.com/tags/decision-tree/"}]},{"title":"ä¸­å›½äººèµ·åå­¦é—®","slug":"tools/Chinese-named","date":"2016-08-12T23:54:16.000Z","updated":"2019-10-20T04:30:34.996Z","comments":true,"path":"2016/08/13/tools/Chinese-named/","link":"","permalink":"http://iequa.com/2016/08/13/tools/Chinese-named/","excerpt":"æˆ‘å¯¹ä¸­å›½äººèµ·åå­¦é—®çš„è‡ªæˆ‘ç ”ç©¶è®°å½•","text":"æˆ‘å¯¹ä¸­å›½äººèµ·åå­¦é—®çš„è‡ªæˆ‘ç ”ç©¶è®°å½• 1. äº”è¡Œå…«å­—ä»‹ç»1.1 äº”è¡Œ äº”è¡Œå°±æ˜¯å‘¨æ˜“ä¸­å¸¸è¯´çš„æœ¨ã€ç«ã€åœŸã€é‡‘ã€æ°´ã€‚æ˜“ç»ä¸­å„ç±»äº‹ç‰©å‡å¯ä»¥äº”è¡Œæ¥åŒºåˆ†ï¼Œå¦‚å¹²æ”¯ã€åœ°æ”¯ã€å­£èŠ‚ã€æ–¹ä½ã€äººä½“ã€é¢œè‰²ã€å‘³é“ç­‰ç­‰ã€‚äº”è¡Œæœ‰ç›¸ç”Ÿä¸ç›¸å…‹çš„ç‰¹è´¨ï¼Œå¾ˆå¤šçš„äº‹ç‰©å¯è—‰ç”±äº”è¡Œçš„è¿ç®—ï¼Œäº†è§£å…ƒç´ ä¹‹å…´è¡°ï¼Œæ¥åˆ¤åˆ«äº‹ç‰©çš„èµ·ä¼å˜åŒ–å’Œä½ ä¸€ç”Ÿçš„å¥½åå‰å‡¶ã€‚ 1.2 ä¸‰æ‰ ä¸‰æ‰é…ç½®å³å¤©ã€äººã€åœ°ã€‚ä¸­å›½ä¼ ç»Ÿæ–‡åŒ–ç†è§£äººç«‹è¶³äºå¤§åœ°ä¹‹ä¸Šï¼Œåœ¨å¤©ä¹‹ä¸‹ï¼Œå—åˆ°ä¸Šå¤©ä¹‹çœ·é¡¾ï¼Œå¤§åœ°çš„æ»‹å…»ï¼Œè€Œç”Ÿç”Ÿä¸æ¯ã€‚äº¦æœ‰é¡ºåº”å¤©æ—¶ã€åœ°åˆ©ã€äººå’Œçš„è¡Œäº‹å“²ç†ã€‚ä¸‰æ‰é…ç½®åœ¨å§“åå­¦ä¸­ï¼Œå æœ‰å¾ˆå¤§çš„åˆ†é‡ã€‚ 1.3 äº”æ ¼ äº”æ ¼é…ç½®æ˜¯æŒ‡å¤©æ ¼ã€åœ°æ ¼ã€äººæ ¼ã€å¤–æ ¼ã€æ€»æ ¼å…±äº”æ ¼ä¹‹é—´çš„å…³ç³»ã€‚å¤©æ ¼æ˜¯ç”±ç¥–å…ˆæµä¼ è€Œæ¥ï¼Œå•ç‹¬å‡ºç°å¯¹äººç”Ÿæ²¡æœ‰å¤šå¤§å½±å“;äººæ ¼æ˜¯å§“åå‰–è±¡æ•°ç†çš„ä¸­å¿ƒæ‰€åœ¨ï¼Œå¯¹äººç”Ÿçš„å½±å“æœ€å¤§;äººæ ¼ä¸åœ°æ ¼ç»“åˆçš„æ•°ç†åˆ™ä¸ºåŸºç¡€è¿ã€‚åœ°æ ¼ä¸»è¦æ˜¯36å²å‰çš„äººç”Ÿï¼Œä¹Ÿå«å‰è¿åŠ›ï¼Œå¤–æ ¼ä»£è¡¨äººçš„å¤–å›´ï¼Œå‰å‡¶æ— è°“ã€‚æ€»æ ¼æ˜¯36å²ä»¥åçš„äººç”Ÿï¼Œä¹Ÿæ˜¯åè¿åŠ›ã€‚äº”æ ¼é…ç½®åœ¨å§“åå­¦ä¸­å æœ‰ä¸»è¦ä½ç½®ã€‚ 2. åˆ¤æ–­äº”è¡Œæ‰€ç¼º èµ·åå­—ï¼Œéœ€è¦æ ¹æ®äº”è¡Œå…«å­—æ‰€ç¼ºå°‘çš„äº”è¡Œæ¥ç”¨ç›¸åº”çš„å±æ€§å­—(æ›´å‡†ç¡®çš„è¯´æ³•æ˜¯ç”¨å–œç”¨ç¥)æ¥å¡«è¡¥ï¼Œæ‰€ä»¥éœ€è¦åˆ¤æ–­äº”è¡Œæ‰€ç¼ºã€‚ è§£æå››æŸ±å…«å­—çš„ç²¾é«“å–œç”¨ç¥å–œç”¨ç¥ç™¾ç§‘å¦‚ä½•çŸ¥é“è‡ªå·±å…«å­—çš„å–œç¥ï¼Œç”¨ç¥ å…«å­—å°±æ˜¯ä»è¿™ä¸ªå¹³è¡¡ç†è®ºï¼Œå»åˆ†æäººä¸€ç”Ÿçš„èµ·è½ çŸ¥é“äº†äº”è¡Œçš„çŸ¥è¯†ï¼Œæˆ‘ä»¬ä¹ŸçŸ¥é“å¾ˆå¤šäººçš„å…«å­—äº”è¡Œéƒ½ä¸å¤ªé½å…¨ï¼Œæœ‰çš„ä¸åªç¼ºä¸€ä¸ªï¼Œè¿˜ä¼šç¼ºä¸¤ä¸ªç”šè‡³ä¸‰ä¸ªã€‚æ¯”å¦‚æˆ‘ä»¬å¸¸å¬è¯´çš„â€œäº”è¡Œç¼ºé‡‘â€ä¹‹ç±»çš„è¯ï¼Œé‚£ä¹ˆå¦‚ä½•çŸ¥é“èµ·åå­—äº”è¡Œç¼ºä»€ä¹ˆå‘¢? 2.1 åˆ¤æ–­äº”è¡Œå…«å­—åŠå–œç”¨ç¥æŸ¥è¯¢äº”è¡Œå…«å­—æ˜¯ä¸ºäº†çœ‹å…«å­—ä¸­ç¼ºå°‘äº”è¡Œä¸­çš„å“ªä¸€è¡Œ(ä»¥å–œç”¨ç¥ä¸ºå‡†)ï¼Œç„¶åç”¨åä¸­å­—å°½é‡è¡¥é½ : é‡‘ã€æœ¨ã€æ°´ã€ç«ã€åœŸ ä»¥ 2015å¹´10æœˆ11æ—¥13æ—¶30åˆ† ä¸ºä¾‹æŸ¥è¯¢æ£€éªŒåˆ¤æ–­äº”è¡Œå…«å­— ä»¥ä¸‹ç½‘å€æŸ¥è¯¢ç»“æœä¸€è‡´ : ä¸‰è—å…«å­—æŸ¥è¯¢ å‘¨æ˜“ç½‘ ä¸­å›½å¥åº·ç½‘ ä»¥ä¸‹ç½‘å€æŸ¥è¯¢ç»“æœä¸€è‡´ : ç¾åè…¾ æ˜“å®‰å±…ç®—å‘½ç½‘ æµ®å›¾å¡” ç”Ÿè¾°å…«å­—å–œç”¨ç¥æŸ¥è¯¢ ä¸­åå¿˜å¿§ç½‘ è¿™ç±»ç½‘å€å¾ˆå¤šï¼Œå¦‚ : ç¾åè…¾ã€å¤ªå¹³æ´‹äº²å­ç½‘ã€å‘¨æ˜“ç½‘ã€ä¸­å›½å¥åº·ç½‘ã€ä¸‰è—å…«å­—æŸ¥è¯¢ ç­‰ç­‰ã€‚è¯·è‡ªè¡Œåˆ¤æ–­æŸ¥è¯¢ç»“æœå‡†ç¡®æ€§ã€‚ å‘¨æ˜“ç½‘ã€ä¸­å›½å¥åº·ç½‘ã€ä¸‰è—å…«å­—æŸ¥è¯¢ç»“æœ ä¸ è€çˆ·ä¹¦ ä¸€è‡´ å–œç”¨ç¥æŸ¥è¯¢ä½ ä¹Ÿå¯ä»¥å‚è€ƒå¦‚ä¸‹ç½‘å€æŸ¥è¯¢ï¼Œä½†å‡†ç¡®æ€§è¯·è‡ªè¡Œè£æ–­ã€‚ ç¾åè…¾ æ˜“å®‰å±… æµ®å›¾å¡” babyqimingå–œç”¨ç¥ ä¼˜é…·è§†é¢‘: æ€ä¹ˆæ ·ç®—å…«å­— ä»€ä¹ˆæ˜¯å…«å­—å–œç”¨ç¥ å››æŸ± 2.2 äº”è¡Œä¸ç¼ºçš„æƒ…å†µäº”è¡Œä¸ç¼ºçš„æƒ…å†µï¼Œå‚è§ å–œç”¨ç¥ã€‚äº”è¡Œç¼ºå°‘çš„æƒ…å†µï¼Œå‚è§ å–œç”¨ç¥ï¼Œä½†åœ¨å¤šæ•°æƒ…å†µä¸‹ï¼Œç¼ºå°‘çš„ä¸€ä¸ªå°±ä¸ºå®ƒçš„å–œç”¨ç¥ï¼Œå…·ä½“å‚è§å–œç”¨ç¥æŸ¥è¯¢ã€‚ å–œç”¨ç¥æŸ¥è¯¢ ä¸ å…«å­—äº”è¡Œ æŸ¥è¯¢ï¼Œè¯·ä»”ç»†è¾¨åˆ«æŸ¥è¯¢çš„ç»“æœå¯é æ€§ã€‚ 3. å§“åç¬”ç”»å‰å‡¶ æ¨è 31 æˆ–è€… 23ç”» äºŒåä¸‰ç”» æ—­æ—¥å‡å¤©ï¼Œåæ˜¾å››æ–¹ï¼Œæ¸æ¬¡è¿›å±•ï¼Œç»ˆæˆå¤§ä¸šã€‚ ï¼ˆå‰ï¼‰ä¸‰åä¸€ç”» æ­¤æ•°å¤§å‰ï¼Œååˆ©åŒæ”¶ï¼Œæ¸è¿›å‘ä¸Šï¼Œå¤§ä¸šæˆå°±ã€‚ ï¼ˆå‰ï¼‰ è¯¦è§å§“åç¬”ç”»å‰å‡¶å¤§å…¨ èµ·åä¸­ç”¨å­—çš„ç¬”ç”»æ•°å‚è§ åº·å­å­—å…¸ (éç®€ä½“å­—æˆ–ç¹ä½“å­—) 4. æ‰‹æœºAPPçš„è¿ç”¨ ç¾åè…¾æ™ºèƒ½èµ·å APP â€¦ è¿ç”¨ç›¸å…³æ‰‹æœºappï¼Œå¯ä»¥æ›´æ–¹ä¾¿çš„è¾…åŠ©æƒ³å‡ºå¥½åå­— 5. å§“åæ‰“åˆ†æµ‹è¯•æ‰“åˆ†æµ‹è¯•è¿™ç§ç½‘ç«™æ¯”è¾ƒå¤šï¼Œæ ¹æ®æˆ‘ä¸ªäººçš„ç»éªŒåˆ¤åˆ«æˆ‘æ¨è ä¸‰è—ç½‘æ‰“åˆ†æµ‹è¯•ï¼Œæ ¹æ®ä¸‰è—ç½‘æŸ¥è¯¢çš„ç»“æœï¼Œå¯ä»¥çœ‹åˆ° ä¸‰æ‰äº”æ ¼çš„è§£æä»¥åŠåº·ç†™å­—å…¸çš„ç¬”ç”»æ•°ç›®ç­‰ã€‚ ä¸¾ä¾‹å¦‚ä¸‹ : 6. å°ç»“ç»¼ä¸Šæ‰€è¿°: èµ·åå­—åªéœ€è¦åœ¨åå­—ä¸­ï¼Œä½¿ç”¨å–œç”¨ç¥çš„å­— å¹¶ä¸” ä¸‰æ‰äº”æ ¼æ‰“åˆ† éƒ½æ¯”è¾ƒä¸é”™çš„æƒ…å†µä¸‹ï¼Œæ–¹ä¸ºå¥½åå­—ã€‚ ä¸ªäººæ„è§ : åå­—è¿˜æ˜¯ é¡ºè€³ï¼Œè„±ä¿— çš„åå­—æ˜¯æœ€é‡è¦çš„ã€‚ èµ·åé€‰æ‹©å­—çš„æ–¹æ³•ä¸€å¦‚å¦‚ä¸‹å›¾ç‰‡æ‰€ç¤ºï¼Œå¯å‚è€ƒç™¾åº¦æœç´¢çš„å§“åå­¦ 7. Reference article å‘¨æ˜“ç½‘ ä¸­å›½å¥åº·ç½‘ ç¾åè…¾ å¤ªå¹³æ´‹äº²å­ç½‘ è§£æå››æŸ±å…«å­—çš„ç²¾é«“å–œç”¨ç¥ ä¸ä¸€å®šå‡†ç¡®çš„å–œç”¨ç¥æŸ¥è¯¢ å…«å­—äº”è¡Œç®—å‘½å’Œäººç”Ÿèµ·ä¼åœ– è¯¦è§å§“åç¬”ç”»å‰å‡¶å¤§å…¨ åº·å­å­—å…¸ ä¸‰è—ç½‘ èµ·åç½‘ â€¦ å…¬å†ï¼š****å¹´**æœˆ**æ—¥(æ˜ŸæœŸå››)11ç‚¹å†œå†ï¼šä¸™ç”³å¹´å››æœˆåä¸‰æ—¥åˆæ—¶æ˜¥èŠ‚ï¼š2æœˆ8æ—¥èŠ‚å‰ï¼šä¹™æœªå¹´èŠ‚åï¼šä¸™ç”³å¹´å…«å­—ï¼šä¸™ç”³ ç™¸å·³ è¾›ä¸‘ ç”²åˆäº”è¡Œï¼šç«é‡‘ æ°´ç« é‡‘åœŸ æœ¨ç«æ–¹ä½ï¼šå—è¥¿ åŒ—å— è¥¿ä¸­ ä¸œå—ç”Ÿè‚–ï¼šçŒ´92 ä¸‰æ‰é…ç½® å‰ï¼Œ å¤©åœ°äººå¤–æ€»æ ¼ å¤§å‰ 31ç”»é™ˆä¿Šå¦ƒé™ˆä¿Šå¸†é™ˆæ³Šç¾Šé™ˆæ³Šäº¦é™ˆéŸ³ç«¹...","categories":[{"name":"tools","slug":"tools","permalink":"http://iequa.com/categories/tools/"}],"tags":[{"name":"Chinese's name","slug":"Chinese-s-name","permalink":"http://iequa.com/tags/Chinese-s-name/"}]},{"title":"Python Data Mining and Analysis environment","slug":"python/language/py-language-1-data-analysis-environment","date":"2016-08-02T08:43:21.000Z","updated":"2019-10-20T04:30:35.004Z","comments":true,"path":"2016/08/02/python/language/py-language-1-data-analysis-environment/","link":"","permalink":"http://iequa.com/2016/08/02/python/language/py-language-1-data-analysis-environment/","excerpt":"è¿™æ˜¯ç”¨ Python è¿›è¡Œæ•°æ®åˆ†ææŒ–æ˜çš„ä¸€å°éƒ¨åˆ†ï¼ŒåŒ…æ‹¬ é«˜ç»´æ•°ç»„ã€æ•°å€¼è®¡ç®—ã€æœºå™¨å­¦ä¹ ã€ç¥ç»ç½‘ç»œ å’Œ è¯­è¨€æ¨¡å‹ç­‰ã€‚","text":"è¿™æ˜¯ç”¨ Python è¿›è¡Œæ•°æ®åˆ†ææŒ–æ˜çš„ä¸€å°éƒ¨åˆ†ï¼ŒåŒ…æ‹¬ é«˜ç»´æ•°ç»„ã€æ•°å€¼è®¡ç®—ã€æœºå™¨å­¦ä¹ ã€ç¥ç»ç½‘ç»œ å’Œ è¯­è¨€æ¨¡å‹ç­‰ã€‚ 1. Python data analysis introPython ä¼˜é›…çš„è¯­æ³•å’ŒåŠ¨æ€ç±»å‹ æ‹¥æœ‰é«˜çº§æ•°æ®ç»“æ„ã€OO Functional Programming è§£é‡Šæ€§ã€èƒ¶æ°´è¯­è¨€ï¼Œå¼€å‘æ•ˆç‡é«˜ åº“ä¸°å¯Œ, NumPy, SciPy, Matplotlib, Pandas é€‚åˆäº Scientific Computingã€Mathematical Modelingã€Data mining â€¦ import future feature from __futrue__ import print_functionfrom __futrue__ import division install third package ä¸‰ç§æ–¹å¼ ä¸‹è½½æºä»£ç è‡ªè¡Œå®‰è£… : å®‰è£…çµæ´»ï¼Œ ä½†éœ€è¦è‡ªè¡Œè§£å†³ä¸Šçº§ä¾èµ–é—®é¢˜ã€‚ ç”¨ pip å®‰è£… : æ¯”è¾ƒæ–¹ä¾¿ï¼Œè‡ªåŠ¨è§£å†³ä¸Šçº§ä¾èµ–é—®é¢˜ ç³»ç»Ÿè‡ªå¸¦çš„å®‰è£…æ–¹å¼ : apt-get or brew .. 1.1 Install pip pip æ˜¯å®‰è£…pythonåŒ…çš„å·¥å…·ï¼Œæä¾›äº†å®‰è£…åŒ…ï¼Œåˆ—å‡ºå·²ç»å®‰è£…çš„åŒ…ï¼Œå‡çº§åŒ…ä»¥åŠå¸è½½åŒ…çš„åŠŸèƒ½ã€‚pip æ˜¯å¯¹easy_installçš„å–ä»£ï¼Œæä¾›äº†å’Œeasy_installç›¸åŒçš„æŸ¥æ‰¾åŒ…çš„åŠŸèƒ½ which pythonwget https://bootstrap.pypa.io/get-pip.pysudo python get-pip.py ä¿®æ”¹pipæº ï¼ˆå¯é€‰ï¼‰ç”±äºå¤©æœåŸå› ,ä½¿ç”¨pipå®‰è£…ä¸€äº›æ¨¡å—ä¼šç‰¹åˆ«æ…¢ç”šè‡³æ— æ³•ä¸‹è½½,å› æ­¤æˆ‘ä»¬éœ€è¦ä¿®æ”¹pipçš„æºåˆ°å›½å†…çš„ä¸€äº›é•œåƒåœ°å€.cd ~mkdir .pipvim pip.confæ·»åŠ ä»¥ä¸‹ä¸¤è¡Œ[global]index-url = http://pypi.v2ex.com/simpleæŠŠindex-urlçš„å€¼è®¾ç½®ä¸ºè‡ªå·±å®é™…æºçš„åœ°å€.è‡³æ­¤pipæºä¿®æ”¹æˆåŠŸ,ä»¥åä½¿ç”¨pipå®‰è£…æ¨¡å—æ—¶éƒ½ä¼šä»è¿™ä¸ªæºå»ä¸‹è½½å®‰è£…. or âœ tar.gz ll-rw-r--r-- 1 hp staff 1138794 Mar 11 16:09 pip-8.1.0.tar.gz-rw-r--r-- 1 hp staff 630700 Mar 11 13:38 setuptools-18.1.tar.gztar -xvf setuptools-18.1.tar.gztar -xvf pip-8.1.0.tar.gzcd setuptools-18.1python setup.py buildpython setup.py installcd pip-9.0.1/python setup.py buildpython setup.py install 9.0.1 è§ https://pypi.python.org/pypi/pip ipython sudo pip install â€”upgrade ipython â€”ignore-installed sixsudo pip install notebook startup ipython notebook ipython notebook PYSPARK_DRIVER_PYTHON=ipython PYSPARK_DRIVER_PYTHON_OPTS=&quot;notebook --ip=192.168.140.159&quot; $SPARK_HOME/bin/pyspark 2. Python Tools for data analysis Extension lib introduction Numpy æä¾›æ•°ç»„æ”¯æŒï¼Œä»¥åŠç›¸åº”çš„é«˜æ•ˆå¤„ç†å‡½æ•° Scipy æä¾›çŸ©é˜µæ”¯æŒï¼Œä»¥åŠçŸ©é˜µç›¸å…³çš„æ•°å€¼è®¡ç®—æ¨¡å— Matplotlib æ•°æ®å¯è§†åŒ–å·¥å…·ï¼Œä½œå›¾åº“ Pandas æ•°æ®åˆ†æå’Œæ¢ç´¢å·¥å…· StatsModels ç»Ÿè®¡å»ºæ¨¡å’Œè®¡é‡ç»æµå­¦ï¼ŒåŒ…æ‹¬æè¿°ç»Ÿè®¡ï¼Œç»Ÿè®¡æ¨¡å‹ä¼°è®¡å’Œæ¨æ–­ Scikit-Learn æ”¯æŒå›å½’ï¼Œåˆ†ç±»ï¼Œèšç±» ç­‰å¼ºå¤§çš„æœºå™¨å­¦ä¹ åº“ Keras æ·±åº¦å­¦ä¹ åº“ï¼Œç”¨äºå»ºç«‹ç¥ç»ç½‘ç»œä»¥åŠ deep learning model Gensim ç”¨æ¥åš text topic model çš„åº“ Pillow æ—§ç‰ˆçš„PIL, å›¾ç‰‡å¤„ç†ç›¸å…³ OpenCV video å¤„ç†ç›¸å…³ GMPY2 é«˜ç²¾åº¦è®¡ç®—ç›¸å…³ 2.1 NumpyNumpy æä¾›äº†æ•°æ®åŠŸèƒ½, åç»­ Scipyã€Matplotlibã€Pandas ç­‰éƒ½ä¾èµ–äºå®ƒã€‚ # -*- coding: utf-8 -*-# sudo pip install numpyimport numpy as npa = np.array([2, 0, 1, 5])print(a)print(&quot;hello world 3.0 !&quot;) 2.2 Scipy Numpy æä¾›äº†å¤šç»´æ•°æ®åŠŸèƒ½ï¼Œä½†å®ƒåªæ˜¯æ•°ç»„ï¼Œå¹¶ä¸æ˜¯çŸ©é˜µã€‚Scipy æä¾›äº†çœŸæ­£çš„çŸ©é˜µï¼Œä»¥åŠå¤§é‡çŸ©é˜µè¿ç®—çš„å¯¹è±¡å’Œå‡½æ•°ã€‚Scipy ä¾èµ–äº Numpy 2.3 Matplotlib è‘—åçš„ç»˜å›¾åº“ï¼Œä¸»è¦ç”¨äºäºŒç»´ç»˜å›¾ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥è¿›è¡Œä¸‰ç»´ç»˜å›¾ã€‚sudo pip install matplotlib 2.4 PandasPandas æ˜¯ Python ä¸‹æœ€å¼ºå¤§çš„æ•°æ®åˆ†æ Toolï¼Œæ²¡æœ‰ä¹‹ä¸€ã€‚Pandas æ„å»ºåœ¨ Numpy ä¹‹ä¸Šã€‚ Pandas Function ç±»SQLï¼ŒCRUD æ•°æ®å¤„ç†å‡½æ•° æ—¶é—´åºåˆ—åˆ†æåŠŸèƒ½ çµæ´»å¤„ç†ç¼ºå¤±æ•°æ® sudo pip install pandassudo pip install xlrdsudo pip install xlwtã€Šåˆ©ç”¨pythonè¿›è¡Œæ•°æ®åˆ†æã€‹è®²è§£è¯¦ç»†ï¼Œé’ˆå¯¹ Pandasã€‚ Pandas åŸºæœ¬çš„æ•°æ®ç»“æ„æ˜¯ : Series å’Œ DataFrame (å®ƒçš„æ¯ä¸€åˆ—éƒ½æ˜¯ä¸€ä¸ªSeries)ã€‚æ¯ä¸ª Series éƒ½ä¼šæœ‰ä¸€ä¸ªå¯¹åº”çš„ Indexï¼Œç”¨æ¥æ ‡è®°å…ƒã€‚(Indexç±»ä¼¼äº SQL ä¸»é”®) # -*- coding: utf-8 -*-import pandas as pds = pd.Series([1, 2, 3], index=[&#x27;a&#x27;, &#x27;b&#x27;, &#x27;c&#x27;]) # åˆ›å»ºä¸€ä¸ªåºåˆ— sd2 = pd.DataFrame(s)d = pd.DataFrame([[1, 2, 3], [4, 5, 6]], columns=[&#x27;a&#x27;, &#x27;b&#x27;, &#x27;c&#x27;]) # åˆ›å»ºä¸€ä¸ª tabled.head() # é»˜è®¤é¢„è§ˆå‰ 5 è¡Œd.describe() # æ•°æ®åŸºæœ¬ç»Ÿè®¡é‡# è¯»å–æ–‡ä»¶pd.read_excel(&#x27;data.xls&#x27;) # è¯»å– Excel æ–‡ä»¶, åˆ›å»º DataFrame.# pd.read_csv(&#x27;data.csv&#x27;, encoding=&#x27;utf-8&#x27;) # è¯»å–æ–‡æœ¬, ä¸€èˆ¬æŒ‡å®š encoding 2.5 StatsModels StatsModels ä¸»è¦æ˜¯å¯¹ï¼Œæ•°æ®çš„è¯»å–ã€å¤„ç†ã€æ¢ç´¢ï¼Œæ›´åŠ æ³¨é‡æ•°æ®çš„ç»Ÿè®¡å»ºæ¨¡åˆ†æï¼Œæœ‰ R è¯­è¨€å‘³é“ã€‚StatsModels ä¸ Pandas ç»“åˆ, æˆä¸º Python ä¸‹å¼ºå¤§çš„æ•°æ®æŒ–æ˜ç»„åˆã€‚sudo pip install StatsModels 2.6 Scikit-Learn Scikit-Learn å¼ºå¤§çš„ ML å·¥å…·åŒ…ã€‚åŒ…æ‹¬ æ•°æ®é¢„å¤„ç†ã€åˆ†ç±»ã€å›å½’ã€èšç±»ã€é¢„æµ‹ å’Œ æ¨¡å‹åˆ†æç­‰ã€‚Scikit-Learn ä¾èµ–äº Numpyã€Scipyã€Matplotlibã€‚ install pip install scikit-learn ç”¨ pip å®‰è£…è¿™ä¸ªåŒ…ä¹‹åï¼Œåœ¨ä½¿ç”¨çš„æ—¶å€™ä¼šå‡ºç° ValueError: numpy.dtype has the wrong ç­‰é”™è¯¯ã€‚ solution fun sudo pip install cythongit clone https://github.com/scikit-learn/scikit-learnsudo makesudo python setup.py install ä¸å®‰è£… cython ï¼Œå®‰è£… scikit-learn ä¼šæŠ¥é”™ã€‚è¿™ç§æ–¹å¼ å®‰è£… scikit-learn è¿‡ç¨‹ä¸­çš„ä¸€äº›é”™è¯¯æˆ–è­¦å‘Šä¸éœ€è¦ç®¡ã€‚å®‰è£…å®Œæˆæµ‹è¯•ä½¿ç”¨æ­£å¸¸pip listscikit-learn (0.18.dev0)scipy (0.13.0b1) 2.7 Keras ç¥ç»ç½‘ç»œmodel 2.8 Gensim topic modelling for humansï¼NLP","categories":[{"name":"python","slug":"python","permalink":"http://iequa.com/categories/python/"}],"tags":[{"name":"machine-learning","slug":"machine-learning","permalink":"http://iequa.com/tags/machine-learning/"},{"name":"python","slug":"python","permalink":"http://iequa.com/tags/python/"}]},{"title":"Elasticsearch installation plugins","slug":"elasticsearch/es-install-plugins","date":"2016-05-17T07:59:16.000Z","updated":"2019-10-20T04:30:35.075Z","comments":true,"path":"2016/05/17/elasticsearch/es-install-plugins/","link":"","permalink":"http://iequa.com/2016/05/17/elasticsearch/es-install-plugins/","excerpt":"Elasticsearch æ‰©å±•æ€§éå¸¸å¥½ï¼Œæœ‰å¾ˆå¤šå®˜æ–¹å’Œç¬¬ä¸‰æ–¹å¼€å‘çš„æ’ä»¶","text":"Elasticsearch æ‰©å±•æ€§éå¸¸å¥½ï¼Œæœ‰å¾ˆå¤šå®˜æ–¹å’Œç¬¬ä¸‰æ–¹å¼€å‘çš„æ’ä»¶ 1. Elasticsearch-Installå®˜ç½‘ : https://www.elastic.co/ Install es download elasticsearch-1.7.5.tar.gzcd usr/local/mySoft/deploytar -xvf elasticsearch-1.7.5.tar.gzln -s /usr/local/mySoft/deploy/elasticsearch-1.7.5/ elasticsearch------vim ~/.zshrcexport ES_HOME=/usr/local/xSoft/elasticsearch Config es $ES_HOME/config/elasticsearch.yml cluster.name: elasticsearch_xnode.name=test-node1 Startup ./bin/elasticsearch./bin/elasticsearch -d -Xms512m -Xmx512m è¿è¡Œä¹‹åï¼Œä¼šäº§ç”Ÿ data å’Œ logs ç›®å½• âœ elasticsearch lltotal 28-rw-r--r-- 1 hp staff 11358 Feb 2 17:24 LICENSE.txt-rw-r--r-- 1 hp staff 150 Feb 2 17:24 NOTICE.txt-rw-r--r-- 1 hp staff 8700 Feb 2 17:24 README.textiledrwxr-xr-x 14 hp staff 476 May 26 15:42 bin/drwxr-xr-x 4 hp staff 136 May 27 11:03 config/drwxr-xr-x 3 hp staff 102 May 26 11:01 data/drwxr-xr-x 26 hp staff 884 May 26 09:58 lib/drwxr-xr-x 7 hp staff 238 May 27 09:58 logs/drwxr-xr-x 7 hp staff 238 May 27 10:48 plugins/âœ elasticsearch Verify open http://ip:9200/ &#123; &quot;status&quot; : 200, &quot;name&quot; : &quot;node01&quot;, &quot;cluster_name&quot; : &quot;elasticsearch_x&quot;, &quot;version&quot; : &#123; &quot;number&quot; : &quot;1.7.5&quot;, &quot;build_hash&quot; : &quot;00f95f4ffca6de89d68b7ccaf80d148f1f70e4d4&quot;, &quot;build_timestamp&quot; : &quot;2016-02-02T09:55:30Z&quot;, &quot;build_snapshot&quot; : false, &quot;lucene_version&quot; : &quot;4.10.4&quot; &#125;, &quot;tagline&quot; : &quot;You Know, for Search&quot;&#125; 2. Elasticsearch-HeadElasticSearch-Head æ˜¯ä¸€ä¸ªä¸Elasticé›†ç¾¤ï¼ˆClusterï¼‰ç›¸äº¤äº’çš„ Web å‰å°ã€‚ ES-Headçš„ä¸»è¦ä½œç”¨ å®ƒå±•ç°ESé›†ç¾¤çš„æ‹“æ‰‘ç»“æ„ï¼Œå¹¶ä¸”å¯ä»¥é€šè¿‡å®ƒæ¥è¿›è¡Œç´¢å¼•ï¼ˆIndexï¼‰å’ŒèŠ‚ç‚¹ï¼ˆNodeï¼‰çº§åˆ«çš„æ“ä½œ å®ƒæä¾›ä¸€ç»„é’ˆå¯¹é›†ç¾¤çš„æŸ¥è¯¢APIï¼Œå¹¶å°†ç»“æœä»¥jsonå’Œè¡¨æ ¼å½¢å¼è¿”å› å®ƒæä¾›ä¸€äº›å¿«æ·èœå•ï¼Œç”¨ä»¥å±•ç°é›†ç¾¤çš„å„ç§çŠ¶æ€ Install-Verify elasticsearch/bin/plugin install mobz/elasticsearch-headopen ip:9200/_plugin/head/open ip:9200/_cluster/health?pretty 3. Elasticsearch-KopfKopfæ˜¯ä¸€ä¸ªElasticSearchçš„ç®¡ç†å·¥å…·ï¼Œå®ƒä¹Ÿæä¾›äº†å¯¹ESé›†ç¾¤æ“ä½œçš„APIã€‚ Install-Verify ./elasticsearch/bin/plugin install lmenezes/elasticsearch-kopf/&#123;branch|version&#125;open http://localhost:9200/_plugin/kopf 4. Elasticsearch-bigdeskBigdeskä¸ºElasticé›†ç¾¤æä¾›åŠ¨æ€çš„å›¾è¡¨ä¸ç»Ÿè®¡æ•°æ®ã€‚ Install-Verify bin/plugin -install lukas-vlcek/bigdeskåˆ é™¤bin/plugin --remove bigdeskopen ip:9200/_plugin/bigdeskopen ip:9200/_cluster/state?pretty 5. Elasticsearch-serviceelasticsearch ä½œä¸ºä¸€ä¸ªç³»ç»Ÿserviceåº”ç”¨ ï¼Œå¯ä»¥å®‰è£…elasticsearch-servicewrapperæ’ä»¶ github-es-service git clone https://github.com/elasticsearch/elasticsearch-servicewrapperä¸‹è½½è¯¥æ’ä»¶åï¼Œè§£å‹ç¼©ã€‚å°†serviceç›®å½•æ‹·è´åˆ°elasticsearchå®‰è£…ç›®å½•çš„binç›®å½•ä¸‹ã€‚ âœ service lltotal 76-rwxr-xr-x 1 hp staff 55710 May 26 15:42 elasticsearch*-rw-r--r-- 1 hp staff 2610 May 26 15:42 elasticsearch.bat-rw-r--r-- 1 hp staff 4754 May 26 15:42 elasticsearch.conf-rwxr-xr-x 1 hp staff 64 May 26 15:42 elasticsearch32*-rwxr-xr-x 1 hp staff 64 May 26 15:42 elasticsearch64*drwxr-xr-x 16 hp staff 544 May 26 15:42 exec/drwxr-xr-x 17 hp staff 578 May 26 15:42 lib/âœ service è¿è¡Œè¿™ä¸ªæ’ä»¶çš„å¥½å¤„æ˜¯ï¼šelasticsearch éœ€è¦çš„jvmå‚æ•°å’Œå…¶å®ƒé…ç½®éƒ½å·²ç»é…ç½®å¥½äº†ï¼Œéå¸¸æ–¹ä¾¿ã€‚ sh elasticsearch start;sh elasticsearch restart;sh elasticsearch stop; åœ¨å®é™…ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œè¯¥æ’ä»¶åŸºæœ¬æŠŠå‚æ•°éƒ½é…ç½®å¥½äº†ã€‚æˆ‘ä»¬åªéœ€è¦ä¿®æ”¹ä¸€ä¸‹jvmåˆ†é…çš„å†…å­˜ç©ºé—´å°±å¥½äº†ï¼Œå¦‚ : set.default.ES_HEAP_SIZE=16384set.default.ES_MIN_MEM=16384set.default.ES_MAX_MEM=19660 ç¬¬ä¸€æ¬¡è¿è¡Œ elaticsearch ä¼šäº§ç”Ÿ data-dir ä¸ log-dir service log åœ¨ logs/service.log ä¸­ã€‚ more_info-service Mac OS X Mountain Lion missing 32-bit Javaapple 6 maybe could 6. Http-basic-server-pluginä¸è¦è£¸å¥”ï¼Œç©¿ä¸€å¥—æ¯”åŸºå°¼å§ã€‚ åšä¸€ä¸ªç®€å•çš„HTTPè®¤è¯ï¼Œelasticsearch-http-basic æä¾›äº†é’ˆå¯¹ ES HTTP è¿æ¥ çš„ IPç™½åå•ã€å¯†ç æƒé™ å’Œ ä¿¡ä»»ä»£ç†åŠŸèƒ½ã€‚ github :Asquera_http_basic Install-Verify elasticsearch-http-basicè¿˜ä¸æ”¯æŒESæ ‡å‡†çš„bin/plugin install [github-name]/[repo-name]çš„å®‰è£…æ–¹å¼, æ‰€ä»¥æŒ‰ç…§å¦‚ä¸‹æ–¹å¼å®‰è£… mkdir -p plugins/http-basic; mv elasticsearch-http-basic-1.5.1.jar plugins/http-basic Config http-basic param http.basic.enabled: truehttp.basic.user: &quot;admin&quot;http.basic.password: &quot;admin&quot;http.basic.ipwhitelist: [&quot;localhost&quot;, &quot;127.0.0.1&quot;]http.basic.trusted_proxy_chains: []http.basic.log: true... 7. Elasticsearch-sql install ./plugin -u https://github.com/NLPchina/elasticsearch-sql/releases/download/1.4.5/elasticsearch-sql-1.4.5.zip --install sql Verify open http://node01:9200/_plugin/sql/ ./bin/plugin â€”list âœ elasticsearch ./bin/plugin --listInstalled plugins: - bigdesk - head - http-basic - jdbc - kopf - license - shield - sql 8. Elasticsearch-jdbcå…³ç³»å‹æ•°æ®åº“çš„åŒæ­¥æ’ä»¶ install ./plugin --install jdbc --url http://xbib.org/repository/org/xbib/elasticsearch/plugin/elasticsearch-river-jdbc/1.5.0.5/elasticsearch-river-jdbc-1.5.0.5-plugin.zip download and add mysql-driver curl -o mysql-connector-java-5.1.33.zip -L &#x27;http://dev.mysql.com/get/Downloads/Connector-J/mysql-connector-java-5.1.33.zip/from/http://cdn.mysql.com/&#x27;cp mysql-connector-java-5.1.33-bin.jar $ES_HOME/plugins/jdbc/chmod 644 $ES_HOME/plugins/jdbc/* åœæ­¢river curl -XDELETE &#x27;localhost:9200/_river/my_jdbc_river/&#x27; Verify open http://node01:9200/_nodes/node01/plugins?pretty=true 9. Basic operationæŸ¥çœ‹è¯¥èŠ‚ç‚¹å®‰è£…çš„æ‰€æœ‰æ’ä»¶åˆ—è¡¨ http://node01:9200/_nodes/node01/plugins?pretty=true &#123; &quot;cluster_name&quot; : &quot;elasticsearch_x&quot;, &quot;nodes&quot; : &#123; &quot;nSitXzd8QvSxQRz3mni3BA&quot; : &#123; &quot;name&quot; : &quot;node01&quot;, &quot;transport_address&quot; : &quot;inet[/192.168.181.35:9300]&quot;, &quot;host&quot; : &quot;unix.local&quot;, &quot;ip&quot; : &quot;192.168.181.35&quot;, &quot;version&quot; : &quot;1.7.5&quot;, &quot;build&quot; : &quot;00f95f4&quot;, &quot;http_address&quot; : &quot;inet[/192.168.181.35:9200]&quot;, &quot;plugins&quot; : [ &#123; &quot;name&quot; : &quot;sql&quot;, &quot;version&quot; : &quot;1.4.5&quot;, &quot;description&quot; : &quot;Use sql to query elasticsearch.&quot;, &quot;url&quot; : &quot;/_plugin/sql/&quot;, &quot;jvm&quot; : true, &quot;site&quot; : true &#125;, &#123; &quot;name&quot; : &quot;http-basic-server-plugin&quot;, &quot;version&quot; : &quot;NA&quot;, &quot;description&quot; : &quot;HTTP Basic Server Plugin&quot;, &quot;jvm&quot; : true, &quot;site&quot; : false &#125;, &#123; &quot;name&quot; : &quot;bigdesk&quot;, &quot;version&quot; : &quot;NA&quot;, &quot;description&quot; : &quot;No description found.&quot;, &quot;url&quot; : &quot;/_plugin/bigdesk/&quot;, &quot;jvm&quot; : false, &quot;site&quot; : true &#125;, &#123; &quot;name&quot; : &quot;head&quot;, &quot;version&quot; : &quot;NA&quot;, &quot;description&quot; : &quot;No description found.&quot;, &quot;url&quot; : &quot;/_plugin/head/&quot;, &quot;jvm&quot; : false, &quot;site&quot; : true &#125;, &#123; &quot;name&quot; : &quot;kopf&quot;, &quot;version&quot; : &quot;1.5.7-SNAPSHOT&quot;, &quot;description&quot; : &quot;kopf - simple web administration tool for ElasticSearch&quot;, &quot;url&quot; : &quot;/_plugin/kopf/&quot;, &quot;jvm&quot; : false, &quot;site&quot; : true &#125; ] &#125; &#125;&#125; XPUT data curl -u admin:admin -XPUT http://node01:9200/megacorp/employee/1 -d &#x27; &#123; &quot;first_name&quot; : &quot;John&quot;, &quot;last_name&quot; : &quot;Smith&quot;, &quot;age&quot; : 25, &quot;about&quot; : &quot;I love to go rock climbing&quot;, &quot;interests&quot;: [ &quot;sports&quot;, &quot;music&quot; ] &#125;&#x27; XGET data curl -XGET &#x27;localhost:9200/_count?pretty&#x27; -d &#x27; &#123; &quot;query&quot;: &#123; &quot;match_all&quot;: &#123;&#125; &#125; &#125;&#x27; output &#123; &quot;count&quot; : 1, &quot;_shards&quot; : &#123; &quot;total&quot; : 5, &quot;successful&quot; : 5, &quot;failed&quot; : 0 &#125;&#125; 10. Reference article csdn-004-Elasticsearchæ’ä»¶çš„ä»‹ç» æ’ä»¶å®‰è£…Headã€Kopfä¸Bigdesk chepoo.com/elasticsearch-service elastic.co/guide/ NLPchina/elasticsearch-sql elasticsearch-http-user-auth (è¿™ä¸ªæˆ‘æ²¡æœ‰ä½¿ç”¨) å»ºé€ è€…è¯´","categories":[{"name":"hadoop","slug":"hadoop","permalink":"http://iequa.com/categories/hadoop/"}],"tags":[{"name":"elasticsearch","slug":"elasticsearch","permalink":"http://iequa.com/tags/elasticsearch/"}]},{"title":"Elasticsearch * å…¥é—¨","slug":"elasticsearch/es-indoor","date":"2016-05-17T07:59:16.000Z","updated":"2019-10-20T04:30:35.074Z","comments":true,"path":"2016/05/17/elasticsearch/es-indoor/","link":"","permalink":"http://iequa.com/2016/05/17/elasticsearch/es-indoor/","excerpt":"Elasticsearch æ˜¯ä¸€ä¸ªåŸºäºApache Lucene(TM)çš„å¼€æºæœç´¢å¼•æ“ ã€ å®æ—¶åˆ†å¸ƒå¼æœç´¢ å’Œ åˆ†æå¼•æ“ã€‚","text":"Elasticsearch æ˜¯ä¸€ä¸ªåŸºäºApache Lucene(TM)çš„å¼€æºæœç´¢å¼•æ“ ã€ å®æ—¶åˆ†å¸ƒå¼æœç´¢ å’Œ åˆ†æå¼•æ“ã€‚ Lucene æ˜¯ æˆç†Ÿçš„å…¨æ–‡ç´¢å¼•ä¸ä¿¡æ¯æ£€ç´¢(IR)åº“ï¼Œé‡‡ç”¨Javaå®ç°ã€‚ä¿¡æ¯æ£€ç´¢å¼æŒ‡æ–‡æ¡£æœç´¢ã€æ–‡æ¡£å†…ä¿¡æ¯æœç´¢æˆ–è€…æ–‡æ¡£ç›¸å…³çš„å…ƒæ•°æ®æœç´¢ç­‰æ“ä½œã€‚ã€‚ Solræ˜¯ä¸€ä¸ªåŸºäºLucene javaåº“çš„ä¼ä¸šçº§æœç´¢æœåŠ¡å™¨ï¼ŒåŒ…å«XML/HTTPï¼ŒJSON APIï¼Œé«˜äº®æŸ¥è¯¢ç»“æœï¼Œç¼“å­˜ï¼Œå¤åˆ¶ï¼Œè¿˜æœ‰ä¸€ä¸ªWEBç®¡ç†ç•Œé¢ã€‚Solrè¿è¡Œåœ¨Servletå®¹å™¨ä¸­ 2010 å¹´ Elasticsearch å‡ºç°å…¬å¼€ç‰ˆæœ¬ Elasticsearch æ¶‰åŠçš„æŠ€æœ¯ å…¨æ–‡æœç´¢ åˆ†æç³»ç»Ÿ åˆ†å¸ƒå¼æ•°æ®åº“ è°åœ¨ä½¿ç”¨ Elasticsearch? ç»´åŸºç™¾ç§‘ StackOverflow Githubâ€¦ 1. æ¦‚å¿µElasticsearch æ˜¯ å¼€æºæœç´¢å¼•æ“. Elasticsearch ä¸ä»…æ˜¯å…¨æ–‡æœç´¢ï¼Œè¿˜æ˜¯ï¼š åˆ†å¸ƒå¼ å®æ—¶æ–‡ä»¶å­˜å‚¨ï¼Œæ¯ä¸ªå­—æ®µéƒ½è¢«ç´¢å¼•å¹¶å¯è¢«æœç´¢ åˆ†å¸ƒå¼ å®æ—¶åˆ†ææœç´¢å¼•æ“ å¯æ‰©å±•æœåŠ¡å™¨ï¼Œå¤„ç†PBçº§ç»“æ„åŒ–æˆ–éç»“æ„åŒ–æ•°æ® è¿™äº›åŠŸèƒ½è¢«é›†æˆåˆ°ä¸€ä¸ªæœåŠ¡é‡Œé¢ï¼Œåº”ç”¨å¯é€šè¿‡ RESTful APIã€å„ç§è¯­è¨€çš„å®¢æˆ·ç«¯ã€å‘½ä»¤è¡Œ ä¸ä¹‹äº¤äº’ã€‚ Elasticsearchä¹Ÿä½¿ç”¨Javaå¼€å‘å¹¶ä½¿ç”¨Luceneä½œä¸ºå…¶æ ¸å¿ƒæ¥å®ç°æ‰€æœ‰ç´¢å¼•å’Œæœç´¢çš„åŠŸèƒ½ï¼Œä½†æ˜¯å®ƒçš„ç›®çš„æ˜¯é€šè¿‡ç®€å•çš„RESTful APIæ¥éšè—Luceneçš„å¤æ‚æ€§ï¼Œä»è€Œè®©å…¨æ–‡æœç´¢å˜å¾—ç®€å•ã€‚ more_info_install_elaticsearch [deploy@node196 config]$ lltotal 20-rw-rw-r-- 1 deploy deploy 13915 May 10 10:02 elasticsearch.yml-rw-rw-r--. 1 deploy deploy 2054 Jul 16 2015 logging.yml[deploy@node196 config]$ pwd/home/deploy/elasticsearch-1.7.1/config ç¼–è¾‘ elasticsearch.yml æ›¿ä»£cluster.nameçš„é»˜è®¤å€¼ï¼Œè¿™æ ·å¯ä»¥é˜²æ­¢ä¸€ä¸ªæ–°å¯åŠ¨çš„èŠ‚ç‚¹åŠ å…¥åˆ°ç›¸åŒç½‘ç»œä¸­çš„å¦ä¸€ä¸ªåŒåçš„é›†ç¾¤ä¸­ã€‚ cluster.name: elasticsearch_your-company-name#################################### Node ###################################### Node names are generated dynamically on startup, so you&#x27;re relieved# from configuring them manually. You can tie this node to a specific name:#node.name: &quot;node196&quot; 2. API2.1 Java APIèŠ‚ç‚¹å®¢æˆ·ç«¯(node client) èŠ‚ç‚¹å®¢æˆ·ç«¯ä»¥æ— æ•°æ®èŠ‚ç‚¹(none data node)èº«ä»½åŠ å…¥é›†ç¾¤ï¼Œæ¢è¨€ä¹‹ï¼Œå®ƒè‡ªå·±ä¸å­˜å‚¨ä»»ä½•æ•°æ®ï¼Œä½†æ˜¯å®ƒçŸ¥é“æ•°æ®åœ¨é›†ç¾¤ä¸­çš„å…·ä½“ä½ç½®ï¼Œå¹¶ä¸”èƒ½ç›´æ¥è½¬å‘è¯·æ±‚åˆ°å¯¹åº”çš„èŠ‚ç‚¹ä¸Šã€‚ ä¼ è¾“å®¢æˆ·ç«¯(Transport client) æ›´è½»é‡çš„ä¼ è¾“å®¢æˆ·ç«¯ èƒ½å‘é€è¯·æ±‚åˆ°è¿œç¨‹é›†ç¾¤ã€‚å®ƒè‡ªå·±ä¸åŠ å…¥é›†ç¾¤ï¼Œåªæ˜¯ç®€å•è½¬å‘è¯·æ±‚ç»™é›†ç¾¤ä¸­çš„èŠ‚ç‚¹ã€‚ ä¸¤ä¸ªJavaå®¢æˆ·ç«¯éƒ½é€šè¿‡ 9300ç«¯å£ ä¸ é›†ç¾¤äº¤äº’ï¼Œä½¿ç”¨ Elasticsearchä¼ è¾“åè®®(Elasticsearch Transport Protocol)ã€‚é›†ç¾¤ä¸­çš„èŠ‚ç‚¹ä¹‹é—´ä¹Ÿé€šè¿‡ 9300 port è¿›è¡Œé€šä¿¡ã€‚ more_info_Java-API 2.2 RESTful API åŸºäº HTTP åè®®ï¼Œä»¥ JSON ä¸ºæ•°æ®äº¤äº’æ ¼å¼çš„ RESTful API å‘ Elasticsearch å‘å‡ºçš„è¯·æ±‚çš„ç»„æˆéƒ¨åˆ†ä¸å…¶å®ƒæ™®é€šçš„HTTPè¯·æ±‚æ˜¯ä¸€æ ·çš„ï¼šcurl -X â€˜://:/?â€˜ -d â€˜â€˜ VERB HTTPæ–¹æ³•ï¼šGET, POST, PUT, HEAD, DELETEâ€¦ example : æŸ¥è¯¢é›†ç¾¤ä¸­ æ–‡æ¡£æ•°é‡ [deploy@node196 config]$ curl -u username:passwd -XGET &#x27;localhost:9200/_count?pretty&#x27; -d &#x27;&gt; &#123;&gt; &quot;query&quot;: &#123;&gt; &quot;match_all&quot;: &#123;&#125;&gt; &#125;&gt; &#125;&#x27;&#123; &quot;count&quot; : 100001234, &quot;_shards&quot; : &#123; &quot;total&quot; : 376, &quot;successful&quot; : 376, &quot;failed&quot; : 0 &#125;&#125; curl -u name:pass -X DELETE http://ip:9200/your_index GET /coupon_seeker/coupon_seeker/_search?q=source:dianpingcurl -u name:pass -XGET &#x27;http://192.168.181.xxx:9200/coupon_seeker/coupon_seeker/_search?q=source:dianping æœ‰æ¡ä»¶çš„ç²¾ç¡®åŒ¹é…åˆ é™¤å‘½ä»¤ curl -u name:pass -XDELETE &#x27;http://192.168.181.xxx:9200/coupon_seeker/coupon_seeker/_query?pretty=true&#x27; -d &#x27;&#123;&quot;query&quot;:&#123;&quot;match&quot;:&#123;source:&quot;dianping&quot;&#125;&#125;&#125;&#x27; 3. æ–‡æ¡£é¢å‘æ–‡æ¡£ Elasticsearch is document orientedï¼Œè¿™æ„å‘³ç€å®ƒå¯ä»¥å­˜å‚¨æ•´ä¸ª object æˆ– documentã€‚ Elasticsearch è¿˜å¯ä»¥ ç´¢å¼•(index) æ¯ä¸ªæ–‡æ¡£çš„å†…å®¹ä½¿ä¹‹å¯ä»¥è¢« æœç´¢ã€‚ å¯å¯¹ document ï¼ˆè€Œéæˆè¡Œæˆåˆ—çš„æ•°æ®ï¼‰è¿›è¡Œ indexã€æœç´¢ã€æ’åºã€è¿‡æ»¤ã€‚ è¿™ç§ç†è§£æ•°æ®çš„æ–¹å¼ä¸ä»¥å¾€å®Œå…¨ä¸åŒï¼Œè¿™ä¹Ÿæ˜¯ Elasticsearch èƒ½å¤Ÿæ‰§è¡Œå¤æ‚çš„å…¨æ–‡æœç´¢çš„åŸå› ä¹‹ä¸€ã€‚ JSON (JavaScript Object Notation)ï¼Œæ–‡æ¡£åºåˆ—åŒ–æ ¼å¼ &#123; &quot;email&quot;: &quot;john@smith.com&quot;, &quot;first_name&quot;: &quot;John&quot;, &quot;last_name&quot;: &quot;Smith&quot;, &quot;info&quot;: &#123; &quot;bio&quot;: &quot;Eco-warrior and defender of the weak&quot;, &quot;age&quot;: 25, &quot;interests&quot;: [ &quot;dolphins&quot;, &quot;whales&quot; ] &#125;, &quot;join_date&quot;: &quot;2014/05/01&quot;&#125; å¦‚ä¸‹ userå¯¹è±¡å¾ˆå¤æ‚ï¼Œä½†å®ƒçš„ç»“æ„å’Œå¯¹è±¡çš„å«ä¹‰å·²ç»è¢«å®Œæ•´çš„ä½“ç°åœ¨JSONä¸­äº†ï¼Œåœ¨Elasticsearchä¸­å°†å¯¹è±¡è½¬åŒ–ä¸º JSON å¹¶åš indexç´¢å¼• è¦æ¯”åœ¨è¡¨ç»“æ„ä¸­åšç›¸åŒçš„äº‹æƒ…ç®€å•çš„å¤šã€‚ 5. ç´¢å¼•[hdfs@node196 data_analysis]$ curl -u username:passwd -XPUT http://node190:9200/megacorp/employee/1 -d &#x27;&gt; &#123;&gt; &quot;first_name&quot; : &quot;John&quot;,&gt; &quot;last_name&quot; : &quot;Smith&quot;,&gt; &quot;age&quot; : 25,&gt; &quot;about&quot; : &quot;I love to go rock climbing&quot;,&gt; &quot;interests&quot;: [ &quot;sports&quot;, &quot;music&quot; ]&gt; &#125;&#x27;&#123;&quot;_index&quot;:&quot;megacorp&quot;,&quot;_type&quot;:&quot;employee&quot;,&quot;_id&quot;:&quot;1&quot;,&quot;_version&quot;:1,&quot;created&quot;:true&#125;[hdfs@node196 data_analysis]$ indexing search aggregations /ËŒÃ¦É¡rÉªËˆÉ¡eÉªÊƒÉ™n/ Elasticsearchèƒ½åšçš„äº‹ åœºæ™¯: å‡è®¾æˆ‘ä»¬åˆšå¥½åœ¨Megacorpå·¥ä½œï¼Œè¿™æ—¶äººåŠ›èµ„æºéƒ¨é—¨å‡ºäºæŸç§ç›®çš„éœ€è¦è®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªå‘˜å·¥ç›®å½•ï¼Œè¿™ä¸ªç›®å½•ç”¨äºä¿ƒè¿›äººæ–‡å…³æ€€å’Œç”¨äºå®æ—¶ååŒå·¥ä½œï¼Œæ‰€ä»¥å®ƒæœ‰ä»¥ä¸‹ä¸åŒçš„éœ€æ±‚ï¼š æ•°æ®èƒ½å¤ŸåŒ…å«å¤šä¸ªå€¼çš„æ ‡ç­¾ã€æ•°å­—å’Œçº¯æ–‡æœ¬ã€‚ æ£€ç´¢ä»»ä½•å‘˜å·¥çš„æ‰€æœ‰ä¿¡æ¯ã€‚ æ”¯æŒç»“æ„åŒ–æœç´¢ï¼Œä¾‹å¦‚æŸ¥æ‰¾30å²ä»¥ä¸Šçš„å‘˜å·¥ã€‚ æ”¯æŒç®€å•çš„å…¨æ–‡æœç´¢å’Œæ›´å¤æ‚çš„çŸ­è¯­(phrase)æœç´¢ é«˜äº®æœç´¢ç»“æœä¸­çš„å…³é”®å­— èƒ½å¤Ÿåˆ©ç”¨å›¾è¡¨ç®¡ç†åˆ†æè¿™äº›æ•°æ® ç´¢å¼•å‘˜å·¥æ–‡æ¡£ Relational DB -&gt; Databases -&gt; Tables -&gt; Rows -&gt; ColumnsElasticsearch -&gt; Indices -&gt; Types -&gt; Documents -&gt; Fields Elasticsearch Relational DB Indices Databases Types Tables Documents Rows Fields Columns Elasticsearch ç´¢å¼•ã€å«ä¹‰çš„åŒºåˆ† index_num. : index (æ•°æ®åº“)ï¼Œå®ƒæ˜¯ç›¸å…³æ–‡æ¡£å­˜å‚¨çš„åœ°æ–¹ï¼Œ index_verb. ã€Œç´¢å¼•ä¸€ä¸ªæ–‡æ¡£ã€è¡¨ç¤ºæŠŠä¸€ä¸ªæ–‡æ¡£å­˜å‚¨åˆ°ç´¢å¼•ï¼ˆåè¯ï¼‰é‡Œï¼Œä»¥ä¾¿å®ƒå¯ä»¥è¢«æ£€ç´¢æˆ–è€…æŸ¥è¯¢ã€‚è¿™å¾ˆåƒSQL ä¸­çš„ INSERTå…³é”®å­—ï¼Œå·®åˆ«æ˜¯ï¼Œå¦‚æœæ–‡æ¡£å·²ç»å­˜åœ¨ï¼Œæ–°çš„æ–‡æ¡£å°†è¦†ç›–æ—§çš„æ–‡æ¡£ã€‚ å€’æ’ç´¢å¼• : ä¼ ç»Ÿæ•°æ®åº“ä¸ºç‰¹å®šåˆ—å¢åŠ ä¸€ä¸ªç´¢å¼•ï¼Œä¾‹å¦‚ B-Treeç´¢å¼• æ¥åŠ é€Ÿæ£€ç´¢ã€‚Elasticsearchå’ŒLuceneä½¿ç”¨å€’æ’ç´¢å¼•(inverted index)çš„æ•°æ®ç»“æ„æ¥è¾¾åˆ°ç›¸åŒç›®çš„ã€‚ PUT /megacorp/employee/1&#123; &quot;first_name&quot; : &quot;John&quot;, &quot;last_name&quot; : &quot;Smith&quot;, &quot;age&quot; : 25, &quot;about&quot; : &quot;I love to go rock climbing&quot;, &quot;interests&quot;: [ &quot;sports&quot;, &quot;music&quot; ]&#125; 4.1 æ£€ç´¢æ–‡æ¡£GET /megacorp/employee/1 &#123; &quot;_index&quot; : &quot;megacorp&quot;, &quot;_type&quot; : &quot;employee&quot;, &quot;_id&quot; : &quot;1&quot;, &quot;_version&quot; : 1, &quot;found&quot; : true, &quot;_source&quot; : &#123; &quot;first_name&quot; : &quot;John&quot;, &quot;last_name&quot; : &quot;Smith&quot;, &quot;age&quot; : 25, &quot;about&quot; : &quot;I love to go rock climbing&quot;, &quot;interests&quot;: [ &quot;sports&quot;, &quot;music&quot; ] &#125;&#125; 4.2 ç®€å•æœç´¢GET /megacorp/employee/_search æŸ¥è¯¢ last_name ä¸º Smith çš„è®°å½• GET /megacorp/employee/_search?q=last_name:Smith &#123; ... &quot;hits&quot;: &#123; &quot;total&quot;: 2, &quot;max_score&quot;: 0.30685282, &quot;hits&quot;: [ &#123; ... &quot;_source&quot;: &#123; &quot;first_name&quot;: &quot;John&quot;, &quot;last_name&quot;: &quot;Smith&quot;, &quot;age&quot;: 25, &quot;about&quot;: &quot;I love to go rock climbing&quot;, &quot;interests&quot;: [ &quot;sports&quot;, &quot;music&quot; ] &#125; &#125;, &#123; ... &quot;_source&quot;: &#123; &quot;first_name&quot;: &quot;Jane&quot;, &quot;last_name&quot;: &quot;Smith&quot;, &quot;age&quot;: 32, &quot;about&quot;: &quot;I like to collect rock albums&quot;, &quot;interests&quot;: [ &quot;music&quot; ] &#125; &#125; ] &#125;&#125; 4.3 ä½¿ç”¨DSLè¯­å¥æŸ¥è¯¢ DSL(Domain Specific Languageç‰¹å®šé¢†åŸŸè¯­è¨€) æŸ¥è¯¢å­—ç¬¦ä¸²ç­‰ä»·äº q=last_name:Smith DSLæŸ¥è¯¢ : GET /megacorp/employee/_search&#123; &quot;query&quot; : &#123; &quot;match&quot; : &#123; &quot;last_name&quot; : &quot;Smith&quot; &#125; &#125;&#125; 4.4 æ›´å¤æ‚çš„æœç´¢filter range GET /megacorp/employee/_search{ â€œqueryâ€ : { â€œfilteredâ€ : { â€œfilterâ€ : { â€œrangeâ€ : { â€œageâ€ : { â€œgtâ€ : 30 } } }, â€œqueryâ€ : { â€œmatchâ€ : { â€œlast_nameâ€ : â€œsmithâ€ } } } }} 4.5 å…¨æ–‡æœç´¢ä¸€ç§ä¼ ç»Ÿæ•°æ®åº“éš¾ä»¥å®ç°çš„åŠŸèƒ½ GET /megacorp/employee/_search&#123; &quot;query&quot; : &#123; &quot;match&quot; : &#123; &quot;about&quot; : &quot;rock climbing&quot; &#125; &#125;&#125; Result : &#123; ... &quot;hits&quot;: &#123; &quot;total&quot;: 2, &quot;max_score&quot;: 0.16273327, &quot;hits&quot;: [ &#123; ... &quot;_score&quot;: 0.16273327, &lt;1&gt; &quot;_source&quot;: &#123; &quot;first_name&quot;: &quot;John&quot;, &quot;last_name&quot;: &quot;Smith&quot;, &quot;age&quot;: 25, &quot;about&quot;: &quot;I love to go rock climbing&quot;, &quot;interests&quot;: [ &quot;sports&quot;, &quot;music&quot; ] &#125; &#125;, &#123; ... &quot;_score&quot;: 0.016878016, &lt;2&gt; &quot;_source&quot;: &#123; &quot;first_name&quot;: &quot;Jane&quot;, &quot;last_name&quot;: &quot;Smith&quot;, &quot;age&quot;: 32, &quot;about&quot;: &quot;I like to collect rock albums&quot;, &quot;interests&quot;: [ &quot;music&quot; ] &#125; &#125; ] &#125;&#125; 4.6 çŸ­è¯­æœç´¢ â€” phrasesæƒ³è¦ç¡®åˆ‡çš„åŒ¹é…è‹¥å¹²ä¸ªå•è¯æˆ–è€…çŸ­è¯­(phrases), ä¾‹å¦‚ æˆ‘ä»¬æƒ³è¦æŸ¥è¯¢åŒæ—¶åŒ…å«â€rockâ€å’Œâ€climbingâ€ï¼ˆå¹¶ä¸”æ˜¯ç›¸é‚»çš„ï¼‰çš„å‘˜å·¥è®°å½•ã€‚ GET /megacorp/employee/_search&#123; &quot;query&quot; : &#123; &quot;match_phrase&quot; : &#123; &quot;about&quot; : &quot;rock climbing&quot; &#125; &#125;&#125; å¢åŠ é«˜äº® GET /megacorp/employee/_search&#123; &quot;query&quot; : &#123; &quot;match_phrase&quot; : &#123; &quot;about&quot; : &quot;rock climbing&quot; &#125; &#125;, &quot;highlight&quot;: &#123; &quot;fields&quot; : &#123; &quot;about&quot; : &#123;&#125; &#125; &#125;&#125; 5. aggregationsèšåˆç›¸å½“äº group by GET /megacorp/employee/_search&#123; &quot;query&quot;: &#123; &quot;match&quot;: &#123; &quot;last_name&quot;: &quot;smith&quot; &#125; &#125;, &quot;aggs&quot;: &#123; &quot;all_interests&quot;: &#123; &quot;terms&quot;: &#123; &quot;field&quot;: &quot;interests&quot; &#125; &#125; &#125;&#125; ...&quot;all_interests&quot;: &#123; &quot;buckets&quot;: [ &#123; &quot;key&quot;: &quot;music&quot;, &quot;doc_count&quot;: 2 &#125;, &#123; &quot;key&quot;: &quot;sports&quot;, &quot;doc_count&quot;: 1 &#125; ]&#125; èšåˆä¹Ÿå…è®¸åˆ†çº§æ±‡æ€»ã€‚ä¾‹å¦‚ï¼Œè®©æˆ‘ä»¬ç»Ÿè®¡æ¯ç§å…´è¶£ä¸‹èŒå‘˜çš„å¹³å‡å¹´é¾„ GET /megacorp/employee/_search&#123; &quot;aggs&quot; : &#123; &quot;all_interests&quot; : &#123; &quot;terms&quot; : &#123; &quot;field&quot; : &quot;interests&quot; &#125;, &quot;aggs&quot; : &#123; &quot;avg_age&quot; : &#123; &quot;avg&quot; : &#123; &quot;field&quot; : &quot;age&quot; &#125; &#125; &#125; &#125; &#125;&#125; æ•™ç¨‹å°ç»“ ä¸ºäº†ä¿æŒç®€çŸ­ï¼Œè¿˜æœ‰å¾ˆå¤šçš„ç‰¹æ€§æœªæåŠâ€”â€”åƒ æ¨èã€å®šä½ã€æ¸—é€ã€æ¨¡ç³Š ä»¥åŠ éƒ¨åˆ†åŒ¹é…ç­‰ã€‚ä½†è¿™ä¹Ÿçªå‡ºäº†æ„å»ºé«˜çº§æœç´¢åŠŸèƒ½æ˜¯å¤šä¹ˆçš„å®¹æ˜“ã€‚æ— éœ€é…ç½®ï¼Œåªéœ€è¦æ·»åŠ æ•°æ®ç„¶åå¼€å§‹æœç´¢ï¼ 6. åˆ†å¸ƒå¼çš„ç‰¹æ€§Elasticsearch ä½ ä¸éœ€è¦çŸ¥é“ä»»ä½•å…³äºåˆ†å¸ƒå¼ç³»ç»Ÿã€åˆ†ç‰‡ã€é›†ç¾¤å‘ç°æˆ–è€…å…¶ä»–å¤§é‡çš„åˆ†å¸ƒå¼æ¦‚å¿µã€‚æ‰€æœ‰çš„æ•™ç¨‹ä½ å³å¯ä»¥è¿è¡Œåœ¨ä½ çš„ç¬”è®°æœ¬ä¸Šï¼Œä¹Ÿå¯ä»¥è¿è¡Œåœ¨æ‹¥æœ‰100ä¸ªèŠ‚ç‚¹çš„é›†ç¾¤ä¸Šï¼Œå…¶å·¥ä½œæ–¹å¼æ˜¯ä¸€æ ·çš„ã€‚ Elasticsearch è‡´åŠ›äºéšè—åˆ†å¸ƒå¼ç³»ç»Ÿçš„å¤æ‚æ€§ã€‚ä»¥ä¸‹è¿™äº›æ“ä½œéƒ½æ˜¯åœ¨åº•å±‚è‡ªåŠ¨å®Œæˆçš„ï¼š å°†ä½ çš„æ–‡æ¡£åˆ†åŒºåˆ°ä¸åŒçš„å®¹å™¨æˆ–è€…åˆ†ç‰‡(shards)ä¸­ï¼Œå®ƒä»¬å¯å­˜äºä¸€æˆ–å¤šä¸ªèŠ‚ç‚¹ä¸­ã€‚ å°†åˆ†ç‰‡å‡åŒ€çš„åˆ†é…åˆ°å„ä¸ªèŠ‚ç‚¹ï¼Œå¯¹ç´¢å¼•å’Œæœç´¢åšè´Ÿè½½å‡è¡¡ã€‚ å†—ä½™æ¯ä¸€ä¸ªåˆ†ç‰‡ï¼Œé˜²æ­¢ç¡¬ä»¶æ•…éšœé€ æˆçš„æ•°æ®ä¸¢å¤±ã€‚ å°†é›†ç¾¤ä¸­ä»»æ„ä¸€ä¸ªèŠ‚ç‚¹ä¸Šçš„è¯·æ±‚è·¯ç”±åˆ°ç›¸åº”æ•°æ®æ‰€åœ¨çš„èŠ‚ç‚¹ã€‚ æ— è®ºæ˜¯å¢åŠ èŠ‚ç‚¹ï¼Œè¿˜æ˜¯ç§»é™¤èŠ‚ç‚¹ï¼Œåˆ†ç‰‡éƒ½å¯ä»¥åšåˆ°æ— ç¼çš„æ‰©å±•å’Œè¿ç§»ã€‚","categories":[{"name":"hadoop","slug":"hadoop","permalink":"http://iequa.com/categories/hadoop/"}],"tags":[{"name":"elasticsearch","slug":"elasticsearch","permalink":"http://iequa.com/tags/elasticsearch/"}]},{"title":"Point to Plane","slug":"ml/math-distance-formula-of-point-to-plain","date":"2016-05-17T07:07:21.000Z","updated":"2019-10-20T04:30:35.045Z","comments":true,"path":"2016/05/17/ml/math-distance-formula-of-point-to-plain/","link":"","permalink":"http://iequa.com/2016/05/17/ml/math-distance-formula-of-point-to-plain/","excerpt":"å¹³é¢çš„ä¸€èˆ¬å¼æ–¹ç¨‹, å‘é‡çš„æ¨¡ï¼ˆé•¿åº¦ï¼‰, å‘é‡çš„æ•°é‡ç§¯, ç‚¹åˆ°å¹³é¢çš„è·ç¦»","text":"å¹³é¢çš„ä¸€èˆ¬å¼æ–¹ç¨‹, å‘é‡çš„æ¨¡ï¼ˆé•¿åº¦ï¼‰, å‘é‡çš„æ•°é‡ç§¯, ç‚¹åˆ°å¹³é¢çš„è·ç¦» ç»´åŸºç™¾ç§‘_Vector 1. å¹³é¢çš„ä¸€èˆ¬å¼æ–¹ç¨‹Ax +By +Cz + D = 0 å…¶ä¸­n = (A, B, C)æ˜¯å¹³é¢çš„æ³•å‘é‡ï¼ŒDæ˜¯å°†å¹³é¢å¹³ç§»åˆ°åæ ‡åŸç‚¹æ‰€éœ€è·ç¦»ï¼ˆæ‰€ä»¥D=0æ—¶ï¼Œå¹³é¢è¿‡åŸç‚¹ï¼‰ 2. å‘é‡çš„æ¨¡ï¼ˆé•¿åº¦ï¼‰ç»™å®šä¸€ä¸ªå‘é‡Vï¼ˆx, y, z),åˆ™|V| = sqrt(x x + y y + z * z) åœ¨æ•°å­¦ä¸­ï¼ŒçŸ¢é‡å¸¸é‡‡ç”¨æ›´ä¸ºæŠ½è±¡çš„çŸ¢é‡ç©ºé—´ï¼ˆä¹Ÿç§°ä¸ºçº¿æ€§ç©ºé—´ï¼‰æ¥å®šä¹‰ï¼Œè€Œå®šä¹‰å…·æœ‰ç‰©ç†æ„ä¹‰ä¸Šçš„å¤§å°å’Œæ–¹å‘çš„çŸ¢é‡æ¦‚å¿µåˆ™éœ€è¦å¼•è¿›äº†èŒƒæ•°å’Œå†…ç§¯çš„æ¬§å‡ é‡Œå¾—ç©ºé—´ã€‚èŒƒæ•°ï¼Œ æ¨¡é•¿ 3. å‘é‡çš„æ•°é‡ç§¯/ç‚¹ç§¯/å†…ç§¯ç»™å®šä¸¤ä¸ªå‘é‡V1(x1, y1, z1)å’ŒV2(x2, y2, z2)åˆ™ä»–ä»¬çš„å†…ç§¯æ˜¯ V1V2 = x1x2 + y1y2 + z1z2 æ•°é‡ç§¯è¢«å¹¿æ³›åº”ç”¨äºç‰©ç†ä¸­ï¼Œå¦‚åšåŠŸå°±æ˜¯ç”¨åŠ›çš„çŸ¢é‡ä¹˜ä½ç§»çš„çŸ¢é‡ï¼Œå³ 4. ç‚¹åˆ°å¹³é¢çš„è·ç¦»(Yes)æ±‚ç‚¹åˆ°ç›´çº¿çš„è·ç¦»ä¸å†æ˜¯éš¾äº‹ï¼Œæœ‰å›¾æœ‰çœŸç›¸ å¦‚æœæ³•å‘é‡æ˜¯å•ä½å‘é‡çš„è¯ï¼Œé‚£ä¹ˆåˆ†æ¯ä¸º1","categories":[{"name":"machine-learning","slug":"machine-learning","permalink":"http://iequa.com/categories/machine-learning/"}],"tags":[{"name":"math","slug":"math","permalink":"http://iequa.com/tags/math/"}]},{"title":"Spark Machine Learning p1 - Sparkç¼–ç¨‹å…¥é—¨","slug":"spark/spark-machine-learning-p1","date":"2016-04-25T02:07:21.000Z","updated":"2019-10-20T04:30:35.077Z","comments":true,"path":"2016/04/25/spark/spark-machine-learning-p1/","link":"","permalink":"http://iequa.com/2016/04/25/spark/spark-machine-learning-p1/","excerpt":"Spark çš„ç¯å¢ƒæ­å»ºä¸è¿è¡Œ, æ¥è§¦äº† RDD ä¸ SparkContext, å¯åŠ¨ Spark-Shell ä»¥åŠå¦‚ä½•ä½¿ç”¨ Scalaã€Python ç¼–å†™ Spark ç¨‹åº.","text":"Spark çš„ç¯å¢ƒæ­å»ºä¸è¿è¡Œ, æ¥è§¦äº† RDD ä¸ SparkContext, å¯åŠ¨ Spark-Shell ä»¥åŠå¦‚ä½•ä½¿ç”¨ Scalaã€Python ç¼–å†™ Spark ç¨‹åº. Apache Spark Spark çš„è®¾è®¡ç›®æ ‡ å³: è¿­ä»£å¼+ä½å»¶è¿Ÿ é€‚åˆ Machine Learning ç®—æ³•çš„ç‰¹æ€§Spark åˆ†å¸ƒå¼è®¡ç®—æ¡†æ¶, å°†ä¸­é—´æ•°æ®å’Œç»“æœä¿å­˜åœ¨å†…å­˜ä¸­Spark æä¾›å‡½æ•°å¼API, å¹¶å…¼å®¹ Hadoop ç”Ÿæ€Spark æ¡†æ¶å¯¹ èµ„æºè°ƒåº¦ã€ä»»åŠ¡æäº¤ã€æ‰§è¡Œã€è·Ÿè¸ªï¼Œ èŠ‚ç‚¹é—´é€šä¿¡ä»¥åŠæ•°æ®å¹¶è¡Œå¤„ç†çš„å†…åœ¨åº•å±‚æ“ä½œéƒ½è¿›è¡Œäº†æŠ½è±¡ ç®€åŒ–äº†æµ·é‡æ•°æ®çš„å­˜å‚¨(HDFS) å’Œ è®¡ç®—(MR) æµç¨‹ã€‚MapReduce ç¼ºç‚¹, å¦‚: å¯åŠ¨ä»»åŠ¡æ—¶çš„é«˜å¼€é”€ã€å¯¹ä¸­é—´æ•°æ® å’Œ è®¡ç®—ç»“æœ å†™å…¥ç£ç›˜çš„ä¾èµ–ã€‚è¿™ä½¿å¾— Hadoop ä¸é€‚åˆ è¿­ä»£å¼ æˆ– ä½å»¶è¿Ÿ çš„ä»»åŠ¡ã€‚ Spark çš„å››ç§è¿è¡Œæ¨¡å¼ æœ¬åœ°å•æœºæ¨¡å¼ â€” Spark è¿›ç¨‹ all run in one JVM é›†ç¾¤å•æœºæ¨¡å¼ â€” ä½¿ç”¨ Spark è‡ªå·±å†…ç½®çš„ ä»»åŠ¡è°ƒåº¦æ¡†æ¶ åŸºäº Mesos ä¸€ä¸ªå¼€æºé›†ç¾¤è®¡ç®—æ¡†æ¶ åŸºäº YARN ä¸ Hadoop2 å…³è”å½¢æˆé›†ç¾¤è®¡ç®—å’Œèµ„æºè°ƒåº¦æ¡†æ¶ 1. Sparkè¿è¡Œè¿è¡Œç¤ºä¾‹ç¨‹åºæ¥æµ‹è¯•æ˜¯å¦ä¸€åˆ‡æ­£å¸¸ï¼š ./bin/run-example org.apache.spark.examples.SparkPi è¯¥å‘½ä»¤å°†åœ¨æœ¬åœ°å•æœºæ¨¡å¼ä¸‹æ‰§è¡ŒSparkPiè¿™ä¸ªç¤ºä¾‹ã€‚åœ¨è¯¥æ¨¡å¼ä¸‹ï¼Œæ‰€æœ‰çš„Sparkè¿›ç¨‹å‡è¿è¡ŒäºåŒä¸€ä¸ªJVMä¸­ï¼Œè€Œå¹¶è¡Œå¤„ç†åˆ™é€šè¿‡å¤šçº¿ç¨‹æ¥å®ç°ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œè¯¥ç¤ºä¾‹ä¼šå¯ç”¨ä¸æœ¬åœ°ç³»ç»Ÿçš„CPUæ ¸å¿ƒæ•°ç›®ç›¸åŒçš„çº¿ç¨‹ã€‚ è¦åœ¨æœ¬åœ°æ¨¡å¼ä¸‹è®¾ç½®å¹¶è¡Œçš„çº§åˆ«ï¼Œä»¥local[N]çš„æ ¼å¼æ¥æŒ‡å®šä¸€ä¸ªmasterå˜é‡å³å¯ã€‚æ¯”å¦‚åªä½¿ç”¨ä¸¤ä¸ªçº¿ç¨‹æ—¶ï¼Œå¯è¾“å…¥å¦‚ä¸‹å‘½ä»¤ï¼š MASTER=local[2] ./bin/run-example org.apache.spark.examples.SparkPi 2. Sparké›†ç¾¤Sparké›†ç¾¤ç”±ä¸¤ç±»ç¨‹åºæ„æˆ: ä¸€ä¸ªé©±åŠ¨ç¨‹åº å¤šä¸ªæ‰§è¡Œç¨‹åº æœ¬åœ°æ¨¡å¼ä¸‹æ‰€æœ‰çš„å¤„ç†éƒ½è¿è¡Œåœ¨åŒä¸€ä¸ªJVMå†…ï¼Œè€Œåœ¨é›†ç¾¤æ¨¡å¼æ—¶å®ƒä»¬é€šå¸¸è¿è¡Œåœ¨ä¸åŒçš„èŠ‚ç‚¹ä¸Šã€‚ ä¸€ä¸ªé‡‡ç”¨å•æœºæ¨¡å¼çš„Sparké›†ç¾¤åŒ…æ‹¬ï¼š ä¸€ä¸ªè¿è¡ŒSparkå•æœºä¸»è¿›ç¨‹å’Œé©±åŠ¨ç¨‹åºçš„ Masterï¼› å„è‡ªè¿è¡Œä¸€ä¸ªæ‰§è¡Œç¨‹åºè¿›ç¨‹çš„å¤šä¸ª Workerã€‚ æ¯”å¦‚åœ¨ä¸€ä¸ªSparkå•æœºé›†ç¾¤ä¸Šè¿è¡Œï¼Œåªéœ€ä¼ å…¥ä¸»èŠ‚ç‚¹çš„URLå³å¯ï¼š MASTER=spark://IP:PORT ./bin/run-example org.apache.spark.examples.SparkPiå…¶ä¸­çš„IPå’ŒPORTåˆ†åˆ«æ˜¯ä¸»èŠ‚ç‚¹IPåœ°å€å’Œç«¯å£å·ã€‚è¿™æ˜¯å‘Šè¯‰Sparkè®©ç¤ºä¾‹ç¨‹åºè¿è¡Œåœ¨ä¸»èŠ‚ç‚¹æ‰€å¯¹åº”çš„é›†ç¾¤ä¸Š 3. Sparkç¼–ç¨‹æ¨¡å‹3.1 SparkContextç±»SparkContextç±»ä¸SparkConfç±» ä»»ä½•Sparkç¨‹åºçš„ç¼–å†™éƒ½æ˜¯ä»SparkContextå¼€å§‹çš„ã€‚SparkContextçš„åˆå§‹åŒ–éœ€è¦ä¸€ä¸ªSparkConfå¯¹è±¡ï¼Œåè€…åŒ…å«äº†Sparké›†ç¾¤é…ç½®çš„å„ç§å‚æ•°ï¼ˆæ¯”å¦‚ä¸»èŠ‚ç‚¹çš„URLï¼‰ã€‚ åˆå§‹åŒ–åï¼Œæˆ‘ä»¬ä¾¿å¯ç”¨SparkContextå¯¹è±¡æ‰€åŒ…å«çš„å„ç§æ–¹æ³•æ¥åˆ›å»ºå’Œæ“ä½œRDDã€‚Spark shellï¼ˆåœ¨Scalaå’ŒPythonä¸‹å¯ä»¥ï¼Œä½†ä¸æ”¯æŒJavaï¼‰èƒ½è‡ªåŠ¨å®Œæˆä¸Šè¿°åˆå§‹åŒ–ã€‚è‹¥è¦ç”¨Scalaä»£ç æ¥å®ç°çš„è¯ï¼Œå¯å‚ç…§ä¸‹é¢çš„ä»£ç ï¼š val conf = new SparkConf().setAppName(&quot;Test Spark App&quot;).setMaster(&quot;local[4]&quot;)val sc = new SparkContext(conf) è¿™æ®µä»£ç ä¼šåˆ›å»ºä¸€ä¸ª4çº¿ç¨‹çš„SparkContextå¯¹è±¡ï¼Œå¹¶å°†å…¶ç›¸åº”çš„ä»»åŠ¡å‘½åä¸ºTest Spark APPã€‚æˆ‘ä»¬ä¹Ÿå¯é€šè¿‡å¦‚ä¸‹æ–¹å¼è°ƒç”¨SparkContextçš„ç®€å•æ„é€ å‡½æ•° val sc = new SparkContext(&quot;local[4]&quot;, &quot;Test Spark App&quot;) 3.2 Spark shellSparkæ”¯æŒ ç”¨ Scala or Python REPLï¼ˆRead-Eval-Print-Loopï¼Œå³äº¤äº’å¼shellï¼‰æ¥è¿›è¡Œäº¤äº’å¼çš„ç¨‹åºç¼–å†™ã€‚ ./bin/spark-shell ä¼šå¯åŠ¨Scala shell å¹¶åˆå§‹åŒ–ä¸€ä¸ªSparkContextå¯¹è±¡ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡ scè¿™ä¸ªScalaå€¼æ¥è°ƒç”¨è¿™ä¸ªå¯¹è±¡ 3.3 RDDä¸€ä¸ª RDD ä»£è¡¨ä¸€ç³»åˆ—çš„â€œè®°å½•â€ï¼ˆä¸¥æ ¼æ¥è¯´ï¼ŒæŸç§ç±»å‹çš„å¯¹è±¡ï¼‰ã€‚è¿™äº›è®°å½•è¢«åˆ†é…æˆ–åˆ†åŒºåˆ°ä¸€ä¸ªé›†ç¾¤çš„å¤šä¸ªèŠ‚ç‚¹ä¸Šï¼ˆåœ¨æœ¬åœ°æ¨¡å¼ä¸‹ï¼Œå¯ä»¥ç±»ä¼¼åœ°ç†è§£ä¸ºå•ä¸ªè¿›ç¨‹é‡Œçš„å¤šä¸ªçº¿ç¨‹ä¸Šï¼‰ã€‚ Sparkä¸­çš„RDDå…·å¤‡å®¹é”™æ€§ï¼Œå³å½“æŸä¸ªèŠ‚ç‚¹æˆ–ä»»åŠ¡å¤±è´¥æ—¶ï¼ˆå› éç”¨æˆ·ä»£ç åŸå› è€Œå¼•èµ·ï¼Œå¦‚ç¡¬ä»¶æ•…éšœã€ç½‘ç»œä¸é€šç­‰ï¼‰ï¼ŒRDDä¼šåœ¨ä½™ä¸‹çš„èŠ‚ç‚¹ä¸Šè‡ªåŠ¨é‡å»ºï¼Œä»¥ä¾¿ä»»åŠ¡èƒ½æœ€ç»ˆå®Œæˆã€‚ 1. åˆ›å»ºRDD RDDå¯ä»ç°æœ‰çš„é›†åˆåˆ›å»º ï¼š val collection = List(&quot;a&quot;, &quot;b&quot;, &quot;c&quot;, &quot;d&quot;, &quot;e&quot;)val rddFromCollection = sc.parallelize(collection) RDDä¹Ÿå¯ä»¥åŸºäºHadoopçš„è¾“å…¥æºåˆ›å»ºï¼Œæ¯”å¦‚æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿã€HDFSã€‚åŸºäºHadoopçš„RDDå¯ä»¥ä½¿ç”¨ä»»ä½•å®ç°äº†Hadoop InputFormatæ¥å£çš„è¾“å…¥æ ¼å¼ï¼ŒåŒ…æ‹¬æ–‡æœ¬æ–‡ä»¶ã€å…¶ä»–Hadoopæ ‡å‡†æ ¼å¼ã€HBaseç­‰ã€‚ä»¥ä¸‹ä¸¾ä¾‹è¯´æ˜å¦‚ä½•ç”¨ä¸€ä¸ªæœ¬åœ°æ–‡ä»¶ç³»ç»Ÿé‡Œçš„æ–‡ä»¶åˆ›å»ºRDDï¼š val rddFromTextFile = sc.textFile(&quot;LICENSE&quot;) ä¸Šè¿°ä»£ç ä¸­çš„textFileå‡½æ•°ï¼ˆæ–¹æ³•ï¼‰ä¼šè¿”å›ä¸€ä¸ªRDDå¯¹è±¡ã€‚è¯¥å¯¹è±¡çš„æ¯ä¸€æ¡è®°å½•éƒ½æ˜¯ä¸€ä¸ªè¡¨ç¤ºæ–‡æœ¬æ–‡ä»¶ä¸­æŸä¸€è¡Œæ–‡å­—çš„Stringï¼ˆå­—ç¬¦ä¸²ï¼‰å¯¹è±¡ã€‚ 2. Sparkæ“ä½œ åœ¨Sparkç¼–ç¨‹æ¨¡å¼ä¸‹ï¼Œæ‰€æœ‰çš„æ“ä½œè¢«åˆ†ä¸º transformation å’Œ action ä¸¤ç§ã€‚ transformation æ“ä½œæ˜¯å¯¹ä¸€ä¸ªæ•°æ®é›†é‡Œçš„æ‰€æœ‰è®°å½•æ‰§è¡ŒæŸç§å‡½æ•°ï¼Œä»è€Œä½¿è®°å½•å‘ç”Ÿæ”¹å˜ï¼› action é€šå¸¸æ˜¯è¿è¡ŒæŸäº›è®¡ç®—æˆ–èšåˆæ“ä½œï¼Œå¹¶å°†ç»“æœè¿”å›è¿è¡Œ SparkContext çš„é‚£ä¸ªé©±åŠ¨ç¨‹åºã€‚ Spark çš„æ“ä½œé€šå¸¸é‡‡ç”¨å‡½æ•°å¼é£æ ¼ã€‚ Sparkç¨‹åºä¸­æœ€å¸¸ç”¨çš„è½¬æ¢æ“ä½œä¾¿æ˜¯mapæ“ä½œã€‚è¯¥æ“ä½œå¯¹ä¸€ä¸ªRDDé‡Œçš„æ¯ä¸€æ¡è®°å½•éƒ½æ‰§è¡ŒæŸä¸ªå‡½æ•°ï¼Œä»è€Œå°†è¾“å…¥æ˜ å°„æˆä¸ºæ–°çš„è¾“å‡ºã€‚ æ¯”å¦‚ï¼Œä¸‹é¢è¿™æ®µä»£ç ä¾¿å¯¹ä¸€ä¸ªä»æœ¬åœ°æ–‡æœ¬æ–‡ä»¶åˆ›å»ºçš„RDDè¿›è¡Œæ“ä½œã€‚å®ƒå¯¹è¯¥RDDä¸­çš„æ¯ä¸€æ¡è®°å½•éƒ½æ‰§è¡Œsizeå‡½æ•°ã€‚åˆ›å»ºä¸€ä¸ªè¿™æ ·çš„ç”±è‹¥å¹²Stringæ„æˆçš„RDDå¯¹è±¡ã€‚é€šè¿‡mapå‡½æ•°ï¼Œæˆ‘ä»¬å°†æ¯ä¸€ä¸ªå­—ç¬¦ä¸²éƒ½è½¬æ¢ä¸ºä¸€ä¸ªæ•´æ•°ï¼Œä»è€Œè¿”å›ä¸€ä¸ªç”±è‹¥å¹²Intæ„æˆçš„RDDå¯¹è±¡ã€‚ scala&gt; rddFromTextFile.countres2: Long = 294scala&gt; val intsFromStringsRDD = rddFromTextFile.map(line =&gt; line.size)intsFromStringsRDD: org.apache.spark.rdd.RDD[Int] = MapPartitionsRDD[3] at map at &lt;console&gt;:23scala&gt; intsFromStringsRDD.countres3: Long = 294scala&gt; val sumOfRecords = intsFromStringsRDD.sumsumOfRecords: Double = 17062.0scala&gt; val numRecords = intsFromStringsRDD.countnumRecords: Long = 294scala&gt; val aveLengthOfRecord = sumOfRecords / numRecordsaveLengthOfRecord: Double = 58.034013605442176// ç­‰ä»·äºval aveLengthOfRecordChained = rddFromTextFile.map(line =&gt; line.size).sum / rddFromTextFile.count ç¤ºä¾‹ä¸­ =&gt; æ˜¯Scalaä¸‹è¡¨ç¤ºåŒ¿åå‡½æ•°çš„è¯­æ³•ã€‚è¯­æ³• line =&gt; line.size è¡¨ç¤ºä»¥ =&gt; æ“ä½œç¬¦å·¦è¾¹çš„éƒ¨åˆ†ä½œä¸ºè¾“å…¥ï¼Œå¯¹å…¶æ‰§è¡Œä¸€ä¸ªå‡½æ•°ï¼Œå¹¶ä»¥ =&gt; æ“ä½œç¬¦å³è¾¹ä»£ç çš„æ‰§è¡Œç»“æœä¸ºè¾“å‡ºã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œè¾“å…¥ä¸ºlineï¼Œè¾“å‡ºåˆ™æ˜¯ line.size å‡½æ•°çš„æ‰§è¡Œç»“æœã€‚åœ¨Scalaè¯­è¨€ä¸­ï¼Œè¿™ç§å°†ä¸€ä¸ªStringå¯¹è±¡æ˜ å°„ä¸ºä¸€ä¸ªIntçš„å‡½æ•°è¢«è¡¨ç¤ºä¸ºString =&gt; Intã€‚ Sparkçš„å¤§å¤šæ•°æ“ä½œéƒ½ä¼šè¿”å›ä¸€ä¸ªæ–°RDDï¼Œä½†å¤šæ•°çš„Actionæ“ä½œåˆ™æ˜¯è¿”å›è®¡ç®—çš„ç»“æœ æ³¨ : Spark ä¸­çš„è½¬æ¢æ“ä½œæ˜¯å»¶åçš„ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨RDDä¸Šè°ƒç”¨ä¸€ä¸ªè½¬æ¢æ“ä½œå¹¶ä¸ä¼šç«‹å³è§¦å‘ç›¸åº”çš„è®¡ç®—ã€‚ åªæœ‰å¿…è¦æ—¶æ‰è®¡ç®—ç»“æœå¹¶å°†å…¶è¿”å›ç»™é©±åŠ¨ç¨‹åºï¼Œä»è€Œæé«˜äº†Sparkçš„æ•ˆç‡ã€‚ scala&gt; val transformedRDD = rddFromTextFile.map(line =&gt; line.size). | filter(size =&gt; size &gt; 10).map(size =&gt; size * 2)transformedRDD: org.apache.spark.rdd.RDD[Int] = MapPartitionsRDD[7] at map at &lt;console&gt;:24scala&gt; æ²¡æœ‰è§¦å‘ä»»ä½•è®¡ç®—ï¼Œä¹Ÿæ²¡æœ‰ç»“æœè¢«è¿”å›ã€‚å¦‚æœæˆ‘ä»¬ç°åœ¨åœ¨æ–°çš„RDDä¸Šè°ƒç”¨ä¸€ä¸ªæ‰§è¡Œæ“ä½œï¼Œæ¯”å¦‚sumï¼Œè¯¥è®¡ç®—å°†ä¼šè¢«è§¦å‘ï¼š è§¦å‘è®¡ç®— scala&gt; val computation = transformedRDD.sumcomputation: Double = 34106.0 3. RDDç¼“å­˜ç­–ç•¥ Sparkæœ€ä¸ºå¼ºå¤§çš„åŠŸèƒ½ä¹‹ä¸€ä¾¿æ˜¯èƒ½å¤ŸæŠŠæ•°æ®ç¼“å­˜åœ¨é›†ç¾¤çš„å†…å­˜é‡Œã€‚è¿™é€šè¿‡è°ƒç”¨RDDçš„cacheå‡½æ•°æ¥å®ç°ï¼š scala&gt; rddFromTextFile.cacheres4: rddFromTextFile.type = MapPartitionsRDD[2] at textFile at &lt;console&gt;:21scala&gt; val aveLengthOfRecordChainedFromCached = rddFromTextFile.map(line =&gt; line.size).sum / rddFromTextFile.countaveLengthOfRecordChainedFromCached: Double = 58.034013605442176 åœ¨RDDé¦–æ¬¡è°ƒç”¨ä¸€ä¸ªæ‰§è¡Œæ“ä½œæ—¶ï¼Œè¿™ä¸ªæ“ä½œå¯¹åº”çš„è®¡ç®—ä¼šç«‹å³æ‰§è¡Œï¼Œæ•°æ®ä¼šä»æ•°æ®æºé‡Œè¯»å‡ºå¹¶ä¿å­˜åˆ°å†…å­˜ã€‚å› æ­¤ï¼Œé¦–æ¬¡è°ƒç”¨cacheå‡½æ•°æ‰€éœ€è¦çš„æ—¶é—´ä¼šéƒ¨åˆ†å–å†³äºSparkä»è¾“å…¥æºè¯»å–æ•°æ®æ‰€éœ€è¦çš„æ—¶é—´ã€‚ä½†æ˜¯ï¼Œå½“ä¸‹ä¸€æ¬¡è®¿é—®è¯¥æ•°æ®é›†çš„æ—¶å€™ï¼Œæ•°æ®å¯ä»¥ç›´æ¥ä»å†…å­˜ä¸­è¯»å‡ºä»è€Œå‡å°‘ä½æ•ˆçš„I/Oæ“ä½œï¼ŒåŠ å¿«è®¡ç®—ã€‚å¤šæ•°æƒ…å†µä¸‹ï¼Œè¿™ä¼šå–å¾—æ•°å€çš„é€Ÿåº¦æå‡ã€‚ Sparkæ”¯æŒæ›´ä¸ºç»†åŒ–çš„ç¼“å­˜ç­–ç•¥ã€‚é€šè¿‡persistå‡½æ•°å¯ä»¥æŒ‡å®šSparkçš„æ•°æ®ç¼“å­˜ç­–ç•¥ã€‚å…³äºRDDç¼“å­˜çš„æ›´å¤šä¿¡æ¯å¯å‚è§ï¼šhttp://spark.apache.org/docs/latest/programming-guide.html#rdd-persistenceã€‚ 3.4 å¹¿æ’­å˜é‡å’Œç´¯åŠ å™¨Sparkçš„å¦ä¸€ä¸ªæ ¸å¿ƒåŠŸèƒ½æ˜¯èƒ½åˆ›å»ºä¸¤ç§ç‰¹æ®Šç±»å‹çš„å˜é‡ï¼šå¹¿æ’­å˜é‡ å’Œ ç´¯åŠ å™¨ã€‚ å¹¿æ’­å˜é‡ï¼ˆbroadcast variableï¼‰ä¸ºåªè¯»å˜é‡ï¼Œå®ƒç”±è¿è¡ŒSparkContextçš„é©±åŠ¨ç¨‹åºåˆ›å»ºåå‘é€ç»™ä¼šå‚ä¸è®¡ç®—çš„èŠ‚ç‚¹ã€‚å¯¹é‚£äº›éœ€è¦è®©å„å·¥ä½œèŠ‚ç‚¹é«˜æ•ˆåœ°è®¿é—®ç›¸åŒæ•°æ®çš„åº”ç”¨åœºæ™¯ï¼Œæ¯”å¦‚æœºå™¨å­¦ä¹ ï¼Œè¿™éå¸¸æœ‰ç”¨ã€‚ Sparkä¸‹åˆ›å»ºå¹¿æ’­å˜é‡åªéœ€åœ¨SparkContextä¸Šè°ƒç”¨ä¸€ä¸ªæ–¹æ³•å³å¯ï¼š scala&gt; val broadcastAList = sc.broadcast(List(&quot;a&quot;, &quot;b&quot;, &quot;c&quot;, &quot;d&quot;, &quot;e&quot;))broadcastAList: org.apache.spark.broadcast.Broadcast[List[String]] = Broadcast(11)scala&gt; å¹¿æ’­å˜é‡ ä¹Ÿå¯ä»¥è¢«éé©±åŠ¨ç¨‹åºæ‰€åœ¨çš„èŠ‚ç‚¹ï¼ˆå³å·¥ä½œèŠ‚ç‚¹ï¼‰è®¿é—®ï¼Œè®¿é—®çš„æ–¹æ³•æ˜¯è°ƒç”¨è¯¥å˜é‡çš„valueæ–¹æ³•ï¼š scala&gt; val broadcastAList = sc.broadcast(List(&quot;a&quot;, &quot;b&quot;, &quot;c&quot;, &quot;d&quot;, &quot;e&quot;))broadcastAList: org.apache.spark.broadcast.Broadcast[List[String]] = Broadcast(11)scala&gt; sc.parallelize(List(&quot;1&quot;, &quot;2&quot;, &quot;3&quot;)).map(x =&gt; broadcastAList.value ++ x).collectres5: Array[List[Any]] = Array(List(a, b, c, d, e, 1), List(a, b, c, d, e, 2), List(a, b, c, d, e, 3)) æ³¨æ„ï¼Œcollect å‡½æ•°ä¸€èˆ¬ä»…åœ¨çš„ç¡®éœ€è¦å°†æ•´ä¸ªç»“æœé›†è¿”å›é©±åŠ¨ç¨‹åºå¹¶è¿›è¡Œåç»­å¤„ç†æ—¶æ‰æœ‰å¿…è¦è°ƒç”¨ã€‚å¦‚æœåœ¨ä¸€ä¸ªéå¸¸å¤§çš„æ•°æ®é›†ä¸Šè°ƒç”¨è¯¥å‡½æ•°ï¼Œå¯èƒ½è€—å°½é©±åŠ¨ç¨‹åºçš„å¯ç”¨å†…å­˜ï¼Œè¿›è€Œå¯¼è‡´ç¨‹åºå´©æºƒã€‚ é«˜è´Ÿè·çš„å¤„ç†åº”å°½å¯èƒ½åœ°åœ¨æ•´ä¸ªé›†ç¾¤ä¸Šè¿›è¡Œï¼Œä»è€Œé¿å…é©±åŠ¨ç¨‹åºæˆä¸ºç³»ç»Ÿç“¶é¢ˆã€‚ç„¶è€Œåœ¨ä¸å°‘æƒ…å†µä¸‹ï¼Œå°†ç»“æœæ”¶é›†åˆ°é©±åŠ¨ç¨‹åºçš„ç¡®æ˜¯æœ‰å¿…è¦çš„ã€‚å¾ˆå¤šæœºå™¨å­¦ä¹ ç®—æ³•çš„è¿­ä»£è¿‡ç¨‹ä¾¿å±äºè¿™ç±»æƒ…å†µã€‚ ç´¯åŠ å™¨ï¼ˆaccumulatorï¼‰ä¹Ÿæ˜¯ä¸€ç§è¢«å¹¿æ’­åˆ°å·¥ä½œèŠ‚ç‚¹çš„å˜é‡ã€‚ç´¯åŠ å™¨ä¸å¹¿æ’­å˜é‡çš„å…³é”®ä¸åŒï¼Œæ˜¯åè€…åªèƒ½è¯»å–è€Œå‰è€…å´å¯ç´¯åŠ ã€‚ å…³äºç´¯åŠ å™¨çš„æ›´å¤šä¿¡æ¯ï¼Œå¯å‚è§ã€ŠSparkç¼–ç¨‹æŒ‡å—ã€‹ï¼šhttp://spark.apache.org/docs/latest/programming-guide.html#shared-variablesã€‚ 4. Spark Scala ç¼–ç¨‹å…¥é—¨scala-spark-app import org.apache.spark.SparkContextimport org.apache.spark.SparkContext._/** * A simple Spark app in Scala */object ScalaApp &#123; def main(args: Array[String]) &#123; val sc = new SparkContext(&quot;local[2]&quot;, &quot;First Spark App&quot;) // we take the raw data in CSV format and convert it into a set of records of the form (user, product, price) val data = sc.textFile(&quot;data/UserPurchaseHistory.csv&quot;) .map(line =&gt; line.split(&quot;,&quot;)) .map(purchaseRecord =&gt; (purchaseRecord(0), purchaseRecord(1), purchaseRecord(2))) // let&#x27;s count the number of purchases val numPurchases = data.count() // let&#x27;s count how many unique users made purchases val uniqueUsers = data.map &#123; case (user, product, price) =&gt; user &#125;.distinct().count() // let&#x27;s sum up our total revenue val totalRevenue = data.map &#123; case (user, product, price) =&gt; price.toDouble &#125;.sum() // let&#x27;s find our most popular product val productsByPopularity = data .map &#123; case (user, product, price) =&gt; (product, 1) &#125; .reduceByKey(_ + _) .collect() .sortBy(-_._2) val mostPopular = productsByPopularity(0) // finally, print everything out println(&quot;Total purchases: &quot; + numPurchases) println(&quot;Unique users: &quot; + uniqueUsers) println(&quot;Total revenue: &quot; + totalRevenue) println(&quot;Most popular product: %s with %d purchases&quot;.format(mostPopular._1, mostPopular._2)) sc.stop() &#125;&#125; 5. Spark Java ç¼–ç¨‹å…¥é—¨Java APIä¸Scala APIæœ¬è´¨ä¸Šå¾ˆç›¸ä¼¼ã€‚Scalaä»£ç å¯ä»¥å¾ˆæ–¹ä¾¿åœ°è°ƒç”¨Javaä»£ç ï¼Œä½†æŸäº›Scalaä»£ç å´æ— æ³•åœ¨Javaé‡Œè°ƒç”¨ï¼Œç‰¹åˆ«æ˜¯é‚£äº›ä½¿ç”¨äº†éšå¼ç±»å‹è½¬æ¢ã€é»˜è®¤å‚æ•°å’Œé‡‡ç”¨äº†æŸäº›Scalaåå°„æœºåˆ¶çš„ä»£ç ã€‚ SparkContextæœ‰äº†å¯¹åº”çš„Javaç‰ˆæœ¬JavaSparkContextï¼Œè€ŒRDDåˆ™å¯¹åº”JavaRDDã€‚Sparkæä¾›å¯¹Java 8åŒ¿åå‡½æ•°ï¼ˆlambdaï¼‰è¯­æ³•çš„æ”¯æŒã€‚ ç”¨Scalaç¼–å†™æ—¶ï¼Œé”®/å€¼å¯¹è®°å½•çš„RDDèƒ½æ”¯æŒä¸€äº›ç‰¹åˆ«çš„æ“ä½œï¼ˆæ¯”å¦‚reduceByKeyå’ŒsaveAsSequenceFileï¼‰ã€‚è¿™äº›æ“ä½œå¯ä»¥é€šè¿‡éšå¼ç±»å‹è½¬æ¢è€Œè‡ªåŠ¨è¢«è°ƒç”¨ã€‚ç”¨Javaç¼–å†™æ—¶ï¼Œåˆ™éœ€è¦ç‰¹åˆ«ç±»å‹çš„JavaRDDæ¥æ”¯æŒè¿™äº›æ“ä½œã€‚å®ƒä»¬åŒ…æ‹¬ç”¨äºé”®/å€¼å¯¹çš„JavaPairRDDï¼Œä»¥åŠç”¨äºæ•°å€¼è®°å½•çš„JavaDoubleRDDã€‚ Java 8 RDDä»¥åŠJava 8 lambdaè¡¨è¾¾å¼æ›´å¤šä¿¡æ¯å¯å‚è§ã€ŠSparkç¼–ç¨‹æŒ‡å—ã€‹ï¼šhttp://spark.apache.org/docs/latest/programming-guide.html#rdd-operationsã€‚ 6. Spark Python ç¼–ç¨‹å…¥é—¨&quot;&quot;&quot;ç”¨Pythonç¼–å†™çš„ä¸€ä¸ªç®€å•Sparkåº”ç”¨&quot;&quot;&quot;from pyspark import SparkContextsc = SparkContext(&quot;local[2]&quot;, &quot;First Spark App&quot;)# å°†CSVæ ¼å¼çš„åŸå§‹æ•°æ®è½¬åŒ–ä¸º(user,product,price)æ ¼å¼çš„è®°å½•é›†data = sc.textFile(&quot;data/UserPurchaseHistory.csv&quot;).map(lambda line:line.split(&quot;,&quot;)).map(lambda record: (record[0], record[1], record[2]))# æ±‚æ€»è´­ä¹°æ¬¡æ•°numPurchases = data.count()# æ±‚æœ‰å¤šå°‘ä¸åŒå®¢æˆ·è´­ä¹°è¿‡å•†å“uniqueUsers = data.map(lambda record: record[0]).distinct().count()# æ±‚å’Œå¾—å‡ºæ€»æ”¶å…¥totalRevenue = data.map(lambda record: float(record[2])).sum()# æ±‚æœ€ç•…é”€çš„äº§å“æ˜¯ä»€ä¹ˆproducts = data.map(lambda record: (record[1], 1.0)).reduceByKey(lambda a, b: a + b).collect()mostPopular = sorted(products, key=lambda x: x[1], reverse=True)[0]print &quot;Total purchases: %d&quot; % numPurchasesprint &quot;Unique users: %d&quot; % uniqueUsersprint &quot;Total revenue: %2.2f&quot; % totalRevenueprint &quot;Most popular product: %s with %d purchases&quot; % (mostPopular[0], mostPopular[1]) åŒ¿åå‡½æ•°åœ¨Pythonè¯­è¨€ä¸­äº¦ç§°lambdaå‡½æ•°ï¼Œlambdaä¹Ÿæ˜¯è¯­æ³•è¡¨è¾¾ä¸Šçš„å…³é”®å­—ã€‚ ç”¨Scalaç¼–å†™æ—¶ï¼Œä¸€ä¸ªå°†è¾“å…¥xæ˜ å°„ä¸ºè¾“å‡ºyçš„åŒ¿åå‡½æ•°è¡¨ç¤ºä¸ºx =&gt; yï¼Œè€Œåœ¨Pythonä¸­åˆ™æ˜¯lambda x : yã€‚ âœ python-spark-app git:(master) âœ— pwd/Users/hp/ghome/hadoop-spark/spark/Spark-Machine-Learning_8519OSCode/Chapter01/python-spark-appâœ python-spark-app git:(master) âœ— $SPARK_HOME/bin/spark-submit pythonapp.pyUsing Spark&#x27;s default log4j profile: org/apache/spark/log4j-defaults.properties16/08/26 15:56:02 INFO SparkContext: Running Spark version 1.5.2...Total purchases: 5Unique users: 4Total revenue: 39.91Most popular product: iPhone Cover with 2 purchases16/08/26 15:56:07 INFO SparkUI: Stopped Spark web UI at http://192.168.143.84:4040... Sparkçš„Python APIå‡ ä¹è¦†ç›–äº†æ‰€æœ‰Scala APIæ‰€èƒ½æä¾›çš„åŠŸèƒ½. ä½†çš„ç¡®æœ‰äº›ç‰¹æ€§ï¼Œæ¯”å¦‚Spark Streamingå’Œä¸ªåˆ«çš„APIæ–¹æ³•ï¼Œæš‚ä¸æ”¯æŒã€‚å…·ä½“å‚è§ã€ŠSparkç¼–ç¨‹æŒ‡å—ã€‹çš„Pythonéƒ¨åˆ† 7. å°ç»“ä½“ä¼šäº† å‡½æ•°å¼ ç¼–ç¨‹çš„å¨åŠ›ï¼Œ scalaã€python éƒ½å¯ä»¥ã€‚java ä¸é€‚åˆå†™ spark ç¨‹åº","categories":[{"name":"spark","slug":"spark","permalink":"http://iequa.com/categories/spark/"}],"tags":[{"name":"spark","slug":"spark","permalink":"http://iequa.com/tags/spark/"}]},{"title":"SBT Hello","slug":"spark/spark-scala-sbt-hello","date":"2016-03-15T23:54:16.000Z","updated":"2019-10-20T04:30:35.077Z","comments":true,"path":"2016/03/16/spark/spark-scala-sbt-hello/","link":"","permalink":"http://iequa.com/2016/03/16/spark/spark-scala-sbt-hello/","excerpt":"ä»€ä¹ˆæ˜¯ SBT ? SBT é¡¹ç›®å·¥ç¨‹ç›®å½• SBT ç¼–è¯‘æ‰“åŒ… Scala HelloWorld","text":"ä»€ä¹ˆæ˜¯ SBT ? SBT é¡¹ç›®å·¥ç¨‹ç›®å½• SBT ç¼–è¯‘æ‰“åŒ… Scala HelloWorld 1. SBT, What?SBT æ˜¯ Simple Build Tool çš„ç®€ç§°. SBT å¯ä»¥è®¤ä¸ºæ˜¯ Scala ä¸–ç•Œçš„ mavenã€‚ SBTçš„ç€è¿·ç‰¹æ€§ï¼Œæ¯”å¦‚ï¼š DSL buildæ„å»º, å¹¶å¯æ··åˆæ„å»º Java å’Œ Scala é¡¹ç›®ï¼› é€šè¿‡è§¦å‘æ‰§è¡Œ (trigger execution) ç‰¹æ€§æ”¯æŒæŒç»­çš„ç¼–è¯‘ä¸æµ‹è¯•ï¼› å¯ä»¥é‡ç”¨ Maven æˆ–è€… ivyçš„repository è¿›è¡Œä¾èµ–ç®¡ç†ï¼› å¢é‡ç¼–è¯‘ã€å¹¶è¡Œä»»åŠ¡ç­‰ç­‰â€¦ 2. Hello, SBTä¸€ä¸ªæè‡´ç®€å•çš„ Scalaé¡¹ç›® ï¼ˆhello simple projectï¼‰ hello/HelloWorld.scala object HelloWorld &#123; def main(args: Array[String]) &#123; println(&quot;Hello, SBT&quot;) &#125;&#125; sbt run âœ hello git:(master) âœ— sbt[info] Set current project to hello (in build file:/Users/hp/ghome/Spark-Scala/hello/)&gt; run[info] Updating &#123;file:/Users/hp/ghome/Spark-Scala/hello/&#125;hello...[info] Resolving org.fusesource.jansi#jansi;1.4 ...[info] Done updating.[info] Compiling 1 Scala source to /Users/hp/ghome/Spark-Scala/hello/target/scala-2.10/classes...[info] Running HelloWorldHello, SBT[success] Total time: 3 s, completed 2016-3-17 9:38:44&gt; 3. SBT é¡¹ç›®å·¥ç¨‹ç»“æ„è¯¦è§£ä¸€ä¸ªå…¸å‹çš„SBTé¡¹ç›®å·¥ç¨‹ç»“æ„å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š build.sbt è¯¦è§£ build.sbt ç›¸å½“äº maven-pom.xmlï¼Œå®ƒæ˜¯buildå®šä¹‰æ–‡ä»¶ã€‚ SBT è¿è¡Œ ä½¿ç”¨ 2 ç§å½¢å¼ çš„ build å®šä¹‰æ–‡ä»¶ï¼Œ one, put your projectâ€™s base directoryï¼Œâ€” build.sbtï¼Œ a simple build definitionï¼› other one, put project directoryï¼Œcan Use Scala language, more expressiveã€‚ ä¸€ä¸ªç®€å•çš„build.sbtæ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼š name := &quot;hello&quot; // é¡¹ç›®åç§°organization := &quot;xxx.xxx.xxx&quot; // ç»„ç»‡åç§°version := &quot;0.0.1-SNAPSHOT&quot; // ç‰ˆæœ¬å·scalaVersion := &quot;2.9.2&quot; // ä½¿ç”¨çš„Scalaç‰ˆæœ¬å·// å…¶å®ƒbuildå®šä¹‰ name å’Œ versionçš„å®šä¹‰æ˜¯å¿…é¡»çš„ï¼Œå› ä¸ºå¦‚æœæƒ³ç”ŸæˆjaråŒ…çš„è¯ï¼Œè¿™ä¸¤ä¸ªå±æ€§çš„å€¼å°†ä½œä¸ºjaråŒ…åç§°çš„ä¸€éƒ¨åˆ†, å„è¡Œä¹‹é—´ä»¥ç©ºè¡Œåˆ†éš”ã€‚é™¤äº†å®šä¹‰ä»¥ä¸Šé¡¹ç›®ç›¸å…³ä¿¡æ¯ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥åœ¨build.sbtä¸­æ·»åŠ é¡¹ç›®ä¾èµ–ï¼š // æ·»åŠ æºä»£ç ç¼–è¯‘æˆ–è€…è¿è¡ŒæœŸé—´ä½¿ç”¨çš„ä¾èµ–libraryDependencies += &quot;ch.qos.logback&quot; % &quot;logback-core&quot; % &quot;1.0.0&quot;libraryDependencies += &quot;ch.qos.logback&quot; % &quot;logback-classic&quot; % &quot;1.0.0&quot;// æˆ–è€…libraryDependencies ++= Seq( &quot;ch.qos.logback&quot; % &quot;logback-core&quot; % &quot;1.0.0&quot;, &quot;ch.qos.logback&quot; % &quot;logback-classic&quot; % &quot;1.0.0&quot;, ... )// æ·»åŠ æµ‹è¯•ä»£ç ç¼–è¯‘æˆ–è€…è¿è¡ŒæœŸé—´ä½¿ç”¨çš„ä¾èµ–libraryDependencies ++= Seq(&quot;org.scalatest&quot; %% &quot;scalatest&quot; % &quot;1.8&quot; % &quot;test&quot;) å½“ç„¶ï¼Œ build.sbtæ–‡ä»¶ä¸­è¿˜å¯ä»¥å®šä¹‰å¾ˆå¤šä¸œè¥¿ï¼Œæ¯”å¦‚æ·»åŠ æ’ä»¶ï¼Œå£°æ˜é¢å¤–çš„repositoryï¼Œå£°æ˜å„ç§ç¼–è¯‘å‚æ•°ç­‰ç­‰ projectç›®å½•å³ç›¸å…³æ–‡ä»¶ä»‹ç» projectç›®å½•ä¸‹çš„å‡ ä¸ªæ–‡ä»¶å¯ä»¥æ ¹æ®æƒ…å†µæ·»åŠ ã€‚ build.properties æ–‡ä»¶å£°æ˜ä½¿ç”¨çš„è¦ä½¿ç”¨å“ªä¸ªç‰ˆæœ¬çš„SBTæ¥ç¼–è¯‘å½“å‰é¡¹ç›®ï¼Œ æœ€æ–°çš„sbt boot launcherå¯ä»¥èƒ½å¤Ÿå…¼å®¹ç¼–è¯‘æ‰€æœ‰0.10.xç‰ˆæœ¬çš„SBTæ„å»ºé¡¹ç›®ï¼Œæ¯”å¦‚å¦‚æœæˆ‘ä½¿ç”¨çš„æ˜¯0.12ç‰ˆæœ¬çš„sbtï¼Œä½†å´æƒ³ç”¨0.11.3ç‰ˆæœ¬çš„sbtæ¥ç¼–è¯‘å½“å‰é¡¹ç›®ï¼Œåˆ™å¯ä»¥åœ¨build.propertiesæ–‡ä»¶ä¸­æ·»åŠ sbt.version=0.11.3æ¥æŒ‡å®šã€‚ plugins.sbt æ–‡ä»¶ç”¨æ¥å£°æ˜å½“å‰é¡¹ç›®å¸Œæœ›ä½¿ç”¨å“ªäº›æ’ä»¶æ¥å¢å¼ºå½“å‰é¡¹ç›®ä½¿ç”¨çš„sbtçš„åŠŸèƒ½ï¼Œæ¯”å¦‚åƒassemblyåŠŸèƒ½ï¼Œæ¸…ç†ivy local cacheåŠŸèƒ½ï¼Œéƒ½æœ‰ç›¸åº”çš„sbtæ’ä»¶ä¾›ä½¿ç”¨ï¼Œ è¦ä½¿ç”¨è¿™äº›æ’ä»¶åªéœ€è¦åœ¨ plugins.sbt ä¸­å£°æ˜å³å¯. ä¸ºäº†èƒ½å¤ŸæˆåŠŸåŠ è½½è¿™äº›sbtæ’ä»¶ï¼Œæˆ‘ä»¬å°†ä»–ä»¬çš„æŸ¥æ‰¾ä½ç½®æ·»åŠ åˆ°resoloverså½“ä¸­. å…¶ä»– $ touch build.sbt$ mkdir src$ mkdir src/main$ mkdir src/main/java$ mkdir src/main/resources$ mkdir src/main/scala$ mkdir src/test$ mkdir src/test/java$ mkdir src/test/resources$ mkdir src/test/scala$ mkdir project$ ... å¯ä»¥ä½¿ç”¨giter8æ¥è‡ªåŠ¨åŒ–ä»¥ä¸Šæ­¥éª¤.giter8çš„æ›´å¤šä¿¡æ¯å¯å‚è€ƒhttps://github.com//giter8. 4. SBT Cmd actions â€“ æ˜¾ç¤ºå¯¹å½“å‰å·¥ç¨‹å¯ç”¨çš„å‘½ä»¤ update â€“ ä¸‹è½½ä¾èµ– compile â€“ ç¼–è¯‘ä»£ç  test â€“ è¿è¡Œæµ‹è¯•ä»£ç  package â€“ åˆ›å»ºä¸€ä¸ªå¯å‘å¸ƒçš„jaråŒ… publish-local â€“ æŠŠæ„å»ºå‡ºæ¥çš„jaråŒ…å®‰è£…åˆ°æœ¬åœ°çš„ivyç¼“å­˜ publish â€“ æŠŠjaråŒ…å‘å¸ƒåˆ°è¿œç¨‹ä»“åº“ï¼ˆå¦‚æœé…ç½®äº†çš„è¯) more cmd test-failed â€“ è¿è¡Œå¤±è´¥çš„spec test-quick â€“ è¿è¡Œæ‰€æœ‰å¤±è´¥çš„ä»¥åŠ/æˆ–è€…æ˜¯ç”±ä¾èµ–æ›´æ–°çš„spec clean-cache â€“ æ¸…é™¤æ‰€æœ‰çš„sbtç¼“å­˜ã€‚ç±»ä¼¼äºsbtçš„cleanå‘½ä»¤ clean-lib â€“ åˆ é™¤lib_managedä¸‹çš„æ‰€æœ‰å†…å®¹ 5. Scala HelloWorldSBT Scala HelloWorld å…·ä½“è¯·çœ‹ : Scala-Projects/HelloWorld âœ HelloWorld&gt; sbt package [info] Loading project definition from /Users/hp/spark/HelloWorld/project[info] Set current project to HelloWorld (in build file:/Users/hp/spark/HelloWorld/)[info] Packaging /Users/hp/spark/HelloWorld/target/scala-2.11/helloworld_2.11-0.0.1-SNAPSHOT.jar ...[info] Done packaging.[success] Total time: 1 s, completed 2016-3-17 9:05:44 âœ HelloWorld&gt; sbt run [info] Loading project definition from /Users/hp/spark/HelloWorld/project[info] Set current project to HelloWorld (in build file:/Users/hp/spark/HelloWorld/)[info] Running HiHi![success] Total time: 1 s, completed 2016-3-17 9:07:43 6. Spark HelloWorldSpark HelloWorld å…·ä½“è¯·çœ‹ : Spark-Projects/HelloWorld âœ HelloWorld&gt; sbt compileâœ HelloWorld&gt; sbt package $SPARK_HOME/bin/spark-submit \\ --class &quot;HelloWorld&quot; \\ target/scala-2.11/helloworld_2.11-1.0.jar 7. Referencedå‚è€ƒ : scala-sbt.org/0.13/docs/zh-cn/Getting-Started.htmlå‚è€ƒ : CSUG/real_world_scala/blob/master/02_sbt.markdownå‚è€ƒ : scala-sbt.org/0.13.1/docs/Getting-Startedå‚è€ƒ : è¯‘è¨€ç½‘","categories":[{"name":"spark","slug":"spark","permalink":"http://iequa.com/categories/spark/"}],"tags":[{"name":"scala","slug":"scala","permalink":"http://iequa.com/tags/scala/"},{"name":"sbt","slug":"sbt","permalink":"http://iequa.com/tags/sbt/"}]},{"title":"å¤§æ•°æ®å¹³å°CDHé›†ç¾¤åœ¨çº¿å®‰è£…","slug":"hadoop/hadoop-cdh-install-online","date":"2016-03-14T07:54:16.000Z","updated":"2019-10-20T04:30:35.049Z","comments":true,"path":"2016/03/14/hadoop/hadoop-cdh-install-online/","link":"","permalink":"http://iequa.com/2016/03/14/hadoop/hadoop-cdh-install-online/","excerpt":"ä»‹ç»äº† CDH é›†ç¾¤çš„æ­å»ºä¸å®‰è£…ï¼Œå…¶ä¸­ Server å®‰è£…æ­¥éª¤éå¸¸å‡†ç¡®, Agent éœ€è¦è¿›ä¸€æ­¥éªŒè¯.","text":"ä»‹ç»äº† CDH é›†ç¾¤çš„æ­å»ºä¸å®‰è£…ï¼Œå…¶ä¸­ Server å®‰è£…æ­¥éª¤éå¸¸å‡†ç¡®, Agent éœ€è¦è¿›ä¸€æ­¥éªŒè¯. æ ‡ç­¾ï¼š Cloudera-Manager CDH Hadoop éƒ¨ç½² é›†ç¾¤ æ‘˜è¦ï¼šç®¡ç†ã€éƒ¨ç½²Hadoopé›†ç¾¤éœ€è¦å·¥å…·ï¼ŒCloudera Managerä¾¿æ˜¯å…¶ä¸€ã€‚æœ¬æ–‡è¯¦ç»†è®°å½•äº†ä»¥åœ¨çº¿æ–¹å¼éƒ¨ç½²CDHé›†ç¾¤&gt;çš„æ­¥éª¤ã€‚ ä»¥Apache Hadoopä¸ºä¸»å¯¼çš„å¤§æ•°æ®æŠ€æœ¯çš„å‡ºç°ï¼Œä½¿å¾—ä¸­å°å‹å…¬å¸å¯¹äºå¤§æ•°æ®çš„å­˜å‚¨ä¸å¤„ç†ä¹Ÿæ‹¥æœ‰äº†æ­¦å™¨ã€‚ ç›®å‰Hadoopæ¯”è¾ƒæµè¡Œçš„ä¸»è¦æœ‰2ä¸ªç‰ˆæœ¬ï¼ŒApacheå’ŒClouderaç‰ˆæœ¬ã€‚ Apache Hadoopï¼šç»´æŠ¤äººå‘˜æ¯”è¾ƒå¤šï¼Œæ›´æ–°é¢‘ç‡æ¯”è¾ƒå¿«ï¼Œä½†æ˜¯ç¨³å®šæ€§æ¯”è¾ƒå·®ã€‚Cloudera Hadoopï¼ˆCDHï¼‰ï¼šCDHï¼šClouderaå…¬å¸çš„å‘è¡Œç‰ˆæœ¬ï¼ŒåŸºäºApache Hadoopçš„äºŒæ¬¡å¼€å‘ï¼Œä¼˜åŒ–äº†ç»„ä»¶å…¼å®¹å’Œäº¤äº’æ¥å£ã€ç®€åŒ–å®‰è£…é…ç½®ã€å¢åŠ Clouderaå…¼å®¹ç‰¹æ€§ã€‚ å¤§æ•°æ®å¹³å°CDHé›†ç¾¤ cdh-5.70-rpm_install è¯¦ç»†è¿‡ç¨‹ Part 1 install cdh server1.1 Ready install resources CentOS Linux release 7.1.1503 (Core) cm-5.7.0 cloudera-manager-installer.bin adduser deploy centos7.1 åœ¨å®‰è£…è¿‡ç¨‹æ—¶ï¼Œç½‘ç»œé…ç½®ï¼Œè®¾ç½®é™æ€IP vim /etc/sysconfig/network-scripts/ifcfg-eth0 è®¾ç½®é™æ€ipï¼Œä»¥åŠæŒ‡å®šipåœ°å€ DEVICE=&quot;eth0&quot;BOOTPROTO=&quot;static&quot;IPADDR=192.168.1.110NM_CONTROLLED=&quot;yes&quot;ONBOOT=&quot;yes&quot;TYPE=&quot;Ethernet&quot;DNS1=8.8.8.8DNS2=8.8.4.4GATEWAY=192.168.1.1 1.2 ç½‘ç»œé…ç½®ï¼ˆæ‰€æœ‰èŠ‚ç‚¹ï¼‰ä¿®æ”¹hostnameä¸º cdh-server7 RedHat çš„ hostnameï¼Œå°±ä¿®æ”¹ /etc/sysconfig/networkæ–‡ä»¶ï¼Œå°†é‡Œé¢çš„ HOSTNAME è¿™ä¸€è¡Œä¿®æ”¹æˆ HOSTNAME=NEWNAMEï¼Œå…¶ä¸­ NEWNAME å°±æ˜¯ä½ è¦è®¾ç½®çš„ hostnameã€‚ Debianå‘è¡Œç‰ˆçš„ hostname çš„é…ç½®æ–‡ä»¶æ˜¯ /etc/hostname ä¿®æ”¹ipä¸ä¸»æœºåçš„å¯¹åº”å…³ç³» [root@cdh-server7 ~]# vi /etc/hosts #ä¿®æ”¹ipä¸ä¸»æœºåçš„å¯¹åº”å…³ç³»:192.168.181.190 node190192.168.181.198 node198192.168.181.196 node196 é‡å¯ç½‘ç»œæœåŠ¡ç”Ÿæ•ˆ [root@cdh-server7 ~]# service network restart å…³é—­SELINUX æŸ¥çœ‹SELINUXçŠ¶æ€[root@cdh-server7 ~]#getenforce è‹¥ SELINUX æ²¡æœ‰å…³é—­ï¼ŒæŒ‰ç…§ä¸‹è¿°æ–¹å¼å…³é—­vi /etc/selinux/configä¿®æ”¹SELinux=disabledã€‚é‡å¯ç”Ÿæ•ˆï¼Œå¯ä»¥ç­‰åé¢éƒ½è®¾ç½®å®Œäº†é‡å¯ä¸»æœº# This file controls the state of SELinux on the system.# SELINUX= can take one of these three values:# enforcing - SELinux security policy is enforced.# permissive - SELinux prints warnings instead of enforcing.# disabled - SELinux is fully disabled.SELINUX=disabled# SELINUXTYPE= type of policy in use. Possible values are:# targeted - Only targeted network daemons are protected.# strict - Full SELinux protection.SELINUXTYPE=targeted [root@cdh-server7 ~]# ping www.baidu.com ä»¥ä¸Šæ­¥éª¤æ‰§è¡Œå®Œæ¯•åï¼Œé‡å¯ä¸»æœº reboot é‡å¯åå†æ¬¡æ£€æŸ¥ä¸‹ä»¥ä¸Šå‡ ç‚¹ï¼Œç¡®ä¿ç¯å¢ƒé…ç½®æ­£ç¡®ã€‚ 1.3 å¸è½½ openjdk (æ‰€æœ‰èŠ‚ç‚¹) æ³¨æ„ : å¦‚æœæ²¡æœ‰openjdk, åˆ™ä¸éœ€è¦å¸è½½ï¼Œé»˜è®¤ centos7 æ²¡æœ‰ [root@cdh-server7 deploy]# rpm -qa | grep java[root@cdh-server7 deploy]# rpm -qa | grep jdk# if exist java or jdk, uninstall, erase it. example under this...[root@cdh-server7 deploy]# rpm -e --nodeps java-1.5.0-gcj-1.5.0.0-29.1.el6.x86_64[root@cdh-server7 deploy]# rpm -e --nodeps java-1.6.0-openjdk-1.6.0.0-1.66.1.13.0.el6.x86_64[root@cdh-server7 deploy]# rpm -e --nodeps java-1.7.0-openjdk-1.7.0.45-2.4.3.3.el6.x86_64 1.4 å¸è½½ centOS7 é»˜è®¤mysql[root@cdh-server7 deploy]# rpm -qa | grep mariadb[root@cdh-server7 deploy]# rpm -e --nodeps mariadb-libs-5.5.41-2.el7_0.x86_64 1.5 Cloudera Managerå®‰è£…ä¸‹è½½èµ„æºæ–‡ä»¶https://archive.cloudera.com/cm5/redhat/7/x86_64/cm/cloudera-manager.repo å°†cloudera-manager.repoæ–‡ä»¶æ‹·è´åˆ°æ‰€æœ‰èŠ‚ç‚¹çš„/etc/yum.repos.d/æ–‡ä»¶å¤¹ä¸‹ [root@node196 ]# cd /home/deploy/cdh[root@node196 cdh]# wget https://archive.cloudera.com/cm5/redhat/7/x86_64/cm/cloudera-manager.repo[root@cdh-server7 cdh]# mv cloudera-manager.repo /etc/yum.repos.d/ éªŒè¯repoæ–‡ä»¶æ˜¯å¦èµ·æ•ˆ yum list|grep cloudera [root@cdh-server7 cdh]# yum list | grep clouderacloudera-manager-agent.x86_64 5.7.0-1.cm560.p0.54.el7 cloudera-managercloudera-manager-daemons.x86_64 5.7.0-1.cm560.p0.54.el7 cloudera-managercloudera-manager-server.x86_64 5.7.0-1.cm560.p0.54.el7 cloudera-managercloudera-manager-server-db-2.x86_64 5.7.0-1.cm560.p0.54.el7 cloudera-managerenterprise-debuginfo.x86_64 5.7.0-1.cm560.p0.54.el7 cloudera-manageroracle-j2sdk1.7.x86_64 1.7.0+update67-1 cloudera-manager å¦‚æœåˆ—å‡ºçš„ä¸æ˜¯ä½ å®‰è£…çš„ç‰ˆæœ¬ï¼Œæ‰§è¡Œä¸‹é¢å‘½ä»¤é‡è¯• yum clean all yum list | grep cloudera ä¸Šä¼ ä¸‹åˆ— rpm åŒ… åˆ° [root@cdh-server7] çš„ /home/deploy/cdh/cloudera-rpms (ä»»æ„ç›®å½•) cd /home/deploy/cdh/cloudera-rpmscloudera-manager-agent-5.7.0-1.cm560.p0.54.el7.x86_64.rpmcloudera-manager-daemons-5.7.0-1.cm560.p0.54.el7.x86_64.rpmcloudera-manager-server-5.7.0-1.cm560.p0.54.el7.x86_64.rpm ## agent not usecloudera-manager-server-db-2-5.7.0-1.cm560.p0.54.el7.x86_64.rpm ## agent not useenterprise-debuginfo-5.7.0-1.cm560.p0.54.el7.x86_64.rpmoracle-j2sdk1.7-1.7.0+update67-1.x86_64.rpm è¯´æ˜ : å¯ä»https://archive.cloudera.com/cm5/redhat/7/x86_64/cm/5/RPMS/x86_64/ ä¸‹è½½ç›¸å…³rpmåŒ… åˆ‡æ¢åˆ°rpmsç›®å½•ä¸‹ï¼Œæ‰§è¡Œ [root@cdh-server7 cdh]# cd /home/deploy/cdh/cloudera-rpms/[root@cdh-server7 cloudera-rpms]# yum -y install *.rpm 1.6 æ‹·è´èµ„æºåŒ…åˆ°ç›®æ ‡ç›®å½•ä» http://archive.cloudera.com/cdh5/parcels/5.7.0/ ä¸‹è½½èµ„æºåŒ… å°†ä¹‹å‰ä¸‹è½½çš„Parcelé‚£3ä¸ªæ–‡ä»¶æ‹·è´åˆ°/opt/cloudera/parcel-repoç›®å½•ä¸‹ï¼ˆå¦‚æœæ²¡æœ‰è¯¥ç›®å½•ï¼Œè¯·è‡ªè¡Œåˆ›å»ºï¼‰ [root@cdh-server7 cdh]# cp CDH-5.7.0-1.cdh5.7.0.p0.45-el7.parcel /opt/cloudera/parcel-repo/CDH-5.7.0-1.cdh5.7.0.p0.45-el7.parcel[root@cdh-server7 cdh]# cp CDH-5.7.0-1.cdh5.7.0.p0.45-el7.parcel.sha1 /opt/cloudera/parcel-repo/CDH-5.7.0-1.cdh5.7.0.p0.45-el7.parcel.sha[root@cdh-server7 cdh]# cp manifest.json /opt/cloudera/parcel-repo/manifest.json 1.7 é…ç½® java ç¯å¢ƒå˜é‡è®¾ç½®JAVA_HOME [root@cdh-server7 cdh]#vi /etc/profileexport JAVA_HOME=/usr/java/jdk1.7.0_67-cloudera/export PATH=$JAVA_HOME/bin:$PATH[root@cdh-server7 cdh]#source /etc/profile å…³é—­é˜²ç«å¢™ [root@cdh-server7 deploy]#systemctl stop firewalld.service #centos7,å…³é—­é˜²ç«å¢™ ä»¥ä¸Šæ­¥éª¤æ‰§è¡Œå®Œæ¯•åï¼Œé‡å¯ä¸»æœº reboot 1.8 å®‰è£…CM (åªåœ¨ä¸»èŠ‚ç‚¹)ä»¥ä¸‹ä¸¤æ­¥éª¤è¯·åªåœ¨ä¸»èŠ‚ç‚¹ä¸Šæ‰§è¡Œ : è¿›å…¥è¯¥ç›®å½•ï¼Œç»™binæ–‡ä»¶èµ‹äºˆå¯æ‰§è¡Œæƒé™ [root@cdh-server7 cdh]# chmod a+x ./cloudera-manager-installer.bin å®‰è£…CM (è¯¥æ­¥éª¤, å¯èƒ½æ˜¯ä¸éœ€è¦çš„) [root@cdh-server7 cdh]# ./cloudera-manager-installer.bin å¼€å§‹å¯åŠ¨serverç«¯ [root@cdh-server7 cdh]# cd /etc/init.d/[root@cdh-server7 init.d]# ./cloudera-scm-server-db start[root@cdh-server7 init.d]# ./cloudera-scm-server startStarting cloudera-scm-server: [ OK ][root@cdh-server7 init.d]# tail -f /var/log/cloudera-scm-server/cloudera-scm-server.log æ³¨æ„ : æœºå™¨é‡å¯ä¹‹åï¼Œé»˜è®¤å¯åŠ¨ä¼šå¯¼è‡´å¼‚å¸¸ éœ€è¦æŒ‰ç…§è¯¥å…ˆå¯åŠ¨cloudera-scm-server-dbï¼Œå†å¯åŠ¨cloudera-scm-serverçš„é¡ºåºæ‰§è¡Œ 1.9 æµè§ˆå™¨è®¿é—®éªŒè¯(ä¸»èŠ‚ç‚¹)CMå®‰è£…æˆåŠŸåæµè§ˆå™¨è¾“å…¥http://ip:7180, ç”¨æˆ·åå’Œå¯†ç éƒ½è¾“å…¥adminï¼Œè¿›å…¥webç®¡ç†ç•Œé¢ã€‚ é€šè¿‡æµè§ˆå™¨è®¿é—®éªŒè¯ http://192.168.181.190:7180/ å¦‚æœæ‰“ä¸å¼€æ”¹ç½‘é¡µï¼Œç­‰å¾…2åˆ†é’Ÿåã€‚è¿™ä¸ªæœåŠ¡å¯åŠ¨æ˜¯éœ€è¦ä¸€å®šæ—¶é—´çš„ã€‚ é€‰æ‹©éƒ¨ç½²çš„ç‰ˆæœ¬ï¼Œè¿™é‡Œæˆ‘ä»¬é€‰æ‹©å…è´¹ç‰ˆçš„å°±å¯ä»¥äº†ã€‚ å¦‚æœä¸ä¼šè®¾ç½®ï¼Œé‚£ä¹ˆè¯·å‚è€ƒ æœ€é è°±çš„å®‰è£…æŒ‡å— http://www.jianshu.com/p/57179e03795f å®‰è£…æœåŠ¡æ—¶ï¼Œæ•°æ®åº“é€‰æ‹©é»˜è®¤çš„åµŒå…¥å¼æ•°æ®åº“ Part 2 å®‰è£… agent this step is similarï¼Œ but I canâ€™t be sure, exactly right. å®‰è£… agent ï¼Œå¯ä»¥åœ¨å•ç‹¬çš„æœºå™¨ï¼Œä¸»èŠ‚ç‚¹ï¼Œå¯ä»¥åªå½“åšä¸»ï¼Œéšæ„ä½  ä¸ºagentåšé…ç½®,å¯åŠ¨agent (æ‰€æœ‰èŠ‚ç‚¹)agent ä¸éœ€è¦è£…serverï¼Œå…¶ä»–ç»å¤§éƒ¨åˆ†æ­¥éª¤å’Œ å®‰è£… server ç›¸åŒã€‚ 2.1 ç½‘ç»œé…ç½®ä¿®æ”¹ipä¸ä¸»æœºåçš„å¯¹åº”å…³ç³» [root@cdh-agent1 ~]# vi /etc/hosts #ä¿®æ”¹ipä¸ä¸»æœºåçš„å¯¹åº”å…³ç³»:192.168.181.190 cdh-server7(node190)192.168.181.198 cdh-agent1(node198)192.168.181.196 cdh-agent2(node196) é‡å¯ç½‘ç»œæœåŠ¡ç”Ÿæ•ˆ [root@cdh-server7 ~]# service network restart å…³é—­SELINUX æŸ¥çœ‹SELINUXçŠ¶æ€[root@cdh-server7 ~]#getenforce è‹¥ SELINUX æ²¡æœ‰å…³é—­ï¼ŒæŒ‰ç…§ä¸‹è¿°æ–¹å¼å…³é—­vi /etc/selinux/configä¿®æ”¹SELinux=disabledã€‚é‡å¯ç”Ÿæ•ˆï¼Œå¯ä»¥ç­‰åé¢éƒ½è®¾ç½®å®Œäº†é‡å¯ä¸»æœº# This file controls the state of SELinux on the system.# SELINUX= can take one of these three values:# enforcing - SELinux security policy is enforced.# permissive - SELinux prints warnings instead of enforcing.# disabled - SELinux is fully disabled.SELINUX=disabled# SELINUXTYPE= type of policy in use. Possible values are:# targeted - Only targeted network daemons are protected.# strict - Full SELinux protection.SELINUXTYPE=targeted [root@cdh-server7 ~]# ping www.baidu.com 2.2 å¸è½½ openjdk (æ‰€æœ‰èŠ‚ç‚¹) æ³¨æ„ : å¦‚æœæ²¡æœ‰openjdk, åˆ™ä¸éœ€è¦å¸è½½ï¼Œé»˜è®¤ centos7 æ²¡æœ‰ [root@cdh-server7 deploy]# rpm -qa | grep java[root@cdh-server7 deploy]# rpm -qa | grep jdk# if exist java or jdk, uninstall, erase it. example under this...[root@cdh-server7 deploy]# rpm -e --nodeps java-1.5.0-gcj-1.5.0.0-29.1.el6.x86_64[root@cdh-server7 deploy]# rpm -e --nodeps java-1.6.0-openjdk-1.6.0.0-1.66.1.13.0.el6.x86_64[root@cdh-server7 deploy]# rpm -e --nodeps java-1.7.0-openjdk-1.7.0.45-2.4.3.3.el6.x86_64 2.3 å¸è½½centOS7é»˜è®¤mysql[root@cdh-server7 deploy]# rpm -qa | grep mariadb[root@cdh-server7 deploy]# rpm -e --nodeps mariadb-libs-5.5.41-2.el7_0.x86_64 2.4 cloudera-manager.repo ä¸Šä¼ cloudera-manager.repo åˆ° cdh-agent1 [root@cdh-agent1 cdh]# cp cloudera-manager.repo /etc/yum.repos.d/ transparent_hugepage echo never &gt; /sys/kernel/mm/transparent_hugepage/enabledecho never &gt; /sys/kernel/mm/transparent_hugepage/defrag vi /etc/rc.local åœ¨æ–‡ä»¶å°¾æ”¾å…¥ å¦‚ä¸‹ä¸¤æ¡è¯­å¥ echo never &gt; /sys/kernel/mm/transparent_hugepage/enabledecho never &gt; /sys/kernel/mm/transparent_hugepage/defrag chmod +x /etc/rc.local è°ƒæ•´swappiness echo 10 &gt; /proc/sys/vm/swappiness# vi /etc/sysctl.confvm.swappiness = 10 2.5 ~/cdh/cloudera-rpms ä¸Šä¼ ä¸‹åˆ—rpmåŒ…åˆ°cdh-agent1çš„/home/deploy/cdh/cloudera-rpms cloudera-manager-agent-5.7.0-1.cm560.p0.54.el7.x86_64.rpmcloudera-manager-daemons-5.7.0-1.cm560.p0.54.el7.x86_64.rpmenterprise-debuginfo-5.7.0-1.cm560.p0.54.el7.x86_64.rpmoracle-j2sdk1.7-1.7.0+update67-1.x86_64.rpm[root@cdh-agent1 init.d]# cd /home/deploy/cdh/cloudera-rpms/[root@cdh-agent1 init.d]# yum -y install *.rpm è®¾ç½®JAVA_HOME [root@cdh-server7 cdh]#vi /etc/profileexport JAVA_HOME=/usr/java/jdk1.7.0_67-cloudera/export PATH=$JAVA_HOME/bin:$PATH[root@cdh-server7 cdh]#source /etc/profile å…³é—­é˜²ç«å¢™ [root@cdh-server7 deploy]#systemctl stop firewalld.service #centos7,å…³é—­é˜²ç«å¢™ ä»¥ä¸Šæ­¥éª¤æ‰§è¡Œå®Œæ¯•åï¼Œé‡å¯ä¸»æœº reboot [root@cdh-agent1 init.d]# vi /etc/cloudera-scm-agent/config.ini+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++# Hostname of the CM server.#server_host=localhostserver_host=cdh-server7(node190)+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ [root@cdh-server7 cdh]# cd /etc/init.d/[root@cdh-server7 init.d]# ./cloudera-scm-agent startStarting cloudera-scm-agent: [ OK ][root@cdh-server deploy]# tail -f /var/log//cloudera-scm-agent/cloudera-scm-agent.log æ³¨æ„ : å®‰è£…YARN NodeManagerå¤±è´¥æ—¶ï¼Œéœ€è¦åˆ é™¤ /yarn /var/lib/hadoop-yarn ç›®å½•å†é‡æ–°æ·»åŠ  CDHæœ€é è°±çš„å®‰è£…æŒ‡å— : http://www.jianshu.com/p/57179e03795f Part 3 æ¢å¤å¯åŠ¨ Our é›†ç¾¤3.1 ç¡®å®š firewalld closesystemctl start firewalld.service#å¯åŠ¨firewallsystemctl stop firewalld.service#åœæ­¢firewallsystemctl disable firewalld.service#ç¦æ­¢firewallå¼€æœºå¯åŠ¨ æ³¨æ„ : æ“ä½œä¹‹å‰ç¡®å®š firewalld æ˜¯å…³é—­çš„ [root@node19x flag]$ vim /etc/rc.local (/etc/rc.local å¯¹åº”è²Œä¼¼ç›¸å¯¹dir /ect/init.d) 1 #!/bin/bash 2 # THIS FILE IS ADDED FOR COMPATIBILITY PURPOSES 3 # 4 # It is highly advisable to create own systemd services or udev rules 5 # to run scripts during boot instead of using this file. 6 # 7 # In contrast to previous versions due to parallel execution during boot 8 # this script will NOT be run after all other services. 9 # 10 # Please note that you must run &#x27;chmod +x /etc/rc.d/rc.local&#x27; to ensure 11 # that this script will be executed during boot. 12 13 touch /var/lock/subsys/local 14 echo never &gt; /sys/kernel/mm/transparent_hugepage/enabled 15 echo never &gt; /sys/kernel/mm/transparent_hugepage/defrag 16 service ntpd start 17 service elasticsearch start 3.2 å¯åŠ¨serverç«¯ã€cmonly at server node [root@cdh-server7 cdh]# cd /etc/init.d/[root@cdh-server7 init.d]# ./cloudera-scm-server-db start[root@cdh-server7 init.d]# ./cloudera-scm-server startStarting cloudera-scm-server: [ OK ][root@cdh-server7 init.d]# tail -f /var/log/cloudera-scm-server/cloudera-scm-server.log// ç­‰å¾…æ—¥å¿— 7180 å¯åŠ¨æˆåŠŸï¼Œ è®¿é—® : http://node190:7180/cmf/home æ³¨æ„ :æœºå™¨é‡å¯ä¹‹åï¼Œé»˜è®¤å¯åŠ¨ä¼šå¯¼è‡´å¼‚å¸¸éœ€è¦æŒ‰ç…§è¯¥å…ˆå¯åŠ¨cloudera-scm-server-dbï¼Œå†å¯åŠ¨cloudera-scm-serverçš„é¡ºåºæ‰§è¡Œ ä¸€èˆ¬ä»¥ä¸‹ agent æ˜¯è‡ªåŠ¨å¯åŠ¨çš„ [root@node190 init.d]# ./cloudera-scm-agent startcloudera-scm-agent is already runningnode190:./cloudera-scm-agent startnode19x:./cloudera-scm-agent startnode19x:./cloudera-scm-agent start... 3.3 CMé¡µé¢ä¸Šå¯åŠ¨å„æœåŠ¡ CM é¡µé¢ä¸Šé‡å¯ service monitor CM é¡µé¢ä¸Šé‡å¯ host monitor CM é¡µé¢ä¸Šå¯åŠ¨å„é¡¹æœåŠ¡ (å¦‚ : ZK, Flume, YARN, HDFS, Hive, Sqoop, Spark etc..) 3.4 å„ä¸ªèŠ‚ç‚¹å¯åŠ¨ ES[deploy@node190 init.d]# lltotal 44-rwxr-xr-x 1 root root 8671 Apr 2 04:52 cloudera-scm-agentlrwxrwxrwx. 1 root root 58 Apr 18 16:55 elasticsearch -&gt; /home/deploy/elasticsearch-1.7.1/bin/service/elasticsearch-rw-r--r--. 1 root root 13948 Sep 16 2015 functions-rwxr-xr-x. 1 root root 2989 Sep 16 2015 netconsole-rwxr-xr-x. 1 root root 6630 Sep 16 2015 network-rw-r--r--. 1 root root 1160 Apr 1 00:45 README deploy cd /home/deploy/elasticsearch-1.7.1/bin/service[deploy@node190 init.d]# ./elasticsearch start[deploy@node19x init.d]# ./elasticsearch start[deploy@node19x init.d]# ./elasticsearch start... http://node190:9200/_plugin/bigdesk/#cluster ç­‰å¾…åŒæ­¥æ•°æ®å®Œæˆï¼Œä¸€èˆ¬ä¼šå¾ˆå¿«ï¼Œç­‰å¾… Status ä» RED å˜ä¸º green çŠ¶æ€ http://node190:9200/_plugin/head/ 3.5 å¯åŠ¨ kibana[deploy@node196 ~]#cd /home/deploy/kibana-4.1.1-linux-x64 ./bin/kibana &gt; kibana.log 2&gt;&amp;1 &amp; --@deploy","categories":[{"name":"hadoop","slug":"hadoop","permalink":"http://iequa.com/categories/hadoop/"}],"tags":[{"name":"cdh","slug":"cdh","permalink":"http://iequa.com/tags/cdh/"}]},{"title":"Sqoop introduce","slug":"hadoop/hadoop-sqoop-learn-use01","date":"2016-02-16T07:54:16.000Z","updated":"2020-12-06T10:52:06.214Z","comments":true,"path":"2016/02/16/hadoop/hadoop-sqoop-learn-use01/","link":"","permalink":"http://iequa.com/2016/02/16/hadoop/hadoop-sqoop-learn-use01/","excerpt":"Sqoop å³ SQL to Hadoop, æ˜¯ä¸€æ¬¾æ–¹ä¾¿çš„åœ¨ä¼ ç»Ÿå…³ç³»æ•°æ®åº“ä¸ Hadoop ä¹‹é—´è¿›è¡Œæ•°æ®è¿ç§»çš„å·¥å…·ï¼Œå……åˆ†åˆ©ç”¨ MapReduce å¹¶è¡Œç‰¹ç‚¹ä»¥æ‰¹å¤„ç†çš„æ–¹å¼åŠ å¿«æ•°æ®ä¼ è¾“.","text":"Sqoop å³ SQL to Hadoop, æ˜¯ä¸€æ¬¾æ–¹ä¾¿çš„åœ¨ä¼ ç»Ÿå…³ç³»æ•°æ®åº“ä¸ Hadoop ä¹‹é—´è¿›è¡Œæ•°æ®è¿ç§»çš„å·¥å…·ï¼Œå……åˆ†åˆ©ç”¨ MapReduce å¹¶è¡Œç‰¹ç‚¹ä»¥æ‰¹å¤„ç†çš„æ–¹å¼åŠ å¿«æ•°æ®ä¼ è¾“. 1. Sqoop what ?sqoop å³ SQL to Hadoop ï¼Œæ˜¯ä¸€æ¬¾æ–¹ä¾¿çš„åœ¨ä¼ ç»Ÿå…³ç³»æ•°æ®åº“ä¸ Hadoop ä¹‹é—´è¿›è¡Œæ•°æ®è¿ç§»çš„å·¥å…·ï¼Œå……åˆ†åˆ©ç”¨ MapReduce å¹¶è¡Œç‰¹ç‚¹ä»¥æ‰¹å¤„ç†çš„æ–¹å¼åŠ å¿«æ•°æ®ä¼ è¾“ï¼Œå‘å±•è‡³ä»Šä¸»è¦æ¼”åŒ–äº†äºŒå¤§ç‰ˆæœ¬ï¼Œsqoop1å’Œsqoop2ã€‚ sqoop : clouder å…¬å¸å¼€å‘ ç”Ÿäº§èƒŒæ™¯ mysql å¯¼å…¥ Hadoop Hadoop å¯¼å…¥ mysql æ³¨ : ä»¥ä¸Š Hadoop æŒ‡ Hiveã€HBaseã€HDFS ç­‰ 2. Sqoop ç‰¹ç‚¹sqoopæ¶æ„éå¸¸ç®€å•ï¼Œå…¶æ•´åˆäº†Hiveã€Hbaseå’ŒOozieï¼Œé€šè¿‡map-reduceä»»åŠ¡æ¥ä¼ è¾“æ•°æ®ï¼Œä»è€Œæä¾›å¹¶å‘ç‰¹æ€§å’Œå®¹é”™ã€‚ Sqoop ç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼šå®¢æˆ·ç«¯(client)å’ŒæœåŠ¡ç«¯(server)ã€‚éœ€è¦åœ¨é›†ç¾¤çš„å…¶ä¸­æŸä¸ªèŠ‚ç‚¹ä¸Šå®‰è£…serverï¼Œè¯¥èŠ‚ç‚¹çš„æœåŠ¡ç«¯å¯ä»¥ä½œä¸ºå…¶ä»– Sqoop å®¢æˆ·ç«¯çš„å…¥å£ç‚¹ã€‚ åœ¨ server ç«¯çš„èŠ‚ç‚¹ä¸Šå¿…é¡»å®‰è£…æœ‰ Hadoopã€‚client å¯ä»¥å®‰è£…åœ¨ä»»æ„æ•°é‡çš„æœºå­ä¸Šã€‚åœ¨è£…æœ‰å®¢æˆ·ç«¯çš„æœºå­ä¸Šä¸éœ€è¦å®‰è£… Hadoopã€‚ sqoop å®˜ç½‘ : https://sqoop.apache.org1.4.5å®˜æ–¹æ–‡æ¡£ : https://sqoop.apache.org/docs/1.4.5/sqoop2ä¸æ¨èçš„åŸå›  : http://blog.csdn.net/robbyo/article/details/50737356 3. Sqoop ä¼˜ç¼ºç‚¹ä¼˜ç‚¹ é«˜æ•ˆå¯æ§çš„åˆ©ç”¨èµ„æºï¼Œä»»åŠ¡å¹¶è¡Œåº¦ï¼Œè¶…æ—¶æ—¶é—´ã€‚ æ•°æ®ç±»å‹æ˜ å°„ä¸è½¬åŒ–ï¼Œå¯è‡ªåŠ¨è¿›è¡Œï¼Œç”¨æˆ·ä¹Ÿå¯è‡ªå®šä¹‰ . æ”¯æŒå¤šç§ä¸»æµæ•°æ®åº“ï¼ŒMySQL,Oracleï¼ŒSQL Serverï¼ŒDB2ç­‰ç­‰ ã€‚ ç¼ºç‚¹ åŸºäºå‘½ä»¤è¡Œçš„æ“ä½œæ–¹å¼ï¼Œæ˜“å‡ºé”™ï¼Œä¸”ä¸å®‰å…¨ã€‚ æ•°æ®ä¼ è¾“å’Œæ•°æ®æ ¼å¼æ˜¯ç´§è€¦åˆçš„ï¼Œè¿™ä½¿å¾—connectoræ— æ³•æ”¯æŒæ‰€æœ‰çš„æ•°æ®æ ¼å¼ ç”¨æˆ·åå’Œå¯†ç æš´æ¼å‡ºæ¥ 4. Sqoop åŸç†4.1 Sqoopçš„importåŸç†Sqoop åœ¨ import æ—¶ï¼Œéœ€è¦åˆ¶å®š split-by å‚æ•°ã€‚ Sqoop æ ¹æ®ä¸åŒçš„ split-byå‚æ•°å€¼ æ¥è¿›è¡Œåˆ‡åˆ†, ç„¶åå°†åˆ‡åˆ†å‡ºæ¥çš„åŒºåŸŸåˆ†é…åˆ°ä¸åŒ map ä¸­ã€‚æ¯ä¸ªmapä¸­å†å¤„ç†æ•°æ®åº“ä¸­è·å–çš„ä¸€è¡Œä¸€è¡Œçš„å€¼ï¼Œå†™å…¥åˆ° HDFS ä¸­ã€‚åŒæ—¶split-by æ ¹æ®ä¸åŒçš„å‚æ•°ç±»å‹æœ‰ä¸åŒçš„åˆ‡åˆ†æ–¹æ³•ï¼Œå¦‚æ¯”è¾ƒç®€å•çš„intå‹ï¼ŒSqoopä¼šå–æœ€å¤§å’Œæœ€å°split-byå­—æ®µå€¼ï¼Œç„¶åæ ¹æ®ä¼ å…¥çš„ num-mappersæ¥ç¡®å®šåˆ’åˆ†å‡ ä¸ªåŒºåŸŸã€‚ æ¯”å¦‚ select max(split_by),min(split-by) from å¾—åˆ°çš„ max(split-by)å’Œ min(split-by) åˆ†åˆ«ä¸º 1000 å’Œ 1, è€Œ num-mappers ä¸º 2 çš„è¯ï¼Œåˆ™ä¼šåˆ†æˆä¸¤ä¸ªåŒºåŸŸ (1,500) å’Œ (501-100), åŒæ—¶ä¹Ÿä¼šåˆ†æˆ 2ä¸ªsql ç»™ 2ä¸ªmap å»è¿›è¡Œå¯¼å…¥æ“ä½œï¼Œåˆ†åˆ«ä¸º select XXX from table where split-by&gt;=1 and split-by=501 and split-by&lt;=1000ã€‚æœ€åæ¯ä¸ªmapå„è‡ªè·å–å„è‡ªSQLä¸­çš„æ•°æ®è¿›è¡Œå¯¼å…¥å·¥ä½œã€‚ 4.2. Sqoopçš„exportåŸç†æ ¹æ® mysql è¡¨åç§°ï¼Œç”Ÿæˆä¸€ä¸ªä»¥è¡¨åç§°å‘½åçš„ Javaç±»ï¼Œè¯¥ç±»ç»§æ‰¿äº† sqoopRecordçš„ï¼Œæ˜¯ä¸€ä¸ªåªæœ‰ Map çš„ MRï¼Œä¸”è‡ªå®šä¹‰äº†è¾“å‡ºå­—æ®µã€‚ sqoop export â€”connect jdbc:mysql://$url:3306/$3?characterEncoding=utf8 â€”username $username â€”password $password â€”table $1 â€”export-dir $2 â€”input-fields-terminated-by â€˜|â€™ â€”null-non-string â€˜0â€™ â€”null-string â€˜0â€™; 5. Sqoop ä½¿ç”¨å®ä¾‹ç¯å¢ƒ sqoop: sqoop-1.4.5+cdh5.3.6+78hive : hive-0.13.1+cdh5.3.6+397hbase: hbase-0.98.6+cdh5.3.6+115 5.1. Mysql to Hadoop Mysql to Hdfs sqoop import \\ --connect $&#123;jdbc_url&#125; --username $&#123;jdbc_username&#125; --password $&#123;jdbc_passwd&#125; \\ --query &quot;$&#123;exec_sql&#125;&quot; \\ --split-by $&#123;id&#125; -m 10 \\ --target-dir $&#123;target_dir&#125; \\ --fields-terminated-by &quot;\\001&quot; --lines-terminated-by &quot;\\n&quot; \\ --hive-drop-import-delims \\ --null-string &#x27;\\\\N&#x27; --null-non-string &#x27;\\\\N&#x27; Mysql To Hive sqoop import \\ --connect $&#123;jdbc_url&#125; \\ --username $&#123;jdbc_username&#125; --password $&#123;jdbc_passwd&#125; \\ --table $&#123;jdbc_table&#125; --fields-terminated-by &quot;\\001&quot; --lines-terminated-by &quot;\\n&quot; \\ --hive-import --hive-overwrite --hive-table $&#123;hive_table&#125; \\ --null-string &#x27;\\\\N&#x27; --null-non-string &#x27;\\\\N&#x27; Mysql To HBase 5.2 Hadoop to Mysql Hdfs To Mysql sqoop export -D sqoop.export.records.per.statement=10 \\--connect jdbc:mysql://192.168.***.**:3306/***?autoReconnect=true --username *** --password *** --table mds_dm_rs_shop_result \\--fields-terminated-by &#x27;\\t&#x27; --export-dir &quot;/dc_ext/xbd/dm/mds/mds_dm_rs_shop_result/dt=20170410&quot; --null-string &#x27;\\\\N&#x27; --null-non-string &#x27;\\\\N&#x27;; refence article Sqoopä¸­æ–‡æ–‡æ¡£Hive to Mysql å¸¸é‡ä¹å¤§é—®é¢˜æ€»ç»“","categories":[{"name":"hadoop","slug":"hadoop","permalink":"http://iequa.com/categories/hadoop/"}],"tags":[{"name":"sqoop","slug":"sqoop","permalink":"http://iequa.com/tags/sqoop/"}]},{"title":"Hive Introduce 1","slug":"hadoop/hadoop-hive-brief","date":"2016-02-15T07:07:21.000Z","updated":"2020-12-06T06:24:54.679Z","comments":true,"path":"2016/02/15/hadoop/hadoop-hive-brief/","link":"","permalink":"http://iequa.com/2016/02/15/hadoop/hadoop-hive-brief/","excerpt":"åˆæ­¥äº†è§£ Hadoop ç”Ÿæ€åœˆ åˆæ­¥äº†è§£ Hive æ¶æ„å›¾","text":"åˆæ­¥äº†è§£ Hadoop ç”Ÿæ€åœˆ åˆæ­¥äº†è§£ Hive æ¶æ„å›¾ 1. Hive Introduce1.1 Hive PrefaceHadoop Hadoop ç”Ÿæ€ç³»ç»Ÿ æ˜¯ å¤„ç†å¤§æ•°æ®é›†è€Œäº§ç”Ÿçš„è§£å†³æ–¹æ¡ˆã€‚ Hadoop å®ç°è®¡ç®—æ¨¡å‹ MapReduce, å¯å°†è®¡ç®—ä»»åŠ¡åˆ†å‰²æˆå¤šä¸ªå¤„ç†å•å…ƒï¼Œè¿™ä¸ªè®¡ç®—æ¨¡å‹ä¸‹é¢æ˜¯ä¸€ä¸ª HDFSã€‚ Hive Hive æä¾›äº†ä¸€ä¸ª HiveæŸ¥è¯¢è¯­è¨€ HiveQL, æŸ¥è¯¢è½¬æ¢ä¸º MapReduce job Hive é€‚åˆåšæ•°æ®ä»“åº“ï¼Œå¯ç¦»çº¿ç»´æŠ¤æµ·é‡æ•°æ®ï¼Œå¯å¯¹æ•°æ®è¿›è¡ŒæŒ–æ˜, å½¢æˆæŠ¥å‘Šç­‰ Hadoopã€HDFS è®¾è®¡æœ¬èº«é™åˆ¶äº† Hive æ‰€èƒ½èƒœä»»çš„å·¥ä½œ, Hive ä¸æ”¯æŒè®°å½•çº§åˆ«çš„æ›´æ–°ã€æ’å…¥ æˆ–è€… åˆ é™¤ æ“ä½œã€‚ Hive è¿è¡Œæ¶æ„ ä½¿ç”¨ HQL ä½œä¸ºæŸ¥è¯¢æ¥å£ï¼› ä½¿ç”¨ MapReduce ä½œä¸ºæ‰§è¡Œå±‚ï¼› ä½¿ç”¨ HDFS ä½œä¸ºå­˜å‚¨å±‚ï¼› 1.2 Hadoop / MapreduceInput -&gt; Mappers -&gt; Sort,Shuffle -&gt; Reducers -&gt; Output 1.3 Hive ç³»ç»Ÿæ¶æ„ 2. Hive æ¶æ„ç»„ä»¶åˆ†ææœ¬ç« é‡ç‚¹ : åˆæ­¥äº†è§£ Hive çš„å·¥ä½œæµ åˆæ­¥äº†è§£ hive çš„å·¥ä½œç»„ä»¶ 2.1 å…ƒæ•°æ®å­˜å‚¨Metastore Hiveçš„æ•°æ®ç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼šæ•°æ®æ–‡ä»¶ å’Œ å…ƒæ•°æ® å…ƒæ•°æ®å­˜å‚¨ï¼ŒDerbyåªèƒ½ç”¨äºä¸€ä¸ªHiveè¿æ¥ï¼Œä¸€èˆ¬å­˜å‚¨åœ¨MySQLã€‚å…ƒæ•°æ®åŒ…æ‹¬è¡¨çš„åå­—ï¼Œè¡¨çš„åˆ—å’Œåˆ†åŒºåŠå…¶å±æ€§ï¼Œè¡¨çš„å±æ€§ï¼ˆæ˜¯å¦ä¸ºå¤–éƒ¨è¡¨ç­‰ï¼‰ï¼Œè¡¨çš„æ•°æ®æ‰€åœ¨ç›®å½•ç­‰ã€‚ 2.2 é©±åŠ¨ (Driver) ç¼–è¯‘å™¨ ä¼˜åŒ–å™¨ æ‰§è¡Œå™¨ ç”¨æˆ·é€šè¿‡ä¸‹é¢çš„æ¥å£æäº¤Hiveç»™Driverï¼Œç”±Driverè¿›è¡ŒHQLè¯­å¥è§£æï¼Œæ­¤æ—¶ä»Metastoreä¸­è·å–è¡¨çš„ä¿¡æ¯ï¼Œå…ˆç”Ÿæˆé€»è¾‘è®¡åˆ’ï¼Œå†ç”Ÿæˆç‰©ç†è®¡åˆ’ï¼Œå†ç”±Executorç”ŸæˆJobäº¤ç»™Hadoopè¿è¡Œï¼Œç„¶åç”±Driverå°†ç»“æœè¿”å›ç»™ç”¨æˆ·ã€‚ ç¼–è¯‘å™¨ï¼ˆHiveçš„æ ¸å¿ƒï¼‰ï¼š1ï¼Œè¯­ä¹‰è§£æå™¨ï¼ˆParseDriverï¼‰ï¼Œå°†æŸ¥è¯¢å­—ç¬¦ä¸²è½¬æ¢æˆè§£ææ ‘è¡¨è¾¾å¼ï¼›2ï¼Œè¯­æ³•è§£æå™¨ï¼ˆSemanticAnalyzerï¼‰ï¼Œå°†è§£ææ ‘è½¬æ¢æˆåŸºäºè¯­å¥å—çš„å†…éƒ¨æŸ¥è¯¢è¡¨è¾¾å¼ï¼›3ï¼Œé€»è¾‘è®¡åˆ’ç”Ÿæˆå™¨ï¼ˆLogical Plan Generatorï¼‰ï¼Œå°†å†…éƒ¨æŸ¥è¯¢è¡¨è¾¾å¼è½¬æ¢ä¸ºé€»è¾‘è®¡åˆ’ï¼Œè¿™äº›è®¡åˆ’ç”±é€»è¾‘æ“ä½œæ ‘ç»„æˆï¼Œæ“ä½œç¬¦æ˜¯Hiveçš„æœ€å°å¤„ç†å•å…ƒï¼Œæ¯ä¸ªæ“ä½œç¬¦å¤„ç†ä»£è¡¨ä¸€é“HDFSæ“ä½œæˆ–è€…æ˜¯MRä½œä¸šï¼›4ï¼ŒæŸ¥è¯¢è®¡åˆ’ç”Ÿæˆå™¨ï¼ˆQueryPlan Generatorï¼‰ï¼Œå°†é€»è¾‘è®¡åˆ’è½¬åŒ–æˆç‰©ç†è®¡åˆ’ï¼ˆMR Jobï¼‰ã€‚ ä¼˜åŒ–å™¨ï¼šä¼˜åŒ–å™¨æ˜¯ä¸€ä¸ªæ¼”åŒ–ç»„ä»¶ï¼Œå½“å‰å®ƒçš„è§„åˆ™æ˜¯ï¼šåˆ—ä¿®å‰ªï¼Œè°“è¯ä¸‹å‹ã€‚ æ‰§è¡Œå™¨ï¼šç¼–è¯‘å™¨å°†æ“ä½œæ ‘åˆ‡åˆ†æˆä¸€ä¸ªJobé“¾ï¼ˆDAGï¼‰ï¼Œæ‰§è¡Œå™¨ä¼šé¡ºåºæ‰§è¡Œå…¶ä¸­æ‰€æœ‰çš„Jobï¼›å¦‚æœTaské“¾ä¸å­˜åœ¨ä¾èµ–å…³ç³»ï¼Œå¯ä»¥é‡‡ç”¨å¹¶å‘æ‰§è¡Œçš„æ–¹å¼è¿›è¡ŒJobçš„æ‰§è¡Œã€‚ 2.3 æ¥å£CLIã€HWIã€ThriftServer CLIï¼šä¸ºå‘½ä»¤è¡Œå·¥å…·ï¼Œé»˜è®¤æœåŠ¡ã€‚bin/hiveæˆ–bin/hiveâ€”service cliï¼› HWIï¼šä¸ºWebæ¥å£ï¼Œå¯ä»¥ç”¨è¿‡æµè§ˆå™¨è®¿é—®Hiveï¼Œé»˜è®¤ç«¯å£9999ï¼Œå¯åŠ¨æ–¹å¼ä¸ºbin/hive â€”service hwi; ThriftServerï¼šé€šè¿‡Thriftå¯¹å¤–æä¾›æœåŠ¡ï¼Œé»˜è®¤ç«¯å£æ˜¯10000ï¼Œå¯åŠ¨æ–¹å¼ä¸ºbin/hive â€”service hiveserver; è¿æ¥hive-metastore(å¦‚mysql)çš„ä¸‰ç§æ–¹å¼ å•ç”¨æˆ·æ¨¡å¼ã€‚æ­¤æ¨¡å¼è¿åˆ°æ•°æ®åº“Derbyï¼Œä¸€èˆ¬ç”¨äºUnit Testã€‚ å¤šç”¨æˆ·æ¨¡å¼ã€‚é€šè¿‡ç½‘ç»œè¿æ¥åˆ°ä¸€ä¸ªæ•°æ®åº“ä¸­ï¼Œæ˜¯æœ€ç»å¸¸ä½¿ç”¨åˆ°çš„æ¨¡å¼ã€‚ è¿œç¨‹æœåŠ¡å™¨æ¨¡å¼ã€‚ç”¨äºéJavaå®¢æˆ·ç«¯è®¿é—®å…ƒæ•°æ®åº“ï¼Œåœ¨æœåŠ¡å™¨ç«¯å¯åŠ¨MetaStoreServerï¼Œå®¢æˆ·ç«¯åˆ©ç”¨Thriftåè®®é€šè¿‡MetaStoreServerè®¿é—®å…ƒæ•°æ®åº“ã€‚ 2.4 å…¶ä»–æœåŠ¡bin/hive â€”service -help metastore (bin/hive â€”service metastore) hiveserver2ï¼ˆbin/hive â€”service hiveserver2ï¼‰ HiveServer2 HiveServer2æ˜¯HieServeræ”¹è¿›ç‰ˆæœ¬ï¼Œå®ƒæä¾›ç»™æ–°çš„ThriftAPIæ¥å¤„ç†JDBCæˆ–è€…ODBCå®¢æˆ·ç«¯ï¼Œè¿›è¡ŒKerberosèº«ä»½éªŒè¯ï¼Œå¤šä¸ªå®¢æˆ·ç«¯å¹¶å‘ HS2è¿˜æä¾›äº†æ–°çš„CLIï¼šBeeLineï¼Œæ˜¯Hive 0.11å¼•å…¥çš„æ–°çš„äº¤äº’å¼CLIï¼ŒåŸºäºSQLLineï¼Œå¯ä»¥ä½œä¸ºHive JDBC Client ç«¯è®¿é—®HievServer2ï¼Œå¯åŠ¨ä¸€ä¸ªbeelineå°±æ˜¯ç»´æŠ¤äº†ä¸€ä¸ªsession. Hiveä¸‹è½½åœ°å€ cdh-hive : hive0.13.1-cdh5.3.6 jar åŒ… (æ²¡ç”¨) apache-hive : Apache-Hive Hive-Beeline è¯•éªŒæˆåŠŸ ä¸‹è½½ apache-hive-0.13.1-bin, apache-hadoop2.5ï¼Œé…ç½® HADOOP_HOME, å¯åŠ¨ âœ ./apache-hive-0.13.1-bin/bin/beelineBeeline version 0.13.1 by Apache Hivebeeline&gt; !connect jdbc:hive2://node190:10000 hdfs 1scan complete in 3msConnecting to jdbc:hive2://node190:10000Connected to: Apache Hive (version 0.13.1-cdh5.3.6)Driver: Hive JDBC (version 0.13.1)Transaction isolation: TRANSACTION_REPEATABLE_READ0: jdbc:hive2://node190:10000&gt; select count(*) from ods_dm_shop_tmp;+-------+| _c0 |+-------+| 1091 |+-------+1 row selected (24.815 seconds)0: jdbc:hive2://node190:10000&gt;è¯´æ˜ : beeline å¯ä»¥æˆåŠŸï¼Œç”¨ä»£ç  jdbc å°±å¯ä»¥æˆåŠŸå®‰è£… hadoop å‚è€ƒäº† ã€ŠSparkå¤§æ•°æ®å¤„ç†ã€‹é«˜å½¦æ°@è‘—, ä¸ç”¨é…ç½®ç›´æ¥ç»¿è‰²ç®€å•ç‰ˆ Hive table table ä¸­çš„ä¸€ä¸ª Partition å¯¹åº”è¡¨ä¸‹çš„ä¸€ä¸ªå­ç›®å½• æ¯ä¸€ä¸ª Bucket å¯¹åº”ä¸€ä¸ªæ–‡ä»¶ï¼› Hiveçš„é»˜è®¤æ•°æ®ä»“åº“ç›®å½•æ˜¯/user/hive/warehouse åœ¨hive-site.xmlä¸­ç”±hive.metastore.warehouse.diré¡¹å®šä¹‰ï¼› reference articleå‚è€ƒ : CSDN - Hive Server 2 è°ƒç ”ï¼Œå®‰è£…å’Œéƒ¨ç½²å‚è€ƒ : æè±†æŠ€æœ¯åšå®¢ - Beelineè¿æ¥hiveserver2å¼‚å¸¸å‚è€ƒ : Hiveå­¦ä¹ ä¹‹HiveServer2 JDBCå®¢æˆ·ç«¯å‚è€ƒ : HiveServer2 Clients beelineå‚è€ƒ : Beelineè¿æ¥hiveserver2å¼‚å¸¸å‚è€ƒ : Hiveå­¦ä¹ ä¹‹HiveServer2æœåŠ¡ç«¯é…ç½®ä¸å¯åŠ¨ other tmp ## Chap 7 HiveQL è§†å›¾ #### Chap 8 HiveQL ç´¢å¼• #### Chap 9 æ¨¡å¼è®¾è®¡ #### Chap 10 è°ƒä¼˜ #### Chap 11 å…¶ä»–æ–‡ä»¶æ ¼å¼å’Œå‹ç¼©æ–¹æ³• #### Chap 12 å¼€å‘ #### Chap 13 å‡½æ•° #### Chap 14 Streaming #### Chap 15 è‡ªå®šä¹‰Hiveæ–‡ä»¶å’Œè®°å½•æ ¼å¼ #### Chap 16 Hive çš„ Thrift æœåŠ¡ #### Chap 11 å…¶ä»–æ–‡ä»¶æ ¼å¼å’Œå‹ç¼©æ–¹æ³• ##","categories":[{"name":"hadoop","slug":"hadoop","permalink":"http://iequa.com/categories/hadoop/"}],"tags":[{"name":"hive","slug":"hive","permalink":"http://iequa.com/tags/hive/"}]},{"title":"Spark Introduce and Install","slug":"spark/spark-introduce-and-install","date":"2016-02-01T02:07:21.000Z","updated":"2019-10-20T04:30:35.077Z","comments":true,"path":"2016/02/01/spark/spark-introduce-and-install/","link":"","permalink":"http://iequa.com/2016/02/01/spark/spark-introduce-and-install/","excerpt":"ä»‹ç» Spark çš„å†å²ï¼Œä»‹ç» Spark çš„å®‰è£…ä¸éƒ¨ç½²ï¼Œä»‹ç» Spark çš„ä»£ç æ¶æ„ ç­‰","text":"ä»‹ç» Spark çš„å†å²ï¼Œä»‹ç» Spark çš„å®‰è£…ä¸éƒ¨ç½²ï¼Œä»‹ç» Spark çš„ä»£ç æ¶æ„ ç­‰ Spark å‘æºäº ç¾å›½åŠ å·å¤§å­¦ä¼¯å…‹åˆ©åˆ†æ ¡ AMPLap å¤§æ•°æ®åˆ†æå¹³å°Spark ç«‹è¶³äºå†…å­˜è®¡ç®—ã€ä»å¤šè¿­ä»£æ‰¹é‡å¤„ç†å‡ºå‘Spark å…¼é¡¾æ•°æ®ä»“åº“ã€æµå¤„ç†ã€å›¾è®¡ç®— ç­‰å¤šç§è®¡ç®—èŒƒå¼ï¼Œå¤§æ•°æ®ç³»ç»Ÿé¢†åŸŸå…¨æ ˆè®¡ç®—å¹³å° spark.apache.org University of California, Berkeley 1. Spark çš„å†å²ä¸å‘å±• 2009 å¹´ : Spark è¯ç”Ÿäº AMPLab 2014-02 : Apache é¡¶çº§é¡¹ç›® 2014-05 : Spark 1.0.0 å‘å¸ƒ 2. Spark ä¹‹äº Hadoop Spark æ˜¯ MapReduce çš„æ›¿ä»£æ–¹æ¡ˆ, ä¸”å…¼å®¹ HDFSã€Hive ç­‰åˆ†å¸ƒå¼å­˜å‚¨å±‚ã€‚ Spark ç›¸æ¯” Hadoop MapReduce çš„ä¼˜åŠ¿å¦‚ä¸‹ : ä¸­é—´ç»“æœè¾“å‡º æ•°æ®æ ¼å¼å’Œå†…å­˜å¸ƒå±€ æ‰§è¡Œç­–ç•¥ ä»»åŠ¡è°ƒåº¦çš„å¼€é”€ Sparkç”¨äº‹ä»¶é©±åŠ¨ç±»åº“AKKAæ¥å¯åŠ¨ä»»åŠ¡, é€šè¿‡çº¿ç¨‹æ± å¤ç”¨çº¿ç¨‹é¿å…è¿›çº¿ç¨‹å¯åŠ¨åˆ‡æ¢å¼€é”€ 3. Spark èƒ½å¸¦æ¥ä»€ä¹ˆ ? æ‰“é€ å…¨æ ˆå¤šè®¡ç®—èŒƒå¼çš„é«˜æ•ˆæ•°æ®æµæ°´çº¿ è½»é‡çº§å¿«é€Ÿå¤„ç†, å¹¶æ”¯æŒ Scalaã€Pythonã€Java ä¸ HDFS ç­‰ å­˜å‚¨å±‚ å…¼å®¹ 4. Spark å®‰è£…ä¸éƒ¨ç½²Spark ä¸»è¦ä½¿ç”¨ HDFS å……å½“æŒä¹…åŒ–å±‚ï¼Œæ‰€ä»¥å®Œæ•´çš„å®‰è£… Spark éœ€è¦å…ˆå®‰è£… Hadoop.Spark æ˜¯è®¡ç®—æ¡†æ¶, å®ƒä¸»è¦ä½¿ç”¨ HDFS å……å½“æŒä¹…åŒ–å±‚ã€‚ Linux é›†ç¾¤å®‰è£… Spark å®‰è£… JDK å®‰è£… Scala é…ç½® SSH å…å¯†ç ç™»é™† (å¯é€‰) å®‰è£… Hadoop å®‰è£… Spark å¯åŠ¨ Spark é›†ç¾¤ Sparkå®˜ç½‘ä¸‹è½½ 4.1 å®‰è£… Spark(1). download spark-1.5.2-bin-hadoop2.6.tgz(2). tar -xzvf spark-1.5.2-bin-hadoop2.6.tgz(3). é…ç½® conf/spark-env.sh 1) è¯¦ç»†å¤æ‚å‚æ•°é…ç½®å‚è§ å®˜ç½‘ Configuration 2) vim conf/spark-env.sh export JAVA_HOME=/Library/Java/JavaVirtualMachines/jdk1.7.0_79.jdk/Contents/Home export SCALA_HOME=/usr/local/Cellar/scala/2.11.5 export SPARK_HOME=/usr/local/xSoft/spark export SPARK_MASTER_IP=ip export MASTER=spark://ip:7077 export SPARK_EXECUTOR_INSTANCES=2 export SPARK_EXECUTOR_CORES=1 export SPARK_WORKER_MEMORY=1000m export SPARK_EXECUTOR_MEMORY=300m export SPARK_LIBRARY_PATH=$&#123;SPARK_HOME&#125;/lib(4). é…ç½® conf/slaves (æµ‹è¯•å¯é€‰)(5). ä¸€èˆ¬éœ€è¦ startup ssh server. 4.2 å¯åŠ¨ Spark é›†ç¾¤åœ¨ Spark æ ¹ç›®å½•å¯åŠ¨ Spark ./sbin/start-all.sh./sbin/stop-all.sh å¯åŠ¨å jps æŸ¥çœ‹ ä¼šæœ‰ Master è¿›ç¨‹å­˜åœ¨ âœ spark-1.5.2-bin-hadoop2.6 jps11262 Jps11101 Master11221 Worker 4.3 Spark é›†ç¾¤åˆè¯•å¯ä»¥é€šè¿‡ä¸¤ç§æ–¹å¼è¿è¡Œ Spark æ ·ä¾‹ : ä»¥ ./run-example çš„æ–¹å¼æ‰§è¡Œ âœ cd /usr/local/xSoft/sparkâœ spark ./sbin/start-all.shâœ spark ./bin/run-example org.apache.spark.examples.SparkPi ä»¥ ./Spark Shell æ–¹å¼æ‰§è¡Œ scala&gt; import org.apache.spark._import org.apache.spark._scala&gt; object SparkPi &#123; | | def main(args: Array[String]) &#123; | | val slices = 2 | val n = 100000 * slices | | val count = sc.parallelize(1 to n, slices).map &#123; i =&gt; | | val x = math.random * 2 - 1 | val y = math.random * 2 - 1 | | if (x * x + y * y &lt; 1) 1 else 0 | | &#125;.reduce(_ + _) | | println(&quot;Pi is rounghly &quot; + 4.0 * count / n) | | &#125; | &#125;defined module SparkPiscala&gt;// Spark Shell å·²é»˜è®¤å°† SparkContext ç±»åˆå§‹åŒ–ä¸ºå¯¹è±¡ sc, ç”¨æˆ·ä»£ç å¯ç›´æ¥ä½¿ç”¨ã€‚// Spark è‡ªå¸¦çš„äº¤äº’å¼çš„ Shell ç¨‹åºï¼Œæ–¹ä¾¿è¿›è¡Œäº¤äº’å¼ç¼–ç¨‹ã€‚ é€šè¿‡ Web UI æŸ¥çœ‹é›†ç¾¤çŠ¶æ€ httpï¼š//masterIp:8080 4.4 Spark quick startquick-start : https://spark.apache.org/docs/latest/quick-start.html ./bin/spark-shell scala&gt; val textFile = sc.textFile(&quot;README.md&quot;)textFile: spark.RDD[String] = spark.MappedRDD@2ee9b6e3RDDs have actions, which return values, and transformations, which return pointers to new RDDs. Letâ€™s start with a few actions:scala&gt; textFile.count() // Number of items in this RDDres0: Long = 126scala&gt; textFile.first() // First item in this RDDres1: String = # Apache Spark 5. Spark ç”Ÿæ€ BDAS Spark æ¡†æ¶ã€æ¶æ„ã€è®¡ç®—æ¨¡å‹ã€æ•°æ®ç®¡ç†ç­–ç•¥ Spark BDAS é¡¹ç›®åŠå…¶å­é¡¹ç›®è¿›è¡Œäº†ç®€è¦ä»‹ç» Spark ç”Ÿæ€ç³»ç»ŸåŒ…å«çš„å¤šä¸ªå­é¡¹ç›® : SparkSqlã€Spark Streamingã€GraphXã€MLlib Spark æ˜¯ BDAS æ ¸å¿ƒ, æ˜¯ä¸€ å¤§æ•°æ®åˆ†å¸ƒå¼ç¼–ç¨‹æ¡†æ¶ 6. Spark æ¶æ„ Spark çš„ä»£ç ç»“æ„ Spark çš„æ¶æ„ Spark è¿è¡Œé€»è¾‘ 6.1 Spark çš„ä»£ç ç»“æ„ schedulerï¼šæ–‡ä»¶å¤¹ä¸­å«æœ‰è´Ÿè´£æ•´ä½“çš„Sparkåº”ç”¨ã€ä»»åŠ¡è°ƒåº¦çš„ä»£ç ã€‚broadcastï¼šå«æœ‰Broadcastï¼ˆå¹¿æ’­å˜é‡ï¼‰çš„å®ç°ä»£ç ï¼ŒAPIä¸­æ˜¯Javaå’ŒPython APIçš„å®ç°ã€‚deployï¼šå«æœ‰Sparkéƒ¨ç½²ä¸å¯åŠ¨è¿è¡Œçš„ä»£ç ã€‚commonï¼šä¸æ˜¯ä¸€ä¸ªæ–‡ä»¶å¤¹ï¼Œè€Œæ˜¯ä»£è¡¨Sparké€šç”¨çš„ç±»å’Œé€»è¾‘å®ç°ï¼Œæœ‰5000è¡Œä»£ç ã€‚metricsï¼šæ˜¯è¿è¡Œæ—¶çŠ¶æ€ç›‘æ§é€»è¾‘ä»£ç ï¼ŒExecutorä¸­å«æœ‰WorkerèŠ‚ç‚¹è´Ÿè´£è®¡ç®—çš„é€»è¾‘ä»£ç ã€‚partialï¼šå«æœ‰è¿‘ä¼¼è¯„ä¼°ä»£ç ã€‚ 6.2 Spark çš„æ¶æ„Sparkæ¶æ„é‡‡ç”¨äº†åˆ†å¸ƒå¼è®¡ç®—ä¸­çš„Master-Slaveæ¨¡å‹ã€‚ Role description Master å¯¹åº”é›†ç¾¤ä¸­çš„å«æœ‰Masterè¿›ç¨‹çš„èŠ‚ç‚¹, é›†ç¾¤çš„æ§åˆ¶å™¨ Slave é›†ç¾¤ä¸­å«æœ‰Workerè¿›ç¨‹çš„èŠ‚ç‚¹ Client ä½œä¸ºç”¨æˆ·çš„å®¢æˆ·ç«¯è´Ÿè´£æäº¤åº”ç”¨ Driver è¿è¡ŒApplicationçš„main()å‡½æ•°å¹¶åˆ›å»ºSparkContextã€‚è´Ÿè´£ä½œä¸šçš„è°ƒåº¦ï¼Œå³Taskä»»åŠ¡çš„åˆ†å‘ Worker ç®¡ç†è®¡ç®—èŠ‚ç‚¹å’Œåˆ›å»ºExecutorï¼Œå¯åŠ¨Executor æˆ– Driver. æ¥æ”¶ä¸»èŠ‚ç‚¹å‘½ä»¤ä¸è¿›è¡ŒçŠ¶æ€æ±‡æŠ¥ Executor Worker nodeæ‰§è¡Œä»»åŠ¡çš„ç»„ä»¶,è´Ÿè´£ Task çš„æ‰§è¡Œ,ç”¨äºå¯åŠ¨çº¿ç¨‹æ± è¿è¡Œä»»åŠ¡ ClusterManager Standalone æ¨¡å¼ä¸­ä¸º Master, æ§åˆ¶æ•´ä¸ªé›†ç¾¤, ç›‘æ§Worker SparkContext æ•´ä¸ªåº”ç”¨çš„ä¸Šä¸‹æ–‡, æ§åˆ¶Appçš„ç”Ÿå‘½å‘¨æœŸ RDD Sparkçš„åŸºæœ¬è®¡ç®—å•å…ƒï¼Œä¸€ç»„RDDå¯å½¢æˆæ‰§è¡Œçš„ DAG Num Spark App æµç¨‹ 1. Client æäº¤åº”ç”¨ 2. Master æ‰¾åˆ°ä¸€ä¸ª Worker å¯åŠ¨ Driver 3. Driver å‘ Master æˆ–è€… èµ„æºç®¡ç†å™¨ç”³è¯·èµ„æºï¼Œä¹‹åå°†åº”ç”¨è½¬åŒ–ä¸º RDD Graph 4. DAGScheduler å°† RDD Graph è½¬åŒ–ä¸º Stageçš„æœ‰å‘æ— ç¯å›¾ æäº¤ç»™ TaskScheduler 5. TaskScheduler æäº¤ task ç»™Executoræ‰§è¡Œ 6. åœ¨ä»»åŠ¡æ‰§è¡Œçš„è¿‡ç¨‹ä¸­ï¼Œå…¶ä»–ç»„ä»¶ååŒå·¥ä½œï¼Œç¡®ä¿æ•´ä¸ªåº”ç”¨é¡ºåˆ©æ‰§è¡Œ åœ¨æ‰§è¡Œé˜¶æ®µï¼ŒDriver ä¼šå°† Task å’Œ Taskæ‰€ä¾èµ–çš„file å’Œ jar åºåˆ—åŒ–åä¼ é€’ç»™å¯¹åº”çš„ Workeræœºå™¨ï¼ŒåŒæ—¶ Executorå¯¹ç›¸åº”æ•°æ®åˆ†åŒºçš„ä»»åŠ¡è¿›è¡Œå¤„ç†ã€‚ 7. å°ç»“ç”±äº Spark ä¸»è¦ä½¿ç”¨ HDFS å……å½“æŒä¹…åŒ–å±‚ï¼Œæ‰€ä»¥å®Œæ•´çš„ä½¿ç”¨ Spark éœ€è¦é¢„å…ˆå®‰è£… Hadoop. Spark å°†åˆ†å¸ƒå¼çš„å†…å­˜æ•°æ®æŠ½è±¡ä¸ºå¼¹æ€§åˆ†å¸ƒå¼æ•°æ®é›† (RDD), å¹¶åœ¨å…¶ä¸Šå®ç°äº†ä¸°å¯Œçš„ç®—å­ï¼Œä»è€Œå¯¹ RDD è¿›è¡Œè®¡ç®—ï¼Œæœ€åå°† ç®—å­åºåˆ— è½¬åŒ–ä¸º DAG è¿›è¡Œæ‰§è¡Œå’Œè°ƒåº¦ã€‚ Sparkçš„Python APIå‡ ä¹è¦†ç›–äº†æ‰€æœ‰Scala APIæ‰€èƒ½æä¾›çš„åŠŸèƒ½. ä½†çš„ç¡®æœ‰äº›ç‰¹æ€§ï¼Œæ¯”å¦‚Spark Streamingå’Œä¸ªåˆ«çš„APIæ–¹æ³•ï¼Œæš‚ä¸æ”¯æŒã€‚å…·ä½“å‚è§ã€ŠSparkç¼–ç¨‹æŒ‡å—ã€‹çš„Pythonéƒ¨åˆ† ä½“ä¼šäº† å‡½æ•°å¼ ç¼–ç¨‹. ä¸ªäººè®¤ä¸º scalaã€python æ¯”è¾ƒé€‚åˆå†™ spark ç¨‹åº.","categories":[{"name":"spark","slug":"spark","permalink":"http://iequa.com/categories/spark/"}],"tags":[{"name":"spark","slug":"spark","permalink":"http://iequa.com/tags/spark/"}]},{"title":"Kettle ETL","slug":"hadoop/ops-etl-kettle","date":"2016-01-22T07:34:16.000Z","updated":"2019-10-20T04:30:35.050Z","comments":true,"path":"2016/01/22/hadoop/ops-etl-kettle/","link":"","permalink":"http://iequa.com/2016/01/22/hadoop/ops-etl-kettle/","excerpt":"Kettle çš„ä½¿ç”¨åˆæ­¥ä»‹ç»","text":"Kettle çš„ä½¿ç”¨åˆæ­¥ä»‹ç» ETL æ˜¯æ•°æ®æŠ½å–ï¼ˆExtractï¼‰ã€æ¸…æ´—ï¼ˆCleaningï¼‰ã€è½¬æ¢ï¼ˆTransformï¼‰ã€è£…è½½ï¼ˆLoadï¼‰çš„è¿‡ç¨‹ã€‚ ETL æ˜¯æ„å»º DW çš„é‡è¦ä¸€ç¯ï¼Œç”¨æˆ·ä»æ•°æ®æºæŠ½å–å‡ºæ•°æ®ï¼Œç» æ•°æ®æ¸…æ´—,æŒ‰ç…§é¢„å®šä¹‰å¥½çš„ DWæ¨¡å‹ï¼Œå°†æ•°æ®åŠ è½½åˆ° DW ä¸­å»ã€‚ ETL æ˜¯å°†ä¸šåŠ¡ç³»ç»Ÿçš„æ•°æ®ç»è¿‡æŠ½å–ã€æ¸…æ´—è½¬æ¢ä¹‹ååŠ è½½åˆ° DW çš„è¿‡ç¨‹ï¼Œç›®çš„æ˜¯å°†ä¼ä¸šä¸­çš„åˆ†æ•£é›¶ä¹±ã€æ ‡å‡†ä¸ç»Ÿä¸€çš„æ•°æ®åˆ°ä¸€èµ·ï¼Œä¸ºä¼ä¸šçš„å†³ç­–æä¾›åˆ†æä¾æ®ã€‚ ETL æ˜¯ BI é¡¹ç›®ä¸­ä¸€ä¸ªé‡è¦ç¯èŠ‚ã€‚ ETLçš„è®¾è®¡åˆ†ä¸‰ä¸ªéƒ¨åˆ†ï¼š æ•°æ®æŠ½å– æ•°æ®çš„æ¸…æ´—è½¬æ¢ æ•°æ®çš„åŠ è½½ 1. Kettle å¼€æºçš„ ETL å·¥å…·1-1. Kettle çš„ä»‹ç» ETLï¼ˆExtract-Transform-Loadçš„ç¼©å†™ï¼Œå³æ•°æ®æŠ½å–ã€è½¬æ¢ã€è£…è½½çš„è¿‡ç¨‹ï¼Œ æˆ‘ä»¬ç»å¸¸ä¼šé‡åˆ°å„ç§æ•°æ®çš„å¤„ç†ï¼Œè½¬æ¢ï¼Œè¿ç§»ï¼Œæ‰€ä»¥æŒæ¡ä¸€ç§ ETL å·¥å…·çš„ä½¿ç”¨å¿…ä¸å¯å°‘ã€‚ Kettle æ”¯æŒå›¾å½¢åŒ–çš„GUIè®¾è®¡ç•Œé¢ï¼Œç„¶åå¯ä»¥ä»¥å·¥ä½œæµçš„å½¢å¼æµè½¬ï¼Œç†Ÿç»ƒå®ƒå¯ä»¥å‡å°‘éå¸¸å¤šçš„ç ”å‘å·¥ä½œé‡ï¼Œæé«˜å·¥ä½œæ•ˆç‡ã€‚ Kettle å…è®¸ä½ ç®¡ç†æ¥è‡ªä¸åŒæ•°æ®åº“çš„æ•°æ®ï¼Œé€šè¿‡æä¾›ä¸€ä¸ªå›¾å½¢åŒ–çš„ç”¨æˆ·ç¯å¢ƒæ¥æè¿°ä½ æƒ³åšä»€ä¹ˆã€‚ Kettle ä¸­æœ‰ä¸¤ç§è„šæœ¬æ–‡ä»¶ï¼Œtransformation å’Œ job. transformation å®Œæˆé’ˆå¯¹æ•°æ®çš„åŸºç¡€è½¬æ¢. job åˆ™å®Œæˆæ•´ä¸ªå·¥ä½œæµçš„æ§åˆ¶ã€‚ 1-2. Kettle å®¶æ—äº§å“ Kettleå®¶æ—ç›®å‰åŒ…æ‹¬ 4 ä¸ªäº§å“ï¼šSpoonã€Panã€CHEFã€Kitchenã€‚ Spoon å…è®¸ä½ é€šè¿‡å›¾å½¢ç•Œé¢æ¥è®¾è®¡ ETL è½¬æ¢è¿‡ç¨‹ï¼ˆTransformationï¼‰ã€‚ Pan å…è®¸ä½ æ‰¹é‡è¿è¡Œç”± Spoon è®¾è®¡çš„ ETL è½¬æ¢ (ä¾‹å¦‚ä½¿ç”¨ä¸€ä¸ªæ—¶é—´è°ƒåº¦å™¨)ã€‚Pan æ˜¯ä¸€åå°æ‰§è¡Œçš„ç¨‹åºï¼Œæ²¡å›¾ç•Œé¢ã€‚ Chef å…è®¸ä½ åˆ›å»ºä»»åŠ¡ï¼ˆJobï¼‰ã€‚ ä»»åŠ¡é€šè¿‡å…è®¸æ¯ä¸ªè½¬æ¢ï¼Œä»»åŠ¡ï¼Œè„šæœ¬ç­‰ç­‰ï¼Œæ›´æœ‰åˆ©äºè‡ªåŠ¨åŒ–æ›´æ–°æ•°æ®ä»“åº“çš„å¤æ‚å·¥ä½œã€‚ä»»åŠ¡é€šè¿‡å…è®¸æ¯ä¸ªè½¬æ¢ï¼Œä»»åŠ¡ï¼Œè„šæœ¬ç­‰ç­‰ã€‚ä»»åŠ¡å°†ä¼šè¢«æ£€æŸ¥ï¼Œçœ‹çœ‹æ˜¯å¦æ­£ç¡®åœ°è¿è¡Œäº†ã€‚ Kitchen å…è®¸ä½ æ‰¹é‡ä½¿ç”¨ç”± Chef è®¾è®¡çš„ä»»åŠ¡ (ä¾‹å¦‚ä½¿ç”¨ä¸€ä¸ªæ—¶é—´è°ƒåº¦å™¨)ã€‚Kitchen ä¹Ÿæ˜¯åå°è¿è¡Œçš„ç¨‹åºã€‚ 2. ä¸‹è½½å’Œéƒ¨ç½²å®‰è£…ÂKettleå¯ä»¥åœ¨http://kettle.pentaho.org/ ç½‘ç«™ä¸‹è½½ÂÂä¸‹è½½ kettle å‹ç¼©åŒ…ï¼Œå›  kettle ä¸ºç»¿è‰²è½¯ä»¶ï¼Œè§£å‹ç¼©åˆ°ä»»æ„æœ¬åœ°è·¯å¾„å³å¯ å®‰è£…éœ€è¦ : JDKã€JAVA_HOMEã€CLASSPATHã€PENTAHO_JAVA_HOME ç­‰ç¯å¢ƒå˜é‡ã€‚ å¦‚éœ€è¿æ¥mysqlï¼Œåˆ™éœ€å°† mysql-connector-java-5.1.38.jar æ”¾å…¥åˆ° lib ä¸­ã€‚ 2-1 kettle windows å®‰è£… å»ºè®®åœ¨ windows ä¸‹ä½¿ç”¨æ“ä½œç»ƒä¹  kettle windows å¯¹å›¾å½¢åŒ– æ”¯æŒå¥½ ç›´æ¥å¯åŠ¨ Spoon.bat å³å¯ 2-2 kettle Linux å®‰è£… linux å›¾å½¢åŒ–ä¸å¼ºï¼Œå¦‚éœ€è¦åœ¨ linux ä¸­æŸ¥çœ‹ä¸€ä¸‹ kettle èµ„æºåº“æ˜¯å¦è¿æ¥æ­£å¸¸ï¼Œä»¥åŠåœ¨ linux ä¸Šè°ƒåº¦ kettle çš„ jobï¼Œå°±éœ€è¦åœ¨ Linuxä¸Š é…ç½® kettle ç¯å¢ƒäº†ã€‚ éªŒè¯ kettle éƒ¨ç½²æˆåŠŸ cd data-integrationè¾“å…¥å‘½ä»¤./kitchen.shã€‚å¦‚æœå‡ºç°å¸®åŠ©ä¿¡æ¯è¯´æ˜éƒ¨ç½²æˆåŠŸ å¦‚å‡ºç°é”™è¯¯ï¼Œè¯· chmod +x *.shï¼Œå†è¯•ã€‚ 2-3 kettle osx å®‰è£… å·²ç»å­˜åœ¨ 3. åº”ç”¨åœºæ™¯è¿™é‡Œç®€å•æ¦‚æ‹¬ä¸€ä¸‹å‡ ç§å…·ä½“çš„åº”ç”¨åœºæ™¯ï¼ŒæŒ‰ç½‘ç»œç¯å¢ƒåˆ’åˆ†ä¸»è¦åŒ…æ‹¬ï¼š 3-1 è¡¨è§†å›¾æ¨¡å¼ï¼š è¿™ç§æƒ…å†µæˆ‘ä»¬ç»å¸¸é‡åˆ°ï¼Œå°±æ˜¯åœ¨åŒä¸€ç½‘ç»œç¯å¢ƒä¸‹ï¼Œæˆ‘ä»¬å¯¹å„ç§æ•°æ®æºçš„è¡¨æ•°æ®è¿›è¡ŒæŠ½å–ã€è¿‡æ»¤ã€æ¸…æ´—ç­‰ï¼Œä¾‹å¦‚å†å²æ•°æ®åŒæ­¥ã€å¼‚æ„ç³»ç»Ÿæ•°æ®äº¤äº’ã€æ•°æ®å¯¹ç§°å‘å¸ƒæˆ–å¤‡ä»½ç­‰éƒ½å½’å±äºè¿™ä¸ªæ¨¡å¼ï¼›ä¼ ç»Ÿçš„å®ç°æ–¹å¼ä¸€èˆ¬éƒ½è¦è¿›è¡Œç ”å‘ï¼ˆä¸€å°éƒ¨åˆ†ä¾‹å¦‚ä¸¤ä¸ªç›¸åŒè¡¨ç»“æ„çš„è¡¨ä¹‹é—´çš„æ•°æ®åŒæ­¥ï¼Œå¦‚æœsqlserveræ•°æ®åº“å¯ä»¥é€šè¿‡å‘å¸ƒ/è®¢é˜…å®ç°ï¼‰ï¼Œæ¶‰åŠåˆ°ä¸€äº›å¤æ‚çš„ä¸€äº›ä¸šåŠ¡é€»è¾‘å¦‚æœæˆ‘ä»¬ç ”å‘å‡ºæ¥è¿˜å®¹æ˜“å‡ºå„ç§bugï¼› 3-2 å‰ç½®æœºæ¨¡å¼ æ•°æ®äº¤æ¢çš„åŒæ–¹ A å’Œ B ç½‘ç»œä¸é€šï¼Œä½†æ˜¯ A å’Œ B éƒ½å¯ä»¥å’Œå‰ç½®æœº C è¿æ¥.. 3-3 æ–‡ä»¶æ¨¡å¼ æ•°æ®äº¤äº’çš„åŒæ–¹ A å’Œ B æ˜¯å®Œå…¨çš„ç‰©ç†éš”ç¦»ï¼Œè¿™æ ·å°±åªèƒ½é€šè¿‡ä»¥æ–‡ä»¶çš„æ–¹å¼æ¥è¿›è¡Œæ•°æ®äº¤äº’äº†ï¼Œä¾‹å¦‚ XML æ ¼å¼. 4. DEMOå®æˆ˜4-1 ç®€å•è¡¨åŒæ­¥åŠŸèƒ½æè¿° : æ•°æ®åº“ TestDB01 ä¸­çš„ UsersAè¡¨ åˆ° æ•°æ®åº“TestDB02 çš„UsersBè¡¨ï¼›å®ç°æµç¨‹ : å»ºç«‹ä¸€ä¸ªè½¬æ¢å’Œä¸€ä¸ªä½œä¸šJobï¼› ä¸€ã€å»ºç«‹è½¬æ¢ è¿›å…¥ä¸»ç•Œé¢ï¼Œæ–°å»ºä¸€ä¸ªè½¬æ¢ï¼Œè½¬æ¢çš„åç¼€åä¸º ktr. åˆ›å»º DBè¿æ¥ï¼Œé€‰æ‹©æ–°å»º DBè¿æ¥, TestæŒ‰é’®æµ‹è¯•æ˜¯å¦é…ç½®æ­£ç¡®ï¼ æˆ‘ä»¬éœ€è¦å»ºç«‹ä¸¤ä¸ª DBè¿æ¥ï¼Œåˆ†åˆ«ä¸º TestDB01 å’Œ TestDB02ï¼› (å¦‚æŠ¥é”™å¯ä»¥ : ä¸‹è½½ mysql-connect jar æ”¾å…¥ lib ç›®å½•ä¸‹) å»ºç«‹æ­¥éª¤å’Œæ­¥éª¤å…³ç³» : [è¾“å…¥] -&gt; [è¡¨è¾“å…¥] ç‚¹å‡»æ ¸å¿ƒå¯¹è±¡ï¼Œæˆ‘ä»¬ä»æ­¥éª¤æ ‘ä¸­é€‰æ‹©ã€è¡¨è¾“å…¥ã€‘, è¿™æ ·æ‹–æ‹½ä¸€ä¸ª è¡¨è¾“å…¥ ä¹‹åï¼Œæˆ‘ä»¬åŒå‡»è¡¨è¾“å…¥ä¹‹åï¼Œæˆ‘ä»¬è‡ªå·±å¯ä»¥éšæ„å†™ä¸€ä¸ª sql è¯­å¥ï¼Œè¿™ä¸ªè¯­å¥è¡¨ç¤º å¯ä»¥åœ¨è¿™ä¸ªåº“ä¸­éšæ„ç»„åˆï¼Œåªè¦ sql è¯­å¥æ²¡æœ‰é”™è¯¯å³å¯ï¼Œæˆ‘è¿™é‡Œåªæ˜¯æœ€ç®€å•çš„æŠŠ TestA ä¸­çš„æ‰€æœ‰æ•°æ®æŸ¥å‡ºæ¥ï¼Œè¯­å¥ä¸º select * from usersAã€‚ å»ºç«‹æ­¥éª¤å’Œæ­¥éª¤å…³ç³» : [è¾“å‡º] -&gt; [æ’å…¥/æ›´æ–°] åŒä¸Šç±»ä¼¼ å»ºç«‹ è¿æ¥ å…³ç³» ç„¶ååœ¨ã€è¡¨è¾“å…¥ã€‘ä¸ŠåŒæ—¶æŒ‰ä½ shift é”®å’Œé¼ æ ‡å·¦é”®æ»‘å‘ã€æ’å…¥/æ›´æ–°ã€‘ï¼Œè¿™æ ·å»ºç«‹ä¸¤ä¸ªæ­¥éª¤ä¹‹é—´çš„è¿æ¥ è¿è¡Œ å»ºç«‹å¥½è½¬æ¢ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥è¿è¡Œ(ç‚¹å‡»ä¸Šé¢çš„å°ä¸‰è§’å½¢)è¿™ä¸ªè½¬æ¢ï¼Œæ£€æŸ¥ä¸€ä¸‹æ˜¯å¦æœ‰é”™ï¼Œå¦‚å›¾ï¼Œæœ‰é”™è¯¯éƒ½ä¼šåœ¨ä¸‹é¢çš„æ§åˆ¶å°ä¸Šè¾“å‡ºã€‚ äºŒã€å»ºç«‹ä½œä¸š : å¦‚æœæˆ‘ä»¬éœ€è¦è®©è¿™ä¸ªè½¬æ¢å®šæ—¶æ‰§è¡Œæ€ä¹ˆåŠå‘¢ï¼Œé‚£ä¹ˆæˆ‘ä»¬éœ€è¦å»ºç«‹ä¸€ä¸ªä½œä¸šjob æ–°å»º Job æ–‡ä»¶-&gt;æ–°å»º-&gt;Job åœ¨ Job ä¸­ æ·»åŠ  è½¬æ¢ åœ¨æ–°å»ºçš„ä½œä¸šä¸­, æ‰“å¼€åˆšæ‰æ–°å»ºçš„ [ç®€å•è¡¨åŒæ­¥] çš„ transformation æ·»åŠ  START é€šç”¨ -&gt; START ä½¿ START å…³è” -&gt; [ç®€å•è¡¨åŒæ­¥] Transformation è¿™æ ·æˆ‘ä»¬åœ¨ã€Startã€‘æ­¥éª¤ä¸Šé¢åŒå‡» è®¾ç½®æ—¶é—´é—´éš”ã€å®šæ—¶æ‰§è¡Œ ç­‰éœ€è¦çš„å‚æ•° è¿™æ ·è¿™ä¸ªä½œä¸šå°±åˆ¶å®šå¥½äº†ï¼Œç‚¹å‡»ä¿å­˜ä¹‹åï¼Œå°±å¯ä»¥åœ¨å›¾å½¢åŒ–ç•Œé¢ä¸Šç‚¹å‡»å¼€å§‹æ‰§è¡Œäº†ã€‚ 5. win/linux åå°è¿è¡Œ5-1 win åå°è¿è¡ŒsimpleTableSync.bat @echo off if &quot;%1&quot; == &quot;h&quot; goto begin mshta vbscript:createobject(&quot;wscript.shell&quot;).run(&quot;%~nx0 h&quot;,0)(window.close)&amp;&amp;exit :beginC:cd C:\\WorkSoft\\data-integrationkitchen /file:C:\\WorkJob\\ETL\\tSyncTestJob.kjb /level:Basic&gt;&gt;C:\\WorkJob\\ETL\\MyTest.log /level:Basic&gt;&gt;C:\\WorkJob\\ETL\\MyTest.log 5-2 linux åå°è¿è¡ŒsimpleTableSync.sh #!/bin/bash################################################################### @date: 2016.01.28# @desc: simpleTableSync @kettle##################################################################cd `dirname $0`/.. &amp;&amp; wk_dir=`pwd` &amp;&amp; cd -source $&#123;wk_dir&#125;/util/envecho_ex &quot;$&#123;data_integration&#125;/kitchen.sh -file=$&#123;data_dir&#125;/tSyncTestJob.kjb&quot;$&#123;data_integration&#125;/kitchen.sh -file=$&#123;data_dir&#125;/tSyncTestJob.kjbcheck_successexit 0 æ³¨æ„ : kjb ä¸ ktr æœ€å¥½æ”¾åœ¨ä¸€ä¸ªç›®å½•ä¸‹ã€‚ [hdfs@node196 simpleTableSync]$ cd data/[hdfs@node196 data]$ lltotal 24-rw-rw-r--. 1 hdfs hdfs 6944 Jan 29 18:22 tSyncTestJob.kjb-rw-rw-r--. 1 hdfs hdfs 13450 Jan 29 18:22 tSyncTestTrans.ktr ä» win æ‹·è´è¿‡æ¥çš„æ–‡ä»¶ï¼Œfileformat å¯èƒ½æ˜¯ dos æ ¼å¼ï¼Œå¯ä»¥ :set ff=unix. Reference articlekettleç³»åˆ—","categories":[{"name":"hadoop","slug":"hadoop","permalink":"http://iequa.com/categories/hadoop/"}],"tags":[{"name":"kettle","slug":"kettle","permalink":"http://iequa.com/tags/kettle/"}]},{"title":"Logback å…¥é—¨åˆæ­¥","slug":"java/java-logback-indoor","date":"2015-12-27T07:54:16.000Z","updated":"2019-10-20T04:30:35.028Z","comments":true,"path":"2015/12/27/java/java-logback-indoor/","link":"","permalink":"http://iequa.com/2015/12/27/java/java-logback-indoor/","excerpt":"Logback ä¸€ä¸ªå¼€æºæ—¥å¿—ç»„ä»¶, SLF4J è¿™ä¸ªç®€å•çš„æ—¥å¿—å‰ç«¯æ¥å£ï¼ˆFaÃ§adeï¼‰æ¥æ›¿ä»£ Jakarta Commons-Logging ã€‚","text":"Logback ä¸€ä¸ªå¼€æºæ—¥å¿—ç»„ä»¶, SLF4J è¿™ä¸ªç®€å•çš„æ—¥å¿—å‰ç«¯æ¥å£ï¼ˆFaÃ§adeï¼‰æ¥æ›¿ä»£ Jakarta Commons-Logging ã€‚ Logback ä¸€ä¸ªå¼€æºæ—¥å¿—ç»„ä»¶ã€‚Logback å½“å‰åˆ†æˆä¸‰ä¸ªæ¨¡å—ï¼šlogback-core logback- classic å’Œ logback-accessã€‚ 1. logback ç®€ä»‹Cekiåœ¨Javaæ—¥å¿—é¢†åŸŸä¸–ç•ŒçŸ¥åã€‚ä»–åˆ›é€ äº†Log4J ï¼Œè¿™ä¸ªæœ€æ—©çš„Javaæ—¥å¿—æ¡†æ¶å³ä¾¿åœ¨JREå†…ç½®æ—¥å¿—åŠŸèƒ½çš„ç«äº‰ä¸‹ä»ç„¶éå¸¸æµè¡Œã€‚éšåä»–åˆç€æ‰‹å®ç°SLF4J è¿™ä¸ªâ€œç®€å•çš„æ—¥å¿—å‰ç«¯æ¥å£ï¼ˆFaÃ§adeï¼‰â€æ¥æ›¿ä»£Jakarta Commons-Logging ã€‚ Logbackï¼Œä¸€ä¸ªâ€œå¯é ã€é€šç”¨ã€å¿«é€Ÿè€Œåˆçµæ´»çš„Javaæ—¥å¿—æ¡†æ¶â€ã€‚ å®˜ç½‘ç½‘å€ : http://logback.qos.ch/ 2. å·¥ç¨‹ä½¿ç”¨éœ€è¦çš„ jarè¦åœ¨å·¥ç¨‹é‡Œé¢ä½¿ç”¨ logback , åªéœ€è¦ä»¥ä¸‹jaræ–‡ä»¶ï¼š (1). slf4j-api.jar (2). logback-access.jar (3). logback-classic.jar (4). logback-core.jar logback-core æ˜¯å…¶å®ƒä¸¤ä¸ªæ¨¡å—çš„åŸºç¡€æ¨¡å—ã€‚ logback-classic æ˜¯ log4j çš„ä¸€ä¸ª æ”¹è‰¯ç‰ˆæœ¬ã€‚ logback-access ä¸Servletå®¹å™¨é›†æˆæä¾›é€šè¿‡Httpæ¥è®¿é—®æ—¥å¿—åŠŸèƒ½ logback-classic å®Œæ•´å®ç° SLF4J API ä½¿ä½ å¯ä»¥å¾ˆæ–¹ä¾¿åœ°æ›´æ¢æˆå…¶å®ƒæ—¥å¿—ç³»ç»Ÿå¦‚ log4j æˆ– JDK Loggingã€‚ 3. logback å¸¸ç”¨é…ç½®è¯¦è§£3.1 æ ¹èŠ‚ç‚¹&lt; configuration &gt; configuration è¯´æ˜ scan å½“æ­¤å±æ€§è®¾ç½®ä¸ºtrueæ—¶ï¼Œé…ç½®æ–‡ä»¶å¦‚æœå‘ç”Ÿæ”¹å˜ï¼Œå°†ä¼šè¢«é‡æ–°åŠ è½½ï¼Œé»˜è®¤å€¼ä¸ºtrueã€‚ scanPeriod è®¾ç½®ç›‘æµ‹é…ç½®æ–‡ä»¶æ˜¯å¦æœ‰ä¿®æ”¹çš„æ—¶é—´é—´éš”ï¼Œå¦‚æœæ²¡æœ‰ç»™å‡ºæ—¶é—´å•ä½ï¼Œé»˜è®¤å•ä½æ˜¯æ¯«ç§’ã€‚å½“scanä¸ºtrueæ—¶ï¼Œæ­¤å±æ€§ç”Ÿæ•ˆã€‚é»˜è®¤çš„æ—¶é—´é—´éš”ä¸º1åˆ†é’Ÿã€‚ debug å½“æ­¤å±æ€§è®¾ç½®ä¸ºtrueæ—¶ï¼Œå°†æ‰“å°å‡º logback å†…éƒ¨æ—¥å¿—ä¿¡æ¯ï¼Œå®æ—¶æŸ¥çœ‹logbackè¿è¡ŒçŠ¶æ€ã€‚é»˜è®¤å€¼ä¸ºfalseã€‚ 4. logback é…ç½®ç¤ºä¾‹4.1 Myself resources/logback.xml example&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;!--å½“æ­¤å±æ€§è®¾ç½®ä¸ºtrueæ—¶ï¼Œå°†æ‰“å°å‡ºlogbackå†…éƒ¨æ—¥å¿—ä¿¡æ¯ï¼Œå®æ—¶æŸ¥çœ‹logbackè¿è¡ŒçŠ¶æ€ã€‚é»˜è®¤å€¼ä¸ºfalseã€‚--&gt;&lt;configuration scan=&quot;true&quot; scanPeriod=&quot;3600 seconds&quot; debug=&quot;false&quot;&gt; &lt;property name=&quot;AppName&quot; value=&quot;your_app_name&quot;/&gt; &lt;property name=&quot;LogParentDir&quot; value=&quot;/home/www/logs/&quot;/&gt; &lt;contextName&gt;$&#123;AppName&#125;&lt;/contextName&gt; &lt;appender name=&quot;infoAppender&quot; class=&quot;ch.qos.logback.core.rolling.RollingFileAppender&quot;&gt; &lt;filter class=&quot;ch.qos.logback.classic.filter.LevelFilter&quot;&gt; &lt;level&gt;INFO&lt;/level&gt; &lt;onMatch&gt;ACCEPT&lt;/onMatch&gt; &lt;onMismatch&gt;DENY&lt;/onMismatch&gt; &lt;/filter&gt; &lt;rollingPolicy class=&quot;ch.qos.logback.core.rolling.TimeBasedRollingPolicy&quot;&gt; &lt;fileNamePattern&gt;$&#123;LogParentDir&#125;/$&#123;AppName&#125;/infoLogFile.%d&#123;yyyy-MM-dd&#125;.log&lt;/fileNamePattern&gt; &lt;maxHistory&gt;30&lt;/maxHistory&gt; &lt;/rollingPolicy&gt; &lt;encoder&gt; &lt;pattern&gt;%d&#123;yyyy-MM-dd HH:mm:ss.SSS&#125; [%thread] %-5level %logger&#123;36&#125; - %msg%n&lt;/pattern&gt; &lt;/encoder&gt; &lt;/appender&gt; &lt;appender name=&quot;errorAppender&quot; class=&quot;ch.qos.logback.core.rolling.RollingFileAppender&quot;&gt; &lt;filter class=&quot;ch.qos.logback.classic.filter.LevelFilter&quot;&gt; &lt;level&gt;ERROR&lt;/level&gt; &lt;onMatch&gt;ACCEPT&lt;/onMatch&gt; &lt;onMismatch&gt;DENY&lt;/onMismatch&gt; &lt;/filter&gt; &lt;rollingPolicy class=&quot;ch.qos.logback.core.rolling.TimeBasedRollingPolicy&quot;&gt; &lt;fileNamePattern&gt;$&#123;LogParentDir&#125;/$&#123;AppName&#125;/errorLogFile.%d&#123;yyyy-MM-dd&#125;.log&lt;/fileNamePattern&gt; &lt;maxHistory&gt;30&lt;/maxHistory&gt; &lt;/rollingPolicy&gt; &lt;encoder&gt; &lt;pattern&gt;%d&#123;yyyy-MM-dd HH:mm:ss.SSS&#125; [%thread] %-5level %logger&#123;36&#125; - %msg%n&lt;/pattern&gt; &lt;/encoder&gt; &lt;/appender&gt; &lt;!--å…¶ä¸­appenderçš„é…ç½®è¡¨ç¤ºæ‰“å°åˆ°æ§åˆ¶å°--&gt; &lt;appender name=&quot;STDOUT&quot; class=&quot;ch.qos.logback.core.ConsoleAppender&quot;&gt; &lt;encoder&gt; &lt;pattern&gt;%d&#123;yyyy-MM-dd HH:mm:ss.SSS&#125; [%thread] %-5level %logger&#123;36&#125; - %msg%n&lt;/pattern&gt; &lt;/encoder&gt; &lt;/appender&gt; &lt;logger name=&quot;com.x.dmt&quot; level=&quot;ERROR&quot; additivity=&quot;false&quot;&gt; &lt;appender-ref ref=&quot;errorAppender&quot;/&gt; &lt;/logger&gt; &lt;!--è®¾ç½®addtivityä¸ºfalseï¼Œå°†æ­¤logerçš„æ‰“å°ä¿¡æ¯ä¸å‘ä¸Šçº§ä¼ é€’ï¼›--&gt; &lt;logger name=&quot;com.x.dmt.service&quot; level=&quot;INFO&quot; additivity=&quot;fasle&quot;&gt; &lt;appender-ref ref=&quot;infoAppender&quot;/&gt; &lt;/logger&gt; &lt;!-- æ³¨æ„: logger åŒåæƒ…å†µ, çº§åˆ«ä½çš„,éœ€è¦æ”¾åœ¨ä¸‹é¢,å¦åˆ™çº§åˆ«é«˜çš„ä¼šè¦†ç›–çº§åˆ«ä½çš„æƒé™,æ—©æ™¨çº§åˆ«ä½çš„æ‰“å°ä¸å‡ºæ¥æ—¥å¿— --&gt;&lt;/configuration&gt; æ›´å¤šå‚è§ iteye1101260 å®˜æ–¹ç½‘å€","categories":[{"name":"java","slug":"java","permalink":"http://iequa.com/categories/java/"}],"tags":[{"name":"logback","slug":"logback","permalink":"http://iequa.com/tags/logback/"}]},{"title":"Work å¸¸ç”¨çš„å‘½ä»¤ç§¯ç´¯","slug":"devops/work-used-commands","date":"2015-05-29T10:09:44.000Z","updated":"2019-10-20T04:30:34.994Z","comments":true,"path":"2015/05/29/devops/work-used-commands/","link":"","permalink":"http://iequa.com/2015/05/29/devops/work-used-commands/","excerpt":"2015å¹´å·¥ä½œæ—¶å€™çš„å¸¸ç”¨çš„å‘½ä»¤ç§¯ç´¯","text":"2015å¹´å·¥ä½œæ—¶å€™çš„å¸¸ç”¨çš„å‘½ä»¤ç§¯ç´¯ awk æ‰¾å‡º =ä¸&amp; ä¹‹é—´çš„å­—ç¬¦ä¸² å¹¶è¾“å‡º awk &#x27;&#123;print $3&#125;&#x27; (1) awk -F&quot;[=|&amp;]&quot; &#x27;&#123;print $2&#125;&#x27; file1 &gt; file2 (2) awk -F&quot;[:|\\n]&quot; &#x27;&#123;print $2&#125;&#x27; file1 &gt; file2 awk -F&quot;[\\^|\\^]&quot; &#x27;&#123;print $2&#125;&#x27; file1 &gt; file2 (3) sed &#x27;/\\^/d&#x27; è¯•è¯•awk -F&quot;[crowd_list&quot;:|&quot;attachment&quot;]&quot; &#x27;&#123;print $2&#125;&#x27; file1 &gt; file2 shell1). shell ä¸­ cut å‘½ä»¤çš„ç”¨æ³• echo root:x:0:0:root:/root:/bin/bash | cut -d : -f 6-7 2). å¦‚ä½•æŸ¥çœ‹ä¸€ä¸ªç›®å½•å ç”¨çš„ç©ºé—´ du -sh * 3). åå°è¿è¡Œè„šæœ¬çš„å‘½ä»¤ nohup sh create_redis.sh &gt; create_redis.log 2&gt;&amp;1 &amp; 4). æŸ¥æ‰¾ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶ä¸­æ˜¯å¦å«æœ‰æŸä¸ªå­—ç¬¦ä¸² find .|xargs grep -ri &quot;IBM&quot; 5). æŸ¥æ‰¾ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶ä¸­æ˜¯å¦å«æœ‰æŸä¸ªå­—ç¬¦ä¸²,å¹¶ä¸”åªæ‰“å°å‡ºæ–‡ä»¶å find .|xargs grep -ri &quot;IBM&quot; -l 6). è®©ä¸€ä¸ªå˜é‡å…·æœ‰åŒå¼•å· &#x27;&quot;$&#123;plat&#125;:$version_init&quot;&#x27; 7). æ‰¹é‡æ›¿æ¢å­—ç¬¦ä¸² sed -i &quot;s/oldString/newString/g&quot; `grep oldString -rl ./` 8). VIM tab ^I æ›¿æ¢ :set listchars=tab:\\ \\ ,eol:$ gitgit clone http://****/dm/dmp_engine.git ï¼ˆæ³¨æ„è¿™ä¸ªåœ°å€æ˜¯ HTTP ä¸æ˜¯ SSHï¼‰ cd dmp_enginegit branch -rgit checkout åˆ†æ”¯åï¼Œè¿™æ˜¯é‡æ–° down åˆ†æ”¯çš„æ­¥éª¤git add filenamegit commit -m â€œa&quot;git push origin åˆ†æ”¯å æˆ–è€…git push -u origin origin/dev_dmp_online_servinggit checkout branch_name åˆ‡æ¢åˆ°è¿™ä¸ªåˆ†æ”¯ä¹‹ä¸‹git checkout -b online_redis3.0 master (ä» master æ‹‰ä¸‹ æ–°åˆ†æ”¯, æ–°åˆ†æ”¯åå« online_redis3.0) linux os_infoæŸ¥çœ‹ å†…å­˜ ä¸ CPU ä¿¡æ¯ 1). æŸ¥çœ‹å†…å­˜ cat /proc/meminfo 2). æŸ¥çœ‹ç‰©ç†CPUçš„ä¸ªæ•° #cat /proc/cpuinfo | grep &quot;physical id&quot; | sort | uniq | wc -l 3). æŸ¥çœ‹é€»è¾‘CPUçš„ä¸ªæ•° #cat /proc/cpuinfo | grep &quot;processor&quot; | wc -l 4). æŸ¥çœ‹CPUæ˜¯å‡ æ ¸ #cat /proc/cpuinfo | grep &quot;cores&quot; | uniq 5). æŸ¥çœ‹CPUçš„ä¸»é¢‘ #cat /proc/cpuinfo | grep MHz | uniq hivehive -e &quot;select attributes[&#x27;lt_its&#x27;],attributes[&#x27;ad_clicks&#x27;] from new_algo_user_attributes where dt=&#x27;20150419&#x27; and platform=&#x27;pc&#x27; and attributes[&#x27;lt_its&#x27;]&lt;&gt;&#x27;NULL&#x27; limit 10&quot; Reference","categories":[{"name":"devops","slug":"devops","permalink":"http://iequa.com/categories/devops/"}],"tags":[{"name":"work-cmd","slug":"work-cmd","permalink":"http://iequa.com/tags/work-cmd/"}]},{"title":"Hive ä¸­ udfã€udaf å’Œ udtf çš„ä½¿ç”¨","slug":"hadoop/hadoop-hive-udf-udaf","date":"2015-02-01T02:07:21.000Z","updated":"2020-12-06T06:30:31.101Z","comments":true,"path":"2015/02/01/hadoop/hadoop-hive-udf-udaf/","link":"","permalink":"http://iequa.com/2015/02/01/hadoop/hadoop-hive-udf-udaf/","excerpt":"Hive æ˜¯åŸºäº Hadoop ä¸­çš„ MapReduceï¼Œæä¾› HQL æŸ¥è¯¢çš„æ•°æ®ä»“åº“. Hive æ˜¯ä¸€ä¸ªå¾ˆå¼€æ”¾çš„ç³»ç»Ÿï¼Œå¾ˆå¤šå†…å®¹éƒ½æ”¯æŒç”¨æˆ·å®šåˆ¶. å¦‚ : æ–‡ä»¶æ ¼å¼ã€MRè„šæœ¬ã€è‡ªå®šä¹‰å‡½æ•°ã€è‡ªå®šä¹‰èšåˆå‡½æ•° ç­‰.","text":"Hive æ˜¯åŸºäº Hadoop ä¸­çš„ MapReduceï¼Œæä¾› HQL æŸ¥è¯¢çš„æ•°æ®ä»“åº“. Hive æ˜¯ä¸€ä¸ªå¾ˆå¼€æ”¾çš„ç³»ç»Ÿï¼Œå¾ˆå¤šå†…å®¹éƒ½æ”¯æŒç”¨æˆ·å®šåˆ¶. å¦‚ : æ–‡ä»¶æ ¼å¼ã€MRè„šæœ¬ã€è‡ªå®šä¹‰å‡½æ•°ã€è‡ªå®šä¹‰èšåˆå‡½æ•° ç­‰. UDFç¼–å†™ UDFå‡½æ•° çš„æ—¶å€™éœ€è¦æ³¨æ„ä¸€ä¸‹å‡ ç‚¹ï¼š è‡ªå®šä¹‰ UDF éœ€è¦ç»§æ‰¿ org.apache.hadoop.hive.ql.UDF éœ€è¦å®ç° evaluate å‡½æ•° ä»¥ä¸‹æ˜¯ä¸¤ä¸ªæ•°æ±‚å’Œå‡½æ•°çš„UDFã€‚evaluateå‡½æ•°ä»£è¡¨ä¸¤ä¸ªæ•´å‹æ•°æ®ç›¸åŠ  package hive.connect; import org.apache.hadoop.hive.ql.exec.UDF; public final class Add extends UDF &#123; public Integer evaluate(Integer a, Integer b) &#123; if (null == a || null == b) &#123; return null; &#125; return a + b; &#125; &#125; UDAFå‡½æ•°ç±»éœ€è¦ç»§æ‰¿ UDAF ç±»ï¼Œå†…éƒ¨ç±» Evaluator éœ€è¦å®ç° UDAFEvaluator æ¥å£. Evaluator éœ€è¦å®ç° initã€iterateã€terminatePartialã€mergeã€terminate è¿™å‡ ä¸ªå‡½æ•°. initå‡½æ•°å®ç°æ¥å£ UDAFEvaluator çš„ init å‡½æ•°. iterateæ¥æ”¶ä¼ å…¥çš„å‚æ•°ï¼Œå¹¶è¿›è¡Œå†…éƒ¨çš„è½®è½¬ã€‚å…¶è¿”å›ç±»å‹ä¸º boolean. terminatePartialæ— å‚æ•°ï¼Œå…¶ä¸º iterate å‡½æ•°è½®è½¬ç»“æŸåï¼Œè¿”å›è½®è½¬æ•°æ®. merge æ¥æ”¶ terminatePartial çš„è¿”å›ç»“æœï¼Œè¿›è¡Œæ•°æ® merge æ“ä½œï¼Œå…¶è¿”å›ç±»å‹ä¸ºboolean. terminate è¿”å›æœ€ç»ˆçš„èšé›†å‡½æ•°ç»“æœ. ä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•çš„ UDAF çš„ demo package com.x.user_bhv;import com.google.common.collect.Maps;import org.apache.hadoop.hive.ql.exec.UDAF;import org.apache.hadoop.hive.ql.exec.UDAFEvaluator;import java.util.HashMap;import java.util.Map;public class UDAFMergeIntToIntMap extends UDAF &#123; public static class PartialResult &#123; Map&lt;Integer, Integer&gt; attributes; PartialResult() &#123; attributes = Maps.newHashMap(); &#125; &#125; public static class UnitIdUDAFEvaluator implements UDAFEvaluator &#123; private PartialResult partialResult; public UnitIdUDAFEvaluator() &#123; super(); init(); &#125; public void init() &#123; System.out.println(&quot;map init&quot;); partialResult = new PartialResult(); &#125; public boolean iterate(Map&lt;Integer, Integer&gt; attributes_args) &#123; if (attributes_args == null || attributes_args.isEmpty()) &#123; return true; &#125; for (Map.Entry&lt;Integer, Integer&gt; entry : attributes_args.entrySet()) &#123; this.partialResult.attributes.put(entry.getKey(), entry.getValue()); &#125; return true; &#125; public PartialResult terminatePartial() &#123; return this.partialResult; &#125; public boolean merge(PartialResult other) &#123; // å‚æ•°ä¸å¯èƒ½ä¸º null for (Map.Entry&lt;Integer, Integer&gt; entry : other.attributes.entrySet()) &#123; this.partialResult.attributes.put(entry.getKey(), entry.getValue()); &#125; return true; &#125; public Map&lt;Integer, Integer&gt; terminate() &#123; if (partialResult == null) &#123; return new HashMap&lt;Integer, Integer&gt;(); &#125; else &#123; return this.partialResult.attributes; &#125; &#125; &#125; public static void main(String[] args) &#123; &#125;&#125; åœ¨ Hive è„šæœ¬ä¸­çš„ä½¿ç”¨ç¤ºä¾‹ : hql=&quot;ADD jar $&#123;jar_dir&#125;/user_bhv_for_hive.jar; CREATE TEMPORARY FUNCTION merge_int_to_int_map AS &#x27;com.x.user_bhv.UDAFMergeIntToIntMap&#x27;; INSERT OVERWRITE TABLE $&#123;table_user_buy_category&#125; SELECT mobile_number, merge_int_to_int_map (level1_id_count_map) FROM ods_dm_e_coupon GROUP BY mobile_number Summary é‡è½½ evaluate å‡½æ•°. UDF å‡½æ•°ä¸­å‚æ•°ç±»å‹å¯ä»¥ä¸ºWritableï¼Œä¹Ÿå¯ä¸ºjavaä¸­çš„åŸºæœ¬æ•°æ®å¯¹è±¡. UDF æ”¯æŒå˜é•¿çš„å‚æ•°. Hive æ”¯æŒéšå¼ç±»å‹è½¬æ¢. å®¢æˆ·ç«¯é€€å‡ºæ—¶ï¼Œåˆ›å»ºçš„ä¸´æ—¶å‡½æ•°è‡ªåŠ¨é”€æ¯. evaluateå‡½æ•°å¿…é¡»è¦è¿”å›ç±»å‹å€¼ï¼Œç©ºçš„è¯è¿”å›nullï¼Œä¸èƒ½ä¸ºvoidç±»å‹. UDF å’Œ UDAF éƒ½å¯ä»¥é‡è½½. æŸ¥çœ‹å‡½æ•° SHOW FUNCTIONS. UDAF: User Defined Aggregation Function Reference Hive ä¸­ UDFã€UDAF å’Œ UDTF ä½¿ç”¨ bliarâ€™s github hive udaf demo","categories":[{"name":"hadoop","slug":"hadoop","permalink":"http://iequa.com/categories/hadoop/"}],"tags":[{"name":"hive","slug":"hive","permalink":"http://iequa.com/tags/hive/"}]},{"title":"MapReduce for Python","slug":"hadoop/hadoop-mr-for-python","date":"2015-01-30T02:37:21.000Z","updated":"2019-10-20T04:30:35.048Z","comments":true,"path":"2015/01/30/hadoop/hadoop-mr-for-python/","link":"","permalink":"http://iequa.com/2015/01/30/hadoop/hadoop-mr-for-python/","excerpt":"æˆ‘ä»¬å¯ä»¥ç”¨ hadoop-streaming çš„æ–¹å¼ï¼Œé€šè¿‡ python ç­‰å…¶ä»–è¯­è¨€æ¥ç¼–å†™ MR ç¨‹åº.","text":"æˆ‘ä»¬å¯ä»¥ç”¨ hadoop-streaming çš„æ–¹å¼ï¼Œé€šè¿‡ python ç­‰å…¶ä»–è¯­è¨€æ¥ç¼–å†™ MR ç¨‹åº. Mapé˜¶æ®µï¼šmapper.py#!/usr/bin/env pythonimport sysfor line in sys.stdin: line = line.strip() words = line.split() for word in words: print(&quot;%s&quot; % word) # è¿™é‡Œä»…ä»…æ˜¯ä¸€ä¸ªä¾‹å­ï¼Œåªè¾“å‡ºäº†ç¬¬ä¸€åˆ— ä¸ºäº†æ˜¯è„šæœ¬å¯æ‰§è¡Œï¼Œå¢åŠ mapper.pyçš„å¯æ‰§è¡Œæƒé™ å½“ç„¶ï¼ŒMapé˜¶æ®µï¼Œ ä½ ä¹Ÿå¯ä»¥ä¸ä½œå¤„ç†åŸæ ·è¾“å‡º: åªå†™ä¸€ä¸ª cat Reduceé˜¶æ®µï¼šreducer.py#!/usr/bin/env python# -*- coding: utf-8 -*-# Copyright 2013 x Inc. All Rights Reserved__author__ = &#x27;Blair Chan&#x27;import sysimport constantfrom datetime import datetimefrom EsHelper import EsHelperdef insert_user_basic_consume_info(items, esHelper): basic_consume_info_doc = get_user_basic_consume_info_doc(items) if basic_consume_info_doc is None: return _id = basic_consume_info_doc[&#x27;mobile_number&#x27;] basic_consume_info_index = &quot;basic_consume_info_index&quot; esHelper.index(index=basic_consume_info_index, doc_type=basic_consume_info_index, id=_id, data=basic_consume_info_doc)def get_user_basic_consume_info_doc(items): doc = None try: doc = &#123; &quot;mobile_number&quot;: items[0], &quot;first_consume_time&quot;: items[1] &#125; except BaseException as e: print(&quot;Exist Exception : %s About get_user_basic_consume_info_doc, mobile_number: %s&quot; % (str(e), mobile_number)) finally: pass return docdef main(): esHelper = EsHelper(constant.ES_URL) success_sum = 0 for line in sys.stdin: line = line.strip() items = line.split(&#x27;\\001&#x27;) if len(items) &lt; 2: continue insert_user_basic_consume_info(items, esHelper) success_sum = success_sum + 1 print(&quot;Success:%d&quot; % success_sum)if __name__ == &#x27;__main__&#x27;: main() æœ¬åœ°æµ‹è¯•cat data.txt | python mapper.py | sort | reducer.py æäº¤Hadoop#!/bin/bashcd `dirname $0`/.. &amp;&amp; wk_dir=`pwd` &amp;&amp; cd -source $&#123;wk_dir&#125;/util/envinput_file=&quot;$&#123;OSS_URL&#125;/$&#123;mds_hive_dir&#125;/$&#123;table_user_basic_consume_info&#125;/*&quot;output_file=&quot;$&#123;OSS_URL&#125;/$&#123;tmp_hive_dir&#125;/$&#123;table_user_basic_consume_info&#125;/dt=$&#123;d1&#125;&quot;reducer=&quot;reducer.py&quot;reducer_depend1=&quot;constant.py&quot;reducer_depend2=&quot;EsHelper.py&quot;archive=&quot;$&#123;OSS_URL&#125;/share/packages/elasticsearch-5.0.0.tar.gz#elasticsearch-5.0.0&quot; ## archive è¡¨ç¤ºçš„ä¾èµ–åŒ…éœ€è¦ä¸Šä¼ åˆ° hdfs ä¸Šï¼Œ#åé¢è¡¨ç¤ºçš„æ˜¯è§£å‹åçš„ç›®å½•å$&#123;HADOOP&#125; fs -rmr $&#123;output_file&#125;cmd=&quot;$&#123;HADOOP&#125; jar $&#123;hadoop_streaming_jar&#125; -D mapred.map.tasks=100 -D mapred.reduce.tasks=100 -D stream.map.input.ignoreKey=true -input $&#123;input_file&#125; -output $&#123;output_file&#125; -file $&#123;reducer&#125; -file $&#123;reducer_depend1&#125; -file $&#123;reducer_depend2&#125; -mapper cat -reducer $&#123;reducer&#125; -cacheArchive $&#123;archive&#125;&quot;echo_ex &quot;$cmd&quot;$cmdcheck_success hadoop_streaming_jar=â€/home/data_mining/share/packages/hadoop2/hadoop-streaming-2.7.2.jarâ€ ä»¥ä¸Šä»…ä»…æ˜¯ä¸€ä¸ªä¾‹å­ï¼Œè™½ç„¶æ’å…¥ ES å‡ºç°å¼‚å¸¸ï¼Œä½†æœ¬ç¯‡ä»…ä»…è¯´æ˜å¦‚ä½•ç”¨ python å†™ mapreduce ç¨‹åº Reference ç”¨pythonå†™MapReduceå‡½æ•°â€”â€”ä»¥WordCountä¸ºä¾‹","categories":[{"name":"hadoop","slug":"hadoop","permalink":"http://iequa.com/categories/hadoop/"}],"tags":[{"name":"hadoop","slug":"hadoop","permalink":"http://iequa.com/tags/hadoop/"}]},{"title":"Linux, profile / bashrc Brief Introduce","slug":"devops/linux-bashrc-profile","date":"2014-05-17T23:54:16.000Z","updated":"2019-10-20T04:30:34.988Z","comments":true,"path":"2014/05/18/devops/linux-bashrc-profile/","link":"","permalink":"http://iequa.com/2014/05/18/devops/linux-bashrc-profile/","excerpt":"/etc/profileã€/etc/bashrcã€~/.bash_profileã€~/.bashrc","text":"/etc/profileã€/etc/bashrcã€~/.bash_profileã€~/.bashrc config file desc /etc/profileï¼Œ/etc/bashrc ç³»ç»Ÿå…¨å±€ç¯å¢ƒå˜é‡è®¾å®š ~/.profileï¼Œ~/.bashrc ç”¨æˆ·å®¶ç›®å½•ä¸‹çš„ç§æœ‰ç¯å¢ƒå˜é‡è®¾å®š 1. login env steps ä»¥ä¸‹æ˜¯ ç™»å…¥ç³»ç»Ÿ,ç¯å¢ƒè®¾å®šæ¡£ æµç¨‹ Read step desc /etc/profile /etc/profile.d å’Œ /etc/inputrc ã€‚ ä»/etc/profile.dç›®å½•çš„é…ç½®æ–‡ä»¶æœé›†shellçš„è®¾ç½® ~/.bash_profile ~/.bash_profileï¼Œå¦‚æ— åˆ™è¯»å– ~/.bash_loginï¼Œå¦‚æ— åˆ™è¯»å– ~/.profile ~/.bashrc ~/.bashrc (äº¤äº’å¼ non-login æ–¹å¼è¿›å…¥ bash è¿è¡Œçš„) 2. .profile ä¸ .bashrc~/.profile ä¸ ~/.bashrc 2.1 ç›¸åŒç‚¹éƒ½å…·æœ‰ä¸ªæ€§åŒ–å®šåˆ¶åŠŸèƒ½ ~/.profile å¯ä»¥è®¾å®šæœ¬ç”¨æˆ·ä¸“æœ‰çš„è·¯å¾„ï¼Œç¯å¢ƒå˜é‡ï¼Œç­‰ï¼Œå®ƒåªèƒ½ç™»å…¥çš„æ—¶å€™æ‰§è¡Œä¸€æ¬¡~/.bashrc ä¹Ÿæ˜¯æŸç”¨æˆ·ä¸“æœ‰è®¾å®šæ–‡æ¡£ï¼Œå¯ä»¥è®¾å®šè·¯å¾„ï¼Œå‘½ä»¤åˆ«åï¼Œæ¯æ¬¡shell scriptçš„æ‰§è¡Œéƒ½ä¼šä½¿ç”¨å®ƒä¸€æ¬¡ 2.2 bashrc å’Œ profile çš„åŒºåˆ«äº¤äº’å¼æ¨¡å¼ shellç­‰å¾…ä½ çš„è¾“å…¥ï¼Œå¹¶ä¸”æ‰§è¡Œä½ æäº¤çš„å‘½ä»¤ã€‚ shellä¸ç”¨æˆ·è¿›è¡Œäº¤äº’ ç™»å½•ã€æ‰§è¡Œå‘½ä»¤ã€ç­¾é€€ã€shellç»ˆæ­¢ ~/.bash_profile æ˜¯äº¤äº’å¼ã€login æ–¹å¼è¿›å…¥ bash è¿è¡Œçš„ ~/.bashrc æ˜¯äº¤äº’å¼ non-login æ–¹å¼è¿›å…¥ bash è¿è¡Œçš„ éäº¤äº’å¼æ¨¡å¼ shellä¸ä¸ä½ è¿›è¡Œäº¤äº’ï¼Œæ˜¯è¯»å–å­˜åœ¨æ–‡ä»¶ä¸­çš„å‘½ä»¤,å¹¶ä¸”æ‰§è¡Œå®ƒä»¬ã€‚å½“å®ƒè¯»åˆ°æ–‡ä»¶çš„ç»“å°¾ï¼Œshellç»ˆæ­¢ Referenceblog.chinaunix.net/","categories":[{"name":"devops","slug":"devops","permalink":"http://iequa.com/categories/devops/"}],"tags":[{"name":"bashrc","slug":"bashrc","permalink":"http://iequa.com/tags/bashrc/"}]},{"title":"Qunar Trainee","slug":"devops/my-dev-trainee","date":"2014-05-06T22:24:16.000Z","updated":"2020-10-18T06:08:21.813Z","comments":true,"path":"2014/05/07/devops/my-dev-trainee/","link":"","permalink":"http://iequa.com/2014/05/07/devops/my-dev-trainee/","excerpt":"an trainee in qunar","text":"an trainee in qunar æ—¶é—´è¿‡å¾—çœŸå¿«ï¼Œæˆ‘åœ¨å»å“ªå„¿ç½‘å®ä¹ å·²ç»æœ‰ä¸€æ®µæ—¶é—´äº†ï¼Œåœ¨è¿™æœŸé—´æˆ‘çœŸçš„å­¦ä¼šäº†å¾ˆå¤šï¼Œç»è¿‡è¿™æ¬¡åŸ¹è®­ï¼Œæˆ‘å­¦ä¼šäº†javaï¼Œäº†è§£äº†guavaï¼Œå­¦ä¹ äº†SVNï¼Œ gitç‰ˆæœ¬ç®¡ç†å·¥å…·ï¼Œ Mavené¡¹ç›®ç®¡ç†åŠè‡ªåŠ¨æ„å»ºå·¥å…·ï¼Œ SpringMVCçš„å¼€å‘ï¼Œmybatis çš„ä½¿ç”¨ï¼ŒServletï¼Œ jspï¼Œ htmlï¼Œ http çš„åˆæ­¥äº†è§£ï¼ŒåŠ¨æ€ä»£ç†ä¸AOPï¼Œ å•å…ƒæµ‹è¯•ä¸è‡ªåŠ¨åŒ–æµ‹è¯•ï¼Œæ•°æ®åº“å»ºè¡¨è§„èŒƒï¼Œ Linuxç³»ç»Ÿçš„ä½¿ç”¨ç­‰ç­‰ç­‰ç­‰ï¼Œç†Ÿæ‚‰äº†å…¬å¸å†…éƒ¨çš„å¼€å‘æ¡†æ¶ï¼Œäº†è§£å…¬å¸å¼€å‘è§„èŒƒï¼Œé€‚åº”å…¬å¸æ–‡åŒ–ï¼Œç¯å¢ƒã€‚ åœ¨è¿™äº›å¤©å®ä¹ çš„æ—¥å­ï¼Œæœ€åˆæœ¬æƒ³ä¸èµ° java è·¯çº¿çš„ï¼Œè§‰å¾—å°è£…å¥½ä¸¥é‡ï¼Œä½ æ ¹æœ¬ä¸çŸ¥é“é‚£ä¸ªåŒ…æ˜¯æ€ä¹ˆå›äº‹ï¼Œå°±å¯ä»¥æ‹¿è¿‡æ¥ä¸€ç”¨ï¼Œå°±å‡ºæ¥äº†ä¸€ä¸ªçœ‹èµ·æ¥æ¯”è¾ƒé«˜å¤§ä¸Šçš„ä½œå“ï¼Œå­¦å¾ˆçŸ­çš„æ—¶é—´å°±å¯ä»¥æå‡ºä¸ªä¸œè¥¿æ¥ï¼Œè§‰å¾—æ²¡æœ‰Cã€C++æˆ–è€…æ˜¯ç®—æ³•ï¼Œæ¥å¾—é‚£ä¹ˆçˆ½ã€‚ä½†æ˜¯ç»è¿‡åŸ¹è®­åï¼Œæˆ‘æ‰å‘ç°äº†javaçš„å¯çˆ±ä¹‹å¤„ä¸å¼ºå¤§ï¼Œä»¥å‰å¯¹javaæœ‰è¯¯è§£ï¼Œå®Œå…¨æ˜¯è‡ªå·±çš„æ— çŸ¥ä¸ä¸æ‡‚ï¼Œé‡åˆ°äº†é…’åº—äº‹ä¸šéƒ¨çš„ æ€é›¨å¤§ç¥ï¼Œæ›´æ˜¯æ„Ÿå—åˆ°äº†å­¦ä¹ javaè¿™æ–¹é¢çš„çŸ¥è¯†ï¼Œå¯ä»¥å¾ˆç‰›å¾ˆç‰›ï¼Œå­¦ä»»ä½•ä¸€é—¨æŠ€æœ¯éƒ½å…·æœ‰æ›´ä¸ºå¹¿é˜”çš„ç©ºé—´ï¼Œå®ä¹ åˆæœŸï¼Œç”±äºæˆ‘å¯¹javaçŸ¥è¯†ä¹‹å‰æ˜¯æ²¡æœ‰ä»»ä½•ç»éªŒçš„ï¼Œæ‰€ä»¥é¢å¯¹ä¸¥æ ¼å¿«é€Ÿæ­£è§„çš„åŸ¹è®­ï¼ŒçœŸçš„æ„Ÿåˆ°å‹åŠ›å¾ˆå¤§ï¼Œå¹¸å¥½å°ç»„çš„åˆ†äº«è¿˜æœ‰åšä½œä¸šé‡åˆ°é—®é¢˜ï¼Œç»„å†…å¤–åŒå­¦çš„å¸®åŠ©ï¼Œæ‰å¯ä»¥è·Ÿä¸‹æ¥ï¼Œç”±äºåˆå­¦ï¼ŒèŠ‚å¥å¾ˆå¿«ï¼Œé‚£ä¹ˆå¤šçŸ¥è¯†ï¼Œåœ¨ä¸åˆ°2ä¸ªæœˆçš„æ—¶é—´å†…å…¨éƒ¨å­¦ç†Ÿæ˜¯å¾ˆéš¾åšåˆ°çš„ï¼Œæˆ‘ç°åœ¨å¯¹ SpringMVC è¿˜æœ‰ä¸€äº› Guavaï¼Œwebçš„çŸ¥è¯†ï¼Œè¿˜ä¸æ˜¯å¾ˆç†Ÿç»ƒï¼Œä»¥åä¸€å®šè¦æ‰¾æ—¶é—´åœ¨è‡ªå·±è¡¥ä¹ ä¸‹è¿™æ–¹é¢çš„çŸ¥è¯†ã€‚å¹¶æŠŠè‡ªå·±åœ¨å…¬å¸å­¦åˆ°çš„ä¸€äº›çŸ¥è¯†ï¼Œä»‹ç»ç»™å­¦æ ¡çš„ä¸€äº›è¿˜åœ¨è¿·èŒ«æ‡µæ‡‚çš„å­¦å¦¹ï¼Œå­¦å¼Ÿä»¬ã€‚åœ¨å…¬å¸çš„å®ä¹ ç”Ÿæ´»ï¼Œå¯¹æˆ‘æ¥è¯´ä¸ä»…ä»…æ˜¯æŠ€æœ¯å’Œèƒ½åŠ›ä¸Šçš„æå‡ï¼Œæ›´å¤šçš„è¿˜æœ‰æ€æƒ³å’Œæ€åº¦çš„è½¬å˜ã€‚ æœ€åï¼Œé¦–å…ˆï¼Œè¦æ„Ÿè°¢å…¬å¸ç»™æˆ‘ä»¬åº”å±Šç”Ÿæä¾›çš„è¿™ä¸ªåŸ¹è®­å¹³å°ï¼Œå¯ä»¥è®©æˆ‘å­¦åˆ°è¿™ä¹ˆå¤šçš„ä¸“ä¸šçŸ¥è¯†ï¼Œè®¤è¯†åˆ°æ›´å¤šçš„å¿—åŒé“åˆçš„æœ‹å‹ï¼›æ„Ÿè°¢ä¸«ä¸«å§ï¼Œè¾›è‹¦æ“åŠ³çš„å°½å¯èƒ½ç»™æˆ‘ä»¬æä¾›æ¬¢æ„‰çš„å­¦ä¹ ç¯å¢ƒï¼Œä»¥åŠé‚€è¯·å¾ˆå¤šçš„ä¼˜ç§€è®²å¸ˆï¼›æ„Ÿè°¢å…¨ä½“ç»™æˆ‘ä»¬è®²è¯¾çš„è®²å¸ˆä»¬ï¼Œæ„Ÿè°¢æˆ‘çš„å›¢é˜Ÿä»¥åŠå‘¨è¾¹çš„åŒäº‹ï¼Œåœ¨å·¥ä½œå­¦ä¹ çš„ç¹å¿™ä¹‹ä½™ï¼Œè¿˜å¯ä»¥å¸¦æ¥å„ç§å„æ ·çš„æ¬¢å£°ç¬‘è¯­ï¼Œæ„Ÿè°¢è€ä½•ä¸davidï¼Œè®©æˆ‘å­¦åˆ°äº†ä¸¥è°¨ï¼Œè´Ÿè´£ï¼Œè®¤çœŸçš„å·¥ä½œæ€åº¦ä¸ç”Ÿæ´»æ€åº¦ã€‚","categories":[{"name":"devops","slug":"devops","permalink":"http://iequa.com/categories/devops/"}],"tags":[{"name":"health","slug":"health","permalink":"http://iequa.com/tags/health/"}]},{"title":"Linux é¸Ÿå“¥çš„ç§æˆ¿èœ è¯»ä¹¦å¿ƒå¾—","slug":"devops/linux-bird-bro","date":"2013-08-29T10:09:44.000Z","updated":"2019-10-20T04:30:34.988Z","comments":true,"path":"2013/08/29/devops/linux-bird-bro/","link":"","permalink":"http://iequa.com/2013/08/29/devops/linux-bird-bro/","excerpt":"Linux é¸Ÿå“¥çš„ç§æˆ¿èœ è¯»ä¹¦å¿ƒå¾— ï¼š å®è·µä¸è§‚å¯Ÿæ‰æ˜¯ç‹é“","text":"Linux é¸Ÿå“¥çš„ç§æˆ¿èœ è¯»ä¹¦å¿ƒå¾— ï¼š å®è·µä¸è§‚å¯Ÿæ‰æ˜¯ç‹é“ 0. è®¡ç®—æœºæ¦‚è®ºè®¡ç®—æœºï¼šæ¥å—ç”¨æˆ·è¾“å…¥çš„æŒ‡ä»¤ä¸æ•°æ®ï¼Œç»è¿‡å¤„ç†å™¨çš„æ•°æ®ä¸é€»è¾‘å•å…ƒè¿ç®—å¤„ç†åï¼Œä»¥äº§ç”Ÿæˆ–å­˜å‚¨æˆæœ‰ç”¨çš„ä¿¡æ¯ã€‚ è®¡ç®—æœºç¡¬ä»¶çš„äº”å¤§å•å…ƒ è¾“å…¥å•å…ƒ (é¼ æ ‡ï¼Œé”®ç›˜ç­‰) æ§åˆ¶å™¨ è¿ç®—å™¨ (ç®—æœ¯é€»è¾‘ï¼Œæ§åˆ¶ï¼Œè®°å¿†) å­˜å‚¨å™¨ è¾“å‡ºå•å…ƒ (å±å¹•ï¼Œæ‰“å°æœºç­‰) CPU ä¸ºä¸€ä¸ªå…·æœ‰ç‰¹å®šåŠŸèƒ½çš„èŠ¯ç‰‡ï¼Œé‡Œå¤´å«æœ‰å¾®æŒ‡ä»¤é›†ã€‚CPU è¯»å–çš„æ•°æ®éƒ½æ˜¯ä»å†…å­˜ä¸­è¯»å–æ¥çš„ï¼Œå†…å­˜çš„æ•°æ®æ˜¯ç”±è¾“å…¥å•å…ƒä¼ è¾“è¿›æ¥çš„ã€‚CPU å¤„ç†å®Œæ¯•çš„æ•°æ®è¦å†™å…¥å†…å­˜ï¼Œå†…å­˜å†åˆ°è¾“å‡ºå•å…ƒã€‚ æ¥å£è®¾å¤‡ ä¸»æ¿ (è®¾å¤‡è¿æ¥ä¸€èµ·ï¼Œè®©å…¶åè°ƒï¼Œé€šä¿¡) å­˜å‚¨è®¾å¤‡(ç¡¬ç›˜ï¼Œè½¯ç›˜ï¼Œå…‰ç›˜ï¼Œç£å¸¦) æ˜¾ç¤ºè®¾å¤‡ ç½‘ç»œè®¾å¤‡ ç¡¬ç›˜æœ€å°ç‰©ç†é‡512bytes,æœ€å°çš„ç»„æˆå•ä½ä¸ºæ‰‡åŒºsector ä¸ªäººè®¡ç®—æœºçš„æ¶æ„ä¸è®¾è®¡ x86å¼€å‘å•† (intel,AMD) çš„cpuæ¶æ„å¹¶ä¸å…¼å®¹ï¼Œä¸»æ¿èŠ¯ç‰‡ç»„è®¾è®¡ä¸ç›¸åŒã€‚ ä¸»æ¿ä¸Šæœ€é‡è¦çš„å°±æ˜¯èŠ¯ç‰‡ç»„ï¼ŒèŠ¯ç‰‡ç»„é€šå¸¸åˆåˆ†ä¸ºä¸¤ä¸ªæ¡¥æ¥å™¨æ¥æ§åˆ¶å„ç»„ä»¶çš„é€šä¿¡ã€‚ åŒ—æ¡¥ : è´Ÿè´£è¿æ¥è¾ƒå¿«çš„ cpu,å†…å­˜å’Œæ˜¾å¡ ç­‰ç»„ä»¶ã€‚ (AMD : å†…å­˜ç›´æ¥ä¸cpué€šä¿¡ï¼Œä¸ç»è¿‡åŒ—æ¡¥)å—æ¡¥ : è´Ÿè´£è¿æ¥ç¡¬ç›˜ï¼ŒUSBï¼Œç½‘å¡ç­‰ã€‚ åŒ—æ¡¥çš„æ€»çº¿ç§°ä¸ºç³»ç»Ÿæ€»çº¿ï¼Œæ˜¯å†…å­˜ä¼ è¾“çš„ä¸»è¦ä¿¡é“ã€‚ ä¸æ€»çº¿å®½åº¦ç±»ä¼¼ï¼Œcpuæ¯æ¬¡èƒ½å¤Ÿå¤„ç†çš„æ•°æ®é‡ç§°ä¸ºå­—ç»„å¤§å°(word size),å­—ç»„å¤§å°ä¾æ®cpuçš„è®¾è®¡è€Œæœ‰32ä½ä¸64ä½ã€‚ æ˜¾å¡å‚å•†ç›´æ¥åœ¨æ˜¾å¡ä¸Šé¢åµŒå…¥ä¸€ä¸ª3DåŠ é€Ÿçš„èŠ¯ç‰‡ï¼Œè¿™å°±æ˜¯GPUç§°è°“çš„ç”±æ¥ã€‚CMOSæ˜¯ç”µè„‘ä¸»æ¿ä¸Šçš„ä¸€å—å¯è¯»å†™çš„RAMèŠ¯ç‰‡ã€‚å› ä¸ºå¯è¯»å†™çš„ç‰¹æ€§. æ‰€ä»¥åœ¨ç”µè„‘ä¸»æ¿ä¸Šç”¨æ¥ä¿å­˜BIOSè®¾ç½®å®Œç”µè„‘ç¡¬ä»¶å‚æ•°åçš„æ•°æ®ï¼Œè¿™ä¸ªèŠ¯ç‰‡ä»…ä»…æ˜¯ç”¨æ¥å­˜æ”¾æ•°æ®çš„ã€‚BIOSä¸ºå†™å…¥åˆ°ä¸»æ¿ä¸ŠæŸä¸€å—é—ªå­˜æˆ–EEPROMçš„ç¨‹åºï¼Œåœ¨å¼€æœºçš„æ—¶å€™è¿è¡Œï¼Œä»¥åŠ è½½CMOSå½“ä¸­çš„å‚æ•°ã€‚ è½¯ä»¶æ˜¯è®¡ç®—æœºçš„çµé­‚ã€‚ æœºå™¨ç¨‹åºä¸ç¼–è¯‘ç¨‹åºã€‚ C/C++ â€” ç¼–è¯‘å™¨ â€”&gt; æœºå™¨ç  æ“ä½œç³»ç»Ÿ OS å¦‚æœæˆ‘ä»¬èƒ½å¤Ÿå°†ç¡¬ä»¶éƒ½é©±åŠ¨ï¼Œå¹¶ä¸”æä¾›ä¸€ä¸ªå¼€å‘è½¯ä»¶çš„å‚è€ƒæ¥å£æ¥ç»™å·¥ç¨‹å¸ˆå¼€å‘è½¯ä»¶çš„è¯ï¼Œé‚£å°±æ˜¯OS OS å†…æ ¸ï¼š OSå…¶å®æ˜¯ä¸€ç»„ç¨‹åºï¼Œè¿™ç»„ç¨‹åºçš„é‡ç‚¹åœ¨äºç®¡ç†è®¡ç®—æœºçš„æ‰€æœ‰æ´»åŠ¨ä»¥åŠé©±åŠ¨ç³»ç»Ÿä¸­çš„æ‰€æœ‰ç¡¬ä»¶ã€‚OSå†…æ ¸ â€” å¼€æœºåå¸¸é©»å†…å­˜ã€‚ ç³»ç»Ÿè°ƒç”¨ï¼š System Call â€” å¼€å‘è½¯ä»¶ï¼Œå‚è€ƒå†…æ ¸çš„ç›¸å…³åŠŸèƒ½ã€‚ åº”ç”¨ç¨‹åº â€” ç³»ç»Ÿè°ƒç”¨ â€” OSå†…æ ¸ â€” ç¡¬ä»¶ å†…æ ¸åŠŸèƒ½ï¼š ç³»ç»Ÿè°ƒç”¨æ¥å£ ç¨‹åºç®¡ç† å†…å­˜ç®¡ç† æ–‡ä»¶ç³»ç»Ÿç®¡ç† è®¾å¤‡é©±åŠ¨ 1. Linux ä»‹ç» GNU (Richard Mathew Stallman - å²æ‰˜æ›¼) ä¼Ÿå¤§çš„äººç‰©ã€‚ GNU é€šç”¨å…¬å…±è®¸å¯è¯ GPL - General Public License Emacs GCC (GNU C Compiler ) GLIBC (GNU C Library) Bash shell Linus Torvalds - Linux å‚è€ƒ Minix(from è°­å®é‚¦æ•™æˆ) Linux å‚è€ƒäº† POSIXè§„èŒƒ(å¯æºå¼æ“ä½œç³»ç»Ÿæ¥å£)ï¼Œé‡ç‚¹åœ¨äºè§„èŒƒå†…æ ¸ä¸åº”ç”¨ç¨‹åºä¹‹é—´çš„æ¥å£ã€‚ Linux å¦‚ä½•å­¦ä¹ ï¼š å®è·µå†å®è·µ â€” è¦å¢åŠ è‡ªå·±çš„ä½“åŠ›ï¼Œå°±åªæœ‰è¿åŠ¨ï¼›è¦å¢åŠ è‡ªå·±çš„çŸ¥è¯†ï¼Œå°±åªæœ‰è¯»ä¹¦ã€‚ é¸Ÿå“¥çš„å»ºè®® ã€ ï¼ˆ1ï¼‰å»ºè®®å…´è¶£ ï¼ˆ2ï¼‰æˆå°±æ„Ÿ (è¢«è®¤å¯ï¼Œè¢«è®¤åŒ) ã€ 2. Linux æ–‡ä»¶å‘½ä»¤ä¸æƒé™Linux : å¤šç”¨æˆ·ï¼Œå¤šä»»åŠ¡ç¯å¢ƒã€‚ owner, group, others ä¸” å„æœ‰ read, write, execute ç­‰æƒé™ã€‚ /etc/passwd /etc/shadow /etc/group æ–‡ä»¶å‘½ä»¤ æ–‡ä»¶å¤„ç†å‘½ä»¤ [ ls, cp, mv, rm, cat, ln, file] æ–‡ä»¶å†…å®¹æŸ¥é˜… [ cat, more, less, head, tail] æƒé™ç®¡ç†å‘½ä»¤ [ chmod u+r g-w o=x 777, chown [-R] robby filename, chgrp ç»„å filename, umask -S] æ–‡ä»¶æœç´¢å‘½ä»¤ [ which, find, locate, updatedb, grep ] which -aåœ¨å“ª, whereis -b(æ•°æ®åº“) locate æ˜¾ç¤ºæ‰€æœ‰ å‹ç¼©è§£å‹å‘½ä»¤ [ gzip, gunzip, tar, zip, bzip2] ç½‘ç»œé€šä¿¡å‘½ä»¤ [ write, wall, ping, ifconfig] å¸®åŠ©å‘½ä»¤ [ man, info, whatis apropos, help] whereis ä¸ which [ä¸åŒæ˜¯å¯ä»¥çœ‹åˆ°å‘½ä»¤æ‰€åœ¨å¸®åŠ©æ–‡æ¡£ä½ç½®] æ–‡ä»¶ç±»å‹ 1, (æ™®é€šæ–‡ä»¶ï¼Œçº¯æ–‡æœ¬æ–‡ä»¶(ASCII)ï¼Œ - äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œæ•°æ®æ ¼å¼æ–‡ä»¶)2, ç›®å½• d directory3, è¿æ¥æ–‡ä»¶ ( l è½¯é“¾æ¥æ–‡ä»¶link )4, è®¾å¤‡ä¸è®¾å¤‡æ–‡ä»¶(b,c)5, å¥—æ¥å­—6, ç®¡é“ æ–‡ä»¶æƒé™ drwxr-xr-x 2 hp hp 4096 2012-12-25 16:18 dlinux[æ–‡ä»¶ç±»å‹ä¸æƒé™] [ç¡¬é“¾æ¥æ•°] [æ‰€æœ‰è€…] [æ‰€å±ç»„] [æ–‡ä»¶å®¹é‡] [ä¿®æ”¹æ—¥æœŸ] [æ–‡ä»¶å]4096 - æ–‡ä»¶å¤§å° [ä¸æ˜¯å¾ˆå‡†ç¡®ï¼Œæ ‡è®°ç›®å½•æœ¬èº«çš„å¤§å°ï¼Œä¸æ˜¯ç›®å½•æ€»å¤§å°] æ•°æ®å—(512å­—èŠ‚1å•ä½) ç‰¹æ®Šæƒ…å†µï¼š hp@ubuntu:~/2014$ ls -ld /usr/bin/passwd-rwsr-xr-x 1 root root 42824 2æœˆ 11 2012 /usr/bin/passwds ä¸ t è¿™ä¸¤ä¸ªæƒé™ä¸ç³»ç»Ÿçš„å¸å·ä»¥åŠç³»ç»Ÿçš„è¿›ç¨‹è¾ƒä¸ºç›¸å…³ã€‚ä»¥åå†ç ”ç©¶ã€‚ ç»„ç»‡æ•°æ®æ–¹å¼ æ¯ç§OSéƒ½æœ‰è‡ªå·±çš„ï¼Œæ¯”å¦‚ NTFS, ext3 â€¦ å­˜å‚¨æ•°æ®çš„æœ€å°å•ä½å°±å«åšæ•°æ®å—ï¼Œè¿™ä¸€è¿™æ ·ç†è§£ï¼ï¼ æ–‡ä»¶å­˜å‚¨æ—¶ï¼Œè‡³å°‘è¦å ç”¨ä¸€ä¸ªæ•°æ®å—ã€‚ ï¼ˆä½  60æ–¤ï¼Œä¹Ÿå¾—åšä¸€ä¸ªæ¤…å­ï¼Œ200æ–¤åšä¸€ä¸ªï¼Œ600æ–¤å¯èƒ½åšä¸¤ä¸ªï¼ï¼‰ åˆ†ä½ åšä»€ä¹ˆï¼Œæ•°æ®å—è¶Šå°å­˜å–é€Ÿåº¦è¶Šå°ï¼Œæ•°æ®å—è¶Šå¤§å­˜å–çš„æ—¶å€™æµªè´¹ç©ºé—´è¶Šå¤§ã€‚ åˆ†ä½ åšä»€ä¹ˆï¼Œè°ƒæ•°æ®å—å¤šå¤§åˆé€‚ã€‚ã€‚ã€‚æœ‰ä¸ªåˆ«æ—¶å€™ï¼ï¼ 3. Linux æ–‡ä»¶æœç´¢å‘½ä»¤(1) å‘½ä»¤æ‰€åœ¨è·¯å¾„ : /usr/bin/find è¯­æ³•:find [æœç´¢è·¯å¾„] [æœå¯»å…³é”®å­—] $ find /etc -name init* åœ¨ç›®å½•/etcä¸­æŸ¥æ‰¾initå¼€å¤´çš„æ–‡ä»¶$ find / -size +204800 åœ¨æ ¹ç›®å½•ä¸‹æŸ¥æ‰¾å¤§äº100MBçš„æ–‡ä»¶ block=512B å¤§äº ï¼š +ï¼Œ å°äº ï¼š - ï¼Œ ç­‰äº ï¼š ä¸å†™ +, -ï¼›$ find / -user sam åœ¨æ ¹ç›®å½•ä¸‹æŸ¥æ‰¾æ‰€æœ‰è€…ä¸ºsamçš„æ–‡ä»¶ (2) æŒ‰ç…§æ—¶é—´æŸ¥æ‰¾ find /etc -mmin -120 ï¼ˆ-ä¹‹å†…ï¼Œ +è¶…è¿‡ ï¼‰ å¤© ctime, atime, mtime ï¼Œ åˆ†é’Ÿ cmin , amin, mmin c-change æ”¹å˜ï¼Œ è¡¨ç¤ºæ–‡ä»¶å±æ€§è¢«ä¿®æ”¹è¿‡ï¼Œæ‰€æœ‰è€…ï¼Œæ‰€å±ç»„ï¼Œæƒé™ a-access è®¿é—® m-modify ä¿®æ”¹ï¼Œ è¡¨ç¤ºæ–‡ä»¶å†…å®¹è¢«ä¿®æ”¹è¿‡ æˆ‘ä»¬åˆšè®²äº† 4 ä¸ªfindçš„é€‰é¡¹ï¼Œå…¶å®ä¸ä¸‹ 40 ä¸ªï¼è¦å­¦ä¼šçœ‹æ–‡æ¡£ï¼ (3) è¿æ¥ç¬¦ -a and é€»è¾‘ä¸ -o or é€»è¾‘æˆ– $ find /etc -ctime -1 åœ¨/etcä¸‹æŸ¥æ‰¾24å°æ—¶å†…è¢«ä¿®æ”¹è¿‡å±æ€§çš„æ–‡ä»¶å’Œç›®å½•$ find /etc -size +163840 -a -size -204800 åœ¨/etcä¸‹æ‰¾å¤§äº80MBå°äº100MBçš„æ–‡ä»¶$ find /etc -name init* -a -type f [ äºŒè¿›åˆ¶æ–‡ä»¶ ]$ find /etc -name init* -a -type l [ è½¯é“¾æ¥æ–‡ä»¶ ] -type æ–‡ä»¶ç±»å‹ f äºŒè¿›åˆ¶æ–‡ä»¶ l è½¯é“¾æ¥æ–‡ä»¶ d ç›®å½• è¿æ¥ç¬¦ find ..... -exec å‘½ä»¤ &#123;&#125; \\; &#123;&#125; find æŸ¥è¯¢çš„ç»“æœ \\ è½¬ä¹‰ç¬¦ ã€ls \\lsã€‘$ find /etc -name inittab -exec ls -l &#123;&#125; \\; åœ¨/etcä¸‹æŸ¥æ‰¾inittabæ–‡ä»¶å¹¶æ˜¾ç¤ºå…¶è¯¦ç»†ä¿¡æ¯$ find /test -name testfile3 -exec rm &#123;&#125; \\;$ find /etc -name inittab -ok ls -l &#123;&#125; \\; èƒ½è¯¢é—®ä¸€ä¸‹ -ok$ find /etc -name inittab -a -type f -exec ls -l &#123;&#125; \\;$ find . -inum 16 -exec rm &#123;&#125; \\; (4) locate åŠŸèƒ½æè¿°:å¯»æ‰¾æ–‡ä»¶æˆ–ç›®å½• èŒƒä¾‹: $ locate file åˆ—å‡ºæ‰€æœ‰è·Ÿfileç›¸å…³çš„æ–‡ä»¶ (5) updatedb æ‰§è¡Œæƒé™:root è¯­æ³•: updatedb åŠŸèƒ½æè¿°: å»ºç«‹æ•´ä¸ªç³»ç»Ÿç›®å½•æ–‡ä»¶çš„æ•°æ®åº“ èŒƒä¾‹: # updateb (6) grep åŠŸèƒ½æè¿° : åœ¨æ–‡ä»¶ä¸­æœå¯»å­—ä¸²åŒ¹é…çš„è¡Œå¹¶è¾“å‡º 4. Linux æ–‡ä»¶ç³»ç»Ÿç®¡ç†hp@ubuntu:/$ df -mæ–‡ä»¶ç³»ç»Ÿ 1M-å— å·²ç”¨ å¯ç”¨ å·²ç”¨% æŒ‚è½½ç‚¹/dev/loop0 14692 4746 9210 35% /udev 2977 1 2977 1% /devtmpfs 1195 1 1194 1% /runnone 5 1 5 1% /run/locknone 2986 1 2985 1% /run/shm/dev/sda8 20490 17188 3303 84% /host/dev/sda7 105036 24898 80139 24% /media/Studtyhp@ubuntu:/$ du -h /etc/services20K /etc/serviceshp@ubuntu:/$ du -sh ~/dlinux76K /home/hp/dlinuxhp@ubuntu:/$ file /etc/services/etc/services: ASCII English text ç‰¹æ®Šæƒé™: ç²˜ç€ä½ t ç²˜ç€ä½çš„å®šä¹‰: å½“æƒé™ä¸º777çš„ç›®å½•è¢«æˆäºˆç²˜ç€ä½,ç”¨æˆ·åªèƒ½åœ¨æ­¤ç›®å½•ä¸‹åˆ é™¤è‡ªå·±æ˜¯æ‰€æœ‰è€…çš„æ–‡ä»¶ã€‚ æŸ¥çœ‹åˆ†åŒºä½¿ç”¨æƒ…å†µ:df æŸ¥çœ‹æ–‡ä»¶ã€ç›®å½•å¤§å°:du æŸ¥çœ‹æ–‡ä»¶è¯¦ç»†æ—¶é—´å‚æ•°:stat æ ¡éªŒæ–‡ä»¶md5å€¼:md5sum æ£€æµ‹ä¿®å¤æ–‡ä»¶ç³»ç»Ÿ:fsckã€e2fsck(å•ç”¨æˆ·æ¨¡å¼å¸è½½æ–‡ä»¶ç³»ç»Ÿåæ‰§è¡Œ) hp@ubuntu:/$ df -h æ–‡ä»¶ç³»ç»Ÿ å®¹é‡ å·²ç”¨ å¯ç”¨ å·²ç”¨% æŒ‚è½½ç‚¹ /dev/loop0 15G 4.7G 9.0G 35% / udev 3.0G 4.0K 3.0G 1% /dev tmpfs 1.2G 1000K 1.2G 1% /run none 5.0M 4.0K 5.0M 1% /run/lock none 3.0G 804K 3.0G 1% /run/shm /dev/sda8 21G 17G 3.3G 84% /host /dev/sda7 103G 25G 79G 24% /media/Studty æ·»åŠ ç¡¬ç›˜åˆ†åŒº åˆ’åˆ†åˆ†åŒº(fdisk) åˆ›å»ºæ–‡ä»¶ç³»ç»Ÿ (mkfs) å°è¯•æŒ‚è½½ (mount) [mount ç‰©ç†è®¾å¤‡å æŒ‚è½½ç‚¹(ç©ºç›®å½•)] å†™å…¥é…ç½®æ–‡ä»¶ (/etc/fstab) 5. Linux æ–‡ä»¶ç³»ç»Ÿç›®å½•ç»“æ„/bin : åŸºç¡€ç³»ç»Ÿæ‰€éœ€è¦çš„æœ€åŸºç¡€çš„å‘½ä»¤å°±æ˜¯æ”¾åœ¨è¿™é‡Œã€‚æ¯”å¦‚ lsã€cpã€mkdirç­‰å‘½ä»¤ï¼› åŠŸèƒ½å’Œ/usr/binç±»ä¼¼ï¼Œè¿™ä¸ªç›®å½•ä¸­çš„æ–‡ä»¶éƒ½æ˜¯å¯æ‰§è¡Œçš„ï¼Œæ™®é€šç”¨æˆ·éƒ½å¯ä»¥ä½¿ç”¨çš„å‘½ä»¤ã€‚/boot : Linuxçš„å†…æ ¸åŠå¼•å¯¼ç³»ç»Ÿç¨‹åºæ‰€éœ€è¦çš„æ–‡ä»¶ã€‚ å¯åŠ¨è£…è½½æ–‡ä»¶å­˜æ”¾ä½ç½®ï¼Œå¦‚kernels,initrd,grubã€‚ä¸€èˆ¬æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„åˆ†åŒºã€‚/dev : ä¸€äº›å¿…è¦çš„è®¾å¤‡,å£°å¡ã€ç£ç›˜ç­‰ã€‚è¿˜æœ‰å¦‚ /dev/null. /dev/console /dev/zero /dev/full ç­‰ã€‚/etc : ç³»ç»Ÿçš„é…ç½®æ–‡ä»¶å­˜æ”¾åœ°. /home : ç”¨æˆ·å·¥ä½œç›®å½•ï¼Œå’Œä¸ªäººé…ç½®æ–‡ä»¶ï¼Œå¦‚ä¸ªäººç¯å¢ƒå˜é‡ç­‰./lib : åº“æ–‡ä»¶å­˜æ”¾åœ°ã€‚binå’Œsbinéœ€è¦çš„åº“æ–‡ä»¶ã€‚ç±»ä¼¼windowsçš„DLLã€‚/media : å¯æ‹†å¸çš„åª’ä»‹æŒ‚è½½ç‚¹ï¼Œå¦‚CD-ROMsã€ç§»åŠ¨ç¡¬ç›˜ã€Uç›˜ï¼Œç³»ç»Ÿé»˜è®¤ä¼šæŒ‚è½½åˆ°è¿™é‡Œæ¥ã€‚/mnt : ä¸´æ—¶æŒ‚è½½æ–‡ä»¶ç³»ç»Ÿã€‚æ¯”å¦‚æœ‰cdrom ç­‰ç›®å½•ã€‚/opt : å¯é€‰çš„åº”ç”¨ç¨‹åºåŒ…ã€‚ ç¬¬ä¸‰æ–¹è½¯ä»¶/proc : æ“ä½œç³»ç»Ÿè¿è¡Œæ—¶ï¼Œè¿›ç¨‹ï¼ˆæ­£åœ¨è¿è¡Œä¸­çš„ç¨‹åºï¼‰ä¿¡æ¯åŠå†…æ ¸ä¿¡æ¯ï¼ˆæ¯”å¦‚cpuã€ç¡¬ç›˜åˆ†åŒºã€å†…å­˜ä¿¡æ¯ç­‰ï¼‰å­˜æ”¾åœ¨è¿™é‡Œã€‚/root : Rootç”¨æˆ·çš„å·¥ä½œç›®å½•/sbin : å’Œbinç±»ä¼¼ï¼Œæ˜¯ä¸€äº›å¯æ‰§è¡Œæ–‡ä»¶ï¼Œä¸è¿‡ä¸æ˜¯æ‰€æœ‰ç”¨æˆ·éƒ½éœ€è¦çš„ï¼Œä¸€èˆ¬æ˜¯ç³»ç»Ÿç®¡ç†æ‰€éœ€è¦ä½¿ç”¨å¾—åˆ°çš„ã€‚/tmp : ç³»ç»Ÿçš„ä¸´æ—¶æ–‡ä»¶ï¼Œä¸€èˆ¬ç³»ç»Ÿé‡å¯ä¸ä¼šè¢«ä¿å­˜ã€‚/usr : åŒ…å«äº†ç³»ç»Ÿç”¨æˆ·å·¥å…·å’Œç¨‹åºã€‚/usr/bin ï¼š éå¿…é¡»çš„æ™®é€šç”¨æˆ·å¯æ‰§è¡Œå‘½ä»¤/usr/include ï¼š æ ‡å‡†å¤´æ–‡ä»¶/usr/lib : /usr/bin/ å’Œ /usr/sbin/çš„åº“æ–‡ä»¶/usr/sbin : éå¿…é¡»çš„å¯æ‰§è¡Œæ–‡ä»¶/usr/src : å†…æ ¸æºç /srv : è¯¥ç›®å½•å­˜æ”¾ä¸€äº›æœåŠ¡å¯åŠ¨ä¹‹åéœ€è¦æå–çš„æ•°æ® 6. VIM ç¼–è¾‘å™¨ åºå· å‘½ä»¤ç±»å‹ å‘½ä»¤è¯¦æƒ… 1. [æ’å…¥å‘½ä»¤] a, A, i, I, o, O 2. [å®šä½å‘½ä»¤] h, j, k, l, $, 0, H, M, L :set nu è®¾ç½®è¡Œå·ï¼Œgg åˆ°ç¬¬ä¸€è¡Œ G åˆ°æœ€åä¸€è¡Œ 3. [åˆ é™¤å‘½ä»¤] x, nx, dd, ndd, dG[å…‰æ ‡å¤„åˆ é™¤åˆ°æ–‡ä»¶å°¾], D, :n1, n2d[åˆ é™¤æŒ‡å®šèŒƒå›´çš„è¡Œ] 4. [å¤åˆ¶å’Œå‰ªåˆ‡å‘½ä»¤] yy, Y, nyy, nY, dd[å‰ªåˆ‡]ï¼Œ ndd[å‰ªåˆ‡nè¡Œ], p, P [ç²˜è´´åœ¨å½“å‰å…‰æ ‡æ‰€åœ¨è¡Œä¸‹æˆ–è¡Œä¸Š] 5. [æ›¿æ¢å’Œå–æ¶ˆå‘½ä»¤] r, R, uï¼Œ r å–ä»£å…‰æ ‡æ‰€åœ¨å¤„å­—ç¬¦ R ä»å…‰æ ‡æ‰€åœ¨å¤„å¼€å§‹æ›¿æ¢å­—ç¬¦ï¼ŒæŒ‰Escç»“æŸ u å–æ¶ˆä¸Šä¸€æ­¥æ“ä½œ 6. [æœç´¢å’Œæ›¿æ¢å‘½ä»¤] /string æŒ‰ n æ˜¯ä¸‹ä¸€ä¸ª ä»å‰å‘åï¼Œ N ä»åå‘å‰ :%s/old/new/g å…¨æ–‡æ›¿æ¢æŒ‡å®šå­—ç¬¦ä¸² :n1,n2s/old/new/c è¯¢é—®æ›¿æ¢ :set ic æœç´¢çš„æ—¶å€™å°±ä¸åŒºåˆ†å¤§å°å†™äº†ï¼ :set noic 7. [ä¿å­˜å’Œé€€å‡ºå‘½ä»¤] [ZZ æœ€å¸¸ç”¨ ] :wq ä¿å­˜é€€å‡º 8. [vi ä¸­å¦å¤–æ¯”è¾ƒæœ‰è¶£çš„å‘½ä»¤] :r !å‘½ä»¤ å¯¼å…¥å‘½ä»¤æ‰§è¡Œç»“æœåˆ°å½“å‰viä¸­, åœ¨viä¸­æ‰§è¡Œå‘½ä»¤ :!å‘½ä»¤ 9. åˆ†å± sp, vsp (æ°´å¹³) ctrl+w *2 10. å®šä¹‰å¿«æ·é”® :map å¿«æ·é”® è§¦å‘å‘½ä»¤ èŒƒä¾‹: : map ^P I# ^P = ctrl+v+p : map ^B 0x 11. vi çš„é…ç½®æ–‡ä»¶ ~/.vimrc 7. å¼•å¯¼æµç¨‹ Linuxå¼•å¯¼æµç¨‹ Linuxè¿è¡Œçº§åˆ« Linuxå¯åŠ¨æœåŠ¡ç®¡ç† GRUBé…ç½®ä¸åº”ç”¨ ç³»ç»Ÿå¼•å¯¼æµç¨‹: å›ºä»¶ firmware(CMOS/BIOS) â†’ POST åŠ ç”µè‡ªæ£€ â†“ [CMOSæ˜¯å›ºåŒ–åœ¨ä¸»æ¿ä¸Šçš„é‚£æ®µç¨‹åºï¼Œ BIOS æ“ä½œCMOSçš„é‚£ä¸ªç•Œé¢]è‡ªä¸¾ç¨‹åº BootLoader(GRUB) â†’ è½½å…¥å†…æ ¸ linux-grub /etc/grub.conf / win-ntldr [ntå†…æ ¸ä»£å·,loader] bootini [é‡Œé¢è®°è½½äº†å¯åŠ¨ä¿¡æ¯] â†“ è½½å…¥å†…æ ¸ï¼ŒOSçš„æ ¸å¿ƒ-å†…æ ¸[å­˜å‚¨CPUæ–‡ä»¶è¿›ç¨‹...ç®¡ç†]-å¿ƒè„å¤§è„‘ æŒ‡å®šlinuxå†…æ ¸å­˜æ”¾çš„ä½ç½®ã€‚ls /bootè½½å…¥å†…æ ¸ Kernel â†’ é©±åŠ¨ç¡¬ä»¶ â†“ [å†…æ ¸åªåšä¸¤ä»¶äº‹æƒ…ï¼Œ1é©±åŠ¨ç¡¬ä»¶2å¯åŠ¨init. å†…æ ¸ä¿å­˜æœ€å¤šçš„æ˜¯é©±åŠ¨ç¨‹åº]å¯åŠ¨è¿›ç¨‹ init â†“ [initæ˜¯ç¬¬ä¸€ä¸ªå¯ä»¥å­˜åœ¨å’Œå¯åŠ¨çš„è¿›ç¨‹]è¯»å–æ‰§è¡Œé…ç½®æ–‡ä»¶/etc/inittab å¼•å¯¼æµç¨‹è¯´æ˜: firmwareè‡ªæ£€ä¹‹åï¼Œå‘ç°ç¡¬ä»¶ä»¬éƒ½æ²¡æœ‰ä»€ä¹ˆé—®é¢˜ä¹‹åï¼Œç„¶å firmware è¯»å– MBR[ä¸»å¼•å¯¼è®°å½•]ï¼Œä½äº 0æŸ±é¢0ç£å¤´1æ‰‡åŒºï¼Œ è·³åˆ° Master boot record å»è¯»å–æ•°æ®ã€‚è½½å…¥MBR ä¸­ä¸€ä¸ªå¾ˆé‡è¦çš„æ•°æ®å«åš Bootloader, ä¹Ÿç§°åšè‡ªä¸¾ç¨‹åºæˆ–è‡ªå¯åŠ¨ç¨‹åºã€‚ ä¸‹é¢æ˜¯ Partition table ç£ç›˜åˆ†åŒºè¡¨ï¼Œä¸‹é¢æ˜¯ Magic Number ç»“æŸæ ‡å¿—å­— init å¯åŠ¨åè¯»å– inittabæ–‡ä»¶, æ‰§è¡Œç¼ºçœè¿è¡Œçº§åˆ«, ä»è€Œç»§ç»­å¼•å¯¼è¿‡ç¨‹ã€‚åœ¨UNIXç³»ç»Ÿä¸­, initæ—¶ç¬¬ä¸€ä¸ªå¯ä»¥å­˜åœ¨çš„è¿›ç¨‹, å®ƒçš„PIDæ’ä¸º1, ä½†å®ƒä¹Ÿå¿…é¡»å‘ä¸€ä¸ªæ›´é«˜çº§çš„åŠŸèƒ½è´Ÿè´£: PIDä¸º0çš„å†…æ ¸è°ƒåº¦å™¨(Kernelscheduler),ä»è€Œè·å¾—CPUæ—¶é—´ã€‚ æ‰©å±• ï¼š åœ¨Linuxé‡Œé¢ä¸å…è®¸å­˜åœ¨ å­¤å„¿è¿›ç¨‹ï¼Œåœ¨linuxç³»ç»Ÿä¸­initæ˜¯æ‰€æœ‰è¿›ç¨‹çš„çˆ¶è¿›ç¨‹ã€‚åƒµå°¸è¿›ç¨‹[Z] å„¿å­æ­»äº†ï¼Œçˆ¶äº²ä¸çŸ¥é“ï¼Œè¿™ä¸ªå­è¿›ç¨‹å°±ä¼šå˜æˆ Zã€‚ Linuxè¿è¡Œçº§åˆ« 0 ~ 6 è¯´æ˜ ï¼š 0 å…³æœº 1 å­—ç¬¦å•ç”¨æˆ· 2ï¼Œ3 å­—ç¬¦ç•Œé¢çš„å¤šç”¨æˆ·æ¨¡å¼[å¹¿æ³›ä½¿ç”¨çš„æœåŠ¡å™¨çš„æ¨¡å¼]4 è‡ªå®šä¹‰ 5 å›¾å½¢åŒ–çš„å¤šç”¨æˆ· 6 reboot 8. å­¦ä¹ bashLinux bashä¸œè¥¿éå¸¸å¤šï¼ŒåŒ…æ‹¬å˜é‡çš„è®¾ç½®ä¸ä½¿ç”¨ï¼Œbashæ“ä½œç¯å¢ƒï¼Œæ•°æ®æµé‡å®šå‘åŠŸèƒ½ï¼Œè¿˜æœ‰å¥½ç”¨çš„ç®¡é“å‘½ä»¤ã€‚ 1, ç¡¬ä»¶ 2ï¼Œå†…æ ¸ç¨‹åº 3ï¼Œåº”ç”¨ç¨‹åº man, chmod, chown, vi, fdisk, mkfsç­‰å‘½ä»¤ï¼Œè¿™äº›å‘½ä»¤éƒ½æ˜¯ç‹¬ç«‹çš„åº”ç”¨ç¨‹åºã€‚ bashçš„ä¸»è¦ä¼˜ç‚¹ : (1) å‘½ä»¤è®°å¿†åŠŸèƒ½ (history) .bash_history (æ³¨é”€ç³»ç»Ÿåï¼Œå‘½ä»¤è®°å¿†ä¼šè®°å½•åˆ°.bash_history) (2) å‘½ä»¤ä¸æ–‡ä»¶è¡¥å…¨åŠŸèƒ½ (tab) (3) å‘½ä»¤åˆ«åè®¾ç½®åŠŸèƒ½ (alias) alias lm=â€™ls -alâ€™ (4) ä½œä¸šæ§åˆ¶ï¼Œå‰å°ï¼Œåå°æ§åˆ¶ (job control, foreground, background) (5) ç¨‹åºè„šæœ¬ (shell script) (6) é€šé…ç¬¦ (Wildcard) shell å˜é‡: echo å˜é‡æ˜¾ç¤º å¦‚ ï¼š echo ${PATH}çˆ¶å­è¿›ç¨‹ export è®¾ç½®æˆç¯å¢ƒå˜é‡..unset å–æ¶ˆå˜é‡çš„è®¾ç½®å€¼ã€‚ uname -r æ˜¾ç¤ºå†…æ ¸ç‰ˆæœ¬â€œversion=$(uname -r)â€ æ¥æ›¿ä»£ â€œversion=uname -râ€œ æ¯”è¾ƒå¥½ã€‚ ç¯å¢ƒå˜é‡çš„åŠŸèƒ½: env ä¸ export æŸ¥çœ‹ç¯å¢ƒå˜é‡HOMEï¼Œ SHELLï¼Œ HISTSIZEï¼Œ PATHï¼Œ LANG(è¯­ç³»æ•°æ®)ï¼Œ RANDOM(éšæœºæ•°å‘ç”Ÿå™¨)export è‡ªå®šä¹‰å˜é‡è½¬æˆç¯å¢ƒå˜é‡ export nameå­è¿›ç¨‹ä¼šå®šä¹‰çˆ¶è¿›ç¨‹çš„ç¯å¢ƒå˜é‡ï¼Œä¸ä¼šç»§æ‰¿çˆ¶è¿›ç¨‹çš„è‡ªå®šä¹‰å˜é‡ bash å¯ä»¥é™åˆ¶ç”¨æˆ·çš„æŸäº›ç³»ç»Ÿèµ„æºï¼Œå¯æ‰“å¼€çš„æ–‡ä»¶æ•°é‡ï¼Œå¯ä½¿ç”¨çš„CPUæ—¶é—´ï¼Œå¯ä½¿ç”¨çš„å†…å­˜æ€»é‡ç­‰ æ–‡ä»¶ç³»ç»ŸåŠç¨‹åºçš„é™åˆ¶å…³ç³» : ulimitulimit -H -S -a -c -f -d -l -t -u -s ç­‰ã€‚ æ•°æ®æµé‡å®šå‘ 1, stdin ä»£ç ä¸º 0 ï¼Œä½¿ç”¨ &lt; æˆ– &lt;&lt;2, stdout ä»£ç ä¸º 1 ï¼Œä½¿ç”¨ &gt; æˆ– &gt;&gt;3, stderr ä»£ç ä¸º 2 ï¼Œä½¿ç”¨ 2&gt; æˆ– 2&gt;&gt; /dev/null åƒåœ¾æ¡¶é»‘æ´è®¾å¤‡ &amp;&amp; ä¸ || cut å‘½ä»¤ ä¾‹å­ ï¼š echo $PATH | cut -d â€˜:â€™ -f 3,5 export | cut -c 12- cut çš„ä¸»è¦ç”¨é€”åœ¨äºå°†åŒä¸€è¡Œé‡Œé¢çš„æ•°æ®è¿›è¡Œåˆ†è§£ï¼Œç”¨äºåˆ†æä¸€äº›æ—¥å¿—ã€‚ grep -a -c -i -n -v â€˜targeâ€™ filename æ’åºå‘½ä»¤ï¼š sort, wc, uniq last | cut -d â€˜ â€˜ -f 1 | sort | uniq -c hp@ubuntu:~$ last | tee last.list | cut -d â€œ â€œ -f1 tee å‘½ä»¤å¯ä»¥è®© standard output è½¬å­˜åˆ°ä¸€ä¸ªæ–‡ä»¶å†…ï¼Œå¹¶å°†åŒæ ·çš„æ•°æ®ç»§ç»­é€åˆ°å±å¹•ä¸­å»å¤„ç† å­—ç¬¦è½¬æ¢å‘½ä»¤ï¼š tr, col, join, paste, expand (1) tr : last | tr â€˜[a-z]â€™ â€˜[A-Z]â€™ ï¼š cat /etc/passwd | tr -d â€˜:â€™ (2) col -x å°†tabé”®è½¬æ¢æˆå¯¹ç­‰çš„ç©ºæ ¼ -b åœ¨æ–‡å­—å†…æœ‰ / æ—¶ï¼Œä»…ä¿ç•™ / åé¢æ¥çš„é‚£ä¸ªå­—ç¬¦ ï¼š cat /etc/man.config | col -x | cat -A | more (3) join [-ti12] file1 file2 (4) paste [-d] file1 file2 ï¼š -d : åé¢å¯ä»¥æ¥åˆ†éš”å­—ç¬¦ï¼Œé»˜è®¤æ˜¯ä»¥ [tab] æ¥åˆ†éš”çš„ã€‚ ï¼š - : å¦‚æœfileéƒ¨åˆ†å†™æˆ -, ä»£è¡¨æ¥è‡ª standard input çš„æ•°æ®çš„æ„æ€ã€‚ (5) expand å°±æ˜¯å°† [tab] æŒ‰é”®è½¬æˆç©ºæ ¼é”®ï¼Œå¯ä»¥è¿™æ ·åš ï¼š expand [-t] file ï¼š expand -t 6 - | cat -A ï¼š unexpand åˆ‡å‰²å‘½ä»¤ï¼š split å‚æ•° -b : åé¢å¯æ¥æ¬²åˆ‡å‰²æˆçš„æ–‡ä»¶å¤§å°ï¼Œå¯åŠ å•ä½ b, k, m ç­‰ï¼› $ split -b 300k /etc/termcap termcap$ ll -k termcap*$ cat termcap* &gt;&gt; termcapback$ ls -al / | split -l 10 - lsroot$ wc -l lsroot* å‚æ•°ä»£æ¢ï¼š xargs å¯ä»¥è¯»å…¥stdinçš„æ•°æ®ï¼Œå¹¶ä¸”ä»¥ç©ºæ ¼ç¬¦æˆ–æ–­è¡Œå­—ç¬¦è¿›è¡Œåˆ†è¾¨ï¼Œå°†stdinçš„æ•°æ®åˆ†éš”æˆargs hp@ubuntu:~$ cut -d &#x27;:&#x27; -f1 /etc/passwd | head -n 3 | xargs -p/bin/echo root daemon bin ?...yroot daemon binhp@ubuntu:~$ echo &quot;3 4:asd&quot; | xargs 3 4:asd å…³äºå‡å· - çš„ç”¨é€” $ tar -cvf - /home | tar -xvf - æŸäº›å‘½ä»¤éœ€è¦ç”¨åˆ°æ–‡ä»¶åæ¥å¤„ç†ï¼Œè¯¥stdin, stdoutå¯ä»¥åˆ©ç”¨å‡å·â€œ-â€æ¥æ›¿ä»£ã€‚ 9. è¿›ç¨‹ç®¡ç†è¿›ç¨‹çš„æ¦‚å¿µ è¿›ç¨‹ç®¡ç†å‘½ä»¤ è®¡åˆ’ä»»åŠ¡ 9.1 è¿›ç¨‹å’Œç¨‹åºçš„åŒºåˆ« ç¨‹åºæ˜¯é™æ€æ¦‚å¿µ, å®ƒä½œä¸ºä¸€ç§è½¯ä»¶èµ„æºé•¿æœŸä¿å­˜; è¿›ç¨‹æ˜¯ç¨‹åºçš„æ‰§è¡Œè¿‡ç¨‹, å®ƒæ˜¯åŠ¨æ€æ¦‚å¿µ, æœ‰ä¸€å®šçš„ç”Ÿå‘½æœŸ, æ˜¯åŠ¨æ€äº§ç”Ÿå’Œæ¶ˆäº¡çš„; å­è¿›ç¨‹æ˜¯ç”±ä¸€ä¸ªè¿›ç¨‹æ‰€äº§ç”Ÿçš„è¿›ç¨‹,äº§ç”Ÿè¿™ä¸ªå­è¿›ç¨‹çš„è¿›ç¨‹ç§°ä¸ºçˆ¶è¿›ç¨‹; åœ¨Linuxç³»ç»Ÿä¸­,ä½¿ç”¨ç³»ç»Ÿè°ƒç”¨forkåˆ›å»ºè¿›ç¨‹ã€‚forkå¤åˆ¶çš„å†…å®¹åŒ…æ‹¬çˆ¶è¿›ç¨‹çš„æ•°æ®å’Œå †æ ˆæ®µä»¥åŠçˆ¶è¿›ç¨‹çš„è¿›ç¨‹ç¯å¢ƒ; çˆ¶è¿›ç¨‹ç»ˆæ­¢å­è¿›ç¨‹è‡ªç„¶ç»ˆæ­¢. 9.2 å‰å°è¿›ç¨‹å’Œåå°è¿›ç¨‹å‰å°è¿›ç¨‹: åœ¨Shellæç¤ºå¤„æ‰“å…¥å‘½ä»¤å, åˆ›å»ºä¸€ä¸ªå­è¿›ç¨‹, è¿è¡Œå‘½ä»¤, Shellç­‰å¾…å‘½ä»¤é€€å‡º, ç„¶åè¿”å›åˆ°å¯¹ç”¨æˆ·ç»™å‡ºæç¤ºç¬¦ã€‚ è¿™æ¡å‘½ä»¤ä¸Shellå¼‚æ­¥è¿è¡Œ, å³åœ¨å‰å°è¿è¡Œ, ç”¨æˆ·åœ¨å®ƒå®Œæˆä¹‹å‰ä¸èƒ½æ‰§è¡Œå¦ä¸€ä¸ªå‘½ä»¤ã€‚ åå°è¿›ç¨‹: åœ¨Shellæç¤ºå¤„æ‰“å…¥å‘½ä»¤, è‹¥åéšä¸€ä¸ª&amp;, Shellåˆ›å»ºçš„å­è¿›ç¨‹è¿è¡Œæ­¤å‘½ä»¤, ä½†ä¸ç­‰å¾…å‘½ä»¤é€€å‡º, è€Œç›´æ¥è¿”å›åˆ°å¯¹ç”¨æˆ·ç»™å‡ºæç¤ºã€‚ è¿™æ¡å‘½ä»¤ä¸ShellåŒæ­¥è¿è¡Œ, å³åœ¨åå°è¿è¡Œã€‚ åå°è¿›ç¨‹å¿…é¡»æ˜¯éäº¤äº’å¼çš„ã€‚ 9.3 è¿›ç¨‹çŠ¶æ€ è¿›ç¨‹çŠ¶æ€ æè¿° å°±ç»ª è¿›ç¨‹å·²ç»åˆ†é…åˆ°èµ„æº,ä½†å› ä¸ºå…¶å®ƒè¿›ç¨‹æ­£å ç”¨CPUã€‚ ç­‰å¾… å› ç­‰å¾…æŸç§äº‹ä»¶è€Œæš‚æ—¶ä¸èƒ½è¿è¡Œçš„çŠ¶æ€ã€‚ è¿è¡Œ è¿›ç¨‹åˆ†é…åˆ°CPU,æ­£åœ¨å¤„ç†å™¨ä¸Šè¿è¡Œã€‚ è¿›ç¨‹çŠ¶æ€ç»†åŒ– ç”¨æˆ·æ€è¿è¡Œ : åœ¨CPUä¸Šæ‰§è¡Œç”¨æˆ·ä»£ç æ ¸å¿ƒæ€è¿è¡Œ : åœ¨CPUä¸Šæ‰§è¡Œæ ¸å¿ƒä»£ç åœ¨å†…å­˜å°±ç»ª : å…·å¤‡è¿è¡Œæ¡ä»¶,åªç­‰è°ƒåº¦ç¨‹åºä¸ºå®ƒåˆ†é…CPUåœ¨å†…å­˜ç¡çœ  : å› ç­‰å¾…æŸä¸€äº‹ä»¶çš„å‘ç”Ÿ,è€Œåœ¨å†…å­˜ä¸­æ’é˜Ÿç­‰å¾…åœ¨å¤–å­˜å°±ç»ª : å°±ç»ªè¿›ç¨‹è¢«äº¤æ¢åˆ°å¤–å­˜ä¸Šç»§ç»­å¤„äºå°±ç»ªçŠ¶æ€åœ¨å¤–å­˜ç¡çœ  : ç¡çœ è¿›ç¨‹è¢«äº¤æ¢åˆ°å¤–å­˜ä¸Šç»§ç»­ç­‰å¾…åœ¨å†…å­˜æš‚åœ : å› è°ƒç”¨stopç¨‹åºè€Œè¿›å…¥è·Ÿè¸ªæš‚åœçŠ¶æ€,ç­‰å¾…å…¶çˆ¶è¿›ç¨‹å‘é€å‘½ä»¤ã€‚åœ¨å¤–å­˜æš‚åœ : å¤„äºè·Ÿè¸ªæš‚åœæ€çš„è¿›ç¨‹è¢«äº¤æ¢åˆ°å¤–å­˜ä¸Š åˆ›å»ºæ€ æ–°è¿›ç¨‹æ­£åœ¨è¢«åˆ›å»ºã€ä½†å°šæœªå®Œæ¯•çš„ä¸­é—´çŠ¶æ€ ç»ˆæ­¢æ€ è¿›ç¨‹ç»ˆæ­¢è‡ªå·± æŸ¥çœ‹ç”¨æˆ·ä¿¡æ¯ w (å‘½ä»¤) hp@ubuntu:~$ w 22:02:45 up 22 min, 2 users, load average: 0.27, 0.27, 0.28USER TTY FROM LOGIN@ IDLE JCPU PCPU WHAThp tty7 21:40 22:33 1:16 0.34s gnome-session -hp pts/0 :0 22:02 0.00s 0.37s 0.01s w é€‰é¡¹ æè¿° JCPU ä»¥ç»ˆç«¯ä»£å·æ¥åŒºåˆ†,è¯¥ç»ˆç«¯æ‰€æœ‰ç›¸å…³çš„è¿›ç¨‹æ‰§è¡Œæ—¶,æ‰€æ¶ˆè€—çš„CPUæ—¶é—´ä¼šæ˜¾ç¤ºåœ¨è¿™é‡Œ PCPU CPUæ‰§è¡Œç¨‹åºè€—è´¹çš„æ—¶é—´ WHAT ç”¨æˆ·æ­£åœ¨æ‰§è¡Œçš„æ“ä½œæŸ¥çœ‹ä¸ªåˆ«ç”¨æˆ·ä¿¡æ¯:w ç”¨æˆ·å load average åˆ†åˆ«æ˜¾ç¤ºç³»ç»Ÿåœ¨è¿‡å»1ã€5ã€15åˆ†é’Ÿå†…çš„å¹³å‡è´Ÿè½½ç¨‹åº¦ã€‚ FROM æ˜¾ç¤ºç”¨æˆ·ä»ä½•å¤„ç™»å½•ç³»ç»Ÿ,â€œ:0â€çš„æ˜¾ç¤ºä»£è¡¨è¯¥ç”¨æˆ·æ—¶ä»X Windowä¸‹,æ‰“å¼€æ–‡æœ¬æ¨¡å¼çª—å£ç™»å½•çš„ IDLE ç”¨æˆ·é—²ç½®çš„æ—¶é—´ã€‚è¿™æ˜¯ä¸€ä¸ªè®¡æ—¶å™¨,ä¸€æ—¦ç”¨æˆ·æ‰§è¡Œä»»ä½•æ“ä½œ,è¯¥è®¡æ—¶å™¨ä¾¿ä¼šè¢«é‡ç½® æŸ¥çœ‹ç³»ç»Ÿä¸­çš„è¿›ç¨‹ ps å¸¸ç”¨é€‰é¡¹ a : æ˜¾ç¤ºæ‰€æœ‰ç”¨æˆ·çš„è¿›ç¨‹u : æ˜¾ç¤ºç”¨æˆ·åå’Œå¯åŠ¨æ—¶é—´x : æ˜¾ç¤ºæ²¡æœ‰æ§åˆ¶ç»ˆç«¯çš„è¿›ç¨‹e : æ˜¾ç¤ºæ‰€æœ‰è¿›ç¨‹,åŒ…æ‹¬æ²¡æœ‰æ§åˆ¶ç»ˆç«¯çš„è¿›ç¨‹l : é•¿æ ¼å¼æ˜¾ç¤ºw : å®½è¡Œæ˜¾ç¤º,å¯ä»¥ä½¿ç”¨å¤šä¸ªwè¿›è¡ŒåŠ å®½æ˜¾ç¤º ps å¸¸ç”¨è¾“å‡ºä¿¡æ¯çš„å«ä¹‰ TIME: è¿›ç¨‹è‡ªä»å¯åŠ¨ä»¥æ¥å¯ç”¨CPUçš„æ€»æ—¶é—´COMMAND/CMD: è¿›ç¨‹çš„å‘½ä»¤åUSER:ç”¨æˆ·å%CPU:å ç”¨CPUæ—¶é—´å’Œæ€»æ—¶é—´çš„ç™¾åˆ†æ¯”%MEM:å ç”¨å†…å­˜ä¸ç³»ç»Ÿå†…å­˜æ€»é‡çš„ç™¾åˆ†æ¯” ps åº”ç”¨å®ä¾‹ ps æŸ¥çœ‹éš¶å±äºè‡ªå·±çš„è¿›ç¨‹ps -u or -l æŸ¥çœ‹éš¶å±äºè‡ªå·±è¿›ç¨‹è¯¦ç»†ä¿¡æ¯ps -le or -aux æŸ¥çœ‹æ‰€æœ‰ç”¨æˆ·æ‰§è¡Œçš„è¿›ç¨‹çš„è¯¦ç»†ä¿¡æ¯ps -aux â€”sort pid å¯æŒ‰è¿›ç¨‹æ‰§è¡Œçš„æ—¶é—´ã€ PIDã€UIDç­‰å¯¹è¿›ç¨‹è¿›è¡Œæ’åº # ps -aux | grep sam# ps -uU sam æŸ¥çœ‹ç³»ç»Ÿä¸­æŒ‡å®šç”¨æˆ·æ‰§è¡Œçš„è¿›ç¨‹# ps -le | grep init æŸ¥çœ‹æŒ‡å®šè¿›ç¨‹ä¿¡æ¯# pstree 9.4 kill â€“ æ€æ­»è¿›ç¨‹ ä¸ºä»€ä¹ˆè¦æ€æ­»è¿›ç¨‹ è¯¥è¿›ç¨‹å ç”¨äº†è¿‡å¤šçš„CPUæ—¶é—´ è¯¥è¿›ç¨‹ç¼©ä½äº†ä¸€ä¸ªç»ˆç«¯,ä½¿å…¶ä»–å‰å°è¿›ç¨‹æ— æ³•è¿è¡Œ è¿è¡Œæ—¶é—´è¿‡é•¿,ä½†æ²¡æœ‰é¢„æœŸæ•ˆæœ äº§ç”Ÿäº†è¿‡å¤šåˆ°å±å¹•æˆ–ç£ç›˜æ–‡ä»¶çš„è¾“å‡º æ— æ³•æ­£å¸¸é€€å‡º, å…³é—­è¿›ç¨‹:kill è¿›ç¨‹å· 1). kill -9 è¿›ç¨‹å·(å¼ºè¡Œå…³é—­) kill -s 9 è¿›ç¨‹å· [å‰ç®€åŒ–]2). kill -1 è¿›ç¨‹å·(é‡å¯è¿›ç¨‹)3). å…³é—­å›¾å½¢ç¨‹åº: xkill4). ç»“æŸæ‰€æœ‰è¿›ç¨‹: killall5). æŸ¥æ‰¾æœåŠ¡è¿›ç¨‹å·: pgrep æœåŠ¡åç§°6). å…³é—­è¿›ç¨‹: pkill è¿›ç¨‹åç§° å¯åŠ¨çš„ç¨‹åº stop ä¹Ÿå¯ä»¥å…³é—­ , é‡å¯ /etc/rc.d/init.d/httpd restart # cat/proc/cpuinfo# pgrep httpd æ£€æµ‹ä½†å®ƒæ‰€æœ‰è¿›ç¨‹çš„ pid# pkill httpd ä¹Ÿå¯ä»¥å…³é—­ï¼Œå¾ˆæ–¹ä¾¿ 9.5 è¿›ç¨‹ä¼˜å…ˆçº§ï¼ŒæŒ‚èµ·ä¸æ¢å¤nice æŒ‡å®šç¨‹åºçš„è¿è¡Œä¼˜å…ˆçº§ æ ¼å¼:nice -n command ä¾‹å¦‚:nice -5 myprogram renice æ”¹å˜ä¸€ä¸ªæ­£åœ¨è¿è¡Œçš„è¿›ç¨‹çš„ä¼˜å…ˆçº§ æ ¼å¼:renice n pid ä¾‹å¦‚:renice -5 777 ä¼˜å…ˆçº§å–å€¼èŒƒå›´ä¸º(-20,19) nohup ä½¿è¿›ç¨‹åœ¨ç”¨æˆ·é€€å‡ºç™»é™†åä»æ—§ç»§ç»­æ‰§è¡Œ,nohupå‘½ä»¤å°†æ‰§è¡Œåçš„æ•°æ®ä¿¡æ¯å’Œé”™è¯¯ä¿¡æ¯é»˜è®¤å‚¨å­˜åˆ°æ–‡ä»¶ nohup.out ä¸­æ ¼å¼: nohup program &amp; è¿›ç¨‹çš„æŒ‚èµ·å’Œæ¢å¤ è¿›ç¨‹çš„ä¸­æ­¢(æŒ‚èµ·)å’Œç»ˆæ­¢ æŒ‚èµ·(Ctrl+Z)[ç±»ä¼¼å·®ä¸å¤šæš‚åœ] ç»ˆæ­¢(Ctrl+C) è¿›ç¨‹çš„æ¢å¤ æ¢å¤åˆ°å‰å°ç»§ç»­è¿è¡Œ(fg) å¤åˆ°åå°ç»§ç»­è¿è¡Œ(bg) æŸ¥çœ‹è¢«æŒ‚èµ· /åå°çš„è¿›ç¨‹(jobs) 9.6 top ä½œç”¨è¿›ç¨‹çŠ¶æ€æ˜¾ç¤ºå’Œè¿›ç¨‹æ§åˆ¶,æ¯5ç§’é’Ÿè‡ªåŠ¨åˆ·æ–°ä¸€æ¬¡(åŠ¨æ€æ˜¾ç¤º) å¸¸ç”¨é€‰é¡¹: d : æŒ‡å®šåˆ·æ–°çš„æ—¶é—´é—´éš” c : æ˜¾ç¤ºæ•´ä¸ªå‘½ä»¤è¡Œè€Œä¸ä»…ä»…æ˜¾ç¤ºå‘½ä»¤å topå¸¸ç”¨å‘½ä»¤: u : æŸ¥çœ‹æŒ‡å®šç”¨æˆ·çš„è¿›ç¨‹ k : ç»ˆæ­¢æ‰§è¡Œä¸­çš„è¿›ç¨‹ h or ?:è·å¾—å¸®åŠ© r : é‡æ–°è®¾ç½®è¿›ç¨‹ä¼˜å…ˆçº§ s : æ”¹å˜åˆ·æ–°çš„æ—¶é—´é—´éš” W : å°†å½“å‰è®¾ç½®å†™å…¥~/.toprcæ–‡ä»¶ä¸­ 9.7 è®¡åˆ’ä»»åŠ¡ at å®‰æ’ä½œä¸šåœ¨æŸä¸€æ—¶åˆ»æ‰§è¡Œä¸€æ¬¡ batch å®‰æ’ä½œä¸šåœ¨ç³»ç»Ÿè´Ÿè½½ä¸é‡æ—¶æ‰§è¡Œä¸€æ¬¡ cron å®‰æ’å‘¨æœŸæ€§è¿è¡Œçš„ä½œä¸š atå‘½ä»¤çš„åŠŸèƒ½å’Œæ ¼å¼ åŠŸèƒ½: å®‰æ’ä¸€ä¸ªæˆ–å¤šä¸ªå‘½ä»¤åœ¨æŒ‡å®šçš„æ—¶é—´è¿è¡Œä¸€æ¬¡ at çš„å‘½ä»¤æ ¼å¼åŠå‚æ•° at [-f æ–‡ä»¶å] æ—¶é—´ / at -d or atrm åˆ é™¤é˜Ÿåˆ—ä¸­çš„ä»»åŠ¡ / at -l or atq æŸ¥çœ‹é˜Ÿåˆ—ä¸­çš„ä»»åŠ¡ è¿›ç¨‹å¤„ç†æ–¹å¼ standalone ç‹¬ç«‹è¿è¡Œ xinetd è¿›ç¨‹æ‰˜ç®¡ atdã€crond è®¡åˆ’ä»»åŠ¡ Linux ä¹¦æ¶ å…¥é—¨ç±» ï¼šã€Šé¸Ÿå“¥çš„Linuxç§æˆ¿èœã€‹ ç¼–ç¨‹ç±» ï¼šã€ŠAdvanced Linux Programmingã€‹-&gt; ã€ŠAdvanced Programming in the UNIX Environmentã€‹ å†…æ ¸ç±» ï¼šã€ŠLinux Kernel Developmentã€‹ å·¥å…·ç±» ï¼šã€ŠHandbook of Open Source Toolsã€‹","categories":[{"name":"devops","slug":"devops","permalink":"http://iequa.com/categories/devops/"}],"tags":[{"name":"linuxbird","slug":"linuxbird","permalink":"http://iequa.com/tags/linuxbird/"}]},{"title":"Java SE Learning Notes for Exception","slug":"java/java-se-2.4-notes-exception","date":"2013-07-25T06:54:16.000Z","updated":"2019-10-20T04:30:35.029Z","comments":true,"path":"2013/07/25/java/java-se-2.4-notes-exception/","link":"","permalink":"http://iequa.com/2013/07/25/java/java-se-2.4-notes-exception/","excerpt":"Java SE å¼‚å¸¸å¤„ç†éƒ¨åˆ†çš„æ¦‚è¦ç¬”è®°: æ‰‹ä¸­æ— å‰‘, å¿ƒä¸­æœ‰å‰‘.","text":"Java SE å¼‚å¸¸å¤„ç†éƒ¨åˆ†çš„æ¦‚è¦ç¬”è®°: æ‰‹ä¸­æ— å‰‘, å¿ƒä¸­æœ‰å‰‘. ç¬¬å››ç«  å¼‚å¸¸å¤„ç† Java å¼‚å¸¸æ˜¯ Java æä¾›çš„ç”¨äºå¤„ç†ç¨‹åºä¸­é”™è¯¯çš„ä¸€ç§æœºåˆ¶ã€‚java.langâ€¦.Exceptionså†™ç¨‹åºæœ‰é—®é¢˜è¦æœ‰å‹å¥½ç•Œé¢åŒ»ç”Ÿå¼€å•å­ { 1, é¼»è…”å†…æ„Ÿè§‰å¼‚å¸¸ 2, ä½“æ¸©æŒç»­å‡é«˜ 3, åˆ†æ³Œä¹³ç™½è‰²æ¶²ä½“ ç›´æ¥è¯´æ„Ÿå†’ä¸å°±å¾—äº†ä¹ˆï¼Ÿ}e.printStackTrace(); éå¸¸å¥½ï¼ç»™ç¨‹åºå‘˜è¯»ã€‚å †æ ˆä¿¡æ¯éƒ½æ‰“å°å‡ºæ¥ï¼ java.lang.Throwable { å¼€è½¦åœ¨ä¸Šå±±èµ°ï¼Œ 1, Error å±±çˆ†å‘ JVM å‡ºé—®é¢˜ã€‚ 2, Exception &#123; ä½ å¯ä»¥å¤„ç†çš„ -- åˆ¹è½¦åå•¦ï¼ä¿®å¥½å†èµ°ã€‚ã€‚ã€‚ 1, ... 2, RuntimeException (ç»å¸¸å‡ºï¼Œä¸ç”¨é€®) å‹è·¯é¢ä¸Šçš„å°çŸ³å­ }ä¸€ä¸ª try å¯ä»¥è·Ÿå¤šä¸ªcatchæ‰€ä»¥ { ä¸€ä¸ªèŒ¶å£¶å¯ä»¥è·Ÿå¤šä¸ªèŒ¶ç¢—ï¼Œä¸€ä¸ªç”·äººå¯ä»¥ä¸‰å¦»å››å¦¾ã€‚}try { // å¯èƒ½æŠ›å‡ºå¼‚å¸¸çš„è¯­å¥ è¯­å¥ä¸€ï¼› è¯­å¥äºŒï¼›} catch(someEx e) { è¯­å¥ï¼› } catch() { è¯­å¥ } finally { }ä¸€ ï¼š æ‰“å¼€äºŒ ï¼š å…³é—­finally : ä¸€èˆ¬è¿›è¡Œèµ„æºçš„æ¸…é™¤å·¥ä½œã€‚ã€‚ã€‚ï¼ æˆ‘å¤„ç†ä¸äº†çš„äº‹æƒ… ï¼š æˆ‘äº¤ç»™ä¸Šä¸€çº§éƒ¨é—¨å»å¤„ç†ï¼å½“æ—¶ catch åˆ° Ex çš„æ—¶å€™ï¼Œä½ è‡³å°‘è¦åšå‡ºä¸€ç§å¤„ç†ã€‚è¦ä¸é‚£æ˜¯å±é™©çš„ç¼–ç¨‹ä¹ æƒ¯ï¼main() æŠ›å‡º å°±æ˜¯äº¤ç»™ java è¿è¡Œæ—¶ç³»ç»Ÿå•¦ï¼ å®ƒä¼šæŠŠå †æ ˆä¿¡æ¯æ‰“å‡ºæ¥ï¼ ä¸€ä¸ªå›¾ ï¼š äº”ä¸ªå…³é”®å­— { try, catch, finally, throw, throws}ä¸€ç‚¹é—®é¢˜ { å…ˆé€®å¤§çš„ï¼Œåé€®å°çš„ï¼ŒæŠ¥é”™ã€‚}ä½¿ç”¨è‡ªå®šä¹‰å¼‚å¸¸ ç¨‹åºä¸­å¯ä»¥ä½¿ç”¨ throw - æ–¹æ³•å throwså¦‚æœthrowæŠ›å‡ºå¼‚å¸¸ä¹‹å,æ–¹æ³•å°±ç»“æŸå•¦ï¼ æ³¨æ„ ï¼š é‡å†™æ–¹æ³•éœ€è¦æŠ›å‡ºä¸åŸæ–¹æ³•æ‰€æŠ›å‡ºå¼‚å¸¸ç±»å‹ä¸€è‡´å¼‚å¸¸æˆ–ä¸æŠ›å‡ºå¼‚å¸¸ã€‚ æ€»ç»“ ï¼š{ ä¸€ä¸ªå›¾ äº”ä¸ªå…³é”®å­— å…ˆé€®å°çš„ï¼Œå†é€®å¤§çš„ã€‚ å¼‚å¸¸ä¸é‡å†™çš„å…³ç³»} Reference csdn robbyo java","categories":[{"name":"java","slug":"java","permalink":"http://iequa.com/categories/java/"}],"tags":[{"name":"java","slug":"java","permalink":"http://iequa.com/tags/java/"}]},{"title":"Java SE Learning Notes for OO","slug":"java/java-se-2.3-notes-oo","date":"2013-07-24T05:54:16.000Z","updated":"2019-10-20T04:30:35.027Z","comments":true,"path":"2013/07/24/java/java-se-2.3-notes-oo/","link":"","permalink":"http://iequa.com/2013/07/24/java/java-se-2.3-notes-oo/","excerpt":"Java SE é¢å‘å¯¹è±¡éƒ¨åˆ†çš„æ¦‚è¦ç¬”è®°: æ‰‹ä¸­æ— å‰‘, å¿ƒä¸­æœ‰å‰‘. å®šä¹‰ç±» ç”Ÿæˆå¯¹è±¡ ï¼Œ å®šä¹‰æ–¹æ³• è¢«è°ƒç”¨","text":"Java SE é¢å‘å¯¹è±¡éƒ¨åˆ†çš„æ¦‚è¦ç¬”è®°: æ‰‹ä¸­æ— å‰‘, å¿ƒä¸­æœ‰å‰‘. å®šä¹‰ç±» ç”Ÿæˆå¯¹è±¡ ï¼Œ å®šä¹‰æ–¹æ³• è¢«è°ƒç”¨ 1. staticstatic var çŸ¥é“äº†å†…å­˜ï¼Œä½ å°±çŸ¥é“äº†ä¸€åˆ‡. å±€éƒ¨å˜é‡ åˆ†é…åœ¨ stack memory æˆå‘˜å˜é‡ åˆ†é…åœ¨ heap memory static var ä¸ºç±»å¯¹è±¡å…±äº«çš„å˜é‡ åœ¨æ•°æ®åŒº éé™æ€å˜é‡ ä¸“å±äºæŸä¸€ä¸ªå¯¹è±¡ é™æ€æ–¹æ³•ä¸å†æ˜¯é’ˆå¯¹æŸä¸€ä¸ªå¯¹è±¡è¿›è¡Œè°ƒç”¨, æ‰€ä»¥ä¸èƒ½è®¿é—®éé™æ€æˆå‘˜ã€‚ 2. packageåŒ…åèµ·åæ–¹æ³• ï¼š å…¬å¸åŸŸåå€’è¿‡æ¥. å¿…é¡»ä¿è¯è¯¥ç±» class æ–‡ä»¶ä½äºæ­£ç¡®çš„ç›®å½•ä¸‹. å¿…é¡»classæ–‡ä»¶çš„æœ€ä¸Šå±‚åŒ…çš„çˆ¶ç›®å½•ä½äºclasspathä¸‹. æ‰§è¡Œä¸€ä¸ªç±»éœ€è¦å†™å…¨åŒ…å. SDK ä¸»è¦çš„åŒ…ä»‹ç» * java.lang - åŒ…å«ä¸€äº› java è¯­è¨€çš„æ ¸å¿ƒç±»ï¼Œ å¦‚ : String, Math, Integer, System, Thread. * java.net - åŒ…å«æ‰§è¡Œä¸ç½‘ç»œç›¸å…³çš„æ“ä½œçš„ç±» * java.io - åŒ…å«èƒ½æä¾›å¤šç§è¾“å…¥/è¾“å‡ºåŠŸèƒ½çš„ç±» * java.util - åŒ…å«ä¸€äº›å®ç”¨å·¥å…·ç±». 3. ç±»çš„ç»§æ‰¿ä¸æƒé™æ§åˆ¶ * ä¿®é¥°ç¬¦ ç±»å†…éƒ¨ åŒä¸€åŒ…å†… å­ç±» ä»»ä½•åœ°æ–¹ * private Yes * default Yes Yes * protected Yes Yes Yes * public Yes Yes Yes Yes åˆ†æå†…å­˜ : å­ç±»å¯¹è±¡åŒ…å«ä¸€ä¸ªçˆ¶ç±»å¯¹è±¡.é‡å†™æ–¹æ³•ä¸èƒ½ä½¿ç”¨æ¯”è¢«é‡å†™æ–¹æ³•æ›´ä¸¥æ ¼çš„è®¿é—®æƒé™ â€” å…¶å®è¿™å’Œå¤šæ€æœ‰å…³ super å…³é”®å­— &amp; ç»§æ‰¿ä¸­çš„æ„é€ æ–¹æ³• å¦‚æœè°ƒç”¨ super å¿…é¡»å†™åœ¨æ„é€ æ–¹æ³•çš„ç¬¬ä¸€è¡Œ å¦‚æœæ²¡è°ƒç”¨ï¼Œç³»ç»Ÿè‡ªåŠ¨è°ƒç”¨ super(), å¦‚æœæ²¡è°ƒï¼Œçˆ¶ç±»ä¸­åˆæ²¡å†™å‚æ•°ä¸ºç©ºè¿™ä¸ªæ„é€ æ–¹æ³•åˆ™å‡ºé”™ã€‚ Object ç±» instanceof æ˜¯ä¸€ä¸ªæ“ä½œç¬¦ equalsæ–¹æ³• J2SDK æä¾›çš„ä¸€äº›ç±» å¦‚ String , Date é‡å†™äº†Object çš„ equals() æ–¹æ³•. å¯¹è±¡è½¬å‹ casting * ä¸€ä¸ªåŸºç±»çš„å¼•ç”¨ç±»å‹å˜é‡å¯ä»¥æŒ‡å‘ â€œå…¶å­ç±»çš„å¯¹è±¡â€ã€‚ * ä¸€ä¸ªåŸºç±»çš„å¼•ç”¨ä¸å¯ä»¥è®¿é—®å…¶å­ç±»æ–°å¢åŠ çš„æˆå‘˜ * å¯ä»¥ä½¿ç”¨ å¼•ç”¨ å˜é‡ instanceof ç±»å æ¥åˆ¤æ–­è¯¥å¼•ç”¨å‹å˜é‡æ‰€&quot;æŒ‡å‘&quot;çš„å¯¹è±¡æ˜¯å¦å±äºè¯¥ç±»æˆ–è¯¥ç±»çš„å­ç±»ã€‚ * upcasting / downcasting å†…å­˜åˆ†æ - æ˜ç™½äº†å†…å­˜ä½ å°±æ˜ç™½äº†ä¸€åˆ‡ï¼ åŠ¨æ€ç»‘å®š, æ± ç»‘å®š, å¤šæ€ * åŠ¨æ€ç»‘å®šçš„æœºåˆ¶ æ˜¯ å®é™…ç±»å‹ new çš„æ˜¯ï¼ * æ·±ä¸€ç‚¹ -- æ˜¯å¯¹è±¡å†…éƒ¨æœ‰ä¸€ä¸ªæŒ‡é’ˆã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ * åŠ¨æ€ç»‘å®šçš„æœºåˆ¶æ˜¯ ï¼š å®é™…ç±»å‹ï¼Œè¿˜æ˜¯å¼•ç”¨ç±»å‹ã€‚æ˜¯è°ƒç”¨å®é™…ç±»å‹ï¼Œä¸æ˜¯å¼•ç”¨ç±»å‹ã€‚ * å®é™…åœ°å€æ‰ä¼šç»‘å®šåˆ°é‚£ä¸ªæ–¹æ³•ä¸Šã€‚ æ–¹æ³•åœ¨ code segment * åªæœ‰åœ¨è¿è¡ŒæœŸé—´(ä¸æ˜¯åœ¨ç¼–è¯‘æœŸé—´)ï¼Œè¿è¡Œå‡ºå¯¹è±¡æ¥ï¼Œæ‰èƒ½åˆ¤æ–­è°ƒç”¨å“ªä¸€ä¸ªã€‚ã€‚ã€‚ã€‚ è¿™æ˜¯é¢å‘å¯¹è±¡æ ¸å¿ƒä¸­çš„æ ¸å¿ƒã€‚æ ¸å¿ƒä¸­çš„æ ¸å¿ƒ ! å¸¦æ¥çš„è«å¤§å¥½å¤„: å¯æ‰©å±•æ€§è¾¾åˆ°äº†éå¸¸éå¸¸çš„æè‡´å¥½ï¼ å¤šæ€æ€»ç»“: è¦æœ‰ç»§æ‰¿ è¦æœ‰é‡å†™ çˆ¶ç±»å¼•ç”¨æŒ‡å‘å­ç±»å¯¹è±¡ 4. Abstract class abstract ä¿®é¥°classæ—¶ï¼Œè¿™ä¸ªç±»å«åšæŠ½è±¡ç±». abstract ä¿®é¥°æ–¹æ³•æ—¶ï¼Œè¯¥æ–¹æ³•å«åšæŠ½è±¡æ–¹æ³•. abstract class å¿…é¡»è¢«ç»§æ‰¿ï¼ŒæŠ½è±¡æ–¹æ³•å¿…é¡»è¢«é‡å†™. å«æœ‰æŠ½è±¡æ–¹æ³•çš„ç±»å¿…é¡»å£°æ˜ä¸ºæŠ½è±¡ç±». abstract class ä¸èƒ½è¢«å®ä¾‹åŒ–, æŠ½è±¡æ–¹æ³•åªéœ€å£°æ˜ï¼Œè€Œä¸éœ€è¦å®ç°. 5. Final å…³é”®å­— final çš„å˜é‡çš„å€¼ä¸èƒ½å¤Ÿè¢«æ”¹å˜. final çš„æˆå‘˜å˜é‡ã€å±€éƒ¨å˜é‡(å½¢å‚) final çš„æ–¹æ³•ä¸èƒ½å¤Ÿè¢«é‡å†™ï¼Œ final çš„ç±»ä¸èƒ½å¤Ÿè¢«ç»§æ‰¿. ç³»ç»Ÿä¸­çš„ final class ä¾‹å¦‚ï¼š public final class String public final class Math public final class Boolean 6. interface: ä¸€ç§ç‰¹æ®Šçš„æŠ½è±¡ç±» å˜é‡å…¨æ˜¯: public static final int id = 1; æ–¹æ³•å…¨æ˜¯: abstract function() java.lang - Comparable æˆ‘çœ‹å°±åƒ cmp ä¸€æ ·ï¼(ä¸ªäººè®¤ä¸º) Interface Comparable&lt;T&gt; å¯ä»¥æ‰©å±• interface interface å¯ä»¥ç›¸äº’ç»§æ‰¿ class interface åªèƒ½æ˜¯ implement å…³ç³» Reference csdn robbyo java","categories":[{"name":"java","slug":"java","permalink":"http://iequa.com/categories/java/"}],"tags":[{"name":"java","slug":"java","permalink":"http://iequa.com/tags/java/"}]},{"title":"Java SE Learning Notes for Hello World","slug":"java/java-se-2.2-notes-app","date":"2013-02-02T02:54:16.000Z","updated":"2019-10-20T04:30:35.029Z","comments":true,"path":"2013/02/02/java/java-se-2.2-notes-app/","link":"","permalink":"http://iequa.com/2013/02/02/java/java-se-2.2-notes-app/","excerpt":"ç¬¬ä¸€ä¸ª Java ç¨‹åº HelloWorld.java. æ‰‹ä¸­æ— å‰‘, å¿ƒä¸­æœ‰å‰‘.","text":"ç¬¬ä¸€ä¸ª Java ç¨‹åº HelloWorld.java. æ‰‹ä¸­æ— å‰‘, å¿ƒä¸­æœ‰å‰‘. Hello WorldHelloWorld.java public class HelloWorld &#123; public static void main(String[] args) &#123; System.out.println(&quot;Hello Java.&quot;); &#125;&#125;/** * è¿™é‡Œæ˜¯æ³¨é‡Š */ ä¸€ä¸ªæºæ–‡ä»¶ä¸­æœ€å¤šåªèƒ½æœ‰ä¸€ä¸ªpublicç±». å¦‚æœæºæ–‡ä»¶ æ–‡ä»¶åŒ…å«ä¸€ä¸ªpublic class å®ƒå¿…éœ€æŒ‰è¯¥ class_name å‘½å Java ç¨‹åºè®¾è®¡data type -- æ•´æ•°ç±»å‹ (byte, short, int, long) -- æ•°å€¼å‹ -- | -- æµ®ç‚¹ç±»å‹ (float, double) --åŸºæœ¬æ•°æ®ç±»å‹ -- å­—ç¬¦å‹ (char) | | | -- å¸ƒå°”å‹ (boolean) æ•°æ®ç±»å‹ -- | -- ç±» (class) | | --å¼•ç”¨æ•°æ®ç±»å‹ -- æ¥å£ (interface) | -- æ•°ç»„ (array) java ä¸­å®šä¹‰äº† 4ç±» 8ç§ åŸºæœ¬æ•°æ®ç±»å‹boolean ç±»å‹åªå…è®¸å–å€¼ true / false , ä¸å¯ä»¥ç”¨ 0 æˆ– é0 æ›¿ä»£ã€‚char é‡‡ç”¨ Unicode ç¼–ç  (å…¨çƒè¯­è¨€ç»Ÿä¸€ç¼–ç ), æ¯ä¸ªå­—ç¬¦å ä¸¤ä¸ªå­—èŠ‚ Reference","categories":[{"name":"java","slug":"java","permalink":"http://iequa.com/categories/java/"}],"tags":[{"name":"java","slug":"java","permalink":"http://iequa.com/tags/java/"}]},{"title":"Java SE Learning Notes for Environment","slug":"java/java-se-2.1-notes-env","date":"2013-02-02T00:54:16.000Z","updated":"2019-10-20T04:30:35.028Z","comments":true,"path":"2013/02/02/java/java-se-2.1-notes-env/","link":"","permalink":"http://iequa.com/2013/02/02/java/java-se-2.1-notes-env/","excerpt":"Java ç¯å¢ƒçš„æ­å»º æ‰‹ä¸­æ— å‰‘, å¿ƒä¸­æœ‰å‰‘.","text":"Java ç¯å¢ƒçš„æ­å»º æ‰‹ä¸­æ— å‰‘, å¿ƒä¸­æœ‰å‰‘. 1. JDKMS=/usr/local/xsoft/software### JAVA ###JAVA_HOME=/Library/Java/JavaVirtualMachines/jdk/Contents/HomeJAVA_BIN=$JAVA_HOME/binPATH=$JAVA_HOME/bin:$PATHCLASSPATH=.:$JAVA_HOME/jre/lib/rt.jar:$JAVA_HOME/jre/lib/dt.jar:$JAVA_HOME/jre/lib/tools.jarexport JAVA_HOME JAVA_BIN PATH CLASSPATH 2. Maven### Maven ###M2_HOME=/usr/local/xsoft/software/apache-mavenMAVEN_HOME=$M2_HOMEM3_HOME=$M2_HOMEPATH=$M3_HOME/bin:$PATHexport MAVEN_HOME M2_HOME PATH#MAVEN_OPTS=-Xms128m -Xmx512m 3. Tomcat### Tomcat ###CATALINA_HOME=/usr/local/xsoft/software/apache-tomcatPATH=$CATALINA_HOME/bin:$PATHexport CATALINA_HOME PATH 4. IDE Intellij IDEA Reference Blair Zsh Config","categories":[{"name":"java","slug":"java","permalink":"http://iequa.com/categories/java/"}],"tags":[{"name":"java","slug":"java","permalink":"http://iequa.com/tags/java/"}]},{"title":"Java SE Introduce","slug":"java/java-se-1-introduce","date":"2013-02-01T23:54:16.000Z","updated":"2019-10-20T04:30:35.028Z","comments":true,"path":"2013/02/02/java/java-se-1-introduce/","link":"","permalink":"http://iequa.com/2013/02/02/java/java-se-1-introduce/","excerpt":"Javaæ˜¯ä¸€ç§å¹¿æ³›ä½¿ç”¨çš„è®¡ç®—æœºç¼–ç¨‹è¯­è¨€ï¼Œæ‹¥æœ‰è·¨å¹³å°ã€é¢å‘å¯¹è±¡ã€æ³›å‹ç¼–ç¨‹çš„ç‰¹æ€§.","text":"Javaæ˜¯ä¸€ç§å¹¿æ³›ä½¿ç”¨çš„è®¡ç®—æœºç¼–ç¨‹è¯­è¨€ï¼Œæ‹¥æœ‰è·¨å¹³å°ã€é¢å‘å¯¹è±¡ã€æ³›å‹ç¼–ç¨‹çš„ç‰¹æ€§. Java data type OO Exception Java Array Java å¸¸ç”¨ç±» Java å®¹å™¨ç±» Collection / Generic Java I/O Stream Java Thread Java TCP/UDP, socket 1. Java æ¦‚è¿° Java è¿è¡Œæœºåˆ¶ JDK &amp; JRE Java env install Java Basic Content conclude : è®¡ç®—æœºè¯­è¨€æœç€äººç±»æ˜“äºç†è§£çš„æ–¹å‘å‘å±• 2. Java ç‰¹ç‚¹ ä¸€ç§ OO è¯­è¨€ ä¸€ç§å¹³å°æ— å…³çš„è¯­è¨€, æä¾›ç¨‹åºè¿è¡Œçš„è§£é‡Šç¯å¢ƒ ä¸€ç§å¥å£®çš„è¯­è¨€, å¸æ”¶äº†C/C++è¯­è¨€çš„ä¼˜ç‚¹ï¼Œ ä½†å»æ‰äº†å…¶å½±å“ç¨‹åºå¥å£®æ€§çš„éƒ¨åˆ†(å¦‚: æŒ‡é’ˆï¼Œ å†…å­˜çš„ç”³è¯·ä¸é‡Šæ”¾ç­‰)ã€‚ 3. Javaç¨‹åºè¿è¡Œæœºåˆ¶Java 2ç§æ ¸å¿ƒæœºåˆ¶ Java Virtual Machine Garbage collection JVM å¯ç†è§£æˆä¸€ä¸ªä»¥å­—èŠ‚ç ä¸ºæœºå™¨æŒ‡ä»¤çš„CPUJVM æœºåˆ¶å±è”½äº†åº•å±‚è¿è¡Œå¹³å°çš„å·®åˆ«, å®ç°äº†â€ä¸€æ¬¡ç¼–è¯‘, éšå¤„è¿è¡Œâ€ã€‚ x.java â€”ç¼–è¯‘â€”&gt; x.class â€”æ‰§è¡Œâ€”&gt; JVM Javaè¯­è¨€æ¶ˆé™¤äº†ç¨‹åºå‘˜å›æ”¶æ— ç”¨å†…å­˜ç©ºé—´çš„è´£ä»»;å®ƒæä¾›ä¸€ç§ç³»ç»Ÿçº§çº¿ç¨‹è·Ÿè¸ªå­˜å‚¨ç©ºé—´çš„åˆ†é…æƒ…å†µï¼Œå¹¶åœ¨JVMçš„ç©ºé—²æ—¶, æ£€æŸ¥å¹¶é‡Šæ”¾é‚£äº›å¯è¢«é‡Šæ”¾çš„å­˜å‚¨å™¨ç©ºé—´ã€‚ 4. JDK &amp; JRE &amp; env install Software Development Kit (è½¯ä»¶å¼€å‘åŒ…) å¼€å‘éœ€è¦ JDK Java Runtime Environment ç”¨æˆ·åªéœ€ JRE /etc/profile or ~/.zshrc or ~/.zprofile ### JAVA ###JAVA_HOME=/Library/Java/JavaVirtualMachines/jdk1.7.0_79.jdk/Contents/HomeJAVA_BIN=$JAVA_HOME/binPATH=$JAVA_HOME/bin:$PATHCLASSPATH=.:$JAVA_HOME/jre/lib/rt.jar:$JAVA_HOME/jre/lib/dt.jar:$JAVA_HOME/jre/lib/tools.jarexport JAVA_HOME JAVA_BIN PATH CLASSPATH classpath : javaåœ¨ç¼–è¯‘å’Œè¿è¡Œæ—¶è¦æ‰¾çš„classæ‰€åœ¨çš„è·¯å¾„å»ºè®®ä½ çš„ JDK è£…åœ¨ä¸å¸¦ç©ºæ ¼çš„ç›®å½•é‡Œé¢ 5. å‘½åè§„åˆ™ ç±»åé¦–å­—æ¯å¤§å†™ å˜é‡åå’Œæ–¹æ³•åçš„é¦–å­—æ¯å°å†™ è¿ç”¨é©¼å³°æ ‡è¯† HelloWorld.java public class HelloWorld &#123; public static void main(String[] args) &#123; System.out.println(&quot;Hello Java.&quot;); &#125;&#125;/** * è¿™é‡Œæ˜¯æ³¨é‡Š */ ä¸€ä¸ªæºæ–‡ä»¶ä¸­æœ€å¤šåªèƒ½æœ‰ä¸€ä¸ªpublicç±». å…¶å®ƒç±»çš„ä¸ªæ•°ä¸é™ï¼Œå¦‚æœæºæ–‡ä»¶ æ–‡ä»¶åŒ…å«ä¸€ä¸ªpublic class å®ƒå¿…éœ€æŒ‰è¯¥ class-name å‘½å 6. Java ç¨‹åºè®¾è®¡data type -- æ•´æ•°ç±»å‹ (byte, short, int, long) -- æ•°å€¼å‹ -- | -- æµ®ç‚¹ç±»å‹ (float, double) --åŸºæœ¬æ•°æ®ç±»å‹ -- å­—ç¬¦å‹ (char) | | | -- å¸ƒå°”å‹ (boolean) æ•°æ®ç±»å‹ -- | -- ç±» (class) | | --å¼•ç”¨æ•°æ®ç±»å‹ -- æ¥å£ (interface) | -- æ•°ç»„ (array) java ä¸­å®šä¹‰äº† 4ç±» 8ç§ åŸºæœ¬æ•°æ®ç±»å‹boolean ç±»å‹åªå…è®¸å–å€¼ true / false , ä¸å¯ä»¥ç”¨ 0 æˆ– é0 æ›¿ä»£ã€‚char é‡‡ç”¨ Unicode ç¼–ç  (å…¨çƒè¯­è¨€ç»Ÿä¸€ç¼–ç ), æ¯ä¸ªå­—ç¬¦å ä¸¤ä¸ªå­—èŠ‚ 7. Array &amp; Methodpublic class Test &#123; public static void main(String[] args) &#123; Date[] days; days = new Date[3]; for (int i = 0; i &lt; 3; i++) &#123; days[i] = new Date(2004, 4, i+1); &#125; // int[] a = &#123;1, 2, 3, 4, 5, 6, 7&#125;; for (int i = 0; i &lt; a.length; i++) &#123; System.out.print(a[i] + &quot; &quot;); &#125; &#125; &#125; class Date &#123; int year; int month; int day; Date(int y, int m, int d) &#123; year = y; month = m; day = d; &#125; &#125; é¢å‘è¿‡ç¨‹-çº¦ç‘Ÿå¤«ç¯ é¢å‘å¯¹è±¡-çº¦ç‘Ÿå¤«ç¯","categories":[{"name":"java","slug":"java","permalink":"http://iequa.com/categories/java/"}],"tags":[{"name":"java","slug":"java","permalink":"http://iequa.com/tags/java/"}]},{"title":"Java SE Learning Notes for All","slug":"java/java-se-2.5-notes-all","date":"2013-02-01T23:54:16.000Z","updated":"2019-10-20T04:30:35.030Z","comments":true,"path":"2013/02/02/java/java-se-2.5-notes-all/","link":"","permalink":"http://iequa.com/2013/02/02/java/java-se-2.5-notes-all/","excerpt":"è¿™ç¯‡ä¸»è¦æ˜¯è®°å½•äº†æˆ‘å­¦ä¹  Java SE çš„æ¦‚è¦ç¬”è®°: æ‰‹ä¸­æ— å‰‘, å¿ƒä¸­æœ‰å‰‘, æ‘˜èŠ±é£å¶å¯ä»¥ä¼¤äºº.","text":"è¿™ç¯‡ä¸»è¦æ˜¯è®°å½•äº†æˆ‘å­¦ä¹  Java SE çš„æ¦‚è¦ç¬”è®°: æ‰‹ä¸­æ— å‰‘, å¿ƒä¸­æœ‰å‰‘, æ‘˜èŠ±é£å¶å¯ä»¥ä¼¤äºº. 1. ç¯å¢ƒé…ç½®### JAVA ###JAVA_HOME=/Library/Java/JavaVirtualMachines/jdk/Contents/HomeJAVA_BIN=$JAVA_HOME/binPATH=$JAVA_HOME/bin:$PATHCLASSPATH=.:$JAVA_HOME/jre/lib/rt.jar:$JAVA_HOME/jre/lib/dt.jar:$JAVA_HOME/jre/lib/tools.jarexport JAVA_HOME JAVA_BIN PATH CLASSPATH 2. åŸºç¡€åˆ†æè®¾è®¡ ï¼š 1. è¿™ä¸ªä¸œè¥¿æœ‰ å“ªäº›ç±» 2. ç±»çš„ å±æ€§å’Œæ–¹æ³• 3. ç±»ä¸ç±»ä¹‹é—´çš„å…³ç³» 4. å®ç° 3. é¢å‘å¯¹è±¡ å®šä¹‰ç±» ç”Ÿæˆå¯¹è±¡ å®šä¹‰æ–¹æ³• è¢«è°ƒç”¨ 3.1 staticstatic var çŸ¥é“äº†å†…å­˜ï¼Œä½ å°±çŸ¥é“äº†ä¸€åˆ‡. å±€éƒ¨å˜é‡ åˆ†é…åœ¨ stack memory æˆå‘˜å˜é‡ åˆ†é…åœ¨ heap memory static var ä¸ºç±»å¯¹è±¡å…±äº«çš„å˜é‡ åœ¨æ•°æ®åŒº éé™æ€å˜é‡ ä¸“å±äºæŸä¸€ä¸ªå¯¹è±¡ é™æ€æ–¹æ³•ä¸å†æ˜¯é’ˆå¯¹æŸä¸€ä¸ªå¯¹è±¡è¿›è¡Œè°ƒç”¨, æ‰€ä»¥ä¸èƒ½è®¿é—®éé™æ€æˆå‘˜ã€‚ 3.2 packageåŒ…åèµ·åæ–¹æ³• ï¼š å…¬å¸åŸŸåå€’è¿‡æ¥. å¿…é¡»ä¿è¯è¯¥ç±» class æ–‡ä»¶ä½äºæ­£ç¡®çš„ç›®å½•ä¸‹. å¿…é¡»classæ–‡ä»¶çš„æœ€ä¸Šå±‚åŒ…çš„çˆ¶ç›®å½•ä½äºclasspathä¸‹. æ‰§è¡Œä¸€ä¸ªç±»éœ€è¦å†™å…¨åŒ…å. SDK ä¸»è¦çš„åŒ…ä»‹ç» * java.lang - åŒ…å«ä¸€äº› java è¯­è¨€çš„æ ¸å¿ƒç±»ï¼Œ å¦‚ : String, Math, Integer, System, Thread. * java.net - åŒ…å«æ‰§è¡Œä¸ç½‘ç»œç›¸å…³çš„æ“ä½œçš„ç±» * java.io - åŒ…å«èƒ½æä¾›å¤šç§è¾“å…¥/è¾“å‡ºåŠŸèƒ½çš„ç±» * java.util - åŒ…å«ä¸€äº›å®ç”¨å·¥å…·ç±». 3.3 ç±»çš„ç»§æ‰¿ä¸æƒé™æ§åˆ¶ * ä¿®é¥°ç¬¦ ç±»å†…éƒ¨ åŒä¸€åŒ…å†… å­ç±» ä»»ä½•åœ°æ–¹ * private Yes * default Yes Yes * protected Yes Yes Yes * public Yes Yes Yes Yes åˆ†æå†…å­˜ : å­ç±»å¯¹è±¡åŒ…å«ä¸€ä¸ªçˆ¶ç±»å¯¹è±¡.é‡å†™æ–¹æ³•ä¸èƒ½ä½¿ç”¨æ¯”è¢«é‡å†™æ–¹æ³•æ›´ä¸¥æ ¼çš„è®¿é—®æƒé™ â€” å…¶å®è¿™å’Œå¤šæ€æœ‰å…³ super å…³é”®å­— &amp; ç»§æ‰¿ä¸­çš„æ„é€ æ–¹æ³• å¦‚æœè°ƒç”¨ super å¿…é¡»å†™åœ¨æ„é€ æ–¹æ³•çš„ç¬¬ä¸€è¡Œ å¦‚æœæ²¡è°ƒç”¨ï¼Œç³»ç»Ÿè‡ªåŠ¨è°ƒç”¨ super(), å¦‚æœæ²¡è°ƒï¼Œçˆ¶ç±»ä¸­åˆæ²¡å†™å‚æ•°ä¸ºç©ºè¿™ä¸ªæ„é€ æ–¹æ³•åˆ™å‡ºé”™ã€‚ Object ç±» instanceof æ˜¯ä¸€ä¸ªæ“ä½œç¬¦ equalsæ–¹æ³• J2SDK æä¾›çš„ä¸€äº›ç±» å¦‚ String , Date é‡å†™äº†Object çš„ equals() æ–¹æ³•. å¯¹è±¡è½¬å‹ casting * ä¸€ä¸ªåŸºç±»çš„å¼•ç”¨ç±»å‹å˜é‡å¯ä»¥æŒ‡å‘ â€œå…¶å­ç±»çš„å¯¹è±¡â€ã€‚ * ä¸€ä¸ªåŸºç±»çš„å¼•ç”¨ä¸å¯ä»¥è®¿é—®å…¶å­ç±»æ–°å¢åŠ çš„æˆå‘˜ * å¯ä»¥ä½¿ç”¨ å¼•ç”¨ å˜é‡ instanceof ç±»å æ¥åˆ¤æ–­è¯¥å¼•ç”¨å‹å˜é‡æ‰€&quot;æŒ‡å‘&quot;çš„å¯¹è±¡æ˜¯å¦å±äºè¯¥ç±»æˆ–è¯¥ç±»çš„å­ç±»ã€‚ * upcasting / downcasting å†…å­˜åˆ†æ - æ˜ç™½äº†å†…å­˜ä½ å°±æ˜ç™½äº†ä¸€åˆ‡ï¼ åŠ¨æ€ç»‘å®š, æ± ç»‘å®š, å¤šæ€ * åŠ¨æ€ç»‘å®šçš„æœºåˆ¶ æ˜¯ å®é™…ç±»å‹ new çš„æ˜¯ï¼ * æ·±ä¸€ç‚¹ -- æ˜¯å¯¹è±¡å†…éƒ¨æœ‰ä¸€ä¸ªæŒ‡é’ˆã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ * åŠ¨æ€ç»‘å®šçš„æœºåˆ¶æ˜¯ ï¼š å®é™…ç±»å‹ï¼Œè¿˜æ˜¯å¼•ç”¨ç±»å‹ã€‚æ˜¯è°ƒç”¨å®é™…ç±»å‹ï¼Œä¸æ˜¯å¼•ç”¨ç±»å‹ã€‚ * å®é™…åœ°å€æ‰ä¼šç»‘å®šåˆ°é‚£ä¸ªæ–¹æ³•ä¸Šã€‚ æ–¹æ³•åœ¨ code segment * åªæœ‰åœ¨è¿è¡ŒæœŸé—´(ä¸æ˜¯åœ¨ç¼–è¯‘æœŸé—´)ï¼Œè¿è¡Œå‡ºå¯¹è±¡æ¥ï¼Œæ‰èƒ½åˆ¤æ–­è°ƒç”¨å“ªä¸€ä¸ªã€‚ã€‚ã€‚ã€‚ è¿™æ˜¯é¢å‘å¯¹è±¡æ ¸å¿ƒä¸­çš„æ ¸å¿ƒã€‚æ ¸å¿ƒä¸­çš„æ ¸å¿ƒ ! å¸¦æ¥çš„è«å¤§å¥½å¤„: å¯æ‰©å±•æ€§è¾¾åˆ°äº†éå¸¸éå¸¸çš„æè‡´å¥½ï¼ å¤šæ€æ€»ç»“: è¦æœ‰ç»§æ‰¿ è¦æœ‰é‡å†™ çˆ¶ç±»å¼•ç”¨æŒ‡å‘å­ç±»å¯¹è±¡ 3.4 Abstract class abstract ä¿®é¥°classæ—¶ï¼Œè¿™ä¸ªç±»å«åšæŠ½è±¡ç±». abstract ä¿®é¥°æ–¹æ³•æ—¶ï¼Œè¯¥æ–¹æ³•å«åšæŠ½è±¡æ–¹æ³•. abstract class å¿…é¡»è¢«ç»§æ‰¿ï¼ŒæŠ½è±¡æ–¹æ³•å¿…é¡»è¢«é‡å†™. å«æœ‰æŠ½è±¡æ–¹æ³•çš„ç±»å¿…é¡»å£°æ˜ä¸ºæŠ½è±¡ç±». abstract class ä¸èƒ½è¢«å®ä¾‹åŒ–, æŠ½è±¡æ–¹æ³•åªéœ€å£°æ˜ï¼Œè€Œä¸éœ€è¦å®ç°. 3.5 Final å…³é”®å­— final çš„å˜é‡çš„å€¼ä¸èƒ½å¤Ÿè¢«æ”¹å˜. final çš„æˆå‘˜å˜é‡ã€å±€éƒ¨å˜é‡(å½¢å‚) final çš„æ–¹æ³•ä¸èƒ½å¤Ÿè¢«é‡å†™ï¼Œ final çš„ç±»ä¸èƒ½å¤Ÿè¢«ç»§æ‰¿. ç³»ç»Ÿä¸­çš„ final class ä¾‹å¦‚ï¼š public final class String public final class Math public final class Boolean 3.6 æ¥å£: ä¸€ç§ç‰¹æ®Šçš„æŠ½è±¡ç±» å˜é‡å…¨æ˜¯: public static final int id = 1; æ–¹æ³•å…¨æ˜¯: abstract function() java.lang - Comparable æˆ‘çœ‹å°±åƒ cmp ä¸€æ ·ï¼(ä¸ªäººè®¤ä¸º) Interface Comparable&lt;T&gt; å¯ä»¥æ‰©å±• interface interface å¯ä»¥ç›¸äº’ç»§æ‰¿ class interface åªèƒ½æ˜¯ implement å…³ç³» ç¬¬å››ç«  å¼‚å¸¸å¤„ç† Java å¼‚å¸¸æ˜¯ Java æä¾›çš„ç”¨äºå¤„ç†ç¨‹åºä¸­é”™è¯¯çš„ä¸€ç§æœºåˆ¶ã€‚java.langâ€¦.Exceptionså†™ç¨‹åºæœ‰é—®é¢˜è¦æœ‰å‹å¥½ç•Œé¢åŒ»ç”Ÿå¼€å•å­ { 1, é¼»è…”å†…æ„Ÿè§‰å¼‚å¸¸ 2, ä½“æ¸©æŒç»­å‡é«˜ 3, åˆ†æ³Œä¹³ç™½è‰²æ¶²ä½“ ç›´æ¥è¯´æ„Ÿå†’ä¸å°±å¾—äº†ä¹ˆï¼Ÿ}e.printStackTrace(); éå¸¸å¥½ï¼ç»™ç¨‹åºå‘˜è¯»ã€‚å †æ ˆä¿¡æ¯éƒ½æ‰“å°å‡ºæ¥ï¼ java.lang.Throwable { å¼€è½¦åœ¨ä¸Šå±±èµ°ï¼Œ 1, Error å±±çˆ†å‘ JVM å‡ºé—®é¢˜ã€‚ 2, Exception &#123; ä½ å¯ä»¥å¤„ç†çš„ -- åˆ¹è½¦åå•¦ï¼ä¿®å¥½å†èµ°ã€‚ã€‚ã€‚ 1, ... 2, RuntimeException (ç»å¸¸å‡ºï¼Œä¸ç”¨é€®) å‹è·¯é¢ä¸Šçš„å°çŸ³å­ }ä¸€ä¸ª try å¯ä»¥è·Ÿå¤šä¸ªcatchæ‰€ä»¥ { ä¸€ä¸ªèŒ¶å£¶å¯ä»¥è·Ÿå¤šä¸ªèŒ¶ç¢—ï¼Œä¸€ä¸ªç”·äººå¯ä»¥ä¸‰å¦»å››å¦¾ã€‚}try { // å¯èƒ½æŠ›å‡ºå¼‚å¸¸çš„è¯­å¥ è¯­å¥ä¸€ï¼› è¯­å¥äºŒï¼›} catch(someEx e) { è¯­å¥ï¼› } catch() { è¯­å¥ } finally { }ä¸€ ï¼š æ‰“å¼€äºŒ ï¼š å…³é—­finally : ä¸€èˆ¬è¿›è¡Œèµ„æºçš„æ¸…é™¤å·¥ä½œã€‚ã€‚ã€‚ï¼ æˆ‘å¤„ç†ä¸äº†çš„äº‹æƒ… ï¼š æˆ‘äº¤ç»™ä¸Šä¸€çº§éƒ¨é—¨å»å¤„ç†ï¼å½“æ—¶ catch åˆ° Ex çš„æ—¶å€™ï¼Œä½ è‡³å°‘è¦åšå‡ºä¸€ç§å¤„ç†ã€‚è¦ä¸é‚£æ˜¯å±é™©çš„ç¼–ç¨‹ä¹ æƒ¯ï¼main() æŠ›å‡º å°±æ˜¯äº¤ç»™ java è¿è¡Œæ—¶ç³»ç»Ÿå•¦ï¼ å®ƒä¼šæŠŠå †æ ˆä¿¡æ¯æ‰“å‡ºæ¥ï¼ ä¸€ä¸ªå›¾ ï¼š äº”ä¸ªå…³é”®å­— { try, catch, finally, throw, throws}ä¸€ç‚¹é—®é¢˜ { å…ˆé€®å¤§çš„ï¼Œåé€®å°çš„ï¼ŒæŠ¥é”™ã€‚}ä½¿ç”¨è‡ªå®šä¹‰å¼‚å¸¸ ç¨‹åºä¸­å¯ä»¥ä½¿ç”¨ throw - æ–¹æ³•å throwså¦‚æœthrowæŠ›å‡ºå¼‚å¸¸ä¹‹å,æ–¹æ³•å°±ç»“æŸå•¦ï¼ æ³¨æ„ ï¼š é‡å†™æ–¹æ³•éœ€è¦æŠ›å‡ºä¸åŸæ–¹æ³•æ‰€æŠ›å‡ºå¼‚å¸¸ç±»å‹ä¸€è‡´å¼‚å¸¸æˆ–ä¸æŠ›å‡ºå¼‚å¸¸ã€‚ æ€»ç»“ ï¼š{ ä¸€ä¸ªå›¾ äº”ä¸ªå…³é”®å­— å…ˆé€®å°çš„ï¼Œå†é€®å¤§çš„ã€‚ å¼‚å¸¸ä¸é‡å†™çš„å…³ç³»} 5. æ•°ç»„ å››ç»´ç©ºé—´int[] a, int a[];å†…å­˜åˆ†æ - çŸ¥é“äº†å†…å­˜ä½ å°±æ˜ç™½äº†ä¸€åˆ‡ï¼æœ¬æ¥æ— ä¸€ç‰© ï¼š ä½•å¤„è£…æ•°ç»„ã€‚ åŠ¨æ€åˆå§‹åŒ– é™æ€åˆå§‹åŒ– int a[] = {3, 9, 8}; å†…éƒ¨è¿‡ç¨‹å±è”½æ‰å•¦ï¼ ipconfigipconfig -all è¿™é‡Œ -all å°±æ˜¯å‘½ä»¤è¡Œå‚æ•°ã€‚ åŸºç¡€ç±»å‹ä¸€èˆ¬åˆ†é…åœ¨æ ˆä¸Šé¢ï¼åŒ…è£…ç±»ï¼Œç”¨äºæŠŠåŸºç¡€ç±»å‹åŒ…è£…æˆå¯¹è±¡ï¼Œåˆ™åˆ†é…åœ¨å †ä¸Šäº†ã€‚ä¾‹å¦‚ ç±» Double, Integer çº¦ç‘Ÿå¤«ç¯ - é¢å‘è¿‡ç¨‹ å’Œ é¢å‘å¯¹è±¡ å†™æ³• å¦ä¸€ä¸ªæ¯”è¾ƒç²¾å·§çš„ç®—æ³• ï¼š ç”¨æ•°ç»„æ¥æ¨¡æ‹Ÿé“¾è¡¨ç®—æ³•å’Œé€»è¾‘æ€ç»´èƒ½åŠ›ä¸æ˜¯ä¸€æœä¸€å¤•èƒ½å®Œæˆçš„ã€‚æ’åºç®—æ³•ç´§è·Ÿç€çš„æ˜¯ - æœç´¢ç®—æ³• ä½ è¿™é‡Œæ˜¯é€šè¿‡å¯¹è±¡square1è°ƒç”¨çš„æ–¹æ³•getsquare() public static void main(String[] args){ getsquare(); //è¿™é‡Œä¼šå‡ºé”™ } æ˜¯çš„ã€‚å…¶å®mainå‡½æ•°å¯ä»¥ç®€å•è®¤ä¸ºè·Ÿæœ¬ç±»æ²¡ä»€ä¹ˆå…³ç³»ï¼Œåªæ˜¯è°ƒç”¨æœ¬ç±»çš„ å…¶å®ƒé™æ€æ–¹æ³•æ—¶ä¸ç”¨å†™ç±»åè€Œå·²ã€‚æ‰€ä»¥ï¼Œè¦è°ƒç”¨å…¶å®ƒéé™æ€æ–¹æ³•ï¼Œéƒ½è¦ å…ˆå®ä¾‹åŒ–ï¼Œå°±åƒåˆ«çš„ç±»æ¥è°ƒç”¨ä¸€æ ·ã€‚â€”â€”â€”â€” æˆ‘æœ‰äº›æ‡‚å•¦ï¼ ä½†è¿˜æ˜¯ä¸å¤ªæ‡‚ï¼Œæˆ‘èƒ½ç†è§£å•¦ï¼ (ä¸ªäººç†è§£)â€”â€”â€”â€” äºŒç»´æ•°ç»„ ï¼š å¯ä»¥çœ‹æˆä»¥æ•°ç»„ä¸ºå…ƒç´ çš„æ•°ç»„ * æ•°ç»„çš„æ‹·è´ &#123; &#125; å¤§å…¬å¸å‰¥å‰Šäººå‰¥å‰Šå¾—æœ€å‰å®³ï¼ æ˜ç™½å†…å­˜ä½ å°±æ˜ç™½äº†ä¸€åˆ‡ï¼ã€‚ã€‚ã€‚ æ€»ç»“ { * æ•°ç»„å†…å­˜çš„å¸ƒå±€ * å¸¸è§ç®—æ³• }} 6. å¸¸ç”¨ç±»æœ¬ç« å†…å®¹ { * å­—ç¬¦ä¸²ç›¸å…³ç±» (String, StringBuffer) * åŸºæœ¬æ•°æ®ç±»å‹åŒ…è£…ç±» * Mathç±» * Fileç±» * æšä¸¾ç±» * java.lang.String ç±»ä»£è¡¨ä¸å¯å˜çš„å­—ç¬¦åºåˆ— String s1 = &quot;helo&quot;; String s3 = &quot;hello&quot;; s1 == s3 true å­—ç¬¦ä¸²å¸¸é‡ - data seg åŒº data segment ç¼–è¯‘å™¨æœ‰ä¼˜åŒ– å¦‚æœæ˜¯ new s1 == s3 false s1.equals(s3) true å­—ç¬¦ä¸²ä½ å¯ä»¥çœ‹æˆæ˜¯ä¸€ä¸ªå­—ç¬¦æ•°ç»„ï¼ String ç±»å¸¸ç”¨æ–¹æ³• &#123; * é™æ€é‡è½½æ–¹æ³• public static String valueOf(...) * public String[] spllit(String regex) &#125; String.valueOf(Object obj); å¤šæ€çš„å­˜åœ¨ toString java.lang.StringBuffer ä»£è¡¨å¯å˜çš„å­—ç¬¦åºåˆ— * åŸºæœ¬æ•°æ®ç±»å‹åŒ…è£…ç±» åŸºæœ¬æ•°æ® ï¼š æ ˆ -&gt; åŒ…è£… --&gt; å †ä¸Šé¢ * åŒ…è£…ç±» &#123; * å†™ç¨‹åºè¦å¾ªåºæ¸è¿›æ–¹æ³• &#125; * Math ç±» &#123; java.lang.Math å…¶ä¸­æ–¹æ³•çš„å‚æ•°å’Œè¿”å›å€¼ç±»å‹éƒ½ä¸º double &#125; * File ç±» &#123; java.io.File ç±»ä»£è¡¨ç³»ç»Ÿæ–‡ä»¶å (è·¯å¾„å’Œæ–‡ä»¶å) File ç±»çš„å¸¸è§æ„é€ æ–¹æ³• ï¼š * public File(String pathname) ä»¥ pathname ä¸ºè·¯å¾„åˆ›å»º File å¯¹è±¡, å¦‚æœ pathname æ˜¯ç›¸å¯¹è·¯å¾„ï¼Œåˆ™é»˜è®¤çš„å½“å‰è·¯å¾„åœ¨ç³»ç»Ÿå±æ€§ user.dir ä¸­å­˜å‚¨ * public File(String parent, String child) * File çš„é™æ€å±æ€§ String separator å­˜å‚¨äº†å½“å‰ç³»ç»Ÿçš„è·¯å¾„åˆ†éš”ç¬¦ã€‚ åŸå‹ ï¼š public static final String separator ä½†æ˜¯äº‹å®ä¸Šæ— è®ºåœ¨å“ª ä½ å†™ / éƒ½æ²¡æœ‰é—®é¢˜ æ³¨æ„ \\ åœ¨ java é‡Œé¢æ˜¯è½¬ä¹‰å­—ç¬¦ &#125; * Enum - java.lang.Enum æšä¸¾ç±»å‹ &#123; 1, åªèƒ½å¤Ÿå–ç‰¹å®šå€¼ä¸­çš„ä¸€ä¸ª 2, ä½¿ç”¨ enum å…³é”®å­— 3, æ˜¯ java.lang.Enum 4, ä¸¾ä¾‹ ï¼š TestEnum.java &#125; æ€»ç»“~~~ API å’Œ é‡‘åº¸çš„ä¹¦å·®ä¸å¤šï¼ 7. å®¹å™¨ç¬¬ä¸ƒç«  å®¹å™¨ &#123; * å®¹å™¨çš„æ¦‚å¿µ - æ•°ç»„æ˜¯ä¹ˆï¼Œ å½“ç„¶æ˜¯ï¼ * å®¹å™¨API * Collection æ¥å£ * Iterator æ¥å£ * å¢å¼ºçš„ for å¾ªç¯ * Set æ¥å£ * Listæ¥å£ å’Œ Comparableæ¥å£ * Collections ç±» * Map æ¥å£ * è‡ªåŠ¨æ‰“åŒ… / è§£åŒ… * æ³›å‹ (JDK1.5æ–°å¢) ----- * J2SDk æ‰€æä¾›çš„å®¹å™¨ä½äº java.util åŒ…å†…ã€‚ * å®¹å™¨APIçš„ç±»å›¾å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š -------------------------------------------------- 1136 1136 1136 -- ä¸€ä¸ªå›¾, ä¸€ä¸ªç±», ä¸‰ä¸ªçŸ¥è¯†ç‚¹ï¼Œå…­ä¸ªæ¥å£ &lt;&lt;interface&gt;&gt; Collection / \\ &lt;&lt;interface&gt;&gt; &lt;&gt; &lt;&gt; ^ Set List | ^ ^ | | _|__ | HashSet LinkedList ArrayList HashMap 1136 1136 1136 ä¸€ä¸ªå›¾, ä¸€ä¸ªç±», ä¸‰ä¸ªçŸ¥è¯†ç‚¹ï¼Œå…­ä¸ªæ¥å£ --------------------------------------------------- * Collection æ¥å£ -- å®šä¹‰äº†å­˜å–ä¸€ç»„å¯¹è±¡çš„æ–¹æ³•, å…¶å­æ¥å£ Set å’Œ List åˆ†åˆ«å®š ä¹‰äº†å­˜å‚¨æ–¹å¼ã€‚ * Set ä¸­çš„æ•°æ®å¯¹è±¡æ²¡æœ‰é¡ºåºä¸”ä¸å¯ä»¥é‡å¤ã€‚ * Listä¸­çš„æ•°æ®å¯¹è±¡æœ‰é¡ºåºä¸”å¯ä»¥é‡å¤ * Map æ¥å£å®šä¹‰äº†å­˜å‚¨ â€œé”® (key) -- å€¼ (value) æ˜ å°„&quot;å¯¹&quot;çš„æ–¹æ³•ã€‚ Collection æ–¹æ³•ä¸¾ä¾‹ * å®¹å™¨ç±»å¯¹è±¡åœ¨è°ƒç”¨ remove, contains ç­‰æ–¹æ³•æ—¶éœ€è¦æ¯”è¾ƒå¯¹è±¡æ˜¯å¦ç›¸ç­‰ è¿™ä¼šæ¶‰åŠåˆ°å¯¹è±¡ç±»å‹çš„ equals æ–¹æ³•å’Œ hashCode æ–¹æ³•ï¼Œå¯¹äºè‡ªå®šä¹‰çš„ ç±»å‹ï¼Œéœ€è¦è¦é‡å†™ equals å’Œ hashCode æ–¹æ³•ä»¥å®ç°è‡ªå®šä¹‰çš„å¯¹è±¡ç›¸ç­‰ è§„åˆ™ã€‚ * æ³¨æ„ ï¼š ç›¸ç­‰çš„å¯¹è±¡åº”è¯¥å…·æœ‰ç›¸ç­‰çš„ hashcodes * --- ArrayList åº•å±‚æ˜¯ä¸€ä¸ªæ•°ç»„ å“ˆå“ˆå“ˆå“ˆå“ˆ ï¼š è£…å…¥çš„æ˜¯å¯¹è±¡ï¼Œå› ä¸ºå¯¹è±¡åœ¨å †ä¸Šï¼Œæ ˆé‡Œé¢çš„å†…å®¹éšæ—¶å¯èƒ½è¢«æ¸…ç©ºï¼ hashCode èƒ½ç›´æ¥å®šä½åˆ°é‚£ä¸ªå¯¹è±¡ toyreb Iterator - æ¥å£æœ€å°åŒ–åŸåˆ™ æˆ‘è¿™å¤§ç®¡å®¶åœ¨åšæ“ä½œçš„æ—¶å€™ ï¼š è¿ä¸»äººåšä»»ä½•çš„æ“ä½œéƒ½ä¸è®©æ“ä½œå•¦ï¼å› ä¸º iterater æ‰§è¡Œäº†é”å®šï¼Œè°ä¹Ÿä¸è®©è°çœ‹ï¼ JDK 1.5 å¢å¼ºçš„ for å¾ªç¯ Set &#123; HashSet, TreeSet ä¸€ä¸ªä»¥ hash è¡¨å®ç°ï¼Œ ä¸€ä¸ªä»¥ æ ‘ ç»“æ„å®ç° &#125; List &#123; Object set(int index, Object element) int indexof(Object o); int lastIndexof(Object o); &#125; * ä¸€ä¸ªç±» { Collections â€” java.util.Collections æä¾›äº†ä¸€äº›é™æ€æ–¹æ³•å®ç°äº†åŸºäºListå®¹å™¨çš„ä¸€äº›å¸¸ç”¨ç®—æ³• ä¾‹å¦‚ &#123; void sort(List) ... ... ... &#125; LinkedList -- é€†åºçš„æ—¶å€™æ•ˆç‡è¾ƒ ArrayList é«˜ï¼ å¯¹äº ç‰¹å®šçš„ å¯¹è±¡æ€ä¹ˆç¡®å®šè°å¤§è°å°ã€‚ &#123; å¯¹è±¡é—´å¯ä»¥æ¯”è¾ƒå¤§å° é€šè¿‡ æ¥å£ åªèƒ½çœ‹è§å¯¹è±¡çš„ä¸€ç‚¹ã€‘ Comparable æ¥å£ -- æ‰€æœ‰å¯ä»¥å®ç°æ’åºçš„ç±» éƒ½å®ç°äº† Comparable æ¥å£ &#125; public int compareTo(Object obj) æ³›å‹è§„å®š - åªèƒ½ä¼  â€œçŒ«â€ vector / hashtable ä»¥å‰é—ç•™ä¸‹æ¥çš„ã€‚æ•ˆç‡ç‰¹åˆ«ä½ Map æ¥å£ &#123; Map æ¥å£çš„å®ç°ç±»æœ‰ HashMap å’Œ TreeMap ç­‰ã€‚ &#123;hashmap ç”¨ hashè¡¨æ¥å®ç°ï¼Œ TreeMap ç”¨äºŒå‰æ ‘æ¥å®ç°-çº¢é»‘&#125; Map ç±»ä¸­å­˜å‚¨çš„é”® - å€¼å¯¹é€šè¿‡é”®æ¥æ ‡è¯†ï¼Œæ‰€ä»¥é”®å€¼ä¸èƒ½é‡å¤ã€‚&#123; ä¸èƒ½é‡å¤ ï¼š æ˜¯equals() equals() å¤ªæ…¢ï¼Œ æ‰€ä»¥æˆ‘ä»¬ç”¨ hashCode() æ¥æ¯”è¾ƒ &#125; &#125; JDK 1.5 ä¹‹å &#123; å¯ä»¥è‡ªåŠ¨æ‰“åŒ…å’Œè§£åŒ… - Auto-boxing / unboxing * åœ¨åˆé€‚çš„æ—¶æœºè‡ªåŠ¨æ‰“åŒ… , è§£åŒ… * è‡ªåŠ¨å°†åŸºç¡€ç±»å‹è½¬åŒ–ä¸ºå¯¹è±¡ * è‡ªåŠ¨å°†å¯¹è±¡è½¬æ¢ä¸ºåŸºç¡€ç±»å‹ * TestMap2.java &#125; ç¤ºä¾‹ç»ƒä¹  &#123; TestArgsWords.java &#125; JDK 1.5 æ³›å‹ èµ·å›  ï¼š JDK 1.4 ä»¥å‰ç±»å‹ä¸æ˜ç¡® è£…å…¥é›†åˆç±»å‹éƒ½è¢«å½“ä½œ Object å¯¹å¾…, ä»è€Œå¤±å»è‡ªå·±çš„å®é™…ç±»å‹ã€‚ ä»é›†åˆä¸­å–å‡ºæ—¶å¾€å¾€éœ€è¦è½¬å‹, æ•ˆç‡ä½, å®¹æ˜“äº§ç”Ÿé”™è¯¯ã€‚ è§£å†³åŠæ³• ï¼š åœ¨å®šä¹‰é›†åˆçš„æ—¶å€™åŒæ—¶å®šä¹‰é›†åˆä¸­å¯¹è±¡çš„ç±»å‹ ç¤ºä¾‹ ï¼š BasicGeneric.java å¯ä»¥åœ¨å®šä¹‰ Collection çš„æ—¶å€™æŒ‡å®š ä¹Ÿå¯ä»¥åœ¨å¾ªç¯æ—¶ç”¨ Iterator æŒ‡å®š å¥½å¤„ ï¼š å¢å¼ºç¨‹åºçš„å¯è¯»æ€§å’Œç¨³å®šæ€§ ä»€ä¹ˆæ—¶å€™å¯ä»¥æŒ‡å®šè‡ªå·±çš„ç±»å‹ ï¼š ä½ çœ‹ APIï¼Œ ä»–è·Ÿä½ å°±å¯ä»¥è·Ÿ æ€»ç»“ { 1136 ä¸€ä¸ªå›¾ ä¸€ä¸ªç±» Collections ä¸‰ä¸ªçŸ¥è¯†ç‚¹ For Generic Auto-boxing / unboxing å…­ä¸ªæ¥å£ {1, Collection {2, Set,3, List}4, Map5, Iterator6, Comparable} 8. IO æµèƒ½å¸®åŠ©ä½ å»ºç«‹æ–‡ä»¶ï¼Œä¸èƒ½å¸®ä½ å»ºç›®å½• è¯»åˆ°å†…å­˜åŒº - * è½¬æ¢æµ &#123; ä¸­æ–‡ windos ç¼–ç  JBK å½“å‰ç³»ç»Ÿé»˜è®¤çš„ ç¼–ç æ˜¯ JBK IOS8859_1 åŒ…å«çš„æ‰€æœ‰è¥¿æ¬§è¯­è¨€ --&gt; åæ¥æ‰æ¨å‡º UniCode (å›½é™…æ ‡å‡†åŒ–ç»„ç»‡ä¸ºäº†åŒ…å«å…¨çƒ) JBK JB2312 JB18030 ä¸œæ–¹äººè‡ªå·±çš„ç¼–ç  - å›½æ ‡ç  - å°±æ˜¯æ±‰å­—ï¼Œä½ å¯ä»¥è®¤ä¸º æ—¥æ–‡ï¼ŒéŸ©æ–‡ éƒ½æœ‰è‡ªå·±çš„ç¼–ç  - å°æ¹¾æœ‰è‡ªå·±çš„ å¤§äº”ç  æ‹‰ä¸1ï¼Œ 2ï¼Œ 3ï¼Œ 4ï¼Œ 5. 6. 7. 8. 9 éƒ½åŒæ„å•¦ï¼åŒ…æ‹¬ä¿„ç½—æ–¯ï¼Œ ä½†æ˜¯ä¸­æ–‡è¿˜ä¸è¡Œ ---- &gt; UniCode FileOutputStream() æ„é€ æ–¹æ³•è‡ªå·±å»æŸ¥ * System.in &#123; System ç±» -- in æ˜¯ InputStream ç±»å‹ public static final InputStream in æŠ½è±¡ç±» ç±»å‹ï¼Œ åˆæ˜¯çˆ¶ç±»å¼•ç”¨æŒ‡å‘å­ç±»å¯¹è±¡ InputStreamReader isr = new InputStreamReader(System.in); System.in -&gt; ç®¡é“ç›´æ¥å †åˆ°é»‘çª—å£ä¸Š BufferedReader br = new BufferedReader(isr); wait() è¿è¡Œå ï¼š ç­‰å¾…åœ¨é‚£ - é˜»å¡å¼çš„æ–¹æ³• å¾ˆå¤š readLine() æœ‰ç‚¹ç‰¹æ®Š å…¶å®æ˜¯ System.in æ¯”è¾ƒç‰¹æ®Š -- æ ‡å‡†è¾“å…¥ - ç­‰å¾…ç€æ ‡å‡†è¾“å…¥ &#123; ä½ ä¸è¾“å…¥ - æˆ‘å¯ä¸å°±ç­‰ç€ä¹ˆï¼Œå½“ç„¶è¿™ä¸ªä¹Ÿå«åšåŒæ­¥æ–¹æ³•ã€‚ ä½ ä¸è¾“å…¥ï¼Œæˆ‘å°±ä¸èƒ½å¹²åˆ«çš„ åŒæ­¥å¼çš„ &#125; * æ•°æ®æµ &#123; è¯·ä½ æŠŠ long ç±»å‹çš„æ•°ï¼Œ å†™åˆ° --&gt; æ–‡ä»¶é‡Œé¢å» readUTF() UTF8 æ¯”è¾ƒçœç©ºé—´ &#125; * æ‰“å°æµ &#123; System.out out - public static final PrintStream é»˜è®¤åœ¨æˆ‘ä»¬çš„é»‘çª—å£è¾“å‡º è¯­è¨€ä»£è¡¨äººçš„æ€ç»´ - èƒ½å¤Ÿä¿ƒè¿›äººçš„æ€ç»´ log4J è‘—åçš„æ—¥å¿—å¼€å‘åŒ… &#125; * Object æµ &#123; æŠŠæ•´ä¸ª Object å…¨éƒ¨å†™å…¥ç¡¬ç›˜è¢« åœ¨ VC ä¸Šå«åšç³»åˆ—åŒ– å­˜ç›˜ç‚¹ã€‚ æŒ¨ç€æ’çš„åºåˆ—åŒ– å†ä¸€ç‚¹ä¸€ç‚¹è¯»å‡ºæ¥ Serializable æ¥å£ --- æ ‡è®°æ€§çš„æ¥å£ transient int k = 15; ç›¸å½“äºè¿™ä¸ª k æ˜¯é€æ˜çš„ã€‚åœ¨åºåˆ—åŒ–çš„æ—¶å€™ä¸ç»™äºè€ƒè™‘ï¼Œè¯»çš„æ—¶å€™è¯»é»˜è®¤å€¼ã€‚ * Serializable æ¥å£ * Externalizable æ¥å£ extends Serializable &#125; }","categories":[{"name":"java","slug":"java","permalink":"http://iequa.com/categories/java/"}],"tags":[{"name":"java","slug":"java","permalink":"http://iequa.com/tags/java/"}]},{"title":"Trie Tree POJ 2001","slug":"leetcode/Trie_Tree-POJ-2001","date":"2013-01-17T10:06:21.000Z","updated":"2019-10-20T04:30:35.080Z","comments":true,"path":"2013/01/17/leetcode/Trie_Tree-POJ-2001/","link":"","permalink":"http://iequa.com/2013/01/17/leetcode/Trie_Tree-POJ-2001/","excerpt":"trie tree poj 2001 shortest prefixes","text":"trie tree poj 2001 shortest prefixes POJ 2001 Shortest Prefixes#include &lt;iostream&gt; #include &lt;string&gt; #include &lt;cstring&gt; #include &lt;cstdlib&gt; #include &lt;cstdio&gt; #include &lt;cmath&gt; #include &lt;vector&gt; #include &lt;stack&gt; #include &lt;deque&gt; #include &lt;queue&gt; #include &lt;bitset&gt; #include &lt;list&gt; #include &lt;map&gt; #include &lt;set&gt; #include &lt;iterator&gt; #include &lt;algorithm&gt; #include &lt;functional&gt; #include &lt;utility&gt; #include &lt;sstream&gt; #include &lt;climits&gt; #include &lt;cassert&gt; #define BUG puts(&quot;here!!!&quot;); using namespace std; const int N = 1010; const int kind = 26; char str[N][25]; struct Node &#123; int num; bool tail; Node* next[kind]; Node() : num(1), tail(false) &#123; memset(next, 0, sizeof(next)); &#125; &#125;; void insert(Node* root, char *s) &#123; Node* p = root; int i = 0, index; while(s[i]) &#123; index = s[i] - &#x27;a&#x27;; if(p-&gt;next[index] == NULL) &#123; p-&gt;next[index] = new Node(); &#125; else p-&gt;next[index]-&gt;num++; p = p-&gt;next[index]; i++; &#125; p-&gt;tail = true; &#125; void solve(Node* root, int count) &#123; for(int i = 0; i &lt; count; i++) &#123; Node* p = root; int len = strlen(str[i]); char* s = str[i]; cout &lt;&lt; s &lt;&lt; &#x27; &#x27;; for(int j = 0; j &lt; len; j++) &#123; cout &lt;&lt; s[j]; int index = s[j] - &#x27;a&#x27;; if(p-&gt;next[index]-&gt;num == 1) &#123; break; &#125; p = p-&gt;next[index]; &#125; cout &lt;&lt; endl; &#125; &#125; int main() &#123; Node* root = new Node(); // æ ¹èŠ‚ç‚¹ä¸åŒ…å«ä»»ä½•å­—ç¬¦ int i = 0, count = 0; while(scanf(&quot;%s&quot;, str[i]) == 1) &#123; insert(root, str[i]); i++; &#125; count = i; solve(root, count); return 0; &#125;","categories":[{"name":"icpc","slug":"icpc","permalink":"http://iequa.com/categories/icpc/"}],"tags":[{"name":"acm","slug":"acm","permalink":"http://iequa.com/tags/acm/"}]},{"title":"Union-Find Sets POJ 1703","slug":"leetcode/union-find_sets-POJ-1703","date":"2013-01-17T10:04:21.000Z","updated":"2019-10-20T04:30:35.081Z","comments":true,"path":"2013/01/17/leetcode/union-find_sets-POJ-1703/","link":"","permalink":"http://iequa.com/2013/01/17/leetcode/union-find_sets-POJ-1703/","excerpt":"union-find sets poj 1703 find them, catch them å¸®æ´¾ä¹‹äº‰","text":"union-find sets poj 1703 find them, catch them å¸®æ´¾ä¹‹äº‰ Find them, Catch themSample Input15 5A 1 2D 1 2A 1 2D 2 4A 1 4 Sample OutputNot sure yet.In different gangs.In the same gang. Code#include &lt;iostream&gt; #include &lt;string&gt; #include &lt;cstring&gt; #include &lt;cstdlib&gt; #include &lt;cstdio&gt; #include &lt;cmath&gt; #include &lt;vector&gt; #include &lt;stack&gt; #include &lt;deque&gt; #include &lt;queue&gt; #include &lt;bitset&gt; #include &lt;list&gt; #include &lt;map&gt; #include &lt;set&gt; #include &lt;iterator&gt; #include &lt;algorithm&gt; #include &lt;functional&gt; #include &lt;utility&gt; #include &lt;sstream&gt; #include &lt;climits&gt; #include &lt;cassert&gt; #define MID(x,y) ( ( x + y ) &gt;&gt; 1 ) #define L(x) ( x &lt;&lt; 1 ) #define R(x) ( x &lt;&lt; 1 | 1 ) #define BUG puts(&quot;here!!!&quot;); #define STOP system(&quot;pause&quot;); using namespace std; const int N = 100005; int f[N+N]; int n, m; int find(int x) &#123; if(f[x] &lt; 0) return x; return f[x] = find(f[x]); &#125; int main() &#123; int loop; cin &gt;&gt; loop; while(loop--) &#123; scanf(&quot;%d%d&quot;, &amp;n, &amp;m); memset(f, 255, sizeof(f)); while(m--) &#123; int a, b; char s[3]; scanf(&quot;%s%d%d&quot;, s, &amp;a, &amp;b); if(s[0] == &#x27;A&#x27;) &#123; if(find(a) != find(b) &amp;&amp; find(a) != find(b+n)) &#123; printf(&quot;Not sure yet.\\n&quot;); &#125; else if(find(a) == find(b)) &#123; printf(&quot;In the same gang.\\n&quot;); &#125; else printf(&quot;In different gangs.\\n&quot;); &#125; else &#123; if(find(a) != find(b+n)) &#123; f[find(a)] = find(b+n); f[find(b)] = find(a+n); &#125; &#125; &#125; &#125; return 0; &#125;","categories":[{"name":"icpc","slug":"icpc","permalink":"http://iequa.com/categories/icpc/"}],"tags":[{"name":"acm","slug":"acm","permalink":"http://iequa.com/tags/acm/"}]},{"title":"Union-Find Sets HDU 1856","slug":"leetcode/union-find_sets-hdu_1856","date":"2013-01-17T07:28:21.000Z","updated":"2019-10-20T04:30:35.083Z","comments":true,"path":"2013/01/17/leetcode/union-find_sets-hdu_1856/","link":"","permalink":"http://iequa.com/2013/01/17/leetcode/union-find_sets-hdu_1856/","excerpt":"union-find sets hdu 1856 more is better","text":"union-find sets hdu 1856 more is better More is better Mr Wang wants some boys to help him with a project. ... Sample Input 41 23 45 61 641 23 45 67 8 Sample Output 42 Code #include &lt;iostream&gt; #include &lt;string&gt; #include &lt;cstring&gt; #include &lt;cstdlib&gt; #include &lt;cstdio&gt; #include &lt;cmath&gt; #include &lt;vector&gt; #include &lt;stack&gt; #include &lt;deque&gt; #include &lt;queue&gt; #include &lt;bitset&gt; #include &lt;list&gt; #include &lt;map&gt; #include &lt;set&gt; #include &lt;iterator&gt; #include &lt;algorithm&gt; #include &lt;functional&gt; #include &lt;utility&gt; #include &lt;sstream&gt; #include &lt;climits&gt; #include &lt;cassert&gt; #define BUG puts(&quot;here!!!&quot;); using namespace std; const int N = 100005; struct Node &#123; int par; int sum; &#125;; int SUM; Node p[2*N + 5]; void makeSet(int n) &#123; for(int i = 0; i &lt;= 2*n; i++) &#123; p[i].par = i; p[i].sum = 1; &#125; SUM = 1; &#125; int find(int a) &#123; if(a == p[a].par) return a; return p[a].par = find(p[a].par); &#125; void union1(int a, int b) &#123; int fa = find(a); int fb = find(b); if(fa != fb) &#123; p[fa].par = fb; p[fb].sum += p[fa].sum; &#125; if(p[fb].sum &gt; SUM) &#123; SUM = p[fb].sum; &#125; &#125; int main() &#123; int n, a, b; while(scanf(&quot;%d&quot;, &amp;n) == 1) &#123; makeSet(n); while(n--) &#123; scanf(&quot;%d%d&quot;, &amp;a, &amp;b); union1(a, b); &#125; printf(&quot;%d\\n&quot;, SUM); &#125; return 0; &#125;","categories":[{"name":"icpc","slug":"icpc","permalink":"http://iequa.com/categories/icpc/"}],"tags":[{"name":"acm","slug":"acm","permalink":"http://iequa.com/tags/acm/"}]},{"title":"KMP / HDU 1711 æ‰¾åˆ°åŒ¹é…çš„ä½ç½®å¹¶è¿”å›","slug":"leetcode/kmp-for-hdu_1711","date":"2013-01-17T07:22:21.000Z","updated":"2019-10-20T04:30:35.082Z","comments":true,"path":"2013/01/17/leetcode/kmp-for-hdu_1711/","link":"","permalink":"http://iequa.com/2013/01/17/leetcode/kmp-for-hdu_1711/","excerpt":"kmp hdu 1711 number sequence","text":"kmp hdu 1711 number sequence DescriptionGiven two sequences of numbers : a[1], a[2], â€¦â€¦ , a[N], and b[1], b[2], â€¦â€¦ , b[M] (1 &lt;= M &lt;= 10000, 1 &lt;= N &lt;= 1000000). Your task is to find a number K which make a[K] = b[1], a[K + 1] = b[2], â€¦â€¦ , a[K + M â€“ 1] = b[M]. If there are more than one K exist, output the smallest one. InputThe first line of input is a number T which indicate the number of cases. Each case contains three lines. The first line is two numbers N and M (1 &lt;= M &lt;= 10000, 1 &lt;= N &lt;= 1000000). The second line contains N integers which indicate a[1], a[2], â€¦â€¦ , a[N]. The third line contains M integers which indicate b[1], b[2], â€¦â€¦ , b[M]. All integers are in the range of [-1000000, 1000000]. OutputFor each test case, you should output one line which only contain K described above. If no such K exists, output -1 instead. Sample Input213 51 2 1 2 3 1 2 3 1 3 2 1 21 2 3 1 313 51 2 1 2 3 1 2 3 1 3 2 1 21 2 3 2 1 Sample Output6-1 Code#include &lt;iostream&gt; #include &lt;string&gt; #include &lt;cstring&gt; #include &lt;cstdlib&gt; #include &lt;cstdio&gt; #include &lt;cmath&gt; #include &lt;vector&gt; #include &lt;stack&gt; #include &lt;deque&gt; #include &lt;queue&gt; #include &lt;bitset&gt; #include &lt;list&gt; #include &lt;map&gt; #include &lt;set&gt; #include &lt;iterator&gt; #include &lt;algorithm&gt; #include &lt;functional&gt; #include &lt;utility&gt; #include &lt;sstream&gt; #include &lt;climits&gt; #include &lt;cassert&gt; #define BUG puts(&quot;here!!!&quot;); using namespace std; const int N = 1000005; const int M = 10005; int s[N]; int t[M]; int next[M]; void getNext(int len) &#123; int i, j; i = 0, j = -1; next[0] = -1; while(i &lt; len-1) &#123; if(j == -1 || t[i] == t[j]) &#123; i++, j++, next[i] = j; &#125; else &#123; j = next[j]; &#125; &#125; &#125; int kmp(int sl, int tl) &#123; int i = 0, j = 0; while(i &lt; sl &amp;&amp; j &lt; tl) &#123; if(j == -1 || s[i] == t[j]) &#123; i++, j++; &#125; else j = next[j]; &#125; if(j == tl) return i-j+1; else return -1; &#125; // abcabcababcabcabdef // abcabcabd int main() &#123; int T, n, m, ans; cin &gt;&gt; T; while(T--) &#123; cin &gt;&gt; n &gt;&gt; m; for(int i = 0; i &lt; n; i++) &#123; scanf(&quot;%d&quot;, s+i); &#125; for(int i = 0; i &lt; m; i++) &#123; scanf(&quot;%d&quot;, t+i); &#125; getNext(m); ans = kmp(n, m); cout &lt;&lt; ans &lt;&lt; endl; &#125; return 0; &#125;","categories":[{"name":"icpc","slug":"icpc","permalink":"http://iequa.com/categories/icpc/"}],"tags":[{"name":"acm","slug":"acm","permalink":"http://iequa.com/tags/acm/"}]},{"title":"éœ€è¦çš„æ°”è´¨å“æ ¼","slug":"tools/being-eq-gentleman","date":"2013-01-16T22:24:16.000Z","updated":"2019-10-20T04:30:34.995Z","comments":true,"path":"2013/01/17/tools/being-eq-gentleman/","link":"","permalink":"http://iequa.com/2013/01/17/tools/being-eq-gentleman/","excerpt":"åšä¸€ä¸ª æˆç†Ÿã€ç»…å£«ã€ç¨³é‡ çš„äººï¼Œæˆ‘æœ€è¿‘è¶Šæ¥è¶Šè§‰å¾—å®ƒéå¸¸éå¸¸éå¸¸é‡è¦â€¦","text":"åšä¸€ä¸ª æˆç†Ÿã€ç»…å£«ã€ç¨³é‡ çš„äººï¼Œæˆ‘æœ€è¿‘è¶Šæ¥è¶Šè§‰å¾—å®ƒéå¸¸éå¸¸éå¸¸é‡è¦â€¦ ä¸€ï¼šæ²‰ç¨³ï¼ˆ1ï¼‰ä¸è¦éšä¾¿æ˜¾éœ²ä½ çš„æƒ…ç»ªã€‚ï¼ˆ2ï¼‰ä¸è¦é€¢äººå°±è¯‰è¯´ä½ çš„å›°éš¾å’Œé­é‡ã€‚ï¼ˆ3ï¼‰åœ¨å¾è¯¢åˆ«äººçš„æ„è§ä¹‹å‰ï¼Œè‡ªå·±å…ˆæ€è€ƒï¼Œä½†ä¸è¦å…ˆè®²ã€‚ï¼ˆ4ï¼‰ä¸è¦ä¸€æœ‰æœºä¼šå°±å” å¨ä½ çš„ä¸æ»¡ã€‚ï¼ˆ5ï¼‰é‡è¦çš„å†³å®šå°½é‡æœ‰åˆ«äººå•†é‡ï¼Œæœ€å¥½éš”ä¸€å¤©å†å‘å¸ƒã€‚ï¼ˆ6ï¼‰è®²è¯ä¸è¦æœ‰ä»»ä½•çš„æ…Œå¼ ï¼Œèµ°è·¯ä¹Ÿæ˜¯ã€‚ äºŒï¼šç»†å¿ƒï¼ˆ1ï¼‰å¯¹èº«è¾¹å‘ç”Ÿçš„äº‹æƒ…ï¼Œå¸¸æ€è€ƒå®ƒä»¬çš„å› æœå…³ç³»ã€‚ï¼ˆ2ï¼‰å¯¹åšä¸åˆ°ä½çš„æ‰§è¡Œé—®é¢˜ï¼Œè¦å‘æ˜å®ƒä»¬çš„æ ¹æœ¬ç—‡ç»“ã€‚ï¼ˆ3ï¼‰å¯¹ä¹ ä»¥ä¸ºå¸¸çš„åšäº‹æ–¹æ³•ï¼Œè¦æœ‰æ”¹è¿›æˆ–ä¼˜åŒ–çš„å»ºè®®ã€‚ï¼ˆ4ï¼‰åšä»€ä¹ˆäº‹æƒ…éƒ½è¦å…»æˆæœ‰æ¡ä¸ç´Šå’Œäº•ç„¶æœ‰åºçš„ä¹ æƒ¯ã€‚ï¼ˆ5ï¼‰ç»å¸¸å»æ‰¾å‡ ä¸ªåˆ«äººçœ‹ä¸å‡ºæ¥çš„æ¯›ç—…æˆ–å¼Šç«¯ã€‚ï¼ˆ6ï¼‰è‡ªå·±è¦éšæ—¶éšåœ°å¯¹æœ‰æ‰€ä¸è¶³çš„åœ°æ–¹è¡¥ä½ã€‚ ä¸‰ï¼šèƒ†è¯†ï¼ˆ1ï¼‰ä¸è¦å¸¸ç”¨ç¼ºä¹è‡ªä¿¡çš„è¯å¥ï¼ˆ2ï¼‰ä¸è¦å¸¸å¸¸åæ‚”ï¼Œè½»æ˜“æ¨ç¿»å·²ç»å†³å®šçš„äº‹ã€‚ï¼ˆ3ï¼‰åœ¨ä¼—äººäº‰æ‰§ä¸ä¼‘æ—¶ï¼Œä¸è¦æ²¡æœ‰ä¸»è§ã€‚ï¼ˆ4ï¼‰æ•´ä½“æ°›å›´ä½è½æ—¶ï¼Œä½ è¦ä¹è§‚ã€é˜³å…‰ã€‚ï¼ˆ5ï¼‰åšä»»ä½•äº‹æƒ…éƒ½è¦ç”¨å¿ƒï¼Œå› ä¸ºæœ‰äººåœ¨çœ‹ç€ä½ ã€‚ï¼ˆ6ï¼‰äº‹æƒ…ä¸é¡ºçš„æ—¶å€™ï¼Œæ­‡å£æ°”ï¼Œé‡æ–°å¯»æ‰¾çªç ´å£ï¼Œå°±ç»“æŸä¹Ÿè¦å¹²å‡€åˆ©è½ã€‚ å››ï¼šå¤§åº¦ï¼ˆ1ï¼‰ä¸è¦åˆ»æ„æŠŠæœ‰å¯èƒ½æ˜¯ä¼™ä¼´çš„äººå˜æˆå¯¹æ‰‹ã€‚ï¼ˆ2ï¼‰å¯¹åˆ«äººçš„å°è¿‡å¤±ã€å°é”™è¯¯ä¸è¦æ–¤æ–¤è®¡è¾ƒã€‚ï¼ˆ3ï¼‰åœ¨é‡‘é’±ä¸Šè¦å¤§æ–¹ï¼Œå­¦ä¹ ä¸‰æ–½ï¼ˆè´¢æ–½ã€æ³•æ–½ã€æ— ç•æ–½ï¼‰ï¼ˆ4ï¼‰ä¸è¦æœ‰æƒåŠ›çš„å‚²æ…¢å’ŒçŸ¥è¯†çš„åè§ã€‚ï¼ˆ5ï¼‰ä»»ä½•æˆæœå’Œæˆå°±éƒ½åº”å’Œåˆ«äººåˆ†äº«ã€‚ï¼ˆ6ï¼‰å¿…é¡»æœ‰äººç‰ºç‰²æˆ–å¥‰çŒ®çš„æ—¶å€™ï¼Œè‡ªå·±èµ°åœ¨å‰é¢ã€‚ äº”ï¼šè¯šä¿¡ï¼ˆ1ï¼‰åšä¸åˆ°çš„äº‹æƒ…ä¸è¦è¯´ï¼Œè¯´äº†å°±åŠªåŠ›åšåˆ°ã€‚ï¼ˆ2ï¼‰è™šçš„å£å·æˆ–æ ‡è¯­ä¸è¦å¸¸æŒ‚å˜´ä¸Šã€‚ï¼ˆ3ï¼‰é’ˆå¯¹å®¢æˆ·æå‡ºçš„â€œä¸è¯šä¿¡â€é—®é¢˜ï¼Œæ‹¿å‡ºæ”¹å–„çš„æ–¹æ³•ã€‚ï¼ˆ4ï¼‰åœæ­¢ä¸€åˆ‡â€œä¸é“å¾·â€çš„æ‰‹æ®µã€‚ï¼ˆ5ï¼‰è€å¼„å°èªæ˜ï¼Œè¦ä¸å¾—ï¼ï¼ˆ6ï¼‰è®¡ç®—ä¸€ä¸‹äº§å“æˆ–æœåŠ¡çš„è¯šä¿¡ä»£ä»·ï¼Œé‚£å°±æ˜¯å“ç‰Œæˆæœ¬ã€‚ å…­ï¼šæ‹…å½“ï¼ˆ1ï¼‰æ£€è®¨ä»»ä½•è¿‡å¤±çš„æ—¶å€™ï¼Œå…ˆä»è‡ªèº«æˆ–è‡ªå·±äººå¼€å§‹åçœã€‚ï¼ˆ2ï¼‰äº‹é¡¹ç»“æŸåï¼Œå…ˆå®¡æŸ¥è¿‡é”™ï¼Œå†åˆ—è¿°åŠŸåŠ³ã€‚ï¼ˆ3ï¼‰è®¤é”™ä»ä¸Šçº§å¼€å§‹ï¼Œè¡¨åŠŸä»ä¸‹çº§å¯åŠ¨.ï¼ˆ4ï¼‰ç€æ‰‹ä¸€ä¸ªè®¡åˆ’ï¼Œå…ˆå°†æƒè´£ç•Œå®šæ¸…æ¥šï¼Œè€Œä¸”åˆ†é…å¾—å½“ã€‚ï¼ˆ5ï¼‰å¯¹â€œæ€•äº‹â€çš„äººæˆ–ç»„ç»‡è¦æŒ‘æ˜äº†è¯´ã€‚ï¼ˆ6ï¼‰å› ä¸ºå‹‡äºæ‰¿æ‹…è´£ä»»æ‰€é€ æˆçš„æŸå¤±ï¼Œå…¬å¸åº”è¯¥æ‰¿æ‹… Reference è½¬è‡ªç½‘ç»œ","categories":[{"name":"tools","slug":"tools","permalink":"http://iequa.com/categories/tools/"}],"tags":[{"name":"life","slug":"life","permalink":"http://iequa.com/tags/life/"}]},{"title":"Linux Cè¯­è¨€çš„ä¸€äº›çŸ¥è¯†å­¦ä¹ ","slug":"leetcode/linux-c","date":"2012-05-19T02:54:16.000Z","updated":"2019-10-20T04:30:35.084Z","comments":true,"path":"2012/05/19/leetcode/linux-c/","link":"","permalink":"http://iequa.com/2012/05/19/leetcode/linux-c/","excerpt":"Linux Cè¯­è¨€çš„ä¸€äº›çŸ¥è¯†, æ¶‰åŠ è®¡ç®—æœºç¨‹åºï¼Œè¯­è¨€å‘å±•ï¼Œç¼–è¯‘é“¾æ¥ï¼Œæ•°æ®ï¼Œå‡½æ•°åº“ç­‰ç­‰.","text":"Linux Cè¯­è¨€çš„ä¸€äº›çŸ¥è¯†, æ¶‰åŠ è®¡ç®—æœºç¨‹åºï¼Œè¯­è¨€å‘å±•ï¼Œç¼–è¯‘é“¾æ¥ï¼Œæ•°æ®ï¼Œå‡½æ•°åº“ç­‰ç­‰. 1. ç¨‹åº ä»€ä¹ˆæ˜¯ç¨‹åºï¼Ÿ ç¨‹åºçš„ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿ æˆ‘ä»¬å¿…é¡»é€šè¿‡æŒ‡ä»¤ï¼ŒæŒ‡æŒ¥è®¡ç®—æœºæ‰§è¡Œæˆ‘ä»¬æƒ³è¦å®ƒåšçš„åŠ¨ä½œã€‚ è€Œä¾ç…§é¡ºåºæ‰§è¡Œçš„ä¸€ç»„æŒ‡ä»¤å°±æ˜¯ç¨‹åºã€‚ 1.1 ç¨‹åºç‰¹å¾1, ç¨‹åºæ˜¯ä¸è®¡ç®—æœºæ²Ÿé€šçš„è¯­è¨€2, ç¨‹åºæ˜¯ç”±ç‰¹å®šè¯­æ³•ä¸å…³é”®å­—æ„æˆ3, ç¨‹åºæ˜¯ä¸€è¡Œä¸€è¡Œæ‰§è¡Œçš„4, ç¨‹åºçš„æ‰§è¡Œ, ä»å…¥å£ç‚¹å¼€å§‹, åŸåˆ™ä¸Šæ˜¯ç”±ä¸Šè€Œä¸‹, ä»å·¦è€Œå³æ‰§è¡Œã€‚ å…¥å£ç‚¹å¯èƒ½æ˜¯ä¸€ä¸ªæ–¹æ³•æˆ–è€…æ˜¯å‡½æ•°ã€‚ã€‚ã€‚ 2. ç¨‹åºè¯­è¨€çš„æ¼”åŒ–1, æœºå™¨è¯­è¨€ â€” è®¡ç®—æœºé€šè¿‡ç”µä¿¡å·æ¨¡å¼ 0/1/0/1â€¦å¼€å…³å¼€å…³â€¦2, æ±‡ç¼–è¯­è¨€3, é«˜çº§è¯­è¨€4, ç¬¬å››ä»£è¯­è¨€5, è‡ªç„¶è¯­è¨€ â€” æ™ºèƒ½è¯­è¨€ï¼Œå¼€æœºï¼Œå®ƒå°±å¼€æœºã€‚å…³æœºï¼Œå®ƒå°±å…³æœºã€‚ 2.1 æœºå™¨è¯­è¨€ 1, æ˜¯è®¡ç®—æœºå”¯ä¸€èƒ½å¤Ÿæ‰§è¡Œçš„è¯­è¨€ã€‚ 2, å…¶ä»–è¯­è¨€å¿…é¡»å…ˆè½¬åŒ–ä¸ºæœºå™¨è¯­è¨€ 3, æŒ‡ä»¤æœ‰ 0 ä¸ 1 ç»„æˆ, ç§°ä¸ºæœºå™¨ç ã€‚ 4, æŒ‡ä»¤éš¾è®°å¿†ä½†æ‰§è¡Œé€Ÿåº¦æœ€å¿«ã€‚ 5, ä¸åŒç±»å‹æœºå™¨æœ‰ä¸åŒçš„æœºå™¨ç , ä¸å…·å¤‡ç§»æ¤æ€§ã€‚ 2.2 é«˜çº§è¯­è¨€ 1, ç¦»æœºå™¨è¶Šæ¥è¶Šè¿œ 2, è¯­æ³•æ¥è¿‘äººç±»çš„è‡ªç„¶è¯­è¨€ 3, æ‰§è¡Œçš„å•ä½ä¸æ˜¯æŒ‡ä»¤, è€Œæ˜¯è¯­å¥, ä¸€è¡Œè¯­å¥ã€‚ 4, å¼€å‘æ•ˆç‡è¶Šæ¥è¶Šé«˜ã€‚ 5, å¿…é¡»ç¼–è¯‘æˆæœºå™¨ç  6, ç§»æ¤æ€§æ¯”è¾ƒå¥½ã€‚ 2.3 ç¬¬å››ä»£è¯­è¨€ 1, 4GL, ä¹Ÿç§°ä¸ºé¢å‘é—®é¢˜çš„ç¨‹åºè¯­è¨€ã€‚ 2, ä»…éœ€å‘Šè¯‰è®¡ç®—æœº â€œåšä»€ä¹ˆâ€, ä¸éœ€è¦æŒ‡æŒ¥è®¡ç®—æœºâ€å¦‚ä½•åšâ€ 3, å¤§å¤§æé«˜å¼€å‘æ•ˆç‡ 4, å¦‚ SQL è¯­è¨€åŠå„ç§æŸ¥è¯¢è¯­è¨€ã€‚ 2.4 è‡ªç„¶è¯­è¨€ 1, è¿ç”¨äººå·¥æ™ºèƒ½, ä»¥æ¥è¿‘å£è¯­çš„æŒ‡ä»¤æŒ‡æŒ¥è®¡ç®—æœºï¼Œå¦‚è¯­éŸ³ã€‚ 2, è¿˜æ²¡æœ‰æˆç†Ÿã€‚ 3. ç¼–è¯‘ä¸é“¾æ¥3.1 ç¼–è¯‘ 1, æŠŠæºä»£ç è½¬åŒ–æˆæœºå™¨ç çš„è¿‡ç¨‹ã€‚ 2, ä¹‹å‰è¿˜ä¼šè¿›è¡Œå‰æœŸå¤„ç†ã€‚ 3, è¿‡ç¨‹ä¸­ä¼šè¿›è¡Œè¯­æ³•æ£€æŸ¥ã€‚ 4, ç¼–è¯‘å™¨ : å®Œæˆç¼–è¯‘åŠ¨ä½œçš„ç¨‹åº 3.2 è¿æ¥ 1, å°†å¯æ‰§è¡Œæ–‡ä»¶ä¸åŒ…å«æ–‡ä»¶ / ç”¨åˆ°çš„å‡½æ•°åº“å»ºç«‹å…³è”çš„è¿‡ç¨‹ã€‚ 4. åŸºæœ¬æ¦‚å¿µ4.1 æ•°æ® æ˜¯è®¡ç®—æœºç¨‹åºå¤„ç†çš„å¯¹è±¡, å¯ä»¥æ˜¯æ•´æ•°, å®æ•°, å­—ç¬¦, ä¹Ÿå¯ä»¥æ˜¯å›¾åƒ, å£°éŸ³ç­‰çš„ç¼–ç è¡¨ç¤ºã€‚ 4.2 æ•°æ®ç»“æ„ æŒ‡çš„æ˜¯æ•°æ®ä¸æ•°æ®é—´å­˜åœ¨ä¸€ç§æˆ–å¤šç§ç‰¹å®šå…³ç³»ã€‚ ä¸æ•°æ®ç»“æ„å¯†åˆ‡ç›¸å…³çš„ä¾¿æ˜¯æ•°æ®çš„ç±»å‹å’Œæ•°æ®çš„å­˜æ”¾ã€‚ ç¨‹åºè®¾è®¡ ç¼–å†™ç¨‹åºçš„è¿‡ç¨‹ã€‚ è½¯ä»¶ ç¨‹åº + æ–‡æ¡£ã€‚ 5. Linux C æ¦‚è¿°Linux å’Œ C å¤©ç”Ÿæœ‰ä¸è§£ä¹‹æº, Linux çš„æ“ä½œç³»ç»Ÿå†…æ ¸å°±ä¸»è¦æ˜¯ç”¨ C å†™çš„, å¦å¤– Linux ä¸‹çš„å¾ˆå¤šè½¯ä»¶ä¹Ÿæ˜¯ç”¨ C å†™çš„ï¼Œç‰¹åˆ«æ˜¯ä¸€äº›è‘—åçš„æœåŠ¡è½¯ä»¶, å¦‚ä½• MySQL, Apache ç­‰ã€‚ 5.1 å¼€å‘ç¯å¢ƒçš„æ„æˆ1, ç¼–è¾‘å™¨ ï¼š é€‰æ‹© VI2, ç¼–è¯‘å™¨ ï¼š é€‰æ‹© GNU C/C++ ç¼–è¯‘å™¨ gcc (å…è´¹å¼€æºçš„å·¥å…· - linuxå‘å‹ç‰ˆæœ¬å¤šæ•°éƒ½è‡ªåŠ¨å®‰è£…)3, è°ƒè¯•å™¨ ï¼š åº”ç”¨å¹¿æ³›çš„ gdb (JDK å­¦ä¹ çš„ GDB)4, å‡½æ•°åº“ ï¼š glibc5, ç³»ç»Ÿå¤´æ–‡ä»¶ ï¼š glibc_header 5.2 ç¼–è¯‘å™¨ gccgcc (GNU CCompiler) æ˜¯GNUæ¨å‡ºçš„åŠŸèƒ½å¼ºå¤§ , æ€§èƒ½ä¼˜è¶Šçš„å¤šå¹³å°ç¼–è¯‘å™¨, gcc ç¼–è¯‘å™¨èƒ½å°†C , C++è¯­è¨€æºç¨‹åºç¼–è¯‘, è¿æ¥æˆå¯æ‰§è¡Œæ–‡ä»¶, ä»¥ä¸‹æ˜¯ gcc æ”¯æŒç¼–è¯‘çš„ä¸€äº›æºæ–‡ä»¶çš„åç¼€åŠå…¶è§£é‡Šã€‚ .c ä¸ºåç¼€çš„æ–‡ä»¶, Cè¯­è¨€æºä»£ç æ–‡ä»¶.h ä¸ºåç¼€çš„æ–‡ä»¶, æ˜¯ç¨‹åºæ‰€åŒ…å«çš„å¤´æ–‡ä»¶ã€‚.i ä¸ºåç¼€çš„æ–‡ä»¶, æ˜¯å·²ç»é¢„å¤„ç†è¿‡çš„ C æºä»£ç æ–‡ä»¶;.o ä¸ºåç¼€çš„æ–‡ä»¶, æ˜¯ç¼–è¯‘åçš„ç›®æ ‡æ–‡ä»¶ã€‚.s ä¸ºåç¼€çš„æ–‡ä»¶, æ˜¯æ±‡ç¼–è¯­è¨€æºä»£ç æ–‡ä»¶ã€‚ gcc -o hello hello.c ç”¨ gcc æ¥ç¼–è¯‘æˆ‘ä»¬çš„æºç¨‹åº -o é€‰é¡¹è¦æ±‚ç¼–è¯‘å™¨ç»™æˆ‘ä»¬è¾“å‡ºçš„å¯æ‰§è¡Œæ–‡ä»¶åä¸º hello hello.c æ˜¯æˆ‘ä»¬çš„æºç¨‹åºæ–‡ä»¶ã€‚ -c é€‰é¡¹ è¡¨ç¤ºæˆ‘ä»¬åªè¦æ±‚ç¼–è¯‘å™¨è¾“å‡ºç›®æ ‡ä»£ç , è€Œä¸å¿…è¦è¾“å‡ºå¯æ‰§è¡Œæ–‡ä»¶ -g é€‰é¡¹è¡¨ç¤ºæˆ‘ä»¬è¦æ±‚ç¼–è¯‘å™¨åœ¨ç¼–è¯‘çš„æ—¶å€™æä¾›æˆ‘ä»¬ä»¥åå¯¹ç¨‹åºè¿›è¡Œè°ƒè¯•çš„ä¿¡æ¯ã€‚ æ‰§è¡Œ ./hello å°±å¯ä»¥çœ‹åˆ°ç¨‹åºçš„è¾“å‡ºç»“æ„ã€‚ (åœ¨å½“å‰ç›®å½•ä¸‹å»æ‰¾) 5.3 å‡½æ•°åº“ glibcè¦æ„å»ºä¸€ä¸ªå®Œæ•´çš„ C å¼€å‘ç¯å¢ƒ, Glibc æ˜¯å¿…ä¸å¯å°‘çš„, å®ƒæ˜¯ Linux ä¸‹ C çš„ä¸»è¦å‡½æ•°åº“. glibc æœ‰ä¸¤ç§å®‰è£…æ–¹å¼ï¼š A. å®‰è£…æˆæµ‹è¯•ç”¨çš„å‡½æ•°åº“, åœ¨ç¼–è¯‘ç¨‹åºæ—¶ç”¨ä¸åŒçš„é€‰é¡¹æ¥è¯•ç”¨æ–°çš„å‡½æ•°åº“ã€‚ B. å®‰è£…æˆä¸»è¦çš„ C å‡½æ•°åº“, æ‰€æœ‰æ–°ç¼–è¯‘ç¨‹åºå‡ç”¨çš„å‡½æ•°åº“ glibc å«å‡ ä¸ªé™„åŠ åŒ… : Linuxthreadsï¼Œ localedate å’Œ cryptï¼Œ ä»–ä»¬çš„æ–‡ä»¶åéšç‰ˆæœ¬çš„ä¸åŒè€Œç±»ä¼¼äºä¸‹åˆ— ï¼š glibc-2.06.tar.gzglibc-linuxthreads-2.0.6.tar.gzglibc-localedate-2.0.6.tar.gzglibc-crypt-2.0.6.tar.gz glibc æ˜¯æä¾›ç³»ç»Ÿè°ƒç”¨å’ŒåŸºæœ¬å‡½æ•°çš„ï¼£åº“, æ¯”å¦‚ open, malloc, printf ç­‰ç­‰ã€‚ æ‰€æœ‰åŠ¨æ€è¿æ¥çš„ç¨‹åºéƒ½è¦ç”¨åˆ°å®ƒ. ç³»ç»Ÿå¤´æ–‡ä»¶ ï¼š glibc_header ç¼ºå°‘ç³»ç»Ÿå¤´æ–‡ä»¶ï¼Œå¾ˆå¤šç”¨åˆ°ç³»ç»ŸåŠŸèƒ½çš„Cç¨‹åºå°†æ— æ³•ç¼–è¯‘ã€‚ å¦‚æœç”¨æˆ·åœ¨å®‰è£…è¿‡ç¨‹ä¸­å°‘è£…äº†è¿™äº›åŒ…ï¼Œå°±ä¼šæ— æ³•ç¼–è¯‘Cç¨‹åºï¼Œè§£å†³æ–¹æ³•ï¼š æ–¹æ³•ä¸€ï¼šä¸æ¨èï¼šé‡è£…ä¸€éLinuxç³»ç»Ÿã€‚ æ–¹æ³•äºŒï¼šé€šè¿‡æ‰¾ä¸€äº›RpmåŒ…æ¥è¿…é€Ÿå®‰è£…Linuxçš„Cå¼€å‘ç¯å¢ƒã€‚ Cå¼€å‘ç¯å¢ƒå¯¹åº”çš„rpmåŒ… ç”±äºgccåŒ…éœ€ä¾èµ– binutilså’ŒcppåŒ…ï¼Œå¦å¤–makeåŒ…ä¹Ÿæ˜¯åœ¨ç¼–è¯‘ä¸­å¸¸ç”¨çš„ï¼Œæ‰€ä»¥ä¸€å…±éœ€è¦8ä¸ªåŒ…æ¥å®Œæˆå®‰è£…ï¼Œå®ƒä»¬æ˜¯ï¼š cpp-2.96-110.i386.rpmbinutils-2.11.93.0.2-11. i386.rpmGlibc-2.2.5-31. i386.rpmGlibc-kernheaders-2.4-7.14. i386.rpmGlibc-common-2.2.5-34Glibc-devel-2.2.5-34- i386.rpmGcc-2.96-110.i386.rpmMake-3.79.1-8. i386.rpm æŸ¥çœ‹glibcçš„ç‰ˆæœ¬ï¼šls /lib/libc-*æŸ¥çœ‹gccç‰ˆæœ¬å·ï¼š gcc â€“version 5.4 C ç¨‹åºçš„ç»„æˆå¯¹äºä¸€ä¸ª C ç¨‹åº, å®‰è£…å®Œæˆåå¯ä»¥åˆ†æˆä¸‰ä¸ªç»„æˆ ï¼š å¯æ‰§è¡Œæ–‡ä»¶ åŒ…å«æ–‡ä»¶ åº“æ–‡ä»¶ å¯æ‰§è¡Œæ–‡ä»¶æ˜¯æœ€ç»ˆè¿è¡Œçš„å‘½ä»¤, åŒ…å«æ–‡ä»¶æ˜¯è¯¥ C ç¨‹åº include çš„å®šä¹‰æ–‡ä»¶, åº“æ–‡ä»¶åˆ™æ˜¯è¯¥ C ç¨‹åºè‡ªå®šä¹‰çš„åº“ã€‚ æ¯”å¦‚ç”¨ RPM å®‰è£…çš„ Mysql æ•°æ®åº“ ï¼š å¯æ‰§è¡Œæ–‡ä»¶æ”¾åœ¨ /usr/bin ä¸‹ åŒ…å«æ–‡ä»¶æ”¾åœ¨ /usr/include/mysql ä¸‹ åº“æ–‡ä»¶åœ¨ /usr/lib/mysql ä¸‹ åªæœ‰ç³»ç»Ÿå¯ä»¥æ‰¾åˆ°ç¨‹åºå¯¹åº”çš„åŒ…å«æ–‡ä»¶å’Œåº“æ–‡ä»¶, ç¨‹åºå¯æ‰§è¡Œæ–‡ä»¶æ‰èƒ½æ­£å¸¸è¿è¡Œã€‚ 6. å°ç»“ å¼€å‘ç¯å¢ƒçš„æ„æˆ GNU çš„ gcc ç¼–è¯‘å™¨ glibc å‡½æ•°åº“ Linux ä¸‹ C ç¨‹åºå¼€å‘è¿‡ç¨‹ ç¬¬ä¸€ä¸ª C ç¨‹åº C ç¨‹åºç»“æ„","categories":[{"name":"icpc","slug":"icpc","permalink":"http://iequa.com/categories/icpc/"}],"tags":[{"name":"Linux_C","slug":"Linux-C","permalink":"http://iequa.com/tags/Linux-C/"}]},{"title":"å­¦ç”¨ g++ (åˆæ­¥)","slug":"leetcode/g++","date":"2012-03-22T02:54:16.000Z","updated":"2019-10-20T04:30:35.081Z","comments":true,"path":"2012/03/22/leetcode/g++/","link":"","permalink":"http://iequa.com/2012/03/22/leetcode/g++/","excerpt":"gcc å’Œ g++ éƒ½æ˜¯GNU(ç»„ç»‡)çš„ä¸€ä¸ªç¼–è¯‘å™¨.","text":"gcc å’Œ g++ éƒ½æ˜¯GNU(ç»„ç»‡)çš„ä¸€ä¸ªç¼–è¯‘å™¨. é“¾æ¥åº“åŠ¨æ€é“¾æ¥åº“ (é€šå¸¸ä»¥ .so ç»“å°¾) å’Œ é™æ€é“¾æ¥åº“ (é€šå¸¸ä»¥ .a ç»“å°¾) ä¸¤è€…çš„å·®åˆ«ä»…åœ¨ç¨‹åºæ‰§è¡Œæ—¶æ‰€éœ€çš„ä»£ç æ˜¯åœ¨è¿è¡Œæ—¶åŠ è½½çš„, è¿˜æ˜¯åœ¨ç¼–è¯‘æ—¶åŠ è½½çš„, é»˜è®¤æƒ…å†µä¸‹, g++ åœ¨é“¾æ¥æ—¶ä¼˜å…ˆä½¿ç”¨åŠ¨æ€é“¾æ¥åº“, åªæœ‰å½“åŠ¨æ€é“¾æ¥åº“ä¸å­˜åœ¨æ—¶æ‰è€ƒè™‘ä½¿ç”¨é™æ€é“¾æ¥åº“. å¦‚æœéœ€è¦çš„è¯å¯ä»¥åœ¨ç¼–è¯‘æ—¶åŠ ä¸Š -static é€‰é¡¹, å¼ºåˆ¶ä½¿ç”¨é™æ€é“¾æ¥åº“ã€‚ g++ foo.cpp -L /home/xiaowp/lib -static -lfoo -o foo ä»£ç ä¼˜åŒ–ä»£ç ä¼˜åŒ–æŒ‡çš„æ˜¯ç¼–è¯‘å™¨ç”¨è¿‡åˆ†ææºä»£ç , æ‰¾å‡ºå…¶ä¸­å°šæœªè¾¾åˆ°æœ€ä¼˜çš„éƒ¨åˆ†, ç„¶åå¯¹å…¶é‡æ–°è¿›è¡Œç»„åˆ, ç›®çš„æ˜¯æ”¹å–„ç¨‹åºçš„æ‰§è¡Œæ€§èƒ½. g++ é€šè¿‡ç¼–è¯‘é€‰é¡¹ -On æ¥æ§åˆ¶ä¼˜åŒ–ä»£ç çš„ç”Ÿæˆ (n ä¸€èˆ¬ 0 ~ 2,3) å­¦ç”¨ g++GCC (GNC Compiler Collection) æ˜¯ linux ä¸‹æœ€ä¸»è¦çš„ç¼–è¯‘å·¥å…·, GCC ä¸ä»…åŠŸèƒ½å¼ºå¤§, ç»“æ„ä¹Ÿå¼‚å¸¸çµæ´». g++ æ˜¯ gcc ä¸­çš„ä¸€ä¸ªå·¥å…·, ä¸“é—¨æ¥ç¼–è¯‘ C++ è¯­è¨€çš„ã€‚ $ g++ hello.cpp -o hello (hello æ˜¯ç¼–è¯‘æˆçš„å¯æ‰§è¡Œæ–‡ä»¶)$ ./hello (è¿è¡Œ hello)","categories":[{"name":"icpc","slug":"icpc","permalink":"http://iequa.com/categories/icpc/"}],"tags":[{"name":"g++","slug":"g","permalink":"http://iequa.com/tags/g/"}]},{"title":"å¯„å­˜å™¨, å†…å­˜, å­˜å‚¨å™¨, Cache çš„åŒºåˆ«","slug":"devops/linux-computer-memory","date":"2012-03-18T02:54:16.000Z","updated":"2019-10-20T04:30:34.992Z","comments":true,"path":"2012/03/18/devops/linux-computer-memory/","link":"","permalink":"http://iequa.com/2012/03/18/devops/linux-computer-memory/","excerpt":"è®¡ç®—æœºå­˜å‚¨ä¸­çš„ å¯„å­˜å™¨ å†…å­˜ å­˜å‚¨å™¨ cacheåŒºåˆ«ï¼Œ ä»èŒƒå›´æ¥çœ‹ï¼Œå®ƒä»¬æ‰€æŒ‡çš„èŒƒç•´å°±ä¸ä¸€æ ·ã€‚","text":"è®¡ç®—æœºå­˜å‚¨ä¸­çš„ å¯„å­˜å™¨ å†…å­˜ å­˜å‚¨å™¨ cacheåŒºåˆ«ï¼Œ ä»èŒƒå›´æ¥çœ‹ï¼Œå®ƒä»¬æ‰€æŒ‡çš„èŒƒç•´å°±ä¸ä¸€æ ·ã€‚ å¯„å­˜å™¨ä¸­å¤®å¤„ç†å™¨å†…çš„ç»„æˆéƒ¨ä»½ã€‚å®ƒè·ŸCPUæœ‰å…³ã€‚å¯„å­˜å™¨æ˜¯æœ‰é™å­˜è´®å®¹é‡çš„é«˜é€Ÿå­˜è´®éƒ¨ä»¶ï¼Œå®ƒä»¬å¯ç”¨æ¥æš‚å­˜æŒ‡ä»¤ã€æ•°æ®å’Œä½å€ã€‚åœ¨ä¸­å¤®å¤„ç†å™¨çš„æ§åˆ¶éƒ¨ä»¶ä¸­ï¼ŒåŒ…å«çš„å¯„å­˜å™¨æœ‰æŒ‡ä»¤å¯„å­˜å™¨(IR)å’Œç¨‹åºè®¡æ•°å™¨(PC)ã€‚åœ¨ä¸­å¤®å¤„ç†å™¨çš„ç®—æœ¯åŠé€»è¾‘éƒ¨ä»¶ä¸­ï¼ŒåŒ…å«çš„å¯„å­˜å™¨æœ‰ç´¯åŠ å™¨(ACC)ã€‚ å­˜å‚¨å™¨å­˜å‚¨å™¨èŒƒå›´æœ€å¤§ï¼Œå®ƒå‡ ä¹æ¶µç›–äº†æ‰€æœ‰å…³äºå­˜å‚¨çš„èŒƒç•´ã€‚ä½ æ‰€è¯´çš„å¯„å­˜å™¨ï¼Œå†…å­˜ï¼Œéƒ½æ˜¯å­˜å‚¨å™¨é‡Œé¢çš„ä¸€ç§ã€‚å‡¡æ˜¯æœ‰å­˜å‚¨èƒ½åŠ›çš„ç¡¬ä»¶ï¼Œéƒ½å¯ä»¥ç§°ä¹‹ä¸ºå­˜å‚¨å™¨ï¼Œè¿™æ˜¯è‡ªç„¶ï¼Œç¡¬ç›˜æ›´åŠ æ˜æ˜¾äº†ï¼Œå®ƒå½’å…¥å¤–å­˜å‚¨å™¨è¡Œåˆ—ï¼Œç”±æ­¤å¯è§â€”â€”ã€‚ å†…å­˜æ—¢ä¸“ä¸šåä¸Šçš„å†…å­˜å‚¨å™¨ï¼Œå®ƒä¸æ˜¯ä¸ªä»€ä¹ˆç¥ç§˜çš„ä¸œè¥¿ï¼Œå®ƒä¹Ÿåªæ˜¯å­˜å‚¨å™¨ä¸­çš„æ²§æµ·ä¸€ç²Ÿï¼Œå®ƒåŒ…æ¶µçš„èŒƒå›´ä¹Ÿå¾ˆå¤§ï¼Œä¸€èˆ¬åˆ†ä¸ºåªè¯»å­˜å‚¨å™¨å’Œéšæœºå­˜å‚¨å™¨ï¼Œä»¥åŠæœ€å¼ºæ‚çš„é«˜é€Ÿç¼“å†²å­˜å‚¨å™¨ï¼ˆCACHEï¼‰ï¼Œåªè¯»å­˜å‚¨å™¨åº”ç”¨å¹¿æ³›ï¼Œå®ƒé€šå¸¸æ˜¯ä¸€å—åœ¨ç¡¬ä»¶ä¸Šé›†æˆçš„å¯è¯»èŠ¯ç‰‡ï¼Œä½œç”¨æ˜¯è¯†åˆ«ä¸æ§åˆ¶ç¡¬ä»¶ï¼Œå®ƒçš„ç‰¹ç‚¹æ˜¯åªå¯è¯»å–ï¼Œä¸èƒ½å†™å…¥ã€‚éšæœºå­˜å‚¨å™¨çš„ç‰¹ç‚¹æ˜¯å¯è¯»å¯å†™ï¼Œæ–­ç”µåä¸€åˆ‡æ•°æ®éƒ½æ¶ˆå¤±ï¼Œæˆ‘ä»¬æ‰€è¯´çš„å†…å­˜æ¡å°±æ˜¯æŒ‡å®ƒäº†ã€‚ Cacheåœ¨CPUä¸­é€Ÿåº¦éå¸¸å—ï¼Œè€Œå®¹é‡å´å¾ˆå°çš„ä¸€ç§å­˜å‚¨å™¨ï¼Œå®ƒæ˜¯è®¡ç®—æœºå­˜å‚¨å™¨ä¸­æœ€å¼ºæ‚çš„å­˜å‚¨å™¨ã€‚ç”±äºæŠ€æœ¯é™åˆ¶ï¼Œå®¹é‡å¾ˆéš¾æå‡ï¼Œä¸€èˆ¬éƒ½ä¸è¿‡å…†ã€‚ Referenceè½¬è‡ª : hp_carrot","categories":[{"name":"devops","slug":"devops","permalink":"http://iequa.com/categories/devops/"}],"tags":[{"name":"memory","slug":"memory","permalink":"http://iequa.com/tags/memory/"}]},{"title":"Graph Theory è¿‘æœŸå°ç»“","slug":"leetcode/graph_theory_summary","date":"2011-12-29T02:26:48.000Z","updated":"2019-10-20T04:30:35.081Z","comments":true,"path":"2011/12/29/leetcode/graph_theory_summary/","link":"","permalink":"http://iequa.com/2011/12/29/leetcode/graph_theory_summary/","excerpt":"å…³äºå›¾è®ºçš„å­¦ä¹ æ€»ç»“, åœ¨æœ¬åšå¯ä»¥è¯¦ç»†çš„ä½“ç°ï¼Œåšçš„å¤§éƒ¨åˆ†éƒ½æ˜¯éå¸¸ç»å…¸çš„å›¾è®ºç®—æ³•å…¥é—¨é¢˜ã€‚","text":"å…³äºå›¾è®ºçš„å­¦ä¹ æ€»ç»“, åœ¨æœ¬åšå¯ä»¥è¯¦ç»†çš„ä½“ç°ï¼Œåšçš„å¤§éƒ¨åˆ†éƒ½æ˜¯éå¸¸ç»å…¸çš„å›¾è®ºç®—æ³•å…¥é—¨é¢˜ã€‚ æ–­æ–­ç»­ç»­ï¼Œä¹Ÿè¦æ¥è¿‘ä¸€ä¸ªæœˆçš„æ—¶é—´å•¦ï¼æˆ‘ä»Šå¤©ç»ˆäºæŠŠå›¾è®ºçš„å¤§éƒ¨åˆ†ç»å…¸ç®—æ³• å¤ä¹ +å­¦ä¹  å°å®Œæ¯•ã€‚ å› ä¸ºä¸­é—´å­¦æ ¡æ€»ä¼šæœ‰ä¸€äº›æ‚äº‹åœ¨å½±å“æˆ‘çš„è¿›åº¦ï¼Œæ‰€ä»¥æ˜¯å‡ ç»å‘¨æŠ˜ï¼Œæ–­æ–­ç»­ç»­ï¼Œä½†æ˜¯å€¼å¾—åº†å¹¸çš„æ˜¯æˆ‘ä¸€ç›´æ²¡æœ‰é—´æ–­è¿‡ï¼Œè¿™æ–¹é¢çš„å­¦ä¹ ã€‚ æœ¬äººå›¾è®ºæ‰€æ¶‰çŒçš„ç®—æ³•å¦‚ä¸‹ { æ‹“æ‰‘æ’åº (Topology-h1285 ) æœ€å°ç”Ÿæˆæ ‘ (Kruska-p1287 / Prim-p1287 ) æœ€çŸ­è·¯ ( Dijkstra-p2387 / Bellman_Ford-z3033 / Bellman_Ford-p3259 / SPFA-template / SPFA-é‚»æ¥çŸ©é˜µ-p3259 / SPFA-é‚»æ¥è¡¨-p3259 / Floyd-template / Floyd-p1502 ) äºŒåˆ†å›¾ (Hungary . poj 1274 / poj 2446 / zoj 1654 KM_CA_poj 2195O(n^4)/ KM_O(n^3)_p2195 ) ç½‘ç»œæµ (EKå…¥é—¨_p1273 / Dinicå…¥é—¨_p1273 / æœ€å°è´¹ç”¨æœ€å¤§æµ(SPFA+EK)_p2195) å¼ºè¿é€šåˆ†é‡ä¸ç¼©ç‚¹(æœ‰å‘å›¾) Korasaju_p2186 / Korasaju and Tarjan_p1236 ã€‚ å›¾çš„å‰²ç‚¹ä¸æ¡¥(æ— å‘å›¾) ( Tarjanå‰²ç‚¹å’Œæ¡¥çš„ç¤ºä¾‹ç¨‹åºã€‚ Sample : poj 144 æ±‚å‰²ç‚¹ä¸ªæ•°) åŒè¿é€šåˆ†é‡(æ— å‘å›¾) (Tarjanç‚¹åŒè¿é€šç¤ºä¾‹ç¨‹åº / tarjan_è¾¹åŒè¿é€š-ç¼©ç‚¹p3352ã€‚ Sample : poj 3352 æ±‚åŠ å…¥æœ€å°‘çš„è¾¹ä½¿å…¶å˜æˆè¾¹åŒè¿é€šåˆ†æ”¯) 2-sat(è¿™ä¸ªæˆ‘ç›®å‰åªèƒ½æ±‚åˆ¤å®šæ€§çš„é—®é¢˜) : poj 3207 / poj 3678 / poj 2723 Sample: Sample : poj 2186 æ±‚æœ‰å¤šå°‘é¡¶ç‚¹æ˜¯ç”±ä»»ä½•é¡¶ç‚¹å‡ºå‘éƒ½å¯è¾¾ã€‚Sample : poj 1236 è‡³å°‘è¦é€‰å‡ ä¸ªé¡¶ç‚¹ï¼Œæ‰èƒ½åšåˆ°ä»è¿™äº›é¡¶ç‚¹å‡ºå‘ï¼Œå¯ä»¥åˆ°è¾¾å…¨éƒ¨é¡¶ç‚¹ è‡³å°‘è¦åŠ å¤šå°‘æ¡è¾¹ï¼Œæ‰èƒ½ä½¿å¾—ä»ä»»ä½•ä¸€ä¸ªé¡¶ç‚¹å‡ºå‘ï¼Œéƒ½èƒ½åˆ°è¾¾å…¨éƒ¨é¡¶ç‚¹","categories":[{"name":"icpc","slug":"icpc","permalink":"http://iequa.com/categories/icpc/"}],"tags":[{"name":"graph_theory","slug":"graph-theory","permalink":"http://iequa.com/tags/graph-theory/"}]},{"title":"è‡´æ•¬å¥‹æ–—çš„è‡ªå·±","slug":"tools/Chicken-soup","date":"2011-11-29T02:26:48.000Z","updated":"2019-10-20T04:30:34.996Z","comments":true,"path":"2011/11/29/tools/Chicken-soup/","link":"","permalink":"http://iequa.com/2011/11/29/tools/Chicken-soup/","excerpt":"è¿™æ˜¯å…³äºä¸€äº›åŠ±å¿—çš„å¥å­ï¼Œ ç°åœ¨çœ‹é‚£æ—¶å€™çš„æˆ‘ï¼ŒçœŸçš„æ˜¯è¶…åŠ±å¿—ï¼Œ è¶…åˆ»è‹¦","text":"è¿™æ˜¯å…³äºä¸€äº›åŠ±å¿—çš„å¥å­ï¼Œ ç°åœ¨çœ‹é‚£æ—¶å€™çš„æˆ‘ï¼ŒçœŸçš„æ˜¯è¶…åŠ±å¿—ï¼Œ è¶…åˆ»è‹¦ ä¸‰å†›å¯å¤ºå¸…ä¹Ÿï¼ŒåŒ¹å¤«ä¸å¯å¤ºå¿—ä¹Ÿï¼ å¤©è¡Œå¥ï¼Œå›å­ä»¥è‡ªå¼ºä¸æ¯ï¼ å®å‰‘é”‹è‡ªç£¨ç ºå‡ºï¼Œæ¢…èŠ±é¦™è‡ªè‹¦å¯’æ¥ï¼ è€å¿ƒå€™å¥½è¿ï¼Œå¥½è¿å¸¸ä¼šæ¥ï¼ ä¸ç»ä¸€ç•ªå¯’å½»éª¨ï¼Œæ€å¾—æ¢…èŠ±æ‰‘é¼»é¦™ï¼ æˆäº‹ä¸åœ¨äºåŠ›é‡çš„å¤§å°ï¼Œè€Œåœ¨äºèƒ½åšæŒå¤šä¹…ï¼ ç»³é”¯æœ¨æ–­ï¼Œæ°´æ»´çŸ³ç©¿ï¼ èš“æ— çˆªç‰™ä¹‹åˆ©ï¼Œç­‹éª¨ä¹‹å¼ºï¼Œä¸Šé£ŸåŸƒåœŸï¼Œä¸‹é¥®é»„æ³‰ï¼Œç”¨å¿ƒä¸€ä¹Ÿï¼ ç–¾é£çŸ¥åŠ²è‰ï¼Œçƒˆç«ç‚¼çœŸé‡‘ã€‚ ä¸ç»å¯’éœœè‹¦ï¼Œå®‰èƒ½é¦™è¢­äººï¼Ÿ é”‹è‡ªç£¨ç ºå‡ºï¼Œç‰ä¹ƒé›•ç¢æˆã€‚ äººè€Œä¸è‹¦ç»ƒï¼Œç„‰èƒ½è‰ºç²¾æ·±ï¼Ÿ","categories":[{"name":"tools","slug":"tools","permalink":"http://iequa.com/categories/tools/"}],"tags":[{"name":"Chicken-soup","slug":"Chicken-soup","permalink":"http://iequa.com/tags/Chicken-soup/"}]},{"title":"Shortest Path","slug":"leetcode/shortest-path","date":"2011-10-27T07:28:21.000Z","updated":"2019-10-20T04:30:35.082Z","comments":true,"path":"2011/10/27/leetcode/shortest-path/","link":"","permalink":"http://iequa.com/2011/10/27/leetcode/shortest-path/","excerpt":"shortest path ï¼š dijstra ã€ Bellman ã€ Floyd ã€ SPFA","text":"shortest path ï¼š dijstra ã€ Bellman ã€ Floyd ã€ SPFA 1. dijstraint data[M][M]; // init INFint lowc[M];int vis[M];int n, m;void djst(int p) &#123; int i, j; for(i = 1; i &lt;= n; i++) &#123; vis[i] = 0; lowc[i] = data[p][i]; &#125; vis[p] = 1; for(i = 1; i &lt;= n-1; i++) &#123; int minc = INF, c = 0, lk; for(j = 1; j &lt;= n; j++) &#123; if(vis[j] == 0 &amp;&amp; lowc[j] &lt; minc) &#123; minc = lowc[j]; c = j; &#125; &#125; if(c == 1) break; vis[c] = 1; for(j = 1; j &lt;= n; j++) &#123; if(vis[j] == 0 &amp;&amp; data[c][j] + minc &gt; 0 &amp;&amp; data[c][j] + minc &lt; lowc[j]) &#123; lowc[j] = data[c][j] + minc; &#125; &#125; &#125; cout &lt;&lt; lowc[1] &lt;&lt; endl;&#125; 2. Bellman#define INF ((long long)(1))&lt;&lt;62#define N 301using namespace std;struct edge&#123; int u; int v; long long w; // æ³¨æ„&#125;e[N*N];int m, n;long long d[1005];bool bellman_ford(int s, int di) &#123; int i, j; for(i = 1; i &lt; n; i++) &#123; d[i] = INF; &#125; d[s] = 0; for(i = 1; i &lt;= n-1; i++) &#123; for(j = 1; j &lt;= m; j++) &#123; if(d[e[j].u] != INF &amp;&amp; d[e[j].u]+e[j].w &lt; d[e[j].v]) // å¯¹è¾¹è¿›è¡Œæ“ä½œ ã€æ¾å¼› d[e[j].v] = d[e[j].u] + e[j].w; &#125; &#125; for(j = 1; j &lt;= m; j++) &#123; if(d[e[j].u] != INF &amp;&amp; (d[e[j].v] &gt; d[e[j].u]+e[j].w)) // å¾ˆç†è§£ d[e[j].v] = -INF; &#125; if(d[di] == INF || d[di] == -INF) return false; return true;&#125; 3. Floyd4. SPFAconst int INF = 0x7fffffff;const int N = 5501;struct edge &#123; int to; int w;&#125;;vector&lt;edge&gt; p[N]; // vector å®ç°é‚»æ¥è¡¨int d[N];bool inque[N]; // è®°å½•é¡¶ç‚¹æ˜¯å¦åœ¨é˜Ÿåˆ—ä¸­ï¼ŒSPFAç®—æ³•å¯ä»¥å…¥é˜Ÿåˆ—å¤šæ¬¡int cnt[N]; // è®°å½•é¡¶ç‚¹å…¥é˜Ÿçš„æ¬¡æ•°int n, m, q;bool SPFA(int s) &#123; queue&lt;int&gt; Q; while(!Q.empty()) Q.pop(); int i; for(i = 0; i &lt;= n; i++) &#123; d[i] = INF; &#125; d[s] = 0; // æºç‚¹çš„è·ç¦»ä¸º 0 memset(inque, 0, sizeof(inque)); memset(cnt, 0, sizeof(cnt)); Q.push(s); inque[s] = true; cnt[s]++; // æºç‚¹å…¥é˜Ÿåˆ—çš„æ¬¡æ•°å¢åŠ  while(!Q.empty()) &#123; int t = Q.front(); Q.pop(); inque[t] = false; for(i = 0; i &lt; p[t].size(); i++) &#123; int to = p[t][i].to; if(d[t] &lt; INF &amp;&amp; d[to] &gt; d[t] + p[t][i].w) &#123; d[to] = d[t] + p[t][i].w; cnt[to]++; if(cnt[to] &gt;= n) &#123; //å½“ä¸€ä¸ªç‚¹å…¥é˜Ÿçš„æ¬¡æ•°&gt;=næ—¶å°±è¯æ˜å‡ºç°äº†è´Ÿç¯ return false; &#125; if(!inque[to]) &#123; Q.push(to); inque[to] = true; &#125; &#125; &#125; &#125; return true;&#125;","categories":[{"name":"icpc","slug":"icpc","permalink":"http://iequa.com/categories/icpc/"}],"tags":[{"name":"acm","slug":"acm","permalink":"http://iequa.com/tags/acm/"}]},{"title":"Minimum Spanning Tree","slug":"leetcode/mst","date":"2011-10-27T02:28:21.000Z","updated":"2019-10-20T04:30:35.079Z","comments":true,"path":"2011/10/27/leetcode/mst/","link":"","permalink":"http://iequa.com/2011/10/27/leetcode/mst/","excerpt":"data structure - minimal spanning tree","text":"data structure - minimal spanning tree 1. prim http://acm.hdu.edu.cn/showproblem.php?pid=1233 #include &lt;iostream&gt;#include &lt;cstdio&gt;#include &lt;cstring&gt;using namespace std;const int INF = 0x7fffffff; // max int valueconst int N = 101;int map[N][N];int dis[N];bool vis[N];int prim(int n) &#123; memset(vis, false, sizeof(vis)); memset(dis, 0, sizeof(dis)); for(int i = 1; i &lt;= n; i++) &#123; if(map[1][i] != -1) &#123; dis[i] = map[1][i]; &#125; else dis[i] = INF; &#125; vis[1] = true; int sum = 0; for(int i = 1; i &lt;= n-1; i++) &#123; int minv = INF, c = 0; for(int j = 1; j &lt;= n; j++) &#123; if(!vis[j] &amp;&amp; dis[j] &lt; minv) &#123; minv = dis[j]; c = j; &#125; &#125; vis[c] = true; sum += minv; for(int j = 1; j &lt;= n; j++) &#123; if(!vis[j] &amp;&amp; map[c][j] != -1 &amp;&amp; map[c][j] &lt; dis[j]) &#123; dis[j] = map[c][j]; &#125; &#125; &#125; return sum;&#125;int main() &#123; int n, m; while(1 == scanf(&quot;%d&quot;, &amp;n) &amp;&amp; n != 0) &#123; memset(map, 255, sizeof(map)); int a, b, c; m = (n * (n-1)) / 2; for (int i = 0; i &lt; m; i++) &#123; scanf(&quot;%d%d%d&quot;, &amp;a, &amp;b, &amp;c); map[a][b] = map[b][a] = c; &#125; printf(&quot;%d\\n&quot;, prim(n)); &#125; return 0;&#125; 2. kruskalint pre[N];int n, m;struct Edge &#123; int u, v; int w;&#125;e[N];bool cmp(const Edge a, const Edge b) &#123; return a.w &lt; b.w;&#125;void make_set(int n) &#123; for(int i = 0; i &lt;= n; i++) pre[i] = i;&#125;int find_set(int a) &#123; if(pre[a] == a) return a; return pre[a] = find_set(pre[a]);&#125;void kruskal() &#123; int sum = 0; sort(e, e + m, cmp); make_set(n); for (int i = 0, fu, fv, cnt_e; i &lt; m; i++) &#123; fu = find_set(e[i].u); fv = find_set(e[i].v); if (fu != fv) &#123; sum += e[i].w; cnt_e++; if (cnt_e == n-1) break; pre[fv] = fu; &#125; &#125; cout &lt;&lt; sum &lt;&lt; endl;&#125;","categories":[{"name":"icpc","slug":"icpc","permalink":"http://iequa.com/categories/icpc/"}],"tags":[{"name":"acm","slug":"acm","permalink":"http://iequa.com/tags/acm/"}]},{"title":"Six Kinds of Sort algorithms","slug":"leetcode/six-sort","date":"2011-10-27T02:28:21.000Z","updated":"2019-10-20T04:30:35.083Z","comments":true,"path":"2011/10/27/leetcode/six-sort/","link":"","permalink":"http://iequa.com/2011/10/27/leetcode/six-sort/","excerpt":"input ï¼š 8, 5, 4, 9, 2, 3, 6","text":"input ï¼š 8, 5, 4, 9, 2, 3, 6 1. heapSortvoid heapify(int a[], int i, int size) &#123; // å †åŒ–çš„ç»´æŒéœ€è¦ç”¨é€’å½’ int ls = 2*i, rs = 2*i + 1; int large = i; if(ls &lt;= size &amp;&amp; a[ls] &gt; a[i]) &#123; large = ls; &#125; if(rs &lt;= size &amp;&amp; a[rs] &gt; a[large]) &#123; large = rs; &#125; if(large != i) &#123; swap(a[i], a[large]); heapify(a, large, size); &#125;&#125;void buildHeap(int a[], int size) &#123; for(int i = size/2; i &gt;= 1; i--) &#123; heapify(a, i, size); &#125;&#125;void heapSort(int a[], int size) &#123; buildHeap(a, size); int len = size; for(int i = len; i &gt;= 2; i--) &#123; swap(a[i], a[1]); len--; heapify(a, 1, len); &#125;&#125; 2. quickSortvoid quickSort(int a[], int left, int right) &#123; if(left &lt; right) &#123; // exit. good idea! int l = left, r = right, x = a[l]; while(1) &#123; while(l &lt; r &amp;&amp; a[r] &gt;= x) r--; while(l &lt; r &amp;&amp; a[l] &lt;= x) l++; if(l &gt;= r) break; swap(a[r], a[l]); &#125; swap(a[left], a[l]); quickSort(a, left, l-1); quickSort(a, l+1, right); &#125;&#125; 3. mergeSortvoid mergeSort(int a[], int l, int r) &#123; // 8, 5, 4, 9, 2, 3, 6 if(l &gt;= r) return; // exit. int mid = (l+r) / 2; // overflow &lt;-&gt; l + (r-l)/2 mergeSort(a, l, mid); mergeSort(a, mid+1, r); int *arr = new int[r-l+1]; int k = 0; int i = l, j = mid + 1; while(i &lt;= mid &amp;&amp; j &lt;= r) &#123; if(a[i] &lt;= a[j]) &#123; arr[k++] = a[i++]; &#125; else &#123; arr[k++] = a[j++]; // ans += (mid-i+1); &#125; &#125; while(i &lt;= mid) arr[k++] = a[i++]; while(j &lt;= r) arr[k++] = a[j++]; for(int i = l; i &lt;= r; i++) &#123; a[i] = arr[i-l]; &#125; delete []arr;&#125; 4. insertSortvoid insertSort(int a[], int len) &#123; int j; for(int i = 1; i &lt; len; i++) &#123;// æ–°æŠ“çš„æ¯å¼ æ‰‘å…‹ç‰Œ int temp = a[i]; for(j = i-1; a[j] &gt; temp &amp;&amp; j &gt;= 0; j--) &#123; a[j+1] = a[j]; &#125; a[j+1] = temp; &#125;&#125; 5. bubbleSortvoid bubbleSort(int a[], int len) &#123; for(int i = 1; i &lt; len; i++) &#123; for(int j = 0; j &lt; len-i; j++) &#123; if(a[j] &gt; a[j+1]) swap(a[j], a[j+1]); &#125; &#125;&#125; 6. selectSortvoid selectSort(int a[], int len) &#123; int i, j, k; for(i = 0; i &lt; len-1; i++) &#123; k = i; for(j = i+1; j &lt; len; j++) &#123; if(a[j] &lt; a[k]) k = j; &#125; swap(a[i], a[k]); // å°†ç¬¬iä½å°çš„æ•°æ”¾å…¥iä½ç½® &#125; &#125;","categories":[{"name":"icpc","slug":"icpc","permalink":"http://iequa.com/categories/icpc/"}],"tags":[{"name":"acm","slug":"acm","permalink":"http://iequa.com/tags/acm/"}]},{"title":"æœç´¢çš„ç»å…¸ POJ 2386 Lake Counting","slug":"leetcode/dfs-POJ-2386","date":"2010-09-27T10:04:21.000Z","updated":"2019-10-20T04:30:35.084Z","comments":true,"path":"2010/09/27/leetcode/dfs-POJ-2386/","link":"","permalink":"http://iequa.com/2010/09/27/leetcode/dfs-POJ-2386/","excerpt":"ç»å…¸çš„æœç´¢ï¼Œå¯»æ‰¾æ°´æ³¡ poj 2386 Lake Counting","text":"ç»å…¸çš„æœç´¢ï¼Œå¯»æ‰¾æ°´æ³¡ poj 2386 Lake Counting Lake Counting#include &lt;iostream&gt;using namespace std;const int MAX = 101;int asd[202];int n, m;int ans = 0;char c;int map[MAX][MAX];void digui(int a, int b, int k) &#123; if (a &gt;= 0 &amp; &amp; a &lt; n &amp; &amp; b &gt;= 0 &amp; &amp; b &lt; m &amp; &amp; map[a][b] == -2) &#123; map[a][b] = k; // è¿™æ˜¯å¾ˆé‡è¦çš„æ ‡è®° digui(a + 1, b, k); digui(a, b + 1, k); digui(a - 1, b, k); digui(a, b - 1, k); digui(a + 1, b + 1, k); digui(a + 1, b - 1, k); digui(a - 1, b + 1, k); digui(a - 1, b - 1, k); &#125;&#125;int main() &#123; int i, j; cin &gt;&gt; n &gt;&gt; m; for (i = 0; i &lt; n; i++) &#123; for (j = 0; j &lt; m; j++)&#123; cin &gt;&gt; c; if (c == &#x27;W&#x27;) map[i][j] = -2; // è¿™çš„æ ‡è®°è¦æ…é‡ï¼Œæœ€å¥½ç”¨è´Ÿæ•°ï¼Œä¸é¿å…å’ŒKé‡å¤ else map[i][j] = 0; &#125; &#125; for (i = 0; i &lt; n; i++) &#123; for (j = 0; j &lt; m; j++) &#123; if (map[i][j] == -2) &#123; ans++; digui(i, j, ans); &#125; &#125; &#125; cout &lt;&lt; ans &lt;&lt; endl; return 0;&#125;","categories":[{"name":"icpc","slug":"icpc","permalink":"http://iequa.com/categories/icpc/"}],"tags":[{"name":"acm","slug":"acm","permalink":"http://iequa.com/tags/acm/"}]},{"title":"æ ¼å¼åŒ–è¾“å‡º printf ä¸ è¾“å‡ºæµ cout","slug":"leetcode/cout_vs_printf","date":"2010-09-25T11:04:21.000Z","updated":"2019-10-20T04:30:35.082Z","comments":true,"path":"2010/09/25/leetcode/cout_vs_printf/","link":"","permalink":"http://iequa.com/2010/09/25/leetcode/cout_vs_printf/","excerpt":"printf æ˜¯ æ ¼å¼åŒ–è¾“å‡º ï¼Œ cout æ˜¯è¾“å‡ºæµ ä»Šå¤©æ— æ„ä¸­å‘ç° cout å’Œ printf æ˜¯æœ‰ç‚¹åŒºåˆ«çš„ï¼Œä¸€ä¸ªæ˜¯è¾“å‡ºè¯­å¥ï¼Œä¸€ä¸ªæ˜¯è¾“å‡ºå‡½æ•°","text":"printf æ˜¯ æ ¼å¼åŒ–è¾“å‡º ï¼Œ cout æ˜¯è¾“å‡ºæµ ä»Šå¤©æ— æ„ä¸­å‘ç° cout å’Œ printf æ˜¯æœ‰ç‚¹åŒºåˆ«çš„ï¼Œä¸€ä¸ªæ˜¯è¾“å‡ºè¯­å¥ï¼Œä¸€ä¸ªæ˜¯è¾“å‡ºå‡½æ•° demo#include &lt;iostream.h&gt;#include &lt;stdio.h&gt;int main() &#123; for(int a=0; a&lt;24; a++) &#123; printf(&quot;++++++++++++\\n&quot;); cout &lt;&lt; &quot;============\\n&quot;; printf(&quot;############\\n&quot;); &#125; printf(&quot;@@@@@@@@@@@\\n&quot;);&#125; è¿è¡Œç»“æœå¦‚ä¸‹ï¼š ++++++++++++++++++++++++########################@@@@@@@@@@@======================== åŸå› åˆ†æcout å…ˆæ˜¯æŠŠè¾“å‡ºç»“æœå­˜åˆ°ç¼“å­˜åŒºï¼Œç„¶åä¸€æ¬¡æ€§è¾“å‡ºï¼Œå…¶å® cout è¾“å‡ºçš„æ—¶å€™ä¹Ÿæ˜¯è°ƒç”¨äº†printfå‡½æ•°ï¼›pintfå‡½æ•°æ˜¯æ¯æ¬¡è¾“å‡ºç»“æœ; è¿™å°±æ˜¯ä¸ºäº†åœ¨ TIMEç¨‹åºä¸­ coutè¿è¡Œçš„æ—¶é—´è¦æ¯”printfå‡½æ•°å¿«çš„åŸå› ï¼› æ³¨æ„ï¼š cout&lt;&lt;â€==\\nâ€; å’Œ cout&lt;&lt;â€==â€&lt;&lt;endl; ä¹Ÿæœ‰ä¸åŒï¼Œ\\nåªæ˜¯ä¸€ä¸ªå­—ç¬¦ï¼Œè€Œendlä¼šå°†ç¼“å­˜åŒºçš„æ•°æ®å…¨éƒ¨è¾“å‡ºå¹¶æ¸…é›¶ï¼›åœ¨TIMEç¨‹åºä¸­ï¼Œå¦‚æœé‡‡ç”¨cout&lt;&lt;â€============â€&lt;&lt;endl;ç»“æ„åè€Œä¼šæ¯”printfæ…¢ï¼Œå› ä¸ºå¤šäº†ä¸€é“è°ƒç”¨ç¼“å­˜æ‰‹ç»­ å½¢è±¡æ¯”å–»ä¸‹é¢æ‰“ä¸ªå¾ˆå½¢è±¡çš„æ¯”å–»ï¼Œå¤§å®¶éƒ½ä¼šæ˜ç™½, æ¯”å¦‚æœ‰100ä¸ªé¸¡è›‹ï¼Œéœ€è¦ä»Aæ‹¿åˆ°Bç‚¹ï¼Œç›¸å½“äºç¨‹åºä¸­çš„è¾“å‡º: printfæŠŠé¸¡è›‹ä¸€æ¬¡ä¸€ä¸ªç”¨æ‰‹æ‹¿åˆ°Bç‚¹ cout&lt;&lt;â€ \\nâ€ å…ˆæŠŠé¸¡è›‹å…¨éƒ¨æ”¾åˆ°ç¯®å­ï¼Œç„¶åä¸€æ¬¡æ€§æ‹¿è¿‡å»å–å‡º cout&lt;&lt;â€ â€œ&lt;&lt;endl å…ˆæŠŠé¸¡è›‹æ”¾åˆ°ç¯®å­ï¼Œç„¶åä¸€æ¬¡ä¸€ä¸ªæ‹¿è¿‡å»å†å–å‡º å°¤å…¶å¯è§å“ªä¸ªå¿«é‚£ä¸ªæ…¢æ˜¾è€Œæ˜“è§","categories":[{"name":"icpc","slug":"icpc","permalink":"http://iequa.com/categories/icpc/"}],"tags":[{"name":"acm","slug":"acm","permalink":"http://iequa.com/tags/acm/"}]},{"title":"æ ¼å¼åŒ–è¾“å…¥ scanf ä¸ è¾“å…¥æµ cin","slug":"leetcode/cin_vs_scanf","date":"2010-09-24T10:04:21.000Z","updated":"2019-10-20T04:30:35.082Z","comments":true,"path":"2010/09/24/leetcode/cin_vs_scanf/","link":"","permalink":"http://iequa.com/2010/09/24/leetcode/cin_vs_scanf/","excerpt":"scanf æ˜¯æ ¼å¼åŒ–è¾“å…¥ï¼Œprintfæ˜¯æ ¼å¼åŒ–è¾“å‡ºã€‚ cinæ˜¯è¾“å…¥æµï¼Œcoutæ˜¯è¾“å‡ºæµã€‚æ•ˆç‡ç¨ä½ï¼Œä½†ä¹¦å†™ç®€ä¾¿ã€‚","text":"scanf æ˜¯æ ¼å¼åŒ–è¾“å…¥ï¼Œprintfæ˜¯æ ¼å¼åŒ–è¾“å‡ºã€‚ cinæ˜¯è¾“å…¥æµï¼Œcoutæ˜¯è¾“å‡ºæµã€‚æ•ˆç‡ç¨ä½ï¼Œä½†ä¹¦å†™ç®€ä¾¿ã€‚ æ ¼å¼åŒ–è¾“å‡º ä¸ æµè¾“å‡º æ ¼å¼åŒ–è¾“å‡ºæ•ˆç‡æ¯”è¾ƒé«˜ï¼Œä½†æ˜¯å†™ä»£ç éº»çƒ¦ã€‚ æµè¾“å‡ºæ“ä½œæ•ˆç‡ç¨ä½ï¼Œä½†ä¹¦å†™ç®€ä¾¿ã€‚ coutä¹‹æ‰€ä»¥æ•ˆç‡ä½ï¼Œæ˜¯å…ˆæŠŠè¦è¾“å‡ºçš„ä¸œè¥¿å­˜å…¥ç¼“å†²åŒºï¼Œå†è¾“å‡ºï¼Œå¯¼è‡´æ•ˆç‡é™ä½ã€‚ ç¼“å†²åŒºæ¯”è¾ƒæŠ½è±¡ï¼Œä¸¾ä¸ªä¾‹å­å§ï¼š int i;cout &lt;&lt; &#x27;a&#x27;;cin &gt;&gt; i;cout &lt;&lt; &#x27;b&#x27;; è¿è¡Œç»“æœä»€ä¹ˆéƒ½æ²¡çœ‹åˆ°è¾“å‡ºï¼Œè¾“å…¥ä¸€ä¸ªæ•´å‹æ¯”å¦‚3å†æŒ‰å›è½¦åabåŒæ—¶æ˜¾ç¤ºå‡ºæ¥äº†ã€‚ä½†æ˜¯è¿™æ ·çš„æƒ…å†µå¹¶ä¸æ˜¯ç»å¸¸å‘ç”Ÿï¼Œæ˜¯åœ¨ä¸€äº›æ¯”è¾ƒå¤§å‹çš„å·¥ç¨‹ä¸­å¶å°”å‡ºç°ï¼ŒåŸå› æ˜¯å­—ç¬¦aå…ˆåˆ°äº†ç¼“å†²åŒºï¼Œä½†æ˜¯æ²¡è¾“å‡ºï¼Œç­‰è¾“å…¥äº†iï¼Œbè¿›å…¥ç¼“å†²åŒºåå†ä¸€å¹¶è¾“å‡ºçš„ã€‚æµè¾“å…¥ä¹Ÿæ˜¯å·®ä¸å¤šçš„ã€‚ C++ ä¸­ iostream.h ä¸ stdio.h iostream.h å’Œ stdio.h æ˜¯ C++ çš„ä¸¤ä¸ªå¤´æ–‡ä»¶ï¼Œé‡Œé¢æ˜¯å¯¹äºä¸€äº›ç±»ï¼Œæ“ä½œç¬¦ï¼Œå‡½æ•°çš„å®šä¹‰ï¼Œå¤´æ–‡ä»¶æœ¬èº«æ²¡æœ‰å¥½åä¹‹åˆ†å§~~ åªæ˜¯å‘å±•åˆ°C++ï¼Œéƒ½æ¯”è¾ƒæå€¡ç”¨iostream.hç½¢äº†ï¼Œå› ä¸ºè¿™æ ·å†™ä»£ç ç®€å•ã€‚","categories":[{"name":"icpc","slug":"icpc","permalink":"http://iequa.com/categories/icpc/"}],"tags":[{"name":"acm","slug":"acm","permalink":"http://iequa.com/tags/acm/"}]}],"categories":[{"name":"leetcode","slug":"leetcode","permalink":"http://iequa.com/categories/leetcode/"},{"name":"data-warehouse","slug":"data-warehouse","permalink":"http://iequa.com/categories/data-warehouse/"},{"name":"hive","slug":"data-warehouse/hive","permalink":"http://iequa.com/categories/data-warehouse/hive/"},{"name":"spark","slug":"spark","permalink":"http://iequa.com/categories/spark/"},{"name":"python","slug":"python","permalink":"http://iequa.com/categories/python/"},{"name":"java","slug":"java","permalink":"http://iequa.com/categories/java/"},{"name":"nlp","slug":"nlp","permalink":"http://iequa.com/categories/nlp/"},{"name":"data-analysis","slug":"data-analysis","permalink":"http://iequa.com/categories/data-analysis/"},{"name":"devops","slug":"devops","permalink":"http://iequa.com/categories/devops/"},{"name":"elastic","slug":"elastic","permalink":"http://iequa.com/categories/elastic/"},{"name":"hadoop","slug":"hadoop","permalink":"http://iequa.com/categories/hadoop/"},{"name":"tensorflow","slug":"tensorflow","permalink":"http://iequa.com/categories/tensorflow/"},{"name":"machine-learning","slug":"machine-learning","permalink":"http://iequa.com/categories/machine-learning/"},{"name":"icpc","slug":"icpc","permalink":"http://iequa.com/categories/icpc/"},{"name":"chatbot","slug":"chatbot","permalink":"http://iequa.com/categories/chatbot/"},{"name":"data-science","slug":"data-science","permalink":"http://iequa.com/categories/data-science/"},{"name":"deeplearning","slug":"deeplearning","permalink":"http://iequa.com/categories/deeplearning/"},{"name":"tools","slug":"tools","permalink":"http://iequa.com/categories/tools/"},{"name":"English","slug":"English","permalink":"http://iequa.com/categories/English/"}],"tags":[{"name":"leetcode","slug":"leetcode","permalink":"http://iequa.com/tags/leetcode/"},{"name":"Hive","slug":"Hive","permalink":"http://iequa.com/tags/Hive/"},{"name":"DWH","slug":"DWH","permalink":"http://iequa.com/tags/DWH/"},{"name":"SQL","slug":"SQL","permalink":"http://iequa.com/tags/SQL/"},{"name":"data warehouse","slug":"data-warehouse","permalink":"http://iequa.com/tags/data-warehouse/"},{"name":"sparkSQL","slug":"sparkSQL","permalink":"http://iequa.com/tags/sparkSQL/"},{"name":"spark","slug":"spark","permalink":"http://iequa.com/tags/spark/"},{"name":"Airflow","slug":"Airflow","permalink":"http://iequa.com/tags/Airflow/"},{"name":"getattr","slug":"getattr","permalink":"http://iequa.com/tags/getattr/"},{"name":"interview","slug":"interview","permalink":"http://iequa.com/tags/interview/"},{"name":"python","slug":"python","permalink":"http://iequa.com/tags/python/"},{"name":"java","slug":"java","permalink":"http://iequa.com/tags/java/"},{"name":"jvm","slug":"jvm","permalink":"http://iequa.com/tags/jvm/"},{"name":"BERT","slug":"BERT","permalink":"http://iequa.com/tags/BERT/"},{"name":"ITFIN","slug":"ITFIN","permalink":"http://iequa.com/tags/ITFIN/"},{"name":"pyCharm","slug":"pyCharm","permalink":"http://iequa.com/tags/pyCharm/"},{"name":"scikit-learn","slug":"scikit-learn","permalink":"http://iequa.com/tags/scikit-learn/"},{"name":"SpaCy","slug":"SpaCy","permalink":"http://iequa.com/tags/SpaCy/"},{"name":"Systemd","slug":"Systemd","permalink":"http://iequa.com/tags/Systemd/"},{"name":"Anaconda","slug":"Anaconda","permalink":"http://iequa.com/tags/Anaconda/"},{"name":"ElasticSearch","slug":"ElasticSearch","permalink":"http://iequa.com/tags/ElasticSearch/"},{"name":"Kubernetes","slug":"Kubernetes","permalink":"http://iequa.com/tags/Kubernetes/"},{"name":"Stack","slug":"Stack","permalink":"http://iequa.com/tags/Stack/"},{"name":"Fluentd","slug":"Fluentd","permalink":"http://iequa.com/tags/Fluentd/"},{"name":"developer","slug":"developer","permalink":"http://iequa.com/tags/developer/"},{"name":"python3","slug":"python3","permalink":"http://iequa.com/tags/python3/"},{"name":"Docker","slug":"Docker","permalink":"http://iequa.com/tags/Docker/"},{"name":"WSGI","slug":"WSGI","permalink":"http://iequa.com/tags/WSGI/"},{"name":"hdfs","slug":"hdfs","permalink":"http://iequa.com/tags/hdfs/"},{"name":"tensorflow","slug":"tensorflow","permalink":"http://iequa.com/tags/tensorflow/"},{"name":"dp","slug":"dp","permalink":"http://iequa.com/tags/dp/"},{"name":"keras","slug":"keras","permalink":"http://iequa.com/tags/keras/"},{"name":"CNN","slug":"CNN","permalink":"http://iequa.com/tags/CNN/"},{"name":"NER","slug":"NER","permalink":"http://iequa.com/tags/NER/"},{"name":"estimation","slug":"estimation","permalink":"http://iequa.com/tags/estimation/"},{"name":"chatbot","slug":"chatbot","permalink":"http://iequa.com/tags/chatbot/"},{"name":"Credit-Score","slug":"Credit-Score","permalink":"http://iequa.com/tags/Credit-Score/"},{"name":"Seq2Seq","slug":"Seq2Seq","permalink":"http://iequa.com/tags/Seq2Seq/"},{"name":"PPL","slug":"PPL","permalink":"http://iequa.com/tags/PPL/"},{"name":"RNN","slug":"RNN","permalink":"http://iequa.com/tags/RNN/"},{"name":"MLP","slug":"MLP","permalink":"http://iequa.com/tags/MLP/"},{"name":"SVM","slug":"SVM","permalink":"http://iequa.com/tags/SVM/"},{"name":"L1-L2","slug":"L1-L2","permalink":"http://iequa.com/tags/L1-L2/"},{"name":"entropy","slug":"entropy","permalink":"http://iequa.com/tags/entropy/"},{"name":"Metric","slug":"Metric","permalink":"http://iequa.com/tags/Metric/"},{"name":"Rondom_Forest","slug":"Rondom-Forest","permalink":"http://iequa.com/tags/Rondom-Forest/"},{"name":"Logistic_Regression","slug":"Logistic-Regression","permalink":"http://iequa.com/tags/Logistic-Regression/"},{"name":"PCA","slug":"PCA","permalink":"http://iequa.com/tags/PCA/"},{"name":"fastText","slug":"fastText","permalink":"http://iequa.com/tags/fastText/"},{"name":"Kmeans","slug":"Kmeans","permalink":"http://iequa.com/tags/Kmeans/"},{"name":"TextCNN","slug":"TextCNN","permalink":"http://iequa.com/tags/TextCNN/"},{"name":"Chatbot","slug":"Chatbot","permalink":"http://iequa.com/tags/Chatbot/"},{"name":"Useful-Links","slug":"Useful-Links","permalink":"http://iequa.com/tags/Useful-Links/"},{"name":"sequence_loss","slug":"sequence-loss","permalink":"http://iequa.com/tags/sequence-loss/"},{"name":"body","slug":"body","permalink":"http://iequa.com/tags/body/"},{"name":"Attention","slug":"Attention","permalink":"http://iequa.com/tags/Attention/"},{"name":"Glove","slug":"Glove","permalink":"http://iequa.com/tags/Glove/"},{"name":"CDH","slug":"CDH","permalink":"http://iequa.com/tags/CDH/"},{"name":"Dialog_Corpus","slug":"Dialog-Corpus","permalink":"http://iequa.com/tags/Dialog-Corpus/"},{"name":"numpy","slug":"numpy","permalink":"http://iequa.com/tags/numpy/"},{"name":"newaxis","slug":"newaxis","permalink":"http://iequa.com/tags/newaxis/"},{"name":"deeplearning.ai","slug":"deeplearning-ai","permalink":"http://iequa.com/tags/deeplearning-ai/"},{"name":"CS231n","slug":"CS231n","permalink":"http://iequa.com/tags/CS231n/"},{"name":"PaperWeekly","slug":"PaperWeekly","permalink":"http://iequa.com/tags/PaperWeekly/"},{"name":"NLTK","slug":"NLTK","permalink":"http://iequa.com/tags/NLTK/"},{"name":"MapReduce","slug":"MapReduce","permalink":"http://iequa.com/tags/MapReduce/"},{"name":"Ensumble","slug":"Ensumble","permalink":"http://iequa.com/tags/Ensumble/"},{"name":"decision-tree","slug":"decision-tree","permalink":"http://iequa.com/tags/decision-tree/"},{"name":"machine-learning","slug":"machine-learning","permalink":"http://iequa.com/tags/machine-learning/"},{"name":"DataWare","slug":"DataWare","permalink":"http://iequa.com/tags/DataWare/"},{"name":"RD","slug":"RD","permalink":"http://iequa.com/tags/RD/"},{"name":"Ensemble","slug":"Ensemble","permalink":"http://iequa.com/tags/Ensemble/"},{"name":"english","slug":"english","permalink":"http://iequa.com/tags/english/"},{"name":"Matplotlib","slug":"Matplotlib","permalink":"http://iequa.com/tags/Matplotlib/"},{"name":"Sklearn","slug":"Sklearn","permalink":"http://iequa.com/tags/Sklearn/"},{"name":"IELTS","slug":"IELTS","permalink":"http://iequa.com/tags/IELTS/"},{"name":"Pandas","slug":"Pandas","permalink":"http://iequa.com/tags/Pandas/"},{"name":"Numpy","slug":"Numpy","permalink":"http://iequa.com/tags/Numpy/"},{"name":"Anaconda3","slug":"Anaconda3","permalink":"http://iequa.com/tags/Anaconda3/"},{"name":"mysql","slug":"mysql","permalink":"http://iequa.com/tags/mysql/"},{"name":"seq2seq+Attention","slug":"seq2seq-Attention","permalink":"http://iequa.com/tags/seq2seq-Attention/"},{"name":"banwagon","slug":"banwagon","permalink":"http://iequa.com/tags/banwagon/"},{"name":"word2vec","slug":"word2vec","permalink":"http://iequa.com/tags/word2vec/"},{"name":"engvid","slug":"engvid","permalink":"http://iequa.com/tags/engvid/"},{"name":"linux","slug":"linux","permalink":"http://iequa.com/tags/linux/"},{"name":"zshrc","slug":"zshrc","permalink":"http://iequa.com/tags/zshrc/"},{"name":"Shadowsocks","slug":"Shadowsocks","permalink":"http://iequa.com/tags/Shadowsocks/"},{"name":"mac","slug":"mac","permalink":"http://iequa.com/tags/mac/"},{"name":"help","slug":"help","permalink":"http://iequa.com/tags/help/"},{"name":"macos","slug":"macos","permalink":"http://iequa.com/tags/macos/"},{"name":"vimrc","slug":"vimrc","permalink":"http://iequa.com/tags/vimrc/"},{"name":"Singapore","slug":"Singapore","permalink":"http://iequa.com/tags/Singapore/"},{"name":"Bayes","slug":"Bayes","permalink":"http://iequa.com/tags/Bayes/"},{"name":"python-re","slug":"python-re","permalink":"http://iequa.com/tags/python-re/"},{"name":"jieba","slug":"jieba","permalink":"http://iequa.com/tags/jieba/"},{"name":"Word2Vec","slug":"Word2Vec","permalink":"http://iequa.com/tags/Word2Vec/"},{"name":"cooking","slug":"cooking","permalink":"http://iequa.com/tags/cooking/"},{"name":"Maryland","slug":"Maryland","permalink":"http://iequa.com/tags/Maryland/"},{"name":"ALS","slug":"ALS","permalink":"http://iequa.com/tags/ALS/"},{"name":"sina","slug":"sina","permalink":"http://iequa.com/tags/sina/"},{"name":"RS","slug":"RS","permalink":"http://iequa.com/tags/RS/"},{"name":"recommendation-system","slug":"recommendation-system","permalink":"http://iequa.com/tags/recommendation-system/"},{"name":"MyTrip","slug":"MyTrip","permalink":"http://iequa.com/tags/MyTrip/"},{"name":"spring","slug":"spring","permalink":"http://iequa.com/tags/spring/"},{"name":"Chinese's name","slug":"Chinese-s-name","permalink":"http://iequa.com/tags/Chinese-s-name/"},{"name":"elasticsearch","slug":"elasticsearch","permalink":"http://iequa.com/tags/elasticsearch/"},{"name":"math","slug":"math","permalink":"http://iequa.com/tags/math/"},{"name":"scala","slug":"scala","permalink":"http://iequa.com/tags/scala/"},{"name":"sbt","slug":"sbt","permalink":"http://iequa.com/tags/sbt/"},{"name":"cdh","slug":"cdh","permalink":"http://iequa.com/tags/cdh/"},{"name":"sqoop","slug":"sqoop","permalink":"http://iequa.com/tags/sqoop/"},{"name":"hive","slug":"hive","permalink":"http://iequa.com/tags/hive/"},{"name":"kettle","slug":"kettle","permalink":"http://iequa.com/tags/kettle/"},{"name":"logback","slug":"logback","permalink":"http://iequa.com/tags/logback/"},{"name":"work-cmd","slug":"work-cmd","permalink":"http://iequa.com/tags/work-cmd/"},{"name":"hadoop","slug":"hadoop","permalink":"http://iequa.com/tags/hadoop/"},{"name":"bashrc","slug":"bashrc","permalink":"http://iequa.com/tags/bashrc/"},{"name":"health","slug":"health","permalink":"http://iequa.com/tags/health/"},{"name":"linuxbird","slug":"linuxbird","permalink":"http://iequa.com/tags/linuxbird/"},{"name":"acm","slug":"acm","permalink":"http://iequa.com/tags/acm/"},{"name":"life","slug":"life","permalink":"http://iequa.com/tags/life/"},{"name":"Linux_C","slug":"Linux-C","permalink":"http://iequa.com/tags/Linux-C/"},{"name":"g++","slug":"g","permalink":"http://iequa.com/tags/g/"},{"name":"memory","slug":"memory","permalink":"http://iequa.com/tags/memory/"},{"name":"graph_theory","slug":"graph-theory","permalink":"http://iequa.com/tags/graph-theory/"},{"name":"Chicken-soup","slug":"Chicken-soup","permalink":"http://iequa.com/tags/Chicken-soup/"}]}