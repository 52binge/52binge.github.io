<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>CNN (week4) - Face recognition &amp; Neural style transfer - Auckland New Zealand</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="Face recognition &amp;amp; Neural style transfer èƒ½å¤Ÿåœ¨å›¾åƒã€è§†é¢‘ä»¥åŠå…¶ä»– 2D æˆ– 3D æ•°æ®ä¸Šåº”ç”¨è¿™äº›ç®—æ³•ã€‚ &amp;lt;!-- more --&amp;gt; 1. What is face recognition? è¿™ä¸€èŠ‚ä¸­çš„äººè„¸è¯†åˆ«æŠ€æœ¯çš„æ¼”ç¤ºçš„ç¡®å¾ˆNB..., æ¼”æŠ€ä¸é”™ï¼ŒğŸ˜„ &amp;lt;img src=&amp;quot;&#x2F;images&#x2F;deeplearning&#x2F;C4W">
<meta name="keywords" content="deeplearning.ai">
<meta property="og:type" content="article">
<meta property="og:title" content="CNN (week4) - Face recognition &amp; Neural style transfer">
<meta property="og:url" content="http:&#x2F;&#x2F;iequa.com&#x2F;2018&#x2F;09&#x2F;08&#x2F;deeplearning&#x2F;Convolutional-Neural-Networks-week4&#x2F;index.html">
<meta property="og:site_name" content="Auckland New Zealand">
<meta property="og:description" content="Face recognition &amp;amp; Neural style transfer èƒ½å¤Ÿåœ¨å›¾åƒã€è§†é¢‘ä»¥åŠå…¶ä»– 2D æˆ– 3D æ•°æ®ä¸Šåº”ç”¨è¿™äº›ç®—æ³•ã€‚ &amp;lt;!-- more --&amp;gt; 1. What is face recognition? è¿™ä¸€èŠ‚ä¸­çš„äººè„¸è¯†åˆ«æŠ€æœ¯çš„æ¼”ç¤ºçš„ç¡®å¾ˆNB..., æ¼”æŠ€ä¸é”™ï¼ŒğŸ˜„ &amp;lt;img src=&amp;quot;&#x2F;images&#x2F;deeplearning&#x2F;C4W">
<meta property="og:locale" content="en">
<meta property="og:updated_time" content="2019-10-20T04:30:35.014Z">
<meta name="twitter:card" content="summary">
  
  
    <link rel="icon" href="/css/images/favicon.ico">
  
  <link href="/webfonts/ptserif/main.css" rel='stylesheet' type='text/css'>
  <link href="/webfonts/source-code-pro/main.css" rel="stylesheet" type="text/css">
  <link rel="stylesheet" href="/css/style.css">
  

</head>

<body>
  <div id="container">
    <!-- blair add baidu tongji start... @2017.10.03 -->
<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?8864dc75a81a27b7e44c00138af95d66";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>
<!-- blair add baidu tongji end ! @2017.10.03 -->

<header id="header">
  <div id="header-outer" class="outer">
    <div id="header-inner" class="inner">
      <a id="main-nav-toggle" class="nav-icon" href="javascript:;" target="_blank" rel="noopener"></a>
      <a id="logo" class="logo" href="/"></a>
      <nav id="main-nav">
        
          <a class="main-nav-link" href="/ai1">AI</a>
        
          <a class="main-nav-link" href="/tensorflow">TF/Keras</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
          <a class="main-nav-link" href="/categories">Categories</a>
        
          <a class="main-nav-link" href="/about">About</a>
        
      </nav>
      <nav id="sub-nav">
        <div id="search-form-wrap">
          <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://iequa.com"></form>
        </div>
      </nav>
    </div>
  </div>
</header>

    <br>
    <section id="main" class="outer"><article id="post-deeplearning/Convolutional-Neural-Networks-week4" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      CNN (week4) - Face recognition &amp; Neural style transfer
      <small class=article-detail-date-index>&nbsp; 2018-09-08</small>
    </h1>
  


        <div class=page-title></div>
        <br>
      </header>
    
    <div class="article-meta">
      <!--<a href="/2018/09/08/deeplearning/Convolutional-Neural-Networks-week4/" class="article-date">
  <time datetime="2018-09-08T07:00:21.000Z" itemprop="datePublished">2018-09-08</time>
</a>-->
      <!-- 
  <div class="article-category">
    <a class="article-category-link" href="/categories/deeplearning/">deeplearning</a>
  </div>

--><!-- by blair 160724 -->
      <!-- by blair
      
        <div class="article-comment-link-wrap">
          <a href="http://iequa.com/2018/09/08/deeplearning/Convolutional-Neural-Networks-week4/#disqus_thread" class="article-comment-link">Comments</a>
        </div>
      
      -->
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p>Face recognition &amp; Neural style transfer èƒ½å¤Ÿåœ¨å›¾åƒã€è§†é¢‘ä»¥åŠå…¶ä»– 2D æˆ– 3D æ•°æ®ä¸Šåº”ç”¨è¿™äº›ç®—æ³•ã€‚</p>
<p>&lt;!-- more --&gt;</p>
<h2>1. What is face recognition?</h2>
<p>è¿™ä¸€èŠ‚ä¸­çš„äººè„¸è¯†åˆ«æŠ€æœ¯çš„æ¼”ç¤ºçš„ç¡®å¾ˆNB..., æ¼”æŠ€ä¸é”™ï¼ŒğŸ˜„</p>
<p>&lt;img src=&quot;/images/deeplearning/C4W4-1_1.png&quot; width=&quot;750&quot; /&gt;</p>
<h2>2. One Shot Learning</h2>
<p>ä½œä¸ºè€æ¿å¸Œæœ›ä¸æ—¶ä¿±è¿›ï¼Œæ‰€ä»¥æƒ³ä½¿ç”¨äººè„¸è¯†åˆ«æŠ€æœ¯æ¥å®ç°æ‰“å¡ã€‚</p>
<p>å‡å¦‚æˆ‘ä»¬å…¬å¸åªæœ‰4ä¸ªå‘˜å·¥ï¼ŒæŒ‰ç…§ä¹‹å‰çš„æ€è·¯æˆ‘ä»¬è®­ç»ƒçš„ç¥ç»ç½‘ç»œæ¨¡å‹åº”è¯¥å¦‚ä¸‹ï¼š</p>
<p>&lt;img src=&quot;/images/deeplearning/C4W4-2.jpg&quot; width=&quot;550&quot; /&gt;</p>
<blockquote>
<p>å¦‚å›¾ç¤ºï¼Œè¾“å…¥ä¸€å¼ å›¾åƒï¼Œç»è¿‡CNNï¼Œæœ€åå†é€šè¿‡ Softmax è¾“å‡º 5 ä¸ªå¯èƒ½å€¼çš„å¤§å° (4ä¸ªå‘˜å·¥ä¸­çš„ä¸€ä¸ªï¼Œæˆ–è€…éƒ½ä¸æ˜¯ï¼Œæ‰€ä»¥å…±5ç§å¯èƒ½æ€§)ã€‚</p>
<p>çœ‹èµ·æ¥å¥½åƒæ²¡ä»€ä¹ˆæ¯›ç—…ï¼Œä½†æ˜¯æˆ‘ä»¬è¦ç›¸ä¿¡æˆ‘ä»¬çš„å…¬å¸ä¼šè¶Šæ¥è¶Šå¥½å•Šï¼Œæ‰€ä»¥éš¾é“å…¬å¸æ¯å¢åŠ ä¸€ä¸ªäººå°±è¦é‡æ–°è®­ç»ƒ<strong>CNN</strong> åŠ æœ€åä¸€å±‚çš„è¾“å‡ºæ•°é‡å— ï¼Ÿ</p>
</blockquote>
<p><strong>one-shotï¼š</strong></p>
<p>è¿™æ˜¾ç„¶æœ‰é—®é¢˜ï¼Œæ‰€ä»¥æœ‰äººæå‡ºäº†ä¸€æ¬¡å­¦ä¹ (one-shot)ï¼Œæ›´å…·ä½“åœ°è¯´æ˜¯é€šè¿‡ä¸€ä¸ªå‡½æ•°æ¥æ±‚å‡ºè¾“å…¥å›¾åƒä¸æ•°æ®åº“ä¸­çš„å›¾åƒçš„å·®å¼‚åº¦ï¼Œç”¨ $d(img1,img2)$ è¡¨ç¤ºã€‚</p>
<p>&lt;img src=&quot;/images/deeplearning/C4W4-3_1.png&quot; width=&quot;750&quot; /&gt;</p>
<p>å¦‚ä¸Šå›¾ç¤ºï¼Œå¦‚æœä¸¤ä¸ªå›¾åƒä¹‹é—´çš„å·®å¼‚åº¦ä¸å¤§äºæŸä¸€ä¸ªé˜ˆå€¼ <strong>Ï„</strong>ï¼Œé‚£ä¹ˆåˆ™è®¤ä¸ºä¸¤å¼ å›¾åƒæ˜¯åŒä¸€ä¸ªäººã€‚åä¹‹ï¼Œäº¦ç„¶ã€‚</p>
<blockquote>
<p>ä¸‹ä¸€å°èŠ‚ä»‹ç»äº†å¦‚ä½•è®¡ç®—å·®å€¼ã€‚</p>
</blockquote>
<h2>3. Siamese Network</h2>
<p>æ³¨æ„ï¼šä¸‹å›¾ä¸­ä¸¤ä¸ªç½‘ç»œå‚æ•°æ˜¯ä¸€æ ·çš„ã€‚</p>
<p>å…ˆçœ‹ä¸Šé¢çš„ç½‘ç»œã€‚è®°è¾“å…¥å›¾åƒä¸º $x^{(1)}$ï¼Œç»è¿‡å·ç§¯å±‚ï¼Œæ± åŒ–å±‚ å’Œ å…¨è¿æ¥å±‚ åå¾—åˆ°äº†ç®­å¤´æ‰€æŒ‡ä½ç½®çš„æ•°æ® (ä¸€èˆ¬åé¢è¿˜ä¼šæ¥ä¸Š $softmax$ å±‚ï¼Œä½†åœ¨è¿™é‡Œæš‚æ—¶ä¸ç”¨ç®¡)ï¼Œå‡è®¾æœ‰ <strong>128</strong> ä¸ªèŠ‚ç‚¹ï¼Œè¯¥å±‚ç”¨ $f(x^{(1)})$ è¡¨ç¤ºï¼Œå¯ä»¥ç†è§£ä¸ºè¾“å…¥ $x^{(1)}$ çš„ç¼–ç ã€‚</p>
<p>é‚£ä¹ˆä¸‹ä¸€ä¸ªç½‘ç»œåŒç†ï¼Œä¸å†èµ˜è¿°ã€‚</p>
<p>å› æ­¤ä¸Šä¸€èŠ‚ä¸­æ‰€è¯´çš„å·®å¼‚åº¦å‡½æ•°å³ä¸º</p>
<p>$$
d(x^{(1)},x^{(2)})=||f(x^{(1)})-f(x^{(2)})||^2
$$</p>
<p>&lt;img src=&quot;/images/deeplearning/C4W4-4_1.png&quot; width=&quot;750&quot; /&gt;</p>
<p>é—®é¢˜çœ‹èµ·æ¥å¥½åƒè§£å†³äº†ï¼Œä½†æ„Ÿè§‰è¿˜æ¼äº†ç‚¹ä»€ä¹ˆã€‚ã€‚<strong>ç¥ç»ç½‘ç»œçš„å‚æ•°å’‹ç¡®å®šå•Šï¼Ÿä¹Ÿå°±æ˜¯è¯´ $f(x^{(i)})$ çš„å‚æ•°æ€ä¹ˆè®¡ç®—å‘¢ï¼Ÿ</strong></p>
<p>é¦–å…ˆå¯ä»¥å¾ˆæ˜ç¡®çš„æ˜¯å¦‚æœä¸¤ä¸ªå›¾åƒæ˜¯åŒä¸€ä¸ªäººï¼Œé‚£æ‰€å¾—åˆ°çš„å‚æ•°åº”è¯¥ä½¿å¾— $||f(x^{(1)})-f(x^{(2)})||^2$ çš„å€¼è¾ƒå°ï¼Œåä¹‹è¾ƒå¤§ã€‚</p>
<p>&lt;img src=&quot;/images/deeplearning/C4W4-5_1.png&quot; width=&quot;750&quot; /&gt;</p>
<h2>4. Triplet Loss</h2>
<h3>4.1 Learning Objective</h3>
<p>è¿™é‡Œé¦–å…ˆä»‹ç»ä¸€ä¸ªä¸‰å…ƒç»„ï¼Œå³ <strong>(Anchor, Positive, Negative)ï¼Œç®€å†™ä¸º(A,P,N)</strong></p>
<table>
<thead>
<tr>
<th style="text-align:center">(A,P,N)</th>
<th style="text-align:center">ä¸‰å…ƒç»„ å„ä¸ªå«ä¹‰</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">Anchor</td>
<td style="text-align:center">å¯ä»¥ç†è§£ä¸ºç”¨äºè¯†åˆ«çš„å›¾åƒ ï¼ˆé”šï¼‰</td>
</tr>
<tr>
<td style="text-align:center">Positive</td>
<td style="text-align:center">è¡¨ç¤ºæ˜¯è¿™ä¸ªäºº</td>
</tr>
<tr>
<td style="text-align:center">Negative</td>
<td style="text-align:center">è¡¨ç¤ºä¸æ˜¯åŒä¸€ä¸ªäºº</td>
</tr>
</tbody>
</table>
<p>ç”±ä¸Šä¸€èŠ‚ä¸­çš„æ€è·¯ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°å¦‚ä¸‹ä¸ç­‰å¼ï¼š</p>
<blockquote>
<p>$d(A,P)\leqq d(A,N)$, å³ $||f(A)-f(P)||^2-||f(A)-f(N)||^2\leqq0$ (å¦‚ä¸‹å›¾ç¤º)</p>
</blockquote>
<p>&lt;img src=&quot;/images/deeplearning/C4W4-6_1.png&quot; width=&quot;750&quot; /&gt;</p>
<p>ä½†æ˜¯è¿™æ ·å­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼Œå³å¦‚æœç¥ç»ç½‘ç»œä»€ä¹ˆéƒ½æ²¡å­¦åˆ°ï¼Œè¿”å›çš„å€¼æ˜¯0ï¼Œä¹Ÿå°±æ˜¯è¯´å¦‚æœ $f(x)=\vec{0}$ çš„è¯ï¼Œé‚£ä¹ˆè¿™ä¸ªä¸ç­‰å¼æ˜¯å§‹ç»ˆæˆç«‹çš„ã€‚(å¦‚ä¸‹å›¾ç¤º)</p>
<p>&lt;img src=&quot;/images/deeplearning/C4W4-7_1.png&quot; width=&quot;750&quot; /&gt;</p>
<p>ä¸ºäº†é¿å…ä¸Šè¿°ç‰¹æ®Šæƒ…å†µï¼Œä¸”å·¦è¾¹å€¼å¿…é¡»å°äº0ï¼Œæ‰€ä»¥åœ¨å³è¾¹å‡å»ä¸€ä¸ªå˜é‡<strong>Î±</strong>ï¼Œä½†æŒ‰ç…§æƒ¯ä¾‹æ˜¯åŠ ä¸Šä¸€ä¸ªå€¼ï¼Œæ‰€ä»¥å°†<strong>Î±</strong>åŠ åœ¨å·¦è¾¹ã€‚</p>
<p>&lt;img src=&quot;/images/deeplearning/C4W4-8_1.png&quot; width=&quot;750&quot; /&gt;</p>
<p>&lt;img src=&quot;/images/deeplearning/C4W4-9_1.png&quot; width=&quot;750&quot; /&gt;</p>
<p>ç»¼ä¸Šï¼Œæ‰€å¾—åˆ°çš„å‚æ•°éœ€è¦æ»¡è¶³å¦‚ä¸‹ä¸ç­‰å¼</p>
<p>$$
||f(A)-f(P)||^2-||f(A)-f(N)||^2+Î±\leqq0
$$</p>
<h3>4.2 Lost function</h3>
<p>ä»‹ç»å®Œä¸‰å…ƒç»„åï¼Œæˆ‘ä»¬å¯ä»¥å¯¹å•ä¸ªå›¾åƒå®šä¹‰å¦‚ä¸‹çš„æŸå¤±å‡½æ•°(å¦‚ä¸‹å›¾ç¤º)</p>
<p>$$
L(A,P,N)=max(||f(A)-f(P)||^2-||f(A)-f(N)||^2+Î±,0)
$$</p>
<blockquote>
<p>è§£é‡Šä¸€ä¸‹ä¸ºä»€ä¹ˆç”¨<strong>max</strong>å‡½æ•°ï¼Œå› ä¸ºå¦‚æœåªè¦æ»¡è¶³ $||f(A)-f(P)||^2-||f(A)-f(N)||^2+Î±\leqq0$ï¼Œæˆ‘ä»¬å°±è®¤ä¸ºå·²ç»æ­£ç¡®è¯†åˆ«å‡ºäº†å›¾åƒä¸­çš„äººï¼Œæ‰€ä»¥å¯¹äºè¯¥å›¾åƒçš„æŸå¤±å€¼æ˜¯ 0.</p>
</blockquote>
<p>&lt;img src=&quot;/images/deeplearning/C4W4-10_1.png&quot; width=&quot;750&quot; /&gt;</p>
<p>æ‰€ä»¥æ€»çš„æŸå¤±å‡½æ•°æ˜¯ : $J=\sum{L(A^{(i)},P^{(i)},N^{(i)})}$</p>
<p>è¦æ³¨æ„çš„æ˜¯ä½¿ç”¨è¿™ç§æ–¹æ³•è¦ä¿è¯æ¯ä¸€ä¸ªäººä¸æ­¢æœ‰ä¸€å¼ å›¾åƒï¼Œå¦åˆ™æ— æ³•è®­ç»ƒã€‚å¦å¤–è¦æ³¨æ„ä¸å‰é¢çš„ <strong>One-shot</strong> åŒºåˆ†å¼€æ¥ï¼Œè¿™é‡Œæ˜¯åœ¨è®­ç»ƒæ¨¡å‹ï¼Œæ‰€ä»¥è®­ç»ƒé›†çš„æ•°é‡è¦å¤šä¸€äº›ï¼Œæ¯ä¸ªäººè¦æœ‰å¤šå¼ ç…§ç‰‡ã€‚è€ŒOne-shotæ˜¯è¿›è¡Œæµ‹è¯•äº†ï¼Œæ‰€ä»¥åªéœ€ä¸€å¼ ç”¨äºè¾“å…¥çš„ç…§ç‰‡å³å¯ã€‚</p>
<h3>4.3 Choosing the triplets(A,P,N)</h3>
<p>è¿˜æœ‰ä¸€ä¸ªå¾ˆé‡è¦çš„é—®é¢˜å°±æ˜¯å¦‚ä½•é€‰æ‹©ä¸‰å…ƒç»„ <strong>(A,P,N)</strong>ã€‚å› ä¸ºå®é™…ä¸Šè¦æ»¡è¶³ä¸ç­‰å¼ $d(A,P)+Î±\leqq d(A,N)$ æ˜¯æ¯”è¾ƒç®€å•çš„,å³åªè¦å°† Negative é€‰æ‹©çš„æ¯”è¾ƒæç«¯ä¾¿å¯ï¼Œæ¯”å¦‚ Anchor æ˜¯ä¸€ä¸ªå°å¥³å­©ï¼Œè€Œ Negative é€‰æ‹©ä¸€ä¸ªè€å¤§çˆ·ã€‚</p>
<p>æ‰€ä»¥è¿˜åº”è¯¥å°½é‡æ»¡è¶³ $d(A,N)\approx{d(A,N)}$</p>
<p>&lt;img src=&quot;/images/deeplearning/C4W4-11_1.png&quot; width=&quot;750&quot; /&gt;</p>
<h2>5. Face Verification and Binary Classification</h2>
<p>é€šè¿‡ä»¥ä¸Šå†…å®¹ï¼Œæˆ‘ä»¬å¯ä»¥ç¡®å®šä¸‹å›¾ä¸­çš„ç½‘ç»œçš„å‚æ•°äº†ï¼Œé‚£ä¹ˆç°åœ¨å¼€å§‹è¿›è¡Œé¢éƒ¨éªŒè¯äº†ã€‚</p>
<p><strong>ä¸Šé¢çš„æ˜¯æµ‹è¯•å›¾ï¼Œä¸‹é¢çš„æ˜¯æ•°æ®åº“ä¸­çš„ä¸€å¼ ç…§ç‰‡</strong></p>
<p>å’Œä¹‹å‰ä¸€æ ·å‡è®¾ $f(x^{(i)})$ æœ‰ 128ä¸ªèŠ‚ç‚¹ï¼Œä¹‹åè¿™ä¸¤ä¸ªæ•°æ®ä½œä¸ºè¾“å…¥æ•°æ®è¾“å…¥åˆ°åé¢çš„é€»è¾‘å›å½’æ¨¡å‹ä¸­å»ï¼Œå³</p>
<p>$$
\hat{y} = Ïƒ(\sum_{k=1}^{128}w_i|f(x^{(i)})_k-f(x^{(j)})_k|+b_i)
$$</p>
<p>è‹¥ $\hat{y}=1$, ä¸ºåŒä¸€äººã€‚åä¹‹ï¼Œä¸æ˜¯ã€‚</p>
<p>å¦‚ä¸‹å›¾ç¤ºï¼Œç»¿è‰²ä¸‹åˆ’çº¿éƒ¨åˆ†å¯ä»¥ç”¨å…¶ä»–å…¬å¼æ›¿æ¢ï¼Œå³æœ‰</p>
<p>$$
\hat{y}=Ïƒ(\sum_{k=1}^{128}w_i \frac{(f(x^{(i)})_k-f(x^{(j)})_k)^2}{f(x^{(i)})_k+f(x^{(j)})_k}+b_i)
$$</p>
<p>&lt;img src=&quot;/images/deeplearning/C4W4-12_1.png&quot; width=&quot;750&quot; /&gt;</p>
<p>å½“ç„¶æ•°æ®åº“ä¸­çš„å›¾åƒä¸ç”¨æ¯æ¬¡æ¥ä¸€å¼ éœ€è¦éªŒè¯çš„å›¾åƒéƒ½é‡æ–°è®¡ç®—ï¼Œå…¶å®å¯ä»¥æå‰è®¡ç®—å¥½ï¼Œå°†ç»“æœä¿å­˜èµ·æ¥ï¼Œè¿™æ ·å°±å¯ä»¥åŠ å¿«è¿ç®—çš„é€Ÿåº¦äº†ã€‚</p>
<p>&lt;img src=&quot;/images/deeplearning/C4W4-13_1.png&quot; width=&quot;750&quot; /&gt;</p>
<h2>6. What is neural style transfer?</h2>
<p>&lt;img src=&quot;/images/deeplearning/C4W4-14_1.png&quot; width=&quot;750&quot; /&gt;</p>
<h2>7. What are deep ConvNets learning?</h2>
<p>&lt;img src=&quot;/images/deeplearning/C4W4-15_1.png&quot; width=&quot;750&quot; /&gt;</p>
<blockquote>
<p>ç¬¬ä¸€å±‚åªèƒ½çœ‹åˆ°å°éƒ¨åˆ†å·ç§¯ç¥ç».</p>
<p>ä½ é€‰æ‹©ä¸€ä¸ªéšè—å•å…ƒï¼Œå‘ç°æœ‰9ä¸ªå›¾ç‰‡ï¼Œæœ€å¤§åŒ–äº†å•å…ƒæ¿€æ´»ï¼Œä½ å¯èƒ½æ‰¾åˆ°ç±»ä¼¼è¿™æ ·çš„å›¾ç‰‡æµ…å±‚åŒºåŸŸ.</p>
</blockquote>
<p>&lt;img src=&quot;/images/deeplearning/C4W4-16_1.png&quot; width=&quot;750&quot; /&gt;</p>
<h2>8. Cost Function</h2>
<p>å¦‚ä¸‹å›¾ç¤ºï¼š</p>
<p>&lt;img src=&quot;/images/deeplearning/C4W4-17_1.png&quot; width=&quot;750&quot; /&gt;</p>
<p>å·¦ä¸Šè§’çš„åŒ…å« Content çš„å›¾ç‰‡ç®€ç§°ä¸º Cï¼Œå³ä¸Šè§’åŒ…å« Style çš„ç®€ç§° Sï¼ŒäºŒè€…èåˆåå¾—åˆ°çš„å›¾ç‰‡ç®€ç§°ä¸º Gã€‚</p>
<p>æˆ‘ä»¬çŸ¥é“è®¡ç®—é—®é¢˜é¡»æ˜¯æœ‰é™çš„ï¼Œæ‰€ä»¥èåˆçš„æ ‡å‡†æ˜¯ä»€ä¹ˆï¼Ÿä¹Ÿå°±æ˜¯è¯´ Content çš„ä¿ç•™ç¨‹åº¦å’Œ Style çš„è¿ç”¨ç¨‹åº¦å¦‚ä½•å–èˆå‘¢ï¼Ÿ</p>
<p>æ­¤æ—¶å¼•å…¥æŸå¤±å‡½æ•°ï¼Œå¹¶å¯¹å…¶è¿›è¡Œæœ€ä¼˜åŒ–ï¼Œè¿™æ ·ä¾¿å¯å¾—åˆ°æœ€ä¼˜è§£ã€‚</p>
<p>$$
J(G)=Î±J_{Content}(C,G)+Î²J_{Style}(S,G)
$$</p>
<blockquote>
<p>$J(G)$ å®šä¹‰ç”¨æ¥ç”Ÿæˆå›¾åƒçš„å¥½åï¼Œ$J_{Content}(C,G)$ è¡¨ç¤º å›¾åƒ$C$ å’Œ å›¾åƒ$G$ ä¹‹é—´çš„å·®å¼‚ï¼Œ$J_{Style}(S,G)$ åŒç†ã€‚</p>
</blockquote>
<p><strong>è®¡ç®—è¿‡ç¨‹ç¤ºä¾‹</strong>ï¼š</p>
<blockquote>
<p>éšæœºåˆå§‹åŒ–å›¾åƒ $G$ï¼Œå‡è®¾ä¸º 100*100*3 ï¼ˆmaybe 500*500*3ï¼‰ (å¦‚ä¸‹å›¾å³è¾¹å››ä¸ªå›¾åƒæœ€ä¸Šé¢é‚£ä¸ªæ‰€ç¤º)</p>
<p>ä½¿ç”¨æ¢¯åº¦ä¸‹é™ä¸æ–­ä¼˜åŒ– $J(G)$ã€‚ (ä¼˜åŒ–è¿‡ç¨‹å¦‚ä¸‹å›¾å³è¾¹ä¸‹é¢3ä¸ªå›¾åƒæ‰€ç¤º)</p>
</blockquote>
<p>&lt;img src=&quot;/images/deeplearning/C4W4-18_1.png&quot; width=&quot;750&quot; /&gt;</p>
<blockquote>
<p>ä¸‹é¢ä¸€å°èŠ‚å°†å…·ä½“ä»‹ç» <strong>Cost Function</strong> çš„è®¡ç®—ã€‚</p>
</blockquote>
<h2>9. Content Cost Function</h2>
<p>é¦–å…ˆå‡è®¾æˆ‘ä»¬ä½¿ç”¨ <strong>ç¬¬ $l$ å±‚</strong> éšè—å±‚ æ¥è®¡ç®— $J_{Content}(C,G)$ï¼Œæ³¨æ„è¿™é‡Œçš„ <strong>$l$</strong> ä¸€èˆ¬å–åœ¨ä¸­é—´å±‚ï¼Œè€Œä¸æ˜¯æœ€å‰é¢çš„å±‚ï¼Œæˆ–è€…æœ€åå±‚</p>
<blockquote>
<p>åŸå› å¦‚ä¸‹ï¼š</p>
<ul>
<li>å‡å¦‚å–<strong>ç¬¬1å±‚</strong>ï¼Œé‚£ä¹ˆå¾—åˆ°çš„ $G$ å›¾åƒ å°†ä¼šä¸ å›¾åƒ$C$ åƒç´ çº§åˆ«çš„ç›¸ä¼¼ï¼Œè¿™æ˜¾ç„¶ä¸è¡Œã€‚</li>
<li>å‡å¦‚å–å¾ˆæ·±å±‚ï¼Œé‚£ä¹ˆè¯¥å±‚å·²ç»æå–å‡ºäº†æ¯”è¾ƒé‡è¦çš„ç‰¹å¾ï¼Œä¾‹å¦‚ å›¾åƒ$C$ ä¸­æœ‰ä¸€æ¡ç‹—ï¼Œé‚£ä¹ˆå¾—åˆ°çš„ å›¾åƒ$G$ ä¼šè¿‡åº¦çš„ä¿ç•™è¿™ä¸ªç‰¹å¾ã€‚</li>
</ul>
</blockquote>
<ul>
<li>ç„¶åä½¿ç”¨é¢„å…ˆè®­ç»ƒå¥½çš„å·ç§¯ç¥ç»ç½‘ç»œï¼Œå¦‚ VGGç½‘ç»œã€‚è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥å¾—åˆ° å›¾åƒ$C$ å’Œ å›¾åƒ$G$ åœ¨ç¬¬$l$å±‚çš„æ¿€æ´»å‡½æ•°å€¼ï¼Œåˆ†åˆ«è®°ä¸º $a^{[l][C]},a^{[l][G]}$</li>
<li>å†…å®¹æŸå¤±å‡½æ•° $J_{Content}(C,G) = \frac{1}{2} || a^{[l][C]} - a^{[l][G]} ||^2$</li>
</ul>
<p>&lt;img src=&quot;/images/deeplearning/C4W4-19_1.png&quot; width=&quot;750&quot; /&gt;</p>
<h2>10. Style Cost Function</h2>
<h3>10.1 ä»€ä¹ˆæ˜¯â€œé£æ ¼â€</h3>
<p>è¦è®¡ç®—é£æ ¼æŸå¤±å‡½æ•°ï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦çŸ¥é“â€œé£æ ¼(Style)â€æ˜¯ä»€ä¹ˆã€‚</p>
<p>æˆ‘ä»¬ä½¿ç”¨ $l$ å±‚çš„æ¿€æ´»æ¥åº¦é‡â€œStyleâ€ï¼Œå°†â€œStyleâ€å®šä¹‰ä¸ºé€šé“é—´æ¿€æ´»å€¼ä¹‹é—´çš„<strong>ç›¸å…³ç³»æ•°</strong>ã€‚(<strong>Define style as correlation between activation across channels</strong>)</p>
<p>&lt;img src=&quot;/images/deeplearning/C4W4-20_1.png&quot; width=&quot;750&quot; /&gt;</p>
<p>é‚£ä¹ˆæˆ‘ä»¬å¦‚ä½•è®¡ç®—è¿™ä¸ªæ‰€è°“çš„ç›¸å…³ç³»æ•°å‘¢ï¼Ÿ</p>
<p>ä¸‹å›¾æ˜¯æˆ‘ä»¬ä»ä¸Šå›¾ä¸­æ‰€æ ‡è¯†çš„ç¬¬ $l$ å±‚ï¼Œä¸ºæ–¹ä¾¿è¯´æ˜ï¼Œå‡è®¾åªæœ‰ 5 å±‚é€šé“ã€‚</p>
<p>&lt;img src=&quot;/images/deeplearning/C4W4-21_1.png&quot; width=&quot;350&quot; /&gt;</p>
<p>å¦‚ä¸Šå›¾ç¤ºï¼Œçº¢è‰²é€šé“å’Œé»„è‰²é€šé“å¯¹åº”ä½ç½®éƒ½æœ‰æ¿€æ´»é¡¹ï¼Œè€Œæˆ‘ä»¬è¦æ±‚çš„ä¾¿æ˜¯å®ƒä»¬ä¹‹é—´çš„<strong>ç›¸å…³ç³»æ•°</strong>ã€‚</p>
<p>ä½†æ˜¯ä¸ºä»€ä¹ˆè¿™ä¹ˆæ±‚å‡ºæ¥æ˜¯æœ‰æ•ˆçš„å‘¢ï¼Ÿä¸ºä»€ä¹ˆå®ƒä»¬èƒ½å¤Ÿåæ˜ å‡ºé£æ ¼å‘¢ï¼Ÿ</p>
<p>ç»§ç»­å¾€ä¸‹çœ‹â†“</p>
<h3>10.2 å›¾åƒé£æ ¼çš„ç›´è§‚ç†è§£</h3>
<p>å¦‚å›¾é£æ ¼å›¾åƒæœ‰ <strong>5</strong> å±‚é€šé“ï¼Œä¸”è¯¥å›¾åƒçš„å¯è§†åŒ–ç‰¹å¾å¦‚ &lt;font color=&quot;blue&quot;&gt;å·¦ä¸‹è§’å›¾&lt;/font&gt; æ‰€ç¤ºã€‚</p>
<p>&lt;img src=&quot;/images/deeplearning/C4W4-22_1.png&quot; width=&quot;800&quot; /&gt;</p>
<p>å…¶ä¸­çº¢è‰²é€šé“å¯è§†åŒ–ç‰¹å¾å¦‚å›¾ä¸­<strong>ç®­å¤´</strong>æ‰€æŒ‡æ˜¯<strong>å‚ç›´æ¡çº¹</strong>ï¼Œè€Œ<strong>é»„è‰²é€šé“çš„ç‰¹å¾åˆ™æ˜¯æ©˜è‰²èƒŒæ™¯</strong>ã€‚
&lt;!--&lt;img src=&quot;/images/deeplearning/C4W4-22_2.png&quot; width=&quot;750&quot; /&gt;
--&gt;
é‚£ä¹ˆé€šè¿‡è®¡ç®—è¿™ä¸¤å±‚é€šé“çš„ç›¸å…³ç³»æ•°æœ‰ä»€ä¹ˆç”¨å‘¢ï¼Ÿ</p>
<blockquote>
<p>å…¶å®å¾ˆå¥½ç†è§£ï¼Œå¦‚æœ<strong>äºŒè€…ç›¸å…³ç³»æ•°æ€§å¼ºï¼Œé‚£ä¹ˆå¦‚æœå‡ºç°æ©˜è‰²èƒŒæ™¯ï¼Œé‚£ä¹ˆå°±åº”è¯¥å¾ˆå¤§æ¦‚ç‡å‡ºç°å‚ç›´æ¡çº¹</strong>ã€‚åä¹‹ï¼Œäº¦ç„¶ã€‚</p>
</blockquote>
<h3>10.3 é£æ ¼ç›¸å…³ç³»æ•°çŸ©é˜µ</h3>
<p>ä»¤ $a_{i,j,k}^{[l]}$ è¡¨ç¤º <strong>(i,j,k)</strong> çš„æ¿€æ´»é¡¹ï¼Œå…¶ä¸­ <strong>i,j,k</strong> åˆ†åˆ«è¡¨ç¤ºé«˜åº¦å€¼(H)ï¼Œå®½åº¦å€¼(W) åŠ æ‰€åœ¨é€šé“å±‚æ¬¡(C)ã€‚</p>
<p>é£æ ¼çŸ©é˜µ(ä¹Ÿç§°ä¸ºâ€œ<strong>Gram Matrix</strong>â€)ç”¨ $G^{[l]}$ è¡¨ç¤ºï¼Œå…¶å¤§å°ä¸º $n_c^{l]}*n_c^{l]}$.</p>
<p>å› æ­¤é£æ ¼å›¾åƒçš„é£æ ¼çŸ©é˜µä¸ºï¼š</p>
<p>$$
G_{kk'}^{<a href="S">l</a>}=\sum_{i=1}^{n_H^{[l]}}\sum_{j=1}^{n_W^{[l]}}a_{i,j,k}^{<a href="S">l</a>}a_{i,j,k'}^{<a href="S">l</a>}
$$</p>
<p>ç”Ÿæˆå›¾åƒçš„ç›¸å…³ç³»æ•°çŸ©é˜µ</p>
<p>$$
G_{kk'}^{<a href="G">l</a>}=\sum_{i=1}^{n_H^{[l]}}\sum_{j=1}^{n_W^{[l]}}a_{i,j,k}^{<a href="G">l</a>}a_{i,j,k'}^{<a href="G">l</a>}
$$</p>
<p>&lt;img src=&quot;/images/deeplearning/C4W4-23_1.png&quot; width=&quot;750&quot; /&gt;</p>
<h3>10.4 é£æ ¼æŸå¤±å‡½æ•°</h3>
<p>&lt;img src=&quot;/images/deeplearning/C4W4-24_1.png&quot; width=&quot;750&quot; /&gt;</p>
<p>ç¬¬ $l$ å±‚çš„é£æ ¼æŸå¤±å‡½æ•°ä¸ºï¼š</p>
<p>$$
J_{Style}^{[l]} (S, G) = \frac {1} { (2n_H^{[l]} n_W^{[l]} n_C^{[l]})^2 } \sum_{k}\sum_{k'} (G_{kk'}^{[l](S)} - G_{kk'}^{[l](G)})
$$</p>
<p>æ€»çš„é£æ ¼æŸå¤±å‡½æ•°ï¼š</p>
<p>$$
J_{Style}(S,G) = \sum_{l}Î»^{[l]}J_{Style}C4^{[l]}(S,G)
$$</p>
<h2>11. 1D and 3D Generalizations</h2>
<p>1D generalizations of models</p>
<p>&lt;img src=&quot;/images/deeplearning/C4W4-25_1.png&quot; width=&quot;750&quot; /&gt;</p>
<p>3D generalizations of models</p>
<p>&lt;img src=&quot;/images/deeplearning/C4W4-26_1.png&quot; width=&quot;750&quot; /&gt;</p>
<blockquote>
<p>åŒ»å­¦å›¾åƒ ä¸ è§†é¢‘æ£€æµ‹ éƒ½æ˜¯ 3D çš„.</p>
</blockquote>
<h2>Reference</h2>
<ul>
<li><a href="https://study.163.com/my#/smarts" target="_blank" rel="noopener">ç½‘æ˜“äº‘è¯¾å ‚ - deeplearning</a></li>
<li><a href="http://www.cnblogs.com/marsggbo/p/7470989.html" target="_blank" rel="noopener">DeepLearning.aiå­¦ä¹ ç¬”è®°æ±‡æ€»</a></li>
</ul>

      
     <!-- by blair add this if sentence at 20160725 -->
      <br>
      
<div id="bottom-donation-section">
<span style="font-size: 1.0em; padding:0em 1em 0.5em 1em; margin: 0 auto;">
  <strong style="vertical-align: top;">åˆ†äº«åˆ°:</strong>
    <div class="j_handlclick"  style="background: url(/images/logos/share_facebook_icon.jpg);background-size: contain;display: inline-block; width:50px; height:50px" href="https://www.facebook.com/sharer/sharer.php?u=" target="_blank">
    </div>
    <div class="j_handlclick"  style="background: url(/images/logos/share_weibo_icon.png);background-size: contain;display: inline-block; width:50px; height:50px" href="https://service.weibo.com/share/share.php?url" target="_blank">
    </div>
    <div class="j_handlclick"  style="background: url(/images/logos/share_wechat_icon.jpg);background-size: contain;display: inline-block; width:50px; height:50px" href="https://api.addthis.com/oexchange/0.8/forward/wechat/offer?url=" target="_blank">
    </div>
    <div class="j_handlclick"  style="background: url(/images/logos/share_twitter_icon.jpg);background-size: contain;display: inline-block; width:50px; height:50px" href="https://twitter.com/intent/tweet?url=" target="_blank">
    </div>
  <br>  
  <br>  
  &nbsp;&nbsp;å¦‚æœæ‚¨è§‰å¾—è¿™ç¯‡æ–‡ç« å¯¹æ‚¨çš„å­¦ä¹ å¾ˆæœ‰å¸®åŠ©, è¯·æ‚¨ä¹Ÿåˆ†äº«å®ƒ, è®©å®ƒèƒ½å†æ¬¡å¸®åŠ©åˆ°æ›´å¤šçš„éœ€è¦å­¦ä¹ çš„äºº.
æ‚¨çš„<a href="/support/"><strong>æ”¯æŒ</strong></a>å°†é¼“åŠ±æˆ‘ç»§ç»­åˆ›ä½œ !
  <br>  

</span>
<!--
<h3 id="bottom-donation-title">æ”¯æŒ è®©æ–‡ç« å˜å¾—æ›´ä¼˜è´¨</h3>
<div>
<a id="bottom-donation-button" href="/support">ç‚¹æˆ‘ èµåŠ© ä½œè€…</a>
</div>
-->
</div>
<div class="well">
  <!--
  åŸåˆ›æ–‡ç« ï¼Œè½¬è½½è¯·æ³¨æ˜ï¼š è½¬è½½è‡ª<a href="http://52binge.github.io" target="_blank" rel="noopener"> Blair Chan's Blog</a>ï¼Œä½œè€…ï¼š
  <a href="/about">Blair Chan</a> <br>
  -->
  æœ¬æ–‡åŸºäº<a target="_blank" title="Creative Commons Attribution 4.0 international License" href="https://creativecommons.org/licenses/by-nc/4.0/">ç½²å4.0å›½é™…è®¸å¯åè®®</a>å‘å¸ƒï¼Œè½¬è½½è¯·ä¿ç•™æœ¬æ–‡ç½²åå’Œæ–‡ç« é“¾æ¥ã€‚ å¦‚æ‚¨æœ‰ä»»ä½•æˆæƒæ–¹é¢çš„åå•†ï¼Œè¯·é‚®ä»¶è”ç³»æˆ‘ã€‚
</div>
 <!-- by blair add 160724-->
    
    </div>
    
      <div class="article-toc">
        <h3>Contents</h3>
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#null"><span class="toc-text">1. What is face recognition?</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#null"><span class="toc-text">2. One Shot Learning</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#null"><span class="toc-text">3. Siamese Network</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#null"><span class="toc-text">4. Triplet Loss</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#null"><span class="toc-text">4.1 Learning Objective</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#null"><span class="toc-text">4.2 Lost function</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#null"><span class="toc-text">4.3 Choosing the triplets(A,P,N)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#null"><span class="toc-text">5. Face Verification and Binary Classification</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#null"><span class="toc-text">6. What is neural style transfer?</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#null"><span class="toc-text">7. What are deep ConvNets learning?</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#null"><span class="toc-text">8. Cost Function</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#null"><span class="toc-text">9. Content Cost Function</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#null"><span class="toc-text">10. Style Cost Function</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#null"><span class="toc-text">10.1 ä»€ä¹ˆæ˜¯â€œé£æ ¼â€</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#null"><span class="toc-text">10.2 å›¾åƒé£æ ¼çš„ç›´è§‚ç†è§£</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#null"><span class="toc-text">10.3 é£æ ¼ç›¸å…³ç³»æ•°çŸ©é˜µ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#null"><span class="toc-text">10.4 é£æ ¼æŸå¤±å‡½æ•°</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#null"><span class="toc-text">11. 1D and 3D Generalizations</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#null"><span class="toc-text">Reference</span></a></li></ol>
      </div>
    
    
      <footer class="article-footer">
        <!-- <div class="well" style="width:100px; height:30px;"></div>  by blair-->
        
  <div class="article-category">
    <a class="article-category-link" href="/categories/deeplearning/">deeplearning</a>
  </div>

 <!-- by blair add 160724-->
        <!--
        <div style="width:100px; height:30px;"></div> by blair add 160724
        -->
        
  <div class="article-tag">
    <a class="article-tag-link" href="/tags/deeplearning-ai/" rel="tag">deeplearning.ai</a>
  </div>


      </footer>
    
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2018/09/11/python/numpy-pandas/py-numpy-9-newaxis/" id="article-nav-newer" class="article-nav-link-wrap">
      <div class="article-nav-title"><span>&lt;</span>&nbsp;
        
          numpy.newaxis è½¬å˜çŸ©é˜µçš„å½¢ç‹€
        
      </div>
    </a>
  
  
    <a href="/2018/09/01/deeplearning/deeplearning-CS231n-P1/" id="article-nav-older" class="article-nav-link-wrap">
      <div class="article-nav-title">æ·±åº¦å­¦ä¹ ä¸è®¡ç®—æœºè§†è§‰ - å†å²å›é¡¾ä¸ä»‹ç»&nbsp;<span>&gt;</span></div>
    </a>
  
</nav>

  
</article>

<section id="comments">
  <div id="disqus_thread">
    <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  </div>
</section>

</section>
    <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2019 Blair Chan&nbsp;
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>, theme by <a href="http://github.com/52binge/hexo-theme-blairos" target="_blank" rel="noopener">blairos</a>
    </div>
  </div>
</footer>

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX"],
    tex2jax: {
      inlineMath: [ ['$','$'], ['\\(','\\)'] ],
      displayMath: [ ['$$','$$']],
      processEscapes: true
    }
  });
</script>
<script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML,http://myserver.com/MathJax/config/local/local.js">
</script>

    
<script type="text/javascript"> <!-- add by blair 0724 type=text/javascript -->
  var disqus_shortname = 'blairos-sn';
  
  var disqus_url = 'http://iequa.com/2018/09/08/deeplearning/Convolutional-Neural-Networks-week4/';
  
  (function(){
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>


<script src="/js/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

  </div>
</body>
</html>
