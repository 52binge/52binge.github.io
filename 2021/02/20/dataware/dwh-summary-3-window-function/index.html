<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>DataWare Review Summary 3 - Window Function - Auckland New Zealand</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="keywords" content="SQL">
<meta property="og:type" content="article">
<meta property="og:title" content="DataWare Review Summary 3 - Window Function">
<meta property="og:url" content="http:&#x2F;&#x2F;iequa.com&#x2F;2021&#x2F;02&#x2F;20&#x2F;dataware&#x2F;dwh-summary-3-window-function&#x2F;index.html">
<meta property="og:site_name" content="Auckland New Zealand">
<meta property="og:locale" content="en">
<meta property="og:image" content="http:&#x2F;&#x2F;iequa.com&#x2F;images&#x2F;sql&#x2F;sql-window-fun-4.png">
<meta property="og:image" content="http:&#x2F;&#x2F;iequa.com&#x2F;images&#x2F;sql&#x2F;sql-window-fun-5.jpg">
<meta property="og:image" content="http:&#x2F;&#x2F;iequa.com&#x2F;images&#x2F;sql&#x2F;sql-window-fun-6.png">
<meta property="og:image" content="http:&#x2F;&#x2F;iequa.com&#x2F;images&#x2F;sql&#x2F;sql-window-fun-7.png">
<meta property="og:image" content="http:&#x2F;&#x2F;iequa.com&#x2F;images&#x2F;sql&#x2F;sql-window-fun-1.jpg">
<meta property="og:image" content="http:&#x2F;&#x2F;iequa.com&#x2F;images&#x2F;sql&#x2F;sql-window-fun-2.jpg">
<meta property="og:image" content="http:&#x2F;&#x2F;iequa.com&#x2F;images&#x2F;sql&#x2F;sql-window-fun-3.jpg">
<meta property="og:image" content="http:&#x2F;&#x2F;iequa.com&#x2F;images&#x2F;sql&#x2F;sql-window-fun-8.jpg">
<meta property="og:updated_time" content="2021-02-22T02:53:31.369Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http:&#x2F;&#x2F;iequa.com&#x2F;images&#x2F;sql&#x2F;sql-window-fun-4.png">
  
  
    <link rel="icon" href="/css/images/favicon-Tiktok.ico">
  
  <link href="/webfonts/ptserif/main.css" rel='stylesheet' type='text/css'>
  <link href="/webfonts/source-code-pro/main.css" rel="stylesheet" type="text/css">
  <link rel="stylesheet" href="/css/style.css">
  

</head>

<body>
  <div id="container">
    <!-- blair add baidu tongji start... @2017.10.03 -->
<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?8864dc75a81a27b7e44c00138af95d66";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>
<!-- blair add baidu tongji end ! @2017.10.03 -->

<!-- jiangting add start... @2020.08.30 -->
<!-- <div id="menu" class="duration-main" style="background-color: #e7e7e7"> -->
<!--   <p class="links-p" href="/">Blair</p> -->
<!--   <address class="icons"> -->
<!--     <a href="https://github.com/blair101" class="icon-font icon linkedin" target="_blank"></a> -->
<!--     <a href="https://cn.linkedin.com/pub/tianyu-dai/a8/818/44a" class="icon-font icon linkedin" target="_blank"></a> -->
<!--   </address> -->
<!--   <div class="hr1"></div> -->
<!--   <nav> -->
<!--     <div> -->
<!--     <a class="home" href="/">Home</a></div> -->
<!--     <p class="links-p" href="/">Home</p> -->
<!--     <nav class="tag-ath"> -->
<!--       <a class="proj" href="/categories">Category</a> -->
<!--       <a class="authors" href="/about">About</a> -->
<!--     </nav> -->
<!--   </nav> -->
<!--   <div class="hr2"></div> -->
<!--     <p class="links-p">Links</p> -->
<!--       <address class="links"> -->
<!--       <a class="proj" href="/article/Create-MyWorld">Projects</a> -->
<!--       <a class="friend">Friends</a></address><div class="hr3"> -->
<!--   </div> -->
<!--   <p class="end"></p> -->
<!--   <div id="menu-links" class="duration-main" style="top: -400px; background-color: #f5f5f5"> -->
<!--     <address> -->
<!--       <li><a target="_blank" href="http://lm7.xxxxxxxx.jp">Lm7</a></li> -->
<!--       <li><a target="_blank" href="http://www.pixiv.net/member.php?id=4933015">Domik</a></li> -->
<!--       <li><a target="_blank" href="http://hana-ui.moe">hana-ui</a></li> -->
<!--       <li><a target="_blank" href="http://fil.dtysky.moe">F-I-L</a></li> -->
<!--       <li><a target="_blank" href="http://paradise.dtysky.moe">Paradise</a></li> -->
<!--       <li><a target="_blank" href="http://moe-notes.dtysky.moe">MoeNotes</a></li> -->
<!--       <li><a target="_blank" href="http://kanata.dtysky.moe">Kanata</a></li> -->
<!--       <li><a target="_blank" href="http://blog.nekohand.moe">Nekohand</a></li> -->
<!--       <li><a target="_blank" href="http://www.jerryfu.net">JerryFu</a></li> -->
<!--       <li><a target="_blank" href="http://kawabangga.com">南史</a></li> -->
<!--       <li><a>Hide Links</a></li> -->
<!--       <li><a></a></li> -->
<!--     </address> -->
<!--   </div> -->
<!-- </div> -->
<!-- jiangting add end !  @2020.08.30 -->

<header id="header">
  <div id="header-outer" class="outer">
    <div id="header-inner" class="inner">
      <a id="main-nav-toggle" class="nav-icon" href="javascript:;" target="_blank" rel="noopener"></a>
      <a id="logo" class="logo" href="/"></a>
      <nav id="main-nav">
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
          <a class="main-nav-link" href="/categories">Categories</a>
        
          <a class="main-nav-link" href="/tweet">Tweet</a>
        
          <a class="main-nav-link" href="/about">About</a>
        
      </nav>
      <nav id="sub-nav">
        <div id="search-form-wrap">
          <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://iequa.com"></form>
        </div>
      </nav>
    </div>
  </div>
</header>

    <br>
    <section id="main" class="outer"><article id="post-dataware/dwh-summary-3-window-function" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      DataWare Review Summary 3 - Window Function
      <small class=article-detail-date-index>&nbsp; 2021-02-20</small>
    </h1>
  


        <div class=page-title></div>
        <br>
      </header>
    
    <div class="article-meta">
      <!--<a href="/2021/02/20/dataware/dwh-summary-3-window-function/" class="article-date">
  <time datetime="2021-02-20T01:07:21.000Z" itemprop="datePublished">2021-02-20</time>
</a>-->
      <!-- 
  <div class="article-category">
    <a class="article-category-link" href="/categories/data-warehouse/">data-warehouse</a>
  </div>

--><!-- by blair 160724 -->
      <!-- by blair
      
        <div class="article-comment-link-wrap">
          <a href="http://iequa.com/2021/02/20/dataware/dwh-summary-3-window-function/#disqus_thread" class="article-comment-link">Comments</a>
        </div>
      
      -->
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p><img src="/images/sql/sql-window-fun-4.png" width="580" alt="（Window Function）是 SQL2003 标准中定义的一项新特性，并在 SQL2011、SQL2016 中完善" /></p>
<a id="more"></a>
<p><code>Window Function</code> 不同于 普通函数和聚合函数，它为每行数据进行一次计算：<strong>输入多行(一个窗口), 返回一个值</strong>. </p>
<h2 id="1-Window-Function-SQL"><a href="#1-Window-Function-SQL" class="headerlink" title="1. Window Function, SQL"></a>1. Window Function, SQL</h2><p>特点就是 OVER 关键字:</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">window_function (expression) OVER (</span><br><span class="line">   [ PARTITION BY part_list ]</span><br><span class="line">   [ ORDER BY order_list ]</span><br><span class="line">   [ &#123; ROWS | RANGE &#125; BETWEEN frame_start AND frame_end ] )</span><br><span class="line"></span><br><span class="line"><span class="comment"># 1. PARTITION BY 表示将数据先按 part_list 进行分区</span></span><br><span class="line"><span class="comment"># 2. ORDER BY 表示将各个分区内的数据按 order_list 进行排序</span></span><br></pre></td></tr></table></figure>
<p><img src="/images/sql/sql-window-fun-5.jpg" width="780" alt="" /></p>
<p>最后一项表示 Frame 的定义，即：当前窗口包含哪些数据？</p>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">type</th>
<th>frame sql</th>
<th style="text-align:center">example</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><strong>ROWS</strong></td>
<td>ROWS BETWEEN 3 PRECEDING AND 3 FOLLOWING</td>
<td style="text-align:center">表示往前 3 行到往后 3 行，一共 7 行数据（或小于 7 行，如果碰到了边界）</td>
</tr>
<tr>
<td style="text-align:center"><strong>RANGE</strong></td>
<td>RANGE BETWEEN 3 PRECEDING AND 3 FOLLOWING</td>
<td style="text-align:center">表示所有值在 $[c-3,c+3]$ 这个范围内的行，$c$ 为当前行的值</td>
</tr>
</tbody>
</table>
</div>
<p><img src="/images/sql/sql-window-fun-6.png" width="780" alt="" /></p>
<p>逻辑语义上说，一个窗口函数的计算“过程”如下：</p>
<blockquote>
<ol>
<li>按窗口定义，将所有输入数据分区、再排序（如果需要的话）</li>
<li>对每一行数据，计算它的 Frame 范围</li>
<li>将 Frame 内的行集合输入窗口函数，计算结果填入当前行</li>
</ol>
</blockquote>
<p>举个例子：</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> dealer_id, emp_name, sales,</span><br><span class="line">       ROW_NUMBER() <span class="keyword">OVER</span> (<span class="keyword">PARTITION</span> <span class="keyword">BY</span> dealer_id <span class="keyword">ORDER</span> <span class="keyword">BY</span> sales) <span class="keyword">AS</span> <span class="keyword">rank</span>,</span><br><span class="line">       <span class="keyword">AVG</span>(sales) <span class="keyword">OVER</span> (<span class="keyword">PARTITION</span> <span class="keyword">BY</span> dealer_id) <span class="keyword">AS</span> avgsales </span><br><span class="line"><span class="keyword">FROM</span> sales</span><br><span class="line"></span><br><span class="line"><span class="comment"># 上述查询中，rank 列表示在当前经销商下，该雇员的销售排名；</span></span><br><span class="line"><span class="comment"># avgsales 表示当前经销商下所有雇员的平均销售额。查询结果如下</span></span><br><span class="line">+<span class="comment">------------+-----------------+--------+------+---------------+</span></span><br><span class="line">| dealer_id  | emp_name        | sales  | <span class="keyword">rank</span> | avgsales      |</span><br><span class="line">+<span class="comment">------------+-----------------+--------+------+---------------+</span></span><br><span class="line">| <span class="number">1</span>          | Raphael Hull    | <span class="number">8227</span>   | <span class="number">1</span>    | <span class="number">14356</span>         |</span><br><span class="line">| <span class="number">1</span>          | Jack Salazar    | <span class="number">9710</span>   | <span class="number">2</span>    | <span class="number">14356</span>         |</span><br><span class="line">| <span class="number">1</span>          | Ferris Brown    | <span class="number">19745</span>  | <span class="number">3</span>    | <span class="number">14356</span>         |</span><br><span class="line">| <span class="number">1</span>          | Noel Meyer      | <span class="number">19745</span>  | <span class="number">4</span>    | <span class="number">14356</span>         |</span><br><span class="line">| <span class="number">2</span>          | Haviva Montoya  | <span class="number">9308</span>   | <span class="number">1</span>    | <span class="number">13924</span>         |</span><br><span class="line">| <span class="number">2</span>          | Beverly Lang    | <span class="number">16233</span>  | <span class="number">2</span>    | <span class="number">13924</span>         |</span><br><span class="line">| <span class="number">2</span>          | Kameko French   | <span class="number">16233</span>  | <span class="number">3</span>    | <span class="number">13924</span>         |</span><br><span class="line">| <span class="number">3</span>          | May Stout       | <span class="number">9308</span>   | <span class="number">1</span>    | <span class="number">12368</span>         |</span><br><span class="line">| <span class="number">3</span>          | Abel Kim        | <span class="number">12369</span>  | <span class="number">2</span>    | <span class="number">12368</span>         |</span><br><span class="line">| <span class="number">3</span>          | Ursa George     | <span class="number">15427</span>  | <span class="number">3</span>    | <span class="number">12368</span>         |</span><br><span class="line">+<span class="comment">------------+-----------------+--------+------+---------------+</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 注：Frame 定义并非所有窗口函数都适用，比如 ROW_NUMBER()、RANK()、LEAD() 等。这些函数总是应用于整个分区，而非当前 Frame</span></span><br></pre></td></tr></table></figure>
<p><img src="/images/sql/sql-window-fun-7.png" width="780" alt="SQL 各部分的逻辑执行顺序" /></p>
<h2 id="2-Window-Function-Hive-Spark"><a href="#2-Window-Function-Hive-Spark" class="headerlink" title="2. Window Function, Hive/Spark"></a>2. Window Function, Hive/Spark</h2><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> window_test_table (</span><br><span class="line">    <span class="keyword">id</span> <span class="built_in">int</span>,    <span class="comment">--用户id</span></span><br><span class="line">    sq <span class="keyword">string</span>,  <span class="comment">--可以标识每个商品</span></span><br><span class="line">    cell_type <span class="built_in">int</span>, <span class="comment">--标识每个商品的类型，比如广告，非广告</span></span><br><span class="line">    <span class="keyword">rank</span> <span class="built_in">int</span>  <span class="comment">--这次搜索下商品的位置，比如第一个广告商品就是1，后面的依次2，3，4...</span></span><br><span class="line">)<span class="keyword">ROW</span> <span class="keyword">FORMAT</span> <span class="keyword">DELIMITED</span> <span class="keyword">FIELDS</span> <span class="keyword">TERMINATED</span> <span class="keyword">BY</span> <span class="string">','</span>;</span><br></pre></td></tr></table></figure>
<p><img src="/images/sql/sql-window-fun-1.jpg" width="580" alt="" /></p>
<p><img src="/images/sql/sql-window-fun-2.jpg" width="580" alt="" /></p>
<p>业务方的实现方法：</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">--业务方的写法</span></span><br><span class="line"><span class="keyword">select</span> </span><br><span class="line">    <span class="keyword">id</span>,</span><br><span class="line">    sq,</span><br><span class="line">    cell_type,</span><br><span class="line">    <span class="keyword">rank</span>,</span><br><span class="line">    <span class="keyword">if</span>(cell_type!=<span class="number">26</span>,row_number() <span class="keyword">over</span>(<span class="keyword">partition</span> <span class="keyword">by</span> <span class="keyword">id</span> <span class="keyword">order</span> <span class="keyword">by</span> <span class="keyword">rank</span>),<span class="literal">null</span>) naturl_rank  </span><br><span class="line"><span class="keyword">from</span> window_test_table <span class="keyword">order</span> <span class="keyword">by</span> <span class="keyword">rank</span>;</span><br></pre></td></tr></table></figure>
<p><img src="/images/sql/sql-window-fun-3.jpg" width="580" alt="" /></p>
<h2 id="2-Window-Function-Principle"><a href="#2-Window-Function-Principle" class="headerlink" title="2. Window Function Principle"></a>2. Window Function Principle</h2><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span></span><br><span class="line">    row_number() <span class="keyword">over</span>( <span class="keyword">partition</span> <span class="keyword">by</span> col1 <span class="keyword">order</span> <span class="keyword">by</span> col2 ) </span><br><span class="line"><span class="keyword">from</span> <span class="keyword">table</span></span><br></pre></td></tr></table></figure>
<h3 id="2-1-window-function-part"><a href="#2-1-window-function-part" class="headerlink" title="2.1 window function part"></a>2.1 window function part</h3><p>windows函数部分就是所要在窗口上执行的函数，spark支持三中类型的窗口函数：</p>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">No.</th>
<th>title</th>
<th style="text-align:center">example</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1.</td>
<td>Aggregate functions (聚合函数)</td>
<td style="text-align:center">AVG(), COUNT(), MIN(), MAX(), SUM()</td>
</tr>
<tr>
<td style="text-align:center">2.</td>
<td>Ranking functions (排序函数)</td>
<td style="text-align:center">RANK(), DENSE_RANK(), ROW_NUMBER(), NTILE()</td>
</tr>
<tr>
<td style="text-align:center">3.</td>
<td>Analytic functions (分析窗口函数)</td>
<td style="text-align:center">FIRST_VALUE(), LAST_VALUE(), LEAD(), LAG() <br> cume_dist函数计算当前值在窗口中的百分位数</td>
</tr>
</tbody>
</table>
</div>
<h3 id="2-2-window-Function-实现原理"><a href="#2-2-window-Function-实现原理" class="headerlink" title="2.2 window Function 实现原理"></a>2.2 window Function 实现原理</h3><p>窗口函数的实现，主要借助 Partitioned Table Function （即PTF）；</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> </span><br><span class="line">   <span class="keyword">id</span>,</span><br><span class="line">   sq,</span><br><span class="line">   cell_type,</span><br><span class="line">   <span class="keyword">rank</span>,</span><br><span class="line">   row_number() <span class="keyword">over</span>(<span class="keyword">partition</span> <span class="keyword">by</span> <span class="keyword">id</span>  <span class="keyword">order</span> <span class="keyword">by</span> <span class="keyword">rank</span> ) naturl_rank,</span><br><span class="line">   <span class="keyword">rank</span>() <span class="keyword">over</span>(<span class="keyword">partition</span> <span class="keyword">by</span> <span class="keyword">id</span> <span class="keyword">order</span> <span class="keyword">by</span> <span class="keyword">rank</span>) <span class="keyword">as</span> r,</span><br><span class="line">   <span class="keyword">dense_rank</span>() <span class="keyword">over</span>(<span class="keyword">partition</span> <span class="keyword">by</span>  cell_type <span class="keyword">order</span> <span class="keyword">by</span> <span class="keyword">id</span>) <span class="keyword">as</span> dr  </span><br><span class="line"><span class="keyword">from</span> window_test_table </span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> <span class="keyword">id</span>,sq,cell_type,<span class="keyword">rank</span>;</span><br></pre></td></tr></table></figure>
<p>数据流转如下图：</p>
<p><img src="/images/sql/sql-window-fun-8.jpg" width="880" alt="" /></p>
<h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ul>
<li><a href="https://zhuanlan.zhihu.com/p/80051518" target="_blank" rel="noopener">SQL 窗口函数的优化和执行</a></li>
<li><a href="https://blog.csdn.net/weixin_43619485/article/details/107164729" target="_blank" rel="noopener">【社招】快手<em>数据仓库</em>面试题整理</a></li>
<li><a href="https://my.oschina.net/u/4631230/blog/4688808" target="_blank" rel="noopener">2020年大厂面试题-数据仓库篇</a></li>
<li><a href="http://bigdatastudy.net/show.aspx?id=450&amp;cid=9" target="_blank" rel="noopener">『 Spark 』14. 一次 Spark SQL 性能提升10倍的经历</a></li>
<li><a href="http://bigdatastudy.net/show.aspx?id=544&amp;cid=9" target="_blank" rel="noopener">Spark教程-Spark 性能优化——和 shuffle 搏斗</a></li>
<li><a href="http://bigdatastudy.net/show.aspx?id=531&amp;cid=9" target="_blank" rel="noopener">spark中的spark Shuffle详解1</a></li>
<li><a href="https://blog.csdn.net/S_Running_snail/article/details/89282009" target="_blank" rel="noopener">Spark-SQL性能优化</a> </li>
</ul>

      
     <!-- by blair add this if sentence at 20160725 -->
      <br>
      
<div id="bottom-donation-section">
<span style="font-size: 1.0em; padding:0em 1em 0.5em 1em; margin: 0 auto;">
  <strong style="vertical-align: top;">分享到:</strong>
    <div class="j_handlclick"  style="background: url(/images/logos/share_facebook_icon.jpg);background-size: contain;display: inline-block; width:50px; height:50px" href="https://www.facebook.com/sharer/sharer.php?u=" target="_blank">
    </div>
    <div class="j_handlclick"  style="background: url(/images/logos/share_twitter_icon.jpg);background-size: contain;display: inline-block; width:50px; height:50px" href="https://twitter.com/intent/tweet?url=" target="_blank">
    </div>
    <div class="j_handlclick"  style="background: url(/images/logos/share_line_icon.jpg);background-size: contain;display: inline-block; width:50px; height:50px" href="https://www.addtoany.com/add_to/line?linkurl=" target="_blank">
    </div>
    <div class="j_handlclick"  style="background: url(/images/logos/share_wechat_icon.jpg);background-size: contain;display: inline-block; width:50px; height:50px" href="https://api.addthis.com/oexchange/0.8/forward/wechat/offer?url=" target="_blank">
    </div>
  <br>  
  <br>  
  &nbsp;&nbsp;如果您觉得这篇文章对您的学习很有帮助, 请您也分享它, 让它能再次帮助到更多的需要学习的人.
您的<a href="/support/"><strong>支持</strong></a>将鼓励我继续创作 !
  <br>  

</span>
<!--
<h3 id="bottom-donation-title">支持 让文章变得更优质</h3>
<div>
<a id="bottom-donation-button" href="/support">点我 赞助 作者</a>
</div>
-->
</div>
<div class="well">
  <!--
  原创文章，转载请注明： 转载自<a href="http://52binge.github.io" target="_blank" rel="noopener"> Blair Chan's Blog</a>，作者：
  <a href="/about">Blair Chan</a> <br>
  -->
  本文基于<a target="_blank" title="Creative Commons Attribution 4.0 international License" href="https://creativecommons.org/licenses/by-nc/4.0/">署名4.0国际许可协议</a>发布，转载请保留本文署名和文章链接。 如您有任何授权方面的协商，请邮件联系我。
</div>
 <!-- by blair add 160724-->
    
    </div>
    
      <div class="article-toc">
        <h3>Contents</h3>
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-Window-Function-SQL"><span class="toc-text">1. Window Function, SQL</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-Window-Function-Hive-Spark"><span class="toc-text">2. Window Function, Hive/Spark</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-Window-Function-Principle"><span class="toc-text">2. Window Function Principle</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-window-function-part"><span class="toc-text">2.1 window function part</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-window-Function-实现原理"><span class="toc-text">2.2 window Function 实现原理</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Reference"><span class="toc-text">Reference</span></a></li></ol>
      </div>
    
    
      <footer class="article-footer">
        <!-- <div class="well" style="width:100px; height:30px;"></div>  by blair-->
        
  <div class="article-category">
    <a class="article-category-link" href="/categories/data-warehouse/">data-warehouse</a>
  </div>

 <!-- by blair add 160724-->
        <!--
        <div style="width:100px; height:30px;"></div> by blair add 160724
        -->
        
  <div class="article-tag">
    <a class="article-tag-link" href="/tags/SQL/" rel="tag">SQL</a>
  </div>


      </footer>
    
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2021/03/09/dataware/dwh-summary-4-project/" id="article-nav-newer" class="article-nav-link-wrap">
      <div class="article-nav-title"><span>&lt;</span>&nbsp;
        
          DataWare Review Summary 4
        
      </div>
    </a>
  
  
    <a href="/2021/02/10/spark/spark-summary-6-sql-optimization-cube-group-by/" id="article-nav-older" class="article-nav-link-wrap">
      <div class="article-nav-title">SparkSQL Multidimensional Analysis - Group by&nbsp;<span>&gt;</span></div>
    </a>
  
</nav>

  
</article>

<section id="comments">
  <div id="disqus_thread">
    <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  </div>
</section>

</section>
    <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2021 Blair Chan&nbsp;
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>, theme by <a href="http://github.com/52binge/hexo-theme-blairos" target="_blank" rel="noopener">blairos</a>
    </div>
  </div>
</footer>

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX"],
    tex2jax: {
      inlineMath: [ ['$','$'], ['\\(','\\)'] ],
      displayMath: [ ['$$','$$']],
      processEscapes: true
    }
  });
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS_HTML,http://myserver.com/MathJax/config/local/local.js">
</script>

    
<script type="text/javascript"> <!-- add by blair 0724 type=text/javascript -->
  var disqus_shortname = 'blairos-sn';
  
  var disqus_url = 'http://iequa.com/2021/02/20/dataware/dwh-summary-3-window-function/';
  
  (function(){
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>


<script src="/js/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

  </div>
</body>
</html>
